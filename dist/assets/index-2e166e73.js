var iie=Object.defineProperty;var lie=(e,t,r)=>t in e?iie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var ss=(e,t,r)=>(lie(e,typeof t!="symbol"?t+"":t,r),r);function cie(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const o=Object.getOwnPropertyDescriptor(n,s);o&&Object.defineProperty(e,s,o.get?o:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}})();var rl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ua(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function die(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var yV={exports:{}},XS={},bV={exports:{}},Ea={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h1=Symbol.for("react.element"),uie=Symbol.for("react.portal"),fie=Symbol.for("react.fragment"),mie=Symbol.for("react.strict_mode"),hie=Symbol.for("react.profiler"),pie=Symbol.for("react.provider"),gie=Symbol.for("react.context"),vie=Symbol.for("react.forward_ref"),xie=Symbol.for("react.suspense"),yie=Symbol.for("react.memo"),bie=Symbol.for("react.lazy"),xL=Symbol.iterator;function wie(e){return e===null||typeof e!="object"?null:(e=xL&&e[xL]||e["@@iterator"],typeof e=="function"?e:null)}var wV={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},jV=Object.assign,_V={};function v0(e,t,r){this.props=e,this.context=t,this.refs=_V,this.updater=r||wV}v0.prototype.isReactComponent={};v0.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};v0.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function NV(){}NV.prototype=v0.prototype;function w3(e,t,r){this.props=e,this.context=t,this.refs=_V,this.updater=r||wV}var j3=w3.prototype=new NV;j3.constructor=w3;jV(j3,v0.prototype);j3.isPureReactComponent=!0;var yL=Array.isArray,SV=Object.prototype.hasOwnProperty,_3={current:null},CV={key:!0,ref:!0,__self:!0,__source:!0};function PV(e,t,r){var n,s={},o=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(o=""+t.key),t)SV.call(t,n)&&!CV.hasOwnProperty(n)&&(s[n]=t[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:h1,type:e,key:o,ref:i,props:s,_owner:_3.current}}function jie(e,t){return{$$typeof:h1,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function N3(e){return typeof e=="object"&&e!==null&&e.$$typeof===h1}function _ie(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var bL=/\/+/g;function IP(e,t){return typeof e=="object"&&e!==null&&e.key!=null?_ie(""+e.key):t.toString(36)}function qj(e,t,r,n,s){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case h1:case uie:i=!0}}if(i)return i=e,s=s(i),e=n===""?"."+IP(i,0):n,yL(s)?(r="",e!=null&&(r=e.replace(bL,"$&/")+"/"),qj(s,t,r,"",function(d){return d})):s!=null&&(N3(s)&&(s=jie(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(bL,"$&/")+"/")+e)),t.push(s)),1;if(i=0,n=n===""?".":n+":",yL(e))for(var l=0;l<e.length;l++){o=e[l];var c=n+IP(o,l);i+=qj(o,t,r,c,s)}else if(c=wie(e),typeof c=="function")for(e=c.call(e),l=0;!(o=e.next()).done;)o=o.value,c=n+IP(o,l++),i+=qj(o,t,r,c,s);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function w2(e,t,r){if(e==null)return e;var n=[],s=0;return qj(e,n,"","",function(o){return t.call(r,o,s++)}),n}function Nie(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Dl={current:null},zj={transition:null},Sie={ReactCurrentDispatcher:Dl,ReactCurrentBatchConfig:zj,ReactCurrentOwner:_3};function AV(){throw Error("act(...) is not supported in production builds of React.")}Ea.Children={map:w2,forEach:function(e,t,r){w2(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return w2(e,function(){t++}),t},toArray:function(e){return w2(e,function(t){return t})||[]},only:function(e){if(!N3(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ea.Component=v0;Ea.Fragment=fie;Ea.Profiler=hie;Ea.PureComponent=w3;Ea.StrictMode=mie;Ea.Suspense=xie;Ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Sie;Ea.act=AV;Ea.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=jV({},e.props),s=e.key,o=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,i=_3.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)SV.call(t,c)&&!CV.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:h1,type:e.type,key:s,ref:o,props:n,_owner:i}};Ea.createContext=function(e){return e={$$typeof:gie,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:pie,_context:e},e.Consumer=e};Ea.createElement=PV;Ea.createFactory=function(e){var t=PV.bind(null,e);return t.type=e,t};Ea.createRef=function(){return{current:null}};Ea.forwardRef=function(e){return{$$typeof:vie,render:e}};Ea.isValidElement=N3;Ea.lazy=function(e){return{$$typeof:bie,_payload:{_status:-1,_result:e},_init:Nie}};Ea.memo=function(e,t){return{$$typeof:yie,type:e,compare:t===void 0?null:t}};Ea.startTransition=function(e){var t=zj.transition;zj.transition={};try{e()}finally{zj.transition=t}};Ea.unstable_act=AV;Ea.useCallback=function(e,t){return Dl.current.useCallback(e,t)};Ea.useContext=function(e){return Dl.current.useContext(e)};Ea.useDebugValue=function(){};Ea.useDeferredValue=function(e){return Dl.current.useDeferredValue(e)};Ea.useEffect=function(e,t){return Dl.current.useEffect(e,t)};Ea.useId=function(){return Dl.current.useId()};Ea.useImperativeHandle=function(e,t,r){return Dl.current.useImperativeHandle(e,t,r)};Ea.useInsertionEffect=function(e,t){return Dl.current.useInsertionEffect(e,t)};Ea.useLayoutEffect=function(e,t){return Dl.current.useLayoutEffect(e,t)};Ea.useMemo=function(e,t){return Dl.current.useMemo(e,t)};Ea.useReducer=function(e,t,r){return Dl.current.useReducer(e,t,r)};Ea.useRef=function(e){return Dl.current.useRef(e)};Ea.useState=function(e){return Dl.current.useState(e)};Ea.useSyncExternalStore=function(e,t,r){return Dl.current.useSyncExternalStore(e,t,r)};Ea.useTransition=function(){return Dl.current.useTransition()};Ea.version="18.3.1";bV.exports=Ea;var p=bV.exports;const Pe=Ua(p),S3=cie({__proto__:null,default:Pe},[p]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cie=p,Pie=Symbol.for("react.element"),Aie=Symbol.for("react.fragment"),Eie=Object.prototype.hasOwnProperty,kie=Cie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Iie={key:!0,ref:!0,__self:!0,__source:!0};function EV(e,t,r){var n,s={},o=null,i=null;r!==void 0&&(o=""+r),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)Eie.call(t,n)&&!Iie.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:Pie,type:e,key:o,ref:i,props:s,_owner:kie.current}}XS.Fragment=Aie;XS.jsx=EV;XS.jsxs=EV;yV.exports=XS;var a=yV.exports,vk={},kV={exports:{}},Kc={},IV={exports:{}},OV={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t($,X){var ye=$.length;$.push(X);e:for(;0<ye;){var Se=ye-1>>>1,V=$[Se];if(0<s(V,X))$[Se]=X,$[ye]=V,ye=Se;else break e}}function r($){return $.length===0?null:$[0]}function n($){if($.length===0)return null;var X=$[0],ye=$.pop();if(ye!==X){$[0]=ye;e:for(var Se=0,V=$.length,B=V>>>1;Se<B;){var Q=2*(Se+1)-1,pe=$[Q],te=Q+1,Y=$[te];if(0>s(pe,ye))te<V&&0>s(Y,pe)?($[Se]=Y,$[te]=ye,Se=te):($[Se]=pe,$[Q]=ye,Se=Q);else if(te<V&&0>s(Y,ye))$[Se]=Y,$[te]=ye,Se=te;else break e}}return X}function s($,X){var ye=$.sortIndex-X.sortIndex;return ye!==0?ye:$.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var i=Date,l=i.now();e.unstable_now=function(){return i.now()-l}}var c=[],d=[],u=1,f=null,h=3,m=!1,v=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w($){for(var X=r(d);X!==null;){if(X.callback===null)n(d);else if(X.startTime<=$)n(d),X.sortIndex=X.expirationTime,t(c,X);else break;X=r(d)}}function j($){if(g=!1,w($),!v)if(r(c)!==null)v=!0,z(_);else{var X=r(d);X!==null&&W(j,X.startTime-$)}}function _($,X){v=!1,g&&(g=!1,x(P),P=-1),m=!0;var ye=h;try{for(w(X),f=r(c);f!==null&&(!(f.expirationTime>X)||$&&!O());){var Se=f.callback;if(typeof Se=="function"){f.callback=null,h=f.priorityLevel;var V=Se(f.expirationTime<=X);X=e.unstable_now(),typeof V=="function"?f.callback=V:f===r(c)&&n(c),w(X)}else n(c);f=r(c)}if(f!==null)var B=!0;else{var Q=r(d);Q!==null&&W(j,Q.startTime-X),B=!1}return B}finally{f=null,h=ye,m=!1}}var S=!1,C=null,P=-1,A=5,R=-1;function O(){return!(e.unstable_now()-R<A)}function I(){if(C!==null){var $=e.unstable_now();R=$;var X=!0;try{X=C(!0,$)}finally{X?M():(S=!1,C=null)}}else S=!1}var M;if(typeof b=="function")M=function(){b(I)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,U=D.port2;D.port1.onmessage=I,M=function(){U.postMessage(null)}}else M=function(){y(I,0)};function z($){C=$,S||(S=!0,M())}function W($,X){P=y(function(){$(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function($){$.callback=null},e.unstable_continueExecution=function(){v||m||(v=!0,z(_))},e.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<$?Math.floor(1e3/$):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function($){switch(h){case 1:case 2:case 3:var X=3;break;default:X=h}var ye=h;h=X;try{return $()}finally{h=ye}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function($,X){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var ye=h;h=$;try{return X()}finally{h=ye}},e.unstable_scheduleCallback=function($,X,ye){var Se=e.unstable_now();switch(typeof ye=="object"&&ye!==null?(ye=ye.delay,ye=typeof ye=="number"&&0<ye?Se+ye:Se):ye=Se,$){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=ye+V,$={id:u++,callback:X,priorityLevel:$,startTime:ye,expirationTime:V,sortIndex:-1},ye>Se?($.sortIndex=ye,t(d,$),r(c)===null&&$===r(d)&&(g?(x(P),P=-1):g=!0,W(j,ye-Se))):($.sortIndex=V,t(c,$),v||m||(v=!0,z(_))),$},e.unstable_shouldYield=O,e.unstable_wrapCallback=function($){var X=h;return function(){var ye=h;h=X;try{return $.apply(this,arguments)}finally{h=ye}}}})(OV);IV.exports=OV;var Oie=IV.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tie=p,Hc=Oie;function Yr(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var TV=new Set,Rb={};function kg(e,t){_x(e,t),_x(e+"Capture",t)}function _x(e,t){for(Rb[e]=t,e=0;e<t.length;e++)TV.add(t[e])}var Wf=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xk=Object.prototype.hasOwnProperty,Die=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,wL={},jL={};function Mie(e){return xk.call(jL,e)?!0:xk.call(wL,e)?!1:Die.test(e)?jL[e]=!0:(wL[e]=!0,!1)}function Rie(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Lie(e,t,r,n){if(t===null||typeof t>"u"||Rie(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ml(e,t,r,n,s,o,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=i}var Bi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Bi[e]=new Ml(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Bi[t]=new Ml(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Bi[e]=new Ml(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Bi[e]=new Ml(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Bi[e]=new Ml(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Bi[e]=new Ml(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Bi[e]=new Ml(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Bi[e]=new Ml(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Bi[e]=new Ml(e,5,!1,e.toLowerCase(),null,!1,!1)});var C3=/[\-:]([a-z])/g;function P3(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(C3,P3);Bi[t]=new Ml(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(C3,P3);Bi[t]=new Ml(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(C3,P3);Bi[t]=new Ml(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Bi[e]=new Ml(e,1,!1,e.toLowerCase(),null,!1,!1)});Bi.xlinkHref=new Ml("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Bi[e]=new Ml(e,1,!1,e.toLowerCase(),null,!0,!0)});function A3(e,t,r,n){var s=Bi.hasOwnProperty(t)?Bi[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Lie(t,r,s,n)&&(r=null),n||s===null?Mie(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var om=Tie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,j2=Symbol.for("react.element"),Ov=Symbol.for("react.portal"),Tv=Symbol.for("react.fragment"),E3=Symbol.for("react.strict_mode"),yk=Symbol.for("react.profiler"),DV=Symbol.for("react.provider"),MV=Symbol.for("react.context"),k3=Symbol.for("react.forward_ref"),bk=Symbol.for("react.suspense"),wk=Symbol.for("react.suspense_list"),I3=Symbol.for("react.memo"),Lm=Symbol.for("react.lazy"),RV=Symbol.for("react.offscreen"),_L=Symbol.iterator;function ry(e){return e===null||typeof e!="object"?null:(e=_L&&e[_L]||e["@@iterator"],typeof e=="function"?e:null)}var no=Object.assign,OP;function My(e){if(OP===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);OP=t&&t[1]||""}return`
`+OP+e}var TP=!1;function DP(e,t){if(!e||TP)return"";TP=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),o=n.stack.split(`
`),i=s.length-1,l=o.length-1;1<=i&&0<=l&&s[i]!==o[l];)l--;for(;1<=i&&0<=l;i--,l--)if(s[i]!==o[l]){if(i!==1||l!==1)do if(i--,l--,0>l||s[i]!==o[l]){var c=`
`+s[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=l);break}}}finally{TP=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?My(e):""}function Fie(e){switch(e.tag){case 5:return My(e.type);case 16:return My("Lazy");case 13:return My("Suspense");case 19:return My("SuspenseList");case 0:case 2:case 15:return e=DP(e.type,!1),e;case 11:return e=DP(e.type.render,!1),e;case 1:return e=DP(e.type,!0),e;default:return""}}function jk(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Tv:return"Fragment";case Ov:return"Portal";case yk:return"Profiler";case E3:return"StrictMode";case bk:return"Suspense";case wk:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case MV:return(e.displayName||"Context")+".Consumer";case DV:return(e._context.displayName||"Context")+".Provider";case k3:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case I3:return t=e.displayName||null,t!==null?t:jk(e.type)||"Memo";case Lm:t=e._payload,e=e._init;try{return jk(e(t))}catch{}}return null}function $ie(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return jk(t);case 8:return t===E3?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Eh(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function LV(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Bie(e){var t=LV(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,o.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function _2(e){e._valueTracker||(e._valueTracker=Bie(e))}function FV(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=LV(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function b_(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function _k(e,t){var r=t.checked;return no({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function NL(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Eh(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function $V(e,t){t=t.checked,t!=null&&A3(e,"checked",t,!1)}function Nk(e,t){$V(e,t);var r=Eh(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Sk(e,t.type,r):t.hasOwnProperty("defaultValue")&&Sk(e,t.type,Eh(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function SL(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Sk(e,t,r){(t!=="number"||b_(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ry=Array.isArray;function rx(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Eh(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Ck(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Yr(91));return no({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function CL(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Yr(92));if(Ry(r)){if(1<r.length)throw Error(Yr(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Eh(r)}}function BV(e,t){var r=Eh(t.value),n=Eh(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function PL(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function qV(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pk(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?qV(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var N2,zV=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(N2=N2||document.createElement("div"),N2.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=N2.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Lb(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Hy={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qie=["Webkit","ms","Moz","O"];Object.keys(Hy).forEach(function(e){qie.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Hy[t]=Hy[e]})});function UV(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Hy.hasOwnProperty(e)&&Hy[e]?(""+t).trim():t+"px"}function VV(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=UV(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var zie=no({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ak(e,t){if(t){if(zie[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Yr(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Yr(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Yr(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Yr(62))}}function Ek(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kk=null;function O3(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ik=null,nx=null,ax=null;function AL(e){if(e=v1(e)){if(typeof Ik!="function")throw Error(Yr(280));var t=e.stateNode;t&&(t=eC(t),Ik(e.stateNode,e.type,t))}}function WV(e){nx?ax?ax.push(e):ax=[e]:nx=e}function HV(){if(nx){var e=nx,t=ax;if(ax=nx=null,AL(e),t)for(e=0;e<t.length;e++)AL(t[e])}}function GV(e,t){return e(t)}function KV(){}var MP=!1;function XV(e,t,r){if(MP)return e(t,r);MP=!0;try{return GV(e,t,r)}finally{MP=!1,(nx!==null||ax!==null)&&(KV(),HV())}}function Fb(e,t){var r=e.stateNode;if(r===null)return null;var n=eC(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Yr(231,t,typeof r));return r}var Ok=!1;if(Wf)try{var ny={};Object.defineProperty(ny,"passive",{get:function(){Ok=!0}}),window.addEventListener("test",ny,ny),window.removeEventListener("test",ny,ny)}catch{Ok=!1}function Uie(e,t,r,n,s,o,i,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(u){this.onError(u)}}var Gy=!1,w_=null,j_=!1,Tk=null,Vie={onError:function(e){Gy=!0,w_=e}};function Wie(e,t,r,n,s,o,i,l,c){Gy=!1,w_=null,Uie.apply(Vie,arguments)}function Hie(e,t,r,n,s,o,i,l,c){if(Wie.apply(this,arguments),Gy){if(Gy){var d=w_;Gy=!1,w_=null}else throw Error(Yr(198));j_||(j_=!0,Tk=d)}}function Ig(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function YV(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function EL(e){if(Ig(e)!==e)throw Error(Yr(188))}function Gie(e){var t=e.alternate;if(!t){if(t=Ig(e),t===null)throw Error(Yr(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var o=s.alternate;if(o===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===r)return EL(s),e;if(o===n)return EL(s),t;o=o.sibling}throw Error(Yr(188))}if(r.return!==n.return)r=s,n=o;else{for(var i=!1,l=s.child;l;){if(l===r){i=!0,r=s,n=o;break}if(l===n){i=!0,n=s,r=o;break}l=l.sibling}if(!i){for(l=o.child;l;){if(l===r){i=!0,r=o,n=s;break}if(l===n){i=!0,n=o,r=s;break}l=l.sibling}if(!i)throw Error(Yr(189))}}if(r.alternate!==n)throw Error(Yr(190))}if(r.tag!==3)throw Error(Yr(188));return r.stateNode.current===r?e:t}function JV(e){return e=Gie(e),e!==null?QV(e):null}function QV(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=QV(e);if(t!==null)return t;e=e.sibling}return null}var ZV=Hc.unstable_scheduleCallback,kL=Hc.unstable_cancelCallback,Kie=Hc.unstable_shouldYield,Xie=Hc.unstable_requestPaint,wo=Hc.unstable_now,Yie=Hc.unstable_getCurrentPriorityLevel,T3=Hc.unstable_ImmediatePriority,eW=Hc.unstable_UserBlockingPriority,__=Hc.unstable_NormalPriority,Jie=Hc.unstable_LowPriority,tW=Hc.unstable_IdlePriority,YS=null,Xu=null;function Qie(e){if(Xu&&typeof Xu.onCommitFiberRoot=="function")try{Xu.onCommitFiberRoot(YS,e,void 0,(e.current.flags&128)===128)}catch{}}var cu=Math.clz32?Math.clz32:tle,Zie=Math.log,ele=Math.LN2;function tle(e){return e>>>=0,e===0?32:31-(Zie(e)/ele|0)|0}var S2=64,C2=4194304;function Ly(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function N_(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,o=e.pingedLanes,i=r&268435455;if(i!==0){var l=i&~s;l!==0?n=Ly(l):(o&=i,o!==0&&(n=Ly(o)))}else i=r&~s,i!==0?n=Ly(i):o!==0&&(n=Ly(o));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,o=t&-t,s>=o||s===16&&(o&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-cu(t),s=1<<r,n|=e[r],t&=~s;return n}function rle(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nle(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,o=e.pendingLanes;0<o;){var i=31-cu(o),l=1<<i,c=s[i];c===-1?(!(l&r)||l&n)&&(s[i]=rle(l,t)):c<=t&&(e.expiredLanes|=l),o&=~l}}function Dk(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function rW(){var e=S2;return S2<<=1,!(S2&4194240)&&(S2=64),e}function RP(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function p1(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-cu(t),e[t]=r}function ale(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-cu(r),o=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~o}}function D3(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-cu(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var ls=0;function nW(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var aW,M3,sW,oW,iW,Mk=!1,P2=[],oh=null,ih=null,lh=null,$b=new Map,Bb=new Map,zm=[],sle="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function IL(e,t){switch(e){case"focusin":case"focusout":oh=null;break;case"dragenter":case"dragleave":ih=null;break;case"mouseover":case"mouseout":lh=null;break;case"pointerover":case"pointerout":$b.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bb.delete(t.pointerId)}}function ay(e,t,r,n,s,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:o,targetContainers:[s]},t!==null&&(t=v1(t),t!==null&&M3(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function ole(e,t,r,n,s){switch(t){case"focusin":return oh=ay(oh,e,t,r,n,s),!0;case"dragenter":return ih=ay(ih,e,t,r,n,s),!0;case"mouseover":return lh=ay(lh,e,t,r,n,s),!0;case"pointerover":var o=s.pointerId;return $b.set(o,ay($b.get(o)||null,e,t,r,n,s)),!0;case"gotpointercapture":return o=s.pointerId,Bb.set(o,ay(Bb.get(o)||null,e,t,r,n,s)),!0}return!1}function lW(e){var t=Op(e.target);if(t!==null){var r=Ig(t);if(r!==null){if(t=r.tag,t===13){if(t=YV(r),t!==null){e.blockedOn=t,iW(e.priority,function(){sW(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Uj(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Rk(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);kk=n,r.target.dispatchEvent(n),kk=null}else return t=v1(r),t!==null&&M3(t),e.blockedOn=r,!1;t.shift()}return!0}function OL(e,t,r){Uj(e)&&r.delete(t)}function ile(){Mk=!1,oh!==null&&Uj(oh)&&(oh=null),ih!==null&&Uj(ih)&&(ih=null),lh!==null&&Uj(lh)&&(lh=null),$b.forEach(OL),Bb.forEach(OL)}function sy(e,t){e.blockedOn===t&&(e.blockedOn=null,Mk||(Mk=!0,Hc.unstable_scheduleCallback(Hc.unstable_NormalPriority,ile)))}function qb(e){function t(s){return sy(s,e)}if(0<P2.length){sy(P2[0],e);for(var r=1;r<P2.length;r++){var n=P2[r];n.blockedOn===e&&(n.blockedOn=null)}}for(oh!==null&&sy(oh,e),ih!==null&&sy(ih,e),lh!==null&&sy(lh,e),$b.forEach(t),Bb.forEach(t),r=0;r<zm.length;r++)n=zm[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<zm.length&&(r=zm[0],r.blockedOn===null);)lW(r),r.blockedOn===null&&zm.shift()}var sx=om.ReactCurrentBatchConfig,S_=!0;function lle(e,t,r,n){var s=ls,o=sx.transition;sx.transition=null;try{ls=1,R3(e,t,r,n)}finally{ls=s,sx.transition=o}}function cle(e,t,r,n){var s=ls,o=sx.transition;sx.transition=null;try{ls=4,R3(e,t,r,n)}finally{ls=s,sx.transition=o}}function R3(e,t,r,n){if(S_){var s=Rk(e,t,r,n);if(s===null)HP(e,t,n,C_,r),IL(e,n);else if(ole(s,e,t,r,n))n.stopPropagation();else if(IL(e,n),t&4&&-1<sle.indexOf(e)){for(;s!==null;){var o=v1(s);if(o!==null&&aW(o),o=Rk(e,t,r,n),o===null&&HP(e,t,n,C_,r),o===s)break;s=o}s!==null&&n.stopPropagation()}else HP(e,t,n,null,r)}}var C_=null;function Rk(e,t,r,n){if(C_=null,e=O3(n),e=Op(e),e!==null)if(t=Ig(e),t===null)e=null;else if(r=t.tag,r===13){if(e=YV(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return C_=e,null}function cW(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Yie()){case T3:return 1;case eW:return 4;case __:case Jie:return 16;case tW:return 536870912;default:return 16}default:return 16}}var Xm=null,L3=null,Vj=null;function dW(){if(Vj)return Vj;var e,t=L3,r=t.length,n,s="value"in Xm?Xm.value:Xm.textContent,o=s.length;for(e=0;e<r&&t[e]===s[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===s[o-n];n++);return Vj=s.slice(e,1<n?1-n:void 0)}function Wj(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function A2(){return!0}function TL(){return!1}function Xc(e){function t(r,n,s,o,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?A2:TL,this.isPropagationStopped=TL,this}return no(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=A2)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=A2)},persist:function(){},isPersistent:A2}),t}var x0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},F3=Xc(x0),g1=no({},x0,{view:0,detail:0}),dle=Xc(g1),LP,FP,oy,JS=no({},g1,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$3,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==oy&&(oy&&e.type==="mousemove"?(LP=e.screenX-oy.screenX,FP=e.screenY-oy.screenY):FP=LP=0,oy=e),LP)},movementY:function(e){return"movementY"in e?e.movementY:FP}}),DL=Xc(JS),ule=no({},JS,{dataTransfer:0}),fle=Xc(ule),mle=no({},g1,{relatedTarget:0}),$P=Xc(mle),hle=no({},x0,{animationName:0,elapsedTime:0,pseudoElement:0}),ple=Xc(hle),gle=no({},x0,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vle=Xc(gle),xle=no({},x0,{data:0}),ML=Xc(xle),yle={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ble={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wle={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jle(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=wle[e])?!!t[e]:!1}function $3(){return jle}var _le=no({},g1,{key:function(e){if(e.key){var t=yle[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Wj(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?ble[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$3,charCode:function(e){return e.type==="keypress"?Wj(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Wj(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Nle=Xc(_le),Sle=no({},JS,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),RL=Xc(Sle),Cle=no({},g1,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$3}),Ple=Xc(Cle),Ale=no({},x0,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ele=Xc(Ale),kle=no({},JS,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ile=Xc(kle),Ole=[9,13,27,32],B3=Wf&&"CompositionEvent"in window,Ky=null;Wf&&"documentMode"in document&&(Ky=document.documentMode);var Tle=Wf&&"TextEvent"in window&&!Ky,uW=Wf&&(!B3||Ky&&8<Ky&&11>=Ky),LL=String.fromCharCode(32),FL=!1;function fW(e,t){switch(e){case"keyup":return Ole.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mW(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Dv=!1;function Dle(e,t){switch(e){case"compositionend":return mW(t);case"keypress":return t.which!==32?null:(FL=!0,LL);case"textInput":return e=t.data,e===LL&&FL?null:e;default:return null}}function Mle(e,t){if(Dv)return e==="compositionend"||!B3&&fW(e,t)?(e=dW(),Vj=L3=Xm=null,Dv=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return uW&&t.locale!=="ko"?null:t.data;default:return null}}var Rle={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $L(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Rle[e.type]:t==="textarea"}function hW(e,t,r,n){WV(n),t=P_(t,"onChange"),0<t.length&&(r=new F3("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Xy=null,zb=null;function Lle(e){SW(e,0)}function QS(e){var t=Lv(e);if(FV(t))return e}function Fle(e,t){if(e==="change")return t}var pW=!1;if(Wf){var BP;if(Wf){var qP="oninput"in document;if(!qP){var BL=document.createElement("div");BL.setAttribute("oninput","return;"),qP=typeof BL.oninput=="function"}BP=qP}else BP=!1;pW=BP&&(!document.documentMode||9<document.documentMode)}function qL(){Xy&&(Xy.detachEvent("onpropertychange",gW),zb=Xy=null)}function gW(e){if(e.propertyName==="value"&&QS(zb)){var t=[];hW(t,zb,e,O3(e)),XV(Lle,t)}}function $le(e,t,r){e==="focusin"?(qL(),Xy=t,zb=r,Xy.attachEvent("onpropertychange",gW)):e==="focusout"&&qL()}function Ble(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return QS(zb)}function qle(e,t){if(e==="click")return QS(t)}function zle(e,t){if(e==="input"||e==="change")return QS(t)}function Ule(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var hu=typeof Object.is=="function"?Object.is:Ule;function Ub(e,t){if(hu(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!xk.call(t,s)||!hu(e[s],t[s]))return!1}return!0}function zL(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function UL(e,t){var r=zL(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=zL(r)}}function vW(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?vW(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function xW(){for(var e=window,t=b_();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=b_(e.document)}return t}function q3(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Vle(e){var t=xW(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&vW(r.ownerDocument.documentElement,r)){if(n!==null&&q3(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,o=Math.min(n.start,s);n=n.end===void 0?o:Math.min(n.end,s),!e.extend&&o>n&&(s=n,n=o,o=s),s=UL(r,o);var i=UL(r,n);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),o>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Wle=Wf&&"documentMode"in document&&11>=document.documentMode,Mv=null,Lk=null,Yy=null,Fk=!1;function VL(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Fk||Mv==null||Mv!==b_(n)||(n=Mv,"selectionStart"in n&&q3(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Yy&&Ub(Yy,n)||(Yy=n,n=P_(Lk,"onSelect"),0<n.length&&(t=new F3("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Mv)))}function E2(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Rv={animationend:E2("Animation","AnimationEnd"),animationiteration:E2("Animation","AnimationIteration"),animationstart:E2("Animation","AnimationStart"),transitionend:E2("Transition","TransitionEnd")},zP={},yW={};Wf&&(yW=document.createElement("div").style,"AnimationEvent"in window||(delete Rv.animationend.animation,delete Rv.animationiteration.animation,delete Rv.animationstart.animation),"TransitionEvent"in window||delete Rv.transitionend.transition);function ZS(e){if(zP[e])return zP[e];if(!Rv[e])return e;var t=Rv[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in yW)return zP[e]=t[r];return e}var bW=ZS("animationend"),wW=ZS("animationiteration"),jW=ZS("animationstart"),_W=ZS("transitionend"),NW=new Map,WL="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zh(e,t){NW.set(e,t),kg(t,[e])}for(var UP=0;UP<WL.length;UP++){var VP=WL[UP],Hle=VP.toLowerCase(),Gle=VP[0].toUpperCase()+VP.slice(1);zh(Hle,"on"+Gle)}zh(bW,"onAnimationEnd");zh(wW,"onAnimationIteration");zh(jW,"onAnimationStart");zh("dblclick","onDoubleClick");zh("focusin","onFocus");zh("focusout","onBlur");zh(_W,"onTransitionEnd");_x("onMouseEnter",["mouseout","mouseover"]);_x("onMouseLeave",["mouseout","mouseover"]);_x("onPointerEnter",["pointerout","pointerover"]);_x("onPointerLeave",["pointerout","pointerover"]);kg("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));kg("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));kg("onBeforeInput",["compositionend","keypress","textInput","paste"]);kg("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));kg("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));kg("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fy="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Kle=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fy));function HL(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Hie(n,t,void 0,e),e.currentTarget=null}function SW(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var o=void 0;if(t)for(var i=n.length-1;0<=i;i--){var l=n[i],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==o&&s.isPropagationStopped())break e;HL(s,l,d),o=c}else for(i=0;i<n.length;i++){if(l=n[i],c=l.instance,d=l.currentTarget,l=l.listener,c!==o&&s.isPropagationStopped())break e;HL(s,l,d),o=c}}}if(j_)throw e=Tk,j_=!1,Tk=null,e}function Ms(e,t){var r=t[Uk];r===void 0&&(r=t[Uk]=new Set);var n=e+"__bubble";r.has(n)||(CW(t,e,2,!1),r.add(n))}function WP(e,t,r){var n=0;t&&(n|=4),CW(r,e,n,t)}var k2="_reactListening"+Math.random().toString(36).slice(2);function Vb(e){if(!e[k2]){e[k2]=!0,TV.forEach(function(r){r!=="selectionchange"&&(Kle.has(r)||WP(r,!1,e),WP(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[k2]||(t[k2]=!0,WP("selectionchange",!1,t))}}function CW(e,t,r,n){switch(cW(t)){case 1:var s=lle;break;case 4:s=cle;break;default:s=R3}r=s.bind(null,t,r,e),s=void 0,!Ok||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function HP(e,t,r,n,s){var o=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;i=i.return}for(;l!==null;){if(i=Op(l),i===null)return;if(c=i.tag,c===5||c===6){n=o=i;continue e}l=l.parentNode}}n=n.return}XV(function(){var d=o,u=O3(r),f=[];e:{var h=NW.get(e);if(h!==void 0){var m=F3,v=e;switch(e){case"keypress":if(Wj(r)===0)break e;case"keydown":case"keyup":m=Nle;break;case"focusin":v="focus",m=$P;break;case"focusout":v="blur",m=$P;break;case"beforeblur":case"afterblur":m=$P;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=DL;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=fle;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=Ple;break;case bW:case wW:case jW:m=ple;break;case _W:m=Ele;break;case"scroll":m=dle;break;case"wheel":m=Ile;break;case"copy":case"cut":case"paste":m=vle;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=RL}var g=(t&4)!==0,y=!g&&e==="scroll",x=g?h!==null?h+"Capture":null:h;g=[];for(var b=d,w;b!==null;){w=b;var j=w.stateNode;if(w.tag===5&&j!==null&&(w=j,x!==null&&(j=Fb(b,x),j!=null&&g.push(Wb(b,j,w)))),y)break;b=b.return}0<g.length&&(h=new m(h,v,null,r,u),f.push({event:h,listeners:g}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",h&&r!==kk&&(v=r.relatedTarget||r.fromElement)&&(Op(v)||v[Hf]))break e;if((m||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,m?(v=r.relatedTarget||r.toElement,m=d,v=v?Op(v):null,v!==null&&(y=Ig(v),v!==y||v.tag!==5&&v.tag!==6)&&(v=null)):(m=null,v=d),m!==v)){if(g=DL,j="onMouseLeave",x="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(g=RL,j="onPointerLeave",x="onPointerEnter",b="pointer"),y=m==null?h:Lv(m),w=v==null?h:Lv(v),h=new g(j,b+"leave",m,r,u),h.target=y,h.relatedTarget=w,j=null,Op(u)===d&&(g=new g(x,b+"enter",v,r,u),g.target=w,g.relatedTarget=y,j=g),y=j,m&&v)t:{for(g=m,x=v,b=0,w=g;w;w=Qg(w))b++;for(w=0,j=x;j;j=Qg(j))w++;for(;0<b-w;)g=Qg(g),b--;for(;0<w-b;)x=Qg(x),w--;for(;b--;){if(g===x||x!==null&&g===x.alternate)break t;g=Qg(g),x=Qg(x)}g=null}else g=null;m!==null&&GL(f,h,m,g,!1),v!==null&&y!==null&&GL(f,y,v,g,!0)}}e:{if(h=d?Lv(d):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var _=Fle;else if($L(h))if(pW)_=zle;else{_=Ble;var S=$le}else(m=h.nodeName)&&m.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(_=qle);if(_&&(_=_(e,d))){hW(f,_,r,u);break e}S&&S(e,h,d),e==="focusout"&&(S=h._wrapperState)&&S.controlled&&h.type==="number"&&Sk(h,"number",h.value)}switch(S=d?Lv(d):window,e){case"focusin":($L(S)||S.contentEditable==="true")&&(Mv=S,Lk=d,Yy=null);break;case"focusout":Yy=Lk=Mv=null;break;case"mousedown":Fk=!0;break;case"contextmenu":case"mouseup":case"dragend":Fk=!1,VL(f,r,u);break;case"selectionchange":if(Wle)break;case"keydown":case"keyup":VL(f,r,u)}var C;if(B3)e:{switch(e){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Dv?fW(e,r)&&(P="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(P="onCompositionStart");P&&(uW&&r.locale!=="ko"&&(Dv||P!=="onCompositionStart"?P==="onCompositionEnd"&&Dv&&(C=dW()):(Xm=u,L3="value"in Xm?Xm.value:Xm.textContent,Dv=!0)),S=P_(d,P),0<S.length&&(P=new ML(P,e,null,r,u),f.push({event:P,listeners:S}),C?P.data=C:(C=mW(r),C!==null&&(P.data=C)))),(C=Tle?Dle(e,r):Mle(e,r))&&(d=P_(d,"onBeforeInput"),0<d.length&&(u=new ML("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:d}),u.data=C))}SW(f,t)})}function Wb(e,t,r){return{instance:e,listener:t,currentTarget:r}}function P_(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=Fb(e,r),o!=null&&n.unshift(Wb(e,o,s)),o=Fb(e,t),o!=null&&n.push(Wb(e,o,s))),e=e.return}return n}function Qg(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function GL(e,t,r,n,s){for(var o=t._reactName,i=[];r!==null&&r!==n;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&d!==null&&(l=d,s?(c=Fb(r,o),c!=null&&i.unshift(Wb(r,c,l))):s||(c=Fb(r,o),c!=null&&i.push(Wb(r,c,l)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var Xle=/\r\n?/g,Yle=/\u0000|\uFFFD/g;function KL(e){return(typeof e=="string"?e:""+e).replace(Xle,`
`).replace(Yle,"")}function I2(e,t,r){if(t=KL(t),KL(e)!==t&&r)throw Error(Yr(425))}function A_(){}var $k=null,Bk=null;function qk(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var zk=typeof setTimeout=="function"?setTimeout:void 0,Jle=typeof clearTimeout=="function"?clearTimeout:void 0,XL=typeof Promise=="function"?Promise:void 0,Qle=typeof queueMicrotask=="function"?queueMicrotask:typeof XL<"u"?function(e){return XL.resolve(null).then(e).catch(Zle)}:zk;function Zle(e){setTimeout(function(){throw e})}function GP(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),qb(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);qb(t)}function ch(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function YL(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var y0=Math.random().toString(36).slice(2),Fu="__reactFiber$"+y0,Hb="__reactProps$"+y0,Hf="__reactContainer$"+y0,Uk="__reactEvents$"+y0,ece="__reactListeners$"+y0,tce="__reactHandles$"+y0;function Op(e){var t=e[Fu];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Hf]||r[Fu]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=YL(e);e!==null;){if(r=e[Fu])return r;e=YL(e)}return t}e=r,r=e.parentNode}return null}function v1(e){return e=e[Fu]||e[Hf],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Lv(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Yr(33))}function eC(e){return e[Hb]||null}var Vk=[],Fv=-1;function Uh(e){return{current:e}}function $s(e){0>Fv||(e.current=Vk[Fv],Vk[Fv]=null,Fv--)}function Ss(e,t){Fv++,Vk[Fv]=e.current,e.current=t}var kh={},sl=Uh(kh),ac=Uh(!1),cg=kh;function Nx(e,t){var r=e.type.contextTypes;if(!r)return kh;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in r)s[o]=t[o];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function sc(e){return e=e.childContextTypes,e!=null}function E_(){$s(ac),$s(sl)}function JL(e,t,r){if(sl.current!==kh)throw Error(Yr(168));Ss(sl,t),Ss(ac,r)}function PW(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(Yr(108,$ie(e)||"Unknown",s));return no({},r,n)}function k_(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||kh,cg=sl.current,Ss(sl,e),Ss(ac,ac.current),!0}function QL(e,t,r){var n=e.stateNode;if(!n)throw Error(Yr(169));r?(e=PW(e,t,cg),n.__reactInternalMemoizedMergedChildContext=e,$s(ac),$s(sl),Ss(sl,e)):$s(ac),Ss(ac,r)}var Ef=null,tC=!1,KP=!1;function AW(e){Ef===null?Ef=[e]:Ef.push(e)}function rce(e){tC=!0,AW(e)}function Vh(){if(!KP&&Ef!==null){KP=!0;var e=0,t=ls;try{var r=Ef;for(ls=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Ef=null,tC=!1}catch(s){throw Ef!==null&&(Ef=Ef.slice(e+1)),ZV(T3,Vh),s}finally{ls=t,KP=!1}}return null}var $v=[],Bv=0,I_=null,O_=0,ud=[],fd=0,dg=null,Tf=1,Df="";function vp(e,t){$v[Bv++]=O_,$v[Bv++]=I_,I_=e,O_=t}function EW(e,t,r){ud[fd++]=Tf,ud[fd++]=Df,ud[fd++]=dg,dg=e;var n=Tf;e=Df;var s=32-cu(n)-1;n&=~(1<<s),r+=1;var o=32-cu(t)+s;if(30<o){var i=s-s%5;o=(n&(1<<i)-1).toString(32),n>>=i,s-=i,Tf=1<<32-cu(t)+s|r<<s|n,Df=o+e}else Tf=1<<o|r<<s|n,Df=e}function z3(e){e.return!==null&&(vp(e,1),EW(e,1,0))}function U3(e){for(;e===I_;)I_=$v[--Bv],$v[Bv]=null,O_=$v[--Bv],$v[Bv]=null;for(;e===dg;)dg=ud[--fd],ud[fd]=null,Df=ud[--fd],ud[fd]=null,Tf=ud[--fd],ud[fd]=null}var $c=null,Oc=null,Gs=!1,nu=null;function kW(e,t){var r=wd(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function ZL(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,$c=e,Oc=ch(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,$c=e,Oc=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=dg!==null?{id:Tf,overflow:Df}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=wd(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,$c=e,Oc=null,!0):!1;default:return!1}}function Wk(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Hk(e){if(Gs){var t=Oc;if(t){var r=t;if(!ZL(e,t)){if(Wk(e))throw Error(Yr(418));t=ch(r.nextSibling);var n=$c;t&&ZL(e,t)?kW(n,r):(e.flags=e.flags&-4097|2,Gs=!1,$c=e)}}else{if(Wk(e))throw Error(Yr(418));e.flags=e.flags&-4097|2,Gs=!1,$c=e}}}function eF(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;$c=e}function O2(e){if(e!==$c)return!1;if(!Gs)return eF(e),Gs=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!qk(e.type,e.memoizedProps)),t&&(t=Oc)){if(Wk(e))throw IW(),Error(Yr(418));for(;t;)kW(e,t),t=ch(t.nextSibling)}if(eF(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Yr(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Oc=ch(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Oc=null}}else Oc=$c?ch(e.stateNode.nextSibling):null;return!0}function IW(){for(var e=Oc;e;)e=ch(e.nextSibling)}function Sx(){Oc=$c=null,Gs=!1}function V3(e){nu===null?nu=[e]:nu.push(e)}var nce=om.ReactCurrentBatchConfig;function iy(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Yr(309));var n=r.stateNode}if(!n)throw Error(Yr(147,e));var s=n,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(i){var l=s.refs;i===null?delete l[o]:l[o]=i},t._stringRef=o,t)}if(typeof e!="string")throw Error(Yr(284));if(!r._owner)throw Error(Yr(290,e))}return e}function T2(e,t){throw e=Object.prototype.toString.call(t),Error(Yr(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function tF(e){var t=e._init;return t(e._payload)}function OW(e){function t(x,b){if(e){var w=x.deletions;w===null?(x.deletions=[b],x.flags|=16):w.push(b)}}function r(x,b){if(!e)return null;for(;b!==null;)t(x,b),b=b.sibling;return null}function n(x,b){for(x=new Map;b!==null;)b.key!==null?x.set(b.key,b):x.set(b.index,b),b=b.sibling;return x}function s(x,b){return x=mh(x,b),x.index=0,x.sibling=null,x}function o(x,b,w){return x.index=w,e?(w=x.alternate,w!==null?(w=w.index,w<b?(x.flags|=2,b):w):(x.flags|=2,b)):(x.flags|=1048576,b)}function i(x){return e&&x.alternate===null&&(x.flags|=2),x}function l(x,b,w,j){return b===null||b.tag!==6?(b=tA(w,x.mode,j),b.return=x,b):(b=s(b,w),b.return=x,b)}function c(x,b,w,j){var _=w.type;return _===Tv?u(x,b,w.props.children,j,w.key):b!==null&&(b.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Lm&&tF(_)===b.type)?(j=s(b,w.props),j.ref=iy(x,b,w),j.return=x,j):(j=Qj(w.type,w.key,w.props,null,x.mode,j),j.ref=iy(x,b,w),j.return=x,j)}function d(x,b,w,j){return b===null||b.tag!==4||b.stateNode.containerInfo!==w.containerInfo||b.stateNode.implementation!==w.implementation?(b=rA(w,x.mode,j),b.return=x,b):(b=s(b,w.children||[]),b.return=x,b)}function u(x,b,w,j,_){return b===null||b.tag!==7?(b=Xp(w,x.mode,j,_),b.return=x,b):(b=s(b,w),b.return=x,b)}function f(x,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return b=tA(""+b,x.mode,w),b.return=x,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case j2:return w=Qj(b.type,b.key,b.props,null,x.mode,w),w.ref=iy(x,null,b),w.return=x,w;case Ov:return b=rA(b,x.mode,w),b.return=x,b;case Lm:var j=b._init;return f(x,j(b._payload),w)}if(Ry(b)||ry(b))return b=Xp(b,x.mode,w,null),b.return=x,b;T2(x,b)}return null}function h(x,b,w,j){var _=b!==null?b.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return _!==null?null:l(x,b,""+w,j);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case j2:return w.key===_?c(x,b,w,j):null;case Ov:return w.key===_?d(x,b,w,j):null;case Lm:return _=w._init,h(x,b,_(w._payload),j)}if(Ry(w)||ry(w))return _!==null?null:u(x,b,w,j,null);T2(x,w)}return null}function m(x,b,w,j,_){if(typeof j=="string"&&j!==""||typeof j=="number")return x=x.get(w)||null,l(b,x,""+j,_);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case j2:return x=x.get(j.key===null?w:j.key)||null,c(b,x,j,_);case Ov:return x=x.get(j.key===null?w:j.key)||null,d(b,x,j,_);case Lm:var S=j._init;return m(x,b,w,S(j._payload),_)}if(Ry(j)||ry(j))return x=x.get(w)||null,u(b,x,j,_,null);T2(b,j)}return null}function v(x,b,w,j){for(var _=null,S=null,C=b,P=b=0,A=null;C!==null&&P<w.length;P++){C.index>P?(A=C,C=null):A=C.sibling;var R=h(x,C,w[P],j);if(R===null){C===null&&(C=A);break}e&&C&&R.alternate===null&&t(x,C),b=o(R,b,P),S===null?_=R:S.sibling=R,S=R,C=A}if(P===w.length)return r(x,C),Gs&&vp(x,P),_;if(C===null){for(;P<w.length;P++)C=f(x,w[P],j),C!==null&&(b=o(C,b,P),S===null?_=C:S.sibling=C,S=C);return Gs&&vp(x,P),_}for(C=n(x,C);P<w.length;P++)A=m(C,x,P,w[P],j),A!==null&&(e&&A.alternate!==null&&C.delete(A.key===null?P:A.key),b=o(A,b,P),S===null?_=A:S.sibling=A,S=A);return e&&C.forEach(function(O){return t(x,O)}),Gs&&vp(x,P),_}function g(x,b,w,j){var _=ry(w);if(typeof _!="function")throw Error(Yr(150));if(w=_.call(w),w==null)throw Error(Yr(151));for(var S=_=null,C=b,P=b=0,A=null,R=w.next();C!==null&&!R.done;P++,R=w.next()){C.index>P?(A=C,C=null):A=C.sibling;var O=h(x,C,R.value,j);if(O===null){C===null&&(C=A);break}e&&C&&O.alternate===null&&t(x,C),b=o(O,b,P),S===null?_=O:S.sibling=O,S=O,C=A}if(R.done)return r(x,C),Gs&&vp(x,P),_;if(C===null){for(;!R.done;P++,R=w.next())R=f(x,R.value,j),R!==null&&(b=o(R,b,P),S===null?_=R:S.sibling=R,S=R);return Gs&&vp(x,P),_}for(C=n(x,C);!R.done;P++,R=w.next())R=m(C,x,P,R.value,j),R!==null&&(e&&R.alternate!==null&&C.delete(R.key===null?P:R.key),b=o(R,b,P),S===null?_=R:S.sibling=R,S=R);return e&&C.forEach(function(I){return t(x,I)}),Gs&&vp(x,P),_}function y(x,b,w,j){if(typeof w=="object"&&w!==null&&w.type===Tv&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case j2:e:{for(var _=w.key,S=b;S!==null;){if(S.key===_){if(_=w.type,_===Tv){if(S.tag===7){r(x,S.sibling),b=s(S,w.props.children),b.return=x,x=b;break e}}else if(S.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Lm&&tF(_)===S.type){r(x,S.sibling),b=s(S,w.props),b.ref=iy(x,S,w),b.return=x,x=b;break e}r(x,S);break}else t(x,S);S=S.sibling}w.type===Tv?(b=Xp(w.props.children,x.mode,j,w.key),b.return=x,x=b):(j=Qj(w.type,w.key,w.props,null,x.mode,j),j.ref=iy(x,b,w),j.return=x,x=j)}return i(x);case Ov:e:{for(S=w.key;b!==null;){if(b.key===S)if(b.tag===4&&b.stateNode.containerInfo===w.containerInfo&&b.stateNode.implementation===w.implementation){r(x,b.sibling),b=s(b,w.children||[]),b.return=x,x=b;break e}else{r(x,b);break}else t(x,b);b=b.sibling}b=rA(w,x.mode,j),b.return=x,x=b}return i(x);case Lm:return S=w._init,y(x,b,S(w._payload),j)}if(Ry(w))return v(x,b,w,j);if(ry(w))return g(x,b,w,j);T2(x,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,b!==null&&b.tag===6?(r(x,b.sibling),b=s(b,w),b.return=x,x=b):(r(x,b),b=tA(w,x.mode,j),b.return=x,x=b),i(x)):r(x,b)}return y}var Cx=OW(!0),TW=OW(!1),T_=Uh(null),D_=null,qv=null,W3=null;function H3(){W3=qv=D_=null}function G3(e){var t=T_.current;$s(T_),e._currentValue=t}function Gk(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function ox(e,t){D_=e,W3=qv=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ec=!0),e.firstContext=null)}function Id(e){var t=e._currentValue;if(W3!==e)if(e={context:e,memoizedValue:t,next:null},qv===null){if(D_===null)throw Error(Yr(308));qv=e,D_.dependencies={lanes:0,firstContext:e}}else qv=qv.next=e;return t}var Tp=null;function K3(e){Tp===null?Tp=[e]:Tp.push(e)}function DW(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,K3(t)):(r.next=s.next,s.next=r),t.interleaved=r,Gf(e,n)}function Gf(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Fm=!1;function X3(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function MW(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Bf(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function dh(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ha&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,Gf(e,r)}return s=n.interleaved,s===null?(t.next=t,K3(n)):(t.next=s.next,s.next=t),n.interleaved=t,Gf(e,r)}function Hj(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,D3(e,r)}}function rF(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?s=o=i:o=o.next=i,r=r.next}while(r!==null);o===null?s=o=t:o=o.next=t}else s=o=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function M_(e,t,r,n){var s=e.updateQueue;Fm=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,d=c.next;c.next=null,i===null?o=d:i.next=d,i=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==i&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(o!==null){var f=s.baseState;i=0,u=d=c=null,l=o;do{var h=l.lane,m=l.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=e,g=l;switch(h=t,m=r,g.tag){case 1:if(v=g.payload,typeof v=="function"){f=v.call(m,f,h);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=g.payload,h=typeof v=="function"?v.call(m,f,h):v,h==null)break e;f=no({},f,h);break e;case 2:Fm=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=s.effects,h===null?s.effects=[l]:h.push(l))}else m={eventTime:m,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=m,c=f):u=u.next=m,i|=h;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;h=l,l=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(1);if(u===null&&(c=f),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=u,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else o===null&&(s.shared.lanes=0);fg|=i,e.lanes=i,e.memoizedState=f}}function nF(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(Yr(191,s));s.call(n)}}}var x1={},Yu=Uh(x1),Gb=Uh(x1),Kb=Uh(x1);function Dp(e){if(e===x1)throw Error(Yr(174));return e}function Y3(e,t){switch(Ss(Kb,t),Ss(Gb,e),Ss(Yu,x1),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Pk(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Pk(t,e)}$s(Yu),Ss(Yu,t)}function Px(){$s(Yu),$s(Gb),$s(Kb)}function RW(e){Dp(Kb.current);var t=Dp(Yu.current),r=Pk(t,e.type);t!==r&&(Ss(Gb,e),Ss(Yu,r))}function J3(e){Gb.current===e&&($s(Yu),$s(Gb))}var Qs=Uh(0);function R_(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var XP=[];function Q3(){for(var e=0;e<XP.length;e++)XP[e]._workInProgressVersionPrimary=null;XP.length=0}var Gj=om.ReactCurrentDispatcher,YP=om.ReactCurrentBatchConfig,ug=0,to=null,Jo=null,hi=null,L_=!1,Jy=!1,Xb=0,ace=0;function Hi(){throw Error(Yr(321))}function Z3(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!hu(e[r],t[r]))return!1;return!0}function e4(e,t,r,n,s,o){if(ug=o,to=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Gj.current=e===null||e.memoizedState===null?lce:cce,e=r(n,s),Jy){o=0;do{if(Jy=!1,Xb=0,25<=o)throw Error(Yr(301));o+=1,hi=Jo=null,t.updateQueue=null,Gj.current=dce,e=r(n,s)}while(Jy)}if(Gj.current=F_,t=Jo!==null&&Jo.next!==null,ug=0,hi=Jo=to=null,L_=!1,t)throw Error(Yr(300));return e}function t4(){var e=Xb!==0;return Xb=0,e}function Ru(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return hi===null?to.memoizedState=hi=e:hi=hi.next=e,hi}function Od(){if(Jo===null){var e=to.alternate;e=e!==null?e.memoizedState:null}else e=Jo.next;var t=hi===null?to.memoizedState:hi.next;if(t!==null)hi=t,Jo=e;else{if(e===null)throw Error(Yr(310));Jo=e,e={memoizedState:Jo.memoizedState,baseState:Jo.baseState,baseQueue:Jo.baseQueue,queue:Jo.queue,next:null},hi===null?to.memoizedState=hi=e:hi=hi.next=e}return hi}function Yb(e,t){return typeof t=="function"?t(e):t}function JP(e){var t=Od(),r=t.queue;if(r===null)throw Error(Yr(311));r.lastRenderedReducer=e;var n=Jo,s=n.baseQueue,o=r.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}n.baseQueue=s=o,r.pending=null}if(s!==null){o=s.next,n=n.baseState;var l=i=null,c=null,d=o;do{var u=d.lane;if((ug&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var f={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=f,i=n):c=c.next=f,to.lanes|=u,fg|=u}d=d.next}while(d!==null&&d!==o);c===null?i=n:c.next=l,hu(n,t.memoizedState)||(ec=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do o=s.lane,to.lanes|=o,fg|=o,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function QP(e){var t=Od(),r=t.queue;if(r===null)throw Error(Yr(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,o=t.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do o=e(o,i.action),i=i.next;while(i!==s);hu(o,t.memoizedState)||(ec=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),r.lastRenderedState=o}return[o,n]}function LW(){}function FW(e,t){var r=to,n=Od(),s=t(),o=!hu(n.memoizedState,s);if(o&&(n.memoizedState=s,ec=!0),n=n.queue,r4(qW.bind(null,r,n,e),[e]),n.getSnapshot!==t||o||hi!==null&&hi.memoizedState.tag&1){if(r.flags|=2048,Jb(9,BW.bind(null,r,n,s,t),void 0,null),bi===null)throw Error(Yr(349));ug&30||$W(r,t,s)}return s}function $W(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=to.updateQueue,t===null?(t={lastEffect:null,stores:null},to.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function BW(e,t,r,n){t.value=r,t.getSnapshot=n,zW(t)&&UW(e)}function qW(e,t,r){return r(function(){zW(t)&&UW(e)})}function zW(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!hu(e,r)}catch{return!0}}function UW(e){var t=Gf(e,1);t!==null&&du(t,e,1,-1)}function aF(e){var t=Ru();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Yb,lastRenderedState:e},t.queue=e,e=e.dispatch=ice.bind(null,to,e),[t.memoizedState,e]}function Jb(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=to.updateQueue,t===null?(t={lastEffect:null,stores:null},to.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function VW(){return Od().memoizedState}function Kj(e,t,r,n){var s=Ru();to.flags|=e,s.memoizedState=Jb(1|t,r,void 0,n===void 0?null:n)}function rC(e,t,r,n){var s=Od();n=n===void 0?null:n;var o=void 0;if(Jo!==null){var i=Jo.memoizedState;if(o=i.destroy,n!==null&&Z3(n,i.deps)){s.memoizedState=Jb(t,r,o,n);return}}to.flags|=e,s.memoizedState=Jb(1|t,r,o,n)}function sF(e,t){return Kj(8390656,8,e,t)}function r4(e,t){return rC(2048,8,e,t)}function WW(e,t){return rC(4,2,e,t)}function HW(e,t){return rC(4,4,e,t)}function GW(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function KW(e,t,r){return r=r!=null?r.concat([e]):null,rC(4,4,GW.bind(null,t,e),r)}function n4(){}function XW(e,t){var r=Od();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Z3(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function YW(e,t){var r=Od();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Z3(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function JW(e,t,r){return ug&21?(hu(r,t)||(r=rW(),to.lanes|=r,fg|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ec=!0),e.memoizedState=r)}function sce(e,t){var r=ls;ls=r!==0&&4>r?r:4,e(!0);var n=YP.transition;YP.transition={};try{e(!1),t()}finally{ls=r,YP.transition=n}}function QW(){return Od().memoizedState}function oce(e,t,r){var n=fh(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},ZW(e))eH(t,r);else if(r=DW(e,t,r,n),r!==null){var s=Ol();du(r,e,n,s),tH(r,t,n)}}function ice(e,t,r){var n=fh(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(ZW(e))eH(t,s);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var i=t.lastRenderedState,l=o(i,r);if(s.hasEagerState=!0,s.eagerState=l,hu(l,i)){var c=t.interleaved;c===null?(s.next=s,K3(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=DW(e,t,s,n),r!==null&&(s=Ol(),du(r,e,n,s),tH(r,t,n))}}function ZW(e){var t=e.alternate;return e===to||t!==null&&t===to}function eH(e,t){Jy=L_=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function tH(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,D3(e,r)}}var F_={readContext:Id,useCallback:Hi,useContext:Hi,useEffect:Hi,useImperativeHandle:Hi,useInsertionEffect:Hi,useLayoutEffect:Hi,useMemo:Hi,useReducer:Hi,useRef:Hi,useState:Hi,useDebugValue:Hi,useDeferredValue:Hi,useTransition:Hi,useMutableSource:Hi,useSyncExternalStore:Hi,useId:Hi,unstable_isNewReconciler:!1},lce={readContext:Id,useCallback:function(e,t){return Ru().memoizedState=[e,t===void 0?null:t],e},useContext:Id,useEffect:sF,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Kj(4194308,4,GW.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Kj(4194308,4,e,t)},useInsertionEffect:function(e,t){return Kj(4,2,e,t)},useMemo:function(e,t){var r=Ru();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Ru();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=oce.bind(null,to,e),[n.memoizedState,e]},useRef:function(e){var t=Ru();return e={current:e},t.memoizedState=e},useState:aF,useDebugValue:n4,useDeferredValue:function(e){return Ru().memoizedState=e},useTransition:function(){var e=aF(!1),t=e[0];return e=sce.bind(null,e[1]),Ru().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=to,s=Ru();if(Gs){if(r===void 0)throw Error(Yr(407));r=r()}else{if(r=t(),bi===null)throw Error(Yr(349));ug&30||$W(n,t,r)}s.memoizedState=r;var o={value:r,getSnapshot:t};return s.queue=o,sF(qW.bind(null,n,o,e),[e]),n.flags|=2048,Jb(9,BW.bind(null,n,o,r,t),void 0,null),r},useId:function(){var e=Ru(),t=bi.identifierPrefix;if(Gs){var r=Df,n=Tf;r=(n&~(1<<32-cu(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Xb++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=ace++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},cce={readContext:Id,useCallback:XW,useContext:Id,useEffect:r4,useImperativeHandle:KW,useInsertionEffect:WW,useLayoutEffect:HW,useMemo:YW,useReducer:JP,useRef:VW,useState:function(){return JP(Yb)},useDebugValue:n4,useDeferredValue:function(e){var t=Od();return JW(t,Jo.memoizedState,e)},useTransition:function(){var e=JP(Yb)[0],t=Od().memoizedState;return[e,t]},useMutableSource:LW,useSyncExternalStore:FW,useId:QW,unstable_isNewReconciler:!1},dce={readContext:Id,useCallback:XW,useContext:Id,useEffect:r4,useImperativeHandle:KW,useInsertionEffect:WW,useLayoutEffect:HW,useMemo:YW,useReducer:QP,useRef:VW,useState:function(){return QP(Yb)},useDebugValue:n4,useDeferredValue:function(e){var t=Od();return Jo===null?t.memoizedState=e:JW(t,Jo.memoizedState,e)},useTransition:function(){var e=QP(Yb)[0],t=Od().memoizedState;return[e,t]},useMutableSource:LW,useSyncExternalStore:FW,useId:QW,unstable_isNewReconciler:!1};function Qd(e,t){if(e&&e.defaultProps){t=no({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Kk(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:no({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var nC={isMounted:function(e){return(e=e._reactInternals)?Ig(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Ol(),s=fh(e),o=Bf(n,s);o.payload=t,r!=null&&(o.callback=r),t=dh(e,o,s),t!==null&&(du(t,e,s,n),Hj(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Ol(),s=fh(e),o=Bf(n,s);o.tag=1,o.payload=t,r!=null&&(o.callback=r),t=dh(e,o,s),t!==null&&(du(t,e,s,n),Hj(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ol(),n=fh(e),s=Bf(r,n);s.tag=2,t!=null&&(s.callback=t),t=dh(e,s,n),t!==null&&(du(t,e,n,r),Hj(t,e,n))}};function oF(e,t,r,n,s,o,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,o,i):t.prototype&&t.prototype.isPureReactComponent?!Ub(r,n)||!Ub(s,o):!0}function rH(e,t,r){var n=!1,s=kh,o=t.contextType;return typeof o=="object"&&o!==null?o=Id(o):(s=sc(t)?cg:sl.current,n=t.contextTypes,o=(n=n!=null)?Nx(e,s):kh),t=new t(r,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=nC,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=o),t}function iF(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&nC.enqueueReplaceState(t,t.state,null)}function Xk(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},X3(e);var o=t.contextType;typeof o=="object"&&o!==null?s.context=Id(o):(o=sc(t)?cg:sl.current,s.context=Nx(e,o)),s.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(Kk(e,t,o,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&nC.enqueueReplaceState(s,s.state,null),M_(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Ax(e,t){try{var r="",n=t;do r+=Fie(n),n=n.return;while(n);var s=r}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:s,digest:null}}function ZP(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Yk(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var uce=typeof WeakMap=="function"?WeakMap:Map;function nH(e,t,r){r=Bf(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){B_||(B_=!0,oI=n),Yk(e,t)},r}function aH(e,t,r){r=Bf(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){Yk(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){Yk(e,t),typeof n!="function"&&(uh===null?uh=new Set([this]):uh.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function lF(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new uce;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=Sce.bind(null,e,t,r),t.then(e,e))}function cF(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function dF(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Bf(-1,1),t.tag=2,dh(r,t,1))),r.lanes|=1),e)}var fce=om.ReactCurrentOwner,ec=!1;function Sl(e,t,r,n){t.child=e===null?TW(t,null,r,n):Cx(t,e.child,r,n)}function uF(e,t,r,n,s){r=r.render;var o=t.ref;return ox(t,s),n=e4(e,t,r,n,o,s),r=t4(),e!==null&&!ec?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Kf(e,t,s)):(Gs&&r&&z3(t),t.flags|=1,Sl(e,t,n,s),t.child)}function fF(e,t,r,n,s){if(e===null){var o=r.type;return typeof o=="function"&&!u4(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=o,sH(e,t,o,n,s)):(e=Qj(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&s)){var i=o.memoizedProps;if(r=r.compare,r=r!==null?r:Ub,r(i,n)&&e.ref===t.ref)return Kf(e,t,s)}return t.flags|=1,e=mh(o,n),e.ref=t.ref,e.return=t,t.child=e}function sH(e,t,r,n,s){if(e!==null){var o=e.memoizedProps;if(Ub(o,n)&&e.ref===t.ref)if(ec=!1,t.pendingProps=n=o,(e.lanes&s)!==0)e.flags&131072&&(ec=!0);else return t.lanes=e.lanes,Kf(e,t,s)}return Jk(e,t,r,n,s)}function oH(e,t,r){var n=t.pendingProps,s=n.children,o=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ss(Uv,Pc),Pc|=r;else{if(!(r&1073741824))return e=o!==null?o.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ss(Uv,Pc),Pc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=o!==null?o.baseLanes:r,Ss(Uv,Pc),Pc|=n}else o!==null?(n=o.baseLanes|r,t.memoizedState=null):n=r,Ss(Uv,Pc),Pc|=n;return Sl(e,t,s,r),t.child}function iH(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Jk(e,t,r,n,s){var o=sc(r)?cg:sl.current;return o=Nx(t,o),ox(t,s),r=e4(e,t,r,n,o,s),n=t4(),e!==null&&!ec?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Kf(e,t,s)):(Gs&&n&&z3(t),t.flags|=1,Sl(e,t,r,s),t.child)}function mF(e,t,r,n,s){if(sc(r)){var o=!0;k_(t)}else o=!1;if(ox(t,s),t.stateNode===null)Xj(e,t),rH(t,r,n),Xk(t,r,n,s),n=!0;else if(e===null){var i=t.stateNode,l=t.memoizedProps;i.props=l;var c=i.context,d=r.contextType;typeof d=="object"&&d!==null?d=Id(d):(d=sc(r)?cg:sl.current,d=Nx(t,d));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";f||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==n||c!==d)&&iF(t,i,n,d),Fm=!1;var h=t.memoizedState;i.state=h,M_(t,n,i,s),c=t.memoizedState,l!==n||h!==c||ac.current||Fm?(typeof u=="function"&&(Kk(t,r,u,n),c=t.memoizedState),(l=Fm||oF(t,r,l,n,h,c,d))?(f||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),i.props=n,i.state=c,i.context=d,n=l):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,MW(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:Qd(t.type,l),i.props=d,f=t.pendingProps,h=i.context,c=r.contextType,typeof c=="object"&&c!==null?c=Id(c):(c=sc(r)?cg:sl.current,c=Nx(t,c));var m=r.getDerivedStateFromProps;(u=typeof m=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==f||h!==c)&&iF(t,i,n,c),Fm=!1,h=t.memoizedState,i.state=h,M_(t,n,i,s);var v=t.memoizedState;l!==f||h!==v||ac.current||Fm?(typeof m=="function"&&(Kk(t,r,m,n),v=t.memoizedState),(d=Fm||oF(t,r,d,n,h,v,c)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,v,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,v,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),i.props=n,i.state=v,i.context=c,n=d):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Qk(e,t,r,n,o,s)}function Qk(e,t,r,n,s,o){iH(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return s&&QL(t,r,!1),Kf(e,t,o);n=t.stateNode,fce.current=t;var l=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=Cx(t,e.child,null,o),t.child=Cx(t,null,l,o)):Sl(e,t,l,o),t.memoizedState=n.state,s&&QL(t,r,!0),t.child}function lH(e){var t=e.stateNode;t.pendingContext?JL(e,t.pendingContext,t.pendingContext!==t.context):t.context&&JL(e,t.context,!1),Y3(e,t.containerInfo)}function hF(e,t,r,n,s){return Sx(),V3(s),t.flags|=256,Sl(e,t,r,n),t.child}var Zk={dehydrated:null,treeContext:null,retryLane:0};function eI(e){return{baseLanes:e,cachePool:null,transitions:null}}function cH(e,t,r){var n=t.pendingProps,s=Qs.current,o=!1,i=(t.flags&128)!==0,l;if((l=i)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Ss(Qs,s&1),e===null)return Hk(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,o?(n=t.mode,o=t.child,i={mode:"hidden",children:i},!(n&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=oC(i,n,0,null),e=Xp(e,n,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=eI(r),t.memoizedState=Zk,e):a4(t,i));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return mce(e,t,i,n,l,s,r);if(o){o=n.fallback,i=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(i&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=mh(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?o=mh(l,o):(o=Xp(o,i,r,null),o.flags|=2),o.return=t,n.return=t,n.sibling=o,t.child=n,n=o,o=t.child,i=e.child.memoizedState,i=i===null?eI(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=e.childLanes&~r,t.memoizedState=Zk,n}return o=e.child,e=o.sibling,n=mh(o,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function a4(e,t){return t=oC({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function D2(e,t,r,n){return n!==null&&V3(n),Cx(t,e.child,null,r),e=a4(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function mce(e,t,r,n,s,o,i){if(r)return t.flags&256?(t.flags&=-257,n=ZP(Error(Yr(422))),D2(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=n.fallback,s=t.mode,n=oC({mode:"visible",children:n.children},s,0,null),o=Xp(o,s,i,null),o.flags|=2,n.return=t,o.return=t,n.sibling=o,t.child=n,t.mode&1&&Cx(t,e.child,null,i),t.child.memoizedState=eI(i),t.memoizedState=Zk,o);if(!(t.mode&1))return D2(e,t,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,o=Error(Yr(419)),n=ZP(o,n,void 0),D2(e,t,i,n)}if(l=(i&e.childLanes)!==0,ec||l){if(n=bi,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,Gf(e,s),du(n,e,s,-1))}return d4(),n=ZP(Error(Yr(421))),D2(e,t,i,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=Cce.bind(null,e),s._reactRetry=t,null):(e=o.treeContext,Oc=ch(s.nextSibling),$c=t,Gs=!0,nu=null,e!==null&&(ud[fd++]=Tf,ud[fd++]=Df,ud[fd++]=dg,Tf=e.id,Df=e.overflow,dg=t),t=a4(t,n.children),t.flags|=4096,t)}function pF(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Gk(e.return,t,r)}function eA(e,t,r,n,s){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=s)}function dH(e,t,r){var n=t.pendingProps,s=n.revealOrder,o=n.tail;if(Sl(e,t,n.children,r),n=Qs.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&pF(e,r,t);else if(e.tag===19)pF(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Ss(Qs,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&R_(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),eA(t,!1,s,r,o);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&R_(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}eA(t,!0,r,null,o);break;case"together":eA(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Xj(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Kf(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),fg|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Yr(153));if(t.child!==null){for(e=t.child,r=mh(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=mh(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function hce(e,t,r){switch(t.tag){case 3:lH(t),Sx();break;case 5:RW(t);break;case 1:sc(t.type)&&k_(t);break;case 4:Y3(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;Ss(T_,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Ss(Qs,Qs.current&1),t.flags|=128,null):r&t.child.childLanes?cH(e,t,r):(Ss(Qs,Qs.current&1),e=Kf(e,t,r),e!==null?e.sibling:null);Ss(Qs,Qs.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return dH(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ss(Qs,Qs.current),n)break;return null;case 22:case 23:return t.lanes=0,oH(e,t,r)}return Kf(e,t,r)}var uH,tI,fH,mH;uH=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};tI=function(){};fH=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,Dp(Yu.current);var o=null;switch(r){case"input":s=_k(e,s),n=_k(e,n),o=[];break;case"select":s=no({},s,{value:void 0}),n=no({},n,{value:void 0}),o=[];break;case"textarea":s=Ck(e,s),n=Ck(e,n),o=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=A_)}Ak(r,n);var i;r=null;for(d in s)if(!n.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(i in l)l.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Rb.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in n){var c=n[d];if(l=s?.[d],n.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(o||(o=[]),o.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(o=o||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Rb.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Ms("scroll",e),o||l===c||(o=[])):(o=o||[]).push(d,c))}r&&(o=o||[]).push("style",r);var d=o;(t.updateQueue=d)&&(t.flags|=4)}};mH=function(e,t,r,n){r!==n&&(t.flags|=4)};function ly(e,t){if(!Gs)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Gi(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function pce(e,t,r){var n=t.pendingProps;switch(U3(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gi(t),null;case 1:return sc(t.type)&&E_(),Gi(t),null;case 3:return n=t.stateNode,Px(),$s(ac),$s(sl),Q3(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(O2(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,nu!==null&&(cI(nu),nu=null))),tI(e,t),Gi(t),null;case 5:J3(t);var s=Dp(Kb.current);if(r=t.type,e!==null&&t.stateNode!=null)fH(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Yr(166));return Gi(t),null}if(e=Dp(Yu.current),O2(t)){n=t.stateNode,r=t.type;var o=t.memoizedProps;switch(n[Fu]=t,n[Hb]=o,e=(t.mode&1)!==0,r){case"dialog":Ms("cancel",n),Ms("close",n);break;case"iframe":case"object":case"embed":Ms("load",n);break;case"video":case"audio":for(s=0;s<Fy.length;s++)Ms(Fy[s],n);break;case"source":Ms("error",n);break;case"img":case"image":case"link":Ms("error",n),Ms("load",n);break;case"details":Ms("toggle",n);break;case"input":NL(n,o),Ms("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},Ms("invalid",n);break;case"textarea":CL(n,o),Ms("invalid",n)}Ak(r,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="children"?typeof l=="string"?n.textContent!==l&&(o.suppressHydrationWarning!==!0&&I2(n.textContent,l,e),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&I2(n.textContent,l,e),s=["children",""+l]):Rb.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&Ms("scroll",n)}switch(r){case"input":_2(n),SL(n,o,!0);break;case"textarea":_2(n),PL(n);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(n.onclick=A_)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=qV(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[Fu]=t,e[Hb]=n,uH(e,t,!1,!1),t.stateNode=e;e:{switch(i=Ek(r,n),r){case"dialog":Ms("cancel",e),Ms("close",e),s=n;break;case"iframe":case"object":case"embed":Ms("load",e),s=n;break;case"video":case"audio":for(s=0;s<Fy.length;s++)Ms(Fy[s],e);s=n;break;case"source":Ms("error",e),s=n;break;case"img":case"image":case"link":Ms("error",e),Ms("load",e),s=n;break;case"details":Ms("toggle",e),s=n;break;case"input":NL(e,n),s=_k(e,n),Ms("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=no({},n,{value:void 0}),Ms("invalid",e);break;case"textarea":CL(e,n),s=Ck(e,n),Ms("invalid",e);break;default:s=n}Ak(r,s),l=s;for(o in l)if(l.hasOwnProperty(o)){var c=l[o];o==="style"?VV(e,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&zV(e,c)):o==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Lb(e,c):typeof c=="number"&&Lb(e,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Rb.hasOwnProperty(o)?c!=null&&o==="onScroll"&&Ms("scroll",e):c!=null&&A3(e,o,c,i))}switch(r){case"input":_2(e),SL(e,n,!1);break;case"textarea":_2(e),PL(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Eh(n.value));break;case"select":e.multiple=!!n.multiple,o=n.value,o!=null?rx(e,!!n.multiple,o,!1):n.defaultValue!=null&&rx(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=A_)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Gi(t),null;case 6:if(e&&t.stateNode!=null)mH(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Yr(166));if(r=Dp(Kb.current),Dp(Yu.current),O2(t)){if(n=t.stateNode,r=t.memoizedProps,n[Fu]=t,(o=n.nodeValue!==r)&&(e=$c,e!==null))switch(e.tag){case 3:I2(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&I2(n.nodeValue,r,(e.mode&1)!==0)}o&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Fu]=t,t.stateNode=n}return Gi(t),null;case 13:if($s(Qs),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Gs&&Oc!==null&&t.mode&1&&!(t.flags&128))IW(),Sx(),t.flags|=98560,o=!1;else if(o=O2(t),n!==null&&n.dehydrated!==null){if(e===null){if(!o)throw Error(Yr(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(Yr(317));o[Fu]=t}else Sx(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Gi(t),o=!1}else nu!==null&&(cI(nu),nu=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Qs.current&1?ri===0&&(ri=3):d4())),t.updateQueue!==null&&(t.flags|=4),Gi(t),null);case 4:return Px(),tI(e,t),e===null&&Vb(t.stateNode.containerInfo),Gi(t),null;case 10:return G3(t.type._context),Gi(t),null;case 17:return sc(t.type)&&E_(),Gi(t),null;case 19:if($s(Qs),o=t.memoizedState,o===null)return Gi(t),null;if(n=(t.flags&128)!==0,i=o.rendering,i===null)if(n)ly(o,!1);else{if(ri!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=R_(e),i!==null){for(t.flags|=128,ly(o,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)o=r,e=n,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,e=i.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ss(Qs,Qs.current&1|2),t.child}e=e.sibling}o.tail!==null&&wo()>Ex&&(t.flags|=128,n=!0,ly(o,!1),t.lanes=4194304)}else{if(!n)if(e=R_(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),ly(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!Gs)return Gi(t),null}else 2*wo()-o.renderingStartTime>Ex&&r!==1073741824&&(t.flags|=128,n=!0,ly(o,!1),t.lanes=4194304);o.isBackwards?(i.sibling=t.child,t.child=i):(r=o.last,r!==null?r.sibling=i:t.child=i,o.last=i)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=wo(),t.sibling=null,r=Qs.current,Ss(Qs,n?r&1|2:r&1),t):(Gi(t),null);case 22:case 23:return c4(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Pc&1073741824&&(Gi(t),t.subtreeFlags&6&&(t.flags|=8192)):Gi(t),null;case 24:return null;case 25:return null}throw Error(Yr(156,t.tag))}function gce(e,t){switch(U3(t),t.tag){case 1:return sc(t.type)&&E_(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Px(),$s(ac),$s(sl),Q3(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return J3(t),null;case 13:if($s(Qs),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Yr(340));Sx()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return $s(Qs),null;case 4:return Px(),null;case 10:return G3(t.type._context),null;case 22:case 23:return c4(),null;case 24:return null;default:return null}}var M2=!1,el=!1,vce=typeof WeakSet=="function"?WeakSet:Set,Sn=null;function zv(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){co(e,t,n)}else r.current=null}function rI(e,t,r){try{r()}catch(n){co(e,t,n)}}var gF=!1;function xce(e,t){if($k=S_,e=xW(),q3(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{r.nodeType,o.nodeType}catch{r=null;break e}var i=0,l=-1,c=-1,d=0,u=0,f=e,h=null;t:for(;;){for(var m;f!==r||s!==0&&f.nodeType!==3||(l=i+s),f!==o||n!==0&&f.nodeType!==3||(c=i+n),f.nodeType===3&&(i+=f.nodeValue.length),(m=f.firstChild)!==null;)h=f,f=m;for(;;){if(f===e)break t;if(h===r&&++d===s&&(l=i),h===o&&++u===n&&(c=i),(m=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=m}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Bk={focusedElem:e,selectionRange:r},S_=!1,Sn=t;Sn!==null;)if(t=Sn,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Sn=e;else for(;Sn!==null;){t=Sn;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var g=v.memoizedProps,y=v.memoizedState,x=t.stateNode,b=x.getSnapshotBeforeUpdate(t.elementType===t.type?g:Qd(t.type,g),y);x.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Yr(163))}}catch(j){co(t,t.return,j)}if(e=t.sibling,e!==null){e.return=t.return,Sn=e;break}Sn=t.return}return v=gF,gF=!1,v}function Qy(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var o=s.destroy;s.destroy=void 0,o!==void 0&&rI(t,r,o)}s=s.next}while(s!==n)}}function aC(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function nI(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function hH(e){var t=e.alternate;t!==null&&(e.alternate=null,hH(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Fu],delete t[Hb],delete t[Uk],delete t[ece],delete t[tce])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function pH(e){return e.tag===5||e.tag===3||e.tag===4}function vF(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||pH(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function aI(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=A_));else if(n!==4&&(e=e.child,e!==null))for(aI(e,t,r),e=e.sibling;e!==null;)aI(e,t,r),e=e.sibling}function sI(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(sI(e,t,r),e=e.sibling;e!==null;)sI(e,t,r),e=e.sibling}var Ri=null,Zd=!1;function _m(e,t,r){for(r=r.child;r!==null;)gH(e,t,r),r=r.sibling}function gH(e,t,r){if(Xu&&typeof Xu.onCommitFiberUnmount=="function")try{Xu.onCommitFiberUnmount(YS,r)}catch{}switch(r.tag){case 5:el||zv(r,t);case 6:var n=Ri,s=Zd;Ri=null,_m(e,t,r),Ri=n,Zd=s,Ri!==null&&(Zd?(e=Ri,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Ri.removeChild(r.stateNode));break;case 18:Ri!==null&&(Zd?(e=Ri,r=r.stateNode,e.nodeType===8?GP(e.parentNode,r):e.nodeType===1&&GP(e,r),qb(e)):GP(Ri,r.stateNode));break;case 4:n=Ri,s=Zd,Ri=r.stateNode.containerInfo,Zd=!0,_m(e,t,r),Ri=n,Zd=s;break;case 0:case 11:case 14:case 15:if(!el&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&rI(r,t,i),s=s.next}while(s!==n)}_m(e,t,r);break;case 1:if(!el&&(zv(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){co(r,t,l)}_m(e,t,r);break;case 21:_m(e,t,r);break;case 22:r.mode&1?(el=(n=el)||r.memoizedState!==null,_m(e,t,r),el=n):_m(e,t,r);break;default:_m(e,t,r)}}function xF(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new vce),t.forEach(function(n){var s=Pce.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Wd(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var o=e,i=t,l=i;e:for(;l!==null;){switch(l.tag){case 5:Ri=l.stateNode,Zd=!1;break e;case 3:Ri=l.stateNode.containerInfo,Zd=!0;break e;case 4:Ri=l.stateNode.containerInfo,Zd=!0;break e}l=l.return}if(Ri===null)throw Error(Yr(160));gH(o,i,s),Ri=null,Zd=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){co(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)vH(t,e),t=t.sibling}function vH(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Wd(t,e),ku(e),n&4){try{Qy(3,e,e.return),aC(3,e)}catch(g){co(e,e.return,g)}try{Qy(5,e,e.return)}catch(g){co(e,e.return,g)}}break;case 1:Wd(t,e),ku(e),n&512&&r!==null&&zv(r,r.return);break;case 5:if(Wd(t,e),ku(e),n&512&&r!==null&&zv(r,r.return),e.flags&32){var s=e.stateNode;try{Lb(s,"")}catch(g){co(e,e.return,g)}}if(n&4&&(s=e.stateNode,s!=null)){var o=e.memoizedProps,i=r!==null?r.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&$V(s,o),Ek(l,i);var d=Ek(l,o);for(i=0;i<c.length;i+=2){var u=c[i],f=c[i+1];u==="style"?VV(s,f):u==="dangerouslySetInnerHTML"?zV(s,f):u==="children"?Lb(s,f):A3(s,u,f,d)}switch(l){case"input":Nk(s,o);break;case"textarea":BV(s,o);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var m=o.value;m!=null?rx(s,!!o.multiple,m,!1):h!==!!o.multiple&&(o.defaultValue!=null?rx(s,!!o.multiple,o.defaultValue,!0):rx(s,!!o.multiple,o.multiple?[]:"",!1))}s[Hb]=o}catch(g){co(e,e.return,g)}}break;case 6:if(Wd(t,e),ku(e),n&4){if(e.stateNode===null)throw Error(Yr(162));s=e.stateNode,o=e.memoizedProps;try{s.nodeValue=o}catch(g){co(e,e.return,g)}}break;case 3:if(Wd(t,e),ku(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{qb(t.containerInfo)}catch(g){co(e,e.return,g)}break;case 4:Wd(t,e),ku(e);break;case 13:Wd(t,e),ku(e),s=e.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(i4=wo())),n&4&&xF(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(el=(d=el)||u,Wd(t,e),el=d):Wd(t,e),ku(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(Sn=e,u=e.child;u!==null;){for(f=Sn=u;Sn!==null;){switch(h=Sn,m=h.child,h.tag){case 0:case 11:case 14:case 15:Qy(4,h,h.return);break;case 1:zv(h,h.return);var v=h.stateNode;if(typeof v.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(g){co(n,r,g)}}break;case 5:zv(h,h.return);break;case 22:if(h.memoizedState!==null){bF(f);continue}}m!==null?(m.return=h,Sn=m):bF(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{s=f.stateNode,d?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=f.stateNode,c=f.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=UV("display",i))}catch(g){co(e,e.return,g)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(g){co(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Wd(t,e),ku(e),n&4&&xF(e);break;case 21:break;default:Wd(t,e),ku(e)}}function ku(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(pH(r)){var n=r;break e}r=r.return}throw Error(Yr(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Lb(s,""),n.flags&=-33);var o=vF(e);sI(e,o,s);break;case 3:case 4:var i=n.stateNode.containerInfo,l=vF(e);aI(e,l,i);break;default:throw Error(Yr(161))}}catch(c){co(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function yce(e,t,r){Sn=e,xH(e)}function xH(e,t,r){for(var n=(e.mode&1)!==0;Sn!==null;){var s=Sn,o=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||M2;if(!i){var l=s.alternate,c=l!==null&&l.memoizedState!==null||el;l=M2;var d=el;if(M2=i,(el=c)&&!d)for(Sn=s;Sn!==null;)i=Sn,c=i.child,i.tag===22&&i.memoizedState!==null?wF(s):c!==null?(c.return=i,Sn=c):wF(s);for(;o!==null;)Sn=o,xH(o),o=o.sibling;Sn=s,M2=l,el=d}yF(e)}else s.subtreeFlags&8772&&o!==null?(o.return=s,Sn=o):yF(e)}}function yF(e){for(;Sn!==null;){var t=Sn;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:el||aC(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!el)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:Qd(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&nF(t,o,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}nF(t,i,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&qb(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Yr(163))}el||t.flags&512&&nI(t)}catch(h){co(t,t.return,h)}}if(t===e){Sn=null;break}if(r=t.sibling,r!==null){r.return=t.return,Sn=r;break}Sn=t.return}}function bF(e){for(;Sn!==null;){var t=Sn;if(t===e){Sn=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Sn=r;break}Sn=t.return}}function wF(e){for(;Sn!==null;){var t=Sn;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{aC(4,t)}catch(c){co(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){co(t,s,c)}}var o=t.return;try{nI(t)}catch(c){co(t,o,c)}break;case 5:var i=t.return;try{nI(t)}catch(c){co(t,i,c)}}}catch(c){co(t,t.return,c)}if(t===e){Sn=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Sn=l;break}Sn=t.return}}var bce=Math.ceil,$_=om.ReactCurrentDispatcher,s4=om.ReactCurrentOwner,Cd=om.ReactCurrentBatchConfig,Ha=0,bi=null,Mo=null,$i=0,Pc=0,Uv=Uh(0),ri=0,Qb=null,fg=0,sC=0,o4=0,Zy=null,Yl=null,i4=0,Ex=1/0,Cf=null,B_=!1,oI=null,uh=null,R2=!1,Ym=null,q_=0,eb=0,iI=null,Yj=-1,Jj=0;function Ol(){return Ha&6?wo():Yj!==-1?Yj:Yj=wo()}function fh(e){return e.mode&1?Ha&2&&$i!==0?$i&-$i:nce.transition!==null?(Jj===0&&(Jj=rW()),Jj):(e=ls,e!==0||(e=window.event,e=e===void 0?16:cW(e.type)),e):1}function du(e,t,r,n){if(50<eb)throw eb=0,iI=null,Error(Yr(185));p1(e,r,n),(!(Ha&2)||e!==bi)&&(e===bi&&(!(Ha&2)&&(sC|=r),ri===4&&Um(e,$i)),oc(e,n),r===1&&Ha===0&&!(t.mode&1)&&(Ex=wo()+500,tC&&Vh()))}function oc(e,t){var r=e.callbackNode;nle(e,t);var n=N_(e,e===bi?$i:0);if(n===0)r!==null&&kL(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&kL(r),t===1)e.tag===0?rce(jF.bind(null,e)):AW(jF.bind(null,e)),Qle(function(){!(Ha&6)&&Vh()}),r=null;else{switch(nW(n)){case 1:r=T3;break;case 4:r=eW;break;case 16:r=__;break;case 536870912:r=tW;break;default:r=__}r=CH(r,yH.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function yH(e,t){if(Yj=-1,Jj=0,Ha&6)throw Error(Yr(327));var r=e.callbackNode;if(ix()&&e.callbackNode!==r)return null;var n=N_(e,e===bi?$i:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=z_(e,n);else{t=n;var s=Ha;Ha|=2;var o=wH();(bi!==e||$i!==t)&&(Cf=null,Ex=wo()+500,Kp(e,t));do try{_ce();break}catch(l){bH(e,l)}while(1);H3(),$_.current=o,Ha=s,Mo!==null?t=0:(bi=null,$i=0,t=ri)}if(t!==0){if(t===2&&(s=Dk(e),s!==0&&(n=s,t=lI(e,s))),t===1)throw r=Qb,Kp(e,0),Um(e,n),oc(e,wo()),r;if(t===6)Um(e,n);else{if(s=e.current.alternate,!(n&30)&&!wce(s)&&(t=z_(e,n),t===2&&(o=Dk(e),o!==0&&(n=o,t=lI(e,o))),t===1))throw r=Qb,Kp(e,0),Um(e,n),oc(e,wo()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(Yr(345));case 2:xp(e,Yl,Cf);break;case 3:if(Um(e,n),(n&130023424)===n&&(t=i4+500-wo(),10<t)){if(N_(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){Ol(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=zk(xp.bind(null,e,Yl,Cf),t);break}xp(e,Yl,Cf);break;case 4:if(Um(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var i=31-cu(n);o=1<<i,i=t[i],i>s&&(s=i),n&=~o}if(n=s,n=wo()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*bce(n/1960))-n,10<n){e.timeoutHandle=zk(xp.bind(null,e,Yl,Cf),n);break}xp(e,Yl,Cf);break;case 5:xp(e,Yl,Cf);break;default:throw Error(Yr(329))}}}return oc(e,wo()),e.callbackNode===r?yH.bind(null,e):null}function lI(e,t){var r=Zy;return e.current.memoizedState.isDehydrated&&(Kp(e,t).flags|=256),e=z_(e,t),e!==2&&(t=Yl,Yl=r,t!==null&&cI(t)),e}function cI(e){Yl===null?Yl=e:Yl.push.apply(Yl,e)}function wce(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],o=s.getSnapshot;s=s.value;try{if(!hu(o(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Um(e,t){for(t&=~o4,t&=~sC,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-cu(t),n=1<<r;e[r]=-1,t&=~n}}function jF(e){if(Ha&6)throw Error(Yr(327));ix();var t=N_(e,0);if(!(t&1))return oc(e,wo()),null;var r=z_(e,t);if(e.tag!==0&&r===2){var n=Dk(e);n!==0&&(t=n,r=lI(e,n))}if(r===1)throw r=Qb,Kp(e,0),Um(e,t),oc(e,wo()),r;if(r===6)throw Error(Yr(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xp(e,Yl,Cf),oc(e,wo()),null}function l4(e,t){var r=Ha;Ha|=1;try{return e(t)}finally{Ha=r,Ha===0&&(Ex=wo()+500,tC&&Vh())}}function mg(e){Ym!==null&&Ym.tag===0&&!(Ha&6)&&ix();var t=Ha;Ha|=1;var r=Cd.transition,n=ls;try{if(Cd.transition=null,ls=1,e)return e()}finally{ls=n,Cd.transition=r,Ha=t,!(Ha&6)&&Vh()}}function c4(){Pc=Uv.current,$s(Uv)}function Kp(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Jle(r)),Mo!==null)for(r=Mo.return;r!==null;){var n=r;switch(U3(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&E_();break;case 3:Px(),$s(ac),$s(sl),Q3();break;case 5:J3(n);break;case 4:Px();break;case 13:$s(Qs);break;case 19:$s(Qs);break;case 10:G3(n.type._context);break;case 22:case 23:c4()}r=r.return}if(bi=e,Mo=e=mh(e.current,null),$i=Pc=t,ri=0,Qb=null,o4=sC=fg=0,Yl=Zy=null,Tp!==null){for(t=0;t<Tp.length;t++)if(r=Tp[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,o=r.pending;if(o!==null){var i=o.next;o.next=s,n.next=i}r.pending=n}Tp=null}return e}function bH(e,t){do{var r=Mo;try{if(H3(),Gj.current=F_,L_){for(var n=to.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}L_=!1}if(ug=0,hi=Jo=to=null,Jy=!1,Xb=0,s4.current=null,r===null||r.return===null){ri=1,Qb=t,Mo=null;break}e:{var o=e,i=r.return,l=r,c=t;if(t=$i,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=cF(i);if(m!==null){m.flags&=-257,dF(m,i,l,o,t),m.mode&1&&lF(o,d,t),t=m,c=d;var v=t.updateQueue;if(v===null){var g=new Set;g.add(c),t.updateQueue=g}else v.add(c);break e}else{if(!(t&1)){lF(o,d,t),d4();break e}c=Error(Yr(426))}}else if(Gs&&l.mode&1){var y=cF(i);if(y!==null){!(y.flags&65536)&&(y.flags|=256),dF(y,i,l,o,t),V3(Ax(c,l));break e}}o=c=Ax(c,l),ri!==4&&(ri=2),Zy===null?Zy=[o]:Zy.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var x=nH(o,c,t);rF(o,x);break e;case 1:l=c;var b=o.type,w=o.stateNode;if(!(o.flags&128)&&(typeof b.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(uh===null||!uh.has(w)))){o.flags|=65536,t&=-t,o.lanes|=t;var j=aH(o,l,t);rF(o,j);break e}}o=o.return}while(o!==null)}_H(r)}catch(_){t=_,Mo===r&&r!==null&&(Mo=r=r.return);continue}break}while(1)}function wH(){var e=$_.current;return $_.current=F_,e===null?F_:e}function d4(){(ri===0||ri===3||ri===2)&&(ri=4),bi===null||!(fg&268435455)&&!(sC&268435455)||Um(bi,$i)}function z_(e,t){var r=Ha;Ha|=2;var n=wH();(bi!==e||$i!==t)&&(Cf=null,Kp(e,t));do try{jce();break}catch(s){bH(e,s)}while(1);if(H3(),Ha=r,$_.current=n,Mo!==null)throw Error(Yr(261));return bi=null,$i=0,ri}function jce(){for(;Mo!==null;)jH(Mo)}function _ce(){for(;Mo!==null&&!Kie();)jH(Mo)}function jH(e){var t=SH(e.alternate,e,Pc);e.memoizedProps=e.pendingProps,t===null?_H(e):Mo=t,s4.current=null}function _H(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=gce(r,t),r!==null){r.flags&=32767,Mo=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ri=6,Mo=null;return}}else if(r=pce(r,t,Pc),r!==null){Mo=r;return}if(t=t.sibling,t!==null){Mo=t;return}Mo=t=e}while(t!==null);ri===0&&(ri=5)}function xp(e,t,r){var n=ls,s=Cd.transition;try{Cd.transition=null,ls=1,Nce(e,t,r,n)}finally{Cd.transition=s,ls=n}return null}function Nce(e,t,r,n){do ix();while(Ym!==null);if(Ha&6)throw Error(Yr(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Yr(177));e.callbackNode=null,e.callbackPriority=0;var o=r.lanes|r.childLanes;if(ale(e,o),e===bi&&(Mo=bi=null,$i=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||R2||(R2=!0,CH(__,function(){return ix(),null})),o=(r.flags&15990)!==0,r.subtreeFlags&15990||o){o=Cd.transition,Cd.transition=null;var i=ls;ls=1;var l=Ha;Ha|=4,s4.current=null,xce(e,r),vH(r,e),Vle(Bk),S_=!!$k,Bk=$k=null,e.current=r,yce(r),Xie(),Ha=l,ls=i,Cd.transition=o}else e.current=r;if(R2&&(R2=!1,Ym=e,q_=s),o=e.pendingLanes,o===0&&(uh=null),Qie(r.stateNode),oc(e,wo()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(B_)throw B_=!1,e=oI,oI=null,e;return q_&1&&e.tag!==0&&ix(),o=e.pendingLanes,o&1?e===iI?eb++:(eb=0,iI=e):eb=0,Vh(),null}function ix(){if(Ym!==null){var e=nW(q_),t=Cd.transition,r=ls;try{if(Cd.transition=null,ls=16>e?16:e,Ym===null)var n=!1;else{if(e=Ym,Ym=null,q_=0,Ha&6)throw Error(Yr(331));var s=Ha;for(Ha|=4,Sn=e.current;Sn!==null;){var o=Sn,i=o.child;if(Sn.flags&16){var l=o.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(Sn=d;Sn!==null;){var u=Sn;switch(u.tag){case 0:case 11:case 15:Qy(8,u,o)}var f=u.child;if(f!==null)f.return=u,Sn=f;else for(;Sn!==null;){u=Sn;var h=u.sibling,m=u.return;if(hH(u),u===d){Sn=null;break}if(h!==null){h.return=m,Sn=h;break}Sn=m}}}var v=o.alternate;if(v!==null){var g=v.child;if(g!==null){v.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}Sn=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,Sn=i;else e:for(;Sn!==null;){if(o=Sn,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Qy(9,o,o.return)}var x=o.sibling;if(x!==null){x.return=o.return,Sn=x;break e}Sn=o.return}}var b=e.current;for(Sn=b;Sn!==null;){i=Sn;var w=i.child;if(i.subtreeFlags&2064&&w!==null)w.return=i,Sn=w;else e:for(i=b;Sn!==null;){if(l=Sn,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:aC(9,l)}}catch(_){co(l,l.return,_)}if(l===i){Sn=null;break e}var j=l.sibling;if(j!==null){j.return=l.return,Sn=j;break e}Sn=l.return}}if(Ha=s,Vh(),Xu&&typeof Xu.onPostCommitFiberRoot=="function")try{Xu.onPostCommitFiberRoot(YS,e)}catch{}n=!0}return n}finally{ls=r,Cd.transition=t}}return!1}function _F(e,t,r){t=Ax(r,t),t=nH(e,t,1),e=dh(e,t,1),t=Ol(),e!==null&&(p1(e,1,t),oc(e,t))}function co(e,t,r){if(e.tag===3)_F(e,e,r);else for(;t!==null;){if(t.tag===3){_F(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(uh===null||!uh.has(n))){e=Ax(r,e),e=aH(t,e,1),t=dh(t,e,1),e=Ol(),t!==null&&(p1(t,1,e),oc(t,e));break}}t=t.return}}function Sce(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Ol(),e.pingedLanes|=e.suspendedLanes&r,bi===e&&($i&r)===r&&(ri===4||ri===3&&($i&130023424)===$i&&500>wo()-i4?Kp(e,0):o4|=r),oc(e,t)}function NH(e,t){t===0&&(e.mode&1?(t=C2,C2<<=1,!(C2&130023424)&&(C2=4194304)):t=1);var r=Ol();e=Gf(e,t),e!==null&&(p1(e,t,r),oc(e,r))}function Cce(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),NH(e,r)}function Pce(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Yr(314))}n!==null&&n.delete(t),NH(e,r)}var SH;SH=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ac.current)ec=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return ec=!1,hce(e,t,r);ec=!!(e.flags&131072)}else ec=!1,Gs&&t.flags&1048576&&EW(t,O_,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Xj(e,t),e=t.pendingProps;var s=Nx(t,sl.current);ox(t,r),s=e4(null,t,n,e,s,r);var o=t4();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,sc(n)?(o=!0,k_(t)):o=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,X3(t),s.updater=nC,t.stateNode=s,s._reactInternals=t,Xk(t,n,e,r),t=Qk(null,t,n,!0,o,r)):(t.tag=0,Gs&&o&&z3(t),Sl(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Xj(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=Ece(n),e=Qd(n,e),s){case 0:t=Jk(null,t,n,e,r);break e;case 1:t=mF(null,t,n,e,r);break e;case 11:t=uF(null,t,n,e,r);break e;case 14:t=fF(null,t,n,Qd(n.type,e),r);break e}throw Error(Yr(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Qd(n,s),Jk(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Qd(n,s),mF(e,t,n,s,r);case 3:e:{if(lH(t),e===null)throw Error(Yr(387));n=t.pendingProps,o=t.memoizedState,s=o.element,MW(e,t),M_(t,n,null,r);var i=t.memoizedState;if(n=i.element,o.isDehydrated)if(o={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){s=Ax(Error(Yr(423)),t),t=hF(e,t,n,r,s);break e}else if(n!==s){s=Ax(Error(Yr(424)),t),t=hF(e,t,n,r,s);break e}else for(Oc=ch(t.stateNode.containerInfo.firstChild),$c=t,Gs=!0,nu=null,r=TW(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Sx(),n===s){t=Kf(e,t,r);break e}Sl(e,t,n,r)}t=t.child}return t;case 5:return RW(t),e===null&&Hk(t),n=t.type,s=t.pendingProps,o=e!==null?e.memoizedProps:null,i=s.children,qk(n,s)?i=null:o!==null&&qk(n,o)&&(t.flags|=32),iH(e,t),Sl(e,t,i,r),t.child;case 6:return e===null&&Hk(t),null;case 13:return cH(e,t,r);case 4:return Y3(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Cx(t,null,n,r):Sl(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Qd(n,s),uF(e,t,n,s,r);case 7:return Sl(e,t,t.pendingProps,r),t.child;case 8:return Sl(e,t,t.pendingProps.children,r),t.child;case 12:return Sl(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,o=t.memoizedProps,i=s.value,Ss(T_,n._currentValue),n._currentValue=i,o!==null)if(hu(o.value,i)){if(o.children===s.children&&!ac.current){t=Kf(e,t,r);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var l=o.dependencies;if(l!==null){i=o.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(o.tag===1){c=Bf(-1,r&-r),c.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}o.lanes|=r,c=o.alternate,c!==null&&(c.lanes|=r),Gk(o.return,r,t),l.lanes|=r;break}c=c.next}}else if(o.tag===10)i=o.type===t.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(Yr(341));i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),Gk(i,r,t),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===t){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}Sl(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,ox(t,r),s=Id(s),n=n(s),t.flags|=1,Sl(e,t,n,r),t.child;case 14:return n=t.type,s=Qd(n,t.pendingProps),s=Qd(n.type,s),fF(e,t,n,s,r);case 15:return sH(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Qd(n,s),Xj(e,t),t.tag=1,sc(n)?(e=!0,k_(t)):e=!1,ox(t,r),rH(t,n,s),Xk(t,n,s,r),Qk(null,t,n,!0,e,r);case 19:return dH(e,t,r);case 22:return oH(e,t,r)}throw Error(Yr(156,t.tag))};function CH(e,t){return ZV(e,t)}function Ace(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wd(e,t,r,n){return new Ace(e,t,r,n)}function u4(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ece(e){if(typeof e=="function")return u4(e)?1:0;if(e!=null){if(e=e.$$typeof,e===k3)return 11;if(e===I3)return 14}return 2}function mh(e,t){var r=e.alternate;return r===null?(r=wd(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Qj(e,t,r,n,s,o){var i=2;if(n=e,typeof e=="function")u4(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Tv:return Xp(r.children,s,o,t);case E3:i=8,s|=8;break;case yk:return e=wd(12,r,t,s|2),e.elementType=yk,e.lanes=o,e;case bk:return e=wd(13,r,t,s),e.elementType=bk,e.lanes=o,e;case wk:return e=wd(19,r,t,s),e.elementType=wk,e.lanes=o,e;case RV:return oC(r,s,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case DV:i=10;break e;case MV:i=9;break e;case k3:i=11;break e;case I3:i=14;break e;case Lm:i=16,n=null;break e}throw Error(Yr(130,e==null?e:typeof e,""))}return t=wd(i,r,t,s),t.elementType=e,t.type=n,t.lanes=o,t}function Xp(e,t,r,n){return e=wd(7,e,n,t),e.lanes=r,e}function oC(e,t,r,n){return e=wd(22,e,n,t),e.elementType=RV,e.lanes=r,e.stateNode={isHidden:!1},e}function tA(e,t,r){return e=wd(6,e,null,t),e.lanes=r,e}function rA(e,t,r){return t=wd(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function kce(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=RP(0),this.expirationTimes=RP(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=RP(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function f4(e,t,r,n,s,o,i,l,c){return e=new kce(e,t,r,l,c),t===1?(t=1,o===!0&&(t|=8)):t=0,o=wd(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},X3(o),e}function Ice(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ov,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function PH(e){if(!e)return kh;e=e._reactInternals;e:{if(Ig(e)!==e||e.tag!==1)throw Error(Yr(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(sc(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Yr(171))}if(e.tag===1){var r=e.type;if(sc(r))return PW(e,r,t)}return t}function AH(e,t,r,n,s,o,i,l,c){return e=f4(r,n,!0,e,s,o,i,l,c),e.context=PH(null),r=e.current,n=Ol(),s=fh(r),o=Bf(n,s),o.callback=t??null,dh(r,o,s),e.current.lanes=s,p1(e,s,n),oc(e,n),e}function iC(e,t,r,n){var s=t.current,o=Ol(),i=fh(s);return r=PH(r),t.context===null?t.context=r:t.pendingContext=r,t=Bf(o,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=dh(s,t,i),e!==null&&(du(e,s,i,o),Hj(e,s,i)),i}function U_(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function NF(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function m4(e,t){NF(e,t),(e=e.alternate)&&NF(e,t)}function Oce(){return null}var EH=typeof reportError=="function"?reportError:function(e){console.error(e)};function h4(e){this._internalRoot=e}lC.prototype.render=h4.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Yr(409));iC(e,t,null,null)};lC.prototype.unmount=h4.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;mg(function(){iC(null,e,null,null)}),t[Hf]=null}};function lC(e){this._internalRoot=e}lC.prototype.unstable_scheduleHydration=function(e){if(e){var t=oW();e={blockedOn:null,target:e,priority:t};for(var r=0;r<zm.length&&t!==0&&t<zm[r].priority;r++);zm.splice(r,0,e),r===0&&lW(e)}};function p4(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function cC(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function SF(){}function Tce(e,t,r,n,s){if(s){if(typeof n=="function"){var o=n;n=function(){var d=U_(i);o.call(d)}}var i=AH(t,n,e,0,null,!1,!1,"",SF);return e._reactRootContainer=i,e[Hf]=i.current,Vb(e.nodeType===8?e.parentNode:e),mg(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var d=U_(c);l.call(d)}}var c=f4(e,0,!1,null,null,!1,!1,"",SF);return e._reactRootContainer=c,e[Hf]=c.current,Vb(e.nodeType===8?e.parentNode:e),mg(function(){iC(t,c,r,n)}),c}function dC(e,t,r,n,s){var o=r._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var l=s;s=function(){var c=U_(i);l.call(c)}}iC(t,i,e,s)}else i=Tce(r,t,e,s,n);return U_(i)}aW=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Ly(t.pendingLanes);r!==0&&(D3(t,r|1),oc(t,wo()),!(Ha&6)&&(Ex=wo()+500,Vh()))}break;case 13:mg(function(){var n=Gf(e,1);if(n!==null){var s=Ol();du(n,e,1,s)}}),m4(e,1)}};M3=function(e){if(e.tag===13){var t=Gf(e,134217728);if(t!==null){var r=Ol();du(t,e,134217728,r)}m4(e,134217728)}};sW=function(e){if(e.tag===13){var t=fh(e),r=Gf(e,t);if(r!==null){var n=Ol();du(r,e,t,n)}m4(e,t)}};oW=function(){return ls};iW=function(e,t){var r=ls;try{return ls=e,t()}finally{ls=r}};Ik=function(e,t,r){switch(t){case"input":if(Nk(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=eC(n);if(!s)throw Error(Yr(90));FV(n),Nk(n,s)}}}break;case"textarea":BV(e,r);break;case"select":t=r.value,t!=null&&rx(e,!!r.multiple,t,!1)}};GV=l4;KV=mg;var Dce={usingClientEntryPoint:!1,Events:[v1,Lv,eC,WV,HV,l4]},cy={findFiberByHostInstance:Op,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Mce={bundleType:cy.bundleType,version:cy.version,rendererPackageName:cy.rendererPackageName,rendererConfig:cy.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:om.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=JV(e),e===null?null:e.stateNode},findFiberByHostInstance:cy.findFiberByHostInstance||Oce,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var L2=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!L2.isDisabled&&L2.supportsFiber)try{YS=L2.inject(Mce),Xu=L2}catch{}}Kc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Dce;Kc.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p4(t))throw Error(Yr(200));return Ice(e,t,null,r)};Kc.createRoot=function(e,t){if(!p4(e))throw Error(Yr(299));var r=!1,n="",s=EH;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=f4(e,1,!1,null,null,r,!1,n,s),e[Hf]=t.current,Vb(e.nodeType===8?e.parentNode:e),new h4(t)};Kc.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Yr(188)):(e=Object.keys(e).join(","),Error(Yr(268,e)));return e=JV(t),e=e===null?null:e.stateNode,e};Kc.flushSync=function(e){return mg(e)};Kc.hydrate=function(e,t,r){if(!cC(t))throw Error(Yr(200));return dC(null,e,t,!0,r)};Kc.hydrateRoot=function(e,t,r){if(!p4(e))throw Error(Yr(405));var n=r!=null&&r.hydratedSources||null,s=!1,o="",i=EH;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=AH(t,null,e,1,r??null,s,!1,o,i),e[Hf]=t.current,Vb(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new lC(t)};Kc.render=function(e,t,r){if(!cC(t))throw Error(Yr(200));return dC(null,e,t,!1,r)};Kc.unmountComponentAtNode=function(e){if(!cC(e))throw Error(Yr(40));return e._reactRootContainer?(mg(function(){dC(null,null,e,!1,function(){e._reactRootContainer=null,e[Hf]=null})}),!0):!1};Kc.unstable_batchedUpdates=l4;Kc.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!cC(r))throw Error(Yr(200));if(e==null||e._reactInternals===void 0)throw Error(Yr(38));return dC(e,t,r,!1,n)};Kc.version="18.3.1-next-f1338f8080-20240426";function kH(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(kH)}catch(e){console.error(e)}}kH(),kV.exports=Kc;var im=kV.exports;const g4=Ua(im);var CF=im;vk.createRoot=CF.createRoot,vk.hydrateRoot=CF.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Zb(){return Zb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zb.apply(this,arguments)}var Jm;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Jm||(Jm={}));const PF="popstate";function Rce(e){e===void 0&&(e={});function t(n,s){let{pathname:o,search:i,hash:l}=n.location;return dI("",{pathname:o,search:i,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:V_(s)}return Fce(t,r,null,e)}function ro(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function IH(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Lce(){return Math.random().toString(36).substr(2,8)}function AF(e,t){return{usr:e.state,key:e.key,idx:t}}function dI(e,t,r,n){return r===void 0&&(r=null),Zb({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?b0(t):t,{state:r,key:t&&t.key||n||Lce()})}function V_(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function b0(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Fce(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:o=!1}=n,i=s.history,l=Jm.Pop,c=null,d=u();d==null&&(d=0,i.replaceState(Zb({},i.state,{idx:d}),""));function u(){return(i.state||{idx:null}).idx}function f(){l=Jm.Pop;let y=u(),x=y==null?null:y-d;d=y,c&&c({action:l,location:g.location,delta:x})}function h(y,x){l=Jm.Push;let b=dI(g.location,y,x);r&&r(b,y),d=u()+1;let w=AF(b,d),j=g.createHref(b);try{i.pushState(w,"",j)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;s.location.assign(j)}o&&c&&c({action:l,location:g.location,delta:1})}function m(y,x){l=Jm.Replace;let b=dI(g.location,y,x);r&&r(b,y),d=u();let w=AF(b,d),j=g.createHref(b);i.replaceState(w,"",j),o&&c&&c({action:l,location:g.location,delta:0})}function v(y){let x=s.location.origin!=="null"?s.location.origin:s.location.href,b=typeof y=="string"?y:V_(y);return b=b.replace(/ $/,"%20"),ro(x,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,x)}let g={get action(){return l},get location(){return e(s,i)},listen(y){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(PF,f),c=y,()=>{s.removeEventListener(PF,f),c=null}},createHref(y){return t(s,y)},createURL:v,encodeLocation(y){let x=v(y);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:h,replace:m,go(y){return i.go(y)}};return g}var EF;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(EF||(EF={}));function $ce(e,t,r){return r===void 0&&(r="/"),Bce(e,t,r,!1)}function Bce(e,t,r,n){let s=typeof t=="string"?b0(t):t,o=kx(s.pathname||"/",r);if(o==null)return null;let i=OH(e);qce(i);let l=null;for(let c=0;l==null&&c<i.length;++c){let d=Qce(o);l=Yce(i[c],d,n)}return l}function OH(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(o,i,l)=>{let c={relativePath:l===void 0?o.path||"":l,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};c.relativePath.startsWith("/")&&(ro(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let d=hh([n,c.relativePath]),u=r.concat(c);o.children&&o.children.length>0&&(ro(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),OH(o.children,t,u,d)),!(o.path==null&&!o.index)&&t.push({path:d,score:Kce(d,o.index),routesMeta:u})};return e.forEach((o,i)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))s(o,i);else for(let c of TH(o.path))s(o,i,c)}),t}function TH(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),o=r.replace(/\?$/,"");if(n.length===0)return s?[o,""]:[o];let i=TH(n.join("/")),l=[];return l.push(...i.map(c=>c===""?o:[o,c].join("/"))),s&&l.push(...i),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function qce(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:Xce(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const zce=/^:[\w-]+$/,Uce=3,Vce=2,Wce=1,Hce=10,Gce=-2,kF=e=>e==="*";function Kce(e,t){let r=e.split("/"),n=r.length;return r.some(kF)&&(n+=Gce),t&&(n+=Vce),r.filter(s=>!kF(s)).reduce((s,o)=>s+(zce.test(o)?Uce:o===""?Wce:Hce),n)}function Xce(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function Yce(e,t,r){r===void 0&&(r=!1);let{routesMeta:n}=e,s={},o="/",i=[];for(let l=0;l<n.length;++l){let c=n[l],d=l===n.length-1,u=o==="/"?t:t.slice(o.length)||"/",f=W_({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),h=c.route;if(!f&&d&&r&&!n[n.length-1].route.index&&(f=W_({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!f)return null;Object.assign(s,f.params),i.push({params:s,pathname:hh([o,f.pathname]),pathnameBase:rde(hh([o,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(o=hh([o,f.pathnameBase]))}return i}function W_(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=Jce(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let o=s[0],i=o.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((d,u,f)=>{let{paramName:h,isOptional:m}=u;if(h==="*"){let g=l[f]||"";i=o.slice(0,o.length-g.length).replace(/(.)\/+$/,"$1")}const v=l[f];return m&&!v?d[h]=void 0:d[h]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:o,pathnameBase:i,pattern:e}}function Jce(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),IH(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function Qce(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return IH(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function kx(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function Zce(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?b0(e):e;return{pathname:r?r.startsWith("/")?r:ede(r,t):t,search:nde(n),hash:ade(s)}}function ede(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function nA(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function tde(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function v4(e,t){let r=tde(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function x4(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=b0(e):(s=Zb({},e),ro(!s.pathname||!s.pathname.includes("?"),nA("?","pathname","search",s)),ro(!s.pathname||!s.pathname.includes("#"),nA("#","pathname","hash",s)),ro(!s.search||!s.search.includes("#"),nA("#","search","hash",s)));let o=e===""||s.pathname==="",i=o?"/":s.pathname,l;if(i==null)l=r;else{let f=t.length-1;if(!n&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),f-=1;s.pathname=h.join("/")}l=f>=0?t[f]:"/"}let c=Zce(s,l),d=i&&i!=="/"&&i.endsWith("/"),u=(o||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}const hh=e=>e.join("/").replace(/\/\/+/g,"/"),rde=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),nde=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,ade=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function sde(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const DH=["post","put","patch","delete"];new Set(DH);const ode=["get",...DH];new Set(ode);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ew(){return ew=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ew.apply(this,arguments)}const uC=p.createContext(null),MH=p.createContext(null),lm=p.createContext(null),fC=p.createContext(null),cm=p.createContext({outlet:null,matches:[],isDataRoute:!1}),RH=p.createContext(null);function ide(e,t){let{relative:r}=t===void 0?{}:t;w0()||ro(!1);let{basename:n,navigator:s}=p.useContext(lm),{hash:o,pathname:i,search:l}=mC(e,{relative:r}),c=i;return n!=="/"&&(c=i==="/"?n:hh([n,i])),s.createHref({pathname:c,search:l,hash:o})}function w0(){return p.useContext(fC)!=null}function $o(){return w0()||ro(!1),p.useContext(fC).location}function LH(e){p.useContext(lm).static||p.useLayoutEffect(e)}function zi(){let{isDataRoute:e}=p.useContext(cm);return e?wde():lde()}function lde(){w0()||ro(!1);let e=p.useContext(uC),{basename:t,future:r,navigator:n}=p.useContext(lm),{matches:s}=p.useContext(cm),{pathname:o}=$o(),i=JSON.stringify(v4(s,r.v7_relativeSplatPath)),l=p.useRef(!1);return LH(()=>{l.current=!0}),p.useCallback(function(d,u){if(u===void 0&&(u={}),!l.current)return;if(typeof d=="number"){n.go(d);return}let f=x4(d,JSON.parse(i),o,u.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:hh([t,f.pathname])),(u.replace?n.replace:n.push)(f,u.state,u)},[t,n,i,o,e])}function cde(){let{matches:e}=p.useContext(cm),t=e[e.length-1];return t?t.params:{}}function mC(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=p.useContext(lm),{matches:s}=p.useContext(cm),{pathname:o}=$o(),i=JSON.stringify(v4(s,n.v7_relativeSplatPath));return p.useMemo(()=>x4(e,JSON.parse(i),o,r==="path"),[e,i,o,r])}function dde(e,t){return ude(e,t)}function ude(e,t,r,n){w0()||ro(!1);let{navigator:s}=p.useContext(lm),{matches:o}=p.useContext(cm),i=o[o.length-1],l=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let d=$o(),u;if(t){var f;let y=typeof t=="string"?b0(t):t;c==="/"||(f=y.pathname)!=null&&f.startsWith(c)||ro(!1),u=y}else u=d;let h=u.pathname||"/",m=h;if(c!=="/"){let y=c.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let v=$ce(e,{pathname:m}),g=gde(v&&v.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:hh([c,s.encodeLocation?s.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:hh([c,s.encodeLocation?s.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),o,r,n);return t&&g?p.createElement(fC.Provider,{value:{location:ew({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Jm.Pop}},g):g}function fde(){let e=bde(),t=sde(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},o=null;return p.createElement(p.Fragment,null,p.createElement("h2",null,"Unexpected Application Error!"),p.createElement("h3",{style:{fontStyle:"italic"}},t),r?p.createElement("pre",{style:s},r):null,o)}const mde=p.createElement(fde,null);class hde extends p.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?p.createElement(cm.Provider,{value:this.props.routeContext},p.createElement(RH.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function pde(e){let{routeContext:t,match:r,children:n}=e,s=p.useContext(uC);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),p.createElement(cm.Provider,{value:t},n)}function gde(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var o;if(!r)return null;if(r.errors)e=r.matches;else if((o=n)!=null&&o.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,l=(s=r)==null?void 0:s.errors;if(l!=null){let u=i.findIndex(f=>f.route.id&&l?.[f.route.id]!==void 0);u>=0||ro(!1),i=i.slice(0,Math.min(i.length,u+1))}let c=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<i.length;u++){let f=i[u];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(d=u),f.route.id){let{loaderData:h,errors:m}=r,v=f.route.loader&&h[f.route.id]===void 0&&(!m||m[f.route.id]===void 0);if(f.route.lazy||v){c=!0,d>=0?i=i.slice(0,d+1):i=[i[0]];break}}}return i.reduceRight((u,f,h)=>{let m,v=!1,g=null,y=null;r&&(m=l&&f.route.id?l[f.route.id]:void 0,g=f.route.errorElement||mde,c&&(d<0&&h===0?(jde("route-fallback",!1),v=!0,y=null):d===h&&(v=!0,y=f.route.hydrateFallbackElement||null)));let x=t.concat(i.slice(0,h+1)),b=()=>{let w;return m?w=g:v?w=y:f.route.Component?w=p.createElement(f.route.Component,null):f.route.element?w=f.route.element:w=u,p.createElement(pde,{match:f,routeContext:{outlet:u,matches:x,isDataRoute:r!=null},children:w})};return r&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?p.createElement(hde,{location:r.location,revalidation:r.revalidation,component:g,error:m,children:b(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):b()},null)}var FH=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(FH||{}),H_=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(H_||{});function vde(e){let t=p.useContext(uC);return t||ro(!1),t}function xde(e){let t=p.useContext(MH);return t||ro(!1),t}function yde(e){let t=p.useContext(cm);return t||ro(!1),t}function $H(e){let t=yde(),r=t.matches[t.matches.length-1];return r.route.id||ro(!1),r.route.id}function bde(){var e;let t=p.useContext(RH),r=xde(H_.UseRouteError),n=$H(H_.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function wde(){let{router:e}=vde(FH.UseNavigateStable),t=$H(H_.UseNavigateStable),r=p.useRef(!1);return LH(()=>{r.current=!0}),p.useCallback(function(s,o){o===void 0&&(o={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,ew({fromRouteId:t},o)))},[e,t])}const IF={};function jde(e,t,r){!t&&!IF[e]&&(IF[e]=!0)}function _de(e,t){e?.v7_startTransition,e?.v7_relativeSplatPath===void 0&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}function BH(e){let{to:t,replace:r,state:n,relative:s}=e;w0()||ro(!1);let{future:o,static:i}=p.useContext(lm),{matches:l}=p.useContext(cm),{pathname:c}=$o(),d=zi(),u=x4(t,v4(l,o.v7_relativeSplatPath),c,s==="path"),f=JSON.stringify(u);return p.useEffect(()=>d(JSON.parse(f),{replace:r,state:n,relative:s}),[d,f,s,r,n]),null}function Ya(e){ro(!1)}function Nde(e){let{basename:t="/",children:r=null,location:n,navigationType:s=Jm.Pop,navigator:o,static:i=!1,future:l}=e;w0()&&ro(!1);let c=t.replace(/^\/*/,"/"),d=p.useMemo(()=>({basename:c,navigator:o,static:i,future:ew({v7_relativeSplatPath:!1},l)}),[c,l,o,i]);typeof n=="string"&&(n=b0(n));let{pathname:u="/",search:f="",hash:h="",state:m=null,key:v="default"}=n,g=p.useMemo(()=>{let y=kx(u,c);return y==null?null:{location:{pathname:y,search:f,hash:h,state:m,key:v},navigationType:s}},[c,u,f,h,m,v,s]);return g==null?null:p.createElement(lm.Provider,{value:d},p.createElement(fC.Provider,{children:r,value:g}))}function Zj(e){let{children:t,location:r}=e;return dde(uI(t),r)}new Promise(()=>{});function uI(e,t){t===void 0&&(t=[]);let r=[];return p.Children.forEach(e,(n,s)=>{if(!p.isValidElement(n))return;let o=[...t,s];if(n.type===p.Fragment){r.push.apply(r,uI(n.props.children,o));return}n.type!==Ya&&ro(!1),!n.props.index||!n.props.children||ro(!1);let i={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=uI(n.props.children,o)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function G_(){return G_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},G_.apply(this,arguments)}function qH(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,o;for(o=0;o<n.length;o++)s=n[o],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function Sde(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Cde(e,t){return e.button===0&&(!t||t==="_self")&&!Sde(e)}function fI(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(s=>[r,s]):[[r,n]])},[]))}function Pde(e,t){let r=fI(e);return t&&t.forEach((n,s)=>{r.has(s)||t.getAll(s).forEach(o=>{r.append(s,o)})}),r}const Ade=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Ede=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],kde="6";try{window.__reactRouterVersion=kde}catch{}const Ide=p.createContext({isTransitioning:!1}),Ode="startTransition",OF=S3[Ode];function Tde(e){let{basename:t,children:r,future:n,window:s}=e,o=p.useRef();o.current==null&&(o.current=Rce({window:s,v5Compat:!0}));let i=o.current,[l,c]=p.useState({action:i.action,location:i.location}),{v7_startTransition:d}=n||{},u=p.useCallback(f=>{d&&OF?OF(()=>c(f)):c(f)},[c,d]);return p.useLayoutEffect(()=>i.listen(u),[i,u]),p.useEffect(()=>_de(n),[n]),p.createElement(Nde,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:i,future:n})}const Dde=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Mde=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,y4=p.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:o,replace:i,state:l,target:c,to:d,preventScrollReset:u,viewTransition:f}=t,h=qH(t,Ade),{basename:m}=p.useContext(lm),v,g=!1;if(typeof d=="string"&&Mde.test(d)&&(v=d,Dde))try{let w=new URL(window.location.href),j=d.startsWith("//")?new URL(w.protocol+d):new URL(d),_=kx(j.pathname,m);j.origin===w.origin&&_!=null?d=_+j.search+j.hash:g=!0}catch{}let y=ide(d,{relative:s}),x=Lde(d,{replace:i,state:l,target:c,preventScrollReset:u,relative:s,viewTransition:f});function b(w){n&&n(w),w.defaultPrevented||x(w)}return p.createElement("a",G_({},h,{href:v||y,onClick:g||o?n:b,ref:r,target:c}))}),Du=p.forwardRef(function(t,r){let{"aria-current":n="page",caseSensitive:s=!1,className:o="",end:i=!1,style:l,to:c,viewTransition:d,children:u}=t,f=qH(t,Ede),h=mC(c,{relative:f.relative}),m=$o(),v=p.useContext(MH),{navigator:g,basename:y}=p.useContext(lm),x=v!=null&&Fde(h)&&d===!0,b=g.encodeLocation?g.encodeLocation(h).pathname:h.pathname,w=m.pathname,j=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;s||(w=w.toLowerCase(),j=j?j.toLowerCase():null,b=b.toLowerCase()),j&&y&&(j=kx(j,y)||j);const _=b!=="/"&&b.endsWith("/")?b.length-1:b.length;let S=w===b||!i&&w.startsWith(b)&&w.charAt(_)==="/",C=j!=null&&(j===b||!i&&j.startsWith(b)&&j.charAt(b.length)==="/"),P={isActive:S,isPending:C,isTransitioning:x},A=S?n:void 0,R;typeof o=="function"?R=o(P):R=[o,S?"active":null,C?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let O=typeof l=="function"?l(P):l;return p.createElement(y4,G_({},f,{"aria-current":A,className:R,ref:r,style:O,to:c,viewTransition:d}),typeof u=="function"?u(P):u)});var mI;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(mI||(mI={}));var TF;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(TF||(TF={}));function Rde(e){let t=p.useContext(uC);return t||ro(!1),t}function Lde(e,t){let{target:r,replace:n,state:s,preventScrollReset:o,relative:i,viewTransition:l}=t===void 0?{}:t,c=zi(),d=$o(),u=mC(e,{relative:i});return p.useCallback(f=>{if(Cde(f,r)){f.preventDefault();let h=n!==void 0?n:V_(d)===V_(u);c(e,{replace:h,state:s,preventScrollReset:o,relative:i,viewTransition:l})}},[d,c,u,n,s,r,e,o,i,l])}function hC(e){let t=p.useRef(fI(e)),r=p.useRef(!1),n=$o(),s=p.useMemo(()=>Pde(n.search,r.current?null:t.current),[n.search]),o=zi(),i=p.useCallback((l,c)=>{const d=fI(typeof l=="function"?l(s):l);r.current=!0,o("?"+d,c)},[o,s]);return[s,i]}function Fde(e,t){t===void 0&&(t={});let r=p.useContext(Ide);r==null&&ro(!1);let{basename:n}=Rde(mI.useViewTransitionState),s=mC(e,{relative:t.relative});if(!r.isTransitioning)return!1;let o=kx(r.currentLocation.pathname,n)||r.currentLocation.pathname,i=kx(r.nextLocation.pathname,n)||r.nextLocation.pathname;return W_(s.pathname,i)!=null||W_(s.pathname,o)!=null}function zH(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=zH(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function fa(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=zH(e))&&(n&&(n+=" "),n+=t);return n}function $de(){for(var e=0,t,r,n="";e<arguments.length;)(t=arguments[e++])&&(r=UH(t))&&(n&&(n+=" "),n+=r);return n}function UH(e){if(typeof e=="string")return e;for(var t,r="",n=0;n<e.length;n++)e[n]&&(t=UH(e[n]))&&(r&&(r+=" "),r+=t);return r}var b4="-";function Bde(e){var t=zde(e),r=e.conflictingClassGroups,n=e.conflictingClassGroupModifiers,s=n===void 0?{}:n;function o(l){var c=l.split(b4);return c[0]===""&&c.length!==1&&c.shift(),VH(c,t)||qde(l)}function i(l,c){var d=r[l]||[];return c&&s[l]?[].concat(d,s[l]):d}return{getClassGroupId:o,getConflictingClassGroupIds:i}}function VH(e,t){if(e.length===0)return t.classGroupId;var r=e[0],n=t.nextPart.get(r),s=n?VH(e.slice(1),n):void 0;if(s)return s;if(t.validators.length!==0){var o=e.join(b4);return t.validators.find(function(i){var l=i.validator;return l(o)})?.classGroupId}}var DF=/^\[(.+)\]$/;function qde(e){if(DF.test(e)){var t=DF.exec(e)[1],r=t?.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}}function zde(e){var t=e.theme,r=e.prefix,n={nextPart:new Map,validators:[]},s=Vde(Object.entries(e.classGroups),r);return s.forEach(function(o){var i=o[0],l=o[1];hI(l,n,i,t)}),n}function hI(e,t,r,n){e.forEach(function(s){if(typeof s=="string"){var o=s===""?t:MF(t,s);o.classGroupId=r;return}if(typeof s=="function"){if(Ude(s)){hI(s(n),t,r,n);return}t.validators.push({validator:s,classGroupId:r});return}Object.entries(s).forEach(function(i){var l=i[0],c=i[1];hI(c,MF(t,l),r,n)})})}function MF(e,t){var r=e;return t.split(b4).forEach(function(n){r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r}function Ude(e){return e.isThemeGetter}function Vde(e,t){return t?e.map(function(r){var n=r[0],s=r[1],o=s.map(function(i){return typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(function(l){var c=l[0],d=l[1];return[t+c,d]})):i});return[n,o]}):e}function Wde(e){if(e<1)return{get:function(){},set:function(){}};var t=0,r=new Map,n=new Map;function s(o,i){r.set(o,i),t++,t>e&&(t=0,n=r,r=new Map)}return{get:function(i){var l=r.get(i);if(l!==void 0)return l;if((l=n.get(i))!==void 0)return s(i,l),l},set:function(i,l){r.has(i)?r.set(i,l):s(i,l)}}}var WH="!";function Hde(e){var t=e.separator||":",r=t.length===1,n=t[0],s=t.length;return function(i){for(var l=[],c=0,d=0,u,f=0;f<i.length;f++){var h=i[f];if(c===0){if(h===n&&(r||i.slice(f,f+s)===t)){l.push(i.slice(d,f)),d=f+s;continue}if(h==="/"){u=f;continue}}h==="["?c++:h==="]"&&c--}var m=l.length===0?i:i.substring(d),v=m.startsWith(WH),g=v?m.substring(1):m,y=u&&u>d?u-d:void 0;return{modifiers:l,hasImportantModifier:v,baseClassName:g,maybePostfixModifierPosition:y}}}function Gde(e){if(e.length<=1)return e;var t=[],r=[];return e.forEach(function(n){var s=n[0]==="[";s?(t.push.apply(t,r.sort().concat([n])),r=[]):r.push(n)}),t.push.apply(t,r.sort()),t}function Kde(e){return{cache:Wde(e.cacheSize),splitModifiers:Hde(e),...Bde(e)}}var Xde=/\s+/;function Yde(e,t){var r=t.splitModifiers,n=t.getClassGroupId,s=t.getConflictingClassGroupIds,o=new Set;return e.trim().split(Xde).map(function(i){var l=r(i),c=l.modifiers,d=l.hasImportantModifier,u=l.baseClassName,f=l.maybePostfixModifierPosition,h=n(f?u.substring(0,f):u),m=!!f;if(!h){if(!f)return{isTailwindClass:!1,originalClassName:i};if(h=n(u),!h)return{isTailwindClass:!1,originalClassName:i};m=!1}var v=Gde(c).join(":"),g=d?v+WH:v;return{isTailwindClass:!0,modifierId:g,classGroupId:h,originalClassName:i,hasPostfixModifier:m}}).reverse().filter(function(i){if(!i.isTailwindClass)return!0;var l=i.modifierId,c=i.classGroupId,d=i.hasPostfixModifier,u=l+c;return o.has(u)?!1:(o.add(u),s(c,d).forEach(function(f){return o.add(l+f)}),!0)}).reverse().map(function(i){return i.originalClassName}).join(" ")}function Jde(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,s,o,i=l;function l(d){var u=t[0],f=t.slice(1),h=f.reduce(function(m,v){return v(m)},u());return n=Kde(h),s=n.cache.get,o=n.cache.set,i=c,c(d)}function c(d){var u=s(d);if(u)return u;var f=Yde(d,n);return o(d,f),f}return function(){return i($de.apply(null,arguments))}}function Ds(e){var t=function(n){return n[e]||[]};return t.isThemeGetter=!0,t}var HH=/^\[(?:([a-z-]+):)?(.+)\]$/i,Qde=/^\d+\/\d+$/,Zde=new Set(["px","full","screen"]),eue=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,tue=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,rue=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function Hd(e){return Mp(e)||Zde.has(e)||Qde.test(e)||pI(e)}function pI(e){return Og(e,"length",lue)}function nue(e){return Og(e,"size",GH)}function aue(e){return Og(e,"position",GH)}function sue(e){return Og(e,"url",cue)}function F2(e){return Og(e,"number",Mp)}function Mp(e){return!Number.isNaN(Number(e))}function oue(e){return e.endsWith("%")&&Mp(e.slice(0,-1))}function dy(e){return RF(e)||Og(e,"number",RF)}function Oa(e){return HH.test(e)}function uy(){return!0}function Nm(e){return eue.test(e)}function iue(e){return Og(e,"",due)}function Og(e,t,r){var n=HH.exec(e);return n?n[1]?n[1]===t:r(n[2]):!1}function lue(e){return tue.test(e)}function GH(){return!1}function cue(e){return e.startsWith("url(")}function RF(e){return Number.isInteger(Number(e))}function due(e){return rue.test(e)}function uue(){var e=Ds("colors"),t=Ds("spacing"),r=Ds("blur"),n=Ds("brightness"),s=Ds("borderColor"),o=Ds("borderRadius"),i=Ds("borderSpacing"),l=Ds("borderWidth"),c=Ds("contrast"),d=Ds("grayscale"),u=Ds("hueRotate"),f=Ds("invert"),h=Ds("gap"),m=Ds("gradientColorStops"),v=Ds("gradientColorStopPositions"),g=Ds("inset"),y=Ds("margin"),x=Ds("opacity"),b=Ds("padding"),w=Ds("saturate"),j=Ds("scale"),_=Ds("sepia"),S=Ds("skew"),C=Ds("space"),P=Ds("translate"),A=function(){return["auto","contain","none"]},R=function(){return["auto","hidden","clip","visible","scroll"]},O=function(){return["auto",Oa,t]},I=function(){return[Oa,t]},M=function(){return["",Hd]},D=function(){return["auto",Mp,Oa]},U=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},z=function(){return["solid","dashed","dotted","double","none"]},W=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},$=function(){return["start","end","center","between","around","evenly","stretch"]},X=function(){return["","0",Oa]},ye=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},Se=function(){return[Mp,F2]},V=function(){return[Mp,Oa]};return{cacheSize:500,theme:{colors:[uy],spacing:[Hd],blur:["none","",Nm,Oa],brightness:Se(),borderColor:[e],borderRadius:["none","","full",Nm,Oa],borderSpacing:I(),borderWidth:M(),contrast:Se(),grayscale:X(),hueRotate:V(),invert:X(),gap:I(),gradientColorStops:[e],gradientColorStopPositions:[oue,pI],inset:O(),margin:O(),opacity:Se(),padding:I(),saturate:Se(),scale:Se(),sepia:X(),skew:V(),space:I(),translate:I()},classGroups:{aspect:[{aspect:["auto","square","video",Oa]}],container:["container"],columns:[{columns:[Nm]}],"break-after":[{"break-after":ye()}],"break-before":[{"break-before":ye()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(U(),[Oa])}],overflow:[{overflow:R()}],"overflow-x":[{"overflow-x":R()}],"overflow-y":[{"overflow-y":R()}],overscroll:[{overscroll:A()}],"overscroll-x":[{"overscroll-x":A()}],"overscroll-y":[{"overscroll-y":A()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",dy]}],basis:[{basis:O()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Oa]}],grow:[{grow:X()}],shrink:[{shrink:X()}],order:[{order:["first","last","none",dy]}],"grid-cols":[{"grid-cols":[uy]}],"col-start-end":[{col:["auto",{span:["full",dy]},Oa]}],"col-start":[{"col-start":D()}],"col-end":[{"col-end":D()}],"grid-rows":[{"grid-rows":[uy]}],"row-start-end":[{row:["auto",{span:[dy]},Oa]}],"row-start":[{"row-start":D()}],"row-end":[{"row-end":D()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Oa]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Oa]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal"].concat($())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat($(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat($(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[C]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[C]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",Oa,t]}],"min-w":[{"min-w":["min","max","fit",Oa,Hd]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[Nm]},Nm,Oa]}],h:[{h:[Oa,t,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",Oa,Hd]}],"max-h":[{"max-h":[Oa,t,"min","max","fit"]}],"font-size":[{text:["base",Nm,pI]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",F2]}],"font-family":[{font:[uy]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Oa]}],"line-clamp":[{"line-clamp":["none",Mp,F2]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Oa,Hd]}],"list-image":[{"list-image":["none",Oa]}],"list-style-type":[{list:["none","disc","decimal",Oa]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(z(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",Hd]}],"underline-offset":[{"underline-offset":["auto",Oa,Hd]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:I()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Oa]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Oa]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(U(),[aue])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",nue]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},sue]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[].concat(z(),["hidden"])}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:z()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:[""].concat(z())}],"outline-offset":[{"outline-offset":[Oa,Hd]}],"outline-w":[{outline:[Hd]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:M()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[Hd]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Nm,iue]}],"shadow-color":[{shadow:[uy]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":W()}],"bg-blend":[{"bg-blend":W()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Nm,Oa]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[f]}],saturate:[{saturate:[w]}],sepia:[{sepia:[_]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[_]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Oa]}],duration:[{duration:V()}],ease:[{ease:["linear","in","out","in-out",Oa]}],delay:[{delay:V()}],animate:[{animate:["none","spin","ping","pulse","bounce",Oa]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[j]}],"scale-x":[{"scale-x":[j]}],"scale-y":[{"scale-y":[j]}],rotate:[{rotate:[dy,Oa]}],"translate-x":[{"translate-x":[P]}],"translate-y":[{"translate-y":[P]}],"skew-x":[{"skew-x":[S]}],"skew-y":[{"skew-y":[S]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Oa]}],accent:[{accent:["auto",e]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Oa]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":I()}],"scroll-mx":[{"scroll-mx":I()}],"scroll-my":[{"scroll-my":I()}],"scroll-ms":[{"scroll-ms":I()}],"scroll-me":[{"scroll-me":I()}],"scroll-mt":[{"scroll-mt":I()}],"scroll-mr":[{"scroll-mr":I()}],"scroll-mb":[{"scroll-mb":I()}],"scroll-ml":[{"scroll-ml":I()}],"scroll-p":[{"scroll-p":I()}],"scroll-px":[{"scroll-px":I()}],"scroll-py":[{"scroll-py":I()}],"scroll-ps":[{"scroll-ps":I()}],"scroll-pe":[{"scroll-pe":I()}],"scroll-pt":[{"scroll-pt":I()}],"scroll-pr":[{"scroll-pr":I()}],"scroll-pb":[{"scroll-pb":I()}],"scroll-pl":[{"scroll-pl":I()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Oa]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Hd,F2]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var fue=Jde(uue);function pr(...e){return fue(fa(e))}const LF=["#3B82F6","#22C55E","#F59E0B","#8B5CF6","#EC4899","#06B6D4","#F43F5E","#10B981","#A855F7","#EAB308"];function mue(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return Math.abs(t)}function $m(e){if(!e)return"#94A3B8";const t=mue(String(e))%LF.length;return LF[t]}var hue={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const pue=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),$r=(e,t)=>{const r=p.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:o=2,absoluteStrokeWidth:i,children:l,...c},d)=>p.createElement("svg",{ref:d,...hue,width:s,height:s,stroke:n,strokeWidth:i?Number(o)*24/Number(s):o,className:`lucide lucide-${pue(e)}`,...c},[...t.map(([u,f])=>p.createElement(u,f)),...(Array.isArray(l)?l:[l])||[]]));return r.displayName=`${e}`,r},Bc=$r("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Xf=$r("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),gue=$r("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]),tb=$r("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),$2=$r("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),w4=$r("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),j4=$r("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]),_4=$r("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]),e_=$r("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),rb=$r("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),KH=$r("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),vue=$r("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]),K_=$r("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),xue=$r("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),pC=$r("CalendarCheck",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]),yue=$r("CalendarDays",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),N4=$r("CalendarPlus",[["path",{d:"M21 13V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"3spt84"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["line",{x1:"19",x2:"19",y1:"16",y2:"22",key:"1ttwzi"}],["line",{x1:"16",x2:"22",y1:"19",y2:"19",key:"1g9955"}]]),t_=$r("CalendarX",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["line",{x1:"10",x2:"14",y1:"14",y2:"18",key:"1g3qc0"}],["line",{x1:"14",x2:"10",y1:"14",y2:"18",key:"1az83m"}]]),Bs=$r("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),B2=$r("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Ro=$r("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),Yf=$r("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),Tg=$r("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),XH=$r("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),j0=$r("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),bue=$r("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),wue=$r("Chrome",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["line",{x1:"21.17",x2:"12",y1:"8",y2:"8",key:"a0cw5f"}],["line",{x1:"3.95",x2:"8.54",y1:"6.06",y2:"14",key:"1kftof"}],["line",{x1:"10.88",x2:"15.46",y1:"21.94",y2:"14",key:"1ymyh8"}]]),jue=$r("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),_ue=$r("ClipboardCopy",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2",key:"4jdomd"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v4",key:"3hqy98"}],["path",{d:"M21 14H11",key:"1bme5i"}],["path",{d:"m15 10-4 4 4 4",key:"5dvupr"}]]),Pd=$r("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),YH=$r("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),Qm=$r("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),ei=$r("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),uo=$r("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Yp=$r("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),hg=$r("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Zg=$r("FileDown",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]),Zo=$r("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),gI=$r("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),Nue=$r("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]),Sue=$r("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]),Cue=$r("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]),Pue=$r("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),Aue=$r("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),Eue=$r("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),kue=$r("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),JH=$r("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Iue=$r("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",key:"1kog09"}]]),Oue=$r("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]),Tue=$r("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),QH=$r("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]),ZH=$r("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]),Due=$r("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),Tc=$r("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),Ix=$r("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),Mue=$r("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),Rue=$r("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),Ox=$r("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),FF=$r("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),Lue=$r("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),aA=$r("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),Fue=$r("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),$F=$r("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),Vv=$r("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),$ue=$r("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),BF=$r("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),Td=$r("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),Cl=$r("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),tw=$r("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),eG=$r("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]),Ja=$r("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),tG=$r("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]),Jp=$r("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),qF=$r("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),Bue=$r("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Zs=$r("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),S4=$r("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),Ad=$r("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),zF=$r("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]),que=$r("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),lx=$r("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]),y1=$r("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),UF=$r("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]),sA=$r("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),vI=$r("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),zue=$r("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),C4=$r("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]),q2=$r("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),Ju=$r("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Uue=$r("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),Jf=$r("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),Dc=$r("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),Vue=$r("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]),rG=$r("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),P4=$r("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),Wue=$r("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),Hue=$r("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]),Gue=$r("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),nG=$r("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),Uu=$r("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Pl=$r("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),aG=$r("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]),Qp=$r("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),al=$r("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),gi=({size:e="md",variant:t="header",className:r=""})=>{const n={xs:"w-8 h-8",sm:"w-10 h-10",md:"w-14 h-14",lg:"w-20 h-20",xl:"w-24 h-24"},s={header:"/isis-profile.png",message:"/isis-profile-baloon.png"},o=s[t]||s.header,i=e==="lg"?"scale-125":e==="md"?"scale-110":"scale-100";return a.jsx("div",{className:`${n[e]||n.md} rounded-full overflow-hidden flex-shrink-0 ring-2 ring-brand ring-offset-0 ${r}`,children:a.jsx("img",{src:o,alt:"Assistente Virtual",className:`w-full h-full object-cover ${i}`,onError:l=>{l.target.style.display="none",l.target.parentElement.innerHTML=`
            <div class="w-full h-full bg-brand flex items-center justify-center">
              <span class="text-bg font-bold text-lg">A</span>
            </div>
          `}})})},sG=p.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),gC=p.createContext({}),vC=p.createContext(null),xC=typeof document<"u",A4=xC?p.useLayoutEffect:p.useEffect,oG=p.createContext({strict:!1}),E4=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),Kue="framerAppearId",iG="data-"+E4(Kue);function Xue(e,t,r,n){const{visualElement:s}=p.useContext(gC),o=p.useContext(oG),i=p.useContext(vC),l=p.useContext(sG).reducedMotion,c=p.useRef();n=n||o.renderer,!c.current&&n&&(c.current=n(e,{visualState:t,parent:s,props:r,presenceContext:i,blockInitialAnimation:i?i.initial===!1:!1,reducedMotionConfig:l}));const d=c.current;p.useInsertionEffect(()=>{d&&d.update(r,i)});const u=p.useRef(!!(r[iG]&&!window.HandoffComplete));return A4(()=>{d&&(d.render(),u.current&&d.animationState&&d.animationState.animateChanges())}),p.useEffect(()=>{d&&(d.updateFeatures(),!u.current&&d.animationState&&d.animationState.animateChanges(),u.current&&(u.current=!1,window.HandoffComplete=!0))}),d}function Wv(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Yue(e,t,r){return p.useCallback(n=>{n&&e.mount&&e.mount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):Wv(r)&&(r.current=n))},[t])}function rw(e){return typeof e=="string"||Array.isArray(e)}function yC(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const k4=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],I4=["initial",...k4];function bC(e){return yC(e.animate)||I4.some(t=>rw(e[t]))}function lG(e){return!!(bC(e)||e.variants)}function Jue(e,t){if(bC(e)){const{initial:r,animate:n}=e;return{initial:r===!1||rw(r)?r:void 0,animate:rw(n)?n:void 0}}return e.inherit!==!1?t:{}}function Que(e){const{initial:t,animate:r}=Jue(e,p.useContext(gC));return p.useMemo(()=>({initial:t,animate:r}),[VF(t),VF(r)])}function VF(e){return Array.isArray(e)?e.join(" "):e}const WF={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},nw={};for(const e in WF)nw[e]={isEnabled:t=>WF[e].some(r=>!!t[r])};function Zue(e){for(const t in e)nw[t]={...nw[t],...e[t]}}const O4=p.createContext({}),cG=p.createContext({}),efe=Symbol.for("motionComponentSymbol");function tfe({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:n,Component:s}){e&&Zue(e);function o(l,c){let d;const u={...p.useContext(sG),...l,layoutId:rfe(l)},{isStatic:f}=u,h=Que(l),m=n(l,f);if(!f&&xC){h.visualElement=Xue(s,m,u,t);const v=p.useContext(cG),g=p.useContext(oG).strict;h.visualElement&&(d=h.visualElement.loadFeatures(u,g,e,v))}return p.createElement(gC.Provider,{value:h},d&&h.visualElement?p.createElement(d,{visualElement:h.visualElement,...u}):null,r(s,l,Yue(m,h.visualElement,c),m,f,h.visualElement))}const i=p.forwardRef(o);return i[efe]=s,i}function rfe({layoutId:e}){const t=p.useContext(O4).id;return t&&e!==void 0?t+"-"+e:e}function nfe(e){function t(n,s={}){return tfe(e(n,s))}if(typeof Proxy>"u")return t;const r=new Map;return new Proxy(t,{get:(n,s)=>(r.has(s)||r.set(s,t(s)),r.get(s))})}const afe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function T4(e){return typeof e!="string"||e.includes("-")?!1:!!(afe.indexOf(e)>-1||/[A-Z]/.test(e))}const X_={};function sfe(e){Object.assign(X_,e)}const b1=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Dg=new Set(b1);function dG(e,{layout:t,layoutId:r}){return Dg.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!X_[e]||e==="opacity")}const lc=e=>!!(e&&e.getVelocity),ofe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},ife=b1.length;function lfe(e,{enableHardwareAcceleration:t=!0,allowTransformNone:r=!0},n,s){let o="";for(let i=0;i<ife;i++){const l=b1[i];if(e[l]!==void 0){const c=ofe[l]||l;o+=`${c}(${e[l]}) `}}return t&&!e.z&&(o+="translateZ(0)"),o=o.trim(),s?o=s(e,n?"":o):r&&n&&(o="none"),o}const uG=e=>t=>typeof t=="string"&&t.startsWith(e),fG=uG("--"),xI=uG("var(--"),cfe=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,dfe=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Ih=(e,t,r)=>Math.min(Math.max(r,e),t),Mg={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},nb={...Mg,transform:e=>Ih(0,1,e)},z2={...Mg,default:1},ab=e=>Math.round(e*1e5)/1e5,wC=/(-)?([\d]*\.?[\d])+/g,mG=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,ufe=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function w1(e){return typeof e=="string"}const j1=e=>({test:t=>w1(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Om=j1("deg"),Qu=j1("%"),ra=j1("px"),ffe=j1("vh"),mfe=j1("vw"),HF={...Qu,parse:e=>Qu.parse(e)/100,transform:e=>Qu.transform(e*100)},GF={...Mg,transform:Math.round},hG={borderWidth:ra,borderTopWidth:ra,borderRightWidth:ra,borderBottomWidth:ra,borderLeftWidth:ra,borderRadius:ra,radius:ra,borderTopLeftRadius:ra,borderTopRightRadius:ra,borderBottomRightRadius:ra,borderBottomLeftRadius:ra,width:ra,maxWidth:ra,height:ra,maxHeight:ra,size:ra,top:ra,right:ra,bottom:ra,left:ra,padding:ra,paddingTop:ra,paddingRight:ra,paddingBottom:ra,paddingLeft:ra,margin:ra,marginTop:ra,marginRight:ra,marginBottom:ra,marginLeft:ra,rotate:Om,rotateX:Om,rotateY:Om,rotateZ:Om,scale:z2,scaleX:z2,scaleY:z2,scaleZ:z2,skew:Om,skewX:Om,skewY:Om,distance:ra,translateX:ra,translateY:ra,translateZ:ra,x:ra,y:ra,z:ra,perspective:ra,transformPerspective:ra,opacity:nb,originX:HF,originY:HF,originZ:ra,zIndex:GF,fillOpacity:nb,strokeOpacity:nb,numOctaves:GF};function D4(e,t,r,n){const{style:s,vars:o,transform:i,transformOrigin:l}=e;let c=!1,d=!1,u=!0;for(const f in t){const h=t[f];if(fG(f)){o[f]=h;continue}const m=hG[f],v=dfe(h,m);if(Dg.has(f)){if(c=!0,i[f]=v,!u)continue;h!==(m.default||0)&&(u=!1)}else f.startsWith("origin")?(d=!0,l[f]=v):s[f]=v}if(t.transform||(c||n?s.transform=lfe(e.transform,r,u,n):s.transform&&(s.transform="none")),d){const{originX:f="50%",originY:h="50%",originZ:m=0}=l;s.transformOrigin=`${f} ${h} ${m}`}}const M4=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function pG(e,t,r){for(const n in t)!lc(t[n])&&!dG(n,r)&&(e[n]=t[n])}function hfe({transformTemplate:e},t,r){return p.useMemo(()=>{const n=M4();return D4(n,t,{enableHardwareAcceleration:!r},e),Object.assign({},n.vars,n.style)},[t])}function pfe(e,t,r){const n=e.style||{},s={};return pG(s,n,e),Object.assign(s,hfe(e,t,r)),e.transformValues?e.transformValues(s):s}function gfe(e,t,r){const n={},s=pfe(e,t,r);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=s,n}const vfe=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Y_(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||vfe.has(e)}let gG=e=>!Y_(e);function xfe(e){e&&(gG=t=>t.startsWith("on")?!Y_(t):e(t))}try{xfe(require("@emotion/is-prop-valid").default)}catch{}function yfe(e,t,r){const n={};for(const s in e)s==="values"&&typeof e.values=="object"||(gG(s)||r===!0&&Y_(s)||!t&&!Y_(s)||e.draggable&&s.startsWith("onDrag"))&&(n[s]=e[s]);return n}function KF(e,t,r){return typeof e=="string"?e:ra.transform(t+r*e)}function bfe(e,t,r){const n=KF(t,e.x,e.width),s=KF(r,e.y,e.height);return`${n} ${s}`}const wfe={offset:"stroke-dashoffset",array:"stroke-dasharray"},jfe={offset:"strokeDashoffset",array:"strokeDasharray"};function _fe(e,t,r=1,n=0,s=!0){e.pathLength=1;const o=s?wfe:jfe;e[o.offset]=ra.transform(-n);const i=ra.transform(t),l=ra.transform(r);e[o.array]=`${i} ${l}`}function R4(e,{attrX:t,attrY:r,attrScale:n,originX:s,originY:o,pathLength:i,pathSpacing:l=1,pathOffset:c=0,...d},u,f,h){if(D4(e,d,u,h),f){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:m,style:v,dimensions:g}=e;m.transform&&(g&&(v.transform=m.transform),delete m.transform),g&&(s!==void 0||o!==void 0||v.transform)&&(v.transformOrigin=bfe(g,s!==void 0?s:.5,o!==void 0?o:.5)),t!==void 0&&(m.x=t),r!==void 0&&(m.y=r),n!==void 0&&(m.scale=n),i!==void 0&&_fe(m,i,l,c,!1)}const vG=()=>({...M4(),attrs:{}}),L4=e=>typeof e=="string"&&e.toLowerCase()==="svg";function Nfe(e,t,r,n){const s=p.useMemo(()=>{const o=vG();return R4(o,t,{enableHardwareAcceleration:!1},L4(n),e.transformTemplate),{...o.attrs,style:{...o.style}}},[t]);if(e.style){const o={};pG(o,e.style,e),s.style={...o,...s.style}}return s}function Sfe(e=!1){return(r,n,s,{latestValues:o},i)=>{const c=(T4(r)?Nfe:gfe)(n,o,i,r),u={...yfe(n,typeof r=="string",e),...c,ref:s},{children:f}=n,h=p.useMemo(()=>lc(f)?f.get():f,[f]);return p.createElement(r,{...u,children:h})}}function xG(e,{style:t,vars:r},n,s){Object.assign(e.style,t,s&&s.getProjectionStyles(n));for(const o in r)e.style.setProperty(o,r[o])}const yG=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function bG(e,t,r,n){xG(e,t,void 0,n);for(const s in t.attrs)e.setAttribute(yG.has(s)?s:E4(s),t.attrs[s])}function F4(e,t){const{style:r}=e,n={};for(const s in r)(lc(r[s])||t.style&&lc(t.style[s])||dG(s,e))&&(n[s]=r[s]);return n}function wG(e,t){const r=F4(e,t);for(const n in e)if(lc(e[n])||lc(t[n])){const s=b1.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;r[s]=e[n]}return r}function $4(e,t,r,n={},s={}){return typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,s)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,s)),t}function jG(e){const t=p.useRef(null);return t.current===null&&(t.current=e()),t.current}const J_=e=>Array.isArray(e),Cfe=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),Pfe=e=>J_(e)?e[e.length-1]||0:e;function r_(e){const t=lc(e)?e.get():e;return Cfe(t)?t.toValue():t}function Afe({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:r},n,s,o){const i={latestValues:Efe(n,s,o,e),renderState:t()};return r&&(i.mount=l=>r(n,l,i)),i}const _G=e=>(t,r)=>{const n=p.useContext(gC),s=p.useContext(vC),o=()=>Afe(e,t,n,s);return r?o():jG(o)};function Efe(e,t,r,n){const s={},o=n(e,{});for(const h in o)s[h]=r_(o[h]);let{initial:i,animate:l}=e;const c=bC(e),d=lG(e);t&&d&&!c&&e.inherit!==!1&&(i===void 0&&(i=t.initial),l===void 0&&(l=t.animate));let u=r?r.initial===!1:!1;u=u||i===!1;const f=u?l:i;return f&&typeof f!="boolean"&&!yC(f)&&(Array.isArray(f)?f:[f]).forEach(m=>{const v=$4(e,m);if(!v)return;const{transitionEnd:g,transition:y,...x}=v;for(const b in x){let w=x[b];if(Array.isArray(w)){const j=u?w.length-1:0;w=w[j]}w!==null&&(s[b]=w)}for(const b in g)s[b]=g[b]}),s}const mo=e=>e;class XF{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const r=this.order.indexOf(t);r!==-1&&(this.order.splice(r,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}function kfe(e){let t=new XF,r=new XF,n=0,s=!1,o=!1;const i=new WeakSet,l={schedule:(c,d=!1,u=!1)=>{const f=u&&s,h=f?t:r;return d&&i.add(c),h.add(c)&&f&&s&&(n=t.order.length),c},cancel:c=>{r.remove(c),i.delete(c)},process:c=>{if(s){o=!0;return}if(s=!0,[t,r]=[r,t],r.clear(),n=t.order.length,n)for(let d=0;d<n;d++){const u=t.order[d];u(c),i.has(u)&&(l.schedule(u),e())}s=!1,o&&(o=!1,l.process(c))}};return l}const U2=["prepare","read","update","preRender","render","postRender"],Ife=40;function Ofe(e,t){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},o=U2.reduce((f,h)=>(f[h]=kfe(()=>r=!0),f),{}),i=f=>o[f].process(s),l=()=>{const f=performance.now();r=!1,s.delta=n?1e3/60:Math.max(Math.min(f-s.timestamp,Ife),1),s.timestamp=f,s.isProcessing=!0,U2.forEach(i),s.isProcessing=!1,r&&t&&(n=!1,e(l))},c=()=>{r=!0,n=!0,s.isProcessing||e(l)};return{schedule:U2.reduce((f,h)=>{const m=o[h];return f[h]=(v,g=!1,y=!1)=>(r||c(),m.schedule(v,g,y)),f},{}),cancel:f=>U2.forEach(h=>o[h].cancel(f)),state:s,steps:o}}const{schedule:Cs,cancel:Qf,state:Qi,steps:oA}=Ofe(typeof requestAnimationFrame<"u"?requestAnimationFrame:mo,!0),Tfe={useVisualState:_G({scrapeMotionValuesFromProps:wG,createRenderState:vG,onMount:(e,t,{renderState:r,latestValues:n})=>{Cs.read(()=>{try{r.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{r.dimensions={x:0,y:0,width:0,height:0}}}),Cs.render(()=>{R4(r,n,{enableHardwareAcceleration:!1},L4(t.tagName),e.transformTemplate),bG(t,r)})}})},Dfe={useVisualState:_G({scrapeMotionValuesFromProps:F4,createRenderState:M4})};function Mfe(e,{forwardMotionProps:t=!1},r,n){return{...T4(e)?Tfe:Dfe,preloadedFeatures:r,useRender:Sfe(t),createVisualElement:n,Component:e}}function Mf(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}const NG=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function jC(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const Rfe=e=>t=>NG(t)&&e(t,jC(t));function qf(e,t,r,n){return Mf(e,t,Rfe(r),n)}const Lfe=(e,t)=>r=>t(e(r)),ph=(...e)=>e.reduce(Lfe);function SG(e){let t=null;return()=>{const r=()=>{t=null};return t===null?(t=e,r):!1}}const YF=SG("dragHorizontal"),JF=SG("dragVertical");function CG(e){let t=!1;if(e==="y")t=JF();else if(e==="x")t=YF();else{const r=YF(),n=JF();r&&n?t=()=>{r(),n()}:(r&&r(),n&&n())}return t}function PG(){const e=CG(!0);return e?(e(),!1):!0}class Wh{constructor(t){this.isMounted=!1,this.node=t}update(){}}function QF(e,t){const r="pointer"+(t?"enter":"leave"),n="onHover"+(t?"Start":"End"),s=(o,i)=>{if(o.pointerType==="touch"||PG())return;const l=e.getProps();e.animationState&&l.whileHover&&e.animationState.setActive("whileHover",t),l[n]&&Cs.update(()=>l[n](o,i))};return qf(e.current,r,s,{passive:!e.getProps()[n]})}class Ffe extends Wh{mount(){this.unmount=ph(QF(this.node,!0),QF(this.node,!1))}unmount(){}}class $fe extends Wh{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=ph(Mf(this.node.current,"focus",()=>this.onFocus()),Mf(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const AG=(e,t)=>t?e===t?!0:AG(e,t.parentElement):!1;function iA(e,t){if(!t)return;const r=new PointerEvent("pointer"+e);t(r,jC(r))}class Bfe extends Wh{constructor(){super(...arguments),this.removeStartListeners=mo,this.removeEndListeners=mo,this.removeAccessibleListeners=mo,this.startPointerPress=(t,r)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),o=qf(window,"pointerup",(l,c)=>{if(!this.checkPressEnd())return;const{onTap:d,onTapCancel:u,globalTapTarget:f}=this.node.getProps();Cs.update(()=>{!f&&!AG(this.node.current,l.target)?u&&u(l,c):d&&d(l,c)})},{passive:!(n.onTap||n.onPointerUp)}),i=qf(window,"pointercancel",(l,c)=>this.cancelPress(l,c),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=ph(o,i),this.startPress(t,r)},this.startAccessiblePress=()=>{const t=o=>{if(o.key!=="Enter"||this.isPressing)return;const i=l=>{l.key!=="Enter"||!this.checkPressEnd()||iA("up",(c,d)=>{const{onTap:u}=this.node.getProps();u&&Cs.update(()=>u(c,d))})};this.removeEndListeners(),this.removeEndListeners=Mf(this.node.current,"keyup",i),iA("down",(l,c)=>{this.startPress(l,c)})},r=Mf(this.node.current,"keydown",t),n=()=>{this.isPressing&&iA("cancel",(o,i)=>this.cancelPress(o,i))},s=Mf(this.node.current,"blur",n);this.removeAccessibleListeners=ph(r,s)}}startPress(t,r){this.isPressing=!0;const{onTapStart:n,whileTap:s}=this.node.getProps();s&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&Cs.update(()=>n(t,r))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!PG()}cancelPress(t,r){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&Cs.update(()=>n(t,r))}mount(){const t=this.node.getProps(),r=qf(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),n=Mf(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=ph(r,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const yI=new WeakMap,lA=new WeakMap,qfe=e=>{const t=yI.get(e.target);t&&t(e)},zfe=e=>{e.forEach(qfe)};function Ufe({root:e,...t}){const r=e||document;lA.has(r)||lA.set(r,{});const n=lA.get(r),s=JSON.stringify(t);return n[s]||(n[s]=new IntersectionObserver(zfe,{root:e,...t})),n[s]}function Vfe(e,t,r){const n=Ufe(t);return yI.set(e,r),n.observe(e),()=>{yI.delete(e),n.unobserve(e)}}const Wfe={some:0,all:1};class Hfe extends Wh{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:o}=t,i={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:Wfe[s]},l=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,o&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:u,onViewportLeave:f}=this.node.getProps(),h=d?u:f;h&&h(c)};return Vfe(this.node.current,i,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(Gfe(t,r))&&this.startObserver()}unmount(){}}function Gfe({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const Kfe={inView:{Feature:Hfe},tap:{Feature:Bfe},focus:{Feature:$fe},hover:{Feature:Ffe}};function EG(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}function Xfe(e){const t={};return e.values.forEach((r,n)=>t[n]=r.get()),t}function Yfe(e){const t={};return e.values.forEach((r,n)=>t[n]=r.getVelocity()),t}function _C(e,t,r){const n=e.getProps();return $4(n,t,r!==void 0?r:n.custom,Xfe(e),Yfe(e))}let Jfe=mo,B4=mo;const gh=e=>e*1e3,zf=e=>e/1e3,Qfe={current:!1},kG=e=>Array.isArray(e)&&typeof e[0]=="number";function IG(e){return!!(!e||typeof e=="string"&&OG[e]||kG(e)||Array.isArray(e)&&e.every(IG))}const $y=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,OG={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:$y([0,.65,.55,1]),circOut:$y([.55,0,1,.45]),backIn:$y([.31,.01,.66,-.59]),backOut:$y([.33,1.53,.69,.99])};function TG(e){if(e)return kG(e)?$y(e):Array.isArray(e)?e.map(TG):OG[e]}function Zfe(e,t,r,{delay:n=0,duration:s,repeat:o=0,repeatType:i="loop",ease:l,times:c}={}){const d={[t]:r};c&&(d.offset=c);const u=TG(l);return Array.isArray(u)&&(d.easing=u),e.animate(d,{delay:n,duration:s,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:o+1,direction:i==="reverse"?"alternate":"normal"})}function eme(e,{repeat:t,repeatType:r="loop"}){const n=t&&r!=="loop"&&t%2===1?0:e.length-1;return e[n]}const DG=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,tme=1e-7,rme=12;function nme(e,t,r,n,s){let o,i,l=0;do i=t+(r-t)/2,o=DG(i,n,s)-e,o>0?r=i:t=i;while(Math.abs(o)>tme&&++l<rme);return i}function _1(e,t,r,n){if(e===t&&r===n)return mo;const s=o=>nme(o,0,1,e,r);return o=>o===0||o===1?o:DG(s(o),t,n)}const ame=_1(.42,0,1,1),sme=_1(0,0,.58,1),MG=_1(.42,0,.58,1),ome=e=>Array.isArray(e)&&typeof e[0]!="number",RG=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,LG=e=>t=>1-e(1-t),q4=e=>1-Math.sin(Math.acos(e)),FG=LG(q4),ime=RG(q4),$G=_1(.33,1.53,.69,.99),z4=LG($G),lme=RG(z4),cme=e=>(e*=2)<1?.5*z4(e):.5*(2-Math.pow(2,-10*(e-1))),dme={linear:mo,easeIn:ame,easeInOut:MG,easeOut:sme,circIn:q4,circInOut:ime,circOut:FG,backIn:z4,backInOut:lme,backOut:$G,anticipate:cme},ZF=e=>{if(Array.isArray(e)){B4(e.length===4);const[t,r,n,s]=e;return _1(t,r,n,s)}else if(typeof e=="string")return dme[e];return e},U4=(e,t)=>r=>!!(w1(r)&&ufe.test(r)&&r.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(r,t)),BG=(e,t,r)=>n=>{if(!w1(n))return n;const[s,o,i,l]=n.match(wC);return{[e]:parseFloat(s),[t]:parseFloat(o),[r]:parseFloat(i),alpha:l!==void 0?parseFloat(l):1}},ume=e=>Ih(0,255,e),cA={...Mg,transform:e=>Math.round(ume(e))},Rp={test:U4("rgb","red"),parse:BG("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+cA.transform(e)+", "+cA.transform(t)+", "+cA.transform(r)+", "+ab(nb.transform(n))+")"};function fme(e){let t="",r="",n="",s="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),s=e.substring(4,5),t+=t,r+=r,n+=n,s+=s),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const bI={test:U4("#"),parse:fme,transform:Rp.transform},Hv={test:U4("hsl","hue"),parse:BG("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+Qu.transform(ab(t))+", "+Qu.transform(ab(r))+", "+ab(nb.transform(n))+")"},jl={test:e=>Rp.test(e)||bI.test(e)||Hv.test(e),parse:e=>Rp.test(e)?Rp.parse(e):Hv.test(e)?Hv.parse(e):bI.parse(e),transform:e=>w1(e)?e:e.hasOwnProperty("red")?Rp.transform(e):Hv.transform(e)},eo=(e,t,r)=>-r*e+r*t+e;function dA(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function mme({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let s=0,o=0,i=0;if(!t)s=o=i=r;else{const l=r<.5?r*(1+t):r+t-r*t,c=2*r-l;s=dA(c,l,e+1/3),o=dA(c,l,e),i=dA(c,l,e-1/3)}return{red:Math.round(s*255),green:Math.round(o*255),blue:Math.round(i*255),alpha:n}}const uA=(e,t,r)=>{const n=e*e;return Math.sqrt(Math.max(0,r*(t*t-n)+n))},hme=[bI,Rp,Hv],pme=e=>hme.find(t=>t.test(e));function e$(e){const t=pme(e);let r=t.parse(e);return t===Hv&&(r=mme(r)),r}const qG=(e,t)=>{const r=e$(e),n=e$(t),s={...r};return o=>(s.red=uA(r.red,n.red,o),s.green=uA(r.green,n.green,o),s.blue=uA(r.blue,n.blue,o),s.alpha=eo(r.alpha,n.alpha,o),Rp.transform(s))};function gme(e){var t,r;return isNaN(e)&&w1(e)&&(((t=e.match(wC))===null||t===void 0?void 0:t.length)||0)+(((r=e.match(mG))===null||r===void 0?void 0:r.length)||0)>0}const zG={regex:cfe,countKey:"Vars",token:"${v}",parse:mo},UG={regex:mG,countKey:"Colors",token:"${c}",parse:jl.parse},VG={regex:wC,countKey:"Numbers",token:"${n}",parse:Mg.parse};function fA(e,{regex:t,countKey:r,token:n,parse:s}){const o=e.tokenised.match(t);o&&(e["num"+r]=o.length,e.tokenised=e.tokenised.replace(t,n),e.values.push(...o.map(s)))}function Q_(e){const t=e.toString(),r={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return r.value.includes("var(--")&&fA(r,zG),fA(r,UG),fA(r,VG),r}function WG(e){return Q_(e).values}function HG(e){const{values:t,numColors:r,numVars:n,tokenised:s}=Q_(e),o=t.length;return i=>{let l=s;for(let c=0;c<o;c++)c<n?l=l.replace(zG.token,i[c]):c<n+r?l=l.replace(UG.token,jl.transform(i[c])):l=l.replace(VG.token,ab(i[c]));return l}}const vme=e=>typeof e=="number"?0:e;function xme(e){const t=WG(e);return HG(e)(t.map(vme))}const Oh={test:gme,parse:WG,createTransformer:HG,getAnimatableNone:xme},GG=(e,t)=>r=>`${r>0?t:e}`;function KG(e,t){return typeof e=="number"?r=>eo(e,t,r):jl.test(e)?qG(e,t):e.startsWith("var(")?GG(e,t):YG(e,t)}const XG=(e,t)=>{const r=[...e],n=r.length,s=e.map((o,i)=>KG(o,t[i]));return o=>{for(let i=0;i<n;i++)r[i]=s[i](o);return r}},yme=(e,t)=>{const r={...e,...t},n={};for(const s in r)e[s]!==void 0&&t[s]!==void 0&&(n[s]=KG(e[s],t[s]));return s=>{for(const o in n)r[o]=n[o](s);return r}},YG=(e,t)=>{const r=Oh.createTransformer(t),n=Q_(e),s=Q_(t);return n.numVars===s.numVars&&n.numColors===s.numColors&&n.numNumbers>=s.numNumbers?ph(XG(n.values,s.values),r):GG(e,t)},aw=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n},t$=(e,t)=>r=>eo(e,t,r);function bme(e){return typeof e=="number"?t$:typeof e=="string"?jl.test(e)?qG:YG:Array.isArray(e)?XG:typeof e=="object"?yme:t$}function wme(e,t,r){const n=[],s=r||bme(e[0]),o=e.length-1;for(let i=0;i<o;i++){let l=s(e[i],e[i+1]);if(t){const c=Array.isArray(t)?t[i]||mo:t;l=ph(c,l)}n.push(l)}return n}function JG(e,t,{clamp:r=!0,ease:n,mixer:s}={}){const o=e.length;if(B4(o===t.length),o===1)return()=>t[0];e[0]>e[o-1]&&(e=[...e].reverse(),t=[...t].reverse());const i=wme(t,n,s),l=i.length,c=d=>{let u=0;if(l>1)for(;u<e.length-2&&!(d<e[u+1]);u++);const f=aw(e[u],e[u+1],d);return i[u](f)};return r?d=>c(Ih(e[0],e[o-1],d)):c}function jme(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const s=aw(0,t,n);e.push(eo(r,1,s))}}function _me(e){const t=[0];return jme(t,e.length-1),t}function Nme(e,t){return e.map(r=>r*t)}function Sme(e,t){return e.map(()=>t||MG).splice(0,e.length-1)}function Z_({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const s=ome(n)?n.map(ZF):ZF(n),o={done:!1,value:t[0]},i=Nme(r&&r.length===t.length?r:_me(t),e),l=JG(i,t,{ease:Array.isArray(s)?s:Sme(t,s)});return{calculatedDuration:e,next:c=>(o.value=l(c),o.done=c>=e,o)}}function QG(e,t){return t?e*(1e3/t):0}const Cme=5;function ZG(e,t,r){const n=Math.max(t-Cme,0);return QG(r-e(n),t-n)}const mA=.001,Pme=.01,r$=10,Ame=.05,Eme=1;function kme({duration:e=800,bounce:t=.25,velocity:r=0,mass:n=1}){let s,o;Jfe(e<=gh(r$));let i=1-t;i=Ih(Ame,Eme,i),e=Ih(Pme,r$,zf(e)),i<1?(s=d=>{const u=d*i,f=u*e,h=u-r,m=wI(d,i),v=Math.exp(-f);return mA-h/m*v},o=d=>{const f=d*i*e,h=f*r+r,m=Math.pow(i,2)*Math.pow(d,2)*e,v=Math.exp(-f),g=wI(Math.pow(d,2),i);return(-s(d)+mA>0?-1:1)*((h-m)*v)/g}):(s=d=>{const u=Math.exp(-d*e),f=(d-r)*e+1;return-mA+u*f},o=d=>{const u=Math.exp(-d*e),f=(r-d)*(e*e);return u*f});const l=5/e,c=Ome(s,o,l);if(e=gh(e),isNaN(c))return{stiffness:100,damping:10,duration:e};{const d=Math.pow(c,2)*n;return{stiffness:d,damping:i*2*Math.sqrt(n*d),duration:e}}}const Ime=12;function Ome(e,t,r){let n=r;for(let s=1;s<Ime;s++)n=n-e(n)/t(n);return n}function wI(e,t){return e*Math.sqrt(1-t*t)}const Tme=["duration","bounce"],Dme=["stiffness","damping","mass"];function n$(e,t){return t.some(r=>e[r]!==void 0)}function Mme(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!n$(e,Dme)&&n$(e,Tme)){const r=kme(e);t={...t,...r,mass:1},t.isResolvedFromDuration=!0}return t}function eK({keyframes:e,restDelta:t,restSpeed:r,...n}){const s=e[0],o=e[e.length-1],i={done:!1,value:s},{stiffness:l,damping:c,mass:d,duration:u,velocity:f,isResolvedFromDuration:h}=Mme({...n,velocity:-zf(n.velocity||0)}),m=f||0,v=c/(2*Math.sqrt(l*d)),g=o-s,y=zf(Math.sqrt(l/d)),x=Math.abs(g)<5;r||(r=x?.01:2),t||(t=x?.005:.5);let b;if(v<1){const w=wI(y,v);b=j=>{const _=Math.exp(-v*y*j);return o-_*((m+v*y*g)/w*Math.sin(w*j)+g*Math.cos(w*j))}}else if(v===1)b=w=>o-Math.exp(-y*w)*(g+(m+y*g)*w);else{const w=y*Math.sqrt(v*v-1);b=j=>{const _=Math.exp(-v*y*j),S=Math.min(w*j,300);return o-_*((m+v*y*g)*Math.sinh(S)+w*g*Math.cosh(S))/w}}return{calculatedDuration:h&&u||null,next:w=>{const j=b(w);if(h)i.done=w>=u;else{let _=m;w!==0&&(v<1?_=ZG(b,w,j):_=0);const S=Math.abs(_)<=r,C=Math.abs(o-j)<=t;i.done=S&&C}return i.value=i.done?o:j,i}}}function a$({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:o=500,modifyTarget:i,min:l,max:c,restDelta:d=.5,restSpeed:u}){const f=e[0],h={done:!1,value:f},m=P=>l!==void 0&&P<l||c!==void 0&&P>c,v=P=>l===void 0?c:c===void 0||Math.abs(l-P)<Math.abs(c-P)?l:c;let g=r*t;const y=f+g,x=i===void 0?y:i(y);x!==y&&(g=x-f);const b=P=>-g*Math.exp(-P/n),w=P=>x+b(P),j=P=>{const A=b(P),R=w(P);h.done=Math.abs(A)<=d,h.value=h.done?x:R};let _,S;const C=P=>{m(h.value)&&(_=P,S=eK({keyframes:[h.value,v(h.value)],velocity:ZG(w,P,h.value),damping:s,stiffness:o,restDelta:d,restSpeed:u}))};return C(0),{calculatedDuration:null,next:P=>{let A=!1;return!S&&_===void 0&&(A=!0,j(P),C(P)),_!==void 0&&P>_?S.next(P-_):(!A&&j(P),h)}}}const Rme=e=>{const t=({timestamp:r})=>e(r);return{start:()=>Cs.update(t,!0),stop:()=>Qf(t),now:()=>Qi.isProcessing?Qi.timestamp:performance.now()}},s$=2e4;function o$(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<s$;)t+=r,n=e.next(t);return t>=s$?1/0:t}const Lme={decay:a$,inertia:a$,tween:Z_,keyframes:Z_,spring:eK};function eN({autoplay:e=!0,delay:t=0,driver:r=Rme,keyframes:n,type:s="keyframes",repeat:o=0,repeatDelay:i=0,repeatType:l="loop",onPlay:c,onStop:d,onComplete:u,onUpdate:f,...h}){let m=1,v=!1,g,y;const x=()=>{y=new Promise(Se=>{g=Se})};x();let b;const w=Lme[s]||Z_;let j;w!==Z_&&typeof n[0]!="number"&&(j=JG([0,100],n,{clamp:!1}),n=[0,100]);const _=w({...h,keyframes:n});let S;l==="mirror"&&(S=w({...h,keyframes:[...n].reverse(),velocity:-(h.velocity||0)}));let C="idle",P=null,A=null,R=null;_.calculatedDuration===null&&o&&(_.calculatedDuration=o$(_));const{calculatedDuration:O}=_;let I=1/0,M=1/0;O!==null&&(I=O+i,M=I*(o+1)-i);let D=0;const U=Se=>{if(A===null)return;m>0&&(A=Math.min(A,Se)),m<0&&(A=Math.min(Se-M/m,A)),P!==null?D=P:D=Math.round(Se-A)*m;const V=D-t*(m>=0?1:-1),B=m>=0?V<0:V>M;D=Math.max(V,0),C==="finished"&&P===null&&(D=M);let Q=D,pe=_;if(o){const me=Math.min(D,M)/I;let ae=Math.floor(me),le=me%1;!le&&me>=1&&(le=1),le===1&&ae--,ae=Math.min(ae,o+1),!!(ae%2)&&(l==="reverse"?(le=1-le,i&&(le-=i/I)):l==="mirror"&&(pe=S)),Q=Ih(0,1,le)*I}const te=B?{done:!1,value:n[0]}:pe.next(Q);j&&(te.value=j(te.value));let{done:Y}=te;!B&&O!==null&&(Y=m>=0?D>=M:D<=0);const ce=P===null&&(C==="finished"||C==="running"&&Y);return f&&f(te.value),ce&&$(),te},z=()=>{b&&b.stop(),b=void 0},W=()=>{C="idle",z(),g(),x(),A=R=null},$=()=>{C="finished",u&&u(),z(),g()},X=()=>{if(v)return;b||(b=r(U));const Se=b.now();c&&c(),P!==null?A=Se-P:(!A||C==="finished")&&(A=Se),C==="finished"&&x(),R=A,P=null,C="running",b.start()};e&&X();const ye={then(Se,V){return y.then(Se,V)},get time(){return zf(D)},set time(Se){Se=gh(Se),D=Se,P!==null||!b||m===0?P=Se:A=b.now()-Se/m},get duration(){const Se=_.calculatedDuration===null?o$(_):_.calculatedDuration;return zf(Se)},get speed(){return m},set speed(Se){Se===m||!b||(m=Se,ye.time=zf(D))},get state(){return C},play:X,pause:()=>{C="paused",P=D},stop:()=>{v=!0,C!=="idle"&&(C="idle",d&&d(),W())},cancel:()=>{R!==null&&U(R),W()},complete:()=>{C="finished"},sample:Se=>(A=0,U(Se))};return ye}function Fme(e){let t;return()=>(t===void 0&&(t=e()),t)}const $me=Fme(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Bme=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),V2=10,qme=2e4,zme=(e,t)=>t.type==="spring"||e==="backgroundColor"||!IG(t.ease);function Ume(e,t,{onUpdate:r,onComplete:n,...s}){if(!($me()&&Bme.has(t)&&!s.repeatDelay&&s.repeatType!=="mirror"&&s.damping!==0&&s.type!=="inertia"))return!1;let i=!1,l,c,d=!1;const u=()=>{c=new Promise(w=>{l=w})};u();let{keyframes:f,duration:h=300,ease:m,times:v}=s;if(zme(t,s)){const w=eN({...s,repeat:0,delay:0});let j={done:!1,value:f[0]};const _=[];let S=0;for(;!j.done&&S<qme;)j=w.sample(S),_.push(j.value),S+=V2;v=void 0,f=_,h=S-V2,m="linear"}const g=Zfe(e.owner.current,t,f,{...s,duration:h,ease:m,times:v}),y=()=>{d=!1,g.cancel()},x=()=>{d=!0,Cs.update(y),l(),u()};return g.onfinish=()=>{d||(e.set(eme(f,s)),n&&n(),x())},{then(w,j){return c.then(w,j)},attachTimeline(w){return g.timeline=w,g.onfinish=null,mo},get time(){return zf(g.currentTime||0)},set time(w){g.currentTime=gh(w)},get speed(){return g.playbackRate},set speed(w){g.playbackRate=w},get duration(){return zf(h)},play:()=>{i||(g.play(),Qf(y))},pause:()=>g.pause(),stop:()=>{if(i=!0,g.playState==="idle")return;const{currentTime:w}=g;if(w){const j=eN({...s,autoplay:!1});e.setWithVelocity(j.sample(w-V2).value,j.sample(w).value,V2)}x()},complete:()=>{d||g.finish()},cancel:x}}function Vme({keyframes:e,delay:t,onUpdate:r,onComplete:n}){const s=()=>(r&&r(e[e.length-1]),n&&n(),{time:0,speed:1,duration:0,play:mo,pause:mo,stop:mo,then:o=>(o(),Promise.resolve()),cancel:mo,complete:mo});return t?eN({keyframes:[0,1],duration:0,delay:t,onComplete:s}):s()}const Wme={type:"spring",stiffness:500,damping:25,restSpeed:10},Hme=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),Gme={type:"keyframes",duration:.8},Kme={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Xme=(e,{keyframes:t})=>t.length>2?Gme:Dg.has(e)?e.startsWith("scale")?Hme(t[1]):Wme:Kme,jI=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Oh.test(t)||t==="0")&&!t.startsWith("url(")),Yme=new Set(["brightness","contrast","saturate","opacity"]);function Jme(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(wC)||[];if(!n)return e;const s=r.replace(n,"");let o=Yme.has(t)?1:0;return n!==r&&(o*=100),t+"("+o+s+")"}const Qme=/([a-z-]*)\(.*?\)/g,_I={...Oh,getAnimatableNone:e=>{const t=e.match(Qme);return t?t.map(Jme).join(" "):e}},Zme={...hG,color:jl,backgroundColor:jl,outlineColor:jl,fill:jl,stroke:jl,borderColor:jl,borderTopColor:jl,borderRightColor:jl,borderBottomColor:jl,borderLeftColor:jl,filter:_I,WebkitFilter:_I},V4=e=>Zme[e];function tK(e,t){let r=V4(e);return r!==_I&&(r=Oh),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const rK=e=>/^0[^.\s]+$/.test(e);function ehe(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||rK(e)}function the(e,t,r,n){const s=jI(t,r);let o;Array.isArray(r)?o=[...r]:o=[null,r];const i=n.from!==void 0?n.from:e.get();let l;const c=[];for(let d=0;d<o.length;d++)o[d]===null&&(o[d]=d===0?i:o[d-1]),ehe(o[d])&&c.push(d),typeof o[d]=="string"&&o[d]!=="none"&&o[d]!=="0"&&(l=o[d]);if(s&&c.length&&l)for(let d=0;d<c.length;d++){const u=c[d];o[u]=tK(t,l)}return o}function rhe({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:o,repeatType:i,repeatDelay:l,from:c,elapsed:d,...u}){return!!Object.keys(u).length}function W4(e,t){return e[t]||e.default||e}const nhe={skipAnimations:!1},H4=(e,t,r,n={})=>s=>{const o=W4(n,e)||{},i=o.delay||n.delay||0;let{elapsed:l=0}=n;l=l-gh(i);const c=the(t,e,r,o),d=c[0],u=c[c.length-1],f=jI(e,d),h=jI(e,u);let m={keyframes:c,velocity:t.getVelocity(),ease:"easeOut",...o,delay:-l,onUpdate:v=>{t.set(v),o.onUpdate&&o.onUpdate(v)},onComplete:()=>{s(),o.onComplete&&o.onComplete()}};if(rhe(o)||(m={...m,...Xme(e,m)}),m.duration&&(m.duration=gh(m.duration)),m.repeatDelay&&(m.repeatDelay=gh(m.repeatDelay)),!f||!h||Qfe.current||o.type===!1||nhe.skipAnimations)return Vme(m);if(!n.isHandoff&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const v=Ume(t,e,m);if(v)return v}return eN(m)};function tN(e){return!!(lc(e)&&e.add)}const nK=e=>/^\-?\d*\.?\d+$/.test(e);function G4(e,t){e.indexOf(t)===-1&&e.push(t)}function K4(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}class X4{constructor(){this.subscriptions=[]}add(t){return G4(this.subscriptions,t),()=>K4(this.subscriptions,t)}notify(t,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,r,n);else for(let o=0;o<s;o++){const i=this.subscriptions[o];i&&i(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const ahe=e=>!isNaN(parseFloat(e));class she{constructor(t,r={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(n,s=!0)=>{this.prev=this.current,this.current=n;const{delta:o,timestamp:i}=Qi;this.lastUpdated!==i&&(this.timeDelta=o,this.lastUpdated=i,Cs.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>Cs.postRender(this.velocityCheck),this.velocityCheck=({timestamp:n})=>{n!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=ahe(this.current),this.owner=r.owner}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new X4);const n=this.events[t].add(r);return t==="change"?()=>{n(),Cs.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,n){this.set(r),this.prev=t,this.timeDelta=n}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?QG(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Tx(e,t){return new she(e,t)}const aK=e=>t=>t.test(e),ohe={test:e=>e==="auto",parse:e=>e},sK=[Mg,ra,Qu,Om,mfe,ffe,ohe],fy=e=>sK.find(aK(e)),ihe=[...sK,jl,Oh],lhe=e=>ihe.find(aK(e));function che(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,Tx(r))}function dhe(e,t){const r=_C(e,t);let{transitionEnd:n={},transition:s={},...o}=r?e.makeTargetAnimatable(r,!1):{};o={...o,...n};for(const i in o){const l=Pfe(o[i]);che(e,i,l)}}function uhe(e,t,r){var n,s;const o=Object.keys(t).filter(l=>!e.hasValue(l)),i=o.length;if(i)for(let l=0;l<i;l++){const c=o[l],d=t[c];let u=null;Array.isArray(d)&&(u=d[0]),u===null&&(u=(s=(n=r[c])!==null&&n!==void 0?n:e.readValue(c))!==null&&s!==void 0?s:t[c]),u!=null&&(typeof u=="string"&&(nK(u)||rK(u))?u=parseFloat(u):!lhe(u)&&Oh.test(d)&&(u=tK(c,d)),e.addValue(c,Tx(u,{owner:e})),r[c]===void 0&&(r[c]=u),u!==null&&e.setBaseTarget(c,u))}}function fhe(e,t){return t?(t[e]||t.default||t).from:void 0}function mhe(e,t,r){const n={};for(const s in e){const o=fhe(s,t);if(o!==void 0)n[s]=o;else{const i=r.getValue(s);i&&(n[s]=i.get())}}return n}function hhe({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function phe(e,t){const r=e.get();if(Array.isArray(t)){for(let n=0;n<t.length;n++)if(t[n]!==r)return!0}else return r!==t}function oK(e,t,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:o=e.getDefaultTransition(),transitionEnd:i,...l}=e.makeTargetAnimatable(t);const c=e.getValue("willChange");n&&(o=n);const d=[],u=s&&e.animationState&&e.animationState.getState()[s];for(const f in l){const h=e.getValue(f),m=l[f];if(!h||m===void 0||u&&hhe(u,f))continue;const v={delay:r,elapsed:0,...W4(o||{},f)};if(window.HandoffAppearAnimations){const x=e.getProps()[iG];if(x){const b=window.HandoffAppearAnimations(x,f,h,Cs);b!==null&&(v.elapsed=b,v.isHandoff=!0)}}let g=!v.isHandoff&&!phe(h,m);if(v.type==="spring"&&(h.getVelocity()||v.velocity)&&(g=!1),h.animation&&(g=!1),g)continue;h.start(H4(f,h,m,e.shouldReduceMotion&&Dg.has(f)?{type:!1}:v));const y=h.animation;tN(c)&&(c.add(f),y.then(()=>c.remove(f))),d.push(y)}return i&&Promise.all(d).then(()=>{i&&dhe(e,i)}),d}function NI(e,t,r={}){const n=_C(e,t,r.custom);let{transition:s=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const o=n?()=>Promise.all(oK(e,n,r)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:d=0,staggerChildren:u,staggerDirection:f}=s;return ghe(e,t,d+c,u,f,r)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,d]=l==="beforeChildren"?[o,i]:[i,o];return c().then(()=>d())}else return Promise.all([o(),i(r.delay)])}function ghe(e,t,r=0,n=0,s=1,o){const i=[],l=(e.variantChildren.size-1)*n,c=s===1?(d=0)=>d*n:(d=0)=>l-d*n;return Array.from(e.variantChildren).sort(vhe).forEach((d,u)=>{d.notify("AnimationStart",t),i.push(NI(d,t,{...o,delay:r+c(u)}).then(()=>d.notify("AnimationComplete",t)))}),Promise.all(i)}function vhe(e,t){return e.sortNodePosition(t)}function xhe(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const s=t.map(o=>NI(e,o,r));n=Promise.all(s)}else if(typeof t=="string")n=NI(e,t,r);else{const s=typeof t=="function"?_C(e,t,r.custom):t;n=Promise.all(oK(e,s,r))}return n.then(()=>e.notify("AnimationComplete",t))}const yhe=[...k4].reverse(),bhe=k4.length;function whe(e){return t=>Promise.all(t.map(({animation:r,options:n})=>xhe(e,r,n)))}function jhe(e){let t=whe(e);const r=Nhe();let n=!0;const s=(c,d)=>{const u=_C(e,d);if(u){const{transition:f,transitionEnd:h,...m}=u;c={...c,...m,...h}}return c};function o(c){t=c(e)}function i(c,d){const u=e.getProps(),f=e.getVariantContext(!0)||{},h=[],m=new Set;let v={},g=1/0;for(let x=0;x<bhe;x++){const b=yhe[x],w=r[b],j=u[b]!==void 0?u[b]:f[b],_=rw(j),S=b===d?w.isActive:null;S===!1&&(g=x);let C=j===f[b]&&j!==u[b]&&_;if(C&&n&&e.manuallyAnimateOnMount&&(C=!1),w.protectedKeys={...v},!w.isActive&&S===null||!j&&!w.prevProp||yC(j)||typeof j=="boolean")continue;let A=_he(w.prevProp,j)||b===d&&w.isActive&&!C&&_||x>g&&_,R=!1;const O=Array.isArray(j)?j:[j];let I=O.reduce(s,{});S===!1&&(I={});const{prevResolvedValues:M={}}=w,D={...M,...I},U=z=>{A=!0,m.has(z)&&(R=!0,m.delete(z)),w.needsAnimating[z]=!0};for(const z in D){const W=I[z],$=M[z];if(v.hasOwnProperty(z))continue;let X=!1;J_(W)&&J_($)?X=!EG(W,$):X=W!==$,X?W!==void 0?U(z):m.add(z):W!==void 0&&m.has(z)?U(z):w.protectedKeys[z]=!0}w.prevProp=j,w.prevResolvedValues=I,w.isActive&&(v={...v,...I}),n&&e.blockInitialAnimation&&(A=!1),A&&(!C||R)&&h.push(...O.map(z=>({animation:z,options:{type:b,...c}})))}if(m.size){const x={};m.forEach(b=>{const w=e.getBaseTarget(b);w!==void 0&&(x[b]=w)}),h.push({animation:x})}let y=!!h.length;return n&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(y=!1),n=!1,y?t(h):Promise.resolve()}function l(c,d,u){var f;if(r[c].isActive===d)return Promise.resolve();(f=e.variantChildren)===null||f===void 0||f.forEach(m=>{var v;return(v=m.animationState)===null||v===void 0?void 0:v.setActive(c,d)}),r[c].isActive=d;const h=i(u,c);for(const m in r)r[m].protectedKeys={};return h}return{animateChanges:i,setActive:l,setAnimateFunction:o,getState:()=>r}}function _he(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!EG(t,e):!1}function lp(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Nhe(){return{animate:lp(!0),whileInView:lp(),whileHover:lp(),whileTap:lp(),whileDrag:lp(),whileFocus:lp(),exit:lp()}}class She extends Wh{constructor(t){super(t),t.animationState||(t.animationState=jhe(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),yC(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){}}let Che=0;class Phe extends Wh{constructor(){super(...arguments),this.id=Che++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r,custom:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===s)return;const o=this.node.animationState.setActive("exit",!t,{custom:n??this.node.getProps().custom});r&&!t&&o.then(()=>r(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const Ahe={animation:{Feature:She},exit:{Feature:Phe}},i$=(e,t)=>Math.abs(e-t);function Ehe(e,t){const r=i$(e.x,t.x),n=i$(e.y,t.y);return Math.sqrt(r**2+n**2)}class iK{constructor(t,r,{transformPagePoint:n,contextWindow:s,dragSnapToOrigin:o=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=pA(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,m=Ehe(f.offset,{x:0,y:0})>=3;if(!h&&!m)return;const{point:v}=f,{timestamp:g}=Qi;this.history.push({...v,timestamp:g});const{onStart:y,onMove:x}=this.handlers;h||(y&&y(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,f)},this.handlePointerMove=(f,h)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=hA(h,this.transformPagePoint),Cs.update(this.updatePoint,!0)},this.handlePointerUp=(f,h)=>{this.end();const{onEnd:m,onSessionEnd:v,resumeAnimation:g}=this.handlers;if(this.dragSnapToOrigin&&g&&g(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=pA(f.type==="pointercancel"?this.lastMoveEventInfo:hA(h,this.transformPagePoint),this.history);this.startEvent&&m&&m(f,y),v&&v(f,y)},!NG(t))return;this.dragSnapToOrigin=o,this.handlers=r,this.transformPagePoint=n,this.contextWindow=s||window;const i=jC(t),l=hA(i,this.transformPagePoint),{point:c}=l,{timestamp:d}=Qi;this.history=[{...c,timestamp:d}];const{onSessionStart:u}=r;u&&u(t,pA(l,this.history)),this.removeListeners=ph(qf(this.contextWindow,"pointermove",this.handlePointerMove),qf(this.contextWindow,"pointerup",this.handlePointerUp),qf(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Qf(this.updatePoint)}}function hA(e,t){return t?{point:t(e.point)}:e}function l$(e,t){return{x:e.x-t.x,y:e.y-t.y}}function pA({point:e},t){return{point:e,delta:l$(e,lK(t)),offset:l$(e,khe(t)),velocity:Ihe(t,.1)}}function khe(e){return e[0]}function lK(e){return e[e.length-1]}function Ihe(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const s=lK(e);for(;r>=0&&(n=e[r],!(s.timestamp-n.timestamp>gh(t)));)r--;if(!n)return{x:0,y:0};const o=zf(s.timestamp-n.timestamp);if(o===0)return{x:0,y:0};const i={x:(s.x-n.x)/o,y:(s.y-n.y)/o};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function Gc(e){return e.max-e.min}function SI(e,t=0,r=.01){return Math.abs(e-t)<=r}function c$(e,t,r,n=.5){e.origin=n,e.originPoint=eo(t.min,t.max,e.origin),e.scale=Gc(r)/Gc(t),(SI(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=eo(r.min,r.max,e.origin)-e.originPoint,(SI(e.translate)||isNaN(e.translate))&&(e.translate=0)}function sb(e,t,r,n){c$(e.x,t.x,r.x,n?n.originX:void 0),c$(e.y,t.y,r.y,n?n.originY:void 0)}function d$(e,t,r){e.min=r.min+t.min,e.max=e.min+Gc(t)}function Ohe(e,t,r){d$(e.x,t.x,r.x),d$(e.y,t.y,r.y)}function u$(e,t,r){e.min=t.min-r.min,e.max=e.min+Gc(t)}function ob(e,t,r){u$(e.x,t.x,r.x),u$(e.y,t.y,r.y)}function The(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?eo(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?eo(r,e,n.max):Math.min(e,r)),e}function f$(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function Dhe(e,{top:t,left:r,bottom:n,right:s}){return{x:f$(e.x,r,s),y:f$(e.y,t,n)}}function m$(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function Mhe(e,t){return{x:m$(e.x,t.x),y:m$(e.y,t.y)}}function Rhe(e,t){let r=.5;const n=Gc(e),s=Gc(t);return s>n?r=aw(t.min,t.max-n,e.min):n>s&&(r=aw(e.min,e.max-s,t.min)),Ih(0,1,r)}function Lhe(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const CI=.35;function Fhe(e=CI){return e===!1?e=0:e===!0&&(e=CI),{x:h$(e,"left","right"),y:h$(e,"top","bottom")}}function h$(e,t,r){return{min:p$(e,t),max:p$(e,r)}}function p$(e,t){return typeof e=="number"?e:e[t]||0}const g$=()=>({translate:0,scale:1,origin:0,originPoint:0}),Gv=()=>({x:g$(),y:g$()}),v$=()=>({min:0,max:0}),Io=()=>({x:v$(),y:v$()});function cd(e){return[e("x"),e("y")]}function cK({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function $he({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function Bhe(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function gA(e){return e===void 0||e===1}function PI({scale:e,scaleX:t,scaleY:r}){return!gA(e)||!gA(t)||!gA(r)}function yp(e){return PI(e)||dK(e)||e.z||e.rotate||e.rotateX||e.rotateY}function dK(e){return x$(e.x)||x$(e.y)}function x$(e){return e&&e!=="0%"}function rN(e,t,r){const n=e-r,s=t*n;return r+s}function y$(e,t,r,n,s){return s!==void 0&&(e=rN(e,s,n)),rN(e,r,n)+t}function AI(e,t=0,r=1,n,s){e.min=y$(e.min,t,r,n,s),e.max=y$(e.max,t,r,n,s)}function uK(e,{x:t,y:r}){AI(e.x,t.translate,t.scale,t.originPoint),AI(e.y,r.translate,r.scale,r.originPoint)}function qhe(e,t,r,n=!1){const s=r.length;if(!s)return;t.x=t.y=1;let o,i;for(let l=0;l<s;l++){o=r[l],i=o.projectionDelta;const c=o.instance;c&&c.style&&c.style.display==="contents"||(n&&o.options.layoutScroll&&o.scroll&&o!==o.root&&Kv(e,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),i&&(t.x*=i.x.scale,t.y*=i.y.scale,uK(e,i)),n&&yp(o.latestValues)&&Kv(e,o.latestValues))}t.x=b$(t.x),t.y=b$(t.y)}function b$(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function Bm(e,t){e.min=e.min+t,e.max=e.max+t}function w$(e,t,[r,n,s]){const o=t[s]!==void 0?t[s]:.5,i=eo(e.min,e.max,o);AI(e,t[r],t[n],i,t.scale)}const zhe=["x","scaleX","originX"],Uhe=["y","scaleY","originY"];function Kv(e,t){w$(e.x,t,zhe),w$(e.y,t,Uhe)}function fK(e,t){return cK(Bhe(e.getBoundingClientRect(),t))}function Vhe(e,t,r){const n=fK(e,r),{scroll:s}=t;return s&&(Bm(n.x,s.offset.x),Bm(n.y,s.offset.y)),n}const mK=({current:e})=>e?e.ownerDocument.defaultView:null,Whe=new WeakMap;class Hhe{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Io(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const s=u=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(jC(u,"page").point)},o=(u,f)=>{const{drag:h,dragPropagation:m,onDragStart:v}=this.getProps();if(h&&!m&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=CG(h),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),cd(y=>{let x=this.getAxisMotionValue(y).get()||0;if(Qu.test(x)){const{projection:b}=this.visualElement;if(b&&b.layout){const w=b.layout.layoutBox[y];w&&(x=Gc(w)*(parseFloat(x)/100))}}this.originPoint[y]=x}),v&&Cs.update(()=>v(u,f),!1,!0);const{animationState:g}=this.visualElement;g&&g.setActive("whileDrag",!0)},i=(u,f)=>{const{dragPropagation:h,dragDirectionLock:m,onDirectionLock:v,onDrag:g}=this.getProps();if(!h&&!this.openGlobalLock)return;const{offset:y}=f;if(m&&this.currentDirection===null){this.currentDirection=Ghe(y),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",f.point,y),this.updateAxis("y",f.point,y),this.visualElement.render(),g&&g(u,f)},l=(u,f)=>this.stop(u,f),c=()=>cd(u=>{var f;return this.getAnimationState(u)==="paused"&&((f=this.getAxisMotionValue(u).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new iK(t,{onSessionStart:s,onStart:o,onMove:i,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,contextWindow:mK(this.visualElement)})}stop(t,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:s}=r;this.startAnimation(s);const{onDragEnd:o}=this.getProps();o&&Cs.update(()=>o(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:s}=this.getProps();if(!n||!W2(t,s,this.currentDirection))return;const o=this.getAxisMotionValue(t);let i=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(i=The(i,this.constraints[t],this.elastic[t])),o.set(i)}resolveConstraints(){var t;const{dragConstraints:r,dragElastic:n}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,o=this.constraints;r&&Wv(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&s?this.constraints=Dhe(s.layoutBox,r):this.constraints=!1,this.elastic=Fhe(n),o!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&cd(i=>{this.getAxisMotionValue(i)&&(this.constraints[i]=Lhe(s.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Wv(t))return!1;const n=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const o=Vhe(n,s.root,this.visualElement.getTransformPagePoint());let i=Mhe(s.layout.layoutBox,o);if(r){const l=r($he(i));this.hasMutatedConstraints=!!l,l&&(i=cK(l))}return i}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:o,dragSnapToOrigin:i,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},d=cd(u=>{if(!W2(u,r,this.currentDirection))return;let f=c&&c[u]||{};i&&(f={min:0,max:0});const h=s?200:1e6,m=s?40:1e7,v={type:"inertia",velocity:n?t[u]:0,bounceStiffness:h,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...o,...f};return this.startAxisValueAnimation(u,v)});return Promise.all(d).then(l)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return n.start(H4(t,n,0,r))}stopAnimation(){cd(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){cd(t=>{var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(t){const r="_drag"+t.toUpperCase(),n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){cd(r=>{const{drag:n}=this.getProps();if(!W2(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,o=this.getAxisMotionValue(r);if(s&&s.layout){const{min:i,max:l}=s.layout.layoutBox[r];o.set(t[r]-eo(i,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!Wv(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};cd(i=>{const l=this.getAxisMotionValue(i);if(l){const c=l.get();s[i]=Rhe({min:c,max:c},this.constraints[i])}});const{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),cd(i=>{if(!W2(i,t,null))return;const l=this.getAxisMotionValue(i),{min:c,max:d}=this.constraints[i];l.set(eo(c,d,s[i]))})}addListeners(){if(!this.visualElement.current)return;Whe.set(this.visualElement,this);const t=this.visualElement.current,r=qf(t,"pointerdown",c=>{const{drag:d,dragListener:u=!0}=this.getProps();d&&u&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();Wv(c)&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,o=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),n();const i=Mf(window,"resize",()=>this.scalePositionWithinConstraints()),l=s.addEventListener("didUpdate",({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&(cd(u=>{const f=this.getAxisMotionValue(u);f&&(this.originPoint[u]+=c[u].translate,f.set(f.get()+c[u].translate))}),this.visualElement.render())});return()=>{i(),r(),o(),l&&l()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:o=!1,dragElastic:i=CI,dragMomentum:l=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:o,dragElastic:i,dragMomentum:l}}}function W2(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function Ghe(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class Khe extends Wh{constructor(t){super(t),this.removeGroupControls=mo,this.removeListeners=mo,this.controls=new Hhe(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||mo}unmount(){this.removeGroupControls(),this.removeListeners()}}const j$=e=>(t,r)=>{e&&Cs.update(()=>e(t,r))};class Xhe extends Wh{constructor(){super(...arguments),this.removePointerDownListener=mo}onPointerDown(t){this.session=new iK(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:mK(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:j$(t),onStart:j$(r),onMove:n,onEnd:(o,i)=>{delete this.session,s&&Cs.update(()=>s(o,i))}}}mount(){this.removePointerDownListener=qf(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function Yhe(){const e=p.useContext(vC);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:n}=e,s=p.useId();return p.useEffect(()=>n(s),[]),!t&&r?[!1,()=>r&&r(s)]:[!0]}const n_={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function _$(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const my={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(ra.test(e))e=parseFloat(e);else return e;const r=_$(e,t.target.x),n=_$(e,t.target.y);return`${r}% ${n}%`}},Jhe={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,s=Oh.parse(e);if(s.length>5)return n;const o=Oh.createTransformer(e),i=typeof s[0]!="number"?1:0,l=r.x.scale*t.x,c=r.y.scale*t.y;s[0+i]/=l,s[1+i]/=c;const d=eo(l,c,.5);return typeof s[2+i]=="number"&&(s[2+i]/=d),typeof s[3+i]=="number"&&(s[3+i]/=d),o(s)}};class Qhe extends Pe.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:o}=t;sfe(Zhe),o&&(r.group&&r.group.add(o),n&&n.register&&s&&n.register(o),o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,onExitComplete:()=>this.safeToRemove()})),n_.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:s,isPresent:o}=this.props,i=n.projection;return i&&(i.isPresent=o,s||t.layoutDependency!==r||r===void 0?i.willUpdate():this.safeToRemove(),t.isPresent!==o&&(o?i.promote():i.relegate()||Cs.postRender(()=>{const l=i.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=t;s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function hK(e){const[t,r]=Yhe(),n=p.useContext(O4);return Pe.createElement(Qhe,{...e,layoutGroup:n,switchLayoutGroup:p.useContext(cG),isPresent:t,safeToRemove:r})}const Zhe={borderRadius:{...my,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:my,borderTopRightRadius:my,borderBottomLeftRadius:my,borderBottomRightRadius:my,boxShadow:Jhe},pK=["TopLeft","TopRight","BottomLeft","BottomRight"],epe=pK.length,N$=e=>typeof e=="string"?parseFloat(e):e,S$=e=>typeof e=="number"||ra.test(e);function tpe(e,t,r,n,s,o){s?(e.opacity=eo(0,r.opacity!==void 0?r.opacity:1,rpe(n)),e.opacityExit=eo(t.opacity!==void 0?t.opacity:1,0,npe(n))):o&&(e.opacity=eo(t.opacity!==void 0?t.opacity:1,r.opacity!==void 0?r.opacity:1,n));for(let i=0;i<epe;i++){const l=`border${pK[i]}Radius`;let c=C$(t,l),d=C$(r,l);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||S$(c)===S$(d)?(e[l]=Math.max(eo(N$(c),N$(d),n),0),(Qu.test(d)||Qu.test(c))&&(e[l]+="%")):e[l]=d}(t.rotate||r.rotate)&&(e.rotate=eo(t.rotate||0,r.rotate||0,n))}function C$(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const rpe=gK(0,.5,FG),npe=gK(.5,.95,mo);function gK(e,t,r){return n=>n<e?0:n>t?1:r(aw(e,t,n))}function P$(e,t){e.min=t.min,e.max=t.max}function nd(e,t){P$(e.x,t.x),P$(e.y,t.y)}function A$(e,t,r,n,s){return e-=t,e=rN(e,1/r,n),s!==void 0&&(e=rN(e,1/s,n)),e}function ape(e,t=0,r=1,n=.5,s,o=e,i=e){if(Qu.test(t)&&(t=parseFloat(t),t=eo(i.min,i.max,t/100)-i.min),typeof t!="number")return;let l=eo(o.min,o.max,n);e===o&&(l-=t),e.min=A$(e.min,t,r,l,s),e.max=A$(e.max,t,r,l,s)}function E$(e,t,[r,n,s],o,i){ape(e,t[r],t[n],t[s],t.scale,o,i)}const spe=["x","scaleX","originX"],ope=["y","scaleY","originY"];function k$(e,t,r,n){E$(e.x,t,spe,r?r.x:void 0,n?n.x:void 0),E$(e.y,t,ope,r?r.y:void 0,n?n.y:void 0)}function I$(e){return e.translate===0&&e.scale===1}function vK(e){return I$(e.x)&&I$(e.y)}function ipe(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function xK(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function O$(e){return Gc(e.x)/Gc(e.y)}class lpe{constructor(){this.members=[]}add(t){G4(this.members,t),t.scheduleRender()}remove(t){if(K4(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(s=>t===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const o=this.members[s];if(o.isPresent!==!1){n=o;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function T$(e,t,r){let n="";const s=e.x.translate/t.x,o=e.y.translate/t.y;if((s||o)&&(n=`translate3d(${s}px, ${o}px, 0) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{rotate:c,rotateX:d,rotateY:u}=r;c&&(n+=`rotate(${c}deg) `),d&&(n+=`rotateX(${d}deg) `),u&&(n+=`rotateY(${u}deg) `)}const i=e.x.scale*t.x,l=e.y.scale*t.y;return(i!==1||l!==1)&&(n+=`scale(${i}, ${l})`),n||"none"}const cpe=(e,t)=>e.depth-t.depth;class dpe{constructor(){this.children=[],this.isDirty=!1}add(t){G4(this.children,t),this.isDirty=!0}remove(t){K4(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(cpe),this.isDirty=!1,this.children.forEach(t)}}function upe(e,t){const r=performance.now(),n=({timestamp:s})=>{const o=s-r;o>=t&&(Qf(n),e(o-t))};return Cs.read(n,!0),()=>Qf(n)}function fpe(e){window.MotionDebug&&window.MotionDebug.record(e)}function mpe(e){return e instanceof SVGElement&&e.tagName!=="svg"}function hpe(e,t,r){const n=lc(e)?e:Tx(e);return n.start(H4("",n,t,r)),n.animation}const D$=["","X","Y","Z"],ppe={visibility:"hidden"},M$=1e3;let gpe=0;const bp={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function yK({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(i={},l=t?.()){this.id=gpe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,bp.totalNodes=bp.resolvedTargetDeltas=bp.recalculatedProjection=0,this.nodes.forEach(ype),this.nodes.forEach(Npe),this.nodes.forEach(Spe),this.nodes.forEach(bpe),fpe(bp)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new dpe)}addEventListener(i,l){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new X4),this.eventHandlers.get(i).add(l)}notifyListeners(i,...l){const c=this.eventHandlers.get(i);c&&c.notify(...l)}hasListeners(i){return this.eventHandlers.has(i)}mount(i,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=mpe(i),this.instance=i;const{layoutId:c,layout:d,visualElement:u}=this.options;if(u&&!u.current&&u.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(d||c)&&(this.isLayoutDirty=!0),e){let f;const h=()=>this.root.updateBlockedByResize=!1;e(i,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=upe(h,250),n_.hasAnimatedSinceResize&&(n_.hasAnimatedSinceResize=!1,this.nodes.forEach(L$))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&u&&(c||d)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:h,hasRelativeTargetChanged:m,layout:v})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const g=this.options.transition||u.getDefaultTransition()||kpe,{onLayoutAnimationStart:y,onLayoutAnimationComplete:x}=u.getProps(),b=!this.targetLayout||!xK(this.targetLayout,v)||m,w=!h&&m;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||w||h&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,w);const j={...W4(g,"layout"),onPlay:y,onComplete:x};(u.shouldReduceMotion||this.options.layoutRoot)&&(j.delay=0,j.type=!1),this.startAnimation(j)}else h||L$(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=v})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Qf(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Cpe),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const f=this.path[u];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(R$);return}this.isUpdating||this.nodes.forEach(jpe),this.isUpdating=!1,this.nodes.forEach(_pe),this.nodes.forEach(vpe),this.nodes.forEach(xpe),this.clearAllSnapshots();const l=performance.now();Qi.delta=Ih(0,1e3/60,l-Qi.timestamp),Qi.timestamp=l,Qi.isProcessing=!0,oA.update.process(Qi),oA.preRender.process(Qi),oA.render.process(Qi),Qi.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(wpe),this.sharedNodes.forEach(Ppe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Cs.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Cs.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Io(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let l=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(l=!1),l&&(this.scroll={animationId:this.root.animationId,phase:i,isRoot:n(this.instance),offset:r(this.instance)})}resetTransform(){if(!s)return;const i=this.isLayoutDirty||this.shouldResetTransform,l=this.projectionDelta&&!vK(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,u=d!==this.prevTransformTemplateValue;i&&(l||yp(this.latestValues)||u)&&(s(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return i&&(c=this.removeTransform(c)),Ipe(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:i}=this.options;if(!i)return Io();const l=i.measureViewportBox(),{scroll:c}=this.root;return c&&(Bm(l.x,c.offset.x),Bm(l.y,c.offset.y)),l}removeElementScroll(i){const l=Io();nd(l,i);for(let c=0;c<this.path.length;c++){const d=this.path[c],{scroll:u,options:f}=d;if(d!==this.root&&u&&f.layoutScroll){if(u.isRoot){nd(l,i);const{scroll:h}=this.root;h&&(Bm(l.x,-h.offset.x),Bm(l.y,-h.offset.y))}Bm(l.x,u.offset.x),Bm(l.y,u.offset.y)}}return l}applyTransform(i,l=!1){const c=Io();nd(c,i);for(let d=0;d<this.path.length;d++){const u=this.path[d];!l&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Kv(c,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),yp(u.latestValues)&&Kv(c,u.latestValues)}return yp(this.latestValues)&&Kv(c,this.latestValues),c}removeTransform(i){const l=Io();nd(l,i);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!yp(d.latestValues))continue;PI(d.latestValues)&&d.updateSnapshot();const u=Io(),f=d.measurePageBox();nd(u,f),k$(l,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,u)}return yp(this.latestValues)&&k$(l,this.latestValues),l}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Qi.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==c;if(!(i||d&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:f,layoutId:h}=this.options;if(!(!this.layout||!(f||h))){if(this.resolvedRelativeTargetAt=Qi.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Io(),this.relativeTargetOrigin=Io(),ob(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),nd(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Io(),this.targetWithTransforms=Io()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Ohe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):nd(this.target,this.layout.layoutBox),uK(this.target,this.targetDelta)):nd(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Io(),this.relativeTargetOrigin=Io(),ob(this.relativeTargetOrigin,this.target,m.target),nd(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}bp.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||PI(this.parent.latestValues)||dK(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var i;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let d=!0;if((this.isProjectionDirty||!((i=this.parent)===null||i===void 0)&&i.isProjectionDirty)&&(d=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===Qi.timestamp&&(d=!1),d)return;const{layout:u,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||f))return;nd(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,m=this.treeScale.y;qhe(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox);const{target:v}=l;if(!v){this.projectionTransform&&(this.projectionDelta=Gv(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=Gv(),this.projectionDeltaWithTransform=Gv());const g=this.projectionTransform;sb(this.projectionDelta,this.layoutCorrected,v,this.latestValues),this.projectionTransform=T$(this.projectionDelta,this.treeScale),(this.projectionTransform!==g||this.treeScale.x!==h||this.treeScale.y!==m)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",v)),bp.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),i){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(i,l=!1){const c=this.snapshot,d=c?c.latestValues:{},u={...this.latestValues},f=Gv();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const h=Io(),m=c?c.source:void 0,v=this.layout?this.layout.source:void 0,g=m!==v,y=this.getStack(),x=!y||y.members.length<=1,b=!!(g&&!x&&this.options.crossfade===!0&&!this.path.some(Epe));this.animationProgress=0;let w;this.mixTargetDelta=j=>{const _=j/1e3;F$(f.x,i.x,_),F$(f.y,i.y,_),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(ob(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Ape(this.relativeTarget,this.relativeTargetOrigin,h,_),w&&ipe(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=Io()),nd(w,this.relativeTarget)),g&&(this.animationValues=u,tpe(u,d,this.latestValues,_,b,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=_},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Qf(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Cs.update(()=>{n_.hasAnimatedSinceResize=!0,this.currentAnimation=hpe(0,M$,{...i,onUpdate:l=>{this.mixTargetDelta(l),i.onUpdate&&i.onUpdate(l)},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(M$),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:l,target:c,layout:d,latestValues:u}=i;if(!(!l||!c||!d)){if(this!==i&&this.layout&&d&&bK(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||Io();const f=Gc(this.layout.layoutBox.x);c.x.min=i.target.x.min,c.x.max=c.x.min+f;const h=Gc(this.layout.layoutBox.y);c.y.min=i.target.y.min,c.y.max=c.y.min+h}nd(l,c),Kv(l,u),sb(this.projectionDeltaWithTransform,this.layoutCorrected,l,u)}}registerSharedNode(i,l){this.sharedNodes.has(i)||this.sharedNodes.set(i,new lpe),this.sharedNodes.get(i).add(l);const d=l.options.initialPromotionConfig;l.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(l):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){var i;const{layoutId:l}=this.options;return l?((i=this.getStack())===null||i===void 0?void 0:i.lead)||this:this}getPrevLead(){var i;const{layoutId:l}=this.options;return l?(i=this.getStack())===null||i===void 0?void 0:i.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:l,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),i&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetRotation(){const{visualElement:i}=this.options;if(!i)return;let l=!1;const{latestValues:c}=i;if((c.rotate||c.rotateX||c.rotateY||c.rotateZ)&&(l=!0),!l)return;const d={};for(let u=0;u<D$.length;u++){const f="rotate"+D$[u];c[f]&&(d[f]=c[f],i.setStaticValue(f,0))}i.render();for(const u in d)i.setStaticValue(u,d[u]);i.scheduleRender()}getProjectionStyles(i){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return ppe;const d={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,d.opacity="",d.pointerEvents=r_(i?.pointerEvents)||"",d.transform=u?u(this.latestValues,""):"none",d;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const g={};return this.options.layoutId&&(g.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,g.pointerEvents=r_(i?.pointerEvents)||""),this.hasProjected&&!yp(this.latestValues)&&(g.transform=u?u({},""):"none",this.hasProjected=!1),g}const h=f.animationValues||f.latestValues;this.applyTransformsToTarget(),d.transform=T$(this.projectionDeltaWithTransform,this.treeScale,h),u&&(d.transform=u(h,d.transform));const{x:m,y:v}=this.projectionDelta;d.transformOrigin=`${m.origin*100}% ${v.origin*100}% 0`,f.animationValues?d.opacity=f===this?(c=(l=h.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:d.opacity=f===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const g in X_){if(h[g]===void 0)continue;const{correct:y,applyTo:x}=X_[g],b=d.transform==="none"?h[g]:y(h[g],f);if(x){const w=x.length;for(let j=0;j<w;j++)d[x[j]]=b}else d[g]=b}return this.options.layoutId&&(d.pointerEvents=f===this?r_(i?.pointerEvents)||"":"none"),d}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>{var l;return(l=i.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(R$),this.root.sharedNodes.clear()}}}function vpe(e){e.updateLayout()}function xpe(e){var t;const r=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:s}=e.layout,{animationType:o}=e.options,i=r.source!==e.layout.source;o==="size"?cd(f=>{const h=i?r.measuredBox[f]:r.layoutBox[f],m=Gc(h);h.min=n[f].min,h.max=h.min+m}):bK(o,r.layoutBox,n)&&cd(f=>{const h=i?r.measuredBox[f]:r.layoutBox[f],m=Gc(n[f]);h.max=h.min+m,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[f].max=e.relativeTarget[f].min+m)});const l=Gv();sb(l,n,r.layoutBox);const c=Gv();i?sb(c,e.applyTransform(s,!0),r.measuredBox):sb(c,n,r.layoutBox);const d=!vK(l);let u=!1;if(!e.resumeFrom){const f=e.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:h,layout:m}=f;if(h&&m){const v=Io();ob(v,r.layoutBox,h.layoutBox);const g=Io();ob(g,n,m.layoutBox),xK(v,g)||(u=!0),f.options.layoutRoot&&(e.relativeTarget=g,e.relativeTargetOrigin=v,e.relativeParent=f)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:c,layoutDelta:l,hasLayoutChanged:d,hasRelativeTargetChanged:u})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function ype(e){bp.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function bpe(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function wpe(e){e.clearSnapshot()}function R$(e){e.clearMeasurements()}function jpe(e){e.isLayoutDirty=!1}function _pe(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function L$(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Npe(e){e.resolveTargetDelta()}function Spe(e){e.calcProjection()}function Cpe(e){e.resetRotation()}function Ppe(e){e.removeLeadSnapshot()}function F$(e,t,r){e.translate=eo(t.translate,0,r),e.scale=eo(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function $$(e,t,r,n){e.min=eo(t.min,r.min,n),e.max=eo(t.max,r.max,n)}function Ape(e,t,r,n){$$(e.x,t.x,r.x,n),$$(e.y,t.y,r.y,n)}function Epe(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const kpe={duration:.45,ease:[.4,0,.1,1]},B$=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),q$=B$("applewebkit/")&&!B$("chrome/")?Math.round:mo;function z$(e){e.min=q$(e.min),e.max=q$(e.max)}function Ipe(e){z$(e.x),z$(e.y)}function bK(e,t,r){return e==="position"||e==="preserve-aspect"&&!SI(O$(t),O$(r),.2)}const Ope=yK({attachResizeListener:(e,t)=>Mf(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),vA={current:void 0},wK=yK({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!vA.current){const e=new Ope({});e.mount(window),e.setOptions({layoutScroll:!0}),vA.current=e}return vA.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Tpe={pan:{Feature:Xhe},drag:{Feature:Khe,ProjectionNode:wK,MeasureLayout:hK}},Dpe=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function Mpe(e){const t=Dpe.exec(e);if(!t)return[,];const[,r,n]=t;return[r,n]}function EI(e,t,r=1){const[n,s]=Mpe(e);if(!n)return;const o=window.getComputedStyle(t).getPropertyValue(n);if(o){const i=o.trim();return nK(i)?parseFloat(i):i}else return xI(s)?EI(s,t,r+1):s}function Rpe(e,{...t},r){const n=e.current;if(!(n instanceof Element))return{target:t,transitionEnd:r};r&&(r={...r}),e.values.forEach(s=>{const o=s.get();if(!xI(o))return;const i=EI(o,n);i&&s.set(i)});for(const s in t){const o=t[s];if(!xI(o))continue;const i=EI(o,n);i&&(t[s]=i,r||(r={}),r[s]===void 0&&(r[s]=o))}return{target:t,transitionEnd:r}}const Lpe=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),jK=e=>Lpe.has(e),Fpe=e=>Object.keys(e).some(jK),U$=e=>e===Mg||e===ra,V$=(e,t)=>parseFloat(e.split(", ")[t]),W$=(e,t)=>(r,{transform:n})=>{if(n==="none"||!n)return 0;const s=n.match(/^matrix3d\((.+)\)$/);if(s)return V$(s[1],t);{const o=n.match(/^matrix\((.+)\)$/);return o?V$(o[1],e):0}},$pe=new Set(["x","y","z"]),Bpe=b1.filter(e=>!$pe.has(e));function qpe(e){const t=[];return Bpe.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t.length&&e.render(),t}const Dx={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:W$(4,13),y:W$(5,14)};Dx.translateX=Dx.x;Dx.translateY=Dx.y;const zpe=(e,t,r)=>{const n=t.measureViewportBox(),s=t.current,o=getComputedStyle(s),{display:i}=o,l={};i==="none"&&t.setStaticValue("display",e.display||"block"),r.forEach(d=>{l[d]=Dx[d](n,o)}),t.render();const c=t.measureViewportBox();return r.forEach(d=>{const u=t.getValue(d);u&&u.jump(l[d]),e[d]=Dx[d](c,o)}),e},Upe=(e,t,r={},n={})=>{t={...t},n={...n};const s=Object.keys(t).filter(jK);let o=[],i=!1;const l=[];if(s.forEach(c=>{const d=e.getValue(c);if(!e.hasValue(c))return;let u=r[c],f=fy(u);const h=t[c];let m;if(J_(h)){const v=h.length,g=h[0]===null?1:0;u=h[g],f=fy(u);for(let y=g;y<v&&h[y]!==null;y++)m?B4(fy(h[y])===m):m=fy(h[y])}else m=fy(h);if(f!==m)if(U$(f)&&U$(m)){const v=d.get();typeof v=="string"&&d.set(parseFloat(v)),typeof h=="string"?t[c]=parseFloat(h):Array.isArray(h)&&m===ra&&(t[c]=h.map(parseFloat))}else f?.transform&&m?.transform&&(u===0||h===0)?u===0?d.set(m.transform(u)):t[c]=f.transform(h):(i||(o=qpe(e),i=!0),l.push(c),n[c]=n[c]!==void 0?n[c]:t[c],d.jump(h))}),l.length){const c=l.indexOf("height")>=0?window.pageYOffset:null,d=zpe(t,e,l);return o.length&&o.forEach(([u,f])=>{e.getValue(u).set(f)}),e.render(),xC&&c!==null&&window.scrollTo({top:c}),{target:d,transitionEnd:n}}else return{target:t,transitionEnd:n}};function Vpe(e,t,r,n){return Fpe(t)?Upe(e,t,r,n):{target:t,transitionEnd:n}}const Wpe=(e,t,r,n)=>{const s=Rpe(e,t,n);return t=s.target,n=s.transitionEnd,Vpe(e,t,r,n)},kI={current:null},_K={current:!1};function Hpe(){if(_K.current=!0,!!xC)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>kI.current=e.matches;e.addListener(t),t()}else kI.current=!1}function Gpe(e,t,r){const{willChange:n}=t;for(const s in t){const o=t[s],i=r[s];if(lc(o))e.addValue(s,o),tN(n)&&n.add(s);else if(lc(i))e.addValue(s,Tx(o,{owner:e})),tN(n)&&n.remove(s);else if(i!==o)if(e.hasValue(s)){const l=e.getValue(s);!l.hasAnimated&&l.set(o)}else{const l=e.getStaticValue(s);e.addValue(s,Tx(l!==void 0?l:o,{owner:e}))}}for(const s in r)t[s]===void 0&&e.removeValue(s);return t}const H$=new WeakMap,NK=Object.keys(nw),Kpe=NK.length,G$=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],Xpe=I4.length;class Ype{constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:s,visualState:o},i={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>Cs.render(this.render,!1,!0);const{latestValues:l,renderState:c}=o;this.latestValues=l,this.baseTarget={...l},this.initialValues=r.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=i,this.isControllingVariants=bC(r),this.isVariantNode=lG(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:d,...u}=this.scrapeMotionValuesFromProps(r,{});for(const f in u){const h=u[f];l[f]!==void 0&&lc(h)&&(h.set(l[f],!1),tN(d)&&d.add(f))}}scrapeMotionValuesFromProps(t,r){return{}}mount(t){this.current=t,H$.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),_K.current||Hpe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:kI.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){H$.delete(this.current),this.projection&&this.projection.unmount(),Qf(this.notifyUpdate),Qf(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,r){const n=Dg.has(t),s=r.on("change",i=>{this.latestValues[t]=i,this.props.onUpdate&&Cs.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),o=r.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{s(),o()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...r},n,s,o){let i,l;for(let c=0;c<Kpe;c++){const d=NK[c],{isEnabled:u,Feature:f,ProjectionNode:h,MeasureLayout:m}=nw[d];h&&(i=h),u(r)&&(!this.features[d]&&f&&(this.features[d]=new f(this)),m&&(l=m))}if((this.type==="html"||this.type==="svg")&&!this.projection&&i){this.projection=new i(this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:d,drag:u,dragConstraints:f,layoutScroll:h,layoutRoot:m}=r;this.projection.setOptions({layoutId:c,layout:d,alwaysMeasureLayout:!!u||f&&Wv(f),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof d=="string"?d:"both",initialPromotionConfig:o,layoutScroll:h,layoutRoot:m})}return l}updateFeatures(){for(const t in this.features){const r=this.features[t];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Io()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}makeTargetAnimatable(t,r=!0){return this.makeTargetAnimatableFromInstance(t,this.props,r)}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<G$.length;n++){const s=G$[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const o=t["on"+s];o&&(this.propEventSubscriptions[s]=this.on(s,o))}this.prevMotionValues=Gpe(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const n=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(n.initial=this.props.initial),n}const r={};for(let n=0;n<Xpe;n++){const s=I4[n],o=this.props[s];(rw(o)||o===!1)&&(r[s]=o)}return r}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){r!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,r)),this.values.set(t,r),this.latestValues[t]=r.get()}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=Tx(r,{owner:this}),this.addValue(t,n)),n}readValue(t){var r;return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(r=this.getBaseTargetFromProps(this.props,t))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var r;const{initial:n}=this.props,s=typeof n=="string"||typeof n=="object"?(r=$4(this.props,n))===null||r===void 0?void 0:r[t]:void 0;if(n&&s!==void 0)return s;const o=this.getBaseTargetFromProps(this.props,t);return o!==void 0&&!lc(o)?o:this.initialValues[t]!==void 0&&s===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new X4),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class SK extends Ype{sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:r,...n},{transformValues:s},o){let i=mhe(n,t||{},this);if(s&&(r&&(r=s(r)),n&&(n=s(n)),i&&(i=s(i))),o){uhe(this,n,i);const l=Wpe(this,n,i,r);r=l.transitionEnd,n=l.target}return{transition:t,transitionEnd:r,...n}}}function Jpe(e){return window.getComputedStyle(e)}class Qpe extends SK{constructor(){super(...arguments),this.type="html"}readValueFromInstance(t,r){if(Dg.has(r)){const n=V4(r);return n&&n.default||0}else{const n=Jpe(t),s=(fG(r)?n.getPropertyValue(r):n[r])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:r}){return fK(t,r)}build(t,r,n,s){D4(t,r,n,s.transformTemplate)}scrapeMotionValuesFromProps(t,r){return F4(t,r)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;lc(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}renderInstance(t,r,n,s){xG(t,r,n,s)}}class Zpe extends SK{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(Dg.has(r)){const n=V4(r);return n&&n.default||0}return r=yG.has(r)?r:E4(r),t.getAttribute(r)}measureInstanceViewportBox(){return Io()}scrapeMotionValuesFromProps(t,r){return wG(t,r)}build(t,r,n,s){R4(t,r,n,this.isSVGTag,s.transformTemplate)}renderInstance(t,r,n,s){bG(t,r,n,s)}mount(t){this.isSVGTag=L4(t.tagName),super.mount(t)}}const ege=(e,t)=>T4(e)?new Zpe(t,{enableHardwareAcceleration:!1}):new Qpe(t,{enableHardwareAcceleration:!0}),tge={layout:{ProjectionNode:wK,MeasureLayout:hK}},rge={...Ahe,...Kfe,...Tpe,...tge},xr=nfe((e,t)=>Mfe(e,t,rge,ege));function CK(){const e=p.useRef(!1);return A4(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function nge(){const e=CK(),[t,r]=p.useState(0),n=p.useCallback(()=>{e.current&&r(t+1)},[t]);return[p.useCallback(()=>Cs.postRender(n),[n]),t]}class age extends p.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=r.offsetHeight||0,n.width=r.offsetWidth||0,n.top=r.offsetTop,n.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function sge({children:e,isPresent:t}){const r=p.useId(),n=p.useRef(null),s=p.useRef({width:0,height:0,top:0,left:0});return p.useInsertionEffect(()=>{const{width:o,height:i,top:l,left:c}=s.current;if(t||!n.current||!o||!i)return;n.current.dataset.motionPopId=r;const d=document.createElement("style");return document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${i}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[t]),p.createElement(age,{isPresent:t,childRef:n,sizeRef:s},p.cloneElement(e,{ref:n}))}const xA=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:o,mode:i})=>{const l=jG(oge),c=p.useId(),d=p.useMemo(()=>({id:c,initial:t,isPresent:r,custom:s,onExitComplete:u=>{l.set(u,!0);for(const f of l.values())if(!f)return;n&&n()},register:u=>(l.set(u,!1),()=>l.delete(u))}),o?void 0:[r]);return p.useMemo(()=>{l.forEach((u,f)=>l.set(f,!1))},[r]),p.useEffect(()=>{!r&&!l.size&&n&&n()},[r]),i==="popLayout"&&(e=p.createElement(sge,{isPresent:r},e)),p.createElement(vC.Provider,{value:d},e)};function oge(){return new Map}function ige(e){return p.useEffect(()=>()=>e(),[])}const wp=e=>e.key||"";function lge(e,t){e.forEach(r=>{const n=wp(r);t.set(n,r)})}function cge(e){const t=[];return p.Children.forEach(e,r=>{p.isValidElement(r)&&t.push(r)}),t}const dge=({children:e,custom:t,initial:r=!0,onExitComplete:n,exitBeforeEnter:s,presenceAffectsLayout:o=!0,mode:i="sync"})=>{const l=p.useContext(O4).forceRender||nge()[0],c=CK(),d=cge(e);let u=d;const f=p.useRef(new Map).current,h=p.useRef(u),m=p.useRef(new Map).current,v=p.useRef(!0);if(A4(()=>{v.current=!1,lge(d,m),h.current=u}),ige(()=>{v.current=!0,m.clear(),f.clear()}),v.current)return p.createElement(p.Fragment,null,u.map(b=>p.createElement(xA,{key:wp(b),isPresent:!0,initial:r?void 0:!1,presenceAffectsLayout:o,mode:i},b)));u=[...u];const g=h.current.map(wp),y=d.map(wp),x=g.length;for(let b=0;b<x;b++){const w=g[b];y.indexOf(w)===-1&&!f.has(w)&&f.set(w,void 0)}return i==="wait"&&f.size&&(u=[]),f.forEach((b,w)=>{if(y.indexOf(w)!==-1)return;const j=m.get(w);if(!j)return;const _=g.indexOf(w);let S=b;if(!S){const C=()=>{f.delete(w);const P=Array.from(m.keys()).filter(A=>!y.includes(A));if(P.forEach(A=>m.delete(A)),h.current=d.filter(A=>{const R=wp(A);return R===w||P.includes(R)}),!f.size){if(c.current===!1)return;l(),n&&n()}};S=p.createElement(xA,{key:wp(j),isPresent:!1,onExitComplete:C,custom:t,presenceAffectsLayout:o,mode:i},j),f.set(w,S)}u.splice(_,0,S)}),u=u.map(b=>{const w=b.key;return f.has(w)?b:p.createElement(xA,{key:wp(b),isPresent:!0,presenceAffectsLayout:o,mode:i},b)}),p.createElement(p.Fragment,null,f.size?u:u.map(b=>p.cloneElement(b)))};function K$(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function NC(...e){return t=>{let r=!1;const n=e.map(s=>{const o=K$(s,t);return!r&&typeof o=="function"&&(r=!0),o});if(r)return()=>{for(let s=0;s<n.length;s++){const o=n[s];typeof o=="function"?o():K$(e[s],null)}}}}function $a(...e){return p.useCallback(NC(...e),e)}function Th(e){const t=fge(e),r=p.forwardRef((n,s)=>{const{children:o,...i}=n,l=p.Children.toArray(o),c=l.find(hge);if(c){const d=c.props.children,u=l.map(f=>f===c?p.Children.count(d)>1?p.Children.only(null):p.isValidElement(d)?d.props.children:null:f);return a.jsx(t,{...i,ref:s,children:p.isValidElement(d)?p.cloneElement(d,void 0,u):null})}return a.jsx(t,{...i,ref:s,children:o})});return r.displayName=`${e}.Slot`,r}var uge=Th("Slot");function fge(e){const t=p.forwardRef((r,n)=>{const{children:s,...o}=r;if(p.isValidElement(s)){const i=gge(s),l=pge(o,s.props);return s.type!==p.Fragment&&(l.ref=n?NC(n,i):i),p.cloneElement(s,l)}return p.Children.count(s)>1?p.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var PK=Symbol("radix.slottable");function mge(e){const t=({children:r})=>a.jsx(a.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=PK,t}function hge(e){return p.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===PK}function pge(e,t){const r={...t};for(const n in t){const s=e[n],o=t[n];/^on[A-Z]/.test(n)?s&&o?r[n]=(...l)=>{const c=o(...l);return s(...l),c}:s&&(r[n]=s):n==="style"?r[n]={...s,...o}:n==="className"&&(r[n]=[s,o].filter(Boolean).join(" "))}return{...e,...r}}function gge(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}const X$=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,Y$=fa,Y4=(e,t)=>r=>{var n;if(t?.variants==null)return Y$(e,r?.class,r?.className);const{variants:s,defaultVariants:o}=t,i=Object.keys(s).map(d=>{const u=r?.[d],f=o?.[d];if(u===null)return null;const h=X$(u)||X$(f);return s[d][h]}),l=r&&Object.entries(r).reduce((d,u)=>{let[f,h]=u;return h===void 0||(d[f]=h),d},{}),c=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((d,u)=>{let{class:f,className:h,...m}=u;return Object.entries(m).every(v=>{let[g,y]=v;return Array.isArray(y)?y.includes({...o,...l}[g]):{...o,...l}[g]===y})?[...d,f,h]:d},[]);return Y$(e,i,c,r?.class,r?.className)},sw=Y4("inline-flex items-center justify-center rounded-sm text-sm font-bold tracking-wide transition-all duration-200 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background active:scale-[0.98] disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-brand text-primary-foreground hover:bg-brand/90 shadow-lg shadow-brand/15",destructive:"bg-danger text-white hover:bg-danger/90 shadow-lg shadow-danger/15",outline:"border border-border bg-transparent hover:bg-accent hover:text-accent-foreground",secondary:"bg-surface-2 text-secondary-foreground hover:bg-surface-2/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-brand underline-offset-4 hover:underline",success:"bg-success text-white hover:bg-success/90 shadow-lg shadow-success/15"},size:{default:"h-10 px-5 py-2 gap-2",sm:"h-9 rounded-sm px-3 gap-1.5",lg:"h-12 rounded-md px-8 gap-2.5 text-base",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),fe=Pe.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...s},o)=>{const i=n?uge:"button";return a.jsx(i,{className:pr(sw({variant:t,size:r,className:e})),ref:o,...s})});fe.displayName="Button";const H2=[{to:"/",icon:Tue,label:"Painel Principal"},{to:"/agenda",icon:Bs,label:"Agenda"},{to:"/vendas",icon:y1,label:"Loja"},{to:"/financeiro",icon:aG,label:"Financeiro"},{to:"/fiscal",icon:_4,label:"Central Fiscal"}],a_={hidden:{opacity:0,x:-20},visible:e=>({opacity:1,x:0,transition:{delay:e*.05+.3,duration:.3,ease:"easeOut"}})},vge=({to:e,icon:t,label:r,index:n,onNavigate:s})=>{const o="flex items-center h-[52px] px-4 rounded-sm bg-brand text-primary-foreground font-bold shadow-lg shadow-brand/10 border-l-4 border-brand w-full",i="flex items-center h-[52px] px-4 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-all duration-200 border-l-4 border-transparent w-full";return a.jsx(xr.li,{custom:n,variants:a_,initial:"hidden",animate:"visible",whileHover:{x:4},transition:{type:"spring",stiffness:300,damping:15},children:a.jsxs(Du,{to:e,onClick:s,className:({isActive:l})=>e==="/isis"&&l?"flex items-center h-[52px] px-4 rounded-sm font-bold text-white shadow-lg shadow-emerald-500/10 border-l-4 border-transparent bg-gradient-to-r from-fuchsia-600 via-violet-600 to-emerald-600 ring-1 ring-white/10":l?o:i,children:[e==="/isis"?a.jsx("span",{className:"mr-4 flex-shrink-0 inline-flex items-center justify-center rounded-full p-[3px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400 shadow-[0_0_12px_rgba(168,85,247,0.35)]",children:a.jsx("span",{className:"rounded-full overflow-hidden bg-background",children:a.jsx(gi,{size:"sm"})})}):a.jsx(t,{className:"h-5 w-5 mr-4 flex-shrink-0"}),a.jsx("span",{className:"text-base flex items-center gap-2",children:r})]})})};function xge({onNavigate:e,isVisible:t,setIsVisible:r,sidebarPinned:n}){const s=zi(),o=$o(),i=["/produtos","/compras","/clientes","/equipe","/quadras","/empresas","/finalizadoras"],l=p.useMemo(()=>i.includes(o.pathname),[o.pathname]),[c,d]=p.useState(l),u=p.useRef(null);p.useRef(null);const f=p.useRef(0),h=p.useRef(0),m=()=>{window.innerWidth<768&&r(!1)};return p.useEffect(()=>{const v=x=>{window.innerWidth>=768||(f.current=x.touches[0].clientX,h.current=x.touches[0].clientY)},g=x=>{if(window.innerWidth>=768)return;const b=x.touches[0].clientX,w=x.touches[0].clientY,j=b-f.current,_=Math.abs(w-h.current);f.current<50&&j>50&&_<50&&r(!0)},y=()=>{f.current=0,h.current=0};return window.addEventListener("touchstart",v,{passive:!0}),window.addEventListener("touchmove",g,{passive:!0}),window.addEventListener("touchend",y,{passive:!0}),()=>{window.removeEventListener("touchstart",v),window.removeEventListener("touchmove",g),window.removeEventListener("touchend",y)}},[t]),a.jsx(a.Fragment,{children:a.jsxs(xr.aside,{ref:u,initial:!1,animate:{width:n||t?280:0},className:`h-screen bg-surface flex flex-col border-r border-border shadow-xl shadow-black/20 overflow-hidden\r
                   fixed inset-y-0 left-0 z-40 md:static md:flex-shrink-0`,children:[a.jsxs(xr.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.4},className:"flex items-center px-6 pt-8 pb-6 h-[120px] flex-shrink-0",children:[a.jsx("div",{className:"w-14 h-14 bg-brand rounded-xl flex items-center justify-center mr-4",children:a.jsx(Dc,{className:"w-8 h-8 text-primary-foreground"})}),a.jsxs("div",{className:"flex items-baseline",children:[a.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FFAA33"},children:"7"}),a.jsx("span",{className:"font-medium text-2xl",style:{color:"#B0B0B0"},children:" Arena"})]})]}),a.jsx("nav",{className:"flex-1 overflow-y-auto px-6 py-2 scrollbar-thin scrollbar-thumb-border scrollbar-track-transparent hover:scrollbar-thumb-border-hover",children:a.jsxs("ul",{className:"space-y-3",children:[H2.map((v,g)=>a.jsx(vge,{...v,index:g,onNavigate:m},v.to)),a.jsxs(xr.li,{custom:H2.length,variants:a_,initial:"hidden",animate:"visible",children:[a.jsxs("button",{type:"button",onClick:()=>d(v=>!v),className:`w-full flex items-center h-[52px] px-4 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-all duration-200 border-l-4 ${l?"bg-brand text-primary-foreground font-bold border-brand":"border-transparent"}`,children:[a.jsx(Sue,{className:"h-5 w-5 mr-4 flex-shrink-0"}),a.jsx("span",{className:"text-base flex-1 text-left",children:"Cadastros"}),a.jsx(Tg,{className:`h-4 w-4 transition-transform ${c?"rotate-180":""}`})]}),c&&a.jsxs("ul",{className:"mt-2 ml-8 space-y-2",children:[a.jsx("li",{children:a.jsxs(Du,{to:"/clientes",onClick:m,className:({isActive:v})=>v?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[a.jsx(Pl,{className:"h-4 w-4 mr-3"})," Clientes & Fornecedores"]})}),a.jsx("li",{children:a.jsxs(Du,{to:"/finalizadoras",onClick:m,className:({isActive:v})=>v?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[a.jsx(Qm,{className:"h-4 w-4 mr-3"})," Finalizadoras"]})}),a.jsx("li",{children:a.jsxs(Du,{to:"/produtos",onClick:m,className:({isActive:v})=>v?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[a.jsx(Td,{className:"h-4 w-4 mr-3"})," Produtos"]})}),a.jsx("li",{children:a.jsxs(Du,{to:"/compras",onClick:m,className:({isActive:v})=>v?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[a.jsx(lx,{className:"h-4 w-4 mr-3"})," Compras"]})}),a.jsx("li",{children:a.jsxs(Du,{to:"/equipe",onClick:m,className:({isActive:v})=>v?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[a.jsx(Hue,{className:"h-4 w-4 mr-3"})," Equipe"]})}),a.jsx("li",{children:a.jsxs(Du,{to:"/quadras",onClick:m,className:({isActive:v})=>v?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[a.jsx(Oue,{className:"h-4 w-4 mr-3"})," Quadras"]})}),a.jsx("li",{children:a.jsxs(Du,{to:"/empresas",onClick:m,className:({isActive:v})=>v?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[a.jsx(K_,{className:"h-4 w-4 mr-3"})," Empresa"]})})]})]}),a.jsx(xr.li,{custom:H2.length+1,variants:a_,initial:"hidden",animate:"visible",className:"pt-4 border-t border-border/50 mt-4",children:a.jsxs(Du,{to:"/suporte",onClick:m,className:({isActive:v})=>v?"flex items-center h-[52px] px-4 rounded-sm bg-brand text-primary-foreground font-bold shadow-lg shadow-brand/10 border-l-4 border-brand":"flex items-center h-[52px] px-4 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-all duration-200 border-l-4 border-transparent",children:[a.jsx(QH,{className:"h-5 w-5 mr-4 flex-shrink-0"}),a.jsx("span",{className:"text-base",children:"Suporte"})]})}),a.jsx(xr.li,{custom:H2.length+2,variants:a_,initial:"hidden",animate:"visible",children:a.jsxs(Du,{to:"/isis",onClick:m,className:({isActive:v})=>v?"flex items-center h-[56px] px-4 rounded-sm font-extrabold text-text-primary bg-surface-2/80 border border-white/20 shadow-[inset_0_0_0_1px_rgba(255,255,255,0.06)]":"flex items-center h-[56px] px-4 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-all duration-200 border border-white/15",children:[a.jsx("span",{className:"mr-4 flex-shrink-0 inline-flex items-center justify-center rounded-full p-[3px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400 shadow-[0_0_12px_rgba(168,85,247,0.35)]",children:a.jsx("span",{className:"rounded-full overflow-hidden bg-background",children:a.jsx(gi,{size:"sm"})})}),a.jsx("span",{className:"text-lg font-extrabold bg-clip-text text-transparent bg-gradient-to-r from-fuchsia-400 via-violet-300 to-emerald-300",children:"sis"}),a.jsx("button",{type:"button",title:"Dashboard analtica da sis",onClick:v=>{v.preventDefault(),v.stopPropagation(),s("/isis/analytics")},className:"ml-auto inline-flex items-center justify-center p-2.5 rounded-full text-text-secondary hover:text-text-primary hover:bg-white/10 transition-all border border-white/10 hover:border-white/20 cursor-pointer shadow-sm hover:shadow",children:a.jsx(Ad,{className:"h-5 w-5"})})]})})]})})]})})}function gn(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e?.(s),r===!1||!s.defaultPrevented)return t?.(s)}}function yge(e,t){const r=p.createContext(t),n=o=>{const{children:i,...l}=o,c=p.useMemo(()=>l,Object.values(l));return a.jsx(r.Provider,{value:c,children:i})};n.displayName=e+"Provider";function s(o){const i=p.useContext(r);if(i)return i;if(t!==void 0)return t;throw new Error(`\`${o}\` must be used within \`${e}\``)}return[n,s]}function Ld(e,t=[]){let r=[];function n(o,i){const l=p.createContext(i),c=r.length;r=[...r,i];const d=f=>{const{scope:h,children:m,...v}=f,g=h?.[e]?.[c]||l,y=p.useMemo(()=>v,Object.values(v));return a.jsx(g.Provider,{value:y,children:m})};d.displayName=o+"Provider";function u(f,h){const m=h?.[e]?.[c]||l,v=p.useContext(m);if(v)return v;if(i!==void 0)return i;throw new Error(`\`${f}\` must be used within \`${o}\``)}return[d,u]}const s=()=>{const o=r.map(i=>p.createContext(i));return function(l){const c=l?.[e]||o;return p.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return s.scopeName=e,[n,bge(s,...t)]}function bge(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(o){const i=n.reduce((l,{useScope:c,scopeName:d})=>{const f=c(o)[`__scope${d}`];return{...l,...f}},{});return p.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return r.scopeName=t.scopeName,r}var wge=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ta=wge.reduce((e,t)=>{const r=Th(`Primitive.${t}`),n=p.forwardRef((s,o)=>{const{asChild:i,...l}=s,c=i?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),a.jsx(c,{...l,ref:o})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function J4(e,t){e&&im.flushSync(()=>e.dispatchEvent(t))}function cc(e){const t=p.useRef(e);return p.useEffect(()=>{t.current=e}),p.useMemo(()=>(...r)=>t.current?.(...r),[])}function jge(e,t=globalThis?.document){const r=cc(e);p.useEffect(()=>{const n=s=>{s.key==="Escape"&&r(s)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var _ge="DismissableLayer",II="dismissableLayer.update",Nge="dismissableLayer.pointerDownOutside",Sge="dismissableLayer.focusOutside",J$,AK=p.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),_0=p.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:o,onInteractOutside:i,onDismiss:l,...c}=e,d=p.useContext(AK),[u,f]=p.useState(null),h=u?.ownerDocument??globalThis?.document,[,m]=p.useState({}),v=$a(t,C=>f(C)),g=Array.from(d.layers),[y]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),x=g.indexOf(y),b=u?g.indexOf(u):-1,w=d.layersWithOutsidePointerEventsDisabled.size>0,j=b>=x,_=Pge(C=>{const P=C.target,A=[...d.branches].some(R=>R.contains(P));!j||A||(s?.(C),i?.(C),C.defaultPrevented||l?.())},h),S=Age(C=>{const P=C.target;[...d.branches].some(R=>R.contains(P))||(o?.(C),i?.(C),C.defaultPrevented||l?.())},h);return jge(C=>{b===d.layers.size-1&&(n?.(C),!C.defaultPrevented&&l&&(C.preventDefault(),l()))},h),p.useEffect(()=>{if(u)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(J$=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(u)),d.layers.add(u),Q$(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=J$)}},[u,h,r,d]),p.useEffect(()=>()=>{u&&(d.layers.delete(u),d.layersWithOutsidePointerEventsDisabled.delete(u),Q$())},[u,d]),p.useEffect(()=>{const C=()=>m({});return document.addEventListener(II,C),()=>document.removeEventListener(II,C)},[]),a.jsx(ta.div,{...c,ref:v,style:{pointerEvents:w?j?"auto":"none":void 0,...e.style},onFocusCapture:gn(e.onFocusCapture,S.onFocusCapture),onBlurCapture:gn(e.onBlurCapture,S.onBlurCapture),onPointerDownCapture:gn(e.onPointerDownCapture,_.onPointerDownCapture)})});_0.displayName=_ge;var Cge="DismissableLayerBranch",EK=p.forwardRef((e,t)=>{const r=p.useContext(AK),n=p.useRef(null),s=$a(t,n);return p.useEffect(()=>{const o=n.current;if(o)return r.branches.add(o),()=>{r.branches.delete(o)}},[r.branches]),a.jsx(ta.div,{...e,ref:s})});EK.displayName=Cge;function Pge(e,t=globalThis?.document){const r=cc(e),n=p.useRef(!1),s=p.useRef(()=>{});return p.useEffect(()=>{const o=l=>{if(l.target&&!n.current){let c=function(){kK(Nge,r,d,{discrete:!0})};const d={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=c,t.addEventListener("click",s.current,{once:!0})):c()}else t.removeEventListener("click",s.current);n.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",o),t.removeEventListener("click",s.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function Age(e,t=globalThis?.document){const r=cc(e),n=p.useRef(!1);return p.useEffect(()=>{const s=o=>{o.target&&!n.current&&kK(Sge,r,{originalEvent:o},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function Q$(){const e=new CustomEvent(II);document.dispatchEvent(e)}function kK(e,t,r,{discrete:n}){const s=r.originalEvent.target,o=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?J4(s,o):s.dispatchEvent(o)}var Ege=_0,kge=EK,yA=0;function SC(){p.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??Z$()),document.body.insertAdjacentElement("beforeend",e[1]??Z$()),yA++,()=>{yA===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),yA--}},[])}function Z$(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var bA="focusScope.autoFocusOnMount",wA="focusScope.autoFocusOnUnmount",e6={bubbles:!1,cancelable:!0},Ige="FocusScope",N1=p.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:o,...i}=e,[l,c]=p.useState(null),d=cc(s),u=cc(o),f=p.useRef(null),h=$a(t,g=>c(g)),m=p.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;p.useEffect(()=>{if(n){let g=function(w){if(m.paused||!l)return;const j=w.target;l.contains(j)?f.current=j:Tm(f.current,{select:!0})},y=function(w){if(m.paused||!l)return;const j=w.relatedTarget;j!==null&&(l.contains(j)||Tm(f.current,{select:!0}))},x=function(w){if(document.activeElement===document.body)for(const _ of w)_.removedNodes.length>0&&Tm(l)};document.addEventListener("focusin",g),document.addEventListener("focusout",y);const b=new MutationObserver(x);return l&&b.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",y),b.disconnect()}}},[n,l,m.paused]),p.useEffect(()=>{if(l){r6.add(m);const g=document.activeElement;if(!l.contains(g)){const x=new CustomEvent(bA,e6);l.addEventListener(bA,d),l.dispatchEvent(x),x.defaultPrevented||(Oge(Lge(IK(l)),{select:!0}),document.activeElement===g&&Tm(l))}return()=>{l.removeEventListener(bA,d),setTimeout(()=>{const x=new CustomEvent(wA,e6);l.addEventListener(wA,u),l.dispatchEvent(x),x.defaultPrevented||Tm(g??document.body,{select:!0}),l.removeEventListener(wA,u),r6.remove(m)},0)}}},[l,d,u,m]);const v=p.useCallback(g=>{if(!r&&!n||m.paused)return;const y=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,x=document.activeElement;if(y&&x){const b=g.currentTarget,[w,j]=Tge(b);w&&j?!g.shiftKey&&x===j?(g.preventDefault(),r&&Tm(w,{select:!0})):g.shiftKey&&x===w&&(g.preventDefault(),r&&Tm(j,{select:!0})):x===b&&g.preventDefault()}},[r,n,m.paused]);return a.jsx(ta.div,{tabIndex:-1,...i,ref:h,onKeyDown:v})});N1.displayName=Ige;function Oge(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(Tm(n,{select:t}),document.activeElement!==r)return}function Tge(e){const t=IK(e),r=t6(t,e),n=t6(t.reverse(),e);return[r,n]}function IK(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function t6(e,t){for(const r of e)if(!Dge(r,{upTo:t}))return r}function Dge(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Mge(e){return e instanceof HTMLInputElement&&"select"in e}function Tm(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&Mge(e)&&t&&e.select()}}var r6=Rge();function Rge(){let e=[];return{add(t){const r=e[0];t!==r&&r?.pause(),e=n6(e,t),e.unshift(t)},remove(t){e=n6(e,t),e[0]?.resume()}}}function n6(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function Lge(e){return e.filter(t=>t.tagName!=="A")}var qi=globalThis?.document?p.useLayoutEffect:()=>{},Fge=S3[" useId ".trim().toString()]||(()=>{}),$ge=0;function uu(e){const[t,r]=p.useState(Fge());return qi(()=>{e||r(n=>n??String($ge++))},[e]),e||(t?`radix-${t}`:"")}const Bge=["top","right","bottom","left"],Dh=Math.min,Ec=Math.max,nN=Math.round,G2=Math.floor,Zu=e=>({x:e,y:e}),qge={left:"right",right:"left",bottom:"top",top:"bottom"},zge={start:"end",end:"start"};function OI(e,t,r){return Ec(e,Dh(t,r))}function Zf(e,t){return typeof e=="function"?e(t):e}function em(e){return e.split("-")[0]}function N0(e){return e.split("-")[1]}function Q4(e){return e==="x"?"y":"x"}function Z4(e){return e==="y"?"height":"width"}const Uge=new Set(["top","bottom"]);function Vu(e){return Uge.has(em(e))?"y":"x"}function eD(e){return Q4(Vu(e))}function Vge(e,t,r){r===void 0&&(r=!1);const n=N0(e),s=eD(e),o=Z4(s);let i=s==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(i=aN(i)),[i,aN(i)]}function Wge(e){const t=aN(e);return[TI(e),t,TI(t)]}function TI(e){return e.replace(/start|end/g,t=>zge[t])}const a6=["left","right"],s6=["right","left"],Hge=["top","bottom"],Gge=["bottom","top"];function Kge(e,t,r){switch(e){case"top":case"bottom":return r?t?s6:a6:t?a6:s6;case"left":case"right":return t?Hge:Gge;default:return[]}}function Xge(e,t,r,n){const s=N0(e);let o=Kge(em(e),r==="start",n);return s&&(o=o.map(i=>i+"-"+s),t&&(o=o.concat(o.map(TI)))),o}function aN(e){return e.replace(/left|right|bottom|top/g,t=>qge[t])}function Yge(e){return{top:0,right:0,bottom:0,left:0,...e}}function OK(e){return typeof e!="number"?Yge(e):{top:e,right:e,bottom:e,left:e}}function sN(e){const{x:t,y:r,width:n,height:s}=e;return{width:n,height:s,top:r,left:t,right:t+n,bottom:r+s,x:t,y:r}}function o6(e,t,r){let{reference:n,floating:s}=e;const o=Vu(t),i=eD(t),l=Z4(i),c=em(t),d=o==="y",u=n.x+n.width/2-s.width/2,f=n.y+n.height/2-s.height/2,h=n[l]/2-s[l]/2;let m;switch(c){case"top":m={x:u,y:n.y-s.height};break;case"bottom":m={x:u,y:n.y+n.height};break;case"right":m={x:n.x+n.width,y:f};break;case"left":m={x:n.x-s.width,y:f};break;default:m={x:n.x,y:n.y}}switch(N0(t)){case"start":m[i]-=h*(r&&d?-1:1);break;case"end":m[i]+=h*(r&&d?-1:1);break}return m}const Jge=async(e,t,r)=>{const{placement:n="bottom",strategy:s="absolute",middleware:o=[],platform:i}=r,l=o.filter(Boolean),c=await(i.isRTL==null?void 0:i.isRTL(t));let d=await i.getElementRects({reference:e,floating:t,strategy:s}),{x:u,y:f}=o6(d,n,c),h=n,m={},v=0;for(let g=0;g<l.length;g++){const{name:y,fn:x}=l[g],{x:b,y:w,data:j,reset:_}=await x({x:u,y:f,initialPlacement:n,placement:h,strategy:s,middlewareData:m,rects:d,platform:i,elements:{reference:e,floating:t}});u=b??u,f=w??f,m={...m,[y]:{...m[y],...j}},_&&v<=50&&(v++,typeof _=="object"&&(_.placement&&(h=_.placement),_.rects&&(d=_.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:s}):_.rects),{x:u,y:f}=o6(d,h,c)),g=-1)}return{x:u,y:f,placement:h,strategy:s,middlewareData:m}};async function ow(e,t){var r;t===void 0&&(t={});const{x:n,y:s,platform:o,rects:i,elements:l,strategy:c}=e,{boundary:d="clippingAncestors",rootBoundary:u="viewport",elementContext:f="floating",altBoundary:h=!1,padding:m=0}=Zf(t,e),v=OK(m),y=l[h?f==="floating"?"reference":"floating":f],x=sN(await o.getClippingRect({element:(r=await(o.isElement==null?void 0:o.isElement(y)))==null||r?y:y.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(l.floating)),boundary:d,rootBoundary:u,strategy:c})),b=f==="floating"?{x:n,y:s,width:i.floating.width,height:i.floating.height}:i.reference,w=await(o.getOffsetParent==null?void 0:o.getOffsetParent(l.floating)),j=await(o.isElement==null?void 0:o.isElement(w))?await(o.getScale==null?void 0:o.getScale(w))||{x:1,y:1}:{x:1,y:1},_=sN(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:b,offsetParent:w,strategy:c}):b);return{top:(x.top-_.top+v.top)/j.y,bottom:(_.bottom-x.bottom+v.bottom)/j.y,left:(x.left-_.left+v.left)/j.x,right:(_.right-x.right+v.right)/j.x}}const Qge=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:s,rects:o,platform:i,elements:l,middlewareData:c}=t,{element:d,padding:u=0}=Zf(e,t)||{};if(d==null)return{};const f=OK(u),h={x:r,y:n},m=eD(s),v=Z4(m),g=await i.getDimensions(d),y=m==="y",x=y?"top":"left",b=y?"bottom":"right",w=y?"clientHeight":"clientWidth",j=o.reference[v]+o.reference[m]-h[m]-o.floating[v],_=h[m]-o.reference[m],S=await(i.getOffsetParent==null?void 0:i.getOffsetParent(d));let C=S?S[w]:0;(!C||!await(i.isElement==null?void 0:i.isElement(S)))&&(C=l.floating[w]||o.floating[v]);const P=j/2-_/2,A=C/2-g[v]/2-1,R=Dh(f[x],A),O=Dh(f[b],A),I=R,M=C-g[v]-O,D=C/2-g[v]/2+P,U=OI(I,D,M),z=!c.arrow&&N0(s)!=null&&D!==U&&o.reference[v]/2-(D<I?R:O)-g[v]/2<0,W=z?D<I?D-I:D-M:0;return{[m]:h[m]+W,data:{[m]:U,centerOffset:D-U-W,...z&&{alignmentOffset:W}},reset:z}}}),Zge=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:s,middlewareData:o,rects:i,initialPlacement:l,platform:c,elements:d}=t,{mainAxis:u=!0,crossAxis:f=!0,fallbackPlacements:h,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:g=!0,...y}=Zf(e,t);if((r=o.arrow)!=null&&r.alignmentOffset)return{};const x=em(s),b=Vu(l),w=em(l)===l,j=await(c.isRTL==null?void 0:c.isRTL(d.floating)),_=h||(w||!g?[aN(l)]:Wge(l)),S=v!=="none";!h&&S&&_.push(...Xge(l,g,v,j));const C=[l,..._],P=await ow(t,y),A=[];let R=((n=o.flip)==null?void 0:n.overflows)||[];if(u&&A.push(P[x]),f){const D=Vge(s,i,j);A.push(P[D[0]],P[D[1]])}if(R=[...R,{placement:s,overflows:A}],!A.every(D=>D<=0)){var O,I;const D=(((O=o.flip)==null?void 0:O.index)||0)+1,U=C[D];if(U&&(!(f==="alignment"?b!==Vu(U):!1)||R.every($=>Vu($.placement)===b?$.overflows[0]>0:!0)))return{data:{index:D,overflows:R},reset:{placement:U}};let z=(I=R.filter(W=>W.overflows[0]<=0).sort((W,$)=>W.overflows[1]-$.overflows[1])[0])==null?void 0:I.placement;if(!z)switch(m){case"bestFit":{var M;const W=(M=R.filter($=>{if(S){const X=Vu($.placement);return X===b||X==="y"}return!0}).map($=>[$.placement,$.overflows.filter(X=>X>0).reduce((X,ye)=>X+ye,0)]).sort(($,X)=>$[1]-X[1])[0])==null?void 0:M[0];W&&(z=W);break}case"initialPlacement":z=l;break}if(s!==z)return{reset:{placement:z}}}return{}}}};function i6(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function l6(e){return Bge.some(t=>e[t]>=0)}const eve=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...s}=Zf(e,t);switch(n){case"referenceHidden":{const o=await ow(t,{...s,elementContext:"reference"}),i=i6(o,r.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:l6(i)}}}case"escaped":{const o=await ow(t,{...s,altBoundary:!0}),i=i6(o,r.floating);return{data:{escapedOffsets:i,escaped:l6(i)}}}default:return{}}}}},TK=new Set(["left","top"]);async function tve(e,t){const{placement:r,platform:n,elements:s}=e,o=await(n.isRTL==null?void 0:n.isRTL(s.floating)),i=em(r),l=N0(r),c=Vu(r)==="y",d=TK.has(i)?-1:1,u=o&&c?-1:1,f=Zf(t,e);let{mainAxis:h,crossAxis:m,alignmentAxis:v}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return l&&typeof v=="number"&&(m=l==="end"?v*-1:v),c?{x:m*u,y:h*d}:{x:h*d,y:m*u}}const rve=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:s,y:o,placement:i,middlewareData:l}=t,c=await tve(t,e);return i===((r=l.offset)==null?void 0:r.placement)&&(n=l.arrow)!=null&&n.alignmentOffset?{}:{x:s+c.x,y:o+c.y,data:{...c,placement:i}}}}},nve=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:s}=t,{mainAxis:o=!0,crossAxis:i=!1,limiter:l={fn:y=>{let{x,y:b}=y;return{x,y:b}}},...c}=Zf(e,t),d={x:r,y:n},u=await ow(t,c),f=Vu(em(s)),h=Q4(f);let m=d[h],v=d[f];if(o){const y=h==="y"?"top":"left",x=h==="y"?"bottom":"right",b=m+u[y],w=m-u[x];m=OI(b,m,w)}if(i){const y=f==="y"?"top":"left",x=f==="y"?"bottom":"right",b=v+u[y],w=v-u[x];v=OI(b,v,w)}const g=l.fn({...t,[h]:m,[f]:v});return{...g,data:{x:g.x-r,y:g.y-n,enabled:{[h]:o,[f]:i}}}}}},ave=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:s,rects:o,middlewareData:i}=t,{offset:l=0,mainAxis:c=!0,crossAxis:d=!0}=Zf(e,t),u={x:r,y:n},f=Vu(s),h=Q4(f);let m=u[h],v=u[f];const g=Zf(l,t),y=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(c){const w=h==="y"?"height":"width",j=o.reference[h]-o.floating[w]+y.mainAxis,_=o.reference[h]+o.reference[w]-y.mainAxis;m<j?m=j:m>_&&(m=_)}if(d){var x,b;const w=h==="y"?"width":"height",j=TK.has(em(s)),_=o.reference[f]-o.floating[w]+(j&&((x=i.offset)==null?void 0:x[f])||0)+(j?0:y.crossAxis),S=o.reference[f]+o.reference[w]+(j?0:((b=i.offset)==null?void 0:b[f])||0)-(j?y.crossAxis:0);v<_?v=_:v>S&&(v=S)}return{[h]:m,[f]:v}}}},sve=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:s,rects:o,platform:i,elements:l}=t,{apply:c=()=>{},...d}=Zf(e,t),u=await ow(t,d),f=em(s),h=N0(s),m=Vu(s)==="y",{width:v,height:g}=o.floating;let y,x;f==="top"||f==="bottom"?(y=f,x=h===(await(i.isRTL==null?void 0:i.isRTL(l.floating))?"start":"end")?"left":"right"):(x=f,y=h==="end"?"top":"bottom");const b=g-u.top-u.bottom,w=v-u.left-u.right,j=Dh(g-u[y],b),_=Dh(v-u[x],w),S=!t.middlewareData.shift;let C=j,P=_;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(P=w),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(C=b),S&&!h){const R=Ec(u.left,0),O=Ec(u.right,0),I=Ec(u.top,0),M=Ec(u.bottom,0);m?P=v-2*(R!==0||O!==0?R+O:Ec(u.left,u.right)):C=g-2*(I!==0||M!==0?I+M:Ec(u.top,u.bottom))}await c({...t,availableWidth:P,availableHeight:C});const A=await i.getDimensions(l.floating);return v!==A.width||g!==A.height?{reset:{rects:!0}}:{}}}};function CC(){return typeof window<"u"}function S0(e){return DK(e)?(e.nodeName||"").toLowerCase():"#document"}function qc(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function df(e){var t;return(t=(DK(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function DK(e){return CC()?e instanceof Node||e instanceof qc(e).Node:!1}function pu(e){return CC()?e instanceof Element||e instanceof qc(e).Element:!1}function of(e){return CC()?e instanceof HTMLElement||e instanceof qc(e).HTMLElement:!1}function c6(e){return!CC()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof qc(e).ShadowRoot}const ove=new Set(["inline","contents"]);function S1(e){const{overflow:t,overflowX:r,overflowY:n,display:s}=gu(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!ove.has(s)}const ive=new Set(["table","td","th"]);function lve(e){return ive.has(S0(e))}const cve=[":popover-open",":modal"];function PC(e){return cve.some(t=>{try{return e.matches(t)}catch{return!1}})}const dve=["transform","translate","scale","rotate","perspective"],uve=["transform","translate","scale","rotate","perspective","filter"],fve=["paint","layout","strict","content"];function tD(e){const t=rD(),r=pu(e)?gu(e):e;return dve.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||uve.some(n=>(r.willChange||"").includes(n))||fve.some(n=>(r.contain||"").includes(n))}function mve(e){let t=Mh(e);for(;of(t)&&!Mx(t);){if(tD(t))return t;if(PC(t))return null;t=Mh(t)}return null}function rD(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const hve=new Set(["html","body","#document"]);function Mx(e){return hve.has(S0(e))}function gu(e){return qc(e).getComputedStyle(e)}function AC(e){return pu(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Mh(e){if(S0(e)==="html")return e;const t=e.assignedSlot||e.parentNode||c6(e)&&e.host||df(e);return c6(t)?t.host:t}function MK(e){const t=Mh(e);return Mx(t)?e.ownerDocument?e.ownerDocument.body:e.body:of(t)&&S1(t)?t:MK(t)}function iw(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const s=MK(e),o=s===((n=e.ownerDocument)==null?void 0:n.body),i=qc(s);if(o){const l=DI(i);return t.concat(i,i.visualViewport||[],S1(s)?s:[],l&&r?iw(l):[])}return t.concat(s,iw(s,[],r))}function DI(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function RK(e){const t=gu(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const s=of(e),o=s?e.offsetWidth:r,i=s?e.offsetHeight:n,l=nN(r)!==o||nN(n)!==i;return l&&(r=o,n=i),{width:r,height:n,$:l}}function nD(e){return pu(e)?e:e.contextElement}function cx(e){const t=nD(e);if(!of(t))return Zu(1);const r=t.getBoundingClientRect(),{width:n,height:s,$:o}=RK(t);let i=(o?nN(r.width):r.width)/n,l=(o?nN(r.height):r.height)/s;return(!i||!Number.isFinite(i))&&(i=1),(!l||!Number.isFinite(l))&&(l=1),{x:i,y:l}}const pve=Zu(0);function LK(e){const t=qc(e);return!rD()||!t.visualViewport?pve:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function gve(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==qc(e)?!1:t}function pg(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const s=e.getBoundingClientRect(),o=nD(e);let i=Zu(1);t&&(n?pu(n)&&(i=cx(n)):i=cx(e));const l=gve(o,r,n)?LK(o):Zu(0);let c=(s.left+l.x)/i.x,d=(s.top+l.y)/i.y,u=s.width/i.x,f=s.height/i.y;if(o){const h=qc(o),m=n&&pu(n)?qc(n):n;let v=h,g=DI(v);for(;g&&n&&m!==v;){const y=cx(g),x=g.getBoundingClientRect(),b=gu(g),w=x.left+(g.clientLeft+parseFloat(b.paddingLeft))*y.x,j=x.top+(g.clientTop+parseFloat(b.paddingTop))*y.y;c*=y.x,d*=y.y,u*=y.x,f*=y.y,c+=w,d+=j,v=qc(g),g=DI(v)}}return sN({width:u,height:f,x:c,y:d})}function aD(e,t){const r=AC(e).scrollLeft;return t?t.left+r:pg(df(e)).left+r}function FK(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),s=n.left+t.scrollLeft-(r?0:aD(e,n)),o=n.top+t.scrollTop;return{x:s,y:o}}function vve(e){let{elements:t,rect:r,offsetParent:n,strategy:s}=e;const o=s==="fixed",i=df(n),l=t?PC(t.floating):!1;if(n===i||l&&o)return r;let c={scrollLeft:0,scrollTop:0},d=Zu(1);const u=Zu(0),f=of(n);if((f||!f&&!o)&&((S0(n)!=="body"||S1(i))&&(c=AC(n)),of(n))){const m=pg(n);d=cx(n),u.x=m.x+n.clientLeft,u.y=m.y+n.clientTop}const h=i&&!f&&!o?FK(i,c,!0):Zu(0);return{width:r.width*d.x,height:r.height*d.y,x:r.x*d.x-c.scrollLeft*d.x+u.x+h.x,y:r.y*d.y-c.scrollTop*d.y+u.y+h.y}}function xve(e){return Array.from(e.getClientRects())}function yve(e){const t=df(e),r=AC(e),n=e.ownerDocument.body,s=Ec(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),o=Ec(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let i=-r.scrollLeft+aD(e);const l=-r.scrollTop;return gu(n).direction==="rtl"&&(i+=Ec(t.clientWidth,n.clientWidth)-s),{width:s,height:o,x:i,y:l}}function bve(e,t){const r=qc(e),n=df(e),s=r.visualViewport;let o=n.clientWidth,i=n.clientHeight,l=0,c=0;if(s){o=s.width,i=s.height;const d=rD();(!d||d&&t==="fixed")&&(l=s.offsetLeft,c=s.offsetTop)}return{width:o,height:i,x:l,y:c}}const wve=new Set(["absolute","fixed"]);function jve(e,t){const r=pg(e,!0,t==="fixed"),n=r.top+e.clientTop,s=r.left+e.clientLeft,o=of(e)?cx(e):Zu(1),i=e.clientWidth*o.x,l=e.clientHeight*o.y,c=s*o.x,d=n*o.y;return{width:i,height:l,x:c,y:d}}function d6(e,t,r){let n;if(t==="viewport")n=bve(e,r);else if(t==="document")n=yve(df(e));else if(pu(t))n=jve(t,r);else{const s=LK(e);n={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return sN(n)}function $K(e,t){const r=Mh(e);return r===t||!pu(r)||Mx(r)?!1:gu(r).position==="fixed"||$K(r,t)}function _ve(e,t){const r=t.get(e);if(r)return r;let n=iw(e,[],!1).filter(l=>pu(l)&&S0(l)!=="body"),s=null;const o=gu(e).position==="fixed";let i=o?Mh(e):e;for(;pu(i)&&!Mx(i);){const l=gu(i),c=tD(i);!c&&l.position==="fixed"&&(s=null),(o?!c&&!s:!c&&l.position==="static"&&!!s&&wve.has(s.position)||S1(i)&&!c&&$K(e,i))?n=n.filter(u=>u!==i):s=l,i=Mh(i)}return t.set(e,n),n}function Nve(e){let{element:t,boundary:r,rootBoundary:n,strategy:s}=e;const i=[...r==="clippingAncestors"?PC(t)?[]:_ve(t,this._c):[].concat(r),n],l=i[0],c=i.reduce((d,u)=>{const f=d6(t,u,s);return d.top=Ec(f.top,d.top),d.right=Dh(f.right,d.right),d.bottom=Dh(f.bottom,d.bottom),d.left=Ec(f.left,d.left),d},d6(t,l,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function Sve(e){const{width:t,height:r}=RK(e);return{width:t,height:r}}function Cve(e,t,r){const n=of(t),s=df(t),o=r==="fixed",i=pg(e,!0,o,t);let l={scrollLeft:0,scrollTop:0};const c=Zu(0);function d(){c.x=aD(s)}if(n||!n&&!o)if((S0(t)!=="body"||S1(s))&&(l=AC(t)),n){const m=pg(t,!0,o,t);c.x=m.x+t.clientLeft,c.y=m.y+t.clientTop}else s&&d();o&&!n&&s&&d();const u=s&&!n&&!o?FK(s,l):Zu(0),f=i.left+l.scrollLeft-c.x-u.x,h=i.top+l.scrollTop-c.y-u.y;return{x:f,y:h,width:i.width,height:i.height}}function jA(e){return gu(e).position==="static"}function u6(e,t){if(!of(e)||gu(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return df(e)===r&&(r=r.ownerDocument.body),r}function BK(e,t){const r=qc(e);if(PC(e))return r;if(!of(e)){let s=Mh(e);for(;s&&!Mx(s);){if(pu(s)&&!jA(s))return s;s=Mh(s)}return r}let n=u6(e,t);for(;n&&lve(n)&&jA(n);)n=u6(n,t);return n&&Mx(n)&&jA(n)&&!tD(n)?r:n||mve(e)||r}const Pve=async function(e){const t=this.getOffsetParent||BK,r=this.getDimensions,n=await r(e.floating);return{reference:Cve(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function Ave(e){return gu(e).direction==="rtl"}const Eve={convertOffsetParentRelativeRectToViewportRelativeRect:vve,getDocumentElement:df,getClippingRect:Nve,getOffsetParent:BK,getElementRects:Pve,getClientRects:xve,getDimensions:Sve,getScale:cx,isElement:pu,isRTL:Ave};function qK(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function kve(e,t){let r=null,n;const s=df(e);function o(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function i(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),o();const d=e.getBoundingClientRect(),{left:u,top:f,width:h,height:m}=d;if(l||t(),!h||!m)return;const v=G2(f),g=G2(s.clientWidth-(u+h)),y=G2(s.clientHeight-(f+m)),x=G2(u),w={rootMargin:-v+"px "+-g+"px "+-y+"px "+-x+"px",threshold:Ec(0,Dh(1,c))||1};let j=!0;function _(S){const C=S[0].intersectionRatio;if(C!==c){if(!j)return i();C?i(!1,C):n=setTimeout(()=>{i(!1,1e-7)},1e3)}C===1&&!qK(d,e.getBoundingClientRect())&&i(),j=!1}try{r=new IntersectionObserver(_,{...w,root:s.ownerDocument})}catch{r=new IntersectionObserver(_,w)}r.observe(e)}return i(!0),o}function Ive(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:o=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,d=nD(e),u=s||o?[...d?iw(d):[],...iw(t)]:[];u.forEach(x=>{s&&x.addEventListener("scroll",r,{passive:!0}),o&&x.addEventListener("resize",r)});const f=d&&l?kve(d,r):null;let h=-1,m=null;i&&(m=new ResizeObserver(x=>{let[b]=x;b&&b.target===d&&m&&(m.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var w;(w=m)==null||w.observe(t)})),r()}),d&&!c&&m.observe(d),m.observe(t));let v,g=c?pg(e):null;c&&y();function y(){const x=pg(e);g&&!qK(g,x)&&r(),g=x,v=requestAnimationFrame(y)}return r(),()=>{var x;u.forEach(b=>{s&&b.removeEventListener("scroll",r),o&&b.removeEventListener("resize",r)}),f?.(),(x=m)==null||x.disconnect(),m=null,c&&cancelAnimationFrame(v)}}const Ove=rve,Tve=nve,Dve=Zge,Mve=sve,Rve=eve,f6=Qge,Lve=ave,Fve=(e,t,r)=>{const n=new Map,s={platform:Eve,...r},o={...s.platform,_c:n};return Jge(e,t,{...s,platform:o})};var $ve=typeof document<"u",Bve=function(){},s_=$ve?p.useLayoutEffect:Bve;function oN(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!oN(e[n],t[n]))return!1;return!0}if(s=Object.keys(e),r=s.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,s[n]))return!1;for(n=r;n--!==0;){const o=s[n];if(!(o==="_owner"&&e.$$typeof)&&!oN(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function zK(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function m6(e,t){const r=zK(e);return Math.round(t*r)/r}function _A(e){const t=p.useRef(e);return s_(()=>{t.current=e}),t}function qve(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:s,elements:{reference:o,floating:i}={},transform:l=!0,whileElementsMounted:c,open:d}=e,[u,f]=p.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[h,m]=p.useState(n);oN(h,n)||m(n);const[v,g]=p.useState(null),[y,x]=p.useState(null),b=p.useCallback($=>{$!==S.current&&(S.current=$,g($))},[]),w=p.useCallback($=>{$!==C.current&&(C.current=$,x($))},[]),j=o||v,_=i||y,S=p.useRef(null),C=p.useRef(null),P=p.useRef(u),A=c!=null,R=_A(c),O=_A(s),I=_A(d),M=p.useCallback(()=>{if(!S.current||!C.current)return;const $={placement:t,strategy:r,middleware:h};O.current&&($.platform=O.current),Fve(S.current,C.current,$).then(X=>{const ye={...X,isPositioned:I.current!==!1};D.current&&!oN(P.current,ye)&&(P.current=ye,im.flushSync(()=>{f(ye)}))})},[h,t,r,O,I]);s_(()=>{d===!1&&P.current.isPositioned&&(P.current.isPositioned=!1,f($=>({...$,isPositioned:!1})))},[d]);const D=p.useRef(!1);s_(()=>(D.current=!0,()=>{D.current=!1}),[]),s_(()=>{if(j&&(S.current=j),_&&(C.current=_),j&&_){if(R.current)return R.current(j,_,M);M()}},[j,_,M,R,A]);const U=p.useMemo(()=>({reference:S,floating:C,setReference:b,setFloating:w}),[b,w]),z=p.useMemo(()=>({reference:j,floating:_}),[j,_]),W=p.useMemo(()=>{const $={position:r,left:0,top:0};if(!z.floating)return $;const X=m6(z.floating,u.x),ye=m6(z.floating,u.y);return l?{...$,transform:"translate("+X+"px, "+ye+"px)",...zK(z.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:X,top:ye}},[r,l,z.floating,u.x,u.y]);return p.useMemo(()=>({...u,update:M,refs:U,elements:z,floatingStyles:W}),[u,M,U,z,W])}const zve=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:s}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?f6({element:n.current,padding:s}).fn(r):{}:n?f6({element:n,padding:s}).fn(r):{}}}},Uve=(e,t)=>({...Ove(e),options:[e,t]}),Vve=(e,t)=>({...Tve(e),options:[e,t]}),Wve=(e,t)=>({...Lve(e),options:[e,t]}),Hve=(e,t)=>({...Dve(e),options:[e,t]}),Gve=(e,t)=>({...Mve(e),options:[e,t]}),Kve=(e,t)=>({...Rve(e),options:[e,t]}),Xve=(e,t)=>({...zve(e),options:[e,t]});var Yve="Arrow",UK=p.forwardRef((e,t)=>{const{children:r,width:n=10,height:s=5,...o}=e;return a.jsx(ta.svg,{...o,ref:t,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:a.jsx("polygon",{points:"0,0 30,0 15,10"})})});UK.displayName=Yve;var Jve=UK;function VK(e){const[t,r]=p.useState(void 0);return qi(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const o=s[0];let i,l;if("borderBoxSize"in o){const c=o.borderBoxSize,d=Array.isArray(c)?c[0]:c;i=d.inlineSize,l=d.blockSize}else i=e.offsetWidth,l=e.offsetHeight;r({width:i,height:l})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var sD="Popper",[WK,C0]=Ld(sD),[Qve,HK]=WK(sD),GK=e=>{const{__scopePopper:t,children:r}=e,[n,s]=p.useState(null);return a.jsx(Qve,{scope:t,anchor:n,onAnchorChange:s,children:r})};GK.displayName=sD;var KK="PopperAnchor",XK=p.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...s}=e,o=HK(KK,r),i=p.useRef(null),l=$a(t,i),c=p.useRef(null);return p.useEffect(()=>{const d=c.current;c.current=n?.current||i.current,d!==c.current&&o.onAnchorChange(c.current)}),n?null:a.jsx(ta.div,{...s,ref:l})});XK.displayName=KK;var oD="PopperContent",[Zve,exe]=WK(oD),YK=p.forwardRef((e,t)=>{const{__scopePopper:r,side:n="bottom",sideOffset:s=0,align:o="center",alignOffset:i=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:d=[],collisionPadding:u=0,sticky:f="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:v,...g}=e,y=HK(oD,r),[x,b]=p.useState(null),w=$a(t,Y=>b(Y)),[j,_]=p.useState(null),S=VK(j),C=S?.width??0,P=S?.height??0,A=n+(o!=="center"?"-"+o:""),R=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},O=Array.isArray(d)?d:[d],I=O.length>0,M={padding:R,boundary:O.filter(rxe),altBoundary:I},{refs:D,floatingStyles:U,placement:z,isPositioned:W,middlewareData:$}=qve({strategy:"fixed",placement:A,whileElementsMounted:(...Y)=>Ive(...Y,{animationFrame:m==="always"}),elements:{reference:y.anchor},middleware:[Uve({mainAxis:s+P,alignmentAxis:i}),c&&Vve({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?Wve():void 0,...M}),c&&Hve({...M}),Gve({...M,apply:({elements:Y,rects:ce,availableWidth:me,availableHeight:ae})=>{const{width:le,height:ue}=ce.reference,Re=Y.floating.style;Re.setProperty("--radix-popper-available-width",`${me}px`),Re.setProperty("--radix-popper-available-height",`${ae}px`),Re.setProperty("--radix-popper-anchor-width",`${le}px`),Re.setProperty("--radix-popper-anchor-height",`${ue}px`)}}),j&&Xve({element:j,padding:l}),nxe({arrowWidth:C,arrowHeight:P}),h&&Kve({strategy:"referenceHidden",...M})]}),[X,ye]=ZK(z),Se=cc(v);qi(()=>{W&&Se?.()},[W,Se]);const V=$.arrow?.x,B=$.arrow?.y,Q=$.arrow?.centerOffset!==0,[pe,te]=p.useState();return qi(()=>{x&&te(window.getComputedStyle(x).zIndex)},[x]),a.jsx("div",{ref:D.setFloating,"data-radix-popper-content-wrapper":"",style:{...U,transform:W?U.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:pe,"--radix-popper-transform-origin":[$.transformOrigin?.x,$.transformOrigin?.y].join(" "),...$.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:a.jsx(Zve,{scope:r,placedSide:X,onArrowChange:_,arrowX:V,arrowY:B,shouldHideArrow:Q,children:a.jsx(ta.div,{"data-side":X,"data-align":ye,...g,ref:w,style:{...g.style,animation:W?void 0:"none"}})})})});YK.displayName=oD;var JK="PopperArrow",txe={top:"bottom",right:"left",bottom:"top",left:"right"},QK=p.forwardRef(function(t,r){const{__scopePopper:n,...s}=t,o=exe(JK,n),i=txe[o.placedSide];return a.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:a.jsx(Jve,{...s,ref:r,style:{...s.style,display:"block"}})})});QK.displayName=JK;function rxe(e){return e!==null}var nxe=e=>({name:"transformOrigin",options:e,fn(t){const{placement:r,rects:n,middlewareData:s}=t,i=s.arrow?.centerOffset!==0,l=i?0:e.arrowWidth,c=i?0:e.arrowHeight,[d,u]=ZK(r),f={start:"0%",center:"50%",end:"100%"}[u],h=(s.arrow?.x??0)+l/2,m=(s.arrow?.y??0)+c/2;let v="",g="";return d==="bottom"?(v=i?f:`${h}px`,g=`${-c}px`):d==="top"?(v=i?f:`${h}px`,g=`${n.floating.height+c}px`):d==="right"?(v=`${-c}px`,g=i?f:`${m}px`):d==="left"&&(v=`${n.floating.width+c}px`,g=i?f:`${m}px`),{data:{x:v,y:g}}}});function ZK(e){const[t,r="center"]=e.split("-");return[t,r]}var iD=GK,EC=XK,lD=YK,cD=QK,axe="Portal",P0=p.forwardRef((e,t)=>{const{container:r,...n}=e,[s,o]=p.useState(!1);qi(()=>o(!0),[]);const i=r||s&&globalThis?.document?.body;return i?g4.createPortal(a.jsx(ta.div,{...n,ref:t}),i):null});P0.displayName=axe;function sxe(e,t){return p.useReducer((r,n)=>t[r][n]??r,e)}var Yc=e=>{const{present:t,children:r}=e,n=oxe(t),s=typeof r=="function"?r({present:n.isPresent}):p.Children.only(r),o=$a(n.ref,ixe(s));return typeof r=="function"||n.isPresent?p.cloneElement(s,{ref:o}):null};Yc.displayName="Presence";function oxe(e){const[t,r]=p.useState(),n=p.useRef(null),s=p.useRef(e),o=p.useRef("none"),i=e?"mounted":"unmounted",[l,c]=sxe(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return p.useEffect(()=>{const d=K2(n.current);o.current=l==="mounted"?d:"none"},[l]),qi(()=>{const d=n.current,u=s.current;if(u!==e){const h=o.current,m=K2(d);e?c("MOUNT"):m==="none"||d?.display==="none"?c("UNMOUNT"):c(u&&h!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,c]),qi(()=>{if(t){let d;const u=t.ownerDocument.defaultView??window,f=m=>{const g=K2(n.current).includes(CSS.escape(m.animationName));if(m.target===t&&g&&(c("ANIMATION_END"),!s.current)){const y=t.style.animationFillMode;t.style.animationFillMode="forwards",d=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=y)})}},h=m=>{m.target===t&&(o.current=K2(n.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",f),t.addEventListener("animationend",f),()=>{u.clearTimeout(d),t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",f),t.removeEventListener("animationend",f)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:p.useCallback(d=>{n.current=d?getComputedStyle(d):null,r(d)},[])}}function K2(e){return e?.animationName||"none"}function ixe(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var lxe=S3[" useInsertionEffect ".trim().toString()]||qi;function tm({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[s,o,i]=cxe({defaultProp:t,onChange:r}),l=e!==void 0,c=l?e:s;{const u=p.useRef(e!==void 0);p.useEffect(()=>{const f=u.current;f!==l&&console.warn(`${n} is changing from ${f?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=l},[l,n])}const d=p.useCallback(u=>{if(l){const f=dxe(u)?u(e):u;f!==e&&i.current?.(f)}else o(u)},[l,e,o,i]);return[c,d]}function cxe({defaultProp:e,onChange:t}){const[r,n]=p.useState(e),s=p.useRef(r),o=p.useRef(t);return lxe(()=>{o.current=t},[t]),p.useEffect(()=>{s.current!==r&&(o.current?.(r),s.current=r)},[r,s]),[r,n,o]}function dxe(e){return typeof e=="function"}var uxe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},ev=new WeakMap,X2=new WeakMap,Y2={},NA=0,eX=function(e){return e&&(e.host||eX(e.parentNode))},fxe=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=eX(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},mxe=function(e,t,r,n){var s=fxe(t,Array.isArray(e)?e:[e]);Y2[r]||(Y2[r]=new WeakMap);var o=Y2[r],i=[],l=new Set,c=new Set(s),d=function(f){!f||l.has(f)||(l.add(f),d(f.parentNode))};s.forEach(d);var u=function(f){!f||c.has(f)||Array.prototype.forEach.call(f.children,function(h){if(l.has(h))u(h);else try{var m=h.getAttribute(n),v=m!==null&&m!=="false",g=(ev.get(h)||0)+1,y=(o.get(h)||0)+1;ev.set(h,g),o.set(h,y),i.push(h),g===1&&v&&X2.set(h,!0),y===1&&h.setAttribute(r,"true"),v||h.setAttribute(n,"true")}catch(x){console.error("aria-hidden: cannot operate on ",h,x)}})};return u(t),l.clear(),NA++,function(){i.forEach(function(f){var h=ev.get(f)-1,m=o.get(f)-1;ev.set(f,h),o.set(f,m),h||(X2.has(f)||f.removeAttribute(n),X2.delete(f)),m||f.removeAttribute(r)}),NA--,NA||(ev=new WeakMap,ev=new WeakMap,X2=new WeakMap,Y2={})}},kC=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),s=t||uxe(e);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live], script"))),mxe(n,s,r,"aria-hidden")):function(){return null}},$u=function(){return $u=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},$u.apply(this,arguments)};function tX(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function hxe(e,t,r){if(r||arguments.length===2)for(var n=0,s=t.length,o;n<s;n++)(o||!(n in t))&&(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}var o_="right-scroll-bar-position",i_="width-before-scroll-bar",pxe="with-scroll-bars-hidden",gxe="--removed-body-scroll-bar-size";function SA(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function vxe(e,t){var r=p.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var s=r.value;s!==n&&(r.value=n,r.callback(n,s))}}}})[0];return r.callback=t,r.facade}var xxe=typeof window<"u"?p.useLayoutEffect:p.useEffect,h6=new WeakMap;function yxe(e,t){var r=vxe(t||null,function(n){return e.forEach(function(s){return SA(s,n)})});return xxe(function(){var n=h6.get(r);if(n){var s=new Set(n),o=new Set(e),i=r.current;s.forEach(function(l){o.has(l)||SA(l,null)}),o.forEach(function(l){s.has(l)||SA(l,i)})}h6.set(r,e)},[e]),r}function bxe(e){return e}function wxe(e,t){t===void 0&&(t=bxe);var r=[],n=!1,s={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(o){var i=t(o,n);return r.push(i),function(){r=r.filter(function(l){return l!==i})}},assignSyncMedium:function(o){for(n=!0;r.length;){var i=r;r=[],i.forEach(o)}r={push:function(l){return o(l)},filter:function(){return r}}},assignMedium:function(o){n=!0;var i=[];if(r.length){var l=r;r=[],l.forEach(o),i=r}var c=function(){var u=i;i=[],u.forEach(o)},d=function(){return Promise.resolve().then(c)};d(),r={push:function(u){i.push(u),d()},filter:function(u){return i=i.filter(u),r}}}};return s}function jxe(e){e===void 0&&(e={});var t=wxe(null);return t.options=$u({async:!0,ssr:!1},e),t}var rX=function(e){var t=e.sideCar,r=tX(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return p.createElement(n,$u({},r))};rX.isSideCarExport=!0;function _xe(e,t){return e.useMedium(t),rX}var nX=jxe(),CA=function(){},IC=p.forwardRef(function(e,t){var r=p.useRef(null),n=p.useState({onScrollCapture:CA,onWheelCapture:CA,onTouchMoveCapture:CA}),s=n[0],o=n[1],i=e.forwardProps,l=e.children,c=e.className,d=e.removeScrollBar,u=e.enabled,f=e.shards,h=e.sideCar,m=e.noRelative,v=e.noIsolation,g=e.inert,y=e.allowPinchZoom,x=e.as,b=x===void 0?"div":x,w=e.gapMode,j=tX(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),_=h,S=yxe([r,t]),C=$u($u({},j),s);return p.createElement(p.Fragment,null,u&&p.createElement(_,{sideCar:nX,removeScrollBar:d,shards:f,noRelative:m,noIsolation:v,inert:g,setCallbacks:o,allowPinchZoom:!!y,lockRef:r,gapMode:w}),i?p.cloneElement(p.Children.only(l),$u($u({},C),{ref:S})):p.createElement(b,$u({},C,{className:c,ref:S}),l))});IC.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};IC.classNames={fullWidth:i_,zeroRight:o_};var p6,Nxe=function(){if(p6)return p6;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Sxe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=Nxe();return t&&e.setAttribute("nonce",t),e}function Cxe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Pxe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Axe=function(){var e=0,t=null;return{add:function(r){e==0&&(t=Sxe())&&(Cxe(t,r),Pxe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Exe=function(){var e=Axe();return function(t,r){p.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},aX=function(){var e=Exe(),t=function(r){var n=r.styles,s=r.dynamic;return e(n,s),null};return t},kxe={left:0,top:0,right:0,gap:0},PA=function(e){return parseInt(e||"",10)||0},Ixe=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[PA(r),PA(n),PA(s)]},Oxe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return kxe;var t=Ixe(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},Txe=aX(),dx="data-scroll-locked",Dxe=function(e,t,r,n){var s=e.left,o=e.top,i=e.right,l=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(pxe,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(l,"px ").concat(n,`;
  }
  body[`).concat(dx,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(l,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(o_,` {
    right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(i_,` {
    margin-right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(o_," .").concat(o_,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(i_," .").concat(i_,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(dx,`] {
    `).concat(gxe,": ").concat(l,`px;
  }
`)},g6=function(){var e=parseInt(document.body.getAttribute(dx)||"0",10);return isFinite(e)?e:0},Mxe=function(){p.useEffect(function(){return document.body.setAttribute(dx,(g6()+1).toString()),function(){var e=g6()-1;e<=0?document.body.removeAttribute(dx):document.body.setAttribute(dx,e.toString())}},[])},Rxe=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,s=n===void 0?"margin":n;Mxe();var o=p.useMemo(function(){return Oxe(s)},[s]);return p.createElement(Txe,{styles:Dxe(o,!t,s,r?"":"!important")})},MI=!1;if(typeof window<"u")try{var J2=Object.defineProperty({},"passive",{get:function(){return MI=!0,!0}});window.addEventListener("test",J2,J2),window.removeEventListener("test",J2,J2)}catch{MI=!1}var tv=MI?{passive:!1}:!1,Lxe=function(e){return e.tagName==="TEXTAREA"},sX=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!Lxe(e)&&r[t]==="visible")},Fxe=function(e){return sX(e,"overflowY")},$xe=function(e){return sX(e,"overflowX")},v6=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var s=oX(e,n);if(s){var o=iX(e,n),i=o[1],l=o[2];if(i>l)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Bxe=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},qxe=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},oX=function(e,t){return e==="v"?Fxe(t):$xe(t)},iX=function(e,t){return e==="v"?Bxe(t):qxe(t)},zxe=function(e,t){return e==="h"&&t==="rtl"?-1:1},Uxe=function(e,t,r,n,s){var o=zxe(e,window.getComputedStyle(t).direction),i=o*n,l=r.target,c=t.contains(l),d=!1,u=i>0,f=0,h=0;do{if(!l)break;var m=iX(e,l),v=m[0],g=m[1],y=m[2],x=g-y-o*v;(v||x)&&oX(e,l)&&(f+=x,h+=v);var b=l.parentNode;l=b&&b.nodeType===Node.DOCUMENT_FRAGMENT_NODE?b.host:b}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return(u&&(s&&Math.abs(f)<1||!s&&i>f)||!u&&(s&&Math.abs(h)<1||!s&&-i>h))&&(d=!0),d},Q2=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},x6=function(e){return[e.deltaX,e.deltaY]},y6=function(e){return e&&"current"in e?e.current:e},Vxe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Wxe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Hxe=0,rv=[];function Gxe(e){var t=p.useRef([]),r=p.useRef([0,0]),n=p.useRef(),s=p.useState(Hxe++)[0],o=p.useState(aX)[0],i=p.useRef(e);p.useEffect(function(){i.current=e},[e]),p.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var g=hxe([e.lockRef.current],(e.shards||[]).map(y6),!0).filter(Boolean);return g.forEach(function(y){return y.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),g.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var l=p.useCallback(function(g,y){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!i.current.allowPinchZoom;var x=Q2(g),b=r.current,w="deltaX"in g?g.deltaX:b[0]-x[0],j="deltaY"in g?g.deltaY:b[1]-x[1],_,S=g.target,C=Math.abs(w)>Math.abs(j)?"h":"v";if("touches"in g&&C==="h"&&S.type==="range")return!1;var P=v6(C,S);if(!P)return!0;if(P?_=C:(_=C==="v"?"h":"v",P=v6(C,S)),!P)return!1;if(!n.current&&"changedTouches"in g&&(w||j)&&(n.current=_),!_)return!0;var A=n.current||_;return Uxe(A,y,g,A==="h"?w:j,!0)},[]),c=p.useCallback(function(g){var y=g;if(!(!rv.length||rv[rv.length-1]!==o)){var x="deltaY"in y?x6(y):Q2(y),b=t.current.filter(function(_){return _.name===y.type&&(_.target===y.target||y.target===_.shadowParent)&&Vxe(_.delta,x)})[0];if(b&&b.should){y.cancelable&&y.preventDefault();return}if(!b){var w=(i.current.shards||[]).map(y6).filter(Boolean).filter(function(_){return _.contains(y.target)}),j=w.length>0?l(y,w[0]):!i.current.noIsolation;j&&y.cancelable&&y.preventDefault()}}},[]),d=p.useCallback(function(g,y,x,b){var w={name:g,delta:y,target:x,should:b,shadowParent:Kxe(x)};t.current.push(w),setTimeout(function(){t.current=t.current.filter(function(j){return j!==w})},1)},[]),u=p.useCallback(function(g){r.current=Q2(g),n.current=void 0},[]),f=p.useCallback(function(g){d(g.type,x6(g),g.target,l(g,e.lockRef.current))},[]),h=p.useCallback(function(g){d(g.type,Q2(g),g.target,l(g,e.lockRef.current))},[]);p.useEffect(function(){return rv.push(o),e.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:h}),document.addEventListener("wheel",c,tv),document.addEventListener("touchmove",c,tv),document.addEventListener("touchstart",u,tv),function(){rv=rv.filter(function(g){return g!==o}),document.removeEventListener("wheel",c,tv),document.removeEventListener("touchmove",c,tv),document.removeEventListener("touchstart",u,tv)}},[]);var m=e.removeScrollBar,v=e.inert;return p.createElement(p.Fragment,null,v?p.createElement(o,{styles:Wxe(s)}):null,m?p.createElement(Rxe,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function Kxe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const Xxe=_xe(nX,Gxe);var lX=p.forwardRef(function(e,t){return p.createElement(IC,$u({},e,{ref:t,sideCar:Xxe}))});lX.classNames=IC.classNames;const OC=lX;var TC="Popover",[cX,qlt]=Ld(TC,[C0]),C1=C0(),[Yxe,Hh]=cX(TC),dX=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:s,onOpenChange:o,modal:i=!1}=e,l=C1(t),c=p.useRef(null),[d,u]=p.useState(!1),[f,h]=tm({prop:n,defaultProp:s??!1,onChange:o,caller:TC});return a.jsx(iD,{...l,children:a.jsx(Yxe,{scope:t,contentId:uu(),triggerRef:c,open:f,onOpenChange:h,onOpenToggle:p.useCallback(()=>h(m=>!m),[h]),hasCustomAnchor:d,onCustomAnchorAdd:p.useCallback(()=>u(!0),[]),onCustomAnchorRemove:p.useCallback(()=>u(!1),[]),modal:i,children:r})})};dX.displayName=TC;var uX="PopoverAnchor",Jxe=p.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,s=Hh(uX,r),o=C1(r),{onCustomAnchorAdd:i,onCustomAnchorRemove:l}=s;return p.useEffect(()=>(i(),()=>l()),[i,l]),a.jsx(EC,{...o,...n,ref:t})});Jxe.displayName=uX;var fX="PopoverTrigger",mX=p.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,s=Hh(fX,r),o=C1(r),i=$a(t,s.triggerRef),l=a.jsx(ta.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":xX(s.open),...n,ref:i,onClick:gn(e.onClick,s.onOpenToggle)});return s.hasCustomAnchor?l:a.jsx(EC,{asChild:!0,...o,children:l})});mX.displayName=fX;var dD="PopoverPortal",[Qxe,Zxe]=cX(dD,{forceMount:void 0}),hX=e=>{const{__scopePopover:t,forceMount:r,children:n,container:s}=e,o=Hh(dD,t);return a.jsx(Qxe,{scope:t,forceMount:r,children:a.jsx(Yc,{present:r||o.open,children:a.jsx(P0,{asChild:!0,container:s,children:n})})})};hX.displayName=dD;var Rx="PopoverContent",pX=p.forwardRef((e,t)=>{const r=Zxe(Rx,e.__scopePopover),{forceMount:n=r.forceMount,...s}=e,o=Hh(Rx,e.__scopePopover);return a.jsx(Yc,{present:n||o.open,children:o.modal?a.jsx(t0e,{...s,ref:t}):a.jsx(r0e,{...s,ref:t})})});pX.displayName=Rx;var e0e=Th("PopoverContent.RemoveScroll"),t0e=p.forwardRef((e,t)=>{const r=Hh(Rx,e.__scopePopover),n=p.useRef(null),s=$a(t,n),o=p.useRef(!1);return p.useEffect(()=>{const i=n.current;if(i)return kC(i)},[]),a.jsx(OC,{as:e0e,allowPinchZoom:!0,children:a.jsx(gX,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:gn(e.onCloseAutoFocus,i=>{i.preventDefault(),o.current||r.triggerRef.current?.focus()}),onPointerDownOutside:gn(e.onPointerDownOutside,i=>{const l=i.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,d=l.button===2||c;o.current=d},{checkForDefaultPrevented:!1}),onFocusOutside:gn(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),r0e=p.forwardRef((e,t)=>{const r=Hh(Rx,e.__scopePopover),n=p.useRef(!1),s=p.useRef(!1);return a.jsx(gX,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{e.onCloseAutoFocus?.(o),o.defaultPrevented||(n.current||r.triggerRef.current?.focus(),o.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:o=>{e.onInteractOutside?.(o),o.defaultPrevented||(n.current=!0,o.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const i=o.target;r.triggerRef.current?.contains(i)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&s.current&&o.preventDefault()}})}),gX=p.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:o,disableOutsidePointerEvents:i,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:u,...f}=e,h=Hh(Rx,r),m=C1(r);return SC(),a.jsx(N1,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:o,children:a.jsx(_0,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:u,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onDismiss:()=>h.onOpenChange(!1),children:a.jsx(lD,{"data-state":xX(h.open),role:"dialog",id:h.contentId,...m,...f,ref:t,style:{...f.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),vX="PopoverClose",n0e=p.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,s=Hh(vX,r);return a.jsx(ta.button,{type:"button",...n,ref:t,onClick:gn(e.onClick,()=>s.onOpenChange(!1))})});n0e.displayName=vX;var a0e="PopoverArrow",s0e=p.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,s=C1(r);return a.jsx(cD,{...s,...n,ref:t})});s0e.displayName=a0e;function xX(e){return e?"open":"closed"}var o0e=dX,i0e=mX,l0e=hX,yX=pX;const vi=o0e,xi=i0e,ni=Pe.forwardRef(({className:e,align:t="center",sideOffset:r=4,...n},s)=>a.jsx(l0e,{container:document.body,children:a.jsx(yX,{ref:s,align:t,sideOffset:r,className:pr("z-[9999] w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));ni.displayName=yX.displayName;var DC="Dialog",[bX,wX]=Ld(DC),[c0e,wu]=bX(DC),jX=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:s,onOpenChange:o,modal:i=!0}=e,l=p.useRef(null),c=p.useRef(null),[d,u]=tm({prop:n,defaultProp:s??!1,onChange:o,caller:DC});return a.jsx(c0e,{scope:t,triggerRef:l,contentRef:c,contentId:uu(),titleId:uu(),descriptionId:uu(),open:d,onOpenChange:u,onOpenToggle:p.useCallback(()=>u(f=>!f),[u]),modal:i,children:r})};jX.displayName=DC;var _X="DialogTrigger",NX=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=wu(_X,r),o=$a(t,s.triggerRef);return a.jsx(ta.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":mD(s.open),...n,ref:o,onClick:gn(e.onClick,s.onOpenToggle)})});NX.displayName=_X;var uD="DialogPortal",[d0e,SX]=bX(uD,{forceMount:void 0}),CX=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:s}=e,o=wu(uD,t);return a.jsx(d0e,{scope:t,forceMount:r,children:p.Children.map(n,i=>a.jsx(Yc,{present:r||o.open,children:a.jsx(P0,{asChild:!0,container:s,children:i})}))})};CX.displayName=uD;var iN="DialogOverlay",PX=p.forwardRef((e,t)=>{const r=SX(iN,e.__scopeDialog),{forceMount:n=r.forceMount,...s}=e,o=wu(iN,e.__scopeDialog);return o.modal?a.jsx(Yc,{present:n||o.open,children:a.jsx(f0e,{...s,ref:t})}):null});PX.displayName=iN;var u0e=Th("DialogOverlay.RemoveScroll"),f0e=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=wu(iN,r);return a.jsx(OC,{as:u0e,allowPinchZoom:!0,shards:[s.contentRef],children:a.jsx(ta.div,{"data-state":mD(s.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),gg="DialogContent",AX=p.forwardRef((e,t)=>{const r=SX(gg,e.__scopeDialog),{forceMount:n=r.forceMount,...s}=e,o=wu(gg,e.__scopeDialog);return a.jsx(Yc,{present:n||o.open,children:o.modal?a.jsx(m0e,{...s,ref:t}):a.jsx(h0e,{...s,ref:t})})});AX.displayName=gg;var m0e=p.forwardRef((e,t)=>{const r=wu(gg,e.__scopeDialog),n=p.useRef(null),s=$a(t,r.contentRef,n);return p.useEffect(()=>{const o=n.current;if(o)return kC(o)},[]),a.jsx(EX,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:gn(e.onCloseAutoFocus,o=>{o.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:gn(e.onPointerDownOutside,o=>{const i=o.detail.originalEvent,l=i.button===0&&i.ctrlKey===!0;(i.button===2||l)&&o.preventDefault()}),onFocusOutside:gn(e.onFocusOutside,o=>o.preventDefault())})}),h0e=p.forwardRef((e,t)=>{const r=wu(gg,e.__scopeDialog),n=p.useRef(!1),s=p.useRef(!1);return a.jsx(EX,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{e.onCloseAutoFocus?.(o),o.defaultPrevented||(n.current||r.triggerRef.current?.focus(),o.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:o=>{e.onInteractOutside?.(o),o.defaultPrevented||(n.current=!0,o.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const i=o.target;r.triggerRef.current?.contains(i)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&s.current&&o.preventDefault()}})}),EX=p.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:o,...i}=e,l=wu(gg,r),c=p.useRef(null),d=$a(t,c);return SC(),a.jsxs(a.Fragment,{children:[a.jsx(N1,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:o,children:a.jsx(_0,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":mD(l.open),...i,ref:d,onDismiss:()=>l.onOpenChange(!1)})}),a.jsxs(a.Fragment,{children:[a.jsx(g0e,{titleId:l.titleId}),a.jsx(x0e,{contentRef:c,descriptionId:l.descriptionId})]})]})}),fD="DialogTitle",kX=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=wu(fD,r);return a.jsx(ta.h2,{id:s.titleId,...n,ref:t})});kX.displayName=fD;var IX="DialogDescription",OX=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=wu(IX,r);return a.jsx(ta.p,{id:s.descriptionId,...n,ref:t})});OX.displayName=IX;var TX="DialogClose",DX=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=wu(TX,r);return a.jsx(ta.button,{type:"button",...n,ref:t,onClick:gn(e.onClick,()=>s.onOpenChange(!1))})});DX.displayName=TX;function mD(e){return e?"open":"closed"}var MX="DialogTitleWarning",[p0e,RX]=yge(MX,{contentName:gg,titleName:fD,docsSlug:"dialog"}),g0e=({titleId:e})=>{const t=RX(MX),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return p.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},v0e="DialogDescriptionWarning",x0e=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${RX(v0e).contentName}}.`;return p.useEffect(()=>{const s=e.current?.getAttribute("aria-describedby");t&&s&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},LX=jX,y0e=NX,FX=CX,hD=PX,pD=AX,gD=kX,vD=OX,MC=DX;const mn=LX,b0e=FX,vh=MC,$X=Pe.forwardRef(({className:e,disableAnimations:t,...r},n)=>{const s=typeof window<"u"&&(window.matchMedia?.("(pointer: coarse)")?.matches||window.innerWidth<768),o=typeof window<"u"&&window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches,i=(t??!1)||s||o;return a.jsx(hD,{ref:n,className:pr("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm",i?"data-[state=open]:animate-none data-[state=closed]:animate-none":"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...r})});$X.displayName=hD.displayName;const un=Pe.forwardRef(({className:e,children:t,overlayClassName:r,disableAnimations:n,alignTop:s,...o},i)=>{const l=typeof window<"u"&&(window.matchMedia?.("(pointer: coarse)")?.matches||window.innerWidth<768),c=typeof window<"u"&&window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches,d=(n??!1)||l||c;return a.jsxs(b0e,{children:[a.jsx($X,{disableAnimations:d,className:r}),a.jsxs(pD,{ref:i,className:pr("fixed z-50 grid w-full max-w-lg gap-4 border border-border bg-surface p-6 pr-14 shadow-lg duration-200 sm:rounded-lg",s?"left-1/2 top-[10%] -translate-x-1/2":"left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",d?"data-[state=open]:animate-none data-[state=closed]:animate-none":"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...o,children:[t,a.jsxs(MC,{className:"absolute right-4 top-4 inline-flex h-10 w-10 items-center justify-center rounded-md border border-border bg-surface/90 opacity-80 shadow-sm ring-offset-background transition-all hover:opacity-100 hover:bg-surface focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[a.jsx(al,{className:"h-5 w-5"}),a.jsx("span",{className:"sr-only",children:"Close"})]})]})]})});un.displayName=pD.displayName;const on=({className:e,...t})=>a.jsx("div",{className:pr("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});on.displayName="DialogHeader";const Qn=({className:e,...t})=>a.jsx("div",{className:pr("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Qn.displayName="DialogFooter";const an=Pe.forwardRef(({className:e,...t},r)=>a.jsx(gD,{ref:r,className:pr("text-lg font-semibold leading-none tracking-tight",e),...t}));an.displayName=gD.displayName;const Nn=Pe.forwardRef(({className:e,...t},r)=>a.jsx(vD,{ref:r,className:pr("text-sm text-text-secondary",e),...t}));Nn.displayName=vD.displayName;const w0e=1;let AA=0;function j0e(){return AA=(AA+1)%Number.MAX_VALUE,AA.toString()}const _l={state:{toasts:[]},listeners:[],getState:()=>_l.state,setState:e=>{typeof e=="function"?_l.state=e(_l.state):_l.state={..._l.state,...e},_l.listeners.forEach(t=>t(_l.state))},subscribe:e=>(_l.listeners.push(e),()=>{_l.listeners=_l.listeners.filter(t=>t!==e)})},l_=({...e})=>{const t=j0e(),r=s=>_l.setState(o=>({...o,toasts:o.toasts.map(i=>i.id===t?{...i,...s}:i)})),n=()=>_l.setState(s=>({...s,toasts:s.toasts.filter(o=>o.id!==t)}));return _l.setState(s=>({...s,toasts:[{...e,id:t,dismiss:n},...s.toasts].slice(0,w0e)})),{id:t,dismiss:n,update:r}};function Qa(){const[e,t]=p.useState(_l.getState());return p.useEffect(()=>_l.subscribe(n=>{t(n)}),[]),p.useEffect(()=>{const r=[];return e.toasts.forEach(n=>{if(n.duration===1/0)return;const s=setTimeout(()=>{n.dismiss()},n.duration||5e3);r.push(s)}),()=>{r.forEach(n=>clearTimeout(n))}},[e.toasts]),{toast:l_,toasts:e.toasts}}const _0e="main",N0e={dev:{supabaseUrl:"https://xlbgopcindcsteymtwjp.supabase.co",supabaseAnonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhsYmdvcGNpbmRjc3RleW10d2pwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ3MDAwMTQsImV4cCI6MjA4MDI3NjAxNH0.0ydvsFW8j5ZKCyHalAlFWHjjK8QbcDC6mZQzVJ0lSnA"},main:{supabaseUrl:"https://dlfryxtyxqoacuunswuc.supabase.co",supabaseAnonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsZnJ5eHR5eHFvYWN1dW5zd3VjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4ODg0MzcsImV4cCI6MjA3MTQ2NDQzN30.AizQBbCE1p_xfAQ9T0Eha1anGzcFETcc__8AV4iaQTY"}},S0e=Object.freeze(Object.defineProperty({__proto__:null,ACTIVE_TARGET:_0e,TARGETS:N0e},Symbol.toStringTag,{value:"Module"})),C0e=void 0,P0e=void 0,A0e=Object.freeze(Object.defineProperty({__proto__:null,ACTIVE_TARGET:C0e,TARGETS:P0e},Symbol.toStringTag,{value:"Module"})),E0e="modulepreload",k0e=function(e){return"/"+e},b6={},ef=function(t,r,n){if(!r||r.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(r.map(o=>{if(o=k0e(o),o in b6)return;b6[o]=!0;const i=o.endsWith(".css"),l=i?'[rel="stylesheet"]':"";if(!!n)for(let u=s.length-1;u>=0;u--){const f=s[u];if(f.href===o&&(!i||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${l}`))return;const d=document.createElement("link");if(d.rel=i?"stylesheet":E0e,i||(d.as="script",d.crossOrigin=""),d.href=o,document.head.appendChild(d),i)return new Promise((u,f)=>{d.addEventListener("load",u),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t()).catch(o=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o})},I0e=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>ef(()=>Promise.resolve().then(()=>A0),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class xD extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class w6 extends xD{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class j6 extends xD{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class _6 extends xD{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var RI;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(RI||(RI={}));var O0e=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?o(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class T0e{constructor(t,{headers:r={},customFetch:n,region:s=RI.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=I0e(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return O0e(this,arguments,void 0,function*(r,n={}){var s;try{const{headers:o,method:i,body:l,signal:c}=n;let d={},{region:u}=n;u||(u=this.region);const f=new URL(`${this.url}/${r}`);u&&u!=="any"&&(d["x-region"]=u,f.searchParams.set("forceFunctionRegion",u));let h;l&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",h=l):typeof l=="string"?(d["Content-Type"]="text/plain",h=l):typeof FormData<"u"&&l instanceof FormData?h=l:(d["Content-Type"]="application/json",h=JSON.stringify(l)));const m=yield this.fetch(f.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),o),body:h,signal:c}).catch(x=>{throw x.name==="AbortError"?x:new w6(x)}),v=m.headers.get("x-relay-error");if(v&&v==="true")throw new j6(m);if(!m.ok)throw new _6(m);let g=((s=m.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),y;return g==="application/json"?y=yield m.json():g==="application/octet-stream"?y=yield m.blob():g==="text/event-stream"?y=m:g==="multipart/form-data"?y=yield m.formData():y=yield m.text(),{data:y,error:null,response:m}}catch(o){return o instanceof Error&&o.name==="AbortError"?{data:null,error:new w6(o)}:{data:null,error:o,response:o instanceof _6||o instanceof j6?o.context:void 0}}})}}var Jl={},yD={},RC={},P1={},LC={},FC={},D0e=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Lx=D0e();const M0e=Lx.fetch,BX=Lx.fetch.bind(Lx),qX=Lx.Headers,R0e=Lx.Request,L0e=Lx.Response,A0=Object.freeze(Object.defineProperty({__proto__:null,Headers:qX,Request:R0e,Response:L0e,default:BX,fetch:M0e},Symbol.toStringTag,{value:"Module"})),F0e=die(A0);var $C={};Object.defineProperty($C,"__esModule",{value:!0});let $0e=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};$C.default=$0e;var zX=rl&&rl.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(FC,"__esModule",{value:!0});const B0e=zX(F0e),q0e=zX($C);let z0e=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=B0e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{var i,l,c,d;let u=null,f=null,h=null,m=o.status,v=o.statusText;if(o.ok){if(this.method!=="HEAD"){const b=await o.text();b===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((i=this.headers.get("Accept"))===null||i===void 0)&&i.includes("application/vnd.pgrst.plan+text"))?f=b:f=JSON.parse(b))}const y=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),x=(c=o.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");y&&x&&x.length>1&&(h=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(u={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,h=null,m=406,v="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const y=await o.text();try{u=JSON.parse(y),Array.isArray(u)&&o.status===404&&(f=[],u=null,m=200,v="OK")}catch{o.status===404&&y===""?(m=204,v="No Content"):u={message:y}}if(u&&this.isMaybeSingle&&(!((d=u?.details)===null||d===void 0)&&d.includes("0 rows"))&&(u=null,m=200,v="OK"),u&&this.shouldThrowOnError)throw new q0e.default(u)}return{error:u,data:f,count:h,status:m,statusText:v}});return this.shouldThrowOnError||(s=s.catch(o=>{var i,l,c;return{error:{message:`${(i=o?.name)!==null&&i!==void 0?i:"FetchError"}: ${o?.message}`,details:`${(l=o?.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=o?.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,r)}returns(){return this}overrideTypes(){return this}};FC.default=z0e;var U0e=rl&&rl.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(LC,"__esModule",{value:!0});const V0e=U0e(FC);let W0e=class extends V0e.default{select(t){let r=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:o=s}={}){const i=o?`${o}.order`:"order",l=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${l?`${l},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:s=n}={}){const o=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(o,`${t}`),this.url.searchParams.set(i,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:o=!1,format:i="text"}={}){var l;const c=[t?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,o?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${d}"; options=${c};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};LC.default=W0e;var H0e=rl&&rl.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(P1,"__esModule",{value:!0});const G0e=H0e(LC);let K0e=class extends G0e.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:s}={}){let o="";s==="plain"?o="pl":s==="phrase"?o="ph":s==="websearch"&&(o="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${o}fts${i}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};P1.default=K0e;var X0e=rl&&rl.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(RC,"__esModule",{value:!0});const hy=X0e(P1);let Y0e=class{constructor(t,{headers:r={},schema:n,fetch:s}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=s}select(t,r){const{head:n=!1,count:s}=r??{},o=n?"HEAD":"GET";let i=!1;const l=(t??"*").split("").map(c=>/\s/.test(c)&&!i?"":(c==='"'&&(i=!i),c)).join("");return this.url.searchParams.set("select",l),s&&this.headers.append("Prefer",`count=${s}`),new hy.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var s;const o="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const i=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(i.length>0){const l=[...new Set(i)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new hy.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:o=!0}={}){var i;const l="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),s&&this.headers.append("Prefer",`count=${s}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const c=t.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new hy.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:r}={}){var n;const s="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new hy.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new hy.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};RC.default=Y0e;var UX=rl&&rl.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(yD,"__esModule",{value:!0});const J0e=UX(RC),Q0e=UX(P1);let Z0e=class VX{constructor(t,{headers:r={},schema:n,fetch:s}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=s}from(t){const r=new URL(`${this.url}/${t}`);return new J0e.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new VX(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:s=!1,count:o}={}){var i;let l;const c=new URL(`${this.url}/rpc/${t}`);let d;n||s?(l=n?"HEAD":"GET",Object.entries(r).filter(([f,h])=>h!==void 0).map(([f,h])=>[f,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([f,h])=>{c.searchParams.append(f,h)})):(l="POST",d=r);const u=new Headers(this.headers);return o&&u.set("Prefer",`count=${o}`),new Q0e.default({method:l,url:c,headers:u,schema:this.schemaName,body:d,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};yD.default=Z0e;var E0=rl&&rl.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Jl,"__esModule",{value:!0});Jl.PostgrestError=Jl.PostgrestBuilder=Jl.PostgrestTransformBuilder=Jl.PostgrestFilterBuilder=Jl.PostgrestQueryBuilder=Jl.PostgrestClient=void 0;const WX=E0(yD);Jl.PostgrestClient=WX.default;const HX=E0(RC);Jl.PostgrestQueryBuilder=HX.default;const GX=E0(P1);Jl.PostgrestFilterBuilder=GX.default;const KX=E0(LC);Jl.PostgrestTransformBuilder=KX.default;const XX=E0(FC);Jl.PostgrestBuilder=XX.default;const YX=E0($C);Jl.PostgrestError=YX.default;var eye=Jl.default={PostgrestClient:WX.default,PostgrestQueryBuilder:HX.default,PostgrestFilterBuilder:GX.default,PostgrestTransformBuilder:KX.default,PostgrestBuilder:XX.default,PostgrestError:YX.default};const{PostgrestClient:tye,PostgrestQueryBuilder:Glt,PostgrestFilterBuilder:Klt,PostgrestTransformBuilder:Xlt,PostgrestBuilder:Ylt,PostgrestError:Jlt}=eye;class rye{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const nye="2.75.0",aye=`realtime-js/${nye}`,sye="1.0.0",LI=1e4,oye=1e3,iye=100;var ib;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(ib||(ib={}));var Yo;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Yo||(Yo={}));var eu;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(eu||(eu={}));var FI;(function(e){e.websocket="websocket"})(FI||(FI={}));var Ep;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Ep||(Ep={}));class lye{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const s=r.getUint8(1),o=r.getUint8(2);let i=this.HEADER_LENGTH+2;const l=n.decode(t.slice(i,i+s));i=i+s;const c=n.decode(t.slice(i,i+o));i=i+o;const d=JSON.parse(n.decode(t.slice(i,t.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class JX{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ws;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(ws||(ws={}));const N6=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((o,i)=>(o[i]=cye(i,e,t,s),o),{}):{}},cye=(e,t,r,n)=>{const s=t.find(l=>l.name===e),o=s?.type,i=r[e];return o&&!n.includes(o)?QX(o,i):$I(i)},QX=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return mye(t,r)}switch(e){case ws.bool:return dye(t);case ws.float4:case ws.float8:case ws.int2:case ws.int4:case ws.int8:case ws.numeric:case ws.oid:return uye(t);case ws.json:case ws.jsonb:return fye(t);case ws.timestamp:return hye(t);case ws.abstime:case ws.date:case ws.daterange:case ws.int4range:case ws.int8range:case ws.money:case ws.reltime:case ws.text:case ws.time:case ws.timestamptz:case ws.timetz:case ws.tsrange:case ws.tstzrange:return $I(t);default:return $I(t)}},$I=e=>e,dye=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},uye=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},fye=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},mye=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let o;const i=e.slice(1,r);try{o=JSON.parse("["+i+"]")}catch{o=i?i.split(","):[]}return o.map(l=>QX(t,l))}return e},hye=e=>typeof e=="string"?e.replace(" ","T"):e,ZX=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class EA{constructor(t,r,n={},s=LI){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var S6;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(S6||(S6={}));class lb{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:o,onLeave:i,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=lb.syncState(this.state,s,o,i),this.pendingDiffs.forEach(c=>{this.state=lb.syncDiff(this.state,c,o,i)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},s=>{const{onJoin:o,onLeave:i,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=lb.syncDiff(this.state,s,o,i),l())}),this.onJoin((s,o,i)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:o,newPresences:i})}),this.onLeave((s,o,i)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:o,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const o=this.cloneDeep(t),i=this.transformState(r),l={},c={};return this.map(o,(d,u)=>{i[d]||(c[d]=u)}),this.map(i,(d,u)=>{const f=o[d];if(f){const h=u.map(y=>y.presence_ref),m=f.map(y=>y.presence_ref),v=u.filter(y=>m.indexOf(y.presence_ref)<0),g=f.filter(y=>h.indexOf(y.presence_ref)<0);v.length>0&&(l[d]=v),g.length>0&&(c[d]=g)}else l[d]=u}),this.syncDiff(o,{joins:l,leaves:c},n,s)}static syncDiff(t,r,n,s){const{joins:o,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(o,(l,c)=>{var d;const u=(d=t[l])!==null&&d!==void 0?d:[];if(t[l]=this.cloneDeep(c),u.length>0){const f=t[l].map(m=>m.presence_ref),h=u.filter(m=>f.indexOf(m.presence_ref)<0);t[l].unshift(...h)}n(l,u,c)}),this.map(i,(l,c)=>{let d=t[l];if(!d)return;const u=c.map(f=>f.presence_ref);d=d.filter(f=>u.indexOf(f.presence_ref)<0),t[l]=d,s(l,d,c),d.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var C6;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(C6||(C6={}));var cb;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(cb||(cb={}));var Pf;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Pf||(Pf={}));class bD{constructor(t,r={config:{}},n){var s,o;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Yo.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new EA(this,eu.join,this.params,this.timeout),this.rejoinTimer=new JX(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Yo.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Yo.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Yo.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Yo.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Yo.errored,this.rejoinTimer.scheduleTimeout())}),this._on(eu.reply,{},(i,l)=>{this._trigger(this._replyEventName(l),i)}),this.presence=new lb(this),this.broadcastEndpointURL=ZX(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,s,o;if(this.socket.isConnected()||this.socket.connect(),this.state==Yo.closed){const{config:{broadcast:i,presence:l,private:c}}=this.params,d=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(m=>m.filter))!==null&&s!==void 0?s:[],u=!!this.bindings[cb.PRESENCE]&&this.bindings[cb.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,f={},h={broadcast:i,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(m=>t?.(Pf.CHANNEL_ERROR,m)),this._onClose(()=>t?.(Pf.CLOSED)),this.updateJoinPayload(Object.assign({config:h},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:m})=>{var v;if(this.socket.setAuth(),m===void 0){t?.(Pf.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,y=(v=g?.length)!==null&&v!==void 0?v:0,x=[];for(let b=0;b<y;b++){const w=g[b],{filter:{event:j,schema:_,table:S,filter:C}}=w,P=m&&m[b];if(P&&P.event===j&&P.schema===_&&P.table===S&&P.filter===C)x.push(Object.assign(Object.assign({},w),{id:P.id}));else{this.unsubscribe(),this.state=Yo.errored,t?.(Pf.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,t&&t(Pf.SUBSCRIBED);return}}).receive("error",m=>{this.state=Yo.errored,t?.(Pf.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{t?.(Pf.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Yo.joined&&t===cb.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){const{event:o,payload:i}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:i,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var i,l,c;const d=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(i=this.params)===null||i===void 0?void 0:i.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&o("ok"),d.receive("ok",()=>o("ok")),d.receive("error",()=>o("error")),d.receive("timeout",()=>o("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Yo.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(eu.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new EA(this,eu.leave,{},t),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Yo.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const s=new AbortController,o=setTimeout(()=>s.abort(),n),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(o),i}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new EA(this,t,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>iye){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,o;const i=t.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=eu;if(n&&[l,c,d,u].indexOf(i)>=0&&n!==this._joinRef())return;let h=this._onMessage(i,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(m=>{var v,g,y;return((v=m.filter)===null||v===void 0?void 0:v.event)==="*"||((y=(g=m.filter)===null||g===void 0?void 0:g.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===i}).map(m=>m.callback(h,n)):(o=this.bindings[i])===null||o===void 0||o.filter(m=>{var v,g,y,x,b,w;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in m){const j=m.id,_=(v=m.filter)===null||v===void 0?void 0:v.event;return j&&((g=r.ids)===null||g===void 0?void 0:g.includes(j))&&(_==="*"||_?.toLocaleLowerCase()===((y=r.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const j=(b=(x=m?.filter)===null||x===void 0?void 0:x.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return j==="*"||j===((w=r?.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===i}).map(m=>{if(typeof h=="object"&&"ids"in h){const v=h.data,{schema:g,table:y,commit_timestamp:x,type:b,errors:w}=v;h=Object.assign(Object.assign({},{schema:g,table:y,commit_timestamp:x,eventType:b,new:{},old:{},errors:w}),this._getPayloadRecords(v))}m.callback(h,n)})}_isClosed(){return this.state===Yo.closed}_isJoined(){return this.state===Yo.joined}_isJoining(){return this.state===Yo.joining}_isLeaving(){return this.state===Yo.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),o={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(o):this.bindings[s]=[o],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var o;return!(((o=s.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===n&&bD.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(eu.close,{},t)}_onError(t){this._on(eu.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Yo.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=N6(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=N6(t.columns,t.old_record)),r}}const kA=()=>{},Z2={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},pye=[1e3,2e3,5e3,1e4],gye=1e4,vye=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class xye{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=LI,this.transport=null,this.heartbeatIntervalMs=Z2.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=kA,this.ref=0,this.reconnectTimer=null,this.logger=kA,this.conn=null,this.sendBuffer=[],this.serializer=new lye,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let o;return s?o=s:typeof fetch>"u"?o=(...i)=>ef(()=>Promise.resolve().then(()=>A0),void 0).then(({default:l})=>l(...i)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):o=fetch,(...i)=>o(...i)},!(!((n=r?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${FI.websocket}`,this.httpEndpoint=ZX(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=rye.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:sye}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case ib.connecting:return Ep.Connecting;case ib.open:return Ep.Open;case ib.closing:return Ep.Closing;default:return Ep.Closed}}isConnected(){return this.connectionState()===Ep.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,s=this.getChannels().find(o=>o.topic===n);if(s)return s;{const o=new bD(`realtime:${t}`,r,this);return this.channels.push(o),o}}push(t){const{topic:r,event:n,payload:s,ref:o}=t,i=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${o})`,s),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(oye,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Z2.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:o,ref:i}=r,l=i?`(${i})`:"",c=o.status||"";this.log("receive",`${c} ${n} ${s} ${l}`.trim(),o),this.channels.filter(d=>d._isMember(n)).forEach(d=>d._trigger(s,o,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(eu.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([vye],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:aye};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(eu.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new JX(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Z2.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,s,o,i,l,c,d,u;if(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t?.timeout)!==null&&n!==void 0?n:LI,this.heartbeatIntervalMs=(s=t?.heartbeatIntervalMs)!==null&&s!==void 0?s:Z2.HEARTBEAT_INTERVAL,this.worker=(o=t?.worker)!==null&&o!==void 0?o:!1,this.accessToken=(i=t?.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(l=t?.heartbeatCallback)!==null&&l!==void 0?l:kA,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t?.reconnectAfterMs)!==null&&c!==void 0?c:f=>pye[f-1]||gye,this.encode=(d=t?.encode)!==null&&d!==void 0?d:(f,h)=>h(JSON.stringify(f)),this.decode=(u=t?.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}class wD extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Do(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class yye extends wD{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class BI extends wD{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var bye=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?o(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const eY=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>ef(()=>Promise.resolve().then(()=>A0),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},wye=()=>bye(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ef(()=>Promise.resolve().then(()=>A0),void 0)).Response:Response}),qI=e=>{if(Array.isArray(e))return e.map(r=>qI(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));t[s]=qI(n)}),t},jye=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var Rg=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?o(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const IA=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),_ye=(e,t,r)=>Rg(void 0,void 0,void 0,function*(){const n=yield wye();e instanceof n&&!r?.noResolveJson?e.json().then(s=>{const o=e.status||500,i=s?.statusCode||o+"";t(new yye(IA(s),o,i))}).catch(s=>{t(new BI(IA(s),s))}):t(new BI(IA(e),e))}),Nye=(e,t,r,n)=>{const s={method:e,headers:t?.headers||{}};return e==="GET"||!n?s:(jye(n)?(s.headers=Object.assign({"Content-Type":"application/json"},t?.headers),s.body=JSON.stringify(n)):s.body=n,t?.duplex&&(s.duplex=t.duplex),Object.assign(Object.assign({},s),r))};function A1(e,t,r,n,s,o){return Rg(this,void 0,void 0,function*(){return new Promise((i,l)=>{e(r,Nye(t,n,s,o)).then(c=>{if(!c.ok)throw c;return n?.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>_ye(c,l,n))})})}function lN(e,t,r,n){return Rg(this,void 0,void 0,function*(){return A1(e,"GET",t,r,n)})}function Lu(e,t,r,n,s){return Rg(this,void 0,void 0,function*(){return A1(e,"POST",t,n,s,r)})}function zI(e,t,r,n,s){return Rg(this,void 0,void 0,function*(){return A1(e,"PUT",t,n,s,r)})}function Sye(e,t,r,n){return Rg(this,void 0,void 0,function*(){return A1(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function tY(e,t,r,n,s){return Rg(this,void 0,void 0,function*(){return A1(e,"DELETE",t,n,s,r)})}var Cye=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?o(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class Pye{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return Cye(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Do(t))return{data:null,error:t};throw t}})}}var Aye=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?o(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class Eye{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}asStream(){return new Pye(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.execute().then(t,r)}execute(){return Aye(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Do(t))return{data:null,error:t};throw t}})}}var Wl=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?o(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const kye={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},P6={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Iye{constructor(t,r={},n,s){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=eY(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,s){return Wl(this,void 0,void 0,function*(){try{let o;const i=Object.assign(Object.assign({},P6),s);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&n instanceof Blob?(o=new FormData,o.append("cacheControl",i.cacheControl),c&&o.append("metadata",this.encodeMetadata(c)),o.append("",n)):typeof FormData<"u"&&n instanceof FormData?(o=n,o.append("cacheControl",i.cacheControl),c&&o.append("metadata",this.encodeMetadata(c))):(o=n,l["cache-control"]=`max-age=${i.cacheControl}`,l["content-type"]=i.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),s?.headers&&(l=Object.assign(Object.assign({},l),s.headers));const d=this._removeEmptyFolders(r),u=this._getFinalPath(d),f=yield(t=="PUT"?zI:Lu)(this.fetch,`${this.url}/object/${u}`,o,Object.assign({headers:l},i?.duplex?{duplex:i.duplex}:{}));return{data:{path:d,id:f.Id,fullPath:f.Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Do(o))return{data:null,error:o};throw o}})}upload(t,r,n){return Wl(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return Wl(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(t),i=this._getFinalPath(o),l=new URL(this.url+`/object/upload/sign/${i}`);l.searchParams.set("token",r);try{let c;const d=Object.assign({upsert:P6.upsert},s),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",d.cacheControl)):(c=n,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const f=yield zI(this.fetch,l.toString(),c,{headers:u});return{data:{path:o,fullPath:f.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Do(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return Wl(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r?.upsert&&(s["x-upsert"]="true");const o=yield Lu(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),i=new URL(this.url+o.url),l=i.searchParams.get("token");if(!l)throw new wD("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Do(n))return{data:null,error:n};throw n}})}update(t,r,n){return Wl(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Wl(this,void 0,void 0,function*(){try{return{data:yield Lu(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Do(s))return{data:null,error:s};throw s}})}copy(t,r,n){return Wl(this,void 0,void 0,function*(){try{return{data:{path:(yield Lu(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Do(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return Wl(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),o=yield Lu(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n?.download?`&download=${n.download===!0?"":n.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${i}`)},{data:o,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Do(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return Wl(this,void 0,void 0,function*(){try{const s=yield Lu(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),o=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${o}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Do(s))return{data:null,error:s};throw s}})}download(t,r){const s=typeof r?.transform<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString(r?.transform||{}),i=o?`?${o}`:"",l=this._getFinalPath(t),c=()=>lN(this.fetch,`${this.url}/${s}/${l}${i}`,{headers:this.headers,noResolveJson:!0});return new Eye(c,this.shouldThrowOnError)}info(t){return Wl(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield lN(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:qI(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Do(n))return{data:null,error:n};throw n}})}exists(t){return Wl(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield Sye(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Do(n)&&n instanceof BI){const s=n.originalError;if([400,404].includes(s?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],o=r?.download?`download=${r.download===!0?"":r.download}`:"";o!==""&&s.push(o);const l=typeof r?.transform<"u"?"render/image":"object",c=this.transformOptsToQueryString(r?.transform||{});c!==""&&s.push(c);let d=s.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${d}`)}}}remove(t){return Wl(this,void 0,void 0,function*(){try{return{data:yield tY(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Do(r))return{data:null,error:r};throw r}})}list(t,r,n){return Wl(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},kye),r),{prefix:t||""});return{data:yield Lu(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Do(s))return{data:null,error:s};throw s}})}listV2(t,r){return Wl(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Lu(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Do(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const Oye="2.75.0",Tye={"X-Client-Info":`storage-js/${Oye}`};var nv=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?o(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class Dye{constructor(t,r={},n,s){this.shouldThrowOnError=!1;const o=new URL(t);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Tye),r),this.fetch=eY(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return nv(this,void 0,void 0,function*(){try{return{data:yield lN(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Do(t))return{data:null,error:t};throw t}})}getBucket(t){return nv(this,void 0,void 0,function*(){try{return{data:yield lN(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Do(r))return{data:null,error:r};throw r}})}createBucket(t){return nv(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield Lu(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Do(s))return{data:null,error:s};throw s}})}updateBucket(t,r){return nv(this,void 0,void 0,function*(){try{return{data:yield zI(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Do(n))return{data:null,error:n};throw n}})}emptyBucket(t){return nv(this,void 0,void 0,function*(){try{return{data:yield Lu(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Do(r))return{data:null,error:r};throw r}})}deleteBucket(t){return nv(this,void 0,void 0,function*(){try{return{data:yield tY(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Do(r))return{data:null,error:r};throw r}})}}class Mye extends Dye{constructor(t,r={},n,s){super(t,r,n,s)}from(t){return new Iye(this.url,this.headers,t,this.fetch)}}const Rye="2.75.0";let By="";typeof Deno<"u"?By="deno":typeof document<"u"?By="web":typeof navigator<"u"&&navigator.product==="ReactNative"?By="react-native":By="node";const Lye={"X-Client-Info":`supabase-js-${By}/${Rye}`},Fye={headers:Lye},$ye={schema:"public"},Bye={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},qye={};var zye=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?o(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const Uye=e=>{let t;return e?t=e:typeof fetch>"u"?t=BX:t=fetch,(...r)=>t(...r)},Vye=()=>typeof Headers>"u"?qX:Headers,Wye=(e,t,r)=>{const n=Uye(r),s=Vye();return(o,i)=>zye(void 0,void 0,void 0,function*(){var l;const c=(l=yield t())!==null&&l!==void 0?l:e;let d=new s(i?.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),n(o,Object.assign(Object.assign({},i),{headers:d}))})};var Hye=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?o(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};function Gye(e){return e.endsWith("/")?e:e+"/"}function Kye(e,t){var r,n;const{db:s,auth:o,realtime:i,global:l}=e,{db:c,auth:d,realtime:u,global:f}=t,h={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},d),o),realtime:Object.assign(Object.assign({},u),i),storage:{},global:Object.assign(Object.assign(Object.assign({},f),l),{headers:Object.assign(Object.assign({},(r=f?.headers)!==null&&r!==void 0?r:{}),(n=l?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>Hye(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function Xye(e){const t=e?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Gye(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const rY="2.75.0",Pv=30*1e3,UI=3,OA=UI*Pv,Yye="http://localhost:9999",Jye="supabase.auth.token",Qye={"X-Client-Info":`gotrue-js/${rY}`},VI="X-Supabase-Api-Version",nY={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Zye=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,ebe=10*60*1e3;class lw extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Xn(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class tbe extends lw{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function rbe(e){return Xn(e)&&e.name==="AuthApiError"}class kp extends lw{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Gh extends lw{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class Dm extends Gh{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function nbe(e){return Xn(e)&&e.name==="AuthSessionMissingError"}class av extends Gh{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ej extends Gh{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class tj extends Gh{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function abe(e){return Xn(e)&&e.name==="AuthImplicitGrantRedirectError"}class A6 extends Gh{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class WI extends Gh{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function TA(e){return Xn(e)&&e.name==="AuthRetryableFetchError"}class E6 extends Gh{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class HI extends Gh{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const cN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),k6=` 	
\r=`.split(""),sbe=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<k6.length;t+=1)e[k6[t].charCodeAt(0)]=-2;for(let t=0;t<cN.length;t+=1)e[cN[t].charCodeAt(0)]=t;return e})();function I6(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(cN[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(cN[n]),t.queuedBits-=6}}function aY(e,t,r){const n=sbe[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function O6(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},o=i=>{lbe(i,n,r)};for(let i=0;i<e.length;i+=1)aY(e.charCodeAt(i),s,o);return t.join("")}function obe(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function ibe(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}obe(n,t)}}function lbe(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function ux(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)aY(e.charCodeAt(s),r,n);return new Uint8Array(t)}function cbe(e){const t=[];return ibe(e,r=>t.push(r)),new Uint8Array(t)}function Lp(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};return e.forEach(s=>I6(s,r,n)),I6(null,r,n),t.join("")}function dbe(e){return Math.round(Date.now()/1e3)+e}function ube(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const _c=()=>typeof window<"u"&&typeof document<"u",cp={tested:!1,writable:!1},sY=()=>{if(!_c())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(cp.tested)return cp.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),cp.tested=!0,cp.writable=!0}catch{cp.tested=!0,cp.writable=!1}return cp.writable};function fbe(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,o)=>{t[o]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const oY=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>ef(()=>Promise.resolve().then(()=>A0),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},mbe=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Av=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},dp=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Sm=async(e,t)=>{await e.removeItem(t)};class BC{constructor(){this.promise=new BC.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}BC.promiseConstructor=Promise;function DA(e){const t=e.split(".");if(t.length!==3)throw new HI("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!Zye.test(t[n]))throw new HI("JWT not in base64url format");return{header:JSON.parse(O6(t[0])),payload:JSON.parse(O6(t[1])),signature:ux(t[2]),raw:{header:t[0],payload:t[1]}}}async function hbe(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function pbe(e,t){return new Promise((n,s)=>{(async()=>{for(let o=0;o<1/0;o++)try{const i=await e(o);if(!t(o,null,i)){n(i);return}}catch(i){if(!t(o,i)){s(i);return}}})()})}function gbe(e){return("0"+e.toString(16)).substr(-2)}function vbe(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let o=0;o<56;o++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,gbe).join("")}async function xbe(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(o=>String.fromCharCode(o)).join("")}async function ybe(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await xbe(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function sv(e,t,r=!1){const n=vbe();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await Av(e,`${t}-code-verifier`,s);const o=await ybe(n);return[o,n===o?"plain":"s256"]}const bbe=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function wbe(e){const t=e.headers.get(VI);if(!t||!t.match(bbe))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function jbe(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function _be(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Nbe=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ov(e){if(!Nbe.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function MA(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function T6(e){return JSON.parse(JSON.stringify(e))}var Sbe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};const jp=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Cbe=[502,503,504];async function D6(e){var t;if(!mbe(e))throw new WI(jp(e),0);if(Cbe.includes(e.status))throw new WI(jp(e),e.status);let r;try{r=await e.json()}catch(o){throw new kp(jp(o),o)}let n;const s=wbe(e);if(s&&s.getTime()>=nY["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new E6(jp(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Dm}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((o,i)=>o&&typeof i=="string",!0))throw new E6(jp(r),e.status,r.weak_password.reasons);throw new tbe(jp(r),e.status||500,n)}const Pbe=(e,t,r,n)=>{const s={method:e,headers:t?.headers||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function pa(e,t,r,n){var s;const o=Object.assign({},n?.headers);o[VI]||(o[VI]=nY["2024-01-01"].name),n?.jwt&&(o.Authorization=`Bearer ${n.jwt}`);const i=(s=n?.query)!==null&&s!==void 0?s:{};n?.redirectTo&&(i.redirect_to=n.redirectTo);const l=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await Abe(e,t,r+l,{headers:o,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(c):{data:Object.assign({},c),error:null}}async function Abe(e,t,r,n,s,o){const i=Pbe(t,n,s,o);let l;try{l=await e(r,Object.assign({},i))}catch(c){throw console.error(c),new WI(jp(c),0)}if(l.ok||await D6(l),n?.noResolveJson)return l;try{return await l.json()}catch(c){await D6(c)}}function Xd(e){var t;let r=null;Ibe(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=dbe(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function M6(e){const t=Xd(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Vm(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Ebe(e){return{data:e,error:null}}function kbe(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:o}=e,i=Sbe(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:o},c=Object.assign({},i);return{data:{properties:l,user:c},error:null}}function R6(e){return e}function Ibe(e){return e.access_token&&e.refresh_token&&e.expires_in}const RA=["global","local","others"];var Obe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class Tbe{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=oY(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=RA[0]){if(RA.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${RA.join(", ")}`);try{return await pa(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Xn(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await pa(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Vm})}catch(n){if(Xn(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Obe(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n?.newEmail,delete s.newEmail),await pa(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:kbe,redirectTo:r?.redirectTo})}catch(r){if(Xn(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await pa(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Vm})}catch(r){if(Xn(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,o,i,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await pa(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(o=(s=t?.perPage)===null||s===void 0?void 0:s.toString())!==null&&o!==void 0?o:""},xform:R6});if(u.error)throw u.error;const f=await u.json(),h=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,m=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(v=>{const g=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(v.split(";")[1].split("=")[1]);d[`${y}Page`]=g}),d.total=parseInt(h)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(Xn(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){ov(t);try{return await pa(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Vm})}catch(r){if(Xn(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){ov(t);try{return await pa(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Vm})}catch(n){if(Xn(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){ov(t);try{return await pa(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Vm})}catch(n){if(Xn(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){ov(t.userId);try{const{data:r,error:n}=await pa(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(Xn(r))return{data:null,error:r};throw r}}async _deleteFactor(t){ov(t.userId),ov(t.id);try{return{data:await pa(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Xn(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,s,o,i,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await pa(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(o=(s=t?.perPage)===null||s===void 0?void 0:s.toString())!==null&&o!==void 0?o:""},xform:R6});if(u.error)throw u.error;const f=await u.json(),h=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,m=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(v=>{const g=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(v.split(";")[1].split("=")[1]);d[`${y}Page`]=g}),d.total=parseInt(h)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(Xn(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(t){try{return await pa(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Xn(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await pa(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Xn(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(t){try{return await pa(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Xn(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await pa(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Xn(r))return{data:null,error:r};throw r}}}function L6(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const iv={debug:!!(globalThis&&sY()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class iY extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Dbe extends iY{}async function Mbe(e,t,r){iv.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),iv.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){iv.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{iv.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw iv.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Dbe(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(iv.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function Rbe(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function lY(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function Lbe(e){return parseInt(e,16)}function Fbe(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function $be(e){var t;const{chainId:r,domain:n,expirationTime:s,issuedAt:o=new Date,nonce:i,notBefore:l,requestId:c,resources:d,scheme:u,uri:f,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const m=lY(e.address),v=u?`${u}://${n}`:n,g=e.statement?`${e.statement}
`:"",y=`${v} wants you to sign in with your Ethereum account:
${m}

${g}`;let x=`URI: ${f}
Version: ${h}
Chain ID: ${r}${i?`
Nonce: ${i}`:""}
Issued At: ${o.toISOString()}`;if(s&&(x+=`
Expiration Time: ${s.toISOString()}`),l&&(x+=`
Not Before: ${l.toISOString()}`),c&&(x+=`
Request ID: ${c}`),d){let b=`
Resources:`;for(const w of d){if(!w||typeof w!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${w}`);b+=`
- ${w}`}x+=b}return`${y}
${x}`}class To extends Error{constructor({message:t,code:r,cause:n,name:s}){var o;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(o=s??(n instanceof Error?n.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=r}}class dN extends To{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function Bbe({error:e,options:t}){var r,n,s;const{publicKey:o}=t;if(!o)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new To({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=o.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new To({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=o.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new To({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((s=o.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new To({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new To({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new To({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return o.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new To({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new To({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const i=window.location.hostname;if(dY(i)){if(o.rp.id!==i)return new To({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new To({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new To({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new To({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new To({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function qbe({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new To({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new To({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(dY(n)){if(r.rpId!==n)return new To({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new To({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new To({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new To({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}var cY=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class zbe{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const Ube=new zbe;function Vbe(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,s=cY(e,["challenge","user","excludeCredentials"]),o=ux(t).buffer,i=Object.assign(Object.assign({},r),{id:ux(r.id).buffer}),l=Object.assign(Object.assign({},s),{challenge:o,user:i});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const d=n[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:ux(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function Wbe(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=cY(e,["challenge","allowCredentials"]),s=ux(t).buffer,o=Object.assign(Object.assign({},n),{challenge:s});if(r&&r.length>0){o.allowCredentials=new Array(r.length);for(let i=0;i<r.length;i++){const l=r[i];o.allowCredentials[i]=Object.assign(Object.assign({},l),{id:ux(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return o}function Hbe(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:Lp(new Uint8Array(e.response.attestationObject)),clientDataJSON:Lp(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Gbe(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),s=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Lp(new Uint8Array(s.authenticatorData)),clientDataJSON:Lp(new Uint8Array(s.clientDataJSON)),signature:Lp(new Uint8Array(s.signature)),userHandle:s.userHandle?Lp(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function dY(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function F6(){var e,t;return!!(_c()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function Kbe(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new dN("Browser returned unexpected credential type",t)}:{data:null,error:new dN("Empty credential response",t)}}catch(t){return{data:null,error:Bbe({error:t,options:e})}}}async function Xbe(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new dN("Browser returned unexpected credential type",t)}:{data:null,error:new dN("Empty credential response",t)}}catch(t){return{data:null,error:qbe({error:t,options:e})}}}const Ybe={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},Jbe={userVerification:"preferred",hints:["security-key"]};function uN(...e){const t=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),r=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),n={};for(const s of e)if(s)for(const o in s){const i=s[o];if(i!==void 0)if(Array.isArray(i))n[o]=i;else if(r(i))n[o]=i;else if(t(i)){const l=n[o];t(l)?n[o]=uN(l,i):n[o]=uN(i)}else n[o]=i}return n}function Qbe(e,t){return uN(Ybe,e,t||{})}function Zbe(e,t){return uN(Jbe,e,t||{})}class ewe{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:s},o){try{const{data:i,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!i)return{data:null,error:l};const c=s??Ube.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:d}=i.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${n}`),d.displayName||(d.displayName=d.name)}switch(i.webauthn.type){case"create":{const d=Qbe(i.webauthn.credential_options.publicKey,o?.create),{data:u,error:f}=await Kbe({publicKey:d,signal:c});return u?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:u}},error:null}:{data:null,error:f}}case"request":{const d=Zbe(i.webauthn.credential_options.publicKey,o?.request),{data:u,error:f}=await Xbe(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:d,signal:c}));return u?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:u}},error:null}:{data:null,error:f}}}}catch(i){return Xn(i)?{data:null,error:i}:{data:null,error:new kp("Unexpected error in challenge",i)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}},o){if(!r)return{data:null,error:new lw("rpId is required for WebAuthn authentication")};try{if(!F6())return{data:null,error:new kp("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:s},{request:o});if(!i)return{data:null,error:l};const{webauthn:c}=i;return this._verify({factorId:t,challengeId:i.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:n,credential_response:c.credential_response}})}catch(i){return Xn(i)?{data:null,error:i}:{data:null,error:new kp("Unexpected error in authenticate",i)}}}async _register({friendlyName:t,rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s},o){if(!r)return{data:null,error:new lw("rpId is required for WebAuthn registration")};try{if(!F6())return{data:null,error:new kp("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this._enroll({friendlyName:t});if(!i)return await this.client.mfa.listFactors().then(u=>{var f;return(f=u.data)===null||f===void 0?void 0:f.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u?.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:s},{create:o});return c?this._verify({factorId:i.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(i){return Xn(i)?{data:null,error:i}:{data:null,error:new kp("Unexpected error in register",i)}}}}Rbe();const twe={url:Yye,storageKey:Jye,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Qye,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function $6(e,t,r){return await r()}const lv={};class cw{get jwks(){var t,r;return(r=(t=lv[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){lv[this.storageKey]=Object.assign(Object.assign({},lv[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=lv[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){lv[this.storageKey]=Object.assign(Object.assign({},lv[this.storageKey]),{cachedAt:t})}constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=cw.nextInstanceID,cw.nextInstanceID+=1,this.instanceID>0&&_c()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},twe),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new Tbe({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=oY(s.fetch),this.lock=s.lock||$6,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:_c()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=Mbe:this.lock=$6,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new ewe(this)},this.persistSession?(s.storage?this.storage=s.storage:sY()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=L6(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=L6(this.memoryStorage)),_c()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${rY}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=fbe(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),_c()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:o}=await this._getSessionFromURL(r,n);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),abe(o)){const c=(t=o.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:i,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",i,"redirect type",l),await this._saveSession(i),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Xn(r)?{error:r}:{error:new kp("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const o=await pa(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t?.options)===null||s===void 0?void 0:s.captchaToken}},xform:Xd}),{data:i,error:l}=o;if(l||!i)return{data:{user:null,session:null},error:l};const c=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(o){if(Xn(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(t){var r,n,s;try{let o;if("email"in t){const{email:u,password:f,options:h}=t;let m=null,v=null;this.flowType==="pkce"&&([m,v]=await sv(this.storage,this.storageKey)),o=await pa(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h?.emailRedirectTo,body:{email:u,password:f,data:(r=h?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:m,code_challenge_method:v},xform:Xd})}else if("phone"in t){const{phone:u,password:f,options:h}=t;o=await pa(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=h?.data)!==null&&n!==void 0?n:{},channel:(s=h?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:h?.captchaToken}},xform:Xd})}else throw new ej("You must provide either an email or phone number and a password");const{data:i,error:l}=o;if(l||!i)return{data:{user:null,session:null},error:l};const c=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(o){if(Xn(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(t){try{let r;if("email"in t){const{email:o,password:i,options:l}=t;r=await pa(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:i,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:M6})}else if("phone"in t){const{phone:o,password:i,options:l}=t;r=await pa(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:i,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:M6})}else throw new ej("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new av}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(Xn(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,s,o;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(o=t.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,s,o,i,l,c,d,u,f,h;let m,v;if("message"in t)m=t.message,v=t.signature;else{const{chain:g,wallet:y,statement:x,options:b}=t;let w;if(_c())if(typeof y=="object")w=y;else{const A=window;if("ethereum"in A&&typeof A.ethereum=="object"&&"request"in A.ethereum&&typeof A.ethereum.request=="function")w=A.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!b?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=y}const j=new URL((r=b?.url)!==null&&r!==void 0?r:window.location.href),_=await w.request({method:"eth_requestAccounts"}).then(A=>A).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!_||_.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const S=lY(_[0]);let C=(n=b?.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!C){const A=await w.request({method:"eth_chainId"});C=Lbe(A)}const P={domain:j.host,address:S,statement:x,uri:j.href,version:"1",chainId:C,nonce:(s=b?.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(i=(o=b?.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(l=b?.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=b?.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=b?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(u=b?.signInWithEthereum)===null||u===void 0?void 0:u.resources};m=$be(P),v=await w.request({method:"personal_sign",params:[Fbe(m),S]})}try{const{data:g,error:y}=await pa(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:m,signature:v},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Xd});if(y)throw y;return!g||!g.session||!g.user?{data:{user:null,session:null},error:new av}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:Object.assign({},g),error:y})}catch(g){if(Xn(g))return{data:{user:null,session:null},error:g};throw g}}async signInWithSolana(t){var r,n,s,o,i,l,c,d,u,f,h,m;let v,g;if("message"in t)v=t.message,g=t.signature;else{const{chain:y,wallet:x,statement:b,options:w}=t;let j;if(_c())if(typeof x=="object")j=x;else{const S=window;if("solana"in S&&typeof S.solana=="object"&&("signIn"in S.solana&&typeof S.solana.signIn=="function"||"signMessage"in S.solana&&typeof S.solana.signMessage=="function"))j=S.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!w?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");j=x}const _=new URL((r=w?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in j&&j.signIn){const S=await j.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w?.signInWithSolana),{version:"1",domain:_.host,uri:_.href}),b?{statement:b}:null));let C;if(Array.isArray(S)&&S[0]&&typeof S[0]=="object")C=S[0];else if(S&&typeof S=="object"&&"signedMessage"in S&&"signature"in S)C=S;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)v=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),g=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in j)||typeof j.signMessage!="function"||!("publicKey"in j)||typeof j!="object"||!j.publicKey||!("toBase58"in j.publicKey)||typeof j.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${_.host} wants you to sign in with your Solana account:`,j.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${_.href}`,`Issued At: ${(s=(n=w?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((o=w?.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((i=w?.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((l=w?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((c=w?.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((d=w?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((f=(u=w?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",...w.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const S=await j.signMessage(new TextEncoder().encode(v),"utf8");if(!S||!(S instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=S}}try{const{data:y,error:x}=await pa(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:Lp(g)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(m=t.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Xd});if(x)throw x;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new av}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:x})}catch(y){if(Xn(y))return{data:{user:null,session:null},error:y};throw y}}async _exchangeCodeForSession(t){const r=await dp(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:o,error:i}=await pa(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Xd});if(await Sm(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new av}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:s??null}),error:i})}catch(o){if(Xn(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:o,nonce:i}=t,l=await pa(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:o,nonce:i,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Xd}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new av}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(r){if(Xn(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,s,o,i;try{if("email"in t){const{email:l,options:c}=t;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await sv(this.storage,this.storageKey));const{error:f}=await pa(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c?.data)!==null&&r!==void 0?r:{},create_user:(n=c?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c?.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:l,options:c}=t,{data:d,error:u}=await pa(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c?.data)!==null&&s!==void 0?s:{},create_user:(o=c?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(i=c?.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:d?.message_id},error:u}}throw new ej("You must provide either an email or phone number.")}catch(l){if(Xn(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(t){var r,n;try{let s,o;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,o=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:l}=await pa(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:o}}),redirectTo:s,xform:Xd});if(l)throw l;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,d=i.user;return c?.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(s){if(Xn(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var r,n,s;try{let o=null,i=null;return this.flowType==="pkce"&&([o,i]=await sv(this.storage,this.storageKey)),await pa(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:i}),headers:this.headers,xform:Ebe})}catch(o){if(Xn(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Dm;const{error:s}=await pa(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(Xn(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:o}=t,{error:i}=await pa(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:o?.captchaToken}},redirectTo:o?.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in t){const{phone:n,type:s,options:o}=t,{data:i,error:l}=await pa(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:o?.captchaToken}}});return{data:{user:null,session:null,messageId:i?.message_id},error:l}}throw new ej("You must provide either an email or phone number and a type")}catch(r){if(Xn(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await dp(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<OA:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const i=await dp(this.userStorage,this.storageKey+"-user");i?.user?t.user=i.user:t.user=MA()}if(this.storage.isServer&&t.user){let i=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,d,u)=>(!i&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,u))})}return{data:{session:t},error:null}}const{data:s,error:o}=await this._callRefreshToken(t.refresh_token);return o?{data:{session:null},error:o}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await pa(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Vm}):await this._useSession(async r=>{var n,s,o;const{data:i,error:l}=r;if(l)throw l;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Dm}:await pa(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&o!==void 0?o:void 0,xform:Vm})})}catch(r){if(Xn(r))return nbe(r)&&(await this._removeSession(),await Sm(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:o}=n;if(o)throw o;if(!s.session)throw new Dm;const i=s.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await sv(this.storage,this.storageKey));const{data:d,error:u}=await pa(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:i.access_token,xform:Vm});if(u)throw u;return i.user=d.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if(Xn(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Dm;const r=Date.now()/1e3;let n=r,s=!0,o=null;const{payload:i}=DA(t.access_token);if(i.exp&&(n=i.exp,s=n<=r),s){const{data:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};o=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;o={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(r){if(Xn(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:i,error:l}=r;if(l)throw l;t=(n=i.session)!==null&&n!==void 0?n:void 0}if(!t?.refresh_token)throw new Dm;const{data:s,error:o}=await this._callRefreshToken(t.refresh_token);return o?{data:{user:null,session:null},error:o}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Xn(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!_c())throw new tj("No browser detected.");if(t.error||t.error_description||t.error_code)throw new tj(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new A6("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new tj("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new A6("No code detected.");const{data:b,error:w}=await this._exchangeCodeForSession(t.code);if(w)throw w;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:o,refresh_token:i,expires_in:l,expires_at:c,token_type:d}=t;if(!o||!l||!i||!d)throw new tj("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(l);let h=u+f;c&&(h=parseInt(c));const m=h-u;m*1e3<=Pv&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${f}s`);const v=h-f;u-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,h,u):u-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,h,u);const{data:g,error:y}=await this._getUser(o);if(y)throw y;const x={provider_token:n,provider_refresh_token:s,access_token:o,expires_in:f,expires_at:h,refresh_token:i,token_type:d,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:t.type},error:null}}catch(n){if(Xn(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await dp(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:o}=r;if(o)return{error:o};const i=(n=s.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:l}=await this.admin.signOut(i,t);if(l&&!(rbe(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(await this._removeSession(),await Sm(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=ube(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:o},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",t,"session",o)}catch(o){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",o),console.error(o)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await sv(this.storage,this.storageKey,!0));try{return await pa(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(o){if(Xn(o))return{data:null,error:o};throw o}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Xn(r))return{data:null,error:r};throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:s}=await this._useSession(async o=>{var i,l,c,d,u;const{data:f,error:h}=o;if(h)throw h;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await pa(this.fetch,"GET",m,{headers:this.headers,jwt:(u=(d=f.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(s)throw s;return _c()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:t.provider,url:n?.url},error:null}}catch(n){if(Xn(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:s,data:{session:o}}=r;if(s)throw s;const{options:i,provider:l,token:c,access_token:d,nonce:u}=t,f=await pa(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=o?.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:c,access_token:d,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:i?.captchaToken}},xform:Xd}),{data:h,error:m}=f;return m?{data:{user:null,session:null},error:m}:!h||!h.session||!h.user?{data:{user:null,session:null},error:new av}:(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),{data:h,error:m})}catch(s){if(Xn(s))return{data:{user:null,session:null},error:s};throw s}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:o,error:i}=r;if(i)throw i;return await pa(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(Xn(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await pbe(async s=>(s>0&&await hbe(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await pa(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Xd})),(s,o)=>{const i=200*Math.pow(2,s);return o&&TA(o)&&Date.now()+i-n<Pv})}catch(n){if(this._debug(r,"error",n),Xn(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),_c()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await dp(this.storage,this.storageKey);if(s&&this.userStorage){let i=await dp(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:s.user},await Av(this.userStorage,this.storageKey+"-user",i)),s.user=(t=i?.user)!==null&&t!==void 0?t:MA()}else if(s&&!s.user&&!s.user){const i=await dp(this.storage,this.storageKey+"-user");i&&i?.user?(s.user=i.user,await Sm(this.storage,this.storageKey+"-user"),await Av(this.storage,this.storageKey,s)):s.user=MA()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const o=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<OA;if(this._debug(n,`session has${o?"":" not"} expired with margin of ${OA}s`),o){if(this.autoRefreshToken&&s.refresh_token){const{error:i}=await this._callRefreshToken(s.refresh_token);i&&(console.error(i),TA(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:l}=await this._getUser(s.access_token);!l&&i?.user?(s.user=i.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Dm;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new BC;const{data:o,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!o.session)throw new Dm;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const l={data:o.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(o){if(this._debug(s,"error",o),Xn(o)){const i={data:null,error:o};return TA(o)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(o),o}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const o=[],i=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){o.push(c)}});if(await Promise.all(i),o.length>0){for(let l=0;l<o.length;l+=1)console.error(o[l]);throw o[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Av(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const o=T6(s);await Av(this.storage,this.storageKey,o)}else{const s=T6(r);await Av(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await Sm(this.storage,this.storageKey),await Sm(this.storage,this.storageKey+"-code-verifier"),await Sm(this.storage,this.storageKey+"-user"),this.userStorage&&await Sm(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&_c()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Pv);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/Pv);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Pv}ms, refresh threshold is ${UI} ticks`),s<=UI&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof iY)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!_c()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[o,i]=await sv(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(i)}`});s.push(l.toString())}if(n?.queryParams){const o=new URLSearchParams(n.queryParams);s.push(o.toString())}return n?.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:o}=r;return o?{data:null,error:o}:await pa(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Xn(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:o,error:i}=r;if(i)return{data:null,error:i};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:d}=await pa(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=o?.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(t.factorType==="totp"&&c.type==="totp"&&(!((s=c?.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(Xn(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:o}=r;if(o)return{data:null,error:o};const i=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?Hbe(t.webauthn.credential_response):Gbe(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:c}=await pa(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:i,headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:c})})}catch(r){if(Xn(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:o}=r;if(o)return{data:null,error:o};const i=await pa(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});if(i.error)return i;const{data:l}=i;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Vbe(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Wbe(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Xn(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const s={all:[],phone:[],totp:[],webauthn:[]};for(const o of(t=r?.factors)!==null&&t!==void 0?t:[])s.all.push(o),o.status==="verified"&&s[o.factor_type].push(o);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:s},error:o}=t;if(o)return{data:null,error:o};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=DA(s.access_token);let l=null;i.aal&&(l=i.aal);let c=l;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const u=i.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+ebe>s)return n;const{data:o,error:i}=await pa(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=s,n=o.keys.find(l=>l.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:m,error:v}=await this.getSession();if(v||!m.session)return{data:null,error:v};n=m.session.access_token}const{header:s,payload:o,signature:i,raw:{header:l,payload:c}}=DA(n);r?.allowExpired||jbe(o.exp);const d=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!d){const{error:m}=await this.getUser(n);if(m)throw m;return{data:{claims:o,header:s,signature:i},error:null}}const u=_be(s.alg),f=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,i,cbe(`${l}.${c}`)))throw new HI("Invalid JWT signature");return{data:{claims:o,header:s,signature:i},error:null}}catch(n){if(Xn(n))return{data:null,error:n};throw n}}}cw.nextInstanceID=0;const rwe=cw;class nwe extends rwe{constructor(t){super(t)}}var awe=globalThis&&globalThis.__awaiter||function(e,t,r,n){function s(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(n.next(u))}catch(f){i(f)}}function c(u){try{d(n.throw(u))}catch(f){i(f)}}function d(u){u.done?o(u.value):s(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class swe{constructor(t,r,n){var s,o,i;this.supabaseUrl=t,this.supabaseKey=r;const l=Xye(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:$ye,realtime:qye,auth:Object.assign(Object.assign({},Bye),{storageKey:c}),global:Fye},u=Kye(n??{},d);this.storageKey=(s=u.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(o=u.global.headers)!==null&&o!==void 0?o:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(f,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=u.auth)!==null&&i!==void 0?i:{},this.headers,u.global.fetch),this.fetch=Wye(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new tye(new URL("rest/v1",l).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new Mye(this.storageUrl.href,this.headers,this.fetch,n?.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new T0e(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){return awe(this,void 0,void 0,function*(){var t,r;if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:o,storageKey:i,flowType:l,lock:c,debug:d},u,f){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new nwe({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),u),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:o,flowType:l,lock:c,debug:d,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(m=>m.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new xye(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n?.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const owe=(e,t,r)=>new swe(e,t,r);function iwe(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}iwe()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const lwe="https://dlfryxtyxqoacuunswuc.supabase.co",cwe="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsZnJ5eHR5eHFvYWN1dW5zd3VjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4ODg0MzcsImV4cCI6MjA3MTQ2NDQzN30.AizQBbCE1p_xfAQ9T0Eha1anGzcFETcc__8AV4iaQTY";function jD(){try{if(typeof window<"u"&&window.__SUPABASE_URL)return window.__SUPABASE_URL}catch{}return lwe}function uY(){try{if(typeof window<"u"&&window.__SUPABASE_KEY)return window.__SUPABASE_KEY}catch{}return cwe}function dwe(){try{return(new URL(jD()).host||"").split(".")[0]||""}catch{return""}}function uwe(){const e=dwe();return e?`sb-${e}-auth-token`:"sb-auth-token"}async function fwe(){try{const e=localStorage.getItem("custom-auth-token");if(e&&e.trim())return e.trim()}catch{}try{if(typeof xh<"u"&&xh?.auth?.getSession){const e=new Promise((s,o)=>setTimeout(()=>o(new Error("getSession timeout")),1e3)),t=xh.auth.getSession(),{data:r}=await Promise.race([t,e]),n=r?.session?.access_token;if(n)return console.debug("[Supabase Wrapper] Token obtido via getSession"),n}}catch(e){console.debug("[Supabase Wrapper] getSession falhou ou timeout:",e.message)}try{const e=uwe(),t=localStorage.getItem(e);if(t){const r=JSON.parse(t);if(r?.access_token)return console.debug("[Supabase Wrapper] Token obtido via localStorage"),r.access_token;if(r?.currentSession?.access_token)return console.debug("[Supabase Wrapper] Token obtido via localStorage (currentSession)"),r.currentSession.access_token}}catch(e){console.warn("[Supabase Wrapper] Erro ao ler localStorage:",e)}return console.warn("[Supabase Wrapper]  Nenhum token encontrado - usando anon key"),null}const mwe=e=>{const t=new URLSearchParams;return Object.entries(e).forEach(([r,n])=>{n!=null&&(Array.isArray(n)?n.forEach(s=>t.append(r,String(s))):t.append(r,String(n)))}),t.toString()},fY=async(e,t={})=>{const{method:r="GET",body:n,headers:s={},params:o={},signal:i,timeoutMs:l=2e4}=t,c=mwe(o),u=`${jD()}/rest/v1/${e}${c?`?${c}`:""}`,h={apikey:uY(),"Content-Type":"application/json",Prefer:"return=representation",...s};try{const _=await fwe();_&&(h.Authorization=`Bearer ${_}`)}catch(_){console.warn("[Supabase Wrapper] Erro ao obter token de sesso:",_)}const m={method:r,headers:h};n&&(m.body=JSON.stringify(n)),i&&(m.signal=i);const v=new AbortController,g=setTimeout(()=>{console.warn(`[Supabase Wrapper]  Timeout (${l}ms) para ${e}`);try{v.abort("timeout")}catch{}},Math.max(5e3,l)),y=(()=>{if(!i)return v.signal;try{i.addEventListener("abort",()=>{try{v.abort("upstream-abort")}catch{}})}catch{}return v.signal})();m.signal=y;const x=Date.now();let b;try{b=await fetch(u,m)}finally{clearTimeout(g)}if(!b.ok){let _="";try{_=await b.text()}catch{}const S=Date.now()-x;let C=!1;try{const P=JSON.parse(_);C=b.status===401&&(P?.code==="PGRST303"||/jwt expired/i.test(P?.message||""))}catch{}if(C){try{window.dispatchEvent(new CustomEvent("auth:jwt-expired"))}catch{}try{localStorage.removeItem("custom-auth-token"),Object.keys(localStorage).filter(P=>P.startsWith("sb-")).forEach(P=>localStorage.removeItem(P)),Object.keys(sessionStorage).filter(P=>P.startsWith("sb-")).forEach(P=>sessionStorage.removeItem(P)),sessionStorage.setItem("auth:forceLogout","1"),window.location.replace("/")}catch{}}throw new Error(`[Supabase Wrapper] HTTP ${b.status} (${S}ms) - ${_||"unknown error"}`)}const w=Date.now()-x;let j;try{j=await b.json()}catch(_){throw console.error(`[Supabase Wrapper] Erro ao parsear JSON de ${e}:`,_),new Error(`[Supabase Wrapper] JSON parse error: ${_.message}`)}return w>3e3?console.warn(`[Supabase Wrapper]  fetch ${e} LENTO (${w}ms)`):console.debug(`[Supabase Wrapper] fetch ${e} OK (${w}ms)`),{data:j,error:null}};class hwe{constructor(t){this.table=t,this.params={},this.multiFilters={},this.selectColumns="*",this.signal=null}select(t="*"){return this.selectColumns=t,this.params.select=t,this}eq(t,r){return this._addFilter(t,`eq.${r}`),this}neq(t,r){return this.params[t]=`neq.${r}`,this}gt(t,r){return this.params[t]=`gt.${r}`,this}gte(t,r){return this._addFilter(t,`gte.${r}`),this}lt(t,r){return this.params[t]=`lt.${r}`,this}lte(t,r){return this._addFilter(t,`lte.${r}`),this}like(t,r){return this.params[t]=`like.${r}`,this}ilike(t,r){return this.params[t]=`ilike.${r}`,this}is(t,r){return this.params[t]=`is.${r}`,this}in(t,r){return this.params[t]=`in.(${r.join(",")})`,this}not(t,r,n){return this.params[t]=`not.${r}.${n}`,this}or(t){return this.params.or=`(${t})`,this}contains(t,r){return this.params[t]=`cs.{${r}}`,this}containedBy(t,r){return this.params[t]=`cd.{${r}}`,this}filter(t,r,n){return this._addFilter(t,`${r}.${n}`),this}order(t,r={}){const n=r.ascending===!1?"desc":"asc";return this.params.order=`${t}.${n}`,this}limit(t){return this.params.limit=t,this}range(t,r){return this.params.offset=t,this.params.limit=r-t+1,this}single(){return this.params.limit=1,this.isSingle=!0,this}maybeSingle(){return this.params.limit=1,this.isMaybeSingle=!0,this}abortSignal(t){return this.signal=t,this}_addFilter(t,r){this.multiFilters[t]||(this.multiFilters[t]=[]),this.multiFilters[t].push(r)}async then(t,r){try{const n={...this.params};Object.entries(this.multiFilters).forEach(([o,i])=>{i.length===1?n[o]=i[0]:i.length>1&&(n[o]=i)});const s=await fY(this.table,{method:"GET",params:n,signal:this.signal});this.isSingle&&s.data&&(s.data=s.data[0]||null),this.isMaybeSingle&&s.data&&(s.data=s.data[0]||null),t(s)}catch(n){r(n)}}}class pwe extends hwe{insert(t){return this.method="POST",this.body=Array.isArray(t)?t:[t],this}update(t){return this.method="PATCH",this.body=t,this}upsert(t,r={}){this.method="POST",this.body=Array.isArray(t)?t:[t];const n=r.ignoreDuplicates?"resolution=ignore-duplicates":"resolution=merge-duplicates",s=r.returning==="minimal"?"return=minimal":"return=representation";return this.headers={...this.headers||{},Prefer:`${n},${s}`},r.onConflict&&(this.params.on_conflict=r.onConflict),this}delete(){return this.method="DELETE",this}async then(t,r){try{const n={...this.params};Object.entries(this.multiFilters).forEach(([o,i])=>{i.length===1?n[o]=i[0]:i.length>1&&(n[o]=i)});const s=await fY(this.table,{method:this.method||"GET",body:this.body,params:n,signal:this.signal,headers:this.headers||{}});this.isSingle&&s.data&&(s.data=s.data[0]||null),this.isMaybeSingle&&s.data&&(s.data=s.data[0]||null),t(s)}catch(n){r(n)}}}const xh={from(e){return new pwe(e)},auth:null,supabaseUrl:jD(),supabaseKey:uY()};typeof window<"u"&&xh.from("empresas").select("id").limit(1).then(({data:e,error:t})=>{t&&console.error("[Supabase Wrapper]  ERRO:",t)}).catch(e=>{console.error("[Supabase Wrapper]  EXCEPTION:",e)});const B6="main";let fx,db;try{const e=Object.assign({"./backendTargets.js":S0e,"./backendTargets.local.js":A0e}),t=e["./backendTargets.js"]||null,r=e["./backendTargets.local.js"]||null;t?.TARGETS&&(db=t.TARGETS),t?.ACTIVE_TARGET&&(fx=t.ACTIVE_TARGET),r?.TARGETS&&(db=r.TARGETS),r?.ACTIVE_TARGET&&(fx=r.ACTIVE_TARGET)}catch{}let jd=db&&fx&&db[fx]?db[fx]:null,_D=fx;!jd&&B6&&(_D=B6);let Ql=jd&&jd.supabaseUrl&&jd.supabaseUrl.trim()?jd.supabaseUrl:"",Zl=jd&&jd.supabaseAnonKey&&jd.supabaseAnonKey.trim()?jd.supabaseAnonKey:"";if(!Ql||!Zl){const e=(_D||"dev").toLowerCase(),t=e==="main"?{}.VITE_SUPABASE_URL_MAIN:{}.VITE_SUPABASE_URL_DEV,r=e==="main"?{}.VITE_SUPABASE_ANON_KEY_MAIN:{}.VITE_SUPABASE_ANON_KEY_DEV;Ql=Ql&&Ql.trim()?Ql:t,Zl=Zl&&Zl.trim()?Zl:r}(!Ql||!Zl)&&(Ql=Ql||"https://dlfryxtyxqoacuunswuc.supabase.co",Zl=Zl||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsZnJ5eHR5eHFvYWN1dW5zd3VjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4ODg0MzcsImV4cCI6MjA3MTQ2NDQzN30.AizQBbCE1p_xfAQ9T0Eha1anGzcFETcc__8AV4iaQTY");try{try{const e=_D||"dev";console.log(`[Target] Branch ativa: ${e}`);try{typeof window<"u"&&(window.__ACTIVE_TARGET=e)}catch{}const t=!!jd&&!!(jd.supabaseUrl||"").trim()&&!!(jd.supabaseAnonKey||"").trim(),r=!t&&(!!{}.VITE_SUPABASE_URL_DEV||!!{}.VITE_SUPABASE_URL_MAIN);console.info(`[Supabase] Backend target mode: ${t?"static config":r?"per-target env":"generic env"}`)}catch{}}catch{}if(!Ql||!Zl)throw console.error("[Supabase]  ERRO CRTICO: Variveis de ambiente ausentes!"),new Error("Supabase: Variveis de ambiente no configuradas!");const GI=Ql,KI=Zl,Yd=owe(Ql,Zl,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storage:typeof window<"u"?window.localStorage:void 0},global:{headers:{"X-Client-Info":"fluxo7arena-web",apikey:Zl}}});try{typeof window<"u"&&xh&&(xh.auth=Yd.auth)}catch{}const de={from:e=>xh.from(e),auth:Yd.auth,storage:Yd.storage,functions:Yd.functions,rpc:(...e)=>Yd.rpc(...e),realtime:Yd.realtime,channel:(...e)=>Yd.channel(...e),removeChannel:(...e)=>Yd.removeChannel(...e),removeAllChannels:()=>Yd.removeAllChannels(),getChannels:()=>Yd.getChannels(),supabaseUrl:Ql,supabaseKey:Zl};if(typeof window<"u"){window.__supabase=de,window.__supabase_original=Yd,window.__supabase_wrapper=xh;try{window.__SUPABASE_URL=Ql}catch{}try{window.__SUPABASE_KEY=Zl}catch{}}try{if(typeof window<"u"){const e=()=>{try{const t=localStorage.getItem("custom-auth-token");if(t&&t.trim()){de.realtime.setAuth(t.trim());return}let r="";try{r=(new URL(Ql).host||"").split(".")[0]||""}catch{}const n=r?`sb-${r}-auth-token`:"sb-auth-token",s=localStorage.getItem(n);if(s){const o=JSON.parse(s),i=o?.access_token||o?.currentSession?.access_token;i&&de.realtime.setAuth(i)}}catch{}};e();try{window.addEventListener("storage",t=>{try{const r=t?.key||"";(r==="custom-auth-token"||r.startsWith("sb-"))&&e()}catch{}})}catch{}}}catch{}const mY=p.createContext({}),ms=()=>{const e=p.useContext(mY);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},gwe=({children:e})=>{const[t,r]=p.useState(null),[n,s]=p.useState(null),[o,i]=p.useState(null),[l,c]=p.useState(!0),[d,u]=p.useState(!1),f=p.useRef(null),h=p.useRef(!1),m=(()=>{try{return typeof window<"u"&&String(window.__ACTIVE_TARGET||"").toLowerCase()==="dev"}catch{return!1}})();p.useEffect(()=>{if((()=>{try{return sessionStorage.getItem("auth:forceLogout")==="1"}catch{return!1}})()){try{localStorage.removeItem("auth:userProfile"),localStorage.removeItem("auth:company")}catch{}r(null),s(null),i(null),u(!0),c(!1);try{sessionStorage.removeItem("auth:forceLogout")}catch{}try{de.auth.signOut({scope:"global"}).catch(()=>{})}catch{}return}try{const P=localStorage.getItem("auth:userProfile"),A=localStorage.getItem("auth:company");P&&s(JSON.parse(P)),A&&i(JSON.parse(A)),(P||A)&&u(!0)}catch(P){console.warn("AuthContext: falha ao hidratar cache local:",P)}(async()=>{try{if(m)try{const R=localStorage.getItem("custom-auth-token");if(R&&R.trim()){const I=JSON.parse(atob(R.split(".")[1].replace(/-/g,"+").replace(/_/g,"/")))?.sub||null;if(I){r({id:I}),u(!0),await v(I),f.current=I,c(!1);return}}}catch{}const{data:{session:P},error:A}=await de.auth.getSession();A&&console.error("supabase.auth.getSession error:",A),P?.user?(r(P.user),u(!0),await v(P.user.id),f.current=P.user.id):u(!0)}catch(P){console.error("getSession exception:",P)}finally{c(!1)}})();const{data:S}=de.auth.onAuthStateChange(async(P,A)=>{console.log("[AuthContext] onAuthStateChange",{event:P,userId:A?.user?.id||null});try{if(P==="SIGNED_OUT"){try{localStorage.removeItem("auth:userProfile"),localStorage.removeItem("auth:company")}catch{}r(null),s(null),i(null),f.current=null,h.current=!1,c(!1),u(!0);return}if(m){u(!0),c(!1);return}const R=A?.user||null;r(R),u(!0),R?.id&&(await v(R.id),f.current=R.id,c(!1))}catch(R){console.error("onAuthStateChange handler error:",R),c(!1),u(!0)}}),C=setTimeout(()=>{c(P=>P&&!1),u(P=>P||!0)},12e3);return()=>{clearTimeout(C),S.subscription.unsubscribe()}},[]),p.useEffect(()=>{(async()=>{try{if(!d||!t)return;const _=!n,S=!!n&&!o&&!!n.codigo_empresa;(_||S)&&(await v(t.id),f.current=t.id)}catch{}})()},[d,t?.id,!!n,n?.codigo_empresa,!!o]),p.useEffect(()=>{const j=()=>{try{const C=localStorage.getItem("auth:userProfile"),P=localStorage.getItem("auth:company");if(C){const A=JSON.parse(C);(!n||!n.codigo_empresa)&&s(A)}if(P){const A=JSON.parse(P);(!o||!o.codigo_empresa)&&i(A)}}catch{}},_=()=>{j(),t?.id&&v(t.id).catch(()=>{})},S=()=>{document.visibilityState==="visible"&&_()};return window.addEventListener("focus",_),document.addEventListener("visibilitychange",S),()=>{window.removeEventListener("focus",_),document.removeEventListener("visibilitychange",S)}},[t?.id]);const v=async j=>{if(h.current){console.log("[AuthDebug] loadUserProfile:skip (already running)");return}h.current=!0;try{const _=[300,800,1600,3e3],S=A=>new Promise(R=>setTimeout(R,A)),C=async(A,R)=>{let O;try{const I=new Promise(D=>{O=setTimeout(()=>D({__timeout:!0}),R)});return await Promise.race([A,I])}finally{clearTimeout(O)}},P=1200;for(let A=0;A<=_.length;A++){console.log("[AuthDebug] loadUserProfile:start",{userId:j,attempt:A});try{console.log("[AuthDebug] querying colaboradores",{userId:j});const R=de.from("colaboradores").select("*").eq("id",j).single(),O=await C(R,P);if(O&&O.__timeout){console.warn("[AuthDebug] colaboradores:timeout, using usuarios fallback (inline)");try{console.log("[AuthDebug] fallback-inline: querying usuarios by id");const{data:D,error:U}=await de.from("usuarios").select("*").eq("id",j).maybeSingle();if(!U&&D){let z=null;if(D.codigo_empresa){console.log("[AuthDebug] fallback-inline: querying empresas by codigo",{codigo_empresa:D.codigo_empresa});const{data:$,error:X}=await de.from("empresas").select("*").eq("codigo_empresa",D.codigo_empresa).single();X?console.warn("[AuthDebug] fallback-inline: empresa error",{status:X.status,code:X.code,message:X.message}):(z=$,console.log("[AuthDebug] fallback-inline: empresa loaded"))}const W={id:j,nome:D.nome||null,cargo:D.papel||"user",codigo_empresa:D.codigo_empresa||null,_source:"usuarios"};s(W);try{localStorage.setItem("auth:userProfile",JSON.stringify(W))}catch{}if(z){i(z);try{localStorage.setItem("auth:company",JSON.stringify(z))}catch{}console.log("[AuthDebug] fallback-inline: set company from usuarios path")}else console.warn("[AuthDebug] fallback-inline: no company resolved; preserving previous company");return}U&&console.warn("[AuthDebug] fallback-inline: usuarios error",{status:U.status,code:U.code,message:U.message})}catch(D){console.warn("[AuthDebug] fallback-inline: unexpected error",D?.message||D)}if(A<_.length){await S(_[A]);continue}return}const{data:I,error:M}=O||{};if(console.log("[AuthDebug] colaboradores:success",{hasProfile:!!I,codigo_empresa:I?.codigo_empresa||null}),M){if(console.warn("[AuthDebug] colaboradores:error",{code:M.code,status:M.status,message:M.message}),M.code==="42P17"){if(A<_.length){await S(_[A]);continue}console.warn("RLS recursion (42P17) persistente ao carregar perfil. Prosseguindo sem alterar cache.");return}if([401,403].includes(Number(M.status))&&(console.warn("[AuthDebug] Erro de autorizao detectado, tentando fallback"),A<_.length)){await S(_[A]);continue}if(M.code==="PGRST116"){try{console.log("[AuthDebug] fallback: querying usuarios by id");const{data:U,error:z}=await de.from("usuarios").select("*").eq("id",j).maybeSingle();if(!z&&U){let W=null;if(U.codigo_empresa){console.log("[AuthDebug] fallback: querying empresas by codigo",{codigo_empresa:U.codigo_empresa});const{data:X,error:ye}=await de.from("empresas").select("*").eq("codigo_empresa",U.codigo_empresa).single();ye?console.warn("[AuthDebug] fallback: empresa error",{status:ye.status,code:ye.code,message:ye.message}):(W=X,console.log("[AuthDebug] fallback: empresa loaded"))}const $={id:j,nome:U.nome||null,cargo:U.papel||"user",codigo_empresa:U.codigo_empresa||null,_source:"usuarios"};s($);try{localStorage.setItem("auth:userProfile",JSON.stringify($))}catch{}if(W){i(W);try{localStorage.setItem("auth:company",JSON.stringify(W))}catch{}console.log("[AuthDebug] fallback: set company from usuarios path")}else console.warn("[AuthDebug] fallback: no company resolved; preserving previous company");return}z&&console.warn("[AuthDebug] fallback: usuarios error",{status:z.status,code:z.code,message:z.message})}catch{}console.warn("AuthContext: perfil no encontrado (PGRST116) e fallback falhou; mantendo cache atual.");return}if([401,403,406].includes(Number(M.status))&&A<_.length){await S(_[A]);continue}throw M}if(!I){if(A<_.length){await S(_[A]);continue}return}s(I);try{localStorage.setItem("auth:userProfile",JSON.stringify(I))}catch{}if(I?.codigo_empresa){console.log("[AuthDebug] company: querying empresas by codigo from colaboradores",{codigo_empresa:I.codigo_empresa});const{data:D,error:U}=await de.from("empresas").select("*").eq("codigo_empresa",I.codigo_empresa).single();if(U){if([401,403,406].includes(Number(U.status))&&A<_.length){await S(_[A]);continue}console.warn("[AuthDebug] company: load error; preserving previous company",{status:U.status,code:U.code,message:U.message});return}else{i(D);try{localStorage.setItem("auth:company",JSON.stringify(D))}catch{}console.log("[AuthDebug] company: set from colaboradores path")}}else console.warn("[AuthDebug] company: no codigo_empresa available on profile; preserving previous company");return}catch(R){if(console.error("[AuthDebug] loadUserProfile:unexpected error",{message:R?.message,code:R?.code,status:R?.status}),A<_.length){await S(_[A]);continue}console.error("Error loading user profile:",R);return}}}finally{h.current=!1}},w={user:t,userProfile:n,company:o,loading:l,authReady:d,signUp:async(j,_,S,C=null)=>{try{const{data:P,error:A}=await de.auth.signUp({email:j,password:_});if(A)throw A;if(P?.user&&C){const{data:R,error:O}=await de.from("empresas").select("id, codigo_empresa").eq("codigo_empresa",C).single();if(O)throw new Error("Cdigo de empresa invlido. Verifique o cdigo informado.");const{error:I}=await de.from("colaboradores").insert({id:P.user.id,codigo_empresa:R.codigo_empresa,nome:S,cargo:"user",ativo:!0});if(I)throw I}return{data:P,error:null}}catch(P){let A="No foi possvel cadastrar. Verifique os dados e tente novamente.";const R=(P?.message||"").toLowerCase();return R.includes("user already registered")||R.includes("already registered")||R.includes("user already exists")?A="Email j cadastrado. Tente entrar ou redefinir a senha.":R.includes("password")&&R.includes("length")&&(A="Senha muito curta. Use ao menos 6 caracteres."),{data:null,error:new Error(A)}}},signIn:async(j,_)=>{try{if(m){const P=GI,A=KI,R=await fetch(`${P}/rest/v1/rpc/auth_login_dev`,{method:"POST",headers:{"Content-Type":"application/json",apikey:A,Authorization:`Bearer ${A}`},body:JSON.stringify({p_email:j,p_password:_})});if(!R.ok){const D=await R.text().catch(()=>"");let U="No foi possvel entrar. Tente novamente.";return R.status===401&&(U="Email ou senha invlidos."),R.status===423&&(U="Usurio bloqueado temporariamente."),{data:null,error:new Error(U+(D?` (${D})`:""))}}const I=(await R.json())?.access_token||"",M=(()=>{try{return JSON.parse(atob(I.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"))).sub}catch{return null}})();try{localStorage.setItem("custom-auth-token",I)}catch{}return M&&(r({id:M}),u(!0),await v(M),f.current=M),{data:{user:M?{id:M}:null},error:null}}const{data:S,error:C}=await de.auth.signInWithPassword({email:j,password:_});if(C){let P="No foi possvel entrar. Tente novamente.";const A=(C.message||"").toLowerCase(),R=C.status;return A.includes("invalid login")||A.includes("invalid credentials")||R===400?P="Email ou senha invlidos.":A.includes("email not confirmed")||A.includes("not confirmed")?P="Email no confirmado. Verifique sua caixa de entrada.":R===429?P="Muitas tentativas. Aguarde alguns minutos e tente novamente.":R>=500&&(P="Servio indisponvel no momento. Tente novamente mais tarde."),{data:null,error:new Error(P)}}return S.user&&await de.from("colaboradores").select("id").eq("id",S.user.id).single(),{data:S,error:null}}catch(S){return{data:null,error:S}}},signOut:async()=>{try{localStorage.removeItem("custom-auth-token")}catch{}try{const j=de.auth.signOut({scope:"global"}),_=new Promise(S=>setTimeout(S,700));await Promise.race([j,_])}catch(j){console.warn("[AuthContext] signOut(): error during signOut",j?.message||j)}f.current=null,r(null),s(null),i(null),c(!1),u(!0);try{localStorage.removeItem("auth:userProfile"),localStorage.removeItem("auth:company"),localStorage.removeItem("clientes:list"),localStorage.removeItem("quadras:list"),localStorage.removeItem("agenda:courts"),localStorage.removeItem("agenda:selectedCourts"),localStorage.removeItem("agenda:viewFilter"),Object.keys(localStorage).filter(j=>j.startsWith("agenda:bookings:")).forEach(j=>localStorage.removeItem(j)),Object.keys(localStorage).filter(j=>j.startsWith("sb-")).forEach(j=>localStorage.removeItem(j)),Object.keys(sessionStorage).filter(j=>j.startsWith("sb-")).forEach(j=>sessionStorage.removeItem(j))}catch{}try{sessionStorage.setItem("auth:forceLogout","1")}catch{}try{window.location.replace("/")}catch{}return{error:null}},reloadCompany:async()=>{try{const j=n&&n.codigo_empresa?n.codigo_empresa:null;if(!j)return;const{data:_,error:S}=await de.from("empresas").select("*").eq("codigo_empresa",j).single();if(!S&&_){i(_);try{localStorage.setItem("auth:company",JSON.stringify(_))}catch{}}}catch{}}};return a.jsx(mY.Provider,{value:w,children:e})};function Da(e){"@babel/helpers - typeof";return Da=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Da(e)}function ho(e){if(e===null||e===!0||e===!1)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function Fn(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function ca(e){Fn(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||Da(e)==="object"&&t==="[object Date]"?new Date(e.getTime()):typeof e=="number"||t==="[object Number]"?new Date(e):((typeof e=="string"||t==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function Ta(e,t){Fn(2,arguments);var r=ca(e),n=ho(t);return isNaN(n)?new Date(NaN):(n&&r.setDate(r.getDate()+n),r)}function vu(e,t){Fn(2,arguments);var r=ca(e),n=ho(t);if(isNaN(n))return new Date(NaN);if(!n)return r;var s=r.getDate(),o=new Date(r.getTime());o.setMonth(r.getMonth()+n+1,0);var i=o.getDate();return s>=i?o:(r.setFullYear(o.getFullYear(),o.getMonth(),s),r)}function hY(e,t){Fn(2,arguments);var r=ca(e).getTime(),n=ho(t);return new Date(r+n)}var vwe={};function Kh(){return vwe}function Dd(e,t){var r,n,s,o,i,l,c,d;Fn(1,arguments);var u=Kh(),f=ho((r=(n=(s=(o=t?.weekStartsOn)!==null&&o!==void 0?o:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&s!==void 0?s:u.weekStartsOn)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&r!==void 0?r:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=ca(e),m=h.getDay(),v=(m<f?7:0)+m-f;return h.setDate(h.getDate()-v),h.setHours(0,0,0,0),h}function vg(e){return Fn(1,arguments),Dd(e,{weekStartsOn:1})}function xwe(e){Fn(1,arguments);var t=ca(e),r=t.getFullYear(),n=new Date(0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);var s=vg(n),o=new Date(0);o.setFullYear(r,0,4),o.setHours(0,0,0,0);var i=vg(o);return t.getTime()>=s.getTime()?r+1:t.getTime()>=i.getTime()?r:r-1}function ywe(e){Fn(1,arguments);var t=xwe(e),r=new Date(0);r.setFullYear(t,0,4),r.setHours(0,0,0,0);var n=vg(r);return n}function dw(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}function _s(e){Fn(1,arguments);var t=ca(e);return t.setHours(0,0,0,0),t}var bwe=864e5;function Wu(e,t){Fn(2,arguments);var r=_s(e),n=_s(t),s=r.getTime()-dw(r),o=n.getTime()-dw(n);return Math.round((s-o)/bwe)}var wwe=6e4;function q6(e,t){Fn(2,arguments);var r=ho(t);return hY(e,r*wwe)}function XI(e,t){Fn(2,arguments);var r=ho(t),n=r*7;return Ta(e,n)}function jwe(e,t){Fn(2,arguments);var r=ho(t);return vu(e,r*12)}function _we(e){Fn(1,arguments);var t;if(e&&typeof e.forEach=="function")t=e;else if(Da(e)==="object"&&e!==null)t=Array.prototype.slice.call(e);else return new Date(NaN);var r;return t.forEach(function(n){var s=ca(n);(r===void 0||r<s||isNaN(Number(s)))&&(r=s)}),r||new Date(NaN)}function Nwe(e){Fn(1,arguments);var t;if(e&&typeof e.forEach=="function")t=e;else if(Da(e)==="object"&&e!==null)t=Array.prototype.slice.call(e);else return new Date(NaN);var r;return t.forEach(function(n){var s=ca(n);(r===void 0||r>s||isNaN(s.getDate()))&&(r=s)}),r||new Date(NaN)}var pY=6e4,gY=36e5;function nl(e,t){Fn(2,arguments);var r=_s(e),n=_s(t);return r.getTime()===n.getTime()}function ND(e){return Fn(1,arguments),e instanceof Date||Da(e)==="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Swe(e){if(Fn(1,arguments),!ND(e)&&typeof e!="number")return!1;var t=ca(e);return!isNaN(Number(t))}function uw(e,t){Fn(2,arguments);var r=ca(e),n=ca(t),s=r.getFullYear()-n.getFullYear(),o=r.getMonth()-n.getMonth();return s*12+o}var Cwe=6048e5;function Pwe(e,t,r){Fn(2,arguments);var n=Dd(e,r),s=Dd(t,r),o=n.getTime()-dw(n),i=s.getTime()-dw(s);return Math.round((o-i)/Cwe)}function z6(e,t){var r=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return r<0?-1:r>0?1:r}function Awe(e,t){Fn(2,arguments);var r=ca(e),n=ca(t),s=z6(r,n),o=Math.abs(Wu(r,n));r.setDate(r.getDate()-s*o);var i=+(z6(r,n)===-s),l=s*(o-i);return l===0?0:l}function c_(e){Fn(1,arguments);var t=ca(e);return t.setHours(23,59,59,999),t}function qC(e){Fn(1,arguments);var t=ca(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function Tl(e){Fn(1,arguments);var t=ca(e);return t.setDate(1),t.setHours(0,0,0,0),t}function Ewe(e){Fn(1,arguments);var t=ca(e),r=new Date(0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function SD(e,t){var r,n,s,o,i,l,c,d;Fn(1,arguments);var u=Kh(),f=ho((r=(n=(s=(o=t?.weekStartsOn)!==null&&o!==void 0?o:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&s!==void 0?s:u.weekStartsOn)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&r!==void 0?r:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=ca(e),m=h.getDay(),v=(m<f?-7:0)+6-(m-f);return h.setDate(h.getDate()+v),h.setHours(23,59,59,999),h}function vY(e){return Fn(1,arguments),SD(e,{weekStartsOn:1})}function kwe(e,t){Fn(2,arguments);var r=ho(t);return hY(e,-r)}var Iwe=864e5;function Owe(e){Fn(1,arguments);var t=ca(e),r=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var n=t.getTime(),s=r-n;return Math.floor(s/Iwe)+1}function fN(e){Fn(1,arguments);var t=1,r=ca(e),n=r.getUTCDay(),s=(n<t?7:0)+n-t;return r.setUTCDate(r.getUTCDate()-s),r.setUTCHours(0,0,0,0),r}function xY(e){Fn(1,arguments);var t=ca(e),r=t.getUTCFullYear(),n=new Date(0);n.setUTCFullYear(r+1,0,4),n.setUTCHours(0,0,0,0);var s=fN(n),o=new Date(0);o.setUTCFullYear(r,0,4),o.setUTCHours(0,0,0,0);var i=fN(o);return t.getTime()>=s.getTime()?r+1:t.getTime()>=i.getTime()?r:r-1}function Twe(e){Fn(1,arguments);var t=xY(e),r=new Date(0);r.setUTCFullYear(t,0,4),r.setUTCHours(0,0,0,0);var n=fN(r);return n}var Dwe=6048e5;function Mwe(e){Fn(1,arguments);var t=ca(e),r=fN(t).getTime()-Twe(t).getTime();return Math.round(r/Dwe)+1}function mN(e,t){var r,n,s,o,i,l,c,d;Fn(1,arguments);var u=Kh(),f=ho((r=(n=(s=(o=t?.weekStartsOn)!==null&&o!==void 0?o:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&s!==void 0?s:u.weekStartsOn)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&r!==void 0?r:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=ca(e),m=h.getUTCDay(),v=(m<f?7:0)+m-f;return h.setUTCDate(h.getUTCDate()-v),h.setUTCHours(0,0,0,0),h}function yY(e,t){var r,n,s,o,i,l,c,d;Fn(1,arguments);var u=ca(e),f=u.getUTCFullYear(),h=Kh(),m=ho((r=(n=(s=(o=t?.firstWeekContainsDate)!==null&&o!==void 0?o:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&s!==void 0?s:h.firstWeekContainsDate)!==null&&n!==void 0?n:(c=h.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1);if(!(m>=1&&m<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var v=new Date(0);v.setUTCFullYear(f+1,0,m),v.setUTCHours(0,0,0,0);var g=mN(v,t),y=new Date(0);y.setUTCFullYear(f,0,m),y.setUTCHours(0,0,0,0);var x=mN(y,t);return u.getTime()>=g.getTime()?f+1:u.getTime()>=x.getTime()?f:f-1}function Rwe(e,t){var r,n,s,o,i,l,c,d;Fn(1,arguments);var u=Kh(),f=ho((r=(n=(s=(o=t?.firstWeekContainsDate)!==null&&o!==void 0?o:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&s!==void 0?s:u.firstWeekContainsDate)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1),h=yY(e,t),m=new Date(0);m.setUTCFullYear(h,0,f),m.setUTCHours(0,0,0,0);var v=mN(m,t);return v}var Lwe=6048e5;function Fwe(e,t){Fn(1,arguments);var r=ca(e),n=mN(r,t).getTime()-Rwe(r,t).getTime();return Math.round(n/Lwe)+1}function os(e,t){for(var r=e<0?"-":"",n=Math.abs(e).toString();n.length<t;)n="0"+n;return r+n}var $we={y:function(t,r){var n=t.getUTCFullYear(),s=n>0?n:1-n;return os(r==="yy"?s%100:s,r.length)},M:function(t,r){var n=t.getUTCMonth();return r==="M"?String(n+1):os(n+1,2)},d:function(t,r){return os(t.getUTCDate(),r.length)},a:function(t,r){var n=t.getUTCHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h:function(t,r){return os(t.getUTCHours()%12||12,r.length)},H:function(t,r){return os(t.getUTCHours(),r.length)},m:function(t,r){return os(t.getUTCMinutes(),r.length)},s:function(t,r){return os(t.getUTCSeconds(),r.length)},S:function(t,r){var n=r.length,s=t.getUTCMilliseconds(),o=Math.floor(s*Math.pow(10,n-3));return os(o,r.length)}};const Cm=$we;var cv={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Bwe={G:function(t,r,n){var s=t.getUTCFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return n.era(s,{width:"abbreviated"});case"GGGGG":return n.era(s,{width:"narrow"});case"GGGG":default:return n.era(s,{width:"wide"})}},y:function(t,r,n){if(r==="yo"){var s=t.getUTCFullYear(),o=s>0?s:1-s;return n.ordinalNumber(o,{unit:"year"})}return Cm.y(t,r)},Y:function(t,r,n,s){var o=yY(t,s),i=o>0?o:1-o;if(r==="YY"){var l=i%100;return os(l,2)}return r==="Yo"?n.ordinalNumber(i,{unit:"year"}):os(i,r.length)},R:function(t,r){var n=xY(t);return os(n,r.length)},u:function(t,r){var n=t.getUTCFullYear();return os(n,r.length)},Q:function(t,r,n){var s=Math.ceil((t.getUTCMonth()+1)/3);switch(r){case"Q":return String(s);case"QQ":return os(s,2);case"Qo":return n.ordinalNumber(s,{unit:"quarter"});case"QQQ":return n.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(s,{width:"wide",context:"formatting"})}},q:function(t,r,n){var s=Math.ceil((t.getUTCMonth()+1)/3);switch(r){case"q":return String(s);case"qq":return os(s,2);case"qo":return n.ordinalNumber(s,{unit:"quarter"});case"qqq":return n.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(s,{width:"wide",context:"standalone"})}},M:function(t,r,n){var s=t.getUTCMonth();switch(r){case"M":case"MM":return Cm.M(t,r);case"Mo":return n.ordinalNumber(s+1,{unit:"month"});case"MMM":return n.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(s,{width:"wide",context:"formatting"})}},L:function(t,r,n){var s=t.getUTCMonth();switch(r){case"L":return String(s+1);case"LL":return os(s+1,2);case"Lo":return n.ordinalNumber(s+1,{unit:"month"});case"LLL":return n.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(s,{width:"wide",context:"standalone"})}},w:function(t,r,n,s){var o=Fwe(t,s);return r==="wo"?n.ordinalNumber(o,{unit:"week"}):os(o,r.length)},I:function(t,r,n){var s=Mwe(t);return r==="Io"?n.ordinalNumber(s,{unit:"week"}):os(s,r.length)},d:function(t,r,n){return r==="do"?n.ordinalNumber(t.getUTCDate(),{unit:"date"}):Cm.d(t,r)},D:function(t,r,n){var s=Owe(t);return r==="Do"?n.ordinalNumber(s,{unit:"dayOfYear"}):os(s,r.length)},E:function(t,r,n){var s=t.getUTCDay();switch(r){case"E":case"EE":case"EEE":return n.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(s,{width:"short",context:"formatting"});case"EEEE":default:return n.day(s,{width:"wide",context:"formatting"})}},e:function(t,r,n,s){var o=t.getUTCDay(),i=(o-s.weekStartsOn+8)%7||7;switch(r){case"e":return String(i);case"ee":return os(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(o,{width:"short",context:"formatting"});case"eeee":default:return n.day(o,{width:"wide",context:"formatting"})}},c:function(t,r,n,s){var o=t.getUTCDay(),i=(o-s.weekStartsOn+8)%7||7;switch(r){case"c":return String(i);case"cc":return os(i,r.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(o,{width:"narrow",context:"standalone"});case"cccccc":return n.day(o,{width:"short",context:"standalone"});case"cccc":default:return n.day(o,{width:"wide",context:"standalone"})}},i:function(t,r,n){var s=t.getUTCDay(),o=s===0?7:s;switch(r){case"i":return String(o);case"ii":return os(o,r.length);case"io":return n.ordinalNumber(o,{unit:"day"});case"iii":return n.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(s,{width:"short",context:"formatting"});case"iiii":default:return n.day(s,{width:"wide",context:"formatting"})}},a:function(t,r,n){var s=t.getUTCHours(),o=s/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},b:function(t,r,n){var s=t.getUTCHours(),o;switch(s===12?o=cv.noon:s===0?o=cv.midnight:o=s/12>=1?"pm":"am",r){case"b":case"bb":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},B:function(t,r,n){var s=t.getUTCHours(),o;switch(s>=17?o=cv.evening:s>=12?o=cv.afternoon:s>=4?o=cv.morning:o=cv.night,r){case"B":case"BB":case"BBB":return n.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(o,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(o,{width:"wide",context:"formatting"})}},h:function(t,r,n){if(r==="ho"){var s=t.getUTCHours()%12;return s===0&&(s=12),n.ordinalNumber(s,{unit:"hour"})}return Cm.h(t,r)},H:function(t,r,n){return r==="Ho"?n.ordinalNumber(t.getUTCHours(),{unit:"hour"}):Cm.H(t,r)},K:function(t,r,n){var s=t.getUTCHours()%12;return r==="Ko"?n.ordinalNumber(s,{unit:"hour"}):os(s,r.length)},k:function(t,r,n){var s=t.getUTCHours();return s===0&&(s=24),r==="ko"?n.ordinalNumber(s,{unit:"hour"}):os(s,r.length)},m:function(t,r,n){return r==="mo"?n.ordinalNumber(t.getUTCMinutes(),{unit:"minute"}):Cm.m(t,r)},s:function(t,r,n){return r==="so"?n.ordinalNumber(t.getUTCSeconds(),{unit:"second"}):Cm.s(t,r)},S:function(t,r){return Cm.S(t,r)},X:function(t,r,n,s){var o=s._originalDate||t,i=o.getTimezoneOffset();if(i===0)return"Z";switch(r){case"X":return V6(i);case"XXXX":case"XX":return _p(i);case"XXXXX":case"XXX":default:return _p(i,":")}},x:function(t,r,n,s){var o=s._originalDate||t,i=o.getTimezoneOffset();switch(r){case"x":return V6(i);case"xxxx":case"xx":return _p(i);case"xxxxx":case"xxx":default:return _p(i,":")}},O:function(t,r,n,s){var o=s._originalDate||t,i=o.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+U6(i,":");case"OOOO":default:return"GMT"+_p(i,":")}},z:function(t,r,n,s){var o=s._originalDate||t,i=o.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+U6(i,":");case"zzzz":default:return"GMT"+_p(i,":")}},t:function(t,r,n,s){var o=s._originalDate||t,i=Math.floor(o.getTime()/1e3);return os(i,r.length)},T:function(t,r,n,s){var o=s._originalDate||t,i=o.getTime();return os(i,r.length)}};function U6(e,t){var r=e>0?"-":"+",n=Math.abs(e),s=Math.floor(n/60),o=n%60;if(o===0)return r+String(s);var i=t||"";return r+String(s)+i+os(o,2)}function V6(e,t){if(e%60===0){var r=e>0?"-":"+";return r+os(Math.abs(e)/60,2)}return _p(e,t)}function _p(e,t){var r=t||"",n=e>0?"-":"+",s=Math.abs(e),o=os(Math.floor(s/60),2),i=os(s%60,2);return n+o+r+i}const qwe=Bwe;var W6=function(t,r){switch(t){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},bY=function(t,r){switch(t){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},zwe=function(t,r){var n=t.match(/(P+)(p+)?/)||[],s=n[1],o=n[2];if(!o)return W6(t,r);var i;switch(s){case"P":i=r.dateTime({width:"short"});break;case"PP":i=r.dateTime({width:"medium"});break;case"PPP":i=r.dateTime({width:"long"});break;case"PPPP":default:i=r.dateTime({width:"full"});break}return i.replace("{{date}}",W6(s,r)).replace("{{time}}",bY(o,r))},Uwe={p:bY,P:zwe};const Vwe=Uwe;var Wwe=["D","DD"],Hwe=["YY","YYYY"];function Gwe(e){return Wwe.indexOf(e)!==-1}function Kwe(e){return Hwe.indexOf(e)!==-1}function H6(e,t,r){if(e==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var Xwe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Ywe=function(t,r,n){var s,o=Xwe[t];return typeof o=="string"?s=o:r===1?s=o.one:s=o.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+s:s+" ago":s};const Jwe=Ywe;function mx(e){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.width?String(t.width):e.defaultWidth,n=e.formats[r]||e.formats[e.defaultWidth];return n}}var Qwe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Zwe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},e1e={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},t1e={date:mx({formats:Qwe,defaultWidth:"full"}),time:mx({formats:Zwe,defaultWidth:"full"}),dateTime:mx({formats:e1e,defaultWidth:"full"})};const r1e=t1e;var n1e={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},a1e=function(t,r,n,s){return n1e[t]};const s1e=a1e;function Bu(e){return function(t,r){var n=r!=null&&r.context?String(r.context):"standalone",s;if(n==="formatting"&&e.formattingValues){var o=e.defaultFormattingWidth||e.defaultWidth,i=r!=null&&r.width?String(r.width):o;s=e.formattingValues[i]||e.formattingValues[o]}else{var l=e.defaultWidth,c=r!=null&&r.width?String(r.width):e.defaultWidth;s=e.values[c]||e.values[l]}var d=e.argumentCallback?e.argumentCallback(t):t;return s[d]}}var o1e={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},i1e={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},l1e={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},c1e={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},d1e={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},u1e={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},f1e=function(t,r){var n=Number(t),s=n%100;if(s>20||s<10)switch(s%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},m1e={ordinalNumber:f1e,era:Bu({values:o1e,defaultWidth:"wide"}),quarter:Bu({values:i1e,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:Bu({values:l1e,defaultWidth:"wide"}),day:Bu({values:c1e,defaultWidth:"wide"}),dayPeriod:Bu({values:d1e,defaultWidth:"wide",formattingValues:u1e,defaultFormattingWidth:"wide"})};const h1e=m1e;function qu(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.width,s=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],o=t.match(s);if(!o)return null;var i=o[0],l=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?g1e(l,function(f){return f.test(i)}):p1e(l,function(f){return f.test(i)}),d;d=e.valueCallback?e.valueCallback(c):c,d=r.valueCallback?r.valueCallback(d):d;var u=t.slice(i.length);return{value:d,rest:u}}}function p1e(e,t){for(var r in e)if(e.hasOwnProperty(r)&&t(e[r]))return r}function g1e(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return r}function wY(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.match(e.matchPattern);if(!n)return null;var s=n[0],o=t.match(e.parsePattern);if(!o)return null;var i=e.valueCallback?e.valueCallback(o[0]):o[0];i=r.valueCallback?r.valueCallback(i):i;var l=t.slice(s.length);return{value:i,rest:l}}}var v1e=/^(\d+)(th|st|nd|rd)?/i,x1e=/\d+/i,y1e={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},b1e={any:[/^b/i,/^(a|c)/i]},w1e={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},j1e={any:[/1/i,/2/i,/3/i,/4/i]},_1e={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},N1e={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},S1e={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},C1e={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},P1e={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},A1e={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},E1e={ordinalNumber:wY({matchPattern:v1e,parsePattern:x1e,valueCallback:function(t){return parseInt(t,10)}}),era:qu({matchPatterns:y1e,defaultMatchWidth:"wide",parsePatterns:b1e,defaultParseWidth:"any"}),quarter:qu({matchPatterns:w1e,defaultMatchWidth:"wide",parsePatterns:j1e,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:qu({matchPatterns:_1e,defaultMatchWidth:"wide",parsePatterns:N1e,defaultParseWidth:"any"}),day:qu({matchPatterns:S1e,defaultMatchWidth:"wide",parsePatterns:C1e,defaultParseWidth:"any"}),dayPeriod:qu({matchPatterns:P1e,defaultMatchWidth:"any",parsePatterns:A1e,defaultParseWidth:"any"})};const k1e=E1e;var I1e={code:"en-US",formatDistance:Jwe,formatLong:r1e,formatRelative:s1e,localize:h1e,match:k1e,options:{weekStartsOn:0,firstWeekContainsDate:1}};const jY=I1e;var O1e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,T1e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,D1e=/^'([^]*?)'?$/,M1e=/''/g,R1e=/[a-zA-Z]/;function cr(e,t,r){var n,s,o,i,l,c,d,u,f,h,m,v,g,y,x,b,w,j;Fn(2,arguments);var _=String(t),S=Kh(),C=(n=(s=r?.locale)!==null&&s!==void 0?s:S.locale)!==null&&n!==void 0?n:jY,P=ho((o=(i=(l=(c=r?.firstWeekContainsDate)!==null&&c!==void 0?c:r==null||(d=r.locale)===null||d===void 0||(u=d.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&l!==void 0?l:S.firstWeekContainsDate)!==null&&i!==void 0?i:(f=S.locale)===null||f===void 0||(h=f.options)===null||h===void 0?void 0:h.firstWeekContainsDate)!==null&&o!==void 0?o:1);if(!(P>=1&&P<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var A=ho((m=(v=(g=(y=r?.weekStartsOn)!==null&&y!==void 0?y:r==null||(x=r.locale)===null||x===void 0||(b=x.options)===null||b===void 0?void 0:b.weekStartsOn)!==null&&g!==void 0?g:S.weekStartsOn)!==null&&v!==void 0?v:(w=S.locale)===null||w===void 0||(j=w.options)===null||j===void 0?void 0:j.weekStartsOn)!==null&&m!==void 0?m:0);if(!(A>=0&&A<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!C.localize)throw new RangeError("locale must contain localize property");if(!C.formatLong)throw new RangeError("locale must contain formatLong property");var R=ca(e);if(!Swe(R))throw new RangeError("Invalid time value");var O=dw(R),I=kwe(R,O),M={firstWeekContainsDate:P,weekStartsOn:A,locale:C,_originalDate:R},D=_.match(T1e).map(function(U){var z=U[0];if(z==="p"||z==="P"){var W=Vwe[z];return W(U,C.formatLong)}return U}).join("").match(O1e).map(function(U){if(U==="''")return"'";var z=U[0];if(z==="'")return L1e(U);var W=qwe[z];if(W)return!(r!=null&&r.useAdditionalWeekYearTokens)&&Kwe(U)&&H6(U,t,String(e)),!(r!=null&&r.useAdditionalDayOfYearTokens)&&Gwe(U)&&H6(U,t,String(e)),W(I,U,C.localize,M);if(z.match(R1e))throw new RangeError("Format string contains an unescaped latin alphabet character `"+z+"`");return U}).join("");return D}function L1e(e){var t=e.match(D1e);return t?t[1].replace(M1e,"'"):e}function F1e(e){Fn(1,arguments);var t=ca(e),r=t.getFullYear(),n=t.getMonth(),s=new Date(0);return s.setFullYear(r,n+1,0),s.setHours(0,0,0,0),s.getDate()}function Iu(e){Fn(1,arguments);var t=ca(e),r=t.getHours();return r}var $1e=6048e5;function B1e(e){Fn(1,arguments);var t=ca(e),r=vg(t).getTime()-ywe(t).getTime();return Math.round(r/$1e)+1}function Ou(e){Fn(1,arguments);var t=ca(e),r=t.getMinutes();return r}function q1e(e){Fn(1,arguments);var t=ca(e),r=t.getTime();return r}function z1e(e){return Fn(1,arguments),Math.floor(q1e(e)/1e3)}function U1e(e,t){var r,n,s,o,i,l,c,d;Fn(1,arguments);var u=ca(e),f=u.getFullYear(),h=Kh(),m=ho((r=(n=(s=(o=t?.firstWeekContainsDate)!==null&&o!==void 0?o:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&s!==void 0?s:h.firstWeekContainsDate)!==null&&n!==void 0?n:(c=h.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1);if(!(m>=1&&m<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var v=new Date(0);v.setFullYear(f+1,0,m),v.setHours(0,0,0,0);var g=Dd(v,t),y=new Date(0);y.setFullYear(f,0,m),y.setHours(0,0,0,0);var x=Dd(y,t);return u.getTime()>=g.getTime()?f+1:u.getTime()>=x.getTime()?f:f-1}function V1e(e,t){var r,n,s,o,i,l,c,d;Fn(1,arguments);var u=Kh(),f=ho((r=(n=(s=(o=t?.firstWeekContainsDate)!==null&&o!==void 0?o:t==null||(i=t.locale)===null||i===void 0||(l=i.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&s!==void 0?s:u.firstWeekContainsDate)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1),h=U1e(e,t),m=new Date(0);m.setFullYear(h,0,f),m.setHours(0,0,0,0);var v=Dd(m,t);return v}var W1e=6048e5;function H1e(e,t){Fn(1,arguments);var r=ca(e),n=Dd(r,t).getTime()-V1e(r,t).getTime();return Math.round(n/W1e)+1}function G1e(e){Fn(1,arguments);var t=ca(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function K1e(e,t){return Fn(1,arguments),Pwe(G1e(e),Tl(e),t)+1}function YI(e,t){Fn(2,arguments);var r=ca(e),n=ca(t);return r.getTime()>n.getTime()}function _Y(e,t){Fn(2,arguments);var r=ca(e),n=ca(t);return r.getTime()<n.getTime()}function G6(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function X1e(e,t){if(e){if(typeof e=="string")return G6(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?G6(e,t):void 0}}function JI(e,t){return JI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},JI(e,t)}function Y1e(e,t){if(Da(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Da(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function J1e(e){var t=Y1e(e,"string");return Da(t)=="symbol"?t:t+""}function Q1e(e,t,r){return(t=J1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CD(e,t){Fn(2,arguments);var r=ca(e),n=ca(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function Z1e(e,t){Fn(2,arguments);var r=ca(e),n=ca(t);return r.getFullYear()===n.getFullYear()}function ub(e,t){Fn(2,arguments);var r=ho(t);return Ta(e,-r)}function K6(e,t){var r;Fn(1,arguments);var n=ho((r=t?.additionalDigits)!==null&&r!==void 0?r:2);if(n!==2&&n!==1&&n!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(!(typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"))return new Date(NaN);var s=n2e(e),o;if(s.date){var i=a2e(s.date,n);o=s2e(i.restDateString,i.year)}if(!o||isNaN(o.getTime()))return new Date(NaN);var l=o.getTime(),c=0,d;if(s.time&&(c=o2e(s.time),isNaN(c)))return new Date(NaN);if(s.timezone){if(d=i2e(s.timezone),isNaN(d))return new Date(NaN)}else{var u=new Date(l+c),f=new Date(0);return f.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),f.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),f}return new Date(l+c+d)}var rj={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},e2e=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,t2e=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,r2e=/^([+-])(\d{2})(?::?(\d{2}))?$/;function n2e(e){var t={},r=e.split(rj.dateTimeDelimiter),n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],rj.timeZoneDelimiter.test(t.date)&&(t.date=e.split(rj.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){var s=rj.timezone.exec(n);s?(t.time=n.replace(s[1],""),t.timezone=s[1]):t.time=n}return t}function a2e(e,t){var r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};var s=n[1]?parseInt(n[1]):null,o=n[2]?parseInt(n[2]):null;return{year:o===null?s:o*100,restDateString:e.slice((n[1]||n[2]).length)}}function s2e(e,t){if(t===null)return new Date(NaN);var r=e.match(e2e);if(!r)return new Date(NaN);var n=!!r[4],s=py(r[1]),o=py(r[2])-1,i=py(r[3]),l=py(r[4]),c=py(r[5])-1;if(n)return f2e(t,l,c)?l2e(t,l,c):new Date(NaN);var d=new Date(0);return!d2e(t,o,i)||!u2e(t,s)?new Date(NaN):(d.setUTCFullYear(t,o,Math.max(s,i)),d)}function py(e){return e?parseInt(e):1}function o2e(e){var t=e.match(t2e);if(!t)return NaN;var r=LA(t[1]),n=LA(t[2]),s=LA(t[3]);return m2e(r,n,s)?r*gY+n*pY+s*1e3:NaN}function LA(e){return e&&parseFloat(e.replace(",","."))||0}function i2e(e){if(e==="Z")return 0;var t=e.match(r2e);if(!t)return 0;var r=t[1]==="+"?-1:1,n=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;return h2e(n,s)?r*(n*gY+s*pY):NaN}function l2e(e,t,r){var n=new Date(0);n.setUTCFullYear(e,0,4);var s=n.getUTCDay()||7,o=(t-1)*7+r+1-s;return n.setUTCDate(n.getUTCDate()+o),n}var c2e=[31,null,31,30,31,30,31,31,30,31,30,31];function NY(e){return e%400===0||e%4===0&&e%100!==0}function d2e(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(c2e[t]||(NY(e)?29:28))}function u2e(e,t){return t>=1&&t<=(NY(e)?366:365)}function f2e(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function m2e(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function h2e(e,t){return t>=0&&t<=59}function FA(e,t){Fn(2,arguments);var r=ca(e),n=ho(t),s=r.getFullYear(),o=r.getDate(),i=new Date(0);i.setFullYear(s,n,15),i.setHours(0,0,0,0);var l=F1e(i);return r.setMonth(n,Math.min(o,l)),r}function nj(e,t){Fn(2,arguments);var r=ca(e),n=ho(t);return r.setHours(n),r}function aj(e,t){Fn(2,arguments);var r=ca(e),n=ho(t);return r.setMinutes(n),r}function X6(e,t){Fn(2,arguments);var r=ca(e),n=ho(t);return isNaN(r.getTime())?new Date(NaN):(r.setFullYear(n),r)}const SY=p.createContext(),p2e=({children:e})=>{const{userProfile:t}=ms(),r=$o(),[n,s]=p.useState([]),[o,i]=p.useState(!1),[l,c]=p.useState(!1),[d,u]=p.useState(!1),f=p.useRef(r.pathname),h=p.useRef(!1),m=p.useRef(null),[v,g]=p.useState(null),y=p.useRef([]),x=p.useRef(null),b=p.useRef(!1);p.useEffect(()=>{y.current=n},[n]);const w=p.useCallback(()=>`alerts:persisted:isis:${t?.codigo_empresa||"na"}`,[t?.codigo_empresa]),j=p.useCallback(()=>{try{const O=localStorage.getItem(w()),I=O?JSON.parse(O):[];return Array.isArray(I)?I.filter(M=>M&&M.tipo==="isis-event"&&M.id):[]}catch{return[]}},[w]),_=p.useCallback(O=>{try{localStorage.setItem(w(),JSON.stringify(O||[]))}catch{}},[w]),S=p.useCallback(O=>{if(!O)return;s(D=>Array.isArray(D)?D.filter(U=>U?.id!==O):[]);const M=j().filter(D=>D?.id!==O);_(M)},[j,_]),C=p.useCallback(()=>document.querySelectorAll('[role="dialog"]').length>0,[]),P=p.useCallback(async()=>{if(t?.codigo_empresa)try{u(!0);const O=t.codigo_empresa,I=new Date,M=_s(I).toISOString(),D=c_(I).toISOString(),U=[],{data:z}=await de.from("produtos").select("nome, estoque, estoque_minimo, status").eq("codigo_empresa",O).not("estoque_minimo","is",null),W=(z||[]).filter(ae=>{const le=Number(ae.estoque||0),ue=Number(ae.estoque_minimo||0);return le<=ue&&ue>0});W.length>0&&U.push({tipo:"estoque",icone:"Package",cor:"danger",mensagem:`${W.length} produto${W.length>1?"s":""} com estoque baixo`,link:"/produtos"});const{data:$}=await de.from("agendamento_participantes").select("id, agendamento_id").eq("codigo_empresa",O).eq("status_pagamento","Pendente");if($&&$.length>0){const ae=[...new Set($.map(ne=>ne.agendamento_id))],{data:le}=await de.from("agendamentos").select("id, inicio, status").in("id",ae).not("status","in","(canceled,absent)").order("inicio",{ascending:!0}),ue=new Set((le||[]).map(ne=>ne.id)),Re=$.filter(ne=>ue.has(ne.agendamento_id));if(Re.length>0){const ne=le?.[0],ie=cr(ne?new Date(ne.inicio):I,"yyyy-MM-dd");U.push({tipo:"pagamento",icone:"DollarSign",cor:"warning",mensagem:`${Re.length} pagamento${Re.length>1?"s":""} pendente${Re.length>1?"s":""} em agendamentos`,link:`/agenda?date=${ie}`})}}const X=new Date;X.setHours(X.getHours()-3);const{data:ye}=await de.from("comandas").select("id, aberto_em, status").eq("codigo_empresa",O).eq("status","open").is("fechado_em",null).lte("aberto_em",X.toISOString());ye&&ye.length>0&&U.push({tipo:"comanda",icone:"Clock",cor:"warning",mensagem:`${ye.length} comanda${ye.length>1?"s":""} aberta${ye.length>1?"s":""} h mais de 3 horas`,link:"/vendas"});const Se=new Date;Se.setHours(Se.getHours()-12);const{data:V}=await de.from("caixa_sessoes").select("id, aberto_em").eq("codigo_empresa",O).eq("status","open").lte("aberto_em",Se.toISOString()).limit(1);V&&V.length>0&&U.push({tipo:"caixa",icone:"ShoppingCart",cor:"danger",mensagem:"Caixa aberto h mais de 12 horas",link:"/vendas"});const{data:B}=await de.from("mesas").select("id, nome, numero").eq("codigo_empresa",O).eq("status","awaiting-payment");if(B&&B.length>0){const ae=B.map(ue=>ue.id),{data:le}=await de.from("comandas").select("id, mesa_id").eq("codigo_empresa",O).in("mesa_id",ae).eq("status","open");if(le&&le.length>0){const ue=le.map(gt=>gt.id),{data:Re}=await de.from("comanda_itens").select("comanda_id, quantidade, preco_unitario, desconto").in("comanda_id",ue),ne={};(Re||[]).forEach(gt=>{const bt=(Number(gt.quantidade)||0)*(Number(gt.preco_unitario)||0),at=Number(gt.desconto)||0,xt=bt-at;ne[gt.comanda_id]=(ne[gt.comanda_id]||0)+xt});const ie=Object.values(ne).filter(gt=>gt>100).length;ie>0&&U.push({tipo:"mesa",icone:"Store",cor:"info",mensagem:`${ie} mesa${ie>1?"s":""} com saldo alto aguardando pagamento`,link:"/vendas"})}}const{data:Q}=await de.from("clientes").select("id, nome, aniversario").eq("codigo_empresa",O).eq("status","Ativo").not("aniversario","is",null),pe=cr(I,"MM-dd"),te=(Q||[]).filter(ae=>ae.aniversario?cr(new Date(ae.aniversario),"MM-dd")===pe:!1);te.length>0&&U.push({tipo:"aniversario",icone:"Users",cor:"success",mensagem:` ${te.length} aniversariante${te.length>1?"s":""} hoje!`,link:"/clientes"});const Y=[];for(let ae=1;ae<=7;ae++){const le=new Date(I);le.setDate(le.getDate()+ae),Y.push(cr(le,"MM-dd"))}const ce=(Q||[]).filter(ae=>{if(!ae.aniversario)return!1;const le=cr(new Date(ae.aniversario),"MM-dd");return Y.includes(le)});ce.length>0&&U.push({tipo:"aniversario-semana",icone:"CalendarPlus",cor:"purple",mensagem:` ${ce.length} aniversariante${ce.length>1?"s":""} esta semana`,link:"/clientes"});const me=j();s([...me,...U]);try{if(!h.current&&!b.current&&U.length>0&&typeof document<"u"&&document.visibilityState==="visible"&&!C()){const le=(()=>{try{return typeof window<"u"&&window.innerWidth<768}catch{return!1}})(),ue=(()=>{try{return!!document.querySelector('button[aria-label="Fechar menu lateral"]')}catch{return!1}})();if(le&&ue){try{x.current&&clearInterval(x.current)}catch{}x.current=setInterval(()=>{try{if(h.current){clearInterval(x.current),x.current=null;return}if(!!!document.querySelector('button[aria-label="Fechar menu lateral"]')&&!C()){c(!0),h.current=!0;try{m.current&&clearTimeout(m.current)}catch{}m.current=setTimeout(()=>{c(!1)},3500),clearInterval(x.current),x.current=null}}catch{}},250)}else setTimeout(()=>{if(!h.current){if(C()){h.current=!0;return}c(!0),h.current=!0;try{m.current&&clearTimeout(m.current)}catch{}m.current=setTimeout(()=>{c(!1)},3500)}},350)}}catch{}}catch(O){console.error("[AlertsContext] Erro ao carregar alertas:",O)}finally{u(!1)}},[t?.codigo_empresa]);p.useEffect(()=>{if(o){h.current=!0,b.current=!0,c(!1);try{x.current&&(clearInterval(x.current),x.current=null)}catch{}}else c(!1)},[o]),p.useEffect(()=>()=>{try{m.current&&clearTimeout(m.current)}catch{}try{x.current&&clearInterval(x.current)}catch{}},[]);const A=p.useCallback(()=>{try{m.current&&clearTimeout(m.current)}catch{}c(!1),g(null)},[]),R=p.useCallback(()=>{s(O=>Array.isArray(O)?O.filter(I=>I?.tipo!=="isis-event"):[]);try{_([])}catch{}try{A()}catch{}},[_,A]);return p.useEffect(()=>{if(!t?.codigo_empresa)return;const O=t.codigo_empresa,I=de.channel(`isis-events:${O}`).on("postgres_changes",{event:"*",schema:"public",table:"agendamentos",filter:`codigo_empresa=eq.${O}`},M=>{try{const{eventType:D,new:U,old:z}=M||{};if(!(U||z))return;const $=U?.created_by_isis===!0||z?.created_by_isis===!0,X=U?.canceled_by==="isis"||z?.canceled_by==="isis";if(!$&&!X||C())return;const ye=U?.inicio||z?.inicio;let Se="";try{if(ye){const pe=new Date(ye);Se=`/agenda?date=${`${pe.getFullYear()}-${String(pe.getMonth()+1).padStart(2,"0")}-${String(pe.getDate()).padStart(2,"0")}`}`}}catch{}let V="";if(D==="INSERT"){if(!$)return;V="sis criou um agendamento"}else if(D==="UPDATE")if(z?.status!=="canceled"&&U?.status==="canceled"&&U?.canceled_by==="isis")V="sis cancelou um agendamento";else return;else if(D==="DELETE")if(z?.canceled_by==="isis")V="sis cancelou um agendamento";else return;else return;const B=`isis-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,Q={id:B,tipo:"isis-event",icone:"AlertTriangle",cor:"warning",mensagem:V,link:"/isis/analytics",createdAt:new Date().toISOString()};s(pe=>[Q,...Array.isArray(pe)?pe:[]]);try{const pe=j(),te=[Q,...pe.filter(Y=>Y.id!==B)];_(te)}catch{}g({id:B,message:V,link:Se}),c(!0);try{m.current&&clearTimeout(m.current)}catch{}m.current=setTimeout(()=>{A()},5e3);try{s(pe=>Array.isArray(pe)?pe:[])}catch{}}catch(D){console.warn("[AlertsContext] erro ao processar evento isis:",D)}}).subscribe();return()=>{try{de.removeChannel(I)}catch{}}},[t?.codigo_empresa,C,A]),p.useEffect(()=>{if(t?.codigo_empresa){P();const O=setInterval(()=>{P()},5*60*1e3);return()=>clearInterval(O)}},[t?.codigo_empresa,P]),p.useEffect(()=>{if(!t?.codigo_empresa)return;const O=()=>{if(document.visibilityState==="visible"){if(C())return;P()}},I=()=>{C()||P()};return document.addEventListener("visibilitychange",O),window.addEventListener("focus",I),()=>{document.removeEventListener("visibilitychange",O),window.removeEventListener("focus",I)}},[t?.codigo_empresa,P,C]),p.useEffect(()=>{if(t?.codigo_empresa){if(f.current===r.pathname)return;if(f.current=r.pathname,C()){console.log("[AlertsContext] Mudana de rota detectada, mas h modais abertos - ignorando recarga");return}console.log("[AlertsContext] Mudana de rota detectada - recarregando alertas"),P()}},[r.pathname,t?.codigo_empresa,P,C]),a.jsx(SY.Provider,{value:{alerts:n,setAlerts:s,showModal:o,setShowModal:i,showBalloon:l,setShowBalloon:c,eventBalloon:v,setEventBalloon:g,closeBalloon:A,dismissAlert:S,clearIsisAlerts:R,loading:d,loadAlerts:P},children:e})},E1=()=>{const e=p.useContext(SY);if(!e)throw new Error("useAlerts must be used within AlertsProvider");return e};function g2e({onToggleSidebar:e,sidebarVisible:t,sidebarPinned:r}){const{toast:n}=Qa(),{signOut:s,userProfile:o,company:i,user:l}=ms(),{alerts:c,setAlerts:d,showModal:u,setShowModal:f,showBalloon:h,setShowBalloon:m,eventBalloon:v,closeBalloon:g,dismissAlert:y}=E1(),x=zi(),b=o?.nome||"Usurio",w=Pe.useMemo(()=>{const X=b.trim().split(/\s+/);return X.length>=2?`${X[0]} ${X[1]}`:b},[b]),j=o?.cargo||o?.papel||"";let _="";try{const X=localStorage.getItem("auth:company");if(X){const ye=JSON.parse(X);_=ye?.nome_fantasia||ye?.razao_social||ye?.nome||ye?.codigoEmpresa||"";var S=ye?.logo_url||""}}catch{}const C=i?.nome_fantasia||i?.razao_social||i?.nome||i?.codigoEmpresa||_||"Empresa no vinculada",P=i?.logo_url||(typeof S<"u"?S:""),A=Pe.useMemo(()=>i?.logo_url?`${i.logo_url}?v=${Date.now()}`:P||"",[i?.logo_url]),R=Pe.useMemo(()=>{try{return typeof window<"u"&&String(window.__ACTIVE_TARGET||"").toLowerCase()==="dev"}catch{return!1}},[]),O=X=>({Package:Td,DollarSign:ei,CalendarCheck:pC,Clock:Pd,ShoppingCart:y1,Store:C4,Users:Pl,CalendarPlus:N4,AlertTriangle:Xf,Info:JH})[X]||Xf,I=X=>({danger:"text-danger",warning:"text-warning",info:"text-info",success:"text-success",purple:"text-purple"})[X]||"text-warning",M=({alert:X,onClick:ye})=>{const Se=O(X.icone),V=I(X.cor),B=X?.tipo==="isis-event";return a.jsxs("li",{className:"flex items-center gap-2 p-2 rounded-md hover:bg-white/5 transition-colors cursor-pointer group",onClick:ye,children:[B?a.jsx("span",{className:"rounded-full overflow-hidden bg-background w-5 h-5 flex items-center justify-center flex-shrink-0 shadow-[0_0_0_2px_rgba(0,0,0,0.25)]",children:a.jsx(gi,{size:"xs",className:"w-5 h-5"})}):a.jsx(Se,{className:`w-4 h-4 flex-shrink-0 ${V}`}),a.jsx("span",{className:"text-text-secondary group-hover:text-text-primary transition-colors flex-1",children:X.mensagem}),X.link&&a.jsx(w4,{className:"w-3 h-3 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]})},D=async()=>{console.log("[Header] Logout button clicked",{at:new Date().toISOString(),userBefore:!!l});const{error:X}=await s();console.log("[Header] Logout completed",{error:X,userAfter:!!l}),n(X?{title:"Erro ao sair",description:"Ocorreu um erro ao fazer logout. Tente novamente.",variant:"destructive"}:{title:"Logout realizado",description:"Voc foi desconectado com sucesso.",variant:"default"})};new Date().toLocaleDateString("pt-BR",{day:"2-digit",month:"long",year:"numeric"});const U=$o(),z=Pe.useMemo(()=>{try{const X=String(U?.pathname||"");if(X==="/"||X.startsWith("/dashboard"))return"";const Se=[{key:"/agenda",label:"Agenda"},{key:"/isis",label:"sis"},{key:"/clientes",label:"Clientes & Fornecedores"},{key:"/produtos",label:"Produtos"},{key:"/vendas",label:"Vendas"},{key:"/financeiro",label:"Financeiro"},{key:"/balcao",label:"Balco"},{key:"/cadastros",label:"Cadastros"},{key:"/quadras",label:"Quadras"},{key:"/equipe",label:"Equipe"},{key:"/finalizadoras",label:"Finalizadoras"},{key:"/empresas",label:"Empresas"},{key:"/configuracoes",label:"Configuraes"},{key:"/login",label:"Login"}].find(V=>X.startsWith(V.key));if(Se)return Se.label;if(typeof document<"u"){const V=String(document.title||"");return(V.includes(" - ")?V.split(" - ")[0]:V)||""}}catch{}return""},[U?.pathname]),W=Pe.useMemo(()=>String(U?.pathname||"").startsWith("/isis"),[U?.pathname]),$=Pe.useMemo(()=>{const X=i?.nome_fantasia||i?.nome||i?.razao_social||i?.codigoEmpresa||_||"";return String(X).toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"").trim()},[i?.nome_fantasia,i?.nome,i?.razao_social,i?.codigoEmpresa,_]);return Pe.useMemo(()=>$?`https://${$}.f7arena.com`:"",[$]),a.jsxs(xr.header,{animate:{opacity:1,y:0},transition:{duration:.6,ease:[.22,1,.36,1]},className:"relative bg-surface/80 backdrop-blur-sm text-text-primary h-14 md:h-[72px] flex-shrink-0 flex items-center justify-between px-3 md:px-8 border-b border-border shadow-[0_1px_0_RGBA(255,255,255,0.04)]",children:[a.jsxs("div",{className:"flex items-center gap-2 md:gap-4 min-w-0 flex-1",children:[a.jsx(fe,{variant:"ghost",size:"icon",onClick:e,"aria-label":t?"Ocultar barra lateral":"Mostrar barra lateral",className:"h-10 w-10 md:h-12 md:w-12 hover:bg-surface-2/60 transition-colors",children:a.jsx(Lue,{className:`w-6 h-6 md:w-7 md:h-7 transition-colors ${t?"text-brand":"text-text-primary"}`})}),a.jsxs("div",{className:"group mx-auto md:mx-0 pl-2 pr-3 md:pl-3 md:pr-5 py-1 md:py-1.5 border border-white/10 bg-gradient-to-b from-surface-2/60 to-surface/60 text-text-primary flex items-center gap-2 md:gap-4 shadow-sm hover:border-white/20 transition-colors overflow-hidden max-w-[60vw] md:max-w-[30vw] lg:max-w-[24vw]",title:C,children:[a.jsx("div",{className:"relative w-9 h-9 md:w-11 md:h-11 shrink-0 overflow-hidden border border-white/10 bg-surface-2/60 grid place-items-center shadow-[0_0_0_3px_RGBA(0,0,0,0.2)]",children:A?a.jsx("img",{src:A,alt:"Logo",className:"w-full h-full object-cover"}):a.jsx(xue,{className:"w-6 h-6 opacity-80"})}),a.jsx("span",{className:"tracking-tight truncate text-base leading-8 md:text-base md:leading-[44px] text-text-primary font-semibold flex-1 min-w-0 text-center md:text-left",children:C}),R&&a.jsx("span",{className:"ml-2 hidden md:inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-extrabold uppercase tracking-wider bg-red-600 text-white shadow animate-pulse",children:"Dev"})]})]}),W?a.jsx("div",{className:"pointer-events-none absolute z-10 left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 hidden md:block",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"rounded-full p-[2px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400 shadow-[0_0_12px_rgba(168,85,247,0.35)] w-8 h-8",children:a.jsx("div",{className:"rounded-full overflow-hidden bg-background w-full h-full",children:a.jsx(gi,{size:"xs",className:"w-8 h-8"})})}),a.jsx("h1",{className:"text-lg md:text-xl font-bold tracking-tight text-text-primary",children:"sis"})]})}):z?a.jsx("div",{className:"pointer-events-none absolute z-10 left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 hidden md:block",children:a.jsx("h1",{className:"text-lg md:text-xl font-bold tracking-tight text-text-primary",children:z})}):null,a.jsxs("div",{className:"flex items-center gap-1 md:gap-2",children:[!W&&a.jsxs(fe,{variant:"ghost",onClick:()=>x("/isis"),className:"hidden md:inline-flex items-center gap-2 px-2.5 py-1.5 rounded-full border border-white/10 bg-surface/60 hover:bg-surface-2/70 hover:border-white/20 transition-all duration-200 hover:-translate-y-px hover:shadow-[0_4px_16px_rgba(0,0,0,0.25)]",children:[a.jsx("span",{className:"inline-flex items-center justify-center rounded-full p-[2px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400",children:a.jsx("span",{className:"rounded-full overflow-hidden bg-background",children:a.jsx(gi,{size:"xs"})})}),a.jsx("span",{className:"text-sm font-semibold text-text-primary",children:"sis"})]}),a.jsxs(vi,{open:u?!1:h,onOpenChange:m,children:[a.jsx(xi,{asChild:!0,children:a.jsxs(fe,{variant:"ghost",size:"icon",onClick:()=>{m(!1),f(!0)},className:"relative text-text-secondary hover:text-text-primary transition-colors duration-200",children:[a.jsx(rb,{className:"h-5 w-5"}),c.length>0&&a.jsx("span",{className:"absolute -top-1 -right-1 bg-danger text-white text-[10px] font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse",children:c.length})]})}),a.jsxs(ni,{align:"end",sideOffset:8,className:"w-80 p-0 overflow-hidden bg-background border-white/10",children:[a.jsxs("div",{className:"p-3 border-b border-border flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(rb,{className:"h-4 w-4 text-brand"}),a.jsx("span",{className:"text-sm font-semibold",children:v?"Notificao":"Alertas"})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[!v&&a.jsx(fe,{size:"sm",variant:"ghost",onClick:()=>{m(!1),f(!0)},children:"Ver todos"}),a.jsx(fe,{size:"icon",variant:"ghost",onClick:()=>{v?g():m(!1)},"aria-label":"Fechar",children:a.jsx(al,{className:"h-4 w-4"})})]})]}),a.jsx("div",{className:"p-2",children:v?a.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-md bg-surface-2",children:[a.jsx("span",{className:"rounded-full overflow-hidden bg-background",children:a.jsx(gi,{size:"xs"})}),a.jsx("span",{className:"text-sm text-text-secondary flex-1",children:v.message}),a.jsx(fe,{size:"sm",variant:"ghost",className:"shrink-0",onClick:()=>{x("/isis/analytics");try{v?.id&&y(v.id)}catch{}g()},children:"Ver"})]}):c.length===0?a.jsx("p",{className:"text-sm text-text-muted text-center py-6",children:"Nenhum alerta no momento"}):a.jsx("ul",{className:"space-y-1 text-sm",children:c.slice(0,3).map((X,ye)=>a.jsx(M,{alert:X,onClick:()=>{if(X.link&&x(X.link),X?.tipo==="isis-event"&&X?.id)try{y(X.id)}catch{}m(!1)}},ye))})})]})]}),a.jsx(fe,{variant:"ghost",size:"icon",onClick:D,className:"text-text-secondary hover:text-brand hover:bg-brand/10 transition-colors duration-200 shrink-0",children:a.jsx(Rue,{className:"h-5 w-5"})}),a.jsx("div",{className:"hidden md:block w-px h-8 bg-border mx-1 md:mx-2"}),a.jsxs("div",{className:"hidden md:flex group pl-2 pr-3 md:pl-4 md:pr-4 py-1.5 rounded-full border border-white/10 bg-gradient-to-b from-surface-2/60 to-surface/60 text-text-primary items-center gap-2 md:gap-3 shadow-sm hover:border-white/20 transition-colors",title:`${w}  ${j}`,children:[a.jsx("span",{className:"text-xs md:text-sm font-semibold truncate max-w-[120px] md:max-w-[180px]",children:w}),a.jsx("span",{className:"text-[10px] md:text-[11px] px-1.5 md:px-2 py-0.5 rounded-full bg-brand/15 text-brand font-medium tracking-wide",children:j})]})]}),a.jsx(mn,{open:u,onOpenChange:f,children:a.jsxs(un,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[a.jsx(on,{children:a.jsxs(an,{className:"flex items-center gap-2",children:[a.jsx(rb,{className:"h-5 w-5 text-brand"}),"Todos os Alertas (",c.length,")"]})}),a.jsx("div",{className:"mt-4",children:c.length===0?a.jsx("p",{className:"text-sm text-text-muted text-center py-8",children:"Nenhum alerta no momento! "}):a.jsx("ul",{className:"space-y-2 text-sm",children:c.map((X,ye)=>a.jsx(M,{alert:X,onClick:()=>{if(X.link&&(x(X.link),f(!1)),X?.tipo==="isis-event"&&X?.id)try{y(X.id)}catch{}}},ye))})})]})})]})}const rt=Pe.forwardRef(({className:e,type:t,...r},n)=>a.jsx("input",{type:t,className:pr("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...r}));rt.displayName="Input";var v2e="Label",CY=p.forwardRef((e,t)=>a.jsx(ta.label,{...e,ref:t,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(e.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));CY.displayName=v2e;var PY=CY;const x2e=Y4("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),qe=Pe.forwardRef(({className:e,...t},r)=>a.jsx(PY,{ref:r,className:pr(x2e(),e),...t}));qe.displayName=PY.displayName;const y2e=e=>{const t={"Invalid login credentials":"Email ou senha incorretos","Email not confirmed":"Email no confirmado","User not found":"Usurio no encontrado","Invalid email":"Email invlido","Password should be at least 6 characters":"A senha deve ter pelo menos 6 caracteres","Unable to validate email address: invalid format":"Formato de email invlido","Email rate limit exceeded":"Muitas tentativas. Aguarde alguns minutos","Network request failed":"Erro de conexo. Verifique sua internet","Failed to fetch":"Erro de conexo. Verifique sua internet"};if(t[e])return t[e];for(const[r,n]of Object.entries(t))if(e.includes(r))return n;return"Erro ao fazer login. Verifique suas credenciais e tente novamente."},b2e=()=>{const[e,t]=p.useState(!1),[r,n]=p.useState(!1),[s,o]=p.useState(""),[i,l]=p.useState({email:"",password:""}),{signIn:c,user:d,authReady:u}=ms(),{toast:f}=Qa();p.useEffect(()=>{if(u&&d)try{const y=sessionStorage.getItem("auth:returnUrl");sessionStorage.removeItem("auth:returnUrl");const x=y||"/";console.log("[LoginPage] Redirecionando para:",x),window.location.replace(x)}catch{}},[u,!!d]);const h=y=>{l({...i,[y.target.name]:y.target.value}),s&&o("")},m=async y=>{y.preventDefault(),n(!0),o("");try{const x=await c(i.email,i.password);if(x.error)throw x.error;f({title:"Login realizado!",description:"Bem-vindo de volta!",variant:"default"});try{const b=sessionStorage.getItem("auth:returnUrl");sessionStorage.removeItem("auth:returnUrl");const w=b||"/";console.log("[LoginPage] Redirecionando aps login para:",w),window.location.replace(w)}catch{}}catch(x){const b=x.message||"Ocorreu um erro. Tente novamente.",w=y2e(b);o(w),f({title:"Erro",description:w,variant:"destructive"})}finally{n(!1)}},v={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.6,ease:[.22,1,.36,1]}}},g=(()=>{try{return typeof window<"u"&&String(window.__ACTIVE_TARGET||"").toLowerCase()==="dev"}catch{return!1}})();return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"min-h-screen bg-background flex items-center justify-center p-4 sm:p-6 relative",children:[g&&a.jsx("div",{className:"pointer-events-none select-none absolute top-4 right-4 z-20",children:a.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-extrabold uppercase tracking-wider bg-red-600 text-white shadow animate-pulse",children:"Dev"})}),a.jsx("div",{className:"absolute inset-0 bg-court-pattern opacity-[0.02] mix-blend-overlay"}),a.jsxs(xr.div,{variants:v,initial:"hidden",animate:"visible",className:"relative z-10 w-full max-w-md pb-20 sm:pb-0",children:[a.jsxs("div",{className:"fx-card",children:[a.jsx("div",{className:"text-center mb-6",children:a.jsxs("div",{className:"flex items-center justify-center mb-4",children:[a.jsx("div",{className:"w-16 h-16 bg-brand rounded-xl flex items-center justify-center mr-4",children:a.jsx(Dc,{className:"w-8 h-8 text-primary-foreground"})}),a.jsxs("div",{children:[a.jsxs("h1",{className:"text-5xl font-extrabold",children:[a.jsx("span",{style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{style:{color:"#FFAA33"},children:"7"})]}),a.jsx("p",{className:"text-2xl font-semibold",style:{color:"#B0B0B0"},children:"Arena"})]})]})}),a.jsxs("form",{onSubmit:m,className:"space-y-5 sm:space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs(qe,{htmlFor:"email",className:"text-text-primary flex items-center gap-2 text-sm sm:text-base",children:[a.jsx(Ox,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Email"]}),a.jsx(rt,{id:"email",name:"email",type:"email",placeholder:"seu@email.com",value:i.email,onChange:h,required:!0,className:"placeholder:text-[#B0B0B0] h-12 sm:h-10 text-base sm:text-sm"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(qe,{htmlFor:"password",className:"text-text-primary flex items-center gap-2 text-sm sm:text-base",children:[a.jsx(Ix,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Senha"]}),a.jsxs("div",{className:"relative",children:[a.jsx(rt,{id:"password",name:"password",type:e?"text":"password",placeholder:"Sua senha",value:i.password,onChange:h,required:!0,className:"pr-10 placeholder:text-[#B0B0B0] h-12 sm:h-10 text-base sm:text-sm"}),a.jsx("button",{type:"button",onClick:()=>t(!e),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-muted hover:text-text-primary transition-colors",children:e?a.jsx(Yp,{className:"w-5 h-5 sm:w-4 sm:h-4"}):a.jsx(hg,{className:"w-5 h-5 sm:w-4 sm:h-4"})})]})]}),s&&a.jsx(xr.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"p-3 rounded-lg bg-destructive/10 border border-destructive/30 text-destructive text-sm",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-base",children:""}),a.jsx("span",{className:"flex-1",children:s})]})}),a.jsx(fe,{type:"submit",className:"w-full h-12 sm:h-10 text-base sm:text-sm",disabled:r,children:r?a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-4 h-4 border-2 border-primary-foreground border-t-transparent rounded-full animate-spin"}),"Entrando..."]}):a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Mue,{className:"w-4 h-4"}),"Entrar"]})})]})]}),a.jsx("p",{className:"mt-4 text-center text-xs text-text-muted opacity-70",children:" 2025 Fluxo7 Arena  Todos os direitos reservados."})]})]})})},Y6=({children:e})=>{const{user:t,authReady:r}=ms(),n=$o();return p.useEffect(()=>{if(r&&!t&&n.pathname!=="/login")try{sessionStorage.setItem("auth:returnUrl",n.pathname+n.search),console.log("[ProtectedRoute] Salvando rota de retorno:",n.pathname+n.search)}catch(s){console.warn("[ProtectedRoute] Erro ao salvar rota de retorno:",s)}},[r,t,n.pathname,n.search]),r?t?e:a.jsx(b2e,{}):a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 border-4 border-brand border-t-transparent rounded-full animate-spin"}),a.jsx("span",{className:"text-text-primary font-medium",children:"Carregando..."})]})})},w2e=p.createContext(),j2e=({children:e})=>{const[t,r]=p.useState({payment:{open:!1,data:null},editParticipant:{open:!1,data:null}}),[n,s]=p.useState(new Set),o=p.useCallback((f,h=null)=>{console.log(" [MODALS] Abrindo modal:",f,h),r(m=>({...m,[f]:{open:!0,data:h}}))},[]),i=p.useCallback(f=>{if(n.has(f)){console.log(` [ModalsContext] Modal "${f}" est protegido, ignorando fechamento`);return}r(h=>({...h,[f]:{open:!1,data:{}}}))},[n]),l=p.useCallback(f=>t[f]?.open||!1,[t]),c=p.useCallback(f=>t[f]?.data||{},[t]),d=p.useCallback(f=>{console.log(` [ModalsContext] Protegendo modal "${f}"`),s(h=>new Set([...h,f]))},[]),u=p.useCallback(f=>{console.log(` [ModalsContext] Desprotegendo modal "${f}"`),s(h=>{const m=new Set(h);return m.delete(f),m})},[]);return a.jsx(w2e.Provider,{value:{openModal:o,closeModal:i,isModalOpen:l,getModalData:c,protectModal:d,unprotectModal:u},children:e})},AY=p.createContext(),hN=()=>{const e=p.useContext(AY);if(!e)throw new Error("useAgenda must be used within AgendaProvider");return e},_2e=({children:e})=>{const[t,r]=p.useState(!1),[n,s]=p.useState(!1),[o,i]=p.useState(!1),[l,c]=p.useState({participantId:null,participantName:""}),[d,u]=p.useState(null),[f,h]=p.useState([]),[m,v]=p.useState(""),[g,y]=p.useState([]),[x,b]=p.useState(null),[w,j]=p.useState([]),_=p.useRef({isProtected:!1,protectedUntil:0}),S=p.useRef(Date.now()),C=p.useRef(null),P=$o(),A=p.useCallback((z=2e3)=>{const W=Date.now()+z;if(W>_.current.protectedUntil)_.current.isProtected=!0,_.current.protectedUntil=W;else return;setTimeout(()=>{Date.now()>=_.current.protectedUntil&&(_.current.isProtected=!1)},z)},[]),R=p.useCallback(()=>{_.current.isProtected=!1,_.current.protectedUntil=0},[]),O=p.useCallback(()=>{r(!0)},[]),I=p.useCallback((z={})=>{const W=z===!0||z&&z.force===!0,$=Date.now();if(W)return r(!1),!0;if(_.current.isProtected&&$<_.current.protectedUntil){const ye=_.current.protectedUntil-$;try{localStorage.getItem("debug:agenda")==="1"&&console.log(` [PaymentModal] Fechamento bloqueado por proteo (${ye}ms restantes)`)}catch{}return!1}if(Date.now()-S.current<500){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Fechamento bloqueado por mudana de visibilidade recente")}catch{}return!1}try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Fechando modal (no protegido)")}catch{}return r(!1),!0},[]),M=p.useCallback((z,W)=>{c({participantId:z,participantName:W}),s(!0),A(3e3)},[A]),D=p.useCallback(()=>{s(!1),c({participantId:null,participantName:""})},[]);p.useEffect(()=>{if(!(P?.pathname||"").startsWith("/agenda"))return()=>{};const $=()=>{const ye=Date.now(),Se=document.hidden;try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [AgendaContext] visibilitychange:",{hidden:Se,timestamp:new Date().toISOString(),isPaymentModalOpen:t})}catch{}if(S.current=ye,!Se&&t){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [AgendaContext] Aba restaurada com modal aberto - protegendo por 3s")}catch{}const V=Date.now()+3e3;_.current.isProtected=!0,_.current.protectedUntil=V}},X=()=>{const ye=Date.now();try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [AgendaContext] window focus:",{timestamp:new Date().toISOString(),isPaymentModalOpen:t})}catch{}if(S.current=ye,t){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [AgendaContext] Janela ganhou foco com modal aberto - protegendo por 3s")}catch{}const Se=Date.now()+3e3;_.current.isProtected=!0,_.current.protectedUntil=Se}};return document.addEventListener("visibilitychange",$),window.addEventListener("focus",X),()=>{document.removeEventListener("visibilitychange",$),window.removeEventListener("focus",X)}},[t,P?.pathname]);const U={isPaymentModalOpen:t,isEditParticipantModalOpen:n,isAddBookingModalOpen:o,openPaymentModal:O,closePaymentModal:I,openEditParticipantModal:M,closeEditParticipantModal:D,setIsAddBookingModalOpen:i,editParticipantData:l,editingBooking:d,setEditingBooking:u,participantsForm:f,setParticipantsForm:h,paymentTotal:m,setPaymentTotal:v,payMethods:g,setPayMethods:y,bookingForm:x,setBookingForm:b,localCustomers:w,setLocalCustomers:j,protectPaymentModal:A,unprotectPaymentModal:R,onParticipantReplacedRef:C,get lastVisibilityChangeTime(){return S.current},get isModalProtected(){const z=Date.now();return _.current.isProtected&&z<_.current.protectedUntil}};return a.jsx(AY.Provider,{value:U,children:e})},N2e="https://guildthlqkfubbqoybys.supabase.co",J6="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd1aWxkdGhscWtmdWJicW95YnlzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU3NTY2NjksImV4cCI6MjA4MTMzMjY2OX0.9--rqgkuDVLiwhU93RLV1YwEYVW6aRe9Qf5Mh80aVCg",S2e=()=>({apikey:J6,Authorization:`Bearer ${J6}`,"Content-Type":"application/json","X-Client-Info":"fluxo7-isis-web"}),Q6=async(e,{method:t="GET",body:r}={})=>{const n=`${N2e}${e}`,s=await fetch(n,{method:t,headers:S2e(),body:r?JSON.stringify(r):void 0}),o=await s.text().catch(()=>""),i=o&&JSON.parse(o)||null;return s.ok?{data:i,error:null}:{data:null,error:{status:s.status,message:i?.message||o||`HTTP ${s.status}`,details:i?.details??null,hint:i?.hint??null,code:i?.code??null}}};class C2e{constructor(t){this.table=t,this._select="*",this._filters=[],this._order=null}select(t){return this._select=t||"*",this}eq(t,r){return this._filters.push([t,"eq",r]),this}is(t,r){return this._filters.push([t,"is",r]),this}order(t,{ascending:r}={}){return this._order={column:t,ascending:r!==!1},this}async insert(t){return Q6(`/rest/v1/${this.table}`,{method:"POST",body:t})}async then(t,r){const n=new URLSearchParams;n.set("select",this._select);for(const[o,i,l]of this._filters)i==="is"&&l===null?n.set(o,"is.null"):n.set(o,`${i}.${l}`);this._order?.column&&n.set("order",`${this._order.column}.${this._order.ascending?"asc":"desc"}`);const s=await Q6(`/rest/v1/${this.table}?${n.toString()}`,{method:"GET"});return Promise.resolve(s).then(t,r)}}const EY={from(e){return new C2e(e)}},kY=p.createContext(),zC=()=>{const e=p.useContext(kY);if(!e)throw new Error("useIsis deve ser usado dentro de IsisProvider");return e},IY=({children:e})=>{const[t,r]=p.useState("greeting"),[n,s]=p.useState([]),o=p.useRef((()=>{try{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();const le=[...Array(36)].map(()=>"x");return le[8]=le[13]=le[18]=le[23]="-",le[14]="4",le.map((ue,Re)=>{if(ue!=="x")return ue;const ne=Math.random()*16|0;return(Re===19?ne&3|8:ne).toString(16)}).join("")}catch{return"00000000-0000-4000-8000-000000000000"}})()),[i,l]=p.useState(o.current),[c,d]=p.useState({empresa:null,quadra:null,data:null,horario:null,modalidade:null,quantidade:null,nomes:[],contato:{nome:"",telefone:""}}),[u,f]=p.useState(!1),[h,m]=p.useState(!1),v=p.useRef(null),y=[["VITE_KEY_CHAT_ISIS",{}.VITE_KEY_CHAT_ISIS],["VITE-KEY-CHAT-ISIS",{VITE_JSONBIN_BIN_ID:"690605e5ae596e708f3c7bc5",VITE_JSONBIN_ISIS_BIN_ID:"6939b808ae596e708f90b843",VITE_JSONBIN_API_KEY:"$/XmOGvx8./SZzV3qMzQ5i.6FjBjS4toNbeaEFzX2D8QPUddyM6VR2",VITE_SUPABASE_URL:"https://dlfryxtyxqoacuunswuc.supabase.co",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsZnJ5eHR5eHFvYWN1dW5zd3VjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4ODg0MzcsImV4cCI6MjA3MTQ2NDQzN30.AizQBbCE1p_xfAQ9T0Eha1anGzcFETcc__8AV4iaQTY",VITE_SUPABASE_URL_ISIS:"https://guildthlqkfubbqoybys.supabase.co",VITE_SUPABASE_ANON_KEY_ISIS:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd1aWxkdGhscWtmdWJicW95YnlzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU3NTY2NjksImV4cCI6MjA4MTMzMjY2OX0.9--rqgkuDVLiwhU93RLV1YwEYVW6aRe9Qf5Mh80aVCg",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}["VITE-KEY-CHAT-ISIS"]],["KEY_CHAT_ISIS",{}.KEY_CHAT_ISIS],["KEY-CHAT-ISIS",{VITE_JSONBIN_BIN_ID:"690605e5ae596e708f3c7bc5",VITE_JSONBIN_ISIS_BIN_ID:"6939b808ae596e708f90b843",VITE_JSONBIN_API_KEY:"$/XmOGvx8./SZzV3qMzQ5i.6FjBjS4toNbeaEFzX2D8QPUddyM6VR2",VITE_SUPABASE_URL:"https://dlfryxtyxqoacuunswuc.supabase.co",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsZnJ5eHR5eHFvYWN1dW5zd3VjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4ODg0MzcsImV4cCI6MjA3MTQ2NDQzN30.AizQBbCE1p_xfAQ9T0Eha1anGzcFETcc__8AV4iaQTY",VITE_SUPABASE_URL_ISIS:"https://guildthlqkfubbqoybys.supabase.co",VITE_SUPABASE_ANON_KEY_ISIS:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd1aWxkdGhscWtmdWJicW95YnlzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU3NTY2NjksImV4cCI6MjA4MTMzMjY2OX0.9--rqgkuDVLiwhU93RLV1YwEYVW6aRe9Qf5Mh80aVCg",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}["KEY-CHAT-ISIS"]]].find(([le,ue])=>!!ue),x=y?.[1],b=y?.[0]||"none",w={}.VITE_JSONBIN_COLLECTION_ID||null,j="6939b808ae596e708f90b843",_="https://api.jsonbin.io/v3/b",S={}.VITE_ISIS_EDGE_SYNC==="1",[C,P]=p.useState(S?j:null);if(S&&typeof window<"u")try{console.info("[Isis][JSONBin] keySource=%s binId=%s",b,j||window.localStorage.getItem("ISIS_JSONBIN_BIN_ID")||"none")}catch{}const A=p.useCallback(async le=>{if(!S)return{ok:!1,data:null};if(!x){try{console.debug("[Isis][Edge] skipped (no JSONBIN key) mode=%s",le?.mode)}catch{}return{ok:!1,data:null}}try{const{data:ue,error:Re}=await de.functions.invoke("isis-chat",{body:le});if(Re){try{console.debug("[Isis][Edge] %s error=%o",le?.mode,Re)}catch{}return{ok:!1,data:null}}try{console.debug("[Isis][Edge] %s ok resp=%o",le?.mode,ue)}catch{}return{ok:!0,data:ue}}catch(ue){try{console.debug("[Isis][Edge] invoke exception:",ue)}catch{}return{ok:!1,data:null}}},[x,S]),R=p.useCallback(async le=>{if(!x)return null;const ue={"X-Master-Key":x,"X-Access-Key":x,"Content-Type":"application/json"};w&&(ue["X-Collection-Id"]=w);const Re=await fetch(`${_}`,{method:"POST",headers:ue,body:JSON.stringify(le||{projects:[{name:"F7 Arena"}],chat_sessions:[]})});if(!Re.ok)return null;const ne=await Re.json().catch(()=>null),ie=ne?.metadata?.id||ne?.id||null;if(ie){P(ie);try{window?.localStorage?.setItem("ISIS_JSONBIN_BIN_ID",ie)}catch{}}return ie},[x]),O=p.useCallback(async()=>{if(!x||!C)return null;try{console.debug("[Isis][JSONBin] loadBin: GET %s/%s",_,C)}catch{}const le={"X-Master-Key":x,"X-Access-Key":x,"X-Bin-Meta":"false","Content-Type":"application/json"};w&&(le["X-Collection-Id"]=w);const ue=await fetch(`${_}/${C}`,{method:"GET",headers:le});try{console.debug("[Isis][JSONBin] loadBin: status=%s",ue?.status)}catch{}if(ue.status===401||ue.status===404){try{console.error("[Isis][JSONBin] GET unauthorized or not found. keySource=%s binId=%s status=%s",b,C,ue.status)}catch{}return await R()?{projects:[{name:"F7 Arena"}],chat_sessions:[]}:null}if(!ue.ok)return null;try{return await ue.json()}catch{return null}},[x,C,R]),I=p.useCallback(async le=>{if(!x||!C&&!await R(le))return!1;const ue=C||(typeof window<"u"?window.localStorage.getItem("ISIS_JSONBIN_BIN_ID"):null);try{console.debug("[Isis][JSONBin] saveBin: PUT %s/%s",_,ue)}catch{}const Re={"X-Master-Key":x,"X-Access-Key":x,"Content-Type":"application/json"};w&&(Re["X-Collection-Id"]=w);const ne=await fetch(`${_}/${ue}`,{method:"PUT",headers:Re,body:JSON.stringify(le)});try{console.debug("[Isis][JSONBin] saveBin: status=%s",ne?.status)}catch{}if(ne.status===401||ne.status===404){try{console.error("[Isis][JSONBin] PUT unauthorized or not found. keySource=%s binId=%s status=%s",b,ue,ne.status)}catch{}return!!await R(le)}return ne.ok},[x,C,R]),M=le=>!le||typeof le!="object"?{projects:[{name:"F7 Arena"}],chat_sessions:[]}:(Array.isArray(le.chat_sessions)||(le.chat_sessions=[]),le),D=(le,ue)=>(Array.isArray(le?.chat_sessions)?le.chat_sessions:[]).findIndex(ne=>(ne?.project||"").toString()===(ue.project||"").toString()&&(ne?.company?.code||"").toString()===(ue.companyCode||"").toString()&&(ne?.client_code||"").toString()===(ue.clientCode||"").toString()),U=p.useCallback(async()=>{if(i)return i;try{try{console.info("[Isis][Chat] ensureSession: start")}catch{}const le=c?.empresa||null,ue=le?{code:le.codigo_empresa||le.codigoEmpresa,name:le.nome_fantasia||le.nome}:null,Re=c?.cliente||null;let ne=await O();ne=M(ne),Array.isArray(ne.projects)||(ne.projects=[{name:"F7 Arena"}]);const ie={project:"F7 Arena",companyCode:ue?.code||null,clientCode:Re?.id?String(Re.id):null};try{console.debug("[Isis][Chat] ensureSession: criteria=%o",ie)}catch{}if(ie.companyCode&&ie.clientCode){const gt=D(ne,ie);try{console.debug("[Isis][Chat] ensureSession: existingIndex=%s",gt)}catch{}gt===-1&&ne.chat_sessions.push({client_code:ie.clientCode,client_name:Re?.nome||Re?.name||"",company:ue,project:ie.project,conversation:[]})}await I(ne);try{console.info("[Isis][Chat] ensureSession: sessionId=%s",i)}catch{}return i}catch(le){try{console.error("[Isis][Chat] ensureSession: failed",le)}catch{}return null}},[i,c?.empresa,c?.cliente,O,I]),z=p.useCallback(async le=>{if(le)try{const ue=c?.empresa||null,Re=ue?{code:ue.codigo_empresa||ue.codigoEmpresa,name:ue.nome_fantasia||ue.nome}:null,ne=c?.cliente||null;let ie=await O();if(!ie)return;ie=M(ie);const gt={project:"F7 Arena",companyCode:Re?.code||null,clientCode:ne?.id?String(ne.id):null};try{console.debug("[Isis][Chat] tryUpdateSessionMeta: criteria=%o",gt)}catch{}if(!gt.companyCode&&!gt.clientCode)return;let bt=D(ie,gt);if(bt===-1){ie.chat_sessions.push({client_code:gt.clientCode,client_name:ne?.nome||ne?.name||"",company:Re,project:gt.project,conversation:[]}),bt=ie.chat_sessions.length-1;try{console.debug("[Isis][Chat] tryUpdateSessionMeta: created index=%s",bt)}catch{}}else{ne?.id&&!ie.chat_sessions[bt].client_code&&(ie.chat_sessions[bt].client_code=String(ne.id)),ne?.nome&&!ie.chat_sessions[bt].client_name&&(ie.chat_sessions[bt].client_name=ne.nome),Re&&!ie.chat_sessions[bt].company&&(ie.chat_sessions[bt].company=Re);try{console.debug("[Isis][Chat] tryUpdateSessionMeta: updated index=%s",bt)}catch{}}await I(ie),Re?.name&&ne?.id&&await A({mode:"set_meta",cod_cliente:ne?.id?String(ne.id):"",nome_cliente:ne?.nome||ne?.name||"",empresa:Re.name,software:"F7 Arena"})}catch{}},[c?.empresa,c?.cliente,O,I,A]),W=p.useCallback(async le=>{try{try{console.info("[Isis][Chat] persistMessage: incoming=%o",{from:le.from,text:le.text})}catch{}const ue=c?.empresa||null,Re=ue?{code:ue.codigo_empresa||ue.codigoEmpresa,name:ue.nome_fantasia||ue.nome}:null,ne=c?.cliente||null;try{const ie=le.from==="isis"?"assistant":"user",gt=Re?.name||ue?.nome_fantasia||ue?.nome||ue?.razao_social||"Desconhecida",bt={id:`${Date.now()}${Math.random().toString(36).slice(2,10)}`,cod_cliente:ne?.id?String(ne.id):null,nome_cliente:ne?.nome||ne?.name||null,empresa:gt,projeto:"fluxo7arena",nota:null,comentario:null,conversa:JSON.stringify({session_id:i,from:ie,text:String(le.text??"")}),timestamp:new Date().toISOString()},{error:at}=await EY.from("isis").insert(bt);if(at)try{console.error("[Isis][Chat] supabase-isis insert error:",at)}catch{}else try{console.debug("[Isis][Chat] supabase-isis inserted")}catch{}}catch(ie){try{console.error("[Isis][Chat] supabase-isis exception:",ie)}catch{}}if(S&&await A({mode:"append_message",cod_cliente:ne?.id?String(ne.id):"_unknown",nome_cliente:ne?.nome||ne?.name||"",empresa:Re?.name||"",software:"F7 Arena",session_id:i,message:{from:le.from==="isis"?"assistant":"user",text:String(le.text??"")}}),S)try{const ie=await U();if(!ie)return;const gt=le.from==="isis"?"assistant":"user",bt={ts:new Date().toISOString(),from:gt,text:String(le.text??"")};let at=await O();if(!at)return;at=M(at);const xt=c?.empresa||null,Ze=xt?{code:xt.codigo_empresa||xt.codigoEmpresa,name:xt.nome_fantasia||xt.nome}:null,ht=c?.cliente||null,Wt={project:"F7 Arena",companyCode:Ze?.code||null,clientCode:ht?.id?String(ht.id):null};let be=D(at,Wt);be===-1?at.chat_sessions.push({client_code:Wt.clientCode,client_name:ht?.nome||ht?.name||"",company:Ze,project:Wt.project,conversation:[bt]}):(Array.isArray(at.chat_sessions[be].conversation)||(at.chat_sessions[be].conversation=[]),at.chat_sessions[be].conversation.push(bt)),await I(at),z(ie)}catch{}}catch{}},[U,z,O,I,A,c?.empresa,c?.cliente,i]),$=p.useCallback(le=>{s(ue=>[...ue,{id:Date.now()+Math.random(),timestamp:new Date,...le}]),setTimeout(()=>{v.current?.scrollIntoView({behavior:"smooth"})},100);try{W(le)}catch{}},[]),X=p.useCallback((le,ue=2e3,Re=null)=>{m(!0),setTimeout(()=>{m(!1);const ne=le&&typeof le=="object"&&le.text?le:{text:le};$({from:"isis",text:ne.text,type:"text",color:ne.color??Re,copyable:!!ne.copyable,copyText:ne.copyText})},ue)},[$]),ye=p.useCallback((le,ue,Re=2e3)=>{m(!0),setTimeout(()=>{m(!1),s(ne=>ne.map(ie=>ie.type==="buttons"&&ie.buttons&&ie.buttons.length>0?{...ie,disabled:!0}:ie)),$({from:"isis",text:le,type:"buttons",buttons:ue,disabled:!1})},Re)},[$]),Se=p.useCallback(()=>{s(le=>le.map(ue=>ue.type==="buttons"&&ue.buttons&&ue.buttons.length>0&&!ue.disabled?{...ue,disabled:!0}:ue))},[]),V=p.useCallback(le=>{s(ue=>ue.filter(Re=>Re.id!==le))},[]),B=p.useCallback(le=>{s(ue=>ue.map(Re=>Re.id===le&&Re.type==="buttons"?{...Re,buttonsHidden:!0,disabled:!0}:Re))},[]),Q=p.useCallback(le=>{$({from:"user",text:le,type:"text"})},[$]),pe=p.useCallback((le,ue)=>{if(d(Re=>({...Re,[le]:ue})),(le==="cliente"||le==="empresa")&&i)try{z(i)}catch{}},[]),te=p.useCallback((le,ue)=>{d(Re=>({...Re,contato:{...Re.contato,[le]:ue}}))},[]),Y=p.useCallback(le=>{r(le)},[]),ce=p.useCallback(()=>{const le=["greeting","quadra","data","horario","modalidade","quantidade","nomes","contato","review","confirmation","avaliacao"],ue=le.indexOf(t);ue>0&&r(le[ue-1])},[t]),me=p.useCallback(()=>{r("greeting"),s([]),d({empresa:null,quadra:null,data:null,horario:null,modalidade:null,quantidade:null,nomes:[],contato:{nome:"",telefone:""}}),f(!1),m(!1),l(null)},[]),ae={currentStep:t,messages:n,selections:c,sessionId:i,isLoading:u,isTyping:h,chatEndRef:v,addMessage:$,addIsisMessage:X,addIsisMessageWithButtons:ye,addUserMessage:Q,disableAllButtons:Se,removeMessageById:V,hideButtonsInMessage:B,updateSelection:pe,updateContact:te,nextStep:Y,previousStep:ce,resetConversation:me,setIsLoading:f,setIsTyping:m};return a.jsx(kY.Provider,{value:ae,children:e})};var P2e=Array.isArray,dc=P2e,A2e=typeof rl=="object"&&rl&&rl.Object===Object&&rl,OY=A2e,E2e=OY,k2e=typeof self=="object"&&self&&self.Object===Object&&self,I2e=E2e||k2e||Function("return this")(),uf=I2e,O2e=uf,T2e=O2e.Symbol,k1=T2e,Z6=k1,TY=Object.prototype,D2e=TY.hasOwnProperty,M2e=TY.toString,gy=Z6?Z6.toStringTag:void 0;function R2e(e){var t=D2e.call(e,gy),r=e[gy];try{e[gy]=void 0;var n=!0}catch{}var s=M2e.call(e);return n&&(t?e[gy]=r:delete e[gy]),s}var L2e=R2e,F2e=Object.prototype,$2e=F2e.toString;function B2e(e){return $2e.call(e)}var q2e=B2e,e8=k1,z2e=L2e,U2e=q2e,V2e="[object Null]",W2e="[object Undefined]",t8=e8?e8.toStringTag:void 0;function H2e(e){return e==null?e===void 0?W2e:V2e:t8&&t8 in Object(e)?z2e(e):U2e(e)}var dm=H2e;function G2e(e){return e!=null&&typeof e=="object"}var um=G2e,K2e=dm,X2e=um,Y2e="[object Symbol]";function J2e(e){return typeof e=="symbol"||X2e(e)&&K2e(e)==Y2e}var k0=J2e,Q2e=dc,Z2e=k0,eje=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,tje=/^\w*$/;function rje(e,t){if(Q2e(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||Z2e(e)?!0:tje.test(e)||!eje.test(e)||t!=null&&e in Object(t)}var PD=rje;function nje(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Xh=nje;const I0=Ua(Xh);var aje=dm,sje=Xh,oje="[object AsyncFunction]",ije="[object Function]",lje="[object GeneratorFunction]",cje="[object Proxy]";function dje(e){if(!sje(e))return!1;var t=aje(e);return t==ije||t==lje||t==oje||t==cje}var AD=dje;const Zn=Ua(AD);var uje=uf,fje=uje["__core-js_shared__"],mje=fje,$A=mje,r8=function(){var e=/[^.]+$/.exec($A&&$A.keys&&$A.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function hje(e){return!!r8&&r8 in e}var pje=hje,gje=Function.prototype,vje=gje.toString;function xje(e){if(e!=null){try{return vje.call(e)}catch{}try{return e+""}catch{}}return""}var DY=xje,yje=AD,bje=pje,wje=Xh,jje=DY,_je=/[\\^$.*+?()[\]{}|]/g,Nje=/^\[object .+?Constructor\]$/,Sje=Function.prototype,Cje=Object.prototype,Pje=Sje.toString,Aje=Cje.hasOwnProperty,Eje=RegExp("^"+Pje.call(Aje).replace(_je,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function kje(e){if(!wje(e)||bje(e))return!1;var t=yje(e)?Eje:Nje;return t.test(jje(e))}var Ije=kje;function Oje(e,t){return e?.[t]}var Tje=Oje,Dje=Ije,Mje=Tje;function Rje(e,t){var r=Mje(e,t);return Dje(r)?r:void 0}var Lg=Rje,Lje=Lg,Fje=Lje(Object,"create"),UC=Fje,n8=UC;function $je(){this.__data__=n8?n8(null):{},this.size=0}var Bje=$je;function qje(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var zje=qje,Uje=UC,Vje="__lodash_hash_undefined__",Wje=Object.prototype,Hje=Wje.hasOwnProperty;function Gje(e){var t=this.__data__;if(Uje){var r=t[e];return r===Vje?void 0:r}return Hje.call(t,e)?t[e]:void 0}var Kje=Gje,Xje=UC,Yje=Object.prototype,Jje=Yje.hasOwnProperty;function Qje(e){var t=this.__data__;return Xje?t[e]!==void 0:Jje.call(t,e)}var Zje=Qje,e_e=UC,t_e="__lodash_hash_undefined__";function r_e(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=e_e&&t===void 0?t_e:t,this}var n_e=r_e,a_e=Bje,s_e=zje,o_e=Kje,i_e=Zje,l_e=n_e;function O0(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}O0.prototype.clear=a_e;O0.prototype.delete=s_e;O0.prototype.get=o_e;O0.prototype.has=i_e;O0.prototype.set=l_e;var c_e=O0;function d_e(){this.__data__=[],this.size=0}var u_e=d_e;function f_e(e,t){return e===t||e!==e&&t!==t}var ED=f_e,m_e=ED;function h_e(e,t){for(var r=e.length;r--;)if(m_e(e[r][0],t))return r;return-1}var VC=h_e,p_e=VC,g_e=Array.prototype,v_e=g_e.splice;function x_e(e){var t=this.__data__,r=p_e(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():v_e.call(t,r,1),--this.size,!0}var y_e=x_e,b_e=VC;function w_e(e){var t=this.__data__,r=b_e(t,e);return r<0?void 0:t[r][1]}var j_e=w_e,__e=VC;function N_e(e){return __e(this.__data__,e)>-1}var S_e=N_e,C_e=VC;function P_e(e,t){var r=this.__data__,n=C_e(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var A_e=P_e,E_e=u_e,k_e=y_e,I_e=j_e,O_e=S_e,T_e=A_e;function T0(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}T0.prototype.clear=E_e;T0.prototype.delete=k_e;T0.prototype.get=I_e;T0.prototype.has=O_e;T0.prototype.set=T_e;var WC=T0,D_e=Lg,M_e=uf,R_e=D_e(M_e,"Map"),kD=R_e,a8=c_e,L_e=WC,F_e=kD;function $_e(){this.size=0,this.__data__={hash:new a8,map:new(F_e||L_e),string:new a8}}var B_e=$_e;function q_e(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var z_e=q_e,U_e=z_e;function V_e(e,t){var r=e.__data__;return U_e(t)?r[typeof t=="string"?"string":"hash"]:r.map}var HC=V_e,W_e=HC;function H_e(e){var t=W_e(this,e).delete(e);return this.size-=t?1:0,t}var G_e=H_e,K_e=HC;function X_e(e){return K_e(this,e).get(e)}var Y_e=X_e,J_e=HC;function Q_e(e){return J_e(this,e).has(e)}var Z_e=Q_e,eNe=HC;function tNe(e,t){var r=eNe(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var rNe=tNe,nNe=B_e,aNe=G_e,sNe=Y_e,oNe=Z_e,iNe=rNe;function D0(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}D0.prototype.clear=nNe;D0.prototype.delete=aNe;D0.prototype.get=sNe;D0.prototype.has=oNe;D0.prototype.set=iNe;var ID=D0,MY=ID,lNe="Expected a function";function OD(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(lNe);var r=function(){var n=arguments,s=t?t.apply(this,n):n[0],o=r.cache;if(o.has(s))return o.get(s);var i=e.apply(this,n);return r.cache=o.set(s,i)||o,i};return r.cache=new(OD.Cache||MY),r}OD.Cache=MY;var RY=OD;const cNe=Ua(RY);var dNe=RY,uNe=500;function fNe(e){var t=dNe(e,function(n){return r.size===uNe&&r.clear(),n}),r=t.cache;return t}var mNe=fNe,hNe=mNe,pNe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,gNe=/\\(\\)?/g,vNe=hNe(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(pNe,function(r,n,s,o){t.push(s?o.replace(gNe,"$1"):n||r)}),t}),xNe=vNe;function yNe(e,t){for(var r=-1,n=e==null?0:e.length,s=Array(n);++r<n;)s[r]=t(e[r],r,e);return s}var TD=yNe,s8=k1,bNe=TD,wNe=dc,jNe=k0,_Ne=1/0,o8=s8?s8.prototype:void 0,i8=o8?o8.toString:void 0;function LY(e){if(typeof e=="string")return e;if(wNe(e))return bNe(e,LY)+"";if(jNe(e))return i8?i8.call(e):"";var t=e+"";return t=="0"&&1/e==-_Ne?"-0":t}var NNe=LY,SNe=NNe;function CNe(e){return e==null?"":SNe(e)}var FY=CNe,PNe=dc,ANe=PD,ENe=xNe,kNe=FY;function INe(e,t){return PNe(e)?e:ANe(e,t)?[e]:ENe(kNe(e))}var $Y=INe,ONe=k0,TNe=1/0;function DNe(e){if(typeof e=="string"||ONe(e))return e;var t=e+"";return t=="0"&&1/e==-TNe?"-0":t}var GC=DNe,MNe=$Y,RNe=GC;function LNe(e,t){t=MNe(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[RNe(t[r++])];return r&&r==n?e:void 0}var DD=LNe,FNe=DD;function $Ne(e,t,r){var n=e==null?void 0:FNe(e,t);return n===void 0?r:n}var BY=$Ne;const zc=Ua(BY);function BNe(e){return e==null}var qNe=BNe;const la=Ua(qNe);var zNe=dm,UNe=dc,VNe=um,WNe="[object String]";function HNe(e){return typeof e=="string"||!UNe(e)&&VNe(e)&&zNe(e)==WNe}var GNe=HNe;const xg=Ua(GNe);var qY={exports:{}},cs={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MD=Symbol.for("react.element"),RD=Symbol.for("react.portal"),KC=Symbol.for("react.fragment"),XC=Symbol.for("react.strict_mode"),YC=Symbol.for("react.profiler"),JC=Symbol.for("react.provider"),QC=Symbol.for("react.context"),KNe=Symbol.for("react.server_context"),ZC=Symbol.for("react.forward_ref"),e5=Symbol.for("react.suspense"),t5=Symbol.for("react.suspense_list"),r5=Symbol.for("react.memo"),n5=Symbol.for("react.lazy"),XNe=Symbol.for("react.offscreen"),zY;zY=Symbol.for("react.module.reference");function Fd(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case MD:switch(e=e.type,e){case KC:case YC:case XC:case e5:case t5:return e;default:switch(e=e&&e.$$typeof,e){case KNe:case QC:case ZC:case n5:case r5:case JC:return e;default:return t}}case RD:return t}}}cs.ContextConsumer=QC;cs.ContextProvider=JC;cs.Element=MD;cs.ForwardRef=ZC;cs.Fragment=KC;cs.Lazy=n5;cs.Memo=r5;cs.Portal=RD;cs.Profiler=YC;cs.StrictMode=XC;cs.Suspense=e5;cs.SuspenseList=t5;cs.isAsyncMode=function(){return!1};cs.isConcurrentMode=function(){return!1};cs.isContextConsumer=function(e){return Fd(e)===QC};cs.isContextProvider=function(e){return Fd(e)===JC};cs.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===MD};cs.isForwardRef=function(e){return Fd(e)===ZC};cs.isFragment=function(e){return Fd(e)===KC};cs.isLazy=function(e){return Fd(e)===n5};cs.isMemo=function(e){return Fd(e)===r5};cs.isPortal=function(e){return Fd(e)===RD};cs.isProfiler=function(e){return Fd(e)===YC};cs.isStrictMode=function(e){return Fd(e)===XC};cs.isSuspense=function(e){return Fd(e)===e5};cs.isSuspenseList=function(e){return Fd(e)===t5};cs.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===KC||e===YC||e===XC||e===e5||e===t5||e===XNe||typeof e=="object"&&e!==null&&(e.$$typeof===n5||e.$$typeof===r5||e.$$typeof===JC||e.$$typeof===QC||e.$$typeof===ZC||e.$$typeof===zY||e.getModuleId!==void 0)};cs.typeOf=Fd;qY.exports=cs;var YNe=qY.exports,JNe=dm,QNe=um,ZNe="[object Number]";function eSe(e){return typeof e=="number"||QNe(e)&&JNe(e)==ZNe}var UY=eSe;const tSe=Ua(UY);var rSe=UY;function nSe(e){return rSe(e)&&e!=+e}var aSe=nSe;const M0=Ua(aSe);var Al=function(t){return t===0?0:t>0?1:-1},Fp=function(t){return xg(t)&&t.indexOf("%")===t.length-1},Xr=function(t){return tSe(t)&&!M0(t)},sSe=function(t){return la(t)},ai=function(t){return Xr(t)||xg(t)},oSe=0,Fg=function(t){var r=++oSe;return"".concat(t||"").concat(r)},El=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Xr(t)&&!xg(t))return n;var o;if(Fp(t)){var i=t.indexOf("%");o=r*parseFloat(t.slice(0,i))/100}else o=+t;return M0(o)&&(o=n),s&&o>r&&(o=r),o},Wm=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},iSe=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},s=0;s<r;s++)if(!n[t[s]])n[t[s]]=!0;else return!0;return!1},ti=function(t,r){return Xr(t)&&Xr(r)?function(n){return t+n*(r-t)}:function(){return r}};function pN(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):zc(n,t))===r})}var lSe=function(t,r){return Xr(t)&&Xr(r)?t-r:xg(t)&&xg(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function hx(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function QI(e){"@babel/helpers - typeof";return QI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},QI(e)}var cSe=["viewBox","children"],dSe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],l8=["points","pathLength"],BA={svg:cSe,polygon:l8,polyline:l8},LD=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],gN=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(p.isValidElement(t)&&(n=t.props),!I0(n))return null;var s={};return Object.keys(n).forEach(function(o){LD.includes(o)&&(s[o]=r||function(i){return n[o](n,i)})}),s},uSe=function(t,r,n){return function(s){return t(r,n,s),null}},yg=function(t,r,n){if(!I0(t)||QI(t)!=="object")return null;var s=null;return Object.keys(t).forEach(function(o){var i=t[o];LD.includes(o)&&typeof i=="function"&&(s||(s={}),s[o]=uSe(i,r,n))}),s},fSe=["children"],mSe=["children"];function c8(e,t){if(e==null)return{};var r=hSe(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function hSe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function ZI(e){"@babel/helpers - typeof";return ZI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ZI(e)}var d8={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Uf=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},u8=null,qA=null,FD=function e(t){if(t===u8&&Array.isArray(qA))return qA;var r=[];return p.Children.forEach(t,function(n){la(n)||(YNe.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),qA=r,u8=t,r};function Uc(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(s){return Uf(s)}):n=[Uf(t)],FD(e).forEach(function(s){var o=zc(s,"type.displayName")||zc(s,"type.name");n.indexOf(o)!==-1&&r.push(s)}),r}function Ac(e,t){var r=Uc(e,t);return r&&r[0]}var f8=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,s=r.height;return!(!Xr(n)||n<=0||!Xr(s)||s<=0)},pSe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],gSe=function(t){return t&&t.type&&xg(t.type)&&pSe.indexOf(t.type)>=0},VY=function(t){return t&&ZI(t)==="object"&&"clipDot"in t},vSe=function(t,r,n,s){var o,i=(o=BA?.[s])!==null&&o!==void 0?o:[];return r.startsWith("data-")||!Zn(t)&&(s&&i.includes(r)||dSe.includes(r))||n&&LD.includes(r)},Bn=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var s=t;if(p.isValidElement(t)&&(s=t.props),!I0(s))return null;var o={};return Object.keys(s).forEach(function(i){var l;vSe((l=s)===null||l===void 0?void 0:l[i],i,r,n)&&(o[i]=s[i])}),o},eO=function e(t,r){if(t===r)return!0;var n=p.Children.count(t);if(n!==p.Children.count(r))return!1;if(n===0)return!0;if(n===1)return m8(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var s=0;s<n;s++){var o=t[s],i=r[s];if(Array.isArray(o)||Array.isArray(i)){if(!e(o,i))return!1}else if(!m8(o,i))return!1}return!0},m8=function(t,r){if(la(t)&&la(r))return!0;if(!la(t)&&!la(r)){var n=t.props||{},s=n.children,o=c8(n,fSe),i=r.props||{},l=i.children,c=c8(i,mSe);return s&&l?hx(o,c)&&eO(s,l):!s&&!l?hx(o,c):!1}return!1},h8=function(t,r){var n=[],s={};return FD(t).forEach(function(o,i){if(gSe(o))n.push(o);else if(o){var l=Uf(o.type),c=r[l]||{},d=c.handler,u=c.once;if(d&&(!u||!s[l])){var f=d(o,l,i);n.push(f),s[l]=!0}}}),n},xSe=function(t){var r=t&&t.type;return r&&d8[r]?d8[r]:null},ySe=function(t,r){return FD(r).indexOf(t)},bSe=["children","width","height","viewBox","className","style","title","desc"];function tO(){return tO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tO.apply(this,arguments)}function wSe(e,t){if(e==null)return{};var r=jSe(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function jSe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function rO(e){var t=e.children,r=e.width,n=e.height,s=e.viewBox,o=e.className,i=e.style,l=e.title,c=e.desc,d=wSe(e,bSe),u=s||{width:r,height:n,x:0,y:0},f=fa("recharts-surface",o);return Pe.createElement("svg",tO({},Bn(d,!0,"svg"),{className:f,width:r,height:n,style:i,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),Pe.createElement("title",null,l),Pe.createElement("desc",null,c),t)}var _Se=["children","className"];function nO(){return nO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nO.apply(this,arguments)}function NSe(e,t){if(e==null)return{};var r=SSe(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function SSe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Aa=Pe.forwardRef(function(e,t){var r=e.children,n=e.className,s=NSe(e,_Se),o=fa("recharts-layer",n);return Pe.createElement("g",nO({className:o},Bn(s,!0),{ref:t}),r)}),fu=function(t,r){for(var n=arguments.length,s=new Array(n>2?n-2:0),o=2;o<n;o++)s[o-2]=arguments[o]};function CSe(e,t,r){var n=-1,s=e.length;t<0&&(t=-t>s?0:s+t),r=r>s?s:r,r<0&&(r+=s),s=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(s);++n<s;)o[n]=e[n+t];return o}var PSe=CSe,ASe=PSe;function ESe(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:ASe(e,t,r)}var kSe=ESe,ISe="\\ud800-\\udfff",OSe="\\u0300-\\u036f",TSe="\\ufe20-\\ufe2f",DSe="\\u20d0-\\u20ff",MSe=OSe+TSe+DSe,RSe="\\ufe0e\\ufe0f",LSe="\\u200d",FSe=RegExp("["+LSe+ISe+MSe+RSe+"]");function $Se(e){return FSe.test(e)}var WY=$Se;function BSe(e){return e.split("")}var qSe=BSe,HY="\\ud800-\\udfff",zSe="\\u0300-\\u036f",USe="\\ufe20-\\ufe2f",VSe="\\u20d0-\\u20ff",WSe=zSe+USe+VSe,HSe="\\ufe0e\\ufe0f",GSe="["+HY+"]",aO="["+WSe+"]",sO="\\ud83c[\\udffb-\\udfff]",KSe="(?:"+aO+"|"+sO+")",GY="[^"+HY+"]",KY="(?:\\ud83c[\\udde6-\\uddff]){2}",XY="[\\ud800-\\udbff][\\udc00-\\udfff]",XSe="\\u200d",YY=KSe+"?",JY="["+HSe+"]?",YSe="(?:"+XSe+"(?:"+[GY,KY,XY].join("|")+")"+JY+YY+")*",JSe=JY+YY+YSe,QSe="(?:"+[GY+aO+"?",aO,KY,XY,GSe].join("|")+")",ZSe=RegExp(sO+"(?="+sO+")|"+QSe+JSe,"g");function eCe(e){return e.match(ZSe)||[]}var tCe=eCe,rCe=qSe,nCe=WY,aCe=tCe;function sCe(e){return nCe(e)?aCe(e):rCe(e)}var oCe=sCe,iCe=kSe,lCe=WY,cCe=oCe,dCe=FY;function uCe(e){return function(t){t=dCe(t);var r=lCe(t)?cCe(t):void 0,n=r?r[0]:t.charAt(0),s=r?iCe(r,1).join(""):t.slice(1);return n[e]()+s}}var fCe=uCe,mCe=fCe,hCe=mCe("toUpperCase"),pCe=hCe;const a5=Ua(pCe);function Ns(e){return function(){return e}}const QY=Math.cos,vN=Math.sin,ju=Math.sqrt,xN=Math.PI,s5=2*xN,oO=Math.PI,iO=2*oO,Np=1e-6,gCe=iO-Np;function ZY(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function vCe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return ZY;const r=10**t;return function(n){this._+=n[0];for(let s=1,o=n.length;s<o;++s)this._+=Math.round(arguments[s]*r)/r+n[s]}}class xCe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?ZY:vCe(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,s){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+s}`}bezierCurveTo(t,r,n,s,o,i){this._append`C${+t},${+r},${+n},${+s},${this._x1=+o},${this._y1=+i}`}arcTo(t,r,n,s,o){if(t=+t,r=+r,n=+n,s=+s,o=+o,o<0)throw new Error(`negative radius: ${o}`);let i=this._x1,l=this._y1,c=n-t,d=s-r,u=i-t,f=l-r,h=u*u+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>Np)if(!(Math.abs(f*c-d*u)>Np)||!o)this._append`L${this._x1=t},${this._y1=r}`;else{let m=n-i,v=s-l,g=c*c+d*d,y=m*m+v*v,x=Math.sqrt(g),b=Math.sqrt(h),w=o*Math.tan((oO-Math.acos((g+h-y)/(2*x*b)))/2),j=w/b,_=w/x;Math.abs(j-1)>Np&&this._append`L${t+j*u},${r+j*f}`,this._append`A${o},${o},0,0,${+(f*m>u*v)},${this._x1=t+_*c},${this._y1=r+_*d}`}}arc(t,r,n,s,o,i){if(t=+t,r=+r,n=+n,i=!!i,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(s),c=n*Math.sin(s),d=t+l,u=r+c,f=1^i,h=i?s-o:o-s;this._x1===null?this._append`M${d},${u}`:(Math.abs(this._x1-d)>Np||Math.abs(this._y1-u)>Np)&&this._append`L${d},${u}`,n&&(h<0&&(h=h%iO+iO),h>gCe?this._append`A${n},${n},0,1,${f},${t-l},${r-c}A${n},${n},0,1,${f},${this._x1=d},${this._y1=u}`:h>Np&&this._append`A${n},${n},0,${+(h>=oO)},${f},${this._x1=t+n*Math.cos(o)},${this._y1=r+n*Math.sin(o)}`)}rect(t,r,n,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+s}h${-n}Z`}toString(){return this._}}function $D(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new xCe(t)}function BD(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function eJ(e){this._context=e}eJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function o5(e){return new eJ(e)}function tJ(e){return e[0]}function rJ(e){return e[1]}function nJ(e,t){var r=Ns(!0),n=null,s=o5,o=null,i=$D(l);e=typeof e=="function"?e:e===void 0?tJ:Ns(e),t=typeof t=="function"?t:t===void 0?rJ:Ns(t);function l(c){var d,u=(c=BD(c)).length,f,h=!1,m;for(n==null&&(o=s(m=i())),d=0;d<=u;++d)!(d<u&&r(f=c[d],d,c))===h&&((h=!h)?o.lineStart():o.lineEnd()),h&&o.point(+e(f,d,c),+t(f,d,c));if(m)return o=null,m+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:Ns(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:Ns(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:Ns(!!c),l):r},l.curve=function(c){return arguments.length?(s=c,n!=null&&(o=s(n)),l):s},l.context=function(c){return arguments.length?(c==null?n=o=null:o=s(n=c),l):n},l}function sj(e,t,r){var n=null,s=Ns(!0),o=null,i=o5,l=null,c=$D(d);e=typeof e=="function"?e:e===void 0?tJ:Ns(+e),t=typeof t=="function"?t:Ns(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?rJ:Ns(+r);function d(f){var h,m,v,g=(f=BD(f)).length,y,x=!1,b,w=new Array(g),j=new Array(g);for(o==null&&(l=i(b=c())),h=0;h<=g;++h){if(!(h<g&&s(y=f[h],h,f))===x)if(x=!x)m=h,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),v=h-1;v>=m;--v)l.point(w[v],j[v]);l.lineEnd(),l.areaEnd()}x&&(w[h]=+e(y,h,f),j[h]=+t(y,h,f),l.point(n?+n(y,h,f):w[h],r?+r(y,h,f):j[h]))}if(b)return l=null,b+""||null}function u(){return nJ().defined(s).curve(i).context(o)}return d.x=function(f){return arguments.length?(e=typeof f=="function"?f:Ns(+f),n=null,d):e},d.x0=function(f){return arguments.length?(e=typeof f=="function"?f:Ns(+f),d):e},d.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Ns(+f),d):n},d.y=function(f){return arguments.length?(t=typeof f=="function"?f:Ns(+f),r=null,d):t},d.y0=function(f){return arguments.length?(t=typeof f=="function"?f:Ns(+f),d):t},d.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:Ns(+f),d):r},d.lineX0=d.lineY0=function(){return u().x(e).y(t)},d.lineY1=function(){return u().x(e).y(r)},d.lineX1=function(){return u().x(n).y(t)},d.defined=function(f){return arguments.length?(s=typeof f=="function"?f:Ns(!!f),d):s},d.curve=function(f){return arguments.length?(i=f,o!=null&&(l=i(o)),d):i},d.context=function(f){return arguments.length?(f==null?o=l=null:l=i(o=f),d):o},d}class aJ{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function yCe(e){return new aJ(e,!0)}function bCe(e){return new aJ(e,!1)}const qD={draw(e,t){const r=ju(t/xN);e.moveTo(r,0),e.arc(0,0,r,0,s5)}},wCe={draw(e,t){const r=ju(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},sJ=ju(1/3),jCe=sJ*2,_Ce={draw(e,t){const r=ju(t/jCe),n=r*sJ;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},NCe={draw(e,t){const r=ju(t),n=-r/2;e.rect(n,n,r,r)}},SCe=.8908130915292852,oJ=vN(xN/10)/vN(7*xN/10),CCe=vN(s5/10)*oJ,PCe=-QY(s5/10)*oJ,ACe={draw(e,t){const r=ju(t*SCe),n=CCe*r,s=PCe*r;e.moveTo(0,-r),e.lineTo(n,s);for(let o=1;o<5;++o){const i=s5*o/5,l=QY(i),c=vN(i);e.lineTo(c*r,-l*r),e.lineTo(l*n-c*s,c*n+l*s)}e.closePath()}},zA=ju(3),ECe={draw(e,t){const r=-ju(t/(zA*3));e.moveTo(0,r*2),e.lineTo(-zA*r,-r),e.lineTo(zA*r,-r),e.closePath()}},ad=-.5,sd=ju(3)/2,lO=1/ju(12),kCe=(lO/2+1)*3,ICe={draw(e,t){const r=ju(t/kCe),n=r/2,s=r*lO,o=n,i=r*lO+r,l=-o,c=i;e.moveTo(n,s),e.lineTo(o,i),e.lineTo(l,c),e.lineTo(ad*n-sd*s,sd*n+ad*s),e.lineTo(ad*o-sd*i,sd*o+ad*i),e.lineTo(ad*l-sd*c,sd*l+ad*c),e.lineTo(ad*n+sd*s,ad*s-sd*n),e.lineTo(ad*o+sd*i,ad*i-sd*o),e.lineTo(ad*l+sd*c,ad*c-sd*l),e.closePath()}};function OCe(e,t){let r=null,n=$D(s);e=typeof e=="function"?e:Ns(e||qD),t=typeof t=="function"?t:Ns(t===void 0?64:+t);function s(){let o;if(r||(r=o=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),o)return r=null,o+""||null}return s.type=function(o){return arguments.length?(e=typeof o=="function"?o:Ns(o),s):e},s.size=function(o){return arguments.length?(t=typeof o=="function"?o:Ns(+o),s):t},s.context=function(o){return arguments.length?(r=o??null,s):r},s}function yN(){}function bN(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function iJ(e){this._context=e}iJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:bN(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:bN(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function TCe(e){return new iJ(e)}function lJ(e){this._context=e}lJ.prototype={areaStart:yN,areaEnd:yN,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:bN(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function DCe(e){return new lJ(e)}function cJ(e){this._context=e}cJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:bN(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function MCe(e){return new cJ(e)}function dJ(e){this._context=e}dJ.prototype={areaStart:yN,areaEnd:yN,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function RCe(e){return new dJ(e)}function p8(e){return e<0?-1:1}function g8(e,t,r){var n=e._x1-e._x0,s=t-e._x1,o=(e._y1-e._y0)/(n||s<0&&-0),i=(r-e._y1)/(s||n<0&&-0),l=(o*s+i*n)/(n+s);return(p8(o)+p8(i))*Math.min(Math.abs(o),Math.abs(i),.5*Math.abs(l))||0}function v8(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function UA(e,t,r){var n=e._x0,s=e._y0,o=e._x1,i=e._y1,l=(o-n)/3;e._context.bezierCurveTo(n+l,s+l*t,o-l,i-l*r,o,i)}function wN(e){this._context=e}wN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:UA(this,this._t0,v8(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,UA(this,v8(this,r=g8(this,e,t)),r);break;default:UA(this,this._t0,r=g8(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function uJ(e){this._context=new fJ(e)}(uJ.prototype=Object.create(wN.prototype)).point=function(e,t){wN.prototype.point.call(this,t,e)};function fJ(e){this._context=e}fJ.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,s,o){this._context.bezierCurveTo(t,e,n,r,o,s)}};function LCe(e){return new wN(e)}function FCe(e){return new uJ(e)}function mJ(e){this._context=e}mJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=x8(e),s=x8(t),o=0,i=1;i<r;++o,++i)this._context.bezierCurveTo(n[0][o],s[0][o],n[1][o],s[1][o],e[i],t[i]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function x8(e){var t,r=e.length-1,n,s=new Array(r),o=new Array(r),i=new Array(r);for(s[0]=0,o[0]=2,i[0]=e[0]+2*e[1],t=1;t<r-1;++t)s[t]=1,o[t]=4,i[t]=4*e[t]+2*e[t+1];for(s[r-1]=2,o[r-1]=7,i[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=s[t]/o[t-1],o[t]-=n,i[t]-=n*i[t-1];for(s[r-1]=i[r-1]/o[r-1],t=r-2;t>=0;--t)s[t]=(i[t]-s[t+1])/o[t];for(o[r-1]=(e[r]+s[r-1])/2,t=0;t<r-1;++t)o[t]=2*e[t+1]-s[t+1];return[s,o]}function $Ce(e){return new mJ(e)}function i5(e,t){this._context=e,this._t=t}i5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function BCe(e){return new i5(e,.5)}function qCe(e){return new i5(e,0)}function zCe(e){return new i5(e,1)}function Fx(e,t){if((i=e.length)>1)for(var r=1,n,s,o=e[t[0]],i,l=o.length;r<i;++r)for(s=o,o=e[t[r]],n=0;n<l;++n)o[n][1]+=o[n][0]=isNaN(s[n][1])?s[n][0]:s[n][1]}function cO(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function UCe(e,t){return e[t]}function VCe(e){const t=[];return t.key=e,t}function WCe(){var e=Ns([]),t=cO,r=Fx,n=UCe;function s(o){var i=Array.from(e.apply(this,arguments),VCe),l,c=i.length,d=-1,u;for(const f of o)for(l=0,++d;l<c;++l)(i[l][d]=[0,+n(f,i[l].key,d,o)]).data=f;for(l=0,u=BD(t(i));l<c;++l)i[u[l]].index=l;return r(i,u),i}return s.keys=function(o){return arguments.length?(e=typeof o=="function"?o:Ns(Array.from(o)),s):e},s.value=function(o){return arguments.length?(n=typeof o=="function"?o:Ns(+o),s):n},s.order=function(o){return arguments.length?(t=o==null?cO:typeof o=="function"?o:Ns(Array.from(o)),s):t},s.offset=function(o){return arguments.length?(r=o??Fx,s):r},s}function HCe(e,t){if((n=e.length)>0){for(var r,n,s=0,o=e[0].length,i;s<o;++s){for(i=r=0;r<n;++r)i+=e[r][s][1]||0;if(i)for(r=0;r<n;++r)e[r][s][1]/=i}Fx(e,t)}}function GCe(e,t){if((s=e.length)>0){for(var r=0,n=e[t[0]],s,o=n.length;r<o;++r){for(var i=0,l=0;i<s;++i)l+=e[i][r][1]||0;n[r][1]+=n[r][0]=-l/2}Fx(e,t)}}function KCe(e,t){if(!(!((i=e.length)>0)||!((o=(s=e[t[0]]).length)>0))){for(var r=0,n=1,s,o,i;n<o;++n){for(var l=0,c=0,d=0;l<i;++l){for(var u=e[t[l]],f=u[n][1]||0,h=u[n-1][1]||0,m=(f-h)/2,v=0;v<l;++v){var g=e[t[v]],y=g[n][1]||0,x=g[n-1][1]||0;m+=y-x}c+=f,d+=m*f}s[n-1][1]+=s[n-1][0]=r,c&&(r-=d/c)}s[n-1][1]+=s[n-1][0]=r,Fx(e,t)}}function fw(e){"@babel/helpers - typeof";return fw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fw(e)}var XCe=["type","size","sizeType"];function dO(){return dO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dO.apply(this,arguments)}function y8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function b8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y8(Object(r),!0).forEach(function(n){YCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YCe(e,t,r){return t=JCe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JCe(e){var t=QCe(e,"string");return fw(t)=="symbol"?t:t+""}function QCe(e,t){if(fw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZCe(e,t){if(e==null)return{};var r=e5e(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function e5e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var hJ={symbolCircle:qD,symbolCross:wCe,symbolDiamond:_Ce,symbolSquare:NCe,symbolStar:ACe,symbolTriangle:ECe,symbolWye:ICe},t5e=Math.PI/180,r5e=function(t){var r="symbol".concat(a5(t));return hJ[r]||qD},n5e=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var s=18*t5e;return 1.25*t*t*(Math.tan(s)-Math.tan(s*2)*Math.pow(Math.tan(s),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},a5e=function(t,r){hJ["symbol".concat(a5(t))]=r},zD=function(t){var r=t.type,n=r===void 0?"circle":r,s=t.size,o=s===void 0?64:s,i=t.sizeType,l=i===void 0?"area":i,c=ZCe(t,XCe),d=b8(b8({},c),{},{type:n,size:o,sizeType:l}),u=function(){var y=r5e(n),x=OCe().type(y).size(n5e(o,l,n));return x()},f=d.className,h=d.cx,m=d.cy,v=Bn(d,!0);return h===+h&&m===+m&&o===+o?Pe.createElement("path",dO({},v,{className:fa("recharts-symbols",f),transform:"translate(".concat(h,", ").concat(m,")"),d:u()})):null};zD.registerSymbol=a5e;function $x(e){"@babel/helpers - typeof";return $x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$x(e)}function uO(){return uO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uO.apply(this,arguments)}function w8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function s5e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?w8(Object(r),!0).forEach(function(n){mw(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function o5e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gJ(n.key),n)}}function i5e(e,t,r){return t&&j8(e.prototype,t),r&&j8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function l5e(e,t,r){return t=jN(t),c5e(e,pJ()?Reflect.construct(t,r||[],jN(e).constructor):t.apply(e,r))}function c5e(e,t){if(t&&($x(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return d5e(e)}function d5e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pJ=function(){return!!e})()}function jN(e){return jN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},jN(e)}function u5e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fO(e,t)}function fO(e,t){return fO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},fO(e,t)}function mw(e,t,r){return t=gJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gJ(e){var t=f5e(e,"string");return $x(t)=="symbol"?t:t+""}function f5e(e,t){if($x(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($x(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var od=32,UD=function(e){function t(){return o5e(this,t),l5e(this,t,arguments)}return u5e(t,e),i5e(t,[{key:"renderIcon",value:function(n){var s=this.props.inactiveColor,o=od/2,i=od/6,l=od/3,c=n.inactive?s:n.color;if(n.type==="plainline")return Pe.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:o,x2:od,y2:o,className:"recharts-legend-icon"});if(n.type==="line")return Pe.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(o,"h").concat(l,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*l,",").concat(o,`
            H`).concat(od,"M").concat(2*l,",").concat(o,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(l,",").concat(o),className:"recharts-legend-icon"});if(n.type==="rect")return Pe.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(od/8,"h").concat(od,"v").concat(od*3/4,"h").concat(-od,"z"),className:"recharts-legend-icon"});if(Pe.isValidElement(n.legendIcon)){var d=s5e({},n);return delete d.legendIcon,Pe.cloneElement(n.legendIcon,d)}return Pe.createElement(zD,{fill:c,cx:o,cy:o,size:od,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,s=this.props,o=s.payload,i=s.iconSize,l=s.layout,c=s.formatter,d=s.inactiveColor,u={x:0,y:0,width:od,height:od},f={display:l==="horizontal"?"inline-block":"block",marginRight:10},h={display:"inline-block",verticalAlign:"middle",marginRight:4};return o.map(function(m,v){var g=m.formatter||c,y=fa(mw(mw({"recharts-legend-item":!0},"legend-item-".concat(v),!0),"inactive",m.inactive));if(m.type==="none")return null;var x=Zn(m.value)?null:m.value;fu(!Zn(m.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var b=m.inactive?d:m.color;return Pe.createElement("li",uO({className:y,style:f,key:"legend-item-".concat(v)},yg(n.props,m,v)),Pe.createElement(rO,{width:i,height:i,viewBox:u,style:h},n.renderIcon(m)),Pe.createElement("span",{className:"recharts-legend-item-text",style:{color:b}},g?g(x,m,v):x))})}},{key:"render",value:function(){var n=this.props,s=n.payload,o=n.layout,i=n.align;if(!s||!s.length)return null;var l={padding:0,margin:0,textAlign:o==="horizontal"?i:"left"};return Pe.createElement("ul",{className:"recharts-default-legend",style:l},this.renderItems())}}])}(p.PureComponent);mw(UD,"displayName","Legend");mw(UD,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var m5e=WC;function h5e(){this.__data__=new m5e,this.size=0}var p5e=h5e;function g5e(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var v5e=g5e;function x5e(e){return this.__data__.get(e)}var y5e=x5e;function b5e(e){return this.__data__.has(e)}var w5e=b5e,j5e=WC,_5e=kD,N5e=ID,S5e=200;function C5e(e,t){var r=this.__data__;if(r instanceof j5e){var n=r.__data__;if(!_5e||n.length<S5e-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new N5e(n)}return r.set(e,t),this.size=r.size,this}var P5e=C5e,A5e=WC,E5e=p5e,k5e=v5e,I5e=y5e,O5e=w5e,T5e=P5e;function R0(e){var t=this.__data__=new A5e(e);this.size=t.size}R0.prototype.clear=E5e;R0.prototype.delete=k5e;R0.prototype.get=I5e;R0.prototype.has=O5e;R0.prototype.set=T5e;var vJ=R0,D5e="__lodash_hash_undefined__";function M5e(e){return this.__data__.set(e,D5e),this}var R5e=M5e;function L5e(e){return this.__data__.has(e)}var F5e=L5e,$5e=ID,B5e=R5e,q5e=F5e;function _N(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new $5e;++t<r;)this.add(e[t])}_N.prototype.add=_N.prototype.push=B5e;_N.prototype.has=q5e;var xJ=_N;function z5e(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var yJ=z5e;function U5e(e,t){return e.has(t)}var bJ=U5e,V5e=xJ,W5e=yJ,H5e=bJ,G5e=1,K5e=2;function X5e(e,t,r,n,s,o){var i=r&G5e,l=e.length,c=t.length;if(l!=c&&!(i&&c>l))return!1;var d=o.get(e),u=o.get(t);if(d&&u)return d==t&&u==e;var f=-1,h=!0,m=r&K5e?new V5e:void 0;for(o.set(e,t),o.set(t,e);++f<l;){var v=e[f],g=t[f];if(n)var y=i?n(g,v,f,t,e,o):n(v,g,f,e,t,o);if(y!==void 0){if(y)continue;h=!1;break}if(m){if(!W5e(t,function(x,b){if(!H5e(m,b)&&(v===x||s(v,x,r,n,o)))return m.push(b)})){h=!1;break}}else if(!(v===g||s(v,g,r,n,o))){h=!1;break}}return o.delete(e),o.delete(t),h}var wJ=X5e,Y5e=uf,J5e=Y5e.Uint8Array,Q5e=J5e;function Z5e(e){var t=-1,r=Array(e.size);return e.forEach(function(n,s){r[++t]=[s,n]}),r}var ePe=Z5e;function tPe(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var VD=tPe,_8=k1,N8=Q5e,rPe=ED,nPe=wJ,aPe=ePe,sPe=VD,oPe=1,iPe=2,lPe="[object Boolean]",cPe="[object Date]",dPe="[object Error]",uPe="[object Map]",fPe="[object Number]",mPe="[object RegExp]",hPe="[object Set]",pPe="[object String]",gPe="[object Symbol]",vPe="[object ArrayBuffer]",xPe="[object DataView]",S8=_8?_8.prototype:void 0,VA=S8?S8.valueOf:void 0;function yPe(e,t,r,n,s,o,i){switch(r){case xPe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case vPe:return!(e.byteLength!=t.byteLength||!o(new N8(e),new N8(t)));case lPe:case cPe:case fPe:return rPe(+e,+t);case dPe:return e.name==t.name&&e.message==t.message;case mPe:case pPe:return e==t+"";case uPe:var l=aPe;case hPe:var c=n&oPe;if(l||(l=sPe),e.size!=t.size&&!c)return!1;var d=i.get(e);if(d)return d==t;n|=iPe,i.set(e,t);var u=nPe(l(e),l(t),n,s,o,i);return i.delete(e),u;case gPe:if(VA)return VA.call(e)==VA.call(t)}return!1}var bPe=yPe;function wPe(e,t){for(var r=-1,n=t.length,s=e.length;++r<n;)e[s+r]=t[r];return e}var jJ=wPe,jPe=jJ,_Pe=dc;function NPe(e,t,r){var n=t(e);return _Pe(e)?n:jPe(n,r(e))}var SPe=NPe;function CPe(e,t){for(var r=-1,n=e==null?0:e.length,s=0,o=[];++r<n;){var i=e[r];t(i,r,e)&&(o[s++]=i)}return o}var PPe=CPe;function APe(){return[]}var EPe=APe,kPe=PPe,IPe=EPe,OPe=Object.prototype,TPe=OPe.propertyIsEnumerable,C8=Object.getOwnPropertySymbols,DPe=C8?function(e){return e==null?[]:(e=Object(e),kPe(C8(e),function(t){return TPe.call(e,t)}))}:IPe,MPe=DPe;function RPe(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var LPe=RPe,FPe=dm,$Pe=um,BPe="[object Arguments]";function qPe(e){return $Pe(e)&&FPe(e)==BPe}var zPe=qPe,P8=zPe,UPe=um,_J=Object.prototype,VPe=_J.hasOwnProperty,WPe=_J.propertyIsEnumerable,HPe=P8(function(){return arguments}())?P8:function(e){return UPe(e)&&VPe.call(e,"callee")&&!WPe.call(e,"callee")},WD=HPe,NN={exports:{}};function GPe(){return!1}var KPe=GPe;NN.exports;(function(e,t){var r=uf,n=KPe,s=t&&!t.nodeType&&t,o=s&&!0&&e&&!e.nodeType&&e,i=o&&o.exports===s,l=i?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||n;e.exports=d})(NN,NN.exports);var NJ=NN.exports,XPe=9007199254740991,YPe=/^(?:0|[1-9]\d*)$/;function JPe(e,t){var r=typeof e;return t=t??XPe,!!t&&(r=="number"||r!="symbol"&&YPe.test(e))&&e>-1&&e%1==0&&e<t}var HD=JPe,QPe=9007199254740991;function ZPe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=QPe}var GD=ZPe,eAe=dm,tAe=GD,rAe=um,nAe="[object Arguments]",aAe="[object Array]",sAe="[object Boolean]",oAe="[object Date]",iAe="[object Error]",lAe="[object Function]",cAe="[object Map]",dAe="[object Number]",uAe="[object Object]",fAe="[object RegExp]",mAe="[object Set]",hAe="[object String]",pAe="[object WeakMap]",gAe="[object ArrayBuffer]",vAe="[object DataView]",xAe="[object Float32Array]",yAe="[object Float64Array]",bAe="[object Int8Array]",wAe="[object Int16Array]",jAe="[object Int32Array]",_Ae="[object Uint8Array]",NAe="[object Uint8ClampedArray]",SAe="[object Uint16Array]",CAe="[object Uint32Array]",Rs={};Rs[xAe]=Rs[yAe]=Rs[bAe]=Rs[wAe]=Rs[jAe]=Rs[_Ae]=Rs[NAe]=Rs[SAe]=Rs[CAe]=!0;Rs[nAe]=Rs[aAe]=Rs[gAe]=Rs[sAe]=Rs[vAe]=Rs[oAe]=Rs[iAe]=Rs[lAe]=Rs[cAe]=Rs[dAe]=Rs[uAe]=Rs[fAe]=Rs[mAe]=Rs[hAe]=Rs[pAe]=!1;function PAe(e){return rAe(e)&&tAe(e.length)&&!!Rs[eAe(e)]}var AAe=PAe;function EAe(e){return function(t){return e(t)}}var SJ=EAe,SN={exports:{}};SN.exports;(function(e,t){var r=OY,n=t&&!t.nodeType&&t,s=n&&!0&&e&&!e.nodeType&&e,o=s&&s.exports===n,i=o&&r.process,l=function(){try{var c=s&&s.require&&s.require("util").types;return c||i&&i.binding&&i.binding("util")}catch{}}();e.exports=l})(SN,SN.exports);var kAe=SN.exports,IAe=AAe,OAe=SJ,A8=kAe,E8=A8&&A8.isTypedArray,TAe=E8?OAe(E8):IAe,CJ=TAe,DAe=LPe,MAe=WD,RAe=dc,LAe=NJ,FAe=HD,$Ae=CJ,BAe=Object.prototype,qAe=BAe.hasOwnProperty;function zAe(e,t){var r=RAe(e),n=!r&&MAe(e),s=!r&&!n&&LAe(e),o=!r&&!n&&!s&&$Ae(e),i=r||n||s||o,l=i?DAe(e.length,String):[],c=l.length;for(var d in e)(t||qAe.call(e,d))&&!(i&&(d=="length"||s&&(d=="offset"||d=="parent")||o&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||FAe(d,c)))&&l.push(d);return l}var UAe=zAe,VAe=Object.prototype;function WAe(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||VAe;return e===r}var HAe=WAe;function GAe(e,t){return function(r){return e(t(r))}}var PJ=GAe,KAe=PJ,XAe=KAe(Object.keys,Object),YAe=XAe,JAe=HAe,QAe=YAe,ZAe=Object.prototype,eEe=ZAe.hasOwnProperty;function tEe(e){if(!JAe(e))return QAe(e);var t=[];for(var r in Object(e))eEe.call(e,r)&&r!="constructor"&&t.push(r);return t}var rEe=tEe,nEe=AD,aEe=GD;function sEe(e){return e!=null&&aEe(e.length)&&!nEe(e)}var I1=sEe,oEe=UAe,iEe=rEe,lEe=I1;function cEe(e){return lEe(e)?oEe(e):iEe(e)}var l5=cEe,dEe=SPe,uEe=MPe,fEe=l5;function mEe(e){return dEe(e,fEe,uEe)}var hEe=mEe,k8=hEe,pEe=1,gEe=Object.prototype,vEe=gEe.hasOwnProperty;function xEe(e,t,r,n,s,o){var i=r&pEe,l=k8(e),c=l.length,d=k8(t),u=d.length;if(c!=u&&!i)return!1;for(var f=c;f--;){var h=l[f];if(!(i?h in t:vEe.call(t,h)))return!1}var m=o.get(e),v=o.get(t);if(m&&v)return m==t&&v==e;var g=!0;o.set(e,t),o.set(t,e);for(var y=i;++f<c;){h=l[f];var x=e[h],b=t[h];if(n)var w=i?n(b,x,h,t,e,o):n(x,b,h,e,t,o);if(!(w===void 0?x===b||s(x,b,r,n,o):w)){g=!1;break}y||(y=h=="constructor")}if(g&&!y){var j=e.constructor,_=t.constructor;j!=_&&"constructor"in e&&"constructor"in t&&!(typeof j=="function"&&j instanceof j&&typeof _=="function"&&_ instanceof _)&&(g=!1)}return o.delete(e),o.delete(t),g}var yEe=xEe,bEe=Lg,wEe=uf,jEe=bEe(wEe,"DataView"),_Ee=jEe,NEe=Lg,SEe=uf,CEe=NEe(SEe,"Promise"),PEe=CEe,AEe=Lg,EEe=uf,kEe=AEe(EEe,"Set"),AJ=kEe,IEe=Lg,OEe=uf,TEe=IEe(OEe,"WeakMap"),DEe=TEe,mO=_Ee,hO=kD,pO=PEe,gO=AJ,vO=DEe,EJ=dm,L0=DY,I8="[object Map]",MEe="[object Object]",O8="[object Promise]",T8="[object Set]",D8="[object WeakMap]",M8="[object DataView]",REe=L0(mO),LEe=L0(hO),FEe=L0(pO),$Ee=L0(gO),BEe=L0(vO),Sp=EJ;(mO&&Sp(new mO(new ArrayBuffer(1)))!=M8||hO&&Sp(new hO)!=I8||pO&&Sp(pO.resolve())!=O8||gO&&Sp(new gO)!=T8||vO&&Sp(new vO)!=D8)&&(Sp=function(e){var t=EJ(e),r=t==MEe?e.constructor:void 0,n=r?L0(r):"";if(n)switch(n){case REe:return M8;case LEe:return I8;case FEe:return O8;case $Ee:return T8;case BEe:return D8}return t});var qEe=Sp,WA=vJ,zEe=wJ,UEe=bPe,VEe=yEe,R8=qEe,L8=dc,F8=NJ,WEe=CJ,HEe=1,$8="[object Arguments]",B8="[object Array]",oj="[object Object]",GEe=Object.prototype,q8=GEe.hasOwnProperty;function KEe(e,t,r,n,s,o){var i=L8(e),l=L8(t),c=i?B8:R8(e),d=l?B8:R8(t);c=c==$8?oj:c,d=d==$8?oj:d;var u=c==oj,f=d==oj,h=c==d;if(h&&F8(e)){if(!F8(t))return!1;i=!0,u=!1}if(h&&!u)return o||(o=new WA),i||WEe(e)?zEe(e,t,r,n,s,o):UEe(e,t,c,r,n,s,o);if(!(r&HEe)){var m=u&&q8.call(e,"__wrapped__"),v=f&&q8.call(t,"__wrapped__");if(m||v){var g=m?e.value():e,y=v?t.value():t;return o||(o=new WA),s(g,y,r,n,o)}}return h?(o||(o=new WA),VEe(e,t,r,n,s,o)):!1}var XEe=KEe,YEe=XEe,z8=um;function kJ(e,t,r,n,s){return e===t?!0:e==null||t==null||!z8(e)&&!z8(t)?e!==e&&t!==t:YEe(e,t,r,n,kJ,s)}var KD=kJ,JEe=vJ,QEe=KD,ZEe=1,eke=2;function tke(e,t,r,n){var s=r.length,o=s,i=!n;if(e==null)return!o;for(e=Object(e);s--;){var l=r[s];if(i&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++s<o;){l=r[s];var c=l[0],d=e[c],u=l[1];if(i&&l[2]){if(d===void 0&&!(c in e))return!1}else{var f=new JEe;if(n)var h=n(d,u,c,e,t,f);if(!(h===void 0?QEe(u,d,ZEe|eke,n,f):h))return!1}}return!0}var rke=tke,nke=Xh;function ake(e){return e===e&&!nke(e)}var IJ=ake,ske=IJ,oke=l5;function ike(e){for(var t=oke(e),r=t.length;r--;){var n=t[r],s=e[n];t[r]=[n,s,ske(s)]}return t}var lke=ike;function cke(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var OJ=cke,dke=rke,uke=lke,fke=OJ;function mke(e){var t=uke(e);return t.length==1&&t[0][2]?fke(t[0][0],t[0][1]):function(r){return r===e||dke(r,e,t)}}var hke=mke;function pke(e,t){return e!=null&&t in Object(e)}var gke=pke,vke=$Y,xke=WD,yke=dc,bke=HD,wke=GD,jke=GC;function _ke(e,t,r){t=vke(t,e);for(var n=-1,s=t.length,o=!1;++n<s;){var i=jke(t[n]);if(!(o=e!=null&&r(e,i)))break;e=e[i]}return o||++n!=s?o:(s=e==null?0:e.length,!!s&&wke(s)&&bke(i,s)&&(yke(e)||xke(e)))}var Nke=_ke,Ske=gke,Cke=Nke;function Pke(e,t){return e!=null&&Cke(e,t,Ske)}var Ake=Pke,Eke=KD,kke=BY,Ike=Ake,Oke=PD,Tke=IJ,Dke=OJ,Mke=GC,Rke=1,Lke=2;function Fke(e,t){return Oke(e)&&Tke(t)?Dke(Mke(e),t):function(r){var n=kke(r,e);return n===void 0&&n===t?Ike(r,e):Eke(t,n,Rke|Lke)}}var $ke=Fke;function Bke(e){return e}var F0=Bke;function qke(e){return function(t){return t?.[e]}}var zke=qke,Uke=DD;function Vke(e){return function(t){return Uke(t,e)}}var Wke=Vke,Hke=zke,Gke=Wke,Kke=PD,Xke=GC;function Yke(e){return Kke(e)?Hke(Xke(e)):Gke(e)}var Jke=Yke,Qke=hke,Zke=$ke,eIe=F0,tIe=dc,rIe=Jke;function nIe(e){return typeof e=="function"?e:e==null?eIe:typeof e=="object"?tIe(e)?Zke(e[0],e[1]):Qke(e):rIe(e)}var ff=nIe;function aIe(e,t,r,n){for(var s=e.length,o=r+(n?1:-1);n?o--:++o<s;)if(t(e[o],o,e))return o;return-1}var TJ=aIe;function sIe(e){return e!==e}var oIe=sIe;function iIe(e,t,r){for(var n=r-1,s=e.length;++n<s;)if(e[n]===t)return n;return-1}var lIe=iIe,cIe=TJ,dIe=oIe,uIe=lIe;function fIe(e,t,r){return t===t?uIe(e,t,r):cIe(e,dIe,r)}var mIe=fIe,hIe=mIe;function pIe(e,t){var r=e==null?0:e.length;return!!r&&hIe(e,t,0)>-1}var gIe=pIe;function vIe(e,t,r){for(var n=-1,s=e==null?0:e.length;++n<s;)if(r(t,e[n]))return!0;return!1}var xIe=vIe;function yIe(){}var bIe=yIe,HA=AJ,wIe=bIe,jIe=VD,_Ie=1/0,NIe=HA&&1/jIe(new HA([,-0]))[1]==_Ie?function(e){return new HA(e)}:wIe,SIe=NIe,CIe=xJ,PIe=gIe,AIe=xIe,EIe=bJ,kIe=SIe,IIe=VD,OIe=200;function TIe(e,t,r){var n=-1,s=PIe,o=e.length,i=!0,l=[],c=l;if(r)i=!1,s=AIe;else if(o>=OIe){var d=t?null:kIe(e);if(d)return IIe(d);i=!1,s=EIe,c=new CIe}else c=t?[]:l;e:for(;++n<o;){var u=e[n],f=t?t(u):u;if(u=r||u!==0?u:0,i&&f===f){for(var h=c.length;h--;)if(c[h]===f)continue e;t&&c.push(f),l.push(u)}else s(c,f,r)||(c!==l&&c.push(f),l.push(u))}return l}var DIe=TIe,MIe=ff,RIe=DIe;function LIe(e,t){return e&&e.length?RIe(e,MIe(t)):[]}var FIe=LIe;const U8=Ua(FIe);function DJ(e,t,r){return t===!0?U8(e,r):Zn(t)?U8(e,t):e}function Bx(e){"@babel/helpers - typeof";return Bx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bx(e)}var $Ie=["ref"];function V8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function yf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V8(Object(r),!0).forEach(function(n){c5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RJ(n.key),n)}}function qIe(e,t,r){return t&&W8(e.prototype,t),r&&W8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zIe(e,t,r){return t=CN(t),UIe(e,MJ()?Reflect.construct(t,r||[],CN(e).constructor):t.apply(e,r))}function UIe(e,t){if(t&&(Bx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VIe(e)}function VIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(MJ=function(){return!!e})()}function CN(e){return CN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},CN(e)}function WIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xO(e,t)}function xO(e,t){return xO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},xO(e,t)}function c5(e,t,r){return t=RJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RJ(e){var t=HIe(e,"string");return Bx(t)=="symbol"?t:t+""}function HIe(e,t){if(Bx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GIe(e,t){if(e==null)return{};var r=KIe(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function KIe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function XIe(e){return e.value}function YIe(e,t){if(Pe.isValidElement(e))return Pe.cloneElement(e,t);if(typeof e=="function")return Pe.createElement(e,t);t.ref;var r=GIe(t,$Ie);return Pe.createElement(UD,r)}var H8=1,Zp=function(e){function t(){var r;BIe(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return r=zIe(this,t,[].concat(s)),c5(r,"lastBoundingBox",{width:-1,height:-1}),r}return WIe(t,e),qIe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,s=this.getBBox();s?(Math.abs(s.width-this.lastBoundingBox.width)>H8||Math.abs(s.height-this.lastBoundingBox.height)>H8)&&(this.lastBoundingBox.width=s.width,this.lastBoundingBox.height=s.height,n&&n(s)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?yf({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var s=this.props,o=s.layout,i=s.align,l=s.verticalAlign,c=s.margin,d=s.chartWidth,u=s.chartHeight,f,h;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(i==="center"&&o==="vertical"){var m=this.getBBoxSnapshot();f={left:((d||0)-m.width)/2}}else f=i==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(l==="middle"){var v=this.getBBoxSnapshot();h={top:((u||0)-v.height)/2}}else h=l==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return yf(yf({},f),h)}},{key:"render",value:function(){var n=this,s=this.props,o=s.content,i=s.width,l=s.height,c=s.wrapperStyle,d=s.payloadUniqBy,u=s.payload,f=yf(yf({position:"absolute",width:i||"auto",height:l||"auto"},this.getDefaultPosition(c)),c);return Pe.createElement("div",{className:"recharts-legend-wrapper",style:f,ref:function(m){n.wrapperNode=m}},YIe(o,yf(yf({},this.props),{},{payload:DJ(u,d,XIe)})))}}],[{key:"getWithHeight",value:function(n,s){var o=yf(yf({},this.defaultProps),n.props),i=o.layout;return i==="vertical"&&Xr(n.props.height)?{height:n.props.height}:i==="horizontal"?{width:n.props.width||s}:null}}])}(p.PureComponent);c5(Zp,"displayName","Legend");c5(Zp,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var G8=k1,JIe=WD,QIe=dc,K8=G8?G8.isConcatSpreadable:void 0;function ZIe(e){return QIe(e)||JIe(e)||!!(K8&&e&&e[K8])}var eOe=ZIe,tOe=jJ,rOe=eOe;function LJ(e,t,r,n,s){var o=-1,i=e.length;for(r||(r=rOe),s||(s=[]);++o<i;){var l=e[o];t>0&&r(l)?t>1?LJ(l,t-1,r,n,s):tOe(s,l):n||(s[s.length]=l)}return s}var FJ=LJ;function nOe(e){return function(t,r,n){for(var s=-1,o=Object(t),i=n(t),l=i.length;l--;){var c=i[e?l:++s];if(r(o[c],c,o)===!1)break}return t}}var aOe=nOe,sOe=aOe,oOe=sOe(),iOe=oOe,lOe=iOe,cOe=l5;function dOe(e,t){return e&&lOe(e,t,cOe)}var $J=dOe,uOe=I1;function fOe(e,t){return function(r,n){if(r==null)return r;if(!uOe(r))return e(r,n);for(var s=r.length,o=t?s:-1,i=Object(r);(t?o--:++o<s)&&n(i[o],o,i)!==!1;);return r}}var mOe=fOe,hOe=$J,pOe=mOe,gOe=pOe(hOe),XD=gOe,vOe=XD,xOe=I1;function yOe(e,t){var r=-1,n=xOe(e)?Array(e.length):[];return vOe(e,function(s,o,i){n[++r]=t(s,o,i)}),n}var BJ=yOe;function bOe(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var wOe=bOe,X8=k0;function jOe(e,t){if(e!==t){var r=e!==void 0,n=e===null,s=e===e,o=X8(e),i=t!==void 0,l=t===null,c=t===t,d=X8(t);if(!l&&!d&&!o&&e>t||o&&i&&c&&!l&&!d||n&&i&&c||!r&&c||!s)return 1;if(!n&&!o&&!d&&e<t||d&&r&&s&&!n&&!o||l&&r&&s||!i&&s||!c)return-1}return 0}var _Oe=jOe,NOe=_Oe;function SOe(e,t,r){for(var n=-1,s=e.criteria,o=t.criteria,i=s.length,l=r.length;++n<i;){var c=NOe(s[n],o[n]);if(c){if(n>=l)return c;var d=r[n];return c*(d=="desc"?-1:1)}}return e.index-t.index}var COe=SOe,GA=TD,POe=DD,AOe=ff,EOe=BJ,kOe=wOe,IOe=SJ,OOe=COe,TOe=F0,DOe=dc;function MOe(e,t,r){t.length?t=GA(t,function(o){return DOe(o)?function(i){return POe(i,o.length===1?o[0]:o)}:o}):t=[TOe];var n=-1;t=GA(t,IOe(AOe));var s=EOe(e,function(o,i,l){var c=GA(t,function(d){return d(o)});return{criteria:c,index:++n,value:o}});return kOe(s,function(o,i){return OOe(o,i,r)})}var ROe=MOe;function LOe(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var FOe=LOe,$Oe=FOe,Y8=Math.max;function BOe(e,t,r){return t=Y8(t===void 0?e.length-1:t,0),function(){for(var n=arguments,s=-1,o=Y8(n.length-t,0),i=Array(o);++s<o;)i[s]=n[t+s];s=-1;for(var l=Array(t+1);++s<t;)l[s]=n[s];return l[t]=r(i),$Oe(e,this,l)}}var qOe=BOe;function zOe(e){return function(){return e}}var UOe=zOe,VOe=Lg,WOe=function(){try{var e=VOe(Object,"defineProperty");return e({},"",{}),e}catch{}}(),qJ=WOe,HOe=UOe,J8=qJ,GOe=F0,KOe=J8?function(e,t){return J8(e,"toString",{configurable:!0,enumerable:!1,value:HOe(t),writable:!0})}:GOe,XOe=KOe,YOe=800,JOe=16,QOe=Date.now;function ZOe(e){var t=0,r=0;return function(){var n=QOe(),s=JOe-(n-r);if(r=n,s>0){if(++t>=YOe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var eTe=ZOe,tTe=XOe,rTe=eTe,nTe=rTe(tTe),aTe=nTe,sTe=F0,oTe=qOe,iTe=aTe;function lTe(e,t){return iTe(oTe(e,t,sTe),e+"")}var cTe=lTe,dTe=ED,uTe=I1,fTe=HD,mTe=Xh;function hTe(e,t,r){if(!mTe(r))return!1;var n=typeof t;return(n=="number"?uTe(r)&&fTe(t,r.length):n=="string"&&t in r)?dTe(r[t],e):!1}var d5=hTe,pTe=FJ,gTe=ROe,vTe=cTe,Q8=d5,xTe=vTe(function(e,t){if(e==null)return[];var r=t.length;return r>1&&Q8(e,t[0],t[1])?t=[]:r>2&&Q8(t[0],t[1],t[2])&&(t=[t[0]]),gTe(e,pTe(t,1),[])}),yTe=xTe;const YD=Ua(yTe);function hw(e){"@babel/helpers - typeof";return hw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hw(e)}function yO(){return yO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yO.apply(this,arguments)}function bTe(e,t){return NTe(e)||_Te(e,t)||jTe(e,t)||wTe()}function wTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jTe(e,t){if(e){if(typeof e=="string")return Z8(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Z8(e,t)}}function Z8(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _Te(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function NTe(e){if(Array.isArray(e))return e}function eB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function KA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eB(Object(r),!0).forEach(function(n){STe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function STe(e,t,r){return t=CTe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CTe(e){var t=PTe(e,"string");return hw(t)=="symbol"?t:t+""}function PTe(e,t){if(hw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(hw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ATe(e){return Array.isArray(e)&&ai(e[0])&&ai(e[1])?e.join(" ~ "):e}var ETe=function(t){var r=t.separator,n=r===void 0?" : ":r,s=t.contentStyle,o=s===void 0?{}:s,i=t.itemStyle,l=i===void 0?{}:i,c=t.labelStyle,d=c===void 0?{}:c,u=t.payload,f=t.formatter,h=t.itemSorter,m=t.wrapperClassName,v=t.labelClassName,g=t.label,y=t.labelFormatter,x=t.accessibilityLayer,b=x===void 0?!1:x,w=function(){if(u&&u.length){var I={padding:0,margin:0},M=(h?YD(u,h):u).map(function(D,U){if(D.type==="none")return null;var z=KA({display:"block",paddingTop:4,paddingBottom:4,color:D.color||"#000"},l),W=D.formatter||f||ATe,$=D.value,X=D.name,ye=$,Se=X;if(W&&ye!=null&&Se!=null){var V=W($,X,D,U,u);if(Array.isArray(V)){var B=bTe(V,2);ye=B[0],Se=B[1]}else ye=V}return Pe.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(U),style:z},ai(Se)?Pe.createElement("span",{className:"recharts-tooltip-item-name"},Se):null,ai(Se)?Pe.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,Pe.createElement("span",{className:"recharts-tooltip-item-value"},ye),Pe.createElement("span",{className:"recharts-tooltip-item-unit"},D.unit||""))});return Pe.createElement("ul",{className:"recharts-tooltip-item-list",style:I},M)}return null},j=KA({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},o),_=KA({margin:0},d),S=!la(g),C=S?g:"",P=fa("recharts-default-tooltip",m),A=fa("recharts-tooltip-label",v);S&&y&&u!==void 0&&u!==null&&(C=y(g,u));var R=b?{role:"status","aria-live":"assertive"}:{};return Pe.createElement("div",yO({className:P,style:j},R),Pe.createElement("p",{className:A,style:_},Pe.isValidElement(C)?C:"".concat(C)),w())};function pw(e){"@babel/helpers - typeof";return pw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pw(e)}function ij(e,t,r){return t=kTe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kTe(e){var t=ITe(e,"string");return pw(t)=="symbol"?t:t+""}function ITe(e,t){if(pw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(pw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vy="recharts-tooltip-wrapper",OTe={visibility:"hidden"};function TTe(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return fa(vy,ij(ij(ij(ij({},"".concat(vy,"-right"),Xr(r)&&t&&Xr(t.x)&&r>=t.x),"".concat(vy,"-left"),Xr(r)&&t&&Xr(t.x)&&r<t.x),"".concat(vy,"-bottom"),Xr(n)&&t&&Xr(t.y)&&n>=t.y),"".concat(vy,"-top"),Xr(n)&&t&&Xr(t.y)&&n<t.y))}function tB(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,s=e.offsetTopLeft,o=e.position,i=e.reverseDirection,l=e.tooltipDimension,c=e.viewBox,d=e.viewBoxDimension;if(o&&Xr(o[n]))return o[n];var u=r[n]-l-s,f=r[n]+s;if(t[n])return i[n]?u:f;if(i[n]){var h=u,m=c[n];return h<m?Math.max(f,c[n]):Math.max(u,c[n])}var v=f+l,g=c[n]+d;return v>g?Math.max(u,c[n]):Math.max(f,c[n])}function DTe(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function MTe(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,s=e.position,o=e.reverseDirection,i=e.tooltipBox,l=e.useTranslate3d,c=e.viewBox,d,u,f;return i.height>0&&i.width>0&&r?(u=tB({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:s,reverseDirection:o,tooltipDimension:i.width,viewBox:c,viewBoxDimension:c.width}),f=tB({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:s,reverseDirection:o,tooltipDimension:i.height,viewBox:c,viewBoxDimension:c.height}),d=DTe({translateX:u,translateY:f,useTranslate3d:l})):d=OTe,{cssProperties:d,cssClasses:TTe({translateX:u,translateY:f,coordinate:r})}}function qx(e){"@babel/helpers - typeof";return qx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qx(e)}function rB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function nB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rB(Object(r),!0).forEach(function(n){wO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UJ(n.key),n)}}function LTe(e,t,r){return t&&aB(e.prototype,t),r&&aB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function FTe(e,t,r){return t=PN(t),$Te(e,zJ()?Reflect.construct(t,r||[],PN(e).constructor):t.apply(e,r))}function $Te(e,t){if(t&&(qx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BTe(e)}function BTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(zJ=function(){return!!e})()}function PN(e){return PN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},PN(e)}function qTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bO(e,t)}function bO(e,t){return bO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},bO(e,t)}function wO(e,t,r){return t=UJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UJ(e){var t=zTe(e,"string");return qx(t)=="symbol"?t:t+""}function zTe(e,t){if(qx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sB=1,UTe=function(e){function t(){var r;RTe(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return r=FTe(this,t,[].concat(s)),wO(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),wO(r,"handleKeyDown",function(i){if(i.key==="Escape"){var l,c,d,u;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(l=(c=r.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&l!==void 0?l:0,y:(d=(u=r.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&d!==void 0?d:0}})}}),r}return qTe(t,e),LTe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>sB||Math.abs(n.height-this.state.lastBoundingBox.height)>sB)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,s;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,s=this.props,o=s.active,i=s.allowEscapeViewBox,l=s.animationDuration,c=s.animationEasing,d=s.children,u=s.coordinate,f=s.hasPayload,h=s.isAnimationActive,m=s.offset,v=s.position,g=s.reverseDirection,y=s.useTranslate3d,x=s.viewBox,b=s.wrapperStyle,w=MTe({allowEscapeViewBox:i,coordinate:u,offsetTopLeft:m,position:v,reverseDirection:g,tooltipBox:this.state.lastBoundingBox,useTranslate3d:y,viewBox:x}),j=w.cssClasses,_=w.cssProperties,S=nB(nB({transition:h&&o?"transform ".concat(l,"ms ").concat(c):void 0},_),{},{pointerEvents:"none",visibility:!this.state.dismissed&&o&&f?"visible":"hidden",position:"absolute",top:0,left:0},b);return Pe.createElement("div",{tabIndex:-1,className:j,style:S,ref:function(P){n.wrapperNode=P}},d)}}])}(p.PureComponent),VTe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},mu={isSsr:VTe(),get:function(t){return mu[t]},set:function(t,r){if(typeof t=="string")mu[t]=r;else{var n=Object.keys(t);n&&n.length&&n.forEach(function(s){mu[s]=t[s]})}}};function zx(e){"@babel/helpers - typeof";return zx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zx(e)}function oB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function iB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oB(Object(r),!0).forEach(function(n){JD(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function WTe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WJ(n.key),n)}}function HTe(e,t,r){return t&&lB(e.prototype,t),r&&lB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function GTe(e,t,r){return t=AN(t),KTe(e,VJ()?Reflect.construct(t,r||[],AN(e).constructor):t.apply(e,r))}function KTe(e,t){if(t&&(zx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XTe(e)}function XTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(VJ=function(){return!!e})()}function AN(e){return AN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},AN(e)}function YTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jO(e,t)}function jO(e,t){return jO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},jO(e,t)}function JD(e,t,r){return t=WJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WJ(e){var t=JTe(e,"string");return zx(t)=="symbol"?t:t+""}function JTe(e,t){if(zx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function QTe(e){return e.dataKey}function ZTe(e,t){return Pe.isValidElement(e)?Pe.cloneElement(e,t):typeof e=="function"?Pe.createElement(e,t):Pe.createElement(ETe,t)}var Xl=function(e){function t(){return WTe(this,t),GTe(this,t,arguments)}return YTe(t,e),HTe(t,[{key:"render",value:function(){var n=this,s=this.props,o=s.active,i=s.allowEscapeViewBox,l=s.animationDuration,c=s.animationEasing,d=s.content,u=s.coordinate,f=s.filterNull,h=s.isAnimationActive,m=s.offset,v=s.payload,g=s.payloadUniqBy,y=s.position,x=s.reverseDirection,b=s.useTranslate3d,w=s.viewBox,j=s.wrapperStyle,_=v??[];f&&_.length&&(_=DJ(v.filter(function(C){return C.value!=null&&(C.hide!==!0||n.props.includeHidden)}),g,QTe));var S=_.length>0;return Pe.createElement(UTe,{allowEscapeViewBox:i,animationDuration:l,animationEasing:c,isAnimationActive:h,active:o,coordinate:u,hasPayload:S,offset:m,position:y,reverseDirection:x,useTranslate3d:b,viewBox:w,wrapperStyle:j},ZTe(d,iB(iB({},this.props),{},{payload:_})))}}])}(p.PureComponent);JD(Xl,"displayName","Tooltip");JD(Xl,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!mu.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var e3e=uf,t3e=function(){return e3e.Date.now()},r3e=t3e,n3e=/\s/;function a3e(e){for(var t=e.length;t--&&n3e.test(e.charAt(t)););return t}var s3e=a3e,o3e=s3e,i3e=/^\s+/;function l3e(e){return e&&e.slice(0,o3e(e)+1).replace(i3e,"")}var c3e=l3e,d3e=c3e,cB=Xh,u3e=k0,dB=0/0,f3e=/^[-+]0x[0-9a-f]+$/i,m3e=/^0b[01]+$/i,h3e=/^0o[0-7]+$/i,p3e=parseInt;function g3e(e){if(typeof e=="number")return e;if(u3e(e))return dB;if(cB(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=cB(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=d3e(e);var r=m3e.test(e);return r||h3e.test(e)?p3e(e.slice(2),r?2:8):f3e.test(e)?dB:+e}var HJ=g3e,v3e=Xh,XA=r3e,uB=HJ,x3e="Expected a function",y3e=Math.max,b3e=Math.min;function w3e(e,t,r){var n,s,o,i,l,c,d=0,u=!1,f=!1,h=!0;if(typeof e!="function")throw new TypeError(x3e);t=uB(t)||0,v3e(r)&&(u=!!r.leading,f="maxWait"in r,o=f?y3e(uB(r.maxWait)||0,t):o,h="trailing"in r?!!r.trailing:h);function m(S){var C=n,P=s;return n=s=void 0,d=S,i=e.apply(P,C),i}function v(S){return d=S,l=setTimeout(x,t),u?m(S):i}function g(S){var C=S-c,P=S-d,A=t-C;return f?b3e(A,o-P):A}function y(S){var C=S-c,P=S-d;return c===void 0||C>=t||C<0||f&&P>=o}function x(){var S=XA();if(y(S))return b(S);l=setTimeout(x,g(S))}function b(S){return l=void 0,h&&n?m(S):(n=s=void 0,i)}function w(){l!==void 0&&clearTimeout(l),d=0,n=c=s=l=void 0}function j(){return l===void 0?i:b(XA())}function _(){var S=XA(),C=y(S);if(n=arguments,s=this,c=S,C){if(l===void 0)return v(c);if(f)return clearTimeout(l),l=setTimeout(x,t),m(c)}return l===void 0&&(l=setTimeout(x,t)),i}return _.cancel=w,_.flush=j,_}var j3e=w3e,_3e=j3e,N3e=Xh,S3e="Expected a function";function C3e(e,t,r){var n=!0,s=!0;if(typeof e!="function")throw new TypeError(S3e);return N3e(r)&&(n="leading"in r?!!r.leading:n,s="trailing"in r?!!r.trailing:s),_3e(e,t,{leading:n,maxWait:t,trailing:s})}var P3e=C3e;const GJ=Ua(P3e);function gw(e){"@babel/helpers - typeof";return gw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gw(e)}function fB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function lj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fB(Object(r),!0).forEach(function(n){A3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function A3e(e,t,r){return t=E3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function E3e(e){var t=k3e(e,"string");return gw(t)=="symbol"?t:t+""}function k3e(e,t){if(gw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function I3e(e,t){return M3e(e)||D3e(e,t)||T3e(e,t)||O3e()}function O3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function T3e(e,t){if(e){if(typeof e=="string")return mB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mB(e,t)}}function mB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function D3e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function M3e(e){if(Array.isArray(e))return e}var fb=p.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,s=n===void 0?{width:-1,height:-1}:n,o=e.width,i=o===void 0?"100%":o,l=e.height,c=l===void 0?"100%":l,d=e.minWidth,u=d===void 0?0:d,f=e.minHeight,h=e.maxHeight,m=e.children,v=e.debounce,g=v===void 0?0:v,y=e.id,x=e.className,b=e.onResize,w=e.style,j=w===void 0?{}:w,_=p.useRef(null),S=p.useRef();S.current=b,p.useImperativeHandle(t,function(){return Object.defineProperty(_.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),_.current},configurable:!0})});var C=p.useState({containerWidth:s.width,containerHeight:s.height}),P=I3e(C,2),A=P[0],R=P[1],O=p.useCallback(function(M,D){R(function(U){var z=Math.round(M),W=Math.round(D);return U.containerWidth===z&&U.containerHeight===W?U:{containerWidth:z,containerHeight:W}})},[]);p.useEffect(function(){var M=function(X){var ye,Se=X[0].contentRect,V=Se.width,B=Se.height;O(V,B),(ye=S.current)===null||ye===void 0||ye.call(S,V,B)};g>0&&(M=GJ(M,g,{trailing:!0,leading:!1}));var D=new ResizeObserver(M),U=_.current.getBoundingClientRect(),z=U.width,W=U.height;return O(z,W),D.observe(_.current),function(){D.disconnect()}},[O,g]);var I=p.useMemo(function(){var M=A.containerWidth,D=A.containerHeight;if(M<0||D<0)return null;fu(Fp(i)||Fp(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,i,c),fu(!r||r>0,"The aspect(%s) must be greater than zero.",r);var U=Fp(i)?M:i,z=Fp(c)?D:c;r&&r>0&&(U?z=U/r:z&&(U=z*r),h&&z>h&&(z=h)),fu(U>0||z>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,U,z,i,c,u,f,r);var W=!Array.isArray(m)&&Uf(m.type).endsWith("Chart");return Pe.Children.map(m,function($){return Pe.isValidElement($)?p.cloneElement($,lj({width:U,height:z},W?{style:lj({height:"100%",width:"100%",maxHeight:z,maxWidth:U},$.props.style)}:{})):$})},[r,m,c,h,f,u,A,i]);return Pe.createElement("div",{id:y?"".concat(y):void 0,className:fa("recharts-responsive-container",x),style:lj(lj({},j),{},{width:i,height:c,minWidth:u,minHeight:f,maxHeight:h}),ref:_},I)}),vw=function(t){return null};vw.displayName="Cell";function xw(e){"@babel/helpers - typeof";return xw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xw(e)}function hB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function _O(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hB(Object(r),!0).forEach(function(n){R3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function R3e(e,t,r){return t=L3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L3e(e){var t=F3e(e,"string");return xw(t)=="symbol"?t:t+""}function F3e(e,t){if(xw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dv={widthCache:{},cacheCount:0},$3e=2e3,B3e={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},pB="recharts_measurement_span";function q3e(e){var t=_O({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var mb=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||mu.isSsr)return{width:0,height:0};var n=q3e(r),s=JSON.stringify({text:t,copyStyle:n});if(dv.widthCache[s])return dv.widthCache[s];try{var o=document.getElementById(pB);o||(o=document.createElement("span"),o.setAttribute("id",pB),o.setAttribute("aria-hidden","true"),document.body.appendChild(o));var i=_O(_O({},B3e),n);Object.assign(o.style,i),o.textContent="".concat(t);var l=o.getBoundingClientRect(),c={width:l.width,height:l.height};return dv.widthCache[s]=c,++dv.cacheCount>$3e&&(dv.cacheCount=0,dv.widthCache={}),c}catch{return{width:0,height:0}}},z3e=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function yw(e){"@babel/helpers - typeof";return yw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yw(e)}function EN(e,t){return H3e(e)||W3e(e,t)||V3e(e,t)||U3e()}function U3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function V3e(e,t){if(e){if(typeof e=="string")return gB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return gB(e,t)}}function gB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function W3e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function H3e(e){if(Array.isArray(e))return e}function G3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,X3e(n.key),n)}}function K3e(e,t,r){return t&&vB(e.prototype,t),r&&vB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function X3e(e){var t=Y3e(e,"string");return yw(t)=="symbol"?t:t+""}function Y3e(e,t){if(yw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xB=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,yB=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,J3e=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Q3e=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,KJ={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Z3e=Object.keys(KJ),Xv="NaN";function e4e(e,t){return e*KJ[t]}var cj=function(){function e(t,r){G3e(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!J3e.test(r)&&(this.num=NaN,this.unit=""),Z3e.includes(r)&&(this.num=e4e(t,r),this.unit="px")}return K3e(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,s=(n=Q3e.exec(r))!==null&&n!==void 0?n:[],o=EN(s,3),i=o[1],l=o[2];return new e(parseFloat(i),l??"")}}])}();function XJ(e){if(e.includes(Xv))return Xv;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=xB.exec(t))!==null&&r!==void 0?r:[],s=EN(n,4),o=s[1],i=s[2],l=s[3],c=cj.parse(o??""),d=cj.parse(l??""),u=i==="*"?c.multiply(d):c.divide(d);if(u.isNaN())return Xv;t=t.replace(xB,u.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,h=(f=yB.exec(t))!==null&&f!==void 0?f:[],m=EN(h,4),v=m[1],g=m[2],y=m[3],x=cj.parse(v??""),b=cj.parse(y??""),w=g==="+"?x.add(b):x.subtract(b);if(w.isNaN())return Xv;t=t.replace(yB,w.toString())}return t}var bB=/\(([^()]*)\)/;function t4e(e){for(var t=e;t.includes("(");){var r=bB.exec(t),n=EN(r,2),s=n[1];t=t.replace(bB,XJ(s))}return t}function r4e(e){var t=e.replace(/\s+/g,"");return t=t4e(t),t=XJ(t),t}function n4e(e){try{return r4e(e)}catch{return Xv}}function YA(e){var t=n4e(e.slice(5,-1));return t===Xv?"":t}var a4e=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],s4e=["dx","dy","angle","className","breakAll"];function NO(){return NO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},NO.apply(this,arguments)}function wB(e,t){if(e==null)return{};var r=o4e(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function o4e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function jB(e,t){return d4e(e)||c4e(e,t)||l4e(e,t)||i4e()}function i4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function l4e(e,t){if(e){if(typeof e=="string")return _B(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _B(e,t)}}function _B(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c4e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function d4e(e){if(Array.isArray(e))return e}var YJ=/[ \f\n\r\t\v\u2028\u2029]+/,JJ=function(t){var r=t.children,n=t.breakAll,s=t.style;try{var o=[];la(r)||(n?o=r.toString().split(""):o=r.toString().split(YJ));var i=o.map(function(c){return{word:c,width:mb(c,s).width}}),l=n?0:mb("",s).width;return{wordsWithComputedWidth:i,spaceWidth:l}}catch{return null}},u4e=function(t,r,n,s,o){var i=t.maxLines,l=t.children,c=t.style,d=t.breakAll,u=Xr(i),f=l,h=function(){var U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return U.reduce(function(z,W){var $=W.word,X=W.width,ye=z[z.length-1];if(ye&&(s==null||o||ye.width+X+n<Number(s)))ye.words.push($),ye.width+=X+n;else{var Se={words:[$],width:X};z.push(Se)}return z},[])},m=h(r),v=function(U){return U.reduce(function(z,W){return z.width>W.width?z:W})};if(!u)return m;for(var g="",y=function(U){var z=f.slice(0,U),W=JJ({breakAll:d,style:c,children:z+g}).wordsWithComputedWidth,$=h(W),X=$.length>i||v($).width>Number(s);return[X,$]},x=0,b=f.length-1,w=0,j;x<=b&&w<=f.length-1;){var _=Math.floor((x+b)/2),S=_-1,C=y(S),P=jB(C,2),A=P[0],R=P[1],O=y(_),I=jB(O,1),M=I[0];if(!A&&!M&&(x=_+1),A&&M&&(b=_-1),!A&&M){j=R;break}w++}return j||m},NB=function(t){var r=la(t)?[]:t.toString().split(YJ);return[{words:r}]},f4e=function(t){var r=t.width,n=t.scaleToFit,s=t.children,o=t.style,i=t.breakAll,l=t.maxLines;if((r||n)&&!mu.isSsr){var c,d,u=JJ({breakAll:i,children:s,style:o});if(u){var f=u.wordsWithComputedWidth,h=u.spaceWidth;c=f,d=h}else return NB(s);return u4e({breakAll:i,children:s,maxLines:l,style:o},c,d,r,n)}return NB(s)},SB="#808080",bg=function(t){var r=t.x,n=r===void 0?0:r,s=t.y,o=s===void 0?0:s,i=t.lineHeight,l=i===void 0?"1em":i,c=t.capHeight,d=c===void 0?"0.71em":c,u=t.scaleToFit,f=u===void 0?!1:u,h=t.textAnchor,m=h===void 0?"start":h,v=t.verticalAnchor,g=v===void 0?"end":v,y=t.fill,x=y===void 0?SB:y,b=wB(t,a4e),w=p.useMemo(function(){return f4e({breakAll:b.breakAll,children:b.children,maxLines:b.maxLines,scaleToFit:f,style:b.style,width:b.width})},[b.breakAll,b.children,b.maxLines,f,b.style,b.width]),j=b.dx,_=b.dy,S=b.angle,C=b.className,P=b.breakAll,A=wB(b,s4e);if(!ai(n)||!ai(o))return null;var R=n+(Xr(j)?j:0),O=o+(Xr(_)?_:0),I;switch(g){case"start":I=YA("calc(".concat(d,")"));break;case"middle":I=YA("calc(".concat((w.length-1)/2," * -").concat(l," + (").concat(d," / 2))"));break;default:I=YA("calc(".concat(w.length-1," * -").concat(l,")"));break}var M=[];if(f){var D=w[0].width,U=b.width;M.push("scale(".concat((Xr(U)?U/D:1)/D,")"))}return S&&M.push("rotate(".concat(S,", ").concat(R,", ").concat(O,")")),M.length&&(A.transform=M.join(" ")),Pe.createElement("text",NO({},Bn(A,!0),{x:R,y:O,className:fa("recharts-text",C),textAnchor:m,fill:x.includes("url")?SB:x}),w.map(function(z,W){var $=z.words.join(P?"":" ");return Pe.createElement("tspan",{x:R,dy:W===0?I:l,key:"".concat($,"-").concat(W)},$)}))};function yh(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function m4e(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function QD(e){let t,r,n;e.length!==2?(t=yh,r=(l,c)=>yh(e(l),c),n=(l,c)=>e(l)-c):(t=e===yh||e===m4e?e:h4e,r=e,n=e);function s(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<0?d=f+1:u=f}while(d<u)}return d}function o(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<=0?d=f+1:u=f}while(d<u)}return d}function i(l,c,d=0,u=l.length){const f=s(l,c,d,u-1);return f>d&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:s,center:i,right:o}}function h4e(){return 0}function QJ(e){return e===null?NaN:+e}function*p4e(e,t){if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(yield r);else{let r=-1;for(let n of e)(n=t(n,++r,e))!=null&&(n=+n)>=n&&(yield n)}}const g4e=QD(yh),v4e=g4e.right;QD(QJ).center;const O1=v4e;class CB extends Map{constructor(t,r=b4e){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,s]of t)this.set(n,s)}get(t){return super.get(PB(this,t))}has(t){return super.has(PB(this,t))}set(t,r){return super.set(x4e(this,t),r)}delete(t){return super.delete(y4e(this,t))}}function PB({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function x4e({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function y4e({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function b4e(e){return e!==null&&typeof e=="object"?e.valueOf():e}function w4e(e=yh){if(e===yh)return ZJ;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function ZJ(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const j4e=Math.sqrt(50),_4e=Math.sqrt(10),N4e=Math.sqrt(2);function kN(e,t,r){const n=(t-e)/Math.max(0,r),s=Math.floor(Math.log10(n)),o=n/Math.pow(10,s),i=o>=j4e?10:o>=_4e?5:o>=N4e?2:1;let l,c,d;return s<0?(d=Math.pow(10,-s)/i,l=Math.round(e*d),c=Math.round(t*d),l/d<e&&++l,c/d>t&&--c,d=-d):(d=Math.pow(10,s)*i,l=Math.round(e/d),c=Math.round(t/d),l*d<e&&++l,c*d>t&&--c),c<l&&.5<=r&&r<2?kN(e,t,r*2):[l,c,d]}function SO(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[s,o,i]=n?kN(t,e,r):kN(e,t,r);if(!(o>=s))return[];const l=o-s+1,c=new Array(l);if(n)if(i<0)for(let d=0;d<l;++d)c[d]=(o-d)/-i;else for(let d=0;d<l;++d)c[d]=(o-d)*i;else if(i<0)for(let d=0;d<l;++d)c[d]=(s+d)/-i;else for(let d=0;d<l;++d)c[d]=(s+d)*i;return c}function CO(e,t,r){return t=+t,e=+e,r=+r,kN(e,t,r)[2]}function PO(e,t,r){t=+t,e=+e,r=+r;const n=t<e,s=n?CO(t,e,r):CO(e,t,r);return(n?-1:1)*(s<0?1/-s:s)}function AB(e,t){let r;if(t===void 0)for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let s of e)(s=t(s,++n,e))!=null&&(r<s||r===void 0&&s>=s)&&(r=s)}return r}function EB(e,t){let r;if(t===void 0)for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let s of e)(s=t(s,++n,e))!=null&&(r>s||r===void 0&&s>=s)&&(r=s)}return r}function eQ(e,t,r=0,n=1/0,s){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(s=s===void 0?ZJ:w4e(s);n>r;){if(n-r>600){const c=n-r+1,d=t-r+1,u=Math.log(c),f=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*f*(c-f)/c)*(d-c/2<0?-1:1),m=Math.max(r,Math.floor(t-d*f/c+h)),v=Math.min(n,Math.floor(t+(c-d)*f/c+h));eQ(e,t,m,v,s)}const o=e[t];let i=r,l=n;for(xy(e,r,t),s(e[n],o)>0&&xy(e,r,n);i<l;){for(xy(e,i,l),++i,--l;s(e[i],o)<0;)++i;for(;s(e[l],o)>0;)--l}s(e[r],o)===0?xy(e,r,l):(++l,xy(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function xy(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function S4e(e,t,r){if(e=Float64Array.from(p4e(e,r)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return EB(e);if(t>=1)return AB(e);var n,s=(n-1)*t,o=Math.floor(s),i=AB(eQ(e,o).subarray(0,o+1)),l=EB(e.subarray(o+1));return i+(l-i)*(s-o)}}function C4e(e,t,r=QJ){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,s=(n-1)*t,o=Math.floor(s),i=+r(e[o],o,e),l=+r(e[o+1],o+1,e);return i+(l-i)*(s-o)}}function P4e(e,t,r){e=+e,t=+t,r=(s=arguments.length)<2?(t=e,e=0,1):s<3?1:+r;for(var n=-1,s=Math.max(0,Math.ceil((t-e)/r))|0,o=new Array(s);++n<s;)o[n]=e+n*r;return o}function $d(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function fm(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const AO=Symbol("implicit");function ZD(){var e=new CB,t=[],r=[],n=AO;function s(o){let i=e.get(o);if(i===void 0){if(n!==AO)return n;e.set(o,i=t.push(o)-1)}return r[i%r.length]}return s.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new CB;for(const i of o)e.has(i)||e.set(i,t.push(i)-1);return s},s.range=function(o){return arguments.length?(r=Array.from(o),s):r.slice()},s.unknown=function(o){return arguments.length?(n=o,s):n},s.copy=function(){return ZD(t,r).unknown(n)},$d.apply(s,arguments),s}function bw(){var e=ZD().unknown(void 0),t=e.domain,r=e.range,n=0,s=1,o,i,l=!1,c=0,d=0,u=.5;delete e.unknown;function f(){var h=t().length,m=s<n,v=m?s:n,g=m?n:s;o=(g-v)/Math.max(1,h-c+d*2),l&&(o=Math.floor(o)),v+=(g-v-o*(h-c))*u,i=o*(1-c),l&&(v=Math.round(v),i=Math.round(i));var y=P4e(h).map(function(x){return v+o*x});return r(m?y.reverse():y)}return e.domain=function(h){return arguments.length?(t(h),f()):t()},e.range=function(h){return arguments.length?([n,s]=h,n=+n,s=+s,f()):[n,s]},e.rangeRound=function(h){return[n,s]=h,n=+n,s=+s,l=!0,f()},e.bandwidth=function(){return i},e.step=function(){return o},e.round=function(h){return arguments.length?(l=!!h,f()):l},e.padding=function(h){return arguments.length?(c=Math.min(1,d=+h),f()):c},e.paddingInner=function(h){return arguments.length?(c=Math.min(1,h),f()):c},e.paddingOuter=function(h){return arguments.length?(d=+h,f()):d},e.align=function(h){return arguments.length?(u=Math.max(0,Math.min(1,h)),f()):u},e.copy=function(){return bw(t(),[n,s]).round(l).paddingInner(c).paddingOuter(d).align(u)},$d.apply(f(),arguments)}function tQ(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return tQ(t())},e}function hb(){return tQ(bw.apply(null,arguments).paddingInner(1))}function eM(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function rQ(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function T1(){}var ww=.7,IN=1/ww,px="\\s*([+-]?\\d+)\\s*",jw="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",tf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",A4e=/^#([0-9a-f]{3,8})$/,E4e=new RegExp(`^rgb\\(${px},${px},${px}\\)$`),k4e=new RegExp(`^rgb\\(${tf},${tf},${tf}\\)$`),I4e=new RegExp(`^rgba\\(${px},${px},${px},${jw}\\)$`),O4e=new RegExp(`^rgba\\(${tf},${tf},${tf},${jw}\\)$`),T4e=new RegExp(`^hsl\\(${jw},${tf},${tf}\\)$`),D4e=new RegExp(`^hsla\\(${jw},${tf},${tf},${jw}\\)$`),kB={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};eM(T1,_w,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:IB,formatHex:IB,formatHex8:M4e,formatHsl:R4e,formatRgb:OB,toString:OB});function IB(){return this.rgb().formatHex()}function M4e(){return this.rgb().formatHex8()}function R4e(){return nQ(this).formatHsl()}function OB(){return this.rgb().formatRgb()}function _w(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=A4e.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?TB(t):r===3?new tc(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?dj(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?dj(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=E4e.exec(e))?new tc(t[1],t[2],t[3],1):(t=k4e.exec(e))?new tc(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=I4e.exec(e))?dj(t[1],t[2],t[3],t[4]):(t=O4e.exec(e))?dj(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=T4e.exec(e))?RB(t[1],t[2]/100,t[3]/100,1):(t=D4e.exec(e))?RB(t[1],t[2]/100,t[3]/100,t[4]):kB.hasOwnProperty(e)?TB(kB[e]):e==="transparent"?new tc(NaN,NaN,NaN,0):null}function TB(e){return new tc(e>>16&255,e>>8&255,e&255,1)}function dj(e,t,r,n){return n<=0&&(e=t=r=NaN),new tc(e,t,r,n)}function L4e(e){return e instanceof T1||(e=_w(e)),e?(e=e.rgb(),new tc(e.r,e.g,e.b,e.opacity)):new tc}function EO(e,t,r,n){return arguments.length===1?L4e(e):new tc(e,t,r,n??1)}function tc(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}eM(tc,EO,rQ(T1,{brighter(e){return e=e==null?IN:Math.pow(IN,e),new tc(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ww:Math.pow(ww,e),new tc(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new tc(eg(this.r),eg(this.g),eg(this.b),ON(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:DB,formatHex:DB,formatHex8:F4e,formatRgb:MB,toString:MB}));function DB(){return`#${$p(this.r)}${$p(this.g)}${$p(this.b)}`}function F4e(){return`#${$p(this.r)}${$p(this.g)}${$p(this.b)}${$p((isNaN(this.opacity)?1:this.opacity)*255)}`}function MB(){const e=ON(this.opacity);return`${e===1?"rgb(":"rgba("}${eg(this.r)}, ${eg(this.g)}, ${eg(this.b)}${e===1?")":`, ${e})`}`}function ON(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function eg(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function $p(e){return e=eg(e),(e<16?"0":"")+e.toString(16)}function RB(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new ou(e,t,r,n)}function nQ(e){if(e instanceof ou)return new ou(e.h,e.s,e.l,e.opacity);if(e instanceof T1||(e=_w(e)),!e)return new ou;if(e instanceof ou)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,s=Math.min(t,r,n),o=Math.max(t,r,n),i=NaN,l=o-s,c=(o+s)/2;return l?(t===o?i=(r-n)/l+(r<n)*6:r===o?i=(n-t)/l+2:i=(t-r)/l+4,l/=c<.5?o+s:2-o-s,i*=60):l=c>0&&c<1?0:i,new ou(i,l,c,e.opacity)}function $4e(e,t,r,n){return arguments.length===1?nQ(e):new ou(e,t,r,n??1)}function ou(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}eM(ou,$4e,rQ(T1,{brighter(e){return e=e==null?IN:Math.pow(IN,e),new ou(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ww:Math.pow(ww,e),new ou(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,s=2*r-n;return new tc(JA(e>=240?e-240:e+120,s,n),JA(e,s,n),JA(e<120?e+240:e-120,s,n),this.opacity)},clamp(){return new ou(LB(this.h),uj(this.s),uj(this.l),ON(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=ON(this.opacity);return`${e===1?"hsl(":"hsla("}${LB(this.h)}, ${uj(this.s)*100}%, ${uj(this.l)*100}%${e===1?")":`, ${e})`}`}}));function LB(e){return e=(e||0)%360,e<0?e+360:e}function uj(e){return Math.max(0,Math.min(1,e||0))}function JA(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const tM=e=>()=>e;function B4e(e,t){return function(r){return e+r*t}}function q4e(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function z4e(e){return(e=+e)==1?aQ:function(t,r){return r-t?q4e(t,r,e):tM(isNaN(t)?r:t)}}function aQ(e,t){var r=t-e;return r?B4e(e,r):tM(isNaN(e)?t:e)}const FB=function e(t){var r=z4e(t);function n(s,o){var i=r((s=EO(s)).r,(o=EO(o)).r),l=r(s.g,o.g),c=r(s.b,o.b),d=aQ(s.opacity,o.opacity);return function(u){return s.r=i(u),s.g=l(u),s.b=c(u),s.opacity=d(u),s+""}}return n.gamma=e,n}(1);function U4e(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),s;return function(o){for(s=0;s<r;++s)n[s]=e[s]*(1-o)+t[s]*o;return n}}function V4e(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function W4e(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,s=new Array(n),o=new Array(r),i;for(i=0;i<n;++i)s[i]=$0(e[i],t[i]);for(;i<r;++i)o[i]=t[i];return function(l){for(i=0;i<n;++i)o[i]=s[i](l);return o}}function H4e(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function TN(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function G4e(e,t){var r={},n={},s;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(s in t)s in e?r[s]=$0(e[s],t[s]):n[s]=t[s];return function(o){for(s in r)n[s]=r[s](o);return n}}var kO=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,QA=new RegExp(kO.source,"g");function K4e(e){return function(){return e}}function X4e(e){return function(t){return e(t)+""}}function Y4e(e,t){var r=kO.lastIndex=QA.lastIndex=0,n,s,o,i=-1,l=[],c=[];for(e=e+"",t=t+"";(n=kO.exec(e))&&(s=QA.exec(t));)(o=s.index)>r&&(o=t.slice(r,o),l[i]?l[i]+=o:l[++i]=o),(n=n[0])===(s=s[0])?l[i]?l[i]+=s:l[++i]=s:(l[++i]=null,c.push({i,x:TN(n,s)})),r=QA.lastIndex;return r<t.length&&(o=t.slice(r),l[i]?l[i]+=o:l[++i]=o),l.length<2?c[0]?X4e(c[0].x):K4e(t):(t=c.length,function(d){for(var u=0,f;u<t;++u)l[(f=c[u]).i]=f.x(d);return l.join("")})}function $0(e,t){var r=typeof t,n;return t==null||r==="boolean"?tM(t):(r==="number"?TN:r==="string"?(n=_w(t))?(t=n,FB):Y4e:t instanceof _w?FB:t instanceof Date?H4e:V4e(t)?U4e:Array.isArray(t)?W4e:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?G4e:TN)(e,t)}function rM(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function J4e(e,t){t===void 0&&(t=e,e=$0);for(var r=0,n=t.length-1,s=t[0],o=new Array(n<0?0:n);r<n;)o[r]=e(s,s=t[++r]);return function(i){var l=Math.max(0,Math.min(n-1,Math.floor(i*=n)));return o[l](i-l)}}function Q4e(e){return function(){return e}}function DN(e){return+e}var $B=[0,1];function kl(e){return e}function IO(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:Q4e(isNaN(t)?NaN:.5)}function Z4e(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function eDe(e,t,r){var n=e[0],s=e[1],o=t[0],i=t[1];return s<n?(n=IO(s,n),o=r(i,o)):(n=IO(n,s),o=r(o,i)),function(l){return o(n(l))}}function tDe(e,t,r){var n=Math.min(e.length,t.length)-1,s=new Array(n),o=new Array(n),i=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<n;)s[i]=IO(e[i],e[i+1]),o[i]=r(t[i],t[i+1]);return function(l){var c=O1(e,l,1,n)-1;return o[c](s[c](l))}}function D1(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function u5(){var e=$B,t=$B,r=$0,n,s,o,i=kl,l,c,d;function u(){var h=Math.min(e.length,t.length);return i!==kl&&(i=Z4e(e[0],e[h-1])),l=h>2?tDe:eDe,c=d=null,f}function f(h){return h==null||isNaN(h=+h)?o:(c||(c=l(e.map(n),t,r)))(n(i(h)))}return f.invert=function(h){return i(s((d||(d=l(t,e.map(n),TN)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,DN),u()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),u()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),r=rM,u()},f.clamp=function(h){return arguments.length?(i=h?!0:kl,u()):i!==kl},f.interpolate=function(h){return arguments.length?(r=h,u()):r},f.unknown=function(h){return arguments.length?(o=h,f):o},function(h,m){return n=h,s=m,u()}}function nM(){return u5()(kl,kl)}function rDe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function MN(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Ux(e){return e=MN(Math.abs(e)),e?e[1]:NaN}function nDe(e,t){return function(r,n){for(var s=r.length,o=[],i=0,l=e[0],c=0;s>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),o.push(r.substring(s-=l,s+l)),!((c+=l+1)>n));)l=e[i=(i+1)%e.length];return o.reverse().join(t)}}function aDe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var sDe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Nw(e){if(!(t=sDe.exec(e)))throw new Error("invalid format: "+e);var t;return new aM({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Nw.prototype=aM.prototype;function aM(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}aM.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function oDe(e){e:for(var t=e.length,r=1,n=-1,s;r<t;++r)switch(e[r]){case".":n=s=r;break;case"0":n===0&&(n=r),s=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(s+1):e}var sQ;function iDe(e,t){var r=MN(e,t);if(!r)return e+"";var n=r[0],s=r[1],o=s-(sQ=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,i=n.length;return o===i?n:o>i?n+new Array(o-i+1).join("0"):o>0?n.slice(0,o)+"."+n.slice(o):"0."+new Array(1-o).join("0")+MN(e,Math.max(0,t+o-1))[0]}function BB(e,t){var r=MN(e,t);if(!r)return e+"";var n=r[0],s=r[1];return s<0?"0."+new Array(-s).join("0")+n:n.length>s+1?n.slice(0,s+1)+"."+n.slice(s+1):n+new Array(s-n.length+2).join("0")}const qB={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:rDe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>BB(e*100,t),r:BB,s:iDe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function zB(e){return e}var UB=Array.prototype.map,VB=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function lDe(e){var t=e.grouping===void 0||e.thousands===void 0?zB:nDe(UB.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",s=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?zB:aDe(UB.call(e.numerals,String)),i=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function d(f){f=Nw(f);var h=f.fill,m=f.align,v=f.sign,g=f.symbol,y=f.zero,x=f.width,b=f.comma,w=f.precision,j=f.trim,_=f.type;_==="n"?(b=!0,_="g"):qB[_]||(w===void 0&&(w=12),j=!0,_="g"),(y||h==="0"&&m==="=")&&(y=!0,h="0",m="=");var S=g==="$"?r:g==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",C=g==="$"?n:/[%p]/.test(_)?i:"",P=qB[_],A=/[defgprs%]/.test(_);w=w===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function R(O){var I=S,M=C,D,U,z;if(_==="c")M=P(O)+M,O="";else{O=+O;var W=O<0||1/O<0;if(O=isNaN(O)?c:P(Math.abs(O),w),j&&(O=oDe(O)),W&&+O==0&&v!=="+"&&(W=!1),I=(W?v==="("?v:l:v==="-"||v==="("?"":v)+I,M=(_==="s"?VB[8+sQ/3]:"")+M+(W&&v==="("?")":""),A){for(D=-1,U=O.length;++D<U;)if(z=O.charCodeAt(D),48>z||z>57){M=(z===46?s+O.slice(D+1):O.slice(D))+M,O=O.slice(0,D);break}}}b&&!y&&(O=t(O,1/0));var $=I.length+O.length+M.length,X=$<x?new Array(x-$+1).join(h):"";switch(b&&y&&(O=t(X+O,X.length?x-M.length:1/0),X=""),m){case"<":O=I+O+M+X;break;case"=":O=I+X+O+M;break;case"^":O=X.slice(0,$=X.length>>1)+I+O+M+X.slice($);break;default:O=X+I+O+M;break}return o(O)}return R.toString=function(){return f+""},R}function u(f,h){var m=d((f=Nw(f),f.type="f",f)),v=Math.max(-8,Math.min(8,Math.floor(Ux(h)/3)))*3,g=Math.pow(10,-v),y=VB[8+v/3];return function(x){return m(g*x)+y}}return{format:d,formatPrefix:u}}var fj,sM,oQ;cDe({thousands:",",grouping:[3],currency:["$",""]});function cDe(e){return fj=lDe(e),sM=fj.format,oQ=fj.formatPrefix,fj}function dDe(e){return Math.max(0,-Ux(Math.abs(e)))}function uDe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ux(t)/3)))*3-Ux(Math.abs(e)))}function fDe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Ux(t)-Ux(e))+1}function iQ(e,t,r,n){var s=PO(e,t,r),o;switch(n=Nw(n??",f"),n.type){case"s":{var i=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(o=uDe(s,i))&&(n.precision=o),oQ(n,i)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(o=fDe(s,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=o-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(o=dDe(s))&&(n.precision=o-(n.type==="%")*2);break}}return sM(n)}function Yh(e){var t=e.domain;return e.ticks=function(r){var n=t();return SO(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var s=t();return iQ(s[0],s[s.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),s=0,o=n.length-1,i=n[s],l=n[o],c,d,u=10;for(l<i&&(d=i,i=l,l=d,d=s,s=o,o=d);u-- >0;){if(d=CO(i,l,r),d===c)return n[s]=i,n[o]=l,t(n);if(d>0)i=Math.floor(i/d)*d,l=Math.ceil(l/d)*d;else if(d<0)i=Math.ceil(i*d)/d,l=Math.floor(l*d)/d;else break;c=d}return e},e}function RN(){var e=nM();return e.copy=function(){return D1(e,RN())},$d.apply(e,arguments),Yh(e)}function lQ(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,DN),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return lQ(e).unknown(t)},e=arguments.length?Array.from(e,DN):[0,1],Yh(r)}function cQ(e,t){e=e.slice();var r=0,n=e.length-1,s=e[r],o=e[n],i;return o<s&&(i=r,r=n,n=i,i=s,s=o,o=i),e[r]=t.floor(s),e[n]=t.ceil(o),e}function WB(e){return Math.log(e)}function HB(e){return Math.exp(e)}function mDe(e){return-Math.log(-e)}function hDe(e){return-Math.exp(-e)}function pDe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function gDe(e){return e===10?pDe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function vDe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function GB(e){return(t,r)=>-e(-t,r)}function oM(e){const t=e(WB,HB),r=t.domain;let n=10,s,o;function i(){return s=vDe(n),o=gDe(n),r()[0]<0?(s=GB(s),o=GB(o),e(mDe,hDe)):e(WB,HB),t}return t.base=function(l){return arguments.length?(n=+l,i()):n},t.domain=function(l){return arguments.length?(r(l),i()):r()},t.ticks=l=>{const c=r();let d=c[0],u=c[c.length-1];const f=u<d;f&&([d,u]=[u,d]);let h=s(d),m=s(u),v,g;const y=l==null?10:+l;let x=[];if(!(n%1)&&m-h<y){if(h=Math.floor(h),m=Math.ceil(m),d>0){for(;h<=m;++h)for(v=1;v<n;++v)if(g=h<0?v/o(-h):v*o(h),!(g<d)){if(g>u)break;x.push(g)}}else for(;h<=m;++h)for(v=n-1;v>=1;--v)if(g=h>0?v/o(-h):v*o(h),!(g<d)){if(g>u)break;x.push(g)}x.length*2<y&&(x=SO(d,u,y))}else x=SO(h,m,Math.min(m-h,y)).map(o);return f?x.reverse():x},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=Nw(c)).precision==null&&(c.trim=!0),c=sM(c)),l===1/0)return c;const d=Math.max(1,n*l/t.ticks().length);return u=>{let f=u/o(Math.round(s(u)));return f*n<n-.5&&(f*=n),f<=d?c(u):""}},t.nice=()=>r(cQ(r(),{floor:l=>o(Math.floor(s(l))),ceil:l=>o(Math.ceil(s(l)))})),t}function dQ(){const e=oM(u5()).domain([1,10]);return e.copy=()=>D1(e,dQ()).base(e.base()),$d.apply(e,arguments),e}function KB(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function XB(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function iM(e){var t=1,r=e(KB(t),XB(t));return r.constant=function(n){return arguments.length?e(KB(t=+n),XB(t)):t},Yh(r)}function uQ(){var e=iM(u5());return e.copy=function(){return D1(e,uQ()).constant(e.constant())},$d.apply(e,arguments)}function YB(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function xDe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function yDe(e){return e<0?-e*e:e*e}function lM(e){var t=e(kl,kl),r=1;function n(){return r===1?e(kl,kl):r===.5?e(xDe,yDe):e(YB(r),YB(1/r))}return t.exponent=function(s){return arguments.length?(r=+s,n()):r},Yh(t)}function cM(){var e=lM(u5());return e.copy=function(){return D1(e,cM()).exponent(e.exponent())},$d.apply(e,arguments),e}function bDe(){return cM.apply(null,arguments).exponent(.5)}function JB(e){return Math.sign(e)*e*e}function wDe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function fQ(){var e=nM(),t=[0,1],r=!1,n;function s(o){var i=wDe(e(o));return isNaN(i)?n:r?Math.round(i):i}return s.invert=function(o){return e.invert(JB(o))},s.domain=function(o){return arguments.length?(e.domain(o),s):e.domain()},s.range=function(o){return arguments.length?(e.range((t=Array.from(o,DN)).map(JB)),s):t.slice()},s.rangeRound=function(o){return s.range(o).round(!0)},s.round=function(o){return arguments.length?(r=!!o,s):r},s.clamp=function(o){return arguments.length?(e.clamp(o),s):e.clamp()},s.unknown=function(o){return arguments.length?(n=o,s):n},s.copy=function(){return fQ(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},$d.apply(s,arguments),Yh(s)}function mQ(){var e=[],t=[],r=[],n;function s(){var i=0,l=Math.max(1,t.length);for(r=new Array(l-1);++i<l;)r[i-1]=C4e(e,i/l);return o}function o(i){return i==null||isNaN(i=+i)?n:t[O1(r,i)]}return o.invertExtent=function(i){var l=t.indexOf(i);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},o.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let l of i)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(yh),s()},o.range=function(i){return arguments.length?(t=Array.from(i),s()):t.slice()},o.unknown=function(i){return arguments.length?(n=i,o):n},o.quantiles=function(){return r.slice()},o.copy=function(){return mQ().domain(e).range(t).unknown(n)},$d.apply(o,arguments)}function hQ(){var e=0,t=1,r=1,n=[.5],s=[0,1],o;function i(c){return c!=null&&c<=c?s[O1(n,c,0,r)]:o}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return i}return i.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},i.range=function(c){return arguments.length?(r=(s=Array.from(c)).length-1,l()):s.slice()},i.invertExtent=function(c){var d=s.indexOf(c);return d<0?[NaN,NaN]:d<1?[e,n[0]]:d>=r?[n[r-1],t]:[n[d-1],n[d]]},i.unknown=function(c){return arguments.length&&(o=c),i},i.thresholds=function(){return n.slice()},i.copy=function(){return hQ().domain([e,t]).range(s).unknown(o)},$d.apply(Yh(i),arguments)}function pQ(){var e=[.5],t=[0,1],r,n=1;function s(o){return o!=null&&o<=o?t[O1(e,o,0,n)]:r}return s.domain=function(o){return arguments.length?(e=Array.from(o),n=Math.min(e.length,t.length-1),s):e.slice()},s.range=function(o){return arguments.length?(t=Array.from(o),n=Math.min(e.length,t.length-1),s):t.slice()},s.invertExtent=function(o){var i=t.indexOf(o);return[e[i-1],e[i]]},s.unknown=function(o){return arguments.length?(r=o,s):r},s.copy=function(){return pQ().domain(e).range(t).unknown(r)},$d.apply(s,arguments)}const ZA=new Date,eE=new Date;function si(e,t,r,n){function s(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return s.floor=o=>(e(o=new Date(+o)),o),s.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),s.round=o=>{const i=s(o),l=s.ceil(o);return o-i<l-o?i:l},s.offset=(o,i)=>(t(o=new Date(+o),i==null?1:Math.floor(i)),o),s.range=(o,i,l)=>{const c=[];if(o=s.ceil(o),l=l==null?1:Math.floor(l),!(o<i)||!(l>0))return c;let d;do c.push(d=new Date(+o)),t(o,l),e(o);while(d<o&&o<i);return c},s.filter=o=>si(i=>{if(i>=i)for(;e(i),!o(i);)i.setTime(i-1)},(i,l)=>{if(i>=i)if(l<0)for(;++l<=0;)for(;t(i,-1),!o(i););else for(;--l>=0;)for(;t(i,1),!o(i););}),r&&(s.count=(o,i)=>(ZA.setTime(+o),eE.setTime(+i),e(ZA),e(eE),Math.floor(r(ZA,eE))),s.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?s.filter(n?i=>n(i)%o===0:i=>s.count(0,i)%o===0):s)),s}const LN=si(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);LN.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?si(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):LN);LN.range;const Rf=1e3,_d=Rf*60,Lf=_d*60,rm=Lf*24,dM=rm*7,QB=rm*30,tE=rm*365,Bp=si(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Rf)},(e,t)=>(t-e)/Rf,e=>e.getUTCSeconds());Bp.range;const uM=si(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Rf)},(e,t)=>{e.setTime(+e+t*_d)},(e,t)=>(t-e)/_d,e=>e.getMinutes());uM.range;const fM=si(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*_d)},(e,t)=>(t-e)/_d,e=>e.getUTCMinutes());fM.range;const mM=si(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Rf-e.getMinutes()*_d)},(e,t)=>{e.setTime(+e+t*Lf)},(e,t)=>(t-e)/Lf,e=>e.getHours());mM.range;const hM=si(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Lf)},(e,t)=>(t-e)/Lf,e=>e.getUTCHours());hM.range;const M1=si(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*_d)/rm,e=>e.getDate()-1);M1.range;const f5=si(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/rm,e=>e.getUTCDate()-1);f5.range;const gQ=si(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/rm,e=>Math.floor(e/rm));gQ.range;function $g(e){return si(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*_d)/dM)}const m5=$g(0),FN=$g(1),jDe=$g(2),_De=$g(3),Vx=$g(4),NDe=$g(5),SDe=$g(6);m5.range;FN.range;jDe.range;_De.range;Vx.range;NDe.range;SDe.range;function Bg(e){return si(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/dM)}const h5=Bg(0),$N=Bg(1),CDe=Bg(2),PDe=Bg(3),Wx=Bg(4),ADe=Bg(5),EDe=Bg(6);h5.range;$N.range;CDe.range;PDe.range;Wx.range;ADe.range;EDe.range;const pM=si(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());pM.range;const gM=si(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());gM.range;const nm=si(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());nm.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:si(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});nm.range;const am=si(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());am.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:si(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});am.range;function vQ(e,t,r,n,s,o){const i=[[Bp,1,Rf],[Bp,5,5*Rf],[Bp,15,15*Rf],[Bp,30,30*Rf],[o,1,_d],[o,5,5*_d],[o,15,15*_d],[o,30,30*_d],[s,1,Lf],[s,3,3*Lf],[s,6,6*Lf],[s,12,12*Lf],[n,1,rm],[n,2,2*rm],[r,1,dM],[t,1,QB],[t,3,3*QB],[e,1,tE]];function l(d,u,f){const h=u<d;h&&([d,u]=[u,d]);const m=f&&typeof f.range=="function"?f:c(d,u,f),v=m?m.range(d,+u+1):[];return h?v.reverse():v}function c(d,u,f){const h=Math.abs(u-d)/f,m=QD(([,,y])=>y).right(i,h);if(m===i.length)return e.every(PO(d/tE,u/tE,f));if(m===0)return LN.every(Math.max(PO(d,u,f),1));const[v,g]=i[h/i[m-1][2]<i[m][2]/h?m-1:m];return v.every(g)}return[l,c]}const[kDe,IDe]=vQ(am,gM,h5,gQ,hM,fM),[ODe,TDe]=vQ(nm,pM,m5,M1,mM,uM);function rE(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function nE(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function yy(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function DDe(e){var t=e.dateTime,r=e.date,n=e.time,s=e.periods,o=e.days,i=e.shortDays,l=e.months,c=e.shortMonths,d=by(s),u=wy(s),f=by(o),h=wy(o),m=by(i),v=wy(i),g=by(l),y=wy(l),x=by(c),b=wy(c),w={a:W,A:$,b:X,B:ye,c:null,d:aq,e:aq,f:nMe,g:mMe,G:pMe,H:eMe,I:tMe,j:rMe,L:xQ,m:aMe,M:sMe,p:Se,q:V,Q:iq,s:lq,S:oMe,u:iMe,U:lMe,V:cMe,w:dMe,W:uMe,x:null,X:null,y:fMe,Y:hMe,Z:gMe,"%":oq},j={a:B,A:Q,b:pe,B:te,c:null,d:sq,e:sq,f:bMe,g:kMe,G:OMe,H:vMe,I:xMe,j:yMe,L:bQ,m:wMe,M:jMe,p:Y,q:ce,Q:iq,s:lq,S:_Me,u:NMe,U:SMe,V:CMe,w:PMe,W:AMe,x:null,X:null,y:EMe,Y:IMe,Z:TMe,"%":oq},_={a:R,A:O,b:I,B:M,c:D,d:rq,e:rq,f:YDe,g:tq,G:eq,H:nq,I:nq,j:HDe,L:XDe,m:WDe,M:GDe,p:A,q:VDe,Q:QDe,s:ZDe,S:KDe,u:$De,U:BDe,V:qDe,w:FDe,W:zDe,x:U,X:z,y:tq,Y:eq,Z:UDe,"%":JDe};w.x=S(r,w),w.X=S(n,w),w.c=S(t,w),j.x=S(r,j),j.X=S(n,j),j.c=S(t,j);function S(me,ae){return function(le){var ue=[],Re=-1,ne=0,ie=me.length,gt,bt,at;for(le instanceof Date||(le=new Date(+le));++Re<ie;)me.charCodeAt(Re)===37&&(ue.push(me.slice(ne,Re)),(bt=ZB[gt=me.charAt(++Re)])!=null?gt=me.charAt(++Re):bt=gt==="e"?" ":"0",(at=ae[gt])&&(gt=at(le,bt)),ue.push(gt),ne=Re+1);return ue.push(me.slice(ne,Re)),ue.join("")}}function C(me,ae){return function(le){var ue=yy(1900,void 0,1),Re=P(ue,me,le+="",0),ne,ie;if(Re!=le.length)return null;if("Q"in ue)return new Date(ue.Q);if("s"in ue)return new Date(ue.s*1e3+("L"in ue?ue.L:0));if(ae&&!("Z"in ue)&&(ue.Z=0),"p"in ue&&(ue.H=ue.H%12+ue.p*12),ue.m===void 0&&(ue.m="q"in ue?ue.q:0),"V"in ue){if(ue.V<1||ue.V>53)return null;"w"in ue||(ue.w=1),"Z"in ue?(ne=nE(yy(ue.y,0,1)),ie=ne.getUTCDay(),ne=ie>4||ie===0?$N.ceil(ne):$N(ne),ne=f5.offset(ne,(ue.V-1)*7),ue.y=ne.getUTCFullYear(),ue.m=ne.getUTCMonth(),ue.d=ne.getUTCDate()+(ue.w+6)%7):(ne=rE(yy(ue.y,0,1)),ie=ne.getDay(),ne=ie>4||ie===0?FN.ceil(ne):FN(ne),ne=M1.offset(ne,(ue.V-1)*7),ue.y=ne.getFullYear(),ue.m=ne.getMonth(),ue.d=ne.getDate()+(ue.w+6)%7)}else("W"in ue||"U"in ue)&&("w"in ue||(ue.w="u"in ue?ue.u%7:"W"in ue?1:0),ie="Z"in ue?nE(yy(ue.y,0,1)).getUTCDay():rE(yy(ue.y,0,1)).getDay(),ue.m=0,ue.d="W"in ue?(ue.w+6)%7+ue.W*7-(ie+5)%7:ue.w+ue.U*7-(ie+6)%7);return"Z"in ue?(ue.H+=ue.Z/100|0,ue.M+=ue.Z%100,nE(ue)):rE(ue)}}function P(me,ae,le,ue){for(var Re=0,ne=ae.length,ie=le.length,gt,bt;Re<ne;){if(ue>=ie)return-1;if(gt=ae.charCodeAt(Re++),gt===37){if(gt=ae.charAt(Re++),bt=_[gt in ZB?ae.charAt(Re++):gt],!bt||(ue=bt(me,le,ue))<0)return-1}else if(gt!=le.charCodeAt(ue++))return-1}return ue}function A(me,ae,le){var ue=d.exec(ae.slice(le));return ue?(me.p=u.get(ue[0].toLowerCase()),le+ue[0].length):-1}function R(me,ae,le){var ue=m.exec(ae.slice(le));return ue?(me.w=v.get(ue[0].toLowerCase()),le+ue[0].length):-1}function O(me,ae,le){var ue=f.exec(ae.slice(le));return ue?(me.w=h.get(ue[0].toLowerCase()),le+ue[0].length):-1}function I(me,ae,le){var ue=x.exec(ae.slice(le));return ue?(me.m=b.get(ue[0].toLowerCase()),le+ue[0].length):-1}function M(me,ae,le){var ue=g.exec(ae.slice(le));return ue?(me.m=y.get(ue[0].toLowerCase()),le+ue[0].length):-1}function D(me,ae,le){return P(me,t,ae,le)}function U(me,ae,le){return P(me,r,ae,le)}function z(me,ae,le){return P(me,n,ae,le)}function W(me){return i[me.getDay()]}function $(me){return o[me.getDay()]}function X(me){return c[me.getMonth()]}function ye(me){return l[me.getMonth()]}function Se(me){return s[+(me.getHours()>=12)]}function V(me){return 1+~~(me.getMonth()/3)}function B(me){return i[me.getUTCDay()]}function Q(me){return o[me.getUTCDay()]}function pe(me){return c[me.getUTCMonth()]}function te(me){return l[me.getUTCMonth()]}function Y(me){return s[+(me.getUTCHours()>=12)]}function ce(me){return 1+~~(me.getUTCMonth()/3)}return{format:function(me){var ae=S(me+="",w);return ae.toString=function(){return me},ae},parse:function(me){var ae=C(me+="",!1);return ae.toString=function(){return me},ae},utcFormat:function(me){var ae=S(me+="",j);return ae.toString=function(){return me},ae},utcParse:function(me){var ae=C(me+="",!0);return ae.toString=function(){return me},ae}}}var ZB={"-":"",_:" ",0:"0"},_i=/^\s*\d+/,MDe=/^%/,RDe=/[\\^$*+?|[\]().{}]/g;function Ga(e,t,r){var n=e<0?"-":"",s=(n?-e:e)+"",o=s.length;return n+(o<r?new Array(r-o+1).join(t)+s:s)}function LDe(e){return e.replace(RDe,"\\$&")}function by(e){return new RegExp("^(?:"+e.map(LDe).join("|")+")","i")}function wy(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function FDe(e,t,r){var n=_i.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function $De(e,t,r){var n=_i.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function BDe(e,t,r){var n=_i.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function qDe(e,t,r){var n=_i.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function zDe(e,t,r){var n=_i.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function eq(e,t,r){var n=_i.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function tq(e,t,r){var n=_i.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function UDe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function VDe(e,t,r){var n=_i.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function WDe(e,t,r){var n=_i.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function rq(e,t,r){var n=_i.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function HDe(e,t,r){var n=_i.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function nq(e,t,r){var n=_i.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function GDe(e,t,r){var n=_i.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function KDe(e,t,r){var n=_i.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function XDe(e,t,r){var n=_i.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function YDe(e,t,r){var n=_i.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function JDe(e,t,r){var n=MDe.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function QDe(e,t,r){var n=_i.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function ZDe(e,t,r){var n=_i.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function aq(e,t){return Ga(e.getDate(),t,2)}function eMe(e,t){return Ga(e.getHours(),t,2)}function tMe(e,t){return Ga(e.getHours()%12||12,t,2)}function rMe(e,t){return Ga(1+M1.count(nm(e),e),t,3)}function xQ(e,t){return Ga(e.getMilliseconds(),t,3)}function nMe(e,t){return xQ(e,t)+"000"}function aMe(e,t){return Ga(e.getMonth()+1,t,2)}function sMe(e,t){return Ga(e.getMinutes(),t,2)}function oMe(e,t){return Ga(e.getSeconds(),t,2)}function iMe(e){var t=e.getDay();return t===0?7:t}function lMe(e,t){return Ga(m5.count(nm(e)-1,e),t,2)}function yQ(e){var t=e.getDay();return t>=4||t===0?Vx(e):Vx.ceil(e)}function cMe(e,t){return e=yQ(e),Ga(Vx.count(nm(e),e)+(nm(e).getDay()===4),t,2)}function dMe(e){return e.getDay()}function uMe(e,t){return Ga(FN.count(nm(e)-1,e),t,2)}function fMe(e,t){return Ga(e.getFullYear()%100,t,2)}function mMe(e,t){return e=yQ(e),Ga(e.getFullYear()%100,t,2)}function hMe(e,t){return Ga(e.getFullYear()%1e4,t,4)}function pMe(e,t){var r=e.getDay();return e=r>=4||r===0?Vx(e):Vx.ceil(e),Ga(e.getFullYear()%1e4,t,4)}function gMe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ga(t/60|0,"0",2)+Ga(t%60,"0",2)}function sq(e,t){return Ga(e.getUTCDate(),t,2)}function vMe(e,t){return Ga(e.getUTCHours(),t,2)}function xMe(e,t){return Ga(e.getUTCHours()%12||12,t,2)}function yMe(e,t){return Ga(1+f5.count(am(e),e),t,3)}function bQ(e,t){return Ga(e.getUTCMilliseconds(),t,3)}function bMe(e,t){return bQ(e,t)+"000"}function wMe(e,t){return Ga(e.getUTCMonth()+1,t,2)}function jMe(e,t){return Ga(e.getUTCMinutes(),t,2)}function _Me(e,t){return Ga(e.getUTCSeconds(),t,2)}function NMe(e){var t=e.getUTCDay();return t===0?7:t}function SMe(e,t){return Ga(h5.count(am(e)-1,e),t,2)}function wQ(e){var t=e.getUTCDay();return t>=4||t===0?Wx(e):Wx.ceil(e)}function CMe(e,t){return e=wQ(e),Ga(Wx.count(am(e),e)+(am(e).getUTCDay()===4),t,2)}function PMe(e){return e.getUTCDay()}function AMe(e,t){return Ga($N.count(am(e)-1,e),t,2)}function EMe(e,t){return Ga(e.getUTCFullYear()%100,t,2)}function kMe(e,t){return e=wQ(e),Ga(e.getUTCFullYear()%100,t,2)}function IMe(e,t){return Ga(e.getUTCFullYear()%1e4,t,4)}function OMe(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Wx(e):Wx.ceil(e),Ga(e.getUTCFullYear()%1e4,t,4)}function TMe(){return"+0000"}function oq(){return"%"}function iq(e){return+e}function lq(e){return Math.floor(+e/1e3)}var uv,jQ,_Q;DMe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function DMe(e){return uv=DDe(e),jQ=uv.format,uv.parse,_Q=uv.utcFormat,uv.utcParse,uv}function MMe(e){return new Date(e)}function RMe(e){return e instanceof Date?+e:+new Date(+e)}function vM(e,t,r,n,s,o,i,l,c,d){var u=nM(),f=u.invert,h=u.domain,m=d(".%L"),v=d(":%S"),g=d("%I:%M"),y=d("%I %p"),x=d("%a %d"),b=d("%b %d"),w=d("%B"),j=d("%Y");function _(S){return(c(S)<S?m:l(S)<S?v:i(S)<S?g:o(S)<S?y:n(S)<S?s(S)<S?x:b:r(S)<S?w:j)(S)}return u.invert=function(S){return new Date(f(S))},u.domain=function(S){return arguments.length?h(Array.from(S,RMe)):h().map(MMe)},u.ticks=function(S){var C=h();return e(C[0],C[C.length-1],S??10)},u.tickFormat=function(S,C){return C==null?_:d(C)},u.nice=function(S){var C=h();return(!S||typeof S.range!="function")&&(S=t(C[0],C[C.length-1],S??10)),S?h(cQ(C,S)):u},u.copy=function(){return D1(u,vM(e,t,r,n,s,o,i,l,c,d))},u}function LMe(){return $d.apply(vM(ODe,TDe,nm,pM,m5,M1,mM,uM,Bp,jQ).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function FMe(){return $d.apply(vM(kDe,IDe,am,gM,h5,f5,hM,fM,Bp,_Q).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function p5(){var e=0,t=1,r,n,s,o,i=kl,l=!1,c;function d(f){return f==null||isNaN(f=+f)?c:i(s===0?.5:(f=(o(f)-r)*s,l?Math.max(0,Math.min(1,f)):f))}d.domain=function(f){return arguments.length?([e,t]=f,r=o(e=+e),n=o(t=+t),s=r===n?0:1/(n-r),d):[e,t]},d.clamp=function(f){return arguments.length?(l=!!f,d):l},d.interpolator=function(f){return arguments.length?(i=f,d):i};function u(f){return function(h){var m,v;return arguments.length?([m,v]=h,i=f(m,v),d):[i(0),i(1)]}}return d.range=u($0),d.rangeRound=u(rM),d.unknown=function(f){return arguments.length?(c=f,d):c},function(f){return o=f,r=f(e),n=f(t),s=r===n?0:1/(n-r),d}}function Jh(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function NQ(){var e=Yh(p5()(kl));return e.copy=function(){return Jh(e,NQ())},fm.apply(e,arguments)}function SQ(){var e=oM(p5()).domain([1,10]);return e.copy=function(){return Jh(e,SQ()).base(e.base())},fm.apply(e,arguments)}function CQ(){var e=iM(p5());return e.copy=function(){return Jh(e,CQ()).constant(e.constant())},fm.apply(e,arguments)}function xM(){var e=lM(p5());return e.copy=function(){return Jh(e,xM()).exponent(e.exponent())},fm.apply(e,arguments)}function $Me(){return xM.apply(null,arguments).exponent(.5)}function PQ(){var e=[],t=kl;function r(n){if(n!=null&&!isNaN(n=+n))return t((O1(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let s of n)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(yh),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,s)=>t(s/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(s,o)=>S4e(e,o/n))},r.copy=function(){return PQ(t).domain(e)},fm.apply(r,arguments)}function g5(){var e=0,t=.5,r=1,n=1,s,o,i,l,c,d=kl,u,f=!1,h;function m(g){return isNaN(g=+g)?h:(g=.5+((g=+u(g))-o)*(n*g<n*o?l:c),d(f?Math.max(0,Math.min(1,g)):g))}m.domain=function(g){return arguments.length?([e,t,r]=g,s=u(e=+e),o=u(t=+t),i=u(r=+r),l=s===o?0:.5/(o-s),c=o===i?0:.5/(i-o),n=o<s?-1:1,m):[e,t,r]},m.clamp=function(g){return arguments.length?(f=!!g,m):f},m.interpolator=function(g){return arguments.length?(d=g,m):d};function v(g){return function(y){var x,b,w;return arguments.length?([x,b,w]=y,d=J4e(g,[x,b,w]),m):[d(0),d(.5),d(1)]}}return m.range=v($0),m.rangeRound=v(rM),m.unknown=function(g){return arguments.length?(h=g,m):h},function(g){return u=g,s=g(e),o=g(t),i=g(r),l=s===o?0:.5/(o-s),c=o===i?0:.5/(i-o),n=o<s?-1:1,m}}function AQ(){var e=Yh(g5()(kl));return e.copy=function(){return Jh(e,AQ())},fm.apply(e,arguments)}function EQ(){var e=oM(g5()).domain([.1,1,10]);return e.copy=function(){return Jh(e,EQ()).base(e.base())},fm.apply(e,arguments)}function kQ(){var e=iM(g5());return e.copy=function(){return Jh(e,kQ()).constant(e.constant())},fm.apply(e,arguments)}function yM(){var e=lM(g5());return e.copy=function(){return Jh(e,yM()).exponent(e.exponent())},fm.apply(e,arguments)}function BMe(){return yM.apply(null,arguments).exponent(.5)}const cq=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:bw,scaleDiverging:AQ,scaleDivergingLog:EQ,scaleDivergingPow:yM,scaleDivergingSqrt:BMe,scaleDivergingSymlog:kQ,scaleIdentity:lQ,scaleImplicit:AO,scaleLinear:RN,scaleLog:dQ,scaleOrdinal:ZD,scalePoint:hb,scalePow:cM,scaleQuantile:mQ,scaleQuantize:hQ,scaleRadial:fQ,scaleSequential:NQ,scaleSequentialLog:SQ,scaleSequentialPow:xM,scaleSequentialQuantile:PQ,scaleSequentialSqrt:$Me,scaleSequentialSymlog:CQ,scaleSqrt:bDe,scaleSymlog:uQ,scaleThreshold:pQ,scaleTime:LMe,scaleUtc:FMe,tickFormat:iQ},Symbol.toStringTag,{value:"Module"}));var qMe=k0;function zMe(e,t,r){for(var n=-1,s=e.length;++n<s;){var o=e[n],i=t(o);if(i!=null&&(l===void 0?i===i&&!qMe(i):r(i,l)))var l=i,c=o}return c}var v5=zMe;function UMe(e,t){return e>t}var IQ=UMe,VMe=v5,WMe=IQ,HMe=F0;function GMe(e){return e&&e.length?VMe(e,HMe,WMe):void 0}var KMe=GMe;const Zm=Ua(KMe);function XMe(e,t){return e<t}var OQ=XMe,YMe=v5,JMe=OQ,QMe=F0;function ZMe(e){return e&&e.length?YMe(e,QMe,JMe):void 0}var eRe=ZMe;const x5=Ua(eRe);var tRe=TD,rRe=ff,nRe=BJ,aRe=dc;function sRe(e,t){var r=aRe(e)?tRe:nRe;return r(e,rRe(t))}var oRe=sRe,iRe=FJ,lRe=oRe;function cRe(e,t){return iRe(lRe(e,t),1)}var dRe=cRe;const uRe=Ua(dRe);var fRe=KD;function mRe(e,t){return fRe(e,t)}var hRe=mRe;const wg=Ua(hRe);var B0=1e9,pRe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},wM,Ks=!0,Md="[DecimalError] ",tg=Md+"Invalid argument: ",bM=Md+"Exponent out of range: ",q0=Math.floor,Cp=Math.pow,gRe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ic,mi=1e7,Ls=7,TQ=9007199254740991,BN=q0(TQ/Ls),Cn={};Cn.absoluteValue=Cn.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Cn.comparedTo=Cn.cmp=function(e){var t,r,n,s,o=this;if(e=new o.constructor(e),o.s!==e.s)return o.s||-e.s;if(o.e!==e.e)return o.e>e.e^o.s<0?1:-1;for(n=o.d.length,s=e.d.length,t=0,r=n<s?n:s;t<r;++t)if(o.d[t]!==e.d[t])return o.d[t]>e.d[t]^o.s<0?1:-1;return n===s?0:n>s^o.s<0?1:-1};Cn.decimalPlaces=Cn.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Ls;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Cn.dividedBy=Cn.div=function(e){return Vf(this,new this.constructor(e))};Cn.dividedToIntegerBy=Cn.idiv=function(e){var t=this,r=t.constructor;return vs(Vf(t,new r(e),0,1),r.precision)};Cn.equals=Cn.eq=function(e){return!this.cmp(e)};Cn.exponent=function(){return Lo(this)};Cn.greaterThan=Cn.gt=function(e){return this.cmp(e)>0};Cn.greaterThanOrEqualTo=Cn.gte=function(e){return this.cmp(e)>=0};Cn.isInteger=Cn.isint=function(){return this.e>this.d.length-2};Cn.isNegative=Cn.isneg=function(){return this.s<0};Cn.isPositive=Cn.ispos=function(){return this.s>0};Cn.isZero=function(){return this.s===0};Cn.lessThan=Cn.lt=function(e){return this.cmp(e)<0};Cn.lessThanOrEqualTo=Cn.lte=function(e){return this.cmp(e)<1};Cn.logarithm=Cn.log=function(e){var t,r=this,n=r.constructor,s=n.precision,o=s+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Ic))throw Error(Md+"NaN");if(r.s<1)throw Error(Md+(r.s?"NaN":"-Infinity"));return r.eq(Ic)?new n(0):(Ks=!1,t=Vf(Sw(r,o),Sw(e,o),o),Ks=!0,vs(t,s))};Cn.minus=Cn.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?RQ(t,e):DQ(t,(e.s=-e.s,e))};Cn.modulo=Cn.mod=function(e){var t,r=this,n=r.constructor,s=n.precision;if(e=new n(e),!e.s)throw Error(Md+"NaN");return r.s?(Ks=!1,t=Vf(r,e,0,1).times(e),Ks=!0,r.minus(t)):vs(new n(r),s)};Cn.naturalExponential=Cn.exp=function(){return MQ(this)};Cn.naturalLogarithm=Cn.ln=function(){return Sw(this)};Cn.negated=Cn.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Cn.plus=Cn.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?DQ(t,e):RQ(t,(e.s=-e.s,e))};Cn.precision=Cn.sd=function(e){var t,r,n,s=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(tg+e);if(t=Lo(s)+1,n=s.d.length-1,r=n*Ls+1,n=s.d[n],n){for(;n%10==0;n/=10)r--;for(n=s.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Cn.squareRoot=Cn.sqrt=function(){var e,t,r,n,s,o,i,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(Md+"NaN")}for(e=Lo(l),Ks=!1,s=Math.sqrt(+l),s==0||s==1/0?(t=Hu(l.d),(t.length+e)%2==0&&(t+="0"),s=Math.sqrt(t),e=q0((e+1)/2)-(e<0||e%2),s==1/0?t="5e"+e:(t=s.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(s.toString()),r=c.precision,s=i=r+3;;)if(o=n,n=o.plus(Vf(l,o,i+2)).times(.5),Hu(o.d).slice(0,i)===(t=Hu(n.d)).slice(0,i)){if(t=t.slice(i-3,i+1),s==i&&t=="4999"){if(vs(o,r+1,0),o.times(o).eq(l)){n=o;break}}else if(t!="9999")break;i+=4}return Ks=!0,vs(n,r)};Cn.times=Cn.mul=function(e){var t,r,n,s,o,i,l,c,d,u=this,f=u.constructor,h=u.d,m=(e=new f(e)).d;if(!u.s||!e.s)return new f(0);for(e.s*=u.s,r=u.e+e.e,c=h.length,d=m.length,c<d&&(o=h,h=m,m=o,i=c,c=d,d=i),o=[],i=c+d,n=i;n--;)o.push(0);for(n=d;--n>=0;){for(t=0,s=c+n;s>n;)l=o[s]+m[n]*h[s-n-1]+t,o[s--]=l%mi|0,t=l/mi|0;o[s]=(o[s]+t)%mi|0}for(;!o[--i];)o.pop();return t?++r:o.shift(),e.d=o,e.e=r,Ks?vs(e,f.precision):e};Cn.toDecimalPlaces=Cn.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(lf(e,0,B0),t===void 0?t=n.rounding:lf(t,0,8),vs(r,e+Lo(r)+1,t))};Cn.toExponential=function(e,t){var r,n=this,s=n.constructor;return e===void 0?r=jg(n,!0):(lf(e,0,B0),t===void 0?t=s.rounding:lf(t,0,8),n=vs(new s(n),e+1,t),r=jg(n,!0,e+1)),r};Cn.toFixed=function(e,t){var r,n,s=this,o=s.constructor;return e===void 0?jg(s):(lf(e,0,B0),t===void 0?t=o.rounding:lf(t,0,8),n=vs(new o(s),e+Lo(s)+1,t),r=jg(n.abs(),!1,e+Lo(n)+1),s.isneg()&&!s.isZero()?"-"+r:r)};Cn.toInteger=Cn.toint=function(){var e=this,t=e.constructor;return vs(new t(e),Lo(e)+1,t.rounding)};Cn.toNumber=function(){return+this};Cn.toPower=Cn.pow=function(e){var t,r,n,s,o,i,l=this,c=l.constructor,d=12,u=+(e=new c(e));if(!e.s)return new c(Ic);if(l=new c(l),!l.s){if(e.s<1)throw Error(Md+"Infinity");return l}if(l.eq(Ic))return l;if(n=c.precision,e.eq(Ic))return vs(l,n);if(t=e.e,r=e.d.length-1,i=t>=r,o=l.s,i){if((r=u<0?-u:u)<=TQ){for(s=new c(Ic),t=Math.ceil(n/Ls+4),Ks=!1;r%2&&(s=s.times(l),uq(s.d,t)),r=q0(r/2),r!==0;)l=l.times(l),uq(l.d,t);return Ks=!0,e.s<0?new c(Ic).div(s):vs(s,n)}}else if(o<0)throw Error(Md+"NaN");return o=o<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,Ks=!1,s=e.times(Sw(l,n+d)),Ks=!0,s=MQ(s),s.s=o,s};Cn.toPrecision=function(e,t){var r,n,s=this,o=s.constructor;return e===void 0?(r=Lo(s),n=jg(s,r<=o.toExpNeg||r>=o.toExpPos)):(lf(e,1,B0),t===void 0?t=o.rounding:lf(t,0,8),s=vs(new o(s),e,t),r=Lo(s),n=jg(s,e<=r||r<=o.toExpNeg,e)),n};Cn.toSignificantDigits=Cn.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(lf(e,1,B0),t===void 0?t=n.rounding:lf(t,0,8)),vs(new n(r),e,t)};Cn.toString=Cn.valueOf=Cn.val=Cn.toJSON=Cn[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Lo(e),r=e.constructor;return jg(e,t<=r.toExpNeg||t>=r.toExpPos)};function DQ(e,t){var r,n,s,o,i,l,c,d,u=e.constructor,f=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),Ks?vs(t,f):t;if(c=e.d,d=t.d,i=e.e,s=t.e,c=c.slice(),o=i-s,o){for(o<0?(n=c,o=-o,l=d.length):(n=d,s=i,l=c.length),i=Math.ceil(f/Ls),l=i>l?i+1:l+1,o>l&&(o=l,n.length=1),n.reverse();o--;)n.push(0);n.reverse()}for(l=c.length,o=d.length,l-o<0&&(o=l,n=d,d=c,c=n),r=0;o;)r=(c[--o]=c[o]+d[o]+r)/mi|0,c[o]%=mi;for(r&&(c.unshift(r),++s),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=s,Ks?vs(t,f):t}function lf(e,t,r){if(e!==~~e||e<t||e>r)throw Error(tg+e)}function Hu(e){var t,r,n,s=e.length-1,o="",i=e[0];if(s>0){for(o+=i,t=1;t<s;t++)n=e[t]+"",r=Ls-n.length,r&&(o+=qm(r)),o+=n;i=e[t],n=i+"",r=Ls-n.length,r&&(o+=qm(r))}else if(i===0)return"0";for(;i%10===0;)i/=10;return o+i}var Vf=function(){function e(n,s){var o,i=0,l=n.length;for(n=n.slice();l--;)o=n[l]*s+i,n[l]=o%mi|0,i=o/mi|0;return i&&n.unshift(i),n}function t(n,s,o,i){var l,c;if(o!=i)c=o>i?1:-1;else for(l=c=0;l<o;l++)if(n[l]!=s[l]){c=n[l]>s[l]?1:-1;break}return c}function r(n,s,o){for(var i=0;o--;)n[o]-=i,i=n[o]<s[o]?1:0,n[o]=i*mi+n[o]-s[o];for(;!n[0]&&n.length>1;)n.shift()}return function(n,s,o,i){var l,c,d,u,f,h,m,v,g,y,x,b,w,j,_,S,C,P,A=n.constructor,R=n.s==s.s?1:-1,O=n.d,I=s.d;if(!n.s)return new A(n);if(!s.s)throw Error(Md+"Division by zero");for(c=n.e-s.e,C=I.length,_=O.length,m=new A(R),v=m.d=[],d=0;I[d]==(O[d]||0);)++d;if(I[d]>(O[d]||0)&&--c,o==null?b=o=A.precision:i?b=o+(Lo(n)-Lo(s))+1:b=o,b<0)return new A(0);if(b=b/Ls+2|0,d=0,C==1)for(u=0,I=I[0],b++;(d<_||u)&&b--;d++)w=u*mi+(O[d]||0),v[d]=w/I|0,u=w%I|0;else{for(u=mi/(I[0]+1)|0,u>1&&(I=e(I,u),O=e(O,u),C=I.length,_=O.length),j=C,g=O.slice(0,C),y=g.length;y<C;)g[y++]=0;P=I.slice(),P.unshift(0),S=I[0],I[1]>=mi/2&&++S;do u=0,l=t(I,g,C,y),l<0?(x=g[0],C!=y&&(x=x*mi+(g[1]||0)),u=x/S|0,u>1?(u>=mi&&(u=mi-1),f=e(I,u),h=f.length,y=g.length,l=t(f,g,h,y),l==1&&(u--,r(f,C<h?P:I,h))):(u==0&&(l=u=1),f=I.slice()),h=f.length,h<y&&f.unshift(0),r(g,f,y),l==-1&&(y=g.length,l=t(I,g,C,y),l<1&&(u++,r(g,C<y?P:I,y))),y=g.length):l===0&&(u++,g=[0]),v[d++]=u,l&&g[0]?g[y++]=O[j]||0:(g=[O[j]],y=1);while((j++<_||g[0]!==void 0)&&b--)}return v[0]||v.shift(),m.e=c,vs(m,i?o+Lo(m)+1:o)}}();function MQ(e,t){var r,n,s,o,i,l,c=0,d=0,u=e.constructor,f=u.precision;if(Lo(e)>16)throw Error(bM+Lo(e));if(!e.s)return new u(Ic);for(t==null?(Ks=!1,l=f):l=t,i=new u(.03125);e.abs().gte(.1);)e=e.times(i),d+=5;for(n=Math.log(Cp(2,d))/Math.LN10*2+5|0,l+=n,r=s=o=new u(Ic),u.precision=l;;){if(s=vs(s.times(e),l),r=r.times(++c),i=o.plus(Vf(s,r,l)),Hu(i.d).slice(0,l)===Hu(o.d).slice(0,l)){for(;d--;)o=vs(o.times(o),l);return u.precision=f,t==null?(Ks=!0,vs(o,f)):o}o=i}}function Lo(e){for(var t=e.e*Ls,r=e.d[0];r>=10;r/=10)t++;return t}function aE(e,t,r){if(t>e.LN10.sd())throw Ks=!0,r&&(e.precision=r),Error(Md+"LN10 precision limit exceeded");return vs(new e(e.LN10),t)}function qm(e){for(var t="";e--;)t+="0";return t}function Sw(e,t){var r,n,s,o,i,l,c,d,u,f=1,h=10,m=e,v=m.d,g=m.constructor,y=g.precision;if(m.s<1)throw Error(Md+(m.s?"NaN":"-Infinity"));if(m.eq(Ic))return new g(0);if(t==null?(Ks=!1,d=y):d=t,m.eq(10))return t==null&&(Ks=!0),aE(g,d);if(d+=h,g.precision=d,r=Hu(v),n=r.charAt(0),o=Lo(m),Math.abs(o)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)m=m.times(e),r=Hu(m.d),n=r.charAt(0),f++;o=Lo(m),n>1?(m=new g("0."+r),o++):m=new g(n+"."+r.slice(1))}else return c=aE(g,d+2,y).times(o+""),m=Sw(new g(n+"."+r.slice(1)),d-h).plus(c),g.precision=y,t==null?(Ks=!0,vs(m,y)):m;for(l=i=m=Vf(m.minus(Ic),m.plus(Ic),d),u=vs(m.times(m),d),s=3;;){if(i=vs(i.times(u),d),c=l.plus(Vf(i,new g(s),d)),Hu(c.d).slice(0,d)===Hu(l.d).slice(0,d))return l=l.times(2),o!==0&&(l=l.plus(aE(g,d+2,y).times(o+""))),l=Vf(l,new g(f),d),g.precision=y,t==null?(Ks=!0,vs(l,y)):l;l=c,s+=2}}function dq(e,t){var r,n,s;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(s=t.length;t.charCodeAt(s-1)===48;)--s;if(t=t.slice(n,s),t){if(s-=n,r=r-n-1,e.e=q0(r/Ls),e.d=[],n=(r+1)%Ls,r<0&&(n+=Ls),n<s){for(n&&e.d.push(+t.slice(0,n)),s-=Ls;n<s;)e.d.push(+t.slice(n,n+=Ls));t=t.slice(n),n=Ls-t.length}else n-=s;for(;n--;)t+="0";if(e.d.push(+t),Ks&&(e.e>BN||e.e<-BN))throw Error(bM+r)}else e.s=0,e.e=0,e.d=[0];return e}function vs(e,t,r){var n,s,o,i,l,c,d,u,f=e.d;for(i=1,o=f[0];o>=10;o/=10)i++;if(n=t-i,n<0)n+=Ls,s=t,d=f[u=0];else{if(u=Math.ceil((n+1)/Ls),o=f.length,u>=o)return e;for(d=o=f[u],i=1;o>=10;o/=10)i++;n%=Ls,s=n-Ls+i}if(r!==void 0&&(o=Cp(10,i-s-1),l=d/o%10|0,c=t<0||f[u+1]!==void 0||d%o,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?s>0?d/Cp(10,i-s):0:f[u-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(o=Lo(e),f.length=1,t=t-o-1,f[0]=Cp(10,(Ls-t%Ls)%Ls),e.e=q0(-t/Ls)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=u,o=1,u--):(f.length=u+1,o=Cp(10,Ls-n),f[u]=s>0?(d/Cp(10,i-s)%Cp(10,s)|0)*o:0),c)for(;;)if(u==0){(f[0]+=o)==mi&&(f[0]=1,++e.e);break}else{if(f[u]+=o,f[u]!=mi)break;f[u--]=0,o=1}for(n=f.length;f[--n]===0;)f.pop();if(Ks&&(e.e>BN||e.e<-BN))throw Error(bM+Lo(e));return e}function RQ(e,t){var r,n,s,o,i,l,c,d,u,f,h=e.constructor,m=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),Ks?vs(t,m):t;if(c=e.d,f=t.d,n=t.e,d=e.e,c=c.slice(),i=d-n,i){for(u=i<0,u?(r=c,i=-i,l=f.length):(r=f,n=d,l=c.length),s=Math.max(Math.ceil(m/Ls),l)+2,i>s&&(i=s,r.length=1),r.reverse(),s=i;s--;)r.push(0);r.reverse()}else{for(s=c.length,l=f.length,u=s<l,u&&(l=s),s=0;s<l;s++)if(c[s]!=f[s]){u=c[s]<f[s];break}i=0}for(u&&(r=c,c=f,f=r,t.s=-t.s),l=c.length,s=f.length-l;s>0;--s)c[l++]=0;for(s=f.length;s>i;){if(c[--s]<f[s]){for(o=s;o&&c[--o]===0;)c[o]=mi-1;--c[o],c[s]+=mi}c[s]-=f[s]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,Ks?vs(t,m):t):new h(0)}function jg(e,t,r){var n,s=Lo(e),o=Hu(e.d),i=o.length;return t?(r&&(n=r-i)>0?o=o.charAt(0)+"."+o.slice(1)+qm(n):i>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(s<0?"e":"e+")+s):s<0?(o="0."+qm(-s-1)+o,r&&(n=r-i)>0&&(o+=qm(n))):s>=i?(o+=qm(s+1-i),r&&(n=r-s-1)>0&&(o=o+"."+qm(n))):((n=s+1)<i&&(o=o.slice(0,n)+"."+o.slice(n)),r&&(n=r-i)>0&&(s+1===i&&(o+="."),o+=qm(n))),e.s<0?"-"+o:o}function uq(e,t){if(e.length>t)return e.length=t,!0}function LQ(e){var t,r,n;function s(o){var i=this;if(!(i instanceof s))return new s(o);if(i.constructor=s,o instanceof s){i.s=o.s,i.e=o.e,i.d=(o=o.d)?o.slice():o;return}if(typeof o=="number"){if(o*0!==0)throw Error(tg+o);if(o>0)i.s=1;else if(o<0)o=-o,i.s=-1;else{i.s=0,i.e=0,i.d=[0];return}if(o===~~o&&o<1e7){i.e=0,i.d=[o];return}return dq(i,o.toString())}else if(typeof o!="string")throw Error(tg+o);if(o.charCodeAt(0)===45?(o=o.slice(1),i.s=-1):i.s=1,gRe.test(o))dq(i,o);else throw Error(tg+o)}if(s.prototype=Cn,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.clone=LQ,s.config=s.set=vRe,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return s.config(e),s}function vRe(e){if(!e||typeof e!="object")throw Error(Md+"Object expected");var t,r,n,s=["precision",1,B0,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<s.length;t+=3)if((n=e[r=s[t]])!==void 0)if(q0(n)===n&&n>=s[t+1]&&n<=s[t+2])this[r]=n;else throw Error(tg+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(tg+r+": "+n);return this}var wM=LQ(pRe);Ic=new wM(1);const fs=wM;function xRe(e){return jRe(e)||wRe(e)||bRe(e)||yRe()}function yRe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bRe(e,t){if(e){if(typeof e=="string")return OO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OO(e,t)}}function wRe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function jRe(e){if(Array.isArray(e))return OO(e)}function OO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var _Re=function(t){return t},FQ={"@@functional/placeholder":!0},$Q=function(t){return t===FQ},fq=function(t){return function r(){return arguments.length===0||arguments.length===1&&$Q(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},NRe=function e(t,r){return t===1?r:fq(function(){for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];var i=s.filter(function(l){return l!==FQ}).length;return i>=t?r.apply(void 0,s):e(t-i,fq(function(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];var u=s.map(function(f){return $Q(f)?c.shift():f});return r.apply(void 0,xRe(u).concat(c))}))})},y5=function(t){return NRe(t.length,t)},TO=function(t,r){for(var n=[],s=t;s<r;++s)n[s-t]=s;return n},SRe=y5(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),CRe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return _Re;var s=r.reverse(),o=s[0],i=s.slice(1);return function(){return i.reduce(function(l,c){return c(l)},o.apply(void 0,arguments))}},DO=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},BQ=function(t){var r=null,n=null;return function(){for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r&&o.every(function(l,c){return l===r[c]})||(r=o,n=t.apply(void 0,o)),n}};function PRe(e){var t;return e===0?t=1:t=Math.floor(new fs(e).abs().log(10).toNumber())+1,t}function ARe(e,t,r){for(var n=new fs(e),s=0,o=[];n.lt(t)&&s<1e5;)o.push(n.toNumber()),n=n.add(r),s++;return o}var ERe=y5(function(e,t,r){var n=+e,s=+t;return n+r*(s-n)}),kRe=y5(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),IRe=y5(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const b5={rangeStep:ARe,getDigitCount:PRe,interpolateNumber:ERe,uninterpolateNumber:kRe,uninterpolateTruncation:IRe};function MO(e){return DRe(e)||TRe(e)||qQ(e)||ORe()}function ORe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TRe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function DRe(e){if(Array.isArray(e))return RO(e)}function Cw(e,t){return LRe(e)||RRe(e,t)||qQ(e,t)||MRe()}function MRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qQ(e,t){if(e){if(typeof e=="string")return RO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RO(e,t)}}function RO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function RRe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,s=!1,o=void 0;try{for(var i=e[Symbol.iterator](),l;!(n=(l=i.next()).done)&&(r.push(l.value),!(t&&r.length===t));n=!0);}catch(c){s=!0,o=c}finally{try{!n&&i.return!=null&&i.return()}finally{if(s)throw o}}return r}}function LRe(e){if(Array.isArray(e))return e}function zQ(e){var t=Cw(e,2),r=t[0],n=t[1],s=r,o=n;return r>n&&(s=n,o=r),[s,o]}function UQ(e,t,r){if(e.lte(0))return new fs(0);var n=b5.getDigitCount(e.toNumber()),s=new fs(10).pow(n),o=e.div(s),i=n!==1?.05:.1,l=new fs(Math.ceil(o.div(i).toNumber())).add(r).mul(i),c=l.mul(s);return t?c:new fs(Math.ceil(c))}function FRe(e,t,r){var n=1,s=new fs(e);if(!s.isint()&&r){var o=Math.abs(e);o<1?(n=new fs(10).pow(b5.getDigitCount(e)-1),s=new fs(Math.floor(s.div(n).toNumber())).mul(n)):o>1&&(s=new fs(Math.floor(e)))}else e===0?s=new fs(Math.floor((t-1)/2)):r||(s=new fs(Math.floor(e)));var i=Math.floor((t-1)/2),l=CRe(SRe(function(c){return s.add(new fs(c-i).mul(n)).toNumber()}),TO);return l(0,t)}function VQ(e,t,r,n){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new fs(0),tickMin:new fs(0),tickMax:new fs(0)};var o=UQ(new fs(t).sub(e).div(r-1),n,s),i;e<=0&&t>=0?i=new fs(0):(i=new fs(e).add(t).div(2),i=i.sub(new fs(i).mod(o)));var l=Math.ceil(i.sub(e).div(o).toNumber()),c=Math.ceil(new fs(t).sub(i).div(o).toNumber()),d=l+c+1;return d>r?VQ(e,t,r,n,s+1):(d<r&&(c=t>0?c+(r-d):c,l=t>0?l:l+(r-d)),{step:o,tickMin:i.sub(new fs(l).mul(o)),tickMax:i.add(new fs(c).mul(o))})}function $Re(e){var t=Cw(e,2),r=t[0],n=t[1],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(s,2),l=zQ([r,n]),c=Cw(l,2),d=c[0],u=c[1];if(d===-1/0||u===1/0){var f=u===1/0?[d].concat(MO(TO(0,s-1).map(function(){return 1/0}))):[].concat(MO(TO(0,s-1).map(function(){return-1/0})),[u]);return r>n?DO(f):f}if(d===u)return FRe(d,s,o);var h=VQ(d,u,i,o),m=h.step,v=h.tickMin,g=h.tickMax,y=b5.rangeStep(v,g.add(new fs(.1).mul(m)),m);return r>n?DO(y):y}function BRe(e,t){var r=Cw(e,2),n=r[0],s=r[1],o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=zQ([n,s]),l=Cw(i,2),c=l[0],d=l[1];if(c===-1/0||d===1/0)return[n,s];if(c===d)return[c];var u=Math.max(t,2),f=UQ(new fs(d).sub(c).div(u-1),o,0),h=[].concat(MO(b5.rangeStep(new fs(c),new fs(d).sub(new fs(.99).mul(f)),f)),[d]);return n>s?DO(h):h}var qRe=BQ($Re),zRe=BQ(BRe),URe=!0,sE="Invariant failed";function Rh(e,t){if(!e){if(URe)throw new Error(sE);var r=typeof t=="function"?t():t,n=r?"".concat(sE,": ").concat(r):sE;throw new Error(n)}}var VRe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Hx(e){"@babel/helpers - typeof";return Hx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hx(e)}function qN(){return qN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qN.apply(this,arguments)}function WRe(e,t){return XRe(e)||KRe(e,t)||GRe(e,t)||HRe()}function HRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GRe(e,t){if(e){if(typeof e=="string")return mq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mq(e,t)}}function mq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function KRe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function XRe(e){if(Array.isArray(e))return e}function YRe(e,t){if(e==null)return{};var r=JRe(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function JRe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function QRe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GQ(n.key),n)}}function ZRe(e,t,r){return t&&hq(e.prototype,t),r&&hq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function eLe(e,t,r){return t=zN(t),tLe(e,WQ()?Reflect.construct(t,r||[],zN(e).constructor):t.apply(e,r))}function tLe(e,t){if(t&&(Hx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rLe(e)}function rLe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(WQ=function(){return!!e})()}function zN(e){return zN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zN(e)}function nLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LO(e,t)}function LO(e,t){return LO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},LO(e,t)}function HQ(e,t,r){return t=GQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GQ(e){var t=aLe(e,"string");return Hx(t)=="symbol"?t:t+""}function aLe(e,t){if(Hx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var R1=function(e){function t(){return QRe(this,t),eLe(this,t,arguments)}return nLe(t,e),ZRe(t,[{key:"render",value:function(){var n=this.props,s=n.offset,o=n.layout,i=n.width,l=n.dataKey,c=n.data,d=n.dataPointFormatter,u=n.xAxis,f=n.yAxis,h=YRe(n,VRe),m=Bn(h,!1);this.props.direction==="x"&&u.type!=="number"&&Rh(!1);var v=c.map(function(g){var y=d(g,l),x=y.x,b=y.y,w=y.value,j=y.errorVal;if(!j)return null;var _=[],S,C;if(Array.isArray(j)){var P=WRe(j,2);S=P[0],C=P[1]}else S=C=j;if(o==="vertical"){var A=u.scale,R=b+s,O=R+i,I=R-i,M=A(w-S),D=A(w+C);_.push({x1:D,y1:O,x2:D,y2:I}),_.push({x1:M,y1:R,x2:D,y2:R}),_.push({x1:M,y1:O,x2:M,y2:I})}else if(o==="horizontal"){var U=f.scale,z=x+s,W=z-i,$=z+i,X=U(w-S),ye=U(w+C);_.push({x1:W,y1:ye,x2:$,y2:ye}),_.push({x1:z,y1:X,x2:z,y2:ye}),_.push({x1:W,y1:X,x2:$,y2:X})}return Pe.createElement(Aa,qN({className:"recharts-errorBar",key:"bar-".concat(_.map(function(Se){return"".concat(Se.x1,"-").concat(Se.x2,"-").concat(Se.y1,"-").concat(Se.y2)}))},m),_.map(function(Se){return Pe.createElement("line",qN({},Se,{key:"line-".concat(Se.x1,"-").concat(Se.x2,"-").concat(Se.y1,"-").concat(Se.y2)}))}))});return Pe.createElement(Aa,{className:"recharts-errorBars"},v)}}])}(Pe.Component);HQ(R1,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});HQ(R1,"displayName","ErrorBar");function Pw(e){"@babel/helpers - typeof";return Pw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pw(e)}function pq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function up(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pq(Object(r),!0).forEach(function(n){sLe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sLe(e,t,r){return t=oLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oLe(e){var t=iLe(e,"string");return Pw(t)=="symbol"?t:t+""}function iLe(e,t){if(Pw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var KQ=function(t){var r=t.children,n=t.formattedGraphicalItems,s=t.legendWidth,o=t.legendContent,i=Ac(r,Zp);if(!i)return null;var l=Zp.defaultProps,c=l!==void 0?up(up({},l),i.props):{},d;return i.props&&i.props.payload?d=i.props&&i.props.payload:o==="children"?d=(n||[]).reduce(function(u,f){var h=f.item,m=f.props,v=m.sectors||m.data||[];return u.concat(v.map(function(g){return{type:i.props.iconType||h.props.legendType,value:g.name,color:g.fill,payload:g}}))},[]):d=(n||[]).map(function(u){var f=u.item,h=f.type.defaultProps,m=h!==void 0?up(up({},h),f.props):{},v=m.dataKey,g=m.name,y=m.legendType,x=m.hide;return{inactive:x,dataKey:v,type:c.iconType||y||"square",color:jM(f),value:g||v,payload:m}}),up(up(up({},c),Zp.getWithHeight(i,s)),{},{payload:d,item:i})};function Aw(e){"@babel/helpers - typeof";return Aw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Aw(e)}function gq(e){return uLe(e)||dLe(e)||cLe(e)||lLe()}function lLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cLe(e,t){if(e){if(typeof e=="string")return FO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FO(e,t)}}function dLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function uLe(e){if(Array.isArray(e))return FO(e)}function FO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function fo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vq(Object(r),!0).forEach(function(n){gx(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gx(e,t,r){return t=fLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fLe(e){var t=mLe(e,"string");return Aw(t)=="symbol"?t:t+""}function mLe(e,t){if(Aw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Aw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function So(e,t,r){return la(e)||la(t)?r:ai(t)?zc(e,t,r):Zn(t)?t(e):r}function pb(e,t,r,n){var s=uRe(e,function(l){return So(l,t)});if(r==="number"){var o=s.filter(function(l){return Xr(l)||parseFloat(l)});return o.length?[x5(o),Zm(o)]:[1/0,-1/0]}var i=n?s.filter(function(l){return!la(l)}):s;return i.map(function(l){return ai(l)||l instanceof Date?l:""})}var hLe=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,i=-1,l=(r=n?.length)!==null&&r!==void 0?r:0;if(l<=1)return 0;if(o&&o.axisType==="angleAxis"&&Math.abs(Math.abs(o.range[1]-o.range[0])-360)<=1e-6)for(var c=o.range,d=0;d<l;d++){var u=d>0?s[d-1].coordinate:s[l-1].coordinate,f=s[d].coordinate,h=d>=l-1?s[0].coordinate:s[d+1].coordinate,m=void 0;if(Al(f-u)!==Al(h-f)){var v=[];if(Al(h-f)===Al(c[1]-c[0])){m=h;var g=f+c[1]-c[0];v[0]=Math.min(g,(g+u)/2),v[1]=Math.max(g,(g+u)/2)}else{m=u;var y=h+c[1]-c[0];v[0]=Math.min(f,(y+f)/2),v[1]=Math.max(f,(y+f)/2)}var x=[Math.min(f,(m+f)/2),Math.max(f,(m+f)/2)];if(t>x[0]&&t<=x[1]||t>=v[0]&&t<=v[1]){i=s[d].index;break}}else{var b=Math.min(u,h),w=Math.max(u,h);if(t>(b+f)/2&&t<=(w+f)/2){i=s[d].index;break}}}else for(var j=0;j<l;j++)if(j===0&&t<=(n[j].coordinate+n[j+1].coordinate)/2||j>0&&j<l-1&&t>(n[j].coordinate+n[j-1].coordinate)/2&&t<=(n[j].coordinate+n[j+1].coordinate)/2||j===l-1&&t>(n[j].coordinate+n[j-1].coordinate)/2){i=n[j].index;break}return i},jM=function(t){var r,n=t,s=n.type.displayName,o=(r=t.type)!==null&&r!==void 0&&r.defaultProps?fo(fo({},t.type.defaultProps),t.props):t.props,i=o.stroke,l=o.fill,c;switch(s){case"Line":c=i;break;case"Area":case"Radar":c=i&&i!=="none"?i:l;break;default:c=l;break}return c},pLe=function(t){var r=t.barSize,n=t.totalSize,s=t.stackGroups,o=s===void 0?{}:s;if(!o)return{};for(var i={},l=Object.keys(o),c=0,d=l.length;c<d;c++)for(var u=o[l[c]].stackGroups,f=Object.keys(u),h=0,m=f.length;h<m;h++){var v=u[f[h]],g=v.items,y=v.cateAxisId,x=g.filter(function(C){return Uf(C.type).indexOf("Bar")>=0});if(x&&x.length){var b=x[0].type.defaultProps,w=b!==void 0?fo(fo({},b),x[0].props):x[0].props,j=w.barSize,_=w[y];i[_]||(i[_]=[]);var S=la(j)?r:j;i[_].push({item:x[0],stackList:x.slice(1),barSize:la(S)?void 0:El(S,n,0)})}}return i},gLe=function(t){var r=t.barGap,n=t.barCategoryGap,s=t.bandSize,o=t.sizeList,i=o===void 0?[]:o,l=t.maxBarSize,c=i.length;if(c<1)return null;var d=El(r,s,0,!0),u,f=[];if(i[0].barSize===+i[0].barSize){var h=!1,m=s/c,v=i.reduce(function(j,_){return j+_.barSize||0},0);v+=(c-1)*d,v>=s&&(v-=(c-1)*d,d=0),v>=s&&m>0&&(h=!0,m*=.9,v=c*m);var g=(s-v)/2>>0,y={offset:g-d,size:0};u=i.reduce(function(j,_){var S={item:_.item,position:{offset:y.offset+y.size+d,size:h?m:_.barSize}},C=[].concat(gq(j),[S]);return y=C[C.length-1].position,_.stackList&&_.stackList.length&&_.stackList.forEach(function(P){C.push({item:P,position:y})}),C},f)}else{var x=El(n,s,0,!0);s-2*x-(c-1)*d<=0&&(d=0);var b=(s-2*x-(c-1)*d)/c;b>1&&(b>>=0);var w=l===+l?Math.min(b,l):b;u=i.reduce(function(j,_,S){var C=[].concat(gq(j),[{item:_.item,position:{offset:x+(b+d)*S+(b-w)/2,size:w}}]);return _.stackList&&_.stackList.length&&_.stackList.forEach(function(P){C.push({item:P,position:C[C.length-1].position})}),C},f)}return u},vLe=function(t,r,n,s){var o=n.children,i=n.width,l=n.margin,c=i-(l.left||0)-(l.right||0),d=KQ({children:o,legendWidth:c});if(d){var u=s||{},f=u.width,h=u.height,m=d.align,v=d.verticalAlign,g=d.layout;if((g==="vertical"||g==="horizontal"&&v==="middle")&&m!=="center"&&Xr(t[m]))return fo(fo({},t),{},gx({},m,t[m]+(f||0)));if((g==="horizontal"||g==="vertical"&&m==="center")&&v!=="middle"&&Xr(t[v]))return fo(fo({},t),{},gx({},v,t[v]+(h||0)))}return t},xLe=function(t,r,n){return la(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},XQ=function(t,r,n,s,o){var i=r.props.children,l=Uc(i,R1).filter(function(d){return xLe(s,o,d.props.direction)});if(l&&l.length){var c=l.map(function(d){return d.props.dataKey});return t.reduce(function(d,u){var f=So(u,n);if(la(f))return d;var h=Array.isArray(f)?[x5(f),Zm(f)]:[f,f],m=c.reduce(function(v,g){var y=So(u,g,0),x=h[0]-Math.abs(Array.isArray(y)?y[0]:y),b=h[1]+Math.abs(Array.isArray(y)?y[1]:y);return[Math.min(x,v[0]),Math.max(b,v[1])]},[1/0,-1/0]);return[Math.min(m[0],d[0]),Math.max(m[1],d[1])]},[1/0,-1/0])}return null},yLe=function(t,r,n,s,o){var i=r.map(function(l){return XQ(t,l,n,o,s)}).filter(function(l){return!la(l)});return i&&i.length?i.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]):null},YQ=function(t,r,n,s,o){var i=r.map(function(c){var d=c.props.dataKey;return n==="number"&&d&&XQ(t,c,d,s)||pb(t,d,n,o)});if(n==="number")return i.reduce(function(c,d){return[Math.min(c[0],d[0]),Math.max(c[1],d[1])]},[1/0,-1/0]);var l={};return i.reduce(function(c,d){for(var u=0,f=d.length;u<f;u++)l[d[u]]||(l[d[u]]=!0,c.push(d[u]));return c},[])},JQ=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},QQ=function(t,r,n,s){if(s)return t.map(function(c){return c.coordinate});var o,i,l=t.map(function(c){return c.coordinate===r&&(o=!0),c.coordinate===n&&(i=!0),c.coordinate});return o||l.push(r),i||l.push(n),l},Ff=function(t,r,n){if(!t)return null;var s=t.scale,o=t.duplicateDomain,i=t.type,l=t.range,c=t.realScaleType==="scaleBand"?s.bandwidth()/2:2,d=(r||n)&&i==="category"&&s.bandwidth?s.bandwidth()/c:0;if(d=t.axisType==="angleAxis"&&l?.length>=2?Al(l[0]-l[1])*2*d:d,r&&(t.ticks||t.niceTicks)){var u=(t.ticks||t.niceTicks).map(function(f){var h=o?o.indexOf(f):f;return{coordinate:s(h)+d,value:f,offset:d}});return u.filter(function(f){return!M0(f.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(f,h){return{coordinate:s(f)+d,value:f,index:h,offset:d}}):s.ticks&&!n?s.ticks(t.tickCount).map(function(f){return{coordinate:s(f)+d,value:f,offset:d}}):s.domain().map(function(f,h){return{coordinate:s(f)+d,value:o?o[f]:f,index:h,offset:d}})},oE=new WeakMap,mj=function(t,r){if(typeof r!="function")return t;oE.has(t)||oE.set(t,new WeakMap);var n=oE.get(t);if(n.has(r))return n.get(r);var s=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,s),s},ZQ=function(t,r,n){var s=t.scale,o=t.type,i=t.layout,l=t.axisType;if(s==="auto")return i==="radial"&&l==="radiusAxis"?{scale:bw(),realScaleType:"band"}:i==="radial"&&l==="angleAxis"?{scale:RN(),realScaleType:"linear"}:o==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:hb(),realScaleType:"point"}:o==="category"?{scale:bw(),realScaleType:"band"}:{scale:RN(),realScaleType:"linear"};if(xg(s)){var c="scale".concat(a5(s));return{scale:(cq[c]||hb)(),realScaleType:cq[c]?c:"point"}}return Zn(s)?{scale:s}:{scale:hb(),realScaleType:"point"}},xq=1e-4,eZ=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,s=t.range(),o=Math.min(s[0],s[1])-xq,i=Math.max(s[0],s[1])+xq,l=t(r[0]),c=t(r[n-1]);(l<o||l>i||c<o||c>i)&&t.domain([r[0],r[n-1]])}},bLe=function(t,r){if(!t)return null;for(var n=0,s=t.length;n<s;n++)if(t[n].item===r)return t[n].position;return null},wLe=function(t,r){if(!r||r.length!==2||!Xr(r[0])||!Xr(r[1]))return t;var n=Math.min(r[0],r[1]),s=Math.max(r[0],r[1]),o=[t[0],t[1]];return(!Xr(t[0])||t[0]<n)&&(o[0]=n),(!Xr(t[1])||t[1]>s)&&(o[1]=s),o[0]>s&&(o[0]=s),o[1]<n&&(o[1]=n),o},jLe=function(t){var r=t.length;if(!(r<=0))for(var n=0,s=t[0].length;n<s;++n)for(var o=0,i=0,l=0;l<r;++l){var c=M0(t[l][n][1])?t[l][n][0]:t[l][n][1];c>=0?(t[l][n][0]=o,t[l][n][1]=o+c,o=t[l][n][1]):(t[l][n][0]=i,t[l][n][1]=i+c,i=t[l][n][1])}},_Le=function(t){var r=t.length;if(!(r<=0))for(var n=0,s=t[0].length;n<s;++n)for(var o=0,i=0;i<r;++i){var l=M0(t[i][n][1])?t[i][n][0]:t[i][n][1];l>=0?(t[i][n][0]=o,t[i][n][1]=o+l,o=t[i][n][1]):(t[i][n][0]=0,t[i][n][1]=0)}},NLe={sign:jLe,expand:HCe,none:Fx,silhouette:GCe,wiggle:KCe,positive:_Le},SLe=function(t,r,n){var s=r.map(function(l){return l.props.dataKey}),o=NLe[n],i=WCe().keys(s).value(function(l,c){return+So(l,c,0)}).order(cO).offset(o);return i(t)},CLe=function(t,r,n,s,o,i){if(!t)return null;var l=i?r.reverse():r,c={},d=l.reduce(function(f,h){var m,v=(m=h.type)!==null&&m!==void 0&&m.defaultProps?fo(fo({},h.type.defaultProps),h.props):h.props,g=v.stackId,y=v.hide;if(y)return f;var x=v[n],b=f[x]||{hasStack:!1,stackGroups:{}};if(ai(g)){var w=b.stackGroups[g]||{numericAxisId:n,cateAxisId:s,items:[]};w.items.push(h),b.hasStack=!0,b.stackGroups[g]=w}else b.stackGroups[Fg("_stackId_")]={numericAxisId:n,cateAxisId:s,items:[h]};return fo(fo({},f),{},gx({},x,b))},c),u={};return Object.keys(d).reduce(function(f,h){var m=d[h];if(m.hasStack){var v={};m.stackGroups=Object.keys(m.stackGroups).reduce(function(g,y){var x=m.stackGroups[y];return fo(fo({},g),{},gx({},y,{numericAxisId:n,cateAxisId:s,items:x.items,stackedData:SLe(t,x.items,o)}))},v)}return fo(fo({},f),{},gx({},h,m))},u)},tZ=function(t,r){var n=r.realScaleType,s=r.type,o=r.tickCount,i=r.originalDomain,l=r.allowDecimals,c=n||r.scale;if(c!=="auto"&&c!=="linear")return null;if(o&&s==="number"&&i&&(i[0]==="auto"||i[1]==="auto")){var d=t.domain();if(!d.length)return null;var u=qRe(d,o,l);return t.domain([x5(u),Zm(u)]),{niceTicks:u}}if(o&&s==="number"){var f=t.domain(),h=zRe(f,o,l);return{niceTicks:h}}return null};function UN(e){var t=e.axis,r=e.ticks,n=e.bandSize,s=e.entry,o=e.index,i=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!la(s[t.dataKey])){var l=pN(r,"value",s[t.dataKey]);if(l)return l.coordinate+n/2}return r[o]?r[o].coordinate+n/2:null}var c=So(s,la(i)?t.dataKey:i);return la(c)?null:t.scale(c)}var yq=function(t){var r=t.axis,n=t.ticks,s=t.offset,o=t.bandSize,i=t.entry,l=t.index;if(r.type==="category")return n[l]?n[l].coordinate+s:null;var c=So(i,r.dataKey,r.domain[l]);return la(c)?null:r.scale(c)-o/2+s},PLe=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var s=Math.min(n[0],n[1]),o=Math.max(n[0],n[1]);return s<=0&&o>=0?0:o<0?o:s}return n[0]},ALe=function(t,r){var n,s=(n=t.type)!==null&&n!==void 0&&n.defaultProps?fo(fo({},t.type.defaultProps),t.props):t.props,o=s.stackId;if(ai(o)){var i=r[o];if(i){var l=i.items.indexOf(t);return l>=0?i.stackedData[l]:null}}return null},ELe=function(t){return t.reduce(function(r,n){return[x5(n.concat([r[0]]).filter(Xr)),Zm(n.concat([r[1]]).filter(Xr))]},[1/0,-1/0])},rZ=function(t,r,n){return Object.keys(t).reduce(function(s,o){var i=t[o],l=i.stackedData,c=l.reduce(function(d,u){var f=ELe(u.slice(r,n+1));return[Math.min(d[0],f[0]),Math.max(d[1],f[1])]},[1/0,-1/0]);return[Math.min(c[0],s[0]),Math.max(c[1],s[1])]},[1/0,-1/0]).map(function(s){return s===1/0||s===-1/0?0:s})},bq=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,wq=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,$O=function(t,r,n){if(Zn(t))return t(r,n);if(!Array.isArray(t))return r;var s=[];if(Xr(t[0]))s[0]=n?t[0]:Math.min(t[0],r[0]);else if(bq.test(t[0])){var o=+bq.exec(t[0])[1];s[0]=r[0]-o}else Zn(t[0])?s[0]=t[0](r[0]):s[0]=r[0];if(Xr(t[1]))s[1]=n?t[1]:Math.max(t[1],r[1]);else if(wq.test(t[1])){var i=+wq.exec(t[1])[1];s[1]=r[1]+i}else Zn(t[1])?s[1]=t[1](r[1]):s[1]=r[1];return s},VN=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var s=t.scale.bandwidth();if(!n||s>0)return s}if(t&&r&&r.length>=2){for(var o=YD(r,function(f){return f.coordinate}),i=1/0,l=1,c=o.length;l<c;l++){var d=o[l],u=o[l-1];i=Math.min((d.coordinate||0)-(u.coordinate||0),i)}return i===1/0?0:i}return n?void 0:0},jq=function(t,r,n){return!t||!t.length||wg(t,zc(n,"type.defaultProps.domain"))?r:t},nZ=function(t,r){var n=t.type.defaultProps?fo(fo({},t.type.defaultProps),t.props):t.props,s=n.dataKey,o=n.name,i=n.unit,l=n.formatter,c=n.tooltipType,d=n.chartType,u=n.hide;return fo(fo({},Bn(t,!1)),{},{dataKey:s,unit:i,formatter:l,name:o||s,color:jM(t),value:So(r,s),type:c,payload:r,chartType:d,hide:u})};function Ew(e){"@babel/helpers - typeof";return Ew=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ew(e)}function _q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Af(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_q(Object(r),!0).forEach(function(n){aZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_q(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function aZ(e,t,r){return t=kLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kLe(e){var t=ILe(e,"string");return Ew(t)=="symbol"?t:t+""}function ILe(e,t){if(Ew(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ew(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function OLe(e,t){return RLe(e)||MLe(e,t)||DLe(e,t)||TLe()}function TLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DLe(e,t){if(e){if(typeof e=="string")return Nq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Nq(e,t)}}function Nq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function MLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function RLe(e){if(Array.isArray(e))return e}var WN=Math.PI/180,LLe=function(t){return t*180/Math.PI},Ps=function(t,r,n,s){return{x:t+Math.cos(-WN*s)*n,y:r+Math.sin(-WN*s)*n}},sZ=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},FLe=function(t,r,n,s,o){var i=t.width,l=t.height,c=t.startAngle,d=t.endAngle,u=El(t.cx,i,i/2),f=El(t.cy,l,l/2),h=sZ(i,l,n),m=El(t.innerRadius,h,0),v=El(t.outerRadius,h,h*.8),g=Object.keys(r);return g.reduce(function(y,x){var b=r[x],w=b.domain,j=b.reversed,_;if(la(b.range))s==="angleAxis"?_=[c,d]:s==="radiusAxis"&&(_=[m,v]),j&&(_=[_[1],_[0]]);else{_=b.range;var S=_,C=OLe(S,2);c=C[0],d=C[1]}var P=ZQ(b,o),A=P.realScaleType,R=P.scale;R.domain(w).range(_),eZ(R);var O=tZ(R,Af(Af({},b),{},{realScaleType:A})),I=Af(Af(Af({},b),O),{},{range:_,radius:v,realScaleType:A,scale:R,cx:u,cy:f,innerRadius:m,outerRadius:v,startAngle:c,endAngle:d});return Af(Af({},y),{},aZ({},x,I))},{})},$Le=function(t,r){var n=t.x,s=t.y,o=r.x,i=r.y;return Math.sqrt(Math.pow(n-o,2)+Math.pow(s-i,2))},BLe=function(t,r){var n=t.x,s=t.y,o=r.cx,i=r.cy,l=$Le({x:n,y:s},{x:o,y:i});if(l<=0)return{radius:l};var c=(n-o)/l,d=Math.acos(c);return s>i&&(d=2*Math.PI-d),{radius:l,angle:LLe(d),angleInRadian:d}},qLe=function(t){var r=t.startAngle,n=t.endAngle,s=Math.floor(r/360),o=Math.floor(n/360),i=Math.min(s,o);return{startAngle:r-i*360,endAngle:n-i*360}},zLe=function(t,r){var n=r.startAngle,s=r.endAngle,o=Math.floor(n/360),i=Math.floor(s/360),l=Math.min(o,i);return t+l*360},Sq=function(t,r){var n=t.x,s=t.y,o=BLe({x:n,y:s},r),i=o.radius,l=o.angle,c=r.innerRadius,d=r.outerRadius;if(i<c||i>d)return!1;if(i===0)return!0;var u=qLe(r),f=u.startAngle,h=u.endAngle,m=l,v;if(f<=h){for(;m>h;)m-=360;for(;m<f;)m+=360;v=m>=f&&m<=h}else{for(;m>f;)m-=360;for(;m<h;)m+=360;v=m>=h&&m<=f}return v?Af(Af({},r),{},{radius:i,angle:zLe(m,r)}):null},oZ=function(t){return!p.isValidElement(t)&&!Zn(t)&&typeof t!="boolean"?t.className:""};function kw(e){"@babel/helpers - typeof";return kw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kw(e)}var ULe=["offset"];function VLe(e){return KLe(e)||GLe(e)||HLe(e)||WLe()}function WLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HLe(e,t){if(e){if(typeof e=="string")return BO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BO(e,t)}}function GLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function KLe(e){if(Array.isArray(e))return BO(e)}function BO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function XLe(e,t){if(e==null)return{};var r=YLe(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function YLe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Cq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Xo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Cq(Object(r),!0).forEach(function(n){JLe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Cq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function JLe(e,t,r){return t=QLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QLe(e){var t=ZLe(e,"string");return kw(t)=="symbol"?t:t+""}function ZLe(e,t){if(kw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Iw(){return Iw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Iw.apply(this,arguments)}var eFe=function(t){var r=t.value,n=t.formatter,s=la(t.children)?r:t.children;return Zn(n)?n(s):s},tFe=function(t,r){var n=Al(r-t),s=Math.min(Math.abs(r-t),360);return n*s},rFe=function(t,r,n){var s=t.position,o=t.viewBox,i=t.offset,l=t.className,c=o,d=c.cx,u=c.cy,f=c.innerRadius,h=c.outerRadius,m=c.startAngle,v=c.endAngle,g=c.clockWise,y=(f+h)/2,x=tFe(m,v),b=x>=0?1:-1,w,j;s==="insideStart"?(w=m+b*i,j=g):s==="insideEnd"?(w=v-b*i,j=!g):s==="end"&&(w=v+b*i,j=g),j=x<=0?j:!j;var _=Ps(d,u,y,w),S=Ps(d,u,y,w+(j?1:-1)*359),C="M".concat(_.x,",").concat(_.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(j?0:1,`,
    `).concat(S.x,",").concat(S.y),P=la(t.id)?Fg("recharts-radial-line-"):t.id;return Pe.createElement("text",Iw({},n,{dominantBaseline:"central",className:fa("recharts-radial-bar-label",l)}),Pe.createElement("defs",null,Pe.createElement("path",{id:P,d:C})),Pe.createElement("textPath",{xlinkHref:"#".concat(P)},r))},nFe=function(t){var r=t.viewBox,n=t.offset,s=t.position,o=r,i=o.cx,l=o.cy,c=o.innerRadius,d=o.outerRadius,u=o.startAngle,f=o.endAngle,h=(u+f)/2;if(s==="outside"){var m=Ps(i,l,d+n,h),v=m.x,g=m.y;return{x:v,y:g,textAnchor:v>=i?"start":"end",verticalAnchor:"middle"}}if(s==="center")return{x:i,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(s==="centerTop")return{x:i,y:l,textAnchor:"middle",verticalAnchor:"start"};if(s==="centerBottom")return{x:i,y:l,textAnchor:"middle",verticalAnchor:"end"};var y=(c+d)/2,x=Ps(i,l,y,h),b=x.x,w=x.y;return{x:b,y:w,textAnchor:"middle",verticalAnchor:"middle"}},aFe=function(t){var r=t.viewBox,n=t.parentViewBox,s=t.offset,o=t.position,i=r,l=i.x,c=i.y,d=i.width,u=i.height,f=u>=0?1:-1,h=f*s,m=f>0?"end":"start",v=f>0?"start":"end",g=d>=0?1:-1,y=g*s,x=g>0?"end":"start",b=g>0?"start":"end";if(o==="top"){var w={x:l+d/2,y:c-f*s,textAnchor:"middle",verticalAnchor:m};return Xo(Xo({},w),n?{height:Math.max(c-n.y,0),width:d}:{})}if(o==="bottom"){var j={x:l+d/2,y:c+u+h,textAnchor:"middle",verticalAnchor:v};return Xo(Xo({},j),n?{height:Math.max(n.y+n.height-(c+u),0),width:d}:{})}if(o==="left"){var _={x:l-y,y:c+u/2,textAnchor:x,verticalAnchor:"middle"};return Xo(Xo({},_),n?{width:Math.max(_.x-n.x,0),height:u}:{})}if(o==="right"){var S={x:l+d+y,y:c+u/2,textAnchor:b,verticalAnchor:"middle"};return Xo(Xo({},S),n?{width:Math.max(n.x+n.width-S.x,0),height:u}:{})}var C=n?{width:d,height:u}:{};return o==="insideLeft"?Xo({x:l+y,y:c+u/2,textAnchor:b,verticalAnchor:"middle"},C):o==="insideRight"?Xo({x:l+d-y,y:c+u/2,textAnchor:x,verticalAnchor:"middle"},C):o==="insideTop"?Xo({x:l+d/2,y:c+h,textAnchor:"middle",verticalAnchor:v},C):o==="insideBottom"?Xo({x:l+d/2,y:c+u-h,textAnchor:"middle",verticalAnchor:m},C):o==="insideTopLeft"?Xo({x:l+y,y:c+h,textAnchor:b,verticalAnchor:v},C):o==="insideTopRight"?Xo({x:l+d-y,y:c+h,textAnchor:x,verticalAnchor:v},C):o==="insideBottomLeft"?Xo({x:l+y,y:c+u-h,textAnchor:b,verticalAnchor:m},C):o==="insideBottomRight"?Xo({x:l+d-y,y:c+u-h,textAnchor:x,verticalAnchor:m},C):I0(o)&&(Xr(o.x)||Fp(o.x))&&(Xr(o.y)||Fp(o.y))?Xo({x:l+El(o.x,d),y:c+El(o.y,u),textAnchor:"end",verticalAnchor:"end"},C):Xo({x:l+d/2,y:c+u/2,textAnchor:"middle",verticalAnchor:"middle"},C)},sFe=function(t){return"cx"in t&&Xr(t.cx)};function pi(e){var t=e.offset,r=t===void 0?5:t,n=XLe(e,ULe),s=Xo({offset:r},n),o=s.viewBox,i=s.position,l=s.value,c=s.children,d=s.content,u=s.className,f=u===void 0?"":u,h=s.textBreakAll;if(!o||la(l)&&la(c)&&!p.isValidElement(d)&&!Zn(d))return null;if(p.isValidElement(d))return p.cloneElement(d,s);var m;if(Zn(d)){if(m=p.createElement(d,s),p.isValidElement(m))return m}else m=eFe(s);var v=sFe(o),g=Bn(s,!0);if(v&&(i==="insideStart"||i==="insideEnd"||i==="end"))return rFe(s,m,g);var y=v?nFe(s):aFe(s);return Pe.createElement(bg,Iw({className:fa("recharts-label",f)},g,y,{breakAll:h}),m)}pi.displayName="Label";var iZ=function(t){var r=t.cx,n=t.cy,s=t.angle,o=t.startAngle,i=t.endAngle,l=t.r,c=t.radius,d=t.innerRadius,u=t.outerRadius,f=t.x,h=t.y,m=t.top,v=t.left,g=t.width,y=t.height,x=t.clockWise,b=t.labelViewBox;if(b)return b;if(Xr(g)&&Xr(y)){if(Xr(f)&&Xr(h))return{x:f,y:h,width:g,height:y};if(Xr(m)&&Xr(v))return{x:m,y:v,width:g,height:y}}return Xr(f)&&Xr(h)?{x:f,y:h,width:0,height:0}:Xr(r)&&Xr(n)?{cx:r,cy:n,startAngle:o||s||0,endAngle:i||s||0,innerRadius:d||0,outerRadius:u||c||l||0,clockWise:x}:t.viewBox?t.viewBox:{}},oFe=function(t,r){return t?t===!0?Pe.createElement(pi,{key:"label-implicit",viewBox:r}):ai(t)?Pe.createElement(pi,{key:"label-implicit",viewBox:r,value:t}):p.isValidElement(t)?t.type===pi?p.cloneElement(t,{key:"label-implicit",viewBox:r}):Pe.createElement(pi,{key:"label-implicit",content:t,viewBox:r}):Zn(t)?Pe.createElement(pi,{key:"label-implicit",content:t,viewBox:r}):I0(t)?Pe.createElement(pi,Iw({viewBox:r},t,{key:"label-implicit"})):null:null},iFe=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var s=t.children,o=iZ(t),i=Uc(s,pi).map(function(c,d){return p.cloneElement(c,{viewBox:r||o,key:"label-".concat(d)})});if(!n)return i;var l=oFe(t.label,r||o);return[l].concat(VLe(i))};pi.parseViewBox=iZ;pi.renderCallByParent=iFe;function lFe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var cFe=lFe;const dFe=Ua(cFe);function Ow(e){"@babel/helpers - typeof";return Ow=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ow(e)}var uFe=["valueAccessor"],fFe=["data","dataKey","clockWise","id","textBreakAll"];function mFe(e){return vFe(e)||gFe(e)||pFe(e)||hFe()}function hFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pFe(e,t){if(e){if(typeof e=="string")return qO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qO(e,t)}}function gFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function vFe(e){if(Array.isArray(e))return qO(e)}function qO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HN(){return HN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},HN.apply(this,arguments)}function Pq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Aq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Pq(Object(r),!0).forEach(function(n){xFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xFe(e,t,r){return t=yFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yFe(e){var t=bFe(e,"string");return Ow(t)=="symbol"?t:t+""}function bFe(e,t){if(Ow(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ow(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Eq(e,t){if(e==null)return{};var r=wFe(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function wFe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var jFe=function(t){return Array.isArray(t.value)?dFe(t.value):t.value};function rf(e){var t=e.valueAccessor,r=t===void 0?jFe:t,n=Eq(e,uFe),s=n.data,o=n.dataKey,i=n.clockWise,l=n.id,c=n.textBreakAll,d=Eq(n,fFe);return!s||!s.length?null:Pe.createElement(Aa,{className:"recharts-label-list"},s.map(function(u,f){var h=la(o)?r(u,f):So(u&&u.payload,o),m=la(l)?{}:{id:"".concat(l,"-").concat(f)};return Pe.createElement(pi,HN({},Bn(u,!0),d,m,{parentViewBox:u.parentViewBox,value:h,textBreakAll:c,viewBox:pi.parseViewBox(la(i)?u:Aq(Aq({},u),{},{clockWise:i})),key:"label-".concat(f),index:f}))}))}rf.displayName="LabelList";function _Fe(e,t){return e?e===!0?Pe.createElement(rf,{key:"labelList-implicit",data:t}):Pe.isValidElement(e)||Zn(e)?Pe.createElement(rf,{key:"labelList-implicit",data:t,content:e}):I0(e)?Pe.createElement(rf,HN({data:t},e,{key:"labelList-implicit"})):null:null}function NFe(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,s=Uc(n,rf).map(function(i,l){return p.cloneElement(i,{data:t,key:"labelList-".concat(l)})});if(!r)return s;var o=_Fe(e.label,t);return[o].concat(mFe(s))}rf.renderCallByParent=NFe;function Tw(e){"@babel/helpers - typeof";return Tw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tw(e)}function zO(){return zO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zO.apply(this,arguments)}function kq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Iq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kq(Object(r),!0).forEach(function(n){SFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SFe(e,t,r){return t=CFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CFe(e){var t=PFe(e,"string");return Tw(t)=="symbol"?t:t+""}function PFe(e,t){if(Tw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var AFe=function(t,r){var n=Al(r-t),s=Math.min(Math.abs(r-t),359.999);return n*s},hj=function(t){var r=t.cx,n=t.cy,s=t.radius,o=t.angle,i=t.sign,l=t.isExternal,c=t.cornerRadius,d=t.cornerIsExternal,u=c*(l?1:-1)+s,f=Math.asin(c/u)/WN,h=d?o:o+i*f,m=Ps(r,n,u,h),v=Ps(r,n,s,h),g=d?o-i*f:o,y=Ps(r,n,u*Math.cos(f*WN),g);return{center:m,circleTangency:v,lineTangency:y,theta:f}},lZ=function(t){var r=t.cx,n=t.cy,s=t.innerRadius,o=t.outerRadius,i=t.startAngle,l=t.endAngle,c=AFe(i,l),d=i+c,u=Ps(r,n,o,i),f=Ps(r,n,o,d),h="M ".concat(u.x,",").concat(u.y,`
    A `).concat(o,",").concat(o,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(i>d),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(s>0){var m=Ps(r,n,s,i),v=Ps(r,n,s,d);h+="L ".concat(v.x,",").concat(v.y,`
            A `).concat(s,",").concat(s,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(i<=d),`,
            `).concat(m.x,",").concat(m.y," Z")}else h+="L ".concat(r,",").concat(n," Z");return h},EFe=function(t){var r=t.cx,n=t.cy,s=t.innerRadius,o=t.outerRadius,i=t.cornerRadius,l=t.forceCornerRadius,c=t.cornerIsExternal,d=t.startAngle,u=t.endAngle,f=Al(u-d),h=hj({cx:r,cy:n,radius:o,angle:d,sign:f,cornerRadius:i,cornerIsExternal:c}),m=h.circleTangency,v=h.lineTangency,g=h.theta,y=hj({cx:r,cy:n,radius:o,angle:u,sign:-f,cornerRadius:i,cornerIsExternal:c}),x=y.circleTangency,b=y.lineTangency,w=y.theta,j=c?Math.abs(d-u):Math.abs(d-u)-g-w;if(j<0)return l?"M ".concat(v.x,",").concat(v.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):lZ({cx:r,cy:n,innerRadius:s,outerRadius:o,startAngle:d,endAngle:u});var _="M ".concat(v.x,",").concat(v.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(o,",").concat(o,",0,").concat(+(j>180),",").concat(+(f<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(b.x,",").concat(b.y,`
  `);if(s>0){var S=hj({cx:r,cy:n,radius:s,angle:d,sign:f,isExternal:!0,cornerRadius:i,cornerIsExternal:c}),C=S.circleTangency,P=S.lineTangency,A=S.theta,R=hj({cx:r,cy:n,radius:s,angle:u,sign:-f,isExternal:!0,cornerRadius:i,cornerIsExternal:c}),O=R.circleTangency,I=R.lineTangency,M=R.theta,D=c?Math.abs(d-u):Math.abs(d-u)-A-M;if(D<0&&i===0)return"".concat(_,"L").concat(r,",").concat(n,"Z");_+="L".concat(I.x,",").concat(I.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(O.x,",").concat(O.y,`
      A`).concat(s,",").concat(s,",0,").concat(+(D>180),",").concat(+(f>0),",").concat(C.x,",").concat(C.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(P.x,",").concat(P.y,"Z")}else _+="L".concat(r,",").concat(n,"Z");return _},kFe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},_M=function(t){var r=Iq(Iq({},kFe),t),n=r.cx,s=r.cy,o=r.innerRadius,i=r.outerRadius,l=r.cornerRadius,c=r.forceCornerRadius,d=r.cornerIsExternal,u=r.startAngle,f=r.endAngle,h=r.className;if(i<o||u===f)return null;var m=fa("recharts-sector",h),v=i-o,g=El(l,v,0,!0),y;return g>0&&Math.abs(u-f)<360?y=EFe({cx:n,cy:s,innerRadius:o,outerRadius:i,cornerRadius:Math.min(g,v/2),forceCornerRadius:c,cornerIsExternal:d,startAngle:u,endAngle:f}):y=lZ({cx:n,cy:s,innerRadius:o,outerRadius:i,startAngle:u,endAngle:f}),Pe.createElement("path",zO({},Bn(r,!0),{className:m,d:y,role:"img"}))};function Dw(e){"@babel/helpers - typeof";return Dw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dw(e)}function UO(){return UO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},UO.apply(this,arguments)}function Oq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Tq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Oq(Object(r),!0).forEach(function(n){IFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IFe(e,t,r){return t=OFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OFe(e){var t=TFe(e,"string");return Dw(t)=="symbol"?t:t+""}function TFe(e,t){if(Dw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Dw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dq={curveBasisClosed:DCe,curveBasisOpen:MCe,curveBasis:TCe,curveBumpX:yCe,curveBumpY:bCe,curveLinearClosed:RCe,curveLinear:o5,curveMonotoneX:LCe,curveMonotoneY:FCe,curveNatural:$Ce,curveStep:BCe,curveStepAfter:zCe,curveStepBefore:qCe},pj=function(t){return t.x===+t.x&&t.y===+t.y},jy=function(t){return t.x},_y=function(t){return t.y},DFe=function(t,r){if(Zn(t))return t;var n="curve".concat(a5(t));return(n==="curveMonotone"||n==="curveBump")&&r?Dq["".concat(n).concat(r==="vertical"?"Y":"X")]:Dq[n]||o5},MFe=function(t){var r=t.type,n=r===void 0?"linear":r,s=t.points,o=s===void 0?[]:s,i=t.baseLine,l=t.layout,c=t.connectNulls,d=c===void 0?!1:c,u=DFe(n,l),f=d?o.filter(function(g){return pj(g)}):o,h;if(Array.isArray(i)){var m=d?i.filter(function(g){return pj(g)}):i,v=f.map(function(g,y){return Tq(Tq({},g),{},{base:m[y]})});return l==="vertical"?h=sj().y(_y).x1(jy).x0(function(g){return g.base.x}):h=sj().x(jy).y1(_y).y0(function(g){return g.base.y}),h.defined(pj).curve(u),h(v)}return l==="vertical"&&Xr(i)?h=sj().y(_y).x1(jy).x0(i):Xr(i)?h=sj().x(jy).y1(_y).y0(i):h=nJ().x(jy).y(_y),h.defined(pj).curve(u),h(f)},rg=function(t){var r=t.className,n=t.points,s=t.path,o=t.pathRef;if((!n||!n.length)&&!s)return null;var i=n&&n.length?MFe(t):s;return p.createElement("path",UO({},Bn(t,!1),gN(t),{className:fa("recharts-curve",r),d:i,ref:o}))},cZ={exports:{}},RFe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",LFe=RFe,FFe=LFe;function dZ(){}function uZ(){}uZ.resetWarningCache=dZ;var $Fe=function(){function e(n,s,o,i,l,c){if(c!==FFe){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:uZ,resetWarningCache:dZ};return r.PropTypes=r,r};cZ.exports=$Fe();var BFe=cZ.exports;const Hn=Ua(BFe);var qFe=Object.getOwnPropertyNames,zFe=Object.getOwnPropertySymbols,UFe=Object.prototype.hasOwnProperty;function Mq(e,t){return function(n,s,o){return e(n,s,o)&&t(n,s,o)}}function gj(e){return function(r,n,s){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,s);var o=s.cache,i=o.get(r),l=o.get(n);if(i&&l)return i===n&&l===r;o.set(r,n),o.set(n,r);var c=e(r,n,s);return o.delete(r),o.delete(n),c}}function Rq(e){return qFe(e).concat(zFe(e))}var VFe=Object.hasOwn||function(e,t){return UFe.call(e,t)};function qg(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var WFe="__v",HFe="__o",GFe="_owner",Lq=Object.getOwnPropertyDescriptor,Fq=Object.keys;function KFe(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function XFe(e,t){return qg(e.getTime(),t.getTime())}function YFe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function JFe(e,t){return e===t}function $q(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var s=new Array(n),o=e.entries(),i,l,c=0;(i=o.next())&&!i.done;){for(var d=t.entries(),u=!1,f=0;(l=d.next())&&!l.done;){if(s[f]){f++;continue}var h=i.value,m=l.value;if(r.equals(h[0],m[0],c,f,e,t,r)&&r.equals(h[1],m[1],h[0],m[0],e,t,r)){u=s[f]=!0;break}f++}if(!u)return!1;c++}return!0}var QFe=qg;function ZFe(e,t,r){var n=Fq(e),s=n.length;if(Fq(t).length!==s)return!1;for(;s-- >0;)if(!fZ(e,t,r,n[s]))return!1;return!0}function Ny(e,t,r){var n=Rq(e),s=n.length;if(Rq(t).length!==s)return!1;for(var o,i,l;s-- >0;)if(o=n[s],!fZ(e,t,r,o)||(i=Lq(e,o),l=Lq(t,o),(i||l)&&(!i||!l||i.configurable!==l.configurable||i.enumerable!==l.enumerable||i.writable!==l.writable)))return!1;return!0}function e$e(e,t){return qg(e.valueOf(),t.valueOf())}function t$e(e,t){return e.source===t.source&&e.flags===t.flags}function Bq(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var s=new Array(n),o=e.values(),i,l;(i=o.next())&&!i.done;){for(var c=t.values(),d=!1,u=0;(l=c.next())&&!l.done;){if(!s[u]&&r.equals(i.value,l.value,i.value,l.value,e,t,r)){d=s[u]=!0;break}u++}if(!d)return!1}return!0}function r$e(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function n$e(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function fZ(e,t,r,n){return(n===GFe||n===HFe||n===WFe)&&(e.$$typeof||t.$$typeof)?!0:VFe(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var a$e="[object Arguments]",s$e="[object Boolean]",o$e="[object Date]",i$e="[object Error]",l$e="[object Map]",c$e="[object Number]",d$e="[object Object]",u$e="[object RegExp]",f$e="[object Set]",m$e="[object String]",h$e="[object URL]",p$e=Array.isArray,qq=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,zq=Object.assign,g$e=Object.prototype.toString.call.bind(Object.prototype.toString);function v$e(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,s=e.areFunctionsEqual,o=e.areMapsEqual,i=e.areNumbersEqual,l=e.areObjectsEqual,c=e.arePrimitiveWrappersEqual,d=e.areRegExpsEqual,u=e.areSetsEqual,f=e.areTypedArraysEqual,h=e.areUrlsEqual;return function(v,g,y){if(v===g)return!0;if(v==null||g==null)return!1;var x=typeof v;if(x!==typeof g)return!1;if(x!=="object")return x==="number"?i(v,g,y):x==="function"?s(v,g,y):!1;var b=v.constructor;if(b!==g.constructor)return!1;if(b===Object)return l(v,g,y);if(p$e(v))return t(v,g,y);if(qq!=null&&qq(v))return f(v,g,y);if(b===Date)return r(v,g,y);if(b===RegExp)return d(v,g,y);if(b===Map)return o(v,g,y);if(b===Set)return u(v,g,y);var w=g$e(v);return w===o$e?r(v,g,y):w===u$e?d(v,g,y):w===l$e?o(v,g,y):w===f$e?u(v,g,y):w===d$e?typeof v.then!="function"&&typeof g.then!="function"&&l(v,g,y):w===h$e?h(v,g,y):w===i$e?n(v,g,y):w===a$e?l(v,g,y):w===s$e||w===c$e||w===m$e?c(v,g,y):!1}}function x$e(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,s={areArraysEqual:n?Ny:KFe,areDatesEqual:XFe,areErrorsEqual:YFe,areFunctionsEqual:JFe,areMapsEqual:n?Mq($q,Ny):$q,areNumbersEqual:QFe,areObjectsEqual:n?Ny:ZFe,arePrimitiveWrappersEqual:e$e,areRegExpsEqual:t$e,areSetsEqual:n?Mq(Bq,Ny):Bq,areTypedArraysEqual:n?Ny:r$e,areUrlsEqual:n$e};if(r&&(s=zq({},s,r(s))),t){var o=gj(s.areArraysEqual),i=gj(s.areMapsEqual),l=gj(s.areObjectsEqual),c=gj(s.areSetsEqual);s=zq({},s,{areArraysEqual:o,areMapsEqual:i,areObjectsEqual:l,areSetsEqual:c})}return s}function y$e(e){return function(t,r,n,s,o,i,l){return e(t,r,l)}}function b$e(e){var t=e.circular,r=e.comparator,n=e.createState,s=e.equals,o=e.strict;if(n)return function(c,d){var u=n(),f=u.cache,h=f===void 0?t?new WeakMap:void 0:f,m=u.meta;return r(c,d,{cache:h,equals:s,meta:m,strict:o})};if(t)return function(c,d){return r(c,d,{cache:new WeakMap,equals:s,meta:void 0,strict:o})};var i={cache:void 0,equals:s,meta:void 0,strict:o};return function(c,d){return r(c,d,i)}}var w$e=Qh();Qh({strict:!0});Qh({circular:!0});Qh({circular:!0,strict:!0});Qh({createInternalComparator:function(){return qg}});Qh({strict:!0,createInternalComparator:function(){return qg}});Qh({circular:!0,createInternalComparator:function(){return qg}});Qh({circular:!0,createInternalComparator:function(){return qg},strict:!0});function Qh(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,s=e.createState,o=e.strict,i=o===void 0?!1:o,l=x$e(e),c=v$e(l),d=n?n(c):y$e(c);return b$e({circular:r,comparator:c,createState:s,equals:d,strict:i})}function j$e(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function Uq(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function s(o){r<0&&(r=o),o-r>t?(e(o),r=-1):j$e(s)};requestAnimationFrame(n)}function VO(e){"@babel/helpers - typeof";return VO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},VO(e)}function _$e(e){return P$e(e)||C$e(e)||S$e(e)||N$e()}function N$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function S$e(e,t){if(e){if(typeof e=="string")return Vq(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Vq(e,t)}}function Vq(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function C$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function P$e(e){if(Array.isArray(e))return e}function A$e(){var e={},t=function(){return null},r=!1,n=function s(o){if(!r){if(Array.isArray(o)){if(!o.length)return;var i=o,l=_$e(i),c=l[0],d=l.slice(1);if(typeof c=="number"){Uq(s.bind(null,d),c);return}s(c),Uq(s.bind(null,d));return}VO(o)==="object"&&(e=o,t(e)),typeof o=="function"&&o()}};return{stop:function(){r=!0},start:function(o){r=!1,n(o)},subscribe:function(o){return t=o,function(){t=function(){return null}}}}}function Mw(e){"@babel/helpers - typeof";return Mw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mw(e)}function Wq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Hq(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Wq(Object(r),!0).forEach(function(n){mZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mZ(e,t,r){return t=E$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function E$e(e){var t=k$e(e,"string");return Mw(t)==="symbol"?t:String(t)}function k$e(e,t){if(Mw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Mw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var I$e=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,s){return n.filter(function(o){return s.includes(o)})})},O$e=function(t){return t},T$e=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},gb=function(t,r){return Object.keys(r).reduce(function(n,s){return Hq(Hq({},n),{},mZ({},s,t(s,r[s])))},{})},Gq=function(t,r,n){return t.map(function(s){return"".concat(T$e(s)," ").concat(r,"ms ").concat(n)}).join(",")};function D$e(e,t){return L$e(e)||R$e(e,t)||hZ(e,t)||M$e()}function M$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function R$e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function L$e(e){if(Array.isArray(e))return e}function F$e(e){return q$e(e)||B$e(e)||hZ(e)||$$e()}function $$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hZ(e,t){if(e){if(typeof e=="string")return WO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WO(e,t)}}function B$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function q$e(e){if(Array.isArray(e))return WO(e)}function WO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var GN=1e-4,pZ=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},gZ=function(t,r){return t.map(function(n,s){return n*Math.pow(r,s)}).reduce(function(n,s){return n+s})},Kq=function(t,r){return function(n){var s=pZ(t,r);return gZ(s,n)}},z$e=function(t,r){return function(n){var s=pZ(t,r),o=[].concat(F$e(s.map(function(i,l){return i*l}).slice(1)),[0]);return gZ(o,n)}},Xq=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var s=r[0],o=r[1],i=r[2],l=r[3];if(r.length===1)switch(r[0]){case"linear":s=0,o=0,i=1,l=1;break;case"ease":s=.25,o=.1,i=.25,l=1;break;case"ease-in":s=.42,o=0,i=1,l=1;break;case"ease-out":s=.42,o=0,i=.58,l=1;break;case"ease-in-out":s=0,o=0,i=.58,l=1;break;default:{var c=r[0].split("(");if(c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4){var d=c[1].split(")")[0].split(",").map(function(y){return parseFloat(y)}),u=D$e(d,4);s=u[0],o=u[1],i=u[2],l=u[3]}}}var f=Kq(s,i),h=Kq(o,l),m=z$e(s,i),v=function(x){return x>1?1:x<0?0:x},g=function(x){for(var b=x>1?1:x,w=b,j=0;j<8;++j){var _=f(w)-b,S=m(w);if(Math.abs(_-b)<GN||S<GN)return h(w);w=v(w-_/S)}return h(w)};return g.isStepper=!1,g},U$e=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,s=t.damping,o=s===void 0?8:s,i=t.dt,l=i===void 0?17:i,c=function(u,f,h){var m=-(u-f)*n,v=h*o,g=h+(m-v)*l/1e3,y=h*l/1e3+u;return Math.abs(y-f)<GN&&Math.abs(g)<GN?[f,0]:[y,g]};return c.isStepper=!0,c.dt=l,c},V$e=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var s=r[0];if(typeof s=="string")switch(s){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Xq(s);case"spring":return U$e();default:if(s.split("(")[0]==="cubic-bezier")return Xq(s)}return typeof s=="function"?s:null};function Rw(e){"@babel/helpers - typeof";return Rw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rw(e)}function Yq(e){return G$e(e)||H$e(e)||vZ(e)||W$e()}function W$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function H$e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function G$e(e){if(Array.isArray(e))return GO(e)}function Jq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Mi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Jq(Object(r),!0).forEach(function(n){HO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HO(e,t,r){return t=K$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K$e(e){var t=X$e(e,"string");return Rw(t)==="symbol"?t:String(t)}function X$e(e,t){if(Rw(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rw(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Y$e(e,t){return Z$e(e)||Q$e(e,t)||vZ(e,t)||J$e()}function J$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vZ(e,t){if(e){if(typeof e=="string")return GO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GO(e,t)}}function GO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Q$e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function Z$e(e){if(Array.isArray(e))return e}var KN=function(t,r,n){return t+(r-t)*n},KO=function(t){var r=t.from,n=t.to;return r!==n},e6e=function e(t,r,n){var s=gb(function(o,i){if(KO(i)){var l=t(i.from,i.to,i.velocity),c=Y$e(l,2),d=c[0],u=c[1];return Mi(Mi({},i),{},{from:d,velocity:u})}return i},r);return n<1?gb(function(o,i){return KO(i)?Mi(Mi({},i),{},{velocity:KN(i.velocity,s[o].velocity,n),from:KN(i.from,s[o].from,n)}):i},r):e(t,s,n-1)};const t6e=function(e,t,r,n,s){var o=I$e(e,t),i=o.reduce(function(y,x){return Mi(Mi({},y),{},HO({},x,[e[x],t[x]]))},{}),l=o.reduce(function(y,x){return Mi(Mi({},y),{},HO({},x,{from:e[x],velocity:0,to:t[x]}))},{}),c=-1,d,u,f=function(){return null},h=function(){return gb(function(x,b){return b.from},l)},m=function(){return!Object.values(l).filter(KO).length},v=function(x){d||(d=x);var b=x-d,w=b/r.dt;l=e6e(r,l,w),s(Mi(Mi(Mi({},e),t),h())),d=x,m()||(c=requestAnimationFrame(f))},g=function(x){u||(u=x);var b=(x-u)/n,w=gb(function(_,S){return KN.apply(void 0,Yq(S).concat([r(b)]))},i);if(s(Mi(Mi(Mi({},e),t),w)),b<1)c=requestAnimationFrame(f);else{var j=gb(function(_,S){return KN.apply(void 0,Yq(S).concat([r(1)]))},i);s(Mi(Mi(Mi({},e),t),j))}};return f=r.isStepper?v:g,function(){return requestAnimationFrame(f),function(){cancelAnimationFrame(c)}}};function Gx(e){"@babel/helpers - typeof";return Gx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gx(e)}var r6e=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function n6e(e,t){if(e==null)return{};var r=a6e(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function a6e(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,o;for(o=0;o<n.length;o++)s=n[o],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function iE(e){return l6e(e)||i6e(e)||o6e(e)||s6e()}function s6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o6e(e,t){if(e){if(typeof e=="string")return XO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XO(e,t)}}function i6e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function l6e(e){if(Array.isArray(e))return XO(e)}function XO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Qq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Gd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qq(Object(r),!0).forEach(function(n){qy(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qy(e,t,r){return t=xZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xZ(n.key),n)}}function d6e(e,t,r){return t&&Zq(e.prototype,t),r&&Zq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xZ(e){var t=u6e(e,"string");return Gx(t)==="symbol"?t:String(t)}function u6e(e,t){if(Gx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function f6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&YO(e,t)}function YO(e,t){return YO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},YO(e,t)}function m6e(e){var t=h6e();return function(){var n=XN(e),s;if(t){var o=XN(this).constructor;s=Reflect.construct(n,arguments,o)}else s=n.apply(this,arguments);return JO(this,s)}}function JO(e,t){if(t&&(Gx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QO(e)}function QO(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h6e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function XN(e){return XN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},XN(e)}var w5=function(e){f6e(r,e);var t=m6e(r);function r(n,s){var o;c6e(this,r),o=t.call(this,n,s);var i=o.props,l=i.isActive,c=i.attributeName,d=i.from,u=i.to,f=i.steps,h=i.children,m=i.duration;if(o.handleStyleChange=o.handleStyleChange.bind(QO(o)),o.changeStyle=o.changeStyle.bind(QO(o)),!l||m<=0)return o.state={style:{}},typeof h=="function"&&(o.state={style:u}),JO(o);if(f&&f.length)o.state={style:f[0].style};else if(d){if(typeof h=="function")return o.state={style:d},JO(o);o.state={style:c?qy({},c,d):d}}else o.state={style:{}};return o}return d6e(r,[{key:"componentDidMount",value:function(){var s=this.props,o=s.isActive,i=s.canBegin;this.mounted=!0,!(!o||!i)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(s){var o=this.props,i=o.isActive,l=o.canBegin,c=o.attributeName,d=o.shouldReAnimate,u=o.to,f=o.from,h=this.state.style;if(l){if(!i){var m={style:c?qy({},c,u):u};this.state&&h&&(c&&h[c]!==u||!c&&h!==u)&&this.setState(m);return}if(!(w$e(s.to,u)&&s.canBegin&&s.isActive)){var v=!s.canBegin||!s.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var g=v||d?f:s.to;if(this.state&&h){var y={style:c?qy({},c,g):g};(c&&h[c]!==g||!c&&h!==g)&&this.setState(y)}this.runAnimation(Gd(Gd({},this.props),{},{from:g,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var s=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),s&&s()}},{key:"handleStyleChange",value:function(s){this.changeStyle(s)}},{key:"changeStyle",value:function(s){this.mounted&&this.setState({style:s})}},{key:"runJSAnimation",value:function(s){var o=this,i=s.from,l=s.to,c=s.duration,d=s.easing,u=s.begin,f=s.onAnimationEnd,h=s.onAnimationStart,m=t6e(i,l,V$e(d),c,this.changeStyle),v=function(){o.stopJSAnimation=m()};this.manager.start([h,u,v,c,f])}},{key:"runStepAnimation",value:function(s){var o=this,i=s.steps,l=s.begin,c=s.onAnimationStart,d=i[0],u=d.style,f=d.duration,h=f===void 0?0:f,m=function(g,y,x){if(x===0)return g;var b=y.duration,w=y.easing,j=w===void 0?"ease":w,_=y.style,S=y.properties,C=y.onAnimationEnd,P=x>0?i[x-1]:y,A=S||Object.keys(_);if(typeof j=="function"||j==="spring")return[].concat(iE(g),[o.runJSAnimation.bind(o,{from:P.style,to:_,duration:b,easing:j}),b]);var R=Gq(A,b,j),O=Gd(Gd(Gd({},P.style),_),{},{transition:R});return[].concat(iE(g),[O,b,C]).filter(O$e)};return this.manager.start([c].concat(iE(i.reduce(m,[u,Math.max(h,l)])),[s.onAnimationEnd]))}},{key:"runAnimation",value:function(s){this.manager||(this.manager=A$e());var o=s.begin,i=s.duration,l=s.attributeName,c=s.to,d=s.easing,u=s.onAnimationStart,f=s.onAnimationEnd,h=s.steps,m=s.children,v=this.manager;if(this.unSubscribe=v.subscribe(this.handleStyleChange),typeof d=="function"||typeof m=="function"||d==="spring"){this.runJSAnimation(s);return}if(h.length>1){this.runStepAnimation(s);return}var g=l?qy({},l,c):c,y=Gq(Object.keys(g),i,d);v.start([u,o,Gd(Gd({},g),{},{transition:y}),i,f])}},{key:"render",value:function(){var s=this.props,o=s.children;s.begin;var i=s.duration;s.attributeName,s.easing;var l=s.isActive;s.steps,s.from,s.to,s.canBegin,s.onAnimationEnd,s.shouldReAnimate,s.onAnimationReStart;var c=n6e(s,r6e),d=p.Children.count(o),u=this.state.style;if(typeof o=="function")return o(u);if(!l||d===0||i<=0)return o;var f=function(m){var v=m.props,g=v.style,y=g===void 0?{}:g,x=v.className,b=p.cloneElement(m,Gd(Gd({},c),{},{style:Gd(Gd({},y),u),className:x}));return b};return d===1?f(p.Children.only(o)):Pe.createElement("div",null,p.Children.map(o,function(h){return f(h)}))}}]),r}(p.PureComponent);w5.displayName="Animate";w5.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};w5.propTypes={from:Hn.oneOfType([Hn.object,Hn.string]),to:Hn.oneOfType([Hn.object,Hn.string]),attributeName:Hn.string,duration:Hn.number,begin:Hn.number,easing:Hn.oneOfType([Hn.string,Hn.func]),steps:Hn.arrayOf(Hn.shape({duration:Hn.number.isRequired,style:Hn.object.isRequired,easing:Hn.oneOfType([Hn.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Hn.func]),properties:Hn.arrayOf("string"),onAnimationEnd:Hn.func})),children:Hn.oneOfType([Hn.node,Hn.func]),isActive:Hn.bool,canBegin:Hn.bool,onAnimationEnd:Hn.func,shouldReAnimate:Hn.bool,onAnimationStart:Hn.func,onAnimationReStart:Hn.func};const Lh=w5;function Yn(){return Yn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yn.apply(null,arguments)}function YN(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function yZ(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,JI(e,t)}function Lw(e){"@babel/helpers - typeof";return Lw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lw(e)}function JN(){return JN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},JN.apply(this,arguments)}function p6e(e,t){return y6e(e)||x6e(e,t)||v6e(e,t)||g6e()}function g6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function v6e(e,t){if(e){if(typeof e=="string")return e7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e7(e,t)}}function e7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function x6e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function y6e(e){if(Array.isArray(e))return e}function t7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function r7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t7(Object(r),!0).forEach(function(n){b6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function b6e(e,t,r){return t=w6e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w6e(e){var t=j6e(e,"string");return Lw(t)=="symbol"?t:t+""}function j6e(e,t){if(Lw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var n7=function(t,r,n,s,o){var i=Math.min(Math.abs(n)/2,Math.abs(s)/2),l=s>=0?1:-1,c=n>=0?1:-1,d=s>=0&&n>=0||s<0&&n<0?1:0,u;if(i>0&&o instanceof Array){for(var f=[0,0,0,0],h=0,m=4;h<m;h++)f[h]=o[h]>i?i:o[h];u="M".concat(t,",").concat(r+l*f[0]),f[0]>0&&(u+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(d,",").concat(t+c*f[0],",").concat(r)),u+="L ".concat(t+n-c*f[1],",").concat(r),f[1]>0&&(u+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(d,`,
        `).concat(t+n,",").concat(r+l*f[1])),u+="L ".concat(t+n,",").concat(r+s-l*f[2]),f[2]>0&&(u+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(d,`,
        `).concat(t+n-c*f[2],",").concat(r+s)),u+="L ".concat(t+c*f[3],",").concat(r+s),f[3]>0&&(u+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(d,`,
        `).concat(t,",").concat(r+s-l*f[3])),u+="Z"}else if(i>0&&o===+o&&o>0){var v=Math.min(i,o);u="M ".concat(t,",").concat(r+l*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(t+c*v,",").concat(r,`
            L `).concat(t+n-c*v,",").concat(r,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(t+n,",").concat(r+l*v,`
            L `).concat(t+n,",").concat(r+s-l*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(t+n-c*v,",").concat(r+s,`
            L `).concat(t+c*v,",").concat(r+s,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(t,",").concat(r+s-l*v," Z")}else u="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(s," h ").concat(-n," Z");return u},_6e=function(t,r){if(!t||!r)return!1;var n=t.x,s=t.y,o=r.x,i=r.y,l=r.width,c=r.height;if(Math.abs(l)>0&&Math.abs(c)>0){var d=Math.min(o,o+l),u=Math.max(o,o+l),f=Math.min(i,i+c),h=Math.max(i,i+c);return n>=d&&n<=u&&s>=f&&s<=h}return!1},N6e={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},NM=function(t){var r=r7(r7({},N6e),t),n=p.useRef(),s=p.useState(-1),o=p6e(s,2),i=o[0],l=o[1];p.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var j=n.current.getTotalLength();j&&l(j)}catch{}},[]);var c=r.x,d=r.y,u=r.width,f=r.height,h=r.radius,m=r.className,v=r.animationEasing,g=r.animationDuration,y=r.animationBegin,x=r.isAnimationActive,b=r.isUpdateAnimationActive;if(c!==+c||d!==+d||u!==+u||f!==+f||u===0||f===0)return null;var w=fa("recharts-rectangle",m);return b?Pe.createElement(Lh,{canBegin:i>0,from:{width:u,height:f,x:c,y:d},to:{width:u,height:f,x:c,y:d},duration:g,animationEasing:v,isActive:b},function(j){var _=j.width,S=j.height,C=j.x,P=j.y;return Pe.createElement(Lh,{canBegin:i>0,from:"0px ".concat(i===-1?1:i,"px"),to:"".concat(i,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:g,isActive:x,easing:v},Pe.createElement("path",JN({},Bn(r,!0),{className:w,d:n7(C,P,_,S,h),ref:n})))}):Pe.createElement("path",JN({},Bn(r,!0),{className:w,d:n7(c,d,u,f,h)}))},S6e=["points","className","baseLinePoints","connectNulls"];function Yv(){return Yv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yv.apply(this,arguments)}function C6e(e,t){if(e==null)return{};var r=P6e(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function P6e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function a7(e){return I6e(e)||k6e(e)||E6e(e)||A6e()}function A6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E6e(e,t){if(e){if(typeof e=="string")return ZO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZO(e,t)}}function k6e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function I6e(e){if(Array.isArray(e))return ZO(e)}function ZO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var s7=function(t){return t&&t.x===+t.x&&t.y===+t.y},O6e=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(function(n){s7(n)?r[r.length-1].push(n):r[r.length-1].length>0&&r.push([])}),s7(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},vb=function(t,r){var n=O6e(t);r&&(n=[n.reduce(function(o,i){return[].concat(a7(o),a7(i))},[])]);var s=n.map(function(o){return o.reduce(function(i,l,c){return"".concat(i).concat(c===0?"M":"L").concat(l.x,",").concat(l.y)},"")}).join("");return n.length===1?"".concat(s,"Z"):s},T6e=function(t,r,n){var s=vb(t,n);return"".concat(s.slice(-1)==="Z"?s.slice(0,-1):s,"L").concat(vb(r.reverse(),n).slice(1))},D6e=function(t){var r=t.points,n=t.className,s=t.baseLinePoints,o=t.connectNulls,i=C6e(t,S6e);if(!r||!r.length)return null;var l=fa("recharts-polygon",n);if(s&&s.length){var c=i.stroke&&i.stroke!=="none",d=T6e(r,s,o);return Pe.createElement("g",{className:l},Pe.createElement("path",Yv({},Bn(i,!0),{fill:d.slice(-1)==="Z"?i.fill:"none",stroke:"none",d})),c?Pe.createElement("path",Yv({},Bn(i,!0),{fill:"none",d:vb(r,o)})):null,c?Pe.createElement("path",Yv({},Bn(i,!0),{fill:"none",d:vb(s,o)})):null)}var u=vb(r,o);return Pe.createElement("path",Yv({},Bn(i,!0),{fill:u.slice(-1)==="Z"?i.fill:"none",className:l,d:u}))};function eT(){return eT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},eT.apply(this,arguments)}var L1=function(t){var r=t.cx,n=t.cy,s=t.r,o=t.className,i=fa("recharts-dot",o);return r===+r&&n===+n&&s===+s?p.createElement("circle",eT({},Bn(t,!1),gN(t),{className:i,cx:r,cy:n,r:s})):null};function Fw(e){"@babel/helpers - typeof";return Fw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fw(e)}var M6e=["x","y","top","left","width","height","className"];function tT(){return tT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tT.apply(this,arguments)}function o7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function R6e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o7(Object(r),!0).forEach(function(n){L6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function L6e(e,t,r){return t=F6e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F6e(e){var t=$6e(e,"string");return Fw(t)=="symbol"?t:t+""}function $6e(e,t){if(Fw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Fw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function B6e(e,t){if(e==null)return{};var r=q6e(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function q6e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var z6e=function(t,r,n,s,o,i){return"M".concat(t,",").concat(o,"v").concat(s,"M").concat(i,",").concat(r,"h").concat(n)},U6e=function(t){var r=t.x,n=r===void 0?0:r,s=t.y,o=s===void 0?0:s,i=t.top,l=i===void 0?0:i,c=t.left,d=c===void 0?0:c,u=t.width,f=u===void 0?0:u,h=t.height,m=h===void 0?0:h,v=t.className,g=B6e(t,M6e),y=R6e({x:n,y:o,top:l,left:d,width:f,height:m},g);return!Xr(n)||!Xr(o)||!Xr(f)||!Xr(m)||!Xr(l)||!Xr(d)?null:Pe.createElement("path",tT({},Bn(y,!0),{className:fa("recharts-cross",v),d:z6e(n,o,f,m,l,d)}))},V6e=v5,W6e=IQ,H6e=ff;function G6e(e,t){return e&&e.length?V6e(e,H6e(t),W6e):void 0}var K6e=G6e;const X6e=Ua(K6e);var Y6e=v5,J6e=ff,Q6e=OQ;function Z6e(e,t){return e&&e.length?Y6e(e,J6e(t),Q6e):void 0}var e8e=Z6e;const t8e=Ua(e8e);var r8e=["cx","cy","angle","ticks","axisLine"],n8e=["ticks","tick","angle","tickFormatter","stroke"];function Kx(e){"@babel/helpers - typeof";return Kx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kx(e)}function xb(){return xb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xb.apply(this,arguments)}function i7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function fp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i7(Object(r),!0).forEach(function(n){j5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function l7(e,t){if(e==null)return{};var r=a8e(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function a8e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function s8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wZ(n.key),n)}}function o8e(e,t,r){return t&&c7(e.prototype,t),r&&c7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function i8e(e,t,r){return t=QN(t),l8e(e,bZ()?Reflect.construct(t,r||[],QN(e).constructor):t.apply(e,r))}function l8e(e,t){if(t&&(Kx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return c8e(e)}function c8e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bZ=function(){return!!e})()}function QN(e){return QN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},QN(e)}function d8e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rT(e,t)}function rT(e,t){return rT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},rT(e,t)}function j5(e,t,r){return t=wZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wZ(e){var t=u8e(e,"string");return Kx(t)=="symbol"?t:t+""}function u8e(e,t){if(Kx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _5=function(e){function t(){return s8e(this,t),i8e(this,t,arguments)}return d8e(t,e),o8e(t,[{key:"getTickValueCoord",value:function(n){var s=n.coordinate,o=this.props,i=o.angle,l=o.cx,c=o.cy;return Ps(l,c,s,i)}},{key:"getTickTextAnchor",value:function(){var n=this.props.orientation,s;switch(n){case"left":s="end";break;case"right":s="start";break;default:s="middle";break}return s}},{key:"getViewBox",value:function(){var n=this.props,s=n.cx,o=n.cy,i=n.angle,l=n.ticks,c=X6e(l,function(u){return u.coordinate||0}),d=t8e(l,function(u){return u.coordinate||0});return{cx:s,cy:o,startAngle:i,endAngle:i,innerRadius:d.coordinate||0,outerRadius:c.coordinate||0}}},{key:"renderAxisLine",value:function(){var n=this.props,s=n.cx,o=n.cy,i=n.angle,l=n.ticks,c=n.axisLine,d=l7(n,r8e),u=l.reduce(function(v,g){return[Math.min(v[0],g.coordinate),Math.max(v[1],g.coordinate)]},[1/0,-1/0]),f=Ps(s,o,u[0],i),h=Ps(s,o,u[1],i),m=fp(fp(fp({},Bn(d,!1)),{},{fill:"none"},Bn(c,!1)),{},{x1:f.x,y1:f.y,x2:h.x,y2:h.y});return Pe.createElement("line",xb({className:"recharts-polar-radius-axis-line"},m))}},{key:"renderTicks",value:function(){var n=this,s=this.props,o=s.ticks,i=s.tick,l=s.angle,c=s.tickFormatter,d=s.stroke,u=l7(s,n8e),f=this.getTickTextAnchor(),h=Bn(u,!1),m=Bn(i,!1),v=o.map(function(g,y){var x=n.getTickValueCoord(g),b=fp(fp(fp(fp({textAnchor:f,transform:"rotate(".concat(90-l,", ").concat(x.x,", ").concat(x.y,")")},h),{},{stroke:"none",fill:d},m),{},{index:y},x),{},{payload:g});return Pe.createElement(Aa,xb({className:fa("recharts-polar-radius-axis-tick",oZ(i)),key:"tick-".concat(g.coordinate)},yg(n.props,g,y)),t.renderTickItem(i,b,c?c(g.value,y):g.value))});return Pe.createElement(Aa,{className:"recharts-polar-radius-axis-ticks"},v)}},{key:"render",value:function(){var n=this.props,s=n.ticks,o=n.axisLine,i=n.tick;return!s||!s.length?null:Pe.createElement(Aa,{className:fa("recharts-polar-radius-axis",this.props.className)},o&&this.renderAxisLine(),i&&this.renderTicks(),pi.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(n,s,o){var i;return Pe.isValidElement(n)?i=Pe.cloneElement(n,s):Zn(n)?i=n(s):i=Pe.createElement(bg,xb({},s,{className:"recharts-polar-radius-axis-tick-value"}),o),i}}])}(p.PureComponent);j5(_5,"displayName","PolarRadiusAxis");j5(_5,"axisType","radiusAxis");j5(_5,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function Xx(e){"@babel/helpers - typeof";return Xx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xx(e)}function Ip(){return Ip=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ip.apply(this,arguments)}function d7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function mp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d7(Object(r),!0).forEach(function(n){N5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function f8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_Z(n.key),n)}}function m8e(e,t,r){return t&&u7(e.prototype,t),r&&u7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function h8e(e,t,r){return t=ZN(t),p8e(e,jZ()?Reflect.construct(t,r||[],ZN(e).constructor):t.apply(e,r))}function p8e(e,t){if(t&&(Xx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return g8e(e)}function g8e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jZ=function(){return!!e})()}function ZN(e){return ZN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ZN(e)}function v8e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nT(e,t)}function nT(e,t){return nT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},nT(e,t)}function N5(e,t,r){return t=_Z(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _Z(e){var t=x8e(e,"string");return Xx(t)=="symbol"?t:t+""}function x8e(e,t){if(Xx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var y8e=Math.PI/180,f7=1e-5,S5=function(e){function t(){return f8e(this,t),h8e(this,t,arguments)}return v8e(t,e),m8e(t,[{key:"getTickLineCoord",value:function(n){var s=this.props,o=s.cx,i=s.cy,l=s.radius,c=s.orientation,d=s.tickSize,u=d||8,f=Ps(o,i,l,n.coordinate),h=Ps(o,i,l+(c==="inner"?-1:1)*u,n.coordinate);return{x1:f.x,y1:f.y,x2:h.x,y2:h.y}}},{key:"getTickTextAnchor",value:function(n){var s=this.props.orientation,o=Math.cos(-n.coordinate*y8e),i;return o>f7?i=s==="outer"?"start":"end":o<-f7?i=s==="outer"?"end":"start":i="middle",i}},{key:"renderAxisLine",value:function(){var n=this.props,s=n.cx,o=n.cy,i=n.radius,l=n.axisLine,c=n.axisLineType,d=mp(mp({},Bn(this.props,!1)),{},{fill:"none"},Bn(l,!1));if(c==="circle")return Pe.createElement(L1,Ip({className:"recharts-polar-angle-axis-line"},d,{cx:s,cy:o,r:i}));var u=this.props.ticks,f=u.map(function(h){return Ps(s,o,i,h.coordinate)});return Pe.createElement(D6e,Ip({className:"recharts-polar-angle-axis-line"},d,{points:f}))}},{key:"renderTicks",value:function(){var n=this,s=this.props,o=s.ticks,i=s.tick,l=s.tickLine,c=s.tickFormatter,d=s.stroke,u=Bn(this.props,!1),f=Bn(i,!1),h=mp(mp({},u),{},{fill:"none"},Bn(l,!1)),m=o.map(function(v,g){var y=n.getTickLineCoord(v),x=n.getTickTextAnchor(v),b=mp(mp(mp({textAnchor:x},u),{},{stroke:"none",fill:d},f),{},{index:g,payload:v,x:y.x2,y:y.y2});return Pe.createElement(Aa,Ip({className:fa("recharts-polar-angle-axis-tick",oZ(i)),key:"tick-".concat(v.coordinate)},yg(n.props,v,g)),l&&Pe.createElement("line",Ip({className:"recharts-polar-angle-axis-tick-line"},h,y)),i&&t.renderTickItem(i,b,c?c(v.value,g):v.value))});return Pe.createElement(Aa,{className:"recharts-polar-angle-axis-ticks"},m)}},{key:"render",value:function(){var n=this.props,s=n.ticks,o=n.radius,i=n.axisLine;return o<=0||!s||!s.length?null:Pe.createElement(Aa,{className:fa("recharts-polar-angle-axis",this.props.className)},i&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(n,s,o){var i;return Pe.isValidElement(n)?i=Pe.cloneElement(n,s):Zn(n)?i=n(s):i=Pe.createElement(bg,Ip({},s,{className:"recharts-polar-angle-axis-tick-value"}),o),i}}])}(p.PureComponent);N5(S5,"displayName","PolarAngleAxis");N5(S5,"axisType","angleAxis");N5(S5,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var b8e=PJ,w8e=b8e(Object.getPrototypeOf,Object),j8e=w8e,_8e=dm,N8e=j8e,S8e=um,C8e="[object Object]",P8e=Function.prototype,A8e=Object.prototype,NZ=P8e.toString,E8e=A8e.hasOwnProperty,k8e=NZ.call(Object);function I8e(e){if(!S8e(e)||_8e(e)!=C8e)return!1;var t=N8e(e);if(t===null)return!0;var r=E8e.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&NZ.call(r)==k8e}var O8e=I8e;const T8e=Ua(O8e);var D8e=dm,M8e=um,R8e="[object Boolean]";function L8e(e){return e===!0||e===!1||M8e(e)&&D8e(e)==R8e}var F8e=L8e;const $8e=Ua(F8e);function $w(e){"@babel/helpers - typeof";return $w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$w(e)}function eS(){return eS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},eS.apply(this,arguments)}function B8e(e,t){return V8e(e)||U8e(e,t)||z8e(e,t)||q8e()}function q8e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function z8e(e,t){if(e){if(typeof e=="string")return m7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m7(e,t)}}function m7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function U8e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function V8e(e){if(Array.isArray(e))return e}function h7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function p7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h7(Object(r),!0).forEach(function(n){W8e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function W8e(e,t,r){return t=H8e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function H8e(e){var t=G8e(e,"string");return $w(t)=="symbol"?t:t+""}function G8e(e,t){if($w(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if($w(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var g7=function(t,r,n,s,o){var i=n-s,l;return l="M ".concat(t,",").concat(r),l+="L ".concat(t+n,",").concat(r),l+="L ".concat(t+n-i/2,",").concat(r+o),l+="L ".concat(t+n-i/2-s,",").concat(r+o),l+="L ".concat(t,",").concat(r," Z"),l},K8e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},X8e=function(t){var r=p7(p7({},K8e),t),n=p.useRef(),s=p.useState(-1),o=B8e(s,2),i=o[0],l=o[1];p.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var w=n.current.getTotalLength();w&&l(w)}catch{}},[]);var c=r.x,d=r.y,u=r.upperWidth,f=r.lowerWidth,h=r.height,m=r.className,v=r.animationEasing,g=r.animationDuration,y=r.animationBegin,x=r.isUpdateAnimationActive;if(c!==+c||d!==+d||u!==+u||f!==+f||h!==+h||u===0&&f===0||h===0)return null;var b=fa("recharts-trapezoid",m);return x?Pe.createElement(Lh,{canBegin:i>0,from:{upperWidth:0,lowerWidth:0,height:h,x:c,y:d},to:{upperWidth:u,lowerWidth:f,height:h,x:c,y:d},duration:g,animationEasing:v,isActive:x},function(w){var j=w.upperWidth,_=w.lowerWidth,S=w.height,C=w.x,P=w.y;return Pe.createElement(Lh,{canBegin:i>0,from:"0px ".concat(i===-1?1:i,"px"),to:"".concat(i,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:g,easing:v},Pe.createElement("path",eS({},Bn(r,!0),{className:b,d:g7(C,P,j,_,S),ref:n})))}):Pe.createElement("g",null,Pe.createElement("path",eS({},Bn(r,!0),{className:b,d:g7(c,d,u,f,h)})))},Y8e=["option","shapeType","propTransformer","activeClassName","isActive"];function Bw(e){"@babel/helpers - typeof";return Bw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bw(e)}function J8e(e,t){if(e==null)return{};var r=Q8e(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Q8e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function v7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function tS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?v7(Object(r),!0).forEach(function(n){Z8e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Z8e(e,t,r){return t=eBe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eBe(e){var t=tBe(e,"string");return Bw(t)=="symbol"?t:t+""}function tBe(e,t){if(Bw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Bw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rBe(e,t){return tS(tS({},t),e)}function nBe(e,t){return e==="symbols"}function x7(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return Pe.createElement(NM,r);case"trapezoid":return Pe.createElement(X8e,r);case"sector":return Pe.createElement(_M,r);case"symbols":if(nBe(t))return Pe.createElement(zD,r);break;default:return null}}function aBe(e){return p.isValidElement(e)?e.props:e}function SZ(e){var t=e.option,r=e.shapeType,n=e.propTransformer,s=n===void 0?rBe:n,o=e.activeClassName,i=o===void 0?"recharts-active-shape":o,l=e.isActive,c=J8e(e,Y8e),d;if(p.isValidElement(t))d=p.cloneElement(t,tS(tS({},c),aBe(t)));else if(Zn(t))d=t(c);else if(T8e(t)&&!$8e(t)){var u=s(t,c);d=Pe.createElement(x7,{shapeType:r,elementProps:u})}else{var f=c;d=Pe.createElement(x7,{shapeType:r,elementProps:f})}return l?Pe.createElement(Aa,{className:i},d):d}function C5(e,t){return t!=null&&"trapezoids"in e.props}function P5(e,t){return t!=null&&"sectors"in e.props}function qw(e,t){return t!=null&&"points"in e.props}function sBe(e,t){var r,n,s=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,o=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return s&&o}function oBe(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function iBe(e,t){var r=e.x===t.x,n=e.y===t.y,s=e.z===t.z;return r&&n&&s}function lBe(e,t){var r;return C5(e,t)?r=sBe:P5(e,t)?r=oBe:qw(e,t)&&(r=iBe),r}function cBe(e,t){var r;return C5(e,t)?r="trapezoids":P5(e,t)?r="sectors":qw(e,t)&&(r="points"),r}function dBe(e,t){if(C5(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(P5(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return qw(e,t)?t.payload:{}}function uBe(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,s=cBe(r,t),o=dBe(r,t),i=n.filter(function(c,d){var u=wg(o,c),f=r.props[s].filter(function(v){var g=lBe(r,t);return g(v,t)}),h=r.props[s].indexOf(f[f.length-1]),m=d===h;return u&&m}),l=n.indexOf(i[i.length-1]);return l}var d_;function Yx(e){"@babel/helpers - typeof";return Yx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yx(e)}function Jv(){return Jv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Jv.apply(this,arguments)}function y7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function js(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y7(Object(r),!0).forEach(function(n){yd(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PZ(n.key),n)}}function mBe(e,t,r){return t&&b7(e.prototype,t),r&&b7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hBe(e,t,r){return t=rS(t),pBe(e,CZ()?Reflect.construct(t,r||[],rS(e).constructor):t.apply(e,r))}function pBe(e,t){if(t&&(Yx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gBe(e)}function gBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(CZ=function(){return!!e})()}function rS(e){return rS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},rS(e)}function vBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aT(e,t)}function aT(e,t){return aT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},aT(e,t)}function yd(e,t,r){return t=PZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PZ(e){var t=xBe(e,"string");return Yx(t)=="symbol"?t:t+""}function xBe(e,t){if(Yx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Yx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cf=function(e){function t(r){var n;return fBe(this,t),n=hBe(this,t,[r]),yd(n,"pieRef",null),yd(n,"sectorRefs",[]),yd(n,"id",Fg("recharts-pie-")),yd(n,"handleAnimationEnd",function(){var s=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),Zn(s)&&s()}),yd(n,"handleAnimationStart",function(){var s=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),Zn(s)&&s()}),n.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},n}return vBe(t,e),mBe(t,[{key:"isActiveIndex",value:function(n){var s=this.props.activeIndex;return Array.isArray(s)?s.indexOf(n)!==-1:n===s}},{key:"hasActiveIndex",value:function(){var n=this.props.activeIndex;return Array.isArray(n)?n.length!==0:n||n===0}},{key:"renderLabels",value:function(n){var s=this.props.isAnimationActive;if(s&&!this.state.isAnimationFinished)return null;var o=this.props,i=o.label,l=o.labelLine,c=o.dataKey,d=o.valueKey,u=Bn(this.props,!1),f=Bn(i,!1),h=Bn(l,!1),m=i&&i.offsetRadius||20,v=n.map(function(g,y){var x=(g.startAngle+g.endAngle)/2,b=Ps(g.cx,g.cy,g.outerRadius+m,x),w=js(js(js(js({},u),g),{},{stroke:"none"},f),{},{index:y,textAnchor:t.getTextAnchor(b.x,g.cx)},b),j=js(js(js(js({},u),g),{},{fill:"none",stroke:g.fill},h),{},{index:y,points:[Ps(g.cx,g.cy,g.outerRadius,x),b]}),_=c;return la(c)&&la(d)?_="value":la(c)&&(_=d),Pe.createElement(Aa,{key:"label-".concat(g.startAngle,"-").concat(g.endAngle,"-").concat(g.midAngle,"-").concat(y)},l&&t.renderLabelLineItem(l,j,"line"),t.renderLabelItem(i,w,So(g,_)))});return Pe.createElement(Aa,{className:"recharts-pie-labels"},v)}},{key:"renderSectorsStatically",value:function(n){var s=this,o=this.props,i=o.activeShape,l=o.blendStroke,c=o.inactiveShape;return n.map(function(d,u){if(d?.startAngle===0&&d?.endAngle===0&&n.length!==1)return null;var f=s.isActiveIndex(u),h=c&&s.hasActiveIndex()?c:null,m=f?i:h,v=js(js({},d),{},{stroke:l?d.fill:d.stroke,tabIndex:-1});return Pe.createElement(Aa,Jv({ref:function(y){y&&!s.sectorRefs.includes(y)&&s.sectorRefs.push(y)},tabIndex:-1,className:"recharts-pie-sector"},yg(s.props,d,u),{key:"sector-".concat(d?.startAngle,"-").concat(d?.endAngle,"-").concat(d.midAngle,"-").concat(u)}),Pe.createElement(SZ,Jv({option:m,isActive:f,shapeType:"sector"},v)))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,s=this.props,o=s.sectors,i=s.isAnimationActive,l=s.animationBegin,c=s.animationDuration,d=s.animationEasing,u=s.animationId,f=this.state,h=f.prevSectors,m=f.prevIsAnimationActive;return Pe.createElement(Lh,{begin:l,duration:c,isActive:i,easing:d,from:{t:0},to:{t:1},key:"pie-".concat(u,"-").concat(m),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(v){var g=v.t,y=[],x=o&&o[0],b=x.startAngle;return o.forEach(function(w,j){var _=h&&h[j],S=j>0?zc(w,"paddingAngle",0):0;if(_){var C=ti(_.endAngle-_.startAngle,w.endAngle-w.startAngle),P=js(js({},w),{},{startAngle:b+S,endAngle:b+C(g)+S});y.push(P),b=P.endAngle}else{var A=w.endAngle,R=w.startAngle,O=ti(0,A-R),I=O(g),M=js(js({},w),{},{startAngle:b+S,endAngle:b+I+S});y.push(M),b=M.endAngle}}),Pe.createElement(Aa,null,n.renderSectorsStatically(y))})}},{key:"attachKeyboardHandlers",value:function(n){var s=this;n.onkeydown=function(o){if(!o.altKey)switch(o.key){case"ArrowLeft":{var i=++s.state.sectorToFocus%s.sectorRefs.length;s.sectorRefs[i].focus(),s.setState({sectorToFocus:i});break}case"ArrowRight":{var l=--s.state.sectorToFocus<0?s.sectorRefs.length-1:s.state.sectorToFocus%s.sectorRefs.length;s.sectorRefs[l].focus(),s.setState({sectorToFocus:l});break}case"Escape":{s.sectorRefs[s.state.sectorToFocus].blur(),s.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var n=this.props,s=n.sectors,o=n.isAnimationActive,i=this.state.prevSectors;return o&&s&&s.length&&(!i||!wg(i,s))?this.renderSectorsWithAnimation():this.renderSectorsStatically(s)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var n=this,s=this.props,o=s.hide,i=s.sectors,l=s.className,c=s.label,d=s.cx,u=s.cy,f=s.innerRadius,h=s.outerRadius,m=s.isAnimationActive,v=this.state.isAnimationFinished;if(o||!i||!i.length||!Xr(d)||!Xr(u)||!Xr(f)||!Xr(h))return null;var g=fa("recharts-pie",l);return Pe.createElement(Aa,{tabIndex:this.props.rootTabIndex,className:g,ref:function(x){n.pieRef=x}},this.renderSectors(),c&&this.renderLabels(i),pi.renderCallByParent(this.props,null,!1),(!m||v)&&rf.renderCallByParent(this.props,i,!1))}}],[{key:"getDerivedStateFromProps",value:function(n,s){return s.prevIsAnimationActive!==n.isAnimationActive?{prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:[],isAnimationFinished:!0}:n.isAnimationActive&&n.animationId!==s.prevAnimationId?{prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:s.curSectors,isAnimationFinished:!0}:n.sectors!==s.curSectors?{curSectors:n.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(n,s){return n>s?"start":n<s?"end":"middle"}},{key:"renderLabelLineItem",value:function(n,s,o){if(Pe.isValidElement(n))return Pe.cloneElement(n,s);if(Zn(n))return n(s);var i=fa("recharts-pie-label-line",typeof n!="boolean"?n.className:"");return Pe.createElement(rg,Jv({},s,{key:o,type:"linear",className:i}))}},{key:"renderLabelItem",value:function(n,s,o){if(Pe.isValidElement(n))return Pe.cloneElement(n,s);var i=o;if(Zn(n)&&(i=n(s),Pe.isValidElement(i)))return i;var l=fa("recharts-pie-label-text",typeof n!="boolean"&&!Zn(n)?n.className:"");return Pe.createElement(bg,Jv({},s,{alignmentBaseline:"middle",className:l}),i)}}])}(p.PureComponent);d_=cf;yd(cf,"displayName","Pie");yd(cf,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!mu.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});yd(cf,"parseDeltaAngle",function(e,t){var r=Al(t-e),n=Math.min(Math.abs(t-e),360);return r*n});yd(cf,"getRealPieData",function(e){var t=e.data,r=e.children,n=Bn(e,!1),s=Uc(r,vw);return t&&t.length?t.map(function(o,i){return js(js(js({payload:o},n),o),s&&s[i]&&s[i].props)}):s&&s.length?s.map(function(o){return js(js({},n),o.props)}):[]});yd(cf,"parseCoordinateOfPie",function(e,t){var r=t.top,n=t.left,s=t.width,o=t.height,i=sZ(s,o),l=n+El(e.cx,s,s/2),c=r+El(e.cy,o,o/2),d=El(e.innerRadius,i,0),u=El(e.outerRadius,i,i*.8),f=e.maxRadius||Math.sqrt(s*s+o*o)/2;return{cx:l,cy:c,innerRadius:d,outerRadius:u,maxRadius:f}});yd(cf,"getComposedData",function(e){var t=e.item,r=e.offset,n=t.type.defaultProps!==void 0?js(js({},t.type.defaultProps),t.props):t.props,s=d_.getRealPieData(n);if(!s||!s.length)return null;var o=n.cornerRadius,i=n.startAngle,l=n.endAngle,c=n.paddingAngle,d=n.dataKey,u=n.nameKey,f=n.valueKey,h=n.tooltipType,m=Math.abs(n.minAngle),v=d_.parseCoordinateOfPie(n,r),g=d_.parseDeltaAngle(i,l),y=Math.abs(g),x=d;la(d)&&la(f)?(fu(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),x="value"):la(d)&&(fu(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),x=f);var b=s.filter(function(P){return So(P,x,0)!==0}).length,w=(y>=360?b:b-1)*c,j=y-b*m-w,_=s.reduce(function(P,A){var R=So(A,x,0);return P+(Xr(R)?R:0)},0),S;if(_>0){var C;S=s.map(function(P,A){var R=So(P,x,0),O=So(P,u,A),I=(Xr(R)?R:0)/_,M;A?M=C.endAngle+Al(g)*c*(R!==0?1:0):M=i;var D=M+Al(g)*((R!==0?m:0)+I*j),U=(M+D)/2,z=(v.innerRadius+v.outerRadius)/2,W=[{name:O,value:R,payload:P,dataKey:x,type:h}],$=Ps(v.cx,v.cy,z,U);return C=js(js(js({percent:I,cornerRadius:o,name:O,tooltipPayload:W,midAngle:U,middleRadius:z,tooltipPosition:$},P),v),{},{value:So(P,x),startAngle:M,endAngle:D,payload:P,paddingAngle:Al(g)*c}),C})}return js(js({},v),{},{sectors:S,data:s})});var yBe=Math.ceil,bBe=Math.max;function wBe(e,t,r,n){for(var s=-1,o=bBe(yBe((t-e)/(r||1)),0),i=Array(o);o--;)i[n?o:++s]=e,e+=r;return i}var jBe=wBe,_Be=HJ,w7=1/0,NBe=17976931348623157e292;function SBe(e){if(!e)return e===0?e:0;if(e=_Be(e),e===w7||e===-w7){var t=e<0?-1:1;return t*NBe}return e===e?e:0}var AZ=SBe,CBe=jBe,PBe=d5,lE=AZ;function ABe(e){return function(t,r,n){return n&&typeof n!="number"&&PBe(t,r,n)&&(r=n=void 0),t=lE(t),r===void 0?(r=t,t=0):r=lE(r),n=n===void 0?t<r?1:-1:lE(n),CBe(t,r,n,e)}}var EBe=ABe,kBe=EBe,IBe=kBe(),OBe=IBe;const nS=Ua(OBe);function zw(e){"@babel/helpers - typeof";return zw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zw(e)}function j7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function _7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j7(Object(r),!0).forEach(function(n){EZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function EZ(e,t,r){return t=TBe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TBe(e){var t=DBe(e,"string");return zw(t)=="symbol"?t:t+""}function DBe(e,t){if(zw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(zw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var MBe=["Webkit","Moz","O","ms"],RBe=function(t,r){if(!t)return null;var n=t.replace(/(\w)/,function(o){return o.toUpperCase()}),s=MBe.reduce(function(o,i){return _7(_7({},o),{},EZ({},i+n,r))},{});return s[t]=r,s};function Jx(e){"@babel/helpers - typeof";return Jx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jx(e)}function aS(){return aS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},aS.apply(this,arguments)}function N7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function cE(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?N7(Object(r),!0).forEach(function(n){Nc(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IZ(n.key),n)}}function FBe(e,t,r){return t&&S7(e.prototype,t),r&&S7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $Be(e,t,r){return t=sS(t),BBe(e,kZ()?Reflect.construct(t,r||[],sS(e).constructor):t.apply(e,r))}function BBe(e,t){if(t&&(Jx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qBe(e)}function qBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kZ=function(){return!!e})()}function sS(e){return sS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sS(e)}function zBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sT(e,t)}function sT(e,t){return sT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},sT(e,t)}function Nc(e,t,r){return t=IZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IZ(e){var t=UBe(e,"string");return Jx(t)=="symbol"?t:t+""}function UBe(e,t){if(Jx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var VBe=function(t){var r=t.data,n=t.startIndex,s=t.endIndex,o=t.x,i=t.width,l=t.travellerWidth;if(!r||!r.length)return{};var c=r.length,d=hb().domain(nS(0,c)).range([o,o+i-l]),u=d.domain().map(function(f){return d(f)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:d(n),endX:d(s),scale:d,scaleValues:u}},C7=function(t){return t.changedTouches&&!!t.changedTouches.length},Qx=function(e){function t(r){var n;return LBe(this,t),n=$Be(this,t,[r]),Nc(n,"handleDrag",function(s){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(s):n.state.isSlideMoving&&n.handleSlideDrag(s)}),Nc(n,"handleTouchMove",function(s){s.changedTouches!=null&&s.changedTouches.length>0&&n.handleDrag(s.changedTouches[0])}),Nc(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var s=n.props,o=s.endIndex,i=s.onDragEnd,l=s.startIndex;i?.({endIndex:o,startIndex:l})}),n.detachDragEndListener()}),Nc(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),Nc(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),Nc(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),Nc(n,"handleSlideDragStart",function(s){var o=C7(s)?s.changedTouches[0]:s;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:o.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return zBe(t,e),FBe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var s=n.startX,o=n.endX,i=this.state.scaleValues,l=this.props,c=l.gap,d=l.data,u=d.length-1,f=Math.min(s,o),h=Math.max(s,o),m=t.getIndexInRange(i,f),v=t.getIndexInRange(i,h);return{startIndex:m-m%c,endIndex:v===u?u:v-v%c}}},{key:"getTextOfTick",value:function(n){var s=this.props,o=s.data,i=s.tickFormatter,l=s.dataKey,c=So(o[n],l,n);return Zn(i)?i(c,n):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var s=this.state,o=s.slideMoveStartX,i=s.startX,l=s.endX,c=this.props,d=c.x,u=c.width,f=c.travellerWidth,h=c.startIndex,m=c.endIndex,v=c.onChange,g=n.pageX-o;g>0?g=Math.min(g,d+u-f-l,d+u-f-i):g<0&&(g=Math.max(g,d-i,d-l));var y=this.getIndex({startX:i+g,endX:l+g});(y.startIndex!==h||y.endIndex!==m)&&v&&v(y),this.setState({startX:i+g,endX:l+g,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,s){var o=C7(s)?s.changedTouches[0]:s;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:o.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var s=this.state,o=s.brushMoveStartX,i=s.movingTravellerId,l=s.endX,c=s.startX,d=this.state[i],u=this.props,f=u.x,h=u.width,m=u.travellerWidth,v=u.onChange,g=u.gap,y=u.data,x={startX:this.state.startX,endX:this.state.endX},b=n.pageX-o;b>0?b=Math.min(b,f+h-m-d):b<0&&(b=Math.max(b,f-d)),x[i]=d+b;var w=this.getIndex(x),j=w.startIndex,_=w.endIndex,S=function(){var P=y.length-1;return i==="startX"&&(l>c?j%g===0:_%g===0)||l<c&&_===P||i==="endX"&&(l>c?_%g===0:j%g===0)||l>c&&_===P};this.setState(Nc(Nc({},i,d+b),"brushMoveStartX",n.pageX),function(){v&&S()&&v(w)})}},{key:"handleTravellerMoveKeyboard",value:function(n,s){var o=this,i=this.state,l=i.scaleValues,c=i.startX,d=i.endX,u=this.state[s],f=l.indexOf(u);if(f!==-1){var h=f+n;if(!(h===-1||h>=l.length)){var m=l[h];s==="startX"&&m>=d||s==="endX"&&m<=c||this.setState(Nc({},s,m),function(){o.props.onChange(o.getIndex({startX:o.state.startX,endX:o.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,s=n.x,o=n.y,i=n.width,l=n.height,c=n.fill,d=n.stroke;return Pe.createElement("rect",{stroke:d,fill:c,x:s,y:o,width:i,height:l})}},{key:"renderPanorama",value:function(){var n=this.props,s=n.x,o=n.y,i=n.width,l=n.height,c=n.data,d=n.children,u=n.padding,f=p.Children.only(d);return f?Pe.cloneElement(f,{x:s,y:o,width:i,height:l,margin:u,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(n,s){var o,i,l=this,c=this.props,d=c.y,u=c.travellerWidth,f=c.height,h=c.traveller,m=c.ariaLabel,v=c.data,g=c.startIndex,y=c.endIndex,x=Math.max(n,this.props.x),b=cE(cE({},Bn(this.props,!1)),{},{x,y:d,width:u,height:f}),w=m||"Min value: ".concat((o=v[g])===null||o===void 0?void 0:o.name,", Max value: ").concat((i=v[y])===null||i===void 0?void 0:i.name);return Pe.createElement(Aa,{tabIndex:0,role:"slider","aria-label":w,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[s],onTouchStart:this.travellerDragStartHandlers[s],onKeyDown:function(_){["ArrowLeft","ArrowRight"].includes(_.key)&&(_.preventDefault(),_.stopPropagation(),l.handleTravellerMoveKeyboard(_.key==="ArrowRight"?1:-1,s))},onFocus:function(){l.setState({isTravellerFocused:!0})},onBlur:function(){l.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(h,b))}},{key:"renderSlide",value:function(n,s){var o=this.props,i=o.y,l=o.height,c=o.stroke,d=o.travellerWidth,u=Math.min(n,s)+d,f=Math.max(Math.abs(s-n)-d,0);return Pe.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:u,y:i,width:f,height:l})}},{key:"renderText",value:function(){var n=this.props,s=n.startIndex,o=n.endIndex,i=n.y,l=n.height,c=n.travellerWidth,d=n.stroke,u=this.state,f=u.startX,h=u.endX,m=5,v={pointerEvents:"none",fill:d};return Pe.createElement(Aa,{className:"recharts-brush-texts"},Pe.createElement(bg,aS({textAnchor:"end",verticalAnchor:"middle",x:Math.min(f,h)-m,y:i+l/2},v),this.getTextOfTick(s)),Pe.createElement(bg,aS({textAnchor:"start",verticalAnchor:"middle",x:Math.max(f,h)+c+m,y:i+l/2},v),this.getTextOfTick(o)))}},{key:"render",value:function(){var n=this.props,s=n.data,o=n.className,i=n.children,l=n.x,c=n.y,d=n.width,u=n.height,f=n.alwaysShowText,h=this.state,m=h.startX,v=h.endX,g=h.isTextActive,y=h.isSlideMoving,x=h.isTravellerMoving,b=h.isTravellerFocused;if(!s||!s.length||!Xr(l)||!Xr(c)||!Xr(d)||!Xr(u)||d<=0||u<=0)return null;var w=fa("recharts-brush",o),j=Pe.Children.count(i)===1,_=RBe("userSelect","none");return Pe.createElement(Aa,{className:w,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:_},this.renderBackground(),j&&this.renderPanorama(),this.renderSlide(m,v),this.renderTravellerLayer(m,"startX"),this.renderTravellerLayer(v,"endX"),(g||y||x||b||f)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var s=n.x,o=n.y,i=n.width,l=n.height,c=n.stroke,d=Math.floor(o+l/2)-1;return Pe.createElement(Pe.Fragment,null,Pe.createElement("rect",{x:s,y:o,width:i,height:l,fill:c,stroke:"none"}),Pe.createElement("line",{x1:s+1,y1:d,x2:s+i-1,y2:d,fill:"none",stroke:"#fff"}),Pe.createElement("line",{x1:s+1,y1:d+2,x2:s+i-1,y2:d+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,s){var o;return Pe.isValidElement(n)?o=Pe.cloneElement(n,s):Zn(n)?o=n(s):o=t.renderDefaultTraveller(s),o}},{key:"getDerivedStateFromProps",value:function(n,s){var o=n.data,i=n.width,l=n.x,c=n.travellerWidth,d=n.updateId,u=n.startIndex,f=n.endIndex;if(o!==s.prevData||d!==s.prevUpdateId)return cE({prevData:o,prevTravellerWidth:c,prevUpdateId:d,prevX:l,prevWidth:i},o&&o.length?VBe({data:o,width:i,x:l,travellerWidth:c,startIndex:u,endIndex:f}):{scale:null,scaleValues:null});if(s.scale&&(i!==s.prevWidth||l!==s.prevX||c!==s.prevTravellerWidth)){s.scale.range([l,l+i-c]);var h=s.scale.domain().map(function(m){return s.scale(m)});return{prevData:o,prevTravellerWidth:c,prevUpdateId:d,prevX:l,prevWidth:i,startX:s.scale(n.startIndex),endX:s.scale(n.endIndex),scaleValues:h}}return null}},{key:"getIndexInRange",value:function(n,s){for(var o=n.length,i=0,l=o-1;l-i>1;){var c=Math.floor((i+l)/2);n[c]>s?l=c:i=c}return s>=n[l]?l:i}}])}(p.PureComponent);Nc(Qx,"displayName","Brush");Nc(Qx,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var WBe=XD;function HBe(e,t){var r;return WBe(e,function(n,s,o){return r=t(n,s,o),!r}),!!r}var GBe=HBe,KBe=yJ,XBe=ff,YBe=GBe,JBe=dc,QBe=d5;function ZBe(e,t,r){var n=JBe(e)?KBe:YBe;return r&&QBe(e,t,r)&&(t=void 0),n(e,XBe(t))}var eqe=ZBe;const tqe=Ua(eqe);var nf=function(t,r){var n=t.alwaysShow,s=t.ifOverflow;return n&&(s="extendDomain"),s===r},P7=qJ;function rqe(e,t,r){t=="__proto__"&&P7?P7(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var nqe=rqe,aqe=nqe,sqe=$J,oqe=ff;function iqe(e,t){var r={};return t=oqe(t),sqe(e,function(n,s,o){aqe(r,s,t(n,s,o))}),r}var lqe=iqe;const cqe=Ua(lqe);function dqe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var uqe=dqe,fqe=XD;function mqe(e,t){var r=!0;return fqe(e,function(n,s,o){return r=!!t(n,s,o),r}),r}var hqe=mqe,pqe=uqe,gqe=hqe,vqe=ff,xqe=dc,yqe=d5;function bqe(e,t,r){var n=xqe(e)?pqe:gqe;return r&&yqe(e,t,r)&&(t=void 0),n(e,vqe(t))}var wqe=bqe;const OZ=Ua(wqe);var jqe=["x","y"];function Uw(e){"@babel/helpers - typeof";return Uw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uw(e)}function oT(){return oT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oT.apply(this,arguments)}function A7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Sy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?A7(Object(r),!0).forEach(function(n){_qe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _qe(e,t,r){return t=Nqe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Nqe(e){var t=Sqe(e,"string");return Uw(t)=="symbol"?t:t+""}function Sqe(e,t){if(Uw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Uw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cqe(e,t){if(e==null)return{};var r=Pqe(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Pqe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Aqe(e,t){var r=e.x,n=e.y,s=Cqe(e,jqe),o="".concat(r),i=parseInt(o,10),l="".concat(n),c=parseInt(l,10),d="".concat(t.height||s.height),u=parseInt(d,10),f="".concat(t.width||s.width),h=parseInt(f,10);return Sy(Sy(Sy(Sy(Sy({},t),s),i?{x:i}:{}),c?{y:c}:{}),{},{height:u,width:h,name:t.name,radius:t.radius})}function E7(e){return Pe.createElement(SZ,oT({shapeType:"rectangle",propTransformer:Aqe,activeClassName:"recharts-active-bar"},e))}var Eqe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,s){if(typeof t=="number")return t;var o=Xr(n)||sSe(n);return o?t(n,s):(o||Rh(!1),r)}},kqe=["value","background"],TZ;function Zx(e){"@babel/helpers - typeof";return Zx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zx(e)}function Iqe(e,t){if(e==null)return{};var r=Oqe(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Oqe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function oS(){return oS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oS.apply(this,arguments)}function k7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Oo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k7(Object(r),!0).forEach(function(n){eh(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Tqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,MZ(n.key),n)}}function Dqe(e,t,r){return t&&I7(e.prototype,t),r&&I7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mqe(e,t,r){return t=iS(t),Rqe(e,DZ()?Reflect.construct(t,r||[],iS(e).constructor):t.apply(e,r))}function Rqe(e,t){if(t&&(Zx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lqe(e)}function Lqe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(DZ=function(){return!!e})()}function iS(e){return iS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},iS(e)}function Fqe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iT(e,t)}function iT(e,t){return iT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},iT(e,t)}function eh(e,t,r){return t=MZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MZ(e){var t=$qe(e,"string");return Zx(t)=="symbol"?t:t+""}function $qe(e,t){if(Zx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zg=function(e){function t(){var r;Tqe(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return r=Mqe(this,t,[].concat(s)),eh(r,"state",{isAnimationFinished:!1}),eh(r,"id",Fg("recharts-bar-")),eh(r,"handleAnimationEnd",function(){var i=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),i&&i()}),eh(r,"handleAnimationStart",function(){var i=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),i&&i()}),r}return Fqe(t,e),Dqe(t,[{key:"renderRectanglesStatically",value:function(n){var s=this,o=this.props,i=o.shape,l=o.dataKey,c=o.activeIndex,d=o.activeBar,u=Bn(this.props,!1);return n&&n.map(function(f,h){var m=h===c,v=m?d:i,g=Oo(Oo(Oo({},u),f),{},{isActive:m,option:v,index:h,dataKey:l,onAnimationStart:s.handleAnimationStart,onAnimationEnd:s.handleAnimationEnd});return Pe.createElement(Aa,oS({className:"recharts-bar-rectangle"},yg(s.props,f,h),{key:"rectangle-".concat(f?.x,"-").concat(f?.y,"-").concat(f?.value,"-").concat(h)}),Pe.createElement(E7,g))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,s=this.props,o=s.data,i=s.layout,l=s.isAnimationActive,c=s.animationBegin,d=s.animationDuration,u=s.animationEasing,f=s.animationId,h=this.state.prevData;return Pe.createElement(Lh,{begin:c,duration:d,isActive:l,easing:u,from:{t:0},to:{t:1},key:"bar-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(m){var v=m.t,g=o.map(function(y,x){var b=h&&h[x];if(b){var w=ti(b.x,y.x),j=ti(b.y,y.y),_=ti(b.width,y.width),S=ti(b.height,y.height);return Oo(Oo({},y),{},{x:w(v),y:j(v),width:_(v),height:S(v)})}if(i==="horizontal"){var C=ti(0,y.height),P=C(v);return Oo(Oo({},y),{},{y:y.y+y.height-P,height:P})}var A=ti(0,y.width),R=A(v);return Oo(Oo({},y),{},{width:R})});return Pe.createElement(Aa,null,n.renderRectanglesStatically(g))})}},{key:"renderRectangles",value:function(){var n=this.props,s=n.data,o=n.isAnimationActive,i=this.state.prevData;return o&&s&&s.length&&(!i||!wg(i,s))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(s)}},{key:"renderBackground",value:function(){var n=this,s=this.props,o=s.data,i=s.dataKey,l=s.activeIndex,c=Bn(this.props.background,!1);return o.map(function(d,u){d.value;var f=d.background,h=Iqe(d,kqe);if(!f)return null;var m=Oo(Oo(Oo(Oo(Oo({},h),{},{fill:"#eee"},f),c),yg(n.props,d,u)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:i,index:u,className:"recharts-bar-background-rectangle"});return Pe.createElement(E7,oS({key:"background-bar-".concat(u),option:n.props.background,isActive:u===l},m))})}},{key:"renderErrorBar",value:function(n,s){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,i=o.data,l=o.xAxis,c=o.yAxis,d=o.layout,u=o.children,f=Uc(u,R1);if(!f)return null;var h=d==="vertical"?i[0].height/2:i[0].width/2,m=function(y,x){var b=Array.isArray(y.value)?y.value[1]:y.value;return{x:y.x,y:y.y,value:b,errorVal:So(y,x)}},v={clipPath:n?"url(#clipPath-".concat(s,")"):null};return Pe.createElement(Aa,v,f.map(function(g){return Pe.cloneElement(g,{key:"error-bar-".concat(s,"-").concat(g.props.dataKey),data:i,xAxis:l,yAxis:c,layout:d,offset:h,dataPointFormatter:m})}))}},{key:"render",value:function(){var n=this.props,s=n.hide,o=n.data,i=n.className,l=n.xAxis,c=n.yAxis,d=n.left,u=n.top,f=n.width,h=n.height,m=n.isAnimationActive,v=n.background,g=n.id;if(s||!o||!o.length)return null;var y=this.state.isAnimationFinished,x=fa("recharts-bar",i),b=l&&l.allowDataOverflow,w=c&&c.allowDataOverflow,j=b||w,_=la(g)?this.id:g;return Pe.createElement(Aa,{className:x},b||w?Pe.createElement("defs",null,Pe.createElement("clipPath",{id:"clipPath-".concat(_)},Pe.createElement("rect",{x:b?d:d-f/2,y:w?u:u-h/2,width:b?f:f*2,height:w?h:h*2}))):null,Pe.createElement(Aa,{className:"recharts-bar-rectangles",clipPath:j?"url(#clipPath-".concat(_,")"):null},v?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(j,_),(!m||y)&&rf.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(n,s){return n.animationId!==s.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:s.curData}:n.data!==s.curData?{curData:n.data}:null}}])}(p.PureComponent);TZ=zg;eh(zg,"displayName","Bar");eh(zg,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!mu.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});eh(zg,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,s=e.bandSize,o=e.xAxis,i=e.yAxis,l=e.xAxisTicks,c=e.yAxisTicks,d=e.stackedData,u=e.dataStartIndex,f=e.displayedData,h=e.offset,m=bLe(n,r);if(!m)return null;var v=t.layout,g=r.type.defaultProps,y=g!==void 0?Oo(Oo({},g),r.props):r.props,x=y.dataKey,b=y.children,w=y.minPointSize,j=v==="horizontal"?i:o,_=d?j.scale.domain():null,S=PLe({numericAxis:j}),C=Uc(b,vw),P=f.map(function(A,R){var O,I,M,D,U,z;d?O=wLe(d[u+R],_):(O=So(A,x),Array.isArray(O)||(O=[S,O]));var W=Eqe(w,TZ.defaultProps.minPointSize)(O[1],R);if(v==="horizontal"){var $,X=[i.scale(O[0]),i.scale(O[1])],ye=X[0],Se=X[1];I=yq({axis:o,ticks:l,bandSize:s,offset:m.offset,entry:A,index:R}),M=($=Se??ye)!==null&&$!==void 0?$:void 0,D=m.size;var V=ye-Se;if(U=Number.isNaN(V)?0:V,z={x:I,y:i.y,width:D,height:i.height},Math.abs(W)>0&&Math.abs(U)<Math.abs(W)){var B=Al(U||W)*(Math.abs(W)-Math.abs(U));M-=B,U+=B}}else{var Q=[o.scale(O[0]),o.scale(O[1])],pe=Q[0],te=Q[1];if(I=pe,M=yq({axis:i,ticks:c,bandSize:s,offset:m.offset,entry:A,index:R}),D=te-pe,U=m.size,z={x:o.x,y:M,width:o.width,height:U},Math.abs(W)>0&&Math.abs(D)<Math.abs(W)){var Y=Al(D||W)*(Math.abs(W)-Math.abs(D));D+=Y}}return Oo(Oo(Oo({},A),{},{x:I,y:M,width:D,height:U,value:d?O:O[1],payload:A,background:z},C&&C[R]&&C[R].props),{},{tooltipPayload:[nZ(r,A)],tooltipPosition:{x:I+D/2,y:M+U/2}})});return Oo({data:P,layout:v},h)});function Vw(e){"@babel/helpers - typeof";return Vw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vw(e)}function Bqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,RZ(n.key),n)}}function qqe(e,t,r){return t&&O7(e.prototype,t),r&&O7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function T7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function tu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?T7(Object(r),!0).forEach(function(n){A5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function A5(e,t,r){return t=RZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RZ(e){var t=zqe(e,"string");return Vw(t)=="symbol"?t:t+""}function zqe(e,t){if(Vw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Vw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SM=function(t,r,n,s,o){var i=t.width,l=t.height,c=t.layout,d=t.children,u=Object.keys(r),f={left:n.left,leftMirror:n.left,right:i-n.right,rightMirror:i-n.right,top:n.top,topMirror:n.top,bottom:l-n.bottom,bottomMirror:l-n.bottom},h=!!Ac(d,zg);return u.reduce(function(m,v){var g=r[v],y=g.orientation,x=g.domain,b=g.padding,w=b===void 0?{}:b,j=g.mirror,_=g.reversed,S="".concat(y).concat(j?"Mirror":""),C,P,A,R,O;if(g.type==="number"&&(g.padding==="gap"||g.padding==="no-gap")){var I=x[1]-x[0],M=1/0,D=g.categoricalDomain.sort(lSe);if(D.forEach(function(Q,pe){pe>0&&(M=Math.min((Q||0)-(D[pe-1]||0),M))}),Number.isFinite(M)){var U=M/I,z=g.layout==="vertical"?n.height:n.width;if(g.padding==="gap"&&(C=U*z/2),g.padding==="no-gap"){var W=El(t.barCategoryGap,U*z),$=U*z/2;C=$-W-($-W)/z*W}}}s==="xAxis"?P=[n.left+(w.left||0)+(C||0),n.left+n.width-(w.right||0)-(C||0)]:s==="yAxis"?P=c==="horizontal"?[n.top+n.height-(w.bottom||0),n.top+(w.top||0)]:[n.top+(w.top||0)+(C||0),n.top+n.height-(w.bottom||0)-(C||0)]:P=g.range,_&&(P=[P[1],P[0]]);var X=ZQ(g,o,h),ye=X.scale,Se=X.realScaleType;ye.domain(x).range(P),eZ(ye);var V=tZ(ye,tu(tu({},g),{},{realScaleType:Se}));s==="xAxis"?(O=y==="top"&&!j||y==="bottom"&&j,A=n.left,R=f[S]-O*g.height):s==="yAxis"&&(O=y==="left"&&!j||y==="right"&&j,A=f[S]-O*g.width,R=n.top);var B=tu(tu(tu({},g),V),{},{realScaleType:Se,x:A,y:R,scale:ye,width:s==="xAxis"?n.width:g.width,height:s==="yAxis"?n.height:g.height});return B.bandSize=VN(B,V),!g.hide&&s==="xAxis"?f[S]+=(O?-1:1)*B.height:g.hide||(f[S]+=(O?-1:1)*B.width),tu(tu({},m),{},A5({},v,B))},{})},LZ=function(t,r){var n=t.x,s=t.y,o=r.x,i=r.y;return{x:Math.min(n,o),y:Math.min(s,i),width:Math.abs(o-n),height:Math.abs(i-s)}},Uqe=function(t){var r=t.x1,n=t.y1,s=t.x2,o=t.y2;return LZ({x:r,y:n},{x:s,y:o})},FZ=function(){function e(t){Bqe(this,e),this.scale=t}return qqe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=n.bandAware,o=n.position;if(r!==void 0){if(o)switch(o){case"start":return this.scale(r);case"middle":{var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+i}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(r)+l}default:return this.scale(r)}if(s){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+c}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),s=n[0],o=n[n.length-1];return s<=o?r>=s&&r<=o:r>=o&&r<=s}}],[{key:"create",value:function(r){return new e(r)}}])}();A5(FZ,"EPS",1e-4);var CM=function(t){var r=Object.keys(t).reduce(function(n,s){return tu(tu({},n),{},A5({},s,FZ.create(t[s])))},{});return tu(tu({},r),{},{apply:function(s){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=o.bandAware,l=o.position;return cqe(s,function(c,d){return r[d].apply(c,{bandAware:i,position:l})})},isInRange:function(s){return OZ(s,function(o,i){return r[i].isInRange(o)})}})};function Vqe(e){return(e%180+180)%180}var Wqe=function(t){var r=t.width,n=t.height,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=Vqe(s),i=o*Math.PI/180,l=Math.atan(n/r),c=i>l&&i<Math.PI-l?n/Math.sin(i):r/Math.cos(i);return Math.abs(c)},Hqe=ff,Gqe=I1,Kqe=l5;function Xqe(e){return function(t,r,n){var s=Object(t);if(!Gqe(t)){var o=Hqe(r);t=Kqe(t),r=function(l){return o(s[l],l,s)}}var i=e(t,r,n);return i>-1?s[o?t[i]:i]:void 0}}var Yqe=Xqe,Jqe=AZ;function Qqe(e){var t=Jqe(e),r=t%1;return t===t?r?t-r:t:0}var Zqe=Qqe,e7e=TJ,t7e=ff,r7e=Zqe,n7e=Math.max;function a7e(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var s=r==null?0:r7e(r);return s<0&&(s=n7e(n+s,0)),e7e(e,t7e(t),s)}var s7e=a7e,o7e=Yqe,i7e=s7e,l7e=o7e(i7e),c7e=l7e;const d7e=Ua(c7e);var u7e=cNe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),PM=p.createContext(void 0),AM=p.createContext(void 0),$Z=p.createContext(void 0),BZ=p.createContext({}),qZ=p.createContext(void 0),zZ=p.createContext(0),UZ=p.createContext(0),D7=function(t){var r=t.state,n=r.xAxisMap,s=r.yAxisMap,o=r.offset,i=t.clipPathId,l=t.children,c=t.width,d=t.height,u=u7e(o);return Pe.createElement(PM.Provider,{value:n},Pe.createElement(AM.Provider,{value:s},Pe.createElement(BZ.Provider,{value:o},Pe.createElement($Z.Provider,{value:u},Pe.createElement(qZ.Provider,{value:i},Pe.createElement(zZ.Provider,{value:d},Pe.createElement(UZ.Provider,{value:c},l)))))))},f7e=function(){return p.useContext(qZ)},VZ=function(t){var r=p.useContext(PM);r==null&&Rh(!1);var n=r[t];return n==null&&Rh(!1),n},m7e=function(){var t=p.useContext(PM);return Wm(t)},h7e=function(){var t=p.useContext(AM),r=d7e(t,function(n){return OZ(n.domain,Number.isFinite)});return r||Wm(t)},WZ=function(t){var r=p.useContext(AM);r==null&&Rh(!1);var n=r[t];return n==null&&Rh(!1),n},p7e=function(){var t=p.useContext($Z);return t},g7e=function(){return p.useContext(BZ)},EM=function(){return p.useContext(UZ)},kM=function(){return p.useContext(zZ)};function e0(e){"@babel/helpers - typeof";return e0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e0(e)}function v7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GZ(n.key),n)}}function x7e(e,t,r){return t&&M7(e.prototype,t),r&&M7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function y7e(e,t,r){return t=lS(t),b7e(e,HZ()?Reflect.construct(t,r||[],lS(e).constructor):t.apply(e,r))}function b7e(e,t){if(t&&(e0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w7e(e)}function w7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(HZ=function(){return!!e})()}function lS(e){return lS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lS(e)}function j7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lT(e,t)}function lT(e,t){return lT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},lT(e,t)}function R7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function L7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?R7(Object(r),!0).forEach(function(n){IM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IM(e,t,r){return t=GZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GZ(e){var t=_7e(e,"string");return e0(t)=="symbol"?t:t+""}function _7e(e,t){if(e0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(e0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function N7e(e,t){return A7e(e)||P7e(e,t)||C7e(e,t)||S7e()}function S7e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function C7e(e,t){if(e){if(typeof e=="string")return F7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return F7(e,t)}}function F7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function P7e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function A7e(e){if(Array.isArray(e))return e}function cT(){return cT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cT.apply(this,arguments)}var E7e=function(t,r){var n;return Pe.isValidElement(t)?n=Pe.cloneElement(t,r):Zn(t)?n=t(r):n=Pe.createElement("line",cT({},r,{className:"recharts-reference-line-line"})),n},k7e=function(t,r,n,s,o,i,l,c,d){var u=o.x,f=o.y,h=o.width,m=o.height;if(n){var v=d.y,g=t.y.apply(v,{position:i});if(nf(d,"discard")&&!t.y.isInRange(g))return null;var y=[{x:u+h,y:g},{x:u,y:g}];return c==="left"?y.reverse():y}if(r){var x=d.x,b=t.x.apply(x,{position:i});if(nf(d,"discard")&&!t.x.isInRange(b))return null;var w=[{x:b,y:f+m},{x:b,y:f}];return l==="top"?w.reverse():w}if(s){var j=d.segment,_=j.map(function(S){return t.apply(S,{position:i})});return nf(d,"discard")&&tqe(_,function(S){return!t.isInRange(S)})?null:_}return null};function I7e(e){var t=e.x,r=e.y,n=e.segment,s=e.xAxisId,o=e.yAxisId,i=e.shape,l=e.className,c=e.alwaysShow,d=f7e(),u=VZ(s),f=WZ(o),h=p7e();if(!d||!h)return null;fu(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var m=CM({x:u.scale,y:f.scale}),v=ai(t),g=ai(r),y=n&&n.length===2,x=k7e(m,v,g,y,h,e.position,u.orientation,f.orientation,e);if(!x)return null;var b=N7e(x,2),w=b[0],j=w.x,_=w.y,S=b[1],C=S.x,P=S.y,A=nf(e,"hidden")?"url(#".concat(d,")"):void 0,R=L7(L7({clipPath:A},Bn(e,!0)),{},{x1:j,y1:_,x2:C,y2:P});return Pe.createElement(Aa,{className:fa("recharts-reference-line",l)},E7e(i,R),pi.renderCallByParent(e,Uqe({x1:j,y1:_,x2:C,y2:P})))}var OM=function(e){function t(){return v7e(this,t),y7e(this,t,arguments)}return j7e(t,e),x7e(t,[{key:"render",value:function(){return Pe.createElement(I7e,this.props)}}])}(Pe.Component);IM(OM,"displayName","ReferenceLine");IM(OM,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function dT(){return dT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dT.apply(this,arguments)}function t0(e){"@babel/helpers - typeof";return t0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t0(e)}function $7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function B7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$7(Object(r),!0).forEach(function(n){E5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function O7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,XZ(n.key),n)}}function T7e(e,t,r){return t&&q7(e.prototype,t),r&&q7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function D7e(e,t,r){return t=cS(t),M7e(e,KZ()?Reflect.construct(t,r||[],cS(e).constructor):t.apply(e,r))}function M7e(e,t){if(t&&(t0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return R7e(e)}function R7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(KZ=function(){return!!e})()}function cS(e){return cS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},cS(e)}function L7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uT(e,t)}function uT(e,t){return uT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},uT(e,t)}function E5(e,t,r){return t=XZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XZ(e){var t=F7e(e,"string");return t0(t)=="symbol"?t:t+""}function F7e(e,t){if(t0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(t0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $7e=function(t){var r=t.x,n=t.y,s=t.xAxis,o=t.yAxis,i=CM({x:s.scale,y:o.scale}),l=i.apply({x:r,y:n},{bandAware:!0});return nf(t,"discard")&&!i.isInRange(l)?null:l},k5=function(e){function t(){return O7e(this,t),D7e(this,t,arguments)}return L7e(t,e),T7e(t,[{key:"render",value:function(){var n=this.props,s=n.x,o=n.y,i=n.r,l=n.alwaysShow,c=n.clipPathId,d=ai(s),u=ai(o);if(fu(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!d||!u)return null;var f=$7e(this.props);if(!f)return null;var h=f.x,m=f.y,v=this.props,g=v.shape,y=v.className,x=nf(this.props,"hidden")?"url(#".concat(c,")"):void 0,b=B7(B7({clipPath:x},Bn(this.props,!0)),{},{cx:h,cy:m});return Pe.createElement(Aa,{className:fa("recharts-reference-dot",y)},t.renderDot(g,b),pi.renderCallByParent(this.props,{x:h-i,y:m-i,width:2*i,height:2*i}))}}])}(Pe.Component);E5(k5,"displayName","ReferenceDot");E5(k5,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});E5(k5,"renderDot",function(e,t){var r;return Pe.isValidElement(e)?r=Pe.cloneElement(e,t):Zn(e)?r=e(t):r=Pe.createElement(L1,dT({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function fT(){return fT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fT.apply(this,arguments)}function r0(e){"@babel/helpers - typeof";return r0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r0(e)}function z7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function U7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?z7(Object(r),!0).forEach(function(n){I5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function B7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JZ(n.key),n)}}function q7e(e,t,r){return t&&V7(e.prototype,t),r&&V7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function z7e(e,t,r){return t=dS(t),U7e(e,YZ()?Reflect.construct(t,r||[],dS(e).constructor):t.apply(e,r))}function U7e(e,t){if(t&&(r0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return V7e(e)}function V7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(YZ=function(){return!!e})()}function dS(e){return dS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dS(e)}function W7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mT(e,t)}function mT(e,t){return mT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},mT(e,t)}function I5(e,t,r){return t=JZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JZ(e){var t=H7e(e,"string");return r0(t)=="symbol"?t:t+""}function H7e(e,t){if(r0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(r0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var G7e=function(t,r,n,s,o){var i=o.x1,l=o.x2,c=o.y1,d=o.y2,u=o.xAxis,f=o.yAxis;if(!u||!f)return null;var h=CM({x:u.scale,y:f.scale}),m={x:t?h.x.apply(i,{position:"start"}):h.x.rangeMin,y:n?h.y.apply(c,{position:"start"}):h.y.rangeMin},v={x:r?h.x.apply(l,{position:"end"}):h.x.rangeMax,y:s?h.y.apply(d,{position:"end"}):h.y.rangeMax};return nf(o,"discard")&&(!h.isInRange(m)||!h.isInRange(v))?null:LZ(m,v)},O5=function(e){function t(){return B7e(this,t),z7e(this,t,arguments)}return W7e(t,e),q7e(t,[{key:"render",value:function(){var n=this.props,s=n.x1,o=n.x2,i=n.y1,l=n.y2,c=n.className,d=n.alwaysShow,u=n.clipPathId;fu(d===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=ai(s),h=ai(o),m=ai(i),v=ai(l),g=this.props.shape;if(!f&&!h&&!m&&!v&&!g)return null;var y=G7e(f,h,m,v,this.props);if(!y&&!g)return null;var x=nf(this.props,"hidden")?"url(#".concat(u,")"):void 0;return Pe.createElement(Aa,{className:fa("recharts-reference-area",c)},t.renderRect(g,U7(U7({clipPath:x},Bn(this.props,!0)),y)),pi.renderCallByParent(this.props,y))}}])}(Pe.Component);I5(O5,"displayName","ReferenceArea");I5(O5,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});I5(O5,"renderRect",function(e,t){var r;return Pe.isValidElement(e)?r=Pe.cloneElement(e,t):Zn(e)?r=e(t):r=Pe.createElement(NM,fT({},t,{className:"recharts-reference-area-rect"})),r});function QZ(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],s=0;s<e.length;s+=t)if(r===void 0||r(e[s])===!0)n.push(e[s]);else return;return n}function K7e(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return Wqe(n,r)}function X7e(e,t,r){var n=r==="width",s=e.x,o=e.y,i=e.width,l=e.height;return t===1?{start:n?s:o,end:n?s+i:o+l}:{start:n?s+i:o+l,end:n?s:o}}function uS(e,t,r,n,s){if(e*t<e*n||e*t>e*s)return!1;var o=r();return e*(t-e*o/2-n)>=0&&e*(t+e*o/2-s)<=0}function Y7e(e,t){return QZ(e,t+1)}function J7e(e,t,r,n,s){for(var o=(n||[]).slice(),i=t.start,l=t.end,c=0,d=1,u=i,f=function(){var v=n?.[c];if(v===void 0)return{v:QZ(n,d)};var g=c,y,x=function(){return y===void 0&&(y=r(v,g)),y},b=v.coordinate,w=c===0||uS(e,b,x,u,l);w||(c=0,u=i,d+=1),w&&(u=b+e*(x()/2+s),c+=d)},h;d<=o.length;)if(h=f(),h)return h.v;return[]}function Ww(e){"@babel/helpers - typeof";return Ww=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ww(e)}function W7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Zi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?W7(Object(r),!0).forEach(function(n){Q7e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Q7e(e,t,r){return t=Z7e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Z7e(e){var t=eze(e,"string");return Ww(t)=="symbol"?t:t+""}function eze(e,t){if(Ww(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ww(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tze(e,t,r,n,s){for(var o=(n||[]).slice(),i=o.length,l=t.start,c=t.end,d=function(h){var m=o[h],v,g=function(){return v===void 0&&(v=r(m,h)),v};if(h===i-1){var y=e*(m.coordinate+e*g()/2-c);o[h]=m=Zi(Zi({},m),{},{tickCoord:y>0?m.coordinate-y*e:m.coordinate})}else o[h]=m=Zi(Zi({},m),{},{tickCoord:m.coordinate});var x=uS(e,m.tickCoord,g,l,c);x&&(c=m.tickCoord-e*(g()/2+s),o[h]=Zi(Zi({},m),{},{isShow:!0}))},u=i-1;u>=0;u--)d(u);return o}function rze(e,t,r,n,s,o){var i=(n||[]).slice(),l=i.length,c=t.start,d=t.end;if(o){var u=n[l-1],f=r(u,l-1),h=e*(u.coordinate+e*f/2-d);i[l-1]=u=Zi(Zi({},u),{},{tickCoord:h>0?u.coordinate-h*e:u.coordinate});var m=uS(e,u.tickCoord,function(){return f},c,d);m&&(d=u.tickCoord-e*(f/2+s),i[l-1]=Zi(Zi({},u),{},{isShow:!0}))}for(var v=o?l-1:l,g=function(b){var w=i[b],j,_=function(){return j===void 0&&(j=r(w,b)),j};if(b===0){var S=e*(w.coordinate-e*_()/2-c);i[b]=w=Zi(Zi({},w),{},{tickCoord:S<0?w.coordinate-S*e:w.coordinate})}else i[b]=w=Zi(Zi({},w),{},{tickCoord:w.coordinate});var C=uS(e,w.tickCoord,_,c,d);C&&(c=w.tickCoord+e*(_()/2+s),i[b]=Zi(Zi({},w),{},{isShow:!0}))},y=0;y<v;y++)g(y);return i}function TM(e,t,r){var n=e.tick,s=e.ticks,o=e.viewBox,i=e.minTickGap,l=e.orientation,c=e.interval,d=e.tickFormatter,u=e.unit,f=e.angle;if(!s||!s.length||!n)return[];if(Xr(c)||mu.isSsr)return Y7e(s,typeof c=="number"&&Xr(c)?c:0);var h=[],m=l==="top"||l==="bottom"?"width":"height",v=u&&m==="width"?mb(u,{fontSize:t,letterSpacing:r}):{width:0,height:0},g=function(w,j){var _=Zn(d)?d(w.value,j):w.value;return m==="width"?K7e(mb(_,{fontSize:t,letterSpacing:r}),v,f):mb(_,{fontSize:t,letterSpacing:r})[m]},y=s.length>=2?Al(s[1].coordinate-s[0].coordinate):1,x=X7e(o,y,m);return c==="equidistantPreserveStart"?J7e(y,x,g,s,i):(c==="preserveStart"||c==="preserveStartEnd"?h=rze(y,x,g,s,i,c==="preserveStartEnd"):h=tze(y,x,g,s,i),h.filter(function(b){return b.isShow}))}var nze=["viewBox"],aze=["viewBox"],sze=["ticks"];function n0(e){"@babel/helpers - typeof";return n0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n0(e)}function Qv(){return Qv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Qv.apply(this,arguments)}function H7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Ko(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?H7(Object(r),!0).forEach(function(n){DM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dE(e,t){if(e==null)return{};var r=oze(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function oze(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function ize(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eee(n.key),n)}}function lze(e,t,r){return t&&G7(e.prototype,t),r&&G7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cze(e,t,r){return t=fS(t),dze(e,ZZ()?Reflect.construct(t,r||[],fS(e).constructor):t.apply(e,r))}function dze(e,t){if(t&&(n0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uze(e)}function uze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ZZ=function(){return!!e})()}function fS(e){return fS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fS(e)}function fze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hT(e,t)}function hT(e,t){return hT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},hT(e,t)}function DM(e,t,r){return t=eee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eee(e){var t=mze(e,"string");return n0(t)=="symbol"?t:t+""}function mze(e,t){if(n0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(n0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var z0=function(e){function t(r){var n;return ize(this,t),n=cze(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return fze(t,e),lze(t,[{key:"shouldComponentUpdate",value:function(n,s){var o=n.viewBox,i=dE(n,nze),l=this.props,c=l.viewBox,d=dE(l,aze);return!hx(o,c)||!hx(i,d)||!hx(s,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var s=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];s&&this.setState({fontSize:window.getComputedStyle(s).fontSize,letterSpacing:window.getComputedStyle(s).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var s=this.props,o=s.x,i=s.y,l=s.width,c=s.height,d=s.orientation,u=s.tickSize,f=s.mirror,h=s.tickMargin,m,v,g,y,x,b,w=f?-1:1,j=n.tickSize||u,_=Xr(n.tickCoord)?n.tickCoord:n.coordinate;switch(d){case"top":m=v=n.coordinate,y=i+ +!f*c,g=y-w*j,b=g-w*h,x=_;break;case"left":g=y=n.coordinate,v=o+ +!f*l,m=v-w*j,x=m-w*h,b=_;break;case"right":g=y=n.coordinate,v=o+ +f*l,m=v+w*j,x=m+w*h,b=_;break;default:m=v=n.coordinate,y=i+ +f*c,g=y+w*j,b=g+w*h,x=_;break}return{line:{x1:m,y1:g,x2:v,y2:y},tick:{x,y:b}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,s=n.orientation,o=n.mirror,i;switch(s){case"left":i=o?"start":"end";break;case"right":i=o?"end":"start";break;default:i="middle";break}return i}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,s=n.orientation,o=n.mirror,i="end";switch(s){case"left":case"right":i="middle";break;case"top":i=o?"start":"end";break;default:i=o?"end":"start";break}return i}},{key:"renderAxisLine",value:function(){var n=this.props,s=n.x,o=n.y,i=n.width,l=n.height,c=n.orientation,d=n.mirror,u=n.axisLine,f=Ko(Ko(Ko({},Bn(this.props,!1)),Bn(u,!1)),{},{fill:"none"});if(c==="top"||c==="bottom"){var h=+(c==="top"&&!d||c==="bottom"&&d);f=Ko(Ko({},f),{},{x1:s,y1:o+h*l,x2:s+i,y2:o+h*l})}else{var m=+(c==="left"&&!d||c==="right"&&d);f=Ko(Ko({},f),{},{x1:s+m*i,y1:o,x2:s+m*i,y2:o+l})}return Pe.createElement("line",Qv({},f,{className:fa("recharts-cartesian-axis-line",zc(u,"className"))}))}},{key:"renderTicks",value:function(n,s,o){var i=this,l=this.props,c=l.tickLine,d=l.stroke,u=l.tick,f=l.tickFormatter,h=l.unit,m=TM(Ko(Ko({},this.props),{},{ticks:n}),s,o),v=this.getTickTextAnchor(),g=this.getTickVerticalAnchor(),y=Bn(this.props,!1),x=Bn(u,!1),b=Ko(Ko({},y),{},{fill:"none"},Bn(c,!1)),w=m.map(function(j,_){var S=i.getTickLineCoord(j),C=S.line,P=S.tick,A=Ko(Ko(Ko(Ko({textAnchor:v,verticalAnchor:g},y),{},{stroke:"none",fill:d},x),P),{},{index:_,payload:j,visibleTicksCount:m.length,tickFormatter:f});return Pe.createElement(Aa,Qv({className:"recharts-cartesian-axis-tick",key:"tick-".concat(j.value,"-").concat(j.coordinate,"-").concat(j.tickCoord)},yg(i.props,j,_)),c&&Pe.createElement("line",Qv({},b,C,{className:fa("recharts-cartesian-axis-tick-line",zc(c,"className"))})),u&&t.renderTickItem(u,A,"".concat(Zn(f)?f(j.value,_):j.value).concat(h||"")))});return Pe.createElement("g",{className:"recharts-cartesian-axis-ticks"},w)}},{key:"render",value:function(){var n=this,s=this.props,o=s.axisLine,i=s.width,l=s.height,c=s.ticksGenerator,d=s.className,u=s.hide;if(u)return null;var f=this.props,h=f.ticks,m=dE(f,sze),v=h;return Zn(c)&&(v=h&&h.length>0?c(this.props):c(m)),i<=0||l<=0||!v||!v.length?null:Pe.createElement(Aa,{className:fa("recharts-cartesian-axis",d),ref:function(y){n.layerReference=y}},o&&this.renderAxisLine(),this.renderTicks(v,this.state.fontSize,this.state.letterSpacing),pi.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,s,o){var i,l=fa(s.className,"recharts-cartesian-axis-tick-value");return Pe.isValidElement(n)?i=Pe.cloneElement(n,Ko(Ko({},s),{},{className:l})):Zn(n)?i=n(Ko(Ko({},s),{},{className:l})):i=Pe.createElement(bg,Qv({},s,{className:"recharts-cartesian-axis-tick-value"}),o),i}}])}(p.Component);DM(z0,"displayName","CartesianAxis");DM(z0,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var hze=["x1","y1","x2","y2","key"],pze=["offset"];function _g(e){"@babel/helpers - typeof";return _g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_g(e)}function K7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function tl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?K7(Object(r),!0).forEach(function(n){gze(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gze(e,t,r){return t=vze(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vze(e){var t=xze(e,"string");return _g(t)=="symbol"?t:t+""}function xze(e,t){if(_g(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_g(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function qp(){return qp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qp.apply(this,arguments)}function X7(e,t){if(e==null)return{};var r=yze(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function yze(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var bze=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,s=t.x,o=t.y,i=t.width,l=t.height,c=t.ry;return Pe.createElement("rect",{x:s,y:o,ry:c,width:i,height:l,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function tee(e,t){var r;if(Pe.isValidElement(e))r=Pe.cloneElement(e,t);else if(Zn(e))r=e(t);else{var n=t.x1,s=t.y1,o=t.x2,i=t.y2,l=t.key,c=X7(t,hze),d=Bn(c,!1);d.offset;var u=X7(d,pze);r=Pe.createElement("line",qp({},u,{x1:n,y1:s,x2:o,y2:i,fill:"none",key:l}))}return r}function wze(e){var t=e.x,r=e.width,n=e.horizontal,s=n===void 0?!0:n,o=e.horizontalPoints;if(!s||!o||!o.length)return null;var i=o.map(function(l,c){var d=tl(tl({},e),{},{x1:t,y1:l,x2:t+r,y2:l,key:"line-".concat(c),index:c});return tee(s,d)});return Pe.createElement("g",{className:"recharts-cartesian-grid-horizontal"},i)}function jze(e){var t=e.y,r=e.height,n=e.vertical,s=n===void 0?!0:n,o=e.verticalPoints;if(!s||!o||!o.length)return null;var i=o.map(function(l,c){var d=tl(tl({},e),{},{x1:l,y1:t,x2:l,y2:t+r,key:"line-".concat(c),index:c});return tee(s,d)});return Pe.createElement("g",{className:"recharts-cartesian-grid-vertical"},i)}function _ze(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,s=e.y,o=e.width,i=e.height,l=e.horizontalPoints,c=e.horizontal,d=c===void 0?!0:c;if(!d||!t||!t.length)return null;var u=l.map(function(h){return Math.round(h+s-s)}).sort(function(h,m){return h-m});s!==u[0]&&u.unshift(0);var f=u.map(function(h,m){var v=!u[m+1],g=v?s+i-h:u[m+1]-h;if(g<=0)return null;var y=m%t.length;return Pe.createElement("rect",{key:"react-".concat(m),y:h,x:n,height:g,width:o,stroke:"none",fill:t[y],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return Pe.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},f)}function Nze(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,s=e.fillOpacity,o=e.x,i=e.y,l=e.width,c=e.height,d=e.verticalPoints;if(!r||!n||!n.length)return null;var u=d.map(function(h){return Math.round(h+o-o)}).sort(function(h,m){return h-m});o!==u[0]&&u.unshift(0);var f=u.map(function(h,m){var v=!u[m+1],g=v?o+l-h:u[m+1]-h;if(g<=0)return null;var y=m%n.length;return Pe.createElement("rect",{key:"react-".concat(m),x:h,y:i,width:g,height:c,stroke:"none",fill:n[y],fillOpacity:s,className:"recharts-cartesian-grid-bg"})});return Pe.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},f)}var Sze=function(t,r){var n=t.xAxis,s=t.width,o=t.height,i=t.offset;return QQ(TM(tl(tl(tl({},z0.defaultProps),n),{},{ticks:Ff(n,!0),viewBox:{x:0,y:0,width:s,height:o}})),i.left,i.left+i.width,r)},Cze=function(t,r){var n=t.yAxis,s=t.width,o=t.height,i=t.offset;return QQ(TM(tl(tl(tl({},z0.defaultProps),n),{},{ticks:Ff(n,!0),viewBox:{x:0,y:0,width:s,height:o}})),i.top,i.top+i.height,r)},fv={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function mS(e){var t,r,n,s,o,i,l=EM(),c=kM(),d=g7e(),u=tl(tl({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:fv.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:fv.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:fv.horizontal,horizontalFill:(s=e.horizontalFill)!==null&&s!==void 0?s:fv.horizontalFill,vertical:(o=e.vertical)!==null&&o!==void 0?o:fv.vertical,verticalFill:(i=e.verticalFill)!==null&&i!==void 0?i:fv.verticalFill,x:Xr(e.x)?e.x:d.left,y:Xr(e.y)?e.y:d.top,width:Xr(e.width)?e.width:d.width,height:Xr(e.height)?e.height:d.height}),f=u.x,h=u.y,m=u.width,v=u.height,g=u.syncWithTicks,y=u.horizontalValues,x=u.verticalValues,b=m7e(),w=h7e();if(!Xr(m)||m<=0||!Xr(v)||v<=0||!Xr(f)||f!==+f||!Xr(h)||h!==+h)return null;var j=u.verticalCoordinatesGenerator||Sze,_=u.horizontalCoordinatesGenerator||Cze,S=u.horizontalPoints,C=u.verticalPoints;if((!S||!S.length)&&Zn(_)){var P=y&&y.length,A=_({yAxis:w?tl(tl({},w),{},{ticks:P?y:w.ticks}):void 0,width:l,height:c,offset:d},P?!0:g);fu(Array.isArray(A),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(_g(A),"]")),Array.isArray(A)&&(S=A)}if((!C||!C.length)&&Zn(j)){var R=x&&x.length,O=j({xAxis:b?tl(tl({},b),{},{ticks:R?x:b.ticks}):void 0,width:l,height:c,offset:d},R?!0:g);fu(Array.isArray(O),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(_g(O),"]")),Array.isArray(O)&&(C=O)}return Pe.createElement("g",{className:"recharts-cartesian-grid"},Pe.createElement(bze,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),Pe.createElement(wze,qp({},u,{offset:d,horizontalPoints:S,xAxis:b,yAxis:w})),Pe.createElement(jze,qp({},u,{offset:d,verticalPoints:C,xAxis:b,yAxis:w})),Pe.createElement(_ze,qp({},u,{horizontalPoints:S})),Pe.createElement(Nze,qp({},u,{verticalPoints:C})))}mS.displayName="CartesianGrid";var Pze=["type","layout","connectNulls","ref"],Aze=["key"];function a0(e){"@babel/helpers - typeof";return a0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a0(e)}function Y7(e,t){if(e==null)return{};var r=Eze(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Eze(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function yb(){return yb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yb.apply(this,arguments)}function J7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function jc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?J7(Object(r),!0).forEach(function(n){ru(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mv(e){return Tze(e)||Oze(e)||Ize(e)||kze()}function kze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ize(e,t){if(e){if(typeof e=="string")return pT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pT(e,t)}}function Oze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Tze(e){if(Array.isArray(e))return pT(e)}function pT(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Dze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nee(n.key),n)}}function Mze(e,t,r){return t&&Q7(e.prototype,t),r&&Q7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rze(e,t,r){return t=hS(t),Lze(e,ree()?Reflect.construct(t,r||[],hS(e).constructor):t.apply(e,r))}function Lze(e,t){if(t&&(a0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fze(e)}function Fze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ree(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ree=function(){return!!e})()}function hS(e){return hS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hS(e)}function $ze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gT(e,t)}function gT(e,t){return gT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},gT(e,t)}function ru(e,t,r){return t=nee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nee(e){var t=Bze(e,"string");return a0(t)=="symbol"?t:t+""}function Bze(e,t){if(a0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(a0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var U0=function(e){function t(){var r;Dze(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return r=Rze(this,t,[].concat(s)),ru(r,"state",{isAnimationFinished:!0,totalLength:0}),ru(r,"generateSimpleStrokeDasharray",function(i,l){return"".concat(l,"px ").concat(i-l,"px")}),ru(r,"getStrokeDasharray",function(i,l,c){var d=c.reduce(function(x,b){return x+b});if(!d)return r.generateSimpleStrokeDasharray(l,i);for(var u=Math.floor(i/d),f=i%d,h=l-i,m=[],v=0,g=0;v<c.length;g+=c[v],++v)if(g+c[v]>f){m=[].concat(mv(c.slice(0,v)),[f-g]);break}var y=m.length%2===0?[0,h]:[h];return[].concat(mv(t.repeat(c,u)),mv(m),y).map(function(x){return"".concat(x,"px")}).join(", ")}),ru(r,"id",Fg("recharts-line-")),ru(r,"pathRef",function(i){r.mainCurve=i}),ru(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),ru(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return $ze(t,e),Mze(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,s){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,i=o.points,l=o.xAxis,c=o.yAxis,d=o.layout,u=o.children,f=Uc(u,R1);if(!f)return null;var h=function(g,y){return{x:g.x,y:g.y,value:g.value,errorVal:So(g.payload,y)}},m={clipPath:n?"url(#clipPath-".concat(s,")"):null};return Pe.createElement(Aa,m,f.map(function(v){return Pe.cloneElement(v,{key:"bar-".concat(v.props.dataKey),data:i,xAxis:l,yAxis:c,layout:d,dataPointFormatter:h})}))}},{key:"renderDots",value:function(n,s,o){var i=this.props.isAnimationActive;if(i&&!this.state.isAnimationFinished)return null;var l=this.props,c=l.dot,d=l.points,u=l.dataKey,f=Bn(this.props,!1),h=Bn(c,!0),m=d.map(function(g,y){var x=jc(jc(jc({key:"dot-".concat(y),r:3},f),h),{},{index:y,cx:g.x,cy:g.y,value:g.value,dataKey:u,payload:g.payload,points:d});return t.renderDotItem(c,x)}),v={clipPath:n?"url(#clipPath-".concat(s?"":"dots-").concat(o,")"):null};return Pe.createElement(Aa,yb({className:"recharts-line-dots",key:"dots"},v),m)}},{key:"renderCurveStatically",value:function(n,s,o,i){var l=this.props,c=l.type,d=l.layout,u=l.connectNulls;l.ref;var f=Y7(l,Pze),h=jc(jc(jc({},Bn(f,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:s?"url(#clipPath-".concat(o,")"):null,points:n},i),{},{type:c,layout:d,connectNulls:u});return Pe.createElement(rg,yb({},h,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,s){var o=this,i=this.props,l=i.points,c=i.strokeDasharray,d=i.isAnimationActive,u=i.animationBegin,f=i.animationDuration,h=i.animationEasing,m=i.animationId,v=i.animateNewValues,g=i.width,y=i.height,x=this.state,b=x.prevPoints,w=x.totalLength;return Pe.createElement(Lh,{begin:u,duration:f,isActive:d,easing:h,from:{t:0},to:{t:1},key:"line-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(j){var _=j.t;if(b){var S=b.length/l.length,C=l.map(function(I,M){var D=Math.floor(M*S);if(b[D]){var U=b[D],z=ti(U.x,I.x),W=ti(U.y,I.y);return jc(jc({},I),{},{x:z(_),y:W(_)})}if(v){var $=ti(g*2,I.x),X=ti(y/2,I.y);return jc(jc({},I),{},{x:$(_),y:X(_)})}return jc(jc({},I),{},{x:I.x,y:I.y})});return o.renderCurveStatically(C,n,s)}var P=ti(0,w),A=P(_),R;if(c){var O="".concat(c).split(/[,\s]+/gim).map(function(I){return parseFloat(I)});R=o.getStrokeDasharray(A,w,O)}else R=o.generateSimpleStrokeDasharray(w,A);return o.renderCurveStatically(l,n,s,{strokeDasharray:R})})}},{key:"renderCurve",value:function(n,s){var o=this.props,i=o.points,l=o.isAnimationActive,c=this.state,d=c.prevPoints,u=c.totalLength;return l&&i&&i.length&&(!d&&u>0||!wg(d,i))?this.renderCurveWithAnimation(n,s):this.renderCurveStatically(i,n,s)}},{key:"render",value:function(){var n,s=this.props,o=s.hide,i=s.dot,l=s.points,c=s.className,d=s.xAxis,u=s.yAxis,f=s.top,h=s.left,m=s.width,v=s.height,g=s.isAnimationActive,y=s.id;if(o||!l||!l.length)return null;var x=this.state.isAnimationFinished,b=l.length===1,w=fa("recharts-line",c),j=d&&d.allowDataOverflow,_=u&&u.allowDataOverflow,S=j||_,C=la(y)?this.id:y,P=(n=Bn(i,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},A=P.r,R=A===void 0?3:A,O=P.strokeWidth,I=O===void 0?2:O,M=VY(i)?i:{},D=M.clipDot,U=D===void 0?!0:D,z=R*2+I;return Pe.createElement(Aa,{className:w},j||_?Pe.createElement("defs",null,Pe.createElement("clipPath",{id:"clipPath-".concat(C)},Pe.createElement("rect",{x:j?h:h-m/2,y:_?f:f-v/2,width:j?m:m*2,height:_?v:v*2})),!U&&Pe.createElement("clipPath",{id:"clipPath-dots-".concat(C)},Pe.createElement("rect",{x:h-z/2,y:f-z/2,width:m+z,height:v+z}))):null,!b&&this.renderCurve(S,C),this.renderErrorBar(S,C),(b||i)&&this.renderDots(S,U,C),(!g||x)&&rf.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,s){return n.animationId!==s.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:s.curPoints}:n.points!==s.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,s){for(var o=n.length%2!==0?[].concat(mv(n),[0]):n,i=[],l=0;l<s;++l)i=[].concat(mv(i),mv(o));return i}},{key:"renderDotItem",value:function(n,s){var o;if(Pe.isValidElement(n))o=Pe.cloneElement(n,s);else if(Zn(n))o=n(s);else{var i=s.key,l=Y7(s,Aze),c=fa("recharts-line-dot",typeof n!="boolean"?n.className:"");o=Pe.createElement(L1,yb({key:i},l,{className:c}))}return o}}])}(p.PureComponent);ru(U0,"displayName","Line");ru(U0,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!mu.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});ru(U0,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,s=e.xAxisTicks,o=e.yAxisTicks,i=e.dataKey,l=e.bandSize,c=e.displayedData,d=e.offset,u=t.layout,f=c.map(function(h,m){var v=So(h,i);return u==="horizontal"?{x:UN({axis:r,ticks:s,bandSize:l,entry:h,index:m}),y:la(v)?null:n.scale(v),value:v,payload:h}:{x:la(v)?null:r.scale(v),y:UN({axis:n,ticks:o,bandSize:l,entry:h,index:m}),value:v,payload:h}});return jc({points:f,layout:u},d)});var qze=["layout","type","stroke","connectNulls","isRange","ref"],zze=["key"],aee;function s0(e){"@babel/helpers - typeof";return s0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s0(e)}function see(e,t){if(e==null)return{};var r=Uze(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Uze(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function zp(){return zp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zp.apply(this,arguments)}function Z7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Mm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z7(Object(r),!0).forEach(function(n){Gu(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Vze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ez(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iee(n.key),n)}}function Wze(e,t,r){return t&&ez(e.prototype,t),r&&ez(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hze(e,t,r){return t=pS(t),Gze(e,oee()?Reflect.construct(t,r||[],pS(e).constructor):t.apply(e,r))}function Gze(e,t){if(t&&(s0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kze(e)}function Kze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oee=function(){return!!e})()}function pS(e){return pS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},pS(e)}function Xze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vT(e,t)}function vT(e,t){return vT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},vT(e,t)}function Gu(e,t,r){return t=iee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iee(e){var t=Yze(e,"string");return s0(t)=="symbol"?t:t+""}function Yze(e,t){if(s0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(s0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zh=function(e){function t(){var r;Vze(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return r=Hze(this,t,[].concat(s)),Gu(r,"state",{isAnimationFinished:!0}),Gu(r,"id",Fg("recharts-area-")),Gu(r,"handleAnimationEnd",function(){var i=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),Zn(i)&&i()}),Gu(r,"handleAnimationStart",function(){var i=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),Zn(i)&&i()}),r}return Xze(t,e),Wze(t,[{key:"renderDots",value:function(n,s,o){var i=this.props.isAnimationActive,l=this.state.isAnimationFinished;if(i&&!l)return null;var c=this.props,d=c.dot,u=c.points,f=c.dataKey,h=Bn(this.props,!1),m=Bn(d,!0),v=u.map(function(y,x){var b=Mm(Mm(Mm({key:"dot-".concat(x),r:3},h),m),{},{index:x,cx:y.x,cy:y.y,dataKey:f,value:y.value,payload:y.payload,points:u});return t.renderDotItem(d,b)}),g={clipPath:n?"url(#clipPath-".concat(s?"":"dots-").concat(o,")"):null};return Pe.createElement(Aa,zp({className:"recharts-area-dots"},g),v)}},{key:"renderHorizontalRect",value:function(n){var s=this.props,o=s.baseLine,i=s.points,l=s.strokeWidth,c=i[0].x,d=i[i.length-1].x,u=n*Math.abs(c-d),f=Zm(i.map(function(h){return h.y||0}));return Xr(o)&&typeof o=="number"?f=Math.max(o,f):o&&Array.isArray(o)&&o.length&&(f=Math.max(Zm(o.map(function(h){return h.y||0})),f)),Xr(f)?Pe.createElement("rect",{x:c<d?c:c-u,y:0,width:u,height:Math.floor(f+(l?parseInt("".concat(l),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var s=this.props,o=s.baseLine,i=s.points,l=s.strokeWidth,c=i[0].y,d=i[i.length-1].y,u=n*Math.abs(c-d),f=Zm(i.map(function(h){return h.x||0}));return Xr(o)&&typeof o=="number"?f=Math.max(o,f):o&&Array.isArray(o)&&o.length&&(f=Math.max(Zm(o.map(function(h){return h.x||0})),f)),Xr(f)?Pe.createElement("rect",{x:0,y:c<d?c:c-u,width:f+(l?parseInt("".concat(l),10):1),height:Math.floor(u)}):null}},{key:"renderClipRect",value:function(n){var s=this.props.layout;return s==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,s,o,i){var l=this.props,c=l.layout,d=l.type,u=l.stroke,f=l.connectNulls,h=l.isRange;l.ref;var m=see(l,qze);return Pe.createElement(Aa,{clipPath:o?"url(#clipPath-".concat(i,")"):null},Pe.createElement(rg,zp({},Bn(m,!0),{points:n,connectNulls:f,type:d,baseLine:s,layout:c,stroke:"none",className:"recharts-area-area"})),u!=="none"&&Pe.createElement(rg,zp({},Bn(this.props,!1),{className:"recharts-area-curve",layout:c,type:d,connectNulls:f,fill:"none",points:n})),u!=="none"&&h&&Pe.createElement(rg,zp({},Bn(this.props,!1),{className:"recharts-area-curve",layout:c,type:d,connectNulls:f,fill:"none",points:s})))}},{key:"renderAreaWithAnimation",value:function(n,s){var o=this,i=this.props,l=i.points,c=i.baseLine,d=i.isAnimationActive,u=i.animationBegin,f=i.animationDuration,h=i.animationEasing,m=i.animationId,v=this.state,g=v.prevPoints,y=v.prevBaseLine;return Pe.createElement(Lh,{begin:u,duration:f,isActive:d,easing:h,from:{t:0},to:{t:1},key:"area-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(x){var b=x.t;if(g){var w=g.length/l.length,j=l.map(function(P,A){var R=Math.floor(A*w);if(g[R]){var O=g[R],I=ti(O.x,P.x),M=ti(O.y,P.y);return Mm(Mm({},P),{},{x:I(b),y:M(b)})}return P}),_;if(Xr(c)&&typeof c=="number"){var S=ti(y,c);_=S(b)}else if(la(c)||M0(c)){var C=ti(y,0);_=C(b)}else _=c.map(function(P,A){var R=Math.floor(A*w);if(y[R]){var O=y[R],I=ti(O.x,P.x),M=ti(O.y,P.y);return Mm(Mm({},P),{},{x:I(b),y:M(b)})}return P});return o.renderAreaStatically(j,_,n,s)}return Pe.createElement(Aa,null,Pe.createElement("defs",null,Pe.createElement("clipPath",{id:"animationClipPath-".concat(s)},o.renderClipRect(b))),Pe.createElement(Aa,{clipPath:"url(#animationClipPath-".concat(s,")")},o.renderAreaStatically(l,c,n,s)))})}},{key:"renderArea",value:function(n,s){var o=this.props,i=o.points,l=o.baseLine,c=o.isAnimationActive,d=this.state,u=d.prevPoints,f=d.prevBaseLine,h=d.totalLength;return c&&i&&i.length&&(!u&&h>0||!wg(u,i)||!wg(f,l))?this.renderAreaWithAnimation(n,s):this.renderAreaStatically(i,l,n,s)}},{key:"render",value:function(){var n,s=this.props,o=s.hide,i=s.dot,l=s.points,c=s.className,d=s.top,u=s.left,f=s.xAxis,h=s.yAxis,m=s.width,v=s.height,g=s.isAnimationActive,y=s.id;if(o||!l||!l.length)return null;var x=this.state.isAnimationFinished,b=l.length===1,w=fa("recharts-area",c),j=f&&f.allowDataOverflow,_=h&&h.allowDataOverflow,S=j||_,C=la(y)?this.id:y,P=(n=Bn(i,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},A=P.r,R=A===void 0?3:A,O=P.strokeWidth,I=O===void 0?2:O,M=VY(i)?i:{},D=M.clipDot,U=D===void 0?!0:D,z=R*2+I;return Pe.createElement(Aa,{className:w},j||_?Pe.createElement("defs",null,Pe.createElement("clipPath",{id:"clipPath-".concat(C)},Pe.createElement("rect",{x:j?u:u-m/2,y:_?d:d-v/2,width:j?m:m*2,height:_?v:v*2})),!U&&Pe.createElement("clipPath",{id:"clipPath-dots-".concat(C)},Pe.createElement("rect",{x:u-z/2,y:d-z/2,width:m+z,height:v+z}))):null,b?null:this.renderArea(S,C),(i||b)&&this.renderDots(S,U,C),(!g||x)&&rf.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,s){return n.animationId!==s.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:s.curPoints,prevBaseLine:s.curBaseLine}:n.points!==s.curPoints||n.baseLine!==s.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(p.PureComponent);aee=Zh;Gu(Zh,"displayName","Area");Gu(Zh,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!mu.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Gu(Zh,"getBaseValue",function(e,t,r,n){var s=e.layout,o=e.baseValue,i=t.props.baseValue,l=i??o;if(Xr(l)&&typeof l=="number")return l;var c=s==="horizontal"?n:r,d=c.scale.domain();if(c.type==="number"){var u=Math.max(d[0],d[1]),f=Math.min(d[0],d[1]);return l==="dataMin"?f:l==="dataMax"||u<0?u:Math.max(Math.min(d[0],d[1]),0)}return l==="dataMin"?d[0]:l==="dataMax"?d[1]:d[0]});Gu(Zh,"getComposedData",function(e){var t=e.props,r=e.item,n=e.xAxis,s=e.yAxis,o=e.xAxisTicks,i=e.yAxisTicks,l=e.bandSize,c=e.dataKey,d=e.stackedData,u=e.dataStartIndex,f=e.displayedData,h=e.offset,m=t.layout,v=d&&d.length,g=aee.getBaseValue(t,r,n,s),y=m==="horizontal",x=!1,b=f.map(function(j,_){var S;v?S=d[u+_]:(S=So(j,c),Array.isArray(S)?x=!0:S=[g,S]);var C=S[1]==null||v&&So(j,c)==null;return y?{x:UN({axis:n,ticks:o,bandSize:l,entry:j,index:_}),y:C?null:s.scale(S[1]),value:S,payload:j}:{x:C?null:n.scale(S[1]),y:UN({axis:s,ticks:i,bandSize:l,entry:j,index:_}),value:S,payload:j}}),w;return v||x?w=b.map(function(j){var _=Array.isArray(j.value)?j.value[0]:null;return y?{x:j.x,y:_!=null&&j.y!=null?s.scale(_):null}:{x:_!=null?n.scale(_):null,y:j.y}}):w=y?s.scale(g):n.scale(g),Mm({points:b,baseLine:w,layout:m,isRange:x},h)});Gu(Zh,"renderDotItem",function(e,t){var r;if(Pe.isValidElement(e))r=Pe.cloneElement(e,t);else if(Zn(e))r=e(t);else{var n=fa("recharts-area-dot",typeof e!="boolean"?e.className:""),s=t.key,o=see(t,zze);r=Pe.createElement(L1,zp({},o,{key:s,className:n}))}return r});function o0(e){"@babel/helpers - typeof";return o0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o0(e)}function Jze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dee(n.key),n)}}function Qze(e,t,r){return t&&tz(e.prototype,t),r&&tz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zze(e,t,r){return t=gS(t),e9e(e,lee()?Reflect.construct(t,r||[],gS(e).constructor):t.apply(e,r))}function e9e(e,t){if(t&&(o0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return t9e(e)}function t9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lee=function(){return!!e})()}function gS(e){return gS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},gS(e)}function r9e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xT(e,t)}function xT(e,t){return xT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},xT(e,t)}function cee(e,t,r){return t=dee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dee(e){var t=n9e(e,"string");return o0(t)=="symbol"?t:t+""}function n9e(e,t){if(o0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(o0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yT(){return yT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yT.apply(this,arguments)}function a9e(e){var t=e.xAxisId,r=EM(),n=kM(),s=VZ(t);return s==null?null:p.createElement(z0,yT({},s,{className:fa("recharts-".concat(s.axisType," ").concat(s.axisType),s.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(i){return Ff(i,!0)}}))}var Fh=function(e){function t(){return Jze(this,t),Zze(this,t,arguments)}return r9e(t,e),Qze(t,[{key:"render",value:function(){return p.createElement(a9e,this.props)}}])}(p.Component);cee(Fh,"displayName","XAxis");cee(Fh,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function i0(e){"@babel/helpers - typeof";return i0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i0(e)}function s9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mee(n.key),n)}}function o9e(e,t,r){return t&&rz(e.prototype,t),r&&rz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function i9e(e,t,r){return t=vS(t),l9e(e,uee()?Reflect.construct(t,r||[],vS(e).constructor):t.apply(e,r))}function l9e(e,t){if(t&&(i0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return c9e(e)}function c9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uee=function(){return!!e})()}function vS(e){return vS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vS(e)}function d9e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bT(e,t)}function bT(e,t){return bT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},bT(e,t)}function fee(e,t,r){return t=mee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mee(e){var t=u9e(e,"string");return i0(t)=="symbol"?t:t+""}function u9e(e,t){if(i0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(i0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wT(){return wT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wT.apply(this,arguments)}var f9e=function(t){var r=t.yAxisId,n=EM(),s=kM(),o=WZ(r);return o==null?null:p.createElement(z0,wT({},o,{className:fa("recharts-".concat(o.axisType," ").concat(o.axisType),o.className),viewBox:{x:0,y:0,width:n,height:s},ticksGenerator:function(l){return Ff(l,!0)}}))},$h=function(e){function t(){return s9e(this,t),i9e(this,t,arguments)}return d9e(t,e),o9e(t,[{key:"render",value:function(){return p.createElement(f9e,this.props)}}])}(p.Component);fee($h,"displayName","YAxis");fee($h,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function nz(e){return g9e(e)||p9e(e)||h9e(e)||m9e()}function m9e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function h9e(e,t){if(e){if(typeof e=="string")return jT(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jT(e,t)}}function p9e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function g9e(e){if(Array.isArray(e))return jT(e)}function jT(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var _T=function(t,r,n,s,o){var i=Uc(t,OM),l=Uc(t,k5),c=[].concat(nz(i),nz(l)),d=Uc(t,O5),u="".concat(s,"Id"),f=s[0],h=r;if(c.length&&(h=c.reduce(function(g,y){if(y.props[u]===n&&nf(y.props,"extendDomain")&&Xr(y.props[f])){var x=y.props[f];return[Math.min(g[0],x),Math.max(g[1],x)]}return g},h)),d.length){var m="".concat(f,"1"),v="".concat(f,"2");h=d.reduce(function(g,y){if(y.props[u]===n&&nf(y.props,"extendDomain")&&Xr(y.props[m])&&Xr(y.props[v])){var x=y.props[m],b=y.props[v];return[Math.min(g[0],x,b),Math.max(g[1],x,b)]}return g},h)}return o&&o.length&&(h=o.reduce(function(g,y){return Xr(y)?[Math.min(g[0],y),Math.max(g[1],y)]:g},h)),h},hee={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function s(c,d,u){this.fn=c,this.context=d,this.once=u||!1}function o(c,d,u,f,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new s(u,f||c,h),v=r?r+d:d;return c._events[v]?c._events[v].fn?c._events[v]=[c._events[v],m]:c._events[v].push(m):(c._events[v]=m,c._eventsCount++),c}function i(c,d){--c._eventsCount===0?c._events=new n:delete c._events[d]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],u,f;if(this._eventsCount===0)return d;for(f in u=this._events)t.call(u,f)&&d.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(u)):d},l.prototype.listeners=function(d){var u=r?r+d:d,f=this._events[u];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,m=f.length,v=new Array(m);h<m;h++)v[h]=f[h].fn;return v},l.prototype.listenerCount=function(d){var u=r?r+d:d,f=this._events[u];return f?f.fn?1:f.length:0},l.prototype.emit=function(d,u,f,h,m,v){var g=r?r+d:d;if(!this._events[g])return!1;var y=this._events[g],x=arguments.length,b,w;if(y.fn){switch(y.once&&this.removeListener(d,y.fn,void 0,!0),x){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,u),!0;case 3:return y.fn.call(y.context,u,f),!0;case 4:return y.fn.call(y.context,u,f,h),!0;case 5:return y.fn.call(y.context,u,f,h,m),!0;case 6:return y.fn.call(y.context,u,f,h,m,v),!0}for(w=1,b=new Array(x-1);w<x;w++)b[w-1]=arguments[w];y.fn.apply(y.context,b)}else{var j=y.length,_;for(w=0;w<j;w++)switch(y[w].once&&this.removeListener(d,y[w].fn,void 0,!0),x){case 1:y[w].fn.call(y[w].context);break;case 2:y[w].fn.call(y[w].context,u);break;case 3:y[w].fn.call(y[w].context,u,f);break;case 4:y[w].fn.call(y[w].context,u,f,h);break;default:if(!b)for(_=1,b=new Array(x-1);_<x;_++)b[_-1]=arguments[_];y[w].fn.apply(y[w].context,b)}}return!0},l.prototype.on=function(d,u,f){return o(this,d,u,f,!1)},l.prototype.once=function(d,u,f){return o(this,d,u,f,!0)},l.prototype.removeListener=function(d,u,f,h){var m=r?r+d:d;if(!this._events[m])return this;if(!u)return i(this,m),this;var v=this._events[m];if(v.fn)v.fn===u&&(!h||v.once)&&(!f||v.context===f)&&i(this,m);else{for(var g=0,y=[],x=v.length;g<x;g++)(v[g].fn!==u||h&&!v[g].once||f&&v[g].context!==f)&&y.push(v[g]);y.length?this._events[m]=y.length===1?y[0]:y:i(this,m)}return this},l.prototype.removeAllListeners=function(d){var u;return d?(u=r?r+d:d,this._events[u]&&i(this,u)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(hee);var v9e=hee.exports;const x9e=Ua(v9e);var uE=new x9e,fE="recharts.syncMouseEvents";function Hw(e){"@babel/helpers - typeof";return Hw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hw(e)}function y9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function az(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pee(n.key),n)}}function b9e(e,t,r){return t&&az(e.prototype,t),r&&az(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mE(e,t,r){return t=pee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pee(e){var t=w9e(e,"string");return Hw(t)=="symbol"?t:t+""}function w9e(e,t){if(Hw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var j9e=function(){function e(){y9e(this,e),mE(this,"activeIndex",0),mE(this,"coordinateList",[]),mE(this,"layout","horizontal")}return b9e(e,[{key:"setDetails",value:function(r){var n,s=r.coordinateList,o=s===void 0?null:s,i=r.container,l=i===void 0?null:i,c=r.layout,d=c===void 0?null:c,u=r.offset,f=u===void 0?null:u,h=r.mouseHandlerCallback,m=h===void 0?null:h;this.coordinateList=(n=o??this.coordinateList)!==null&&n!==void 0?n:[],this.container=l??this.container,this.layout=d??this.layout,this.offset=f??this.offset,this.mouseHandlerCallback=m??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var s=this.container.getBoundingClientRect(),o=s.x,i=s.y,l=s.height,c=this.coordinateList[this.activeIndex].coordinate,d=((r=window)===null||r===void 0?void 0:r.scrollX)||0,u=((n=window)===null||n===void 0?void 0:n.scrollY)||0,f=o+c+d,h=i+this.offset.top+l/2+u;this.mouseHandlerCallback({pageX:f,pageY:h})}}}])}();function _9e(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e?.[0],s=e?.[1];if(n&&s&&Xr(n)&&Xr(s))return!0}return!1}function N9e(e,t,r,n){var s=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-s:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-s,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function gee(e){var t=e.cx,r=e.cy,n=e.radius,s=e.startAngle,o=e.endAngle,i=Ps(t,r,n,s),l=Ps(t,r,n,o);return{points:[i,l],cx:t,cy:r,radius:n,startAngle:s,endAngle:o}}function S9e(e,t,r){var n,s,o,i;if(e==="horizontal")n=t.x,o=n,s=r.top,i=r.top+r.height;else if(e==="vertical")s=t.y,i=s,n=r.left,o=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var l=t.cx,c=t.cy,d=t.innerRadius,u=t.outerRadius,f=t.angle,h=Ps(l,c,d,f),m=Ps(l,c,u,f);n=h.x,s=h.y,o=m.x,i=m.y}else return gee(t);return[{x:n,y:s},{x:o,y:i}]}function Gw(e){"@babel/helpers - typeof";return Gw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gw(e)}function sz(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function vj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sz(Object(r),!0).forEach(function(n){C9e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sz(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function C9e(e,t,r){return t=P9e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P9e(e){var t=A9e(e,"string");return Gw(t)=="symbol"?t:t+""}function A9e(e,t){if(Gw(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gw(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function E9e(e){var t,r,n=e.element,s=e.tooltipEventType,o=e.isActive,i=e.activeCoordinate,l=e.activePayload,c=e.offset,d=e.activeTooltipIndex,u=e.tooltipAxisBandSize,f=e.layout,h=e.chartName,m=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!m||!o||!i||h!=="ScatterChart"&&s!=="axis")return null;var v,g=rg;if(h==="ScatterChart")v=i,g=U6e;else if(h==="BarChart")v=N9e(f,i,c,u),g=NM;else if(f==="radial"){var y=gee(i),x=y.cx,b=y.cy,w=y.radius,j=y.startAngle,_=y.endAngle;v={cx:x,cy:b,startAngle:j,endAngle:_,innerRadius:w,outerRadius:w},g=_M}else v={points:S9e(f,i,c)},g=rg;var S=vj(vj(vj(vj({stroke:"#ccc",pointerEvents:"none"},c),v),Bn(m,!1)),{},{payload:l,payloadIndex:d,className:fa("recharts-tooltip-cursor",m.className)});return p.isValidElement(m)?p.cloneElement(m,S):p.createElement(g,S)}var k9e=["item"],I9e=["children","className","width","height","style","compact","title","desc"];function l0(e){"@babel/helpers - typeof";return l0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l0(e)}function Zv(){return Zv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zv.apply(this,arguments)}function oz(e,t){return D9e(e)||T9e(e,t)||xee(e,t)||O9e()}function O9e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function T9e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function D9e(e){if(Array.isArray(e))return e}function iz(e,t){if(e==null)return{};var r=M9e(e,t),n,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function M9e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function R9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yee(n.key),n)}}function L9e(e,t,r){return t&&lz(e.prototype,t),r&&lz(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function F9e(e,t,r){return t=xS(t),$9e(e,vee()?Reflect.construct(t,r||[],xS(e).constructor):t.apply(e,r))}function $9e(e,t){if(t&&(l0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return B9e(e)}function B9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vee=function(){return!!e})()}function xS(e){return xS=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},xS(e)}function q9e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&NT(e,t)}function NT(e,t){return NT=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},NT(e,t)}function c0(e){return V9e(e)||U9e(e)||xee(e)||z9e()}function z9e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xee(e,t){if(e){if(typeof e=="string")return ST(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ST(e,t)}}function U9e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function V9e(e){if(Array.isArray(e))return ST(e)}function ST(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cz(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Nr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cz(Object(r),!0).forEach(function(n){Jn(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cz(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Jn(e,t,r){return t=yee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yee(e){var t=W9e(e,"string");return l0(t)=="symbol"?t:t+""}function W9e(e,t){if(l0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(l0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var H9e={xAxis:["bottom","top"],yAxis:["left","right"]},G9e={width:"100%",height:"100%"},bee={x:0,y:0};function xj(e){return e}var K9e=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},X9e=function(t,r,n,s){var o=r.find(function(u){return u&&u.index===n});if(o){if(t==="horizontal")return{x:o.coordinate,y:s.y};if(t==="vertical")return{x:s.x,y:o.coordinate};if(t==="centric"){var i=o.coordinate,l=s.radius;return Nr(Nr(Nr({},s),Ps(s.cx,s.cy,l,i)),{},{angle:i,radius:l})}var c=o.coordinate,d=s.angle;return Nr(Nr(Nr({},s),Ps(s.cx,s.cy,c,d)),{},{angle:d,radius:c})}return bee},T5=function(t,r){var n=r.graphicalItems,s=r.dataStartIndex,o=r.dataEndIndex,i=(n??[]).reduce(function(l,c){var d=c.props.data;return d&&d.length?[].concat(c0(l),c0(d)):l},[]);return i.length>0?i:t&&t.length&&Xr(s)&&Xr(o)?t.slice(s,o+1):[]};function wee(e){return e==="number"?[0,"auto"]:void 0}var CT=function(t,r,n,s){var o=t.graphicalItems,i=t.tooltipAxis,l=T5(r,t);return n<0||!o||!o.length||n>=l.length?null:o.reduce(function(c,d){var u,f=(u=d.props.data)!==null&&u!==void 0?u:r;f&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(f=f.slice(t.dataStartIndex,t.dataEndIndex+1));var h;if(i.dataKey&&!i.allowDuplicatedCategory){var m=f===void 0?l:f;h=pN(m,i.dataKey,s)}else h=f&&f[n]||l[n];return h?[].concat(c0(c),[nZ(d,h)]):c},[])},dz=function(t,r,n,s){var o=s||{x:t.chartX,y:t.chartY},i=K9e(o,n),l=t.orderedTooltipTicks,c=t.tooltipAxis,d=t.tooltipTicks,u=hLe(i,l,d,c);if(u>=0&&d){var f=d[u]&&d[u].value,h=CT(t,r,u,f),m=X9e(n,l,u,o);return{activeTooltipIndex:u,activeLabel:f,activePayload:h,activeCoordinate:m}}return null},Y9e=function(t,r){var n=r.axes,s=r.graphicalItems,o=r.axisType,i=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.layout,f=t.children,h=t.stackOffset,m=JQ(u,o);return n.reduce(function(v,g){var y,x=g.type.defaultProps!==void 0?Nr(Nr({},g.type.defaultProps),g.props):g.props,b=x.type,w=x.dataKey,j=x.allowDataOverflow,_=x.allowDuplicatedCategory,S=x.scale,C=x.ticks,P=x.includeHidden,A=x[i];if(v[A])return v;var R=T5(t.data,{graphicalItems:s.filter(function(V){var B,Q=i in V.props?V.props[i]:(B=V.type.defaultProps)===null||B===void 0?void 0:B[i];return Q===A}),dataStartIndex:c,dataEndIndex:d}),O=R.length,I,M,D;_9e(x.domain,j,b)&&(I=$O(x.domain,null,j),m&&(b==="number"||S!=="auto")&&(D=pb(R,w,"category")));var U=wee(b);if(!I||I.length===0){var z,W=(z=x.domain)!==null&&z!==void 0?z:U;if(w){if(I=pb(R,w,b),b==="category"&&m){var $=iSe(I);_&&$?(M=I,I=nS(0,O)):_||(I=jq(W,I,g).reduce(function(V,B){return V.indexOf(B)>=0?V:[].concat(c0(V),[B])},[]))}else if(b==="category")_?I=I.filter(function(V){return V!==""&&!la(V)}):I=jq(W,I,g).reduce(function(V,B){return V.indexOf(B)>=0||B===""||la(B)?V:[].concat(c0(V),[B])},[]);else if(b==="number"){var X=yLe(R,s.filter(function(V){var B,Q,pe=i in V.props?V.props[i]:(B=V.type.defaultProps)===null||B===void 0?void 0:B[i],te="hide"in V.props?V.props.hide:(Q=V.type.defaultProps)===null||Q===void 0?void 0:Q.hide;return pe===A&&(P||!te)}),w,o,u);X&&(I=X)}m&&(b==="number"||S!=="auto")&&(D=pb(R,w,"category"))}else m?I=nS(0,O):l&&l[A]&&l[A].hasStack&&b==="number"?I=h==="expand"?[0,1]:rZ(l[A].stackGroups,c,d):I=YQ(R,s.filter(function(V){var B=i in V.props?V.props[i]:V.type.defaultProps[i],Q="hide"in V.props?V.props.hide:V.type.defaultProps.hide;return B===A&&(P||!Q)}),b,u,!0);if(b==="number")I=_T(f,I,A,o,C),W&&(I=$O(W,I,j));else if(b==="category"&&W){var ye=W,Se=I.every(function(V){return ye.indexOf(V)>=0});Se&&(I=ye)}}return Nr(Nr({},v),{},Jn({},A,Nr(Nr({},x),{},{axisType:o,domain:I,categoricalDomain:D,duplicateDomain:M,originalDomain:(y=x.domain)!==null&&y!==void 0?y:U,isCategorical:m,layout:u})))},{})},J9e=function(t,r){var n=r.graphicalItems,s=r.Axis,o=r.axisType,i=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.layout,f=t.children,h=T5(t.data,{graphicalItems:n,dataStartIndex:c,dataEndIndex:d}),m=h.length,v=JQ(u,o),g=-1;return n.reduce(function(y,x){var b=x.type.defaultProps!==void 0?Nr(Nr({},x.type.defaultProps),x.props):x.props,w=b[i],j=wee("number");if(!y[w]){g++;var _;return v?_=nS(0,m):l&&l[w]&&l[w].hasStack?(_=rZ(l[w].stackGroups,c,d),_=_T(f,_,w,o)):(_=$O(j,YQ(h,n.filter(function(S){var C,P,A=i in S.props?S.props[i]:(C=S.type.defaultProps)===null||C===void 0?void 0:C[i],R="hide"in S.props?S.props.hide:(P=S.type.defaultProps)===null||P===void 0?void 0:P.hide;return A===w&&!R}),"number",u),s.defaultProps.allowDataOverflow),_=_T(f,_,w,o)),Nr(Nr({},y),{},Jn({},w,Nr(Nr({axisType:o},s.defaultProps),{},{hide:!0,orientation:zc(H9e,"".concat(o,".").concat(g%2),null),domain:_,originalDomain:j,isCategorical:v,layout:u})))}return y},{})},Q9e=function(t,r){var n=r.axisType,s=n===void 0?"xAxis":n,o=r.AxisComp,i=r.graphicalItems,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.children,f="".concat(s,"Id"),h=Uc(u,o),m={};return h&&h.length?m=Y9e(t,{axes:h,graphicalItems:i,axisType:s,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:d}):i&&i.length&&(m=J9e(t,{Axis:o,graphicalItems:i,axisType:s,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:d})),m},Z9e=function(t){var r=Wm(t),n=Ff(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:YD(n,function(s){return s.coordinate}),tooltipAxis:r,tooltipAxisBandSize:VN(r,n)}},uz=function(t){var r=t.children,n=t.defaultShowTooltip,s=Ac(r,Qx),o=0,i=0;return t.data&&t.data.length!==0&&(i=t.data.length-1),s&&s.props&&(s.props.startIndex>=0&&(o=s.props.startIndex),s.props.endIndex>=0&&(i=s.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:o,dataEndIndex:i,activeTooltipIndex:-1,isTooltipActive:!!n}},eUe=function(t){return!t||!t.length?!1:t.some(function(r){var n=Uf(r&&r.type);return n&&n.indexOf("Bar")>=0})},fz=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},tUe=function(t,r){var n=t.props,s=t.graphicalItems,o=t.xAxisMap,i=o===void 0?{}:o,l=t.yAxisMap,c=l===void 0?{}:l,d=n.width,u=n.height,f=n.children,h=n.margin||{},m=Ac(f,Qx),v=Ac(f,Zp),g=Object.keys(c).reduce(function(_,S){var C=c[S],P=C.orientation;return!C.mirror&&!C.hide?Nr(Nr({},_),{},Jn({},P,_[P]+C.width)):_},{left:h.left||0,right:h.right||0}),y=Object.keys(i).reduce(function(_,S){var C=i[S],P=C.orientation;return!C.mirror&&!C.hide?Nr(Nr({},_),{},Jn({},P,zc(_,"".concat(P))+C.height)):_},{top:h.top||0,bottom:h.bottom||0}),x=Nr(Nr({},y),g),b=x.bottom;m&&(x.bottom+=m.props.height||Qx.defaultProps.height),v&&r&&(x=vLe(x,s,n,r));var w=d-x.left-x.right,j=u-x.top-x.bottom;return Nr(Nr({brushBottom:b},x),{},{width:Math.max(w,0),height:Math.max(j,0)})},rUe=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},D5=function(t){var r=t.chartName,n=t.GraphicalChild,s=t.defaultTooltipEventType,o=s===void 0?"axis":s,i=t.validateTooltipEventTypes,l=i===void 0?["axis"]:i,c=t.axisComponents,d=t.legendContent,u=t.formatAxisMap,f=t.defaultProps,h=function(x,b){var w=b.graphicalItems,j=b.stackGroups,_=b.offset,S=b.updateId,C=b.dataStartIndex,P=b.dataEndIndex,A=x.barSize,R=x.layout,O=x.barGap,I=x.barCategoryGap,M=x.maxBarSize,D=fz(R),U=D.numericAxisName,z=D.cateAxisName,W=eUe(w),$=[];return w.forEach(function(X,ye){var Se=T5(x.data,{graphicalItems:[X],dataStartIndex:C,dataEndIndex:P}),V=X.type.defaultProps!==void 0?Nr(Nr({},X.type.defaultProps),X.props):X.props,B=V.dataKey,Q=V.maxBarSize,pe=V["".concat(U,"Id")],te=V["".concat(z,"Id")],Y={},ce=c.reduce(function(ht,Wt){var be=b["".concat(Wt.axisType,"Map")],Ct=V["".concat(Wt.axisType,"Id")];be&&be[Ct]||Wt.axisType==="zAxis"||Rh(!1);var wt=be[Ct];return Nr(Nr({},ht),{},Jn(Jn({},Wt.axisType,wt),"".concat(Wt.axisType,"Ticks"),Ff(wt)))},Y),me=ce[z],ae=ce["".concat(z,"Ticks")],le=j&&j[pe]&&j[pe].hasStack&&ALe(X,j[pe].stackGroups),ue=Uf(X.type).indexOf("Bar")>=0,Re=VN(me,ae),ne=[],ie=W&&pLe({barSize:A,stackGroups:j,totalSize:rUe(ce,z)});if(ue){var gt,bt,at=la(Q)?M:Q,xt=(gt=(bt=VN(me,ae,!0))!==null&&bt!==void 0?bt:at)!==null&&gt!==void 0?gt:0;ne=gLe({barGap:O,barCategoryGap:I,bandSize:xt!==Re?xt:Re,sizeList:ie[te],maxBarSize:at}),xt!==Re&&(ne=ne.map(function(ht){return Nr(Nr({},ht),{},{position:Nr(Nr({},ht.position),{},{offset:ht.position.offset-xt/2})})}))}var Ze=X&&X.type&&X.type.getComposedData;Ze&&$.push({props:Nr(Nr({},Ze(Nr(Nr({},ce),{},{displayedData:Se,props:x,dataKey:B,item:X,bandSize:Re,barPosition:ne,offset:_,stackedData:le,layout:R,dataStartIndex:C,dataEndIndex:P}))),{},Jn(Jn(Jn({key:X.key||"item-".concat(ye)},U,ce[U]),z,ce[z]),"animationId",S)),childIndex:ySe(X,x.children),item:X})}),$},m=function(x,b){var w=x.props,j=x.dataStartIndex,_=x.dataEndIndex,S=x.updateId;if(!f8({props:w}))return null;var C=w.children,P=w.layout,A=w.stackOffset,R=w.data,O=w.reverseStackOrder,I=fz(P),M=I.numericAxisName,D=I.cateAxisName,U=Uc(C,n),z=CLe(R,U,"".concat(M,"Id"),"".concat(D,"Id"),A,O),W=c.reduce(function(V,B){var Q="".concat(B.axisType,"Map");return Nr(Nr({},V),{},Jn({},Q,Q9e(w,Nr(Nr({},B),{},{graphicalItems:U,stackGroups:B.axisType===M&&z,dataStartIndex:j,dataEndIndex:_}))))},{}),$=tUe(Nr(Nr({},W),{},{props:w,graphicalItems:U}),b?.legendBBox);Object.keys(W).forEach(function(V){W[V]=u(w,W[V],$,V.replace("Map",""),r)});var X=W["".concat(D,"Map")],ye=Z9e(X),Se=h(w,Nr(Nr({},W),{},{dataStartIndex:j,dataEndIndex:_,updateId:S,graphicalItems:U,stackGroups:z,offset:$}));return Nr(Nr({formattedGraphicalItems:Se,graphicalItems:U,offset:$,stackGroups:z},ye),W)},v=function(y){function x(b){var w,j,_;return R9e(this,x),_=F9e(this,x,[b]),Jn(_,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Jn(_,"accessibilityManager",new j9e),Jn(_,"handleLegendBBoxUpdate",function(S){if(S){var C=_.state,P=C.dataStartIndex,A=C.dataEndIndex,R=C.updateId;_.setState(Nr({legendBBox:S},m({props:_.props,dataStartIndex:P,dataEndIndex:A,updateId:R},Nr(Nr({},_.state),{},{legendBBox:S}))))}}),Jn(_,"handleReceiveSyncEvent",function(S,C,P){if(_.props.syncId===S){if(P===_.eventEmitterSymbol&&typeof _.props.syncMethod!="function")return;_.applySyncEvent(C)}}),Jn(_,"handleBrushChange",function(S){var C=S.startIndex,P=S.endIndex;if(C!==_.state.dataStartIndex||P!==_.state.dataEndIndex){var A=_.state.updateId;_.setState(function(){return Nr({dataStartIndex:C,dataEndIndex:P},m({props:_.props,dataStartIndex:C,dataEndIndex:P,updateId:A},_.state))}),_.triggerSyncEvent({dataStartIndex:C,dataEndIndex:P})}}),Jn(_,"handleMouseEnter",function(S){var C=_.getMouseInfo(S);if(C){var P=Nr(Nr({},C),{},{isTooltipActive:!0});_.setState(P),_.triggerSyncEvent(P);var A=_.props.onMouseEnter;Zn(A)&&A(P,S)}}),Jn(_,"triggeredAfterMouseMove",function(S){var C=_.getMouseInfo(S),P=C?Nr(Nr({},C),{},{isTooltipActive:!0}):{isTooltipActive:!1};_.setState(P),_.triggerSyncEvent(P);var A=_.props.onMouseMove;Zn(A)&&A(P,S)}),Jn(_,"handleItemMouseEnter",function(S){_.setState(function(){return{isTooltipActive:!0,activeItem:S,activePayload:S.tooltipPayload,activeCoordinate:S.tooltipPosition||{x:S.cx,y:S.cy}}})}),Jn(_,"handleItemMouseLeave",function(){_.setState(function(){return{isTooltipActive:!1}})}),Jn(_,"handleMouseMove",function(S){S.persist(),_.throttleTriggeredAfterMouseMove(S)}),Jn(_,"handleMouseLeave",function(S){_.throttleTriggeredAfterMouseMove.cancel();var C={isTooltipActive:!1};_.setState(C),_.triggerSyncEvent(C);var P=_.props.onMouseLeave;Zn(P)&&P(C,S)}),Jn(_,"handleOuterEvent",function(S){var C=xSe(S),P=zc(_.props,"".concat(C));if(C&&Zn(P)){var A,R;/.*touch.*/i.test(C)?R=_.getMouseInfo(S.changedTouches[0]):R=_.getMouseInfo(S),P((A=R)!==null&&A!==void 0?A:{},S)}}),Jn(_,"handleClick",function(S){var C=_.getMouseInfo(S);if(C){var P=Nr(Nr({},C),{},{isTooltipActive:!0});_.setState(P),_.triggerSyncEvent(P);var A=_.props.onClick;Zn(A)&&A(P,S)}}),Jn(_,"handleMouseDown",function(S){var C=_.props.onMouseDown;if(Zn(C)){var P=_.getMouseInfo(S);C(P,S)}}),Jn(_,"handleMouseUp",function(S){var C=_.props.onMouseUp;if(Zn(C)){var P=_.getMouseInfo(S);C(P,S)}}),Jn(_,"handleTouchMove",function(S){S.changedTouches!=null&&S.changedTouches.length>0&&_.throttleTriggeredAfterMouseMove(S.changedTouches[0])}),Jn(_,"handleTouchStart",function(S){S.changedTouches!=null&&S.changedTouches.length>0&&_.handleMouseDown(S.changedTouches[0])}),Jn(_,"handleTouchEnd",function(S){S.changedTouches!=null&&S.changedTouches.length>0&&_.handleMouseUp(S.changedTouches[0])}),Jn(_,"handleDoubleClick",function(S){var C=_.props.onDoubleClick;if(Zn(C)){var P=_.getMouseInfo(S);C(P,S)}}),Jn(_,"handleContextMenu",function(S){var C=_.props.onContextMenu;if(Zn(C)){var P=_.getMouseInfo(S);C(P,S)}}),Jn(_,"triggerSyncEvent",function(S){_.props.syncId!==void 0&&uE.emit(fE,_.props.syncId,S,_.eventEmitterSymbol)}),Jn(_,"applySyncEvent",function(S){var C=_.props,P=C.layout,A=C.syncMethod,R=_.state.updateId,O=S.dataStartIndex,I=S.dataEndIndex;if(S.dataStartIndex!==void 0||S.dataEndIndex!==void 0)_.setState(Nr({dataStartIndex:O,dataEndIndex:I},m({props:_.props,dataStartIndex:O,dataEndIndex:I,updateId:R},_.state)));else if(S.activeTooltipIndex!==void 0){var M=S.chartX,D=S.chartY,U=S.activeTooltipIndex,z=_.state,W=z.offset,$=z.tooltipTicks;if(!W)return;if(typeof A=="function")U=A($,S);else if(A==="value"){U=-1;for(var X=0;X<$.length;X++)if($[X].value===S.activeLabel){U=X;break}}var ye=Nr(Nr({},W),{},{x:W.left,y:W.top}),Se=Math.min(M,ye.x+ye.width),V=Math.min(D,ye.y+ye.height),B=$[U]&&$[U].value,Q=CT(_.state,_.props.data,U),pe=$[U]?{x:P==="horizontal"?$[U].coordinate:Se,y:P==="horizontal"?V:$[U].coordinate}:bee;_.setState(Nr(Nr({},S),{},{activeLabel:B,activeCoordinate:pe,activePayload:Q,activeTooltipIndex:U}))}else _.setState(S)}),Jn(_,"renderCursor",function(S){var C,P=_.state,A=P.isTooltipActive,R=P.activeCoordinate,O=P.activePayload,I=P.offset,M=P.activeTooltipIndex,D=P.tooltipAxisBandSize,U=_.getTooltipEventType(),z=(C=S.props.active)!==null&&C!==void 0?C:A,W=_.props.layout,$=S.key||"_recharts-cursor";return Pe.createElement(E9e,{key:$,activeCoordinate:R,activePayload:O,activeTooltipIndex:M,chartName:r,element:S,isActive:z,layout:W,offset:I,tooltipAxisBandSize:D,tooltipEventType:U})}),Jn(_,"renderPolarAxis",function(S,C,P){var A=zc(S,"type.axisType"),R=zc(_.state,"".concat(A,"Map")),O=S.type.defaultProps,I=O!==void 0?Nr(Nr({},O),S.props):S.props,M=R&&R[I["".concat(A,"Id")]];return p.cloneElement(S,Nr(Nr({},M),{},{className:fa(A,M.className),key:S.key||"".concat(C,"-").concat(P),ticks:Ff(M,!0)}))}),Jn(_,"renderPolarGrid",function(S){var C=S.props,P=C.radialLines,A=C.polarAngles,R=C.polarRadius,O=_.state,I=O.radiusAxisMap,M=O.angleAxisMap,D=Wm(I),U=Wm(M),z=U.cx,W=U.cy,$=U.innerRadius,X=U.outerRadius;return p.cloneElement(S,{polarAngles:Array.isArray(A)?A:Ff(U,!0).map(function(ye){return ye.coordinate}),polarRadius:Array.isArray(R)?R:Ff(D,!0).map(function(ye){return ye.coordinate}),cx:z,cy:W,innerRadius:$,outerRadius:X,key:S.key||"polar-grid",radialLines:P})}),Jn(_,"renderLegend",function(){var S=_.state.formattedGraphicalItems,C=_.props,P=C.children,A=C.width,R=C.height,O=_.props.margin||{},I=A-(O.left||0)-(O.right||0),M=KQ({children:P,formattedGraphicalItems:S,legendWidth:I,legendContent:d});if(!M)return null;var D=M.item,U=iz(M,k9e);return p.cloneElement(D,Nr(Nr({},U),{},{chartWidth:A,chartHeight:R,margin:O,onBBoxUpdate:_.handleLegendBBoxUpdate}))}),Jn(_,"renderTooltip",function(){var S,C=_.props,P=C.children,A=C.accessibilityLayer,R=Ac(P,Xl);if(!R)return null;var O=_.state,I=O.isTooltipActive,M=O.activeCoordinate,D=O.activePayload,U=O.activeLabel,z=O.offset,W=(S=R.props.active)!==null&&S!==void 0?S:I;return p.cloneElement(R,{viewBox:Nr(Nr({},z),{},{x:z.left,y:z.top}),active:W,label:U,payload:W?D:[],coordinate:M,accessibilityLayer:A})}),Jn(_,"renderBrush",function(S){var C=_.props,P=C.margin,A=C.data,R=_.state,O=R.offset,I=R.dataStartIndex,M=R.dataEndIndex,D=R.updateId;return p.cloneElement(S,{key:S.key||"_recharts-brush",onChange:mj(_.handleBrushChange,S.props.onChange),data:A,x:Xr(S.props.x)?S.props.x:O.left,y:Xr(S.props.y)?S.props.y:O.top+O.height+O.brushBottom-(P.bottom||0),width:Xr(S.props.width)?S.props.width:O.width,startIndex:I,endIndex:M,updateId:"brush-".concat(D)})}),Jn(_,"renderReferenceElement",function(S,C,P){if(!S)return null;var A=_,R=A.clipPathId,O=_.state,I=O.xAxisMap,M=O.yAxisMap,D=O.offset,U=S.type.defaultProps||{},z=S.props,W=z.xAxisId,$=W===void 0?U.xAxisId:W,X=z.yAxisId,ye=X===void 0?U.yAxisId:X;return p.cloneElement(S,{key:S.key||"".concat(C,"-").concat(P),xAxis:I[$],yAxis:M[ye],viewBox:{x:D.left,y:D.top,width:D.width,height:D.height},clipPathId:R})}),Jn(_,"renderActivePoints",function(S){var C=S.item,P=S.activePoint,A=S.basePoint,R=S.childIndex,O=S.isRange,I=[],M=C.props.key,D=C.item.type.defaultProps!==void 0?Nr(Nr({},C.item.type.defaultProps),C.item.props):C.item.props,U=D.activeDot,z=D.dataKey,W=Nr(Nr({index:R,dataKey:z,cx:P.x,cy:P.y,r:4,fill:jM(C.item),strokeWidth:2,stroke:"#fff",payload:P.payload,value:P.value},Bn(U,!1)),gN(U));return I.push(x.renderActiveDot(U,W,"".concat(M,"-activePoint-").concat(R))),A?I.push(x.renderActiveDot(U,Nr(Nr({},W),{},{cx:A.x,cy:A.y}),"".concat(M,"-basePoint-").concat(R))):O&&I.push(null),I}),Jn(_,"renderGraphicChild",function(S,C,P){var A=_.filterFormatItem(S,C,P);if(!A)return null;var R=_.getTooltipEventType(),O=_.state,I=O.isTooltipActive,M=O.tooltipAxis,D=O.activeTooltipIndex,U=O.activeLabel,z=_.props.children,W=Ac(z,Xl),$=A.props,X=$.points,ye=$.isRange,Se=$.baseLine,V=A.item.type.defaultProps!==void 0?Nr(Nr({},A.item.type.defaultProps),A.item.props):A.item.props,B=V.activeDot,Q=V.hide,pe=V.activeBar,te=V.activeShape,Y=!!(!Q&&I&&W&&(B||pe||te)),ce={};R!=="axis"&&W&&W.props.trigger==="click"?ce={onClick:mj(_.handleItemMouseEnter,S.props.onClick)}:R!=="axis"&&(ce={onMouseLeave:mj(_.handleItemMouseLeave,S.props.onMouseLeave),onMouseEnter:mj(_.handleItemMouseEnter,S.props.onMouseEnter)});var me=p.cloneElement(S,Nr(Nr({},A.props),ce));function ae(Wt){return typeof M.dataKey=="function"?M.dataKey(Wt.payload):null}if(Y)if(D>=0){var le,ue;if(M.dataKey&&!M.allowDuplicatedCategory){var Re=typeof M.dataKey=="function"?ae:"payload.".concat(M.dataKey.toString());le=pN(X,Re,U),ue=ye&&Se&&pN(Se,Re,U)}else le=X?.[D],ue=ye&&Se&&Se[D];if(te||pe){var ne=S.props.activeIndex!==void 0?S.props.activeIndex:D;return[p.cloneElement(S,Nr(Nr(Nr({},A.props),ce),{},{activeIndex:ne})),null,null]}if(!la(le))return[me].concat(c0(_.renderActivePoints({item:A,activePoint:le,basePoint:ue,childIndex:D,isRange:ye})))}else{var ie,gt=(ie=_.getItemByXY(_.state.activeCoordinate))!==null&&ie!==void 0?ie:{graphicalItem:me},bt=gt.graphicalItem,at=bt.item,xt=at===void 0?S:at,Ze=bt.childIndex,ht=Nr(Nr(Nr({},A.props),ce),{},{activeIndex:Ze});return[p.cloneElement(xt,ht),null,null]}return ye?[me,null,null]:[me,null]}),Jn(_,"renderCustomized",function(S,C,P){return p.cloneElement(S,Nr(Nr({key:"recharts-customized-".concat(P)},_.props),_.state))}),Jn(_,"renderMap",{CartesianGrid:{handler:xj,once:!0},ReferenceArea:{handler:_.renderReferenceElement},ReferenceLine:{handler:xj},ReferenceDot:{handler:_.renderReferenceElement},XAxis:{handler:xj},YAxis:{handler:xj},Brush:{handler:_.renderBrush,once:!0},Bar:{handler:_.renderGraphicChild},Line:{handler:_.renderGraphicChild},Area:{handler:_.renderGraphicChild},Radar:{handler:_.renderGraphicChild},RadialBar:{handler:_.renderGraphicChild},Scatter:{handler:_.renderGraphicChild},Pie:{handler:_.renderGraphicChild},Funnel:{handler:_.renderGraphicChild},Tooltip:{handler:_.renderCursor,once:!0},PolarGrid:{handler:_.renderPolarGrid,once:!0},PolarAngleAxis:{handler:_.renderPolarAxis},PolarRadiusAxis:{handler:_.renderPolarAxis},Customized:{handler:_.renderCustomized}}),_.clipPathId="".concat((w=b.id)!==null&&w!==void 0?w:Fg("recharts"),"-clip"),_.throttleTriggeredAfterMouseMove=GJ(_.triggeredAfterMouseMove,(j=b.throttleDelay)!==null&&j!==void 0?j:1e3/60),_.state={},_}return q9e(x,y),L9e(x,[{key:"componentDidMount",value:function(){var w,j;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(w=this.props.margin.left)!==null&&w!==void 0?w:0,top:(j=this.props.margin.top)!==null&&j!==void 0?j:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var w=this.props,j=w.children,_=w.data,S=w.height,C=w.layout,P=Ac(j,Xl);if(P){var A=P.props.defaultIndex;if(!(typeof A!="number"||A<0||A>this.state.tooltipTicks.length-1)){var R=this.state.tooltipTicks[A]&&this.state.tooltipTicks[A].value,O=CT(this.state,_,A,R),I=this.state.tooltipTicks[A].coordinate,M=(this.state.offset.top+S)/2,D=C==="horizontal",U=D?{x:I,y:M}:{y:I,x:M},z=this.state.formattedGraphicalItems.find(function($){var X=$.item;return X.type.name==="Scatter"});z&&(U=Nr(Nr({},U),z.props.points[A].tooltipPosition),O=z.props.points[A].tooltipPayload);var W={activeTooltipIndex:A,isTooltipActive:!0,activeLabel:R,activePayload:O,activeCoordinate:U};this.setState(W),this.renderCursor(P),this.accessibilityManager.setIndex(A)}}}},{key:"getSnapshotBeforeUpdate",value:function(w,j){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==j.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==w.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==w.margin){var _,S;this.accessibilityManager.setDetails({offset:{left:(_=this.props.margin.left)!==null&&_!==void 0?_:0,top:(S=this.props.margin.top)!==null&&S!==void 0?S:0}})}return null}},{key:"componentDidUpdate",value:function(w){eO([Ac(w.children,Xl)],[Ac(this.props.children,Xl)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var w=Ac(this.props.children,Xl);if(w&&typeof w.props.shared=="boolean"){var j=w.props.shared?"axis":"item";return l.indexOf(j)>=0?j:o}return o}},{key:"getMouseInfo",value:function(w){if(!this.container)return null;var j=this.container,_=j.getBoundingClientRect(),S=z3e(_),C={chartX:Math.round(w.pageX-S.left),chartY:Math.round(w.pageY-S.top)},P=_.width/j.offsetWidth||1,A=this.inRange(C.chartX,C.chartY,P);if(!A)return null;var R=this.state,O=R.xAxisMap,I=R.yAxisMap,M=this.getTooltipEventType(),D=dz(this.state,this.props.data,this.props.layout,A);if(M!=="axis"&&O&&I){var U=Wm(O).scale,z=Wm(I).scale,W=U&&U.invert?U.invert(C.chartX):null,$=z&&z.invert?z.invert(C.chartY):null;return Nr(Nr({},C),{},{xValue:W,yValue:$},D)}return D?Nr(Nr({},C),D):null}},{key:"inRange",value:function(w,j){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,S=this.props.layout,C=w/_,P=j/_;if(S==="horizontal"||S==="vertical"){var A=this.state.offset,R=C>=A.left&&C<=A.left+A.width&&P>=A.top&&P<=A.top+A.height;return R?{x:C,y:P}:null}var O=this.state,I=O.angleAxisMap,M=O.radiusAxisMap;if(I&&M){var D=Wm(I);return Sq({x:C,y:P},D)}return null}},{key:"parseEventsOfWrapper",value:function(){var w=this.props.children,j=this.getTooltipEventType(),_=Ac(w,Xl),S={};_&&j==="axis"&&(_.props.trigger==="click"?S={onClick:this.handleClick}:S={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var C=gN(this.props,this.handleOuterEvent);return Nr(Nr({},C),S)}},{key:"addListener",value:function(){uE.on(fE,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){uE.removeListener(fE,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(w,j,_){for(var S=this.state.formattedGraphicalItems,C=0,P=S.length;C<P;C++){var A=S[C];if(A.item===w||A.props.key===w.key||j===Uf(A.item.type)&&_===A.childIndex)return A}return null}},{key:"renderClipPath",value:function(){var w=this.clipPathId,j=this.state.offset,_=j.left,S=j.top,C=j.height,P=j.width;return Pe.createElement("defs",null,Pe.createElement("clipPath",{id:w},Pe.createElement("rect",{x:_,y:S,height:C,width:P})))}},{key:"getXScales",value:function(){var w=this.state.xAxisMap;return w?Object.entries(w).reduce(function(j,_){var S=oz(_,2),C=S[0],P=S[1];return Nr(Nr({},j),{},Jn({},C,P.scale))},{}):null}},{key:"getYScales",value:function(){var w=this.state.yAxisMap;return w?Object.entries(w).reduce(function(j,_){var S=oz(_,2),C=S[0],P=S[1];return Nr(Nr({},j),{},Jn({},C,P.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(w){var j;return(j=this.state.xAxisMap)===null||j===void 0||(j=j[w])===null||j===void 0?void 0:j.scale}},{key:"getYScaleByAxisId",value:function(w){var j;return(j=this.state.yAxisMap)===null||j===void 0||(j=j[w])===null||j===void 0?void 0:j.scale}},{key:"getItemByXY",value:function(w){var j=this.state,_=j.formattedGraphicalItems,S=j.activeItem;if(_&&_.length)for(var C=0,P=_.length;C<P;C++){var A=_[C],R=A.props,O=A.item,I=O.type.defaultProps!==void 0?Nr(Nr({},O.type.defaultProps),O.props):O.props,M=Uf(O.type);if(M==="Bar"){var D=(R.data||[]).find(function($){return _6e(w,$)});if(D)return{graphicalItem:A,payload:D}}else if(M==="RadialBar"){var U=(R.data||[]).find(function($){return Sq(w,$)});if(U)return{graphicalItem:A,payload:U}}else if(C5(A,S)||P5(A,S)||qw(A,S)){var z=uBe({graphicalItem:A,activeTooltipItem:S,itemData:I.data}),W=I.activeIndex===void 0?z:I.activeIndex;return{graphicalItem:Nr(Nr({},A),{},{childIndex:W}),payload:qw(A,S)?I.data[z]:A.props.data[z]}}}return null}},{key:"render",value:function(){var w=this;if(!f8(this))return null;var j=this.props,_=j.children,S=j.className,C=j.width,P=j.height,A=j.style,R=j.compact,O=j.title,I=j.desc,M=iz(j,I9e),D=Bn(M,!1);if(R)return Pe.createElement(D7,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Pe.createElement(rO,Zv({},D,{width:C,height:P,title:O,desc:I}),this.renderClipPath(),h8(_,this.renderMap)));if(this.props.accessibilityLayer){var U,z;D.tabIndex=(U=this.props.tabIndex)!==null&&U!==void 0?U:0,D.role=(z=this.props.role)!==null&&z!==void 0?z:"application",D.onKeyDown=function($){w.accessibilityManager.keyboardEvent($)},D.onFocus=function(){w.accessibilityManager.focus()}}var W=this.parseEventsOfWrapper();return Pe.createElement(D7,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},Pe.createElement("div",Zv({className:fa("recharts-wrapper",S),style:Nr({position:"relative",cursor:"default",width:C,height:P},A)},W,{ref:function(X){w.container=X}}),Pe.createElement(rO,Zv({},D,{width:C,height:P,title:O,desc:I,style:G9e}),this.renderClipPath(),h8(_,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(p.Component);Jn(v,"displayName",r),Jn(v,"defaultProps",Nr({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},f)),Jn(v,"getDerivedStateFromProps",function(y,x){var b=y.dataKey,w=y.data,j=y.children,_=y.width,S=y.height,C=y.layout,P=y.stackOffset,A=y.margin,R=x.dataStartIndex,O=x.dataEndIndex;if(x.updateId===void 0){var I=uz(y);return Nr(Nr(Nr({},I),{},{updateId:0},m(Nr(Nr({props:y},I),{},{updateId:0}),x)),{},{prevDataKey:b,prevData:w,prevWidth:_,prevHeight:S,prevLayout:C,prevStackOffset:P,prevMargin:A,prevChildren:j})}if(b!==x.prevDataKey||w!==x.prevData||_!==x.prevWidth||S!==x.prevHeight||C!==x.prevLayout||P!==x.prevStackOffset||!hx(A,x.prevMargin)){var M=uz(y),D={chartX:x.chartX,chartY:x.chartY,isTooltipActive:x.isTooltipActive},U=Nr(Nr({},dz(x,w,C)),{},{updateId:x.updateId+1}),z=Nr(Nr(Nr({},M),D),U);return Nr(Nr(Nr({},z),m(Nr({props:y},z),x)),{},{prevDataKey:b,prevData:w,prevWidth:_,prevHeight:S,prevLayout:C,prevStackOffset:P,prevMargin:A,prevChildren:j})}if(!eO(j,x.prevChildren)){var W,$,X,ye,Se=Ac(j,Qx),V=Se&&(W=($=Se.props)===null||$===void 0?void 0:$.startIndex)!==null&&W!==void 0?W:R,B=Se&&(X=(ye=Se.props)===null||ye===void 0?void 0:ye.endIndex)!==null&&X!==void 0?X:O,Q=V!==R||B!==O,pe=!la(w),te=pe&&!Q?x.updateId:x.updateId+1;return Nr(Nr({updateId:te},m(Nr(Nr({props:y},x),{},{updateId:te,dataStartIndex:V,dataEndIndex:B}),x)),{},{prevChildren:j,dataStartIndex:V,dataEndIndex:B})}return null}),Jn(v,"renderActiveDot",function(y,x,b){var w;return p.isValidElement(y)?w=p.cloneElement(y,x):Zn(y)?w=y(x):w=Pe.createElement(L1,x),Pe.createElement(Aa,{className:"recharts-active-dot",key:b},w)});var g=p.forwardRef(function(x,b){return Pe.createElement(v,Zv({},x,{ref:b}))});return g.displayName=v.displayName,g},jee=D5({chartName:"LineChart",GraphicalChild:U0,axisComponents:[{axisType:"xAxis",AxisComp:Fh},{axisType:"yAxis",AxisComp:$h}],formatAxisMap:SM}),nUe=D5({chartName:"BarChart",GraphicalChild:zg,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:Fh},{axisType:"yAxis",AxisComp:$h}],formatAxisMap:SM}),aUe=D5({chartName:"PieChart",GraphicalChild:cf,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:S5},{axisType:"radiusAxis",AxisComp:_5}],formatAxisMap:FLe,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),sUe=D5({chartName:"AreaChart",GraphicalChild:Zh,axisComponents:[{axisType:"xAxis",AxisComp:Fh},{axisType:"yAxis",AxisComp:$h}],formatAxisMap:SM});const mz=({icon:e,title:t,value:r,trend:n,trendValue:s,color:o,className:i,loading:l})=>{const c=n==="up"?w4:gue,d=n==="up"?"text-success":"text-danger";return a.jsx(xr.div,{variants:{hidden:{opacity:0,y:30,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{duration:.5,ease:[.22,1,.36,1]}}},className:`fx-card group flex flex-col justify-between ${i}`,children:a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("div",{className:"flex items-center justify-center h-10 w-10 rounded-md border border-white/10 bg-white/5 transition-colors duration-300 group-hover:border-brand/50 group-hover:bg-brand/10",style:{color:`var(--${o})`},children:a.jsx(e,{className:"h-5 w-5"})}),!l&&n&&s&&a.jsxs("div",{className:`flex items-center text-xs font-bold ${d}`,children:[a.jsx(c,{className:"w-3.5 h-3.5 mr-1"}),a.jsx("span",{children:s})]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-semibold text-text-secondary uppercase tracking-wider mb-2",children:t}),l?a.jsx("div",{className:"h-9 bg-white/5 rounded animate-pulse"}):a.jsx("p",{className:"text-3xl font-bold text-text-primary tabular-nums tracking-tight",children:r})]})]})})},oUe=({alerts:e,className:t})=>{const r=zi(),[n,s]=p.useState(!1),o=u=>({Package:Td,DollarSign:ei,CalendarCheck:pC,Clock:Pd,ShoppingCart:y1,Store:C4,Users:Pl,CalendarPlus:N4,AlertTriangle:Xf,Info:JH})[u]||Xf,i=u=>({danger:"text-danger",warning:"text-warning",info:"text-info",success:"text-success",purple:"text-purple"})[u]||"text-warning",l=e.length>2?e.slice(0,2):e,c=e.length>2,d=({alert:u,onClick:f})=>{const h=o(u.icone),m=i(u.cor);return a.jsxs("li",{className:"flex items-center gap-2 p-2 rounded-md hover:bg-white/5 transition-colors cursor-pointer group",onClick:f,children:[a.jsx(h,{className:`w-4 h-4 flex-shrink-0 ${m}`}),a.jsx("span",{className:"text-text-secondary group-hover:text-text-primary transition-colors flex-1",children:u.mensagem}),u.link&&a.jsx(w4,{className:"w-3 h-3 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]})};return a.jsxs(a.Fragment,{children:[a.jsxs(xr.div,{variants:{hidden:{opacity:0,y:30,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{duration:.5,ease:[.22,1,.36,1]}}},className:`fx-card ${t||""}`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("h2",{className:"text-lg font-bold text-text-primary flex items-center",children:[a.jsx(rb,{className:"mr-2 h-5 w-5 text-brand"})," Alertas do Dia"]}),c&&a.jsx(fe,{variant:"ghost",size:"sm",className:"text-xs text-brand hover:text-brand/80",onClick:()=>s(!0),children:"Ver todos"})]}),e.length===0?a.jsx("p",{className:"text-sm text-text-muted",children:"Nenhum alerta no momento! "}):a.jsx("ul",{className:"space-y-2 text-sm",children:l.map((u,f)=>a.jsx(d,{alert:u,onClick:()=>u.link&&r(u.link)},f))})]}),a.jsx(mn,{open:n,onOpenChange:s,children:a.jsxs(un,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[a.jsx(on,{children:a.jsxs(an,{className:"flex items-center gap-2",children:[a.jsx(rb,{className:"h-5 w-5 text-brand"}),"Todos os Alertas (",e.length,")"]})}),a.jsx("div",{className:"mt-4",children:e.length===0?a.jsx("p",{className:"text-sm text-text-muted text-center py-8",children:"Nenhum alerta no momento! "}):a.jsx("ul",{className:"space-y-2 text-sm",children:e.map((u,f)=>a.jsx(d,{alert:u,onClick:()=>{u.link&&(r(u.link),s(!1))}},f))})})]})})]})},iUe=({title:e,icon:t,data:r,color:n,className:s,loading:o})=>{const i=r.reduce((d,u)=>d+(u.receita||0),0),l=r.reduce((d,u)=>d+(u.despesa||0),0),c=i-l;return a.jsxs(xr.div,{variants:{hidden:{opacity:0,y:30,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{duration:.5,ease:[.22,1,.36,1]}}},className:`fx-card group ${s||""}`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("div",{className:"flex items-center justify-center h-10 w-10 rounded-md border border-white/10 bg-white/5 transition-colors duration-300 group-hover:border-brand/50 group-hover:bg-brand/10 mr-3",style:{color:`var(--${n})`},children:a.jsx(t,{className:"h-5 w-5"})}),a.jsx("h3",{className:"text-base font-bold text-text-primary flex-1",children:e}),a.jsx("div",{className:"text-xs font-semibold text-text-muted",children:"ltimos 14 dias"})]}),a.jsx("div",{className:"mb-2",children:a.jsx(fb,{width:"100%",height:90,children:a.jsxs(sUe,{data:r,margin:{top:4,right:0,left:0,bottom:0},children:[a.jsx(Xl,{cursor:{stroke:"var(--border)",strokeDasharray:"3 3"},contentStyle:{background:"rgba(10, 10, 10, 0.85)",borderColor:"var(--border)",color:"var(--text-primary)",borderRadius:"var(--radius-sm)"},formatter:(d,u)=>u==="saldo"?[`R$ ${d.toLocaleString("pt-BR")}`,"Saldo"]:d,labelFormatter:d=>d}),a.jsx(Zh,{type:"monotone",dataKey:"saldo",stroke:"var(--brand)",strokeWidth:2,fill:"var(--brand)",fillOpacity:.15})]})})}),a.jsxs("div",{className:"grid grid-cols-3 gap-3 text-xs",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-text-secondary",children:"Receita"}),o?a.jsx("div",{className:"h-5 w-20 bg-white/5 rounded animate-pulse mt-1"}):a.jsxs("p",{className:"font-bold text-success tabular-nums",children:["R$ ",i.toLocaleString("pt-BR")]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-text-secondary",children:"Despesa"}),o?a.jsx("div",{className:"h-5 w-20 bg-white/5 rounded animate-pulse mt-1"}):a.jsxs("p",{className:"font-bold text-danger tabular-nums",children:["R$ ",l.toLocaleString("pt-BR")]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-text-secondary",children:"Saldo"}),o?a.jsx("div",{className:"h-5 w-20 bg-white/5 rounded animate-pulse mt-1"}):a.jsxs("p",{className:"font-bold text-text-primary tabular-nums",children:["R$ ",c.toLocaleString("pt-BR")]})]})]})]})},lUe=({title:e,icon:t,data:r,color:n,className:s,loading:o})=>a.jsxs(xr.div,{variants:{hidden:{opacity:0,y:30,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{duration:.5,ease:[.22,1,.36,1]}}},className:`fx-card group flex flex-col ${s||""}`,children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("div",{className:"flex items-center justify-center h-10 w-10 rounded-md border border-white/10 bg-white/5 transition-colors duration-300 group-hover:border-brand/50 group-hover:bg-brand/10 mr-3",style:{color:`var(--${n})`},children:a.jsx(t,{className:"h-5 w-5"})}),a.jsx("h3",{className:"text-base font-bold text-text-primary",children:e})]}),a.jsx("div",{className:"space-y-3 mt-auto",children:o?Array.from({length:3}).map((i,l)=>a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("div",{className:"h-4 w-24 bg-white/5 rounded animate-pulse"}),a.jsx("div",{className:"h-4 w-12 bg-white/5 rounded animate-pulse"})]},l)):r.map((i,l)=>a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-text-secondary",children:i.name}),a.jsx("span",{className:"font-bold text-text-primary tabular-nums",children:i.value})]},l))})]}),cUe={hidden:{opacity:0},visible:{opacity:1,transition:{when:"beforeChildren",staggerChildren:.1,delayChildren:.2}}},hE={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.6,ease:[.22,1,.36,1]}}};function dUe(){const{toast:e}=Qa(),{userProfile:t}=ms(),n=E1()?.alerts||[],s=zi(),[o,i]=p.useState(!0),[l,c]=p.useState(0),[d,u]=p.useState({finalizados:0,total:0}),[f,h]=p.useState(0),[m,v]=p.useState(0),[g,y]=p.useState(0),[x,b]=p.useState(0),[w,j]=p.useState(0),[_,S]=p.useState(0),[C,P]=p.useState([]);p.useEffect(()=>{(async()=>{if(!t?.codigo_empresa){console.log("[DashboardPage] Aguardando autenticao..."),i(!1);return}console.log("[DashboardPage] Iniciando carregamento de dados...");try{i(!0);const I=t.codigo_empresa,M=new Date,D=_s(M).toISOString(),U=c_(M).toISOString();console.log("[Dashboard] 1. Buscando pagamentos...");const{data:z}=await de.from("pagamentos").select("valor, status").eq("codigo_empresa",I).gte("recebido_em",D).lte("recebido_em",U);console.log("[Dashboard]  Pagamentos carregados:",z?.length||0);const W=(z||[]).filter(be=>!["Cancelado","Estornado"].includes(be.status)).reduce((be,Ct)=>be+Number(Ct.valor||0),0);console.log("[Dashboard] 2. Buscando agendamentos de hoje...");const{data:$}=await de.from("agendamentos").select("id").eq("codigo_empresa",I).gte("inicio",D).lte("inicio",U);console.log("[Dashboard]  Agendamentos de hoje:",$?.length||0);let X=0;if($&&$.length>0){console.log("[Dashboard] 3. Buscando participantes pagos...");const be=$.map(wt=>wt.id),{data:Ct}=await de.from("agendamento_participantes").select("valor_cota, status_pagamento, aplicar_taxa, finalizadora_id, finalizadoras!agp_finalizadora_id_fkey(taxa_percentual)").eq("codigo_empresa",I).in("agendamento_id",be).eq("status_pagamento","Pago");console.log("[Dashboard]  Participantes pagos:",Ct?.length||0),X=(Ct||[]).reduce((wt,Ge)=>{let Je=Number(Ge.valor_cota||0);if(Ge.aplicar_taxa===!0){const _e=Number(Ge.finalizadoras?.taxa_percentual||0);_e>0&&(Je=Je/(1+_e/100))}return wt+Je},0)}const ye=W+X;c(ye),console.log("[Dashboard] 4. Buscando agendamentos completos...");const{data:Se}=await de.from("agendamentos").select("id, status, inicio, fim").eq("codigo_empresa",I).gte("inicio",D).lte("inicio",U);console.log("[Dashboard]  Agendamentos completos:",Se?.length||0);const V=(Se||[]).filter(be=>be.status==="finished").length;u({finalizados:V,total:Se?.length||0});const B=new Date().toISOString(),Q=(Se||[]).filter(be=>be.inicio>B&&!["canceled","finished"].includes(be.status)).length;h(Q);const pe=(Se||[]).filter(be=>be.status==="in_progress").length;v(pe),console.log("[Dashboard] 5. Buscando quadras...");const{data:te}=await de.from("quadras").select("id").eq("codigo_empresa",I);console.log("[Dashboard]  Quadras:",te?.length||0);const me=(te?.length||0)*17;let ae=0;for(const be of Se||[])if(!["canceled","no_show"].includes(be.status))if(be.inicio&&be.fim){const Ct=new Date(be.inicio),Je=(new Date(be.fim)-Ct)/(1e3*60*60);ae+=Je}else ae+=1;const le=me>0?Math.round(ae/me*100):0;y(le),console.log("[Dashboard] 6. Buscando comandas abertas...");const{data:ue}=await de.from("comandas").select("id").eq("codigo_empresa",I).eq("status","open");console.log("[Dashboard]  Comandas abertas:",ue?.length||0),b(ue?.length||0),console.log("[Dashboard] 7. Buscando mesas...");const{data:Re}=await de.from("mesas").select("id, status").eq("codigo_empresa",I);console.log("[Dashboard]  Mesas:",Re?.length||0);const ne=(Re||[]).filter(be=>["in-use","awaiting-payment"].includes(be.status)).length;j(ne),console.log("[Dashboard] 8. Buscando vendas da loja...");const{data:ie}=await de.from("comandas").select("id").eq("codigo_empresa",I).eq("status","closed").gte("fechado_em",D).lte("fechado_em",U);console.log("[Dashboard]  Vendas da loja:",ie?.length||0),S(ie?.length||0),console.log("[Dashboard] 9. Buscando dados dos ltimos 14 dias...");const gt=new Date;gt.setDate(gt.getDate()-13);const bt=_s(gt).toISOString(),at=c_(M).toISOString(),{data:xt}=await de.from("pagamentos").select("valor, status, recebido_em").eq("codigo_empresa",I).gte("recebido_em",bt).lte("recebido_em",at);console.log("[Dashboard]  Pagamentos 14 dias:",xt?.length||0);const{data:Ze}=await de.from("agendamentos").select("id, inicio").eq("codigo_empresa",I).gte("inicio",bt).lte("inicio",at);console.log("[Dashboard]  Agendamentos 14 dias:",Ze?.length||0);let ht=[];if(Ze&&Ze.length>0){const be=Ze.map(wt=>wt.id),{data:Ct}=await de.from("agendamento_participantes").select("valor_cota, agendamento_id").eq("codigo_empresa",I).in("agendamento_id",be).eq("status_pagamento","Pago");ht=Ct||[],console.log("[Dashboard]  Participantes pagos 14 dias:",ht.length)}const Wt=[];for(let be=13;be>=0;be--){const Ct=new Date;Ct.setDate(Ct.getDate()-be);const wt=_s(Ct),Ge=c_(Ct),Je=(xt||[]).filter(ze=>{const or=new Date(ze.recebido_em);return or>=wt&&or<=Ge&&!["Cancelado","Estornado"].includes(ze.status)}).reduce((ze,or)=>ze+Number(or.valor||0),0),_e=(Ze||[]).filter(ze=>{const or=new Date(ze.inicio);return or>=wt&&or<=Ge}).map(ze=>ze.id),je=ht.filter(ze=>_e.includes(ze.agendamento_id)).reduce((ze,or)=>ze+Number(or.valor_cota||0),0),Ue=Je+je;Wt.push({name:be===0?"Hoje":`${be}d`,saldo:Math.round(Ue),receita:Math.round(Ue),despesa:0})}console.log("[Dashboard]  Dados de 14 dias carregados"),P(Wt)}catch(I){console.error("[DashboardPage]  Erro ao carregar dashboard:",I),e({title:"Erro ao carregar dashboard",description:I?.message||"Tente recarregar a pgina",variant:"destructive"})}finally{console.log("[DashboardPage]  Carregamento concludo"),i(!1)}})()},[t?.codigo_empresa]);const A=O=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(O||0)),R=[{name:"Comandas Abertas",value:x},{name:"Mesas Ocupadas",value:w},{name:"Vendas Hoje",value:_}];return a.jsx(a.Fragment,{children:a.jsxs(xr.div,{variants:cUe,initial:"hidden",animate:"visible",className:"space-y-4",children:[a.jsxs(xr.div,{variants:hE,className:"relative grid grid-cols-1 xl:grid-cols-12 gap-4 items-start",children:[a.jsx("div",{className:"xl:col-span-8",children:a.jsxs("div",{className:"bg-surface/70 backdrop-blur-sm relative p-4 rounded-xl border border-white/10 overflow-hidden shadow-1",children:[a.jsx("div",{className:"absolute inset-0 bg-court-pattern opacity-[0.03] mix-blend-overlay"}),a.jsxs("div",{className:"relative z-10 max-w-[720px]",children:[a.jsxs("h1",{className:"text-3xl font-black mb-2 text-text-primary tracking-tighter",children:["Bem-vindo de volta, ",a.jsxs("span",{className:"text-brand",children:[(t?.nome_exibicao||t?.nome||t?.email?.split("@")[0]||"Admin").split(" ")[0],"!"]})]}),a.jsx("p",{className:"text-text-secondary mb-3 max-w-[60ch] text-sm md:text-base font-normal",children:"Sua central de comando para uma gesto de sucesso. Monitore agendamentos, faturamento e clientes em um s lugar."}),a.jsxs("div",{className:"flex flex-wrap gap-2.5",children:[a.jsxs(fe,{onClick:()=>s("/agenda",{state:{openModal:!0}}),size:"default",children:[a.jsx(N4,{className:"mr-2 h-4 w-4"}),"+ Agendamento"]}),a.jsxs(fe,{onClick:()=>s("/clientes",{state:{openModal:!0}}),variant:"outline",size:"default",children:[a.jsx(Pl,{className:"mr-2 h-4 w-4"}),"Adicionar Cliente"]})]})]})]})}),a.jsx("div",{className:"xl:col-span-4",children:a.jsxs("div",{className:"fx-card",children:[a.jsxs("h2",{className:"text-lg font-bold text-text-primary mb-3 flex items-center",children:[a.jsx(Pd,{className:"mr-2 h-5 w-5 text-brand"})," Resumo do Dia"]}),a.jsxs("ul",{className:"space-y-2 text-sm",children:[a.jsxs("li",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-text-secondary",children:"Prximas Reservas"}),o?a.jsx("div",{className:"h-6 w-12 bg-white/5 rounded animate-pulse"}):a.jsx("span",{className:"font-bold text-text-primary tabular-nums",children:f})]}),a.jsxs("li",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-text-secondary",children:"Quadras em Uso"}),o?a.jsx("div",{className:"h-6 w-12 bg-white/5 rounded animate-pulse"}):a.jsx("span",{className:"font-bold text-success tabular-nums",children:m})]}),a.jsxs("li",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-text-secondary",children:"Taxa de Ocupao"}),o?a.jsx("div",{className:"h-6 w-16 bg-white/5 rounded animate-pulse"}):a.jsxs("span",{className:`font-bold tabular-nums ${g>=70?"text-success":g>=40?"text-warning":"text-danger"}`,children:[g,"%"]})]})]})]})})]}),a.jsxs(xr.div,{variants:hE,className:"relative grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-12 gap-4 items-stretch",children:[a.jsx("div",{className:"xl:col-span-3",children:a.jsx(mz,{icon:ei,title:"Faturamento do Dia",value:A(l),color:"success",className:"h-full",loading:o})}),a.jsx("div",{className:"xl:col-span-3",children:a.jsx(mz,{icon:pC,title:"Agend. Finalizados",value:`${d.finalizados} de ${d.total}`,color:"info",className:"h-full",loading:o})}),a.jsx("div",{className:"xl:col-span-3",children:a.jsx(oUe,{className:"h-full",alerts:n})}),a.jsx("div",{className:"xl:col-span-3",children:a.jsx(lUe,{icon:C4,title:"Informaes da Loja",data:R,color:"purple",className:"h-full",loading:o})})]}),a.jsx(xr.div,{variants:hE,className:"grid grid-cols-1 gap-4",children:a.jsx(iUe,{icon:Jf,title:"Resumo Financeiro",data:C,color:"brand",loading:o})})]})})}var uUe={lessThanXSeconds:{one:"menos de um segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"meio minuto",lessThanXMinutes:{one:"menos de um minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"cerca de 1 hora",other:"cerca de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 dia",other:"{{count}} dias"},aboutXWeeks:{one:"cerca de 1 semana",other:"cerca de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"cerca de 1 ms",other:"cerca de {{count}} meses"},xMonths:{one:"1 ms",other:"{{count}} meses"},aboutXYears:{one:"cerca de 1 ano",other:"cerca de {{count}} anos"},xYears:{one:"1 ano",other:"{{count}} anos"},overXYears:{one:"mais de 1 ano",other:"mais de {{count}} anos"},almostXYears:{one:"quase 1 ano",other:"quase {{count}} anos"}},fUe=function(t,r,n){var s,o=uUe[t];return typeof o=="string"?s=o:r===1?s=o.one:s=o.other.replace("{{count}}",String(r)),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"em "+s:"h "+s:s};const mUe=fUe;var hUe={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/yyyy"},pUe={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},gUe={full:"{{date}} 's' {{time}}",long:"{{date}} 's' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},vUe={date:mx({formats:hUe,defaultWidth:"full"}),time:mx({formats:pUe,defaultWidth:"full"}),dateTime:mx({formats:gUe,defaultWidth:"full"})};const xUe=vUe;var yUe={lastWeek:function(t){var r=t.getUTCDay(),n=r===0||r===6?"ltimo":"ltima";return"'"+n+"' eeee 's' p"},yesterday:"'ontem s' p",today:"'hoje s' p",tomorrow:"'amanh s' p",nextWeek:"eeee 's' p",other:"P"},bUe=function(t,r,n,s){var o=yUe[t];return typeof o=="function"?o(r):o};const wUe=bUe;var jUe={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","depois de cristo"]},_Ue={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1 trimestre","2 trimestre","3 trimestre","4 trimestre"]},NUe={narrow:["j","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],wide:["janeiro","fevereiro","maro","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]},SUe={narrow:["D","S","T","Q","Q","S","S"],short:["dom","seg","ter","qua","qui","sex","sab"],abbreviated:["domingo","segunda","tera","quarta","quinta","sexta","sbado"],wide:["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"]},CUe={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"}},PUe={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"}},AUe=function(t,r){var n=Number(t);return r?.unit==="week"?n+"":n+""},EUe={ordinalNumber:AUe,era:Bu({values:jUe,defaultWidth:"wide"}),quarter:Bu({values:_Ue,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:Bu({values:NUe,defaultWidth:"wide"}),day:Bu({values:SUe,defaultWidth:"wide"}),dayPeriod:Bu({values:CUe,defaultWidth:"wide",formattingValues:PUe,defaultFormattingWidth:"wide"})};const kUe=EUe;var IUe=/^(\d+)[o]?/i,OUe=/\d+/i,TUe={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|d\.?\s?c\.?)/i,wide:/^(antes de cristo|depois de cristo)/i},DUe={any:[/^ac/i,/^dc/i],wide:[/^antes de cristo/i,/^depois de cristo/i]},MUe={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234]()? trimestre/i},RUe={any:[/1/i,/2/i,/3/i,/4/i]},LUe={narrow:/^[jfmajsond]/i,abbreviated:/^(jan|fev|mar|abr|mai|jun|jul|ago|set|out|nov|dez)/i,wide:/^(janeiro|fevereiro|maro|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)/i},FUe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^fev/i,/^mar/i,/^abr/i,/^mai/i,/^jun/i,/^jul/i,/^ago/i,/^set/i,/^out/i,/^nov/i,/^dez/i]},$Ue={narrow:/^(dom|[23456]?|s[a]b)/i,short:/^(dom|[23456]?|s[a]b)/i,abbreviated:/^(dom|seg|ter|qua|qui|sex|s[a]b)/i,wide:/^(domingo|(segunda|ter[c]a|quarta|quinta|sexta)([- ]feira)?|s[a]bado)/i},BUe={short:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],narrow:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],any:[/^d/i,/^seg/i,/^t/i,/^qua/i,/^qui/i,/^sex/i,/^s[a]b/i]},qUe={narrow:/^(a|p|mn|md|(da) (manh|tarde|noite))/i,any:/^([ap]\.?\s?m\.?|meia[-\s]noite|meio[-\s]dia|(da) (manh|tarde|noite))/i},zUe={any:{am:/^a/i,pm:/^p/i,midnight:/^mn|^meia[-\s]noite/i,noon:/^md|^meio[-\s]dia/i,morning:/manh/i,afternoon:/tarde/i,evening:/tarde/i,night:/noite/i}},UUe={ordinalNumber:wY({matchPattern:IUe,parsePattern:OUe,valueCallback:function(t){return parseInt(t,10)}}),era:qu({matchPatterns:TUe,defaultMatchWidth:"wide",parsePatterns:DUe,defaultParseWidth:"any"}),quarter:qu({matchPatterns:MUe,defaultMatchWidth:"wide",parsePatterns:RUe,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:qu({matchPatterns:LUe,defaultMatchWidth:"wide",parsePatterns:FUe,defaultParseWidth:"any"}),day:qu({matchPatterns:$Ue,defaultMatchWidth:"wide",parsePatterns:BUe,defaultParseWidth:"any"}),dayPeriod:qu({matchPatterns:qUe,defaultMatchWidth:"any",parsePatterns:zUe,defaultParseWidth:"any"})};const VUe=UUe;var WUe={code:"pt-BR",formatDistance:mUe,formatLong:xUe,formatRelative:wUe,localize:kUe,match:VUe,options:{weekStartsOn:0,firstWeekContainsDate:1}};const na=WUe;var aa=function(){return aa=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},aa.apply(this,arguments)};function HUe(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function _ee(e,t,r){if(r||arguments.length===2)for(var n=0,s=t.length,o;n<s;n++)(o||!(n in t))&&(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}function F1(e){return e.mode==="multiple"}function $1(e){return e.mode==="range"}function M5(e){return e.mode==="single"}var GUe={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function KUe(e,t){return cr(e,"LLLL y",t)}function XUe(e,t){return cr(e,"d",t)}function YUe(e,t){return cr(e,"LLLL",t)}function JUe(e){return"".concat(e)}function QUe(e,t){return cr(e,"cccccc",t)}function ZUe(e,t){return cr(e,"yyyy",t)}var eVe=Object.freeze({__proto__:null,formatCaption:KUe,formatDay:XUe,formatMonthCaption:YUe,formatWeekNumber:JUe,formatWeekdayName:QUe,formatYearCaption:ZUe}),tVe=function(e,t,r){return cr(e,"do MMMM (EEEE)",r)},rVe=function(){return"Month: "},nVe=function(){return"Go to next month"},aVe=function(){return"Go to previous month"},sVe=function(e,t){return cr(e,"cccc",t)},oVe=function(e){return"Week n. ".concat(e)},iVe=function(){return"Year: "},lVe=Object.freeze({__proto__:null,labelDay:tVe,labelMonthDropdown:rVe,labelNext:nVe,labelPrevious:aVe,labelWeekNumber:oVe,labelWeekday:sVe,labelYearDropdown:iVe});function cVe(){var e="buttons",t=GUe,r=jY,n={},s={},o=1,i={},l=new Date;return{captionLayout:e,classNames:t,formatters:eVe,labels:lVe,locale:r,modifiersClassNames:n,modifiers:s,numberOfMonths:o,styles:i,today:l,mode:"default"}}function dVe(e){var t=e.fromYear,r=e.toYear,n=e.fromMonth,s=e.toMonth,o=e.fromDate,i=e.toDate;return n?o=Tl(n):t&&(o=new Date(t,0,1)),s?i=qC(s):r&&(i=new Date(r,11,31)),{fromDate:o?_s(o):void 0,toDate:i?_s(i):void 0}}var Nee=p.createContext(void 0);function uVe(e){var t,r=e.initialProps,n=cVe(),s=dVe(r),o=s.fromDate,i=s.toDate,l=(t=r.captionLayout)!==null&&t!==void 0?t:n.captionLayout;l!=="buttons"&&(!o||!i)&&(l="buttons");var c;(M5(r)||F1(r)||$1(r))&&(c=r.onSelect);var d=aa(aa(aa({},n),r),{captionLayout:l,classNames:aa(aa({},n.classNames),r.classNames),components:aa({},r.components),formatters:aa(aa({},n.formatters),r.formatters),fromDate:o,labels:aa(aa({},n.labels),r.labels),mode:r.mode||n.mode,modifiers:aa(aa({},n.modifiers),r.modifiers),modifiersClassNames:aa(aa({},n.modifiersClassNames),r.modifiersClassNames),onSelect:c,styles:aa(aa({},n.styles),r.styles),toDate:i});return a.jsx(Nee.Provider,{value:d,children:e.children})}function As(){var e=p.useContext(Nee);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function See(e){var t=As(),r=t.locale,n=t.classNames,s=t.styles,o=t.formatters.formatCaption;return a.jsx("div",{className:n.caption_label,style:s.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:o(e.displayMonth,{locale:r})})}function fVe(e){return a.jsx("svg",aa({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:a.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Cee(e){var t,r,n=e.onChange,s=e.value,o=e.children,i=e.caption,l=e.className,c=e.style,d=As(),u=(r=(t=d.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:fVe;return a.jsxs("div",{className:l,style:c,children:[a.jsx("span",{className:d.classNames.vhidden,children:e["aria-label"]}),a.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:d.classNames.dropdown,style:d.styles.dropdown,value:s,onChange:n,children:o}),a.jsxs("div",{className:d.classNames.caption_label,style:d.styles.caption_label,"aria-hidden":"true",children:[i,a.jsx(u,{className:d.classNames.dropdown_icon,style:d.styles.dropdown_icon})]})]})}function mVe(e){var t,r=As(),n=r.fromDate,s=r.toDate,o=r.styles,i=r.locale,l=r.formatters.formatMonthCaption,c=r.classNames,d=r.components,u=r.labels.labelMonthDropdown;if(!n)return a.jsx(a.Fragment,{});if(!s)return a.jsx(a.Fragment,{});var f=[];if(Z1e(n,s))for(var h=Tl(n),m=n.getMonth();m<=s.getMonth();m++)f.push(FA(h,m));else for(var h=Tl(new Date),m=0;m<=11;m++)f.push(FA(h,m));var v=function(y){var x=Number(y.target.value),b=FA(Tl(e.displayMonth),x);e.onChange(b)},g=(t=d?.Dropdown)!==null&&t!==void 0?t:Cee;return a.jsx(g,{name:"months","aria-label":u(),className:c.dropdown_month,style:o.dropdown_month,onChange:v,value:e.displayMonth.getMonth(),caption:l(e.displayMonth,{locale:i}),children:f.map(function(y){return a.jsx("option",{value:y.getMonth(),children:l(y,{locale:i})},y.getMonth())})})}function hVe(e){var t,r=e.displayMonth,n=As(),s=n.fromDate,o=n.toDate,i=n.locale,l=n.styles,c=n.classNames,d=n.components,u=n.formatters.formatYearCaption,f=n.labels.labelYearDropdown,h=[];if(!s)return a.jsx(a.Fragment,{});if(!o)return a.jsx(a.Fragment,{});for(var m=s.getFullYear(),v=o.getFullYear(),g=m;g<=v;g++)h.push(X6(Ewe(new Date),g));var y=function(b){var w=X6(Tl(r),Number(b.target.value));e.onChange(w)},x=(t=d?.Dropdown)!==null&&t!==void 0?t:Cee;return a.jsx(x,{name:"years","aria-label":f(),className:c.dropdown_year,style:l.dropdown_year,onChange:y,value:r.getFullYear(),caption:u(r,{locale:i}),children:h.map(function(b){return a.jsx("option",{value:b.getFullYear(),children:u(b,{locale:i})},b.getFullYear())})})}function pVe(e,t){var r=p.useState(e),n=r[0],s=r[1],o=t===void 0?n:t;return[o,s]}function gVe(e){var t=e.month,r=e.defaultMonth,n=e.today,s=t||r||n||new Date,o=e.toDate,i=e.fromDate,l=e.numberOfMonths,c=l===void 0?1:l;if(o&&uw(o,s)<0){var d=-1*(c-1);s=vu(o,d)}return i&&uw(s,i)<0&&(s=i),Tl(s)}function vVe(){var e=As(),t=gVe(e),r=pVe(t,e.month),n=r[0],s=r[1],o=function(i){var l;if(!e.disableNavigation){var c=Tl(i);s(c),(l=e.onMonthChange)===null||l===void 0||l.call(e,c)}};return[n,o]}function xVe(e,t){for(var r=t.reverseMonths,n=t.numberOfMonths,s=Tl(e),o=Tl(vu(s,n)),i=uw(o,s),l=[],c=0;c<i;c++){var d=vu(s,c);l.push(d)}return r&&(l=l.reverse()),l}function yVe(e,t){if(!t.disableNavigation){var r=t.toDate,n=t.pagedNavigation,s=t.numberOfMonths,o=s===void 0?1:s,i=n?o:1,l=Tl(e);if(!r)return vu(l,i);var c=uw(r,e);if(!(c<o))return vu(l,i)}}function bVe(e,t){if(!t.disableNavigation){var r=t.fromDate,n=t.pagedNavigation,s=t.numberOfMonths,o=s===void 0?1:s,i=n?o:1,l=Tl(e);if(!r)return vu(l,-i);var c=uw(l,r);if(!(c<=0))return vu(l,-i)}}var Pee=p.createContext(void 0);function wVe(e){var t=As(),r=vVe(),n=r[0],s=r[1],o=xVe(n,t),i=yVe(n,t),l=bVe(n,t),c=function(f){return o.some(function(h){return CD(f,h)})},d=function(f,h){c(f)||(h&&_Y(f,h)?s(vu(f,1+t.numberOfMonths*-1)):s(f))},u={currentMonth:n,displayMonths:o,goToMonth:s,goToDate:d,previousMonth:l,nextMonth:i,isDateDisplayed:c};return a.jsx(Pee.Provider,{value:u,children:e.children})}function B1(){var e=p.useContext(Pee);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function hz(e){var t,r=As(),n=r.classNames,s=r.styles,o=r.components,i=B1().goToMonth,l=function(u){i(vu(u,e.displayIndex?-e.displayIndex:0))},c=(t=o?.CaptionLabel)!==null&&t!==void 0?t:See,d=a.jsx(c,{id:e.id,displayMonth:e.displayMonth});return a.jsxs("div",{className:n.caption_dropdowns,style:s.caption_dropdowns,children:[a.jsx("div",{className:n.vhidden,children:d}),a.jsx(mVe,{onChange:l,displayMonth:e.displayMonth}),a.jsx(hVe,{onChange:l,displayMonth:e.displayMonth})]})}function jVe(e){return a.jsx("svg",aa({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:a.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function _Ve(e){return a.jsx("svg",aa({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:a.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var yS=p.forwardRef(function(e,t){var r=As(),n=r.classNames,s=r.styles,o=[n.button_reset,n.button];e.className&&o.push(e.className);var i=o.join(" "),l=aa(aa({},s.button_reset),s.button);return e.style&&Object.assign(l,e.style),a.jsx("button",aa({},e,{ref:t,type:"button",className:i,style:l}))});function NVe(e){var t,r,n=As(),s=n.dir,o=n.locale,i=n.classNames,l=n.styles,c=n.labels,d=c.labelPrevious,u=c.labelNext,f=n.components;if(!e.nextMonth&&!e.previousMonth)return a.jsx(a.Fragment,{});var h=d(e.previousMonth,{locale:o}),m=[i.nav_button,i.nav_button_previous].join(" "),v=u(e.nextMonth,{locale:o}),g=[i.nav_button,i.nav_button_next].join(" "),y=(t=f?.IconRight)!==null&&t!==void 0?t:_Ve,x=(r=f?.IconLeft)!==null&&r!==void 0?r:jVe;return a.jsxs("div",{className:i.nav,style:l.nav,children:[!e.hidePrevious&&a.jsx(yS,{name:"previous-month","aria-label":h,className:m,style:l.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:s==="rtl"?a.jsx(y,{className:i.nav_icon,style:l.nav_icon}):a.jsx(x,{className:i.nav_icon,style:l.nav_icon})}),!e.hideNext&&a.jsx(yS,{name:"next-month","aria-label":v,className:g,style:l.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:s==="rtl"?a.jsx(x,{className:i.nav_icon,style:l.nav_icon}):a.jsx(y,{className:i.nav_icon,style:l.nav_icon})})]})}function pz(e){var t=As().numberOfMonths,r=B1(),n=r.previousMonth,s=r.nextMonth,o=r.goToMonth,i=r.displayMonths,l=i.findIndex(function(v){return CD(e.displayMonth,v)}),c=l===0,d=l===i.length-1,u=t>1&&(c||!d),f=t>1&&(d||!c),h=function(){n&&o(n)},m=function(){s&&o(s)};return a.jsx(NVe,{displayMonth:e.displayMonth,hideNext:u,hidePrevious:f,nextMonth:s,previousMonth:n,onPreviousClick:h,onNextClick:m})}function SVe(e){var t,r=As(),n=r.classNames,s=r.disableNavigation,o=r.styles,i=r.captionLayout,l=r.components,c=(t=l?.CaptionLabel)!==null&&t!==void 0?t:See,d;return s?d=a.jsx(c,{id:e.id,displayMonth:e.displayMonth}):i==="dropdown"?d=a.jsx(hz,{displayMonth:e.displayMonth,id:e.id}):i==="dropdown-buttons"?d=a.jsxs(a.Fragment,{children:[a.jsx(hz,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),a.jsx(pz,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):d=a.jsxs(a.Fragment,{children:[a.jsx(c,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),a.jsx(pz,{displayMonth:e.displayMonth,id:e.id})]}),a.jsx("div",{className:n.caption,style:o.caption,children:d})}function CVe(e){var t=As(),r=t.footer,n=t.styles,s=t.classNames.tfoot;return r?a.jsx("tfoot",{className:s,style:n.tfoot,children:a.jsx("tr",{children:a.jsx("td",{colSpan:8,children:r})})}):a.jsx(a.Fragment,{})}function PVe(e,t,r){for(var n=r?vg(new Date):Dd(new Date,{locale:e,weekStartsOn:t}),s=[],o=0;o<7;o++){var i=Ta(n,o);s.push(i)}return s}function AVe(){var e=As(),t=e.classNames,r=e.styles,n=e.showWeekNumber,s=e.locale,o=e.weekStartsOn,i=e.ISOWeek,l=e.formatters.formatWeekdayName,c=e.labels.labelWeekday,d=PVe(s,o,i);return a.jsxs("tr",{style:r.head_row,className:t.head_row,children:[n&&a.jsx("td",{style:r.head_cell,className:t.head_cell}),d.map(function(u,f){return a.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":c(u,{locale:s}),children:l(u,{locale:s})},f)})]})}function EVe(){var e,t=As(),r=t.classNames,n=t.styles,s=t.components,o=(e=s?.HeadRow)!==null&&e!==void 0?e:AVe;return a.jsx("thead",{style:n.head,className:r.head,children:a.jsx(o,{})})}function kVe(e){var t=As(),r=t.locale,n=t.formatters.formatDay;return a.jsx(a.Fragment,{children:n(e.date,{locale:r})})}var MM=p.createContext(void 0);function IVe(e){if(!F1(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return a.jsx(MM.Provider,{value:t,children:e.children})}return a.jsx(OVe,{initialProps:e.initialProps,children:e.children})}function OVe(e){var t=e.initialProps,r=e.children,n=t.selected,s=t.min,o=t.max,i=function(d,u,f){var h,m;(h=t.onDayClick)===null||h===void 0||h.call(t,d,u,f);var v=!!(u.selected&&s&&n?.length===s);if(!v){var g=!!(!u.selected&&o&&n?.length===o);if(!g){var y=n?_ee([],n,!0):[];if(u.selected){var x=y.findIndex(function(b){return nl(d,b)});y.splice(x,1)}else y.push(d);(m=t.onSelect)===null||m===void 0||m.call(t,y,d,u,f)}}},l={disabled:[]};n&&l.disabled.push(function(d){var u=o&&n.length>o-1,f=n.some(function(h){return nl(h,d)});return!!(u&&!f)});var c={selected:n,onDayClick:i,modifiers:l};return a.jsx(MM.Provider,{value:c,children:r})}function RM(){var e=p.useContext(MM);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function TVe(e,t){var r=t||{},n=r.from,s=r.to;return n&&s?nl(s,e)&&nl(n,e)?void 0:nl(s,e)?{from:s,to:void 0}:nl(n,e)?void 0:YI(n,e)?{from:e,to:s}:{from:n,to:e}:s?YI(e,s)?{from:s,to:e}:{from:e,to:s}:n?_Y(e,n)?{from:e,to:n}:{from:n,to:e}:{from:e,to:void 0}}var LM=p.createContext(void 0);function DVe(e){if(!$1(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return a.jsx(LM.Provider,{value:t,children:e.children})}return a.jsx(MVe,{initialProps:e.initialProps,children:e.children})}function MVe(e){var t=e.initialProps,r=e.children,n=t.selected,s=n||{},o=s.from,i=s.to,l=t.min,c=t.max,d=function(m,v,g){var y,x;(y=t.onDayClick)===null||y===void 0||y.call(t,m,v,g);var b=TVe(m,n);(x=t.onSelect)===null||x===void 0||x.call(t,b,m,v,g)},u={range_start:[],range_end:[],range_middle:[],disabled:[]};if(o?(u.range_start=[o],i?(u.range_end=[i],nl(o,i)||(u.range_middle=[{after:o,before:i}])):u.range_end=[o]):i&&(u.range_start=[i],u.range_end=[i]),l&&(o&&!i&&u.disabled.push({after:ub(o,l-1),before:Ta(o,l-1)}),o&&i&&u.disabled.push({after:o,before:Ta(o,l-1)}),!o&&i&&u.disabled.push({after:ub(i,l-1),before:Ta(i,l-1)})),c){if(o&&!i&&(u.disabled.push({before:Ta(o,-c+1)}),u.disabled.push({after:Ta(o,c-1)})),o&&i){var f=Wu(i,o)+1,h=c-f;u.disabled.push({before:ub(o,h)}),u.disabled.push({after:Ta(i,h)})}!o&&i&&(u.disabled.push({before:Ta(i,-c+1)}),u.disabled.push({after:Ta(i,c-1)}))}return a.jsx(LM.Provider,{value:{selected:n,onDayClick:d,modifiers:u},children:r})}function FM(){var e=p.useContext(LM);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function u_(e){return Array.isArray(e)?_ee([],e,!0):e!==void 0?[e]:[]}function RVe(e){var t={};return Object.entries(e).forEach(function(r){var n=r[0],s=r[1];t[n]=u_(s)}),t}var xu;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(xu||(xu={}));var LVe=xu.Selected,bf=xu.Disabled,FVe=xu.Hidden,$Ve=xu.Today,pE=xu.RangeEnd,gE=xu.RangeMiddle,vE=xu.RangeStart,BVe=xu.Outside;function qVe(e,t,r){var n,s=(n={},n[LVe]=u_(e.selected),n[bf]=u_(e.disabled),n[FVe]=u_(e.hidden),n[$Ve]=[e.today],n[pE]=[],n[gE]=[],n[vE]=[],n[BVe]=[],n);return e.fromDate&&s[bf].push({before:e.fromDate}),e.toDate&&s[bf].push({after:e.toDate}),F1(e)?s[bf]=s[bf].concat(t.modifiers[bf]):$1(e)&&(s[bf]=s[bf].concat(r.modifiers[bf]),s[vE]=r.modifiers[vE],s[gE]=r.modifiers[gE],s[pE]=r.modifiers[pE]),s}var Aee=p.createContext(void 0);function zVe(e){var t=As(),r=RM(),n=FM(),s=qVe(t,r,n),o=RVe(t.modifiers),i=aa(aa({},s),o);return a.jsx(Aee.Provider,{value:i,children:e.children})}function Eee(){var e=p.useContext(Aee);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function UVe(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function VVe(e){return!!(e&&typeof e=="object"&&"from"in e)}function WVe(e){return!!(e&&typeof e=="object"&&"after"in e)}function HVe(e){return!!(e&&typeof e=="object"&&"before"in e)}function GVe(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function KVe(e,t){var r,n=t.from,s=t.to;if(n&&s){var o=Wu(s,n)<0;o&&(r=[s,n],n=r[0],s=r[1]);var i=Wu(e,n)>=0&&Wu(s,e)>=0;return i}return s?nl(s,e):n?nl(n,e):!1}function XVe(e){return ND(e)}function YVe(e){return Array.isArray(e)&&e.every(ND)}function JVe(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if(XVe(r))return nl(e,r);if(YVe(r))return r.includes(e);if(VVe(r))return KVe(e,r);if(GVe(r))return r.dayOfWeek.includes(e.getDay());if(UVe(r)){var n=Wu(r.before,e),s=Wu(r.after,e),o=n>0,i=s<0,l=YI(r.before,r.after);return l?i&&o:o||i}return WVe(r)?Wu(e,r.after)>0:HVe(r)?Wu(r.before,e)>0:typeof r=="function"?r(e):!1})}function $M(e,t,r){var n=Object.keys(t).reduce(function(o,i){var l=t[i];return JVe(e,l)&&o.push(i),o},[]),s={};return n.forEach(function(o){return s[o]=!0}),r&&!CD(e,r)&&(s.outside=!0),s}function QVe(e,t){for(var r=Tl(e[0]),n=qC(e[e.length-1]),s,o,i=r;i<=n;){var l=$M(i,t),c=!l.disabled&&!l.hidden;if(!c){i=Ta(i,1);continue}if(l.selected)return i;l.today&&!o&&(o=i),s||(s=i),i=Ta(i,1)}return o||s}var ZVe=365;function kee(e,t){var r=t.moveBy,n=t.direction,s=t.context,o=t.modifiers,i=t.retry,l=i===void 0?{count:0,lastFocused:e}:i,c=s.weekStartsOn,d=s.fromDate,u=s.toDate,f=s.locale,h={day:Ta,week:XI,month:vu,year:jwe,startOfWeek:function(y){return s.ISOWeek?vg(y):Dd(y,{locale:f,weekStartsOn:c})},endOfWeek:function(y){return s.ISOWeek?vY(y):SD(y,{locale:f,weekStartsOn:c})}},m=h[r](e,n==="after"?1:-1);n==="before"&&d?m=_we([d,m]):n==="after"&&u&&(m=Nwe([u,m]));var v=!0;if(o){var g=$M(m,o);v=!g.disabled&&!g.hidden}return v?m:l.count>ZVe?l.lastFocused:kee(m,{moveBy:r,direction:n,context:s,modifiers:o,retry:aa(aa({},l),{count:l.count+1})})}var Iee=p.createContext(void 0);function eWe(e){var t=B1(),r=Eee(),n=p.useState(),s=n[0],o=n[1],i=p.useState(),l=i[0],c=i[1],d=QVe(t.displayMonths,r),u=s??(l&&t.isDateDisplayed(l))?l:d,f=function(){c(s),o(void 0)},h=function(y){o(y)},m=As(),v=function(y,x){if(s){var b=kee(s,{moveBy:y,direction:x,context:m,modifiers:r});nl(s,b)||(t.goToDate(b,s),h(b))}},g={focusedDay:s,focusTarget:u,blur:f,focus:h,focusDayAfter:function(){return v("day","after")},focusDayBefore:function(){return v("day","before")},focusWeekAfter:function(){return v("week","after")},focusWeekBefore:function(){return v("week","before")},focusMonthBefore:function(){return v("month","before")},focusMonthAfter:function(){return v("month","after")},focusYearBefore:function(){return v("year","before")},focusYearAfter:function(){return v("year","after")},focusStartOfWeek:function(){return v("startOfWeek","before")},focusEndOfWeek:function(){return v("endOfWeek","after")}};return a.jsx(Iee.Provider,{value:g,children:e.children})}function BM(){var e=p.useContext(Iee);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function tWe(e,t){var r=Eee(),n=$M(e,r,t);return n}var qM=p.createContext(void 0);function rWe(e){if(!M5(e.initialProps)){var t={selected:void 0};return a.jsx(qM.Provider,{value:t,children:e.children})}return a.jsx(nWe,{initialProps:e.initialProps,children:e.children})}function nWe(e){var t=e.initialProps,r=e.children,n=function(o,i,l){var c,d,u;if((c=t.onDayClick)===null||c===void 0||c.call(t,o,i,l),i.selected&&!t.required){(d=t.onSelect)===null||d===void 0||d.call(t,void 0,o,i,l);return}(u=t.onSelect)===null||u===void 0||u.call(t,o,o,i,l)},s={selected:t.selected,onDayClick:n};return a.jsx(qM.Provider,{value:s,children:r})}function Oee(){var e=p.useContext(qM);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function aWe(e,t){var r=As(),n=Oee(),s=RM(),o=FM(),i=BM(),l=i.focusDayAfter,c=i.focusDayBefore,d=i.focusWeekAfter,u=i.focusWeekBefore,f=i.blur,h=i.focus,m=i.focusMonthBefore,v=i.focusMonthAfter,g=i.focusYearBefore,y=i.focusYearAfter,x=i.focusStartOfWeek,b=i.focusEndOfWeek,w=function(W){var $,X,ye,Se;M5(r)?($=n.onDayClick)===null||$===void 0||$.call(n,e,t,W):F1(r)?(X=s.onDayClick)===null||X===void 0||X.call(s,e,t,W):$1(r)?(ye=o.onDayClick)===null||ye===void 0||ye.call(o,e,t,W):(Se=r.onDayClick)===null||Se===void 0||Se.call(r,e,t,W)},j=function(W){var $;h(e),($=r.onDayFocus)===null||$===void 0||$.call(r,e,t,W)},_=function(W){var $;f(),($=r.onDayBlur)===null||$===void 0||$.call(r,e,t,W)},S=function(W){var $;($=r.onDayMouseEnter)===null||$===void 0||$.call(r,e,t,W)},C=function(W){var $;($=r.onDayMouseLeave)===null||$===void 0||$.call(r,e,t,W)},P=function(W){var $;($=r.onDayPointerEnter)===null||$===void 0||$.call(r,e,t,W)},A=function(W){var $;($=r.onDayPointerLeave)===null||$===void 0||$.call(r,e,t,W)},R=function(W){var $;($=r.onDayTouchCancel)===null||$===void 0||$.call(r,e,t,W)},O=function(W){var $;($=r.onDayTouchEnd)===null||$===void 0||$.call(r,e,t,W)},I=function(W){var $;($=r.onDayTouchMove)===null||$===void 0||$.call(r,e,t,W)},M=function(W){var $;($=r.onDayTouchStart)===null||$===void 0||$.call(r,e,t,W)},D=function(W){var $;($=r.onDayKeyUp)===null||$===void 0||$.call(r,e,t,W)},U=function(W){var $;switch(W.key){case"ArrowLeft":W.preventDefault(),W.stopPropagation(),r.dir==="rtl"?l():c();break;case"ArrowRight":W.preventDefault(),W.stopPropagation(),r.dir==="rtl"?c():l();break;case"ArrowDown":W.preventDefault(),W.stopPropagation(),d();break;case"ArrowUp":W.preventDefault(),W.stopPropagation(),u();break;case"PageUp":W.preventDefault(),W.stopPropagation(),W.shiftKey?g():m();break;case"PageDown":W.preventDefault(),W.stopPropagation(),W.shiftKey?y():v();break;case"Home":W.preventDefault(),W.stopPropagation(),x();break;case"End":W.preventDefault(),W.stopPropagation(),b();break}($=r.onDayKeyDown)===null||$===void 0||$.call(r,e,t,W)},z={onClick:w,onFocus:j,onBlur:_,onKeyDown:U,onKeyUp:D,onMouseEnter:S,onMouseLeave:C,onPointerEnter:P,onPointerLeave:A,onTouchCancel:R,onTouchEnd:O,onTouchMove:I,onTouchStart:M};return z}function sWe(){var e=As(),t=Oee(),r=RM(),n=FM(),s=M5(e)?t.selected:F1(e)?r.selected:$1(e)?n.selected:void 0;return s}function oWe(e){return Object.values(xu).includes(e)}function iWe(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(n){var s=e.modifiersClassNames[n];if(s)r.push(s);else if(oWe(n)){var o=e.classNames["day_".concat(n)];o&&r.push(o)}}),r}function lWe(e,t){var r=aa({},e.styles.day);return Object.keys(t).forEach(function(n){var s;r=aa(aa({},r),(s=e.modifiersStyles)===null||s===void 0?void 0:s[n])}),r}function cWe(e,t,r){var n,s,o,i=As(),l=BM(),c=tWe(e,t),d=aWe(e,c),u=sWe(),f=!!(i.onDayClick||i.mode!=="default");p.useEffect(function(){var S;c.outside||l.focusedDay&&f&&nl(l.focusedDay,e)&&((S=r.current)===null||S===void 0||S.focus())},[l.focusedDay,e,r,f,c.outside]);var h=iWe(i,c).join(" "),m=lWe(i,c),v=!!(c.outside&&!i.showOutsideDays||c.hidden),g=(o=(s=i.components)===null||s===void 0?void 0:s.DayContent)!==null&&o!==void 0?o:kVe,y=a.jsx(g,{date:e,displayMonth:t,activeModifiers:c}),x={style:m,className:h,children:y,role:"gridcell"},b=l.focusTarget&&nl(l.focusTarget,e)&&!c.outside,w=l.focusedDay&&nl(l.focusedDay,e),j=aa(aa(aa({},x),(n={disabled:c.disabled,role:"gridcell"},n["aria-selected"]=c.selected,n.tabIndex=w||b?0:-1,n)),d),_={isButton:f,isHidden:v,activeModifiers:c,selectedDays:u,buttonProps:j,divProps:x};return _}function dWe(e){var t=p.useRef(null),r=cWe(e.date,e.displayMonth,t);return r.isHidden?a.jsx("div",{role:"gridcell"}):r.isButton?a.jsx(yS,aa({name:"day",ref:t},r.buttonProps)):a.jsx("div",aa({},r.divProps))}function uWe(e){var t=e.number,r=e.dates,n=As(),s=n.onWeekNumberClick,o=n.styles,i=n.classNames,l=n.locale,c=n.labels.labelWeekNumber,d=n.formatters.formatWeekNumber,u=d(Number(t),{locale:l});if(!s)return a.jsx("span",{className:i.weeknumber,style:o.weeknumber,children:u});var f=c(Number(t),{locale:l}),h=function(m){s(t,r,m)};return a.jsx(yS,{name:"week-number","aria-label":f,className:i.weeknumber,style:o.weeknumber,onClick:h,children:u})}function fWe(e){var t,r,n=As(),s=n.styles,o=n.classNames,i=n.showWeekNumber,l=n.components,c=(t=l?.Day)!==null&&t!==void 0?t:dWe,d=(r=l?.WeekNumber)!==null&&r!==void 0?r:uWe,u;return i&&(u=a.jsx("td",{className:o.cell,style:s.cell,children:a.jsx(d,{number:e.weekNumber,dates:e.dates})})),a.jsxs("tr",{className:o.row,style:s.row,children:[u,e.dates.map(function(f){return a.jsx("td",{className:o.cell,style:s.cell,role:"presentation",children:a.jsx(c,{displayMonth:e.displayMonth,date:f})},z1e(f))})]})}function gz(e,t,r){for(var n=r?.ISOWeek?vY(t):SD(t,r),s=r?.ISOWeek?vg(e):Dd(e,r),o=Wu(n,s),i=[],l=0;l<=o;l++)i.push(Ta(s,l));var c=i.reduce(function(d,u){var f=r?.ISOWeek?B1e(u):H1e(u,r),h=d.find(function(m){return m.weekNumber===f});return h?(h.dates.push(u),d):(d.push({weekNumber:f,dates:[u]}),d)},[]);return c}function mWe(e,t){var r=gz(Tl(e),qC(e),t);if(t?.useFixedWeeks){var n=K1e(e,t);if(n<6){var s=r[r.length-1],o=s.dates[s.dates.length-1],i=XI(o,6-n),l=gz(XI(o,1),i,t);r.push.apply(r,l)}}return r}function hWe(e){var t,r,n,s=As(),o=s.locale,i=s.classNames,l=s.styles,c=s.hideHead,d=s.fixedWeeks,u=s.components,f=s.weekStartsOn,h=s.firstWeekContainsDate,m=s.ISOWeek,v=mWe(e.displayMonth,{useFixedWeeks:!!d,ISOWeek:m,locale:o,weekStartsOn:f,firstWeekContainsDate:h}),g=(t=u?.Head)!==null&&t!==void 0?t:EVe,y=(r=u?.Row)!==null&&r!==void 0?r:fWe,x=(n=u?.Footer)!==null&&n!==void 0?n:CVe;return a.jsxs("table",{id:e.id,className:i.table,style:l.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!c&&a.jsx(g,{}),a.jsx("tbody",{className:i.tbody,style:l.tbody,children:v.map(function(b){return a.jsx(y,{displayMonth:e.displayMonth,dates:b.dates,weekNumber:b.weekNumber},b.weekNumber)})}),a.jsx(x,{displayMonth:e.displayMonth})]})}function pWe(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var gWe=pWe()?p.useLayoutEffect:p.useEffect,xE=!1,vWe=0;function vz(){return"react-day-picker-".concat(++vWe)}function xWe(e){var t,r=e??(xE?vz():null),n=p.useState(r),s=n[0],o=n[1];return gWe(function(){s===null&&o(vz())},[]),p.useEffect(function(){xE===!1&&(xE=!0)},[]),(t=e??s)!==null&&t!==void 0?t:void 0}function yWe(e){var t,r,n=As(),s=n.dir,o=n.classNames,i=n.styles,l=n.components,c=B1().displayMonths,d=xWe(n.id?"".concat(n.id,"-").concat(e.displayIndex):void 0),u=n.id?"".concat(n.id,"-grid-").concat(e.displayIndex):void 0,f=[o.month],h=i.month,m=e.displayIndex===0,v=e.displayIndex===c.length-1,g=!m&&!v;s==="rtl"&&(t=[m,v],v=t[0],m=t[1]),m&&(f.push(o.caption_start),h=aa(aa({},h),i.caption_start)),v&&(f.push(o.caption_end),h=aa(aa({},h),i.caption_end)),g&&(f.push(o.caption_between),h=aa(aa({},h),i.caption_between));var y=(r=l?.Caption)!==null&&r!==void 0?r:SVe;return a.jsxs("div",{className:f.join(" "),style:h,children:[a.jsx(y,{id:d,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),a.jsx(hWe,{id:u,"aria-labelledby":d,displayMonth:e.displayMonth})]},e.displayIndex)}function bWe(e){var t=As(),r=t.classNames,n=t.styles;return a.jsx("div",{className:r.months,style:n.months,children:e.children})}function wWe(e){var t,r,n=e.initialProps,s=As(),o=BM(),i=B1(),l=p.useState(!1),c=l[0],d=l[1];p.useEffect(function(){s.initialFocus&&o.focusTarget&&(c||(o.focus(o.focusTarget),d(!0)))},[s.initialFocus,c,o.focus,o.focusTarget,o]);var u=[s.classNames.root,s.className];s.numberOfMonths>1&&u.push(s.classNames.multiple_months),s.showWeekNumber&&u.push(s.classNames.with_weeknumber);var f=aa(aa({},s.styles.root),s.style),h=Object.keys(n).filter(function(v){return v.startsWith("data-")}).reduce(function(v,g){var y;return aa(aa({},v),(y={},y[g]=n[g],y))},{}),m=(r=(t=n.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:bWe;return a.jsx("div",aa({className:u.join(" "),style:f,dir:s.dir,id:s.id,nonce:n.nonce,title:n.title,lang:n.lang},h,{children:a.jsx(m,{children:i.displayMonths.map(function(v,g){return a.jsx(yWe,{displayIndex:g,displayMonth:v},g)})})}))}function jWe(e){var t=e.children,r=HUe(e,["children"]);return a.jsx(uVe,{initialProps:r,children:a.jsx(wVe,{children:a.jsx(rWe,{initialProps:r,children:a.jsx(IVe,{initialProps:r,children:a.jsx(DVe,{initialProps:r,children:a.jsx(zVe,{children:a.jsx(eWe,{children:t})})})})})})})}function PT(e){return a.jsx(jWe,aa({},e,{children:a.jsx(wWe,{initialProps:e})}))}function yi({className:e,classNames:t,showOutsideDays:r=!0,weekStartsOn:n=1,locale:s=na,...o}){const i=["dom","seg","ter","qua","qui","sex","sb"];return a.jsx(PT,{showOutsideDays:r,weekStartsOn:n,locale:s,className:pr("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:pr(sw({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:pr(sw({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"text-muted-foreground opacity-50",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},formatters:{formatWeekdayName:(l,c)=>i[l.getDay()]},components:{IconLeft:({...l})=>a.jsx(XH,{className:"h-4 w-4"}),IconRight:({...l})=>a.jsx(j0,{className:"h-4 w-4"})},...o})}yi.displayName="Calendar";var Tee="AlertDialog",[_We,Qlt]=Ld(Tee,[wX]),mm=wX(),Dee=e=>{const{__scopeAlertDialog:t,...r}=e,n=mm(t);return a.jsx(LX,{...n,...r,modal:!0})};Dee.displayName=Tee;var NWe="AlertDialogTrigger",Mee=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=mm(r);return a.jsx(y0e,{...s,...n,ref:t})});Mee.displayName=NWe;var SWe="AlertDialogPortal",Ree=e=>{const{__scopeAlertDialog:t,...r}=e,n=mm(t);return a.jsx(FX,{...n,...r})};Ree.displayName=SWe;var CWe="AlertDialogOverlay",Lee=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=mm(r);return a.jsx(hD,{...s,...n,ref:t})});Lee.displayName=CWe;var vx="AlertDialogContent",[PWe,AWe]=_We(vx),EWe=mge("AlertDialogContent"),Fee=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,children:n,...s}=e,o=mm(r),i=p.useRef(null),l=$a(t,i),c=p.useRef(null);return a.jsx(p0e,{contentName:vx,titleName:$ee,docsSlug:"alert-dialog",children:a.jsx(PWe,{scope:r,cancelRef:c,children:a.jsxs(pD,{role:"alertdialog",...o,...s,ref:l,onOpenAutoFocus:gn(s.onOpenAutoFocus,d=>{d.preventDefault(),c.current?.focus({preventScroll:!0})}),onPointerDownOutside:d=>d.preventDefault(),onInteractOutside:d=>d.preventDefault(),children:[a.jsx(EWe,{children:n}),a.jsx(IWe,{contentRef:i})]})})})});Fee.displayName=vx;var $ee="AlertDialogTitle",Bee=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=mm(r);return a.jsx(gD,{...s,...n,ref:t})});Bee.displayName=$ee;var qee="AlertDialogDescription",zee=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=mm(r);return a.jsx(vD,{...s,...n,ref:t})});zee.displayName=qee;var kWe="AlertDialogAction",Uee=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,s=mm(r);return a.jsx(MC,{...s,...n,ref:t})});Uee.displayName=kWe;var Vee="AlertDialogCancel",Wee=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,{cancelRef:s}=AWe(Vee,r),o=mm(r),i=$a(t,s);return a.jsx(MC,{...o,...n,ref:i})});Wee.displayName=Vee;var IWe=({contentRef:e})=>{const t=`\`${vx}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${vx}\` by passing a \`${qee}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${vx}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return p.useEffect(()=>{document.getElementById(e.current?.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},OWe=Dee,TWe=Mee,DWe=Ree,Hee=Lee,Gee=Fee,Kee=Uee,Xee=Wee,Yee=Bee,Jee=zee;const au=OWe,Up=TWe,MWe=DWe,Qee=Pe.forwardRef(({className:e,...t},r)=>a.jsx(Hee,{className:pr("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));Qee.displayName=Hee.displayName;const md=Pe.forwardRef(({className:e,...t},r)=>a.jsxs(MWe,{children:[a.jsx(Qee,{}),a.jsx(Gee,{ref:r,className:pr("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));md.displayName=Gee.displayName;const hd=({className:e,...t})=>a.jsx("div",{className:pr("flex flex-col space-y-2 text-center sm:text-left",e),...t});hd.displayName="AlertDialogHeader";const pd=({className:e,...t})=>a.jsx("div",{className:pr("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});pd.displayName="AlertDialogFooter";const gd=Pe.forwardRef(({className:e,...t},r)=>a.jsx(Yee,{ref:r,className:pr("text-lg font-semibold",e),...t}));gd.displayName=Yee.displayName;const vd=Pe.forwardRef(({className:e,...t},r)=>a.jsx(Jee,{ref:r,className:pr("text-sm text-muted-foreground",e),...t}));vd.displayName=Jee.displayName;const su=Pe.forwardRef(({className:e,...t},r)=>a.jsx(Kee,{ref:r,className:pr(sw(),e),...t}));su.displayName=Kee.displayName;const xd=Pe.forwardRef(({className:e,...t},r)=>a.jsx(Xee,{ref:r,className:pr(sw({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));xd.displayName=Xee.displayName;function xz(e,[t,r]){return Math.min(r,Math.max(t,e))}function R5(e){const t=e+"CollectionProvider",[r,n]=Ld(t),[s,o]=r(t,{collectionRef:{current:null},itemMap:new Map}),i=g=>{const{scope:y,children:x}=g,b=Pe.useRef(null),w=Pe.useRef(new Map).current;return a.jsx(s,{scope:y,itemMap:w,collectionRef:b,children:x})};i.displayName=t;const l=e+"CollectionSlot",c=Th(l),d=Pe.forwardRef((g,y)=>{const{scope:x,children:b}=g,w=o(l,x),j=$a(y,w.collectionRef);return a.jsx(c,{ref:j,children:b})});d.displayName=l;const u=e+"CollectionItemSlot",f="data-radix-collection-item",h=Th(u),m=Pe.forwardRef((g,y)=>{const{scope:x,children:b,...w}=g,j=Pe.useRef(null),_=$a(y,j),S=o(u,x);return Pe.useEffect(()=>(S.itemMap.set(j,{ref:j,...w}),()=>void S.itemMap.delete(j))),a.jsx(h,{[f]:"",ref:_,children:b})});m.displayName=u;function v(g){const y=o(e+"CollectionConsumer",g);return Pe.useCallback(()=>{const b=y.collectionRef.current;if(!b)return[];const w=Array.from(b.querySelectorAll(`[${f}]`));return Array.from(y.itemMap.values()).sort((S,C)=>w.indexOf(S.ref.current)-w.indexOf(C.ref.current))},[y.collectionRef,y.itemMap])}return[{Provider:i,Slot:d,ItemSlot:m},v,n]}var RWe=p.createContext(void 0);function L5(e){const t=p.useContext(RWe);return e||t||"ltr"}function Zee(e){const t=p.useRef({value:e,previous:e});return p.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var ete=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),LWe="VisuallyHidden",zM=p.forwardRef((e,t)=>a.jsx(ta.span,{...e,ref:t,style:{...ete,...e.style}}));zM.displayName=LWe;var FWe=[" ","Enter","ArrowUp","ArrowDown"],$We=[" ","Enter"],Ng="Select",[F5,$5,BWe]=R5(Ng),[V0,Zlt]=Ld(Ng,[BWe,C0]),B5=C0(),[qWe,ep]=V0(Ng),[zWe,UWe]=V0(Ng),tte=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:s,onOpenChange:o,value:i,defaultValue:l,onValueChange:c,dir:d,name:u,autoComplete:f,disabled:h,required:m,form:v}=e,g=B5(t),[y,x]=p.useState(null),[b,w]=p.useState(null),[j,_]=p.useState(!1),S=L5(d),[C,P]=tm({prop:n,defaultProp:s??!1,onChange:o,caller:Ng}),[A,R]=tm({prop:i,defaultProp:l,onChange:c,caller:Ng}),O=p.useRef(null),I=y?v||!!y.closest("form"):!0,[M,D]=p.useState(new Set),U=Array.from(M).map(z=>z.props.value).join(";");return a.jsx(iD,{...g,children:a.jsxs(qWe,{required:m,scope:t,trigger:y,onTriggerChange:x,valueNode:b,onValueNodeChange:w,valueNodeHasChildren:j,onValueNodeHasChildrenChange:_,contentId:uu(),value:A,onValueChange:R,open:C,onOpenChange:P,dir:S,triggerPointerDownPosRef:O,disabled:h,children:[a.jsx(F5.Provider,{scope:t,children:a.jsx(zWe,{scope:e.__scopeSelect,onNativeOptionAdd:p.useCallback(z=>{D(W=>new Set(W).add(z))},[]),onNativeOptionRemove:p.useCallback(z=>{D(W=>{const $=new Set(W);return $.delete(z),$})},[]),children:r})}),I?a.jsxs(_te,{"aria-hidden":!0,required:m,tabIndex:-1,name:u,autoComplete:f,value:A,onChange:z=>R(z.target.value),disabled:h,form:v,children:[A===void 0?a.jsx("option",{value:""}):null,Array.from(M)]},U):null]})})};tte.displayName=Ng;var rte="SelectTrigger",nte=p.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...s}=e,o=B5(r),i=ep(rte,r),l=i.disabled||n,c=$a(t,i.onTriggerChange),d=$5(r),u=p.useRef("touch"),[f,h,m]=Ste(g=>{const y=d().filter(w=>!w.disabled),x=y.find(w=>w.value===i.value),b=Cte(y,g,x);b!==void 0&&i.onValueChange(b.value)}),v=g=>{l||(i.onOpenChange(!0),m()),g&&(i.triggerPointerDownPosRef.current={x:Math.round(g.pageX),y:Math.round(g.pageY)})};return a.jsx(EC,{asChild:!0,...o,children:a.jsx(ta.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":Nte(i.value)?"":void 0,...s,ref:c,onClick:gn(s.onClick,g=>{g.currentTarget.focus(),u.current!=="mouse"&&v(g)}),onPointerDown:gn(s.onPointerDown,g=>{u.current=g.pointerType;const y=g.target;y.hasPointerCapture(g.pointerId)&&y.releasePointerCapture(g.pointerId),g.button===0&&g.ctrlKey===!1&&g.pointerType==="mouse"&&(v(g),g.preventDefault())}),onKeyDown:gn(s.onKeyDown,g=>{const y=f.current!=="";!(g.ctrlKey||g.altKey||g.metaKey)&&g.key.length===1&&h(g.key),!(y&&g.key===" ")&&FWe.includes(g.key)&&(v(),g.preventDefault())})})})});nte.displayName=rte;var ate="SelectValue",ste=p.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:s,children:o,placeholder:i="",...l}=e,c=ep(ate,r),{onValueNodeHasChildrenChange:d}=c,u=o!==void 0,f=$a(t,c.onValueNodeChange);return qi(()=>{d(u)},[d,u]),a.jsx(ta.span,{...l,ref:f,style:{pointerEvents:"none"},children:Nte(c.value)?a.jsx(a.Fragment,{children:i}):o})});ste.displayName=ate;var VWe="SelectIcon",ote=p.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...s}=e;return a.jsx(ta.span,{"aria-hidden":!0,...s,ref:t,children:n||""})});ote.displayName=VWe;var WWe="SelectPortal",ite=e=>a.jsx(P0,{asChild:!0,...e});ite.displayName=WWe;var Sg="SelectContent",lte=p.forwardRef((e,t)=>{const r=ep(Sg,e.__scopeSelect),[n,s]=p.useState();if(qi(()=>{s(new DocumentFragment)},[]),!r.open){const o=n;return o?im.createPortal(a.jsx(cte,{scope:e.__scopeSelect,children:a.jsx(F5.Slot,{scope:e.__scopeSelect,children:a.jsx("div",{children:e.children})})}),o):null}return a.jsx(dte,{...e,ref:t})});lte.displayName=Sg;var Jd=10,[cte,tp]=V0(Sg),HWe="SelectContentImpl",GWe=Th("SelectContent.RemoveScroll"),dte=p.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:o,onPointerDownOutside:i,side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:f,collisionBoundary:h,collisionPadding:m,sticky:v,hideWhenDetached:g,avoidCollisions:y,...x}=e,b=ep(Sg,r),[w,j]=p.useState(null),[_,S]=p.useState(null),C=$a(t,Y=>j(Y)),[P,A]=p.useState(null),[R,O]=p.useState(null),I=$5(r),[M,D]=p.useState(!1),U=p.useRef(!1);p.useEffect(()=>{if(w)return kC(w)},[w]),SC();const z=p.useCallback(Y=>{const[ce,...me]=I().map(ue=>ue.ref.current),[ae]=me.slice(-1),le=document.activeElement;for(const ue of Y)if(ue===le||(ue?.scrollIntoView({block:"nearest"}),ue===ce&&_&&(_.scrollTop=0),ue===ae&&_&&(_.scrollTop=_.scrollHeight),ue?.focus(),document.activeElement!==le))return},[I,_]),W=p.useCallback(()=>z([P,w]),[z,P,w]);p.useEffect(()=>{M&&W()},[M,W]);const{onOpenChange:$,triggerPointerDownPosRef:X}=b;p.useEffect(()=>{if(w){let Y={x:0,y:0};const ce=ae=>{Y={x:Math.abs(Math.round(ae.pageX)-(X.current?.x??0)),y:Math.abs(Math.round(ae.pageY)-(X.current?.y??0))}},me=ae=>{Y.x<=10&&Y.y<=10?ae.preventDefault():w.contains(ae.target)||$(!1),document.removeEventListener("pointermove",ce),X.current=null};return X.current!==null&&(document.addEventListener("pointermove",ce),document.addEventListener("pointerup",me,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ce),document.removeEventListener("pointerup",me,{capture:!0})}}},[w,$,X]),p.useEffect(()=>{const Y=()=>$(!1);return window.addEventListener("blur",Y),window.addEventListener("resize",Y),()=>{window.removeEventListener("blur",Y),window.removeEventListener("resize",Y)}},[$]);const[ye,Se]=Ste(Y=>{const ce=I().filter(le=>!le.disabled),me=ce.find(le=>le.ref.current===document.activeElement),ae=Cte(ce,Y,me);ae&&setTimeout(()=>ae.ref.current.focus())}),V=p.useCallback((Y,ce,me)=>{const ae=!U.current&&!me;(b.value!==void 0&&b.value===ce||ae)&&(A(Y),ae&&(U.current=!0))},[b.value]),B=p.useCallback(()=>w?.focus(),[w]),Q=p.useCallback((Y,ce,me)=>{const ae=!U.current&&!me;(b.value!==void 0&&b.value===ce||ae)&&O(Y)},[b.value]),pe=n==="popper"?AT:ute,te=pe===AT?{side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:f,collisionBoundary:h,collisionPadding:m,sticky:v,hideWhenDetached:g,avoidCollisions:y}:{};return a.jsx(cte,{scope:r,content:w,viewport:_,onViewportChange:S,itemRefCallback:V,selectedItem:P,onItemLeave:B,itemTextRefCallback:Q,focusSelectedItem:W,selectedItemText:R,position:n,isPositioned:M,searchRef:ye,children:a.jsx(OC,{as:GWe,allowPinchZoom:!0,children:a.jsx(N1,{asChild:!0,trapped:b.open,onMountAutoFocus:Y=>{Y.preventDefault()},onUnmountAutoFocus:gn(s,Y=>{b.trigger?.focus({preventScroll:!0}),Y.preventDefault()}),children:a.jsx(_0,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:Y=>Y.preventDefault(),onDismiss:()=>b.onOpenChange(!1),children:a.jsx(pe,{role:"listbox",id:b.contentId,"data-state":b.open?"open":"closed",dir:b.dir,onContextMenu:Y=>Y.preventDefault(),...x,...te,onPlaced:()=>D(!0),ref:C,style:{display:"flex",flexDirection:"column",outline:"none",...x.style},onKeyDown:gn(x.onKeyDown,Y=>{const ce=Y.ctrlKey||Y.altKey||Y.metaKey;if(Y.key==="Tab"&&Y.preventDefault(),!ce&&Y.key.length===1&&Se(Y.key),["ArrowUp","ArrowDown","Home","End"].includes(Y.key)){let ae=I().filter(le=>!le.disabled).map(le=>le.ref.current);if(["ArrowUp","End"].includes(Y.key)&&(ae=ae.slice().reverse()),["ArrowUp","ArrowDown"].includes(Y.key)){const le=Y.target,ue=ae.indexOf(le);ae=ae.slice(ue+1)}setTimeout(()=>z(ae)),Y.preventDefault()}})})})})})})});dte.displayName=HWe;var KWe="SelectItemAlignedPosition",ute=p.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...s}=e,o=ep(Sg,r),i=tp(Sg,r),[l,c]=p.useState(null),[d,u]=p.useState(null),f=$a(t,C=>u(C)),h=$5(r),m=p.useRef(!1),v=p.useRef(!0),{viewport:g,selectedItem:y,selectedItemText:x,focusSelectedItem:b}=i,w=p.useCallback(()=>{if(o.trigger&&o.valueNode&&l&&d&&g&&y&&x){const C=o.trigger.getBoundingClientRect(),P=d.getBoundingClientRect(),A=o.valueNode.getBoundingClientRect(),R=x.getBoundingClientRect();if(o.dir!=="rtl"){const le=R.left-P.left,ue=A.left-le,Re=C.left-ue,ne=C.width+Re,ie=Math.max(ne,P.width),gt=window.innerWidth-Jd,bt=xz(ue,[Jd,Math.max(Jd,gt-ie)]);l.style.minWidth=ne+"px",l.style.left=bt+"px"}else{const le=P.right-R.right,ue=window.innerWidth-A.right-le,Re=window.innerWidth-C.right-ue,ne=C.width+Re,ie=Math.max(ne,P.width),gt=window.innerWidth-Jd,bt=xz(ue,[Jd,Math.max(Jd,gt-ie)]);l.style.minWidth=ne+"px",l.style.right=bt+"px"}const O=h(),I=window.innerHeight-Jd*2,M=g.scrollHeight,D=window.getComputedStyle(d),U=parseInt(D.borderTopWidth,10),z=parseInt(D.paddingTop,10),W=parseInt(D.borderBottomWidth,10),$=parseInt(D.paddingBottom,10),X=U+z+M+$+W,ye=Math.min(y.offsetHeight*5,X),Se=window.getComputedStyle(g),V=parseInt(Se.paddingTop,10),B=parseInt(Se.paddingBottom,10),Q=C.top+C.height/2-Jd,pe=I-Q,te=y.offsetHeight/2,Y=y.offsetTop+te,ce=U+z+Y,me=X-ce;if(ce<=Q){const le=O.length>0&&y===O[O.length-1].ref.current;l.style.bottom="0px";const ue=d.clientHeight-g.offsetTop-g.offsetHeight,Re=Math.max(pe,te+(le?B:0)+ue+W),ne=ce+Re;l.style.height=ne+"px"}else{const le=O.length>0&&y===O[0].ref.current;l.style.top="0px";const Re=Math.max(Q,U+g.offsetTop+(le?V:0)+te)+me;l.style.height=Re+"px",g.scrollTop=ce-Q+g.offsetTop}l.style.margin=`${Jd}px 0`,l.style.minHeight=ye+"px",l.style.maxHeight=I+"px",n?.(),requestAnimationFrame(()=>m.current=!0)}},[h,o.trigger,o.valueNode,l,d,g,y,x,o.dir,n]);qi(()=>w(),[w]);const[j,_]=p.useState();qi(()=>{d&&_(window.getComputedStyle(d).zIndex)},[d]);const S=p.useCallback(C=>{C&&v.current===!0&&(w(),b?.(),v.current=!1)},[w,b]);return a.jsx(YWe,{scope:r,contentWrapper:l,shouldExpandOnScrollRef:m,onScrollButtonChange:S,children:a.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:j},children:a.jsx(ta.div,{...s,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});ute.displayName=KWe;var XWe="SelectPopperPosition",AT=p.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:s=Jd,...o}=e,i=B5(r);return a.jsx(lD,{...i,...o,ref:t,align:n,collisionPadding:s,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});AT.displayName=XWe;var[YWe,UM]=V0(Sg,{}),ET="SelectViewport",fte=p.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...s}=e,o=tp(ET,r),i=UM(ET,r),l=$a(t,o.onViewportChange),c=p.useRef(0);return a.jsxs(a.Fragment,{children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),a.jsx(F5.Slot,{scope:r,children:a.jsx(ta.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:gn(s.onScroll,d=>{const u=d.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:h}=i;if(h?.current&&f){const m=Math.abs(c.current-u.scrollTop);if(m>0){const v=window.innerHeight-Jd*2,g=parseFloat(f.style.minHeight),y=parseFloat(f.style.height),x=Math.max(g,y);if(x<v){const b=x+m,w=Math.min(v,b),j=b-w;f.style.height=w+"px",f.style.bottom==="0px"&&(u.scrollTop=j>0?j:0,f.style.justifyContent="flex-end")}}}c.current=u.scrollTop})})})]})});fte.displayName=ET;var mte="SelectGroup",[JWe,QWe]=V0(mte),ZWe=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=uu();return a.jsx(JWe,{scope:r,id:s,children:a.jsx(ta.div,{role:"group","aria-labelledby":s,...n,ref:t})})});ZWe.displayName=mte;var hte="SelectLabel",pte=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=QWe(hte,r);return a.jsx(ta.div,{id:s.id,...n,ref:t})});pte.displayName=hte;var bS="SelectItem",[eHe,gte]=V0(bS),vte=p.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:s=!1,textValue:o,...i}=e,l=ep(bS,r),c=tp(bS,r),d=l.value===n,[u,f]=p.useState(o??""),[h,m]=p.useState(!1),v=$a(t,b=>c.itemRefCallback?.(b,n,s)),g=uu(),y=p.useRef("touch"),x=()=>{s||(l.onValueChange(n),l.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return a.jsx(eHe,{scope:r,value:n,disabled:s,textId:g,isSelected:d,onItemTextChange:p.useCallback(b=>{f(w=>w||(b?.textContent??"").trim())},[]),children:a.jsx(F5.ItemSlot,{scope:r,value:n,disabled:s,textValue:u,children:a.jsx(ta.div,{role:"option","aria-labelledby":g,"data-highlighted":h?"":void 0,"aria-selected":d&&h,"data-state":d?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...i,ref:v,onFocus:gn(i.onFocus,()=>m(!0)),onBlur:gn(i.onBlur,()=>m(!1)),onClick:gn(i.onClick,()=>{y.current!=="mouse"&&x()}),onPointerUp:gn(i.onPointerUp,()=>{y.current==="mouse"&&x()}),onPointerDown:gn(i.onPointerDown,b=>{y.current=b.pointerType}),onPointerMove:gn(i.onPointerMove,b=>{y.current=b.pointerType,s?c.onItemLeave?.():y.current==="mouse"&&b.currentTarget.focus({preventScroll:!0})}),onPointerLeave:gn(i.onPointerLeave,b=>{b.currentTarget===document.activeElement&&c.onItemLeave?.()}),onKeyDown:gn(i.onKeyDown,b=>{c.searchRef?.current!==""&&b.key===" "||($We.includes(b.key)&&x(),b.key===" "&&b.preventDefault())})})})})});vte.displayName=bS;var zy="SelectItemText",xte=p.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:s,...o}=e,i=ep(zy,r),l=tp(zy,r),c=gte(zy,r),d=UWe(zy,r),[u,f]=p.useState(null),h=$a(t,x=>f(x),c.onItemTextChange,x=>l.itemTextRefCallback?.(x,c.value,c.disabled)),m=u?.textContent,v=p.useMemo(()=>a.jsx("option",{value:c.value,disabled:c.disabled,children:m},c.value),[c.disabled,c.value,m]),{onNativeOptionAdd:g,onNativeOptionRemove:y}=d;return qi(()=>(g(v),()=>y(v)),[g,y,v]),a.jsxs(a.Fragment,{children:[a.jsx(ta.span,{id:c.textId,...o,ref:h}),c.isSelected&&i.valueNode&&!i.valueNodeHasChildren?im.createPortal(o.children,i.valueNode):null]})});xte.displayName=zy;var yte="SelectItemIndicator",bte=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return gte(yte,r).isSelected?a.jsx(ta.span,{"aria-hidden":!0,...n,ref:t}):null});bte.displayName=yte;var kT="SelectScrollUpButton",tHe=p.forwardRef((e,t)=>{const r=tp(kT,e.__scopeSelect),n=UM(kT,e.__scopeSelect),[s,o]=p.useState(!1),i=$a(t,n.onScrollButtonChange);return qi(()=>{if(r.viewport&&r.isPositioned){let l=function(){const d=c.scrollTop>0;o(d)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),s?a.jsx(wte,{...e,ref:i,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}}):null});tHe.displayName=kT;var IT="SelectScrollDownButton",rHe=p.forwardRef((e,t)=>{const r=tp(IT,e.__scopeSelect),n=UM(IT,e.__scopeSelect),[s,o]=p.useState(!1),i=$a(t,n.onScrollButtonChange);return qi(()=>{if(r.viewport&&r.isPositioned){let l=function(){const d=c.scrollHeight-c.clientHeight,u=Math.ceil(c.scrollTop)<d;o(u)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),s?a.jsx(wte,{...e,ref:i,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}}):null});rHe.displayName=IT;var wte=p.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...s}=e,o=tp("SelectScrollButton",r),i=p.useRef(null),l=$5(r),c=p.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return p.useEffect(()=>()=>c(),[c]),qi(()=>{l().find(u=>u.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[l]),a.jsx(ta.div,{"aria-hidden":!0,...s,ref:t,style:{flexShrink:0,...s.style},onPointerDown:gn(s.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(n,50))}),onPointerMove:gn(s.onPointerMove,()=>{o.onItemLeave?.(),i.current===null&&(i.current=window.setInterval(n,50))}),onPointerLeave:gn(s.onPointerLeave,()=>{c()})})}),nHe="SelectSeparator",jte=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return a.jsx(ta.div,{"aria-hidden":!0,...n,ref:t})});jte.displayName=nHe;var OT="SelectArrow",aHe=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=B5(r),o=ep(OT,r),i=tp(OT,r);return o.open&&i.position==="popper"?a.jsx(cD,{...s,...n,ref:t}):null});aHe.displayName=OT;var sHe="SelectBubbleInput",_te=p.forwardRef(({__scopeSelect:e,value:t,...r},n)=>{const s=p.useRef(null),o=$a(n,s),i=Zee(t);return p.useEffect(()=>{const l=s.current;if(!l)return;const c=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(c,"value").set;if(i!==t&&u){const f=new Event("change",{bubbles:!0});u.call(l,t),l.dispatchEvent(f)}},[i,t]),a.jsx(ta.select,{...r,style:{...ete,...r.style},ref:o,defaultValue:t})});_te.displayName=sHe;function Nte(e){return e===""||e===void 0}function Ste(e){const t=cc(e),r=p.useRef(""),n=p.useRef(0),s=p.useCallback(i=>{const l=r.current+i;t(l),function c(d){r.current=d,window.clearTimeout(n.current),d!==""&&(n.current=window.setTimeout(()=>c(""),1e3))}(l)},[t]),o=p.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return p.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,s,o]}function Cte(e,t,r){const s=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,o=r?e.indexOf(r):-1;let i=oHe(e,Math.max(o,0));s.length===1&&(i=i.filter(d=>d!==r));const c=i.find(d=>d.textValue.toLowerCase().startsWith(s.toLowerCase()));return c!==r?c:void 0}function oHe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var iHe=tte,Pte=nte,lHe=ste,cHe=ote,dHe=ite,Ate=lte,uHe=fte,Ete=pte,kte=vte,fHe=xte,mHe=bte,Ite=jte;const vn=iHe,wn=lHe,hn=Pe.forwardRef(({className:e,children:t,...r},n)=>a.jsxs(Pte,{ref:n,className:pr("flex h-10 w-full items-center justify-between rounded-md border border-input bg-transparent px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground hover:bg-surface-2/30 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-colors duration-150",e),...r,children:[t,a.jsx(cHe,{asChild:!0,children:a.jsx(Tg,{className:"h-4 w-4 opacity-50"})})]}));hn.displayName=Pte.displayName;const pn=Pe.forwardRef(({className:e,children:t,position:r="popper",...n},s)=>a.jsx(dHe,{children:a.jsx(Ate,{ref:s,className:pr("relative z-50 min-w-[8rem] max-h-[340px] overflow-auto fx-scroll rounded-md border bg-popover text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:a.jsx(uHe,{className:pr("p-1",r==="popper"&&"w-full min-w-[var(--radix-select-trigger-width)]"),children:t})})}));pn.displayName=Ate.displayName;const hHe=Pe.forwardRef(({className:e,...t},r)=>a.jsx(Ete,{ref:r,className:pr("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));hHe.displayName=Ete.displayName;const ct=Pe.forwardRef(({className:e,children:t,...r},n)=>a.jsxs(kte,{ref:n,className:pr("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none hover:bg-surface-2/50 focus:bg-surface-2/50 data-[state=checked]:bg-surface-2/50 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 transition-colors",e),...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(mHe,{children:a.jsx(Yf,{className:"h-4 w-4"})})}),a.jsx(fHe,{children:t})]}));ct.displayName=kte.displayName;const pHe=Pe.forwardRef(({className:e,...t},r)=>a.jsx(Ite,{ref:r,className:pr("-mx-1 my-1 h-px bg-muted",e),...t}));pHe.displayName=Ite.displayName;var q5="Checkbox",[gHe,ect]=Ld(q5),[vHe,VM]=gHe(q5);function xHe(e){const{__scopeCheckbox:t,checked:r,children:n,defaultChecked:s,disabled:o,form:i,name:l,onCheckedChange:c,required:d,value:u="on",internal_do_not_use_render:f}=e,[h,m]=tm({prop:r,defaultProp:s??!1,onChange:c,caller:q5}),[v,g]=p.useState(null),[y,x]=p.useState(null),b=p.useRef(!1),w=v?!!i||!!v.closest("form"):!0,j={checked:h,disabled:o,setChecked:m,control:v,setControl:g,name:l,form:i,value:u,hasConsumerStoppedPropagationRef:b,required:d,defaultChecked:bh(s)?!1:s,isFormControl:w,bubbleInput:y,setBubbleInput:x};return a.jsx(vHe,{scope:t,...j,children:yHe(f)?f(j):n})}var Ote="CheckboxTrigger",Tte=p.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:r,...n},s)=>{const{control:o,value:i,disabled:l,checked:c,required:d,setControl:u,setChecked:f,hasConsumerStoppedPropagationRef:h,isFormControl:m,bubbleInput:v}=VM(Ote,e),g=$a(s,u),y=p.useRef(c);return p.useEffect(()=>{const x=o?.form;if(x){const b=()=>f(y.current);return x.addEventListener("reset",b),()=>x.removeEventListener("reset",b)}},[o,f]),a.jsx(ta.button,{type:"button",role:"checkbox","aria-checked":bh(c)?"mixed":c,"aria-required":d,"data-state":Fte(c),"data-disabled":l?"":void 0,disabled:l,value:i,...n,ref:g,onKeyDown:gn(t,x=>{x.key==="Enter"&&x.preventDefault()}),onClick:gn(r,x=>{f(b=>bh(b)?!0:!b),v&&m&&(h.current=x.isPropagationStopped(),h.current||x.stopPropagation())})})});Tte.displayName=Ote;var WM=p.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:n,checked:s,defaultChecked:o,required:i,disabled:l,value:c,onCheckedChange:d,form:u,...f}=e;return a.jsx(xHe,{__scopeCheckbox:r,checked:s,defaultChecked:o,disabled:l,required:i,onCheckedChange:d,name:n,form:u,value:c,internal_do_not_use_render:({isFormControl:h})=>a.jsxs(a.Fragment,{children:[a.jsx(Tte,{...f,ref:t,__scopeCheckbox:r}),h&&a.jsx(Lte,{__scopeCheckbox:r})]})})});WM.displayName=q5;var Dte="CheckboxIndicator",Mte=p.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:n,...s}=e,o=VM(Dte,r);return a.jsx(Yc,{present:n||bh(o.checked)||o.checked===!0,children:a.jsx(ta.span,{"data-state":Fte(o.checked),"data-disabled":o.disabled?"":void 0,...s,ref:t,style:{pointerEvents:"none",...e.style}})})});Mte.displayName=Dte;var Rte="CheckboxBubbleInput",Lte=p.forwardRef(({__scopeCheckbox:e,...t},r)=>{const{control:n,hasConsumerStoppedPropagationRef:s,checked:o,defaultChecked:i,required:l,disabled:c,name:d,value:u,form:f,bubbleInput:h,setBubbleInput:m}=VM(Rte,e),v=$a(r,m),g=Zee(o),y=VK(n);p.useEffect(()=>{const b=h;if(!b)return;const w=window.HTMLInputElement.prototype,_=Object.getOwnPropertyDescriptor(w,"checked").set,S=!s.current;if(g!==o&&_){const C=new Event("click",{bubbles:S});b.indeterminate=bh(o),_.call(b,bh(o)?!1:o),b.dispatchEvent(C)}},[h,g,o,s]);const x=p.useRef(bh(o)?!1:o);return a.jsx(ta.input,{type:"checkbox","aria-hidden":!0,defaultChecked:i??x.current,required:l,disabled:c,name:d,value:u,form:f,...t,tabIndex:-1,ref:v,style:{...t.style,...y,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});Lte.displayName=Rte;function yHe(e){return typeof e=="function"}function bh(e){return e==="indeterminate"}function Fte(e){return bh(e)?"indeterminate":e?"checked":"unchecked"}const za=Pe.forwardRef(({className:e,...t},r)=>a.jsx(WM,{ref:r,className:pr("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:a.jsx(Mte,{className:pr("flex items-center justify-center text-current"),children:a.jsx(Yf,{className:"h-4 w-4"})})}));za.displayName=WM.displayName;var yE="rovingFocusGroup.onEntryFocus",bHe={bubbles:!1,cancelable:!0},q1="RovingFocusGroup",[TT,$te,wHe]=R5(q1),[jHe,z5]=Ld(q1,[wHe]),[_He,NHe]=jHe(q1),Bte=p.forwardRef((e,t)=>a.jsx(TT.Provider,{scope:e.__scopeRovingFocusGroup,children:a.jsx(TT.Slot,{scope:e.__scopeRovingFocusGroup,children:a.jsx(SHe,{...e,ref:t})})}));Bte.displayName=q1;var SHe=p.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:s=!1,dir:o,currentTabStopId:i,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:d,preventScrollOnEntryFocus:u=!1,...f}=e,h=p.useRef(null),m=$a(t,h),v=L5(o),[g,y]=tm({prop:i,defaultProp:l??null,onChange:c,caller:q1}),[x,b]=p.useState(!1),w=cc(d),j=$te(r),_=p.useRef(!1),[S,C]=p.useState(0);return p.useEffect(()=>{const P=h.current;if(P)return P.addEventListener(yE,w),()=>P.removeEventListener(yE,w)},[w]),a.jsx(_He,{scope:r,orientation:n,dir:v,loop:s,currentTabStopId:g,onItemFocus:p.useCallback(P=>y(P),[y]),onItemShiftTab:p.useCallback(()=>b(!0),[]),onFocusableItemAdd:p.useCallback(()=>C(P=>P+1),[]),onFocusableItemRemove:p.useCallback(()=>C(P=>P-1),[]),children:a.jsx(ta.div,{tabIndex:x||S===0?-1:0,"data-orientation":n,...f,ref:m,style:{outline:"none",...e.style},onMouseDown:gn(e.onMouseDown,()=>{_.current=!0}),onFocus:gn(e.onFocus,P=>{const A=!_.current;if(P.target===P.currentTarget&&A&&!x){const R=new CustomEvent(yE,bHe);if(P.currentTarget.dispatchEvent(R),!R.defaultPrevented){const O=j().filter(z=>z.focusable),I=O.find(z=>z.active),M=O.find(z=>z.id===g),U=[I,M,...O].filter(Boolean).map(z=>z.ref.current);Ute(U,u)}}_.current=!1}),onBlur:gn(e.onBlur,()=>b(!1))})})}),qte="RovingFocusGroupItem",zte=p.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:s=!1,tabStopId:o,children:i,...l}=e,c=uu(),d=o||c,u=NHe(qte,r),f=u.currentTabStopId===d,h=$te(r),{onFocusableItemAdd:m,onFocusableItemRemove:v,currentTabStopId:g}=u;return p.useEffect(()=>{if(n)return m(),()=>v()},[n,m,v]),a.jsx(TT.ItemSlot,{scope:r,id:d,focusable:n,active:s,children:a.jsx(ta.span,{tabIndex:f?0:-1,"data-orientation":u.orientation,...l,ref:t,onMouseDown:gn(e.onMouseDown,y=>{n?u.onItemFocus(d):y.preventDefault()}),onFocus:gn(e.onFocus,()=>u.onItemFocus(d)),onKeyDown:gn(e.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){u.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const x=AHe(y,u.orientation,u.dir);if(x!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let w=h().filter(j=>j.focusable).map(j=>j.ref.current);if(x==="last")w.reverse();else if(x==="prev"||x==="next"){x==="prev"&&w.reverse();const j=w.indexOf(y.currentTarget);w=u.loop?EHe(w,j+1):w.slice(j+1)}setTimeout(()=>Ute(w))}}),children:typeof i=="function"?i({isCurrentTabStop:f,hasTabStop:g!=null}):i})})});zte.displayName=qte;var CHe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function PHe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function AHe(e,t,r){const n=PHe(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return CHe[n]}function Ute(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function EHe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var Vte=Bte,Wte=zte,DT=["Enter"," "],kHe=["ArrowDown","PageUp","Home"],Hte=["ArrowUp","PageDown","End"],IHe=[...kHe,...Hte],OHe={ltr:[...DT,"ArrowRight"],rtl:[...DT,"ArrowLeft"]},THe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},z1="Menu",[Kw,DHe,MHe]=R5(z1),[Ug,Gte]=Ld(z1,[MHe,C0,z5]),U5=C0(),Kte=z5(),[RHe,Vg]=Ug(z1),[LHe,U1]=Ug(z1),Xte=e=>{const{__scopeMenu:t,open:r=!1,children:n,dir:s,onOpenChange:o,modal:i=!0}=e,l=U5(t),[c,d]=p.useState(null),u=p.useRef(!1),f=cc(o),h=L5(s);return p.useEffect(()=>{const m=()=>{u.current=!0,document.addEventListener("pointerdown",v,{capture:!0,once:!0}),document.addEventListener("pointermove",v,{capture:!0,once:!0})},v=()=>u.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",v,{capture:!0}),document.removeEventListener("pointermove",v,{capture:!0})}},[]),a.jsx(iD,{...l,children:a.jsx(RHe,{scope:t,open:r,onOpenChange:f,content:c,onContentChange:d,children:a.jsx(LHe,{scope:t,onClose:p.useCallback(()=>f(!1),[f]),isUsingKeyboardRef:u,dir:h,modal:i,children:n})})})};Xte.displayName=z1;var FHe="MenuAnchor",HM=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,s=U5(r);return a.jsx(EC,{...s,...n,ref:t})});HM.displayName=FHe;var GM="MenuPortal",[$He,Yte]=Ug(GM,{forceMount:void 0}),Jte=e=>{const{__scopeMenu:t,forceMount:r,children:n,container:s}=e,o=Vg(GM,t);return a.jsx($He,{scope:t,forceMount:r,children:a.jsx(Yc,{present:r||o.open,children:a.jsx(P0,{asChild:!0,container:s,children:n})})})};Jte.displayName=GM;var Ed="MenuContent",[BHe,KM]=Ug(Ed),Qte=p.forwardRef((e,t)=>{const r=Yte(Ed,e.__scopeMenu),{forceMount:n=r.forceMount,...s}=e,o=Vg(Ed,e.__scopeMenu),i=U1(Ed,e.__scopeMenu);return a.jsx(Kw.Provider,{scope:e.__scopeMenu,children:a.jsx(Yc,{present:n||o.open,children:a.jsx(Kw.Slot,{scope:e.__scopeMenu,children:i.modal?a.jsx(qHe,{...s,ref:t}):a.jsx(zHe,{...s,ref:t})})})})}),qHe=p.forwardRef((e,t)=>{const r=Vg(Ed,e.__scopeMenu),n=p.useRef(null),s=$a(t,n);return p.useEffect(()=>{const o=n.current;if(o)return kC(o)},[]),a.jsx(XM,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:gn(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),zHe=p.forwardRef((e,t)=>{const r=Vg(Ed,e.__scopeMenu);return a.jsx(XM,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),UHe=Th("MenuContent.ScrollLock"),XM=p.forwardRef((e,t)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:s,onOpenAutoFocus:o,onCloseAutoFocus:i,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:h,onDismiss:m,disableOutsideScroll:v,...g}=e,y=Vg(Ed,r),x=U1(Ed,r),b=U5(r),w=Kte(r),j=DHe(r),[_,S]=p.useState(null),C=p.useRef(null),P=$a(t,C,y.onContentChange),A=p.useRef(0),R=p.useRef(""),O=p.useRef(0),I=p.useRef(null),M=p.useRef("right"),D=p.useRef(0),U=v?OC:p.Fragment,z=v?{as:UHe,allowPinchZoom:!0}:void 0,W=X=>{const ye=R.current+X,Se=j().filter(Y=>!Y.disabled),V=document.activeElement,B=Se.find(Y=>Y.ref.current===V)?.textValue,Q=Se.map(Y=>Y.textValue),pe=tGe(Q,ye,B),te=Se.find(Y=>Y.textValue===pe)?.ref.current;(function Y(ce){R.current=ce,window.clearTimeout(A.current),ce!==""&&(A.current=window.setTimeout(()=>Y(""),1e3))})(ye),te&&setTimeout(()=>te.focus())};p.useEffect(()=>()=>window.clearTimeout(A.current),[]),SC();const $=p.useCallback(X=>M.current===I.current?.side&&nGe(X,I.current?.area),[]);return a.jsx(BHe,{scope:r,searchRef:R,onItemEnter:p.useCallback(X=>{$(X)&&X.preventDefault()},[$]),onItemLeave:p.useCallback(X=>{$(X)||(C.current?.focus(),S(null))},[$]),onTriggerLeave:p.useCallback(X=>{$(X)&&X.preventDefault()},[$]),pointerGraceTimerRef:O,onPointerGraceIntentChange:p.useCallback(X=>{I.current=X},[]),children:a.jsx(U,{...z,children:a.jsx(N1,{asChild:!0,trapped:s,onMountAutoFocus:gn(o,X=>{X.preventDefault(),C.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:a.jsx(_0,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:h,onDismiss:m,children:a.jsx(Vte,{asChild:!0,...w,dir:x.dir,orientation:"vertical",loop:n,currentTabStopId:_,onCurrentTabStopIdChange:S,onEntryFocus:gn(c,X=>{x.isUsingKeyboardRef.current||X.preventDefault()}),preventScrollOnEntryFocus:!0,children:a.jsx(lD,{role:"menu","aria-orientation":"vertical","data-state":hre(y.open),"data-radix-menu-content":"",dir:x.dir,...b,...g,ref:P,style:{outline:"none",...g.style},onKeyDown:gn(g.onKeyDown,X=>{const Se=X.target.closest("[data-radix-menu-content]")===X.currentTarget,V=X.ctrlKey||X.altKey||X.metaKey,B=X.key.length===1;Se&&(X.key==="Tab"&&X.preventDefault(),!V&&B&&W(X.key));const Q=C.current;if(X.target!==Q||!IHe.includes(X.key))return;X.preventDefault();const te=j().filter(Y=>!Y.disabled).map(Y=>Y.ref.current);Hte.includes(X.key)&&te.reverse(),ZHe(te)}),onBlur:gn(e.onBlur,X=>{X.currentTarget.contains(X.target)||(window.clearTimeout(A.current),R.current="")}),onPointerMove:gn(e.onPointerMove,Xw(X=>{const ye=X.target,Se=D.current!==X.clientX;if(X.currentTarget.contains(ye)&&Se){const V=X.clientX>D.current?"right":"left";M.current=V,D.current=X.clientX}}))})})})})})})});Qte.displayName=Ed;var VHe="MenuGroup",YM=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return a.jsx(ta.div,{role:"group",...n,ref:t})});YM.displayName=VHe;var WHe="MenuLabel",Zte=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return a.jsx(ta.div,{...n,ref:t})});Zte.displayName=WHe;var wS="MenuItem",yz="menu.itemSelect",V5=p.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:n,...s}=e,o=p.useRef(null),i=U1(wS,e.__scopeMenu),l=KM(wS,e.__scopeMenu),c=$a(t,o),d=p.useRef(!1),u=()=>{const f=o.current;if(!r&&f){const h=new CustomEvent(yz,{bubbles:!0,cancelable:!0});f.addEventListener(yz,m=>n?.(m),{once:!0}),J4(f,h),h.defaultPrevented?d.current=!1:i.onClose()}};return a.jsx(ere,{...s,ref:c,disabled:r,onClick:gn(e.onClick,u),onPointerDown:f=>{e.onPointerDown?.(f),d.current=!0},onPointerUp:gn(e.onPointerUp,f=>{d.current||f.currentTarget?.click()}),onKeyDown:gn(e.onKeyDown,f=>{const h=l.searchRef.current!=="";r||h&&f.key===" "||DT.includes(f.key)&&(f.currentTarget.click(),f.preventDefault())})})});V5.displayName=wS;var ere=p.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:n=!1,textValue:s,...o}=e,i=KM(wS,r),l=Kte(r),c=p.useRef(null),d=$a(t,c),[u,f]=p.useState(!1),[h,m]=p.useState("");return p.useEffect(()=>{const v=c.current;v&&m((v.textContent??"").trim())},[o.children]),a.jsx(Kw.ItemSlot,{scope:r,disabled:n,textValue:s??h,children:a.jsx(Wte,{asChild:!0,...l,focusable:!n,children:a.jsx(ta.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...o,ref:d,onPointerMove:gn(e.onPointerMove,Xw(v=>{n?i.onItemLeave(v):(i.onItemEnter(v),v.defaultPrevented||v.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:gn(e.onPointerLeave,Xw(v=>i.onItemLeave(v))),onFocus:gn(e.onFocus,()=>f(!0)),onBlur:gn(e.onBlur,()=>f(!1))})})})}),HHe="MenuCheckboxItem",tre=p.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:n,...s}=e;return a.jsx(ore,{scope:e.__scopeMenu,checked:r,children:a.jsx(V5,{role:"menuitemcheckbox","aria-checked":jS(r)?"mixed":r,...s,ref:t,"data-state":QM(r),onSelect:gn(s.onSelect,()=>n?.(jS(r)?!0:!r),{checkForDefaultPrevented:!1})})})});tre.displayName=HHe;var rre="MenuRadioGroup",[GHe,KHe]=Ug(rre,{value:void 0,onValueChange:()=>{}}),nre=p.forwardRef((e,t)=>{const{value:r,onValueChange:n,...s}=e,o=cc(n);return a.jsx(GHe,{scope:e.__scopeMenu,value:r,onValueChange:o,children:a.jsx(YM,{...s,ref:t})})});nre.displayName=rre;var are="MenuRadioItem",sre=p.forwardRef((e,t)=>{const{value:r,...n}=e,s=KHe(are,e.__scopeMenu),o=r===s.value;return a.jsx(ore,{scope:e.__scopeMenu,checked:o,children:a.jsx(V5,{role:"menuitemradio","aria-checked":o,...n,ref:t,"data-state":QM(o),onSelect:gn(n.onSelect,()=>s.onValueChange?.(r),{checkForDefaultPrevented:!1})})})});sre.displayName=are;var JM="MenuItemIndicator",[ore,XHe]=Ug(JM,{checked:!1}),ire=p.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:n,...s}=e,o=XHe(JM,r);return a.jsx(Yc,{present:n||jS(o.checked)||o.checked===!0,children:a.jsx(ta.span,{...s,ref:t,"data-state":QM(o.checked)})})});ire.displayName=JM;var YHe="MenuSeparator",lre=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return a.jsx(ta.div,{role:"separator","aria-orientation":"horizontal",...n,ref:t})});lre.displayName=YHe;var JHe="MenuArrow",cre=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,s=U5(r);return a.jsx(cD,{...s,...n,ref:t})});cre.displayName=JHe;var QHe="MenuSub",[tct,dre]=Ug(QHe),Uy="MenuSubTrigger",ure=p.forwardRef((e,t)=>{const r=Vg(Uy,e.__scopeMenu),n=U1(Uy,e.__scopeMenu),s=dre(Uy,e.__scopeMenu),o=KM(Uy,e.__scopeMenu),i=p.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=o,d={__scopeMenu:e.__scopeMenu},u=p.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return p.useEffect(()=>u,[u]),p.useEffect(()=>{const f=l.current;return()=>{window.clearTimeout(f),c(null)}},[l,c]),a.jsx(HM,{asChild:!0,...d,children:a.jsx(ere,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":s.contentId,"data-state":hre(r.open),...e,ref:NC(t,s.onTriggerChange),onClick:f=>{e.onClick?.(f),!(e.disabled||f.defaultPrevented)&&(f.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:gn(e.onPointerMove,Xw(f=>{o.onItemEnter(f),!f.defaultPrevented&&!e.disabled&&!r.open&&!i.current&&(o.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{r.onOpenChange(!0),u()},100))})),onPointerLeave:gn(e.onPointerLeave,Xw(f=>{u();const h=r.content?.getBoundingClientRect();if(h){const m=r.content?.dataset.side,v=m==="right",g=v?-5:5,y=h[v?"left":"right"],x=h[v?"right":"left"];o.onPointerGraceIntentChange({area:[{x:f.clientX+g,y:f.clientY},{x:y,y:h.top},{x,y:h.top},{x,y:h.bottom},{x:y,y:h.bottom}],side:m}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(f),f.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:gn(e.onKeyDown,f=>{const h=o.searchRef.current!=="";e.disabled||h&&f.key===" "||OHe[n.dir].includes(f.key)&&(r.onOpenChange(!0),r.content?.focus(),f.preventDefault())})})})});ure.displayName=Uy;var fre="MenuSubContent",mre=p.forwardRef((e,t)=>{const r=Yte(Ed,e.__scopeMenu),{forceMount:n=r.forceMount,...s}=e,o=Vg(Ed,e.__scopeMenu),i=U1(Ed,e.__scopeMenu),l=dre(fre,e.__scopeMenu),c=p.useRef(null),d=$a(t,c);return a.jsx(Kw.Provider,{scope:e.__scopeMenu,children:a.jsx(Yc,{present:n||o.open,children:a.jsx(Kw.Slot,{scope:e.__scopeMenu,children:a.jsx(XM,{id:l.contentId,"aria-labelledby":l.triggerId,...s,ref:d,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{i.isUsingKeyboardRef.current&&c.current?.focus(),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:gn(e.onFocusOutside,u=>{u.target!==l.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:gn(e.onEscapeKeyDown,u=>{i.onClose(),u.preventDefault()}),onKeyDown:gn(e.onKeyDown,u=>{const f=u.currentTarget.contains(u.target),h=THe[i.dir].includes(u.key);f&&h&&(o.onOpenChange(!1),l.trigger?.focus(),u.preventDefault())})})})})})});mre.displayName=fre;function hre(e){return e?"open":"closed"}function jS(e){return e==="indeterminate"}function QM(e){return jS(e)?"indeterminate":e?"checked":"unchecked"}function ZHe(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function eGe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function tGe(e,t,r){const s=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,o=r?e.indexOf(r):-1;let i=eGe(e,Math.max(o,0));s.length===1&&(i=i.filter(d=>d!==r));const c=i.find(d=>d.toLowerCase().startsWith(s.toLowerCase()));return c!==r?c:void 0}function rGe(e,t){const{x:r,y:n}=e;let s=!1;for(let o=0,i=t.length-1;o<t.length;i=o++){const l=t[o],c=t[i],d=l.x,u=l.y,f=c.x,h=c.y;u>n!=h>n&&r<(f-d)*(n-u)/(h-u)+d&&(s=!s)}return s}function nGe(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return rGe(r,t)}function Xw(e){return t=>t.pointerType==="mouse"?e(t):void 0}var aGe=Xte,sGe=HM,oGe=Jte,iGe=Qte,lGe=YM,cGe=Zte,dGe=V5,uGe=tre,fGe=nre,mGe=sre,hGe=ire,pGe=lre,gGe=cre,vGe=ure,xGe=mre,W5="DropdownMenu",[yGe,rct]=Ld(W5,[Gte]),Rl=Gte(),[bGe,pre]=yGe(W5),gre=e=>{const{__scopeDropdownMenu:t,children:r,dir:n,open:s,defaultOpen:o,onOpenChange:i,modal:l=!0}=e,c=Rl(t),d=p.useRef(null),[u,f]=tm({prop:s,defaultProp:o??!1,onChange:i,caller:W5});return a.jsx(bGe,{scope:t,triggerId:uu(),triggerRef:d,contentId:uu(),open:u,onOpenChange:f,onOpenToggle:p.useCallback(()=>f(h=>!h),[f]),modal:l,children:a.jsx(aGe,{...c,open:u,onOpenChange:f,dir:n,modal:l,children:r})})};gre.displayName=W5;var vre="DropdownMenuTrigger",xre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...s}=e,o=pre(vre,r),i=Rl(r);return a.jsx(sGe,{asChild:!0,...i,children:a.jsx(ta.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...s,ref:NC(t,o.triggerRef),onPointerDown:gn(e.onPointerDown,l=>{!n&&l.button===0&&l.ctrlKey===!1&&(o.onOpenToggle(),o.open||l.preventDefault())}),onKeyDown:gn(e.onKeyDown,l=>{n||(["Enter"," "].includes(l.key)&&o.onOpenToggle(),l.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});xre.displayName=vre;var wGe="DropdownMenuPortal",yre=e=>{const{__scopeDropdownMenu:t,...r}=e,n=Rl(t);return a.jsx(oGe,{...n,...r})};yre.displayName=wGe;var bre="DropdownMenuContent",wre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=pre(bre,r),o=Rl(r),i=p.useRef(!1);return a.jsx(iGe,{id:s.contentId,"aria-labelledby":s.triggerId,...o,...n,ref:t,onCloseAutoFocus:gn(e.onCloseAutoFocus,l=>{i.current||s.triggerRef.current?.focus(),i.current=!1,l.preventDefault()}),onInteractOutside:gn(e.onInteractOutside,l=>{const c=l.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0,u=c.button===2||d;(!s.modal||u)&&(i.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});wre.displayName=bre;var jGe="DropdownMenuGroup",_Ge=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Rl(r);return a.jsx(lGe,{...s,...n,ref:t})});_Ge.displayName=jGe;var NGe="DropdownMenuLabel",jre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Rl(r);return a.jsx(cGe,{...s,...n,ref:t})});jre.displayName=NGe;var SGe="DropdownMenuItem",_re=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Rl(r);return a.jsx(dGe,{...s,...n,ref:t})});_re.displayName=SGe;var CGe="DropdownMenuCheckboxItem",Nre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Rl(r);return a.jsx(uGe,{...s,...n,ref:t})});Nre.displayName=CGe;var PGe="DropdownMenuRadioGroup",AGe=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Rl(r);return a.jsx(fGe,{...s,...n,ref:t})});AGe.displayName=PGe;var EGe="DropdownMenuRadioItem",Sre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Rl(r);return a.jsx(mGe,{...s,...n,ref:t})});Sre.displayName=EGe;var kGe="DropdownMenuItemIndicator",Cre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Rl(r);return a.jsx(hGe,{...s,...n,ref:t})});Cre.displayName=kGe;var IGe="DropdownMenuSeparator",Pre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Rl(r);return a.jsx(pGe,{...s,...n,ref:t})});Pre.displayName=IGe;var OGe="DropdownMenuArrow",TGe=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Rl(r);return a.jsx(gGe,{...s,...n,ref:t})});TGe.displayName=OGe;var DGe="DropdownMenuSubTrigger",Are=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Rl(r);return a.jsx(vGe,{...s,...n,ref:t})});Are.displayName=DGe;var MGe="DropdownMenuSubContent",Ere=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Rl(r);return a.jsx(xGe,{...s,...n,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Ere.displayName=MGe;var RGe=gre,LGe=xre,FGe=yre,kre=wre,Ire=jre,Ore=_re,Tre=Nre,Dre=Sre,Mre=Cre,Rre=Pre,Lre=Are,Fre=Ere;const bb=RGe,wb=LGe,$Ge=Pe.forwardRef(({className:e,inset:t,children:r,...n},s)=>a.jsxs(Lre,{ref:s,className:pr("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...n,children:[r,a.jsx(j0,{className:"ml-auto h-4 w-4"})]}));$Ge.displayName=Lre.displayName;const BGe=Pe.forwardRef(({className:e,...t},r)=>a.jsx(Fre,{ref:r,className:pr("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));BGe.displayName=Fre.displayName;const xx=Pe.forwardRef(({className:e,sideOffset:t=4,...r},n)=>a.jsx(FGe,{children:a.jsx(kre,{ref:n,sideOffset:t,className:pr("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));xx.displayName=kre.displayName;const Nl=Pe.forwardRef(({className:e,inset:t,...r},n)=>a.jsx(Ore,{ref:n,className:pr("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...r}));Nl.displayName=Ore.displayName;const qGe=Pe.forwardRef(({className:e,children:t,checked:r,...n},s)=>a.jsxs(Tre,{ref:s,className:pr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r,...n,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(Mre,{children:a.jsx(Yf,{className:"h-4 w-4"})})}),t]}));qGe.displayName=Tre.displayName;const zGe=Pe.forwardRef(({className:e,children:t,...r},n)=>a.jsxs(Dre,{ref:n,className:pr("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(Mre,{children:a.jsx(jue,{className:"h-2 w-2 fill-current"})})}),t]}));zGe.displayName=Dre.displayName;const MT=Pe.forwardRef(({className:e,inset:t,...r},n)=>a.jsx(Ire,{ref:n,className:pr("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));MT.displayName=Ire.displayName;const f_=Pe.forwardRef(({className:e,...t},r)=>a.jsx(Rre,{ref:r,className:pr("-mx-1 my-1 h-px bg-muted",e),...t}));f_.displayName=Rre.displayName;function ea(){try{const e=localStorage.getItem("auth:userProfile");if(e){const r=JSON.parse(e);if(r?.codigo_empresa)return r.codigo_empresa}const t=localStorage.getItem("auth:company");if(t){const r=JSON.parse(t);if(r?.codigo_empresa)return r.codigo_empresa;if(r?.codigo)return r.codigo}return typeof window<"u"&&window.__authProfile&&window.__authProfile.codigo_empresa?window.__authProfile.codigo_empresa:null}catch{return null}}async function th({somenteAtivas:e=!0,codigoEmpresa:t}={}){const r=t||ea();let n=de.from("finalizadoras").select("*").order("codigo_interno",{ascending:!0,nullsFirst:!1}).order("nome",{ascending:!0});r&&(n=n.eq("codigo_empresa",r)),e&&(n=n.eq("ativo",!0));const{data:s,error:o}=await n;if(o)throw o;const i=s||[];return i.sort((l,c)=>{const d=parseInt(l?.codigo_interno)||0,u=parseInt(c?.codigo_interno)||0;if(d!==u)return d-u;const f=(l?.nome||"").toLowerCase(),h=(c?.nome||"").toLowerCase();return f.localeCompare(h)}),i}async function UGe(e,t){const r=t||ea(),n={codigo_interno:e?.codigo_interno||null,codigo_sefaz:e?.codigo_sefaz||null,nome:(e?.nome||"").trim(),tipo:e?.tipo||"outros",ativo:e?.ativo??!0,taxa_percentual:e?.taxa_percentual==null?null:Number(e.taxa_percentual)};if(!n.nome)throw new Error("Nome  obrigatrio");r&&(n.codigo_empresa=r);const{data:s,error:o}=await de.from("finalizadoras").insert(n).select("*").single();if(o)throw o;return s}async function _S({caixaSessaoId:e,codigoEmpresa:t}={}){if(!e)throw new Error("caixaSessaoId  obrigatrio");const r=t||ea();let n=de.from("caixa_sessoes").select("id, aberto_em, fechado_em, saldo_inicial, saldo_final").eq("id",e).limit(1);r&&(n=n.eq("codigo_empresa",r));const{data:s,error:o}=await n;if(o)throw o;const i=Array.isArray(s)?s[0]:s;if(!i)throw new Error("Sesso no encontrada");const l=i.aberto_em,c=i.fechado_em||new Date().toISOString(),d=await Nd({from:l,to:c,codigoEmpresa:r});let u=0,f=0,h=0,m=0;try{let g=de.from("caixa_movimentacoes").select("tipo, valor").eq("caixa_sessao_id",e);r&&(g=g.eq("codigo_empresa",r));const{data:y}=await g;for(const x of y||[]){const b=Number(x?.valor||0),w=String(x?.tipo||"").toLowerCase();w==="suprimento"?u+=b:w==="sangria"?f+=b:w==="ajuste"?h+=b:w==="troco"&&(m+=b)}}catch{}const v=u+h-f-m;return{...d,saldoInicial:Number(i.saldo_inicial||0),saldoFinal:i.saldo_final!=null?Number(i.saldo_final):null,movimentos:{suprimentos:u,sangrias:f,ajustes:h,troco:m,totalMovimentos:v}}}async function VGe(e,t,r){if(!e)throw new Error("ID invlido");const n=r||ea(),s={codigo_interno:t?.codigo_interno||null,codigo_sefaz:t?.codigo_sefaz||null,nome:(t?.nome||"").trim(),tipo:t?.tipo||"outros",ativo:t?.ativo??!0,taxa_percentual:t?.taxa_percentual==null?null:Number(t.taxa_percentual)};if(!s.nome)throw new Error("Nome  obrigatrio");let o=de.from("finalizadoras").update(s).eq("id",e);n&&(o=o.eq("codigo_empresa",n));const{data:i,error:l}=await o.select("*").single();if(l)throw l;return i}async function WGe(e,t,r){if(!e)throw new Error("ID invlido");const n=r||ea();let s=de.from("finalizadoras").update({ativo:!!t}).eq("id",e);n&&(s=s.eq("codigo_empresa",n));const{data:o,error:i}=await s.select("*").single();if(i)throw i;return o}async function ZM({codigoEmpresa:e}={}){const t=e||ea();let r=de.from("caixa_sessoes").select("id").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);t&&(r=r.eq("codigo_empresa",t));const{data:n,error:s}=await r;if(s)throw s;if(!(Array.isArray(n)&&n.length>0)){const i=new Error(" necessrio abrir o caixa antes de criar comandas.");throw i.code="NO_OPEN_CASH_SESSION",i}return!0}async function RT(e=[],t){if(!Array.isArray(e)||e.length===0)return{};const r=t||ea(),n=async i=>{let l=de.from("comanda_clientes").select(`comanda_id, cliente_id, nome_livre, clientes:clientes${i}(id, nome)`).in("comanda_id",e);return r&&(l=l.eq("codigo_empresa",r)),l};let s=[];try{const{data:i,error:l}=await n("!comanda_clientes_cliente_id_fkey");if(l)throw l;s=i||[]}catch{try{const{data:i,error:l}=await n("!fk_comanda_clientes_cliente");if(l)throw l;s=i||[]}catch{let i=de.from("comanda_clientes").select("comanda_id, cliente_id, nome_livre").in("comanda_id",e);r&&(i=i.eq("codigo_empresa",r));const{data:l}=await i;s=l||[]}}const o={};for(const i of s){const l=i.comanda_id,c=i.clientes?.nome||i.nome_livre||"";o[l]||(o[l]=[]),c&&o[l].push(c)}for(const i of Object.keys(o))o[i]=Array.from(new Set(o[i])).join(", ");return o}async function LT(e=[],t){if(!Array.isArray(e)||e.length===0)return{};const r=t||ea();let n=de.from("pagamentos").select("comanda_id, metodo, status, finalizadoras!pagamentos_finalizadora_id_fkey(nome)").in("comanda_id",e);r&&(n=n.eq("codigo_empresa",r));const{data:s,error:o}=await n;if(o)throw o;const i={};for(const c of s||[]){if(!((c.status||"Pago")!=="Cancelado"&&(c.status||"Pago")!=="Estornado"))continue;const u=c.comanda_id,f=c?.finalizadoras?.nome||c.metodo||"Outros";i[u]||(i[u]=[]),i[u].push(f)}const l={};for(const[c,d]of Object.entries(i))d.length===0?l[c]="":d.length===1?l[c]=d[0]:l[c]=`${d[0]} +${d.length-1}`;return l}async function HGe({comandaId:e,codigoEmpresa:t}={}){if(!e)throw new Error("comandaId  obrigatrio");const r=t||ea();let n=de.from("comanda_itens").select("produto_id, quantidade").eq("comanda_id",e);r&&(n=n.eq("codigo_empresa",r));const{data:s,error:o}=await n;if(o)throw o;const i=new Map;for(const m of s||[]){const v=m.produto_id,g=Number(m.quantidade||0);i.set(v,(i.get(v)||0)+g)}if(i.size===0)return!0;const l=Array.from(i.keys());let c=de.from("produtos").select("id, nome, estoque");c=c.in("id",l),r&&(c=c.eq("codigo_empresa",r));const{data:d,error:u}=await c;if(u)throw u;const f=new Map((d||[]).map(m=>[m.id,{nome:m.nome,estoque:Number(m.estoque||0)}])),h=[];for(const[m,v]of i.entries()){const g=f.get(m)||{nome:`Produto ${m}`,estoque:0};v>g.estoque&&h.push({id:m,name:g.nome,solicitado:v,estoque:g.estoque})}if(h.length>0){const m=h.map(g=>`${g.name}: solicitado ${g.solicitado}, estoque ${g.estoque}`).join("; "),v=new Error(`Estoque insuficiente para finalizar: ${m}`);throw v.code="INSUFFICIENT_STOCK_COMANDA",v.items=h,v}return!0}async function ex({codigoEmpresa:e}={}){const t=e||ea();let r=de.from("comandas").select("id,status,aberto_em").is("mesa_id",null).in("status",["open","awaiting-payment"]).order("aberto_em",{ascending:!1}).limit(1);t&&(r=r.eq("codigo_empresa",t));const{data:n,error:s}=await r;if(s)throw s;return n?.[0]||null}async function m_({codigoEmpresa:e}={}){const t=e||ea();console.log("[getOrCreateComandaBalcao] Iniciando com codigo_empresa:",t),await ZM({codigoEmpresa:t});const r=await ex({codigoEmpresa:t});if(r)return console.log("[getOrCreateComandaBalcao] Comanda existente encontrada:",r),r;const n={status:"open",mesa_id:null,aberto_em:new Date().toISOString()};console.log("[getOrCreateComandaBalcao] Criando nova comanda (codigo_empresa via DEFAULT):",n);const{data:s,error:o}=await de.from("comandas").insert(n).select("id,status,aberto_em,tipo,codigo_empresa").single();if(o)throw console.error("[getOrCreateComandaBalcao] ERRO ao criar comanda:",o),o;return console.log("[getOrCreateComandaBalcao] Comanda criada com sucesso:",s),console.log("[getOrCreateComandaBalcao] Codigo da comanda criada:",s?.codigo_empresa,"vs esperado:",t),await new Promise(i=>setTimeout(i,100)),s}async function bz({status:e,from:t,to:r,search:n="",limit:s=50,offset:o=0,codigoEmpresa:i}={}){const l=i||ea();let c=de.from("comandas").select("id, mesa_id, status, aberto_em, fechado_em, diferenca_pagamento").order("fechado_em",{ascending:!1,nullsFirst:!1}).order("aberto_em",{ascending:!1}).range(o,o+s-1);l&&(c=c.eq("codigo_empresa",l)),e&&Array.isArray(e)&&e.length?c=c.in("status",e):typeof e=="string"&&e!=="all"&&(e==="closed"?c=c.or("status.eq.closed,fechado_em.not.is.null").neq("status","cancelled"):c=c.eq("status",e));const d=y=>{if(!y)return null;if(typeof y=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(y)){const[x,b,w]=y.split("-").map(Number);return new Date(x,b-1,w,0,0,0,0)}return new Date(y)},u=y=>{if(!y)return null;if(typeof y=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(y)){const[x,b,w]=y.split("-").map(Number);return new Date(x,b-1,w,23,59,59,999)}return new Date(y)},f=d(t),h=u(r);f&&(c=c.gte("aberto_em",f.toISOString())),h&&(c=c.lte("aberto_em",h.toISOString()));const m=(n||"").trim();if(m){const y=/^\d+$/.test(m);if(/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(m)){const b=de.from("comandas").select("id, mesa_id, status, aberto_em, fechado_em, diferenca_pagamento").eq("id",m).eq("codigo_empresa",l),w=de.from("comandas").select("id, mesa_id, status, aberto_em, fechado_em, diferenca_pagamento").eq("mesa_id",m).eq("codigo_empresa",l),[j,_]=await Promise.all([b,w]),S=j.data||[],C=_.data||[],P=[...S,...C];return Array.from(new Map(P.map(R=>[R.id,R])).values()).sort((R,O)=>new Date(O.fechado_em||O.aberto_em)-new Date(R.fechado_em||R.aberto_em))}else y?c=c.or(`id.eq.${m},status.ilike.%${m}%`):c=c.or(`status.ilike.%${m}%`)}const{data:v,error:g}=await c;if(g)throw g;return v||[]}async function Nd({from:e,to:t,codigoEmpresa:r}={}){const n="[listarResumoPeriodo]",s=r||ea();console.log(`${n} Iniciando consulta`),console.log(`${n} Perodo: ${e||"SEM from"} at ${t||"SEM to"}`),console.log(`${n} codigo_empresa: ${s}`);let o=[];try{let h=de.from("comandas").select("id, fechado_em").eq("status","closed");s&&(h=h.eq("codigo_empresa",s)),e&&(h=h.gte("fechado_em",new Date(e).toISOString())),t&&(h=h.lte("fechado_em",new Date(t).toISOString()));const{data:m,error:v}=await h;if(v)throw v;o=m||[]}catch{o=[]}const i=(o||[]).map(h=>h.id);let l=0,c=0;if(i.length>0)try{let h=de.from("comanda_itens").select("comanda_id, quantidade, preco_unitario, desconto").in("comanda_id",i);s&&(h=h.eq("codigo_empresa",s));const{data:m,error:v}=await h;if(v)throw v;for(const g of m||[]){const y=Number(g.quantidade||0)*Number(g.preco_unitario||0),x=Number(g.desconto||0);l+=y,c+=x}}catch{}const d=Math.max(0,l-c),u={};let f=0;try{let h=de.from("pagamentos").select("metodo, valor, recebido_em, status, finalizadoras!pagamentos_finalizadora_id_fkey(nome)");s&&(h=h.eq("codigo_empresa",s)),e&&(h=h.gte("recebido_em",new Date(e).toISOString())),t&&(h=h.lte("recebido_em",new Date(t).toISOString())),console.log(`${n} Consultando pagamentos de comandas...`);const{data:m,error:v}=await h;if(v)throw console.error(`${n}  Erro ao buscar pagamentos:`,v),v;console.log(`${n} Total de pagamentos de comandas encontrados: ${(m||[]).length}`);for(const g of m||[]){if(!((g.status||"Pago")!=="Cancelado"&&(g.status||"Pago")!=="Estornado"))continue;const x=g.finalizadoras?.nome||g.metodo||"outros",b=Number(g.valor||0);u[x]=(u[x]||0)+b,f+=b}console.log(`${n}  Resumo comandas por finalizadora:`,u)}catch(h){console.error(`${n}  Exception ao processar pagamentos de comandas:`,h)}try{let h=de.from("agendamentos").select("id, inicio");s&&(h=h.eq("codigo_empresa",s)),e&&(h=h.gte("inicio",new Date(e).toISOString())),t&&(h=h.lte("inicio",new Date(t).toISOString())),console.log(`${n} Consultando agendamentos no perodo...`);const{data:m,error:v}=await h;if(v)throw console.error(`${n}  Erro ao buscar agendamentos:`,v),v;if(console.log(`${n} Total de agendamentos encontrados: ${(m||[]).length}`),m&&m.length>0){const g=m.map(w=>w.id);let y=de.from("agendamento_participantes").select("valor_cota, status_pagamento, finalizadora_id, aplicar_taxa, finalizadoras!agp_finalizadora_id_fkey(nome, taxa_percentual)").in("agendamento_id",g).eq("status_pagamento","Pago");s&&(y=y.eq("codigo_empresa",s)),console.log(`${n} Consultando participantes pagos...`);const{data:x,error:b}=await y;if(b)throw console.error(`${n}  Erro ao buscar participantes:`,b),b;console.log(`${n} Total de participantes pagos encontrados: ${(x||[]).length}`);for(const w of x||[]){const j=w.finalizadoras?.nome||"Outros";let _=Number(w.valor_cota||0);if(w.aplicar_taxa===!0){const S=Number(w.finalizadoras?.taxa_percentual||0);S>0&&(_=_/(1+S/100),console.log(`${n}  Participante com taxa: valor_cota=${w.valor_cota}, taxa=${S}%, valor_real=${_.toFixed(2)}`))}u[j]=(u[j]||0)+_,f+=_}console.log(`${n}  Resumo agendamentos por finalizadora:`,u)}}catch(h){console.error(`${n}  Exception ao processar pagamentos de agendamentos:`,h)}return console.log(`${n}  RESUMO FINAL por finalizadora:`,u),console.log(`${n} Total de entradas: R$ ${f.toFixed(2)}`),{from:e?new Date(e).toISOString():null,to:t?new Date(t).toISOString():null,totalPorFinalizadora:u,totalEntradas:f,totalVendasBrutas:l,totalDescontos:c,totalVendasLiquidas:d}}async function Yw({codigoEmpresa:e}={}){const t=e||ea();let r=null;try{let s=de.from("caixa_sessoes").select("aberto_em").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);t&&(s=s.eq("codigo_empresa",t));const{data:o,error:i}=await s;if(i)throw i;r=o?.[0]?.aberto_em||null}catch{}if(!r)return null;const n=new Date().toISOString();return Nd({from:r,to:n,codigoEmpresa:t})}async function $re({comandaId:e,codigoEmpresa:t}={}){const r=t||ea();let n=de.from("pagamentos").select("*, finalizadoras!pagamentos_finalizadora_id_fkey(id, nome, codigo_sefaz, codigo_interno)").order("recebido_em",{ascending:!0});e&&(n=n.eq("comanda_id",e)),r&&(n=n.eq("codigo_empresa",r));const{data:s,error:o}=await n;if(o)throw o;return s||[]}async function jb({searchTerm:e="",limit:t=20,codigoEmpresa:r}={}){const n=r||ea();let s=de.from("clientes").select("*").eq("status","active").eq("flag_cliente",!0).order("nome",{ascending:!0}).limit(t);n&&(s=s.eq("codigo_empresa",n));const o=(e||"").trim();o&&(/^\d+$/.test(o)?s=s.or(`codigo.eq.${o},nome.ilike.%${o}%,email.ilike.%${o}%,telefone.ilike.%${o}%`):s=s.or(`nome.ilike.%${o}%,email.ilike.%${o}%,telefone.ilike.%${o}%`));const{data:i,error:l}=await s;if(l)throw l;return i||[]}async function kc({codigoEmpresa:e}={}){const t="[listarComandasAbertas]",r=e||ea(),n=async()=>{const s=new Promise((c,d)=>setTimeout(()=>d(new Error("listarComandasAbertas timeout aps 30s")),3e4));let o=de.from("comandas").select("id, mesa_id, status, aberto_em, fechado_em, observacoes, observacoes_atualizadas_em").is("fechado_em",null).neq("status","cancelled").order("aberto_em",{ascending:!1}).limit(500);r&&(o=o.eq("codigo_empresa",r));const{data:i,error:l}=await Promise.race([o,s]);if(l)throw l;return i||[]};try{try{return await n()}catch(s){if(String(s?.message||"").includes("timeout"))return console.warn(`${t} timeout na primeira tentativa, retornando array vazio`),[];throw s}}catch(s){return console.error(`${t}  EXCEPTION:`,s?.message||s),[]}}async function NS(e=[],t){if(!e||e.length===0)return{};const r=t||ea();let n=de.from("comanda_itens").select("comanda_id, quantidade, preco_unitario").in("comanda_id",e);r&&(n=n.eq("codigo_empresa",r));const{data:s,error:o}=await n;if(o)throw o;const i={};for(const l of s||[]){const c=l.comanda_id,d=Number(l.quantidade||0)*Number(l.preco_unitario||0);i[c]=(i[c]||0)+d}return i}async function rh(e){const t="[listMesas]",r=e||ea(),n=async()=>{const s=new Promise((c,d)=>setTimeout(()=>d(new Error("listMesas timeout aps 30s")),3e4));let o=de.from("mesas").select("id, numero, nome, status").order("numero",{ascending:!0}).limit(200);r&&(o=o.eq("codigo_empresa",r));const{data:i,error:l}=await Promise.race([o,s]);if(l)throw l;return i||[]};try{try{return await n()}catch(s){if(String(s?.message||"").includes("timeout"))return console.warn(`${t} timeout na primeira tentativa, retornando array vazio`),[];throw s}}catch(s){return console.error(`${t}  EXCEPTION:`,s?.message||s),[]}}async function GGe({comandaId:e,status:t,codigoEmpresa:r}={}){if(!e)throw new Error("comandaId  obrigatrio");let n=de.from("pagamentos").select("*").eq("comanda_id",e);t&&(n=n.eq("status",t)),n=n.order("created_at",{ascending:!0});const{data:s,error:o}=await n;if(o)throw o;return s||[]}async function yj({comandaId:e,linhas:t,codigoEmpresa:r}={}){if(!e)throw new Error("comandaId  obrigatrio");const n=r||ea();if(Array.isArray(t)){await de.from("pagamentos").delete().eq("comanda_id",e).eq("status","Pendente");for(const s of t){const o=Number(s?.valor||0);if(o<=0)continue;const i=s?.metodo||s?.metodoNome||"outros";await eR({comandaId:e,finalizadoraId:s?.finalizadoraId||s?.methodId||null,metodo:i,valor:o,status:"Pendente",codigoEmpresa:n,clienteId:s?.clienteId||s?.clientId||null})}}}async function KGe({comandaId:e,codigoEmpresa:t}={}){if(!e)throw new Error("comandaId  obrigatrio");const r=t||ea();let n=de.from("pagamentos").update({status:"Pago",recebido_em:new Date().toISOString()}).eq("comanda_id",e).eq("status","Pendente");r&&(n=n.eq("codigo_empresa",r));const{error:s}=await n;if(s)throw s;return!0}async function XGe({numero:e,nome:t,codigoEmpresa:r}={}){const n=r||ea();let s=e;if(!s){let i=de.from("mesas").select("numero").order("numero",{ascending:!1}).limit(1);n&&(i=i.eq("codigo_empresa",n));const{data:l,error:c}=await i;if(c)throw c;s=(l?.[0]?.numero||0)+1}const o={numero:s,status:"available"};t&&typeof t=="string"&&t.trim()&&(o.nome=t.trim()),n&&(o.codigo_empresa=n);try{const{data:i,error:l}=await de.from("mesas").insert(o).select("*").single();if(l)throw l;return i}catch(i){const l=String(i?.message||i||"");if(/column\s+\"?nome\"?\s+of\s+relation/i.test(l)||/column\s+\"?nome\"?\s+does not exist/i.test(l)){const c={numero:s,status:"available"};n&&(c.codigo_empresa=n);const{data:d,error:u}=await de.from("mesas").insert(c).select("*").single();if(u)throw u;return d}throw i}}async function Of({saldoInicial:e=0,codigoEmpresa:t}={}){const r=t||ea();let n=de.from("caixa_sessoes").select("id,status,aberto_em,saldo_inicial").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);r&&(n=n.eq("codigo_empresa",r));const{data:s,error:o}=await n;if(o)throw o;if(s&&s.length>0){const d=s[0];try{const u=new Date(d.aberto_em),f=new Date;if(u.toDateString()!==f.toDateString()){try{const b=await kc({codigoEmpresa:r});if(Array.isArray(b)&&b.length>0)return console.warn("[ensureCaixaAberto] Sesso de dia anterior detectada, mas h comandas abertas. No fechar automaticamente."),d}catch{}const m=f.toISOString();let v=0,g=0;try{const b=await Nd({from:d.aberto_em,to:m,codigoEmpresa:r});v=Number(b?.totalEntradas||0)}catch{}try{let b=de.from("caixa_movimentacoes").select("tipo,valor").eq("caixa_sessao_id",d.id);r&&(b=b.eq("codigo_empresa",r));const{data:w}=await b;for(const j of w||[]){const _=Number(j?.valor||0),S=String(j?.tipo||"").toLowerCase();S==="suprimento"||S==="ajuste"?g+=_:(S==="sangria"||S==="troco")&&(g-=_)}}catch{}const y=Number(d?.saldo_inicial||0)+v+g;let x=de.from("caixa_sessoes").update({status:"closed",saldo_final:y,fechado_em:m}).eq("id",d.id).eq("status","open");r&&(x=x.eq("codigo_empresa",r)),await x;try{const b=await _S({caixaSessaoId:d.id,codigoEmpresa:r}).catch(async()=>await Nd({from:d.aberto_em,to:m,codigoEmpresa:r})),w={codigo_empresa:r||ea(),caixa_sessao_id:d.id,periodo_de:b?.from||d.aberto_em,periodo_ate:b?.to||m,total_bruto:Number(b?.totalVendasBrutas||0),total_descontos:Number(b?.totalDescontos||0),total_liquido:Number(b?.totalVendasLiquidas||0),total_entradas:Number(b?.totalEntradas||0),por_finalizadora:b?.totalPorFinalizadora||{}},j=w.por_finalizadora;await de.from("caixa_resumos").insert({...w,por_finalizadora:j&&typeof j!="string"?JSON.stringify(j):j})}catch{}}else{try{if(d?.saldo_inicial==null&&e!=null){let m=de.from("caixa_sessoes").update({saldo_inicial:Number(e)||0}).eq("id",d.id);return r&&(m=m.eq("codigo_empresa",r)),await m,{...d,saldo_inicial:Number(e)||0}}}catch{}return d}}catch{}return d}const i={status:"open",saldo_inicial:e};r&&(i.codigo_empresa=r);const{data:l,error:c}=await de.from("caixa_sessoes").insert(i).select("id,status,aberto_em").single();if(c)throw c;return l}async function nh({codigoEmpresa:e}={}){const t=e||ea();let r=de.from("caixa_sessoes").select("id,status,aberto_em,saldo_inicial").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);t&&(r=r.eq("codigo_empresa",t));const{data:n,error:s}=await r;if(s)throw s;return n?.[0]||null}async function Bre({saldoFinal:e=null,valorFinalDinheiro:t=null,codigoEmpresa:r}={}){console.log("[fecharCaixa] Iniciando fechamento:",{valorFinalDinheiro:t,saldoFinal:e,codigoEmpresa:r});const n=r||ea();try{console.log("[fecharCaixa]  Limpeza preventiva: ajustando apenas comandas cancelled/closed sem fechado_em...");const{data:x}=await de.from("comandas").select("id, status, fechado_em").eq("codigo_empresa",n).is("fechado_em",null).in("status",["cancelled","closed"]);if(x&&x.length>0){console.log(`[fecharCaixa]  Encontradas ${x.length} comandas (cancelled/closed) sem fechado_em, ajustando...`);const b=new Date().toISOString();for(const w of x)try{await de.from("comandas").update({fechado_em:b}).eq("id",w.id).eq("codigo_empresa",n),console.log(`[fecharCaixa]  Comanda ${w.id} (status: ${w.status}) ajustada com fechado_em`)}catch{}}else console.log("[fecharCaixa]  Nenhuma comanda cancelled/closed sem fechado_em encontrada")}catch(x){console.warn("[fecharCaixa]  Erro na limpeza preventiva:",x?.message)}try{let x=await kc({codigoEmpresa:n});if(x=x||[],console.log(`[fecharCaixa]  Comandas abertas encontradas: ${x.length}`,x.map(w=>({id:w.id,status:w.status,mesa:w.mesa_id}))),x&&x.length>0){const w=x.map(j=>`${j.id}${j.mesa_id?`@mesa:${j.mesa_id}`:"@balcao"}`).join(", ");throw new Error(`Existem ${x.length} comanda(s) aberta(s). Feche todas as comandas antes de encerrar o caixa.`)}let b=0;for(;b<12&&(x=await kc({codigoEmpresa:n}),!(!x||x.length===0));)await new Promise(w=>setTimeout(w,250)),b++;if(x&&x.length>0){const w=x.map(C=>C.id);let j=new Map,_=new Map;try{if(w.length>0){let C=de.from("comanda_itens").select("comanda_id, quantidade").in("comanda_id",w);n&&(C=C.eq("codigo_empresa",n));const{data:P}=await C;j=new Map;for(const A of P||[]){const R=A.comanda_id,O=Number(A.quantidade||0);j.set(R,(j.get(R)||0)+O)}}}catch{}try{if(w.length>0){let C=de.from("pagamentos").select("comanda_id, status").in("comanda_id",w);n&&(C=C.eq("codigo_empresa",n));const{data:P}=await C;_=new Map;for(const A of P||[]){const R=String(A?.status||"Pago");if(R==="Cancelado"||R==="Estornado")continue;const O=A.comanda_id;_.set(O,(_.get(O)||0)+1)}}}catch{}for(const C of x){const P=Number(j.get(C.id)||0)>0,A=Number(_.get(C.id)||0)>0;if(!P&&!A)try{await d0({comandaId:C.id,codigoEmpresa:n})}catch{}}let S=await kc({codigoEmpresa:n});if(S=S||[],S.length>0){const C=S.map(O=>O.id);let P=new Map,A=new Map;try{if(C.length>0){let O=de.from("comanda_itens").select("comanda_id, quantidade").in("comanda_id",C);n&&(O=O.eq("codigo_empresa",n));const{data:I}=await O;P=new Map;for(const M of I||[]){const D=M.comanda_id,U=Number(M.quantidade||0);P.set(D,(P.get(D)||0)+U)}}}catch{}try{if(C.length>0){let O=de.from("pagamentos").select("comanda_id, status").in("comanda_id",C);n&&(O=O.eq("codigo_empresa",n));const{data:I}=await O;A=new Map;for(const M of I||[]){const D=String(M?.status||"Pago");if(D==="Cancelado"||D==="Estornado")continue;const U=M.comanda_id;A.set(U,(A.get(U)||0)+1)}}}catch{}const R=S.filter(O=>Number(P.get(O.id)||0)>0||Number(A.get(O.id)||0)>0);if(R.length>0){const O=R.map(I=>`${I.id}${I.mesa_id?`@mesa:${I.mesa_id}`:"@balcao"}`).join(", ");throw new Error(`Existem ${R.length} comandas abertas. IDs: ${O}. Feche todas antes de encerrar o caixa.`)}}}}catch(x){if(x&&/Existem \d+ comandas/.test(x.message||""))throw x;const b=new Error("Falha ao validar comandas abertas. Tente novamente e verifique sua conexo.");throw b.code="CASH_CLOSE_VALIDATION_FAILED",b}let s=de.from("caixa_sessoes").select("id,aberto_em,saldo_inicial").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);n&&(s=s.eq("codigo_empresa",n));const{data:o,error:i}=await s;if(i)throw i;const l=o?.[0]?.id||null,c=o?.[0]?.aberto_em||null,d=Number(o?.[0]?.saldo_inicial||0);if(!l)throw new Error("Nenhuma sesso de caixa aberta encontrada.");const u=new Date().toISOString();let f=0,h=0;try{const x=await Nd({from:c,to:u,codigoEmpresa:n});f=Number(x?.totalEntradas||0)}catch{}try{let x=de.from("caixa_movimentacoes").select("tipo, valor").eq("caixa_sessao_id",l);n&&(x=x.eq("codigo_empresa",n));const{data:b}=await x;for(const w of b||[]){const j=Number(w?.valor||0),_=String(w?.tipo||"").toLowerCase();_==="suprimento"||_==="ajuste"?h+=j:(_==="sangria"||_==="troco")&&(h-=j)}}catch{}const m=e!=null?Number(e):d+f+h;try{let x=await kc({codigoEmpresa:n});if(x=x||[],x.length>0){const b=x.map(S=>S.id);let w=new Map,j=new Map;try{if(b.length>0){let S=de.from("comanda_itens").select("comanda_id, quantidade").in("comanda_id",b);n&&(S=S.eq("codigo_empresa",n));const{data:C}=await S;w=new Map;for(const P of C||[]){const A=P.comanda_id,R=Number(P.quantidade||0);w.set(A,(w.get(A)||0)+R)}}}catch{}try{if(b.length>0){let S=de.from("pagamentos").select("comanda_id, status").in("comanda_id",b);n&&(S=S.eq("codigo_empresa",n));const{data:C}=await S;j=new Map;for(const P of C||[]){const A=String(P?.status||"Pago");if(A==="Cancelado"||A==="Estornado")continue;const R=P.comanda_id;j.set(R,(j.get(R)||0)+1)}}}catch{}for(const S of x){const C=Number(w.get(S.id)||0)>0,P=Number(j.get(S.id)||0)>0;if(!C&&!P)try{await d0({comandaId:S.id,codigoEmpresa:n})}catch{}}let _=await kc({codigoEmpresa:n});if(_=_||[],_.length>0){const S=_.map(C=>`${C.id}${C.mesa_id?`@mesa:${C.mesa_id}`:"@balcao"}`).join(", ");throw new Error(`Existem ${_.length} comandas abertas. IDs: ${S}. Feche todas antes de encerrar o caixa.`)}}}catch(x){if(!(x&&x.message)){const b=new Error("Falha ao validar comandas abertas no momento do fechamento. Tente novamente.");throw b.code="CASH_CLOSE_FINAL_CHECK_FAILED",b}throw x}let v=de.from("caixa_sessoes").update({status:"closed",saldo_final:m,fechado_em:u}).eq("id",l).eq("status","open");n&&(v=v.eq("codigo_empresa",n));const{data:g,error:y}=await v.select("id,status,fechado_em,saldo_final").single();if(y){const x=String(y.message||"");if(x.toLowerCase().includes("row")||x.toLowerCase().includes("single")){let b=de.from("caixa_sessoes").select("id,status,fechado_em,saldo_final").eq("id",l).limit(1);n&&(b=b.eq("codigo_empresa",n));const{data:w}=await b;if(w&&w[0])return w[0]}throw y}try{if(c&&u&&g?.status==="closed"){let x;try{x=await _S({caixaSessaoId:l,codigoEmpresa:n})}catch{x=await Nd({from:c,to:u,codigoEmpresa:n})}const b={codigo_empresa:n||ea(),caixa_sessao_id:l,periodo_de:x?.from||c,periodo_ate:x?.to||u,total_bruto:Number(x?.totalVendasBrutas||0),total_descontos:Number(x?.totalDescontos||0),total_liquido:Number(x?.totalVendasLiquidas||0),total_entradas:Number(x?.totalEntradas||0),por_finalizadora:x?.totalPorFinalizadora||{}},w=t!=null?Number(t):null,j=w!=null?w-Number(m||0):null;console.log("[fecharCaixa] Valores para snapshot:",{contado:w,diferenca:j,efetivoSaldoFinal:m,valorFinalDinheiroOriginal:t});const S=await(async C=>{const P={...C},A=P.por_finalizadora;A&&typeof A!="string"&&(P.por_finalizadora=JSON.stringify(A));let R=!0,O=!0;try{const W=localStorage.getItem("schema:caixa_resumos:valor_final_dinheiro"),$=localStorage.getItem("schema:caixa_resumos:diferenca_dinheiro");W==="no"&&(R=!1),$==="no"&&(O=!1)}catch{}if(!R||!O)try{let W=de.from("caixa_resumos").select("valor_final_dinheiro, diferenca_dinheiro").limit(1);const{error:$}=await W;if(!$){R=!0,O=!0;try{localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","yes"),localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","yes")}catch{}}}catch{}if(!R&&!O)return await de.from("caixa_resumos").insert(P);let I={...P};R&&w!=null&&(I.valor_final_dinheiro=w),O&&j!=null&&(I.diferenca_dinheiro=j),console.log("[fecharCaixa] Tentando inserir snapshot com:",{supportValor:R,supportDif:O,contado:w,diferenca:j,hasValorFinalDinheiro:"valor_final_dinheiro"in I});const M=await de.from("caixa_resumos").insert(I);if(!M.error)return M;const D=`${M.error?.message||""} ${M.error?.details||""}`.toLowerCase(),U=M.error?.code;if(U==="42703"||U==="PGRST204"||D.includes("column")||D.includes("schema cache")){try{I.valor_final_dinheiro!==void 0&&localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","no"),I.diferenca_dinheiro!==void 0&&localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","no")}catch{}return await de.from("caixa_resumos").insert(P)}return M})(b);if(S.error)throw console.error("[fecharCaixa] Erro ao inserir snapshot:",S.error),S.error;console.log("[fecharCaixa]  Snapshot inserido com sucesso");try{const{data:C}=await de.from("caixa_resumos").select("valor_final_dinheiro, diferenca_dinheiro").eq("caixa_sessao_id",l).order("criado_em",{ascending:!1}).limit(1).single();console.log("[fecharCaixa] Verificao ps-insert:",C)}catch(C){console.warn("[fecharCaixa] Falha ao verificar snapshot:",C?.message)}}}catch(x){console.warn("[fecharCaixa] Falha ao gravar snapshot de fechamento:",x)}try{let x=de.from("caixa_sessoes").select("id,aberto_em,saldo_inicial").eq("status","open");n&&(x=x.eq("codigo_empresa",n));const{data:b}=await x;if(Array.isArray(b)&&b.length>0)for(const w of b)try{const j=w?.aberto_em,_=Number(w?.saldo_inicial||0),S=new Date().toISOString();let C=0,P=0;try{const R=await Nd({from:j,to:S,codigoEmpresa:n});C=Number(R?.totalEntradas||0)}catch{}try{let R=de.from("caixa_movimentacoes").select("tipo,valor").eq("caixa_sessao_id",w.id);n&&(R=R.eq("codigo_empresa",n));const{data:O}=await R;for(const I of O||[]){const M=Number(I?.valor||0),D=String(I?.tipo||"").toLowerCase();D==="suprimento"||D==="ajuste"?P+=M:(D==="sangria"||D==="troco")&&(P-=M)}}catch{}const A=_+C+P;await de.from("caixa_sessoes").update({status:"closed",saldo_final:A,fechado_em:S}).eq("id",w.id).eq("status","open").eq(n?"codigo_empresa":"id",n||w.id);try{const R=await _S({caixaSessaoId:w.id,codigoEmpresa:n}).catch(async()=>await Nd({from:j,to:S,codigoEmpresa:n})),O={codigo_empresa:n||ea(),caixa_sessao_id:w.id,periodo_de:R?.from||j,periodo_ate:R?.to||S,total_bruto:Number(R?.totalVendasBrutas||0),total_descontos:Number(R?.totalDescontos||0),total_liquido:Number(R?.totalVendasLiquidas||0),total_entradas:Number(R?.totalEntradas||0),por_finalizadora:R?.totalPorFinalizadora||{}},I=O.por_finalizadora;await de.from("caixa_resumos").insert({...O,por_finalizadora:I&&typeof I!="string"?JSON.stringify(I):I})}catch{}}catch(j){try{console.warn("[fecharCaixa] Saneamento: falhou ao fechar sesso remanescente",w?.id,j?.message||j)}catch{}}}catch{}return g}async function qre({from:e,to:t,limit:r=50,codigoEmpresa:n}={}){console.log("[listarFechamentosCaixa] Iniciando busca de fechamentos",{from:e,to:t,limit:r});const s=n||ea();let o=de.from("caixa_sessoes").select("id, aberto_em, fechado_em, saldo_inicial, saldo_final, status").eq("status","closed").order("fechado_em",{ascending:!1}).limit(r);s&&(o=o.eq("codigo_empresa",s)),e&&(o=o.gte("fechado_em",`${e}T00:00:00`)),t&&(o=o.lte("fechado_em",`${t}T23:59:59`));const{data:i,error:l}=await o;if(l)throw l;const c=Array.isArray(i)?i:[];if(console.log("[listarFechamentosCaixa] Sesses fechadas encontradas:",c.length),c.length===0)return[];const d=c.map(m=>m.id);let u=[];try{let m=!0,v=!0;try{const j=localStorage.getItem("schema:caixa_resumos:valor_final_dinheiro"),_=localStorage.getItem("schema:caixa_resumos:diferenca_dinheiro");j==="no"&&(m=!1),_==="no"&&(v=!1)}catch{}if(!m||!v)try{let j=de.from("caixa_resumos").select("valor_final_dinheiro, diferenca_dinheiro").limit(1);const{error:_}=await j;if(!_){m=!0,v=!0;try{localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","yes"),localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","yes")}catch{}}}catch{}const g=["caixa_sessao_id"];m&&g.push("valor_final_dinheiro"),v&&g.push("diferenca_dinheiro");const y=g.join(", ");let x=de.from("caixa_resumos").select(y).in("caixa_sessao_id",d).order("criado_em",{ascending:!1});s&&(x=x.eq("codigo_empresa",s));let{data:b,error:w}=await x;if(w){const j=w?.code,_=`${w?.message||""} ${w?.details||""}`.toLowerCase();if(j==="42703"||j==="PGRST204"||_.includes("column")||_.includes("schema cache")){try{m&&localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","no"),v&&localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","no")}catch{}let C=de.from("caixa_resumos").select("caixa_sessao_id").in("caixa_sessao_id",d).order("criado_em",{ascending:!1});s&&(C=C.eq("codigo_empresa",s));const{data:P}=await C;u=P||[]}else throw w}else u=b||[]}catch(m){console.warn("[listarFechamentosCaixa] Erro ao buscar snapshots:",m?.message),u=[]}console.log("[listarFechamentosCaixa] Snapshots encontrados:",u.length,u);const f=new Map(u.map(m=>[m.caixa_sessao_id,m])),h=c.map(m=>{const v=f.get(m.id),g={...m,valor_final_dinheiro:v?.valor_final_dinheiro??null,diferenca_dinheiro:v?.diferenca_dinheiro??null};return v&&console.log(`[listarFechamentosCaixa] Sesso ${m.id} enriquecida com snapshot:`,{valor_final_dinheiro:v.valor_final_dinheiro,diferenca_dinheiro:v.diferenca_dinheiro}),g});return console.log("[listarFechamentosCaixa] Resultado final:",h.length,"sesses com dados enriquecidos"),h}async function SS({caixaSessaoId:e,codigoEmpresa:t}={}){if(!e)throw new Error("caixaSessaoId  obrigatrio");const r=t||ea();let n=null;try{let s=!0,o=!0;try{const f=localStorage.getItem("schema:caixa_resumos:valor_final_dinheiro"),h=localStorage.getItem("schema:caixa_resumos:diferenca_dinheiro");f==="no"&&(s=!1),h==="no"&&(o=!1)}catch{}if(!s||!o)try{let f=de.from("caixa_resumos").select("valor_final_dinheiro, diferenca_dinheiro").limit(1);const{error:h}=await f;if(!h){s=!0,o=!0;try{localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","yes"),localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","yes")}catch{}}}catch{}const i=["caixa_sessao_id","periodo_de","periodo_ate","total_bruto","total_descontos","total_liquido","total_entradas","por_finalizadora"];s&&i.push("valor_final_dinheiro"),o&&i.push("diferenca_dinheiro");const l=i.join(", ");let c=de.from("caixa_resumos").select(l).eq("caixa_sessao_id",e).order("criado_em",{ascending:!1}).limit(1);r&&(c=c.eq("codigo_empresa",r));let{data:d,error:u}=await c;if(u){const f=u?.code,h=`${u?.message||""} ${u?.details||""}`.toLowerCase();if(f==="42703"||f==="PGRST204"||h.includes("column")||h.includes("schema cache")){try{s&&localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","no"),o&&localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","no")}catch{}let v=de.from("caixa_resumos").select("caixa_sessao_id, periodo_de, periodo_ate, total_bruto, total_descontos, total_liquido, total_entradas, por_finalizadora").eq("caixa_sessao_id",e).order("criado_em",{ascending:!1}).limit(1);r&&(v=v.eq("codigo_empresa",r));const{data:g}=await v;n=g?.[0]||null}else throw u}else n=d?.[0]||null}catch(s){try{console.warn("[getCaixaResumo] Snapshot select falhou, usando fallback dinmico:",s?.message||s)}catch{}}if(!n||typeof n.saldo_inicial>"u"||typeof n.saldo_final>"u"){const s=await _S({caixaSessaoId:e,codigoEmpresa:r});let o=null;try{let i=de.from("caixa_sessoes").select("saldo_inicial, saldo_final").eq("id",e).limit(1);r&&(i=i.eq("codigo_empresa",r));const{data:l}=await i;o=l?.[0]||null}catch{}n={codigo_empresa:r,caixa_sessao_id:e,periodo_de:s?.from||null,periodo_ate:s?.to||null,total_bruto:Number(s?.totalVendasBrutas||0),total_descontos:Number(s?.totalDescontos||0),total_liquido:Number(s?.totalVendasLiquidas||0),total_entradas:Number(s?.totalEntradas||0),por_finalizadora:s?.totalPorFinalizadora||{},saldo_inicial:Number(o?.saldo_inicial??s?.saldoInicial??0),saldo_final:o?.saldo_final!=null?Number(o.saldo_final):null,movimentos:s?.movimentos||{suprimentos:0,sangrias:0,ajustes:0,troco:0,totalMovimentos:0}}}else if(typeof n.por_finalizadora=="string")try{n.por_finalizadora=JSON.parse(n.por_finalizadora)}catch{n.por_finalizadora={}}return n}async function FT({tipo:e,valor:t,observacao:r="",caixaSessaoId:n,codigoEmpresa:s}={}){const o=s||ea();if(!e||!["sangria","suprimento","troco","ajuste"].includes(e))throw new Error("Tipo invlido de movimentao");let i=n;if(!i){let u=de.from("caixa_sessoes").select("id").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);o&&(u=u.eq("codigo_empresa",o));const{data:f,error:h}=await u;if(h)throw h;i=f?.[0]?.id||null}if(!i)throw new Error("Sesso de caixa no encontrada para registrar movimentao");const l={codigo_empresa:o,caixa_sessao_id:i,tipo:e,valor:Math.max(0,Number(t)||0),observacao:(r||"").trim()||null},{data:c,error:d}=await de.from("caixa_movimentacoes").insert(l).select("*").single();if(d)throw d;return c}async function ng({caixaSessaoId:e,codigoEmpresa:t}={}){const r=t||ea();if(!e)throw new Error("caixaSessaoId  obrigatrio");let n=de.from("caixa_movimentacoes").select("*").eq("caixa_sessao_id",e).order("criado_em",{ascending:!0});r&&(n=n.eq("codigo_empresa",r));const{data:s,error:o}=await n;if(o)throw o;return s||[]}async function YGe({mesaId:e,codigoEmpresa:t}={}){const r=t||ea();await ZM({codigoEmpresa:r}),console.log(`[abrirComandaParaMesa] Iniciando para mesaId: ${e}, codigo_empresa: ${r}`);try{const n={status:"open",aberto_em:new Date().toISOString()};e&&(n.mesa_id=e),console.log("[abrirComandaParaMesa] Payload (codigo_empresa via DEFAULT):",n);const{data:s,error:o}=await de.from("comandas").insert(n).select("*").single();if(o)throw console.error("[abrirComandaParaMesa] ERRO ao criar comanda:",o),o;return console.log("[abrirComandaParaMesa]  Comanda criada:",s),await new Promise(i=>setTimeout(i,100)),s}catch(n){throw console.error("[abrirComandaParaMesa] ERRO:",n),n}}async function JGe({mesaId:e,codigoEmpresa:t}){const r=t||ea();let n=de.from("comandas").select("id,status,aberto_em,fechado_em").eq("mesa_id",e).is("fechado_em",null).in("status",["open","awaiting-payment"]).order("aberto_em",{ascending:!1}).limit(1);r&&(n=n.eq("codigo_empresa",r));const{data:s,error:o}=await n;if(o)throw o;return s?.[0]||null}async function io({comandaId:e,codigoEmpresa:t}){const r=t||ea();let n=de.from("comanda_itens").select("*").eq("comanda_id",e).order("created_at",{ascending:!0});r&&(n=n.eq("codigo_empresa",r));const{data:s,error:o}=await n;if(o)throw o;return s||[]}async function Hm({codigoEmpresa:e}){const t=e||ea();let r=de.from("comandas").select("id").is("fechado_em",null);t&&(r=r.eq("codigo_empresa",t));const{data:n,error:s}=await r;if(s)throw s;if(console.log("[listarItensDeTodasComandasAbertas] Comandas abertas:",n?.length||0,"IDs:",n?.map(d=>d.id)),!n||n.length===0)return console.log("[listarItensDeTodasComandasAbertas] Nenhuma comanda aberta encontrada"),[];const o=n.map(d=>d.id);let i=de.from("comanda_itens").select("produto_id, quantidade").in("comanda_id",o);t&&(i=i.eq("codigo_empresa",t));const{data:l,error:c}=await i;if(c)throw c;return console.log("[listarItensDeTodasComandasAbertas] Itens encontrados:",l?.length||0),l&&l.length>0&&console.log("[listarItensDeTodasComandasAbertas] Detalhes dos itens:",l),l||[]}const bj=new Map;async function QGe({mesaId:e,codigoEmpresa:t}={}){const r=`${e}:${t||ea()}`;if(bj.has(r))return console.log(`[getOrCreateComandaForMesa]  Operao j em andamento para mesa ${e}, aguardando...`),bj.get(r);const n=t||ea(),s=(async()=>{try{await ZM({codigoEmpresa:n}),console.log(`[getOrCreateComandaForMesa]  Criando nova comanda para mesa ${e}`);const o=await JGe({mesaId:e,codigoEmpresa:n});if(o){console.log(`[getOrCreateComandaForMesa]  Comanda existente ${o.id} encontrada, verificando se est vazia...`);let l=!1,c=!1;try{l=(await io({comandaId:o.id,codigoEmpresa:n})||[]).length>0}catch{}try{const{data:d}=await de.from("pagamentos").select("id, status").eq("comanda_id",o.id).eq("codigo_empresa",n);c=(d||[]).filter(f=>{const h=String(f?.status||"Pago");return h!=="Cancelado"&&h!=="Estornado"}).length>0}catch{}if(!l&&!c){console.log(`[getOrCreateComandaForMesa]  Comanda ${o.id} est vazia, fechando automaticamente...`);try{await d0({comandaId:o.id,codigoEmpresa:n}),console.log(`[getOrCreateComandaForMesa]  Comanda ${o.id} fechada com sucesso`)}catch(d){console.warn(`[getOrCreateComandaForMesa]  Erro ao fechar comanda ${o.id}:`,d?.message)}}else console.log(`[getOrCreateComandaForMesa]  Comanda ${o.id} tem dados (itens: ${l}, pagamentos: ${c}), no ser fechada automaticamente`)}console.log(`[getOrCreateComandaForMesa]  Criando comanda zerada para mesa ${e}`);const i=await YGe({mesaId:e,codigoEmpresa:n});return console.log(`[getOrCreateComandaForMesa]  Comanda ${i.id} criada com sucesso`),i}finally{bj.delete(r),console.log(`[getOrCreateComandaForMesa]  Lock liberado para mesa ${e}`)}})();return bj.set(r,s),s}async function _b({comandaId:e,clienteIds:t=[],nomesLivres:r=[],codigoEmpresa:n,replace:s=!1}={}){const o=n||ea();if(!e)throw new Error("comandaId  obrigatrio");let i=[],l=[];try{i=Array.isArray(t)?t:t?[t]:[]}catch(m){console.warn("[adicionarClientesAComanda] Erro ao processar clienteIds:",m),i=[]}try{l=Array.isArray(r)?r:r?[r]:[]}catch(m){console.warn("[adicionarClientesAComanda] Erro ao processar nomesLivres:",m),l=[]}const c=i.map(m=>m&&typeof m=="object"?m.id||m.cliente_id||m.value:m).filter(Boolean),d=l.map(m=>m&&typeof m=="object"?m.nome||m.name||m.label:m).map(m=>String(m||"").trim()).filter(Boolean);if(console.log(`[adicionarClientesAComanda] Adicionando clientes  comanda ${e}:`,{clienteIds:c,nomesLivres:d,codigo:o,replace:s}),s){const{error:m}=await de.from("comanda_clientes").delete().eq("comanda_id",e);m&&console.warn("[adicionarClientesAComanda] Erro ao limpar clientes existentes:",m)}const u=[];if(Array.isArray(c)){let m=[];if(!s)try{const{data:g}=await de.from("comanda_clientes").select("cliente_id, nome_livre").eq("comanda_id",e);m=Array.isArray(g)?g:[]}catch{}const v=new Set((m||[]).map(g=>g.cliente_id).filter(Boolean));for(let g=0;g<c.length;g++){const y=c[g];y&&(!s&&v.has(y)||u.push({comanda_id:e,cliente_id:y}))}}if(Array.isArray(d))for(let m=0;m<d.length;m++){const g=(d[m]||"").trim();g&&u.push({comanda_id:e,nome_livre:g})}if(u.length===0)return console.log("[adicionarClientesAComanda] Nenhum cliente para adicionar"),!0;let f=[];Array.isArray(u)&&(f=u.map(m=>o?{...m,codigo_empresa:o}:m)),console.log("[adicionarClientesAComanda] Payload para insero:",f);const{error:h}=await de.from("comanda_clientes").insert(f);if(h)throw console.error("[adicionarClientesAComanda] ERRO ao inserir clientes:",h),h;return console.log("[adicionarClientesAComanda] Clientes adicionados com sucesso"),!0}async function ui({comandaId:e,codigoEmpresa:t}={}){if(t||ea(),!e)throw new Error("comandaId  obrigatrio");try{const{data:r,error:n}=await de.from("comanda_clientes").select("id, cliente_id, nome_livre, clientes:clientes!comanda_clientes_cliente_id_fkey(id, codigo, nome, email, telefone)").eq("comanda_id",e).order("created_at",{ascending:!0});if(n)throw n;return(r||[]).map(s=>({id:s.id,tipo:s.cliente_id?"cadastrado":"livre",nome:s.clientes?.nome||s.nome_livre,cliente_id:s.cliente_id}))}catch{try{const{data:n,error:s}=await de.from("comanda_clientes").select("id, cliente_id, nome_livre, clientes:clientes!fk_comanda_clientes_cliente(id, nome, email, telefone)").eq("comanda_id",e).order("created_at",{ascending:!0});if(s)throw s;return(n||[]).map(o=>({id:o.id,tipo:o.cliente_id?"cadastrado":"livre",nome:o.clientes?.nome||o.nome_livre,cliente_id:o.cliente_id}))}catch{const{data:s,error:o}=await de.from("comanda_clientes").select("id, cliente_id, nome_livre").eq("comanda_id",e).order("created_at",{ascending:!0});if(o)throw o;return(s||[]).map(i=>({id:i.id,tipo:i.cliente_id?"cadastrado":"livre",nome:i.nome_livre||"",cliente_id:i.cliente_id}))}}}async function $T({comandaId:e,produtoId:t,descricao:r,quantidade:n,precoUnitario:s,desconto:o=0,codigoEmpresa:i}){const l=i||ea();console.log(`[adicionarItem] Adicionando item  comanda ${e}:`,{produtoId:t,descricao:r,quantidade:n,precoUnitario:s,codigo:l});try{let f=de.from("produtos").select("id, estoque, estoque_minimo, nome").eq("id",t).limit(1);l&&(f=f.eq("codigo_empresa",l));const{data:h,error:m}=await f;if(m)throw m;const v=Array.isArray(h)?h[0]:h;if(v){const g=Number(v.estoque??0),y=Number(v.estoque_minimo??0),x=Number(n??1);if(g<=0){const C=new Error(`Produto sem estoque: ${v.nome||""}`.trim());throw C.code="OUT_OF_STOCK",C}let b=de.from("comanda_itens").select("quantidade").eq("comanda_id",e).eq("produto_id",t);l&&(b=b.eq("codigo_empresa",l));const{data:w,error:j}=await b;if(j)throw j;const _=Array.isArray(w)&&w.length?w.reduce((C,P)=>C+Number(P?.quantidade||0),0):0;if(_+x>g){const C=new Error(`Estoque insuficiente. Em comanda: ${_}, solicitado: +${x}, disponvel: ${g}`);throw C.code="INSUFFICIENT_STOCK",C}if(g<=y&&g>0)try{console.warn(`[adicionarItem] Aviso: estoque baixo para produto '${v.nome}' (estoque=${g}, minimo=${y})`)}catch{}}}catch(f){throw f}const c={comanda_id:e,produto_id:t,descricao:r,quantidade:n,preco_unitario:s,desconto:o};l&&(c.codigo_empresa=l);const{data:d,error:u}=await de.from("comanda_itens").insert(c).select("*").single();if(u)throw u;return d}async function dd({itemId:e,quantidade:t,codigoEmpresa:r}){const n=r||ea();let s=de.from("comanda_itens").select("id, quantidade, produto_id, comanda_id").eq("id",e).limit(1);n&&(s=s.eq("codigo_empresa",n));const{data:o,error:i}=await s;if(i)throw i;const l=Array.isArray(o)?o[0]:o,c=Number(t||0);if(!l)throw new Error("Item no encontrado");const d=Number(l.quantidade||0);if(c-d>0){let v=de.from("produtos").select("id, estoque, nome, estoque_minimo").eq("id",l.produto_id).limit(1);n&&(v=v.eq("codigo_empresa",n));const{data:g,error:y}=await v;if(y)throw y;const x=Array.isArray(g)?g[0]:g;if(x){const b=Number(x.estoque??0);let w=de.from("comanda_itens").select("quantidade").eq("comanda_id",l.comanda_id).eq("produto_id",l.produto_id).neq("id",l.id);n&&(w=w.eq("codigo_empresa",n));const{data:j,error:_}=await w;if(_)throw _;const S=Array.isArray(j)&&j.length?j.reduce((R,O)=>R+Number(O?.quantidade||0),0):0;if(S+c>b){const R=new Error(`Estoque insuficiente. Em comanda (outros itens): ${S}, novo para este item: ${c}, disponvel: ${b}`);throw R.code="INSUFFICIENT_STOCK",R}const P=Number(x.estoque_minimo??0),A=b-(S+c);if(A<=P&&A>=0)try{console.warn(`[atualizarQuantidadeItem] Aviso: produto '${x.nome}' atingiu nvel de estoque baixo (restante=${A}, minimo=${P})`)}catch{}}}let f=de.from("comanda_itens").update({quantidade:c}).eq("id",e);n&&(f=f.eq("codigo_empresa",n));const{data:h,error:m}=await f.select("*").single();if(m)throw m;return h}async function tx({itemId:e,codigoEmpresa:t}){const r=t||ea();let n=de.from("comanda_itens").delete().eq("id",e);r&&(n=n.eq("codigo_empresa",r));const{data:s,error:o}=await n.select("id");if(o&&o.code!=="PGRST116")throw o;return Array.isArray(s)&&s.length>0}function ZGe(e){if(!e)return!1;const t=e.code?String(e.code):"",r=[e.message,e.details,e.hint].filter(Boolean).join(" ").toLowerCase();return t==="22P02"||r.includes("invalid input value for enum")}async function eR({comandaId:e,finalizadoraId:t,metodo:r,valor:n,status:s="Pago",codigoEmpresa:o,clienteId:i=null}){const l=o||ea();if(!l)throw new Error("Empresa no identificada (codigo_empresa ausente).");const c=s&&["Pendente","Pago","Estornado","Cancelado"].includes(s)?s:"Pago",d=["dinheiro","credito","debito","pix","voucher","outros"],f=(m=>{if(!m)return"outros";const v=String(m).toLowerCase().trim(),y={"cartao credito":"credito","carto credito":"credito","cartao debito":"debito","carto debito":"debito","carto de credito":"credito","carto de dbito":"debito","cartao de credito":"credito","cartao de debito":"debito"}[v]||v;return d.includes(y)?y:"outros"})(r),h={comanda_id:e,finalizadora_id:t||null,metodo:f,valor:Math.max(0,Number(n)||0),status:c,recebido_em:new Date().toISOString(),codigo_empresa:l};i&&(h.cliente_id=i),console.log("[registrarPagamento] Iniciando registro de pagamento:",{comandaId:e,finalizadoraId:t,metodo:f,valor:h.valor,status:h.status,codigoEmpresa:l,payload:h});try{const{data:m,error:v}=await de.from("pagamentos").insert(h).select().single();if(v){console.warn("[registrarPagamento] Primeira tentativa falhou:",{code:v.code,message:v.message});const g=`${v?.message||""} ${v?.details||""}`.toLowerCase();if(v?.code==="42703"||g.includes("column")&&g.includes("cliente_id")){const{cliente_id:x,...b}=h;try{localStorage.setItem("schema:pagamentos:cliente_id","no")}catch{}const{data:w,error:j}=await de.from("pagamentos").insert(b).select().single();if(j)throw j;return console.log("[registrarPagamento] Pagamento registrado sem cliente_id:",w),w}if(ZGe(v)){console.log("[registrarPagamento] Tentando abordagem alternativa sem status...");try{const x={...h};delete x.status;const{data:b,error:w}=await de.from("pagamentos").insert(x).select().single();if(w)throw w;return console.log("[registrarPagamento] Pagamento registrado com sucesso (abordagem alternativa):",b),b}catch(x){throw console.error("[registrarPagamento] Falha na abordagem alternativa:",x),new Error(`Falha ao processar pagamento: ${x.message}`)}}throw v}return console.log("[registrarPagamento] Pagamento registrado com sucesso:",m),m}catch(m){throw console.error("[registrarPagamento] Erro ao registrar pagamento:",{error:{message:m.message,code:m.code,details:m.details,hint:m.hint},comandaId:e,finalizadoraId:t,valor:h.valor,status:h.status,codigoEmpresa:l}),m}}async function d0({comandaId:e,codigoEmpresa:t,diferencaPagamento:r}){const n=t||ea(),s="[fecharComandaEMesa]";try{console.group(s)}catch{}try{console.time?.(s)}catch{}try{console.log(`${s} Iniciando fechamento da comanda ${e}`),console.log(`${s} Obtendo dados da comanda...`);const{data:o,error:i}=await de.from("comandas").select("id, mesa_id, status, fechado_em").eq("id",e).single();if(i||!o)throw console.error(`${s} Erro ao buscar comanda:`,i?.message||"Comanda no encontrada"),i||new Error("Comanda no encontrada");if(o.fechado_em)return console.log(`${s} Comanda ${e} j est fechada em ${o.fechado_em}`),!0;const l=new Date().toISOString();console.log(`${s} Atualizando comanda...`);const c={status:"closed",fechado_em:l};typeof r=="number"&&Number.isFinite(r)&&(c.diferenca_pagamento=r),console.log(`${s} Fechando comanda com status closed + fechado_em${c.diferenca_pagamento!=null?" + diferenca_pagamento":""}...`);let{error:d}=await de.from("comandas").update(c).eq("id",e).eq("codigo_empresa",n);if(d&&d.code==="42703"){console.warn(`${s} Coluna diferenca_pagamento ausente no schema, tentando novamente sem ela...`);const u={status:"closed",fechado_em:l};({error:d}=await de.from("comandas").update(u).eq("id",e).eq("codigo_empresa",n))}if(d)throw console.error(`${s} Erro ao fechar comanda:`,d),d;if(console.log(`${s} Comanda ${e} fechada com sucesso`),o.mesa_id){console.log(`${s} Atualizando status da mesa ${o.mesa_id} para disponvel...`);try{const{error:u}=await de.from("mesas").update({status:"available"}).eq("id",o.mesa_id).select("id").single();u?console.error(`${s} Erro ao atualizar status da mesa:`,u):console.log(`${s} Mesa ${o.mesa_id} marcada como disponvel`)}catch(u){console.error(`${s} Exceo ao atualizar mesa:`,u)}}else console.log(`${s} Nenhuma mesa associada para liberar`);return console.log(`${s} Fechamento da comanda ${e} concludo com sucesso`),!0}catch(o){throw console.error(`${s} Erro fatal ao fechar comanda:`,o),o}finally{try{console.timeEnd?.(s)}catch{}try{console.groupEnd()}catch{}}}async function wz({comandaId:e,codigoEmpresa:t}){const r=t||ea(),n="[cancelarComandaEMesa]";try{console.group(n)}catch{}try{console.time?.(n)}catch{}try{if(!e)throw new Error("comandaId obrigatrio");if(!r)throw new Error("codigo_empresa obrigatrio");console.log(`${n} Cancelando comanda ${e}`);const{data:s}=await de.from("comandas").select("id, mesa_id").eq("id",e).single();try{await de.from("comanda_itens").delete().eq("comanda_id",e).eq("codigo_empresa",r)}catch{}try{await de.from("comanda_clientes").delete().eq("comanda_id",e).eq("codigo_empresa",r)}catch{}const o=new Date().toISOString(),{data:i,error:l}=await de.from("comandas").update({status:"cancelled",fechado_em:o}).eq("id",e).eq("codigo_empresa",r).select();if(l)throw console.error(`${n} Erro ao atualizar comanda:`,l),l;if(!i||i.length===0)throw console.error(`${n}  UPDATE no afetou nenhuma linha! Comanda ${e} no foi encontrada ou RLS bloqueou`),new Error("Comanda no encontrada ou sem permisso para cancelar");if(console.log(`${n}  Comanda atualizada:`,i[0]),s?.mesa_id){console.log(`${n} Liberando mesa ${s.mesa_id}`);try{await de.from("mesas").update({status:"available"}).eq("id",s.mesa_id)}catch(c){console.error(`${n} Erro ao liberar mesa:`,c)}}return console.log(`${n} Comanda ${e} cancelada com sucesso`),!0}catch(s){throw console.error(`${n} Falha:`,s),s}finally{try{console.timeEnd?.(n)}catch{}try{console.groupEnd?.(n)}catch{}}}async function eKe({itemId:e,desconto_tipo:t,desconto_valor:r,desconto_motivo:n,codigoEmpresa:s}={}){const o=s||ea();if(!e)throw new Error("itemId  obrigatrio");if(!["percentual","fixo"].includes(t))throw new Error('Tipo de desconto deve ser "percentual" ou "fixo"');if(r<0)throw new Error("Desconto no pode ser negativo");if(t==="percentual"&&r>100)throw new Error("Desconto percentual no pode ser maior que 100%");let i=de.from("comanda_itens").update({desconto_tipo:t,desconto_valor:Number(r),desconto_motivo:n||null}).eq("id",e);o&&(i=i.eq("codigo_empresa",o));const{data:l,error:c}=await i.select("*").single();if(c)throw c;return l}async function tKe({comandaId:e,desconto_tipo:t,desconto_valor:r,desconto_motivo:n,codigoEmpresa:s}={}){const o=s||ea();if(!e)throw new Error("comandaId  obrigatrio");if(!["percentual","fixo"].includes(t))throw new Error('Tipo de desconto deve ser "percentual" ou "fixo"');if(r<0)throw new Error("Desconto no pode ser negativo");if(t==="percentual"&&r>100)throw new Error("Desconto percentual no pode ser maior que 100%");let i=de.from("comandas").update({desconto_tipo:t,desconto_valor:Number(r),desconto_motivo:n||null}).eq("id",e);o&&(i=i.eq("codigo_empresa",o));const{data:l,error:c}=await i.select("*").single();if(c)throw c;return l}async function rKe({itemId:e,codigoEmpresa:t}={}){const r=t||ea();if(!e)throw new Error("itemId  obrigatrio");let n=de.from("comanda_itens").update({desconto_tipo:null,desconto_valor:0,desconto_motivo:null}).eq("id",e);r&&(n=n.eq("codigo_empresa",r));const{data:s,error:o}=await n.select("*").single();if(o)throw o;return s}async function nKe({comandaId:e,codigoEmpresa:t}={}){const r=t||ea();if(!e)throw new Error("comandaId  obrigatrio");let n=de.from("comandas").update({desconto_tipo:null,desconto_valor:0,desconto_motivo:null}).eq("id",e);r&&(n=n.eq("codigo_empresa",r));const{data:s,error:o}=await n.select("*").single();if(o)throw o;return s}async function aKe({comandaId:e,observacoes:t,codigoEmpresa:r}={}){if(!e)throw new Error("comandaId  obrigatrio");const{error:n}=await de.from("comandas").update({observacoes:(t||"").trim()||null,observacoes_atualizadas_em:new Date().toISOString()}).eq("id",e);if(n)throw n;return{id:e}}var H5="Tabs",[sKe,nct]=Ld(H5,[z5]),zre=z5(),[oKe,tR]=sKe(H5),Ure=p.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,onValueChange:s,defaultValue:o,orientation:i="horizontal",dir:l,activationMode:c="automatic",...d}=e,u=L5(l),[f,h]=tm({prop:n,onChange:s,defaultProp:o??"",caller:H5});return a.jsx(oKe,{scope:r,baseId:uu(),value:f,onValueChange:h,orientation:i,dir:u,activationMode:c,children:a.jsx(ta.div,{dir:u,"data-orientation":i,...d,ref:t})})});Ure.displayName=H5;var Vre="TabsList",Wre=p.forwardRef((e,t)=>{const{__scopeTabs:r,loop:n=!0,...s}=e,o=tR(Vre,r),i=zre(r);return a.jsx(Vte,{asChild:!0,...i,orientation:o.orientation,dir:o.dir,loop:n,children:a.jsx(ta.div,{role:"tablist","aria-orientation":o.orientation,...s,ref:t})})});Wre.displayName=Vre;var Hre="TabsTrigger",Gre=p.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,disabled:s=!1,...o}=e,i=tR(Hre,r),l=zre(r),c=Yre(i.baseId,n),d=Jre(i.baseId,n),u=n===i.value;return a.jsx(Wte,{asChild:!0,...l,focusable:!s,active:u,children:a.jsx(ta.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":d,"data-state":u?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:c,...o,ref:t,onMouseDown:gn(e.onMouseDown,f=>{!s&&f.button===0&&f.ctrlKey===!1?i.onValueChange(n):f.preventDefault()}),onKeyDown:gn(e.onKeyDown,f=>{[" ","Enter"].includes(f.key)&&i.onValueChange(n)}),onFocus:gn(e.onFocus,()=>{const f=i.activationMode!=="manual";!u&&!s&&f&&i.onValueChange(n)})})})});Gre.displayName=Hre;var Kre="TabsContent",Xre=p.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,forceMount:s,children:o,...i}=e,l=tR(Kre,r),c=Yre(l.baseId,n),d=Jre(l.baseId,n),u=n===l.value,f=p.useRef(u);return p.useEffect(()=>{const h=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(h)},[]),a.jsx(Yc,{present:s||u,children:({present:h})=>a.jsx(ta.div,{"data-state":u?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!h,id:d,tabIndex:0,...i,ref:t,style:{...e.style,animationDuration:f.current?"0s":void 0},children:h&&o})})});Xre.displayName=Kre;function Yre(e,t){return`${e}-trigger-${t}`}function Jre(e,t){return`${e}-content-${t}`}var iKe=Ure,Qre=Wre,Zre=Gre,ene=Xre;const Mc=iKe,rc=Pe.forwardRef(({className:e,...t},r)=>a.jsx(Qre,{ref:r,className:pr("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));rc.displayName=Qre.displayName;const sa=Pe.forwardRef(({className:e,...t},r)=>a.jsx(Zre,{ref:r,className:pr("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));sa.displayName=Zre.displayName;const is=Pe.forwardRef(({className:e,...t},r)=>a.jsx(ene,{ref:r,className:pr("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));is.displayName=ene.displayName;function tne({open:e,onOpenChange:t,client:r,onSaved:n}){const{toast:s}=Qa(),{userProfile:o}=ms(),i=I=>({tipo_pessoa:I?.tipo_pessoa||"PF",tipo_cadastro:I?.tipo_cadastro||"cliente",nome:I?.nome||"",apelido:I?.apelido||"",cpf:I?.cpf||"",cnpj:I?.cnpj||"",rg:I?.rg||"",ie:I?.ie||"",email:I?.email||"",telefone:I?.telefone||"",fone2:I?.fone2||"",celular1:I?.celular1||"",celular2:I?.celular2||"",whatsapp:I?.whatsapp||"",cep:I?.cep||"",endereco:I?.endereco||"",numero:I?.numero||"",complemento:I?.complemento||"",bairro:I?.bairro||"",cidade:I?.cidade||"",uf:I?.uf||"",cidade_ibge:I?.cidade_ibge||"",limite_credito:I?.limite_credito??"",tipo_recebimento:I?.tipo_recebimento||"",regime_tributario:I?.regime_tributario||"",tipo_contribuinte:I?.tipo_contribuinte||"",aniversario:I?.aniversario?String(I.aniversario).slice(0,10):"",sexo:I?.sexo||"",estado_civil:I?.estado_civil||"",nome_mae:I?.nome_mae||"",nome_pai:I?.nome_pai||"",observacoes:I?.observacoes||"",status:I?.status||"active"}),[l,c]=p.useState(i(r)),[d,u]=p.useState("basicos"),[f,h]=p.useState(!1);p.useEffect(()=>{let I="cliente";r?.flag_cliente&&r?.flag_fornecedor?I="ambos":r?.flag_fornecedor&&(I="fornecedor"),c({tipo_pessoa:r?.tipo_pessoa||"PF",tipo_cadastro:I,nome:r?.nome||"",apelido:r?.apelido||"",cpf:r?.cpf||"",cnpj:r?.cnpj||"",rg:r?.rg||"",ie:r?.ie||"",email:r?.email||"",telefone:r?.telefone||"",fone2:r?.fone2||"",celular1:r?.celular1||"",celular2:r?.celular2||"",whatsapp:r?.whatsapp||"",cep:r?.cep||"",endereco:r?.endereco||"",numero:r?.numero||"",complemento:r?.complemento||"",bairro:r?.bairro||"",cidade:r?.cidade||"",uf:r?.uf||"",cidade_ibge:r?.cidade_ibge||"",limite_credito:r?.limite_credito??"",tipo_recebimento:r?.tipo_recebimento||"",regime_tributario:r?.regime_tributario||"",tipo_contribuinte:r?.tipo_contribuinte||"",aniversario:r?.aniversario?String(r.aniversario).slice(0,10):"",sexo:r?.sexo||"",estado_civil:r?.estado_civil||"",nome_mae:r?.nome_mae||"",nome_pai:r?.nome_pai||"",observacoes:r?.observacoes||"",status:r?.status||"active"})},[r]),p.useEffect(()=>{e?c(i(r||null)):r||c(i(null))},[e,!!r]);const m=I=>{const{id:M,value:D}=I.target;c(U=>({...U,[M]:D}))},v=async()=>{try{const I=x.digits(l.cnpj);if(!I||I.length!==14){s({title:"CNPJ invlido",description:"Informe 14 dgitos para buscar.",variant:"destructive"});return}const M=await fetch(`https://brasilapi.com.br/api/cnpj/v1/${I}`);if(!M.ok){let pe="Falha ao consultar CNPJ";try{const te=await M.json();te?.message&&(pe=te.message)}catch{}throw new Error(pe)}const D=await M.json();try{console.info("[clientes] BuscarCNPJ:payload",D)}catch{}const U=D.razao_social||D.nome||"",z=D.nome_fantasia||"",W=D.logradouro||"",$=String(D.numero||""),X=D.complemento||"",ye=D.bairro||"",Se=D.municipio||D.localidade||"",V=D.uf||"",B=x.digits(D.cep||"");let Q="";try{if(Se&&V){const pe=await fetch(`https://brasilapi.com.br/api/ibge/municipios/v1/${V}`);if(pe.ok){const te=await pe.json(),Y=ae=>String(ae||"").normalize("NFD").replace(/\p{Diacritic}/gu,"").toLowerCase().trim(),ce=Y(Se),me=(te||[]).find(ae=>Y(ae.nome)===ce);(me?.codigo_ibge||me?.codigo)&&(Q=String(me.codigo_ibge||me.codigo))}}}catch{}c(pe=>({...pe,nome:U,apelido:z||U,endereco:W,numero:$,complemento:X,bairro:ye,cidade:Se,uf:V,cep:B,cidade_ibge:Q||pe.cidade_ibge}));try{console.info("[clientes] BuscarCNPJ:setForm",{razao:U,fantasia:z,logradouro:W,numero:$,complemento:X,bairro:ye,cidade:Se,uf:V,cep:B,codigoIBGE:Q})}catch{}s({title:"CNPJ carregado",description:"Dados preenchidos."})}catch(I){s({title:"Falha ao buscar CNPJ",description:I.message||"Tente novamente.",variant:"destructive"})}},g=I=>I===""?null:I,y=I=>{if(I==null)return null;if(typeof I=="number")return I;const M=String(I).trim();if(!M)return null;const D=M.replace(/\s+/g,"").replace(/\.(?=\d{3}(?:\D|$))/g,"").replace(/,/g,"."),U=Number(D);return Number.isFinite(U)?U:null},x=p.useMemo(()=>({digits:I=>(I||"").replace(/\D+/g,"")}),[]),b=I=>x.digits(I).slice(0,11).replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})$/,"$1-$2"),w=I=>x.digits(I).slice(0,14).replace(/(\d{2})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1/$2").replace(/(\d{4})(\d{1,2})$/,"$1-$2"),j=I=>x.digits(I).slice(0,8).replace(/(\d{5})(\d)/,"$1-$2"),_=I=>{const M=x.digits(I).slice(0,11);return M.length<=10?M.replace(/(\d{2})(\d{4})(\d{0,4})/,"($1) $2-$3").trim():M.replace(/(\d{2})(\d{5})(\d{0,4})/,"($1) $2-$3").trim()},S=I=>String(I||"").replace(/[^a-z]/gi,"").toUpperCase().slice(0,2),C=(I,M=6)=>x.digits(I).slice(0,M),P=I=>{const M=x.digits(I);return M?(Number(M)/100).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""},A=(I,M)=>{let D=M;I==="cpf"&&(D=b(M)),I==="cnpj"&&(D=w(M)),I==="cep"&&(D=j(M)),["telefone","fone2","celular1","celular2","whatsapp"].includes(I)&&(D=_(M)),I==="uf"&&(D=S(M)),I==="numero"&&(D=C(M,8)),I==="cidade_ibge"&&(D=C(M,7)),I==="limite_credito"&&(D=P(M)),c(U=>({...U,[I]:D}))},R=async()=>{const I=x.digits(l.cep);if(!I||I.length!==8){s({title:"CEP invlido",description:"Informe 8 dgitos.",variant:"destructive"});return}try{h(!0),c(U=>({...U,endereco:"Buscando...",bairro:"Buscando...",cidade:"Buscando...",uf:""}));const D=await(await fetch(`https://viacep.com.br/ws/${I}/json/`)).json();if(D.erro)throw new Error("CEP no encontrado");c(U=>({...U,endereco:D.logradouro||"",bairro:D.bairro||"",cidade:D.localidade||"",uf:D.uf||"",cidade_ibge:D.ibge||""})),s({title:"CEP encontrado!",description:"Endereo preenchido automaticamente.",variant:"success"})}catch(M){c(D=>({...D,endereco:"",bairro:"",cidade:"",uf:""})),s({title:"Falha ao buscar CEP",description:M.message||"Tente novamente.",variant:"destructive"})}finally{h(!1)}},O=async I=>{I?.preventDefault?.(),window.__protectPaymentModal&&window.__protectPaymentModal(5e3);try{if(!l.nome||l.nome.trim().length<2)throw new Error("Informe o nome/razo social do cliente.");const M={tipo_pessoa:g(l.tipo_pessoa),nome:l.nome,apelido:g(l.apelido),cpf:g(l.cpf),cnpj:g(l.cnpj),rg:g(l.rg),ie:g(l.ie),email:g(l.email),telefone:g(l.telefone),fone2:g(l.fone2),celular1:g(l.celular1),celular2:g(l.celular2),whatsapp:g(l.whatsapp),cep:g(l.cep),endereco:g(l.endereco),numero:g(l.numero),complemento:g(l.complemento),bairro:g(l.bairro),cidade:g(l.cidade),uf:g(l.uf),cidade_ibge:g(l.cidade_ibge),limite_credito:y(l.limite_credito),tipo_recebimento:g(l.tipo_recebimento),regime_tributario:g(l.regime_tributario),tipo_contribuinte:g(l.tipo_contribuinte),aniversario:g(l.aniversario),sexo:g(l.sexo),estado_civil:g(l.estado_civil),nome_mae:g(l.nome_mae),nome_pai:g(l.nome_pai),observacoes:g(l.observacoes),flag_cliente:l.tipo_cadastro==="cliente"||l.tipo_cadastro==="ambos",flag_fornecedor:l.tipo_cadastro==="fornecedor"||l.tipo_cadastro==="ambos",flag_funcionario:!1,flag_administradora:!1,flag_parceiro:!1,flag_ccf_spc:!1,status:l.status};let D,U=null;if(r?.id){const{data:z,error:W}=await de.from("clientes").update(M).eq("id",r.id).select().single();D=W,U=z??null}else{const z=o?.codigo_empresa||null;if(!z)throw new Error("No foi possvel identificar a empresa do usurio (codigo_empresa). Tente recarregar a pgina ou entrar novamente.");const W={...M,codigo_empresa:z},{data:$,error:X}=await de.from("clientes").insert(W).select().single();D=X,U=$??null}if(D)throw D;s({title:"Cliente salvo!",description:"As informaes do cliente foram atualizadas.",variant:"success"}),n?.(U),setTimeout(()=>{t?.(!1)},50)}catch(M){const D=(M?.message||"").toLowerCase(),U=M?.code||"";let z="Erro ao salvar cliente",W=M.message;U==="23505"||D.includes("duplicate key")&&D.includes("uq_clientes_empresa_codigo")?(z="Cdigo j cadastrado",W="J existe um cliente com este cdigo na sua empresa. Deixe o campo cdigo em branco para gerar automaticamente ou escolha outro nmero."):D.includes("column")&&D.includes("does not exist")&&(W="Seu banco pode no estar migrado para os novos campos. Atualize o schema conforme estrutura_bd."),s({title:z,description:W,variant:"destructive"})}};return a.jsx(mn,{open:e,onOpenChange:t,children:a.jsxs(un,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto w-full",children:[a.jsxs(on,{children:[a.jsx(an,{children:r?"Editar Cliente":"Novo Cliente"}),a.jsx(Nn,{children:"Preencha os dados cadastrais do cliente."})]}),a.jsx("form",{onSubmit:O,className:"grid gap-4 sm:gap-6 py-2",children:a.jsxs(Mc,{value:d,onValueChange:u,className:"w-full",children:[a.jsx("div",{className:"sm:hidden mb-4",children:a.jsxs(vn,{value:d,onValueChange:u,children:[a.jsx(hn,{className:"w-full",children:a.jsx(wn,{})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"basicos",children:"Dados Bsicos"}),a.jsx(ct,{value:"endereco",children:"Endereo"}),a.jsx(ct,{value:"financeiro",children:"Financeiro"}),a.jsx(ct,{value:"adicionais",children:"Adicionais"})]})]})}),a.jsxs(rc,{className:"hidden sm:grid grid-cols-4 gap-2",children:[a.jsx(sa,{value:"basicos",children:"Dados Bsicos"}),a.jsx(sa,{value:"endereco",children:"Endereo"}),a.jsx(sa,{value:"financeiro",children:"Financeiro"}),a.jsx(sa,{value:"adicionais",children:"Adicionais"})]}),a.jsx(is,{value:"basicos",className:"space-y-3 sm:space-y-4 mt-2",children:a.jsxs("div",{className:"grid grid-cols-12 gap-3 sm:gap-4",children:[a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(qe,{children:"Tipo de Pessoa"}),a.jsxs(vn,{value:l.tipo_pessoa,onValueChange:I=>c(M=>({...M,tipo_pessoa:I})),children:[a.jsx(hn,{children:a.jsx(wn,{placeholder:"Pessoa"})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"PF",children:"Fsica"}),a.jsx(ct,{value:"PJ",children:"Jurdica"})]})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(qe,{children:"Tipo de Cadastro *"}),a.jsxs(vn,{value:l.tipo_cadastro,onValueChange:I=>c(M=>({...M,tipo_cadastro:I})),required:!0,children:[a.jsx(hn,{children:a.jsx(wn,{placeholder:"Selecione"})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"cliente",children:"Cliente"}),a.jsx(ct,{value:"fornecedor",children:"Fornecedor"}),a.jsx(ct,{value:"ambos",children:"Cliente e Fornecedor"})]})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[a.jsx(qe,{htmlFor:"nome",children:l.tipo_pessoa==="PJ"?"Razo Social":"Nome"}),a.jsx(rt,{id:"nome",value:l.nome,onChange:m,required:!0})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[a.jsx(qe,{htmlFor:"apelido",children:l.tipo_pessoa==="PJ"?"Nome Fantasia":"Apelido"}),a.jsx(rt,{id:"apelido",value:l.apelido,onChange:m})]}),l.tipo_pessoa==="PF"?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(qe,{htmlFor:"cpf",children:"CPF"}),a.jsx(rt,{id:"cpf",value:l.cpf,onChange:I=>A("cpf",I.target.value),placeholder:"000.000.000-00"})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(qe,{htmlFor:"rg",children:"RG"}),a.jsx(rt,{id:"rg",value:l.rg,onChange:m})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(qe,{htmlFor:"cnpj",children:"CNPJ"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(rt,{id:"cnpj",value:l.cnpj,onChange:I=>A("cnpj",I.target.value),placeholder:"00.000.000/0000-00"}),a.jsx(fe,{type:"button",variant:"outline",onClick:v,children:"Buscar"})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(qe,{htmlFor:"ie",children:"Inscrio Estadual (IE)"}),a.jsx(rt,{id:"ie",value:l.ie,onChange:m})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[a.jsx(qe,{htmlFor:"email",children:"Email"}),a.jsx(rt,{id:"email",type:"email",value:l.email,onChange:m})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(qe,{htmlFor:"telefone",children:"Telefone"}),a.jsx(rt,{id:"telefone",value:l.telefone,onChange:I=>A("telefone",I.target.value)})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(qe,{htmlFor:"celular1",children:"Celular"}),a.jsx(rt,{id:"celular1",value:l.celular1,onChange:I=>A("celular1",I.target.value)})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(qe,{htmlFor:"whatsapp",children:"WhatsApp"}),a.jsx(rt,{id:"whatsapp",value:l.whatsapp,onChange:I=>A("whatsapp",I.target.value),placeholder:"(DDD) 9...."})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(qe,{htmlFor:"fone2",children:"Fone 2"}),a.jsx(rt,{id:"fone2",value:l.fone2,onChange:I=>A("fone2",I.target.value)})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(qe,{htmlFor:"celular2",children:"Celular 2"}),a.jsx(rt,{id:"celular2",value:l.celular2,onChange:I=>A("celular2",I.target.value)})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(qe,{htmlFor:"aniversario",children:"Nascimento"}),a.jsx(rt,{id:"aniversario",type:"date",value:l.aniversario||"",onChange:m})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(qe,{children:"Status"}),a.jsxs(vn,{value:l.status,onValueChange:I=>c(M=>({...M,status:I})),children:[a.jsx(hn,{children:a.jsx(wn,{placeholder:"Status"})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"active",children:"Ativo"}),a.jsx(ct,{value:"inactive",children:"Inativo"})]})]})]})]})}),a.jsx(is,{value:"endereco",className:"space-y-3 sm:space-y-4 mt-2",children:a.jsxs("div",{className:"grid grid-cols-12 gap-3 sm:gap-4",children:[a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(qe,{htmlFor:"cep",children:"CEP"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(rt,{id:"cep",value:l.cep,onChange:I=>A("cep",I.target.value),placeholder:"00000-000"}),a.jsx(fe,{type:"button",variant:"outline",onClick:R,disabled:f,children:f?"Buscando...":"Buscar"})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[a.jsx(qe,{htmlFor:"endereco",children:"Endereo"}),a.jsx(rt,{id:"endereco",value:l.endereco,onChange:m})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(qe,{htmlFor:"numero",children:"Nmero"}),a.jsx(rt,{id:"numero",value:l.numero,onChange:I=>A("numero",I.target.value)})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[a.jsx(qe,{htmlFor:"complemento",children:"Complemento"}),a.jsx(rt,{id:"complemento",value:l.complemento,onChange:m})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[a.jsx(qe,{htmlFor:"bairro",children:"Bairro"}),a.jsx(rt,{id:"bairro",value:l.bairro,onChange:m})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(qe,{htmlFor:"cidade",children:"Cidade"}),a.jsx(rt,{id:"cidade",value:l.cidade,onChange:m})]}),a.jsxs("div",{className:"col-span-6 sm:col-span-1",children:[a.jsx(qe,{htmlFor:"uf",children:"UF"}),a.jsx(rt,{id:"uf",value:l.uf,onChange:I=>A("uf",I.target.value),placeholder:"UF"})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(qe,{htmlFor:"cidade_ibge",children:"Cd. IBGE"}),a.jsx(rt,{id:"cidade_ibge",value:l.cidade_ibge,onChange:I=>A("cidade_ibge",I.target.value)})]})]})}),a.jsx(is,{value:"financeiro",className:"space-y-3 sm:space-y-4 mt-2",children:a.jsxs("div",{className:"grid grid-cols-12 gap-3 sm:gap-4",children:[a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(qe,{htmlFor:"limite_credito",children:"Limite de Crdito"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-secondary text-sm",children:"R$"}),a.jsx(rt,{id:"limite_credito",value:l.limite_credito,onChange:I=>A("limite_credito",I.target.value),placeholder:"0,00",className:"pl-10"})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(qe,{children:"Tipo de Recebimento"}),a.jsxs(vn,{value:l.tipo_recebimento||"",onValueChange:I=>c(M=>({...M,tipo_recebimento:I})),children:[a.jsx(hn,{children:a.jsx(wn,{placeholder:"Selecione"})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"avista",children:" vista"}),a.jsx(ct,{value:"aprazo",children:"A prazo"}),a.jsx(ct,{value:"misto",children:"Misto"})]})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(qe,{children:"Regime Tributrio"}),a.jsxs(vn,{value:l.regime_tributario||"",onValueChange:I=>c(M=>({...M,regime_tributario:I})),children:[a.jsx(hn,{children:a.jsx(wn,{placeholder:"Selecione"})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"simples",children:"Simples"}),a.jsx(ct,{value:"lucro_presumido",children:"Lucro Presumido"}),a.jsx(ct,{value:"lucro_real",children:"Lucro Real"})]})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[a.jsx(qe,{children:"Tipo de Contribuinte"}),a.jsxs(vn,{value:l.tipo_contribuinte||"",onValueChange:I=>c(M=>({...M,tipo_contribuinte:I})),children:[a.jsx(hn,{children:a.jsx(wn,{placeholder:"Selecione"})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"nao_contribuinte",children:"No Contribuinte"}),a.jsx(ct,{value:"contribuinte",children:"Contribuinte"}),a.jsx(ct,{value:"isento",children:"Isento"})]})]})]})]})}),a.jsx(is,{value:"adicionais",className:"space-y-3 sm:space-y-4 mt-2",children:a.jsxs("div",{className:"grid grid-cols-12 gap-3 sm:gap-4",children:[a.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[a.jsx(qe,{htmlFor:"sexo",children:"Sexo"}),a.jsxs(vn,{value:l.sexo||"",onValueChange:I=>c(M=>({...M,sexo:I})),children:[a.jsx(hn,{children:a.jsx(wn,{placeholder:"Selecione"})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"m",children:"Masculino"}),a.jsx(ct,{value:"f",children:"Feminino"}),a.jsx(ct,{value:"o",children:"Outro"})]})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[a.jsx(qe,{htmlFor:"estado_civil",children:"Estado Civil"}),a.jsxs(vn,{value:l.estado_civil||"",onValueChange:I=>c(M=>({...M,estado_civil:I})),children:[a.jsx(hn,{children:a.jsx(wn,{placeholder:"Selecione"})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"solteiro",children:"Solteiro(a)"}),a.jsx(ct,{value:"casado",children:"Casado(a)"}),a.jsx(ct,{value:"divorciado",children:"Divorciado(a)"}),a.jsx(ct,{value:"viuvo",children:"Vivo(a)"})]})]})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[a.jsx(qe,{htmlFor:"nome_mae",children:"Nome da Me"}),a.jsx(rt,{id:"nome_mae",value:l.nome_mae,onChange:m})]}),a.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[a.jsx(qe,{htmlFor:"nome_pai",children:"Nome do Pai"}),a.jsx(rt,{id:"nome_pai",value:l.nome_pai,onChange:m})]}),a.jsxs("div",{className:"col-span-12",children:[a.jsx(qe,{htmlFor:"observacoes",children:"Observaes"}),a.jsx("textarea",{id:"observacoes",value:l.observacoes,onChange:m,rows:4,className:"w-full rounded-md border border-border bg-background p-2 text-sm"})]})]})})]})}),a.jsxs(Qn,{className:"flex flex-col sm:flex-row gap-2 sm:gap-0",children:[a.jsx(vh,{asChild:!0,children:a.jsx(fe,{type:"button",variant:"secondary",className:"w-full sm:w-auto",children:"Cancelar"})}),a.jsx(fe,{type:"submit",onClick:O,className:"w-full sm:w-auto",children:"Salvar Cliente"})]})]})})}function lKe(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const r=document.implementation.createHTMLDocument(),n=r.createElement("base"),s=r.createElement("a");return r.head.appendChild(n),r.body.appendChild(s),t&&(n.href=t),s.href=e,s.href}const cKe=(()=>{let e=0;const t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function wh(e){const t=[];for(let r=0,n=e.length;r<n;r++)t.push(e[r]);return t}let hv=null;function rne(e={}){return hv||(e.includeStyleProperties?(hv=e.includeStyleProperties,hv):(hv=wh(window.getComputedStyle(document.documentElement)),hv))}function CS(e,t){const n=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t);return n?parseFloat(n.replace("px","")):0}function dKe(e){const t=CS(e,"border-left-width"),r=CS(e,"border-right-width");return e.clientWidth+t+r}function uKe(e){const t=CS(e,"border-top-width"),r=CS(e,"border-bottom-width");return e.clientHeight+t+r}function nne(e,t={}){const r=t.width||dKe(e),n=t.height||uKe(e);return{width:r,height:n}}function fKe(){let e,t;try{t=process}catch{}const r=t&&t.env?t.env.devicePixelRatio:null;return r&&(e=parseInt(r,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const bc=16384;function mKe(e){(e.width>bc||e.height>bc)&&(e.width>bc&&e.height>bc?e.width>e.height?(e.height*=bc/e.width,e.width=bc):(e.width*=bc/e.height,e.height=bc):e.width>bc?(e.height*=bc/e.width,e.width=bc):(e.width*=bc/e.height,e.height=bc))}function PS(e){return new Promise((t,r)=>{const n=new Image;n.onload=()=>{n.decode().then(()=>{requestAnimationFrame(()=>t(n))})},n.onerror=r,n.crossOrigin="anonymous",n.decoding="async",n.src=e})}async function hKe(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(t=>`data:image/svg+xml;charset=utf-8,${t}`)}async function pKe(e,t,r){const n="http://www.w3.org/2000/svg",s=document.createElementNS(n,"svg"),o=document.createElementNS(n,"foreignObject");return s.setAttribute("width",`${t}`),s.setAttribute("height",`${r}`),s.setAttribute("viewBox",`0 0 ${t} ${r}`),o.setAttribute("width","100%"),o.setAttribute("height","100%"),o.setAttribute("x","0"),o.setAttribute("y","0"),o.setAttribute("externalResourcesRequired","true"),s.appendChild(o),o.appendChild(e),hKe(s)}const ic=(e,t)=>{if(e instanceof t)return!0;const r=Object.getPrototypeOf(e);return r===null?!1:r.constructor.name===t.name||ic(r,t)};function gKe(e){const t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}function vKe(e,t){return rne(t).map(r=>{const n=e.getPropertyValue(r),s=e.getPropertyPriority(r);return`${r}: ${n}${s?" !important":""};`}).join(" ")}function xKe(e,t,r,n){const s=`.${e}:${t}`,o=r.cssText?gKe(r):vKe(r,n);return document.createTextNode(`${s}{${o}}`)}function jz(e,t,r,n){const s=window.getComputedStyle(e,r),o=s.getPropertyValue("content");if(o===""||o==="none")return;const i=cKe();try{t.className=`${t.className} ${i}`}catch{return}const l=document.createElement("style");l.appendChild(xKe(i,r,s,n)),t.appendChild(l)}function yKe(e,t,r){jz(e,t,":before",r),jz(e,t,":after",r)}const _z="application/font-woff",Nz="image/jpeg",bKe={woff:_z,woff2:_z,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Nz,jpeg:Nz,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function wKe(e){const t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}function rR(e){const t=wKe(e).toLowerCase();return bKe[t]||""}function jKe(e){return e.split(/,/)[1]}function BT(e){return e.search(/^(data:)/)!==-1}function ane(e,t){return`data:${t};base64,${e}`}async function sne(e,t,r){const n=await fetch(e,t);if(n.status===404)throw new Error(`Resource "${n.url}" not found`);const s=await n.blob();return new Promise((o,i)=>{const l=new FileReader;l.onerror=i,l.onloadend=()=>{try{o(r({res:n,result:l.result}))}catch(c){i(c)}},l.readAsDataURL(s)})}const bE={};function _Ke(e,t,r){let n=e.replace(/\?.*/,"");return r&&(n=e),/ttf|otf|eot|woff2?/i.test(n)&&(n=n.replace(/.*\//,"")),t?`[${t}]${n}`:n}async function nR(e,t,r){const n=_Ke(e,t,r.includeQueryParams);if(bE[n]!=null)return bE[n];r.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let s;try{const o=await sne(e,r.fetchRequestInit,({res:i,result:l})=>(t||(t=i.headers.get("Content-Type")||""),jKe(l)));s=ane(o,t)}catch(o){s=r.imagePlaceholder||"";let i=`Failed to fetch resource: ${e}`;o&&(i=typeof o=="string"?o:o.message),i&&console.warn(i)}return bE[n]=s,s}async function NKe(e){const t=e.toDataURL();return t==="data:,"?e.cloneNode(!1):PS(t)}async function SKe(e,t){if(e.currentSrc){const o=document.createElement("canvas"),i=o.getContext("2d");o.width=e.clientWidth,o.height=e.clientHeight,i?.drawImage(e,0,0,o.width,o.height);const l=o.toDataURL();return PS(l)}const r=e.poster,n=rR(r),s=await nR(r,n,t);return PS(s)}async function CKe(e,t){var r;try{if(!((r=e?.contentDocument)===null||r===void 0)&&r.body)return await G5(e.contentDocument.body,t,!0)}catch{}return e.cloneNode(!1)}async function PKe(e,t){return ic(e,HTMLCanvasElement)?NKe(e):ic(e,HTMLVideoElement)?SKe(e,t):ic(e,HTMLIFrameElement)?CKe(e,t):e.cloneNode(one(e))}const AKe=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT",one=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SVG";async function EKe(e,t,r){var n,s;if(one(t))return t;let o=[];return AKe(e)&&e.assignedNodes?o=wh(e.assignedNodes()):ic(e,HTMLIFrameElement)&&(!((n=e.contentDocument)===null||n===void 0)&&n.body)?o=wh(e.contentDocument.body.childNodes):o=wh(((s=e.shadowRoot)!==null&&s!==void 0?s:e).childNodes),o.length===0||ic(e,HTMLVideoElement)||await o.reduce((i,l)=>i.then(()=>G5(l,r)).then(c=>{c&&t.appendChild(c)}),Promise.resolve()),t}function kKe(e,t,r){const n=t.style;if(!n)return;const s=window.getComputedStyle(e);s.cssText?(n.cssText=s.cssText,n.transformOrigin=s.transformOrigin):rne(r).forEach(o=>{let i=s.getPropertyValue(o);o==="font-size"&&i.endsWith("px")&&(i=`${Math.floor(parseFloat(i.substring(0,i.length-2)))-.1}px`),ic(e,HTMLIFrameElement)&&o==="display"&&i==="inline"&&(i="block"),o==="d"&&t.getAttribute("d")&&(i=`path(${t.getAttribute("d")})`),n.setProperty(o,i,s.getPropertyPriority(o))})}function IKe(e,t){ic(e,HTMLTextAreaElement)&&(t.innerHTML=e.value),ic(e,HTMLInputElement)&&t.setAttribute("value",e.value)}function OKe(e,t){if(ic(e,HTMLSelectElement)){const r=t,n=Array.from(r.children).find(s=>e.value===s.getAttribute("value"));n&&n.setAttribute("selected","")}}function TKe(e,t,r){return ic(t,Element)&&(kKe(e,t,r),yKe(e,t,r),IKe(e,t),OKe(e,t)),t}async function DKe(e,t){const r=e.querySelectorAll?e.querySelectorAll("use"):[];if(r.length===0)return e;const n={};for(let o=0;o<r.length;o++){const l=r[o].getAttribute("xlink:href");if(l){const c=e.querySelector(l),d=document.querySelector(l);!c&&d&&!n[l]&&(n[l]=await G5(d,t,!0))}}const s=Object.values(n);if(s.length){const o="http://www.w3.org/1999/xhtml",i=document.createElementNS(o,"svg");i.setAttribute("xmlns",o),i.style.position="absolute",i.style.width="0",i.style.height="0",i.style.overflow="hidden",i.style.display="none";const l=document.createElementNS(o,"defs");i.appendChild(l);for(let c=0;c<s.length;c++)l.appendChild(s[c]);e.appendChild(i)}return e}async function G5(e,t,r){return!r&&t.filter&&!t.filter(e)?null:Promise.resolve(e).then(n=>PKe(n,t)).then(n=>EKe(e,n,t)).then(n=>TKe(e,n,t)).then(n=>DKe(n,t))}const ine=/url\((['"]?)([^'"]+?)\1\)/g,MKe=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,RKe=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function LKe(e){const t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}function FKe(e){const t=[];return e.replace(ine,(r,n,s)=>(t.push(s),r)),t.filter(r=>!BT(r))}async function $Ke(e,t,r,n,s){try{const o=r?lKe(t,r):t,i=rR(t);let l;if(s){const c=await s(o);l=ane(c,i)}else l=await nR(o,i,n);return e.replace(LKe(t),`$1${l}$3`)}catch{}return e}function BKe(e,{preferredFontFormat:t}){return t?e.replace(RKe,r=>{for(;;){const[n,,s]=MKe.exec(r)||[];if(!s)return"";if(s===t)return`src: ${n};`}}):e}function lne(e){return e.search(ine)!==-1}async function cne(e,t,r){if(!lne(e))return e;const n=BKe(e,r);return FKe(n).reduce((o,i)=>o.then(l=>$Ke(l,i,t,r)),Promise.resolve(n))}async function pv(e,t,r){var n;const s=(n=t.style)===null||n===void 0?void 0:n.getPropertyValue(e);if(s){const o=await cne(s,null,r);return t.style.setProperty(e,o,t.style.getPropertyPriority(e)),!0}return!1}async function qKe(e,t){await pv("background",e,t)||await pv("background-image",e,t),await pv("mask",e,t)||await pv("-webkit-mask",e,t)||await pv("mask-image",e,t)||await pv("-webkit-mask-image",e,t)}async function zKe(e,t){const r=ic(e,HTMLImageElement);if(!(r&&!BT(e.src))&&!(ic(e,SVGImageElement)&&!BT(e.href.baseVal)))return;const n=r?e.src:e.href.baseVal,s=await nR(n,rR(n),t);await new Promise((o,i)=>{e.onload=o,e.onerror=t.onImageErrorHandler?(...c)=>{try{o(t.onImageErrorHandler(...c))}catch(d){i(d)}}:i;const l=e;l.decode&&(l.decode=o),l.loading==="lazy"&&(l.loading="eager"),r?(e.srcset="",e.src=s):e.href.baseVal=s})}async function UKe(e,t){const n=wh(e.childNodes).map(s=>dne(s,t));await Promise.all(n).then(()=>e)}async function dne(e,t){ic(e,Element)&&(await qKe(e,t),await zKe(e,t),await UKe(e,t))}function VKe(e,t){const{style:r}=e;t.backgroundColor&&(r.backgroundColor=t.backgroundColor),t.width&&(r.width=`${t.width}px`),t.height&&(r.height=`${t.height}px`);const n=t.style;return n!=null&&Object.keys(n).forEach(s=>{r[s]=n[s]}),e}const Sz={};async function Cz(e){let t=Sz[e];if(t!=null)return t;const n=await(await fetch(e)).text();return t={url:e,cssText:n},Sz[e]=t,t}async function Pz(e,t){let r=e.cssText;const n=/url\(["']?([^"')]+)["']?\)/g,o=(r.match(/url\([^)]+\)/g)||[]).map(async i=>{let l=i.replace(n,"$1");return l.startsWith("https://")||(l=new URL(l,e.url).href),sne(l,t.fetchRequestInit,({result:c})=>(r=r.replace(i,`url(${c})`),[i,c]))});return Promise.all(o).then(()=>r)}function Az(e){if(e==null)return[];const t=[],r=/(\/\*[\s\S]*?\*\/)/gi;let n=e.replace(r,"");const s=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const c=s.exec(n);if(c===null)break;t.push(c[0])}n=n.replace(s,"");const o=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,i="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",l=new RegExp(i,"gi");for(;;){let c=o.exec(n);if(c===null){if(c=l.exec(n),c===null)break;o.lastIndex=l.lastIndex}else l.lastIndex=o.lastIndex;t.push(c[0])}return t}async function WKe(e,t){const r=[],n=[];return e.forEach(s=>{if("cssRules"in s)try{wh(s.cssRules||[]).forEach((o,i)=>{if(o.type===CSSRule.IMPORT_RULE){let l=i+1;const c=o.href,d=Cz(c).then(u=>Pz(u,t)).then(u=>Az(u).forEach(f=>{try{s.insertRule(f,f.startsWith("@import")?l+=1:s.cssRules.length)}catch(h){console.error("Error inserting rule from remote css",{rule:f,error:h})}})).catch(u=>{console.error("Error loading remote css",u.toString())});n.push(d)}})}catch(o){const i=e.find(l=>l.href==null)||document.styleSheets[0];s.href!=null&&n.push(Cz(s.href).then(l=>Pz(l,t)).then(l=>Az(l).forEach(c=>{i.insertRule(c,i.cssRules.length)})).catch(l=>{console.error("Error loading remote stylesheet",l)})),console.error("Error inlining remote css file",o)}}),Promise.all(n).then(()=>(e.forEach(s=>{if("cssRules"in s)try{wh(s.cssRules||[]).forEach(o=>{r.push(o)})}catch(o){console.error(`Error while reading CSS rules from ${s.href}`,o)}}),r))}function HKe(e){return e.filter(t=>t.type===CSSRule.FONT_FACE_RULE).filter(t=>lne(t.style.getPropertyValue("src")))}async function GKe(e,t){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const r=wh(e.ownerDocument.styleSheets),n=await WKe(r,t);return HKe(n)}function une(e){return e.trim().replace(/["']/g,"")}function KKe(e){const t=new Set;function r(n){(n.style.fontFamily||getComputedStyle(n).fontFamily).split(",").forEach(o=>{t.add(une(o))}),Array.from(n.children).forEach(o=>{o instanceof HTMLElement&&r(o)})}return r(e),t}async function XKe(e,t){const r=await GKe(e,t),n=KKe(e);return(await Promise.all(r.filter(o=>n.has(une(o.style.fontFamily))).map(o=>{const i=o.parentStyleSheet?o.parentStyleSheet.href:null;return cne(o.cssText,i,t)}))).join(`
`)}async function YKe(e,t){const r=t.fontEmbedCSS!=null?t.fontEmbedCSS:t.skipFonts?null:await XKe(e,t);if(r){const n=document.createElement("style"),s=document.createTextNode(r);n.appendChild(s),e.firstChild?e.insertBefore(n,e.firstChild):e.appendChild(n)}}async function JKe(e,t={}){const{width:r,height:n}=nne(e,t),s=await G5(e,t,!0);return await YKe(s,t),await dne(s,t),VKe(s,t),await pKe(s,r,n)}async function QKe(e,t={}){const{width:r,height:n}=nne(e,t),s=await JKe(e,t),o=await PS(s),i=document.createElement("canvas"),l=i.getContext("2d"),c=t.pixelRatio||fKe(),d=t.canvasWidth||r,u=t.canvasHeight||n;return i.width=d*c,i.height=u*c,t.skipAutoScale||mKe(i),i.style.width=`${d}`,i.style.height=`${u}`,t.backgroundColor&&(l.fillStyle=t.backgroundColor,l.fillRect(0,0,i.width,i.height)),l.drawImage(o,0,0,i.width,i.height),i}async function ZKe(e,t={}){return(await QKe(e,t)).toDataURL()}var yu=Uint8Array,Rc=Uint16Array,aR=Int32Array,sR=new yu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),oR=new yu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ez=new yu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),fne=function(e,t){for(var r=new Rc(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var s=new aR(r[30]),n=1;n<30;++n)for(var o=r[n];o<r[n+1];++o)s[o]=o-r[n]<<5|n;return{b:r,r:s}},mne=fne(sR,2),eXe=mne.b,qT=mne.r;eXe[28]=258,qT[258]=28;var tXe=fne(oR,0),kz=tXe.r,zT=new Rc(32768);for(var Fs=0;Fs<32768;++Fs){var Pm=(Fs&43690)>>1|(Fs&21845)<<1;Pm=(Pm&52428)>>2|(Pm&13107)<<2,Pm=(Pm&61680)>>4|(Pm&3855)<<4,zT[Fs]=((Pm&65280)>>8|(Pm&255)<<8)>>1}var Nb=function(e,t,r){for(var n=e.length,s=0,o=new Rc(t);s<n;++s)e[s]&&++o[e[s]-1];var i=new Rc(t);for(s=1;s<t;++s)i[s]=i[s-1]+o[s-1]<<1;var l;if(r){l=new Rc(1<<t);var c=15-t;for(s=0;s<n;++s)if(e[s])for(var d=s<<4|e[s],u=t-e[s],f=i[e[s]-1]++<<u,h=f|(1<<u)-1;f<=h;++f)l[zT[f]>>c]=d}else for(l=new Rc(n),s=0;s<n;++s)e[s]&&(l[s]=zT[i[e[s]-1]++]>>15-e[s]);return l},Cg=new yu(288);for(var Fs=0;Fs<144;++Fs)Cg[Fs]=8;for(var Fs=144;Fs<256;++Fs)Cg[Fs]=9;for(var Fs=256;Fs<280;++Fs)Cg[Fs]=7;for(var Fs=280;Fs<288;++Fs)Cg[Fs]=8;var AS=new yu(32);for(var Fs=0;Fs<32;++Fs)AS[Fs]=5;var rXe=Nb(Cg,9,0),nXe=Nb(AS,5,0),hne=function(e){return(e+7)/8|0},aXe=function(e,t,r){return(t==null||t<0)&&(t=0),(r==null||r>e.length)&&(r=e.length),new yu(e.subarray(t,r))},wf=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},Cy=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},wE=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var s=r.length,o=r.slice();if(!s)return{t:gne,l:0};if(s==1){var i=new yu(r[0].s+1);return i[r[0].s]=1,{t:i,l:1}}r.sort(function(_,S){return _.f-S.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],d=0,u=1,f=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};u!=s-1;)l=r[r[d].f<r[f].f?d++:f++],c=r[d!=u&&r[d].f<r[f].f?d++:f++],r[u++]={s:-1,f:l.f+c.f,l,r:c};for(var h=o[0].s,n=1;n<s;++n)o[n].s>h&&(h=o[n].s);var m=new Rc(h+1),v=UT(r[u-1],m,0);if(v>t){var n=0,g=0,y=v-t,x=1<<y;for(o.sort(function(S,C){return m[C.s]-m[S.s]||S.f-C.f});n<s;++n){var b=o[n].s;if(m[b]>t)g+=x-(1<<v-m[b]),m[b]=t;else break}for(g>>=y;g>0;){var w=o[n].s;m[w]<t?g-=1<<t-m[w]++-1:++n}for(;n>=0&&g;--n){var j=o[n].s;m[j]==t&&(--m[j],++g)}v=t}return{t:new yu(m),l:v}},UT=function(e,t,r){return e.s==-1?Math.max(UT(e.l,t,r+1),UT(e.r,t,r+1)):t[e.s]=r},Iz=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Rc(++t),n=0,s=e[0],o=1,i=function(c){r[n++]=c},l=1;l<=t;++l)if(e[l]==s&&l!=t)++o;else{if(!s&&o>2){for(;o>138;o-=138)i(32754);o>2&&(i(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(i(s),--o;o>6;o-=6)i(8304);o>2&&(i(o-3<<5|8208),o=0)}for(;o--;)i(s);o=1,s=e[l]}return{c:r.subarray(0,n),n:t}},Py=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},pne=function(e,t,r){var n=r.length,s=hne(t+2);e[s]=n&255,e[s+1]=n>>8,e[s+2]=e[s]^255,e[s+3]=e[s+1]^255;for(var o=0;o<n;++o)e[s+o+4]=r[o];return(s+4+n)*8},Oz=function(e,t,r,n,s,o,i,l,c,d,u){wf(t,u++,r),++s[256];for(var f=wE(s,15),h=f.t,m=f.l,v=wE(o,15),g=v.t,y=v.l,x=Iz(h),b=x.c,w=x.n,j=Iz(g),_=j.c,S=j.n,C=new Rc(19),P=0;P<b.length;++P)++C[b[P]&31];for(var P=0;P<_.length;++P)++C[_[P]&31];for(var A=wE(C,7),R=A.t,O=A.l,I=19;I>4&&!R[Ez[I-1]];--I);var M=d+5<<3,D=Py(s,Cg)+Py(o,AS)+i,U=Py(s,h)+Py(o,g)+i+14+3*I+Py(C,R)+2*C[16]+3*C[17]+7*C[18];if(c>=0&&M<=D&&M<=U)return pne(t,u,e.subarray(c,c+d));var z,W,$,X;if(wf(t,u,1+(U<D)),u+=2,U<D){z=Nb(h,m,0),W=h,$=Nb(g,y,0),X=g;var ye=Nb(R,O,0);wf(t,u,w-257),wf(t,u+5,S-1),wf(t,u+10,I-4),u+=14;for(var P=0;P<I;++P)wf(t,u+3*P,R[Ez[P]]);u+=3*I;for(var Se=[b,_],V=0;V<2;++V)for(var B=Se[V],P=0;P<B.length;++P){var Q=B[P]&31;wf(t,u,ye[Q]),u+=R[Q],Q>15&&(wf(t,u,B[P]>>5&127),u+=B[P]>>12)}}else z=rXe,W=Cg,$=nXe,X=AS;for(var P=0;P<l;++P){var pe=n[P];if(pe>255){var Q=pe>>18&31;Cy(t,u,z[Q+257]),u+=W[Q+257],Q>7&&(wf(t,u,pe>>23&31),u+=sR[Q]);var te=pe&31;Cy(t,u,$[te]),u+=X[te],te>3&&(Cy(t,u,pe>>5&8191),u+=oR[te])}else Cy(t,u,z[pe]),u+=W[pe]}return Cy(t,u,z[256]),u+W[256]},sXe=new aR([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),gne=new yu(0),oXe=function(e,t,r,n,s,o){var i=o.z||e.length,l=new yu(n+i+5*(1+Math.ceil(i/7e3))+s),c=l.subarray(n,l.length-s),d=o.l,u=(o.r||0)&7;if(t){u&&(c[0]=o.r>>3);for(var f=sXe[t-1],h=f>>13,m=f&8191,v=(1<<r)-1,g=o.p||new Rc(32768),y=o.h||new Rc(v+1),x=Math.ceil(r/3),b=2*x,w=function(ne){return(e[ne]^e[ne+1]<<x^e[ne+2]<<b)&v},j=new aR(25e3),_=new Rc(288),S=new Rc(32),C=0,P=0,A=o.i||0,R=0,O=o.w||0,I=0;A+2<i;++A){var M=w(A),D=A&32767,U=y[M];if(g[D]=U,y[M]=D,O<=A){var z=i-A;if((C>7e3||R>24576)&&(z>423||!d)){u=Oz(e,c,0,j,_,S,P,R,I,A-I,u),R=C=P=0,I=A;for(var W=0;W<286;++W)_[W]=0;for(var W=0;W<30;++W)S[W]=0}var $=2,X=0,ye=m,Se=D-U&32767;if(z>2&&M==w(A-Se))for(var V=Math.min(h,z)-1,B=Math.min(32767,A),Q=Math.min(258,z);Se<=B&&--ye&&D!=U;){if(e[A+$]==e[A+$-Se]){for(var pe=0;pe<Q&&e[A+pe]==e[A+pe-Se];++pe);if(pe>$){if($=pe,X=Se,pe>V)break;for(var te=Math.min(Se,pe-2),Y=0,W=0;W<te;++W){var ce=A-Se+W&32767,me=g[ce],ae=ce-me&32767;ae>Y&&(Y=ae,U=ce)}}}D=U,U=g[D],Se+=D-U&32767}if(X){j[R++]=268435456|qT[$]<<18|kz[X];var le=qT[$]&31,ue=kz[X]&31;P+=sR[le]+oR[ue],++_[257+le],++S[ue],O=A+$,++C}else j[R++]=e[A],++_[e[A]]}}for(A=Math.max(A,O);A<i;++A)j[R++]=e[A],++_[e[A]];u=Oz(e,c,d,j,_,S,P,R,I,A-I,u),d||(o.r=u&7|c[u/8|0]<<3,u-=7,o.h=y,o.p=g,o.i=A,o.w=O)}else{for(var A=o.w||0;A<i+d;A+=65535){var Re=A+65535;Re>=i&&(c[u/8|0]=d,Re=i),u=pne(c,u+1,e.subarray(A,Re))}o.i=i}return aXe(l,0,n+hne(u)+s)},vne=function(){var e=1,t=0;return{p:function(r){for(var n=e,s=t,o=r.length|0,i=0;i!=o;){for(var l=Math.min(i+2655,o);i<l;++i)s+=n+=r[i];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}e=n,t=s},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},iXe=function(e,t,r,n,s){if(!s&&(s={l:1},t.dictionary)){var o=t.dictionary.subarray(-32768),i=new yu(o.length+e.length);i.set(o),i.set(e,o.length),e=i,s.w=o.length}return oXe(e,t.level==null?6:t.level,t.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,s)},xne=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},lXe=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var s=vne();s.p(t.dictionary),xne(e,2,s.d())}};function VT(e,t){t||(t={});var r=vne();r.p(e);var n=iXe(e,t,t.dictionary?6:2,4);return lXe(n,t),xne(n,n.length-4,r.d()),n}var cXe=typeof TextDecoder<"u"&&new TextDecoder,dXe=0;try{cXe.decode(gne,{stream:!0}),dXe=1}catch{}function uXe(e){if(Array.isArray(e))return e}function fXe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,o,i,l=[],c=!0,d=!1;try{if(o=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(d)throw s}}return l}}function mXe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tz(e,t){return uXe(e)||fXe(e,t)||X1e(e,t)||mXe()}function Dz(e,t="utf8"){return new TextDecoder(t).decode(e)}const hXe=new TextEncoder;function pXe(e){return hXe.encode(e)}const gXe=1024*8,vXe=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),jE={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class iR{constructor(t=gXe,r={}){ss(this,"buffer");ss(this,"byteLength");ss(this,"byteOffset");ss(this,"length");ss(this,"offset");ss(this,"lastWrittenByte");ss(this,"littleEndian");ss(this,"_data");ss(this,"_mark");ss(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const s=r.offset?r.offset>>>0:0,o=t.byteLength-s;let i=s;(ArrayBuffer.isView(t)||t instanceof iR)&&(t.byteLength!==t.buffer.byteLength&&(i=t.byteOffset+s),t=t.buffer),n?this.lastWrittenByte=o:this.lastWrittenByte=0,this.buffer=t,this.length=o,this.byteLength=o,this.byteOffset=i,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,i,o),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,s=new Uint8Array(n);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=jE[r].BYTES_PER_ELEMENT*t,s=this.byteOffset+this.offset,o=this.buffer.slice(s,s+n);if(this.littleEndian===vXe&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(s,s+n));l.reverse();const c=new jE[r](l.buffer);return this.offset+=n,c.reverse(),c}const i=new jE[r](o);return this.offset+=n,i}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return Dz(this.readBytes(t))}decodeText(t=1,r="utf8"){return Dz(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(pXe(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const xXe=4,Mz=0,Rz=1,yXe=2;function W0(e){let t=e.length;for(;--t>=0;)e[t]=0}const bXe=0,yne=1,wXe=2,jXe=3,_Xe=258,lR=29,V1=256,Jw=V1+1+lR,yx=30,cR=19,bne=2*Jw+1,Vp=15,_E=16,NXe=7,dR=256,wne=16,jne=17,_ne=18,WT=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),h_=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),SXe=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Nne=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),CXe=512,kf=new Array((Jw+2)*2);W0(kf);const Sb=new Array(yx*2);W0(Sb);const Qw=new Array(CXe);W0(Qw);const Zw=new Array(_Xe-jXe+1);W0(Zw);const uR=new Array(lR);W0(uR);const ES=new Array(yx);W0(ES);function NE(e,t,r,n,s){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=s,this.has_stree=e&&e.length}let Sne,Cne,Pne;function SE(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const Ane=e=>e<256?Qw[e]:Qw[256+(e>>>7)],e1=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},nc=(e,t,r)=>{e.bi_valid>_E-r?(e.bi_buf|=t<<e.bi_valid&65535,e1(e,e.bi_buf),e.bi_buf=t>>_E-e.bi_valid,e.bi_valid+=r-_E):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},zu=(e,t,r)=>{nc(e,r[t*2],r[t*2+1])},Ene=(e,t)=>{let r=0;do r|=e&1,e>>>=1,r<<=1;while(--t>0);return r>>>1},PXe=e=>{e.bi_valid===16?(e1(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},AXe=(e,t)=>{const r=t.dyn_tree,n=t.max_code,s=t.stat_desc.static_tree,o=t.stat_desc.has_stree,i=t.stat_desc.extra_bits,l=t.stat_desc.extra_base,c=t.stat_desc.max_length;let d,u,f,h,m,v,g=0;for(h=0;h<=Vp;h++)e.bl_count[h]=0;for(r[e.heap[e.heap_max]*2+1]=0,d=e.heap_max+1;d<bne;d++)u=e.heap[d],h=r[r[u*2+1]*2+1]+1,h>c&&(h=c,g++),r[u*2+1]=h,!(u>n)&&(e.bl_count[h]++,m=0,u>=l&&(m=i[u-l]),v=r[u*2],e.opt_len+=v*(h+m),o&&(e.static_len+=v*(s[u*2+1]+m)));if(g!==0){do{for(h=c-1;e.bl_count[h]===0;)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[c]--,g-=2}while(g>0);for(h=c;h!==0;h--)for(u=e.bl_count[h];u!==0;)f=e.heap[--d],!(f>n)&&(r[f*2+1]!==h&&(e.opt_len+=(h-r[f*2+1])*r[f*2],r[f*2+1]=h),u--)}},kne=(e,t,r)=>{const n=new Array(Vp+1);let s=0,o,i;for(o=1;o<=Vp;o++)s=s+r[o-1]<<1,n[o]=s;for(i=0;i<=t;i++){let l=e[i*2+1];l!==0&&(e[i*2]=Ene(n[l]++,l))}},EXe=()=>{let e,t,r,n,s;const o=new Array(Vp+1);for(r=0,n=0;n<lR-1;n++)for(uR[n]=r,e=0;e<1<<WT[n];e++)Zw[r++]=n;for(Zw[r-1]=n,s=0,n=0;n<16;n++)for(ES[n]=s,e=0;e<1<<h_[n];e++)Qw[s++]=n;for(s>>=7;n<yx;n++)for(ES[n]=s<<7,e=0;e<1<<h_[n]-7;e++)Qw[256+s++]=n;for(t=0;t<=Vp;t++)o[t]=0;for(e=0;e<=143;)kf[e*2+1]=8,e++,o[8]++;for(;e<=255;)kf[e*2+1]=9,e++,o[9]++;for(;e<=279;)kf[e*2+1]=7,e++,o[7]++;for(;e<=287;)kf[e*2+1]=8,e++,o[8]++;for(kne(kf,Jw+1,o),e=0;e<yx;e++)Sb[e*2+1]=5,Sb[e*2]=Ene(e,5);Sne=new NE(kf,WT,V1+1,Jw,Vp),Cne=new NE(Sb,h_,0,yx,Vp),Pne=new NE(new Array(0),SXe,0,cR,NXe)},Ine=e=>{let t;for(t=0;t<Jw;t++)e.dyn_ltree[t*2]=0;for(t=0;t<yx;t++)e.dyn_dtree[t*2]=0;for(t=0;t<cR;t++)e.bl_tree[t*2]=0;e.dyn_ltree[dR*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},One=e=>{e.bi_valid>8?e1(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Lz=(e,t,r,n)=>{const s=t*2,o=r*2;return e[s]<e[o]||e[s]===e[o]&&n[t]<=n[r]},CE=(e,t,r)=>{const n=e.heap[r];let s=r<<1;for(;s<=e.heap_len&&(s<e.heap_len&&Lz(t,e.heap[s+1],e.heap[s],e.depth)&&s++,!Lz(t,n,e.heap[s],e.depth));)e.heap[r]=e.heap[s],r=s,s<<=1;e.heap[r]=n},Fz=(e,t,r)=>{let n,s,o=0,i,l;if(e.sym_next!==0)do n=e.pending_buf[e.sym_buf+o++]&255,n+=(e.pending_buf[e.sym_buf+o++]&255)<<8,s=e.pending_buf[e.sym_buf+o++],n===0?zu(e,s,t):(i=Zw[s],zu(e,i+V1+1,t),l=WT[i],l!==0&&(s-=uR[i],nc(e,s,l)),n--,i=Ane(n),zu(e,i,r),l=h_[i],l!==0&&(n-=ES[i],nc(e,n,l)));while(o<e.sym_next);zu(e,dR,t)},HT=(e,t)=>{const r=t.dyn_tree,n=t.stat_desc.static_tree,s=t.stat_desc.has_stree,o=t.stat_desc.elems;let i,l,c=-1,d;for(e.heap_len=0,e.heap_max=bne,i=0;i<o;i++)r[i*2]!==0?(e.heap[++e.heap_len]=c=i,e.depth[i]=0):r[i*2+1]=0;for(;e.heap_len<2;)d=e.heap[++e.heap_len]=c<2?++c:0,r[d*2]=1,e.depth[d]=0,e.opt_len--,s&&(e.static_len-=n[d*2+1]);for(t.max_code=c,i=e.heap_len>>1;i>=1;i--)CE(e,r,i);d=o;do i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],CE(e,r,1),l=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=l,r[d*2]=r[i*2]+r[l*2],e.depth[d]=(e.depth[i]>=e.depth[l]?e.depth[i]:e.depth[l])+1,r[i*2+1]=r[l*2+1]=d,e.heap[1]=d++,CE(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],AXe(e,t),kne(r,c,e.bl_count)},$z=(e,t,r)=>{let n,s=-1,o,i=t[0*2+1],l=0,c=7,d=4;for(i===0&&(c=138,d=3),t[(r+1)*2+1]=65535,n=0;n<=r;n++)o=i,i=t[(n+1)*2+1],!(++l<c&&o===i)&&(l<d?e.bl_tree[o*2]+=l:o!==0?(o!==s&&e.bl_tree[o*2]++,e.bl_tree[wne*2]++):l<=10?e.bl_tree[jne*2]++:e.bl_tree[_ne*2]++,l=0,s=o,i===0?(c=138,d=3):o===i?(c=6,d=3):(c=7,d=4))},Bz=(e,t,r)=>{let n,s=-1,o,i=t[0*2+1],l=0,c=7,d=4;for(i===0&&(c=138,d=3),n=0;n<=r;n++)if(o=i,i=t[(n+1)*2+1],!(++l<c&&o===i)){if(l<d)do zu(e,o,e.bl_tree);while(--l!==0);else o!==0?(o!==s&&(zu(e,o,e.bl_tree),l--),zu(e,wne,e.bl_tree),nc(e,l-3,2)):l<=10?(zu(e,jne,e.bl_tree),nc(e,l-3,3)):(zu(e,_ne,e.bl_tree),nc(e,l-11,7));l=0,s=o,i===0?(c=138,d=3):o===i?(c=6,d=3):(c=7,d=4)}},kXe=e=>{let t;for($z(e,e.dyn_ltree,e.l_desc.max_code),$z(e,e.dyn_dtree,e.d_desc.max_code),HT(e,e.bl_desc),t=cR-1;t>=3&&e.bl_tree[Nne[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},IXe=(e,t,r,n)=>{let s;for(nc(e,t-257,5),nc(e,r-1,5),nc(e,n-4,4),s=0;s<n;s++)nc(e,e.bl_tree[Nne[s]*2+1],3);Bz(e,e.dyn_ltree,t-1),Bz(e,e.dyn_dtree,r-1)},OXe=e=>{let t=4093624447,r;for(r=0;r<=31;r++,t>>>=1)if(t&1&&e.dyn_ltree[r*2]!==0)return Mz;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Rz;for(r=32;r<V1;r++)if(e.dyn_ltree[r*2]!==0)return Rz;return Mz};let qz=!1;const TXe=e=>{qz||(EXe(),qz=!0),e.l_desc=new SE(e.dyn_ltree,Sne),e.d_desc=new SE(e.dyn_dtree,Cne),e.bl_desc=new SE(e.bl_tree,Pne),e.bi_buf=0,e.bi_valid=0,Ine(e)},Tne=(e,t,r,n)=>{nc(e,(bXe<<1)+(n?1:0),3),One(e),e1(e,r),e1(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r},DXe=e=>{nc(e,yne<<1,3),zu(e,dR,kf),PXe(e)},MXe=(e,t,r,n)=>{let s,o,i=0;e.level>0?(e.strm.data_type===yXe&&(e.strm.data_type=OXe(e)),HT(e,e.l_desc),HT(e,e.d_desc),i=kXe(e),s=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=s&&(s=o)):s=o=r+5,r+4<=s&&t!==-1?Tne(e,t,r,n):e.strategy===xXe||o===s?(nc(e,(yne<<1)+(n?1:0),3),Fz(e,kf,Sb)):(nc(e,(wXe<<1)+(n?1:0),3),IXe(e,e.l_desc.max_code+1,e.d_desc.max_code+1,i+1),Fz(e,e.dyn_ltree,e.dyn_dtree)),Ine(e),n&&One(e)},RXe=(e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,t===0?e.dyn_ltree[r*2]++:(e.matches++,t--,e.dyn_ltree[(Zw[r]+V1+1)*2]++,e.dyn_dtree[Ane(t)*2]++),e.sym_next===e.sym_end);var LXe=TXe,FXe=Tne,$Xe=MXe,BXe=RXe,qXe=DXe,zXe={_tr_init:LXe,_tr_stored_block:FXe,_tr_flush_block:$Xe,_tr_tally:BXe,_tr_align:qXe};const UXe=(e,t,r,n)=>{let s=e&65535|0,o=e>>>16&65535|0,i=0;for(;r!==0;){i=r>2e3?2e3:r,r-=i;do s=s+t[n++]|0,o=o+s|0;while(--i);s%=65521,o%=65521}return s|o<<16|0};var t1=UXe;const VXe=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},WXe=new Uint32Array(VXe()),HXe=(e,t,r,n)=>{const s=WXe,o=n+r;e^=-1;for(let i=n;i<o;i++)e=e>>>8^s[(e^t[i])&255];return e^-1};var fi=HXe,u0={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},W1={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:GXe,_tr_stored_block:GT,_tr_flush_block:KXe,_tr_tally:jh,_tr_align:XXe}=zXe,{Z_NO_FLUSH:_h,Z_PARTIAL_FLUSH:YXe,Z_FULL_FLUSH:JXe,Z_FINISH:bd,Z_BLOCK:zz,Z_OK:Li,Z_STREAM_END:Uz,Z_STREAM_ERROR:af,Z_DATA_ERROR:QXe,Z_BUF_ERROR:PE,Z_DEFAULT_COMPRESSION:ZXe,Z_FILTERED:eYe,Z_HUFFMAN_ONLY:wj,Z_RLE:tYe,Z_FIXED:rYe,Z_DEFAULT_STRATEGY:nYe,Z_UNKNOWN:aYe,Z_DEFLATED:K5}=W1,sYe=9,oYe=15,iYe=8,lYe=29,cYe=256,KT=cYe+1+lYe,dYe=30,uYe=19,fYe=2*KT+1,mYe=15,Fa=3,ah=258,sf=ah+Fa+1,hYe=32,f0=42,fR=57,XT=69,YT=73,JT=91,QT=103,Wp=113,Vy=666,Il=1,H0=2,Pg=3,G0=4,pYe=3,Hp=(e,t)=>(e.msg=u0[t],t),Vz=e=>e*2-(e>4?9:0),Gm=e=>{let t=e.length;for(;--t>=0;)e[t]=0},gYe=e=>{let t,r,n,s=e.w_size;t=e.hash_size,n=t;do r=e.head[--n],e.head[n]=r>=s?r-s:0;while(--t);t=s,n=t;do r=e.prev[--n],e.prev[n]=r>=s?r-s:0;while(--t)};let vYe=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask,Nh=vYe;const Sc=e=>{const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),r!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,t.pending===0&&(t.pending_out=0))},Lc=(e,t)=>{KXe(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Sc(e.strm)},Xa=(e,t)=>{e.pending_buf[e.pending++]=t},Ay=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},ZT=(e,t,r,n)=>{let s=e.avail_in;return s>n&&(s=n),s===0?0:(e.avail_in-=s,t.set(e.input.subarray(e.next_in,e.next_in+s),r),e.state.wrap===1?e.adler=t1(e.adler,t,s,r):e.state.wrap===2&&(e.adler=fi(e.adler,t,s,r)),e.next_in+=s,e.total_in+=s,s)},Dne=(e,t)=>{let r=e.max_chain_length,n=e.strstart,s,o,i=e.prev_length,l=e.nice_match;const c=e.strstart>e.w_size-sf?e.strstart-(e.w_size-sf):0,d=e.window,u=e.w_mask,f=e.prev,h=e.strstart+ah;let m=d[n+i-1],v=d[n+i];e.prev_length>=e.good_match&&(r>>=2),l>e.lookahead&&(l=e.lookahead);do if(s=t,!(d[s+i]!==v||d[s+i-1]!==m||d[s]!==d[n]||d[++s]!==d[n+1])){n+=2,s++;do;while(d[++n]===d[++s]&&d[++n]===d[++s]&&d[++n]===d[++s]&&d[++n]===d[++s]&&d[++n]===d[++s]&&d[++n]===d[++s]&&d[++n]===d[++s]&&d[++n]===d[++s]&&n<h);if(o=ah-(h-n),n=h-ah,o>i){if(e.match_start=t,i=o,o>=l)break;m=d[n+i-1],v=d[n+i]}}while((t=f[t&u])>c&&--r!==0);return i<=e.lookahead?i:e.lookahead},m0=e=>{const t=e.w_size;let r,n,s;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-sf)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),gYe(e),n+=t),e.strm.avail_in===0)break;if(r=ZT(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=r,e.lookahead+e.insert>=Fa)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=Nh(e,e.ins_h,e.window[s+1]);e.insert&&(e.ins_h=Nh(e,e.ins_h,e.window[s+Fa-1]),e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<Fa)););}while(e.lookahead<sf&&e.strm.avail_in!==0)},Mne=(e,t)=>{let r=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,n,s,o,i=0,l=e.strm.avail_in;do{if(n=65535,o=e.bi_valid+42>>3,e.strm.avail_out<o||(o=e.strm.avail_out-o,s=e.strstart-e.block_start,n>s+e.strm.avail_in&&(n=s+e.strm.avail_in),n>o&&(n=o),n<r&&(n===0&&t!==bd||t===_h||n!==s+e.strm.avail_in)))break;i=t===bd&&n===s+e.strm.avail_in?1:0,GT(e,0,0,i),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,Sc(e.strm),s&&(s>n&&(s=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+s),e.strm.next_out),e.strm.next_out+=s,e.strm.avail_out-=s,e.strm.total_out+=s,e.block_start+=s,n-=s),n&&(ZT(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(i===0);return l-=e.strm.avail_in,l&&(l>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=l&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-l,e.strm.next_in),e.strstart),e.strstart+=l,e.insert+=l>e.w_size-e.insert?e.w_size-e.insert:l),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),i?G0:t!==_h&&t!==bd&&e.strm.avail_in===0&&e.strstart===e.block_start?H0:(o=e.window_size-e.strstart,e.strm.avail_in>o&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,o+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),o>e.strm.avail_in&&(o=e.strm.avail_in),o&&(ZT(e.strm,e.window,e.strstart,o),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.high_water<e.strstart&&(e.high_water=e.strstart),o=e.bi_valid+42>>3,o=e.pending_buf_size-o>65535?65535:e.pending_buf_size-o,r=o>e.w_size?e.w_size:o,s=e.strstart-e.block_start,(s>=r||(s||t===bd)&&t!==_h&&e.strm.avail_in===0&&s<=o)&&(n=s>o?o:s,i=t===bd&&e.strm.avail_in===0&&n===s?1:0,GT(e,e.block_start,n,i),e.block_start+=n,Sc(e.strm)),i?Pg:Il)},AE=(e,t)=>{let r,n;for(;;){if(e.lookahead<sf){if(m0(e),e.lookahead<sf&&t===_h)return Il;if(e.lookahead===0)break}if(r=0,e.lookahead>=Fa&&(e.ins_h=Nh(e,e.ins_h,e.window[e.strstart+Fa-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),r!==0&&e.strstart-r<=e.w_size-sf&&(e.match_length=Dne(e,r)),e.match_length>=Fa)if(n=jh(e,e.strstart-e.match_start,e.match_length-Fa),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=Fa){e.match_length--;do e.strstart++,e.ins_h=Nh(e,e.ins_h,e.window[e.strstart+Fa-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Nh(e,e.ins_h,e.window[e.strstart+1]);else n=jh(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(Lc(e,!1),e.strm.avail_out===0))return Il}return e.insert=e.strstart<Fa-1?e.strstart:Fa-1,t===bd?(Lc(e,!0),e.strm.avail_out===0?Pg:G0):e.sym_next&&(Lc(e,!1),e.strm.avail_out===0)?Il:H0},gv=(e,t)=>{let r,n,s;for(;;){if(e.lookahead<sf){if(m0(e),e.lookahead<sf&&t===_h)return Il;if(e.lookahead===0)break}if(r=0,e.lookahead>=Fa&&(e.ins_h=Nh(e,e.ins_h,e.window[e.strstart+Fa-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=Fa-1,r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-sf&&(e.match_length=Dne(e,r),e.match_length<=5&&(e.strategy===eYe||e.match_length===Fa&&e.strstart-e.match_start>4096)&&(e.match_length=Fa-1)),e.prev_length>=Fa&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-Fa,n=jh(e,e.strstart-1-e.prev_match,e.prev_length-Fa),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=s&&(e.ins_h=Nh(e,e.ins_h,e.window[e.strstart+Fa-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=Fa-1,e.strstart++,n&&(Lc(e,!1),e.strm.avail_out===0))return Il}else if(e.match_available){if(n=jh(e,0,e.window[e.strstart-1]),n&&Lc(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return Il}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=jh(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<Fa-1?e.strstart:Fa-1,t===bd?(Lc(e,!0),e.strm.avail_out===0?Pg:G0):e.sym_next&&(Lc(e,!1),e.strm.avail_out===0)?Il:H0},xYe=(e,t)=>{let r,n,s,o;const i=e.window;for(;;){if(e.lookahead<=ah){if(m0(e),e.lookahead<=ah&&t===_h)return Il;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=Fa&&e.strstart>0&&(s=e.strstart-1,n=i[s],n===i[++s]&&n===i[++s]&&n===i[++s])){o=e.strstart+ah;do;while(n===i[++s]&&n===i[++s]&&n===i[++s]&&n===i[++s]&&n===i[++s]&&n===i[++s]&&n===i[++s]&&n===i[++s]&&s<o);e.match_length=ah-(o-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=Fa?(r=jh(e,1,e.match_length-Fa),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=jh(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(Lc(e,!1),e.strm.avail_out===0))return Il}return e.insert=0,t===bd?(Lc(e,!0),e.strm.avail_out===0?Pg:G0):e.sym_next&&(Lc(e,!1),e.strm.avail_out===0)?Il:H0},yYe=(e,t)=>{let r;for(;;){if(e.lookahead===0&&(m0(e),e.lookahead===0)){if(t===_h)return Il;break}if(e.match_length=0,r=jh(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(Lc(e,!1),e.strm.avail_out===0))return Il}return e.insert=0,t===bd?(Lc(e,!0),e.strm.avail_out===0?Pg:G0):e.sym_next&&(Lc(e,!1),e.strm.avail_out===0)?Il:H0};function Tu(e,t,r,n,s){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=s}const Wy=[new Tu(0,0,0,0,Mne),new Tu(4,4,8,4,AE),new Tu(4,5,16,8,AE),new Tu(4,6,32,32,AE),new Tu(4,4,16,16,gv),new Tu(8,16,32,32,gv),new Tu(8,16,128,128,gv),new Tu(8,32,128,256,gv),new Tu(32,128,258,1024,gv),new Tu(32,258,258,4096,gv)],bYe=e=>{e.window_size=2*e.w_size,Gm(e.head),e.max_lazy_match=Wy[e.level].max_lazy,e.good_match=Wy[e.level].good_length,e.nice_match=Wy[e.level].nice_length,e.max_chain_length=Wy[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=Fa-1,e.match_available=0,e.ins_h=0};function wYe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=K5,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(fYe*2),this.dyn_dtree=new Uint16Array((2*dYe+1)*2),this.bl_tree=new Uint16Array((2*uYe+1)*2),Gm(this.dyn_ltree),Gm(this.dyn_dtree),Gm(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(mYe+1),this.heap=new Uint16Array(2*KT+1),Gm(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*KT+1),Gm(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const H1=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==f0&&t.status!==fR&&t.status!==XT&&t.status!==YT&&t.status!==JT&&t.status!==QT&&t.status!==Wp&&t.status!==Vy?1:0},Rne=e=>{if(H1(e))return Hp(e,af);e.total_in=e.total_out=0,e.data_type=aYe;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?fR:t.wrap?f0:Wp,e.adler=t.wrap===2?0:1,t.last_flush=-2,GXe(t),Li},Lne=e=>{const t=Rne(e);return t===Li&&bYe(e.state),t},jYe=(e,t)=>H1(e)||e.state.wrap!==2?af:(e.state.gzhead=t,Li),Fne=(e,t,r,n,s,o)=>{if(!e)return af;let i=1;if(t===ZXe&&(t=6),n<0?(i=0,n=-n):n>15&&(i=2,n-=16),s<1||s>sYe||r!==K5||n<8||n>15||t<0||t>9||o<0||o>rYe||n===8&&i!==1)return Hp(e,af);n===8&&(n=9);const l=new wYe;return e.state=l,l.strm=e,l.status=f0,l.wrap=i,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=s+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+Fa-1)/Fa),l.window=new Uint8Array(l.w_size*2),l.head=new Uint16Array(l.hash_size),l.prev=new Uint16Array(l.w_size),l.lit_bufsize=1<<s+6,l.pending_buf_size=l.lit_bufsize*4,l.pending_buf=new Uint8Array(l.pending_buf_size),l.sym_buf=l.lit_bufsize,l.sym_end=(l.lit_bufsize-1)*3,l.level=t,l.strategy=o,l.method=r,Lne(e)},_Ye=(e,t)=>Fne(e,t,K5,oYe,iYe,nYe),NYe=(e,t)=>{if(H1(e)||t>zz||t<0)return e?Hp(e,af):af;const r=e.state;if(!e.output||e.avail_in!==0&&!e.input||r.status===Vy&&t!==bd)return Hp(e,e.avail_out===0?PE:af);const n=r.last_flush;if(r.last_flush=t,r.pending!==0){if(Sc(e),e.avail_out===0)return r.last_flush=-1,Li}else if(e.avail_in===0&&Vz(t)<=Vz(n)&&t!==bd)return Hp(e,PE);if(r.status===Vy&&e.avail_in!==0)return Hp(e,PE);if(r.status===f0&&r.wrap===0&&(r.status=Wp),r.status===f0){let s=K5+(r.w_bits-8<<4)<<8,o=-1;if(r.strategy>=wj||r.level<2?o=0:r.level<6?o=1:r.level===6?o=2:o=3,s|=o<<6,r.strstart!==0&&(s|=hYe),s+=31-s%31,Ay(r,s),r.strstart!==0&&(Ay(r,e.adler>>>16),Ay(r,e.adler&65535)),e.adler=1,r.status=Wp,Sc(e),r.pending!==0)return r.last_flush=-1,Li}if(r.status===fR){if(e.adler=0,Xa(r,31),Xa(r,139),Xa(r,8),r.gzhead)Xa(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Xa(r,r.gzhead.time&255),Xa(r,r.gzhead.time>>8&255),Xa(r,r.gzhead.time>>16&255),Xa(r,r.gzhead.time>>24&255),Xa(r,r.level===9?2:r.strategy>=wj||r.level<2?4:0),Xa(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(Xa(r,r.gzhead.extra.length&255),Xa(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=fi(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=XT;else if(Xa(r,0),Xa(r,0),Xa(r,0),Xa(r,0),Xa(r,0),Xa(r,r.level===9?2:r.strategy>=wj||r.level<2?4:0),Xa(r,pYe),r.status=Wp,Sc(e),r.pending!==0)return r.last_flush=-1,Li}if(r.status===XT){if(r.gzhead.extra){let s=r.pending,o=(r.gzhead.extra.length&65535)-r.gzindex;for(;r.pending+o>r.pending_buf_size;){let l=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+l),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>s&&(e.adler=fi(e.adler,r.pending_buf,r.pending-s,s)),r.gzindex+=l,Sc(e),r.pending!==0)return r.last_flush=-1,Li;s=0,o-=l}let i=new Uint8Array(r.gzhead.extra);r.pending_buf.set(i.subarray(r.gzindex,r.gzindex+o),r.pending),r.pending+=o,r.gzhead.hcrc&&r.pending>s&&(e.adler=fi(e.adler,r.pending_buf,r.pending-s,s)),r.gzindex=0}r.status=YT}if(r.status===YT){if(r.gzhead.name){let s=r.pending,o;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>s&&(e.adler=fi(e.adler,r.pending_buf,r.pending-s,s)),Sc(e),r.pending!==0)return r.last_flush=-1,Li;s=0}r.gzindex<r.gzhead.name.length?o=r.gzhead.name.charCodeAt(r.gzindex++)&255:o=0,Xa(r,o)}while(o!==0);r.gzhead.hcrc&&r.pending>s&&(e.adler=fi(e.adler,r.pending_buf,r.pending-s,s)),r.gzindex=0}r.status=JT}if(r.status===JT){if(r.gzhead.comment){let s=r.pending,o;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>s&&(e.adler=fi(e.adler,r.pending_buf,r.pending-s,s)),Sc(e),r.pending!==0)return r.last_flush=-1,Li;s=0}r.gzindex<r.gzhead.comment.length?o=r.gzhead.comment.charCodeAt(r.gzindex++)&255:o=0,Xa(r,o)}while(o!==0);r.gzhead.hcrc&&r.pending>s&&(e.adler=fi(e.adler,r.pending_buf,r.pending-s,s))}r.status=QT}if(r.status===QT){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(Sc(e),r.pending!==0))return r.last_flush=-1,Li;Xa(r,e.adler&255),Xa(r,e.adler>>8&255),e.adler=0}if(r.status=Wp,Sc(e),r.pending!==0)return r.last_flush=-1,Li}if(e.avail_in!==0||r.lookahead!==0||t!==_h&&r.status!==Vy){let s=r.level===0?Mne(r,t):r.strategy===wj?yYe(r,t):r.strategy===tYe?xYe(r,t):Wy[r.level].func(r,t);if((s===Pg||s===G0)&&(r.status=Vy),s===Il||s===Pg)return e.avail_out===0&&(r.last_flush=-1),Li;if(s===H0&&(t===YXe?XXe(r):t!==zz&&(GT(r,0,0,!1),t===JXe&&(Gm(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),Sc(e),e.avail_out===0))return r.last_flush=-1,Li}return t!==bd?Li:r.wrap<=0?Uz:(r.wrap===2?(Xa(r,e.adler&255),Xa(r,e.adler>>8&255),Xa(r,e.adler>>16&255),Xa(r,e.adler>>24&255),Xa(r,e.total_in&255),Xa(r,e.total_in>>8&255),Xa(r,e.total_in>>16&255),Xa(r,e.total_in>>24&255)):(Ay(r,e.adler>>>16),Ay(r,e.adler&65535)),Sc(e),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?Li:Uz)},SYe=e=>{if(H1(e))return af;const t=e.state.status;return e.state=null,t===Wp?Hp(e,QXe):Li},CYe=(e,t)=>{let r=t.length;if(H1(e))return af;const n=e.state,s=n.wrap;if(s===2||s===1&&n.status!==f0||n.lookahead)return af;if(s===1&&(e.adler=t1(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){s===0&&(Gm(n.head),n.strstart=0,n.block_start=0,n.insert=0);let c=new Uint8Array(n.w_size);c.set(t.subarray(r-n.w_size,r),0),t=c,r=n.w_size}const o=e.avail_in,i=e.next_in,l=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,m0(n);n.lookahead>=Fa;){let c=n.strstart,d=n.lookahead-(Fa-1);do n.ins_h=Nh(n,n.ins_h,n.window[c+Fa-1]),n.prev[c&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=c,c++;while(--d);n.strstart=c,n.lookahead=Fa-1,m0(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=Fa-1,n.match_available=0,e.next_in=i,e.input=l,e.avail_in=o,n.wrap=s,Li};var PYe=_Ye,AYe=Fne,EYe=Lne,kYe=Rne,IYe=jYe,OYe=NYe,TYe=SYe,DYe=CYe,MYe="pako deflate (from Nodeca project)",Cb={deflateInit:PYe,deflateInit2:AYe,deflateReset:EYe,deflateResetKeep:kYe,deflateSetHeader:IYe,deflate:OYe,deflateEnd:TYe,deflateSetDictionary:DYe,deflateInfo:MYe};const RYe=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var LYe=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)RYe(r,n)&&(e[n]=r[n])}}return e},FYe=e=>{let t=0;for(let n=0,s=e.length;n<s;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,s=0,o=e.length;n<o;n++){let i=e[n];r.set(i,s),s+=i.length}return r},X5={assign:LYe,flattenChunks:FYe};let $ne=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{$ne=!1}const r1=new Uint8Array(256);for(let e=0;e<256;e++)r1[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;r1[254]=r1[254]=1;var $Ye=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,s,o,i=e.length,l=0;for(s=0;s<i;s++)r=e.charCodeAt(s),(r&64512)===55296&&s+1<i&&(n=e.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(l),o=0,s=0;o<l;s++)r=e.charCodeAt(s),(r&64512)===55296&&s+1<i&&(n=e.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),r<128?t[o++]=r:r<2048?(t[o++]=192|r>>>6,t[o++]=128|r&63):r<65536?(t[o++]=224|r>>>12,t[o++]=128|r>>>6&63,t[o++]=128|r&63):(t[o++]=240|r>>>18,t[o++]=128|r>>>12&63,t[o++]=128|r>>>6&63,t[o++]=128|r&63);return t};const BYe=(e,t)=>{if(t<65534&&e.subarray&&$ne)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var qYe=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,s;const o=new Array(r*2);for(s=0,n=0;n<r;){let i=e[n++];if(i<128){o[s++]=i;continue}let l=r1[i];if(l>4){o[s++]=65533,n+=l-1;continue}for(i&=l===2?31:l===3?15:7;l>1&&n<r;)i=i<<6|e[n++]&63,l--;if(l>1){o[s++]=65533;continue}i<65536?o[s++]=i:(i-=65536,o[s++]=55296|i>>10&1023,o[s++]=56320|i&1023)}return BYe(o,s)},zYe=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+r1[e[r]]>t?r:t},n1={string2buf:$Ye,buf2string:qYe,utf8border:zYe};function UYe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Bne=UYe;const qne=Object.prototype.toString,{Z_NO_FLUSH:VYe,Z_SYNC_FLUSH:WYe,Z_FULL_FLUSH:HYe,Z_FINISH:GYe,Z_OK:kS,Z_STREAM_END:KYe,Z_DEFAULT_COMPRESSION:XYe,Z_DEFAULT_STRATEGY:YYe,Z_DEFLATED:JYe}=W1;function mR(e){this.options=X5.assign({level:XYe,method:JYe,chunkSize:16384,windowBits:15,memLevel:8,strategy:YYe},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Bne,this.strm.avail_out=0;let r=Cb.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==kS)throw new Error(u0[r]);if(t.header&&Cb.deflateSetHeader(this.strm,t.header),t.dictionary){let n;if(typeof t.dictionary=="string"?n=n1.string2buf(t.dictionary):qne.call(t.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(t.dictionary):n=t.dictionary,r=Cb.deflateSetDictionary(this.strm,n),r!==kS)throw new Error(u0[r]);this._dict_set=!0}}mR.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize;let s,o;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?GYe:VYe,typeof e=="string"?r.input=n1.string2buf(e):qne.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(o===WYe||o===HYe)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(s=Cb.deflate(r,o),s===KYe)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),s=Cb.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===kS;if(r.avail_out===0){this.onData(r.output);continue}if(o>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0};mR.prototype.onData=function(e){this.chunks.push(e)};mR.prototype.onEnd=function(e){e===kS&&(this.result=X5.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};const jj=16209,QYe=16191;var ZYe=function(t,r){let n,s,o,i,l,c,d,u,f,h,m,v,g,y,x,b,w,j,_,S,C,P,A,R;const O=t.state;n=t.next_in,A=t.input,s=n+(t.avail_in-5),o=t.next_out,R=t.output,i=o-(r-t.avail_out),l=o+(t.avail_out-257),c=O.dmax,d=O.wsize,u=O.whave,f=O.wnext,h=O.window,m=O.hold,v=O.bits,g=O.lencode,y=O.distcode,x=(1<<O.lenbits)-1,b=(1<<O.distbits)-1;e:do{v<15&&(m+=A[n++]<<v,v+=8,m+=A[n++]<<v,v+=8),w=g[m&x];t:for(;;){if(j=w>>>24,m>>>=j,v-=j,j=w>>>16&255,j===0)R[o++]=w&65535;else if(j&16){_=w&65535,j&=15,j&&(v<j&&(m+=A[n++]<<v,v+=8),_+=m&(1<<j)-1,m>>>=j,v-=j),v<15&&(m+=A[n++]<<v,v+=8,m+=A[n++]<<v,v+=8),w=y[m&b];r:for(;;){if(j=w>>>24,m>>>=j,v-=j,j=w>>>16&255,j&16){if(S=w&65535,j&=15,v<j&&(m+=A[n++]<<v,v+=8,v<j&&(m+=A[n++]<<v,v+=8)),S+=m&(1<<j)-1,S>c){t.msg="invalid distance too far back",O.mode=jj;break e}if(m>>>=j,v-=j,j=o-i,S>j){if(j=S-j,j>u&&O.sane){t.msg="invalid distance too far back",O.mode=jj;break e}if(C=0,P=h,f===0){if(C+=d-j,j<_){_-=j;do R[o++]=h[C++];while(--j);C=o-S,P=R}}else if(f<j){if(C+=d+f-j,j-=f,j<_){_-=j;do R[o++]=h[C++];while(--j);if(C=0,f<_){j=f,_-=j;do R[o++]=h[C++];while(--j);C=o-S,P=R}}}else if(C+=f-j,j<_){_-=j;do R[o++]=h[C++];while(--j);C=o-S,P=R}for(;_>2;)R[o++]=P[C++],R[o++]=P[C++],R[o++]=P[C++],_-=3;_&&(R[o++]=P[C++],_>1&&(R[o++]=P[C++]))}else{C=o-S;do R[o++]=R[C++],R[o++]=R[C++],R[o++]=R[C++],_-=3;while(_>2);_&&(R[o++]=R[C++],_>1&&(R[o++]=R[C++]))}}else if(j&64){t.msg="invalid distance code",O.mode=jj;break e}else{w=y[(w&65535)+(m&(1<<j)-1)];continue r}break}}else if(j&64)if(j&32){O.mode=QYe;break e}else{t.msg="invalid literal/length code",O.mode=jj;break e}else{w=g[(w&65535)+(m&(1<<j)-1)];continue t}break}}while(n<s&&o<l);_=v>>3,n-=_,v-=_<<3,m&=(1<<v)-1,t.next_in=n,t.next_out=o,t.avail_in=n<s?5+(s-n):5-(n-s),t.avail_out=o<l?257+(l-o):257-(o-l),O.hold=m,O.bits=v};const vv=15,Wz=852,Hz=592,Gz=0,EE=1,Kz=2,eJe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),tJe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),rJe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),nJe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),aJe=(e,t,r,n,s,o,i,l)=>{const c=l.bits;let d=0,u=0,f=0,h=0,m=0,v=0,g=0,y=0,x=0,b=0,w,j,_,S,C,P=null,A;const R=new Uint16Array(vv+1),O=new Uint16Array(vv+1);let I=null,M,D,U;for(d=0;d<=vv;d++)R[d]=0;for(u=0;u<n;u++)R[t[r+u]]++;for(m=c,h=vv;h>=1&&R[h]===0;h--);if(m>h&&(m=h),h===0)return s[o++]=1<<24|64<<16|0,s[o++]=1<<24|64<<16|0,l.bits=1,0;for(f=1;f<h&&R[f]===0;f++);for(m<f&&(m=f),y=1,d=1;d<=vv;d++)if(y<<=1,y-=R[d],y<0)return-1;if(y>0&&(e===Gz||h!==1))return-1;for(O[1]=0,d=1;d<vv;d++)O[d+1]=O[d]+R[d];for(u=0;u<n;u++)t[r+u]!==0&&(i[O[t[r+u]]++]=u);if(e===Gz?(P=I=i,A=20):e===EE?(P=eJe,I=tJe,A=257):(P=rJe,I=nJe,A=0),b=0,u=0,d=f,C=o,v=m,g=0,_=-1,x=1<<m,S=x-1,e===EE&&x>Wz||e===Kz&&x>Hz)return 1;for(;;){M=d-g,i[u]+1<A?(D=0,U=i[u]):i[u]>=A?(D=I[i[u]-A],U=P[i[u]-A]):(D=32+64,U=0),w=1<<d-g,j=1<<v,f=j;do j-=w,s[C+(b>>g)+j]=M<<24|D<<16|U|0;while(j!==0);for(w=1<<d-1;b&w;)w>>=1;if(w!==0?(b&=w-1,b+=w):b=0,u++,--R[d]===0){if(d===h)break;d=t[r+i[u]]}if(d>m&&(b&S)!==_){for(g===0&&(g=m),C+=f,v=d-g,y=1<<v;v+g<h&&(y-=R[v+g],!(y<=0));)v++,y<<=1;if(x+=1<<v,e===EE&&x>Wz||e===Kz&&x>Hz)return 1;_=b&S,s[_]=m<<24|v<<16|C-o|0}}return b!==0&&(s[C+b]=d-g<<24|64<<16|0),l.bits=m,0};var Pb=aJe;const sJe=0,zne=1,Une=2,{Z_FINISH:Xz,Z_BLOCK:oJe,Z_TREES:_j,Z_OK:Ag,Z_STREAM_END:iJe,Z_NEED_DICT:lJe,Z_STREAM_ERROR:Rd,Z_DATA_ERROR:Vne,Z_MEM_ERROR:Wne,Z_BUF_ERROR:cJe,Z_DEFLATED:Yz}=W1,Y5=16180,Jz=16181,Qz=16182,Zz=16183,e9=16184,t9=16185,r9=16186,n9=16187,a9=16188,s9=16189,IS=16190,jf=16191,kE=16192,o9=16193,IE=16194,i9=16195,l9=16196,c9=16197,d9=16198,Nj=16199,Sj=16200,u9=16201,f9=16202,m9=16203,h9=16204,p9=16205,OE=16206,g9=16207,v9=16208,Ws=16209,Hne=16210,Gne=16211,dJe=852,uJe=592,fJe=15,mJe=fJe,x9=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function hJe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Wg=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Y5||t.mode>Gne?1:0},Kne=e=>{if(Wg(e))return Rd;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=Y5,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(dJe),t.distcode=t.distdyn=new Int32Array(uJe),t.sane=1,t.back=-1,Ag},Xne=e=>{if(Wg(e))return Rd;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Kne(e)},Yne=(e,t)=>{let r;if(Wg(e))return Rd;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Rd:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,Xne(e))},Jne=(e,t)=>{if(!e)return Rd;const r=new hJe;e.state=r,r.strm=e,r.window=null,r.mode=Y5;const n=Yne(e,t);return n!==Ag&&(e.state=null),n},pJe=e=>Jne(e,mJe);let y9=!0,TE,DE;const gJe=e=>{if(y9){TE=new Int32Array(512),DE=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Pb(zne,e.lens,0,288,TE,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Pb(Une,e.lens,0,32,DE,0,e.work,{bits:5}),y9=!1}e.lencode=TE,e.lenbits=9,e.distcode=DE,e.distbits=5},Qne=(e,t,r,n)=>{let s;const o=e.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(t.subarray(r-o.wsize,r),0),o.wnext=0,o.whave=o.wsize):(s=o.wsize-o.wnext,s>n&&(s=n),o.window.set(t.subarray(r-n,r-n+s),o.wnext),n-=s,n?(o.window.set(t.subarray(r-n,r),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=s,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=s))),0},vJe=(e,t)=>{let r,n,s,o,i,l,c,d,u,f,h,m,v,g,y=0,x,b,w,j,_,S,C,P;const A=new Uint8Array(4);let R,O;const I=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Wg(e)||!e.output||!e.input&&e.avail_in!==0)return Rd;r=e.state,r.mode===jf&&(r.mode=kE),i=e.next_out,s=e.output,c=e.avail_out,o=e.next_in,n=e.input,l=e.avail_in,d=r.hold,u=r.bits,f=l,h=c,P=Ag;e:for(;;)switch(r.mode){case Y5:if(r.wrap===0){r.mode=kE;break}for(;u<16;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}if(r.wrap&2&&d===35615){r.wbits===0&&(r.wbits=15),r.check=0,A[0]=d&255,A[1]=d>>>8&255,r.check=fi(r.check,A,2,0),d=0,u=0,r.mode=Jz;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((d&255)<<8)+(d>>8))%31){e.msg="incorrect header check",r.mode=Ws;break}if((d&15)!==Yz){e.msg="unknown compression method",r.mode=Ws;break}if(d>>>=4,u-=4,C=(d&15)+8,r.wbits===0&&(r.wbits=C),C>15||C>r.wbits){e.msg="invalid window size",r.mode=Ws;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=d&512?s9:jf,d=0,u=0;break;case Jz:for(;u<16;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}if(r.flags=d,(r.flags&255)!==Yz){e.msg="unknown compression method",r.mode=Ws;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=Ws;break}r.head&&(r.head.text=d>>8&1),r.flags&512&&r.wrap&4&&(A[0]=d&255,A[1]=d>>>8&255,r.check=fi(r.check,A,2,0)),d=0,u=0,r.mode=Qz;case Qz:for(;u<32;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}r.head&&(r.head.time=d),r.flags&512&&r.wrap&4&&(A[0]=d&255,A[1]=d>>>8&255,A[2]=d>>>16&255,A[3]=d>>>24&255,r.check=fi(r.check,A,4,0)),d=0,u=0,r.mode=Zz;case Zz:for(;u<16;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}r.head&&(r.head.xflags=d&255,r.head.os=d>>8),r.flags&512&&r.wrap&4&&(A[0]=d&255,A[1]=d>>>8&255,r.check=fi(r.check,A,2,0)),d=0,u=0,r.mode=e9;case e9:if(r.flags&1024){for(;u<16;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}r.length=d,r.head&&(r.head.extra_len=d),r.flags&512&&r.wrap&4&&(A[0]=d&255,A[1]=d>>>8&255,r.check=fi(r.check,A,2,0)),d=0,u=0}else r.head&&(r.head.extra=null);r.mode=t9;case t9:if(r.flags&1024&&(m=r.length,m>l&&(m=l),m&&(r.head&&(C=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(o,o+m),C)),r.flags&512&&r.wrap&4&&(r.check=fi(r.check,n,m,o)),l-=m,o+=m,r.length-=m),r.length))break e;r.length=0,r.mode=r9;case r9:if(r.flags&2048){if(l===0)break e;m=0;do C=n[o+m++],r.head&&C&&r.length<65536&&(r.head.name+=String.fromCharCode(C));while(C&&m<l);if(r.flags&512&&r.wrap&4&&(r.check=fi(r.check,n,m,o)),l-=m,o+=m,C)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=n9;case n9:if(r.flags&4096){if(l===0)break e;m=0;do C=n[o+m++],r.head&&C&&r.length<65536&&(r.head.comment+=String.fromCharCode(C));while(C&&m<l);if(r.flags&512&&r.wrap&4&&(r.check=fi(r.check,n,m,o)),l-=m,o+=m,C)break e}else r.head&&(r.head.comment=null);r.mode=a9;case a9:if(r.flags&512){for(;u<16;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}if(r.wrap&4&&d!==(r.check&65535)){e.msg="header crc mismatch",r.mode=Ws;break}d=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=jf;break;case s9:for(;u<32;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}e.adler=r.check=x9(d),d=0,u=0,r.mode=IS;case IS:if(r.havedict===0)return e.next_out=i,e.avail_out=c,e.next_in=o,e.avail_in=l,r.hold=d,r.bits=u,lJe;e.adler=r.check=1,r.mode=jf;case jf:if(t===oJe||t===_j)break e;case kE:if(r.last){d>>>=u&7,u-=u&7,r.mode=OE;break}for(;u<3;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}switch(r.last=d&1,d>>>=1,u-=1,d&3){case 0:r.mode=o9;break;case 1:if(gJe(r),r.mode=Nj,t===_j){d>>>=2,u-=2;break e}break;case 2:r.mode=l9;break;case 3:e.msg="invalid block type",r.mode=Ws}d>>>=2,u-=2;break;case o9:for(d>>>=u&7,u-=u&7;u<32;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}if((d&65535)!==(d>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Ws;break}if(r.length=d&65535,d=0,u=0,r.mode=IE,t===_j)break e;case IE:r.mode=i9;case i9:if(m=r.length,m){if(m>l&&(m=l),m>c&&(m=c),m===0)break e;s.set(n.subarray(o,o+m),i),l-=m,o+=m,c-=m,i+=m,r.length-=m;break}r.mode=jf;break;case l9:for(;u<14;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}if(r.nlen=(d&31)+257,d>>>=5,u-=5,r.ndist=(d&31)+1,d>>>=5,u-=5,r.ncode=(d&15)+4,d>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Ws;break}r.have=0,r.mode=c9;case c9:for(;r.have<r.ncode;){for(;u<3;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}r.lens[I[r.have++]]=d&7,d>>>=3,u-=3}for(;r.have<19;)r.lens[I[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,R={bits:r.lenbits},P=Pb(sJe,r.lens,0,19,r.lencode,0,r.work,R),r.lenbits=R.bits,P){e.msg="invalid code lengths set",r.mode=Ws;break}r.have=0,r.mode=d9;case d9:for(;r.have<r.nlen+r.ndist;){for(;y=r.lencode[d&(1<<r.lenbits)-1],x=y>>>24,b=y>>>16&255,w=y&65535,!(x<=u);){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}if(w<16)d>>>=x,u-=x,r.lens[r.have++]=w;else{if(w===16){for(O=x+2;u<O;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}if(d>>>=x,u-=x,r.have===0){e.msg="invalid bit length repeat",r.mode=Ws;break}C=r.lens[r.have-1],m=3+(d&3),d>>>=2,u-=2}else if(w===17){for(O=x+3;u<O;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}d>>>=x,u-=x,C=0,m=3+(d&7),d>>>=3,u-=3}else{for(O=x+7;u<O;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}d>>>=x,u-=x,C=0,m=11+(d&127),d>>>=7,u-=7}if(r.have+m>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Ws;break}for(;m--;)r.lens[r.have++]=C}}if(r.mode===Ws)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=Ws;break}if(r.lenbits=9,R={bits:r.lenbits},P=Pb(zne,r.lens,0,r.nlen,r.lencode,0,r.work,R),r.lenbits=R.bits,P){e.msg="invalid literal/lengths set",r.mode=Ws;break}if(r.distbits=6,r.distcode=r.distdyn,R={bits:r.distbits},P=Pb(Une,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,R),r.distbits=R.bits,P){e.msg="invalid distances set",r.mode=Ws;break}if(r.mode=Nj,t===_j)break e;case Nj:r.mode=Sj;case Sj:if(l>=6&&c>=258){e.next_out=i,e.avail_out=c,e.next_in=o,e.avail_in=l,r.hold=d,r.bits=u,ZYe(e,h),i=e.next_out,s=e.output,c=e.avail_out,o=e.next_in,n=e.input,l=e.avail_in,d=r.hold,u=r.bits,r.mode===jf&&(r.back=-1);break}for(r.back=0;y=r.lencode[d&(1<<r.lenbits)-1],x=y>>>24,b=y>>>16&255,w=y&65535,!(x<=u);){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}if(b&&!(b&240)){for(j=x,_=b,S=w;y=r.lencode[S+((d&(1<<j+_)-1)>>j)],x=y>>>24,b=y>>>16&255,w=y&65535,!(j+x<=u);){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}d>>>=j,u-=j,r.back+=j}if(d>>>=x,u-=x,r.back+=x,r.length=w,b===0){r.mode=p9;break}if(b&32){r.back=-1,r.mode=jf;break}if(b&64){e.msg="invalid literal/length code",r.mode=Ws;break}r.extra=b&15,r.mode=u9;case u9:if(r.extra){for(O=r.extra;u<O;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}r.length+=d&(1<<r.extra)-1,d>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=f9;case f9:for(;y=r.distcode[d&(1<<r.distbits)-1],x=y>>>24,b=y>>>16&255,w=y&65535,!(x<=u);){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}if(!(b&240)){for(j=x,_=b,S=w;y=r.distcode[S+((d&(1<<j+_)-1)>>j)],x=y>>>24,b=y>>>16&255,w=y&65535,!(j+x<=u);){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}d>>>=j,u-=j,r.back+=j}if(d>>>=x,u-=x,r.back+=x,b&64){e.msg="invalid distance code",r.mode=Ws;break}r.offset=w,r.extra=b&15,r.mode=m9;case m9:if(r.extra){for(O=r.extra;u<O;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}r.offset+=d&(1<<r.extra)-1,d>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Ws;break}r.mode=h9;case h9:if(c===0)break e;if(m=h-c,r.offset>m){if(m=r.offset-m,m>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Ws;break}m>r.wnext?(m-=r.wnext,v=r.wsize-m):v=r.wnext-m,m>r.length&&(m=r.length),g=r.window}else g=s,v=i-r.offset,m=r.length;m>c&&(m=c),c-=m,r.length-=m;do s[i++]=g[v++];while(--m);r.length===0&&(r.mode=Sj);break;case p9:if(c===0)break e;s[i++]=r.length,c--,r.mode=Sj;break;case OE:if(r.wrap){for(;u<32;){if(l===0)break e;l--,d|=n[o++]<<u,u+=8}if(h-=c,e.total_out+=h,r.total+=h,r.wrap&4&&h&&(e.adler=r.check=r.flags?fi(r.check,s,h,i-h):t1(r.check,s,h,i-h)),h=c,r.wrap&4&&(r.flags?d:x9(d))!==r.check){e.msg="incorrect data check",r.mode=Ws;break}d=0,u=0}r.mode=g9;case g9:if(r.wrap&&r.flags){for(;u<32;){if(l===0)break e;l--,d+=n[o++]<<u,u+=8}if(r.wrap&4&&d!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=Ws;break}d=0,u=0}r.mode=v9;case v9:P=iJe;break e;case Ws:P=Vne;break e;case Hne:return Wne;case Gne:default:return Rd}return e.next_out=i,e.avail_out=c,e.next_in=o,e.avail_in=l,r.hold=d,r.bits=u,(r.wsize||h!==e.avail_out&&r.mode<Ws&&(r.mode<OE||t!==Xz))&&Qne(e,e.output,e.next_out,h-e.avail_out),f-=e.avail_in,h-=e.avail_out,e.total_in+=f,e.total_out+=h,r.total+=h,r.wrap&4&&h&&(e.adler=r.check=r.flags?fi(r.check,s,h,e.next_out-h):t1(r.check,s,h,e.next_out-h)),e.data_type=r.bits+(r.last?64:0)+(r.mode===jf?128:0)+(r.mode===Nj||r.mode===IE?256:0),(f===0&&h===0||t===Xz)&&P===Ag&&(P=cJe),P},xJe=e=>{if(Wg(e))return Rd;let t=e.state;return t.window&&(t.window=null),e.state=null,Ag},yJe=(e,t)=>{if(Wg(e))return Rd;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,Ag):Rd},bJe=(e,t)=>{const r=t.length;let n,s,o;return Wg(e)||(n=e.state,n.wrap!==0&&n.mode!==IS)?Rd:n.mode===IS&&(s=1,s=t1(s,t,r,0),s!==n.check)?Vne:(o=Qne(e,t,r,r),o?(n.mode=Hne,Wne):(n.havedict=1,Ag))};var wJe=Xne,jJe=Yne,_Je=Kne,NJe=pJe,SJe=Jne,CJe=vJe,PJe=xJe,AJe=yJe,EJe=bJe,kJe="pako inflate (from Nodeca project)",If={inflateReset:wJe,inflateReset2:jJe,inflateResetKeep:_Je,inflateInit:NJe,inflateInit2:SJe,inflate:CJe,inflateEnd:PJe,inflateGetHeader:AJe,inflateSetDictionary:EJe,inflateInfo:kJe};function IJe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var OJe=IJe;const Zne=Object.prototype.toString,{Z_NO_FLUSH:TJe,Z_FINISH:DJe,Z_OK:a1,Z_STREAM_END:ME,Z_NEED_DICT:RE,Z_STREAM_ERROR:MJe,Z_DATA_ERROR:b9,Z_MEM_ERROR:RJe}=W1;function G1(e){this.options=X5.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Bne,this.strm.avail_out=0;let r=If.inflateInit2(this.strm,t.windowBits);if(r!==a1)throw new Error(u0[r]);if(this.header=new OJe,If.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=n1.string2buf(t.dictionary):Zne.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=If.inflateSetDictionary(this.strm,t.dictionary),r!==a1)))throw new Error(u0[r])}G1.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let o,i,l;if(this.ended)return!1;for(t===~~t?i=t:i=t===!0?DJe:TJe,Zne.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),o=If.inflate(r,i),o===RE&&s&&(o=If.inflateSetDictionary(r,s),o===a1?o=If.inflate(r,i):o===b9&&(o=RE));r.avail_in>0&&o===ME&&r.state.wrap>0&&e[r.next_in]!==0;)If.inflateReset(r),o=If.inflate(r,i);switch(o){case MJe:case b9:case RE:case RJe:return this.onEnd(o),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||o===ME))if(this.options.to==="string"){let c=n1.utf8border(r.output,r.next_out),d=r.next_out-c,u=n1.buf2string(r.output,c);r.next_out=d,r.avail_out=n-d,d&&r.output.set(r.output.subarray(c,c+d),0),this.onData(u)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(o===a1&&l===0)){if(o===ME)return o=If.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};G1.prototype.onData=function(e){this.chunks.push(e)};G1.prototype.onEnd=function(e){e===a1&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=X5.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function hR(e,t){const r=new G1(t);if(r.push(e),r.err)throw r.msg||u0[r.err];return r.result}function LJe(e,t){return t=t||{},t.raw=!0,hR(e,t)}var FJe=G1,$Je=hR,BJe=LJe,qJe=hR,zJe=W1,UJe={Inflate:FJe,inflate:$Je,inflateRaw:BJe,ungzip:qJe,constants:zJe};const{Inflate:VJe,inflate:WJe,inflateRaw:act,ungzip:sct}=UJe;var w9=VJe,HJe=WJe;const eae=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;eae[e]=t}const j9=4294967295;function GJe(e,t,r){let n=e;for(let s=0;s<r;s++)n=eae[(n^t[s])&255]^n>>>8;return n}function KJe(e,t){return(GJe(j9,e,t)^j9)>>>0}function _9(e,t,r){const n=e.readUint32(),s=KJe(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(s!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${s}`)}function tae(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function rae(e,t,r,n){let s=0;for(;s<n;s++)t[s]=e[s];for(;s<r;s++)t[s]=e[s]+t[s-n]&255}function nae(e,t,r,n){let s=0;if(r.length===0)for(;s<n;s++)t[s]=e[s];else for(;s<n;s++)t[s]=e[s]+r[s]&255}function aae(e,t,r,n,s){let o=0;if(r.length===0){for(;o<s;o++)t[o]=e[o];for(;o<n;o++)t[o]=e[o]+(t[o-s]>>1)&255}else{for(;o<s;o++)t[o]=e[o]+(r[o]>>1)&255;for(;o<n;o++)t[o]=e[o]+(t[o-s]+r[o]>>1)&255}}function sae(e,t,r,n,s){let o=0;if(r.length===0){for(;o<s;o++)t[o]=e[o];for(;o<n;o++)t[o]=e[o]+t[o-s]&255}else{for(;o<s;o++)t[o]=e[o]+r[o]&255;for(;o<n;o++)t[o]=e[o]+XJe(t[o-s],r[o],r[o-s])&255}}function XJe(e,t,r){const n=e+t-r,s=Math.abs(n-e),o=Math.abs(n-t),i=Math.abs(n-r);return s<=o&&s<=i?e:o<=i?t:r}function YJe(e,t,r,n,s,o){switch(e){case 0:tae(t,r,s);break;case 1:rae(t,r,s,o);break;case 2:nae(t,r,n,s);break;case 3:aae(t,r,n,s,o);break;case 4:sae(t,r,n,s,o);break;default:throw new Error(`Unsupported filter: ${e}`)}}const JJe=new Uint16Array([255]),QJe=new Uint8Array(JJe.buffer),ZJe=QJe[0]===255;function eQe(e){const{data:t,width:r,height:n,channels:s,depth:o}=e,i=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(o/8)*s,c=new Uint8Array(n*r*l);let d=0;for(let u=0;u<7;u++){const f=i[u],h=Math.ceil((r-f.x)/f.xStep),m=Math.ceil((n-f.y)/f.yStep);if(h<=0||m<=0)continue;const v=h*l,g=new Uint8Array(v);for(let y=0;y<m;y++){const x=t[d++],b=t.subarray(d,d+v);d+=v;const w=new Uint8Array(v);YJe(x,b,w,g,v,l),g.set(w);for(let j=0;j<h;j++){const _=f.x+j*f.xStep,S=f.y+y*f.yStep;if(!(_>=r||S>=n))for(let C=0;C<l;C++)c[(S*r+_)*l+C]=w[j*l+C]}}}if(o===16){const u=new Uint16Array(c.buffer);if(ZJe)for(let f=0;f<u.length;f++)u[f]=tQe(u[f]);return u}else return c}function tQe(e){return(e&255)<<8|e>>8&255}const rQe=new Uint16Array([255]),nQe=new Uint8Array(rQe.buffer),aQe=nQe[0]===255,sQe=new Uint8Array(0);function N9(e){const{data:t,width:r,height:n,channels:s,depth:o}=e,i=Math.ceil(o/8)*s,l=Math.ceil(o/8*s*r),c=new Uint8Array(n*l);let d=sQe,u=0,f,h;for(let m=0;m<n;m++){switch(f=t.subarray(u+1,u+1+l),h=c.subarray(m*l,(m+1)*l),t[u]){case 0:tae(f,h,l);break;case 1:rae(f,h,l,i);break;case 2:nae(f,h,d,l);break;case 3:aae(f,h,d,l,i);break;case 4:sae(f,h,d,l,i);break;default:throw new Error(`Unsupported filter: ${t[u]}`)}d=h,u+=l+1}if(o===16){const m=new Uint16Array(c.buffer);if(aQe)for(let v=0;v<m.length;v++)m[v]=oQe(m[v]);return m}else return c}function oQe(e){return(e&255)<<8|e>>8&255}const p_=Uint8Array.of(137,80,78,71,13,10,26,10);function S9(e){if(!iQe(e.readBytes(p_.length)))throw new Error("wrong PNG signature")}function iQe(e){if(e.length<p_.length)return!1;for(let t=0;t<p_.length;t++)if(e[t]!==p_[t])return!1;return!0}const lQe="tEXt",cQe=0,oae=new TextDecoder("latin1");function dQe(e){if(fQe(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const uQe=/^[\u0000-\u00FF]*$/;function fQe(e){if(!uQe.test(e))throw new Error("invalid latin1 text")}function mQe(e,t,r){const n=iae(t);e[n]=hQe(t,r-n.length-1)}function iae(e){for(e.mark();e.readByte()!==cQe;);const t=e.offset;e.reset();const r=oae.decode(e.readBytes(t-e.offset-1));return e.skip(1),dQe(r),r}function hQe(e,t){return oae.decode(e.readBytes(t))}const wc={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},LE={UNKNOWN:-1,DEFLATE:0},C9={UNKNOWN:-1,ADAPTIVE:0},FE={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Cj={NONE:0,BACKGROUND:1,PREVIOUS:2},$E={SOURCE:0,OVER:1};class pQe extends iR{constructor(r,n={}){super(r);ss(this,"_checkCrc");ss(this,"_inflator");ss(this,"_png");ss(this,"_apng");ss(this,"_end");ss(this,"_hasPalette");ss(this,"_palette");ss(this,"_hasTransparency");ss(this,"_transparency");ss(this,"_compressionMethod");ss(this,"_filterMethod");ss(this,"_interlaceMethod");ss(this,"_colorType");ss(this,"_isAnimated");ss(this,"_numberOfFrames");ss(this,"_numberOfPlays");ss(this,"_frames");ss(this,"_writingDataChunks");const{checkCrc:s=!1}=n;this._checkCrc=s,this._inflator=new w9,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=LE.UNKNOWN,this._filterMethod=C9.UNKNOWN,this._interlaceMethod=FE.UNKNOWN,this._colorType=wc.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(S9(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(S9(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const s=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case lQe:mQe(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?_9(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const s=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=s+r;break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?_9(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=gQe(this.readUint8());const n=this.readUint8();this._colorType=n;let s;switch(n){case wc.GREYSCALE:s=1;break;case wc.TRUECOLOUR:s=3;break;case wc.INDEXED_COLOUR:s=1;break;case wc.GREYSCALE_ALPHA:s=2;break;case wc.TRUECOLOUR_ALPHA:s=4;break;case wc.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==LE.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const s=[];this._palette=s;for(let o=0;o<n;o++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,s=this.offset+this.byteOffset;if(s+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case wc.GREYSCALE:case wc.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case wc.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const s=this.readByte();this._palette[n].push(s)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case wc.UNKNOWN:case wc.GREYSCALE_ALPHA:case wc.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=iae(this),s=this.readUint8();if(s!==LE.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const o=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:HJe(o)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),s=this.readByte();this._png.resolution={x:r,y:n,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(r);if(s){if(s.data=N9({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)n.data=s.data;else{const o=this._apng.frames.at(r-1);this.disposeFrame(s,o,n),this.addFrameDataToCanvas(n,s)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,s){switch(r.disposeOp){case Cj.NONE:break;case Cj.BACKGROUND:for(let o=0;o<this._png.height;o++)for(let i=0;i<this._png.width;i++){const l=(o*r.width+i)*this._png.channels;for(let c=0;c<this._png.channels;c++)s.data[l+c]=0}break;case Cj.PREVIOUS:s.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const s=1<<this._png.depth,o=(i,l)=>{const c=((i+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,d=(i*n.width+l)*this._png.channels;return{index:c,frameIndex:d}};switch(n.blendOp){case $E.SOURCE:for(let i=0;i<n.height;i++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:d}=o(i,l);for(let u=0;u<this._png.channels;u++)r.data[c+u]=n.data[d+u]}break;case $E.OVER:for(let i=0;i<n.height;i++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:d}=o(i,l);for(let u=0;u<this._png.channels;u++){const f=n.data[d+this._png.channels-1]/s,h=u%(this._png.channels-1)===0?1:n.data[d+u],m=Math.floor(f*h+(1-f)*r.data[c+u]);r.data[c+u]+=m}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==C9.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===FE.NO_INTERLACE)this._png.data=N9({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===FE.ADAM7)this._png.data=eQe({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Cj.NONE,blendOp:$E.SOURCE,data:r}),this._inflator=new w9,this._writingDataChunks=!1}}function gQe(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var P9;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(P9||(P9={}));function vQe(e,t){return new pQe(e,t).decode()}var oa=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function BE(){oa.console&&typeof oa.console.log=="function"&&oa.console.log.apply(oa.console,arguments)}var gs={log:BE,warn:function(e){oa.console&&(typeof oa.console.warn=="function"?oa.console.warn.apply(oa.console,arguments):BE.call(null,arguments))},error:function(e){oa.console&&(typeof oa.console.error=="function"?oa.console.error.apply(oa.console,arguments):BE(e))}};function qE(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){Pp(n.response,t,r)},n.onerror=function(){gs.error("could not download file")},n.send()}function A9(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function Pj(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var Pp=oa.saveAs||((typeof window>"u"?"undefined":Da(window))!=="object"||window!==oa?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=oa.URL||oa.webkitURL,s=document.createElement("a");t=t||e.name||"download",s.download=t,s.rel="noopener",typeof e=="string"?(s.href=e,s.origin!==location.origin?A9(s.href)?qE(e,t,r):Pj(s,s.target="_blank"):Pj(s)):(s.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){Pj(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(A9(e))qE(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){Pj(n)})}else navigator.msSaveOrOpenBlob(function(s,o){return o===void 0?o={autoBom:!1}:Da(o)!=="object"&&(gs.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob([String.fromCharCode(65279),s],{type:s.type}):s}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return qE(e,t,r);var s=e.type==="application/octet-stream",o=/constructor/i.test(oa.HTMLElement)||oa.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||s&&o)&&(typeof FileReader>"u"?"undefined":Da(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var u=l.result;u=i?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},l.readAsDataURL(e)}else{var c=oa.URL||oa.webkitURL,d=c.createObjectURL(e);n?n.location=d:location.href=d,n=null,setTimeout(function(){c.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function lae(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var s=r[n].re,o=r[n].process,i=s.exec(e);i&&(t=o(i),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),d=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),"#"+l+c+d}}var g_=oa.atob.bind(oa),E9=oa.btoa.bind(oa);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function zE(e,t){var r=e[0],n=e[1],s=e[2],o=e[3];r=Ki(r,n,s,o,t[0],7,-680876936),o=Ki(o,r,n,s,t[1],12,-389564586),s=Ki(s,o,r,n,t[2],17,606105819),n=Ki(n,s,o,r,t[3],22,-1044525330),r=Ki(r,n,s,o,t[4],7,-176418897),o=Ki(o,r,n,s,t[5],12,1200080426),s=Ki(s,o,r,n,t[6],17,-1473231341),n=Ki(n,s,o,r,t[7],22,-45705983),r=Ki(r,n,s,o,t[8],7,1770035416),o=Ki(o,r,n,s,t[9],12,-1958414417),s=Ki(s,o,r,n,t[10],17,-42063),n=Ki(n,s,o,r,t[11],22,-1990404162),r=Ki(r,n,s,o,t[12],7,1804603682),o=Ki(o,r,n,s,t[13],12,-40341101),s=Ki(s,o,r,n,t[14],17,-1502002290),r=Xi(r,n=Ki(n,s,o,r,t[15],22,1236535329),s,o,t[1],5,-165796510),o=Xi(o,r,n,s,t[6],9,-1069501632),s=Xi(s,o,r,n,t[11],14,643717713),n=Xi(n,s,o,r,t[0],20,-373897302),r=Xi(r,n,s,o,t[5],5,-701558691),o=Xi(o,r,n,s,t[10],9,38016083),s=Xi(s,o,r,n,t[15],14,-660478335),n=Xi(n,s,o,r,t[4],20,-405537848),r=Xi(r,n,s,o,t[9],5,568446438),o=Xi(o,r,n,s,t[14],9,-1019803690),s=Xi(s,o,r,n,t[3],14,-187363961),n=Xi(n,s,o,r,t[8],20,1163531501),r=Xi(r,n,s,o,t[13],5,-1444681467),o=Xi(o,r,n,s,t[2],9,-51403784),s=Xi(s,o,r,n,t[7],14,1735328473),r=Yi(r,n=Xi(n,s,o,r,t[12],20,-1926607734),s,o,t[5],4,-378558),o=Yi(o,r,n,s,t[8],11,-2022574463),s=Yi(s,o,r,n,t[11],16,1839030562),n=Yi(n,s,o,r,t[14],23,-35309556),r=Yi(r,n,s,o,t[1],4,-1530992060),o=Yi(o,r,n,s,t[4],11,1272893353),s=Yi(s,o,r,n,t[7],16,-155497632),n=Yi(n,s,o,r,t[10],23,-1094730640),r=Yi(r,n,s,o,t[13],4,681279174),o=Yi(o,r,n,s,t[0],11,-358537222),s=Yi(s,o,r,n,t[3],16,-722521979),n=Yi(n,s,o,r,t[6],23,76029189),r=Yi(r,n,s,o,t[9],4,-640364487),o=Yi(o,r,n,s,t[12],11,-421815835),s=Yi(s,o,r,n,t[15],16,530742520),r=Ji(r,n=Yi(n,s,o,r,t[2],23,-995338651),s,o,t[0],6,-198630844),o=Ji(o,r,n,s,t[7],10,1126891415),s=Ji(s,o,r,n,t[14],15,-1416354905),n=Ji(n,s,o,r,t[5],21,-57434055),r=Ji(r,n,s,o,t[12],6,1700485571),o=Ji(o,r,n,s,t[3],10,-1894986606),s=Ji(s,o,r,n,t[10],15,-1051523),n=Ji(n,s,o,r,t[1],21,-2054922799),r=Ji(r,n,s,o,t[8],6,1873313359),o=Ji(o,r,n,s,t[15],10,-30611744),s=Ji(s,o,r,n,t[6],15,-1560198380),n=Ji(n,s,o,r,t[13],21,1309151649),r=Ji(r,n,s,o,t[4],6,-145523070),o=Ji(o,r,n,s,t[11],10,-1120210379),s=Ji(s,o,r,n,t[2],15,718787259),n=Ji(n,s,o,r,t[9],21,-343485551),e[0]=sh(r,e[0]),e[1]=sh(n,e[1]),e[2]=sh(s,e[2]),e[3]=sh(o,e[3])}function J5(e,t,r,n,s,o){return t=sh(sh(t,e),sh(n,o)),sh(t<<s|t>>>32-s,r)}function Ki(e,t,r,n,s,o,i){return J5(t&r|~t&n,e,t,s,o,i)}function Xi(e,t,r,n,s,o,i){return J5(t&n|r&~n,e,t,s,o,i)}function Yi(e,t,r,n,s,o,i){return J5(t^r^n,e,t,s,o,i)}function Ji(e,t,r,n,s,o,i){return J5(r^(t|~n),e,t,s,o,i)}function cae(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)zE(n,xQe(e.substring(t-64,t)));e=e.substring(t-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)s[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(s[t>>2]|=128<<(t%4<<3),t>55)for(zE(n,s),t=0;t<16;t++)s[t]=0;return s[14]=8*r,zE(n,s),n}function xQe(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var k9="0123456789abcdef".split("");function yQe(e){for(var t="",r=0;r<4;r++)t+=k9[e>>8*r+4&15]+k9[e>>8*r&15];return t}function bQe(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function e3(e){return cae(e).map(bQe).join("")}var wQe=function(e){for(var t=0;t<e.length;t++)e[t]=yQe(e[t]);return e.join("")}(cae("hello"))!="5d41402abc4b2a76b9719d911017c592";function sh(e,t){if(wQe){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function t3(e,t){var r,n,s,o;if(e!==r){for(var i=(s=e,o=1+(256/e.length|0),new Array(o+1).join(s)),l=[],c=0;c<256;c++)l[c]=c;var d=0;for(c=0;c<256;c++){var u=l[c];d=(d+u+i.charCodeAt(c))%256,l[c]=l[d],l[d]=u}r=e,n=l}else l=n;var f=t.length,h=0,m=0,v="";for(c=0;c<f;c++)m=(m+(u=l[h=(h+1)%256]))%256,l[h]=l[m],l[m]=u,i=l[(l[h]+l[m])%256],v+=String.fromCharCode(t.charCodeAt(c)^i);return v}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var I9={print:4,modify:8,copy:16,"annot-forms":32};function Ev(e,t,r,n){this.v=1,this.r=2;var s=192;e.forEach(function(l){if(I9.perm!==void 0)throw new Error("Invalid permission: "+l);s+=I9[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var o=(t+this.padding).substr(0,32),i=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(o,i),this.P=-(1+(255^s)),this.encryptionKey=e3(o+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=t3(this.encryptionKey,this.padding)}function kv(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var s=e.charCodeAt(n);t+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):e[n]}return t}function O9(e){if(Da(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,s){if(s=s||!1,typeof r!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var o=Math.random().toString(35);return t[r][o]=[n,!!s],o},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var o in t[r]){var i=t[r][o];try{i[0].apply(e,n)}catch(l){oa.console&&gs.error("jsPDF PubSub Error",l.message,l)}i[1]&&s.push(o)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function s1(e){if(!(this instanceof s1))return new s1(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function dae(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Km(e,t,r,n,s){if(!(this instanceof Km))return new Km(e,t,r,n,s);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,dae.call(this,n,s)}function Gp(e,t,r,n,s){if(!(this instanceof Gp))return new Gp(e,t,r,n,s);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,dae.call(this,n,s)}function Ln(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],o=arguments[3],i=[],l=1,c=16,d="S",u=null;Da(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,s=e.format||s,o=e.compress||e.compressPdf||o,(u=e.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),l=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),d=e.defaultPathOperation||"S"),i=e.filters||(o===!0?["FlateEncode"]:i),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=e.putOnlyUsedFonts||!1,h={},m={internal:{},__private__:{}};m.__private__.PubSub=O9;var v="1.3",g=m.__private__.getPdfVersion=function(){return v};m.__private__.setPdfVersion=function(L){v=L};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};m.__private__.getPageFormats=function(){return y};var x=m.__private__.getPageFormat=function(L){return y[L]};s=s||"a4";var b="compat",w="advanced",j=b;function _(){this.saveGraphicsState(),ie(new Be(Ue,0,0,-Ue,0,Es()*Ue).toString()+" cm"),this.setFontSize(this.getFontSize()/Ue),d="n",j=w}function S(){this.restoreGraphicsState(),d="S",j=b}var C=m.__private__.combineFontStyleAndFontWeight=function(L,ge){if(L=="bold"&&ge=="normal"||L=="bold"&&ge==400||L=="normal"&&ge=="italic"||L=="bold"&&ge=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ge&&(L=ge==400||ge==="normal"?L==="italic"?"italic":"normal":ge!=700&&ge!=="bold"||L!=="normal"?(ge==700?"bold":ge)+""+L:"bold"),L};m.advancedAPI=function(L){var ge=j===b;return ge&&_.call(this),typeof L!="function"||(L(this),ge&&S.call(this)),this},m.compatAPI=function(L){var ge=j===w;return ge&&S.call(this),typeof L!="function"||(L(this),ge&&_.call(this)),this},m.isAdvancedAPI=function(){return j===w};var P,A=function(L){if(j!==w)throw new Error(L+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},R=m.roundToPrecision=m.__private__.roundToPrecision=function(L,ge){var We=t||ge;if(isNaN(L)||isNaN(We))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return L.toFixed(We).replace(/0+$/,"")};P=m.hpf=m.__private__.hpf=typeof c=="number"?function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.hpf");return R(L,c)}:c==="smart"?function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.hpf");return R(L,L>-1&&L<1?16:5)}:function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.hpf");return R(L,16)};var O=m.f2=m.__private__.f2=function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.f2");return R(L,2)},I=m.__private__.f3=function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.f3");return R(L,3)},M=m.scale=m.__private__.scale=function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.scale");return j===b?L*Ue:j===w?L:void 0},D=function(L){return M(function(ge){return j===b?Es()-ge:j===w?ge:void 0}(L))};m.__private__.setPrecision=m.setPrecision=function(L){typeof parseInt(L,10)=="number"&&(t=parseInt(L,10))};var U,z="00000000000000000000000000000000",W=m.__private__.getFileId=function(){return z},$=m.__private__.setFileId=function(L){return z=L!==void 0&&/^[a-fA-F0-9]{32}$/.test(L)?L.toUpperCase():z.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(k=new Ev(u.userPermissions,u.userPassword,u.ownerPassword,z)),z};m.setFileId=function(L){return $(L),this},m.getFileId=function(){return W()};var X=m.__private__.convertDateToPDFDate=function(L){var ge=L.getTimezoneOffset(),We=ge<0?"+":"-",mt=Math.floor(Math.abs(ge/60)),J=Math.abs(ge%60),ve=[We,Q(mt),"'",Q(J),"'"].join("");return["D:",L.getFullYear(),Q(L.getMonth()+1),Q(L.getDate()),Q(L.getHours()),Q(L.getMinutes()),Q(L.getSeconds()),ve].join("")},ye=m.__private__.convertPDFDateToDate=function(L){var ge=parseInt(L.substr(2,4),10),We=parseInt(L.substr(6,2),10)-1,mt=parseInt(L.substr(8,2),10),J=parseInt(L.substr(10,2),10),ve=parseInt(L.substr(12,2),10),G=parseInt(L.substr(14,2),10);return new Date(ge,We,mt,J,ve,G,0)},Se=m.__private__.setCreationDate=function(L){var ge;if(L===void 0&&(L=new Date),L instanceof Date)ge=X(L);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(L))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ge=L}return U=ge},V=m.__private__.getCreationDate=function(L){var ge=U;return L==="jsDate"&&(ge=ye(U)),ge};m.setCreationDate=function(L){return Se(L),this},m.getCreationDate=function(L){return V(L)};var B,Q=m.__private__.padd2=function(L){return("0"+parseInt(L)).slice(-2)},pe=m.__private__.padd2Hex=function(L){return("00"+(L=L.toString())).substr(L.length)},te=0,Y=[],ce=[],me=0,ae=[],le=[],ue=!1,Re=ce;m.__private__.setCustomOutputDestination=function(L){ue=!0,Re=L};var ne=function(L){ue||(Re=L)};m.__private__.resetCustomOutputDestination=function(){ue=!1,Re=ce};var ie=m.__private__.out=function(L){return L=L.toString(),me+=L.length+1,Re.push(L),Re},gt=m.__private__.write=function(L){return ie(arguments.length===1?L.toString():Array.prototype.join.call(arguments," "))},bt=m.__private__.getArrayBuffer=function(L){for(var ge=L.length,We=new ArrayBuffer(ge),mt=new Uint8Array(We);ge--;)mt[ge]=L.charCodeAt(ge);return We},at=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];m.__private__.getStandardFonts=function(){return at};var xt=e.fontSize||16;m.__private__.setFontSize=m.setFontSize=function(L){return xt=j===w?L/Ue:L,this};var Ze,ht=m.__private__.getFontSize=m.getFontSize=function(){return j===b?xt:xt*Ue},Wt=e.R2L||!1;m.__private__.setR2L=m.setR2L=function(L){return Wt=L,this},m.__private__.getR2L=m.getR2L=function(){return Wt};var be,Ct=m.__private__.setZoomMode=function(L){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(L))Ze=L;else if(isNaN(L)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(L)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+L+'" is not recognized.');Ze=L}else Ze=parseInt(L,10)};m.__private__.getZoomMode=function(){return Ze};var wt,Ge=m.__private__.setPageMode=function(L){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(L)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+L+'" is not recognized.');be=L};m.__private__.getPageMode=function(){return be};var Je=m.__private__.setLayoutMode=function(L){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(L)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+L+'" is not recognized.');wt=L};m.__private__.getLayoutMode=function(){return wt},m.__private__.setDisplayMode=m.setDisplayMode=function(L,ge,We){return Ct(L),Je(ge),Ge(We),this};var _e={title:"",subject:"",author:"",keywords:"",creator:""};m.__private__.getDocumentProperty=function(L){if(Object.keys(_e).indexOf(L)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return _e[L]},m.__private__.getDocumentProperties=function(){return _e},m.__private__.setDocumentProperties=m.setProperties=m.setDocumentProperties=function(L){for(var ge in _e)_e.hasOwnProperty(ge)&&L[ge]&&(_e[ge]=L[ge]);return this},m.__private__.setDocumentProperty=function(L,ge){if(Object.keys(_e).indexOf(L)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return _e[L]=ge};var je,Ue,ze,or,tr,Nt={},yr={},Me=[],dt={},ut={},rr={},hr={},It=null,dr=0,ur=[],er=new O9(m),ln=e.hotfixes||[],Mr={},Ye={},$e=[],Be=function L(ge,We,mt,J,ve,G){if(!(this instanceof L))return new L(ge,We,mt,J,ve,G);isNaN(ge)&&(ge=1),isNaN(We)&&(We=0),isNaN(mt)&&(mt=0),isNaN(J)&&(J=1),isNaN(ve)&&(ve=0),isNaN(G)&&(G=0),this._matrix=[ge,We,mt,J,ve,G]};Object.defineProperty(Be.prototype,"sx",{get:function(){return this._matrix[0]},set:function(L){this._matrix[0]=L}}),Object.defineProperty(Be.prototype,"shy",{get:function(){return this._matrix[1]},set:function(L){this._matrix[1]=L}}),Object.defineProperty(Be.prototype,"shx",{get:function(){return this._matrix[2]},set:function(L){this._matrix[2]=L}}),Object.defineProperty(Be.prototype,"sy",{get:function(){return this._matrix[3]},set:function(L){this._matrix[3]=L}}),Object.defineProperty(Be.prototype,"tx",{get:function(){return this._matrix[4]},set:function(L){this._matrix[4]=L}}),Object.defineProperty(Be.prototype,"ty",{get:function(){return this._matrix[5]},set:function(L){this._matrix[5]=L}}),Object.defineProperty(Be.prototype,"a",{get:function(){return this._matrix[0]},set:function(L){this._matrix[0]=L}}),Object.defineProperty(Be.prototype,"b",{get:function(){return this._matrix[1]},set:function(L){this._matrix[1]=L}}),Object.defineProperty(Be.prototype,"c",{get:function(){return this._matrix[2]},set:function(L){this._matrix[2]=L}}),Object.defineProperty(Be.prototype,"d",{get:function(){return this._matrix[3]},set:function(L){this._matrix[3]=L}}),Object.defineProperty(Be.prototype,"e",{get:function(){return this._matrix[4]},set:function(L){this._matrix[4]=L}}),Object.defineProperty(Be.prototype,"f",{get:function(){return this._matrix[5]},set:function(L){this._matrix[5]=L}}),Object.defineProperty(Be.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Be.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Be.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Be.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Be.prototype.join=function(L){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(P).join(L)},Be.prototype.multiply=function(L){var ge=L.sx*this.sx+L.shy*this.shx,We=L.sx*this.shy+L.shy*this.sy,mt=L.shx*this.sx+L.sy*this.shx,J=L.shx*this.shy+L.sy*this.sy,ve=L.tx*this.sx+L.ty*this.shx+this.tx,G=L.tx*this.shy+L.ty*this.sy+this.ty;return new Be(ge,We,mt,J,ve,G)},Be.prototype.decompose=function(){var L=this.sx,ge=this.shy,We=this.shx,mt=this.sy,J=this.tx,ve=this.ty,G=Math.sqrt(L*L+ge*ge),re=(L/=G)*We+(ge/=G)*mt;We-=L*re,mt-=ge*re;var we=Math.sqrt(We*We+mt*mt);return re/=we,L*(mt/=we)<ge*(We/=we)&&(L=-L,ge=-ge,re=-re,G=-G),{scale:new Be(G,0,0,we,0,0),translate:new Be(1,0,0,1,J,ve),rotate:new Be(L,ge,-ge,L,0,0),skew:new Be(1,0,re,1,0,0)}},Be.prototype.toString=function(L){return this.join(" ")},Be.prototype.inversed=function(){var L=this.sx,ge=this.shy,We=this.shx,mt=this.sy,J=this.tx,ve=this.ty,G=1/(L*mt-ge*We),re=mt*G,we=-ge*G,Ce=-We*G,ke=L*G;return new Be(re,we,Ce,ke,-re*J-Ce*ve,-we*J-ke*ve)},Be.prototype.applyToPoint=function(L){var ge=L.x*this.sx+L.y*this.shx+this.tx,We=L.x*this.shy+L.y*this.sy+this.ty;return new il(ge,We)},Be.prototype.applyToRectangle=function(L){var ge=this.applyToPoint(L),We=this.applyToPoint(new il(L.x+L.w,L.y+L.h));return new zs(ge.x,ge.y,We.x-ge.x,We.y-ge.y)},Be.prototype.clone=function(){var L=this.sx,ge=this.shy,We=this.shx,mt=this.sy,J=this.tx,ve=this.ty;return new Be(L,ge,We,mt,J,ve)},m.Matrix=Be;var et=m.matrixMult=function(L,ge){return ge.multiply(L)},jt=new Be(1,0,0,1,0,0);m.unitMatrix=m.identityMatrix=jt;var yt=function(L,ge){if(!ut[L]){var We=(ge instanceof Km?"Sh":"P")+(Object.keys(dt).length+1).toString(10);ge.id=We,ut[L]=We,dt[We]=ge,er.publish("addPattern",ge)}};m.ShadingPattern=Km,m.TilingPattern=Gp,m.addShadingPattern=function(L,ge){return A("addShadingPattern()"),yt(L,ge),this},m.beginTilingPattern=function(L){A("beginTilingPattern()"),qo(L.boundingBox[0],L.boundingBox[1],L.boundingBox[2]-L.boundingBox[0],L.boundingBox[3]-L.boundingBox[1],L.matrix)},m.endTilingPattern=function(L,ge){A("endTilingPattern()"),ge.stream=le[B].join(`
`),yt(L,ge),er.publish("endTilingPattern",ge),$e.pop().restore()};var qt,pt=m.__private__.newObject=function(){var L=Dt();return he(L,!0),L},Dt=m.__private__.newObjectDeferred=function(){return te++,Y[te]=function(){return me},te},he=function(L,ge){return ge=typeof ge=="boolean"&&ge,Y[L]=me,ge&&ie(L+" 0 obj"),L},Qe=m.__private__.newAdditionalObject=function(){var L={objId:Dt(),content:""};return ae.push(L),L},zt=Dt(),Mt=Dt(),ir=m.__private__.decodeColorString=function(L){var ge=L.split(" ");if(ge.length!==2||ge[1]!=="g"&&ge[1]!=="G")ge.length!==5||ge[4]!=="k"&&ge[4]!=="K"||(ge=[(1-ge[0])*(1-ge[3]),(1-ge[1])*(1-ge[3]),(1-ge[2])*(1-ge[3]),"r"]);else{var We=parseFloat(ge[0]);ge=[We,We,We,"r"]}for(var mt="#",J=0;J<3;J++)mt+=("0"+Math.floor(255*parseFloat(ge[J])).toString(16)).slice(-2);return mt},nr=m.__private__.encodeColorString=function(L){var ge;typeof L=="string"&&(L={ch1:L});var We=L.ch1,mt=L.ch2,J=L.ch3,ve=L.ch4,G=L.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof We=="string"&&We.charAt(0)!=="#"){var re=new lae(We);if(re.ok)We=re.toHex();else if(!/^\d*\.?\d*$/.test(We))throw new Error('Invalid color "'+We+'" passed to jsPDF.encodeColorString.')}if(typeof We=="string"&&/^#[0-9A-Fa-f]{3}$/.test(We)&&(We="#"+We[1]+We[1]+We[2]+We[2]+We[3]+We[3]),typeof We=="string"&&/^#[0-9A-Fa-f]{6}$/.test(We)){var we=parseInt(We.substr(1),16);We=we>>16&255,mt=we>>8&255,J=255&we}if(mt===void 0||ve===void 0&&We===mt&&mt===J)ge=typeof We=="string"?We+" "+G[0]:L.precision===2?O(We/255)+" "+G[0]:I(We/255)+" "+G[0];else if(ve===void 0||Da(ve)==="object"){if(ve&&!isNaN(ve.a)&&ve.a===0)return["1.","1.","1.",G[1]].join(" ");ge=typeof We=="string"?[We,mt,J,G[1]].join(" "):L.precision===2?[O(We/255),O(mt/255),O(J/255),G[1]].join(" "):[I(We/255),I(mt/255),I(J/255),G[1]].join(" ")}else ge=typeof We=="string"?[We,mt,J,ve,G[2]].join(" "):L.precision===2?[O(We),O(mt),O(J),O(ve),G[2]].join(" "):[I(We),I(mt),I(J),I(ve),G[2]].join(" ");return ge},kr=m.__private__.getFilters=function(){return i},Ft=m.__private__.putStream=function(L){var ge=(L=L||{}).data||"",We=L.filters||kr(),mt=L.alreadyAppliedFilters||[],J=L.addLength1||!1,ve=ge.length,G=L.objectId,re=function(tt){return tt};if(u!==null&&G===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(re=k.encryptor(G,0));var we={};We===!0&&(We=["FlateEncode"]);var Ce=L.additionalKeyValues||[],ke=(we=Ln.API.processDataByFilters!==void 0?Ln.API.processDataByFilters(ge,We):{data:ge,reverseChain:[]}).reverseChain+(Array.isArray(mt)?mt.join(" "):mt.toString());if(we.data.length!==0&&(Ce.push({key:"Length",value:we.data.length}),J===!0&&Ce.push({key:"Length1",value:ve})),ke.length!=0)if(ke.split("/").length-1==1)Ce.push({key:"Filter",value:ke});else{Ce.push({key:"Filter",value:"["+ke+"]"});for(var Oe=0;Oe<Ce.length;Oe+=1)if(Ce[Oe].key==="DecodeParms"){for(var oe=[],Ee=0;Ee<we.reverseChain.split("/").length-1;Ee+=1)oe.push("null");oe.push(Ce[Oe].value),Ce[Oe].value="["+oe.join(" ")+"]"}}ie("<<");for(var Ie=0;Ie<Ce.length;Ie++)ie("/"+Ce[Ie].key+" "+Ce[Ie].value);ie(">>"),we.data.length!==0&&(ie("stream"),ie(re(we.data)),ie("endstream"))},Dr=m.__private__.putPage=function(L){var ge=L.number,We=L.data,mt=L.objId,J=L.contentsObjId;he(mt,!0),ie("<</Type /Page"),ie("/Parent "+L.rootDictionaryObjId+" 0 R"),ie("/Resources "+L.resourceDictionaryObjId+" 0 R"),ie("/MediaBox ["+parseFloat(P(L.mediaBox.bottomLeftX))+" "+parseFloat(P(L.mediaBox.bottomLeftY))+" "+P(L.mediaBox.topRightX)+" "+P(L.mediaBox.topRightY)+"]"),L.cropBox!==null&&ie("/CropBox ["+P(L.cropBox.bottomLeftX)+" "+P(L.cropBox.bottomLeftY)+" "+P(L.cropBox.topRightX)+" "+P(L.cropBox.topRightY)+"]"),L.bleedBox!==null&&ie("/BleedBox ["+P(L.bleedBox.bottomLeftX)+" "+P(L.bleedBox.bottomLeftY)+" "+P(L.bleedBox.topRightX)+" "+P(L.bleedBox.topRightY)+"]"),L.trimBox!==null&&ie("/TrimBox ["+P(L.trimBox.bottomLeftX)+" "+P(L.trimBox.bottomLeftY)+" "+P(L.trimBox.topRightX)+" "+P(L.trimBox.topRightY)+"]"),L.artBox!==null&&ie("/ArtBox ["+P(L.artBox.bottomLeftX)+" "+P(L.artBox.bottomLeftY)+" "+P(L.artBox.topRightX)+" "+P(L.artBox.topRightY)+"]"),typeof L.userUnit=="number"&&L.userUnit!==1&&ie("/UserUnit "+L.userUnit),er.publish("putPage",{objId:mt,pageContext:ur[ge],pageNumber:ge,page:We}),ie("/Contents "+J+" 0 R"),ie(">>"),ie("endobj");var ve=We.join(`
`);return j===w&&(ve+=`
Q`),he(J,!0),Ft({data:ve,filters:kr(),objectId:J}),ie("endobj"),mt},Fr=m.__private__.putPages=function(){var L,ge,We=[];for(L=1;L<=dr;L++)ur[L].objId=Dt(),ur[L].contentsObjId=Dt();for(L=1;L<=dr;L++)We.push(Dr({number:L,data:le[L],objId:ur[L].objId,contentsObjId:ur[L].contentsObjId,mediaBox:ur[L].mediaBox,cropBox:ur[L].cropBox,bleedBox:ur[L].bleedBox,trimBox:ur[L].trimBox,artBox:ur[L].artBox,userUnit:ur[L].userUnit,rootDictionaryObjId:zt,resourceDictionaryObjId:Mt}));he(zt,!0),ie("<</Type /Pages");var mt="/Kids [";for(ge=0;ge<dr;ge++)mt+=We[ge]+" 0 R ";ie(mt+"]"),ie("/Count "+dr),ie(">>"),ie("endobj"),er.publish("postPutPages")},Tn=function(L){er.publish("putFont",{font:L,out:ie,newObject:pt,putStream:Ft}),L.isAlreadyPutted!==!0&&(L.objectNumber=pt(),ie("<<"),ie("/Type /Font"),ie("/BaseFont /"+kv(L.postScriptName)),ie("/Subtype /Type1"),typeof L.encoding=="string"&&ie("/Encoding /"+L.encoding),ie("/FirstChar 32"),ie("/LastChar 255"),ie(">>"),ie("endobj"))},nt=function(L){L.objectNumber=pt();var ge=[];ge.push({key:"Type",value:"/XObject"}),ge.push({key:"Subtype",value:"/Form"}),ge.push({key:"BBox",value:"["+[P(L.x),P(L.y),P(L.x+L.width),P(L.y+L.height)].join(" ")+"]"}),ge.push({key:"Matrix",value:"["+L.matrix.toString()+"]"});var We=L.pages[1].join(`
`);Ft({data:We,additionalKeyValues:ge,objectId:L.objectNumber}),ie("endobj")},$t=function(L,ge){ge||(ge=21);var We=pt(),mt=function(G,re){var we,Ce=[],ke=1/(re-1);for(we=0;we<1;we+=ke)Ce.push(we);if(Ce.push(1),G[0].offset!=0){var Oe={offset:0,color:G[0].color};G.unshift(Oe)}if(G[G.length-1].offset!=1){var oe={offset:1,color:G[G.length-1].color};G.push(oe)}for(var Ee="",Ie=0,tt=0;tt<Ce.length;tt++){for(we=Ce[tt];we>G[Ie+1].offset;)Ie++;var vt=G[Ie].offset,Rt=(we-vt)/(G[Ie+1].offset-vt),At=G[Ie].color,Gt=G[Ie+1].color;Ee+=pe(Math.round((1-Rt)*At[0]+Rt*Gt[0]).toString(16))+pe(Math.round((1-Rt)*At[1]+Rt*Gt[1]).toString(16))+pe(Math.round((1-Rt)*At[2]+Rt*Gt[2]).toString(16))}return Ee.trim()}(L.colors,ge),J=[];J.push({key:"FunctionType",value:"0"}),J.push({key:"Domain",value:"[0.0 1.0]"}),J.push({key:"Size",value:"["+ge+"]"}),J.push({key:"BitsPerSample",value:"8"}),J.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),J.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ft({data:mt,additionalKeyValues:J,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:We}),ie("endobj"),L.objectNumber=pt(),ie("<< /ShadingType "+L.type),ie("/ColorSpace /DeviceRGB");var ve="/Coords ["+P(parseFloat(L.coords[0]))+" "+P(parseFloat(L.coords[1]))+" ";L.type===2?ve+=P(parseFloat(L.coords[2]))+" "+P(parseFloat(L.coords[3])):ve+=P(parseFloat(L.coords[2]))+" "+P(parseFloat(L.coords[3]))+" "+P(parseFloat(L.coords[4]))+" "+P(parseFloat(L.coords[5])),ie(ve+="]"),L.matrix&&ie("/Matrix ["+L.matrix.toString()+"]"),ie("/Function "+We+" 0 R"),ie("/Extend [true true]"),ie(">>"),ie("endobj")},Kt=function(L,ge){var We=Dt(),mt=pt();ge.push({resourcesOid:We,objectOid:mt}),L.objectNumber=mt;var J=[];J.push({key:"Type",value:"/Pattern"}),J.push({key:"PatternType",value:"1"}),J.push({key:"PaintType",value:"1"}),J.push({key:"TilingType",value:"1"}),J.push({key:"BBox",value:"["+L.boundingBox.map(P).join(" ")+"]"}),J.push({key:"XStep",value:P(L.xStep)}),J.push({key:"YStep",value:P(L.yStep)}),J.push({key:"Resources",value:We+" 0 R"}),L.matrix&&J.push({key:"Matrix",value:"["+L.matrix.toString()+"]"}),Ft({data:L.stream,additionalKeyValues:J,objectId:L.objectNumber}),ie("endobj")},sr=function(L){for(var ge in L.objectNumber=pt(),ie("<<"),L)switch(ge){case"opacity":ie("/ca "+O(L[ge]));break;case"stroke-opacity":ie("/CA "+O(L[ge]))}ie(">>"),ie("endobj")},St=function(L){he(L.resourcesOid,!0),ie("<<"),ie("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var ge in ie("/Font <<"),Nt)Nt.hasOwnProperty(ge)&&(f===!1||f===!0&&h.hasOwnProperty(ge))&&ie("/"+ge+" "+Nt[ge].objectNumber+" 0 R");ie(">>")}(),function(){if(Object.keys(dt).length>0){for(var ge in ie("/Shading <<"),dt)dt.hasOwnProperty(ge)&&dt[ge]instanceof Km&&dt[ge].objectNumber>=0&&ie("/"+ge+" "+dt[ge].objectNumber+" 0 R");er.publish("putShadingPatternDict"),ie(">>")}}(),function(ge){if(Object.keys(dt).length>0){for(var We in ie("/Pattern <<"),dt)dt.hasOwnProperty(We)&&dt[We]instanceof m.TilingPattern&&dt[We].objectNumber>=0&&dt[We].objectNumber<ge&&ie("/"+We+" "+dt[We].objectNumber+" 0 R");er.publish("putTilingPatternDict"),ie(">>")}}(L.objectOid),function(){if(Object.keys(rr).length>0){var ge;for(ge in ie("/ExtGState <<"),rr)rr.hasOwnProperty(ge)&&rr[ge].objectNumber>=0&&ie("/"+ge+" "+rr[ge].objectNumber+" 0 R");er.publish("putGStateDict"),ie(">>")}}(),function(){for(var ge in ie("/XObject <<"),Mr)Mr.hasOwnProperty(ge)&&Mr[ge].objectNumber>=0&&ie("/"+ge+" "+Mr[ge].objectNumber+" 0 R");er.publish("putXobjectDict"),ie(">>")}(),ie(">>"),ie("endobj")},Jr=function(L){yr[L.fontName]=yr[L.fontName]||{},yr[L.fontName][L.fontStyle]=L.id},Pt=function(L,ge,We,mt,J){var ve={id:"F"+(Object.keys(Nt).length+1).toString(10),postScriptName:L,fontName:ge,fontStyle:We,encoding:mt,isStandardFont:J||!1,metadata:{}};return er.publish("addFont",{font:ve,instance:this}),Nt[ve.id]=ve,Jr(ve),ve.id},lr=m.__private__.pdfEscape=m.pdfEscape=function(L,ge){return function(We,mt){var J,ve,G,re,we,Ce,ke,Oe,oe;if(G=(mt=mt||{}).sourceEncoding||"Unicode",we=mt.outputEncoding,(mt.autoencode||we)&&Nt[je].metadata&&Nt[je].metadata[G]&&Nt[je].metadata[G].encoding&&(re=Nt[je].metadata[G].encoding,!we&&Nt[je].encoding&&(we=Nt[je].encoding),!we&&re.codePages&&(we=re.codePages[0]),typeof we=="string"&&(we=re[we]),we)){for(ke=!1,Ce=[],J=0,ve=We.length;J<ve;J++)(Oe=we[We.charCodeAt(J)])?Ce.push(String.fromCharCode(Oe)):Ce.push(We[J]),Ce[J].charCodeAt(0)>>8&&(ke=!0);We=Ce.join("")}for(J=We.length;ke===void 0&&J!==0;)We.charCodeAt(J-1)>>8&&(ke=!0),J--;if(!ke)return We;for(Ce=mt.noBOM?[]:[254,255],J=0,ve=We.length;J<ve;J++){if((oe=(Oe=We.charCodeAt(J))>>8)>>8)throw new Error("Character at position "+J+" of string '"+We+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Ce.push(oe),Ce.push(Oe-(oe<<8))}return String.fromCharCode.apply(void 0,Ce)}(L,ge).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},st=m.__private__.beginPage=function(L){le[++dr]=[],ur[dr]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(L[0]),topRightY:Number(L[1])}},Tr(dr),ne(le[B])},Et=function(L,ge){var We,mt,J;switch(r=ge||r,typeof L=="string"&&(We=x(L.toLowerCase()),Array.isArray(We)&&(mt=We[0],J=We[1])),Array.isArray(L)&&(mt=L[0]*Ue,J=L[1]*Ue),isNaN(mt)&&(mt=s[0],J=s[1]),(mt>14400||J>14400)&&(gs.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),mt=Math.min(14400,mt),J=Math.min(14400,J)),s=[mt,J],r.substr(0,1)){case"l":J>mt&&(s=[J,mt]);break;case"p":mt>J&&(s=[J,mt])}st(s),Sa(sn),ie(fc),qs!==0&&ie(qs+" J"),Qc!==0&&ie(Qc+" j"),er.publish("addPage",{pageNumber:dr})},ar=function(L){L>0&&L<=dr&&(le.splice(L,1),ur.splice(L,1),dr--,B>dr&&(B=dr),this.setPage(B))},Tr=function(L){L>0&&L<=dr&&(B=L)},Qr=m.__private__.getNumberOfPages=m.getNumberOfPages=function(){return le.length-1},tn=function(L,ge,We){var mt,J=void 0;return We=We||{},L=L!==void 0?L:Nt[je].fontName,ge=ge!==void 0?ge:Nt[je].fontStyle,mt=L.toLowerCase(),yr[mt]!==void 0&&yr[mt][ge]!==void 0?J=yr[mt][ge]:yr[L]!==void 0&&yr[L][ge]!==void 0?J=yr[L][ge]:We.disableWarning===!1&&gs.warn("Unable to look up font label for font '"+L+"', '"+ge+"'. Refer to getFontList() for available fonts."),J||We.noFallback||(J=yr.times[ge])==null&&(J=yr.times.normal),J},Qt=m.__private__.putInfo=function(){var L=pt(),ge=function(mt){return mt};for(var We in u!==null&&(ge=k.encryptor(L,0)),ie("<<"),ie("/Producer ("+lr(ge("jsPDF "+Ln.version))+")"),_e)_e.hasOwnProperty(We)&&_e[We]&&ie("/"+We.substr(0,1).toUpperCase()+We.substr(1)+" ("+lr(ge(_e[We]))+")");ie("/CreationDate ("+lr(ge(U))+")"),ie(">>"),ie("endobj")},fn=m.__private__.putCatalog=function(L){var ge=(L=L||{}).rootDictionaryObjId||zt;switch(pt(),ie("<<"),ie("/Type /Catalog"),ie("/Pages "+ge+" 0 R"),Ze||(Ze="fullwidth"),Ze){case"fullwidth":ie("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ie("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ie("/OpenAction [3 0 R /Fit]");break;case"original":ie("/OpenAction [3 0 R /XYZ null null 1]");break;default:var We=""+Ze;We.substr(We.length-1)==="%"&&(Ze=parseInt(Ze)/100),typeof Ze=="number"&&ie("/OpenAction [3 0 R /XYZ null null "+O(Ze)+"]")}switch(wt||(wt="continuous"),wt){case"continuous":ie("/PageLayout /OneColumn");break;case"single":ie("/PageLayout /SinglePage");break;case"two":case"twoleft":ie("/PageLayout /TwoColumnLeft");break;case"tworight":ie("/PageLayout /TwoColumnRight")}be&&ie("/PageMode /"+be),er.publish("putCatalog"),ie(">>"),ie("endobj")},nn=m.__private__.putTrailer=function(){ie("trailer"),ie("<<"),ie("/Size "+(te+1)),ie("/Root "+te+" 0 R"),ie("/Info "+(te-1)+" 0 R"),u!==null&&ie("/Encrypt "+k.oid+" 0 R"),ie("/ID [ <"+z+"> <"+z+"> ]"),ie(">>")},In=m.__private__.putHeader=function(){ie("%PDF-"+v),ie("%")},Dn=m.__private__.putXRef=function(){var L="0000000000";ie("xref"),ie("0 "+(te+1)),ie("0000000000 65535 f ");for(var ge=1;ge<=te;ge++)typeof Y[ge]=="function"?ie((L+Y[ge]()).slice(-10)+" 00000 n "):Y[ge]!==void 0?ie((L+Y[ge]).slice(-10)+" 00000 n "):ie("0000000000 00000 n ")},se=m.__private__.buildDocument=function(){var L;te=0,me=0,ce=[],Y=[],ae=[],zt=Dt(),Mt=Dt(),ne(ce),er.publish("buildDocument"),In(),Fr(),function(){er.publish("putAdditionalObjects");for(var We=0;We<ae.length;We++){var mt=ae[We];he(mt.objId,!0),ie(mt.content),ie("endobj")}er.publish("postPutAdditionalObjects")}(),L=[],function(){for(var We in Nt)Nt.hasOwnProperty(We)&&(f===!1||f===!0&&h.hasOwnProperty(We))&&Tn(Nt[We])}(),function(){var We;for(We in rr)rr.hasOwnProperty(We)&&sr(rr[We])}(),function(){for(var We in Mr)Mr.hasOwnProperty(We)&&nt(Mr[We])}(),function(We){var mt;for(mt in dt)dt.hasOwnProperty(mt)&&(dt[mt]instanceof Km?$t(dt[mt]):dt[mt]instanceof Gp&&Kt(dt[mt],We))}(L),er.publish("putResources"),L.forEach(St),St({resourcesOid:Mt,objectOid:Number.MAX_SAFE_INTEGER}),er.publish("postPutResources"),u!==null&&(k.oid=pt(),ie("<<"),ie("/Filter /Standard"),ie("/V "+k.v),ie("/R "+k.r),ie("/U <"+k.toHexString(k.U)+">"),ie("/O <"+k.toHexString(k.O)+">"),ie("/P "+k.P),ie(">>"),ie("endobj")),Qt(),fn();var ge=me;return Dn(),nn(),ie("startxref"),ie(""+ge),ie("%%EOF"),ne(le[B]),ce.join(`
`)},He=m.__private__.getBlob=function(L){return new Blob([bt(L)],{type:"application/pdf"})},ot=m.output=m.__private__.output=(qt=function(L,ge){switch(typeof(ge=ge||{})=="string"?ge={filename:ge}:ge.filename=ge.filename||"generated.pdf",L){case void 0:return se();case"save":m.save(ge.filename);break;case"arraybuffer":return bt(se());case"blob":return He(se());case"bloburi":case"bloburl":if(oa.URL!==void 0&&typeof oa.URL.createObjectURL=="function")return oa.URL&&oa.URL.createObjectURL(He(se()))||void 0;gs.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var We="",mt=se();try{We=E9(mt)}catch{We=E9(unescape(encodeURIComponent(mt)))}return"data:application/pdf;filename="+ge.filename+";base64,"+We;case"pdfobjectnewwindow":if(Object.prototype.toString.call(oa)==="[object Window]"){var J="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",ve=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ge.pdfObjectUrl&&(J=ge.pdfObjectUrl,ve="");var G='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+J+'"'+ve+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ge)+");<\/script></body></html>",re=oa.open();return re!==null&&re.document.write(G),re}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(oa)==="[object Window]"){var we='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ge.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ge.filename+'" width="500px" height="400px" /></body></html>',Ce=oa.open();if(Ce!==null){Ce.document.write(we);var ke=this;Ce.document.documentElement.querySelector("#pdfViewer").onload=function(){Ce.document.title=ge.filename,Ce.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(ke.output("bloburl"))}}return Ce}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(oa)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Oe='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ge)+'"></iframe></body></html>',oe=oa.open();if(oe!==null&&(oe.document.write(Oe),oe.document.title=ge.filename),oe||typeof safari>"u")return oe;break;case"datauri":case"dataurl":return oa.document.location.href=this.output("datauristring",ge);default:return null}},qt.foo=function(){try{return qt.apply(this,arguments)}catch(We){var L=We.stack||"";~L.indexOf(" at ")&&(L=L.split(" at ")[1]);var ge="Error in function "+L.split(`
`)[0].split("<")[0]+": "+We.message;if(!oa.console)throw new Error(ge);oa.console.error(ge,We),oa.alert&&alert(ge)}},qt.foo.bar=qt,qt.foo),ee=function(L){return Array.isArray(ln)===!0&&ln.indexOf(L)>-1};switch(n){case"pt":Ue=1;break;case"mm":Ue=72/25.4;break;case"cm":Ue=72/2.54;break;case"in":Ue=72;break;case"px":Ue=ee("px_scaling")==1?.75:96/72;break;case"pc":case"em":Ue=12;break;case"ex":Ue=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Ue=n}var k=null;Se(),$();var T=m.__private__.getPageInfo=m.getPageInfo=function(L){if(isNaN(L)||L%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:ur[L].objId,pageNumber:L,pageContext:ur[L]}},K=m.__private__.getPageInfoByObjId=function(L){if(isNaN(L)||L%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ge in ur)if(ur[ge].objId===L)break;return T(ge)},H=m.__private__.getCurrentPageInfo=m.getCurrentPageInfo=function(){return{objId:ur[B].objId,pageNumber:B,pageContext:ur[B]}};m.addPage=function(){return Et.apply(this,arguments),this},m.setPage=function(){return Tr.apply(this,arguments),ne.call(this,le[B]),this},m.insertPage=function(L){return this.addPage(),this.movePage(B,L),this},m.movePage=function(L,ge){var We,mt;if(L>ge){We=le[L],mt=ur[L];for(var J=L;J>ge;J--)le[J]=le[J-1],ur[J]=ur[J-1];le[ge]=We,ur[ge]=mt,this.setPage(ge)}else if(L<ge){We=le[L],mt=ur[L];for(var ve=L;ve<ge;ve++)le[ve]=le[ve+1],ur[ve]=ur[ve+1];le[ge]=We,ur[ge]=mt,this.setPage(ge)}return this},m.deletePage=function(){return ar.apply(this,arguments),this},m.__private__.text=m.text=function(L,ge,We,mt,J){var ve,G,re,we,Ce,ke,Oe,oe,Ee,Ie=(mt=mt||{}).scope||this;if(typeof L=="number"&&typeof ge=="number"&&(typeof We=="string"||Array.isArray(We))){var tt=We;We=ge,ge=L,L=tt}if(arguments[3]instanceof Be==0?(re=arguments[4],we=arguments[5],Da(Oe=arguments[3])==="object"&&Oe!==null||(typeof re=="string"&&(we=re,re=null),typeof Oe=="string"&&(we=Oe,Oe=null),typeof Oe=="number"&&(re=Oe,Oe=null),mt={flags:Oe,angle:re,align:we})):(A("The transform parameter of text() with a Matrix value"),Ee=J),isNaN(ge)||isNaN(We)||L==null)throw new Error("Invalid arguments passed to jsPDF.text");if(L.length===0)return Ie;var vt,Rt="",At=typeof mt.lineHeightFactor=="number"?mt.lineHeightFactor:zn,Gt=Ie.internal.scaleFactor;function Bt(Ia){return Ia=Ia.split("	").join(Array(mt.TabLen||9).join(" ")),lr(Ia,Oe)}function Ht(Ia){for(var Ka,us=Ia.concat(),vo=[],ed=us.length;ed--;)typeof(Ka=us.shift())=="string"?vo.push(Ka):Array.isArray(Ia)&&(Ka.length===1||Ka[1]===void 0&&Ka[2]===void 0)?vo.push(Ka[0]):vo.push([Ka[0],Ka[1],Ka[2]]);return vo}function jr(Ia,Ka){var us;if(typeof Ia=="string")us=Ka(Ia)[0];else if(Array.isArray(Ia)){for(var vo,ed,ap=Ia.concat(),Pu=[],gm=ap.length;gm--;)typeof(vo=ap.shift())=="string"?Pu.push(Ka(vo)[0]):Array.isArray(vo)&&typeof vo[0]=="string"&&(ed=Ka(vo[0],vo[1],vo[2]),Pu.push([ed[0],ed[1],ed[2]]));us=Pu}return us}var vr=!1,xn=!0;if(typeof L=="string")vr=!0;else if(Array.isArray(L)){var Kn=L.concat();G=[];for(var Un,Ir=Kn.length;Ir--;)(typeof(Un=Kn.shift())!="string"||Array.isArray(Un)&&typeof Un[0]!="string")&&(xn=!1);vr=xn}if(vr===!1)throw new Error('Type of text must be string or Array. "'+L+'" is not recognized.');typeof L=="string"&&(L=L.match(/[\r?\n]/)?L.split(/\r\n|\r|\n/g):[L]);var Er=xt/Ie.internal.scaleFactor,Br=Er*(At-1);switch(mt.baseline){case"bottom":We-=Br;break;case"top":We+=Er-Br;break;case"hanging":We+=Er-2*Br;break;case"middle":We+=Er/2-Br}if((ke=mt.maxWidth||0)>0&&(typeof L=="string"?L=Ie.splitTextToSize(L,ke):Object.prototype.toString.call(L)==="[object Array]"&&(L=L.reduce(function(Ia,Ka){return Ia.concat(Ie.splitTextToSize(Ka,ke))},[]))),ve={text:L,x:ge,y:We,options:mt,mutex:{pdfEscape:lr,activeFontKey:je,fonts:Nt,activeFontSize:xt}},er.publish("preProcessText",ve),L=ve.text,re=(mt=ve.options).angle,Ee instanceof Be==0&&re&&typeof re=="number"){re*=Math.PI/180,mt.rotationDirection===0&&(re=-re),j===w&&(re=-re);var zr=Math.cos(re),en=Math.sin(re);Ee=new Be(zr,en,-en,zr,0,0)}else re&&re instanceof Be&&(Ee=re);j!==w||Ee||(Ee=jt),(Ce=mt.charSpace||Ll)!==void 0&&(Rt+=P(M(Ce))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(oe=mt.horizontalScale)!==void 0&&(Rt+=P(100*oe)+` Tz
`),mt.lang;var cn=-1,mr=mt.renderingMode!==void 0?mt.renderingMode:mt.stroke,Ur=Ie.internal.getCurrentPageInfo().pageContext;switch(mr){case 0:case!1:case"fill":cn=0;break;case 1:case!0:case"stroke":cn=1;break;case 2:case"fillThenStroke":cn=2;break;case 3:case"invisible":cn=3;break;case 4:case"fillAndAddForClipping":cn=4;break;case 5:case"strokeAndAddPathForClipping":cn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":cn=6;break;case 7:case"addToPathForClipping":cn=7}var gr=Ur.usedRenderingMode!==void 0?Ur.usedRenderingMode:-1;cn!==-1?Rt+=cn+` Tr
`:gr!==-1&&(Rt+=`0 Tr
`),cn!==-1&&(Ur.usedRenderingMode=cn),we=mt.align||"left";var _r,Xt=xt*At,Lr=Ie.internal.pageSize.getWidth(),br=Nt[je];Ce=mt.charSpace||Ll,ke=mt.maxWidth||0,Oe=Object.assign({autoencode:!0,noBOM:!0},mt.flags);var Gr=[],yn=function(Ia){return Ie.getStringUnitWidth(Ia,{font:br,charSpace:Ce,fontSize:xt,doKerning:!1})*xt/Gt};if(Object.prototype.toString.call(L)==="[object Array]"){var Zr;G=Ht(L),we!=="left"&&(_r=G.map(yn));var kn,ya=0;if(we==="right"){ge-=_r[0],L=[],Ir=G.length;for(var Ca=0;Ca<Ir;Ca++)Ca===0?(kn=Ys(ge),Zr=Za(We)):(kn=M(ya-_r[Ca]),Zr=-Xt),L.push([G[Ca],kn,Zr]),ya=_r[Ca]}else if(we==="center"){ge-=_r[0]/2,L=[],Ir=G.length;for(var ks=0;ks<Ir;ks++)ks===0?(kn=Ys(ge),Zr=Za(We)):(kn=M((ya-_r[ks])/2),Zr=-Xt),L.push([G[ks],kn,Zr]),ya=_r[ks]}else if(we==="left"){L=[],Ir=G.length;for(var es=0;es<Ir;es++)L.push(G[es])}else if(we==="justify"&&br.encoding==="Identity-H"){L=[],Ir=G.length,ke=ke!==0?ke:Lr;for(var ka=0,ma=0;ma<Ir;ma++)if(Zr=ma===0?Za(We):-Xt,kn=ma===0?Ys(ge):ka,ma<Ir-1){var Co=M((ke-_r[ma])/(G[ma].split(" ").length-1)),Js=G[ma].split(" ");L.push([Js[0]+" ",kn,Zr]),ka=0;for(var Is=1;Is<Js.length;Is++){var Us=(yn(Js[Is-1]+" "+Js[Is])-yn(Js[Is]))*Gt+Co;Is==Js.length-1?L.push([Js[Is],Us,0]):L.push([Js[Is]+" ",Us,0]),ka-=Us}}else L.push([G[ma],kn,Zr]);L.push(["",ka,0])}else{if(we!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(L=[],Ir=G.length,ke=ke!==0?ke:Lr,ma=0;ma<Ir;ma++){Zr=ma===0?Za(We):-Xt,kn=ma===0?Ys(ge):0;var Zc=G[ma].split(" ").length-1,pm=Zc>0?(ke-_r[ma])/Zc:0;ma<Ir-1?Gr.push(P(M(pm))):Gr.push(0),L.push([G[ma],kn,Zr])}}}(typeof mt.R2L=="boolean"?mt.R2L:Wt)===!0&&(L=jr(L,function(Ia,Ka,us){return[Ia.split("").reverse().join(""),Ka,us]})),ve={text:L,x:ge,y:We,options:mt,mutex:{pdfEscape:lr,activeFontKey:je,fonts:Nt,activeFontSize:xt}},er.publish("postProcessText",ve),L=ve.text,vt=ve.mutex.isHex||!1;var np=Nt[je].encoding;np!=="WinAnsiEncoding"&&np!=="StandardEncoding"||(L=jr(L,function(Ia,Ka,us){return[Bt(Ia),Ka,us]})),G=Ht(L),L=[];for(var Uo,go,Cu,Bl=Array.isArray(G[0])?1:0,ll="",ql=function(Ia,Ka,us){var vo="";return us instanceof Be?(us=typeof mt.angle=="number"?et(us,new Be(1,0,0,1,Ia,Ka)):et(new Be(1,0,0,1,Ia,Ka),us),j===w&&(us=et(new Be(1,0,0,-1,0,0),us)),vo=us.join(" ")+` Tm
`):vo=P(Ia)+" "+P(Ka)+` Td
`,vo},Vo=0;Vo<G.length;Vo++){switch(ll="",Bl){case 1:Cu=(vt?"<":"(")+G[Vo][0]+(vt?">":")"),Uo=parseFloat(G[Vo][1]),go=parseFloat(G[Vo][2]);break;case 0:Cu=(vt?"<":"(")+G[Vo]+(vt?">":")"),Uo=Ys(ge),go=Za(We)}Gr!==void 0&&Gr[Vo]!==void 0&&(ll=Gr[Vo]+` Tw
`),Vo===0?L.push(ll+ql(Uo,go,Ee)+Cu):Bl===0?L.push(ll+Cu):Bl===1&&L.push(ll+ql(Uo,go,Ee)+Cu)}L=Bl===0?L.join(` Tj
T* `):L.join(` Tj
`),L+=` Tj
`;var ys=`BT
/`;return ys+=je+" "+xt+` Tf
`,ys+=P(xt*At)+` TL
`,ys+=Ui+`
`,ys+=Rt,ys+=L,ie(ys+="ET"),h[je]=!0,Ie};var F=m.__private__.clip=m.clip=function(L){return ie(L==="evenodd"?"W*":"W"),this};m.clipEvenOdd=function(){return F("evenodd")},m.__private__.discardPath=m.discardPath=function(){return ie("n"),this};var Le=m.__private__.isValidStyle=function(L){var ge=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(L)!==-1&&(ge=!0),ge};m.__private__.setDefaultPathOperation=m.setDefaultPathOperation=function(L){return Le(L)&&(d=L),this};var it=m.__private__.getStyle=m.getStyle=function(L){var ge=d;switch(L){case"D":case"S":ge="S";break;case"F":ge="f";break;case"FD":case"DF":ge="B";break;case"f":case"f*":case"B":case"B*":ge=L}return ge},lt=m.close=function(){return ie("h"),this};m.stroke=function(){return ie("S"),this},m.fill=function(L){return Vt("f",L),this},m.fillEvenOdd=function(L){return Vt("f*",L),this},m.fillStroke=function(L){return Vt("B",L),this},m.fillStrokeEvenOdd=function(L){return Vt("B*",L),this};var Vt=function(L,ge){Da(ge)==="object"?Sr(ge,L):ie(L)},Ve=function(L){L===null||j===w&&L===void 0||(L=it(L),ie(L))};function kt(L,ge,We,mt,J){var ve=new Gp(ge||this.boundingBox,We||this.xStep,mt||this.yStep,this.gState,J||this.matrix);ve.stream=this.stream;var G=L+"$$"+this.cloneIndex+++"$$";return yt(G,ve),ve}var Sr=function(L,ge){var We=ut[L.key],mt=dt[We];if(mt instanceof Km)ie("q"),ie(Or(ge)),mt.gState&&m.setGState(mt.gState),ie(L.matrix.toString()+" cm"),ie("/"+We+" sh"),ie("Q");else if(mt instanceof Gp){var J=new Be(1,0,0,-1,0,Es());L.matrix&&(J=J.multiply(L.matrix||jt),We=kt.call(mt,L.key,L.boundingBox,L.xStep,L.yStep,J).id),ie("q"),ie("/Pattern cs"),ie("/"+We+" scn"),mt.gState&&m.setGState(mt.gState),ie(ge),ie("Q")}},Or=function(L){switch(L){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},fr=m.moveTo=function(L,ge){return ie(P(M(L))+" "+P(D(ge))+" m"),this},Kr=m.lineTo=function(L,ge){return ie(P(M(L))+" "+P(D(ge))+" l"),this},Pn=m.curveTo=function(L,ge,We,mt,J,ve){return ie([P(M(L)),P(D(ge)),P(M(We)),P(D(mt)),P(M(J)),P(D(ve)),"c"].join(" ")),this};m.__private__.line=m.line=function(L,ge,We,mt,J){if(isNaN(L)||isNaN(ge)||isNaN(We)||isNaN(mt)||!Le(J))throw new Error("Invalid arguments passed to jsPDF.line");return j===b?this.lines([[We-L,mt-ge]],L,ge,[1,1],J||"S"):this.lines([[We-L,mt-ge]],L,ge,[1,1]).stroke()},m.__private__.lines=m.lines=function(L,ge,We,mt,J,ve){var G,re,we,Ce,ke,Oe,oe,Ee,Ie,tt,vt,Rt;if(typeof L=="number"&&(Rt=We,We=ge,ge=L,L=Rt),mt=mt||[1,1],ve=ve||!1,isNaN(ge)||isNaN(We)||!Array.isArray(L)||!Array.isArray(mt)||!Le(J)||typeof ve!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(fr(ge,We),G=mt[0],re=mt[1],Ce=L.length,tt=ge,vt=We,we=0;we<Ce;we++)(ke=L[we]).length===2?(tt=ke[0]*G+tt,vt=ke[1]*re+vt,Kr(tt,vt)):(Oe=ke[0]*G+tt,oe=ke[1]*re+vt,Ee=ke[2]*G+tt,Ie=ke[3]*re+vt,tt=ke[4]*G+tt,vt=ke[5]*re+vt,Pn(Oe,oe,Ee,Ie,tt,vt));return ve&&lt(),Ve(J),this},m.path=function(L){for(var ge=0;ge<L.length;ge++){var We=L[ge],mt=We.c;switch(We.op){case"m":fr(mt[0],mt[1]);break;case"l":Kr(mt[0],mt[1]);break;case"c":Pn.apply(this,mt);break;case"h":lt()}}return this},m.__private__.rect=m.rect=function(L,ge,We,mt,J){if(isNaN(L)||isNaN(ge)||isNaN(We)||isNaN(mt)||!Le(J))throw new Error("Invalid arguments passed to jsPDF.rect");return j===b&&(mt=-mt),ie([P(M(L)),P(D(ge)),P(M(We)),P(M(mt)),"re"].join(" ")),Ve(J),this},m.__private__.triangle=m.triangle=function(L,ge,We,mt,J,ve,G){if(isNaN(L)||isNaN(ge)||isNaN(We)||isNaN(mt)||isNaN(J)||isNaN(ve)||!Le(G))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[We-L,mt-ge],[J-We,ve-mt],[L-J,ge-ve]],L,ge,[1,1],G,!0),this},m.__private__.roundedRect=m.roundedRect=function(L,ge,We,mt,J,ve,G){if(isNaN(L)||isNaN(ge)||isNaN(We)||isNaN(mt)||isNaN(J)||isNaN(ve)||!Le(G))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var re=4/3*(Math.SQRT2-1);return J=Math.min(J,.5*We),ve=Math.min(ve,.5*mt),this.lines([[We-2*J,0],[J*re,0,J,ve-ve*re,J,ve],[0,mt-2*ve],[0,ve*re,-J*re,ve,-J,ve],[2*J-We,0],[-J*re,0,-J,-ve*re,-J,-ve],[0,2*ve-mt],[0,-ve*re,J*re,-ve,J,-ve]],L+J,ge,[1,1],G,!0),this},m.__private__.ellipse=m.ellipse=function(L,ge,We,mt,J){if(isNaN(L)||isNaN(ge)||isNaN(We)||isNaN(mt)||!Le(J))throw new Error("Invalid arguments passed to jsPDF.ellipse");var ve=4/3*(Math.SQRT2-1)*We,G=4/3*(Math.SQRT2-1)*mt;return fr(L+We,ge),Pn(L+We,ge-G,L+ve,ge-mt,L,ge-mt),Pn(L-ve,ge-mt,L-We,ge-G,L-We,ge),Pn(L-We,ge+G,L-ve,ge+mt,L,ge+mt),Pn(L+ve,ge+mt,L+We,ge+G,L+We,ge),Ve(J),this},m.__private__.circle=m.circle=function(L,ge,We,mt){if(isNaN(L)||isNaN(ge)||isNaN(We)||!Le(mt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(L,ge,We,We,mt)},m.setFont=function(L,ge,We){return We&&(ge=C(ge,We)),je=tn(L,ge,{disableWarning:!1}),this};var qn=m.__private__.getFont=m.getFont=function(){return Nt[tn.apply(m,arguments)]};m.__private__.getFontList=m.getFontList=function(){var L,ge,We={};for(L in yr)if(yr.hasOwnProperty(L))for(ge in We[L]=[],yr[L])yr[L].hasOwnProperty(ge)&&We[L].push(ge);return We},m.addFont=function(L,ge,We,mt,J){var ve=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&ve.indexOf(arguments[3])!==-1?J=arguments[3]:arguments[3]&&ve.indexOf(arguments[3])==-1&&(We=C(We,mt)),Pt.call(this,L,ge,We,J=J||"Identity-H")};var zn,sn=e.lineWidth||.200025,qr=m.__private__.getLineWidth=m.getLineWidth=function(){return sn},Sa=m.__private__.setLineWidth=m.setLineWidth=function(L){return sn=L,ie(P(M(L))+" w"),this};m.__private__.setLineDash=Ln.API.setLineDash=Ln.API.setLineDashPattern=function(L,ge){if(L=L||[],ge=ge||0,isNaN(ge)||!Array.isArray(L))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return L=L.map(function(We){return P(M(We))}).join(" "),ge=P(M(ge)),ie("["+L+"] "+ge+" d"),this};var _a=m.__private__.getLineHeight=m.getLineHeight=function(){return xt*zn};m.__private__.getLineHeight=m.getLineHeight=function(){return xt*zn};var da=m.__private__.setLineHeightFactor=m.setLineHeightFactor=function(L){return typeof(L=L||1.15)=="number"&&(zn=L),this},Xs=m.__private__.getLineHeightFactor=m.getLineHeightFactor=function(){return zn};da(e.lineHeight);var Ys=m.__private__.getHorizontalCoordinate=function(L){return M(L)},Za=m.__private__.getVerticalCoordinate=function(L){return j===w?L:ur[B].mediaBox.topRightY-ur[B].mediaBox.bottomLeftY-M(L)},ol=m.__private__.getHorizontalCoordinateString=m.getHorizontalCoordinateString=function(L){return P(Ys(L))},hs=m.__private__.getVerticalCoordinateString=m.getVerticalCoordinateString=function(L){return P(Za(L))},fc=e.strokeColor||"0 G";m.__private__.getStrokeColor=m.getDrawColor=function(){return ir(fc)},m.__private__.setStrokeColor=m.setDrawColor=function(L,ge,We,mt){return fc=nr({ch1:L,ch2:ge,ch3:We,ch4:mt,pdfColorType:"draw",precision:2}),ie(fc),this};var mc=e.fillColor||"0 g";m.__private__.getFillColor=m.getFillColor=function(){return ir(mc)},m.__private__.setFillColor=m.setFillColor=function(L,ge,We,mt){return mc=nr({ch1:L,ch2:ge,ch3:We,ch4:mt,pdfColorType:"fill",precision:2}),ie(mc),this};var Ui=e.textColor||"0 g",Bo=m.__private__.getTextColor=m.getTextColor=function(){return ir(Ui)};m.__private__.setTextColor=m.setTextColor=function(L,ge,We,mt){return Ui=nr({ch1:L,ch2:ge,ch3:We,ch4:mt,pdfColorType:"text",precision:3}),this};var Ll=e.charSpace,Bd=m.__private__.getCharSpace=m.getCharSpace=function(){return parseFloat(Ll||0)};m.__private__.setCharSpace=m.setCharSpace=function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ll=L,this};var qs=0;m.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},m.__private__.setLineCap=m.setLineCap=function(L){var ge=m.CapJoinStyles[L];if(ge===void 0)throw new Error("Line cap style of '"+L+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return qs=ge,ie(ge+" J"),this};var Qc=0;m.__private__.setLineJoin=m.setLineJoin=function(L){var ge=m.CapJoinStyles[L];if(ge===void 0)throw new Error("Line join style of '"+L+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Qc=ge,ie(ge+" j"),this},m.__private__.setLineMiterLimit=m.__private__.setMiterLimit=m.setLineMiterLimit=m.setMiterLimit=function(L){if(L=L||0,isNaN(L))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ie(P(M(L))+" M"),this},m.GState=s1,m.setGState=function(L){(L=typeof L=="string"?rr[hr[L]]:Fl(null,L)).equals(It)||(ie("/"+L.id+" gs"),It=L)};var Fl=function(L,ge){if(!L||!hr[L]){var We=!1;for(var mt in rr)if(rr.hasOwnProperty(mt)&&rr[mt].equals(ge)){We=!0;break}if(We)ge=rr[mt];else{var J="GS"+(Object.keys(rr).length+1).toString(10);rr[J]=ge,ge.id=J}return L&&(hr[L]=ge.id),er.publish("addGState",ge),ge}};m.addGState=function(L,ge){return Fl(L,ge),this},m.saveGraphicsState=function(){return ie("q"),Me.push({key:je,size:xt,color:Ui}),this},m.restoreGraphicsState=function(){ie("Q");var L=Me.pop();return je=L.key,xt=L.size,Ui=L.color,It=null,this},m.setCurrentTransformationMatrix=function(L){return ie(L.toString()+" cm"),this},m.comment=function(L){return ie("#"+L),this};var il=function(L,ge){var We=L||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return We},set:function(ve){isNaN(ve)||(We=parseFloat(ve))}});var mt=ge||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return mt},set:function(ve){isNaN(ve)||(mt=parseFloat(ve))}});var J="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return J},set:function(ve){J=ve.toString()}}),this},zs=function(L,ge,We,mt){il.call(this,L,ge),this.type="rect";var J=We||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return J},set:function(G){isNaN(G)||(J=parseFloat(G))}});var ve=mt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return ve},set:function(G){isNaN(G)||(ve=parseFloat(G))}}),this},Si=function(){this.page=dr,this.currentPage=B,this.pages=le.slice(0),this.pagesContext=ur.slice(0),this.x=ze,this.y=or,this.matrix=tr,this.width=$l(B),this.height=oi(B),this.outputDestination=Re,this.id="",this.objectNumber=-1};Si.prototype.restore=function(){dr=this.page,B=this.currentPage,ur=this.pagesContext,le=this.pages,ze=this.x,or=this.y,tr=this.matrix,hf(B,this.width),zo(B,this.height),Re=this.outputDestination};var qo=function(L,ge,We,mt,J){$e.push(new Si),dr=B=0,le=[],ze=L,or=ge,tr=J,st([We,mt])};for(var hc in m.beginFormObject=function(L,ge,We,mt,J){return qo(L,ge,We,mt,J),this},m.endFormObject=function(L){return function(ge){if(Ye[ge])$e.pop().restore();else{var We=new Si,mt="Xo"+(Object.keys(Mr).length+1).toString(10);We.id=mt,Ye[ge]=mt,Mr[mt]=We,er.publish("addFormObject",We),$e.pop().restore()}}(L),this},m.doFormObject=function(L,ge){var We=Mr[Ye[L]];return ie("q"),ie(ge.toString()+" cm"),ie("/"+We.id+" Do"),ie("Q"),this},m.getFormObject=function(L){var ge=Mr[Ye[L]];return{x:ge.x,y:ge.y,width:ge.width,height:ge.height,matrix:ge.matrix}},m.save=function(L,ge){return L=L||"generated.pdf",(ge=ge||{}).returnPromise=ge.returnPromise||!1,ge.returnPromise===!1?(Pp(He(se()),L),typeof Pp.unload=="function"&&oa.setTimeout&&setTimeout(Pp.unload,911),this):new Promise(function(We,mt){try{var J=Pp(He(se()),L);typeof Pp.unload=="function"&&oa.setTimeout&&setTimeout(Pp.unload,911),We(J)}catch(ve){mt(ve.message)}})},Ln.API)Ln.API.hasOwnProperty(hc)&&(hc==="events"&&Ln.API.events.length?function(L,ge){var We,mt,J;for(J=ge.length-1;J!==-1;J--)We=ge[J][0],mt=ge[J][1],L.subscribe.apply(L,[We].concat(typeof mt=="function"?[mt]:mt))}(er,Ln.API.events):m[hc]=Ln.API[hc]);function $l(L){return ur[L].mediaBox.topRightX-ur[L].mediaBox.bottomLeftX}function hf(L,ge){ur[L].mediaBox.topRightX=ge+ur[L].mediaBox.bottomLeftX}function oi(L){return ur[L].mediaBox.topRightY-ur[L].mediaBox.bottomLeftY}function zo(L,ge){ur[L].mediaBox.topRightY=ge+ur[L].mediaBox.bottomLeftY}var hm=m.getPageWidth=function(L){return $l(L=L||B)/Ue},pf=m.setPageWidth=function(L,ge){hf(L,ge*Ue)},Es=m.getPageHeight=function(L){return oi(L=L||B)/Ue},po=m.setPageHeight=function(L,ge){zo(L,ge*Ue)};return m.internal={pdfEscape:lr,getStyle:it,getFont:qn,getFontSize:ht,getCharSpace:Bd,getTextColor:Bo,getLineHeight:_a,getLineHeightFactor:Xs,getLineWidth:qr,write:gt,getHorizontalCoordinate:Ys,getVerticalCoordinate:Za,getCoordinateString:ol,getVerticalCoordinateString:hs,collections:{},newObject:pt,newAdditionalObject:Qe,newObjectDeferred:Dt,newObjectDeferredBegin:he,getFilters:kr,putStream:Ft,events:er,scaleFactor:Ue,pageSize:{getWidth:function(){return hm(B)},setWidth:function(L){pf(B,L)},getHeight:function(){return Es(B)},setHeight:function(L){po(B,L)}},encryptionOptions:u,encryption:k,getEncryptor:function(L){return u!==null?k.encryptor(L,0):function(ge){return ge}},output:ot,getNumberOfPages:Qr,pages:le,out:ie,f2:O,f3:I,getPageInfo:T,getPageInfoByObjId:K,getCurrentPageInfo:H,getPDFVersion:g,Point:il,Rectangle:zs,Matrix:Be,hasHotfix:ee},Object.defineProperty(m.internal.pageSize,"width",{get:function(){return hm(B)},set:function(L){pf(B,L)},enumerable:!0,configurable:!0}),Object.defineProperty(m.internal.pageSize,"height",{get:function(){return Es(B)},set:function(L){po(B,L)},enumerable:!0,configurable:!0}),function(L){for(var ge=0,We=at.length;ge<We;ge++){var mt=Pt.call(this,L[ge][0],L[ge][1],L[ge][2],at[ge][3],!0);f===!1&&(h[mt]=!0);var J=L[ge][0].split("-");Jr({id:mt,fontName:J[0],fontStyle:J[1]||""})}er.publish("addFonts",{fonts:Nt,dictionary:yr})}.call(m,at),je="F1",Et(s,r),er.publish("initialized"),m}Ev.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},Ev.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Ev.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},Ev.prototype.processOwnerPassword=function(e,t){return t3(e3(t).substr(0,5),e)},Ev.prototype.encryptor=function(e,t){var r=e3(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return t3(r,n)}},s1.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||Da(e)!==Da(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},Ln.API={events:[]},Ln.version="3.0.3";var lo=Ln.API,pR=1,Hg=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},xv=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},ha=function(e){return e.toFixed(2)},Am=function(e){return e.toFixed(5)};lo.__acroform__={};var uc=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},T9=function(e){return e*pR},Mu=function(e){var t=new fae,r=En.internal.getHeight(e)||0,n=En.internal.getWidth(e)||0;return t.BBox=[0,0,Number(ha(n)),Number(ha(r))],t},jQe=lo.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},_Qe=lo.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},NQe=lo.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},jo=lo.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return NQe(e,t-1)},_o=lo.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return jQe(e,t-1)},No=lo.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return _Qe(e,t-1)},SQe=lo.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,s=e[0],o=e[1],i=e[2],l=e[3],c={};return c.lowerLeft_X=r(s)||0,c.lowerLeft_Y=n(o+l)||0,c.upperRight_X=r(s+i)||0,c.upperRight_Y=n(o)||0,[Number(ha(c.lowerLeft_X)),Number(ha(c.lowerLeft_Y)),Number(ha(c.upperRight_X)),Number(ha(c.upperRight_Y))]},CQe=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=r3(e,r),s=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+s+" "+ha(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var o=Mu(e);return o.scope=e.scope,o.stream=t.join(`
`),o}},r3=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},s=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");s=e.multiline?s.map(function(O){return O.split(`
`)}):s.map(function(O){return[O]});var o=r,i=En.internal.getHeight(e)||0;i=i<0?-i:i;var l=En.internal.getWidth(e)||0;l=l<0?-l:l;var c=function(O,I,M){if(O+1<s.length){var D=I+" "+s[O+1][0];return Aj(D,e,M).width<=l-4}return!1};o++;e:for(;o>0;){t="",o--;var d,u,f=Aj("3",e,o).height,h=e.multiline?i-o:(i-f)/2,m=h+=2,v=0,g=0,y=0;if(o<=0){t=`(...) Tj
`,t+="% Width of Text: "+Aj(t,e,o=12).width+", FieldWidth:"+l+`
`;break}for(var x="",b=0,w=0;w<s.length;w++)if(s.hasOwnProperty(w)){var j=!1;if(s[w].length!==1&&y!==s[w].length-1){if((f+2)*(b+2)+2>i)continue e;x+=s[w][y],j=!0,g=w,w--}else{x=(x+=s[w][y]+" ").substr(x.length-1)==" "?x.substr(0,x.length-1):x;var _=parseInt(w),S=c(_,x,o),C=w>=s.length-1;if(S&&!C){x+=" ",y=0;continue}if(S||C){if(C)g=_;else if(e.multiline&&(f+2)*(b+2)+2>i)continue e}else{if(!e.multiline||(f+2)*(b+2)+2>i)continue e;g=_}}for(var P="",A=v;A<=g;A++){var R=s[A];if(e.multiline){if(A===g){P+=R[y]+" ",y=(y+1)%R.length;continue}if(A===v){P+=R[R.length-1]+" ";continue}}P+=R[0]+" "}switch(P=P.substr(P.length-1)==" "?P.substr(0,P.length-1):P,u=Aj(P,e,o).width,e.textAlign){case"right":d=l-u-2;break;case"center":d=(l-u)/2;break;default:d=2}t+=ha(d)+" "+ha(m)+` Td
`,t+="("+Hg(P)+`) Tj
`,t+=-ha(d)+` 0 Td
`,m=-(o+2),u=0,v=j?g:g+1,b++,x=""}break}return n.text=t,n.fontSize=o,n},Aj=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),s=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:s}},PQe={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},AQe=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},EQe=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(_u.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(PQe)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");pR=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new mae,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var o=n[s];o.objId=void 0,o.hasAnnotation&&AQe(o,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,s){var o=!n;for(var i in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(i)){var l=n[i],c=[],d=l.Rect;if(l.Rect&&(l.Rect=SQe(l.Rect,s)),s.internal.newObjectDeferredBegin(l.objId,!0),l.DA=En.createDefaultAppearanceStream(l),Da(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=d,l.hasAppearanceStream&&!l.appearanceStreamContent){var u=CQe(l);c.push({key:"AP",value:"<</N "+u+">>"}),s.internal.acroformPlugin.xForms.push(u)}if(l.appearanceStreamContent){var f="";for(var h in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(h)){var m=l.appearanceStreamContent[h];if(f+="/"+h+" ",f+="<<",Object.keys(m).length>=1||Array.isArray(m)){for(var i in m)if(m.hasOwnProperty(i)){var v=m[i];typeof v=="function"&&(v=v.call(s,l)),f+="/"+i+" "+v+" ",s.internal.acroformPlugin.xForms.indexOf(v)>=0||s.internal.acroformPlugin.xForms.push(v)}}else typeof(v=m)=="function"&&(v=v.call(s,l)),f+="/"+i+" "+v,s.internal.acroformPlugin.xForms.indexOf(v)>=0||s.internal.acroformPlugin.xForms.push(v);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}s.internal.putStream({additionalKeyValues:c,objectId:l.objId}),s.internal.out("endobj")}o&&function(g,y){for(var x in g)if(g.hasOwnProperty(x)){var b=x,w=g[x];y.internal.newObjectDeferredBegin(w.objId,!0),Da(w)==="object"&&typeof w.putStream=="function"&&w.putStream(),delete g[b]}}(s.internal.acroformPlugin.xForms,s)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},uae=lo.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(i){return i};if(Array.isArray(e)){for(var s="[",o=0;o<e.length;o++)switch(o!==0&&(s+=" "),Da(e[o])){case"boolean":case"number":case"object":s+=e[o].toString();break;case"string":e[o].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),s+="("+Hg(n(e[o].toString()))+")"):s+=e[o].toString()}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},UE=function(e,t,r){var n=function(s){return s};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+Hg(n(e))+")"},Ku=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Ku.prototype.toString=function(){return this.objId+" 0 R"},Ku.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Ku.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(o){return o!="content"&&o!="appearanceStreamContent"&&o!="scope"&&o!="objId"&&o.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],s=this[n];s&&(Array.isArray(s)?e.push({key:n,value:uae(s,this.objId,this.scope)}):s instanceof Ku?(s.scope=this.scope,e.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&e.push({key:n,value:s}))}return e};var fae=function(){Ku.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};uc(fae,Ku);var mae=function(){Ku.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Hg(r(e))+")"}},set:function(r){e=r}})};uc(mae,Ku);var _u=function e(){Ku.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute F supplied.');t=x}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!jo(t,3)},set:function(x){x?this.F=_o(t,3):this.F=No(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute Ff supplied.');r=x}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(x){n=x!==void 0?x:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(x){n[0]=x}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(x){n[1]=x}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(x){n[2]=x}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(x){n[3]=x}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(x){switch(x){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=x;break;default:throw new Error('Invalid value "'+x+'" for attribute FT supplied.')}}});var o=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!o||o.length<1){if(this instanceof OS)return;o="FieldObject"+e.FieldNum++}var x=function(b){return b};return this.scope&&(x=this.scope.internal.getEncryptor(this.objId)),"("+Hg(x(o))+")"},set:function(x){o=x.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return o},set:function(x){o=x}});var i="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return i},set:function(x){i=x}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(x){l=x}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(x){c=x}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/pR:d},set:function(x){d=x}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(x){u=x}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof OS||this instanceof Sh))return UE(f,this.objId,this.scope)},set:function(x){x=x.toString(),f=x}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Qo==0?UE(h,this.objId,this.scope):h},set:function(x){x=x.toString(),h=this instanceof Qo==0?x.substr(0,1)==="("?xv(x.substr(1,x.length-2)):xv(x):x}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Qo==1?xv(h.substr(1,h.length-1)):h},set:function(x){x=x.toString(),h=this instanceof Qo==1?"/"+x:x}});var m=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(m)return m},set:function(x){this.V=x}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof Qo==0?UE(m,this.objId,this.scope):m},set:function(x){x=x.toString(),m=this instanceof Qo==0?x.substr(0,1)==="("?xv(x.substr(1,x.length-2)):xv(x):x}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Qo==1?xv(m.substr(1,m.length-1)):m},set:function(x){x=x.toString(),m=this instanceof Qo==1?"/"+x:x}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var v,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(x){x=!!x,g=x}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(v)return v},set:function(x){v=x}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!jo(this.Ff,1)},set:function(x){x?this.Ff=_o(this.Ff,1):this.Ff=No(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!jo(this.Ff,2)},set:function(x){x?this.Ff=_o(this.Ff,2):this.Ff=No(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!jo(this.Ff,3)},set:function(x){x?this.Ff=_o(this.Ff,3):this.Ff=No(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(x){if([0,1,2].indexOf(x)===-1)throw new Error('Invalid value "'+x+'" for attribute Q supplied.');y=x}}),Object.defineProperty(this,"textAlign",{get:function(){var x;switch(y){case 0:default:x="left";break;case 1:x="center";break;case 2:x="right"}return x},configurable:!0,enumerable:!0,set:function(x){switch(x){case"right":case 2:y=2;break;case"center":case 1:y=1;break;default:y=0}}})};uc(_u,Ku);var ag=function(){_u.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return uae(t,this.objId,this.scope)},set:function(r){var n,s;s=[],typeof(n=r)=="string"&&(s=function(o,i,l){l||(l=1);for(var c,d=[];c=i.exec(o);)d.push(c[l]);return d}(n,/\((.*?)\)/g)),t=s}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!jo(this.Ff,18)},set:function(r){r?this.Ff=_o(this.Ff,18):this.Ff=No(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!jo(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=_o(this.Ff,19):this.Ff=No(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!jo(this.Ff,20)},set:function(r){r?(this.Ff=_o(this.Ff,20),t.sort()):this.Ff=No(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!jo(this.Ff,22)},set:function(r){r?this.Ff=_o(this.Ff,22):this.Ff=No(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!jo(this.Ff,23)},set:function(r){r?this.Ff=_o(this.Ff,23):this.Ff=No(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!jo(this.Ff,27)},set:function(r){r?this.Ff=_o(this.Ff,27):this.Ff=No(this.Ff,27)}}),this.hasAppearanceStream=!1};uc(ag,_u);var sg=function(){ag.call(this),this.fontName="helvetica",this.combo=!1};uc(sg,ag);var og=function(){sg.call(this),this.combo=!0};uc(og,sg);var Ab=function(){og.call(this),this.edit=!0};uc(Ab,og);var Qo=function(){_u.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!jo(this.Ff,15)},set:function(r){r?this.Ff=_o(this.Ff,15):this.Ff=No(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!jo(this.Ff,16)},set:function(r){r?this.Ff=_o(this.Ff,16):this.Ff=No(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!jo(this.Ff,17)},set:function(r){r?this.Ff=_o(this.Ff,17):this.Ff=No(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!jo(this.Ff,26)},set:function(r){r?this.Ff=_o(this.Ff,26):this.Ff=No(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(o){return o};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,s=[];for(n in s.push("<<"),t)s.push("/"+n+" ("+Hg(r(t[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(r){Da(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};uc(Qo,_u);var Eb=function(){Qo.call(this),this.pushButton=!0};uc(Eb,Qo);var ig=function(){Qo.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};uc(ig,Qo);var OS=function(){var e,t;_u.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(s){e=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(s){t=s}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(l){return l};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var o,i=[];for(o in i.push("<<"),n)i.push("/"+o+" ("+Hg(s(n[o]))+")");return i.push(">>"),i.join(`
`)},set:function(s){Da(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(s){r="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=En.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};uc(OS,_u),ig.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},ig.prototype.createOption=function(e){var t=new OS;return t.Parent=this,t.optionName=e,this.Kids.push(t),kQe.call(this.scope,t),t};var kb=function(){Qo.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=En.CheckBox.createAppearanceStream()};uc(kb,Qo);var Sh=function(){_u.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!jo(this.Ff,13)},set:function(t){t?this.Ff=_o(this.Ff,13):this.Ff=No(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!jo(this.Ff,21)},set:function(t){t?this.Ff=_o(this.Ff,21):this.Ff=No(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!jo(this.Ff,23)},set:function(t){t?this.Ff=_o(this.Ff,23):this.Ff=No(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!jo(this.Ff,24)},set:function(t){t?this.Ff=_o(this.Ff,24):this.Ff=No(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!jo(this.Ff,25)},set:function(t){t?this.Ff=_o(this.Ff,25):this.Ff=No(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!jo(this.Ff,26)},set:function(t){t?this.Ff=_o(this.Ff,26):this.Ff=No(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};uc(Sh,_u);var Ib=function(){Sh.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!jo(this.Ff,14)},set:function(e){e?this.Ff=_o(this.Ff,14):this.Ff=No(this.Ff,14)}}),this.password=!0};uc(Ib,Sh);var En={CheckBox:{createAppearanceStream:function(){return{N:{On:En.CheckBox.YesNormal},D:{On:En.CheckBox.YesPushDown,Off:En.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Mu(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,s=e.scope.__private__.encodeColorString(e.color),o=r3(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+ha(En.internal.getWidth(e))+" "+ha(En.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+ha(o.fontSize)+" Tf "+s),r.push("BT"),r.push(o.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=Mu(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),s=[],o=En.internal.getHeight(e),i=En.internal.getWidth(e),l=r3(e,e.caption);return s.push("1 g"),s.push("0 0 "+ha(i)+" "+ha(o)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+ha(i-1)+" "+ha(o-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+r+" "+ha(l.fontSize)+" Tf "+n),s.push(l.text),s.push("ET"),s.push("Q"),t.stream=s.join(`
`),t},OffPushDown:function(e){var t=Mu(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ha(En.internal.getWidth(e))+" "+ha(En.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:En.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=En.RadioButton.Circle.YesNormal,t.D[e]=En.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Mu(e);t.scope=e.scope;var r=[],n=En.internal.getWidth(e)<=En.internal.getHeight(e)?En.internal.getWidth(e)/4:En.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=En.internal.Bezier_C,o=Number((n*s).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Am(En.internal.getWidth(e)/2)+" "+Am(En.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Mu(e);t.scope=e.scope;var r=[],n=En.internal.getWidth(e)<=En.internal.getHeight(e)?En.internal.getWidth(e)/4:En.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),o=Number((s*En.internal.Bezier_C).toFixed(5)),i=Number((n*En.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Am(En.internal.getWidth(e)/2)+" "+Am(En.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+o+" "+o+" "+s+" 0 "+s+" c"),r.push("-"+o+" "+s+" -"+s+" "+o+" -"+s+" 0 c"),r.push("-"+s+" -"+o+" -"+o+" -"+s+" 0 -"+s+" c"),r.push(o+" -"+s+" "+s+" -"+o+" "+s+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Am(En.internal.getWidth(e)/2)+" "+Am(En.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=Mu(e);t.scope=e.scope;var r=[],n=En.internal.getWidth(e)<=En.internal.getHeight(e)?En.internal.getWidth(e)/4:En.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),o=Number((s*En.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Am(En.internal.getWidth(e)/2)+" "+Am(En.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+o+" "+o+" "+s+" 0 "+s+" c"),r.push("-"+o+" "+s+" -"+s+" "+o+" -"+s+" 0 c"),r.push("-"+s+" -"+o+" -"+o+" -"+s+" 0 -"+s+" c"),r.push(o+" -"+s+" "+s+" -"+o+" "+s+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:En.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=En.RadioButton.Cross.YesNormal,t.D[e]=En.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Mu(e);t.scope=e.scope;var r=[],n=En.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+ha(En.internal.getWidth(e)-2)+" "+ha(En.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(ha(n.x1.x)+" "+ha(n.x1.y)+" m"),r.push(ha(n.x2.x)+" "+ha(n.x2.y)+" l"),r.push(ha(n.x4.x)+" "+ha(n.x4.y)+" m"),r.push(ha(n.x3.x)+" "+ha(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Mu(e);t.scope=e.scope;var r=En.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+ha(En.internal.getWidth(e))+" "+ha(En.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+ha(En.internal.getWidth(e)-2)+" "+ha(En.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(ha(r.x1.x)+" "+ha(r.x1.y)+" m"),n.push(ha(r.x2.x)+" "+ha(r.x2.y)+" l"),n.push(ha(r.x4.x)+" "+ha(r.x4.y)+" m"),n.push(ha(r.x3.x)+" "+ha(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=Mu(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ha(En.internal.getWidth(e))+" "+ha(En.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};En.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=En.internal.getWidth(e),r=En.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},En.internal.getWidth=function(e){var t=0;return Da(e)==="object"&&(t=T9(e.Rect[2])),t},En.internal.getHeight=function(e){var t=0;return Da(e)==="object"&&(t=T9(e.Rect[3])),t};var kQe=lo.addField=function(e){if(EQe(this,e),!(e instanceof _u))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};lo.AcroFormChoiceField=ag,lo.AcroFormListBox=sg,lo.AcroFormComboBox=og,lo.AcroFormEditBox=Ab,lo.AcroFormButton=Qo,lo.AcroFormPushButton=Eb,lo.AcroFormRadioButton=ig,lo.AcroFormCheckBox=kb,lo.AcroFormTextField=Sh,lo.AcroFormPasswordField=Ib,lo.AcroFormAppearance=En,lo.AcroForm={ChoiceField:ag,ListBox:sg,ComboBox:og,EditBox:Ab,Button:Qo,PushButton:Eb,RadioButton:ig,CheckBox:kb,TextField:Sh,PasswordField:Ib,Appearance:En},Ln.AcroForm={ChoiceField:ag,ListBox:sg,ComboBox:og,EditBox:Ab,Button:Qo,PushButton:Eb,RadioButton:ig,CheckBox:kb,TextField:Sh,PasswordField:Ib,Appearance:En};var IQe=Ln.AcroForm;function hae(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=e.__addimage__.getImageFileTypeByImageData=function(O,I){var M,D,U,z,W,$=r;if((I=I||r)==="RGBA"||O.data!==void 0&&O.data instanceof Uint8ClampedArray&&"height"in O&&"width"in O)return"RGBA";if(S(O))for(W in n)for(U=n[W],M=0;M<U.length;M+=1){for(z=!0,D=0;D<U[M].length;D+=1)if(U[M][D]!==void 0&&U[M][D]!==O[D]){z=!1;break}if(z===!0){$=W;break}}else for(W in n)for(U=n[W],M=0;M<U.length;M+=1){for(z=!0,D=0;D<U[M].length;D+=1)if(U[M][D]!==void 0&&U[M][D]!==O.charCodeAt(D)){z=!1;break}if(z===!0){$=W;break}}return $===r&&I!==r&&($=I),$},o=function O(I){for(var M=this.internal.write,D=this.internal.putStream,U=(0,this.internal.getFilters)();U.indexOf("FlateEncode")!==-1;)U.splice(U.indexOf("FlateEncode"),1);I.objectId=this.internal.newObject();var z=[];if(z.push({key:"Type",value:"/XObject"}),z.push({key:"Subtype",value:"/Image"}),z.push({key:"Width",value:I.width}),z.push({key:"Height",value:I.height}),I.colorSpace===x.INDEXED?z.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(I.palette.length/3-1)+" "+("sMask"in I&&I.sMask!==void 0?I.objectId+2:I.objectId+1)+" 0 R]"}):(z.push({key:"ColorSpace",value:"/"+I.colorSpace}),I.colorSpace===x.DEVICE_CMYK&&z.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),z.push({key:"BitsPerComponent",value:I.bitsPerComponent}),"decodeParameters"in I&&I.decodeParameters!==void 0&&z.push({key:"DecodeParms",value:"<<"+I.decodeParameters+">>"}),"transparency"in I&&Array.isArray(I.transparency)&&I.transparency.length>0){for(var W="",$=0,X=I.transparency.length;$<X;$++)W+=I.transparency[$]+" "+I.transparency[$]+" ";z.push({key:"Mask",value:"["+W+"]"})}I.sMask!==void 0&&z.push({key:"SMask",value:I.objectId+1+" 0 R"});var ye=I.filter!==void 0?["/"+I.filter]:void 0;if(D({data:I.data,additionalKeyValues:z,alreadyAppliedFilters:ye,objectId:I.objectId}),M("endobj"),"sMask"in I&&I.sMask!==void 0){var Se,V=(Se=I.sMaskBitsPerComponent)!==null&&Se!==void 0?Se:I.bitsPerComponent,B={width:I.width,height:I.height,colorSpace:"DeviceGray",bitsPerComponent:V,data:I.sMask};"filter"in I&&(B.decodeParameters="/Predictor ".concat(I.predictor," /Colors 1 /BitsPerComponent ").concat(V," /Columns ").concat(I.width),B.filter=I.filter),O.call(this,B)}if(I.colorSpace===x.INDEXED){var Q=this.internal.newObject();D({data:P(new Uint8Array(I.palette)),objectId:Q}),M("endobj")}},i=function(){var O=this.internal.collections[t+"images"];for(var I in O)o.call(this,O[I])},l=function(){var O,I=this.internal.collections[t+"images"],M=this.internal.write;for(var D in I)M("/I"+(O=I[D]).index,O.objectId,"0","R")},c=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",l))},d=function(){var O=this.internal.collections[t+"images"];return c.call(this),O},u=function(){return Object.keys(this.internal.collections[t+"images"]).length},f=function(O){return typeof e["process"+O.toUpperCase()]=="function"},h=function(O){return Da(O)==="object"&&O.nodeType===1},m=function(O,I){if(O.nodeName==="IMG"&&O.hasAttribute("src")){var M=""+O.getAttribute("src");if(M.indexOf("data:image/")===0)return g_(unescape(M).split("base64,").pop());var D=e.loadFile(M,!0);if(D!==void 0)return D}if(O.nodeName==="CANVAS"){if(O.width===0||O.height===0)throw new Error("Given canvas must have data. Canvas width: "+O.width+", height: "+O.height);var U;switch(I){case"PNG":U="image/png";break;case"WEBP":U="image/webp";break;default:U="image/jpeg"}return g_(O.toDataURL(U,1).split("base64,").pop())}},v=function(O){var I=this.internal.collections[t+"images"];if(I){for(var M in I)if(O===I[M].alias)return I[M]}},g=function(O,I,M){return O||I||(O=-96,I=-96),O<0&&(O=-1*M.width*72/O/this.internal.scaleFactor),I<0&&(I=-1*M.height*72/I/this.internal.scaleFactor),O===0&&(O=I*M.width/M.height),I===0&&(I=O*M.height/M.width),[O,I]},y=function(O,I,M,D,U,z){var W=g.call(this,M,D,U),$=this.internal.getCoordinateString,X=this.internal.getVerticalCoordinateString,ye=d.call(this);if(M=W[0],D=W[1],ye[U.index]=U,z){z*=Math.PI/180;var Se=Math.cos(z),V=Math.sin(z),B=function(pe){return pe.toFixed(4)},Q=[B(Se),B(V),B(-1*V),B(Se),0,0,"cm"]}this.internal.write("q"),z?(this.internal.write([1,"0","0",1,$(O),X(I+D),"cm"].join(" ")),this.internal.write(Q.join(" ")),this.internal.write([$(M),"0","0",$(D),"0","0","cm"].join(" "))):this.internal.write([$(M),"0","0",$(D),$(O),X(I+D),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+U.index+" Do"),this.internal.write("Q")},x=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var b=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=e.__addimage__.sHashCode=function(O){var I,M,D=0;if(typeof O=="string")for(M=O.length,I=0;I<M;I++)D=(D<<5)-D+O.charCodeAt(I),D|=0;else if(S(O))for(M=O.byteLength/2,I=0;I<M;I++)D=(D<<5)-D+O[I],D|=0;return D},j=e.__addimage__.validateStringAsBase64=function(O){(O=O||"").toString().trim();var I=!0;return O.length===0&&(I=!1),O.length%4!=0&&(I=!1),/^[A-Za-z0-9+/]+$/.test(O.substr(0,O.length-2))===!1&&(I=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(O.substr(-2))===!1&&(I=!1),I},_=e.__addimage__.extractImageFromDataUrl=function(O){if(O==null||!(O=O.trim()).startsWith("data:"))return null;var I=O.indexOf(",");return I<0?null:O.substring(0,I).trim().endsWith("base64")?O.substring(I+1):null};e.__addimage__.isArrayBuffer=function(O){return O instanceof ArrayBuffer};var S=e.__addimage__.isArrayBufferView=function(O){return O instanceof Int8Array||O instanceof Uint8Array||O instanceof Uint8ClampedArray||O instanceof Int16Array||O instanceof Uint16Array||O instanceof Int32Array||O instanceof Uint32Array||O instanceof Float32Array||O instanceof Float64Array},C=e.__addimage__.binaryStringToUint8Array=function(O){for(var I=O.length,M=new Uint8Array(I),D=0;D<I;D++)M[D]=O.charCodeAt(D);return M},P=e.__addimage__.arrayBufferToBinaryString=function(O){for(var I="",M=S(O)?O:new Uint8Array(O),D=0;D<M.length;D+=8192)I+=String.fromCharCode.apply(null,M.subarray(D,D+8192));return I};e.addImage=function(){var O,I,M,D,U,z,W,$,X;if(typeof arguments[1]=="number"?(I=r,M=arguments[1],D=arguments[2],U=arguments[3],z=arguments[4],W=arguments[5],$=arguments[6],X=arguments[7]):(I=arguments[1],M=arguments[2],D=arguments[3],U=arguments[4],z=arguments[5],W=arguments[6],$=arguments[7],X=arguments[8]),Da(O=arguments[0])==="object"&&!h(O)&&"imageData"in O){var ye=O;O=ye.imageData,I=ye.format||I||r,M=ye.x||M||0,D=ye.y||D||0,U=ye.w||ye.width||U,z=ye.h||ye.height||z,W=ye.alias||W,$=ye.compression||$,X=ye.rotation||ye.angle||X}var Se=this.internal.getFilters();if($===void 0&&Se.indexOf("FlateEncode")!==-1&&($="SLOW"),isNaN(M)||isNaN(D))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var V=A.call(this,O,I,W,$);return y.call(this,M,D,U,z,V,X),this};var A=function(O,I,M,D){var U,z,W;if(typeof O=="string"&&s(O)===r){O=unescape(O);var $=R(O,!1);($!==""||($=e.loadFile(O,!0))!==void 0)&&(O=$)}if(h(O)&&(O=m(O,I)),I=s(O,I),!f(I))throw new Error("addImage does not support files of type '"+I+"', please ensure that a plugin for '"+I+"' support is added.");if(((W=M)==null||W.length===0)&&(M=function(X){return typeof X=="string"||S(X)?w(X):S(X.data)?w(X.data):null}(O)),(U=v.call(this,M))||(O instanceof Uint8Array||I==="RGBA"||(z=O,O=C(O)),U=this["process"+I.toUpperCase()](O,u.call(this),M,function(X){return X&&typeof X=="string"&&(X=X.toUpperCase()),X in e.image_compression?X:b.NONE}(D),z)),!U)throw new Error("An unknown error occurred whilst processing the image.");return U},R=e.__addimage__.convertBase64ToBinaryString=function(O,I){I=typeof I!="boolean"||I;var M,D="";if(typeof O=="string"){var U;M=(U=_(O))!==null&&U!==void 0?U:O;try{D=g_(M)}catch(z){if(I)throw j(M)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+z.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return D};e.getImageProperties=function(O){var I,M,D="";if(h(O)&&(O=m(O)),typeof O=="string"&&s(O)===r&&((D=R(O,!1))===""&&(D=e.loadFile(O)||""),O=D),M=s(O),!f(M))throw new Error("addImage does not support files of type '"+M+"', please ensure that a plugin for '"+M+"' support is added.");if(O instanceof Uint8Array||(O=C(O)),!(I=this["process"+M.toUpperCase()](O)))throw new Error("An unknown error occurred whilst processing the image");return I.fileType=M,I}})(Ln.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Ln.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,s,o,i=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),d=r.pageContext.annotations,u=!1,f=0;f<d.length&&!u;f++)switch((n=d[f]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var h=0;h<d.length;h++){n=d[h];var m=this.internal.pdfEscape,v=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(g.objId),b=n.title||"Note";o="<</Type /Annot /Subtype /Text "+(s="/Rect ["+i(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+m(x(n.contents))+")",o+=" /Popup "+y.objId+" 0 R",o+=" /P "+c.objId+" 0 R",o+=" /T ("+m(x(b))+") >>",g.content=o;var w=g.objId+" 0 R";o="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+i(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+w,n.open&&(o+=" /Open true"),o+=" >>",y.content=o,this.internal.write(g.objId,"0 R",y.objId,"0 R");break;case"freetext":s="/Rect ["+i(n.bounds.x)+" "+l(n.bounds.y)+" "+i(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var j=n.color||"#000000";o="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+m(v(n.contents))+")",o+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+j+")",o+=" /Border [0 0 0]",o+=" >>",this.internal.write(o);break;case"link":if(n.options.name){var _=this.annotations._nameMap[n.options.name];n.options.pageNumber=_.page,n.options.top=_.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",o="",n.options.url)o="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+m(v(n.options.url))+") >>";else if(n.options.pageNumber)switch(o="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":o+=" /Fit]";break;case"FitH":o+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,o+=" /FitV "+n.options.left+"]";break;default:var S=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),o+=" /XYZ "+n.options.left+" "+S+" "+n.options.zoom+"]"}o!=""&&(o+=" >>",this.internal.write(o))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,s,o,i){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:d(n),w:c(r+s),h:d(n+o)},options:i,type:"link"})},e.textWithLink=function(r,n,s,o){var i,l,c=this.getTextWidth(r),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(o.maxWidth!==void 0){l=o.maxWidth;var u=this.splitTextToSize(r,l).length;i=Math.ceil(d*u)}else l=c,i=d;return this.text(r,n,s,o),s+=.2*d,o.align==="center"&&(n-=c/2),o.align==="right"&&(n-=c),this.link(n,s-d,l,i,o),c},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(Ln.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];e.__arabicParser__={};var o=e.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},i=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},l=e.__arabicParser__.isArabicEndLetter=function(g){return i(g)&&o(g)&&t[g.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(g){return i(g)&&s.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return i(g)&&o(g)&&t[g.charCodeAt(0)].length>=1};var d=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return i(g)&&o(g)&&t[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return i(g)&&o(g)&&t[g.charCodeAt(0)].length>=3};var u=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return i(g)&&o(g)&&t[g.charCodeAt(0)].length==4},f=e.__arabicParser__.resolveLigatures=function(g){var y=0,x=r,b="",w=0;for(y=0;y<g.length;y+=1)x[g.charCodeAt(y)]!==void 0?(w++,typeof(x=x[g.charCodeAt(y)])=="number"&&(b+=String.fromCharCode(x),x=r,w=0),y===g.length-1&&(x=r,b+=g.charAt(y-(w-1)),y-=w-1,w=0)):(x=r,b+=g.charAt(y-w),y-=w,w=0);return b};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var h=e.__arabicParser__.getCorrectForm=function(g,y,x){return i(g)?o(g)===!1?-1:!d(g)||!i(y)&&!i(x)||!i(x)&&l(y)||l(g)&&!i(y)||l(g)&&c(y)||l(g)&&l(y)?0:u(g)&&i(y)&&!l(y)&&i(x)&&d(x)?3:l(g)||!i(x)?1:2:-1},m=function(g){var y=0,x=0,b=0,w="",j="",_="",S=(g=g||"").split("\\s+"),C=[];for(y=0;y<S.length;y+=1){for(C.push(""),x=0;x<S[y].length;x+=1)w=S[y][x],j=S[y][x-1],_=S[y][x+1],i(w)?(b=h(w,j,_),C[y]+=b!==-1?String.fromCharCode(t[w.charCodeAt(0)][b]):w):C[y]+=w;C[y]=f(C[y])}return C.join(" ")},v=e.__arabicParser__.processArabic=e.processArabic=function(){var g,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,x=[];if(Array.isArray(y)){var b=0;for(x=[],b=0;b<y.length;b+=1)Array.isArray(y[b])?x.push([m(y[b][0]),y[b][1],y[b][2]]):x.push([m(y[b])]);g=x}else g=m(y);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",v])}(Ln.API),Ln.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(l){s=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var o=[];Object.defineProperty(this,"childNodes",{get:function(){return o},set:function(l){o=l}});var i={};Object.defineProperty(this,"style",{get:function(){return i},set:function(l){i=l}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var s;if((r=r||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Ln.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new o,this.internal.__cell__.pages=1},o=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(g){c=g}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var h=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var m=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return m},set:function(g){m=g}});var v=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return v},set:function(g){v=g}}),this};o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},o.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,d){n.call(this);var u=(d=d||{}).fontSize||this.getFontSize(),f=d.font||this.getFont(),h=d.scaleFactor||this.internal.scaleFactor,m=0,v=0,g=0,y=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var x=d.maxWidth;x>0?typeof c=="string"?c=this.splitTextToSize(c,x):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(w,j){return w.concat(y.splitTextToSize(j,x))},[])):c=Array.isArray(c)?c:[c];for(var b=0;b<c.length;b++)m<(g=this.getStringUnitWidth(c[b],{font:f})*u)&&(m=g);return m!==0&&(v=c.length),{w:m/=h,h:Math.max((v*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/h,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new o(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var i=e.cell=function(){var c;c=arguments[0]instanceof o?arguments[0]:new o(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var d=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,f=this.internal.__cell__.margins||t,h=this.internal.__cell__.tableHeaderRow,m=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===c.lineNumber?(c.x=(d.x||0)+(d.width||0),c.y=d.y||0):d.y+d.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,m&&h&&(this.printHeaderRow(c.lineNumber,!0),c.y+=h[0].height)):c.y=d.y+d.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-u,c.y+u,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+u,{align:"center",baseline:"top",maxWidth:c.width-u-u}):this.text(c.text,c.x+u,c.y+u,{align:"left",baseline:"top",maxWidth:c.width-u-u})),this.internal.__cell__.lastCell=c,this};e.table=function(c,d,u,f,h){if(n.call(this),!u)throw new Error("No data for PDF table.");var m,v,g,y,x=[],b=[],w=[],j={},_={},S=[],C=[],P=(h=h||{}).autoSize||!1,A=h.printHeaders!==!1,R=h.css&&h.css["font-size"]!==void 0?16*h.css["font-size"]:h.fontSize||12,O=h.margins||Object.assign({width:this.getPageWidth()},t),I=typeof h.padding=="number"?h.padding:3,M=h.headerBackgroundColor||"#c8c8c8",D=h.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=A,this.internal.__cell__.margins=O,this.internal.__cell__.table_font_size=R,this.internal.__cell__.padding=I,this.internal.__cell__.headerBackgroundColor=M,this.internal.__cell__.headerTextColor=D,this.setFontSize(R),f==null)b=x=Object.keys(u[0]),w=x.map(function(){return"left"});else if(Array.isArray(f)&&Da(f[0])==="object")for(x=f.map(function(ye){return ye.name}),b=f.map(function(ye){return ye.prompt||ye.name||""}),w=f.map(function(ye){return ye.align||"left"}),m=0;m<f.length;m+=1)_[f[m].name]=.7499990551181103*f[m].width;else Array.isArray(f)&&typeof f[0]=="string"&&(b=x=f,w=x.map(function(){return"left"}));if(P||Array.isArray(f)&&typeof f[0]=="string")for(m=0;m<x.length;m+=1){for(j[y=x[m]]=u.map(function(ye){return ye[y]}),this.setFont(void 0,"bold"),S.push(this.getTextDimensions(b[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),v=j[y],this.setFont(void 0,"normal"),g=0;g<v.length;g+=1)S.push(this.getTextDimensions(v[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);_[y]=Math.max.apply(null,S)+I+I,S=[]}if(A){var U={};for(m=0;m<x.length;m+=1)U[x[m]]={},U[x[m]].text=b[m],U[x[m]].align=w[m];var z=l.call(this,U,_);C=x.map(function(ye){return new o(c,d,_[ye],z,U[ye].text,void 0,U[ye].align)}),this.setTableHeaderRow(C),this.printHeaderRow(1,!1)}var W=f.reduce(function(ye,Se){return ye[Se.name]=Se.align,ye},{});for(m=0;m<u.length;m+=1){"rowStart"in h&&h.rowStart instanceof Function&&h.rowStart({row:m,data:u[m]},this);var $=l.call(this,u[m],_);for(g=0;g<x.length;g+=1){var X=u[m][x[g]];"cellStart"in h&&h.cellStart instanceof Function&&h.cellStart({row:m,col:g,data:X},this),i.call(this,new o(c,d,_[x[g]],$,X,m+2,W[x[g]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=d,this};var l=function(c,d){var u=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,h=this.internal.scaleFactor;return Object.keys(c).map(function(m){var v=c[m];return this.splitTextToSize(v.hasOwnProperty("text")?v.text:v,d[m]-u-u)},this).map(function(m){return this.getLineHeightFactor()*m.length*f/h+u+u},this).reduce(function(m,v){return Math.max(m,v)},0)};e.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,d){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new o(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var h=[],m=0;m<this.internal.__cell__.tableHeaderRow.length;m+=1){u=this.internal.__cell__.tableHeaderRow[m].clone(),d&&(u.y=this.internal.__cell__.margins.top||0,h.push(u)),u.lineNumber=c;var v=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),i.call(this,u),this.setTextColor(v)}h.length>0&&this.setTableHeaderRow(h),this.setFont(void 0,"normal"),r=!1}}(Ln.API);var pae={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},gae=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],n3=hae(gae),vae=[100,200,300,400,500,600,700,800,900],OQe=hae(vae);function VE(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(o){return pae[o=o||"normal"]?o:"normal"}(e.style),n=function(o){return o?typeof o=="number"?o>=100&&o<=900&&o%100==0?o:400:/^\d00$/.test(o)?parseInt(o):o==="bold"?700:400:400}(e.weight),s=function(o){return typeof n3[o=o||"normal"]=="number"?o:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:s,src:e.src||[],ref:e.ref||{name:t,style:[s,r,n].join(" ")}}}function D9(e,t,r,n){var s;for(s=r;s>=0&&s<t.length;s+=n)if(e[t[s]])return e[t[s]];for(s=r;s>=0&&s<t.length;s-=n)if(e[t[s]])return e[t[s]]}var TQe={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},M9={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function R9(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function L9(e){return e.trimLeft()}function DQe(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function MQe(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var Ej,F9,$9,yv,kj,B9,q9,z9,WE=["times"];function U9(e,t,r,n,s){var o=4,i=W9;switch(s){case Ln.API.image_compression.FAST:o=1,i=V9;break;case Ln.API.image_compression.MEDIUM:o=6,i=H9;break;case Ln.API.image_compression.SLOW:o=9,i=G9}e=function(c,d,u,f){for(var h,m=c.length/d,v=new Uint8Array(c.length+m),g=[RQe,V9,W9,H9,G9],y=0;y<m;y+=1){var x=y*d,b=c.subarray(x,x+d);if(f)v.set(f(b,u,h),x+y);else{for(var w=g.length,j=[],_=0;_<w;_+=1)j[_]=g[_](b,u,h);var S=FQe(j.concat());v.set(j[S],x+y)}h=b}return v}(e,t,Math.ceil(r*n/8),i);var l=VT(e,{level:o});return Ln.API.__addimage__.arrayBufferToBinaryString(l)}function RQe(e){var t=Array.apply([],e);return t.unshift(0),t}function V9(e,t){var r=e.length,n=[];n[0]=1;for(var s=0;s<r;s+=1){var o=e[s-t]||0;n[s+1]=e[s]-o+256&255}return n}function W9(e,t,r){var n=e.length,s=[];s[0]=2;for(var o=0;o<n;o+=1){var i=r&&r[o]||0;s[o+1]=e[o]-i+256&255}return s}function H9(e,t,r){var n=e.length,s=[];s[0]=3;for(var o=0;o<n;o+=1){var i=e[o-t]||0,l=r&&r[o]||0;s[o+1]=e[o]+256-(i+l>>>1)&255}return s}function G9(e,t,r){var n=e.length,s=[];s[0]=4;for(var o=0;o<n;o+=1){var i=LQe(e[o-t]||0,r&&r[o]||0,r&&r[o-t]||0);s[o+1]=e[o]-i+256&255}return s}function LQe(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),s=Math.abs(e-r),o=Math.abs(e+t-r-r);return n<=s&&n<=o?e:s<=o?t:r}function FQe(e){var t=e.map(function(r){return r.reduce(function(n,s){return n+Math.abs(s)},0)});return t.indexOf(Math.min.apply(null,t))}function HE(e,t,r){var n=t*r,s=Math.floor(n/8),o=16-(n-8*s+r),i=(1<<r)-1;return xae(e,s)>>o&i}function K9(e,t,r,n){var s=r*n,o=Math.floor(s/8),i=16-(s-8*o+n),l=(1<<n)-1,c=(t&l)<<i;(function(d,u,f){if(u+1<d.byteLength)d.setUint16(u,f,!1);else{var h=f>>8&255;d.setUint8(u,h)}})(e,o,xae(e,o)&~(l<<i)&65535|c)}function xae(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function $Qe(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,s=e[t++],o=s>>7,i=1<<1+(7&s);e[t++],e[t++];var l=null,c=null;o&&(l=t,c=i,t+=3*i);var d=!0,u=[],f=0,h=null,m=0,v=null;for(this.width=r,this.height=n;d&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,v=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((O=e[t++])>=0))throw Error("Invalid block size");if(O===0)break;t+=O}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[t++];f=e[t++]|e[t++]<<8,h=e[t++],1&g||(h=null),m=g>>2&7,t++;break;case 254:for(;;){if(!((O=e[t++])>=0))throw Error("Invalid block size");if(O===0)break;t+=O}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var y=e[t++]|e[t++]<<8,x=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,j=e[t++],_=j>>6&1,S=1<<1+(7&j),C=l,P=c,A=!1;j>>7&&(A=!0,C=t,P=S,t+=3*S);var R=t;for(t++;;){var O;if(!((O=e[t++])>=0))throw Error("Invalid block size");if(O===0)break;t+=O}u.push({x:y,y:x,width:b,height:w,has_local_palette:A,palette_offset:C,palette_size:P,data_offset:R,data_length:t-R,transparent_index:h,interlaced:!!_,delay:f,disposal:m});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return v},this.frameInfo=function(I){if(I<0||I>=u.length)throw new Error("Frame index out of range.");return u[I]},this.decodeAndBlitFrameBGRA=function(I,M){var D=this.frameInfo(I),U=D.width*D.height,z=new Uint8Array(U);X9(e,D.data_offset,z,U);var W=D.palette_offset,$=D.transparent_index;$===null&&($=256);var X=D.width,ye=r-X,Se=X,V=4*(D.y*r+D.x),B=4*((D.y+D.height)*r+D.x),Q=V,pe=4*ye;D.interlaced===!0&&(pe+=4*r*7);for(var te=8,Y=0,ce=z.length;Y<ce;++Y){var me=z[Y];if(Se===0&&(Se=X,(Q+=pe)>=B&&(pe=4*ye+4*r*(te-1),Q=V+(X+ye)*(te<<1),te>>=1)),me===$)Q+=4;else{var ae=e[W+3*me],le=e[W+3*me+1],ue=e[W+3*me+2];M[Q++]=ue,M[Q++]=le,M[Q++]=ae,M[Q++]=255}--Se}},this.decodeAndBlitFrameRGBA=function(I,M){var D=this.frameInfo(I),U=D.width*D.height,z=new Uint8Array(U);X9(e,D.data_offset,z,U);var W=D.palette_offset,$=D.transparent_index;$===null&&($=256);var X=D.width,ye=r-X,Se=X,V=4*(D.y*r+D.x),B=4*((D.y+D.height)*r+D.x),Q=V,pe=4*ye;D.interlaced===!0&&(pe+=4*r*7);for(var te=8,Y=0,ce=z.length;Y<ce;++Y){var me=z[Y];if(Se===0&&(Se=X,(Q+=pe)>=B&&(pe=4*ye+4*r*(te-1),Q=V+(X+ye)*(te<<1),te>>=1)),me===$)Q+=4;else{var ae=e[W+3*me],le=e[W+3*me+1],ue=e[W+3*me+2];M[Q++]=ae,M[Q++]=le,M[Q++]=ue,M[Q++]=255}--Se}}}function X9(e,t,r,n){for(var s=e[t++],o=1<<s,i=o+1,l=i+1,c=s+1,d=(1<<c)-1,u=0,f=0,h=0,m=e[t++],v=new Int32Array(4096),g=null;;){for(;u<16&&m!==0;)f|=e[t++]<<u,u+=8,m===1?m=e[t++]:--m;if(u<c)break;var y=f&d;if(f>>=c,u-=c,y!==o){if(y===i)break;for(var x=y<l?y:g,b=0,w=x;w>o;)w=v[w]>>8,++b;var j=w;if(h+b+(x!==y?1:0)>n)return void gs.log("Warning, gif stream longer than expected.");r[h++]=j;var _=h+=b;for(x!==y&&(r[h++]=j),w=x;b--;)w=v[w],r[--_]=255&w,w>>=8;g!==null&&l<4096&&(v[l++]=g<<8|j,l>=d+1&&c<12&&(++c,d=d<<1|1)),g=y}else l=i+1,d=(1<<(c=s+1))-1,g=null}return h!==n&&gs.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function GE(e){var t,r,n,s,o,i=Math.floor,l=new Array(64),c=new Array(64),d=new Array(64),u=new Array(64),f=new Array(65535),h=new Array(65535),m=new Array(64),v=new Array(64),g=[],y=0,x=7,b=new Array(64),w=new Array(64),j=new Array(64),_=new Array(256),S=new Array(2048),C=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],P=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],A=[0,1,2,3,4,5,6,7,8,9,10,11],R=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],O=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],I=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],M=[0,1,2,3,4,5,6,7,8,9,10,11],D=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],U=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function z(V,B){for(var Q=0,pe=0,te=new Array,Y=1;Y<=16;Y++){for(var ce=1;ce<=V[Y];ce++)te[B[pe]]=[],te[B[pe]][0]=Q,te[B[pe]][1]=Y,pe++,Q++;Q*=2}return te}function W(V){for(var B=V[0],Q=V[1]-1;Q>=0;)B&1<<Q&&(y|=1<<x),Q--,--x<0&&(y==255?($(255),$(0)):$(y),x=7,y=0)}function $(V){g.push(V)}function X(V){$(V>>8&255),$(255&V)}function ye(V,B,Q,pe,te){for(var Y,ce=te[0],me=te[240],ae=function(xt,Ze){var ht,Wt,be,Ct,wt,Ge,Je,_e,je,Ue,ze=0;for(je=0;je<8;++je){ht=xt[ze],Wt=xt[ze+1],be=xt[ze+2],Ct=xt[ze+3],wt=xt[ze+4],Ge=xt[ze+5],Je=xt[ze+6];var or=ht+(_e=xt[ze+7]),tr=ht-_e,Nt=Wt+Je,yr=Wt-Je,Me=be+Ge,dt=be-Ge,ut=Ct+wt,rr=Ct-wt,hr=or+ut,It=or-ut,dr=Nt+Me,ur=Nt-Me;xt[ze]=hr+dr,xt[ze+4]=hr-dr;var er=.707106781*(ur+It);xt[ze+2]=It+er,xt[ze+6]=It-er;var ln=.382683433*((hr=rr+dt)-(ur=yr+tr)),Mr=.5411961*hr+ln,Ye=1.306562965*ur+ln,$e=.707106781*(dr=dt+yr),Be=tr+$e,et=tr-$e;xt[ze+5]=et+Mr,xt[ze+3]=et-Mr,xt[ze+1]=Be+Ye,xt[ze+7]=Be-Ye,ze+=8}for(ze=0,je=0;je<8;++je){ht=xt[ze],Wt=xt[ze+8],be=xt[ze+16],Ct=xt[ze+24],wt=xt[ze+32],Ge=xt[ze+40],Je=xt[ze+48];var jt=ht+(_e=xt[ze+56]),yt=ht-_e,qt=Wt+Je,pt=Wt-Je,Dt=be+Ge,he=be-Ge,Qe=Ct+wt,zt=Ct-wt,Mt=jt+Qe,ir=jt-Qe,nr=qt+Dt,kr=qt-Dt;xt[ze]=Mt+nr,xt[ze+32]=Mt-nr;var Ft=.707106781*(kr+ir);xt[ze+16]=ir+Ft,xt[ze+48]=ir-Ft;var Dr=.382683433*((Mt=zt+he)-(kr=pt+yt)),Fr=.5411961*Mt+Dr,Tn=1.306562965*kr+Dr,nt=.707106781*(nr=he+pt),$t=yt+nt,Kt=yt-nt;xt[ze+40]=Kt+Fr,xt[ze+24]=Kt-Fr,xt[ze+8]=$t+Tn,xt[ze+56]=$t-Tn,ze++}for(je=0;je<64;++je)Ue=xt[je]*Ze[je],m[je]=Ue>0?Ue+.5|0:Ue-.5|0;return m}(V,B),le=0;le<64;++le)v[C[le]]=ae[le];var ue=v[0]-Q;Q=v[0],ue==0?W(pe[0]):(W(pe[h[Y=32767+ue]]),W(f[Y]));for(var Re=63;Re>0&&v[Re]==0;)Re--;if(Re==0)return W(ce),Q;for(var ne,ie=1;ie<=Re;){for(var gt=ie;v[ie]==0&&ie<=Re;)++ie;var bt=ie-gt;if(bt>=16){ne=bt>>4;for(var at=1;at<=ne;++at)W(me);bt&=15}Y=32767+v[ie],W(te[(bt<<4)+h[Y]]),W(f[Y]),ie++}return Re!=63&&W(ce),Q}function Se(V){V=Math.min(Math.max(V,1),100),o!=V&&(function(B){for(var Q=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],pe=0;pe<64;pe++){var te=i((Q[pe]*B+50)/100);te=Math.min(Math.max(te,1),255),l[C[pe]]=te}for(var Y=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ce=0;ce<64;ce++){var me=i((Y[ce]*B+50)/100);me=Math.min(Math.max(me,1),255),c[C[ce]]=me}for(var ae=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],le=0,ue=0;ue<8;ue++)for(var Re=0;Re<8;Re++)d[le]=1/(l[C[le]]*ae[ue]*ae[Re]*8),u[le]=1/(c[C[le]]*ae[ue]*ae[Re]*8),le++}(V<50?Math.floor(5e3/V):Math.floor(200-2*V)),o=V)}this.encode=function(V,B){B&&Se(B),g=new Array,y=0,x=7,X(65496),X(65504),X(16),$(74),$(70),$(73),$(70),$(0),$(1),$(1),$(0),X(1),X(1),$(0),$(0),function(){X(65499),X(132),$(0);for(var Wt=0;Wt<64;Wt++)$(l[Wt]);$(1);for(var be=0;be<64;be++)$(c[be])}(),function(Wt,be){X(65472),X(17),$(8),X(be),X(Wt),$(3),$(1),$(17),$(0),$(2),$(17),$(1),$(3),$(17),$(1)}(V.width,V.height),function(){X(65476),X(418),$(0);for(var Wt=0;Wt<16;Wt++)$(P[Wt+1]);for(var be=0;be<=11;be++)$(A[be]);$(16);for(var Ct=0;Ct<16;Ct++)$(R[Ct+1]);for(var wt=0;wt<=161;wt++)$(O[wt]);$(1);for(var Ge=0;Ge<16;Ge++)$(I[Ge+1]);for(var Je=0;Je<=11;Je++)$(M[Je]);$(17);for(var _e=0;_e<16;_e++)$(D[_e+1]);for(var je=0;je<=161;je++)$(U[je])}(),X(65498),X(12),$(3),$(1),$(0),$(2),$(17),$(3),$(17),$(0),$(63),$(0);var Q=0,pe=0,te=0;y=0,x=7,this.encode.displayName="_encode_";for(var Y,ce,me,ae,le,ue,Re,ne,ie,gt=V.data,bt=V.width,at=V.height,xt=4*bt,Ze=0;Ze<at;){for(Y=0;Y<xt;){for(le=xt*Ze+Y,Re=-1,ne=0,ie=0;ie<64;ie++)ue=le+(ne=ie>>3)*xt+(Re=4*(7&ie)),Ze+ne>=at&&(ue-=xt*(Ze+1+ne-at)),Y+Re>=xt&&(ue-=Y+Re-xt+4),ce=gt[ue++],me=gt[ue++],ae=gt[ue++],b[ie]=(S[ce]+S[me+256|0]+S[ae+512|0]>>16)-128,w[ie]=(S[ce+768|0]+S[me+1024|0]+S[ae+1280|0]>>16)-128,j[ie]=(S[ce+1280|0]+S[me+1536|0]+S[ae+1792|0]>>16)-128;Q=ye(b,d,Q,t,n),pe=ye(w,u,pe,r,s),te=ye(j,u,te,r,s),Y+=32}Ze+=8}if(x>=0){var ht=[];ht[1]=x+1,ht[0]=(1<<x+1)-1,W(ht)}return X(65497),new Uint8Array(g)},e=e||50,function(){for(var V=String.fromCharCode,B=0;B<256;B++)_[B]=V(B)}(),t=z(P,A),r=z(I,M),n=z(R,O),s=z(D,U),function(){for(var V=1,B=2,Q=1;Q<=15;Q++){for(var pe=V;pe<B;pe++)h[32767+pe]=Q,f[32767+pe]=[],f[32767+pe][1]=Q,f[32767+pe][0]=pe;for(var te=-(B-1);te<=-V;te++)h[32767+te]=Q,f[32767+te]=[],f[32767+te][1]=Q,f[32767+te][0]=B-1+te;V<<=1,B<<=1}}(),function(){for(var V=0;V<256;V++)S[V]=19595*V,S[V+256|0]=38470*V,S[V+512|0]=7471*V+32768,S[V+768|0]=-11059*V,S[V+1024|0]=-21709*V,S[V+1280|0]=32768*V+8421375,S[V+1536|0]=-27439*V,S[V+1792|0]=-5329*V}(),Se(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Kd(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Y9(e){function t(A){if(!A)throw Error("assert :P")}function r(A,R,O){for(var I=0;4>I;I++)if(A[R+I]!=O.charCodeAt(I))return!0;return!1}function n(A,R,O,I,M){for(var D=0;D<M;D++)A[R+D]=O[I+D]}function s(A,R,O,I){for(var M=0;M<I;M++)A[R+M]=O}function o(A){return new Int32Array(A)}function i(A,R){for(var O=[],I=0;I<A;I++)O.push(new R);return O}function l(A,R){var O=[];return function I(M,D,U){for(var z=U[D],W=0;W<z&&(M.push(U.length>D+1?[]:new R),!(U.length<D+1));W++)I(M[W],D+1,U)}(O,0,A),O}var c=function(){var A=this;function R(N,E){for(var q=1<<E-1>>>0;N&q;)q>>>=1;return q?(N&q-1)+q:N}function O(N,E,q,Z,xe){t(!(Z%q));do N[E+(Z-=q)]=xe;while(0<Z)}function I(N,E,q,Z,xe){if(t(2328>=xe),512>=xe)var Ne=o(512);else if((Ne=o(xe))==null)return 0;return function(Ae,Te,Fe,Ke,_t,Zt){var Xe,Tt,Ut=Te,wr=1<<Fe,Jt=o(16),Cr=o(16);for(t(_t!=0),t(Ke!=null),t(Ae!=null),t(0<Fe),Tt=0;Tt<_t;++Tt){if(15<Ke[Tt])return 0;++Jt[Ke[Tt]]}if(Jt[0]==_t)return 0;for(Cr[1]=0,Xe=1;15>Xe;++Xe){if(Jt[Xe]>1<<Xe)return 0;Cr[Xe+1]=Cr[Xe]+Jt[Xe]}for(Tt=0;Tt<_t;++Tt)Xe=Ke[Tt],0<Ke[Tt]&&(Zt[Cr[Xe]++]=Tt);if(Cr[15]==1)return(Ke=new M).g=0,Ke.value=Zt[0],O(Ae,Ut,1,wr,Ke),wr;var Ar,Hr=-1,Rr=wr-1,$n=0,An=1,ba=1,Mn=1<<Fe;for(Tt=0,Xe=1,_t=2;Xe<=Fe;++Xe,_t<<=1){if(An+=ba<<=1,0>(ba-=Jt[Xe]))return 0;for(;0<Jt[Xe];--Jt[Xe])(Ke=new M).g=Xe,Ke.value=Zt[Tt++],O(Ae,Ut+$n,_t,Mn,Ke),$n=R($n,Xe)}for(Xe=Fe+1,_t=2;15>=Xe;++Xe,_t<<=1){if(An+=ba<<=1,0>(ba-=Jt[Xe]))return 0;for(;0<Jt[Xe];--Jt[Xe]){if(Ke=new M,($n&Rr)!=Hr){for(Ut+=Mn,Ar=1<<(Hr=Xe)-Fe;15>Hr&&!(0>=(Ar-=Jt[Hr]));)++Hr,Ar<<=1;wr+=Mn=1<<(Ar=Hr-Fe),Ae[Te+(Hr=$n&Rr)].g=Ar+Fe,Ae[Te+Hr].value=Ut-Te-Hr}Ke.g=Xe-Fe,Ke.value=Zt[Tt++],O(Ae,Ut+($n>>Fe),_t,Mn,Ke),$n=R($n,Xe)}}return An!=2*Cr[15]-1?0:wr}(N,E,q,Z,xe,Ne)}function M(){this.value=this.g=0}function D(){this.value=this.g=0}function U(){this.G=i(5,M),this.H=o(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=i(yn,D)}function z(N,E,q,Z){t(N!=null),t(E!=null),t(2147483648>Z),N.Ca=254,N.I=0,N.b=-8,N.Ka=0,N.oa=E,N.pa=q,N.Jd=E,N.Yc=q+Z,N.Zc=4<=Z?q+Z-4+1:q,ce(N)}function W(N,E){for(var q=0;0<E--;)q|=ae(N,128)<<E;return q}function $(N,E){var q=W(N,E);return me(N)?-q:q}function X(N,E,q,Z){var xe,Ne=0;for(t(N!=null),t(E!=null),t(4294967288>Z),N.Sb=Z,N.Ra=0,N.u=0,N.h=0,4<Z&&(Z=4),xe=0;xe<Z;++xe)Ne+=E[q+xe]<<8*xe;N.Ra=Ne,N.bb=Z,N.oa=E,N.pa=q}function ye(N){for(;8<=N.u&&N.bb<N.Sb;)N.Ra>>>=8,N.Ra+=N.oa[N.pa+N.bb]<<ya-8>>>0,++N.bb,N.u-=8;pe(N)&&(N.h=1,N.u=0)}function Se(N,E){if(t(0<=E),!N.h&&E<=kn){var q=Q(N)&Zr[E];return N.u+=E,ye(N),q}return N.h=1,N.u=0}function V(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function B(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function Q(N){return N.Ra>>>(N.u&ya-1)>>>0}function pe(N){return t(N.bb<=N.Sb),N.h||N.bb==N.Sb&&N.u>ya}function te(N,E){N.u=E,N.h=pe(N)}function Y(N){N.u>=Ca&&(t(N.u>=Ca),ye(N))}function ce(N){t(N!=null&&N.oa!=null),N.pa<N.Zc?(N.I=(N.oa[N.pa++]|N.I<<8)>>>0,N.b+=8):(t(N!=null&&N.oa!=null),N.pa<N.Yc?(N.b+=8,N.I=N.oa[N.pa++]|N.I<<8):N.Ka?N.b=0:(N.I<<=8,N.b+=8,N.Ka=1))}function me(N){return W(N,1)}function ae(N,E){var q=N.Ca;0>N.b&&ce(N);var Z=N.b,xe=q*E>>>8,Ne=(N.I>>>Z>xe)+0;for(Ne?(q-=xe,N.I-=xe+1<<Z>>>0):q=xe+1,Z=q,xe=0;256<=Z;)xe+=8,Z>>=8;return Z=7^xe+ks[Z],N.b-=Z,N.Ca=(q<<Z)-1,Ne}function le(N,E,q){N[E+0]=q>>24&255,N[E+1]=q>>16&255,N[E+2]=q>>8&255,N[E+3]=255&q}function ue(N,E){return N[E+0]|N[E+1]<<8}function Re(N,E){return ue(N,E)|N[E+2]<<16}function ne(N,E){return ue(N,E)|ue(N,E+2)<<16}function ie(N,E){var q=1<<E;return t(N!=null),t(0<E),N.X=o(q),N.X==null?0:(N.Mb=32-E,N.Xa=E,1)}function gt(N,E){t(N!=null),t(E!=null),t(N.Xa==E.Xa),n(E.X,0,N.X,0,1<<E.Xa)}function bt(){this.X=[],this.Xa=this.Mb=0}function at(N,E,q,Z){t(q!=null),t(Z!=null);var xe=q[0],Ne=Z[0];return xe==0&&(xe=(N*Ne+E/2)/E),Ne==0&&(Ne=(E*xe+N/2)/N),0>=xe||0>=Ne?0:(q[0]=xe,Z[0]=Ne,1)}function xt(N,E){return N+(1<<E)-1>>>E}function Ze(N,E){return((4278255360&N)+(4278255360&E)>>>0&4278255360)+((16711935&N)+(16711935&E)>>>0&16711935)>>>0}function ht(N,E){A[E]=function(q,Z,xe,Ne,Ae,Te,Fe){var Ke;for(Ke=0;Ke<Ae;++Ke){var _t=A[N](Te[Fe+Ke-1],xe,Ne+Ke);Te[Fe+Ke]=Ze(q[Z+Ke],_t)}}}function Wt(){this.ud=this.hd=this.jd=0}function be(N,E){return((4278124286&(N^E))>>>1)+(N&E)>>>0}function Ct(N){return 0<=N&&256>N?N:0>N?0:255<N?255:void 0}function wt(N,E){return Ct(N+(N-E+.5>>1))}function Ge(N,E,q){return Math.abs(E-q)-Math.abs(N-q)}function Je(N,E,q,Z,xe,Ne,Ae){for(Z=Ne[Ae-1],q=0;q<xe;++q)Ne[Ae+q]=Z=Ze(N[E+q],Z)}function _e(N,E,q,Z,xe){var Ne;for(Ne=0;Ne<q;++Ne){var Ae=N[E+Ne],Te=Ae>>8&255,Fe=16711935&(Fe=(Fe=16711935&Ae)+((Te<<16)+Te));Z[xe+Ne]=(4278255360&Ae)+Fe>>>0}}function je(N,E){E.jd=255&N,E.hd=N>>8&255,E.ud=N>>16&255}function Ue(N,E,q,Z,xe,Ne){var Ae;for(Ae=0;Ae<Z;++Ae){var Te=E[q+Ae],Fe=Te>>>8,Ke=Te,_t=255&(_t=(_t=Te>>>16)+((N.jd<<24>>24)*(Fe<<24>>24)>>>5));Ke=255&(Ke=(Ke+=(N.hd<<24>>24)*(Fe<<24>>24)>>>5)+((N.ud<<24>>24)*(_t<<24>>24)>>>5)),xe[Ne+Ae]=(4278255360&Te)+(_t<<16)+Ke}}function ze(N,E,q,Z,xe){A[E]=function(Ne,Ae,Te,Fe,Ke,_t,Zt,Xe,Tt){for(Fe=Zt;Fe<Xe;++Fe)for(Zt=0;Zt<Tt;++Zt)Ke[_t++]=xe(Te[Z(Ne[Ae++])])},A[N]=function(Ne,Ae,Te,Fe,Ke,_t,Zt){var Xe=8>>Ne.b,Tt=Ne.Ea,Ut=Ne.K[0],wr=Ne.w;if(8>Xe)for(Ne=(1<<Ne.b)-1,wr=(1<<Xe)-1;Ae<Te;++Ae){var Jt,Cr=0;for(Jt=0;Jt<Tt;++Jt)Jt&Ne||(Cr=Z(Fe[Ke++])),_t[Zt++]=xe(Ut[Cr&wr]),Cr>>=Xe}else A["VP8LMapColor"+q](Fe,Ke,Ut,wr,_t,Zt,Ae,Te,Tt)}}function or(N,E,q,Z,xe){for(q=E+q;E<q;){var Ne=N[E++];Z[xe++]=Ne>>16&255,Z[xe++]=Ne>>8&255,Z[xe++]=255&Ne}}function tr(N,E,q,Z,xe){for(q=E+q;E<q;){var Ne=N[E++];Z[xe++]=Ne>>16&255,Z[xe++]=Ne>>8&255,Z[xe++]=255&Ne,Z[xe++]=Ne>>24&255}}function Nt(N,E,q,Z,xe){for(q=E+q;E<q;){var Ne=(Ae=N[E++])>>16&240|Ae>>12&15,Ae=240&Ae|Ae>>28&15;Z[xe++]=Ne,Z[xe++]=Ae}}function yr(N,E,q,Z,xe){for(q=E+q;E<q;){var Ne=(Ae=N[E++])>>16&248|Ae>>13&7,Ae=Ae>>5&224|Ae>>3&31;Z[xe++]=Ne,Z[xe++]=Ae}}function Me(N,E,q,Z,xe){for(q=E+q;E<q;){var Ne=N[E++];Z[xe++]=255&Ne,Z[xe++]=Ne>>8&255,Z[xe++]=Ne>>16&255}}function dt(N,E,q,Z,xe,Ne){if(Ne==0)for(q=E+q;E<q;)le(Z,((Ne=N[E++])[0]>>24|Ne[1]>>8&65280|Ne[2]<<8&16711680|Ne[3]<<24)>>>0),xe+=32;else n(Z,xe,N,E,q)}function ut(N,E){A[E][0]=A[N+"0"],A[E][1]=A[N+"1"],A[E][2]=A[N+"2"],A[E][3]=A[N+"3"],A[E][4]=A[N+"4"],A[E][5]=A[N+"5"],A[E][6]=A[N+"6"],A[E][7]=A[N+"7"],A[E][8]=A[N+"8"],A[E][9]=A[N+"9"],A[E][10]=A[N+"10"],A[E][11]=A[N+"11"],A[E][12]=A[N+"12"],A[E][13]=A[N+"13"],A[E][14]=A[N+"0"],A[E][15]=A[N+"0"]}function rr(N){return N==Vr||N==Wn||N==Na||N==ia}function hr(){this.eb=[],this.size=this.A=this.fb=0}function It(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function dr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new hr,this.f.kb=new It,this.sd=null}function ur(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function er(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ln(N){return alert("todo:WebPSamplerProcessPlane"),N.T}function Mr(N,E){var q=N.T,Z=E.ba.f.RGBA,xe=Z.eb,Ne=Z.fb+N.ka*Z.A,Ae=ci[E.ba.S],Te=N.y,Fe=N.O,Ke=N.f,_t=N.N,Zt=N.ea,Xe=N.W,Tt=E.cc,Ut=E.dc,wr=E.Mc,Jt=E.Nc,Cr=N.ka,Ar=N.ka+N.T,Hr=N.U,Rr=Hr+1>>1;for(Cr==0?Ae(Te,Fe,null,null,Ke,_t,Zt,Xe,Ke,_t,Zt,Xe,xe,Ne,null,null,Hr):(Ae(E.ec,E.fc,Te,Fe,Tt,Ut,wr,Jt,Ke,_t,Zt,Xe,xe,Ne-Z.A,xe,Ne,Hr),++q);Cr+2<Ar;Cr+=2)Tt=Ke,Ut=_t,wr=Zt,Jt=Xe,_t+=N.Rc,Xe+=N.Rc,Ne+=2*Z.A,Ae(Te,(Fe+=2*N.fa)-N.fa,Te,Fe,Tt,Ut,wr,Jt,Ke,_t,Zt,Xe,xe,Ne-Z.A,xe,Ne,Hr);return Fe+=N.fa,N.j+Ar<N.o?(n(E.ec,E.fc,Te,Fe,Hr),n(E.cc,E.dc,Ke,_t,Rr),n(E.Mc,E.Nc,Zt,Xe,Rr),q--):1&Ar||Ae(Te,Fe,null,null,Ke,_t,Zt,Xe,Ke,_t,Zt,Xe,xe,Ne+Z.A,null,null,Hr),q}function Ye(N,E,q){var Z=N.F,xe=[N.J];if(Z!=null){var Ne=N.U,Ae=E.ba.S,Te=Ae==Yt||Ae==Na;E=E.ba.f.RGBA;var Fe=[0],Ke=N.ka;Fe[0]=N.T,N.Kb&&(Ke==0?--Fe[0]:(--Ke,xe[0]-=N.width),N.j+N.ka+N.T==N.o&&(Fe[0]=N.o-N.j-Ke));var _t=E.eb;Ke=E.fb+Ke*E.A,N=o2(Z,xe[0],N.width,Ne,Fe,_t,Ke+(Te?0:3),E.A),t(q==Fe),N&&rr(Ae)&&vm(_t,Ke,Te,Ne,Fe,E.A)}return 0}function $e(N){var E=N.ma,q=E.ba.S,Z=11>q,xe=q==ft||q==Lt||q==Yt||q==Pr||q==12||rr(q);if(E.memory=null,E.Ib=null,E.Jb=null,E.Nd=null,!Lr(E.Oa,N,xe?11:12))return 0;if(xe&&rr(q)&&Bt(),N.da)alert("todo:use_scaling");else{if(Z){if(E.Ib=ln,N.Kb){if(q=N.U+1>>1,E.memory=o(N.U+2*q),E.memory==null)return 0;E.ec=E.memory,E.fc=0,E.cc=E.ec,E.dc=E.fc+N.U,E.Mc=E.cc,E.Nc=E.dc+q,E.Ib=Mr,Bt()}}else alert("todo:EmitYUV");xe&&(E.Jb=Ye,Z&&At())}if(Z&&!aL){for(N=0;256>N;++N)zoe[N]=89858*(N-128)+f2>>u2,Woe[N]=-22014*(N-128)+f2,Voe[N]=-45773*(N-128),Uoe[N]=113618*(N-128)+f2>>u2;for(N=Q0;N<jP;++N)E=76283*(N-16)+f2>>u2,Hoe[N-Q0]=cn(E,255),Goe[N-Q0]=cn(E+8>>4,15);aL=1}return 1}function Be(N){var E=N.ma,q=N.U,Z=N.T;return t(!(1&N.ka)),0>=q||0>=Z?0:(q=E.Ib(N,E),E.Jb!=null&&E.Jb(N,E,q),E.Dc+=q,1)}function et(N){N.ma.memory=null}function jt(N,E,q,Z){return Se(N,8)!=47?0:(E[0]=Se(N,14)+1,q[0]=Se(N,14)+1,Z[0]=Se(N,1),Se(N,3)!=0?0:!N.h)}function yt(N,E){if(4>N)return N+1;var q=N-2>>1;return(2+(1&N)<<q)+Se(E,q)+1}function qt(N,E){return 120<E?E-120:1<=(q=((q=dl[E-1])>>4)*N+(8-(15&q)))?q:1;var q}function pt(N,E,q){var Z=Q(q),xe=N[E+=255&Z].g-8;return 0<xe&&(te(q,q.u+8),Z=Q(q),E+=N[E].value,E+=Z&(1<<xe)-1),te(q,q.u+N[E].g),N[E].value}function Dt(N,E,q){return q.g+=N.g,q.value+=N.value<<E>>>0,t(8>=q.g),N.g}function he(N,E,q){var Z=N.xc;return t((E=Z==0?0:N.vc[N.md*(q>>Z)+(E>>Z)])<N.Wb),N.Ya[E]}function Qe(N,E,q,Z){var xe=N.ab,Ne=N.c*E,Ae=N.C;E=Ae+E;var Te=q,Fe=Z;for(Z=N.Ta,q=N.Ua;0<xe--;){var Ke=N.gc[xe],_t=Ae,Zt=E,Xe=Te,Tt=Fe,Ut=(Fe=Z,Te=q,Ke.Ea);switch(t(_t<Zt),t(Zt<=Ke.nc),Ke.hc){case 2:ma(Xe,Tt,(Zt-_t)*Ut,Fe,Te);break;case 0:var wr=_t,Jt=Zt,Cr=Fe,Ar=Te,Hr=(Mn=Ke).Ea;wr==0&&(es(Xe,Tt,null,null,1,Cr,Ar),Je(Xe,Tt+1,0,0,Hr-1,Cr,Ar+1),Tt+=Hr,Ar+=Hr,++wr);for(var Rr=1<<Mn.b,$n=Rr-1,An=xt(Hr,Mn.b),ba=Mn.K,Mn=Mn.w+(wr>>Mn.b)*An;wr<Jt;){var La=ba,Wo=Mn,wa=1;for(ka(Xe,Tt,Cr,Ar-Hr,1,Cr,Ar);wa<Hr;){var Rn=(wa&~$n)+Rr;Rn>Hr&&(Rn=Hr),(0,Zc[La[Wo++]>>8&15])(Xe,Tt+ +wa,Cr,Ar+wa-Hr,Rn-wa,Cr,Ar+wa),wa=Rn}Tt+=Hr,Ar+=Hr,++wr&$n||(Mn+=An)}Zt!=Ke.nc&&n(Fe,Te-Ut,Fe,Te+(Zt-_t-1)*Ut,Ut);break;case 1:for(Ut=Xe,Jt=Tt,Hr=(Xe=Ke.Ea)-(Ar=Xe&~(Cr=(Tt=1<<Ke.b)-1)),wr=xt(Xe,Ke.b),Rr=Ke.K,Ke=Ke.w+(_t>>Ke.b)*wr;_t<Zt;){for($n=Rr,An=Ke,ba=new Wt,Mn=Jt+Ar,La=Jt+Xe;Jt<Mn;)je($n[An++],ba),pm(ba,Ut,Jt,Tt,Fe,Te),Jt+=Tt,Te+=Tt;Jt<La&&(je($n[An++],ba),pm(ba,Ut,Jt,Hr,Fe,Te),Jt+=Hr,Te+=Hr),++_t&Cr||(Ke+=wr)}break;case 3:if(Xe==Fe&&Tt==Te&&0<Ke.b){for(Jt=Fe,Xe=Ut=Te+(Zt-_t)*Ut-(Ar=(Zt-_t)*xt(Ke.Ea,Ke.b)),Tt=Fe,Cr=Te,wr=[],Ar=(Hr=Ar)-1;0<=Ar;--Ar)wr[Ar]=Tt[Cr+Ar];for(Ar=Hr-1;0<=Ar;--Ar)Jt[Xe+Ar]=wr[Ar];Co(Ke,_t,Zt,Fe,Ut,Fe,Te)}else Co(Ke,_t,Zt,Xe,Tt,Fe,Te)}Te=Z,Fe=q}Fe!=q&&n(Z,q,Te,Fe,Ne)}function zt(N,E){var q=N.V,Z=N.Ba+N.c*N.C,xe=E-N.C;if(t(E<=N.l.o),t(16>=xe),0<xe){var Ne=N.l,Ae=N.Ta,Te=N.Ua,Fe=Ne.width;if(Qe(N,xe,q,Z),xe=Te=[Te],t((q=N.C)<(Z=E)),t(Ne.v<Ne.va),Z>Ne.o&&(Z=Ne.o),q<Ne.j){var Ke=Ne.j-q;q=Ne.j,xe[0]+=Ke*Fe}if(q>=Z?q=0:(xe[0]+=4*Ne.v,Ne.ka=q-Ne.j,Ne.U=Ne.va-Ne.v,Ne.T=Z-q,q=1),q){if(Te=Te[0],11>(q=N.ca).S){var _t=q.f.RGBA,Zt=(Z=q.S,xe=Ne.U,Ne=Ne.T,Ke=_t.eb,_t.A),Xe=Ne;for(_t=_t.fb+N.Ma*_t.A;0<Xe--;){var Tt=Ae,Ut=Te,wr=xe,Jt=Ke,Cr=_t;switch(Z){case De:np(Tt,Ut,wr,Jt,Cr);break;case ft:Uo(Tt,Ut,wr,Jt,Cr);break;case Vr:Uo(Tt,Ut,wr,Jt,Cr),vm(Jt,Cr,0,wr,1,0);break;case Ot:Bl(Tt,Ut,wr,Jt,Cr);break;case Lt:dt(Tt,Ut,wr,Jt,Cr,1);break;case Wn:dt(Tt,Ut,wr,Jt,Cr,1),vm(Jt,Cr,0,wr,1,0);break;case Yt:dt(Tt,Ut,wr,Jt,Cr,0);break;case Na:dt(Tt,Ut,wr,Jt,Cr,0),vm(Jt,Cr,1,wr,1,0);break;case Pr:go(Tt,Ut,wr,Jt,Cr);break;case ia:go(Tt,Ut,wr,Jt,Cr),sp(Jt,Cr,wr,1,0);break;case Wr:Cu(Tt,Ut,wr,Jt,Cr);break;default:t(0)}Te+=Fe,_t+=Zt}N.Ma+=Ne}else alert("todo:EmitRescaledRowsYUVA");t(N.Ma<=q.height)}}N.C=E,t(N.C<=N.i)}function Mt(N){var E;if(0<N.ua)return 0;for(E=0;E<N.Wb;++E){var q=N.Ya[E].G,Z=N.Ya[E].H;if(0<q[1][Z[1]+0].g||0<q[2][Z[2]+0].g||0<q[3][Z[3]+0].g)return 0}return 1}function ir(N,E,q,Z,xe,Ne){if(N.Z!=0){var Ae=N.qd,Te=N.rd;for(t(Ao[N.Z]!=null);E<q;++E)Ao[N.Z](Ae,Te,Z,xe,Z,xe,Ne),Ae=Z,Te=xe,xe+=Ne;N.qd=Ae,N.rd=Te}}function nr(N,E){var q=N.l.ma,Z=q.Z==0||q.Z==1?N.l.j:N.C;if(Z=N.C<Z?Z:N.C,t(E<=N.l.o),E>Z){var xe=N.l.width,Ne=q.ca,Ae=q.tb+xe*Z,Te=N.V,Fe=N.Ba+N.c*Z,Ke=N.gc;t(N.ab==1),t(Ke[0].hc==3),Is(Ke[0],Z,E,Te,Fe,Ne,Ae),ir(q,Z,E,Ne,Ae,xe)}N.C=N.Ma=E}function kr(N,E,q,Z,xe,Ne,Ae){var Te=N.$/Z,Fe=N.$%Z,Ke=N.m,_t=N.s,Zt=q+N.$,Xe=Zt;xe=q+Z*xe;var Tt=q+Z*Ne,Ut=280+_t.ua,wr=N.Pb?Te:16777216,Jt=0<_t.ua?_t.Wa:null,Cr=_t.wc,Ar=Zt<Tt?he(_t,Fe,Te):null;t(N.C<Ne),t(Tt<=xe);var Hr=!1;e:for(;;){for(;Hr||Zt<Tt;){var Rr=0;if(Te>=wr){var $n=Zt-q;t((wr=N).Pb),wr.wd=wr.m,wr.xd=$n,0<wr.s.ua&&gt(wr.s.Wa,wr.s.vb),wr=Te+xm}if(Fe&Cr||(Ar=he(_t,Fe,Te)),t(Ar!=null),Ar.Qb&&(E[Zt]=Ar.qb,Hr=!0),!Hr)if(Y(Ke),Ar.jc){Rr=Ke,$n=E;var An=Zt,ba=Ar.pd[Q(Rr)&yn-1];t(Ar.jc),256>ba.g?(te(Rr,Rr.u+ba.g),$n[An]=ba.value,Rr=0):(te(Rr,Rr.u+ba.g-256),t(256<=ba.value),Rr=ba.value),Rr==0&&(Hr=!0)}else Rr=pt(Ar.G[0],Ar.H[0],Ke);if(Ke.h)break;if(Hr||256>Rr){if(!Hr)if(Ar.nd)E[Zt]=(Ar.qb|Rr<<8)>>>0;else{if(Y(Ke),Hr=pt(Ar.G[1],Ar.H[1],Ke),Y(Ke),$n=pt(Ar.G[2],Ar.H[2],Ke),An=pt(Ar.G[3],Ar.H[3],Ke),Ke.h)break;E[Zt]=(An<<24|Hr<<16|Rr<<8|$n)>>>0}if(Hr=!1,++Zt,++Fe>=Z&&(Fe=0,++Te,Ae!=null&&Te<=Ne&&!(Te%16)&&Ae(N,Te),Jt!=null))for(;Xe<Zt;)Rr=E[Xe++],Jt.X[(506832829*Rr&4294967295)>>>Jt.Mb]=Rr}else if(280>Rr){if(Rr=yt(Rr-256,Ke),$n=pt(Ar.G[4],Ar.H[4],Ke),Y(Ke),$n=qt(Z,$n=yt($n,Ke)),Ke.h)break;if(Zt-q<$n||xe-Zt<Rr)break e;for(An=0;An<Rr;++An)E[Zt+An]=E[Zt+An-$n];for(Zt+=Rr,Fe+=Rr;Fe>=Z;)Fe-=Z,++Te,Ae!=null&&Te<=Ne&&!(Te%16)&&Ae(N,Te);if(t(Zt<=xe),Fe&Cr&&(Ar=he(_t,Fe,Te)),Jt!=null)for(;Xe<Zt;)Rr=E[Xe++],Jt.X[(506832829*Rr&4294967295)>>>Jt.Mb]=Rr}else{if(!(Rr<Ut))break e;for(Hr=Rr-280,t(Jt!=null);Xe<Zt;)Rr=E[Xe++],Jt.X[(506832829*Rr&4294967295)>>>Jt.Mb]=Rr;Rr=Zt,t(!(Hr>>>($n=Jt).Xa)),E[Rr]=$n.X[Hr],Hr=!0}Hr||t(Ke.h==pe(Ke))}if(N.Pb&&Ke.h&&Zt<xe)t(N.m.h),N.a=5,N.m=N.wd,N.$=N.xd,0<N.s.ua&&gt(N.s.vb,N.s.Wa);else{if(Ke.h)break e;Ae?.(N,Te>Ne?Ne:Te),N.a=0,N.$=Zt-q}return 1}return N.a=3,0}function Ft(N){t(N!=null),N.vc=null,N.yc=null,N.Ya=null;var E=N.Wa;E!=null&&(E.X=null),N.vb=null,t(N!=null)}function Dr(){var N=new we;return N==null?null:(N.a=0,N.xb=ts,ut("Predictor","VP8LPredictors"),ut("Predictor","VP8LPredictors_C"),ut("PredictorAdd","VP8LPredictorsAdd"),ut("PredictorAdd","VP8LPredictorsAdd_C"),ma=_e,pm=Ue,np=or,Uo=tr,go=Nt,Cu=yr,Bl=Me,A.VP8LMapColor32b=Js,A.VP8LMapColor8b=Us,N)}function Fr(N,E,q,Z,xe){var Ne=1,Ae=[N],Te=[E],Fe=Z.m,Ke=Z.s,_t=null,Zt=0;e:for(;;){if(q)for(;Ne&&Se(Fe,1);){var Xe=Ae,Tt=Te,Ut=Z,wr=1,Jt=Ut.m,Cr=Ut.gc[Ut.ab],Ar=Se(Jt,2);if(Ut.Oc&1<<Ar)Ne=0;else{switch(Ut.Oc|=1<<Ar,Cr.hc=Ar,Cr.Ea=Xe[0],Cr.nc=Tt[0],Cr.K=[null],++Ut.ab,t(4>=Ut.ab),Ar){case 0:case 1:Cr.b=Se(Jt,3)+2,wr=Fr(xt(Cr.Ea,Cr.b),xt(Cr.nc,Cr.b),0,Ut,Cr.K),Cr.K=Cr.K[0];break;case 3:var Hr,Rr=Se(Jt,8)+1,$n=16<Rr?0:4<Rr?1:2<Rr?2:3;if(Xe[0]=xt(Cr.Ea,$n),Cr.b=$n,Hr=wr=Fr(Rr,1,0,Ut,Cr.K)){var An,ba=Rr,Mn=Cr,La=1<<(8>>Mn.b),Wo=o(La);if(Wo==null)Hr=0;else{var wa=Mn.K[0],Rn=Mn.w;for(Wo[0]=Mn.K[0][0],An=1;An<1*ba;++An)Wo[An]=Ze(wa[Rn+An],Wo[An-1]);for(;An<4*La;++An)Wo[An]=0;Mn.K[0]=null,Mn.K[0]=Wo,Hr=1}}wr=Hr;break;case 2:break;default:t(0)}Ne=wr}}if(Ae=Ae[0],Te=Te[0],Ne&&Se(Fe,1)&&!(Ne=1<=(Zt=Se(Fe,4))&&11>=Zt)){Z.a=3;break e}var dn;if(dn=Ne)t:{var yo,va,Ba,Ts=Z,Ei=Ae,ml=Te,so=Zt,Wi=q,hl=Ts.m,Ho=Ts.s,Va=[null],ns=1,oo=0,as=rd[so];r:for(;;){if(Wi&&Se(hl,1)){var ki=Se(hl,3)+2,Ud=xt(Ei,ki),bo=xt(ml,ki),Ul=Ud*bo;if(!Fr(Ud,bo,0,Ts,Va))break r;for(Va=Va[0],Ho.xc=ki,yo=0;yo<Ul;++yo){var ps=Va[yo]>>8&65535;Va[yo]=ps,ps>=ns&&(ns=ps+1)}}if(hl.h)break r;for(va=0;5>va;++va){var Go=li[va];!va&&0<so&&(Go+=1<<so),oo<Go&&(oo=Go)}var pc=i(ns*as,M),pl=ns,gc=i(pl,U);if(gc==null)var vc=null;else t(65536>=pl),vc=gc;var Vl=o(oo);if(vc==null||Vl==null||pc==null){Ts.a=1;break r}var xc=pc;for(yo=Ba=0;yo<ns;++yo){var bs=vc[yo],yc=bs.G,Vd=bs.H,ip=0,vf=1,Ii=0;for(va=0;5>va;++va){Go=li[va],yc[va]=xc,Vd[va]=Ba,!va&&0<so&&(Go+=1<<so);a:{var h2,_P=Go,p2=Ts,Z0=Vl,Yoe=xc,Joe=Ba,NP=0,ym=p2.m,Qoe=Se(ym,1);if(s(Z0,0,0,_P),Qoe){var Zoe=Se(ym,1)+1,eie=Se(ym,1),iL=Se(ym,eie==0?1:8);Z0[iL]=1,Zoe==2&&(Z0[iL=Se(ym,8)]=1);var g2=1}else{var lL=o(19),cL=Se(ym,4)+4;if(19<cL){p2.a=3;var v2=0;break a}for(h2=0;h2<cL;++h2)lL[td[h2]]=Se(ym,3);var SP=void 0,ey=void 0,dL=p2,tie=lL,x2=_P,uL=Z0,CP=0,bm=dL.m,fL=8,mL=i(128,M);n:for(;I(mL,0,7,tie,19);){if(Se(bm,1)){var rie=2+2*Se(bm,3);if((SP=2+Se(bm,rie))>x2)break n}else SP=x2;for(ey=0;ey<x2&&SP--;){Y(bm);var hL=mL[0+(127&Q(bm))];te(bm,bm.u+hL.g);var Jg=hL.value;if(16>Jg)uL[ey++]=Jg,Jg!=0&&(fL=Jg);else{var nie=Jg==16,pL=Jg-16,aie=Po[pL],gL=Se(bm,jn[pL])+aie;if(ey+gL>x2)break n;for(var sie=nie?fL:0;0<gL--;)uL[ey++]=sie}}CP=1;break n}CP||(dL.a=3),g2=CP}(g2=g2&&!ym.h)&&(NP=I(Yoe,Joe,8,Z0,_P)),g2&&NP!=0?v2=NP:(p2.a=3,v2=0)}if(v2==0)break r;if(vf&&Vi[va]==1&&(vf=xc[Ba].g==0),ip+=xc[Ba].g,Ba+=v2,3>=va){var ty,PP=Vl[0];for(ty=1;ty<Go;++ty)Vl[ty]>PP&&(PP=Vl[ty]);Ii+=PP}}if(bs.nd=vf,bs.Qb=0,vf&&(bs.qb=(yc[3][Vd[3]+0].value<<24|yc[1][Vd[1]+0].value<<16|yc[2][Vd[2]+0].value)>>>0,ip==0&&256>yc[0][Vd[0]+0].value&&(bs.Qb=1,bs.qb+=yc[0][Vd[0]+0].value<<8)),bs.jc=!bs.Qb&&6>Ii,bs.jc){var y2,xf=bs;for(y2=0;y2<yn;++y2){var wm=y2,jm=xf.pd[wm],b2=xf.G[0][xf.H[0]+wm];256<=b2.value?(jm.g=b2.g+256,jm.value=b2.value):(jm.g=0,jm.value=0,wm>>=Dt(b2,8,jm),wm>>=Dt(xf.G[1][xf.H[1]+wm],16,jm),wm>>=Dt(xf.G[2][xf.H[2]+wm],0,jm),Dt(xf.G[3][xf.H[3]+wm],24,jm))}}}Ho.vc=Va,Ho.Wb=ns,Ho.Ya=vc,Ho.yc=pc,dn=1;break t}dn=0}if(!(Ne=dn)){Z.a=3;break e}if(0<Zt){if(Ke.ua=1<<Zt,!ie(Ke.Wa,Zt)){Z.a=1,Ne=0;break e}}else Ke.ua=0;var AP=Z,vL=Ae,oie=Te,EP=AP.s,kP=EP.xc;if(AP.c=vL,AP.i=oie,EP.md=xt(vL,kP),EP.wc=kP==0?-1:(1<<kP)-1,q){Z.xb=ja;break e}if((_t=o(Ae*Te))==null){Z.a=1,Ne=0;break e}Ne=(Ne=kr(Z,_t,0,Ae,Te,Te,null))&&!Fe.h;break e}return Ne?(xe!=null?xe[0]=_t:(t(_t==null),t(q)),Z.$=0,q||Ft(Ke)):Ft(Ke),Ne}function Tn(N,E){var q=N.c*N.i,Z=q+E+16*E;return t(N.c<=E),N.V=o(Z),N.V==null?(N.Ta=null,N.Ua=0,N.a=1,0):(N.Ta=N.V,N.Ua=N.Ba+q+E,1)}function nt(N,E){var q=N.C,Z=E-q,xe=N.V,Ne=N.Ba+N.c*q;for(t(E<=N.l.o);0<Z;){var Ae=16<Z?16:Z,Te=N.l.ma,Fe=N.l.width,Ke=Fe*Ae,_t=Te.ca,Zt=Te.tb+Fe*q,Xe=N.Ta,Tt=N.Ua;Qe(N,Ae,xe,Ne),zd(Xe,Tt,_t,Zt,Ke),ir(Te,q,q+Ae,_t,Zt,Fe),Z-=Ae,xe+=Ae*N.c,q+=Ae}t(q==E),N.C=N.Ma=E}function $t(){this.ub=this.yd=this.td=this.Rb=0}function Kt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function sr(){this.Fb=this.Bb=this.Cb=0,this.Zb=o(4),this.Lb=o(4)}function St(){this.Yb=function(){var N=[];return function E(q,Z,xe){for(var Ne=xe[Z],Ae=0;Ae<Ne&&(q.push(xe.length>Z+1?[]:0),!(xe.length<Z+1));Ae++)E(q[Ae],Z+1,xe)}(N,0,[3,11]),N}()}function Jr(){this.jb=o(3),this.Wc=l([4,8],St),this.Xc=l([4,17],St)}function Pt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new o(4),this.od=new o(4)}function lr(){this.ld=this.La=this.dd=this.tc=0}function st(){this.Na=this.la=0}function Et(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ar(){this.ad=o(384),this.Za=0,this.Ob=o(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Tr(){this.uc=this.M=this.Nb=0,this.wa=Array(new lr),this.Y=0,this.ya=Array(new ar),this.aa=0,this.l=new Qt}function Qr(){this.y=o(16),this.f=o(8),this.ea=o(8)}function tn(){this.cb=this.a=0,this.sc="",this.m=new V,this.Od=new $t,this.Kc=new Kt,this.ed=new Pt,this.Qa=new sr,this.Ic=this.$c=this.Aa=0,this.D=new Tr,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=i(8,V),this.ia=0,this.pb=i(4,Et),this.Pa=new Jr,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Qr),this.Hd=0,this.rb=Array(new st),this.sb=0,this.wa=Array(new lr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ar),this.L=this.aa=0,this.gd=l([4,2],lr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Qt(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function fn(){var N=new tn;return N!=null&&(N.a=0,N.sc="OK",N.cb=0,N.Xb=0,Pi||(Pi=se)),N}function nn(N,E,q){return N.a==0&&(N.a=E,N.sc=q,N.cb=0),0}function In(N,E,q){return 3<=q&&N[E+0]==157&&N[E+1]==1&&N[E+2]==42}function Dn(N,E){if(N==null)return 0;if(N.a=0,N.sc="OK",E==null)return nn(N,2,"null VP8Io passed to VP8GetHeaders()");var q=E.data,Z=E.w,xe=E.ha;if(4>xe)return nn(N,7,"Truncated header.");var Ne=q[Z+0]|q[Z+1]<<8|q[Z+2]<<16,Ae=N.Od;if(Ae.Rb=!(1&Ne),Ae.td=Ne>>1&7,Ae.yd=Ne>>4&1,Ae.ub=Ne>>5,3<Ae.td)return nn(N,3,"Incorrect keyframe parameters.");if(!Ae.yd)return nn(N,4,"Frame not displayable.");Z+=3,xe-=3;var Te=N.Kc;if(Ae.Rb){if(7>xe)return nn(N,7,"cannot parse picture header");if(!In(q,Z,xe))return nn(N,3,"Bad code word");Te.c=16383&(q[Z+4]<<8|q[Z+3]),Te.Td=q[Z+4]>>6,Te.i=16383&(q[Z+6]<<8|q[Z+5]),Te.Ud=q[Z+6]>>6,Z+=7,xe-=7,N.za=Te.c+15>>4,N.Ub=Te.i+15>>4,E.width=Te.c,E.height=Te.i,E.Da=0,E.j=0,E.v=0,E.va=E.width,E.o=E.height,E.da=0,E.ib=E.width,E.hb=E.height,E.U=E.width,E.T=E.height,s((Ne=N.Pa).jb,0,255,Ne.jb.length),t((Ne=N.Qa)!=null),Ne.Cb=0,Ne.Bb=0,Ne.Fb=1,s(Ne.Zb,0,0,Ne.Zb.length),s(Ne.Lb,0,0,Ne.Lb)}if(Ae.ub>xe)return nn(N,7,"bad partition length");z(Ne=N.m,q,Z,Ae.ub),Z+=Ae.ub,xe-=Ae.ub,Ae.Rb&&(Te.Ld=me(Ne),Te.Kd=me(Ne)),Te=N.Qa;var Fe,Ke=N.Pa;if(t(Ne!=null),t(Te!=null),Te.Cb=me(Ne),Te.Cb){if(Te.Bb=me(Ne),me(Ne)){for(Te.Fb=me(Ne),Fe=0;4>Fe;++Fe)Te.Zb[Fe]=me(Ne)?$(Ne,7):0;for(Fe=0;4>Fe;++Fe)Te.Lb[Fe]=me(Ne)?$(Ne,6):0}if(Te.Bb)for(Fe=0;3>Fe;++Fe)Ke.jb[Fe]=me(Ne)?W(Ne,8):255}else Te.Bb=0;if(Ne.Ka)return nn(N,3,"cannot parse segment header");if((Te=N.ed).zd=me(Ne),Te.Tb=W(Ne,6),Te.wb=W(Ne,3),Te.Pc=me(Ne),Te.Pc&&me(Ne)){for(Ke=0;4>Ke;++Ke)me(Ne)&&(Te.vd[Ke]=$(Ne,6));for(Ke=0;4>Ke;++Ke)me(Ne)&&(Te.od[Ke]=$(Ne,6))}if(N.L=Te.Tb==0?0:Te.zd?1:2,Ne.Ka)return nn(N,3,"cannot parse filter header");var _t=xe;if(xe=Fe=Z,Z=Fe+_t,Te=_t,N.Xb=(1<<W(N.m,2))-1,_t<3*(Ke=N.Xb))q=7;else{for(Fe+=3*Ke,Te-=3*Ke,_t=0;_t<Ke;++_t){var Zt=q[xe+0]|q[xe+1]<<8|q[xe+2]<<16;Zt>Te&&(Zt=Te),z(N.Jc[+_t],q,Fe,Zt),Fe+=Zt,Te-=Zt,xe+=3}z(N.Jc[+Ke],q,Fe,Te),q=Fe<Z?0:5}if(q!=0)return nn(N,q,"cannot parse partitions");for(q=W(Fe=N.m,7),xe=me(Fe)?$(Fe,4):0,Z=me(Fe)?$(Fe,4):0,Te=me(Fe)?$(Fe,4):0,Ke=me(Fe)?$(Fe,4):0,Fe=me(Fe)?$(Fe,4):0,_t=N.Qa,Zt=0;4>Zt;++Zt){if(_t.Cb){var Xe=_t.Zb[Zt];_t.Fb||(Xe+=q)}else{if(0<Zt){N.pb[Zt]=N.pb[0];continue}Xe=q}var Tt=N.pb[Zt];Tt.Sc[0]=Ma[cn(Xe+xe,127)],Tt.Sc[1]=rs[cn(Xe+0,127)],Tt.Eb[0]=2*Ma[cn(Xe+Z,127)],Tt.Eb[1]=101581*rs[cn(Xe+Te,127)]>>16,8>Tt.Eb[1]&&(Tt.Eb[1]=8),Tt.Qc[0]=Ma[cn(Xe+Ke,117)],Tt.Qc[1]=rs[cn(Xe+Fe,127)],Tt.lc=Xe+Fe}if(!Ae.Rb)return nn(N,4,"Not a key frame.");for(me(Ne),Ae=N.Pa,q=0;4>q;++q){for(xe=0;8>xe;++xe)for(Z=0;3>Z;++Z)for(Te=0;11>Te;++Te)Ke=ae(Ne,gf[q][xe][Z][Te])?W(Ne,8):ao[q][xe][Z][Te],Ae.Wc[q][xe].Yb[Z][Te]=Ke;for(xe=0;17>xe;++xe)Ae.Xc[q][xe]=Ae.Wc[q][Vs[xe]]}return N.kc=me(Ne),N.kc&&(N.Bd=W(Ne,8)),N.cb=1}function se(N,E,q,Z,xe,Ne,Ae){var Te=E[xe].Yb[q];for(q=0;16>xe;++xe){if(!ae(N,Te[q+0]))return xe;for(;!ae(N,Te[q+1]);)if(Te=E[++xe].Yb[0],q=0,xe==16)return 16;var Fe=E[xe+1].Yb;if(ae(N,Te[q+2])){var Ke=N,_t=0;if(ae(Ke,(Xe=Te)[(Zt=q)+3]))if(ae(Ke,Xe[Zt+6])){for(Te=0,Zt=2*(_t=ae(Ke,Xe[Zt+8]))+(Xe=ae(Ke,Xe[Zt+9+_t])),_t=0,Xe=xo[Zt];Xe[Te];++Te)_t+=_t+ae(Ke,Xe[Te]);_t+=3+(8<<Zt)}else ae(Ke,Xe[Zt+7])?(_t=7+2*ae(Ke,165),_t+=ae(Ke,145)):_t=5+ae(Ke,159);else _t=ae(Ke,Xe[Zt+4])?3+ae(Ke,Xe[Zt+5]):2;Te=Fe[2]}else _t=1,Te=Fe[1];Fe=Ae+ul[xe],0>(Ke=N).b&&ce(Ke);var Zt,Xe=Ke.b,Tt=(Zt=Ke.Ca>>1)-(Ke.I>>Xe)>>31;--Ke.b,Ke.Ca+=Tt,Ke.Ca|=1,Ke.I-=(Zt+1&Tt)<<Xe,Ne[Fe]=((_t^Tt)-Tt)*Z[(0<xe)+0]}return 16}function He(N){var E=N.rb[N.sb-1];E.la=0,E.Na=0,s(N.zc,0,0,N.zc.length),N.ja=0}function ot(N,E,q,Z,xe){xe=N[E+q+32*Z]+(xe>>3),N[E+q+32*Z]=-256&xe?0>xe?0:255:xe}function ee(N,E,q,Z,xe,Ne){ot(N,E,0,q,Z+xe),ot(N,E,1,q,Z+Ne),ot(N,E,2,q,Z-Ne),ot(N,E,3,q,Z-xe)}function k(N){return(20091*N>>16)+N}function T(N,E,q,Z){var xe,Ne=0,Ae=o(16);for(xe=0;4>xe;++xe){var Te=N[E+0]+N[E+8],Fe=N[E+0]-N[E+8],Ke=(35468*N[E+4]>>16)-k(N[E+12]),_t=k(N[E+4])+(35468*N[E+12]>>16);Ae[Ne+0]=Te+_t,Ae[Ne+1]=Fe+Ke,Ae[Ne+2]=Fe-Ke,Ae[Ne+3]=Te-_t,Ne+=4,E++}for(xe=Ne=0;4>xe;++xe)Te=(N=Ae[Ne+0]+4)+Ae[Ne+8],Fe=N-Ae[Ne+8],Ke=(35468*Ae[Ne+4]>>16)-k(Ae[Ne+12]),ot(q,Z,0,0,Te+(_t=k(Ae[Ne+4])+(35468*Ae[Ne+12]>>16))),ot(q,Z,1,0,Fe+Ke),ot(q,Z,2,0,Fe-Ke),ot(q,Z,3,0,Te-_t),Ne++,Z+=32}function K(N,E,q,Z){var xe=N[E+0]+4,Ne=35468*N[E+4]>>16,Ae=k(N[E+4]),Te=35468*N[E+1]>>16;ee(q,Z,0,xe+Ae,N=k(N[E+1]),Te),ee(q,Z,1,xe+Ne,N,Te),ee(q,Z,2,xe-Ne,N,Te),ee(q,Z,3,xe-Ae,N,Te)}function H(N,E,q,Z,xe){T(N,E,q,Z),xe&&T(N,E+16,q,Z+4)}function F(N,E,q,Z){ql(N,E+0,q,Z,1),ql(N,E+32,q,Z+128,1)}function Le(N,E,q,Z){var xe;for(N=N[E+0]+4,xe=0;4>xe;++xe)for(E=0;4>E;++E)ot(q,Z,E,xe,N)}function it(N,E,q,Z){N[E+0]&&Ia(N,E+0,q,Z),N[E+16]&&Ia(N,E+16,q,Z+4),N[E+32]&&Ia(N,E+32,q,Z+128),N[E+48]&&Ia(N,E+48,q,Z+128+4)}function lt(N,E,q,Z){var xe,Ne=o(16);for(xe=0;4>xe;++xe){var Ae=N[E+0+xe]+N[E+12+xe],Te=N[E+4+xe]+N[E+8+xe],Fe=N[E+4+xe]-N[E+8+xe],Ke=N[E+0+xe]-N[E+12+xe];Ne[0+xe]=Ae+Te,Ne[8+xe]=Ae-Te,Ne[4+xe]=Ke+Fe,Ne[12+xe]=Ke-Fe}for(xe=0;4>xe;++xe)Ae=(N=Ne[0+4*xe]+3)+Ne[3+4*xe],Te=Ne[1+4*xe]+Ne[2+4*xe],Fe=Ne[1+4*xe]-Ne[2+4*xe],Ke=N-Ne[3+4*xe],q[Z+0]=Ae+Te>>3,q[Z+16]=Ke+Fe>>3,q[Z+32]=Ae-Te>>3,q[Z+48]=Ke-Fe>>3,Z+=64}function Vt(N,E,q){var Z,xe=E-32,Ne=Ci,Ae=255-N[xe-1];for(Z=0;Z<q;++Z){var Te,Fe=Ne,Ke=Ae+N[E-1];for(Te=0;Te<q;++Te)N[E+Te]=Fe[Ke+N[xe+Te]];E+=32}}function Ve(N,E){Vt(N,E,4)}function kt(N,E){Vt(N,E,8)}function Sr(N,E){Vt(N,E,16)}function Or(N,E){var q;for(q=0;16>q;++q)n(N,E+32*q,N,E-32,16)}function fr(N,E){var q;for(q=16;0<q;--q)s(N,E,N[E-1],16),E+=32}function Kr(N,E,q){var Z;for(Z=0;16>Z;++Z)s(E,q+32*Z,N,16)}function Pn(N,E){var q,Z=16;for(q=0;16>q;++q)Z+=N[E-1+32*q]+N[E+q-32];Kr(Z>>5,N,E)}function qn(N,E){var q,Z=8;for(q=0;16>q;++q)Z+=N[E-1+32*q];Kr(Z>>4,N,E)}function zn(N,E){var q,Z=8;for(q=0;16>q;++q)Z+=N[E+q-32];Kr(Z>>4,N,E)}function sn(N,E){Kr(128,N,E)}function qr(N,E,q){return N+2*E+q+2>>2}function Sa(N,E){var q,Z=E-32;for(Z=new Uint8Array([qr(N[Z-1],N[Z+0],N[Z+1]),qr(N[Z+0],N[Z+1],N[Z+2]),qr(N[Z+1],N[Z+2],N[Z+3]),qr(N[Z+2],N[Z+3],N[Z+4])]),q=0;4>q;++q)n(N,E+32*q,Z,0,Z.length)}function _a(N,E){var q=N[E-1],Z=N[E-1+32],xe=N[E-1+64],Ne=N[E-1+96];le(N,E+0,16843009*qr(N[E-1-32],q,Z)),le(N,E+32,16843009*qr(q,Z,xe)),le(N,E+64,16843009*qr(Z,xe,Ne)),le(N,E+96,16843009*qr(xe,Ne,Ne))}function da(N,E){var q,Z=4;for(q=0;4>q;++q)Z+=N[E+q-32]+N[E-1+32*q];for(Z>>=3,q=0;4>q;++q)s(N,E+32*q,Z,4)}function Xs(N,E){var q=N[E-1+0],Z=N[E-1+32],xe=N[E-1+64],Ne=N[E-1-32],Ae=N[E+0-32],Te=N[E+1-32],Fe=N[E+2-32],Ke=N[E+3-32];N[E+0+96]=qr(Z,xe,N[E-1+96]),N[E+1+96]=N[E+0+64]=qr(q,Z,xe),N[E+2+96]=N[E+1+64]=N[E+0+32]=qr(Ne,q,Z),N[E+3+96]=N[E+2+64]=N[E+1+32]=N[E+0+0]=qr(Ae,Ne,q),N[E+3+64]=N[E+2+32]=N[E+1+0]=qr(Te,Ae,Ne),N[E+3+32]=N[E+2+0]=qr(Fe,Te,Ae),N[E+3+0]=qr(Ke,Fe,Te)}function Ys(N,E){var q=N[E+1-32],Z=N[E+2-32],xe=N[E+3-32],Ne=N[E+4-32],Ae=N[E+5-32],Te=N[E+6-32],Fe=N[E+7-32];N[E+0+0]=qr(N[E+0-32],q,Z),N[E+1+0]=N[E+0+32]=qr(q,Z,xe),N[E+2+0]=N[E+1+32]=N[E+0+64]=qr(Z,xe,Ne),N[E+3+0]=N[E+2+32]=N[E+1+64]=N[E+0+96]=qr(xe,Ne,Ae),N[E+3+32]=N[E+2+64]=N[E+1+96]=qr(Ne,Ae,Te),N[E+3+64]=N[E+2+96]=qr(Ae,Te,Fe),N[E+3+96]=qr(Te,Fe,Fe)}function Za(N,E){var q=N[E-1+0],Z=N[E-1+32],xe=N[E-1+64],Ne=N[E-1-32],Ae=N[E+0-32],Te=N[E+1-32],Fe=N[E+2-32],Ke=N[E+3-32];N[E+0+0]=N[E+1+64]=Ne+Ae+1>>1,N[E+1+0]=N[E+2+64]=Ae+Te+1>>1,N[E+2+0]=N[E+3+64]=Te+Fe+1>>1,N[E+3+0]=Fe+Ke+1>>1,N[E+0+96]=qr(xe,Z,q),N[E+0+64]=qr(Z,q,Ne),N[E+0+32]=N[E+1+96]=qr(q,Ne,Ae),N[E+1+32]=N[E+2+96]=qr(Ne,Ae,Te),N[E+2+32]=N[E+3+96]=qr(Ae,Te,Fe),N[E+3+32]=qr(Te,Fe,Ke)}function ol(N,E){var q=N[E+0-32],Z=N[E+1-32],xe=N[E+2-32],Ne=N[E+3-32],Ae=N[E+4-32],Te=N[E+5-32],Fe=N[E+6-32],Ke=N[E+7-32];N[E+0+0]=q+Z+1>>1,N[E+1+0]=N[E+0+64]=Z+xe+1>>1,N[E+2+0]=N[E+1+64]=xe+Ne+1>>1,N[E+3+0]=N[E+2+64]=Ne+Ae+1>>1,N[E+0+32]=qr(q,Z,xe),N[E+1+32]=N[E+0+96]=qr(Z,xe,Ne),N[E+2+32]=N[E+1+96]=qr(xe,Ne,Ae),N[E+3+32]=N[E+2+96]=qr(Ne,Ae,Te),N[E+3+64]=qr(Ae,Te,Fe),N[E+3+96]=qr(Te,Fe,Ke)}function hs(N,E){var q=N[E-1+0],Z=N[E-1+32],xe=N[E-1+64],Ne=N[E-1+96];N[E+0+0]=q+Z+1>>1,N[E+2+0]=N[E+0+32]=Z+xe+1>>1,N[E+2+32]=N[E+0+64]=xe+Ne+1>>1,N[E+1+0]=qr(q,Z,xe),N[E+3+0]=N[E+1+32]=qr(Z,xe,Ne),N[E+3+32]=N[E+1+64]=qr(xe,Ne,Ne),N[E+3+64]=N[E+2+64]=N[E+0+96]=N[E+1+96]=N[E+2+96]=N[E+3+96]=Ne}function fc(N,E){var q=N[E-1+0],Z=N[E-1+32],xe=N[E-1+64],Ne=N[E-1+96],Ae=N[E-1-32],Te=N[E+0-32],Fe=N[E+1-32],Ke=N[E+2-32];N[E+0+0]=N[E+2+32]=q+Ae+1>>1,N[E+0+32]=N[E+2+64]=Z+q+1>>1,N[E+0+64]=N[E+2+96]=xe+Z+1>>1,N[E+0+96]=Ne+xe+1>>1,N[E+3+0]=qr(Te,Fe,Ke),N[E+2+0]=qr(Ae,Te,Fe),N[E+1+0]=N[E+3+32]=qr(q,Ae,Te),N[E+1+32]=N[E+3+64]=qr(Z,q,Ae),N[E+1+64]=N[E+3+96]=qr(xe,Z,q),N[E+1+96]=qr(Ne,xe,Z)}function mc(N,E){var q;for(q=0;8>q;++q)n(N,E+32*q,N,E-32,8)}function Ui(N,E){var q;for(q=0;8>q;++q)s(N,E,N[E-1],8),E+=32}function Bo(N,E,q){var Z;for(Z=0;8>Z;++Z)s(E,q+32*Z,N,8)}function Ll(N,E){var q,Z=8;for(q=0;8>q;++q)Z+=N[E+q-32]+N[E-1+32*q];Bo(Z>>4,N,E)}function Bd(N,E){var q,Z=4;for(q=0;8>q;++q)Z+=N[E+q-32];Bo(Z>>3,N,E)}function qs(N,E){var q,Z=4;for(q=0;8>q;++q)Z+=N[E-1+32*q];Bo(Z>>3,N,E)}function Qc(N,E){Bo(128,N,E)}function Fl(N,E,q){var Z=N[E-q],xe=N[E+0],Ne=3*(xe-Z)+Yg[1020+N[E-2*q]-N[E+q]],Ae=op[112+(Ne+4>>3)];N[E-q]=Ci[255+Z+op[112+(Ne+3>>3)]],N[E+0]=Ci[255+xe-Ae]}function il(N,E,q,Z){var xe=N[E+0],Ne=N[E+q];return ii[255+N[E-2*q]-N[E-q]]>Z||ii[255+Ne-xe]>Z}function zs(N,E,q,Z){return 4*ii[255+N[E-q]-N[E+0]]+ii[255+N[E-2*q]-N[E+q]]<=Z}function Si(N,E,q,Z,xe){var Ne=N[E-3*q],Ae=N[E-2*q],Te=N[E-q],Fe=N[E+0],Ke=N[E+q],_t=N[E+2*q],Zt=N[E+3*q];return 4*ii[255+Te-Fe]+ii[255+Ae-Ke]>Z?0:ii[255+N[E-4*q]-Ne]<=xe&&ii[255+Ne-Ae]<=xe&&ii[255+Ae-Te]<=xe&&ii[255+Zt-_t]<=xe&&ii[255+_t-Ke]<=xe&&ii[255+Ke-Fe]<=xe}function qo(N,E,q,Z){var xe=2*Z+1;for(Z=0;16>Z;++Z)zs(N,E+Z,q,xe)&&Fl(N,E+Z,q)}function hc(N,E,q,Z){var xe=2*Z+1;for(Z=0;16>Z;++Z)zs(N,E+Z*q,1,xe)&&Fl(N,E+Z*q,1)}function $l(N,E,q,Z){var xe;for(xe=3;0<xe;--xe)qo(N,E+=4*q,q,Z)}function hf(N,E,q,Z){var xe;for(xe=3;0<xe;--xe)hc(N,E+=4,q,Z)}function oi(N,E,q,Z,xe,Ne,Ae,Te){for(Ne=2*Ne+1;0<xe--;){if(Si(N,E,q,Ne,Ae))if(il(N,E,q,Te))Fl(N,E,q);else{var Fe=N,Ke=E,_t=q,Zt=Fe[Ke-2*_t],Xe=Fe[Ke-_t],Tt=Fe[Ke+0],Ut=Fe[Ke+_t],wr=Fe[Ke+2*_t],Jt=27*(Ar=Yg[1020+3*(Tt-Xe)+Yg[1020+Zt-Ut]])+63>>7,Cr=18*Ar+63>>7,Ar=9*Ar+63>>7;Fe[Ke-3*_t]=Ci[255+Fe[Ke-3*_t]+Ar],Fe[Ke-2*_t]=Ci[255+Zt+Cr],Fe[Ke-_t]=Ci[255+Xe+Jt],Fe[Ke+0]=Ci[255+Tt-Jt],Fe[Ke+_t]=Ci[255+Ut-Cr],Fe[Ke+2*_t]=Ci[255+wr-Ar]}E+=Z}}function zo(N,E,q,Z,xe,Ne,Ae,Te){for(Ne=2*Ne+1;0<xe--;){if(Si(N,E,q,Ne,Ae))if(il(N,E,q,Te))Fl(N,E,q);else{var Fe=N,Ke=E,_t=q,Zt=Fe[Ke-_t],Xe=Fe[Ke+0],Tt=Fe[Ke+_t],Ut=op[112+(4+(wr=3*(Xe-Zt))>>3)],wr=op[112+(wr+3>>3)],Jt=Ut+1>>1;Fe[Ke-2*_t]=Ci[255+Fe[Ke-2*_t]+Jt],Fe[Ke-_t]=Ci[255+Zt+wr],Fe[Ke+0]=Ci[255+Xe-Ut],Fe[Ke+_t]=Ci[255+Tt-Jt]}E+=Z}}function hm(N,E,q,Z,xe,Ne){oi(N,E,q,1,16,Z,xe,Ne)}function pf(N,E,q,Z,xe,Ne){oi(N,E,1,q,16,Z,xe,Ne)}function Es(N,E,q,Z,xe,Ne){var Ae;for(Ae=3;0<Ae;--Ae)zo(N,E+=4*q,q,1,16,Z,xe,Ne)}function po(N,E,q,Z,xe,Ne){var Ae;for(Ae=3;0<Ae;--Ae)zo(N,E+=4,1,q,16,Z,xe,Ne)}function L(N,E,q,Z,xe,Ne,Ae,Te){oi(N,E,xe,1,8,Ne,Ae,Te),oi(q,Z,xe,1,8,Ne,Ae,Te)}function ge(N,E,q,Z,xe,Ne,Ae,Te){oi(N,E,1,xe,8,Ne,Ae,Te),oi(q,Z,1,xe,8,Ne,Ae,Te)}function We(N,E,q,Z,xe,Ne,Ae,Te){zo(N,E+4*xe,xe,1,8,Ne,Ae,Te),zo(q,Z+4*xe,xe,1,8,Ne,Ae,Te)}function mt(N,E,q,Z,xe,Ne,Ae,Te){zo(N,E+4,1,xe,8,Ne,Ae,Te),zo(q,Z+4,1,xe,8,Ne,Ae,Te)}function J(){this.ba=new dr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new er,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function ve(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function G(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function re(){this.ua=0,this.Wa=new bt,this.vb=new bt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new U,this.yc=new M}function we(){this.xb=this.a=0,this.l=new Qt,this.ca=new dr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new B,this.Pb=0,this.wd=new B,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new re,this.ab=0,this.gc=i(4,G),this.Oc=0}function Ce(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Qt,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ke(N,E,q,Z,xe,Ne,Ae){for(N=N==null?0:N[E+0],E=0;E<Ae;++E)xe[Ne+E]=N+q[Z+E]&255,N=xe[Ne+E]}function Oe(N,E,q,Z,xe,Ne,Ae){var Te;if(N==null)ke(null,null,q,Z,xe,Ne,Ae);else for(Te=0;Te<Ae;++Te)xe[Ne+Te]=N[E+Te]+q[Z+Te]&255}function oe(N,E,q,Z,xe,Ne,Ae){if(N==null)ke(null,null,q,Z,xe,Ne,Ae);else{var Te,Fe=N[E+0],Ke=Fe,_t=Fe;for(Te=0;Te<Ae;++Te)Ke=_t+(Fe=N[E+Te])-Ke,_t=q[Z+Te]+(-256&Ke?0>Ke?0:255:Ke)&255,Ke=Fe,xe[Ne+Te]=_t}}function Ee(N,E,q,Z){var xe=E.width,Ne=E.o;if(t(N!=null&&E!=null),0>q||0>=Z||q+Z>Ne)return null;if(!N.Cc){if(N.ga==null){var Ae;if(N.ga=new Ce,(Ae=N.ga==null)||(Ae=E.width*E.o,t(N.Gb.length==0),N.Gb=o(Ae),N.Uc=0,N.Gb==null?Ae=0:(N.mb=N.Gb,N.nb=N.Uc,N.rc=null,Ae=1),Ae=!Ae),!Ae){Ae=N.ga;var Te=N.Fa,Fe=N.P,Ke=N.qc,_t=N.mb,Zt=N.nb,Xe=Fe+1,Tt=Ke-1,Ut=Ae.l;if(t(Te!=null&&_t!=null&&E!=null),Ao[0]=null,Ao[1]=ke,Ao[2]=Oe,Ao[3]=oe,Ae.ca=_t,Ae.tb=Zt,Ae.c=E.width,Ae.i=E.height,t(0<Ae.c&&0<Ae.i),1>=Ke)E=0;else if(Ae.$a=3&Te[Fe+0],Ae.Z=Te[Fe+0]>>2&3,Ae.Lc=Te[Fe+0]>>4&3,Fe=Te[Fe+0]>>6&3,0>Ae.$a||1<Ae.$a||4<=Ae.Z||1<Ae.Lc||Fe)E=0;else if(Ut.put=Be,Ut.ac=$e,Ut.bc=et,Ut.ma=Ae,Ut.width=E.width,Ut.height=E.height,Ut.Da=E.Da,Ut.v=E.v,Ut.va=E.va,Ut.j=E.j,Ut.o=E.o,Ae.$a)e:{t(Ae.$a==1),E=Dr();t:for(;;){if(E==null){E=0;break e}if(t(Ae!=null),Ae.mc=E,E.c=Ae.c,E.i=Ae.i,E.l=Ae.l,E.l.ma=Ae,E.l.width=Ae.c,E.l.height=Ae.i,E.a=0,X(E.m,Te,Xe,Tt),!Fr(Ae.c,Ae.i,1,E,null)||(E.ab==1&&E.gc[0].hc==3&&Mt(E.s)?(Ae.ic=1,Te=E.c*E.i,E.Ta=null,E.Ua=0,E.V=o(Te),E.Ba=0,E.V==null?(E.a=1,E=0):E=1):(Ae.ic=0,E=Tn(E,Ae.c)),!E))break t;E=1;break e}Ae.mc=null,E=0}else E=Tt>=Ae.c*Ae.i;Ae=!E}if(Ae)return null;N.ga.Lc!=1?N.Ga=0:Z=Ne-q}t(N.ga!=null),t(q+Z<=Ne);e:{if(E=(Te=N.ga).c,Ne=Te.l.o,Te.$a==0){if(Xe=N.rc,Tt=N.Vc,Ut=N.Fa,Fe=N.P+1+q*E,Ke=N.mb,_t=N.nb+q*E,t(Fe<=N.P+N.qc),Te.Z!=0)for(t(Ao[Te.Z]!=null),Ae=0;Ae<Z;++Ae)Ao[Te.Z](Xe,Tt,Ut,Fe,Ke,_t,E),Xe=Ke,Tt=_t,_t+=E,Fe+=E;else for(Ae=0;Ae<Z;++Ae)n(Ke,_t,Ut,Fe,E),Xe=Ke,Tt=_t,_t+=E,Fe+=E;N.rc=Xe,N.Vc=Tt}else{if(t(Te.mc!=null),E=q+Z,t((Ae=Te.mc)!=null),t(E<=Ae.i),Ae.C>=E)E=1;else if(Te.ic||At(),Te.ic){Te=Ae.V,Xe=Ae.Ba,Tt=Ae.c;var wr=Ae.i,Jt=(Ut=1,Fe=Ae.$/Tt,Ke=Ae.$%Tt,_t=Ae.m,Zt=Ae.s,Ae.$),Cr=Tt*wr,Ar=Tt*E,Hr=Zt.wc,Rr=Jt<Ar?he(Zt,Ke,Fe):null;t(Jt<=Cr),t(E<=wr),t(Mt(Zt));t:for(;;){for(;!_t.h&&Jt<Ar;){if(Ke&Hr||(Rr=he(Zt,Ke,Fe)),t(Rr!=null),Y(_t),256>(wr=pt(Rr.G[0],Rr.H[0],_t)))Te[Xe+Jt]=wr,++Jt,++Ke>=Tt&&(Ke=0,++Fe<=E&&!(Fe%16)&&nr(Ae,Fe));else{if(!(280>wr)){Ut=0;break t}wr=yt(wr-256,_t);var $n,An=pt(Rr.G[4],Rr.H[4],_t);if(Y(_t),!(Jt>=(An=qt(Tt,An=yt(An,_t)))&&Cr-Jt>=wr)){Ut=0;break t}for($n=0;$n<wr;++$n)Te[Xe+Jt+$n]=Te[Xe+Jt+$n-An];for(Jt+=wr,Ke+=wr;Ke>=Tt;)Ke-=Tt,++Fe<=E&&!(Fe%16)&&nr(Ae,Fe);Jt<Ar&&Ke&Hr&&(Rr=he(Zt,Ke,Fe))}t(_t.h==pe(_t))}nr(Ae,Fe>E?E:Fe);break t}!Ut||_t.h&&Jt<Cr?(Ut=0,Ae.a=_t.h?5:3):Ae.$=Jt,E=Ut}else E=kr(Ae,Ae.V,Ae.Ba,Ae.c,Ae.i,E,nt);if(!E){Z=0;break e}}q+Z>=Ne&&(N.Cc=1),Z=1}if(!Z)return null;if(N.Cc&&((Z=N.ga)!=null&&(Z.mc=null),N.ga=null,0<N.Ga))return alert("todo:WebPDequantizeLevels"),null}return N.nb+q*xe}function Ie(N,E,q,Z,xe,Ne){for(;0<xe--;){var Ae,Te=N,Fe=E+(q?1:0),Ke=N,_t=E+(q?0:3);for(Ae=0;Ae<Z;++Ae){var Zt=Ke[_t+4*Ae];Zt!=255&&(Zt*=32897,Te[Fe+4*Ae+0]=Te[Fe+4*Ae+0]*Zt>>23,Te[Fe+4*Ae+1]=Te[Fe+4*Ae+1]*Zt>>23,Te[Fe+4*Ae+2]=Te[Fe+4*Ae+2]*Zt>>23)}E+=Ne}}function tt(N,E,q,Z,xe){for(;0<Z--;){var Ne;for(Ne=0;Ne<q;++Ne){var Ae=N[E+2*Ne+0],Te=15&(Ke=N[E+2*Ne+1]),Fe=4369*Te,Ke=(240&Ke|Ke>>4)*Fe>>16;N[E+2*Ne+0]=(240&Ae|Ae>>4)*Fe>>16&240|(15&Ae|Ae<<4)*Fe>>16>>4&15,N[E+2*Ne+1]=240&Ke|Te}E+=xe}}function vt(N,E,q,Z,xe,Ne,Ae,Te){var Fe,Ke,_t=255;for(Ke=0;Ke<xe;++Ke){for(Fe=0;Fe<Z;++Fe){var Zt=N[E+Fe];Ne[Ae+4*Fe]=Zt,_t&=Zt}E+=q,Ae+=Te}return _t!=255}function Rt(N,E,q,Z,xe){var Ne;for(Ne=0;Ne<xe;++Ne)q[Z+Ne]=N[E+Ne]>>8}function At(){vm=Ie,sp=tt,o2=vt,zd=Rt}function Gt(N,E,q){A[N]=function(Z,xe,Ne,Ae,Te,Fe,Ke,_t,Zt,Xe,Tt,Ut,wr,Jt,Cr,Ar,Hr){var Rr,$n=Hr-1>>1,An=Te[Fe+0]|Ke[_t+0]<<16,ba=Zt[Xe+0]|Tt[Ut+0]<<16;t(Z!=null);var Mn=3*An+ba+131074>>2;for(E(Z[xe+0],255&Mn,Mn>>16,wr,Jt),Ne!=null&&(Mn=3*ba+An+131074>>2,E(Ne[Ae+0],255&Mn,Mn>>16,Cr,Ar)),Rr=1;Rr<=$n;++Rr){var La=Te[Fe+Rr]|Ke[_t+Rr]<<16,Wo=Zt[Xe+Rr]|Tt[Ut+Rr]<<16,wa=An+La+ba+Wo+524296,Rn=wa+2*(La+ba)>>3;Mn=Rn+An>>1,An=(wa=wa+2*(An+Wo)>>3)+La>>1,E(Z[xe+2*Rr-1],255&Mn,Mn>>16,wr,Jt+(2*Rr-1)*q),E(Z[xe+2*Rr-0],255&An,An>>16,wr,Jt+(2*Rr-0)*q),Ne!=null&&(Mn=wa+ba>>1,An=Rn+Wo>>1,E(Ne[Ae+2*Rr-1],255&Mn,Mn>>16,Cr,Ar+(2*Rr-1)*q),E(Ne[Ae+2*Rr+0],255&An,An>>16,Cr,Ar+(2*Rr+0)*q)),An=La,ba=Wo}1&Hr||(Mn=3*An+ba+131074>>2,E(Z[xe+Hr-1],255&Mn,Mn>>16,wr,Jt+(Hr-1)*q),Ne!=null&&(Mn=3*ba+An+131074>>2,E(Ne[Ae+Hr-1],255&Mn,Mn>>16,Cr,Ar+(Hr-1)*q)))}}function Bt(){ci[De]=Os,ci[ft]=zl,ci[Ot]=Ai,ci[Lt]=wP,ci[Yt]=Eu,ci[Pr]=rL,ci[Wr]=Boe,ci[Vr]=zl,ci[Wn]=wP,ci[Na]=Eu,ci[ia]=rL}function Ht(N){return N&~qoe?0>N?0:255:N>>nL}function jr(N,E){return Ht((19077*N>>8)+(26149*E>>8)-14234)}function vr(N,E,q){return Ht((19077*N>>8)-(6419*E>>8)-(13320*q>>8)+8708)}function xn(N,E){return Ht((19077*N>>8)+(33050*E>>8)-17685)}function Kn(N,E,q,Z,xe){Z[xe+0]=jr(N,q),Z[xe+1]=vr(N,E,q),Z[xe+2]=xn(N,E)}function Un(N,E,q,Z,xe){Z[xe+0]=xn(N,E),Z[xe+1]=vr(N,E,q),Z[xe+2]=jr(N,q)}function Ir(N,E,q,Z,xe){var Ne=vr(N,E,q);E=Ne<<3&224|xn(N,E)>>3,Z[xe+0]=248&jr(N,q)|Ne>>5,Z[xe+1]=E}function Er(N,E,q,Z,xe){var Ne=240&xn(N,E)|15;Z[xe+0]=240&jr(N,q)|vr(N,E,q)>>4,Z[xe+1]=Ne}function Br(N,E,q,Z,xe){Z[xe+0]=255,Kn(N,E,q,Z,xe+1)}function zr(N,E,q,Z,xe){Un(N,E,q,Z,xe),Z[xe+3]=255}function en(N,E,q,Z,xe){Kn(N,E,q,Z,xe),Z[xe+3]=255}function cn(N,E){return 0>N?0:N>E?E:N}function mr(N,E,q){A[N]=function(Z,xe,Ne,Ae,Te,Fe,Ke,_t,Zt){for(var Xe=_t+(-2&Zt)*q;_t!=Xe;)E(Z[xe+0],Ne[Ae+0],Te[Fe+0],Ke,_t),E(Z[xe+1],Ne[Ae+0],Te[Fe+0],Ke,_t+q),xe+=2,++Ae,++Fe,_t+=2*q;1&Zt&&E(Z[xe+0],Ne[Ae+0],Te[Fe+0],Ke,_t)}}function Ur(N,E,q){return q==0?N==0?E==0?6:5:E==0?4:0:q}function gr(N,E,q,Z,xe){switch(N>>>30){case 3:ql(E,q,Z,xe,0);break;case 2:Vo(E,q,Z,xe);break;case 1:Ia(E,q,Z,xe)}}function _r(N,E){var q,Z,xe=E.M,Ne=E.Nb,Ae=N.oc,Te=N.pc+40,Fe=N.oc,Ke=N.pc+584,_t=N.oc,Zt=N.pc+600;for(q=0;16>q;++q)Ae[Te+32*q-1]=129;for(q=0;8>q;++q)Fe[Ke+32*q-1]=129,_t[Zt+32*q-1]=129;for(0<xe?Ae[Te-1-32]=Fe[Ke-1-32]=_t[Zt-1-32]=129:(s(Ae,Te-32-1,127,21),s(Fe,Ke-32-1,127,9),s(_t,Zt-32-1,127,9)),Z=0;Z<N.za;++Z){var Xe=E.ya[E.aa+Z];if(0<Z){for(q=-1;16>q;++q)n(Ae,Te+32*q-4,Ae,Te+32*q+12,4);for(q=-1;8>q;++q)n(Fe,Ke+32*q-4,Fe,Ke+32*q+4,4),n(_t,Zt+32*q-4,_t,Zt+32*q+4,4)}var Tt=N.Gd,Ut=N.Hd+Z,wr=Xe.ad,Jt=Xe.Hc;if(0<xe&&(n(Ae,Te-32,Tt[Ut].y,0,16),n(Fe,Ke-32,Tt[Ut].f,0,8),n(_t,Zt-32,Tt[Ut].ea,0,8)),Xe.Za){var Cr=Ae,Ar=Te-32+16;for(0<xe&&(Z>=N.za-1?s(Cr,Ar,Tt[Ut].y[15],4):n(Cr,Ar,Tt[Ut+1].y,0,4)),q=0;4>q;q++)Cr[Ar+128+q]=Cr[Ar+256+q]=Cr[Ar+384+q]=Cr[Ar+0+q];for(q=0;16>q;++q,Jt<<=2)Cr=Ae,Ar=Te+sL[q],ua[Xe.Ob[q]](Cr,Ar),gr(Jt,wr,16*+q,Cr,Ar)}else if(Cr=Ur(Z,xe,Xe.Ob[0]),ga[Cr](Ae,Te),Jt!=0)for(q=0;16>q;++q,Jt<<=2)gr(Jt,wr,16*+q,Ae,Te+sL[q]);for(q=Xe.Gc,Cr=Ur(Z,xe,Xe.Dd),_n[Cr](Fe,Ke),_n[Cr](_t,Zt),Jt=wr,Cr=Fe,Ar=Ke,255&(Xe=0|q)&&(170&Xe?ys(Jt,256,Cr,Ar):Ka(Jt,256,Cr,Ar)),Xe=_t,Jt=Zt,255&(q>>=8)&&(170&q?ys(wr,320,Xe,Jt):Ka(wr,320,Xe,Jt)),xe<N.Ub-1&&(n(Tt[Ut].y,0,Ae,Te+480,16),n(Tt[Ut].f,0,Fe,Ke+224,8),n(Tt[Ut].ea,0,_t,Zt+224,8)),q=8*Ne*N.B,Tt=N.sa,Ut=N.ta+16*Z+16*Ne*N.R,wr=N.qa,Xe=N.ra+8*Z+q,Jt=N.Ha,Cr=N.Ia+8*Z+q,q=0;16>q;++q)n(Tt,Ut+q*N.R,Ae,Te+32*q,16);for(q=0;8>q;++q)n(wr,Xe+q*N.B,Fe,Ke+32*q,8),n(Jt,Cr+q*N.B,_t,Zt+32*q,8)}}function Xt(N,E,q,Z,xe,Ne,Ae,Te,Fe){var Ke=[0],_t=[0],Zt=0,Xe=Fe!=null?Fe.kd:0,Tt=Fe??new ve;if(N==null||12>q)return 7;Tt.data=N,Tt.w=E,Tt.ha=q,E=[E],q=[q],Tt.gb=[Tt.gb];e:{var Ut=E,wr=q,Jt=Tt.gb;if(t(N!=null),t(wr!=null),t(Jt!=null),Jt[0]=0,12<=wr[0]&&!r(N,Ut[0],"RIFF")){if(r(N,Ut[0]+8,"WEBP")){Jt=3;break e}var Cr=ne(N,Ut[0]+4);if(12>Cr||4294967286<Cr){Jt=3;break e}if(Xe&&Cr>wr[0]-8){Jt=7;break e}Jt[0]=Cr,Ut[0]+=12,wr[0]-=12}Jt=0}if(Jt!=0)return Jt;for(Cr=0<Tt.gb[0],q=q[0];;){e:{var Ar=N;wr=E,Jt=q;var Hr=Ke,Rr=_t,$n=Ut=[0];if((Mn=Zt=[Zt])[0]=0,8>Jt[0])Jt=7;else{if(!r(Ar,wr[0],"VP8X")){if(ne(Ar,wr[0]+4)!=10){Jt=3;break e}if(18>Jt[0]){Jt=7;break e}var An=ne(Ar,wr[0]+8),ba=1+Re(Ar,wr[0]+12);if(2147483648<=ba*(Ar=1+Re(Ar,wr[0]+15))){Jt=3;break e}$n!=null&&($n[0]=An),Hr!=null&&(Hr[0]=ba),Rr!=null&&(Rr[0]=Ar),wr[0]+=18,Jt[0]-=18,Mn[0]=1}Jt=0}}if(Zt=Zt[0],Ut=Ut[0],Jt!=0)return Jt;if(wr=!!(2&Ut),!Cr&&Zt)return 3;if(Ne!=null&&(Ne[0]=!!(16&Ut)),Ae!=null&&(Ae[0]=wr),Te!=null&&(Te[0]=0),Ae=Ke[0],Ut=_t[0],Zt&&wr&&Fe==null){Jt=0;break}if(4>q){Jt=7;break}if(Cr&&Zt||!Cr&&!Zt&&!r(N,E[0],"ALPH")){q=[q],Tt.na=[Tt.na],Tt.P=[Tt.P],Tt.Sa=[Tt.Sa];e:{An=N,Jt=E,Cr=q;var Mn=Tt.gb;Hr=Tt.na,Rr=Tt.P,$n=Tt.Sa,ba=22,t(An!=null),t(Cr!=null),Ar=Jt[0];var La=Cr[0];for(t(Hr!=null),t($n!=null),Hr[0]=null,Rr[0]=null,$n[0]=0;;){if(Jt[0]=Ar,Cr[0]=La,8>La){Jt=7;break e}var Wo=ne(An,Ar+4);if(4294967286<Wo){Jt=3;break e}var wa=8+Wo+1&-2;if(ba+=wa,0<Mn&&ba>Mn){Jt=3;break e}if(!r(An,Ar,"VP8 ")||!r(An,Ar,"VP8L")){Jt=0;break e}if(La[0]<wa){Jt=7;break e}r(An,Ar,"ALPH")||(Hr[0]=An,Rr[0]=Ar+8,$n[0]=Wo),Ar+=wa,La-=wa}}if(q=q[0],Tt.na=Tt.na[0],Tt.P=Tt.P[0],Tt.Sa=Tt.Sa[0],Jt!=0)break}q=[q],Tt.Ja=[Tt.Ja],Tt.xa=[Tt.xa];e:if(Mn=N,Jt=E,Cr=q,Hr=Tt.gb[0],Rr=Tt.Ja,$n=Tt.xa,An=Jt[0],Ar=!r(Mn,An,"VP8 "),ba=!r(Mn,An,"VP8L"),t(Mn!=null),t(Cr!=null),t(Rr!=null),t($n!=null),8>Cr[0])Jt=7;else{if(Ar||ba){if(Mn=ne(Mn,An+4),12<=Hr&&Mn>Hr-12){Jt=3;break e}if(Xe&&Mn>Cr[0]-8){Jt=7;break e}Rr[0]=Mn,Jt[0]+=8,Cr[0]-=8,$n[0]=ba}else $n[0]=5<=Cr[0]&&Mn[An+0]==47&&!(Mn[An+4]>>5),Rr[0]=Cr[0];Jt=0}if(q=q[0],Tt.Ja=Tt.Ja[0],Tt.xa=Tt.xa[0],E=E[0],Jt!=0)break;if(4294967286<Tt.Ja)return 3;if(Te==null||wr||(Te[0]=Tt.xa?2:1),Ae=[Ae],Ut=[Ut],Tt.xa){if(5>q){Jt=7;break}Te=Ae,Xe=Ut,wr=Ne,N==null||5>q?N=0:5<=q&&N[E+0]==47&&!(N[E+4]>>5)?(Cr=[0],Mn=[0],Hr=[0],X(Rr=new B,N,E,q),jt(Rr,Cr,Mn,Hr)?(Te!=null&&(Te[0]=Cr[0]),Xe!=null&&(Xe[0]=Mn[0]),wr!=null&&(wr[0]=Hr[0]),N=1):N=0):N=0}else{if(10>q){Jt=7;break}Te=Ut,N==null||10>q||!In(N,E+3,q-3)?N=0:(Xe=N[E+0]|N[E+1]<<8|N[E+2]<<16,wr=16383&(N[E+7]<<8|N[E+6]),N=16383&(N[E+9]<<8|N[E+8]),1&Xe||3<(Xe>>1&7)||!(Xe>>4&1)||Xe>>5>=Tt.Ja||!wr||!N?N=0:(Ae&&(Ae[0]=wr),Te&&(Te[0]=N),N=1))}if(!N||(Ae=Ae[0],Ut=Ut[0],Zt&&(Ke[0]!=Ae||_t[0]!=Ut)))return 3;Fe!=null&&(Fe[0]=Tt,Fe.offset=E-Fe.w,t(4294967286>E-Fe.w),t(Fe.offset==Fe.ha-q));break}return Jt==0||Jt==7&&Zt&&Fe==null?(Ne!=null&&(Ne[0]|=Tt.na!=null&&0<Tt.na.length),Z!=null&&(Z[0]=Ae),xe!=null&&(xe[0]=Ut),0):Jt}function Lr(N,E,q){var Z=E.width,xe=E.height,Ne=0,Ae=0,Te=Z,Fe=xe;if(E.Da=N!=null&&0<N.Da,E.Da&&(Te=N.cd,Fe=N.bd,Ne=N.v,Ae=N.j,11>q||(Ne&=-2,Ae&=-2),0>Ne||0>Ae||0>=Te||0>=Fe||Ne+Te>Z||Ae+Fe>xe))return 0;if(E.v=Ne,E.j=Ae,E.va=Ne+Te,E.o=Ae+Fe,E.U=Te,E.T=Fe,E.da=N!=null&&0<N.da,E.da){if(!at(Te,Fe,q=[N.ib],Ne=[N.hb]))return 0;E.ib=q[0],E.hb=Ne[0]}return E.ob=N!=null&&N.ob,E.Kb=N==null||!N.Sd,E.da&&(E.ob=E.ib<3*Z/4&&E.hb<3*xe/4,E.Kb=0),1}function br(N){if(N==null)return 2;if(11>N.S){var E=N.f.RGBA;E.fb+=(N.height-1)*E.A,E.A=-E.A}else E=N.f.kb,N=N.height,E.O+=(N-1)*E.fa,E.fa=-E.fa,E.N+=(N-1>>1)*E.Ab,E.Ab=-E.Ab,E.W+=(N-1>>1)*E.Db,E.Db=-E.Db,E.F!=null&&(E.J+=(N-1)*E.lb,E.lb=-E.lb);return 0}function Gr(N,E,q,Z){if(Z==null||0>=N||0>=E)return 2;if(q!=null){if(q.Da){var xe=q.cd,Ne=q.bd,Ae=-2&q.v,Te=-2&q.j;if(0>Ae||0>Te||0>=xe||0>=Ne||Ae+xe>N||Te+Ne>E)return 2;N=xe,E=Ne}if(q.da){if(!at(N,E,xe=[q.ib],Ne=[q.hb]))return 2;N=xe[0],E=Ne[0]}}Z.width=N,Z.height=E;e:{var Fe=Z.width,Ke=Z.height;if(N=Z.S,0>=Fe||0>=Ke||!(N>=De&&13>N))N=2;else{if(0>=Z.Rd&&Z.sd==null){Ae=Ne=xe=E=0;var _t=(Te=Fe*oL[N])*Ke;if(11>N||(Ne=(Ke+1)/2*(E=(Fe+1)/2),N==12&&(Ae=(xe=Fe)*Ke)),(Ke=o(_t+2*Ne+Ae))==null){N=1;break e}Z.sd=Ke,11>N?((Fe=Z.f.RGBA).eb=Ke,Fe.fb=0,Fe.A=Te,Fe.size=_t):((Fe=Z.f.kb).y=Ke,Fe.O=0,Fe.fa=Te,Fe.Fd=_t,Fe.f=Ke,Fe.N=0+_t,Fe.Ab=E,Fe.Cd=Ne,Fe.ea=Ke,Fe.W=0+_t+Ne,Fe.Db=E,Fe.Ed=Ne,N==12&&(Fe.F=Ke,Fe.J=0+_t+2*Ne),Fe.Tc=Ae,Fe.lb=xe)}if(E=1,xe=Z.S,Ne=Z.width,Ae=Z.height,xe>=De&&13>xe)if(11>xe)N=Z.f.RGBA,E&=(Te=Math.abs(N.A))*(Ae-1)+Ne<=N.size,E&=Te>=Ne*oL[xe],E&=N.eb!=null;else{N=Z.f.kb,Te=(Ne+1)/2,_t=(Ae+1)/2,Fe=Math.abs(N.fa),Ke=Math.abs(N.Ab);var Zt=Math.abs(N.Db),Xe=Math.abs(N.lb),Tt=Xe*(Ae-1)+Ne;E&=Fe*(Ae-1)+Ne<=N.Fd,E&=Ke*(_t-1)+Te<=N.Cd,E=(E&=Zt*(_t-1)+Te<=N.Ed)&Fe>=Ne&Ke>=Te&Zt>=Te,E&=N.y!=null,E&=N.f!=null,E&=N.ea!=null,xe==12&&(E&=Xe>=Ne,E&=Tt<=N.Tc,E&=N.F!=null)}else E=0;N=E?0:2}}return N!=0||q!=null&&q.fd&&(N=br(Z)),N}var yn=64,Zr=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],kn=24,ya=32,Ca=8,ks=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ht("Predictor0","PredictorAdd0"),A.Predictor0=function(){return 4278190080},A.Predictor1=function(N){return N},A.Predictor2=function(N,E,q){return E[q+0]},A.Predictor3=function(N,E,q){return E[q+1]},A.Predictor4=function(N,E,q){return E[q-1]},A.Predictor5=function(N,E,q){return be(be(N,E[q+1]),E[q+0])},A.Predictor6=function(N,E,q){return be(N,E[q-1])},A.Predictor7=function(N,E,q){return be(N,E[q+0])},A.Predictor8=function(N,E,q){return be(E[q-1],E[q+0])},A.Predictor9=function(N,E,q){return be(E[q+0],E[q+1])},A.Predictor10=function(N,E,q){return be(be(N,E[q-1]),be(E[q+0],E[q+1]))},A.Predictor11=function(N,E,q){var Z=E[q+0];return 0>=Ge(Z>>24&255,N>>24&255,(E=E[q-1])>>24&255)+Ge(Z>>16&255,N>>16&255,E>>16&255)+Ge(Z>>8&255,N>>8&255,E>>8&255)+Ge(255&Z,255&N,255&E)?Z:N},A.Predictor12=function(N,E,q){var Z=E[q+0];return(Ct((N>>24&255)+(Z>>24&255)-((E=E[q-1])>>24&255))<<24|Ct((N>>16&255)+(Z>>16&255)-(E>>16&255))<<16|Ct((N>>8&255)+(Z>>8&255)-(E>>8&255))<<8|Ct((255&N)+(255&Z)-(255&E)))>>>0},A.Predictor13=function(N,E,q){var Z=E[q-1];return(wt((N=be(N,E[q+0]))>>24&255,Z>>24&255)<<24|wt(N>>16&255,Z>>16&255)<<16|wt(N>>8&255,Z>>8&255)<<8|wt(255&N,255&Z))>>>0};var es=A.PredictorAdd0;A.PredictorAdd1=Je,ht("Predictor2","PredictorAdd2"),ht("Predictor3","PredictorAdd3"),ht("Predictor4","PredictorAdd4"),ht("Predictor5","PredictorAdd5"),ht("Predictor6","PredictorAdd6"),ht("Predictor7","PredictorAdd7"),ht("Predictor8","PredictorAdd8"),ht("Predictor9","PredictorAdd9"),ht("Predictor10","PredictorAdd10"),ht("Predictor11","PredictorAdd11"),ht("Predictor12","PredictorAdd12"),ht("Predictor13","PredictorAdd13");var ka=A.PredictorAdd2;ze("ColorIndexInverseTransform","MapARGB","32b",function(N){return N>>8&255},function(N){return N}),ze("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(N){return N},function(N){return N>>8&255});var ma,Co=A.ColorIndexInverseTransform,Js=A.MapARGB,Is=A.VP8LColorIndexInverseTransformAlpha,Us=A.MapAlpha,Zc=A.VP8LPredictorsAdd=[];Zc.length=16,(A.VP8LPredictors=[]).length=16,(A.VP8LPredictorsAdd_C=[]).length=16,(A.VP8LPredictors_C=[]).length=16;var pm,np,Uo,go,Cu,Bl,ll,ql,Vo,ys,Ia,Ka,us,vo,ed,ap,Pu,gm,Gg,Au,qd,Kg,Xg,cl,vm,sp,o2,zd,J0=o(511),i2=o(2041),l2=o(225),c2=o(767),d2=0,Yg=i2,op=l2,Ci=c2,ii=J0,De=0,ft=1,Ot=2,Lt=3,Yt=4,Pr=5,Wr=6,Vr=7,Wn=8,Na=9,ia=10,jn=[2,3,7],Po=[3,3,11],li=[280,256,256,256,40],Vi=[0,1,1,1,0],td=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],dl=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],rd=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],xm=8,Ma=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],rs=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Pi=null,xo=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],ul=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Ra=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],ao=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],fl=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],gf=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Vs=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ga=[],ua=[],_n=[],ja=1,ts=2,Ao=[],ci=[];Gt("UpsampleRgbLinePair",Kn,3),Gt("UpsampleBgrLinePair",Un,3),Gt("UpsampleRgbaLinePair",en,4),Gt("UpsampleBgraLinePair",zr,4),Gt("UpsampleArgbLinePair",Br,4),Gt("UpsampleRgba4444LinePair",Er,2),Gt("UpsampleRgb565LinePair",Ir,2);var Os=A.UpsampleRgbLinePair,Ai=A.UpsampleBgrLinePair,zl=A.UpsampleRgbaLinePair,wP=A.UpsampleBgraLinePair,Eu=A.UpsampleArgbLinePair,rL=A.UpsampleRgba4444LinePair,Boe=A.UpsampleRgb565LinePair,u2=16,f2=1<<u2-1,Q0=-227,jP=482,nL=6,qoe=(256<<nL)-1,aL=0,zoe=o(256),Uoe=o(256),Voe=o(256),Woe=o(256),Hoe=o(jP-Q0),Goe=o(jP-Q0);mr("YuvToRgbRow",Kn,3),mr("YuvToBgrRow",Un,3),mr("YuvToRgbaRow",en,4),mr("YuvToBgraRow",zr,4),mr("YuvToArgbRow",Br,4),mr("YuvToRgba4444Row",Er,2),mr("YuvToRgb565Row",Ir,2);var sL=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],m2=[0,2,8],Koe=[8,7,6,4,4,2,2,2,1,1,1,1],Xoe=1;this.WebPDecodeRGBA=function(N,E,q,Z,xe){var Ne=ft,Ae=new J,Te=new dr;Ae.ba=Te,Te.S=Ne,Te.width=[Te.width],Te.height=[Te.height];var Fe=Te.width,Ke=Te.height,_t=new ur;if(_t==null||N==null)var Zt=2;else t(_t!=null),Zt=Xt(N,E,q,_t.width,_t.height,_t.Pd,_t.Qd,_t.format,null);if(Zt!=0?Fe=0:(Fe!=null&&(Fe[0]=_t.width[0]),Ke!=null&&(Ke[0]=_t.height[0]),Fe=1),Fe){Te.width=Te.width[0],Te.height=Te.height[0],Z!=null&&(Z[0]=Te.width),xe!=null&&(xe[0]=Te.height);e:{if(Z=new Qt,(xe=new ve).data=N,xe.w=E,xe.ha=q,xe.kd=1,E=[0],t(xe!=null),((N=Xt(xe.data,xe.w,xe.ha,null,null,null,E,null,xe))==0||N==7)&&E[0]&&(N=4),(E=N)==0){if(t(Ae!=null),Z.data=xe.data,Z.w=xe.w+xe.offset,Z.ha=xe.ha-xe.offset,Z.put=Be,Z.ac=$e,Z.bc=et,Z.ma=Ae,xe.xa){if((N=Dr())==null){Ae=1;break e}if(function(Xe,Tt){var Ut=[0],wr=[0],Jt=[0];t:for(;;){if(Xe==null)return 0;if(Tt==null)return Xe.a=2,0;if(Xe.l=Tt,Xe.a=0,X(Xe.m,Tt.data,Tt.w,Tt.ha),!jt(Xe.m,Ut,wr,Jt)){Xe.a=3;break t}if(Xe.xb=ts,Tt.width=Ut[0],Tt.height=wr[0],!Fr(Ut[0],wr[0],1,Xe,null))break t;return 1}return t(Xe.a!=0),0}(N,Z)){if(Z=(E=Gr(Z.width,Z.height,Ae.Oa,Ae.ba))==0){t:{Z=N;r:for(;;){if(Z==null){Z=0;break t}if(t(Z.s.yc!=null),t(Z.s.Ya!=null),t(0<Z.s.Wb),t((q=Z.l)!=null),t((xe=q.ma)!=null),Z.xb!=0){if(Z.ca=xe.ba,Z.tb=xe.tb,t(Z.ca!=null),!Lr(xe.Oa,q,Lt)){Z.a=2;break r}if(!Tn(Z,q.width)||q.da)break r;if((q.da||rr(Z.ca.S))&&At(),11>Z.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),Z.ca.f.kb.F!=null&&At()),Z.Pb&&0<Z.s.ua&&Z.s.vb.X==null&&!ie(Z.s.vb,Z.s.Wa.Xa)){Z.a=1;break r}Z.xb=0}if(!kr(Z,Z.V,Z.Ba,Z.c,Z.i,q.o,zt))break r;xe.Dc=Z.Ma,Z=1;break t}t(Z.a!=0),Z=0}Z=!Z}Z&&(E=N.a)}else E=N.a}else{if((N=new fn)==null){Ae=1;break e}if(N.Fa=xe.na,N.P=xe.P,N.qc=xe.Sa,Dn(N,Z)){if((E=Gr(Z.width,Z.height,Ae.Oa,Ae.ba))==0){if(N.Aa=0,q=Ae.Oa,t((xe=N)!=null),q!=null){if(0<(Fe=0>(Fe=q.Md)?0:100<Fe?255:255*Fe/100)){for(Ke=_t=0;4>Ke;++Ke)12>(Zt=xe.pb[Ke]).lc&&(Zt.ia=Fe*Koe[0>Zt.lc?0:Zt.lc]>>3),_t|=Zt.ia;_t&&(alert("todo:VP8InitRandom"),xe.ia=1)}xe.Ga=q.Id,100<xe.Ga?xe.Ga=100:0>xe.Ga&&(xe.Ga=0)}(function(Xe,Tt){if(Xe==null)return 0;if(Tt==null)return nn(Xe,2,"NULL VP8Io parameter in VP8Decode().");if(!Xe.cb&&!Dn(Xe,Tt))return 0;if(t(Xe.cb),Tt.ac==null||Tt.ac(Tt)){Tt.ob&&(Xe.L=0);var Ut=m2[Xe.L];if(Xe.L==2?(Xe.yb=0,Xe.zb=0):(Xe.yb=Tt.v-Ut>>4,Xe.zb=Tt.j-Ut>>4,0>Xe.yb&&(Xe.yb=0),0>Xe.zb&&(Xe.zb=0)),Xe.Va=Tt.o+15+Ut>>4,Xe.Hb=Tt.va+15+Ut>>4,Xe.Hb>Xe.za&&(Xe.Hb=Xe.za),Xe.Va>Xe.Ub&&(Xe.Va=Xe.Ub),0<Xe.L){var wr=Xe.ed;for(Ut=0;4>Ut;++Ut){var Jt;if(Xe.Qa.Cb){var Cr=Xe.Qa.Lb[Ut];Xe.Qa.Fb||(Cr+=wr.Tb)}else Cr=wr.Tb;for(Jt=0;1>=Jt;++Jt){var Ar=Xe.gd[Ut][Jt],Hr=Cr;if(wr.Pc&&(Hr+=wr.vd[0],Jt&&(Hr+=wr.od[0])),0<(Hr=0>Hr?0:63<Hr?63:Hr)){var Rr=Hr;0<wr.wb&&(Rr=4<wr.wb?Rr>>2:Rr>>1)>9-wr.wb&&(Rr=9-wr.wb),1>Rr&&(Rr=1),Ar.dd=Rr,Ar.tc=2*Hr+Rr,Ar.ld=40<=Hr?2:15<=Hr?1:0}else Ar.tc=0;Ar.La=Jt}}}Ut=0}else nn(Xe,6,"Frame setup failed"),Ut=Xe.a;if(Ut=Ut==0){if(Ut){Xe.$c=0,0<Xe.Aa||(Xe.Ic=Xoe);t:{Ut=Xe.Ic,wr=4*(Rr=Xe.za);var $n=32*Rr,An=Rr+1,ba=0<Xe.L?Rr*(0<Xe.Aa?2:1):0,Mn=(Xe.Aa==2?2:1)*Rr;if((Ar=wr+832+(Jt=3*(16*Ut+m2[Xe.L])/2*$n)+(Cr=Xe.Fa!=null&&0<Xe.Fa.length?Xe.Kc.c*Xe.Kc.i:0))!=Ar)Ut=0;else{if(Ar>Xe.Vb){if(Xe.Vb=0,Xe.Ec=o(Ar),Xe.Fc=0,Xe.Ec==null){Ut=nn(Xe,1,"no memory during frame initialization.");break t}Xe.Vb=Ar}Ar=Xe.Ec,Hr=Xe.Fc,Xe.Ac=Ar,Xe.Bc=Hr,Hr+=wr,Xe.Gd=i($n,Qr),Xe.Hd=0,Xe.rb=i(An+1,st),Xe.sb=1,Xe.wa=ba?i(ba,lr):null,Xe.Y=0,Xe.D.Nb=0,Xe.D.wa=Xe.wa,Xe.D.Y=Xe.Y,0<Xe.Aa&&(Xe.D.Y+=Rr),t(!0),Xe.oc=Ar,Xe.pc=Hr,Hr+=832,Xe.ya=i(Mn,ar),Xe.aa=0,Xe.D.ya=Xe.ya,Xe.D.aa=Xe.aa,Xe.Aa==2&&(Xe.D.aa+=Rr),Xe.R=16*Rr,Xe.B=8*Rr,Rr=($n=m2[Xe.L])*Xe.R,$n=$n/2*Xe.B,Xe.sa=Ar,Xe.ta=Hr+Rr,Xe.qa=Xe.sa,Xe.ra=Xe.ta+16*Ut*Xe.R+$n,Xe.Ha=Xe.qa,Xe.Ia=Xe.ra+8*Ut*Xe.B+$n,Xe.$c=0,Hr+=Jt,Xe.mb=Cr?Ar:null,Xe.nb=Cr?Hr:null,t(Hr+Cr<=Xe.Fc+Xe.Vb),He(Xe),s(Xe.Ac,Xe.Bc,0,wr),Ut=1}}if(Ut){if(Tt.ka=0,Tt.y=Xe.sa,Tt.O=Xe.ta,Tt.f=Xe.qa,Tt.N=Xe.ra,Tt.ea=Xe.Ha,Tt.Vd=Xe.Ia,Tt.fa=Xe.R,Tt.Rc=Xe.B,Tt.F=null,Tt.J=0,!d2){for(Ut=-255;255>=Ut;++Ut)J0[255+Ut]=0>Ut?-Ut:Ut;for(Ut=-1020;1020>=Ut;++Ut)i2[1020+Ut]=-128>Ut?-128:127<Ut?127:Ut;for(Ut=-112;112>=Ut;++Ut)l2[112+Ut]=-16>Ut?-16:15<Ut?15:Ut;for(Ut=-255;510>=Ut;++Ut)c2[255+Ut]=0>Ut?0:255<Ut?255:Ut;d2=1}ll=lt,ql=H,ys=F,Ia=Le,Ka=it,Vo=K,us=hm,vo=pf,ed=L,ap=ge,Pu=Es,gm=po,Gg=We,Au=mt,qd=qo,Kg=hc,Xg=$l,cl=hf,ua[0]=da,ua[1]=Ve,ua[2]=Sa,ua[3]=_a,ua[4]=Xs,ua[5]=Za,ua[6]=Ys,ua[7]=ol,ua[8]=fc,ua[9]=hs,ga[0]=Pn,ga[1]=Sr,ga[2]=Or,ga[3]=fr,ga[4]=qn,ga[5]=zn,ga[6]=sn,_n[0]=Ll,_n[1]=kt,_n[2]=mc,_n[3]=Ui,_n[4]=qs,_n[5]=Bd,_n[6]=Qc,Ut=1}else Ut=0}Ut&&(Ut=function(La,Wo){for(La.M=0;La.M<La.Va;++La.M){var wa,Rn=La.Jc[La.M&La.Xb],dn=La.m,yo=La;for(wa=0;wa<yo.za;++wa){var va=dn,Ba=yo,Ts=Ba.Ac,Ei=Ba.Bc+4*wa,ml=Ba.zc,so=Ba.ya[Ba.aa+wa];if(Ba.Qa.Bb?so.$b=ae(va,Ba.Pa.jb[0])?2+ae(va,Ba.Pa.jb[2]):ae(va,Ba.Pa.jb[1]):so.$b=0,Ba.kc&&(so.Ad=ae(va,Ba.Bd)),so.Za=!ae(va,145)+0,so.Za){var Wi=so.Ob,hl=0;for(Ba=0;4>Ba;++Ba){var Ho,Va=ml[0+Ba];for(Ho=0;4>Ho;++Ho){Va=fl[Ts[Ei+Ho]][Va];for(var ns=Ra[ae(va,Va[0])];0<ns;)ns=Ra[2*ns+ae(va,Va[ns])];Va=-ns,Ts[Ei+Ho]=Va}n(Wi,hl,Ts,Ei,4),hl+=4,ml[0+Ba]=Va}}else Va=ae(va,156)?ae(va,128)?1:3:ae(va,163)?2:0,so.Ob[0]=Va,s(Ts,Ei,Va,4),s(ml,0,Va,4);so.Dd=ae(va,142)?ae(va,114)?ae(va,183)?1:3:2:0}if(yo.m.Ka)return nn(La,7,"Premature end-of-partition0 encountered.");for(;La.ja<La.za;++La.ja){if(yo=Rn,va=(dn=La).rb[dn.sb-1],Ts=dn.rb[dn.sb+dn.ja],wa=dn.ya[dn.aa+dn.ja],Ei=dn.kc?wa.Ad:0)va.la=Ts.la=0,wa.Za||(va.Na=Ts.Na=0),wa.Hc=0,wa.Gc=0,wa.ia=0;else{var oo,as;if(va=Ts,Ts=yo,Ei=dn.Pa.Xc,ml=dn.ya[dn.aa+dn.ja],so=dn.pb[ml.$b],Ba=ml.ad,Wi=0,hl=dn.rb[dn.sb-1],Va=Ho=0,s(Ba,Wi,0,384),ml.Za)var ki=0,Ud=Ei[3];else{ns=o(16);var bo=va.Na+hl.Na;if(bo=Pi(Ts,Ei[1],bo,so.Eb,0,ns,0),va.Na=hl.Na=(0<bo)+0,1<bo)ll(ns,0,Ba,Wi);else{var Ul=ns[0]+3>>3;for(ns=0;256>ns;ns+=16)Ba[Wi+ns]=Ul}ki=1,Ud=Ei[0]}var ps=15&va.la,Go=15&hl.la;for(ns=0;4>ns;++ns){var pc=1&Go;for(Ul=as=0;4>Ul;++Ul)ps=ps>>1|(pc=(bo=Pi(Ts,Ud,bo=pc+(1&ps),so.Sc,ki,Ba,Wi))>ki)<<7,as=as<<2|(3<bo?3:1<bo?2:Ba[Wi+0]!=0),Wi+=16;ps>>=4,Go=Go>>1|pc<<7,Ho=(Ho<<8|as)>>>0}for(Ud=ps,ki=Go>>4,oo=0;4>oo;oo+=2){for(as=0,ps=va.la>>4+oo,Go=hl.la>>4+oo,ns=0;2>ns;++ns){for(pc=1&Go,Ul=0;2>Ul;++Ul)bo=pc+(1&ps),ps=ps>>1|(pc=0<(bo=Pi(Ts,Ei[2],bo,so.Qc,0,Ba,Wi)))<<3,as=as<<2|(3<bo?3:1<bo?2:Ba[Wi+0]!=0),Wi+=16;ps>>=2,Go=Go>>1|pc<<5}Va|=as<<4*oo,Ud|=ps<<4<<oo,ki|=(240&Go)<<oo}va.la=Ud,hl.la=ki,ml.Hc=Ho,ml.Gc=Va,ml.ia=43690&Va?0:so.ia,Ei=!(Ho|Va)}if(0<dn.L&&(dn.wa[dn.Y+dn.ja]=dn.gd[wa.$b][wa.Za],dn.wa[dn.Y+dn.ja].La|=!Ei),yo.Ka)return nn(La,7,"Premature end-of-file encountered.")}if(He(La),dn=Wo,yo=1,wa=(Rn=La).D,va=0<Rn.L&&Rn.M>=Rn.zb&&Rn.M<=Rn.Va,Rn.Aa==0)t:{if(wa.M=Rn.M,wa.uc=va,_r(Rn,wa),yo=1,wa=(as=Rn.D).Nb,va=(Va=m2[Rn.L])*Rn.R,Ts=Va/2*Rn.B,ns=16*wa*Rn.R,Ul=8*wa*Rn.B,Ei=Rn.sa,ml=Rn.ta-va+ns,so=Rn.qa,Ba=Rn.ra-Ts+Ul,Wi=Rn.Ha,hl=Rn.Ia-Ts+Ul,Go=(ps=as.M)==0,Ho=ps>=Rn.Va-1,Rn.Aa==2&&_r(Rn,as),as.uc)for(pc=(bo=Rn).D.M,t(bo.D.uc),as=bo.yb;as<bo.Hb;++as){ki=as,Ud=pc;var pl=(gc=(Ii=bo).D).Nb;oo=Ii.R;var gc=gc.wa[gc.Y+ki],vc=Ii.sa,Vl=Ii.ta+16*pl*oo+16*ki,xc=gc.dd,bs=gc.tc;if(bs!=0)if(t(3<=bs),Ii.L==1)0<ki&&Kg(vc,Vl,oo,bs+4),gc.La&&cl(vc,Vl,oo,bs),0<Ud&&qd(vc,Vl,oo,bs+4),gc.La&&Xg(vc,Vl,oo,bs);else{var yc=Ii.B,Vd=Ii.qa,ip=Ii.ra+8*pl*yc+8*ki,vf=Ii.Ha,Ii=Ii.Ia+8*pl*yc+8*ki;pl=gc.ld,0<ki&&(vo(vc,Vl,oo,bs+4,xc,pl),ap(Vd,ip,vf,Ii,yc,bs+4,xc,pl)),gc.La&&(gm(vc,Vl,oo,bs,xc,pl),Au(Vd,ip,vf,Ii,yc,bs,xc,pl)),0<Ud&&(us(vc,Vl,oo,bs+4,xc,pl),ed(Vd,ip,vf,Ii,yc,bs+4,xc,pl)),gc.La&&(Pu(vc,Vl,oo,bs,xc,pl),Gg(Vd,ip,vf,Ii,yc,bs,xc,pl))}}if(Rn.ia&&alert("todo:DitherRow"),dn.put!=null){if(as=16*ps,ps=16*(ps+1),Go?(dn.y=Rn.sa,dn.O=Rn.ta+ns,dn.f=Rn.qa,dn.N=Rn.ra+Ul,dn.ea=Rn.Ha,dn.W=Rn.Ia+Ul):(as-=Va,dn.y=Ei,dn.O=ml,dn.f=so,dn.N=Ba,dn.ea=Wi,dn.W=hl),Ho||(ps-=Va),ps>dn.o&&(ps=dn.o),dn.F=null,dn.J=null,Rn.Fa!=null&&0<Rn.Fa.length&&as<ps&&(dn.J=Ee(Rn,dn,as,ps-as),dn.F=Rn.mb,dn.F==null&&dn.F.length==0)){yo=nn(Rn,3,"Could not decode alpha data.");break t}as<dn.j&&(Va=dn.j-as,as=dn.j,t(!(1&Va)),dn.O+=Rn.R*Va,dn.N+=Rn.B*(Va>>1),dn.W+=Rn.B*(Va>>1),dn.F!=null&&(dn.J+=dn.width*Va)),as<ps&&(dn.O+=dn.v,dn.N+=dn.v>>1,dn.W+=dn.v>>1,dn.F!=null&&(dn.J+=dn.v),dn.ka=as-dn.j,dn.U=dn.va-dn.v,dn.T=ps-as,yo=dn.put(dn))}wa+1!=Rn.Ic||Ho||(n(Rn.sa,Rn.ta-va,Ei,ml+16*Rn.R,va),n(Rn.qa,Rn.ra-Ts,so,Ba+8*Rn.B,Ts),n(Rn.Ha,Rn.Ia-Ts,Wi,hl+8*Rn.B,Ts))}if(!yo)return nn(La,6,"Output aborted.")}return 1}(Xe,Tt)),Tt.bc!=null&&Tt.bc(Tt),Ut&=1}return Ut?(Xe.cb=0,Ut):0})(N,Z)||(E=N.a)}}else E=N.a}E==0&&Ae.Oa!=null&&Ae.Oa.fd&&(E=br(Ae.ba))}Ae=E}Ne=Ae!=0?null:11>Ne?Te.f.RGBA.eb:Te.f.kb.y}else Ne=null;return Ne};var oL=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(A,R){for(var O="",I=0;I<4;I++)O+=String.fromCharCode(A[R++]);return O}function u(A,R){return A[R+0]|A[R+1]<<8}function f(A,R){return(A[R+0]|A[R+1]<<8|A[R+2]<<16)>>>0}function h(A,R){return(A[R+0]|A[R+1]<<8|A[R+2]<<16|A[R+3]<<24)>>>0}new c;var m=[0],v=[0],g=[],y=new c,x=e,b=function(A,R){var O={},I=0,M=!1,D=0,U=0;if(O.frames=[],!function(V,B){for(var Q=0;Q<4;Q++)if(V[B+Q]!="RIFF".charCodeAt(Q))return!0;return!1}(A,R)){for(h(A,R+=4),R+=8;R<A.length;){var z=d(A,R),W=h(A,R+=4);R+=4;var $=W+(1&W);switch(z){case"VP8 ":case"VP8L":O.frames[I]===void 0&&(O.frames[I]={}),(Se=O.frames[I]).src_off=M?U:R-8,Se.src_size=D+W+8,I++,M&&(M=!1,D=0,U=0);break;case"VP8X":(Se=O.header={}).feature_flags=A[R];var X=R+4;Se.canvas_width=1+f(A,X),X+=3,Se.canvas_height=1+f(A,X),X+=3;break;case"ALPH":M=!0,D=$+8,U=R-8;break;case"ANIM":(Se=O.header).bgcolor=h(A,R),X=R+4,Se.loop_count=u(A,X),X+=2;break;case"ANMF":var ye,Se;(Se=O.frames[I]={}).offset_x=2*f(A,R),R+=3,Se.offset_y=2*f(A,R),R+=3,Se.width=1+f(A,R),R+=3,Se.height=1+f(A,R),R+=3,Se.duration=f(A,R),R+=3,ye=A[R++],Se.dispose=1&ye,Se.blend=ye>>1&1}z!="ANMF"&&(R+=$)}return O}}(x,0);b.response=x,b.rgbaoutput=!0,b.dataurl=!1;var w=b.header?b.header:null,j=b.frames?b.frames:null;if(w){w.loop_counter=w.loop_count,m=[w.canvas_height],v=[w.canvas_width];for(var _=0;_<j.length&&j[_].blend!=0;_++);}var S=j[0],C=y.WebPDecodeRGBA(x,S.src_off,S.src_size,v,m);S.rgba=C,S.imgwidth=v[0],S.imgheight=m[0];for(var P=0;P<v[0]*m[0]*4;P++)g[P]=C[P];return this.width=v,this.height=m,this.data=g,this}(function(e){var t,r,n,s,o,i,l,c,d,u=function(V){return V=V||{},this.isStrokeTransparent=V.isStrokeTransparent||!1,this.strokeOpacity=V.strokeOpacity||1,this.strokeStyle=V.strokeStyle||"#000000",this.fillStyle=V.fillStyle||"#000000",this.isFillTransparent=V.isFillTransparent||!1,this.fillOpacity=V.fillOpacity||1,this.font=V.font||"10px sans-serif",this.textBaseline=V.textBaseline||"alphabetic",this.textAlign=V.textAlign||"left",this.lineWidth=V.lineWidth||1,this.lineJoin=V.lineJoin||"miter",this.lineCap=V.lineCap||"butt",this.path=V.path||[],this.transform=V.transform!==void 0?V.transform.clone():new c,this.globalCompositeOperation=V.globalCompositeOperation||"normal",this.globalAlpha=V.globalAlpha||1,this.clip_path=V.clip_path||[],this.currentPoint=V.currentPoint||new i,this.miterLimit=V.miterLimit||10,this.lastPoint=V.lastPoint||new i,this.lineDashOffset=V.lineDashOffset||0,this.lineDash=V.lineDash||[],this.margin=V.margin||[0,0,0,0],this.prevPageLastElemOffset=V.prevPageLastElemOffset||0,this.ignoreClearRect=typeof V.ignoreClearRect!="boolean"||V.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new f(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,o=this.internal.getVerticalCoordinate,i=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,d=new u}]);var f=function(V){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var B=V;Object.defineProperty(this,"pdf",{get:function(){return B}});var Q=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return Q},set:function(ne){Q=!!ne}});var pe=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return pe},set:function(ne){pe=!!ne}});var te=0;Object.defineProperty(this,"posX",{get:function(){return te},set:function(ne){isNaN(ne)||(te=ne)}});var Y=0;Object.defineProperty(this,"posY",{get:function(){return Y},set:function(ne){isNaN(ne)||(Y=ne)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(ne){var ie;typeof ne=="number"?ie=[ne,ne,ne,ne]:((ie=new Array(4))[0]=ne[0],ie[1]=ne.length>=2?ne[1]:ie[0],ie[2]=ne.length>=3?ne[2]:ie[0],ie[3]=ne.length>=4?ne[3]:ie[1]),d.margin=ie}});var ce=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ce},set:function(ne){ce=ne}});var me=0;Object.defineProperty(this,"lastBreak",{get:function(){return me},set:function(ne){me=ne}});var ae=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ae},set:function(ne){ae=ne}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(ne){ne instanceof u&&(d=ne)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(ne){d.path=ne}});var le=[];Object.defineProperty(this,"ctxStack",{get:function(){return le},set:function(ne){le=ne}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ne){var ie;ie=h(ne),this.ctx.fillStyle=ie.style,this.ctx.isFillTransparent=ie.a===0,this.ctx.fillOpacity=ie.a,this.pdf.setFillColor(ie.r,ie.g,ie.b,{a:ie.a}),this.pdf.setTextColor(ie.r,ie.g,ie.b,{a:ie.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ne){var ie=h(ne);this.ctx.strokeStyle=ie.style,this.ctx.isStrokeTransparent=ie.a===0,this.ctx.strokeOpacity=ie.a,ie.a===0?this.pdf.setDrawColor(255,255,255):(ie.a,this.pdf.setDrawColor(ie.r,ie.g,ie.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ne){["butt","round","square"].indexOf(ne)!==-1&&(this.ctx.lineCap=ne,this.pdf.setLineCap(ne))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ne){isNaN(ne)||(this.ctx.lineWidth=ne,this.pdf.setLineWidth(ne))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ne){["bevel","round","miter"].indexOf(ne)!==-1&&(this.ctx.lineJoin=ne,this.pdf.setLineJoin(ne))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ne){isNaN(ne)||(this.ctx.miterLimit=ne,this.pdf.setMiterLimit(ne))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ne){this.ctx.textBaseline=ne}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ne){["right","end","center","left","start"].indexOf(ne)!==-1&&(this.ctx.textAlign=ne)}});var ue=null,Re=null;Object.defineProperty(this,"fontFaces",{get:function(){return Re},set:function(ne){ue=null,Re=ne}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ne){var ie;if(this.ctx.font=ne,(ie=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(ne))!==null){var gt=ie[1];ie[2];var bt=ie[3],at=ie[4];ie[5];var xt=ie[6],Ze=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(at)[2];at=Math.floor(Ze==="px"?parseFloat(at)*this.pdf.internal.scaleFactor:Ze==="em"?parseFloat(at)*this.pdf.getFontSize():parseFloat(at)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(at);var ht=function(Ue){var ze,or,tr=[],Nt=Ue.trim();if(Nt==="")return WE;if(Nt in M9)return[M9[Nt]];for(;Nt!=="";){switch(or=null,ze=(Nt=L9(Nt)).charAt(0)){case'"':case"'":or=DQe(Nt.substring(1),ze);break;default:or=MQe(Nt)}if(or===null||(tr.push(or[0]),(Nt=L9(or[1]))!==""&&Nt.charAt(0)!==","))return WE;Nt=Nt.replace(/^,/,"")}return tr}(xt);if(this.fontFaces){var Wt=function(Ue,ze){if(ue===null){var or=function(tr){var Nt=[];return Object.keys(tr).forEach(function(yr){tr[yr].forEach(function(Me){var dt=null;switch(Me){case"bold":dt={family:yr,weight:"bold"};break;case"italic":dt={family:yr,style:"italic"};break;case"bolditalic":dt={family:yr,weight:"bold",style:"italic"};break;case"":case"normal":dt={family:yr}}dt!==null&&(dt.ref={name:yr,style:Me},Nt.push(dt))})}),Nt}(Ue.getFontList());ue=function(tr){for(var Nt={},yr=0;yr<tr.length;++yr){var Me=VE(tr[yr]),dt=Me.family,ut=Me.stretch,rr=Me.style,hr=Me.weight;Nt[dt]=Nt[dt]||{},Nt[dt][ut]=Nt[dt][ut]||{},Nt[dt][ut][rr]=Nt[dt][ut][rr]||{},Nt[dt][ut][rr][hr]=Me}return Nt}(or.concat(ze))}return ue}(this.pdf,this.fontFaces),be=ht.map(function(Ue){return{family:Ue,stretch:"normal",weight:bt,style:gt}}),Ct=function(Ue,ze,or){for(var tr=(or=or||{}).defaultFontFamily||"times",Nt=Object.assign({},TQe,or.genericFontFamilies||{}),yr=null,Me=null,dt=0;dt<ze.length;++dt)if(Nt[(yr=VE(ze[dt])).family]&&(yr.family=Nt[yr.family]),Ue.hasOwnProperty(yr.family)){Me=Ue[yr.family];break}if(!(Me=Me||Ue[tr]))throw new Error("Could not find a font-family for the rule '"+R9(yr)+"' and default family '"+tr+"'.");if(Me=function(ut,rr){if(rr[ut])return rr[ut];var hr=n3[ut],It=hr<=n3.normal?-1:1,dr=D9(rr,gae,hr,It);if(!dr)throw new Error("Could not find a matching font-stretch value for "+ut);return dr}(yr.stretch,Me),Me=function(ut,rr){if(rr[ut])return rr[ut];for(var hr=pae[ut],It=0;It<hr.length;++It)if(rr[hr[It]])return rr[hr[It]];throw new Error("Could not find a matching font-style for "+ut)}(yr.style,Me),!(Me=function(ut,rr){if(rr[ut])return rr[ut];if(ut===400&&rr[500])return rr[500];if(ut===500&&rr[400])return rr[400];var hr=OQe[ut],It=D9(rr,vae,hr,ut<400?-1:1);if(!It)throw new Error("Could not find a matching font-weight for value "+ut);return It}(yr.weight,Me)))throw new Error("Failed to resolve a font for the rule '"+R9(yr)+"'.");return Me}(Wt,be);this.pdf.setFont(Ct.ref.name,Ct.ref.style)}else{var wt="";(bt==="bold"||parseInt(bt,10)>=700||gt==="bold")&&(wt="bold"),gt==="italic"&&(wt+="italic"),wt.length===0&&(wt="normal");for(var Ge="",Je={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},_e=0;_e<ht.length;_e++){if(this.pdf.internal.getFont(ht[_e],wt,{noFallback:!0,disableWarning:!0})!==void 0){Ge=ht[_e];break}if(wt==="bolditalic"&&this.pdf.internal.getFont(ht[_e],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Ge=ht[_e],wt="bold";else if(this.pdf.internal.getFont(ht[_e],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Ge=ht[_e],wt="normal";break}}if(Ge===""){for(var je=0;je<ht.length;je++)if(Je[ht[je]]){Ge=Je[ht[je]];break}}Ge=Ge===""?"Times":Ge,this.pdf.setFont(Ge,wt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ne){this.ctx.globalCompositeOperation=ne}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ne){this.ctx.globalAlpha=ne}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ne){this.ctx.lineDashOffset=ne,Se.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ne){this.ctx.lineDash=ne,Se.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ne){this.ctx.ignoreClearRect=!!ne}})};f.prototype.setLineDash=function(V){this.lineDash=V},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){j.call(this,"fill",!1)},f.prototype.stroke=function(){j.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(V,B){if(isNaN(V)||isNaN(B))throw gs.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var Q=this.ctx.transform.applyToPoint(new i(V,B));this.path.push({type:"mt",x:Q.x,y:Q.y}),this.ctx.lastPoint=new i(V,B)},f.prototype.closePath=function(){var V=new i(0,0),B=0;for(B=this.path.length-1;B!==-1;B--)if(this.path[B].type==="begin"&&Da(this.path[B+1])==="object"&&typeof this.path[B+1].x=="number"){V=new i(this.path[B+1].x,this.path[B+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new i(V.x,V.y)},f.prototype.lineTo=function(V,B){if(isNaN(V)||isNaN(B))throw gs.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var Q=this.ctx.transform.applyToPoint(new i(V,B));this.path.push({type:"lt",x:Q.x,y:Q.y}),this.ctx.lastPoint=new i(Q.x,Q.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),j.call(this,null,!0)},f.prototype.quadraticCurveTo=function(V,B,Q,pe){if(isNaN(Q)||isNaN(pe)||isNaN(V)||isNaN(B))throw gs.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var te=this.ctx.transform.applyToPoint(new i(Q,pe)),Y=this.ctx.transform.applyToPoint(new i(V,B));this.path.push({type:"qct",x1:Y.x,y1:Y.y,x:te.x,y:te.y}),this.ctx.lastPoint=new i(te.x,te.y)},f.prototype.bezierCurveTo=function(V,B,Q,pe,te,Y){if(isNaN(te)||isNaN(Y)||isNaN(V)||isNaN(B)||isNaN(Q)||isNaN(pe))throw gs.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ce=this.ctx.transform.applyToPoint(new i(te,Y)),me=this.ctx.transform.applyToPoint(new i(V,B)),ae=this.ctx.transform.applyToPoint(new i(Q,pe));this.path.push({type:"bct",x1:me.x,y1:me.y,x2:ae.x,y2:ae.y,x:ce.x,y:ce.y}),this.ctx.lastPoint=new i(ce.x,ce.y)},f.prototype.arc=function(V,B,Q,pe,te,Y){if(isNaN(V)||isNaN(B)||isNaN(Q)||isNaN(pe)||isNaN(te))throw gs.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Y=!!Y,!this.ctx.transform.isIdentity){var ce=this.ctx.transform.applyToPoint(new i(V,B));V=ce.x,B=ce.y;var me=this.ctx.transform.applyToPoint(new i(0,Q)),ae=this.ctx.transform.applyToPoint(new i(0,0));Q=Math.sqrt(Math.pow(me.x-ae.x,2)+Math.pow(me.y-ae.y,2))}Math.abs(te-pe)>=2*Math.PI&&(pe=0,te=2*Math.PI),this.path.push({type:"arc",x:V,y:B,radius:Q,startAngle:pe,endAngle:te,counterclockwise:Y})},f.prototype.arcTo=function(V,B,Q,pe,te){throw new Error("arcTo not implemented.")},f.prototype.rect=function(V,B,Q,pe){if(isNaN(V)||isNaN(B)||isNaN(Q)||isNaN(pe))throw gs.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(V,B),this.lineTo(V+Q,B),this.lineTo(V+Q,B+pe),this.lineTo(V,B+pe),this.lineTo(V,B),this.lineTo(V+Q,B),this.lineTo(V,B)},f.prototype.fillRect=function(V,B,Q,pe){if(isNaN(V)||isNaN(B)||isNaN(Q)||isNaN(pe))throw gs.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var te={};this.lineCap!=="butt"&&(te.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(te.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(V,B,Q,pe),this.fill(),te.hasOwnProperty("lineCap")&&(this.lineCap=te.lineCap),te.hasOwnProperty("lineJoin")&&(this.lineJoin=te.lineJoin)}},f.prototype.strokeRect=function(V,B,Q,pe){if(isNaN(V)||isNaN(B)||isNaN(Q)||isNaN(pe))throw gs.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");v.call(this)||(this.beginPath(),this.rect(V,B,Q,pe),this.stroke())},f.prototype.clearRect=function(V,B,Q,pe){if(isNaN(V)||isNaN(B)||isNaN(Q)||isNaN(pe))throw gs.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(V,B,Q,pe))},f.prototype.save=function(V){V=typeof V!="boolean"||V;for(var B=this.pdf.internal.getCurrentPageInfo().pageNumber,Q=0;Q<this.pdf.internal.getNumberOfPages();Q++)this.pdf.setPage(Q+1),this.pdf.internal.out("q");if(this.pdf.setPage(B),V){this.ctx.fontSize=this.pdf.internal.getFontSize();var pe=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=pe}},f.prototype.restore=function(V){V=typeof V!="boolean"||V;for(var B=this.pdf.internal.getCurrentPageInfo().pageNumber,Q=0;Q<this.pdf.internal.getNumberOfPages();Q++)this.pdf.setPage(Q+1),this.pdf.internal.out("Q");this.pdf.setPage(B),V&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(V){var B,Q,pe,te;if(V.isCanvasGradient===!0&&(V=V.getColor()),!V)return{r:0,g:0,b:0,a:0,style:V};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(V))B=0,Q=0,pe=0,te=0;else{var Y=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(V);if(Y!==null)B=parseInt(Y[1]),Q=parseInt(Y[2]),pe=parseInt(Y[3]),te=1;else if((Y=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(V))!==null)B=parseInt(Y[1]),Q=parseInt(Y[2]),pe=parseInt(Y[3]),te=parseFloat(Y[4]);else{if(te=1,typeof V=="string"&&V.charAt(0)!=="#"){var ce=new lae(V);V=ce.ok?ce.toHex():"#000000"}V.length===4?(B=V.substring(1,2),B+=B,Q=V.substring(2,3),Q+=Q,pe=V.substring(3,4),pe+=pe):(B=V.substring(1,3),Q=V.substring(3,5),pe=V.substring(5,7)),B=parseInt(B,16),Q=parseInt(Q,16),pe=parseInt(pe,16)}}return{r:B,g:Q,b:pe,a:te,style:V}},m=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},v=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(V,B,Q,pe){if(isNaN(B)||isNaN(Q)||typeof V!="string")throw gs.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(pe=isNaN(pe)?void 0:pe,!m.call(this)){var te=$(this.ctx.transform.rotation),Y=this.ctx.transform.scaleX;I.call(this,{text:V,x:B,y:Q,scale:Y,angle:te,align:this.textAlign,maxWidth:pe})}},f.prototype.strokeText=function(V,B,Q,pe){if(isNaN(B)||isNaN(Q)||typeof V!="string")throw gs.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!v.call(this)){pe=isNaN(pe)?void 0:pe;var te=$(this.ctx.transform.rotation),Y=this.ctx.transform.scaleX;I.call(this,{text:V,x:B,y:Q,scale:Y,renderingMode:"stroke",angle:te,align:this.textAlign,maxWidth:pe})}},f.prototype.measureText=function(V){if(typeof V!="string")throw gs.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var B=this.pdf,Q=this.pdf.internal.scaleFactor,pe=B.internal.getFontSize(),te=B.getStringUnitWidth(V)*pe/B.internal.scaleFactor;return new function(Y){var ce=(Y=Y||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ce}}),this}({width:te*=Math.round(96*Q/72*1e4)/1e4})},f.prototype.scale=function(V,B){if(isNaN(V)||isNaN(B))throw gs.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var Q=new c(V,0,0,B,0,0);this.ctx.transform=this.ctx.transform.multiply(Q)},f.prototype.rotate=function(V){if(isNaN(V))throw gs.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var B=new c(Math.cos(V),Math.sin(V),-Math.sin(V),Math.cos(V),0,0);this.ctx.transform=this.ctx.transform.multiply(B)},f.prototype.translate=function(V,B){if(isNaN(V)||isNaN(B))throw gs.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var Q=new c(1,0,0,1,V,B);this.ctx.transform=this.ctx.transform.multiply(Q)},f.prototype.transform=function(V,B,Q,pe,te,Y){if(isNaN(V)||isNaN(B)||isNaN(Q)||isNaN(pe)||isNaN(te)||isNaN(Y))throw gs.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ce=new c(V,B,Q,pe,te,Y);this.ctx.transform=this.ctx.transform.multiply(ce)},f.prototype.setTransform=function(V,B,Q,pe,te,Y){V=isNaN(V)?1:V,B=isNaN(B)?0:B,Q=isNaN(Q)?0:Q,pe=isNaN(pe)?1:pe,te=isNaN(te)?0:te,Y=isNaN(Y)?0:Y,this.ctx.transform=new c(V,B,Q,pe,te,Y)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(V,B,Q,pe,te,Y,ce,me,ae){var le=this.pdf.getImageProperties(V),ue=1,Re=1,ne=1,ie=1;pe!==void 0&&me!==void 0&&(ne=me/pe,ie=ae/te,ue=le.width/pe*me/pe,Re=le.height/te*ae/te),Y===void 0&&(Y=B,ce=Q,B=0,Q=0),pe!==void 0&&me===void 0&&(me=pe,ae=te),pe===void 0&&me===void 0&&(me=le.width,ae=le.height);for(var gt,bt=this.ctx.transform.decompose(),at=$(bt.rotate.shx),xt=new c,Ze=(xt=(xt=(xt=xt.multiply(bt.translate)).multiply(bt.skew)).multiply(bt.scale)).applyToRectangle(new l(Y-B*ne,ce-Q*ie,pe*ue,te*Re)),ht=y.call(this,Ze),Wt=[],be=0;be<ht.length;be+=1)Wt.indexOf(ht[be])===-1&&Wt.push(ht[be]);if(w(Wt),this.autoPaging)for(var Ct=Wt[0],wt=Wt[Wt.length-1],Ge=Ct;Ge<wt+1;Ge++){this.pdf.setPage(Ge);var Je=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],_e=Ge===1?this.posY+this.margin[0]:this.margin[0],je=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ue=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ze=Ge===1?0:je+(Ge-2)*Ue;if(this.ctx.clip_path.length!==0){var or=this.path;gt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(gt,this.posX+this.margin[3],-ze+_e+this.ctx.prevPageLastElemOffset),_.call(this,"fill",!0),this.path=or}var tr=JSON.parse(JSON.stringify(Ze));tr=b([tr],this.posX+this.margin[3],-ze+_e+this.ctx.prevPageLastElemOffset)[0];var Nt=(Ge>Ct||Ge<wt)&&g.call(this);Nt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Je,Ue,null).clip().discardPath()),this.pdf.addImage(V,"JPEG",tr.x,tr.y,tr.w,tr.h,null,null,at),Nt&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(V,"JPEG",Ze.x,Ze.y,Ze.w,Ze.h,null,null,at)};var y=function(V,B,Q){var pe=[];B=B||this.pdf.internal.pageSize.width,Q=Q||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var te=this.posY+this.ctx.prevPageLastElemOffset;switch(V.type){default:case"mt":case"lt":pe.push(Math.floor((V.y+te)/Q)+1);break;case"arc":pe.push(Math.floor((V.y+te-V.radius)/Q)+1),pe.push(Math.floor((V.y+te+V.radius)/Q)+1);break;case"qct":var Y=X(this.ctx.lastPoint.x,this.ctx.lastPoint.y,V.x1,V.y1,V.x,V.y);pe.push(Math.floor((Y.y+te)/Q)+1),pe.push(Math.floor((Y.y+Y.h+te)/Q)+1);break;case"bct":var ce=ye(this.ctx.lastPoint.x,this.ctx.lastPoint.y,V.x1,V.y1,V.x2,V.y2,V.x,V.y);pe.push(Math.floor((ce.y+te)/Q)+1),pe.push(Math.floor((ce.y+ce.h+te)/Q)+1);break;case"rect":pe.push(Math.floor((V.y+te)/Q)+1),pe.push(Math.floor((V.y+V.h+te)/Q)+1)}for(var me=0;me<pe.length;me+=1)for(;this.pdf.internal.getNumberOfPages()<pe[me];)x.call(this);return pe},x=function(){var V=this.fillStyle,B=this.strokeStyle,Q=this.font,pe=this.lineCap,te=this.lineWidth,Y=this.lineJoin;this.pdf.addPage(),this.fillStyle=V,this.strokeStyle=B,this.font=Q,this.lineCap=pe,this.lineWidth=te,this.lineJoin=Y},b=function(V,B,Q){for(var pe=0;pe<V.length;pe++)switch(V[pe].type){case"bct":V[pe].x2+=B,V[pe].y2+=Q;case"qct":V[pe].x1+=B,V[pe].y1+=Q;default:V[pe].x+=B,V[pe].y+=Q}return V},w=function(V){return V.sort(function(B,Q){return B-Q})},j=function(V,B){for(var Q,pe,te=this.fillStyle,Y=this.strokeStyle,ce=this.lineCap,me=this.lineWidth,ae=Math.abs(me*this.ctx.transform.scaleX),le=this.lineJoin,ue=JSON.parse(JSON.stringify(this.path)),Re=JSON.parse(JSON.stringify(this.path)),ne=[],ie=0;ie<Re.length;ie++)if(Re[ie].x!==void 0)for(var gt=y.call(this,Re[ie]),bt=0;bt<gt.length;bt+=1)ne.indexOf(gt[bt])===-1&&ne.push(gt[bt]);for(var at=0;at<ne.length;at++)for(;this.pdf.internal.getNumberOfPages()<ne[at];)x.call(this);if(w(ne),this.autoPaging)for(var xt=ne[0],Ze=ne[ne.length-1],ht=xt;ht<Ze+1;ht++){this.pdf.setPage(ht),this.fillStyle=te,this.strokeStyle=Y,this.lineCap=ce,this.lineWidth=ae,this.lineJoin=le;var Wt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],be=ht===1?this.posY+this.margin[0]:this.margin[0],Ct=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],wt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ge=ht===1?0:Ct+(ht-2)*wt;if(this.ctx.clip_path.length!==0){var Je=this.path;Q=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(Q,this.posX+this.margin[3],-Ge+be+this.ctx.prevPageLastElemOffset),_.call(this,V,!0),this.path=Je}if(pe=JSON.parse(JSON.stringify(ue)),this.path=b(pe,this.posX+this.margin[3],-Ge+be+this.ctx.prevPageLastElemOffset),B===!1||ht===0){var _e=(ht>xt||ht<Ze)&&g.call(this);_e&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Wt,wt,null).clip().discardPath()),_.call(this,V,B),_e&&this.pdf.restoreGraphicsState()}this.lineWidth=me}else this.lineWidth=ae,_.call(this,V,B),this.lineWidth=me;this.path=ue},_=function(V,B){if((V!=="stroke"||B||!v.call(this))&&(V==="stroke"||B||!m.call(this))){for(var Q,pe,te=[],Y=this.path,ce=0;ce<Y.length;ce++){var me=Y[ce];switch(me.type){case"begin":te.push({begin:!0});break;case"close":te.push({close:!0});break;case"mt":te.push({start:me,deltas:[],abs:[]});break;case"lt":var ae=te.length;if(Y[ce-1]&&!isNaN(Y[ce-1].x)&&(Q=[me.x-Y[ce-1].x,me.y-Y[ce-1].y],ae>0)){for(;ae>=0;ae--)if(te[ae-1].close!==!0&&te[ae-1].begin!==!0){te[ae-1].deltas.push(Q),te[ae-1].abs.push(me);break}}break;case"bct":Q=[me.x1-Y[ce-1].x,me.y1-Y[ce-1].y,me.x2-Y[ce-1].x,me.y2-Y[ce-1].y,me.x-Y[ce-1].x,me.y-Y[ce-1].y],te[te.length-1].deltas.push(Q);break;case"qct":var le=Y[ce-1].x+2/3*(me.x1-Y[ce-1].x),ue=Y[ce-1].y+2/3*(me.y1-Y[ce-1].y),Re=me.x+2/3*(me.x1-me.x),ne=me.y+2/3*(me.y1-me.y),ie=me.x,gt=me.y;Q=[le-Y[ce-1].x,ue-Y[ce-1].y,Re-Y[ce-1].x,ne-Y[ce-1].y,ie-Y[ce-1].x,gt-Y[ce-1].y],te[te.length-1].deltas.push(Q);break;case"arc":te.push({deltas:[],abs:[],arc:!0}),Array.isArray(te[te.length-1].abs)&&te[te.length-1].abs.push(me)}}pe=B?null:V==="stroke"?"stroke":"fill";for(var bt=!1,at=0;at<te.length;at++)if(te[at].arc)for(var xt=te[at].abs,Ze=0;Ze<xt.length;Ze++){var ht=xt[Ze];ht.type==="arc"?P.call(this,ht.x,ht.y,ht.radius,ht.startAngle,ht.endAngle,ht.counterclockwise,void 0,B,!bt):M.call(this,ht.x,ht.y),bt=!0}else if(te[at].close===!0)this.pdf.internal.out("h"),bt=!1;else if(te[at].begin!==!0){var Wt=te[at].start.x,be=te[at].start.y;D.call(this,te[at].deltas,Wt,be),bt=!0}pe&&A.call(this,pe),B&&R.call(this)}},S=function(V){var B=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,Q=B*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return V-Q;case"top":return V+B-Q;case"hanging":return V+B-2*Q;case"middle":return V+B/2-Q;default:return V}},C=function(V){return V+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var V=function(){};return V.colorStops=[],V.addColorStop=function(B,Q){this.colorStops.push([B,Q])},V.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},V.isCanvasGradient=!0,V},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var P=function(V,B,Q,pe,te,Y,ce,me,ae){for(var le=z.call(this,Q,pe,te,Y),ue=0;ue<le.length;ue++){var Re=le[ue];ue===0&&(ae?O.call(this,Re.x1+V,Re.y1+B):M.call(this,Re.x1+V,Re.y1+B)),U.call(this,V,B,Re.x2,Re.y2,Re.x3,Re.y3,Re.x4,Re.y4)}me?R.call(this):A.call(this,ce)},A=function(V){switch(V){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},R=function(){this.pdf.clip(),this.pdf.discardPath()},O=function(V,B){this.pdf.internal.out(r(V)+" "+n(B)+" m")},I=function(V){var B;switch(V.align){case"right":case"end":B="right";break;case"center":B="center";break;default:B="left"}var Q=this.pdf.getTextDimensions(V.text),pe=S.call(this,V.y),te=C.call(this,pe)-Q.h,Y=this.ctx.transform.applyToPoint(new i(V.x,pe)),ce=this.ctx.transform.decompose(),me=new c;me=(me=(me=me.multiply(ce.translate)).multiply(ce.skew)).multiply(ce.scale);for(var ae,le,ue,Re=this.ctx.transform.applyToRectangle(new l(V.x,pe,Q.w,Q.h)),ne=me.applyToRectangle(new l(V.x,te,Q.w,Q.h)),ie=y.call(this,ne),gt=[],bt=0;bt<ie.length;bt+=1)gt.indexOf(ie[bt])===-1&&gt.push(ie[bt]);if(w(gt),this.autoPaging)for(var at=gt[0],xt=gt[gt.length-1],Ze=at;Ze<xt+1;Ze++){this.pdf.setPage(Ze);var ht=Ze===1?this.posY+this.margin[0]:this.margin[0],Wt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],be=this.pdf.internal.pageSize.height-this.margin[2],Ct=be-this.margin[0],wt=this.pdf.internal.pageSize.width-this.margin[1],Ge=wt-this.margin[3],Je=Ze===1?0:Wt+(Ze-2)*Ct;if(this.ctx.clip_path.length!==0){var _e=this.path;ae=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(ae,this.posX+this.margin[3],-1*Je+ht),_.call(this,"fill",!0),this.path=_e}var je=b([JSON.parse(JSON.stringify(ne))],this.posX+this.margin[3],-Je+ht+this.ctx.prevPageLastElemOffset)[0];V.scale>=.01&&(le=this.pdf.internal.getFontSize(),this.pdf.setFontSize(le*V.scale),ue=this.lineWidth,this.lineWidth=ue*V.scale);var Ue=this.autoPaging!=="text";if(Ue||je.y+je.h<=be){if(Ue||je.y>=ht&&je.x<=wt){var ze=Ue?V.text:this.pdf.splitTextToSize(V.text,V.maxWidth||wt-je.x)[0],or=b([JSON.parse(JSON.stringify(Re))],this.posX+this.margin[3],-Je+ht+this.ctx.prevPageLastElemOffset)[0],tr=Ue&&(Ze>at||Ze<xt)&&g.call(this);tr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ge,Ct,null).clip().discardPath()),this.pdf.text(ze,or.x,or.y,{angle:V.angle,align:B,renderingMode:V.renderingMode}),tr&&this.pdf.restoreGraphicsState()}}else je.y<be&&(this.ctx.prevPageLastElemOffset+=be-je.y);V.scale>=.01&&(this.pdf.setFontSize(le),this.lineWidth=ue)}else V.scale>=.01&&(le=this.pdf.internal.getFontSize(),this.pdf.setFontSize(le*V.scale),ue=this.lineWidth,this.lineWidth=ue*V.scale),this.pdf.text(V.text,Y.x+this.posX,Y.y+this.posY,{angle:V.angle,align:B,renderingMode:V.renderingMode,maxWidth:V.maxWidth}),V.scale>=.01&&(this.pdf.setFontSize(le),this.lineWidth=ue)},M=function(V,B,Q,pe){Q=Q||0,pe=pe||0,this.pdf.internal.out(r(V+Q)+" "+n(B+pe)+" l")},D=function(V,B,Q){return this.pdf.lines(V,B,Q,null,null)},U=function(V,B,Q,pe,te,Y,ce,me){this.pdf.internal.out([t(s(Q+V)),t(o(pe+B)),t(s(te+V)),t(o(Y+B)),t(s(ce+V)),t(o(me+B)),"c"].join(" "))},z=function(V,B,Q,pe){for(var te=2*Math.PI,Y=Math.PI/2;B>Q;)B-=te;var ce=Math.abs(Q-B);ce<te&&pe&&(ce=te-ce);for(var me=[],ae=pe?-1:1,le=B;ce>1e-5;){var ue=le+ae*Math.min(ce,Y);me.push(W.call(this,V,le,ue)),ce-=Math.abs(ue-le),le=ue}return me},W=function(V,B,Q){var pe=(Q-B)/2,te=V*Math.cos(pe),Y=V*Math.sin(pe),ce=te,me=-Y,ae=ce*ce+me*me,le=ae+ce*te+me*Y,ue=4/3*(Math.sqrt(2*ae*le)-le)/(ce*Y-me*te),Re=ce-ue*me,ne=me+ue*ce,ie=Re,gt=-ne,bt=pe+B,at=Math.cos(bt),xt=Math.sin(bt);return{x1:V*Math.cos(B),y1:V*Math.sin(B),x2:Re*at-ne*xt,y2:Re*xt+ne*at,x3:ie*at-gt*xt,y3:ie*xt+gt*at,x4:V*Math.cos(Q),y4:V*Math.sin(Q)}},$=function(V){return 180*V/Math.PI},X=function(V,B,Q,pe,te,Y){var ce=V+.5*(Q-V),me=B+.5*(pe-B),ae=te+.5*(Q-te),le=Y+.5*(pe-Y),ue=Math.min(V,te,ce,ae),Re=Math.max(V,te,ce,ae),ne=Math.min(B,Y,me,le),ie=Math.max(B,Y,me,le);return new l(ue,ne,Re-ue,ie-ne)},ye=function(V,B,Q,pe,te,Y,ce,me){var ae,le,ue,Re,ne,ie,gt,bt,at,xt,Ze,ht,Wt,be,Ct=Q-V,wt=pe-B,Ge=te-Q,Je=Y-pe,_e=ce-te,je=me-Y;for(le=0;le<41;le++)at=(gt=(ue=V+(ae=le/40)*Ct)+ae*((ne=Q+ae*Ge)-ue))+ae*(ne+ae*(te+ae*_e-ne)-gt),xt=(bt=(Re=B+ae*wt)+ae*((ie=pe+ae*Je)-Re))+ae*(ie+ae*(Y+ae*je-ie)-bt),le==0?(Ze=at,ht=xt,Wt=at,be=xt):(Ze=Math.min(Ze,at),ht=Math.min(ht,xt),Wt=Math.max(Wt,at),be=Math.max(be,xt));return new l(Math.round(Ze),Math.round(ht),Math.round(Wt-Ze),Math.round(be-ht))},Se=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var V,B,Q=(V=this.ctx.lineDash,B=this.ctx.lineDashOffset,JSON.stringify({lineDash:V,lineDashOffset:B}));this.prevLineDash!==Q&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=Q)}}})(Ln.API),function(e){var t=function(i){var l,c,d,u,f,h,m,v,g,y;for(c=[],d=0,u=(i+=l="\0\0\0\0".slice(i.length%4||4)).length;u>d;d+=4)(f=(i.charCodeAt(d)<<24)+(i.charCodeAt(d+1)<<16)+(i.charCodeAt(d+2)<<8)+i.charCodeAt(d+3))!==0?(h=(f=((f=((f=((f=(f-(y=f%85))/85)-(g=f%85))/85)-(v=f%85))/85)-(m=f%85))/85)%85,c.push(h+33,m+33,v+33,g+33,y+33)):c.push(122);return function(x,b){for(var w=b;w>0;w--)x.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(i){var l,c,d,u,f,h=String,m="length",v=255,g="charCodeAt",y="slice",x="replace";for(i[y](-2),i=i[y](0,-2)[x](/\s/g,"")[x]("z","!!!!!"),d=[],u=0,f=(i+=l="uuuuu"[y](i[m]%5||5))[m];f>u;u+=5)c=52200625*(i[g](u)-33)+614125*(i[g](u+1)-33)+7225*(i[g](u+2)-33)+85*(i[g](u+3)-33)+(i[g](u+4)-33),d.push(v&c>>24,v&c>>16,v&c>>8,v&c);return function(b,w){for(var j=w;j>0;j--)b.pop()}(d,l[m]),h.fromCharCode.apply(h,d)},n=function(i){return i.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(i){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),l.test(i)===!1)return"";for(var c="",d=0;d<i.length;d+=2)c+=String.fromCharCode("0x"+(i[d]+i[d+1]));return c},o=function(i){for(var l=new Uint8Array(i.length),c=i.length;c--;)l[c]=i.charCodeAt(c);return(l=VT(l)).reduce(function(d,u){return d+String.fromCharCode(u)},"")};e.processDataByFilters=function(i,l){var c=0,d=i||"",u=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":d=r(d),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":d=t(d),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":d=s(d),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":d=n(d),u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":d=o(d),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:d,reverseChain:u.reverse().join(" ")}}}(Ln.API),function(e){e.loadFile=function(t,r,n){return function(s,o,i){o=o!==!1,i=typeof i=="function"?i:function(){};var l=void 0;try{l=function(c,d,u){var f=new XMLHttpRequest,h=0,m=function(v){var g=v.length,y=[],x=String.fromCharCode;for(h=0;h<g;h+=1)y.push(x(255&v.charCodeAt(h)));return y.join("")};if(f.open("GET",c,!d),f.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(f.onload=function(){f.status===200?u(m(this.responseText)):u(void 0)}),f.send(null),d&&f.status===200)return m(f.responseText)}(s,o,i)}catch{}return l}(t,r,n)},e.loadImageFile=e.loadFile}(Ln.API),function(e){function t(){return(oa.html2canvas?Promise.resolve(oa.html2canvas):ef(()=>import("./html2canvas.esm-f16e60ff.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(oa.DOMPurify?Promise.resolve(oa.DOMPurify):ef(()=>import("./purify.es-fd086bfc.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=Da(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},s=function(l,c){var d=document.createElement(l);for(var u in c.className&&(d.className=c.className),c.innerHTML&&c.dompurify&&(d.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)d.style[u]=c.style[u];return d},o=function l(c,d){for(var u=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),f=c.firstChild;f;f=f.nextSibling)d!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||u.appendChild(l(f,d));return c.nodeType===1&&(c.nodeName==="CANVAS"?(u.width=c.width,u.height=c.height,u.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(u.value=c.value),u.addEventListener("load",function(){u.scrollTop=c.scrollTop,u.scrollLeft=c.scrollLeft},!0)),u},i=function l(c){var d=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),u=l.convert(Promise.resolve(),d);return(u=u.setProgress(1,l,1,[l])).set(c)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(l,c){return l.__proto__=c||i.prototype,l},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(d){switch(n(d)){case"string":return"string";case"element":return d.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(d){return this.set({src:s("div",{innerHTML:l,dompurify:d})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},i.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=o(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var d=Object.assign({},this.opt.html2canvas);return delete d.onrendered,c(this.prop.container,d)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var d=this.opt.jsPDF,u=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,h=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete h.onrendered,d.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,d.context2d.posX=this.opt.x,d.context2d.posY=this.opt.y,d.context2d.margin=this.opt.margin,d.context2d.fontFaces=u,u)for(var m=0;m<u.length;++m){var v=u[m],g=v.src.find(function(y){return y.format==="truetype"});g&&d.addFont(g.url,v.ref.name,v.ref.style)}return h.windowHeight=h.windowHeight||0,h.windowHeight=h.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):h.windowHeight,d.context2d.save(!0),c(this.prop.container,h)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(l,c,d){return(d=d||"pdf").toLowerCase()==="img"||d.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},i.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},i.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},i.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(d){if(d in i.template.prop)return function(){this.prop[d]=l[d]};switch(d){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[d]=l[d]}}},this);return this.then(function(){return this.thenList(c)})},i.prototype.get=function(l,c){return this.then(function(){var d=l in i.template.prop?this.prop[l]:this.opt[l];return c?c(d):d})},i.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},i.prototype.setPageSize=function(l){function c(d,u){return Math.floor(d*u/72*96)}return this.then(function(){(l=l||Ln.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},i.prototype.setProgress=function(l,c,d,u){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),d!=null&&(this.progress.n=d),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(l,c,d,u){return this.setProgress(l?this.progress.val+l:null,c||null,d?this.progress.n+d:null,u?this.progress.stack.concat(u):null)},i.prototype.then=function(l,c){var d=this;return this.thenCore(l,c,function(u,f){return d.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(h){return d.updateProgress(null,u),h}).then(u,f).then(function(h){return d.updateProgress(1),h})})},i.prototype.thenCore=function(l,c,d){d=d||Promise.prototype.then;var u=this;l&&(l=l.bind(u)),c&&(c=c.bind(u));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?u:i.convert(Object.assign({},u),Promise.prototype),h=d.call(f,l,c);return i.convert(h,u.__proto__)},i.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},i.prototype.thenList=function(l){var c=this;return l.forEach(function(d){c=c.thenCore(d)}),c},i.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return i.convert(c,this)},i.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},i.prototype.error=function(l){return this.then(function(){throw new Error(l)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,Ln.getPageSize=function(l,c,d){if(Da(l)==="object"){var u=l;l=u.orientation,c=u.unit||c,d=u.format||d}c=c||"mm",d=d||"a4",l=(""+(l||"P")).toLowerCase();var f,h=(""+d).toLowerCase(),m={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+c}var v,g=0,y=0;if(m.hasOwnProperty(h))g=m[h][1]/f,y=m[h][0]/f;else try{g=d[1],y=d[0]}catch{throw new Error("Invalid format: "+d)}if(l==="p"||l==="portrait")l="p",y>g&&(v=y,y=g,g=v);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",g>y&&(v=y,y=g,g=v)}return{width:y,height:g,unit:c,k:f,orientation:l}},e.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(VE):null;var d=new i(c);return c.worker?d:d.from(l).doCallback()}}(Ln.API),Ln.API.addJS=function(e){return $9=e,this.internal.events.subscribe("postPutResources",function(){Ej=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Ej+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),F9=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+$9+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Ej!==void 0&&F9!==void 0&&this.internal.out("/Names <</JavaScript "+Ej+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=r.outline.render().split(/\r\n/),o=0;o<s.length;o++){var i=s[o],l=n.exec(i);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(i)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,u=[];for(o=0;o<d;o++){var f=r.internal.newObject();u.push(f);var h=r.internal.getPageInfo(o+1);r.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var m=r.internal.newObject();for(r.internal.write("<< /Names [ "),o=0;o<u.length;o++)r.internal.write("(page_"+(o+1)+")"+u[o]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+m+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,s,o){var i={title:s,options:o,children:[]};return n==null&&(n=this.root),n.children.push(i),i},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,o=0;o<n.children.length;o++){var i=n.children[o];this.objStart(i),this.line("/Title "+this.makeString(i.title)),this.line("/Parent "+this.makeRef(n)),o>0&&this.line("/Prev "+this.makeRef(n.children[o-1])),o<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[o+1])),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1])));var l=this.count=this.count_r({count:0},i);if(l>0&&this.line("/Count "+l),i.options&&i.options.pageNumber){var c=r.internal.getPageInfo(i.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var d=0;d<n.children.length;d++)this.renderItems(n.children[d])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,s){for(var o=0;o<s.children.length;o++)n.count++,this.count_r(n,s.children[o]);return n.count}}])}(Ln.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,s,o,i,l){var c,d=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=i||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(f){for(var h,m=256*f.charCodeAt(4)+f.charCodeAt(5),v=f.length,g={width:0,height:0,numcomponents:1},y=4;y<v;y+=2){if(y+=m,t.indexOf(f.charCodeAt(y+1))!==-1){h=256*f.charCodeAt(y+5)+f.charCodeAt(y+6),g={width:256*f.charCodeAt(y+7)+f.charCodeAt(y+8),height:h,numcomponents:f.charCodeAt(y+9)};break}m=256*f.charCodeAt(y+2)+f.charCodeAt(y+3)}return g}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}u={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:d,index:n,alias:s}}return u}}(Ln.API),Ln.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var s,o=vQe(e,{checkCrc:!0}),i=o.width,l=o.height,c=o.channels,d=o.palette,u=o.depth;s=d&&c===1?function(P){for(var A=P.width,R=P.height,O=P.data,I=P.palette,M=P.depth,D=!1,U=[],z=[],W=void 0,$=!1,X=0,ye=0;ye<I.length;ye++){var Se=Tz(I[ye],4),V=Se[0],B=Se[1],Q=Se[2],pe=Se[3];U.push(V,B,Q),pe!=null&&(pe===0?(X++,z.length<1&&z.push(ye)):pe<255&&($=!0))}if($||X>1){D=!0,z=void 0;var te=A*R;W=new Uint8Array(te);for(var Y=new DataView(O.buffer),ce=0;ce<te;ce++){var me=HE(Y,ce,M),ae=Tz(I[me],4)[3];W[ce]=ae}}else X===0&&(z=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:D?8:void 0,colorBytes:O,alphaBytes:W,needSMask:D,palette:U,mask:z}}(o):c===2||c===4?function(P){for(var A=P.data,R=P.width,O=P.height,I=P.channels,M=P.depth,D=I===2?"DeviceGray":"DeviceRGB",U=I-1,z=R*O,W=U,$=z*W,X=1*z,ye=Math.ceil($*M/8),Se=Math.ceil(X*M/8),V=new Uint8Array(ye),B=new Uint8Array(Se),Q=new DataView(A.buffer),pe=new DataView(V.buffer),te=new DataView(B.buffer),Y=!1,ce=0;ce<z;ce++){for(var me=ce*I,ae=0;ae<W;ae++)K9(pe,HE(Q,me+ae,M),ce*W+ae,M);var le=HE(Q,me+W,M);le<(1<<M)-1&&(Y=!0),K9(te,le,1*ce,M)}return{colorSpace:D,colorsPerPixel:U,sMaskBitsPerComponent:Y?M:void 0,colorBytes:V,alphaBytes:B,needSMask:Y}}(o):function(P){var A=P.data,R=P.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:R,colorsPerPixel:R==="DeviceGray"?1:3,colorBytes:A instanceof Uint16Array?function(O){for(var I=O.length,M=new Uint8Array(2*I),D=new DataView(M.buffer,M.byteOffset,M.byteLength),U=0;U<I;U++)D.setUint16(2*U,O[U],!1);return M}(A):A,needSMask:!1}}(o);var f,h,m,v=s,g=v.colorSpace,y=v.colorsPerPixel,x=v.sMaskBitsPerComponent,b=v.colorBytes,w=v.alphaBytes,j=v.needSMask,_=v.palette,S=v.mask,C=null;return n!==Ln.API.image_compression.NONE&&typeof VT=="function"?(C=function(P){var A;switch(P){case Ln.API.image_compression.FAST:A=11;break;case Ln.API.image_compression.MEDIUM:A=13;break;case Ln.API.image_compression.SLOW:A=14;break;default:A=12}return A}(n),f=this.decode.FLATE_DECODE,h="/Predictor ".concat(C," /Colors ").concat(y," /BitsPerComponent ").concat(u," /Columns ").concat(i),e=U9(b,Math.ceil(i*y*u/8),y,u,n),j&&(m=U9(w,Math.ceil(i*x/8),1,x,n))):(f=void 0,h=void 0,e=b,j&&(m=w)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(m&&this.__addimage__.isArrayBuffer(m)||this.__addimage__.isArrayBufferView(m))&&(m=this.__addimage__.arrayBufferToBinaryString(m)),{alias:r,data:e,index:t,filter:f,decodeParameters:h,transparency:S,palette:_,sMask:m,predictor:C,width:i,height:l,bitsPerComponent:u,sMaskBitsPerComponent:x,colorSpace:g}}},function(e){e.processGIF89A=function(t,r,n,s){var o=new $Qe(t),i=o.width,l=o.height,c=[];o.decodeAndBlitFrameRGBA(0,c);var d={data:c,width:i,height:l},u=new GE(100).encode(d,100);return e.processJPEG.call(this,u,r,n,s)},e.processGIF87A=e.processGIF89A}(Ln.API),Kd.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:s,green:n,blue:r,quad:o}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Kd.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){gs.log("bit decode error:"+r)}},Kd.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,s=0;s<t;s++)for(var o=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+8*s*4,l=0;l<8&&8*s+l<this.width;l++){var c=this.palette[o>>7-l&1];this.data[i+4*l]=c.blue,this.data[i+4*l+1]=c.green,this.data[i+4*l+2]=c.red,this.data[i+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Kd.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<e;s++){var o=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+2*s*4,l=o>>4,c=15&o,d=this.palette[l];if(this.data[i]=d.blue,this.data[i+1]=d.green,this.data[i+2]=d.red,this.data[i+3]=255,2*s+1>=this.width)break;d=this.palette[c],this.data[i+4]=d.blue,this.data[i+4+1]=d.green,this.data[i+4+2]=d.red,this.data[i+4+3]=255}t!==0&&(this.pos+=4-t)}},Kd.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),o=r*this.width*4+4*n;if(s<this.palette.length){var i=this.palette[s];this.data[o]=i.red,this.data[o+1]=i.green,this.data[o+2]=i.blue,this.data[o+3]=255}else this.data[o]=255,this.data[o+1]=255,this.data[o+2]=255,this.data[o+3]=255}e!==0&&(this.pos+=4-e)}},Kd.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var i=(o&t)/t*255|0,l=(o>>5&t)/t*255|0,c=(o>>10&t)/t*255|0,d=o>>15?255:0,u=n*this.width*4+4*s;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=i,this.data[u+3]=d}this.pos+=e}},Kd.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,o=0;o<this.width;o++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(i&t)/t*255|0,c=(i>>5&r)/r*255|0,d=(i>>11)/t*255|0,u=s*this.width*4+4*o;this.data[u]=d,this.data[u+1]=c,this.data[u+2]=l,this.data[u+3]=255}this.pos+=e}},Kd.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),i=t*this.width*4+4*r;this.data[i]=o,this.data[i+1]=s,this.data[i+2]=n,this.data[i+3]=255}this.pos+=this.width%4}},Kd.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=o,this.data[l+1]=s,this.data[l+2]=n,this.data[l+3]=i}},Kd.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,s){var o=new Kd(t,!1),i=o.width,l=o.height,c={data:o.getData(),width:i,height:l},d=new GE(100).encode(c,100);return e.processJPEG.call(this,d,r,n,s)}}(Ln.API),Y9.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,s){var o=new Y9(t),i=o.width,l=o.height,c={data:o.getData(),width:i,height:l},d=new GE(100).encode(c,100);return e.processJPEG.call(this,d,r,n,s)}}(Ln.API),Ln.API.processRGBA=function(e,t,r){for(var n=e.data,s=n.length,o=new Uint8Array(s/4*3),i=new Uint8Array(s/4),l=0,c=0,d=0;d<s;d+=4){var u=n[d],f=n[d+1],h=n[d+2],m=n[d+3];o[l++]=u,o[l++]=f,o[l++]=h,i[c++]=m}var v=this.__addimage__.arrayBufferToBinaryString(o);return{alpha:this.__addimage__.arrayBufferToBinaryString(i),data:v,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Ln.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},yv=Ln.API,kj=yv.getCharWidthsArray=function(e,t){var r,n,s=(t=t||{}).font||this.internal.getFont(),o=t.fontSize||this.internal.getFontSize(),i=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:s.metadata.Unicode.widths,c=l.fof?l.fof:1,d=t.kerning?t.kerning:s.metadata.Unicode.kerning,u=d.fof?d.fof:1,f=t.doKerning!==!1,h=0,m=e.length,v=0,g=l[0]||c,y=[];for(r=0;r<m;r++)n=e.charCodeAt(r),typeof s.metadata.widthOfString=="function"?y.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+i*(1e3/o)||0)/1e3):(h=f&&Da(d[n])==="object"&&!isNaN(parseInt(d[n][v],10))?d[n][v]/u:0,y.push((l[n]||g)/c+h)),v=n;return y},B9=yv.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),s=t.charSpace||this.internal.getCharSpace();return yv.processArabic&&(e=yv.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,s)/r:kj.apply(this,arguments).reduce(function(o,i){return o+i},0)},q9=function(e,t,r,n){for(var s=[],o=0,i=e.length,l=0;o!==i&&l+t[o]<r;)l+=t[o],o++;s.push(e.slice(0,o));var c=o;for(l=0;o!==i;)l+t[o]>n&&(s.push(e.slice(c,o)),l=0,c=o),l+=t[o],o++;return c!==o&&s.push(e.slice(c,o)),s},z9=function(e,t,r){r||(r={});var n,s,o,i,l,c,d,u=[],f=[u],h=r.textIndent||0,m=0,v=0,g=e.split(" "),y=kj.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var x=Array(c).join(" "),b=[];g.map(function(j){(j=j.split(/\s*\n/)).length>1?b=b.concat(j.map(function(_,S){return(S&&_.length?`
`:"")+_})):b.push(j[0])}),g=b,c=B9.apply(this,[x,r])}for(o=0,i=g.length;o<i;o++){var w=0;if(n=g[o],c&&n[0]==`
`&&(n=n.substr(1),w=1),h+m+(v=(s=kj.apply(this,[n,r])).reduce(function(j,_){return j+_},0))>t||w){if(v>t){for(l=q9.apply(this,[n,s,t-(h+m),t]),u.push(l.shift()),u=[l.pop()];l.length;)f.push([l.shift()]);v=s.slice(n.length-(u[0]?u[0].length:0)).reduce(function(j,_){return j+_},0)}else u=[n];f.push(u),h=v+c,m=y}else u.push(n),h+=m+v,m=y}return d=c?function(j,_){return(_?x:"")+j.join(" ")}:function(j){return j.join(" ")},f.map(d)},yv.splitTextToSize=function(e,t,r){var n,s=(r=r||{}).fontSize||this.internal.getFontSize(),o=function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var f=this.internal.getFont(u.fontName,u.fontStyle),h="Unicode";return f.metadata[h]?{widths:f.metadata[h].widths||{0:1},kerning:f.metadata[h].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var i=1*this.internal.scaleFactor*t/s;o.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/s:0,o.lineIndent=r.lineIndent;var l,c,d=[];for(l=0,c=n.length;l<c;l++)d=d.concat(z9.apply(this,[n[l],i,o]));return d},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},s={},o=0;o<16;o++)n[r[o]]=t[o],s[t[o]]=r[o];var i=function(h){return"0x"+parseInt(h,10).toString(16)},l=e.__fontmetrics__.compress=function(h){var m,v,g,y,x=["{"];for(var b in h){if(m=h[b],isNaN(parseInt(b,10))?v="'"+b+"'":(b=parseInt(b,10),v=(v=i(b).slice(2)).slice(0,-1)+s[v.slice(-1)]),typeof m=="number")m<0?(g=i(m).slice(3),y="-"):(g=i(m).slice(2),y=""),g=y+g.slice(0,-1)+s[g.slice(-1)];else{if(Da(m)!=="object")throw new Error("Don't know what to do with value type "+Da(m)+".");g=l(m)}x.push(v+g)}return x.push("}"),x.join("")},c=e.__fontmetrics__.uncompress=function(h){if(typeof h!="string")throw new Error("Invalid argument passed to uncompress.");for(var m,v,g,y,x={},b=1,w=x,j=[],_="",S="",C=h.length-1,P=1;P<C;P+=1)(y=h[P])=="'"?m?(g=m.join(""),m=void 0):m=[]:m?m.push(y):y=="{"?(j.push([w,g]),w={},g=void 0):y=="}"?((v=j.pop())[0][v[1]]=w,g=void 0,w=v[0]):y=="-"?b=-1:g===void 0?n.hasOwnProperty(y)?(_+=n[y],g=parseInt(_,16)*b,b=1,_=""):_+=y:n.hasOwnProperty(y)?(S+=n[y],w[g]=parseInt(S,16)*b,b=1,g=void 0,S=""):S+=y;return x},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},f={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(h){var m=h.font,v=f.Unicode[m.postScriptName];v&&(m.metadata.Unicode={},m.metadata.Unicode.widths=v.widths,m.metadata.Unicode.kerning=v.kerning);var g=u.Unicode[m.postScriptName];g&&(m.metadata.Unicode.encoding=g,m.encoding=g.codePages[0])}])}(Ln.API),function(e){var t=function(r){for(var n=r.length,s=new Uint8Array(n),o=0;o<n;o++)s[o]=r.charCodeAt(o);return s};e.API.events.push(["addFont",function(r){var n=void 0,s=r.font,o=r.instance;if(!s.isStandardFont){if(o===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=o.existsFileInVFS(s.postScriptName)===!1?o.loadFile(s.postScriptName):o.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(i,l){l=/^\x00\x01\x00\x00/.test(l)?t(l):t(g_(l)),i.metadata=e.API.TTFFont.open(l),i.metadata.Unicode=i.metadata.Unicode||{encoding:{},kerning:{},widths:[]},i.metadata.glyIdsUsed=[0]})(s,n)}}])}(Ln),Ln.API.addSvgAsImage=function(e,t,r,n,s,o,i,l){if(isNaN(t)||isNaN(r))throw gs.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(s))throw gs.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=s;var d=c.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,c.width,c.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(oa.canvg?Promise.resolve(oa.canvg):ef(()=>import("./index.es-60246d09.js"),[])).catch(function(h){return Promise.reject(new Error("Could not load canvg: "+h))}).then(function(h){return h.default?h.default:h}).then(function(h){return h.fromString(d,e,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(h){return h.render(u)}).then(function(){f.addImage(c.toDataURL("image/jpeg",1),t,r,n,s,i,l)})},Ln.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(t,r);return this},Ln.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,s,o,i={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(i),c=[],d=0,u=0,f=0;function h(v,g){var y,x=!1;for(y=0;y<v.length;y+=1)v[y]===g&&(x=!0);return x}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(i)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var m=l.length;for(f=0;f<m;f+=1)r[l[f]].value=r[l[f]].defaultValue,r[l[f]].explicitSet=!1}if(Da(e)==="object"){for(s in e)if(o=e[s],h(l,s)&&o!==void 0){if(r[s].type==="boolean"&&typeof o=="boolean")r[s].value=o;else if(r[s].type==="name"&&h(r[s].valueSet,o))r[s].value=o;else if(r[s].type==="integer"&&Number.isInteger(o))r[s].value=o;else if(r[s].type==="array"){for(d=0;d<o.length;d+=1)if(n=!0,o[d].length===1&&typeof o[d][0]=="number")c.push(String(o[d]-1));else if(o[d].length>1){for(u=0;u<o[d].length;u+=1)typeof o[d][u]!="number"&&(n=!1);n===!0&&c.push([o[d][0]-1,o[d][1]-1].join(" "))}r[s].value="["+c.join(" ")+"]"}else r[s].value=r[s].defaultValue;r[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var v,g=[];for(v in r)r[v].explicitSet===!0&&(r[v].type==="name"?g.push("/"+v+" /"+r[v].value):g.push("/"+v+" "+r[v].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),o=unescape(encodeURIComponent(n)),i=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),d=o.length+i.length+l.length+s.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(s+o+i+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(Ln.API),function(e){var t=e.API,r=t.pdfEscape16=function(o,i){for(var l,c=i.metadata.Unicode.widths,d=["","0","00","000","0000"],u=[""],f=0,h=o.length;f<h;++f){if(l=i.metadata.characterToGlyph(o.charCodeAt(f)),i.metadata.glyIdsUsed.push(l),i.metadata.toUnicode[l]=o.charCodeAt(f),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(i.metadata.widthOfGlyph(l),10)])),l=="0")return u.join("");l=l.toString(16),u.push(d[4-l.length],l)}return u.join("")},n=function(o){var i,l,c,d,u,f,h;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,h=(l=Object.keys(o).sort(function(m,v){return m-v})).length;f<h;f++)i=l[f],c.length>=100&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),o[i]!==void 0&&o[i]!==null&&typeof o[i].toString=="function"&&(d=("0000"+o[i].toString(16)).slice(-4),i=("0000"+(+i).toString(16)).slice(-4),c.push("<"+i+"><"+d+">"));return c.length&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),u+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(o){(function(i){var l=i.font,c=i.out,d=i.newObject,u=i.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="Identity-H"){for(var f=l.metadata.Unicode.widths,h=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),m="",v=0;v<h.length;v++)m+=String.fromCharCode(h[v]);var g=d();u({data:m,addLength1:!0,objectId:g}),c("endobj");var y=d();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:y}),c("endobj");var x=d();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+kv(l.fontName)),c("/FontFile2 "+g+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var b=d();c("<<"),c("/Type /Font"),c("/BaseFont /"+kv(l.fontName)),c("/FontDescriptor "+x+" 0 R"),c("/W "+e.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=d(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+y+" 0 R"),c("/BaseFont /"+kv(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+b+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(o)}]),t.events.push(["putFont",function(o){(function(i){var l=i.font,c=i.out,d=i.newObject,u=i.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var f=l.metadata.rawData,h="",m=0;m<f.length;m++)h+=String.fromCharCode(f[m]);var v=d();u({data:h,addLength1:!0,objectId:v}),c("endobj");var g=d();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:g}),c("endobj");var y=d();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+v+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+kv(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=d();for(var x=0;x<l.metadata.hmtx.widths.length;x++)l.metadata.hmtx.widths[x]=parseInt(l.metadata.hmtx.widths[x]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+kv(l.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(o)}]);var s=function(o){var i,l=o.text||"",c=o.x,d=o.y,u=o.options||{},f=o.mutex||{},h=f.pdfEscape,m=f.activeFontKey,v=f.fonts,g=m,y="",x=0,b="",w=v[g].encoding;if(v[g].encoding!=="Identity-H")return{text:l,x:c,y:d,options:u,mutex:f};for(b=l,g=m,Array.isArray(l)&&(b=l[0]),x=0;x<b.length;x+=1)v[g].metadata.hasOwnProperty("cmap")&&(i=v[g].metadata.cmap.unicode.codeMap[b[x].charCodeAt(0)]),i||b[x].charCodeAt(0)<256&&v[g].metadata.hasOwnProperty("Unicode")?y+=b[x]:y+="";var j="";return parseInt(g.slice(1))<14||w==="WinAnsiEncoding"?j=h(y,g).split("").map(function(_){return _.charCodeAt(0).toString(16)}).join(""):w==="Identity-H"&&(j=r(y,v[g])),f.isHex=!0,{text:j,x:c,y:d,options:u,mutex:f}};t.events.push(["postProcessText",function(o){var i=o.text||"",l=[],c={text:i,x:o.x,y:o.y,options:o.options,mutex:o.mutex};if(Array.isArray(i)){var d=0;for(d=0;d<i.length;d+=1)Array.isArray(i[d])&&i[d].length===3?l.push([s(Object.assign({},c,{text:i[d][0]})).text,i[d][1],i[d][2]]):l.push(s(Object.assign({},c,{text:i[d]})).text);o.text=l}else o.text=s(Object.assign({},c,{text:i})).text}])}(Ln),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Ln.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var s,o,i,l,c,d,u,f=t,h=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],v={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],x=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),b=!1,w=0;this.__bidiEngine__={};var j=function(O){var I=O.charCodeAt(),M=I>>8,D=g[M];return D!==void 0?f[256*D+(255&I)]:M===252||M===253?"AL":x.test(M)?"L":M===8?"R":"N"},_=function(O){for(var I,M=0;M<O.length;M++){if((I=j(O.charAt(M)))==="L")return!1;if(I==="R")return!0}return!1},S=function(O,I,M,D){var U,z,W,$,X=I[D];switch(X){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":b=!1;break;case"N":case"AN":break;case"EN":b&&(X="AN");break;case"AL":b=!0,X="R";break;case"WS":case"BN":X="N";break;case"CS":D<1||D+1>=I.length||(U=M[D-1])!=="EN"&&U!=="AN"||(z=I[D+1])!=="EN"&&z!=="AN"?X="N":b&&(z="AN"),X=z===U?z:"N";break;case"ES":X=(U=D>0?M[D-1]:"B")==="EN"&&D+1<I.length&&I[D+1]==="EN"?"EN":"N";break;case"ET":if(D>0&&M[D-1]==="EN"){X="EN";break}if(b){X="N";break}for(W=D+1,$=I.length;W<$&&I[W]==="ET";)W++;X=W<$&&I[W]==="EN"?"EN":"N";break;case"NSM":if(i&&!l){for($=I.length,W=D+1;W<$&&I[W]==="NSM";)W++;if(W<$){var ye=O[D],Se=ye>=1425&&ye<=2303||ye===64286;if(U=I[W],Se&&(U==="R"||U==="AL")){X="R";break}}}X=D<1||(U=I[D-1])==="B"?"N":M[D-1];break;case"B":b=!1,s=!0,X=w;break;case"S":o=!0,X="N"}return X},C=function(O,I,M){var D=O.split("");return M&&P(D,M,{hiLevel:w}),D.reverse(),I&&I.reverse(),D.join("")},P=function(O,I,M){var D,U,z,W,$,X=-1,ye=O.length,Se=0,V=[],B=w?m:h,Q=[];for(b=!1,s=!1,o=!1,U=0;U<ye;U++)Q[U]=j(O[U]);for(z=0;z<ye;z++){if($=Se,V[z]=S(O,Q,V,z),D=240&(Se=B[$][v[V[z]]]),Se&=15,I[z]=W=B[Se][5],D>0)if(D===16){for(U=X;U<z;U++)I[U]=1;X=-1}else X=-1;if(B[Se][6])X===-1&&(X=z);else if(X>-1){for(U=X;U<z;U++)I[U]=W;X=-1}Q[z]==="B"&&(I[z]=0),M.hiLevel|=W}o&&function(pe,te,Y){for(var ce=0;ce<Y;ce++)if(pe[ce]==="S"){te[ce]=w;for(var me=ce-1;me>=0&&pe[me]==="WS";me--)te[me]=w}}(Q,I,ye)},A=function(O,I,M,D,U){if(!(U.hiLevel<O)){if(O===1&&w===1&&!s)return I.reverse(),void(M&&M.reverse());for(var z,W,$,X,ye=I.length,Se=0;Se<ye;){if(D[Se]>=O){for($=Se+1;$<ye&&D[$]>=O;)$++;for(X=Se,W=$-1;X<W;X++,W--)z=I[X],I[X]=I[W],I[W]=z,M&&(z=M[X],M[X]=M[W],M[W]=z);Se=$}Se++}}},R=function(O,I,M){var D=O.split(""),U={hiLevel:w};return M||(M=[]),P(D,M,U),function(z,W,$){if($.hiLevel!==0&&u)for(var X,ye=0;ye<z.length;ye++)W[ye]===1&&(X=y.indexOf(z[ye]))>=0&&(z[ye]=y[X+1])}(D,M,U),A(2,D,I,M,U),A(1,D,I,M,U),D.join("")};return this.__bidiEngine__.doBidiReorder=function(O,I,M){if(function(U,z){if(z)for(var W=0;W<U.length;W++)z[W]=W;l===void 0&&(l=_(U)),d===void 0&&(d=_(U))}(O,I),i||!c||d)if(i&&c&&l^d)w=l?1:0,O=C(O,I,M);else if(!i&&c&&d)w=l?1:0,O=R(O,I,M),O=C(O,I);else if(!i||l||c||d){if(i&&!c&&l^d)O=C(O,I),l?(w=0,O=R(O,I,M)):(w=1,O=R(O,I,M),O=C(O,I));else if(i&&l&&!c&&d)w=1,O=R(O,I,M),O=C(O,I);else if(!i&&!c&&l^d){var D=u;l?(w=1,O=R(O,I,M),w=0,u=!1,O=R(O,I,M),u=D):(w=0,O=R(O,I,M),O=C(O,I),w=1,u=!1,O=R(O,I,M),u=D,O=C(O,I))}}else w=0,O=R(O,I,M);else w=l?1:0,O=R(O,I,M);return O},this.__bidiEngine__.setOptions=function(O){O&&(i=O.isInputVisual,c=O.isOutputVisual,l=O.isInputRtl,d=O.isOutputRtl,u=O.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var s=n.text;n.x,n.y;var o=n.options||{};n.mutex,o.lang;var i=[];if(o.isInputVisual=typeof o.isInputVisual!="boolean"||o.isInputVisual,r.setOptions(o),Object.prototype.toString.call(s)==="[object Array]"){var l=0;for(i=[],l=0;l<s.length;l+=1)Object.prototype.toString.call(s[l])==="[object Array]"?i.push([r.doBidiReorder(s[l][0]),s[l][1],s[l][2]]):i.push([r.doBidiReorder(s[l])]);n.text=i}else n.text=r.doBidiReorder(s);r.setOptions({isInputVisual:!0})}])}(Ln),Ln.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new Bh(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new eZe(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new BQe(this.contents),this.head=new zQe(this),this.name=new GQe(this),this.cmap=new yae(this),this.toUnicode={},this.hhea=new UQe(this),this.maxp=new KQe(this),this.hmtx=new XQe(this),this.post=new WQe(this),this.os2=new VQe(this),this.loca=new ZQe(this),this.glyf=new YQe(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,s,o;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var i,l,c,d;for(d=[],i=0,l=(c=this.bbox).length;i<l;i++)t=c[i],d.push(Math.round(t*this.scaleFactor));return d}.call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(r=s>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(o=this.familyClass)===1||o===2||o===3||o===4||o===5||o===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var s,o,i,l;for(i=0,o=0,l=(t=""+t).length;0<=l?o<l:o>l;o=0<=l?++o:--o)s=t.charCodeAt(o),i+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/r)||0;return i*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var Nu,Bh=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,s;for(s=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)s.push(this.writeByte(t.charCodeAt(r)));return s},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,s,o,i,l,c;return t=this.readByte(),r=this.readByte(),n=this.readByte(),s=this.readByte(),o=this.readByte(),i=this.readByte(),l=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^o)+65536*(255^i)+256*(255^l)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*s+16777216*o+65536*i+256*l+c},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,s,o;for(o=[],n=0,s=t.length;n<s;n++)r=t[n],o.push(this.writeByte(r));return o},e}(),BQe=function(){var e;function t(r){var n,s,o;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},s=0,o=this.tableCount;0<=o?s<o:s>o;s=0<=o?++s:--s)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,s,o,i,l,c,d,u,f,h,m,v,g;for(g in m=Object.keys(r).length,c=Math.log(2),f=16*Math.floor(Math.log(m)/c),i=Math.floor(f/c),u=16*m-f,(s=new Bh).writeInt(this.scalarType),s.writeShort(m),s.writeShort(f),s.writeShort(i),s.writeShort(u),o=16*m,d=s.pos+o,l=null,v=[],r)for(h=r[g],s.writeString(g),s.writeInt(e(h)),s.writeInt(d),s.writeInt(h.length),v=v.concat(h),g==="head"&&(l=d),d+=h.length;d%4;)v.push(0),d++;return s.write(v),n=2981146554-e(s.data),s.pos=l+8,s.writeUInt32(n),s.data},e=function(r){var n,s,o,i;for(r=bae.call(r);r.length%4;)r.push(0);for(o=new Bh(r),s=0,n=0,i=r.length;n<i;n=n+=4)s+=o.readUInt32();return 4294967295&s},t}(),qQe={}.hasOwnProperty,mf=function(e,t){for(var r in t)qQe.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};Nu=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var zQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return mf(e,Nu),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new Bh).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),J9=function(){function e(t,r){var n,s,o,i,l,c,d,u,f,h,m,v,g,y,x,b,w;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),f=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(m=t.readUInt16(),h=m/2,t.pos+=6,o=function(){var j,_;for(_=[],c=j=0;0<=h?j<h:j>h;c=0<=h?++j:--j)_.push(t.readUInt16());return _}(),t.pos+=2,g=function(){var j,_;for(_=[],c=j=0;0<=h?j<h:j>h;c=0<=h?++j:--j)_.push(t.readUInt16());return _}(),d=function(){var j,_;for(_=[],c=j=0;0<=h?j<h:j>h;c=0<=h?++j:--j)_.push(t.readUInt16());return _}(),u=function(){var j,_;for(_=[],c=j=0;0<=h?j<h:j>h;c=0<=h?++j:--j)_.push(t.readUInt16());return _}(),s=(this.length-t.pos+this.offset)/2,l=function(){var j,_;for(_=[],c=j=0;0<=s?j<s:j>s;c=0<=s?++j:--j)_.push(t.readUInt16());return _}(),c=x=0,w=o.length;x<w;c=++x)for(y=o[c],n=b=v=g[c];v<=y?b<=y:b>=y;n=v<=y?++b:--b)u[c]===0?i=n+d[c]:(i=l[u[c]/2+(n-v)-(h-c)]||0)!==0&&(i+=d[c]),this.codeMap[n]=65535&i}t.pos=f}return e.encode=function(t,r){var n,s,o,i,l,c,d,u,f,h,m,v,g,y,x,b,w,j,_,S,C,P,A,R,O,I,M,D,U,z,W,$,X,ye,Se,V,B,Q,pe,te,Y,ce,me,ae,le,ue;switch(D=new Bh,i=Object.keys(t).sort(function(Re,ne){return Re-ne}),r){case"macroman":for(g=0,y=function(){var Re=[];for(v=0;v<256;++v)Re.push(0);return Re}(),b={0:0},o={},U=0,X=i.length;U<X;U++)b[me=t[s=i[U]]]==null&&(b[me]=++g),o[s]={old:t[s],new:b[t[s]]},y[s]=b[t[s]];return D.writeUInt16(1),D.writeUInt16(0),D.writeUInt32(12),D.writeUInt16(0),D.writeUInt16(262),D.writeUInt16(0),D.write(y),{charMap:o,subtable:D.data,maxGlyphID:g+1};case"unicode":for(I=[],f=[],w=0,b={},n={},x=d=null,z=0,ye=i.length;z<ye;z++)b[_=t[s=i[z]]]==null&&(b[_]=++w),n[s]={old:_,new:b[_]},l=b[_]-s,x!=null&&l===d||(x&&f.push(x),I.push(s),d=l),x=s;for(x&&f.push(x),f.push(65535),I.push(65535),R=2*(A=I.length),P=2*Math.pow(Math.log(A)/Math.LN2,2),h=Math.log(P/2)/Math.LN2,C=2*A-P,c=[],S=[],m=[],v=W=0,Se=I.length;W<Se;v=++W){if(O=I[v],u=f[v],O===65535){c.push(0),S.push(0);break}if(O-(M=n[O].new)>=32768)for(c.push(0),S.push(2*(m.length+A-v)),s=$=O;O<=u?$<=u:$>=u;s=O<=u?++$:--$)m.push(n[s].new);else c.push(M-O),S.push(0)}for(D.writeUInt16(3),D.writeUInt16(1),D.writeUInt32(12),D.writeUInt16(4),D.writeUInt16(16+8*A+2*m.length),D.writeUInt16(0),D.writeUInt16(R),D.writeUInt16(P),D.writeUInt16(h),D.writeUInt16(C),Y=0,V=f.length;Y<V;Y++)s=f[Y],D.writeUInt16(s);for(D.writeUInt16(0),ce=0,B=I.length;ce<B;ce++)s=I[ce],D.writeUInt16(s);for(ae=0,Q=c.length;ae<Q;ae++)l=c[ae],D.writeUInt16(l);for(le=0,pe=S.length;le<pe;le++)j=S[le],D.writeUInt16(j);for(ue=0,te=m.length;ue<te;ue++)g=m[ue],D.writeUInt16(g);return{charMap:n,subtable:D.data,maxGlyphID:w+1}}},e}(),yae=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return mf(e,Nu),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,s;for(t.pos=this.offset,this.version=t.readUInt16(),s=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=s?n<s:n>s;n=0<=s?++n:--n)r=new J9(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,s;return r==null&&(r="macroman"),n=J9.encode(t,r),(s=new Bh).writeUInt16(0),s.writeUInt16(1),n.table=s.data.concat(n.subtable),n},e}(),UQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return mf(e,Nu),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),VQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return mf(e,Nu),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),WQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return mf(e,Nu),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,s;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var o;for(n=t.readUInt16(),this.glyphNameIndex=[],o=0;0<=n?o<n:o>n;o=0<=n?++o:--o)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],s=[];t.pos<this.offset+this.length;)r=t.readByte(),s.push(this.names.push(t.readString(r)));return s;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=function(){var i,l,c;for(c=[],o=i=0,l=this.file.maxp.numGlyphs;0<=l?i<l:i>l;o=0<=l?++i:--i)c.push(t.readUInt32());return c}.call(this)}},e}(),HQe=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},GQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return mf(e,Nu),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,s,o,i,l,c,d,u,f,h;for(t.pos=this.offset,t.readShort(),r=t.readShort(),l=t.readShort(),n=[],o=0;0<=r?o<r:o>r;o=0<=r?++o:--o)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+l+t.readShort()});for(c={},o=u=0,f=n.length;u<f;o=++u)s=n[o],t.pos=s.offset,d=t.readString(s.length),i=new HQe(d,s),c[h=s.nameID]==null&&(c[h]=[]),c[s.nameID].push(i);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),KQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return mf(e,Nu),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),XQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return mf(e,Nu),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,s,o,i,l,c;for(t.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,u;for(u=[],r=d=0;0<=s?d<s:d>s;r=0<=s?++d:--d)u.push(t.readInt16());return u}(),this.widths=function(){var d,u,f,h;for(h=[],d=0,u=(f=this.metrics).length;d<u;d++)o=f[d],h.push(o.advance);return h}.call(this),n=this.widths[this.widths.length-1],c=[],r=i=0;0<=s?i<s:i>s;r=0<=s?++i:--i)c.push(this.widths.push(n));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),bae=[].slice,YQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return mf(e,Nu),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,s,o,i,l,c,d,u,f;return t in this.cache?this.cache[t]:(o=this.file.loca,r=this.file.contents,n=o.indexOf(t),(s=o.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,i=(l=new Bh(r.read(s))).readShort(),d=l.readShort(),f=l.readShort(),c=l.readShort(),u=l.readShort(),this.cache[t]=i===-1?new QQe(l,d,f,c,u):new JQe(l,i,d,f,c,u),this.cache[t]))},e.prototype.encode=function(t,r,n){var s,o,i,l,c;for(i=[],o=[],l=0,c=r.length;l<c;l++)s=t[r[l]],o.push(i.length),s&&(i=i.concat(s.encode(n)));return o.push(i.length),{table:i,offsets:o}},e}(),JQe=function(){function e(t,r,n,s,o,i){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=s,this.xMax=o,this.yMax=i,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),QQe=function(){function e(t,r,n,s,o){var i,l;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=s,this.yMax=o,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],i=this.raw;l=i.readShort(),this.glyphOffsets.push(i.pos),this.glyphIDs.push(i.readUInt16()),32&l;)i.pos+=1&l?4:2,128&l?i.pos+=8:64&l?i.pos+=4:8&l&&(i.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new Bh(bae.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),ZQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return mf(e,Nu),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?function(){var s,o;for(o=[],n=0,s=this.length;n<s;n+=2)o.push(2*t.readUInt16());return o}.call(this):function(){var s,o;for(o=[],n=0,s=this.length;n<s;n+=4)o.push(t.readUInt32());return o}.call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),s=0,o=0,i=0;i<n.length;++i)if(n[i]=s,o<r.length&&r[o]==i){++o,n[i]=s;var l=this.offsets[i],c=this.offsets[i+1]-l;c>0&&(s+=c)}for(var d=new Array(4*n.length),u=0;u<n.length;++u)d[4*u+3]=255&n[u],d[4*u+2]=(65280&n[u])>>8,d[4*u+1]=(16711680&n[u])>>16,d[4*u]=(4278190080&n[u])>>24;return d},e}(),eZe=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,s,o;for(r in s=this.font.cmap.tables[0].codeMap,t={},o=this.subset)n=o[r],t[r]=s[n];return t},e.prototype.glyphsFor=function(t){var r,n,s,o,i,l,c;for(s={},i=0,l=t.length;i<l;i++)s[o=t[i]]=this.font.glyf.glyphFor(o);for(o in r=[],s)(n=s[o])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(o in c=this.glyphsFor(r))n=c[o],s[o]=n;return s},e.prototype.encode=function(t,r){var n,s,o,i,l,c,d,u,f,h,m,v,g,y,x;for(s in n=yae.encode(this.generateCmap(),"unicode"),i=this.glyphsFor(t),m={0:0},x=n.charMap)m[(c=x[s]).old]=c.new;for(v in h=n.maxGlyphID,i)v in m||(m[v]=h++);return u=function(b){var w,j;for(w in j={},b)j[b[w]]=w;return j}(m),f=Object.keys(u).sort(function(b,w){return b-w}),g=function(){var b,w,j;for(j=[],b=0,w=f.length;b<w;b++)l=f[b],j.push(u[l]);return j}(),o=this.font.glyf.encode(i,g,m),d=this.font.loca.encode(o.offsets,g),y={cmap:this.font.cmap.raw(),glyf:o.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},e}();Ln.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,s,o,i;if(Array.isArray(r))return"["+function(){var l,c,d;for(d=[],l=0,c=r.length;l<c;l++)n=r[l],d.push(t.convert(n));return d}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(s in o=["<<"],r)i=r[s],o.push("/"+s+" "+t.convert(i));return o.push(">>"),o.join(`
`)}return""+r},t}();const tZe=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:IQe,AcroFormAppearance:En,AcroFormButton:Qo,AcroFormCheckBox:kb,AcroFormChoiceField:ag,AcroFormComboBox:og,AcroFormEditBox:Ab,AcroFormListBox:sg,AcroFormPasswordField:Ib,AcroFormPushButton:Eb,AcroFormRadioButton:ig,AcroFormTextField:Sh,GState:s1,ShadingPattern:Km,TilingPattern:Gp,default:Ln,jsPDF:Ln},Symbol.toStringTag,{value:"Module"})),Eo=e=>{const t=String(e??"").replace(/\D/g,"");if(!t)return"";const r=(Number(t)/100).toFixed(2),[n,s]=r.split(".");return`${n.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${s}`},Oi=e=>{if(e==null||e==="")return NaN;const t=String(e).replace(/\./g,"").replace(",","."),r=parseFloat(t);return Number.isFinite(r)?r:NaN};function rZe({setIsModalOpen:e,setBookings:t,form:r,setForm:n,localCustomers:s,onOpenClientModal:o,onClientModalSuccess:i}){const{toast:l}=Qa(),{userProfile:c}=ms(),{loadAlerts:d}=E1(),{isPaymentModalOpen:u,closePaymentModal:f,editingBooking:h,paymentTotal:m,setPaymentTotal:v,participantsForm:g,setParticipantsForm:y,payMethods:x,openEditParticipantModal:b,protectPaymentModal:w,unprotectPaymentModal:j,onParticipantReplacedRef:_,lastVisibilityChangeTime:S,isModalProtected:C}=hN();window.__protectPaymentModal=w,p.useEffect(()=>(u&&(document.body.style.overflow="auto",document.body.style.pointerEvents="auto"),()=>{document.body.style.overflow="",document.body.style.pointerEvents=""}),[u]);const[P,A]=p.useState(""),[R,O]=p.useState([]);p.useState(null);const[I,M]=p.useState(null),[D,U]=p.useState(!1),[z,W]=p.useState(""),[$,X]=p.useState(!1),[ye,Se]=p.useState([]);p.useState(null);const[V,B]=p.useState(0),[Q,pe]=p.useState(!1),[te,Y]=p.useState(""),[ce,me]=p.useState([]),[ae,le]=p.useState([]),ue=p.useRef(!1),Re=p.useRef({}),ne=p.useRef({}),ie=p.useRef({}),[gt,bt]=p.useState(null),[at,xt]=p.useState(null),[Ze,ht]=p.useState(!1),[Wt,be]=p.useState("downloading"),[Ct,wt]=p.useState(0),[Ge,Je]=p.useState(null),[_e,je]=p.useState(""),[Ue,ze]=p.useState(null),or=p.useRef(null),tr=p.useRef(null),Nt=p.useRef(null),yr=p.useRef(null),Me=p.useRef([]),dt=p.useRef(null),ut=p.useRef(!1),rr=p.useRef(null),hr=p.useRef([]),[It,dr]=p.useState({isOpen:!1,participantIndex:null,currentStatus:null}),ur=p.useRef(!1),er=p.useCallback((nt,$t)=>{le(Kt=>{const sr=[...Kt];return nt>=0&&nt<sr.length&&($t===""&&sr[nt].nome&&(ie.current[nt]=sr[nt].nome),$t!==""&&delete ie.current[nt],sr[nt]={...sr[nt],nome:$t}),y(sr),sr})},[y]),ln=p.useCallback(nt=>{const $t=ie.current[nt];$t&&(le(Kt=>{const sr=[...Kt];return nt>=0&&nt<sr.length&&(sr[nt]={...sr[nt],nome:$t}),delete ie.current[nt],y(sr),sr}),setTimeout(()=>{Re.current[nt]?.focus()},0))},[y]),Mr=p.useCallback((nt,$t,Kt)=>{if($t==="Pago"){const sr=Oi(Kt);if(Number.isFinite(sr)&&sr>0)return}ur.current=!0,console.log(" [StatusConfirmation] Modal protegido por 3 segundos"),setTimeout(()=>{ur.current=!1,console.log(" [StatusConfirmation] Proteo removida")},3e3),dr({isOpen:!0,participantIndex:nt,currentStatus:$t})},[]),Ye=p.useCallback(nt=>{const{participantIndex:$t}=It;$t!==null&&(le(Kt=>{const sr=[...Kt];return $t>=0&&$t<sr.length&&(sr[$t]={...sr[$t],status_pagamento:nt}),y(sr),sr}),setTimeout(()=>{console.log(" [StatusChange] Recarregando alertas..."),d().catch(Kt=>{console.error(" [StatusChange] Erro ao recarregar alertas:",Kt)})},500)),dr({isOpen:!1,participantIndex:null,currentStatus:null})},[It,y,d]),$e=p.useCallback(nt=>!s||!Array.isArray(s)?!1:s.find(Kt=>Kt.id===nt)?.is_consumidor_final===!0,[s]),Be=p.useCallback(()=>{const nt=R||[],$t=(ae||[]).map((St,Jr)=>({...St,_originalIndex:Jr})).filter(St=>!nt.includes(St._originalIndex)),Kt=$t.find(St=>$e(St.cliente_id)&&St.nome&&St.nome.toLowerCase().includes("cliente consumidor"));return Kt?Kt._originalIndex:$t.find(St=>$e(St.cliente_id)&&St.nome)?._originalIndex??null},[ae,R,$e]),et=p.useCallback(nt=>{const $t=R||[],sr=(ae||[]).map((Jr,Pt)=>({...Jr,_originalIndex:Pt})).filter(Jr=>!$t.includes(Jr._originalIndex)).filter(Jr=>$e(Jr.cliente_id));if(sr.length===0)return null;const St=sr.findIndex(Jr=>Jr._originalIndex===nt);return St!==-1?St<sr.length-1?sr[St+1]._originalIndex:sr[0]._originalIndex:null},[ae,R,$e]),jt=p.useCallback(nt=>{const $t=R||[],sr=(ae||[]).map((Jr,Pt)=>({...Jr,_originalIndex:Pt})).filter(Jr=>!$t.includes(Jr._originalIndex)).filter(Jr=>$e(Jr.cliente_id)),St=sr.findIndex(Jr=>Jr._originalIndex===nt);return St>0?sr[St-1]._originalIndex:null},[ae,R,$e]),yt=p.useCallback(()=>{if(!x||x.length===0)return null;const nt=x.find($t=>$t.codigo_interno==="01");return nt||x[0]},[x]),qt=p.useMemo(()=>{const nt=ae||[],$t=R||[];return nt.filter((Kt,sr)=>!$t.includes(sr)).length},[ae,R]),pt=p.useMemo(()=>{const nt=ae||[],$t=R||[],Kt=nt.filter((Et,ar)=>!$t.includes(ar)),sr=Oi(m);let St=0,Jr=0,Pt=0,lr=!1;Kt.forEach(Et=>{let ar=Oi(Et?.valor_cota);if(Et?.aplicar_taxa===!0&&Number.isFinite(ar)){const Qr=x.find(Qt=>String(Qt.id)===String(Et.finalizadora_id)),tn=Number(Qr?.taxa_percentual||0);tn>0&&(ar=ar/(1+tn/100),lr=!0)}Number.isFinite(ar)&&(St+=ar),(Et?.status_pagamento||"Pendente")==="Pago"?Jr++:Pt++});const st=Number.isFinite(sr)?St-sr:0;return{totalTarget:sr,totalAssigned:St,diff:st,paid:Jr,pending:Pt,temTaxaAplicada:lr}},[ae,R,m,x]),Dt=()=>{const nt=Oi(m);if(!Number.isFinite(nt)||qt===0)return;const $t=nt/qt,Kt=Eo(String($t.toFixed(2)));le(sr=>{const St=[...sr];return St.forEach((Jr,Pt)=>{St[Pt]={...St[Pt],valor_cota:Kt,status_pagamento:"Pago",aplicar_taxa:!1}}),St})},he=()=>{le(nt=>{const $t=[...nt];return $t.forEach((Kt,sr)=>{$t[sr]={...$t[sr],valor_cota:"",status_pagamento:"Pendente",aplicar_taxa:!1}}),$t})},Qe=()=>{le(nt=>{const $t=[...nt];return $t.forEach((Kt,sr)=>{const St=Oi(Kt.valor_cota);if(St>0){const Pt=x.find(st=>String(st.id)===String(Kt.finalizadora_id)),lr=Number(Pt?.taxa_percentual||0);if(lr>0&&!Kt.aplicar_taxa){const st=St*(1+lr/100);$t[sr]={...$t[sr],aplicar_taxa:!0,valor_cota:Eo(st.toFixed(2))}}}}),$t})},zt=(nt,$t)=>{b(nt,$t)},Mt=()=>{Y(m||""),pe(!0)},ir=()=>{try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal][TOTAL] confirmEditingTotal",{prev:m,next:te,timestamp:new Date().toISOString()})}catch{}v(te),pe(!1)},nr=()=>{Y(""),pe(!1)},kr=async(nt={})=>{const{autoSave:$t=!1}=nt;try{if(ut.current||D){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [SAVE-PAYMENTS] Salvamento ignorado (j existe um em andamento)",{autoSave:$t})}catch{}return}ut.current=!0,U(!0);const Kt=h?.id,sr=c?.codigo_empresa;try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [SAVE-PAYMENTS] Iniciando salvamento",{autoSave:$t,agendamentoId:Kt,timestamp:new Date().toISOString()})}catch{}if(!Kt||!sr){l({title:"Erro ao salvar pagamentos",description:"Agendamento ou empresa indisponvel.",variant:"destructive"});return}const St=(ae||[]).filter((se,He)=>!(R||[]).includes(He)),Jr=Q?te:m;try{if(Q){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal][TOTAL] forcing total from editing state before save",{prev:m,editingTotalValue:te,totalStrToSave:Jr,timestamp:new Date().toISOString()})}catch{}v(Jr),pe(!1)}}catch{}let Pt=0;const lr=St.reduce((se,He)=>{const ot=He.status_pagamento||"Pendente";return se+(ot!=="Pago"?1:0)},0);try{localStorage.getItem("debug:agenda")==="1"&&(console.log(" [SAVE-PAYMENTS] Dados a salvar:",{totalParticipantes:St.length,pendentes:lr}),console.log("[ORDER-SAVE] savingIds:",St.map(se=>se.cliente_id)))}catch{}const st=new Date().toISOString();try{localStorage.getItem("debug:agenda")==="1"&&console.log(`

========== SALVAMENTO INICIADO ${st} ==========`)}catch{}const{data:Et,error:ar}=await de.from("agendamento_participantes").select("*").eq("codigo_empresa",sr).eq("agendamento_id",Kt).is("deleted_at",null).order("ordem",{ascending:!0}).order("id",{ascending:!0});if(ar)throw console.error(" Erro ao buscar participantes originais:",ar),ar;try{localStorage.getItem("debug:agenda")==="1"&&(console.log(` Participantes originais no banco: ${Et?.length||0}`),console.log("[ORDER-SAVE] originalIds:",(Et||[]).map(se=>se.cliente_id)))}catch{}Pt=0,St.forEach((se,He)=>{console.log(`  #${He+1} (novo): ${se.nome}`)}),console.log(" Fazendo recriao completa de participantes (soft-delete + insert)");try{const{error:se}=await de.from("agendamento_participantes").update({deleted_at:new Date().toISOString(),is_representante:!1}).eq("codigo_empresa",sr).eq("agendamento_id",Kt).is("deleted_at",null);if(se)throw console.error(" Erro ao aplicar soft-delete nos participantes atuais:",se),se}catch(se){throw console.error(" Falha ao soft-deletar participantes antes de recriar:",se),se}if(St.length>0){const se=St.map((ot,ee)=>{const k=Oi(ot.valor_cota),T=yt(),K=ot.finalizadora_id||(T?.id?String(T.id):null);return{codigo_empresa:sr,agendamento_id:Kt,cliente_id:ot.cliente_id,nome:(ot?.nome||"").trim()||"Cliente Consumidor",valor_cota:Number.isFinite(k)?k:0,status_pagamento:ot.status_pagamento||"Pendente",finalizadora_id:K,aplicar_taxa:ot.aplicar_taxa||!1,ordem:ee+1,is_representante:ee===0,deleted_at:null}}),{error:He}=await de.from("agendamento_participantes").insert(se);if(He)throw console.error(" Erro ao inserir participantes recriados:",He),He}console.log(" Recriao completa de participantes concluda"),console.log(`========== SALVAMENTO CONCLUDO ==========

`);const Tr=St.map(se=>({id:se.cliente_id,nome:se.nome,codigo:se.codigo!==null&&se.codigo!==void 0?se.codigo:null})),Qr=Tr[0]||null,tn=Tr.map(se=>se?.nome).filter(Boolean),Qt=Oi(Jr),fn=Number.isFinite(Qt)?Qt:null;try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal][TOTAL] updating agendamentos.valor_total",{agendamentoId:Kt,codigo_empresa:sr,totalStrToSave:Jr,totalNum:Qt,totalToPersist:fn,timestamp:new Date().toISOString()})}catch{}const{data:nn,error:In}=await de.from("agendamentos").update({cliente_id:Qr?.id??null,clientes:tn,valor_total:fn}).eq("codigo_empresa",sr).eq("id",Kt).select("id, valor_total");try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal][TOTAL] update agendamentos result",{ok:!In,error:In?In.message||In:null,data:nn,timestamp:new Date().toISOString()})}catch{}if(In)throw In;n(se=>({...se,selectedClients:Tr})),t(se=>se.map(He=>He.id===Kt?{...He,customer:Qr?.nome||He.customer,cliente_id:Qr?.id??null,clientes:tn,valor_total:fn}:He));let Dn=St;if(at!==null){const se=Re.current?.[at]?.value;typeof se=="string"&&(Dn=[...St],at>=0&&at<Dn.length&&(Dn[at]={...Dn[at],nome:se}))}le(Dn),O([]),$t||(lr>0?l({title:"Pagamentos salvos",description:`${lr} ${lr===1?"pendente":"pendentes"}`,variant:"warning"}):l({title:"Pagamentos salvos",variant:"success"})),M(null),y(St);try{window.dispatchEvent(new CustomEvent("payments:saved",{detail:{agendamentoId:Kt,participants:St}}))}catch{}d().catch(se=>{console.error("[PaymentModal] Erro ao recarregar alertas:",se)});try{localStorage.getItem("debug:agenda")==="1"&&(console.log(" [SAVE-PAYMENTS] Salvamento concludo com sucesso"),console.log(" [SAVE-PAYMENTS] Contagem final de pendentes:",lr))}catch{}console.log(" [LOG 2 - FECHAR PAYMENT MODAL] Dados salvos no banco:"),console.log("   Total:",St.length),console.log("   Pendentes:",lr),St.forEach((se,He)=>{console.log(`   #${He+1}: ${se.nome} | Status: ${se.status_pagamento} | Valor: ${se.valor_cota}`)}),$t&&console.log(" [SAVE-PAYMENTS] Salvamento em modo autoSave (sem fechar modal)")}catch(Kt){throw console.error(" [SAVE-PAYMENTS] Erro ao salvar:",Kt),l({title:"Erro ao salvar pagamentos",description:"Tente novamente.",variant:"destructive"}),Kt}finally{ut.current=!1,U(!1)}},Ft=p.useCallback(async(nt="close")=>{try{if(!u||ue.current||Ze&&Wt==="downloading"||It?.isOpen||$||C&&String(nt)==="interactOutside")return;ue.current=!0;try{await kr({autoSave:!0})}catch($t){console.error("[PaymentModal] Falha ao salvar ao fechar:",$t)}finally{try{j()}catch{}f({force:!0});try{window.dispatchEvent(new Event("paymentmodal:closed"))}catch{}}}catch{}finally{ue.current=!1}},[u,Ze,Wt,It?.isOpen,$,C,kr,f,j]);p.useEffect(()=>{const nt=$t=>{if(u&&!$&&!Ze&&($t.key==="Escape"&&($t.preventDefault(),Ft("escape-key")),$t.key==="F8"&&($t.preventDefault(),m&&qt>0&&Dt()),$t.key==="F9"&&($t.preventDefault(),qt>0&&Qe()),$t.key==="F10"&&($t.preventDefault(),qt>0&&he()),$t.key==="Delete")){const Kt=document.activeElement;if(!(Kt&&Kt.tagName==="INPUT")){$t.preventDefault();const St=Be();St!==null&&(er(St,""),setTimeout(()=>{Re.current[St]?.focus()},0))}}};return window.addEventListener("keydown",nt),()=>window.removeEventListener("keydown",nt)},[u,$,Ze,m,qt,Dt,Qe,he,Ft,ae,R,$e,er,Be]),p.useEffect(()=>{if(u){const nt=Be();bt(nt)}},[u,ae,R,Be]),p.useEffect(()=>{if(u){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Modal aberto - payMethods:",x?.length||0,"initializedRef:",tr.current)}catch{}Nt.current=setTimeout(()=>{try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Timeout de 3s acionado - initializedRef:",tr.current,"payMethods:",x?.length||0)}catch{}if(!tr.current&&(!x||x.length===0)){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Inicializando com timeout (sem finalizadoras)")}catch{}const nt=(r?.selectedClients||[]).map($t=>{let Kt=$t.codigo;if(Kt==null&&s&&Array.isArray(s)){const sr=s.find(St=>St.id===$t.id);Kt=sr?.codigo!==null&&sr?.codigo!==void 0?sr.codigo:null}return{cliente_id:$t.id,nome:$t.nome,codigo:Kt,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:null,aplicar_taxa:!1}});Array.isArray(ae)&&ae.length>0||le(nt),tr.current=Date.now()}},3e3),!tr.current&&x&&x.length>0&&(Nt.current&&(clearTimeout(Nt.current),Nt.current=null),(async()=>{const{defaultMethod:$t,defaultFinalizadoraId:Kt,defaultAplicarTaxa:sr}=(()=>{const lr=yt(),st=lr?.id?String(lr.id):null,Et=Number(lr?.taxa_percentual||0)>0;return{defaultMethod:lr,defaultFinalizadoraId:st,defaultAplicarTaxa:Et}})();let St=[],Jr="nenhuma";if(h?.id)try{const{data:lr,error:st}=await de.from("agendamento_participantes").select("*").eq("agendamento_id",h.id).eq("codigo_empresa",c?.codigo_empresa).is("deleted_at",null).order("ordem",{ascending:!0}).order("id",{ascending:!0});st?console.error(" Erro ao buscar participantes:",st):lr&&lr.length>0?(St=lr.map(Et=>({cliente_id:Et.cliente_id,nome:Et.nome,codigo:null,valor_cota:Et.valor_cota?Eo(String(Number(Et.valor_cota).toFixed(2))):"0,00",status_pagamento:Et.status_pagamento||"Pendente",finalizadora_id:Et.finalizadora_id?String(Et.finalizadora_id):Kt,aplicar_taxa:Et.aplicar_taxa||!1})),Jr="banco de dados"):Jr="banco vazio"}catch(lr){console.error(" Erro ao buscar participantes:",lr)}St.length===0&&g&&g.length>0?(St=g,Jr="participantsForm (contexto)"):St.length===0&&r?.selectedClients&&r.selectedClients.length>0&&(St=(r?.selectedClients||[]).map(lr=>{let st=lr.codigo;if(st==null&&s&&Array.isArray(s)){const Et=s.find(ar=>ar.id===lr.id);st=Et?.codigo!==null&&Et?.codigo!==void 0?Et.codigo:null}return{cliente_id:lr.id,nome:lr.nome,codigo:st,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:Kt,aplicar_taxa:sr}}),Jr="form.selectedClients");let Pt=St.map(lr=>{let st=lr.codigo;if(st==null&&s&&Array.isArray(s)){const ar=s.find(Tr=>Tr.id===lr.cliente_id);st=ar?.codigo!==null&&ar?.codigo!==void 0?ar.codigo:null}let Et=lr.finalizadora_id;if(!Et){const ar=yt();Et=ar?.id?String(ar.id):null}return{...lr,codigo:st??lr.codigo,finalizadora_id:Et}});try{const lr=(r?.selectedClients||[]).slice();if(lr.length>0&&Pt.length>0){const st=new Map;Pt.forEach(Tr=>{const Qr=st.get(Tr.cliente_id)||[];Qr.push(Tr),st.set(Tr.cliente_id,Qr)});const Et=new Map,ar=[];for(const Tr of lr){const Qr=Et.get(Tr.id)||0,Qt=(st.get(Tr.id)||[])[Qr];if(Qt)ar.push(Qt),Et.set(Tr.id,Qr+1);else{const fn=yt(),nn=fn?.id?String(fn.id):null;ar.push({cliente_id:Tr.id,nome:Tr.nome,codigo:Tr.codigo??null,valor_cota:"0,00",status_pagamento:"Pendente",finalizadora_id:nn,aplicar_taxa:Number(fn?.taxa_percentual||0)>0})}}St=ar,Jr=Jr+" (reordenado pelos chips)"}}catch(lr){console.error("[PaymentModal] Falha ao reordenar por chips:",lr)}if(Pt=St.map(lr=>{let st=lr.codigo;if(st==null&&s&&Array.isArray(s)){const Et=s.find(ar=>ar.id===lr.cliente_id);st=Et?.codigo!==null&&Et?.codigo!==void 0?Et.codigo:null}return{...lr,codigo:st??lr.codigo,finalizadora_id:lr.finalizadora_id||(()=>{const Et=yt();return Et?.id?String(Et.id):null})()}}),Pt.length===0&&h?.id){console.error(" ALERTA CRTICO: Nenhum participante encontrado em NENHUMA fonte!"),console.error(" Agendamento ID:",h.id),console.error(" Empresa:",c?.codigo_empresa),console.error(" Isso pode indicar perda de dados!");try{const{data:lr,error:st}=await de.from("agendamento_participantes").select("*").eq("agendamento_id",h.id);console.error(" Busca sem filtro de empresa:",{encontrados:lr?.length||0,dados:lr,erro:st})}catch(lr){console.error(" Erro na busca de debug:",lr)}}if(Pt.length>0||!h?.id){Array.isArray(ae)&&ae.length>0||le(Pt),tr.current=Date.now();try{if(localStorage.getItem("debug:agenda")==="1"){console.log(" [LOG 1 - ABRIR PAYMENT MODAL] Participantes carregados:"),console.log("   Total:",Pt.length),console.log("   Fonte:",Jr),Pt.forEach((Et,ar)=>{console.log(`   #${ar+1}: ${Et.nome} | Status: ${Et.status_pagamento} | Valor: ${Et.valor_cota}`)});const lr=(r?.selectedClients||[]).map(Et=>Et.id),st=Pt.map(Et=>Et.cliente_id);console.log("[ORDER] chipsIds:",lr),console.log("[ORDER] finalIds:",st)}}catch{}}else console.error(" BLOQUEADO: No vou sobrescrever com array vazio!"),console.error(" Mantendo dados anteriores para evitar perda.")})())}else Nt.current&&(clearTimeout(Nt.current),Nt.current=null),A(""),M(null),O([]),le([]);return()=>{Nt.current&&clearTimeout(Nt.current)}},[u,x,yt,g,r?.selectedClients,s,ae]),p.useEffect(()=>{u&&!tr.current&&Array.isArray(ae)&&ae.length>0&&(tr.current=Date.now())},[u,ae]),p.useEffect(()=>{if(!u)return;const nt=(ae||[]).length;if(rr.current==null){rr.current=nt,hr.current=Array.isArray(ae)?ae:[];return}const $t=nt<rr.current;let Kt=[];try{const sr=Array.isArray(hr.current)?hr.current:[],St=Array.isArray(ae)?ae:[],Jr=lr=>`${lr?.cliente_id??""}|${(lr?.nome??"").toLowerCase()}`,Pt=new Set(St.map(Jr));Kt=sr.filter(lr=>!Pt.has(Jr(lr)))}catch{}if(rr.current=nt,hr.current=Array.isArray(ae)?ae:[],$t&&h?.id)try{const sr=Kt.map(St=>St?.nome).filter(Boolean);console.log(" [PaymentModal] Participante(s) removido(s):",sr);try{window.dispatchEvent(new CustomEvent("payments:participant-removed",{detail:{agendamentoId:h?.id,removed:Kt}}))}catch{}}catch{}},[u,ae,h?.id,kr]),p.useEffect(()=>{if(!u)return;const nt=p.useRef.__prevHidden=p.useRef.__prevHidden||{len:0},$t=(R||[]).length,Kt=$t>(nt.len||0);if(nt.len=$t,Kt&&h?.id)try{console.log(" [PaymentModal] ndices ocultados (remoo lgica):",R)}catch{}},[R,u,h?.id,kr]),p.useEffect(()=>{tr.current=null},[h?.id]),p.useEffect(()=>(_.current=nt=>{me([nt]),setTimeout(()=>{me([])},1e3)},()=>{_.current=null}),[_]);const Dr=p.useCallback(nt=>{le(nt)},[]);p.useEffect(()=>(u&&(y.updateLocal=Dr,y.getLocal=()=>ae),()=>{y.updateLocal&&(delete y.updateLocal,delete y.getLocal)}),[u,Dr,ae]),p.useLayoutEffect(()=>{if(!u)return;const nt=(r?.selectedClients||[]).slice();if(!(nt.length===0||!ae||ae.length===0||at!==null||(ae||[]).some(Kt=>Kt?.status_pagamento&&Kt.status_pagamento!=="Pendente"||Kt?.valor_cota&&Kt.valor_cota!==""&&Kt.valor_cota!=="0,00")))try{const Kt=new Map;ae.forEach(Et=>{const ar=Kt.get(Et.cliente_id)||[];ar.push(Et),Kt.set(Et.cliente_id,ar)});const sr=new Map,St=[];for(const Et of nt){const ar=sr.get(Et.id)||0,Qr=(Kt.get(Et.id)||[])[ar];Qr?(St.push(Qr),sr.set(Et.id,ar+1)):St.push({cliente_id:Et.id,nome:Et.nome,codigo:Et.codigo??null,valor_cota:"0,00",status_pagamento:"Pendente",finalizadora_id:yt()?.id?String(yt().id):null,aplicar_taxa:Number(yt()?.taxa_percentual||0)>0})}const Jr=new Map(sr),Pt=[];Kt.forEach((Et,ar)=>{const Tr=Jr.get(ar)||0;for(let Qr=Tr;Qr<Et.length;Qr++)Pt.push(Et[Qr])});const lr=St.concat(Pt);if(lr.length!==ae.length||lr.some((Et,ar)=>Et.cliente_id!==ae[ar]?.cliente_id||Et.nome!==ae[ar]?.nome)){try{if(localStorage.getItem("debug:agenda")==="1"){const Et=nt.map(Tr=>Tr.nome),ar=lr.map(Tr=>Tr.nome);console.log("[ORDER] chipsNames:",Et),console.log("[ORDER] finalNames (next):",ar)}}catch{}le(lr)}}catch(Kt){console.error("[PaymentModal] Falha ao reordenar aps mudana de chips:",Kt)}},[u,r?.selectedClients]),p.useEffect(()=>{$||(Se([]),W("")),B(0)},[$]),p.useEffect(()=>{$&&Me.current[V]&&Me.current[V]?.scrollIntoView({behavior:"smooth",block:"nearest"})},[V,$]),p.useEffect(()=>{const nt=$t=>{if($){if($t.key==="Escape"){$t.preventDefault(),X(!1),W(""),Se([]);try{j()}catch{}}if($t.key==="Enter"&&$t.target.tagName!=="INPUT"&&ye.length>0){$t.preventDefault();const Kt=ye.map(sr=>({cliente_id:sr.id,nome:sr.nome,codigo:sr.codigo,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:(()=>{const St=yt();return St?.id?String(St.id):null})(),aplicar_taxa:(()=>{const St=yt();return Number(St?.taxa_percentual||0)>0})()}));le(sr=>{const St=sr.length,Jr=Kt.map((Pt,lr)=>St+lr);return me(Jr),setTimeout(()=>{me([])},1e3),[...sr,...Kt]}),X(!1),Se([]),W("");try{j()}catch{}}}};return window.addEventListener("keydown",nt),()=>window.removeEventListener("keydown",nt)},[$,ye,yt,le,l,W,X,Se]),p.useEffect(()=>{const nt=async()=>{await Ft("external:save-and-close")};return window.addEventListener("paymentmodal:save-and-close",nt),()=>window.removeEventListener("paymentmodal:save-and-close",nt)},[Ft]),p.useEffect(()=>{!Ze&&Ue&&(console.log(" [PDF] Revogando URL do blob ao fechar modal"),URL.revokeObjectURL(Ue),ze(null))},[Ze,Ue]);const Fr=p.useRef(null),Tn=async()=>{try{if(console.log(" [PDF] Iniciando gerao do PDF"),!Fr.current)throw new Error("Elemento do relatrio no encontrado");console.log(" [PDF] Abrindo modal de download"),Ue&&URL.revokeObjectURL(Ue),ht(!0),be("downloading"),wt(0),Je(null),ze(null),je("");const nt=(ae||[]).filter((Dn,se)=>!(R||[]).includes(se)),$t=20,Kt=Math.ceil(nt.length/$t);wt(5);const sr=new Ln({orientation:"landscape",unit:"mm",format:"a4",compress:!0}),St=297,Jr=210;for(let Dn=0;Dn<Kt;Dn++){const se=Dn*$t,He=Math.min(se+$t,nt.length),ot=nt.slice(se,He),ee=10+Math.floor(Dn/Kt*80);wt(ee);const k=Fr.current;if(!k)throw new Error("Elemento do relatrio no encontrado durante a gerao");console.log(` [PDF] Capturando pgina ${Dn+1}/${Kt} (participantes ${se+1}-${He})`);const T={visibility:k.style.visibility,opacity:k.style.opacity};k.style.visibility="visible",k.style.opacity="1",console.log(` [PDF] Elemento innerHTML length: ${k.innerHTML.length}`),console.log(` [PDF] Elemento scrollHeight: ${k.scrollHeight}`),console.log(` [PDF] Elemento scrollWidth: ${k.scrollWidth}`);const K=k.querySelector('div[style*="borderBottom"]'),H=k.querySelectorAll('div[style*="borderBottom"]')[1];Dn>0?(K&&(K.style.display="none"),H&&(H.style.display="none")):(K&&(K.style.display="block"),H&&(H.style.display="flex"));const F=k.querySelectorAll("tbody tr");console.log(` [PDF] Total de linhas na tabela: ${F.length}`),F.forEach((kt,Sr)=>{kt.style.display=Sr>=se&&Sr<He?"table-row":"none"});const Le=k.querySelector("#page-indicator");Le&&(Le.textContent=`Pgina ${Dn+1} de ${Kt}`),console.log(" [PDF] Forando reflow..."),k.offsetHeight,k.getBoundingClientRect(),k.scrollHeight,k.offsetWidth,k.clientHeight,console.log(" [PDF] Aguardando renderizao..."),await new Promise(kt=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{setTimeout(kt,2e3)})})})}),console.log(" [PDF] Renderizao completa, iniciando captura...");const it=k.querySelectorAll("tbody tr");if(console.log(` [PDF] Linhas da tabela encontradas: ${it.length}`),it.forEach((kt,Sr)=>{const Or=kt.querySelectorAll("td"),fr=Array.from(Or).map(Kr=>Kr.textContent.trim()).join(" | ");console.log(` [PDF] Linha ${Sr+1}: ${fr}`)}),it.length===0){console.warn(" [PDF] AVISO: Nenhuma linha de tabela encontrada! Verificando estrutura...");const kt=k.querySelector("tbody");console.log(" [PDF] tbody existe:",!!kt),kt&&console.log(" [PDF] innerHTML do tbody:",kt.innerHTML.substring(0,500))}let lt;try{const kt=k.scrollHeight,Sr=k.scrollWidth;if(console.log(` [PDF] Dimenses reais: width=${Sr}px, height=${kt}px`),lt=await ZKe(k,{pixelRatio:2,backgroundColor:"#ffffff",cacheBust:!0,skipFonts:!1}),!lt||lt.length===0)throw new Error("Canvas vazio retornado pela captura");console.log(` [PDF] Pgina ${Dn+1} capturada (${lt.length} bytes, ${kt}px altura, ${it.length} linhas)`)}catch(kt){throw console.error(` [PDF] Erro ao capturar pgina ${Dn+1}:`,kt),k.style.visibility=T.visibility,k.style.opacity=T.opacity,new Error(`Falha ao capturar pgina ${Dn+1}: ${kt.message}`)}k.style.visibility=T.visibility,k.style.opacity=T.opacity,Dn>0&&sr.addPage();const Vt=St,Ve=k.scrollHeight/k.scrollWidth*St;sr.addImage(lt,"PNG",0,0,Vt,Ve,"","MEDIUM"),console.log(` [PDF] Pgina ${Dn+1} adicionada ao PDF (${Vt}mm x ${Ve}mm)`)}if(Fr.current){Fr.current.querySelectorAll("tbody tr").forEach(He=>{He.style.display="table-row"});const se=Fr.current.querySelector("#page-indicator");se&&(se.textContent="")}wt(95);const Pt=Kt>1?` (${Kt} pginas)`:"",lr=(ae||[]).filter((Dn,se)=>!(R||[]).includes(se));let st=lr.find(Dn=>!s?.find(He=>He.id===Dn.cliente_id)?.is_consumidor_final);!st&&lr.length>0&&(st=lr[0]);const ar=(st?.nome||"sem-nome").trim().split(/\s+/),Tr=ar[0]||"sem",Qr=ar.length>1?ar[ar.length-1]:"nome",Qt=`rel-${`${Tr}-${Qr}`.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9-]+/g,"-").replace(/^-+|-+$/g,"")}-${h?.code||"0"}${Pt}.pdf`,fn=sr.output("blob"),nn=URL.createObjectURL(fn);Je(fn),ze(nn),je(Qt),wt(100);const In=document.createElement("a");In.href=nn,In.download=Qt,In.click(),await new Promise(Dn=>setTimeout(Dn,500)),console.log(" [PDF] PDF gerado com sucesso! Modal de download deve permanecer aberto."),console.log(" [PDF] isPaymentModalOpen deve continuar true"),be("success"),console.log(" [PDF] Status atualizado para success")}catch(nt){console.error(" [PDF] Erro ao gerar PDF:",nt),ht(!1),l({title:"Erro ao gerar PDF",description:nt?.message||"No foi possvel gerar o PDF.",variant:"destructive"})}};return a.jsxs(a.Fragment,{children:[a.jsx(mn,{open:u,onOpenChange:nt=>{if(console.log(" [PaymentModal] onOpenChange chamado:",{open:nt,isDownloadModalOpen:Ze}),!nt){if(console.log(" [PaymentModal] Tentando fechar modal de pagamentos"),Ze&&Wt==="downloading"){console.log(" [PaymentModal] BLOQUEADO: Modal de download est gerando");return}Ft("x")}},children:a.jsx(un,{forceMount:!0,className:"w-full max-w-screen-sm sm:max-w-[1100px] max-h-[90vh] overflow-y-auto overflow-x-hidden mx-auto px-5 sm:px-6 flex flex-col items-center sm:items-stretch",onOpenAutoFocus:nt=>nt.preventDefault(),onInteractOutside:async nt=>{const $t=Date.now(),Kt=tr.current?$t-tr.current:0,sr=$t-S;if(console.log(" [PaymentModal] onInteractOutside disparado:",{target:nt.target?.tagName,className:nt.target?.className?.substring?.(0,50),timeSinceInit:`${Kt}ms`,timeSinceVisibility:`${sr}ms`,isAddParticipantOpen:$,isDownloadModalOpen:Ze,statusConfirmationOpen:It.isOpen,isModalProtected:C,timestamp:new Date().toISOString()}),It.isOpen){console.log(" [PaymentModal] Bloqueado: modal de confirmao de status est aberto"),nt.preventDefault();return}if(Ze){console.log(" [PaymentModal] Bloqueado: modal de download est aberto"),nt.preventDefault();return}if(C){console.log(" [PaymentModal] Bloqueado: modal protegido (protectPaymentModal ativo)"),nt.preventDefault();return}if($){console.log(" [PaymentModal] Bloqueado: modal de adicionar participante aberto"),nt.preventDefault();return}if(tr.current&&Kt<500){console.log(" [PaymentModal] Bloqueado: modal abriu recentemente"),nt.preventDefault();return}if(sr<3e3){console.log(` [PaymentModal] Bloqueado: mudana de visibilidade recente (${sr}ms atrs)`),nt.preventDefault();return}nt.preventDefault(),await Ft("interactOutside")},onEscapeKeyDown:nt=>{nt.preventDefault(),Ft("escape")},children:!x||x.length===0?tr.current?a.jsxs(a.Fragment,{children:[a.jsxs(on,{className:"sr-only",children:[a.jsx(an,{children:"Aviso"}),a.jsx(Nn,{children:"Nenhuma forma de pagamento cadastrada"})]}),a.jsxs("div",{className:"p-8 flex flex-col items-center justify-center gap-4",children:[a.jsx(Xf,{className:"w-12 h-12 text-amber-500"}),a.jsxs("div",{className:"text-center space-y-2",children:[a.jsx("p",{className:"font-semibold text-amber-500",children:"Nenhuma forma de pagamento cadastrada"}),a.jsx("p",{className:"text-sm text-text-muted",children:"Cadastre pelo menos uma finalizadora para gerenciar pagamentos."})]}),a.jsxs("div",{className:"flex gap-2 mt-4",children:[a.jsx(fe,{type:"button",variant:"outline",onClick:f,children:"Fechar"}),a.jsx(y4,{to:"/finalizadoras",children:a.jsx(fe,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white",onClick:f,children:"Cadastrar Finalizadora"})})]})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs(on,{className:"sr-only",children:[a.jsx(an,{children:"Carregando"}),a.jsx(Nn,{children:"Carregando formas de pagamento"})]}),a.jsxs("div",{className:"p-8 flex flex-col items-center justify-center gap-4",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-500"}),a.jsx("p",{className:"text-sm text-text-muted",children:"Carregando formas de pagamento..."})]})]}):a.jsxs(a.Fragment,{children:[a.jsx(on,{className:"relative pb-4 w-full max-w-[600px] mx-auto sm:max-w-none sm:mx-0",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-start justify-between gap-3 sm:gap-4",children:[a.jsxs("div",{className:"flex-1 w-full sm:w-auto",children:[a.jsx("div",{className:"flex items-center gap-3",children:a.jsx(an,{children:"Registrar pagamento"})}),a.jsx(Nn,{className:"hidden sm:block",children:"As alteraes so salvas ao fechar o modal."})]}),a.jsxs(fe,{type:"button",variant:"outline",size:"sm",onClick:Tn,className:"flex-shrink-0 gap-2 w-full sm:w-auto mt-2 sm:mt-0 sm:mr-12",title:"Baixar relatrio como imagem",children:[a.jsx(uo,{className:"w-4 h-4"}),a.jsx("span",{children:"Baixar Relatrio"})]})]})}),a.jsxs("div",{className:"space-y-3 sm:space-y-6 w-full max-w-[600px] mx-auto sm:max-w-none sm:mx-0",children:[a.jsxs("div",{className:"sm:hidden space-y-2 max-w-md mx-auto",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{className:"p-2 rounded-lg bg-emerald-600/10 border border-emerald-500/30 min-w-0 relative group",children:[a.jsx("div",{className:"text-[10px] text-emerald-300/80 mb-1 truncate",children:"Total"}),Q?a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(rt,{type:"text",value:te,onChange:nt=>Y(Eo(nt.target.value)),className:"w-full h-6 text-xs text-center font-bold bg-emerald-950/50 border-emerald-400/50 text-emerald-300 px-1",placeholder:"0,00",autoFocus:!0,onKeyDown:nt=>{nt.key==="Enter"&&te!==m?ir():nt.key==="Escape"&&nr()},onBlur:()=>{te!==m?ir():nr()}}),te!==m&&a.jsx("button",{onMouseDown:nt=>nt.preventDefault(),onClick:ir,className:"p-0.5 rounded hover:bg-emerald-500/20 transition-colors flex-shrink-0",title:"Confirmar",children:a.jsx(Yf,{className:"w-3 h-3 text-emerald-400"})})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-sm font-bold text-emerald-400 truncate",children:Eo(m)||"R$ 0,00"}),a.jsx("button",{onClick:Mt,className:"absolute right-1 top-1/2 -translate-y-1/2 p-0.5 rounded hover:bg-emerald-500/20 transition-colors",title:"Editar",children:a.jsx(Cl,{className:"w-3 h-3 text-emerald-400"})})]})]}),a.jsxs("div",{className:`p-2 rounded-lg border min-w-0 ${pt.diff===0?"bg-emerald-600/10 border-emerald-500/30":pt.diff>0?"bg-amber-600/10 border-amber-500/30":"bg-rose-600/10 border-rose-500/30"}`,children:[a.jsx("div",{className:`text-[10px] mb-1 truncate ${pt.diff===0?"text-emerald-300/80":pt.diff>0?"text-amber-300/80":"text-rose-300/80"}`,children:"Diferena"}),a.jsxs("div",{className:`text-sm font-bold truncate ${pt.diff===0?"text-emerald-400":pt.diff>0?"text-amber-400":"text-rose-400"}`,children:[pt.diff>0?"+":"",Eo(String(Math.abs(pt.diff).toFixed(2)))]})]})]}),a.jsxs("div",{className:"flex gap-1.5 text-xs justify-center",children:[a.jsxs("span",{className:"px-2.5 py-1.5 rounded bg-white/5 border border-white/10 whitespace-nowrap",children:[a.jsx("span",{className:"text-text-secondary",children:"Participantes:"})," ",a.jsx("strong",{children:qt})]}),a.jsxs("span",{className:"px-2.5 py-1.5 rounded bg-white/5 border border-white/10 whitespace-nowrap",children:[a.jsx("span",{className:"text-text-secondary",children:"Atribudo:"})," ",a.jsxs("strong",{children:["R$ ",pt.totalAssigned.toFixed(2)]})]}),a.jsxs("span",{className:"px-2.5 py-1.5 rounded bg-white/5 border border-white/10 whitespace-nowrap",children:[a.jsx("span",{className:"text-text-secondary",children:"Alvo:"})," ",a.jsxs("strong",{children:["R$ ",pt.totalTarget.toFixed(2)]})]})]}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx(fe,{type:"button",size:"sm",className:"bg-sky-600 hover:bg-sky-500 text-white text-xs h-8 px-3",onClick:Dt,disabled:!m||qt===0,children:(()=>{const nt=Oi(m);if(Number.isFinite(nt)&&qt>0){const $t=nt/qt;return`Dividir (${Eo(String($t.toFixed(2)))})`}return"Dividir"})()}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(fe,{type:"button",variant:"ghost",size:"sm",className:"border border-amber-500/30 text-amber-400 hover:bg-amber-500/10 text-xs h-8 px-3 flex-1",onClick:Qe,disabled:qt===0,children:"Aplicar taxas"}),a.jsx(fe,{type:"button",variant:"ghost",size:"sm",className:"border border-white/10 text-xs h-8 px-3 flex-1",onClick:he,disabled:qt===0,children:"Zerar"})]})]})]}),a.jsx("div",{className:"hidden sm:block p-4 rounded-lg border border-border bg-gradient-to-br from-surface-2 to-surface shadow-md",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-start gap-3 w-full",children:[a.jsxs("div",{className:"flex flex-row gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(qe,{className:"font-bold text-base text-white",children:"Valor total a receber"}),a.jsx("div",{className:"w-[180px] px-3 py-2 rounded-md bg-gradient-to-br from-emerald-600/20 to-emerald-700/20 border-2 border-emerald-500/40 shadow-lg flex items-center justify-center gap-2 relative group",children:Q?a.jsxs(a.Fragment,{children:[a.jsx(rt,{type:"text",value:te,onChange:nt=>Y(Eo(nt.target.value)),className:"w-full h-8 text-center text-lg font-bold bg-emerald-950/50 border-emerald-400/50 text-emerald-300",placeholder:"0,00",autoFocus:!0,onKeyDown:nt=>{nt.key==="Enter"&&te!==m?ir():nt.key==="Escape"&&nr()},onBlur:()=>{te!==m?ir():nr()}}),te!==m&&a.jsx("button",{onMouseDown:nt=>nt.preventDefault(),onClick:ir,className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 rounded hover:bg-emerald-500/20 transition-colors",title:"Confirmar (Enter)",children:a.jsx(Yf,{className:"w-4 h-4 text-emerald-400"})})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"text-xl font-bold text-emerald-400",children:Eo(m)||"R$ 0,00"}),a.jsx("button",{onClick:Mt,className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 rounded hover:bg-emerald-500/20 transition-colors opacity-0 group-hover:opacity-100",title:"Editar valor total",children:a.jsx(Cl,{className:"w-4 h-4 text-emerald-400"})})]})})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(qe,{className:"font-bold text-base text-white",children:"Diferena"}),a.jsx("div",{className:`w-[180px] px-3 py-2 rounded-md border-2 shadow-lg flex items-center justify-center ${pt.diff===0?"bg-gradient-to-br from-emerald-600/20 to-emerald-700/20 border-emerald-500/40":pt.diff>0?"bg-gradient-to-br from-amber-600/20 to-amber-700/20 border-amber-500/40":"bg-gradient-to-br from-rose-600/20 to-rose-700/20 border-rose-500/40"}`,children:a.jsxs("span",{className:`text-xl font-bold ${pt.diff===0?"text-emerald-400":pt.diff>0?"text-amber-400":"text-rose-400"}`,children:[pt.diff>0?"+":"",Eo(String(Math.abs(pt.diff).toFixed(2)))]})})]})]}),a.jsxs("div",{className:"ml-auto flex flex-col gap-3 items-end",children:[a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded bg-white/5 border border-white/10",children:[a.jsx("span",{className:"text-text-secondary",children:"Participantes:"}),a.jsx("strong",{children:qt})]}),a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded bg-white/5 border border-white/10",children:[a.jsx("span",{className:"text-text-secondary",children:"Atribudo:"}),a.jsxs("strong",{children:["R$ ",pt.totalAssigned.toFixed(2)]})]}),a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded bg-white/5 border border-white/10",children:[a.jsx("span",{className:"text-text-secondary",children:"Alvo:"}),a.jsxs("strong",{children:["R$ ",pt.totalTarget.toFixed(2)]})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsx(fe,{type:"button",variant:"secondary",size:"sm",className:"bg-sky-600 hover:bg-sky-500 text-white flex-shrink-0",onClick:Dt,disabled:!m||qt===0,children:(()=>{const nt=Oi(m);if(Number.isFinite(nt)&&qt>0){const $t=nt/qt;return a.jsxs(a.Fragment,{children:["Dividir igualmente (",Eo(String($t.toFixed(2)))," cada)",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-sky-700/50 rounded border border-sky-500/30",children:"F8"})]})}return a.jsxs(a.Fragment,{children:["Dividir igualmente",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-sky-700/50 rounded border border-sky-500/30",children:"F8"})]})})()}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(fe,{type:"button",variant:"ghost",size:"sm",className:"border border-amber-500/30 text-amber-400 hover:bg-amber-500/10 flex-1 sm:flex-initial whitespace-nowrap",onClick:Qe,disabled:qt===0,children:["Aplicar taxas",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-amber-700/50 rounded border border-amber-500/30",children:"F9"})]}),a.jsxs(fe,{type:"button",variant:"ghost",size:"sm",className:"border border-white/10 flex-1 sm:flex-initial",onClick:he,disabled:qt===0,children:["Zerar",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-white/10 rounded border border-white/20",children:"F10"})]})]})]})]})]})}),(r.selectedClients||[]).length===0?a.jsx("div",{className:"text-xs text-text-muted italic",children:'Nenhum participante neste agendamento. Adicione participantes no campo "Clientes" do modal principal.'}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsxs("div",{className:"relative flex-1 min-w-0",children:[a.jsx(rt,{ref:or,type:"text",placeholder:"Buscar participante...",value:P,onChange:nt=>A(nt.target.value),className:"pr-16"}),a.jsx("button",{type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs text-amber-400 hover:text-amber-300",onClick:()=>{A(""),or.current?.focus()},children:"limpar"})]}),a.jsxs(fe,{type:"button",size:"sm",className:"bg-amber-500 hover:bg-amber-400 text-black shadow-md flex-shrink-0",onClick:nt=>{nt.preventDefault(),nt.stopPropagation(),w(2e3),X(!0)},children:[a.jsx("span",{className:"hidden sm:inline",children:"Adicionar participante +"}),a.jsx("span",{className:"sm:hidden",children:"Participante +"})]})]}),I?.type==="pending"&&a.jsxs("div",{role:"alert",className:"mb-2 rounded-md border border-amber-600/40 bg-amber-500/10 px-3 py-2 text-amber-200 flex items-start gap-3",children:[a.jsx(Xf,{className:"w-4 h-4 text-amber-300 mt-0.5"}),a.jsxs("div",{className:"flex-1 text-sm",children:[a.jsx("strong",{children:"Ateno:"})," Existem ",a.jsx("strong",{children:I.count})," participante(s) com status ",a.jsx("strong",{children:"Pendente"}),"."]}),a.jsx("button",{type:"button",className:"text-xs px-2 py-1 rounded bg-amber-500/20 hover:bg-amber-500/30 border border-amber-600/40",onClick:()=>M(null),children:"Entendi"})]}),a.jsx("div",{className:"border border-border rounded-md overflow-hidden",children:a.jsx("div",{className:"divide-y divide-border max-h-[50vh] overflow-y-scroll",children:(()=>{const nt=P.trim().toLowerCase(),$t=R||[],sr=(ae||[]).map((St,Jr)=>({...St,_originalIndex:Jr})).filter(St=>!$t.includes(St._originalIndex)).filter(St=>!nt||String(St?.nome||"").toLowerCase().includes(nt));return sr.length===0?a.jsx("div",{className:"px-3 py-4 text-sm text-text-muted",children:"Nenhum participante com esse nome"}):sr.map(St=>{const Jr=`participant-${St._originalIndex}`,Pt=St._originalIndex,lr=ce.includes(Pt);return a.jsxs("div",{className:`p-2 sm:p-3 border-b last:border-b-0 transition-all duration-500 ease-out ${lr?"bg-white/10":""}`,children:[a.jsxs("div",{className:"sm:hidden space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[St.codigo!==null&&St.codigo!==void 0&&a.jsxs("span",{className:`text-xs font-bold rounded px-1.5 py-0.5 shrink-0 ${St.status_pagamento==="Pago"?"text-emerald-400 bg-emerald-600/20 border border-emerald-700/40":"text-amber-400 bg-amber-600/20 border border-amber-700/40"}`,children:["#",St.codigo]}),$e(St.cliente_id)?a.jsxs("div",{className:"relative flex-1 min-w-0",children:[a.jsx("input",{ref:st=>{st&&(Re.current[Pt]=st)},type:"text",value:St.nome||"",onChange:st=>er(Pt,st.target.value),onFocus:()=>xt(Pt),onKeyDown:st=>{if(st.key==="Enter"){st.preventDefault();const Et=et(Pt);Et!==null&&setTimeout(()=>{Re.current[Et]?.focus()},0)}else if(st.key==="Delete"&&St.nome&&st.target===document.activeElement)st.preventDefault(),st.stopPropagation(),er(Pt,""),setTimeout(()=>{Re.current[Pt]?.focus()},0);else if(st.key==="ArrowDown"){st.preventDefault();const Et=et(Pt);Et!==null&&setTimeout(()=>{Re.current[Et]?.focus()},0)}else if(st.key==="ArrowUp"){st.preventDefault();const Et=jt(Pt);Et!==null&&setTimeout(()=>{Re.current[Et]?.focus()},0)}},onBlur:async st=>{xt(null);const Et=(st.currentTarget?.value||"").trim();Et===""?ie.current[Pt]&&ln(Pt):(le(ar=>{const Tr=[...ar];return Pt>=0&&Pt<Tr.length&&(Tr[Pt]={...Tr[Pt],nome:Et}),Tr}),delete ie.current[Pt])},placeholder:"Nome do cliente...",className:"font-medium text-sm bg-black/40 text-white placeholder:text-white/50 border border-white/15 rounded px-2 py-0.5 pr-11 focus:border-white/30 focus:outline-none focus:ring-1 focus:ring-white/20 w-full",title:"Editar nome do Cliente Consumidor (histrico do agendamento)"}),St.nome?a.jsx("button",{type:"button",onClick:()=>{er(Pt,""),setTimeout(()=>{Re.current[Pt]?.focus()},0)},className:`absolute right-1 top-1/2 -translate-y-1/2 px-1.5 py-0.5 text-[10px] font-bold border rounded transition-all ${at===Pt||!at&&gt===Pt?"text-amber-300 bg-amber-500/20 border-amber-400/50 animate-pulse shadow-lg shadow-amber-500/20":"text-white/60 bg-white/10 hover:bg-white/20 hover:text-white/90 border-white/20"}`,title:at===Pt||!at&&gt===Pt?"Ser limpo ao pressionar Delete":"Limpar nome (tecla Delete)",children:"DEL"}):ie.current[Pt]?a.jsx("button",{type:"button",onClick:()=>ln(Pt),className:"absolute right-1 top-1/2 -translate-y-1/2 p-1 text-emerald-400 bg-emerald-500/10 hover:bg-emerald-500/20 hover:text-emerald-300 border border-emerald-500/30 rounded transition-all",title:"Restaurar ltimo nome",children:a.jsx(qF,{className:"w-3 h-3"})}):null]}):a.jsx("span",{className:"font-medium text-sm truncate",children:St.nome})]}),a.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[a.jsx("button",{type:"button",className:"p-1 text-text-secondary hover:text-brand transition-colors",onClick:()=>zt(Pt,St.nome),title:"Trocar",children:a.jsx(Cl,{className:"w-4 h-4"})}),a.jsx(fe,{type:"button",variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-400 h-6 w-6 p-0",onClick:()=>{O(st=>[...st,Pt])},children:""})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[a.jsxs("div",{children:[a.jsx(qe,{className:"text-[10px] text-text-muted",children:"Mtodo"}),a.jsxs(vn,{value:String(St.finalizadora_id||""),onValueChange:st=>{le(Et=>{const ar=[...Et];if(Pt>=0&&Pt<ar.length){const Tr=x.find(tn=>String(tn.id)===String(st)),Qr=Number(Tr?.taxa_percentual||0)>0;ar[Pt]={...ar[Pt],finalizadora_id:st,aplicar_taxa:Qr?ar[Pt].aplicar_taxa??!0:!1}}return ar})},children:[a.jsx(hn,{className:"h-8 text-xs",children:a.jsx(wn,{placeholder:"Mtodo"})}),a.jsx(pn,{children:x.map(st=>a.jsx(ct,{value:String(st.id),children:st.nome||st.tipo||"Outros"},st.id))})]}),(()=>{const st=x.find(Qr=>String(Qr.id)===String(St.finalizadora_id)),Et=Number(st?.taxa_percentual||0);if(Et<=0)return a.jsx("div",{className:"h-4 mt-1"});const ar=Oi(St.valor_cota),Tr=Number.isFinite(ar)&&ar>0;return a.jsxs("label",{className:`flex items-center gap-1.5 mt-1 text-[11px] ${Tr?"cursor-pointer":"cursor-not-allowed opacity-50"}`,title:Tr?`Taxa de ${Et.toFixed(2)}%`:"Informe o valor primeiro",children:[a.jsx("input",{type:"checkbox",className:"w-4 h-4",checked:!!St.aplicar_taxa,disabled:!Tr,onChange:Qr=>{if(!Tr){l({title:"Valor necessrio",description:"Informe o valor antes de aplicar a taxa.",variant:"destructive"});return}le(tn=>{const Qt=[...tn];if(Pt>=0&&Pt<Qt.length){const fn=Qr.target.checked;let nn=ar;fn?nn=ar*(1+Et/100):nn=ar/(1+Et/100),Qt[Pt]={...Qt[Pt],aplicar_taxa:fn,valor_cota:Eo(nn.toFixed(2))}}return Qt})},style:{accentColor:"#f59e0b"}}),a.jsxs("span",{className:"text-amber-500 font-medium",children:["Taxa (",Et.toFixed(2),"%)"]})]})})()]}),a.jsxs("div",{className:"isolate",children:[a.jsx(qe,{className:"text-[10px] text-text-muted",children:"Valor"}),a.jsx(rt,{ref:st=>{st&&(ne.current[Pt]=st)},type:"text",inputMode:"decimal",placeholder:"R$ 0,00",value:Eo(St.valor_cota),onChange:st=>{const Et=Eo(st.target.value),ar=Oi(Et),Tr=Number.isFinite(ar)&&ar>0?"Pago":"Pendente";le(Qr=>{const tn=[...Qr];return Pt>=0&&Pt<tn.length&&(tn[Pt]={...tn[Pt],valor_cota:Et,status_pagamento:Tr,aplicar_taxa:Et===""||ar<=0?!1:tn[Pt].aplicar_taxa}),tn})},className:"h-8 text-xs text-text-primary placeholder:text-slate-400 bg-surface-2 border-border hover:border-border-hover focus:border-brand focus:ring-2 focus:ring-brand/20"})]})]}),a.jsx("div",{className:"flex justify-end",children:(()=>{const st=St.status_pagamento==="Pago",Et=Number.isFinite(Oi(St.valor_cota))&&Oi(St.valor_cota)>0,ar=st&&Et;return a.jsx("button",{type:"button",onClick:()=>Mr(Pt,St.status_pagamento,St.valor_cota),disabled:ar,className:`inline-flex items-center justify-center px-3 py-0.5 rounded text-xs font-medium border transition-all ${st&&Et?"bg-emerald-600/20 text-emerald-400 border-emerald-700/40 cursor-not-allowed":st?"bg-emerald-600/20 text-emerald-400 border-emerald-700/40 hover:bg-emerald-600/30 hover:border-emerald-600/60 cursor-pointer":"bg-amber-600/20 text-amber-400 border-amber-700/40 hover:bg-amber-600/30 hover:border-amber-600/60 cursor-pointer"}`,title:ar?"No  possvel alterar (valor preenchido)":"Clique para alterar status",children:st?"Pago":"Pendente"})})()})]}),a.jsxs("div",{className:"hidden sm:flex items-center gap-3",children:[a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"flex items-center gap-2",children:[St.codigo!==null&&St.codigo!==void 0&&a.jsxs("span",{className:`text-sm font-bold rounded-md px-2.5 py-1 shadow-sm ${St.status_pagamento==="Pago"?"text-emerald-400 bg-emerald-600/20 border border-emerald-700/40":"text-amber-400 bg-amber-600/20 border border-amber-700/40"}`,children:["#",St.codigo]}),$e(St.cliente_id)?a.jsxs("div",{className:"relative",children:[a.jsx("input",{ref:st=>{st&&(Re.current[Pt]=st)},type:"text",value:St.nome||"",onChange:st=>er(Pt,st.target.value),onFocus:()=>xt(Pt),onKeyDown:st=>{if(st.key==="Enter"){st.preventDefault();const Et=et(Pt);Et!==null&&setTimeout(()=>{Re.current[Et]?.focus()},0)}else if(st.key==="Delete"&&St.nome&&st.target===document.activeElement)st.preventDefault(),st.stopPropagation(),er(Pt,""),setTimeout(()=>{Re.current[Pt]?.focus()},0);else if(st.key==="ArrowDown"){st.preventDefault();const Et=et(Pt);Et!==null&&setTimeout(()=>{Re.current[Et]?.focus()},0)}else if(st.key==="ArrowUp"){st.preventDefault();const Et=jt(Pt);Et!==null&&setTimeout(()=>{Re.current[Et]?.focus()},0)}},onBlur:async st=>{xt(null);const Et=(st.currentTarget?.value||"").trim();Et===""?ie.current[Pt]&&ln(Pt):(le(ar=>{const Tr=[...ar];return Pt>=0&&Pt<Tr.length&&(Tr[Pt]={...Tr[Pt],nome:Et}),Tr}),delete ie.current[Pt])},placeholder:"Nome do cliente...",className:"font-medium text-base bg-black/40 text-white placeholder:text-white/50 border border-white/15 rounded-md px-3 py-1.5 pr-14 focus:border-white/30 focus:outline-none focus:ring-2 focus:ring-white/20 min-w-[200px] max-w-[300px]",title:"Editar nome do Cliente Consumidor (histrico do agendamento)"}),St.nome?a.jsx("button",{type:"button",onClick:()=>{er(Pt,""),setTimeout(()=>{Re.current[Pt]?.focus()},0)},className:`absolute right-2 top-1/2 -translate-y-1/2 px-2 py-1 text-xs font-bold border rounded transition-all ${at===Pt||!at&&gt===Pt?"text-amber-300 bg-amber-500/20 border-amber-400/50 animate-pulse shadow-lg shadow-amber-500/30":"text-white/60 bg-white/10 hover:bg-white/20 hover:text-white/90 border-white/20 shadow-sm"}`,title:at===Pt||!at&&gt===Pt?"Ser limpo ao pressionar Delete":"Limpar nome (tecla Delete)",children:"DEL"}):ie.current[Pt]?a.jsx("button",{type:"button",onClick:()=>ln(Pt),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1.5 text-emerald-400 bg-emerald-500/10 hover:bg-emerald-500/20 hover:text-emerald-300 border border-emerald-500/30 rounded transition-all shadow-sm",title:"Restaurar ltimo nome",children:a.jsx(qF,{className:"w-4 h-4"})}):null]}):a.jsx("span",{className:"font-medium text-base",children:St.nome}),a.jsx("button",{type:"button",className:"p-1 text-text-secondary hover:text-brand transition-colors",onClick:()=>zt(Pt,St.nome),title:"Trocar participante",children:a.jsx(Cl,{className:"w-5 h-5"})})]})}),a.jsx("div",{className:"isolate",children:a.jsx(rt,{ref:st=>{st&&(ne.current[Pt]=st)},type:"text",inputMode:"decimal",placeholder:"R$ 0,00",value:Eo(St.valor_cota),onChange:st=>{const Et=Eo(st.target.value),ar=Oi(Et),Tr=Number.isFinite(ar)&&ar>0?"Pago":"Pendente";le(Qr=>{const tn=[...Qr];return Pt>=0&&Pt<tn.length&&(tn[Pt]={...tn[Pt],valor_cota:Et,status_pagamento:Tr,aplicar_taxa:Et===""||ar<=0?!1:tn[Pt].aplicar_taxa}),tn})},className:"w-28 text-text-primary placeholder:text-slate-400 bg-surface-2 border-border hover:border-border-hover focus:border-brand focus:ring-2 focus:ring-brand/20"})}),a.jsxs("div",{className:"flex items-center gap-2 min-w-[240px] isolate",children:[a.jsxs(vn,{value:String(St.finalizadora_id||""),onValueChange:st=>{le(Et=>{const ar=[...Et];if(Pt>=0&&Pt<ar.length){const Tr=x.find(tn=>String(tn.id)===String(st)),Qr=Number(Tr?.taxa_percentual||0)>0;ar[Pt]={...ar[Pt],finalizadora_id:st,aplicar_taxa:Qr?ar[Pt].aplicar_taxa??!0:!1}}return ar})},children:[a.jsx(hn,{className:"w-[140px] flex-shrink-0",children:a.jsx(wn,{placeholder:"Selecione"})}),a.jsx(pn,{children:x.map(st=>a.jsx(ct,{value:String(st.id),children:st.nome||st.tipo||"Outros"},st.id))})]}),a.jsx("div",{className:"flex-1 min-w-0 isolate",children:(()=>{const st=x.find(Qr=>String(Qr.id)===String(St.finalizadora_id)),Et=Number(st?.taxa_percentual||0);if(Et<=0)return a.jsx("div",{className:"h-5"});const ar=Oi(St.valor_cota),Tr=ar>0;return a.jsxs("label",{className:`flex items-center gap-1.5 text-xs transition-colors ${Tr?"cursor-pointer hover:text-text-primary":"cursor-not-allowed opacity-50"}`,title:Tr?`Taxa de ${Et.toFixed(2)}%`:"Informe o valor primeiro",children:[a.jsx("input",{type:"checkbox",checked:!!St.aplicar_taxa,disabled:!Tr,onChange:Qr=>{if(!Tr){l({title:"Valor necessrio",description:"Informe o valor antes de aplicar a taxa.",variant:"destructive"});return}le(tn=>{const Qt=[...tn];if(Pt>=0&&Pt<Qt.length){const fn=Qr.target.checked;let nn=ar;fn?nn=ar*(1+Et/100):nn=ar/(1+Et/100),Qt[Pt]={...Qt[Pt],aplicar_taxa:fn,valor_cota:Eo(nn.toFixed(2))}}return Qt})},className:`w-4 h-4 rounded border-2 border-amber-500 checked:bg-amber-500 checked:border-amber-500 focus:ring-2 focus:ring-amber-500 focus:ring-offset-1 ${Tr?"cursor-pointer":"cursor-not-allowed"}`,style:{accentColor:"#f59e0b"}}),a.jsxs("span",{className:"whitespace-nowrap text-amber-500 font-medium",children:["Taxa (",Et.toFixed(2),"%)"]})]})})()})]}),(()=>{const st=St.status_pagamento==="Pago",Et=Number.isFinite(Oi(St.valor_cota))&&Oi(St.valor_cota)>0,ar=st&&Et;return a.jsx("button",{type:"button",onClick:()=>Mr(Pt,St.status_pagamento,St.valor_cota),disabled:ar,className:`inline-flex items-center justify-center w-[90px] px-3 py-1 rounded text-sm font-medium border transition-all ${st&&Et?"bg-emerald-600/20 text-emerald-400 border-emerald-700/40 cursor-not-allowed":st?"bg-emerald-600/20 text-emerald-400 border-emerald-700/40 hover:bg-emerald-600/30 hover:border-emerald-600/60 cursor-pointer":"bg-amber-600/20 text-amber-400 border-amber-700/40 hover:bg-amber-600/30 hover:border-amber-600/60 cursor-pointer"}`,title:ar?"No  possvel alterar (valor preenchido)":"Clique para alterar status",children:st?"Pago":"Pendente"})})(),a.jsx(fe,{type:"button",variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-400",onClick:()=>{O(st=>[...st,Pt])},children:"Remover"})]})]},Jr)})})()})})]})]}),a.jsx(Qn,{className:"gap-2",children:a.jsxs(fe,{type:"button",variant:"ghost",className:"border border-white/10",onClick:async()=>{await Ft("footer-close")},children:["Fechar",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-white/10 rounded border border-white/20",children:"Esc"})]})})]})})}),a.jsxs("div",{ref:Fr,style:{position:"fixed",left:"0",top:"0",width:"900px",minHeight:"auto",padding:"30px",backgroundColor:"#ffffff !important",color:"#000000 !important",fontFamily:"Arial, sans-serif",opacity:"0",visibility:"hidden",zIndex:"-9999",pointerEvents:"none",overflow:"hidden"},children:[a.jsxs("div",{style:{marginBottom:"8px",paddingBottom:"6px",borderBottom:"2px solid #000",backgroundColor:"#fff",color:"#000"},children:[a.jsx("h1",{style:{fontSize:"18px",fontWeight:"bold",margin:"0 0 6px 0",color:"#000",letterSpacing:"0.5px",textAlign:"center"},children:"RELATRIO DE PAGAMENTOS"}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"10px",color:"#000",fontWeight:"600"},children:[a.jsxs("div",{style:{display:"flex",gap:"20px",flex:1},children:[a.jsxs("div",{children:[a.jsx("span",{style:{fontWeight:"700"},children:"Data:"}),a.jsx("span",{style:{marginLeft:"4px"},children:h?.start?new Date(h.start).toLocaleDateString("pt-BR"):"-"})]}),a.jsxs("div",{children:[a.jsx("span",{style:{fontWeight:"700"},children:"Quadra:"}),a.jsx("span",{style:{marginLeft:"4px"},children:h?.court||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{style:{fontWeight:"700"},children:"Cdigo:"}),a.jsx("span",{style:{marginLeft:"4px"},children:h?.code?`#${h.code}`:"-"})]})]}),a.jsxs("div",{style:{display:"flex",gap:"30px",textAlign:"right"},children:[a.jsxs("div",{children:[a.jsx("span",{style:{fontWeight:"700"},children:"Total:"}),a.jsxs("strong",{style:{marginLeft:"4px",color:"#000",fontSize:"11px",display:"inline"},children:["R$ ",Eo(m||0)]})]}),a.jsxs("div",{children:[a.jsx("span",{style:{fontWeight:"700"},children:"Diferena:"}),a.jsxs("strong",{style:{marginLeft:"4px",color:pt.diff<0?"#dc2626":"#16a34a",fontSize:"11px",display:"inline"},children:[pt.diff<0?"-":"","R$ ",Eo(Math.abs(pt.diff).toFixed(2))]})]})]})]})]}),a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"8px",fontSize:"10px",backgroundColor:"#fff",fontFamily:"Arial, sans-serif",border:"1px solid #000",tableLayout:"fixed"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{backgroundColor:"#cccccc",borderBottom:"1px solid #000"},children:[a.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"5%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"N"}),a.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"35%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Nome"}),a.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"10%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Cdigo"}),a.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"15%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Valor"}),a.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"20%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Forma"}),a.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"15%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Status"})]})}),a.jsx("tbody",{children:(()=>(ae||[]).filter(($t,Kt)=>!(R||[]).includes(Kt)).map(($t,Kt)=>{const sr=x?.find(ar=>String(ar.id)===String($t.finalizadora_id)),St=$t.status_pagamento==="Pago",Pt=s?.find(ar=>ar.id===$t.cliente_id)?.is_consumidor_final,st=($t.nome||"Sem nome").trim().split(/\s+/).slice(0,2).join(" "),Et=Pt?"0":$t.codigo||"N/A";return a.jsxs("tr",{"data-participant-index":Kt,style:{backgroundColor:"#fff"},children:[a.jsx("td",{style:{padding:"4px 2px",textAlign:"center",color:"#000",backgroundColor:"#fff",fontSize:"10px",fontWeight:"600",border:"1px solid #000",wordWrap:"break-word"},children:Kt+1}),a.jsx("td",{style:{padding:"4px 2px",textAlign:"left",color:"#000",backgroundColor:"#fff",fontSize:"10px",fontWeight:"600",border:"1px solid #000",wordWrap:"break-word",overflow:"hidden"},children:st}),a.jsx("td",{style:{padding:"4px 2px",textAlign:"center",color:"#000",fontSize:"10px",fontWeight:"600",backgroundColor:"#fff",border:"1px solid #000",wordWrap:"break-word"},children:Et}),a.jsxs("td",{style:{padding:"4px 2px",textAlign:"center",color:"#000",backgroundColor:"#fff",fontSize:"10px",fontWeight:"600",border:"1px solid #000",wordWrap:"break-word"},children:["R$ ",Eo($t.valor_cota||0)]}),a.jsx("td",{style:{padding:"4px 2px",textAlign:"center",color:"#000",fontSize:"10px",fontWeight:"600",backgroundColor:"#fff",border:"1px solid #000",wordWrap:"break-word"},children:sr?.nome||"N/D"}),a.jsx("td",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:St?"#16a34a":"#ca8a04",fontSize:"10px",backgroundColor:"#fff",border:"1px solid #000",wordWrap:"break-word"},children:St?" Pago":" Pendente"})]},`participant-${Kt}-${$t.cliente_id}`)}))()})]}),a.jsx("div",{style:{height:"2px",backgroundColor:"#fff"}}),a.jsxs("div",{style:{marginTop:"2px",textAlign:"center",fontSize:"10px",color:"#000",borderTop:"1px solid #000",paddingTop:"2px",display:"flex",justifyContent:"space-between",backgroundColor:"#fff"},children:[a.jsxs("div",{style:{color:"#000",fontWeight:"500"},children:["Gerado em: ",new Date().toLocaleString("pt-BR")]}),a.jsx("div",{id:"page-indicator",style:{fontSize:"10px",fontWeight:"bold",color:"#000"}})]})]}),a.jsx(mn,{open:$,onOpenChange:nt=>{if(!nt){Se([]),W("");try{j()}catch{}}X(nt)},children:a.jsxs(un,{className:"sm:max-w-[500px]",onInteractOutside:nt=>{nt.preventDefault(),X(!1);try{j()}catch{}},children:[a.jsxs(on,{children:[a.jsx(an,{children:"Adicionar Participante"}),a.jsx(Nn,{children:"Selecione um cliente para adicionar aos pagamentos."})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(Zs,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(rt,{ref:yr,placeholder:"Buscar por cdigo ou nome...",value:z,onChange:nt=>{W(nt.target.value),B(0)},onKeyDown:nt=>{const $t=z.toLowerCase().trim(),Kt=(s||[]).filter(lr=>{if(!$t)return!0;const st=String(lr.codigo||""),Et=(lr.nome||"").toLowerCase();return st.includes($t)||Et.includes($t)}),sr=Kt.find(lr=>lr?.is_consumidor_final===!0),Jr=Kt.filter(lr=>lr?.is_consumidor_final!==!0).sort((lr,st)=>{const Et=lr.codigo||0,ar=st.codigo||0;return Et-ar}),Pt=sr?[sr,...Jr]:Jr;if(nt.key==="ArrowDown")nt.preventDefault(),B(lr=>Math.min(lr+1,Pt.length-1));else if(nt.key==="ArrowUp")nt.preventDefault(),B(lr=>Math.max(lr-1,0));else if(nt.key==="Enter"&&Pt[V]){nt.preventDefault();const st={...Pt[V],timestamp:Date.now()};Se(Et=>[...Et,st])}},className:"pl-10 pr-10"}),z&&a.jsx("button",{type:"button",onClick:()=>W(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-muted hover:text-text",children:a.jsx(al,{className:"h-4 w-4"})})]}),a.jsx(fe,{type:"button",size:"sm",className:"bg-amber-500 hover:bg-amber-400 text-black shadow-md",onClick:()=>{o&&(w(15e3),o(()=>{X(!0)}),X(!1),W(""))},children:"+Novo"})]}),a.jsx("div",{ref:dt,className:"border rounded-md max-h-[400px] overflow-y-auto",children:(()=>{const nt=z.toLowerCase().trim(),$t=(s||[]).filter(Pt=>{if(!nt)return!0;const lr=String(Pt.codigo||""),st=(Pt.nome||"").toLowerCase();return lr.includes(nt)||st.includes(nt)}),Kt=$t.find(Pt=>Pt?.is_consumidor_final===!0),St=$t.filter(Pt=>Pt?.is_consumidor_final!==!0).sort((Pt,lr)=>{const st=Pt.codigo||0,Et=lr.codigo||0;return st-Et}),Jr=Kt?[Kt,...St]:St;return Jr.length===0?a.jsx("div",{className:"p-8 text-center text-text-muted",children:"Nenhum cliente encontrado."}):Jr.map((Pt,lr)=>{const st=Pt?.is_consumidor_final===!0,Et=ye.filter(Tr=>Tr.id===Pt.id).length,ar=lr===V;return a.jsxs("div",{ref:Tr=>{Me.current[lr]=Tr},role:"button",tabIndex:0,className:`w-full px-4 py-3 text-left transition-all border-b border-border last:border-0 flex items-center gap-3 cursor-pointer ${ar?"ring-2 ring-blue-500 ring-inset z-10":""} ${st?"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-2 border-l-amber-500/40":Et>0?"bg-emerald-600/20 hover:bg-emerald-600/30":"hover:bg-surface-2"}`,onMouseEnter:()=>B(lr),onClick:Tr=>{Tr.preventDefault(),Tr.stopPropagation();const Qr={...Pt,timestamp:Date.now()};Se(tn=>[...tn,Qr])},onKeyDown:Tr=>{if(Tr.key==="Enter"||Tr.key===" "){Tr.preventDefault();const Qr={...Pt,timestamp:Date.now()};Se(tn=>[...tn,Qr])}},children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[(()=>Pt.codigo!==null&&Pt.codigo!==void 0?a.jsxs("span",{className:`inline-flex items-center justify-center w-10 h-10 rounded-full font-bold text-sm transition-colors ${st?"bg-amber-500/15 text-amber-300/90 ring-1 ring-amber-500/20":"bg-emerald-600/20 text-emerald-400"}`,children:["#",Pt.codigo]}):null)(),a.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[a.jsx("span",{className:`font-medium ${st?"text-amber-100/90":""}`,children:Pt.nome}),st&&a.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium",children:[a.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]})]})]}),Et>0&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-7 h-7 rounded-full bg-rose-600 hover:bg-rose-500 text-white text-base font-bold transition-colors",onClick:Tr=>{Tr.preventDefault(),Tr.stopPropagation(),Se(Qr=>{const tn=Qr.findIndex(Qt=>Qt.id===Pt.id);if(tn!==-1){const Qt=[...Qr];return Qt.splice(tn,1),Qt}return Qr})},children:"-"}),a.jsx("span",{className:"inline-flex items-center justify-center min-w-[32px] h-7 px-2 rounded-full bg-sky-600 text-white text-base font-bold",children:Et}),a.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-7 h-7 rounded-full bg-emerald-600 hover:bg-emerald-500 text-white text-base font-bold transition-colors",onClick:Tr=>{Tr.preventDefault(),Tr.stopPropagation();const Qr={...Pt,timestamp:Date.now()};Se(tn=>[...tn,Qr])},children:"+"})]})]},Pt.id)})})()})]}),a.jsxs(Qn,{className:"flex items-center justify-between",children:[a.jsx("div",{className:"text-sm text-text-muted",children:ye.length>0&&a.jsxs("span",{className:"font-medium",children:[ye.length," ",ye.length===1?"participante selecionado":"participantes selecionados"]})}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(fe,{type:"button",variant:"ghost",className:"border border-border",onClick:nt=>{nt.preventDefault(),nt.stopPropagation(),w(1e3),X(!1),W(""),Se([]);try{j()}catch{}},children:["Cancelar",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-white/10 rounded border border-white/20",children:"Esc"})]}),a.jsxs(fe,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white",disabled:ye.length===0,onClick:nt=>{console.log("[AddParticipant] Boto Salvar clicado"),nt.preventDefault(),nt.stopPropagation(),console.log("[AddParticipant] Protegendo modal de pagamentos (3000ms)"),w(3e3),console.log("[AddParticipant] Adicionando participantes:",ye.length);const $t=ye.map(Kt=>({cliente_id:Kt.id,nome:Kt.nome,codigo:Kt.codigo,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:(()=>{const sr=yt();return sr?.id?String(sr.id):null})(),aplicar_taxa:(()=>{const sr=yt();return Number(sr?.taxa_percentual||0)>0})()}));le(Kt=>{const sr=Kt.length,St=$t.map((Jr,Pt)=>sr+Pt);return me(St),setTimeout(()=>{me([])},1e3),[...Kt,...$t]}),console.log("[AddParticipant] Fechando modal de adicionar participante"),X(!1),W(""),Se([]);try{j()}catch{}console.log("[AddParticipant] Concludo")},children:["Confirmar (",ye.length,")",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-emerald-700/50 rounded border border-emerald-500/30",children:""})]})]})]})]})}),a.jsx(mn,{open:Ze,onOpenChange:nt=>{console.log(" [DownloadModal] onOpenChange chamado:",{open:nt,downloadStatus:Wt}),!nt&&Wt==="success"?(console.log(" [DownloadModal] Fechando modal de download (sucesso)"),ht(!1)):nt||console.log(" [DownloadModal] BLOQUEADO: Ainda baixando")},children:a.jsxs(un,{className:"sm:max-w-md",onPointerDownOutside:nt=>{Wt==="downloading"&&nt.preventDefault()},onEscapeKeyDown:nt=>{Wt==="downloading"&&nt.preventDefault()},children:[a.jsxs(on,{children:[a.jsx(an,{className:"text-center",children:Wt==="downloading"?"Gerando PDF...":"PDF Gerado com Sucesso!"}),a.jsx(Nn,{className:"sr-only",children:Wt==="downloading"?"Aguarde enquanto o relatrio de pagamentos est sendo gerado":"Relatrio de pagamentos gerado e baixado com sucesso"})]}),a.jsx("div",{className:"flex flex-col items-center justify-center py-6 space-y-4",children:Wt==="downloading"?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-green-500"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Gerando seu relatrio..."}),a.jsxs("div",{className:"w-full max-w-xs",children:[a.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[a.jsx("span",{children:"Progresso"}),a.jsxs("span",{children:[Ct,"%"]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:a.jsx("div",{className:"bg-green-600 h-2.5 rounded-full transition-all duration-300",style:{width:`${Ct}%`}})})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"rounded-full bg-green-100 p-3",children:a.jsx("svg",{className:"w-12 h-12 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),a.jsx("p",{className:"text-sm text-gray-600 text-center",children:"Relatrio baixado com sucesso!"}),a.jsx("p",{className:"text-xs text-gray-400 text-center",children:_e})]})}),Wt==="success"&&a.jsxs("div",{className:"flex flex-col gap-2",children:[navigator.share&&navigator.canShare&&navigator.canShare({files:[]})&&a.jsxs(fe,{onClick:async()=>{if(!Ge){l({title:"Arquivo no disponvel",description:"Tente gerar o PDF novamente.",variant:"destructive"});return}try{console.log(" [PDF] Compartilhando via Web Share API...");const nt=new File([Ge],_e,{type:"application/pdf"});await navigator.share({files:[nt],title:"Relatrio de Pagamentos",text:"Confira o relatrio de pagamentos"}),console.log(" [PDF] Compartilhado com sucesso"),l({title:"Compartilhado com sucesso!",variant:"success"})}catch(nt){if(nt.name==="AbortError"){console.log(" [PDF] Compartilhamento cancelado");return}console.error(" [PDF] Erro ao compartilhar:",nt),l({title:"Erro ao compartilhar",description:nt.message,variant:"destructive"})}},className:"w-full bg-blue-600 hover:bg-blue-700 text-white",children:[a.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),"Compartilhar"]}),a.jsxs(fe,{onClick:()=>{Ue?(console.log(" [PDF] Abrindo PDF em nova aba:",Ue),window.open(Ue,"_blank")):(console.error(" [PDF] URL do blob no disponvel"),l({title:"Erro ao abrir PDF",description:"URL do PDF no est disponvel.",variant:"destructive"}))},className:"w-full bg-green-600 hover:bg-green-700",children:[a.jsxs("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Abrir PDF"]}),a.jsx("p",{className:"text-xs text-center text-gray-500 px-2",children:"O PDF foi baixado. Abra-o para visualizar, imprimir ou compartilhar."}),a.jsx(fe,{onClick:()=>ht(!1),variant:"ghost",className:"w-full",children:"Fechar"})]})]})}),a.jsx(mn,{open:It.isOpen,onOpenChange:nt=>{if(!nt&&ur.current){console.log(" [StatusConfirmation] Bloqueado onOpenChange (protegido)");return}nt||(console.log(" [StatusConfirmation] Fechando modal via onOpenChange"),dr({isOpen:!1,participantIndex:null,currentStatus:null}))},children:a.jsxs(un,{className:"w-[95vw] sm:max-w-[400px]",onInteractOutside:nt=>{ur.current&&(console.log(" [StatusConfirmation] Bloqueado clique fora"),nt.preventDefault())},onEscapeKeyDown:nt=>{ur.current&&(console.log(" [StatusConfirmation] Bloqueado ESC"),nt.preventDefault())},children:[a.jsxs(on,{children:[a.jsx(an,{children:"Alterar Status de Pagamento"}),a.jsx(Nn,{children:It.currentStatus==="Pago"?a.jsxs(a.Fragment,{children:["Tem certeza que deseja marcar este participante como ",a.jsx("strong",{children:"Pendente"}),"?"]}):a.jsxs(a.Fragment,{children:["Tem certeza que deseja marcar este participante como ",a.jsx("strong",{children:"Pago"})," mesmo sem valor registrado?"]})})]}),a.jsx("div",{className:"space-y-4",children:a.jsx("div",{className:"p-3 rounded-lg bg-amber-500/10 border border-amber-500/30",children:a.jsx("p",{className:"text-sm text-amber-400",children:It.currentStatus==="Pago"?a.jsx(a.Fragment,{children:" Esta ao marcar o participante como pendente novamente para refazer o pagamento."}):a.jsx(a.Fragment,{children:" Esta ao marcar o participante como pago sem um valor especfico."})})})}),a.jsxs(Qn,{className:"gap-2",children:[a.jsx(fe,{type:"button",variant:"ghost",className:"border border-white/10",onClick:()=>{dr({isOpen:!1,participantIndex:null,currentStatus:null})},children:"Cancelar"}),a.jsx(fe,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white",onClick:()=>Ye(It.currentStatus==="Pago"?"Pendente":"Pago"),children:"Confirmar"})]})]})})]})}function nZe({form:e,setForm:t,localCustomers:r}){Qa(),ms();const{isEditParticipantModalOpen:n,closeEditParticipantModal:s,editParticipantData:o,participantsForm:i,setParticipantsForm:l,payMethods:c,protectPaymentModal:d,onParticipantReplacedRef:u}=hN(),[f,h]=p.useState(""),[m,v]=p.useState(!1),[g,y]=p.useState(0),x=Pe.useRef(null),b=Pe.useRef([]),w=Pe.useRef(null),j=O=>{const I=o.participantId;if(i[I]?.cliente_id===O.id)return;console.log(" [EditParticipantModal] Substituindo participante:",{de:o.participantName,para:O.nome,indice:I,id_para:O.id});const M=i[I];if(l.updateLocal&&l.getLocal){const D=l.getLocal();if(I>=0&&I<D.length){const U={cliente_id:O.id,nome:O.nome,codigo:O.codigo,valor_cota:M?.valor_cota||"",status_pagamento:M?.status_pagamento||"Pendente",finalizadora_id:M?.finalizadora_id||(c[0]?.id?String(c[0].id):null),aplicar_taxa:M?.aplicar_taxa||!1},z=[...D];z[I]=U,l.updateLocal(z)}}else l(D=>{if(I<0||I>=D.length)return D;const U={cliente_id:O.id,nome:O.nome,codigo:O.codigo,valor_cota:M?.valor_cota||"",status_pagamento:M?.status_pagamento||"Pendente",finalizadora_id:M?.finalizadora_id||(c[0]?.id?String(c[0].id):null),aplicar_taxa:M?.aplicar_taxa||!1},z=[...D];return z[I]=U,z});d(3e3),s(),h(""),u?.current&&u.current(I)};if(p.useEffect(()=>{n&&(h(""),v(!1),y(0))},[n]),p.useEffect(()=>{n&&b.current[g]&&b.current[g]?.scrollIntoView({behavior:"smooth",block:"nearest"})},[g,n]),!n)return null;const _=f.trim().toLowerCase(),S=(r||[]).filter(O=>_?String(O?.nome||"").toLowerCase().includes(_):!0),C=S.find(O=>O?.is_consumidor_final===!0),A=S.filter(O=>O?.is_consumidor_final!==!0).sort((O,I)=>{const M=Number(O?.codigo),D=Number(I?.codigo);return Number.isFinite(M)&&Number.isFinite(D)?M-D:String(O?.nome||"").localeCompare(String(I?.nome||""))}),R=C?[C,...A]:A;return a.jsx(mn,{open:n,onOpenChange:O=>{console.log("[EditParticipantModal] onOpenChange:",O),O||(console.log("[EditParticipantModal] Protegendo modal de pagamentos"),d(2e3),s(),h(""))},modal:!0,children:a.jsxs(un,{className:"sm:max-w-[500px]",onPointerDownOutside:O=>{console.log(" [EditParticipantModal] onPointerDownOutside - prevenindo"),O.preventDefault(),O.stopPropagation()},onInteractOutside:O=>{console.log(" [EditParticipantModal] onInteractOutside - prevenindo"),O.preventDefault(),O.stopPropagation(),d(2e3)},children:[a.jsxs(on,{children:[a.jsx(an,{children:"Trocar Participante"}),a.jsxs(Nn,{children:["Substituindo: ",a.jsx("strong",{children:o.participantName})]})]}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{children:[a.jsx(qe,{htmlFor:"edit-participant-search",children:"Buscar cliente"}),a.jsx(rt,{ref:x,id:"edit-participant-search",type:"text",placeholder:"Digite o nome do cliente...",value:f,onChange:O=>{h(O.target.value),y(0)},onKeyDown:O=>{if(O.key==="ArrowDown")O.preventDefault(),y(I=>Math.min(I+1,R.length-1));else if(O.key==="ArrowUp")O.preventDefault(),y(I=>Math.max(I-1,0));else if(O.key==="Enter"&&R[g]){O.preventDefault();const I=R[g],M=o.participantId;i[M]?.cliente_id===I.id||(d(2e3),j(I))}},className:"mt-1",autoFocus:!0})]}),a.jsx("div",{ref:w,className:"border border-border rounded-md max-h-[300px] overflow-y-auto",children:m?a.jsx("div",{className:"p-4 text-center text-sm text-text-muted",children:"Carregando clientes..."}):R.length===0?a.jsx("div",{className:"p-4 text-center text-sm text-text-muted",children:_?"Nenhum cliente encontrado":"Nenhum cliente cadastrado"}):R.map((O,I)=>{const M=o.participantId,D=i[M]?.cliente_id===O.id,U=O?.is_consumidor_final===!0,z=I===g;return a.jsxs("button",{ref:W=>{b.current[I]=W},type:"button",className:pr(z&&"ring-2 ring-blue-500 ring-inset z-10","w-full px-4 py-3 text-left transition-all","border-b border-border last:border-b-0","flex items-center gap-3",D&&"bg-brand/10 cursor-not-allowed opacity-60",!D&&U&&"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-2 border-l-amber-500/40",!D&&!U&&"hover:bg-surface-2"),disabled:D,onMouseEnter:()=>y(I),onClick:W=>{W.preventDefault(),W.stopPropagation(),console.log("[EditParticipantModal] Cliente selecionado - protegendo modal"),d(2e3),j(O)},children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[O.codigo!==null&&O.codigo!==void 0&&a.jsxs("span",{className:pr("inline-flex items-center justify-center w-10 h-10 rounded-full font-bold text-sm transition-colors",U&&"bg-amber-500/15 text-amber-300/90 ring-1 ring-amber-500/20",!U&&"bg-emerald-600/20 text-emerald-400"),children:["#",O.codigo]}),a.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[a.jsx("span",{className:pr("font-medium",U&&"text-amber-100/90"),children:O.nome}),U&&a.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium",children:[a.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]})]})]}),D&&a.jsx("span",{className:"text-xs text-brand font-medium",children:"Atual"})]},O.id)})})]}),a.jsx(Qn,{children:a.jsx(fe,{type:"button",variant:"ghost",className:"border border-white/10",onClick:O=>{console.log(" [EditParticipantModal] ========== BOTO CANCELAR CLICADO =========="),console.log(" [EditParticipantModal] preventDefault()"),O.preventDefault(),console.log(" [EditParticipantModal] stopPropagation()"),O.stopPropagation(),console.log(" [EditParticipantModal] Protegendo modal de pagamentos (2000ms)"),d(2e3),console.log(" [EditParticipantModal] Fechando modal de editar participante"),s(),console.log(" [EditParticipantModal] Limpando busca"),h(""),console.log(" [EditParticipantModal] ========== CANCELAR CONCLUDO ==========")},children:"Cancelar"})})]})})}const aZe=e=>e?e.trim().split(/\s+/).slice(0,2).join(" "):"",Em=56,KE=30,sZe=6,oZe=24;function iZe({weekStart:e,weekBookings:t,activeCourtFilter:r,courtsMap:n,participantsByAgendamento:s,onBookingClick:o,onSlotClick:i,statusConfig:l,dayStartHour:c=sZe,dayEndHourExclusive:d=oZe,weekDiasFuncionamento:u={},sidebarVisible:f=!1}){const h=p.useRef(null),m=p.useRef(null),[v,g]=Pe.useState(0),[y,x]=Pe.useState(window.innerWidth<768);Pe.useEffect(()=>{const P=()=>{x(window.innerWidth<768)};return window.addEventListener("resize",P),()=>window.removeEventListener("resize",P)},[]);const b=p.useMemo(()=>Array.from({length:7},(P,A)=>Ta(e,A)),[e]);p.useEffect(()=>{const P=()=>{m.current&&h.current&&(h.current.scrollLeft=m.current.scrollLeft)},A=()=>{h.current&&m.current&&(m.current.scrollLeft=h.current.scrollLeft)},R=()=>{if(m.current){const M=m.current.scrollHeight>m.current.clientHeight;g(M?17:0)}},O=m.current,I=h.current;return O&&O.addEventListener("scroll",P),I&&I.addEventListener("scroll",A),R(),window.addEventListener("resize",R),()=>{O&&O.removeEventListener("scroll",P),I&&I.removeEventListener("scroll",A),window.removeEventListener("resize",R)}},[]);const w=p.useMemo(()=>{if(r&&n[r]){const P=n[r],A=P.hora_inicio||`${c}:00:00`,R=P.hora_fim||`${d}:00:00`,[O]=String(A).split(":").map(Number),[I,M]=String(R).split(":").map(Number);let D=I===0&&M===0?24:I;return M>0&&D<24&&(D+=1),{start:O||c,end:D||d}}return{start:c,end:d}},[r,n,c,d]),j=p.useMemo(()=>Array.from({length:Math.max(0,w.end-w.start)},(P,A)=>w.start+A),[w]),_=p.useMemo(()=>Math.max(0,w.end-w.start)*(60/KE)*Em,[w]),S=p.useMemo(()=>{const P={};return b.forEach(A=>{P[cr(A,"yyyy-MM-dd")]=[]}),t.forEach(A=>{const R=cr(_s(A.start),"yyyy-MM-dd");P[R]&&P[R].push(A)}),P},[b,t]),C=(P,A)=>{const R=P.start.getHours()*60+P.start.getMinutes(),I=P.end.getHours()*60+P.end.getMinutes()-R,M=w.start*60,D=(R-M)/KE*Em,U=I/KE*Em,W=l[P.status]||{hex:"#888",text:"text-gray-400",label:"Unknown",icon:null},$=W.icon,X=40,ye=Math.max(X,U-4),Se=Math.min(1.3,ye/55),V=Math.max(11,Math.round(13*Se)),B=Math.max(10,Math.round(11*Se)),Q=Math.max(9,Math.round(10*Se)),pe=Math.max(14,Math.round(16*Se)),te=A?.[P.id]||[],Y=te.filter(ae=>String(ae.status_pagamento||"").toLowerCase()==="pago").length,ce=te.length,me=I===30;return a.jsx("div",{id:`booking-${P.id}`,className:"absolute left-0.5 right-0.5 rounded-md border-2 bg-surface cursor-pointer transition-all hover:bg-surface-2 hover:shadow-md overflow-hidden",style:{top:`${D}px`,height:`${Math.max(X,U)}px`,borderColor:W.hex||"#888",borderLeftWidth:"3px",zIndex:5},onClick:()=>o(P),children:a.jsxs("div",{className:"h-full flex flex-col justify-center px-2 py-1",children:[a.jsx("div",{className:"flex items-center gap-1.5 mb-0.5",children:a.jsx("p",{className:"font-semibold truncate",style:{fontSize:`${V}px`,lineHeight:1.1,color:"#e2e8f0"},children:aZe(P.customer)})}),me&&(P.modality||ce>0)&&a.jsxs("div",{className:"flex items-center gap-1 w-full justify-between",style:{lineHeight:1},children:[P.modality&&a.jsx("span",{className:"text-xs font-bold text-white bg-gradient-to-r from-slate-700 to-slate-800 border border-slate-600/60 rounded px-1.5 py-0.5 whitespace-nowrap shadow-sm flex-shrink-0",style:{fontSize:Math.max(7,Q-1)},children:P.modality}),ce>0&&a.jsxs("span",{className:`text-xs font-semibold rounded-full px-1.5 py-0.5 border flex items-center gap-0.5 whitespace-nowrap flex-shrink-0 ${Y===ce?"text-emerald-300 bg-emerald-500/10 border-emerald-400/30":"text-amber-300 bg-amber-500/10 border-amber-400/30"}`,style:{fontSize:Math.max(8,Q-1)},children:[a.jsx(ei,{style:{width:Math.max(10,Q-1),height:Math.max(10,Q-1)}}),a.jsxs("span",{children:[Y,"/",ce]})]})]}),me&&a.jsxs("div",{className:"flex items-center gap-1.5 justify-between",children:[a.jsxs("span",{className:"font-semibold whitespace-nowrap",style:{fontSize:`${B}px`,color:"#999",lineHeight:1},children:[cr(P.start,"HH:mm"),"",cr(P.end,"HH:mm")]}),$&&a.jsxs("div",{className:"flex items-center gap-0.5",children:[!f&&!y&&a.jsx($,{style:{width:Math.max(12,pe-2),height:Math.max(12,pe-2),color:W.hex}}),a.jsx("span",{className:"truncate font-semibold",style:{fontSize:`${B}px`,color:W.hex,lineHeight:1},children:W.label})]})]}),!me&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"truncate",style:{fontSize:`${B}px`,color:"#999",lineHeight:1,marginBottom:"2px"},children:[cr(P.start,"HH:mm"),"",cr(P.end,"HH:mm")]}),P.modality&&a.jsx("span",{className:"text-xs font-bold text-white truncate bg-gradient-to-r from-slate-700 to-slate-800 border border-slate-600/60 rounded px-1.5 py-0.5 whitespace-nowrap shadow-sm mb-0.5",style:{fontSize:Math.max(7,Q-1),display:"inline-block",width:"fit-content"},children:P.modality}),a.jsxs("div",{className:"flex items-center gap-1 w-full justify-between",children:[$&&a.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[!f&&!y&&a.jsx($,{style:{width:pe,height:pe,color:W.hex}}),a.jsx("span",{className:"truncate font-semibold",style:{fontSize:`${Q}px`,color:W.hex,lineHeight:1},children:P.status==="in_progress"?"Andamento":W.label})]}),ce>0&&a.jsxs("span",{className:`text-xs font-semibold rounded-full px-1.5 py-0.5 border flex items-center gap-0.5 whitespace-nowrap flex-shrink-0 ${Y===ce?"text-emerald-300 bg-emerald-500/10 border-emerald-400/30":"text-amber-300 bg-amber-500/10 border-amber-400/30"}`,style:{fontSize:Math.max(8,Q-1)},children:[a.jsx(ei,{style:{width:Math.max(12,Q),height:Math.max(12,Q)}}),a.jsxs("span",{children:[Y,"/",ce]})]})]})]})]})},P.id)};return a.jsxs("div",{className:"flex-1 bg-surface rounded-lg border border-border flex flex-col overflow-hidden",children:[a.jsxs("div",{className:"flex sticky top-0 z-20 bg-surface border-b border-border",children:[a.jsx("div",{className:"w-20 flex-shrink-0 flex items-center justify-center font-semibold text-sm border-r border-border bg-surface",children:"Horrios"}),a.jsxs("div",{ref:h,"data-header-scroll":!0,className:"flex flex-1 overflow-auto",style:{scrollbarWidth:"none",msOverflowStyle:"none",paddingRight:`${v}px`,minWidth:0},children:[a.jsx("style",{children:`
            [data-header-scroll]::-webkit-scrollbar {
              display: none;
            }
          `}),b.map(P=>a.jsxs("div",{className:"flex-1 basis-[140px] min-w-[140px] flex flex-col items-center justify-center py-3 border-r border-border bg-surface-2/50 text-center",children:[a.jsx("div",{className:"text-xs font-semibold text-text-muted",children:cr(P,"EEE",{locale:na}).toUpperCase()}),a.jsx("div",{className:"text-sm font-bold text-text-primary",children:cr(P,"dd")})]},cr(P,"yyyy-MM-dd")))]})]}),a.jsxs("div",{ref:m,className:"flex flex-1 overflow-auto",style:{minWidth:0},children:[a.jsxs("div",{className:"w-20 flex-shrink-0 bg-surface sticky left-0 z-10 flex flex-col relative",style:{borderRight:"1px solid var(--color-border)",minHeight:`${_}px`},children:[j.map(P=>a.jsxs(Pe.Fragment,{children:[a.jsx("div",{className:pr("relative border-b border-border/60",P%2===1&&"bg-surface-2/30"),style:{height:Em},children:a.jsxs("span",{className:"absolute left-1/2 -translate-x-1/2 top-1/2 -translate-y-1/2 bg-surface rounded px-1 text-sm font-bold whitespace-nowrap",children:[String(P).padStart(2,"0"),":00"]})}),a.jsx("div",{className:pr("relative border-b border-border/60",P%2===1&&"bg-surface-2/30"),style:{height:Em},children:a.jsxs("span",{className:"absolute left-1/2 -translate-x-1/2 top-1/2 -translate-y-1/2 bg-surface rounded px-1 text-sm font-bold whitespace-nowrap",children:[String(P).padStart(2,"0"),":30"]})})]},`time-${P}`)),a.jsx("div",{className:"absolute right-0 top-0 w-px bg-border pointer-events-none",style:{height:`${_}px`}})]}),b.map(P=>{const A=cr(P,"yyyy-MM-dd"),R=S[A]||[],O=u[A]||{},I=r&&O[r]&&!O[r].funciona;return a.jsxs("div",{className:"flex-1 basis-[140px] min-w-[140px] relative border-r border-border bg-surface-2/10",style:{minHeight:`${_}px`},children:[j.map(M=>a.jsx("div",{className:pr("border-b border-border/60",M%2===1&&"bg-surface-2/5"),style:{height:Em*2},children:I?a.jsx("div",{className:"w-full h-full cursor-not-allowed bg-surface/60 flex items-center justify-center border-b border-border/60 transition-colors",onClick:D=>D.preventDefault(),children:a.jsxs("div",{className:"text-center pointer-events-none",children:[a.jsx(j4,{className:"h-5 w-5 text-text-primary mx-auto mb-1"}),a.jsx("div",{className:"text-xs font-medium text-text-primary mb-1",children:"Fechada"}),O[r]?.observacao&&a.jsx("div",{className:"text-xs text-text-muted",children:O[r].observacao})]})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"relative border-b border-border/60 transition-colors flex items-center justify-center cursor-pointer hover:bg-white/5",style:{height:Em},onClick:()=>{const D=new Date(P.getTime());D.setHours(M,0,0,0),console.log("Slot :00 clicked",{day:P,hour:M,slotDate:D,activeCourtFilter:r}),i?.(D,r)}}),a.jsx("div",{className:"relative border-b border-border/60 transition-colors flex items-center justify-center cursor-pointer hover:bg-white/5",style:{height:Em},onClick:()=>{const D=new Date(P.getTime());D.setHours(M,30,0,0),console.log("Slot :30 clicked",{day:P,hour:M,slotDate:D,activeCourtFilter:r}),i?.(D,r)}})]})},`${A}-${M}`)),R.map(M=>C(M,s))]},A)})]})]})}const Pa=30,hp=e=>{const t=String(e??"").replace(/\D/g,"");if(!t)return"";const r=(Number(t)/100).toFixed(2),[n,s]=r.split(".");return`${n.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${s}`},_f=e=>{if(e==null||e==="")return NaN;const t=String(e).replace(/\./g,"").replace(",","."),r=parseFloat(t);return Number.isFinite(r)?r:NaN};function Q9(e){const t=String(e||"").trim().split(/\s+/).filter(Boolean);return t.length===0?"":t.length===1?t[0]:`${t[0]} ${t[1]}`}const Ti=56,lZe=6,a3=6,wae=24;Array.from({length:(wae-a3)*(60/Pa)},(e,t)=>{const r=a3*60+t*Pa,n=Math.floor(r/60),s=r%60;return{time:`${String(n).padStart(2,"0")}:${String(s).padStart(2,"0")}`,isHourMark:s===0}});const pp=["Futebol","Beach Tennis","Futevlei","Treino"];function Rm(e){return Dd(e,{weekStartsOn:1})}function cZe(e){const t=Rm(e),r=Ta(t,6);return t.getMonth()===r.getMonth()?`${cr(t,"dd")}-${cr(r,"dd")} de ${cr(r,"MMMM",{locale:na})} de ${cr(r,"yyyy")}`:`${cr(t,"dd")} de ${cr(t,"MMMM",{locale:na})} - ${cr(r,"dd")} de ${cr(r,"MMMM",{locale:na})} de ${cr(r,"yyyy")}`}const di={scheduled:{label:"Agendado",accent:"bg-[#3B82F6]",text:"text-[#3B82F6]",border:"border-[#3B82F6]",hex:"#3B82F6",icon:Bs},confirmed:{label:"Confirmado",accent:"bg-[#22C55E]",text:"text-[#22C55E]",border:"border-[#22C55E]",hex:"#22C55E",icon:Ro},in_progress:{label:"Em andamento",accent:"bg-[#FACC15]",text:"text-[#FACC15]",border:"border-[#FACC15]",hex:"#FACC15",icon:eG},finished:{label:"Finalizado",accent:"bg-[#6B7280]",text:"text-[#6B7280]",border:"border-[#6B7280]",hex:"#6B7280",icon:Nue},canceled:{label:"Cancelado",accent:"bg-[#EF4444]",text:"text-[#EF4444]",border:"border-[#EF4444]",hex:"#EF4444",icon:Qp},absent:{label:"Ausente",accent:"bg-[#F97316]",text:"text-[#F97316]",border:"border-[#F97316]",hex:"#F97316",icon:nG}},dZe={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},Z9={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},eU=e=>{let t=Math.floor(e/60);const r=e%60;return t>=24&&(t=t%24),`${String(t).padStart(2,"0")}:${String(r).padStart(2,"0")}`};function uZe({sidebarVisible:e=!1}){const{toast:t}=Qa(),{loadAlerts:r}=E1(),n=$o(),{isPaymentModalOpen:s,openPaymentModal:o,closePaymentModal:i,isEditParticipantModalOpen:l,openEditParticipantModal:c,closeEditParticipantModal:d,editParticipantData:u,editingBooking:f,setEditingBooking:h,participantsForm:m,setParticipantsForm:v,paymentTotal:g,setPaymentTotal:y,payMethods:x,setPayMethods:b}=hN(),w=p.useMemo(()=>{try{return typeof window<"u"&&localStorage.getItem("debug:agenda")==="1"}catch{return!1}},[]),j=p.useCallback((...G)=>{if(w)try{console.log("[AgendaDbg]",...G)}catch{}},[w]);p.useEffect(()=>{try{jt.current=Date.now()+2500,j("runAutomation:startup grace set",{until:jt.current}),setTimeout(()=>{try{qs()}catch{}},2500+200)}catch{}const G=console.log,re=console.info,we=console.debug,Ce=console.warn,ke=console.error,Oe=oe=>{const Ee=String(oe||"");return Ee.startsWith("[AgendaDbg]")||!1||Ee.startsWith("[PulseDump]")||Ee.startsWith("[Clientes:load]")||Ee.startsWith("[AgendaSettings]")||Ee.startsWith("[Auto]")||Ee.startsWith("[DEBUG-PaymentModal]")||Ee.startsWith(" EditGuard")};return console.log=(...oe)=>{try{if(Oe(oe[0]))return}catch{}return G(...oe)},console.info=(...oe)=>{try{if(Oe(oe[0]))return}catch{}return re(...oe)},console.debug=(...oe)=>{try{if(Oe(oe[0]))return}catch{}return we(...oe)},console.warn=(...oe)=>{try{if(Oe(oe[0]))return}catch{}return Ce(...oe)},console.error=(...oe)=>{try{if(Oe(oe[0]))return}catch{}return ke(...oe)},()=>{console.log=G,console.info=re,console.debug=we,console.warn=Ce,console.error=ke}},[]);const _=p.useRef({active:!1,tag:"",start:0,timer:null,events:[]}),S=p.useCallback((G,re)=>{if(w)try{const we=Date.now(),Ce=_.current&&_.current.active?we-(_.current.start||we):0;_.current.events.push({t:we,ms:Ce,event:G,data:re})}catch{}},[w]),C=p.useCallback(G=>{if(w){try{if(!_.current.active)return;const{tag:re,start:we,events:Ce}=_.current,ke=`[PulseDump] tag=${re} dur=${Date.now()-we}ms reason=${G}`;console.groupCollapsed(ke);for(const Oe of Ce)console.log(` +${String(Oe.ms).padStart(4," ")}ms`,Oe.event,Oe.data||{});console.groupEnd()}catch{}try{_.current.timer&&clearTimeout(_.current.timer)}catch{}_.current={active:!1,tag:"",start:0,timer:null,events:[]}}},[w]),P=p.useCallback((G,re=5e3)=>{if(w){try{_.current.timer&&clearTimeout(_.current.timer)}catch{}_.current={active:!0,tag:G,start:Date.now(),timer:null,events:[]},_.current.timer=setTimeout(()=>C("timeout"),re),j("PulseStart",{tag:G,timeoutMs:re})}},[w,C,j]),{userProfile:A,authReady:R,company:O}=ms(),[I,M]=hC(),[D,U]=p.useState(new Date),[z,W]=p.useState("day"),[$,X]=p.useState(!1),[ye,Se]=p.useState({}),[V,B]=p.useState(!1),[Q,pe]=p.useState({}),te=p.useMemo(()=>{const G=O?.nome_fantasia||O?.nome||O?.razao_social||O?.codigoEmpresa||"";return String(G).toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"").trim()},[O?.nome_fantasia,O?.nome,O?.razao_social,O?.codigoEmpresa]),Y=p.useMemo(()=>te?`https://${te}.f7arena.com`:"",[te]),ce=p.useCallback(async G=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(G);else{const re=document.createElement("textarea");re.value=G,re.style.position="fixed",re.style.top="0",re.style.left="0",re.style.opacity="0",document.body.appendChild(re),re.focus(),re.select(),document.execCommand("copy"),document.body.removeChild(re)}return!0}catch{return!1}},[]);p.useEffect(()=>{const G=re=>{if(re.key==="Escape"&&$){X(!1);return}if(re.key==="F10"){try{re.preventDefault()}catch{}X(we=>!we)}};return window.addEventListener("keydown",G),()=>window.removeEventListener("keydown",G)},[$]),p.useEffect(()=>{if($&&window.innerWidth<768)if(screen.orientation&&screen.orientation.lock)screen.orientation.lock("landscape").catch(()=>{const G=document.getElementById("screen-orientation-meta");G&&G.setAttribute("content","landscape")});else{const G=document.getElementById("screen-orientation-meta");G&&G.setAttribute("content","landscape")}else if(!$&&window.innerWidth<768){screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock();const G=document.getElementById("screen-orientation-meta");G&&G.setAttribute("content","portrait-primary")}},[$]),p.useEffect(()=>{const G=I.get("date");if(G)try{const re=new Date(G+"T00:00:00");isNaN(re.getTime())||(U(re),I.delete("date"),M(I,{replace:!0}))}catch(re){console.error("[AgendaPage] Erro ao parsear date da URL:",re)}},[I,M]);const[me,ae]=p.useState([]),le=p.useRef([]);p.useEffect(()=>{le.current=Array.isArray(me)?me:[]},[me]);const[ue,Re]=p.useState(!1),[ne,ie]=p.useState(""),gt=p.useRef(0),bt=p.useRef(""),at=p.useRef(!1),xt=p.useRef(0),[Ze,ht]=p.useState(!1),[Wt,be]=p.useState(!1),Ct=p.useRef(!1);p.useEffect(()=>{Ct.current||!R||!A?.codigo_empresa||D&&(Ct.current=!0,(async()=>{try{const G=_s(D),re=Ta(G,1),{data:we,error:Ce}=await de.from("agendamentos").select("id, codigo, inicio, fim, status, modalidade, quadra_id, cliente_id, auto_disabled, clientes, valor_total, created_by_isis").eq("codigo_empresa",A.codigo_empresa).gte("inicio",G.toISOString()).lt("inicio",re.toISOString()).order("inicio",{ascending:!0});if(Ce)return;const ke=(we||[]).map(Oe=>({id:Oe.id,code:Oe.codigo,start:new Date(Oe.inicio),end:new Date(Oe.fim),status:Oe.status||"scheduled",modality:Oe.modalidade||"",customer:Array.isArray(Oe.clientes)&&Oe.clientes.length>0?Oe.clientes[0]:"",court:String(Oe.quadra_id||""),court_id:Oe.quadra_id,valor_total:Oe.valor_total??null,auto_disabled:!!Oe.auto_disabled,created_by_isis:!!Oe.created_by_isis}));ae(Oe=>Array.isArray(Oe)&&Oe.length>0?Oe:ke)}catch{}})())},[R,A?.codigo_empresa,D,de]);const[wt,Ge]=p.useState(4),[Je,_e]=p.useState(!1),[je,Ue]=p.useState(!1),ze=f,or=h,[tr,Nt]=p.useState({}),yr=p.useRef(0),Me=p.useRef("");p.useEffect(()=>{const G=re=>{try{const we=re?.detail||{},Ce=we.agendamentoId,ke=we.participants;if(!Ce||!Array.isArray(ke))return;Nt(Oe=>{const oe=Oe[Ce]||[],Ee=ke.map((Ie,tt)=>{const vt=oe[tt]||{};return{...vt,cliente_id:Ie.cliente_id,nome:Ie.nome,codigo:Ie.codigo!==void 0?Ie.codigo:vt.codigo??null,valor_cota:typeof Ie.valor_cota=="string"?Ie.valor_cota:vt.valor_cota??"",status_pagamento:Ie.status_pagamento??vt.status_pagamento??"Pendente",finalizadora_id:Ie.finalizadora_id??vt.finalizadora_id??null,aplicar_taxa:Ie.aplicar_taxa??vt.aplicar_taxa??!1,ordem:tt+1}});return{...Oe,[Ce]:Ee}})}catch{}};return window.addEventListener("payments:saved",G),()=>window.removeEventListener("payments:saved",G)},[]);const dt=p.useRef(!1);p.useEffect(()=>{dt.current=Ze,j("Modal state change:",{isModalOpen:Ze}),S("modal",{open:Ze})},[Ze,j]);const ut=p.useRef("init"),rr=p.useRef(0),hr=p.useRef(!1),It=p.useRef(0),dr=p.useRef(!1),ur=p.useRef(0),[er,ln]=p.useState(!1),Mr=p.useRef(0),Ye=p.useRef(!1),$e=p.useRef(0),Be=p.useCallback((G=800)=>{$e.current=Date.now()+G,j("UI:busy set",{ms:G})},[j]),et=p.useCallback(()=>Date.now()<$e.current,[]),jt=p.useRef(0),yt=p.useRef(0),qt=p.useRef(!1),pt=p.useCallback(()=>{const G=Date.now();Ze||G-yt.current<350||(yt.current=G,ht(!0),qt.current=!0)},[Ze]),Dt=p.useRef(!1);p.useEffect(()=>{n.state?.openModal&&!Ze&&!Dt.current&&(Dt.current=!0,pt(),window.history.replaceState({},document.title))},[n.state?.openModal,Ze,pt]);const[he,Qe]=p.useState({scheduled:!0,available:!0,canceledOnly:!1,pendingPayments:!1}),[zt,Mt]=p.useState(null),[ir,nr]=p.useState(!0),kr=p.useRef(!0);p.useEffect(()=>{kr.current=!!ir},[ir]);const Ft=p.useMemo(()=>Object.fromEntries((zt??[]).map(G=>[G.nome,G])),[zt]),Dr=p.useMemo(()=>(zt??[]).map(G=>G.nome),[zt]),[Fr,Tn]=p.useState([]);p.useEffect(()=>{try{if(ir)return;const G=zt||[];if(!Array.isArray(G)||G.length===0||!Array.isArray(me)||me.length===0)return;let re=!1;const we=me.map(Ce=>{if(!Ce)return Ce;const ke=Ce.court_id;if(ke==null)return Ce;const Oe=G.find(oe=>String(oe.id)===String(ke));return Oe?.nome&&Ce.court!==Oe.nome&&!(Dr||[]).includes(Ce.court)?(re=!0,{...Ce,court:Oe.nome}):Ce});re&&ae(we)}catch{}},[ir,zt,me,Dr]);const nt=A?.codigo_empresa,$t=p.useMemo(()=>nt?`quadras:list:${nt}`:"quadras:list",[nt]),Kt=p.useMemo(()=>nt?`agenda:selectedCourts:${nt}`:"agenda:selectedCourts",[nt]),sr=p.useMemo(()=>nt?`agenda:viewFilter:${nt}`:"agenda:viewFilter",[nt]),[St,Jr]=p.useState(null),[Pt,lr]=p.useState(0);p.useEffect(()=>{Fr.length>0&&St===null&&Jr(Fr[0])},[Fr,St]);const[st,Et]=p.useState([]),ar=p.useRef(null),Tr=p.useRef({scheduled:!0,canceledOnly:!1}),[Qr,tn]=p.useState(null),[Qt,fn]=p.useState(""),nn=p.useRef(0),In=p.useRef(!1),Dn=p.useRef(!1),[se,He]=p.useState(!1),[ot,ee]=p.useState(()=>{try{return localStorage.getItem("agenda:hideCanceledInfo")==="1"}catch{return!1}});p.useEffect(()=>{try{localStorage.setItem("agenda:hideCanceledInfo",ot?"1":"0")}catch{}},[ot]);const k=p.useMemo(()=>{if(!A?.codigo_empresa)return null;const G=cr(z==="week"?Rm(D):D,"yyyy-MM-dd"),re=z==="week"?"week":"day";return`agenda:bookings:${A.codigo_empresa}:${re}:${G}`},[A?.codigo_empresa,D,z]),T=p.useMemo(()=>{if(!A?.codigo_empresa)return null;const G=cr(D,"yyyy-MM-dd");return`agenda:participants:${A.codigo_empresa}:${G}`},[A?.codigo_empresa,D]),[K,H]=p.useState(!1),F=p.useMemo(()=>({autoConfirmEnabled:!1,autoConfirmMinutesBefore:120,autoStartEnabled:!0,autoFinishEnabled:!0}),[]),[Le,it]=p.useState(F),[lt,Vt]=p.useState(F),[Ve,kt]=p.useState(!1),[Sr,Or]=p.useState(0),fr=p.useCallback(()=>Date.now()+(Number.isFinite(Sr)?Sr:0),[Sr]),[Kr,Pn]=p.useState(null);p.useEffect(()=>{(async()=>{if(console.log("[AgendaSettings][LOAD] Iniciando carregamento...",{authReady:R,company_id:O?.id}),!R||!O?.id){console.warn("[AgendaSettings][LOAD] Aguardando autenticao...");return}try{console.log("[AgendaSettings][LOAD] Modo:","PRODUO (wrapper)"),console.log("[AgendaSettings][LOAD] Buscando para empresa_id:",O.id);const{data:re,error:we}=await de.from("agenda_settings").select("*").eq("empresa_id",O.id).maybeSingle();if(console.log("[AgendaSettings][LOAD] Resultado da query:",{data:re,error:we}),console.log("[AgendaSettings][LOAD] Data type:",re===null?"null":typeof re),we){console.error("[AgendaSettings][LOAD] ERRO ao carregar:",we);return}if(!re){console.warn("[AgendaSettings][LOAD] Nenhum registro encontrado (ainda no criado)");return}console.log("[AgendaSettings][LOAD]  Registro encontrado:",re);const Ce={autoConfirmEnabled:!!re.auto_confirm_enabled,autoConfirmMinutesBefore:re.auto_confirm_enabled&&Number.isFinite(Number(re.auto_confirm_hours))?Number(re.auto_confirm_hours)*60:F.autoConfirmMinutesBefore,autoStartEnabled:!!re.auto_start_enabled,autoFinishEnabled:!!re.auto_finish_enabled};console.log("[AgendaSettings][LOAD]  Estado mapeado:",Ce),it(ke=>({...ke,...Ce})),Vt(Ce),console.log("[AgendaSettings][LOAD]  Estados atualizados com sucesso!")}catch(re){console.warn("[AgendaSettings] unexpected load error",re)}})()},[R,O?.id]),p.useEffect(()=>{let G=!0,re=null,we=!1;const Ce=async()=>{try{const{data:ke,error:Oe}=await de.functions.invoke("time-br",{body:{}});if(!Oe&&ke&&G){const oe=Number(ke.nowMs);if(Number.isFinite(oe)){const Ee=oe-Date.now();Or(Ee),Pn(Date.now());return}}if(!we){we=!0;try{console.warn("[TimeSync] time-br sem dados vlidos; usando relgio local.")}catch{}}}catch{if(!we){we=!0;try{console.warn("[TimeSync] time-br falhou; usando relgio local.")}catch{}}}};return Ce(),re=setInterval(Ce,5*60*1e3),()=>{G=!1,re&&clearInterval(re)}},[]);const[qn,zn]=p.useState({}),sn=2*60*60*1e3,qr=p.useCallback(G=>{zn(re=>({...re,[G]:Date.now()}))},[]),Sa=p.useCallback(G=>{zn(re=>{if(!re||!(G in re))return re;const we={...re};return delete we[G],we})},[]),_a=p.useCallback(G=>{const re=qn?.[G];return typeof re=="number"&&Date.now()-re<sn},[qn]),[da,Xs]=p.useState(null),Ys=p.useCallback(()=>new Promise(G=>{Xs({resolve:G})}),[]),Za=p.useRef(new Map),ol=async()=>{console.log(" [AgendaSettings][SAVE] FUNO CHAMADA! "),console.log("[AgendaSettings][SAVE] Linha 509 - Antes do try");try{if(console.log("[AgendaSettings][SAVE] Linha 511 - Dentro do try"),console.log("[AgendaSettings][SAVE] authReady:",R),console.log("[AgendaSettings][SAVE] company:",O),!R||!O?.id){console.error("[AgendaSettings][SAVE] ERRO: No autenticado",{authReady:R,company:O}),t({title:"No autenticado",description:"Faa login para salvar as configuraes.",variant:"destructive"});return}console.log("[AgendaSettings][SAVE]  Autenticado! Preparando payload..."),console.log("[AgendaSettings][SAVE] automation atual:",Le),kt(!0);const G={empresa_id:O.id,auto_confirm_enabled:!!Le.autoConfirmEnabled,auto_confirm_hours:Le.autoConfirmEnabled?Math.max(0,Math.round(Number(Le.autoConfirmMinutesBefore||0)/60)):null,auto_start_enabled:!!Le.autoStartEnabled,auto_finish_enabled:!!Le.autoFinishEnabled};console.log("[AgendaSettings][SAVE] Payload preparado:",G),console.log("[AgendaSettings][SAVE] Modo:","PRODUO (wrapper)"),console.log("[AgendaSettings][SAVE] Supabase client type:",typeof de.from);const{data:re,error:we}=await de.from("agenda_settings").upsert(G,{onConflict:"empresa_id"}).select();if(console.log("[AgendaSettings][SAVE] Resultado do upsert:",{data:re,error:we}),console.log("[AgendaSettings][SAVE] Data type:",Array.isArray(re)?"array":typeof re),console.log("[AgendaSettings][SAVE] Data length:",re?.length),we)throw console.error("[AgendaSettings][SAVE]  ERRO no upsert:",we),we;!re||re.length===0?console.error("[AgendaSettings][SAVE]  AVISO: Upsert no retornou dados!"):console.log("[AgendaSettings][SAVE]  Dados salvos com sucesso:",re[0]),Vt(Le),console.log("[AgendaSettings][SAVE]  savedAutomation atualizado:",Le),t({title:"Configuraes salvas",description:"As automaes da agenda foram atualizadas com sucesso."}),H(!1),console.log("[AgendaSettings][SAVE]  Salvamento concludo!")}catch(G){console.error(" [AgendaSettings][SAVE] ERRO CAPTURADO:",G),console.error("[AgendaSettings][SAVE] Stack:",G?.stack),console.error("[AgendaSettings][SAVE] Message:",G?.message);const re=G?.message||"Falha ao salvar as configuraes.";t({title:"Erro ao salvar",description:re,variant:"destructive"})}finally{console.log("[AgendaSettings][SAVE] Finally executado"),kt(!1)}},hs=p.useCallback(async(G,re,we="user")=>{try{const Ce=["canceled","finished","absent"],ke=["scheduled","confirmed","in_progress"],Oe=Ce.includes(re),oe=re==="canceled";let Ee=!1;if(we==="user"&&ke.includes(re)){const Rt=(me||[]).find(Bt=>Bt.id===G),At=Rt?Ce.includes(Rt.status):!1,Gt=Rt?!!Rt.auto_disabled:!1;(At||Gt)&&(Ee=!!await Ys())}const Ie=oe?{canceled_by:we||"user",canceled_at:new Date().toISOString()}:{},tt=Oe?{status:re,auto_disabled:!0,...Ie}:Ee?{status:re,auto_disabled:!1}:{status:re},{error:vt}=await de.from("agendamentos").update(tt).eq("codigo_empresa",A.codigo_empresa).eq("id",G).select("id");if(vt)throw vt;ae(Rt=>Rt.map(At=>{if(At.id!==G)return At;const Gt={...At,status:re,customer:At.customer||""};return Oe?Gt.auto_disabled=!0:Ee&&(Gt.auto_disabled=!1),Gt}));try{Za.current.set(G,{status:re,ts:Date.now(),src:we})}catch{}try{const Rt=JSON.parse(localStorage.getItem(k)||"[]");if(Array.isArray(Rt)&&Rt.length>0){const At=Array.isArray(Rt)?Rt.map(Gt=>{if(Gt.id!==G)return Gt;const Bt={...Gt,status:re,customer:Gt.customer||""};return Oe?Bt.auto_disabled=!0:Ee&&(Bt.auto_disabled=!1),Bt}):Rt;localStorage.setItem(k,JSON.stringify(At))}}catch{}if(we==="user")try{Ee?Sa(G):qr(G)}catch{}}catch(Ce){console.error("Auto-status: falha ao atualizar",G,re,Ce)}},[me,k,qr,Sa,Ys,he]),fc=p.useRef(!1),mc=p.useRef(null),Ui=p.useRef(null),Bo=p.useRef(null),Ll=p.useRef(!1),Bd=p.useCallback(()=>{try{mc.current&&(clearTimeout(mc.current),mc.current=null)}catch{}},[]),qs=p.useCallback(()=>{if(!R||!A?.codigo_empresa)return;if(Date.now()<(jt.current||0)){try{localStorage.getItem("debug:agenda")==="1"&&console.log("[AutoDiag] scheduleNextAutomation:deferred returning-from-hidden")}catch{}Ui.current||(Ui.current=setTimeout(()=>{Ui.current=null;try{qs()}catch{}},800));return}if(Ui.current){try{clearTimeout(Ui.current)}catch{}Ui.current=null}if(!Ll.current){j("scheduleNextAutomation:skipped (initial data not ready)"),setTimeout(()=>qs(),800);return}if(dt.current){j("scheduleNextAutomation:skipped (modal open)");return}S("auto:schedule"),Bd();const re=fr();let we=1/0;const Ce=ke=>{Number.isFinite(ke)&&ke>re&&ke<we&&(we=ke)};try{for(const ke of me||[]){if(!ke||ke.auto_disabled||_a(ke.id))continue;const Oe=ke.start instanceof Date?ke.start.getTime():new Date(ke.start).getTime(),oe=ke.end instanceof Date?ke.end.getTime():new Date(ke.end).getTime();if(ke.status==="scheduled"&&lt.autoConfirmEnabled){const Ee=Number(lt.autoConfirmMinutesBefore||0)*6e4;Ce(Oe-Ee),lt.autoFinishEnabled&&Ce(oe)}ke.status==="confirmed"&&(lt.autoStartEnabled&&Ce(Oe),lt.autoFinishEnabled&&Ce(oe)),ke.status==="in_progress"&&lt.autoFinishEnabled&&Ce(oe)}}catch{}if(we!==1/0){const ke=Math.max(0,Math.min(we-re+250,6e5));try{console.debug("[Auto] next schedule in ms",ke)}catch{}try{hm(we)}catch{}mc.current=setTimeout(()=>{try{Bo.current&&Bo.current()}catch{}},ke)}},[R,A?.codigo_empresa,me,lt,_a,Bd,fr]),Qc=p.useCallback(async G=>{try{if(!(typeof Kr=="number"&&Date.now()-Kr<6e5))try{const{data:Ce}=await de.functions.invoke("time-br",{body:{}}),ke=Number(Ce?.nowMs);Number.isFinite(ke)&&(Or(ke-Date.now()),Pn(Date.now()))}catch{}try{qs()}catch{}let we=null;if(G?.id&&A?.codigo_empresa){const{data:Ce}=await de.from("agendamentos").select("id, inicio, fim, status, modalidade, quadra_id, cliente_id, auto_disabled").eq("codigo_empresa",A.codigo_empresa).eq("id",G.id).single();if(Ce){const ke={...G,start:new Date(Ce.inicio),end:new Date(Ce.fim),status:Ce.status||G.status,modality:Ce.modalidade||G.modality,auto_disabled:!!Ce.auto_disabled,customer:G.customer||""};we=ke,ae(Oe=>Oe.map(oe=>oe.id===G.id?ke:oe))}}try{const Ce=we||G;if(Ce&&Ce.id){const ke=fr(),Oe=Ce.start instanceof Date?Ce.start.getTime():new Date(Ce.start).getTime(),oe=Ce.end instanceof Date?Ce.end.getTime():new Date(Ce.end).getTime();if(!Ce.auto_disabled&&!_a(Ce.id))if(Ce.status==="in_progress"&&lt.autoFinishEnabled&&Number.isFinite(oe)&&ke>=oe)await hs(Ce.id,"finished","automation");else if(Ce.status==="scheduled"&&lt.autoStartEnabled&&Number.isFinite(Oe)&&ke>=Oe)await hs(Ce.id,"in_progress","automation");else if(Ce.status==="confirmed"&&lt.autoStartEnabled&&Number.isFinite(Oe)&&ke>=Oe)await hs(Ce.id,"in_progress","automation");else if(Ce.status==="scheduled"&&lt.autoConfirmEnabled&&Number.isFinite(Oe)){const Ie=Number(lt.autoConfirmMinutesBefore||0)*6e4;ke>=Oe-Ie&&await hs(Ce.id,"confirmed","automation")}else(Ce.status==="scheduled"||Ce.status==="confirmed")&&lt.autoFinishEnabled&&Number.isFinite(oe)&&ke>=oe&&await hs(Ce.id,"finished","automation")}}catch{}try{Bo.current&&Bo.current()}catch{}try{console.log(" EditGuard | ok | tempo=",typeof Kr=="number"?"Servidor":"Local")}catch{}return{booking:we}}catch(re){try{console.warn(" EditGuard | falha leve",re?.message||re)}catch{}return{booking:null}}},[Kr,de,A,ae,qs,fr,Le,_a,hs]);p.useEffect(()=>{if(!(!R||!A?.codigo_empresa)&&Kr&&!Ll.current){Ll.current=!0,j("initial-data:ready",{at:Kr});try{qs()}catch{}}},[Kr,R,A,qs,j]);const Fl=p.useCallback(async()=>{if(!(!R||!A?.codigo_empresa)){if(dt.current){j("runAutomation:skipped (modal open)");return}if(Date.now()<(jt.current||0)){j("runAutomation:skipped (returning-from-hidden grace)");try{qs()}catch{}return}if(!Ll.current){j("runAutomation:skipped (initial data not ready)");try{qs()}catch{}return}if(!fc.current){fc.current=!0;try{try{console.debug("[Auto] tick")}catch{}S("auto:tick");const G=fr(),re=new Date(G),we=cr(re,"yyyy-MM-dd");let Ce=(me||[]).filter(Oe=>cr(Oe.start,"yyyy-MM-dd")===we);if(Ce.length===0)try{const Oe=_s(re),oe=Ta(Oe,1),{data:Ee,error:Ie}=await de.from("agendamentos").select("id, inicio, fim, status, auto_disabled").eq("codigo_empresa",A.codigo_empresa).gte("inicio",Oe.toISOString()).lt("inicio",oe.toISOString());!Ie&&Array.isArray(Ee)&&(Ce=Ee.map(tt=>({id:tt.id,start:new Date(tt.inicio),end:new Date(tt.fim),status:tt.status||"scheduled",auto_disabled:!!tt.auto_disabled})))}catch{}try{const{data:Oe,error:oe}=await de.from("agendamentos").select("id, inicio, fim, status, auto_disabled").eq("codigo_empresa",A.codigo_empresa).lt("fim",re.toISOString()).in("status",["scheduled","confirmed","in_progress"]);if(!oe&&Array.isArray(Oe)&&Oe.length>0){const Ee=Oe.map(tt=>({id:tt.id,start:new Date(tt.inicio),end:new Date(tt.fim),status:tt.status||"scheduled",auto_disabled:!!tt.auto_disabled})),Ie=new Map(Ce.map(tt=>[tt.id,tt]));for(const tt of Ee)Ie.has(tt.id)||Ie.set(tt.id,tt);Ce=Array.from(Ie.values())}}catch{}let ke=!1;for(const Oe of Ce){if(Oe.auto_disabled||_a(Oe.id))continue;const oe=Oe.start instanceof Date?Oe.start.getTime():new Date(Oe.start).getTime(),Ee=Oe.end instanceof Date?Oe.end.getTime():new Date(Oe.end).getTime();if(Oe.status==="in_progress"&&lt.autoFinishEnabled&&G>=Ee){try{console.debug("[Auto] finish",{id:Oe.id})}catch{}await hs(Oe.id,"finished","automation"),ke=!0;continue}if(Oe.status==="scheduled"&&lt.autoStartEnabled&&G>=oe){try{console.debug("[Auto] start-direct (skip confirm)",{id:Oe.id})}catch{}await hs(Oe.id,"in_progress","automation"),ke=!0;continue}if(Oe.status==="confirmed"&&lt.autoStartEnabled&&G>=oe){try{console.debug("[Auto] start",{id:Oe.id})}catch{}await hs(Oe.id,"in_progress","automation"),ke=!0;continue}if(Oe.status==="scheduled"&&lt.autoConfirmEnabled){const Ie=Number(lt.autoConfirmMinutesBefore||0)*6e4;if(G>=oe-Ie){try{console.debug("[Auto] confirm",{id:Oe.id})}catch{}await hs(Oe.id,"confirmed","automation"),ke=!0;continue}}if((Oe.status==="scheduled"||Oe.status==="confirmed")&&lt.autoFinishEnabled&&G>=Ee){try{console.debug("[Auto] catchup-finish",{id:Oe.id})}catch{}await hs(Oe.id,"finished","automation"),ke=!0;continue}}if(ke)try{setTimeout(()=>{try{zs()}catch{}},800)}catch{}try{qs()}catch{}}finally{fc.current=!1}}}},[R,A?.codigo_empresa,me,lt,hs,_a,qs,fr]);p.useEffect(()=>{Bo.current=Fl},[Fl]),p.useEffect(()=>{const G=setInterval(Fl,1e4);try{Bo.current&&Bo.current()}catch{}try{qs()}catch{}return()=>clearInterval(G)},[Fl]),p.useEffect(()=>{const G=setInterval(()=>{try{if(!!!(lt?.autoConfirmEnabled||lt?.autoStartEnabled||lt?.autoFinishEnabled))return;Bo.current&&(console.debug("[Auto][Watchdog] forcing periodic automation run"),Bo.current())}catch{}},18e5);return()=>clearInterval(G)},[lt]),p.useEffect(()=>{if(k)try{const G=JSON.parse(localStorage.getItem(k)||"[]");if(Array.isArray(G)&&G.length>0){const re=G.map(we=>({...we,start:new Date(we.start),end:new Date(we.end),customer:we.customer||"",created_by_isis:!!we.created_by_isis}));j("cache:bookings:hydrate",{count:re.length,sample:re[0]}),S("cache:hydrate",{count:re.length}),ae(we=>we&&we.length>0?we:re),Be(1200)}}catch{}},[k,j]),p.useEffect(()=>{const G=()=>{try{const Ce=new Date().toISOString();if(document.visibilityState==="visible"){const ke=Date.now();jt.current=ke+800}}catch{}},re=()=>{try{const Ce=new Date().toISOString()}catch{}},we=()=>{try{const Ce=new Date().toISOString()}catch{}};return document.addEventListener("visibilitychange",G),window.addEventListener("focus",re),window.addEventListener("blur",we),()=>{document.removeEventListener("visibilitychange",G),window.removeEventListener("focus",re),window.removeEventListener("blur",we)}},[Ze,me]),p.useEffect(()=>{try{qs()}catch{}return()=>{try{Bd()}catch{}}},[me,Le,qs,Bd]),p.useEffect(()=>{if(T)try{const G=JSON.parse(localStorage.getItem(T)||"{}");if(G&&typeof G=="object"){const re={};for(const[we,Ce]of Object.entries(G||{})){const ke=Array.isArray(Ce)?Ce.slice():[];ke.sort((Oe,oe)=>{const Ee=Number.isFinite(Number(Oe?.ordem))?Number(Oe.ordem):Number.MAX_SAFE_INTEGER,Ie=Number.isFinite(Number(oe?.ordem))?Number(oe.ordem):Number.MAX_SAFE_INTEGER;return Ee!==Ie?Ee-Ie:String(Oe?.id||"").localeCompare(String(oe?.id||""))}),re[we]=ke}Nt(re),Me.current=cr(D,"yyyy-MM-dd")}}catch{}},[T]);const il=p.useCallback(async(G,re)=>{if(!R||!A?.codigo_empresa)return{map:{},ids:[]};const we=(Array.isArray(G)?G:[]).filter(Boolean);if(we.length===0)return{map:{},ids:[]};try{localStorage.getItem("debug:agenda")==="1"&&console.log("[AgendaBoot] fetchParticipantsBatch:start",{reqId:re,ids:we.length})}catch{}const{data:Ce,error:ke}=await de.from("agendamento_participantes").select("id, agendamento_id, codigo_empresa, cliente_id, nome, valor_cota, status_pagamento, finalizadora_id, aplicar_taxa, ordem, is_representante, deleted_at, cliente:clientes!agendamento_participantes_cliente_id_fkey(nome, codigo)").in("agendamento_id",we).is("deleted_at",null).order("ordem",{ascending:!0}).order("id",{ascending:!0});if(gt.current!==re)return{map:{},ids:we};if(ke)throw ke;const Oe={};for(const oe of Ce||[]){const Ee=oe.agendamento_id;Oe[Ee]||(Oe[Ee]=[]);const Ie=oe.nome||(Array.isArray(oe.cliente)?oe.cliente[0]?.nome:oe.cliente?.nome)||"",tt=(Array.isArray(oe.cliente)?oe.cliente[0]?.codigo:oe.cliente?.codigo)||null;Oe[Ee].push({...oe,nome:Ie,codigo:tt})}for(const oe of we){const Ee=Array.isArray(Oe[oe])?Oe[oe].slice():[];Ee.sort((Ie,tt)=>{const vt=Number.isFinite(Number(Ie?.ordem))?Number(Ie.ordem):Number.MAX_SAFE_INTEGER,Rt=Number.isFinite(Number(tt?.ordem))?Number(tt.ordem):Number.MAX_SAFE_INTEGER;return vt!==Rt?vt-Rt:String(Ie?.id||"").localeCompare(String(tt?.id||""))}),Oe[oe]=Ee}Nt(oe=>{const Ee={...oe};for(const Ie of we)Ee[Ie]=Oe[Ie]||[];try{T&&localStorage.setItem(T,JSON.stringify(Ee))}catch{}return Ee}),ae(oe=>{const Ee=oe||[];let Ie=!1;const tt=Ee.map(vt=>{const Rt=Oe[vt.id];if(Array.isArray(Rt)&&Rt.length>0){const At=(Rt.find(Gt=>Gt?.is_representante)||Rt[0])?.nome||"";if(At&&At!==vt.customer)return Ie=!0,{...vt,customer:At}}return vt});return Ie?tt:oe});try{localStorage.getItem("debug:agenda")==="1"&&console.log("[AgendaBoot] fetchParticipantsBatch:done",{reqId:re,rows:(Ce||[]).length})}catch{}return{map:Oe,ids:we}},[R,A?.codigo_empresa,T,Nt,ae]),zs=p.useCallback(async()=>{if(!R||!A?.codigo_empresa||Ze)return;j("fetchBookings:start",{date:cr(D,"yyyy-MM-dd"),empresa:A?.codigo_empresa}),S("fetch:start",{day:cr(D,"yyyy-MM-dd")});const G=_s(D),re=z==="week"?Rm(D):G,we=z==="week"?Ta(re,7):Ta(re,1),{data:Ce,error:ke}=await de.from("agendamentos").select(`
        id, codigo, codigo_empresa, quadra_id, cliente_id, clientes, valor_total, inicio, fim, modalidade, status, auto_disabled, created_by_isis,
        quadra:quadra_id ( nome )
      `).eq("codigo_empresa",A.codigo_empresa).gte("inicio",re.toISOString()).lt("inicio",we.toISOString()).order("inicio",{ascending:!0});if(ke){j("fetchBookings:error",{message:ke?.message,code:ke?.code,status:ke?.status}),S("fetch:error",{message:ke?.message,code:ke?.code,status:ke?.status}),t({title:"Erro ao carregar agendamentos",description:ke.message,variant:"destructive"}),In.current||(In.current=!0,setTimeout(zs,900));return}if(!Ce||Ce.length===0)return j("fetchBookings:empty-hit"),S("fetch:empty"),In.current?In.current=!1:(In.current=!0,setTimeout(zs,700)),le.current;In.current=!1;const Oe=Date.now(),oe=(()=>{try{const Ie=Array.isArray(le.current)?le.current:[];return new Map(Ie.map(tt=>[tt.id,tt]))}catch{return new Map}})(),Ee=(Ce||[]).map(Ie=>{const tt=new Date(Ie.inicio),vt=new Date(Ie.fim),Rt=oe.get(Ie.id),At=Ie.quadra?.[0]?.nome||Ie.quadra?.nome||Object.values(Ft).find(vr=>vr.id===Ie.quadra_id)?.nome||"",Gt=Ie.quadra_id!=null?String(Ie.quadra_id):"";let Bt="";if(!Bt&&Ie.clientes)try{const vr=typeof Ie.clientes=="string"?JSON.parse(Ie.clientes):Ie.clientes;Array.isArray(vr)&&vr.length>0&&(Bt=vr[0]?.nome||vr[0]||"")}catch{}const Ht=Za.current.get(Ie.id),jr=Ht&&Oe-Ht.ts<4e3;return{id:Ie.id,code:Ie.codigo,court:At||Gt,court_id:Ie.quadra_id,customer:Rt&&Rt.customer?Rt.customer:Bt,valor_total:Ie.valor_total!==void 0?Ie.valor_total:Rt?.valor_total??null,start:tt,end:vt,status:jr?Ht.status:Ie.status||"scheduled",modality:Ie.modalidade||"",auto_disabled:!!Ie.auto_disabled,created_by_isis:!!Ie.created_by_isis}});ae(Ie=>{const tt=Array.isArray(Ie)?Ie:[],vt=Array.isArray(Ee)?Ee:[];if(tt.length!==vt.length)return Ee;for(let Rt=0;Rt<tt.length;Rt++){const At=tt[Rt],Gt=vt[Rt];if(!At||!Gt)return Ee;const Bt=At.start instanceof Date?At.start.getTime():new Date(At.start).getTime(),Ht=At.end instanceof Date?At.end.getTime():new Date(At.end).getTime(),jr=Gt.start instanceof Date?Gt.start.getTime():new Date(Gt.start).getTime(),vr=Gt.end instanceof Date?Gt.end.getTime():new Date(Gt.end).getTime();if(At.id!==Gt.id||At.status!==Gt.status||At.modality!==Gt.modality||String(At.court||"")!==String(Gt.court||"")||String(At.court_id||"")!==String(Gt.court_id||"")||String(At.customer||"")!==String(Gt.customer||"")||Number(At.valor_total??NaN)!==Number(Gt.valor_total??NaN)||!!At.auto_disabled!=!!Gt.auto_disabled||Bt!==jr||Ht!==vr)return Ee}return Ie});try{if(k){const Ie=Ee.map(tt=>({id:tt.id,code:tt.code,court:tt.court,court_id:tt.court_id,customer:tt.customer,valor_total:tt.valor_total??null,start:tt.start.toISOString(),end:tt.end.toISOString(),status:tt.status,modality:tt.modality,auto_disabled:tt.auto_disabled,created_by_isis:!!tt.created_by_isis}));localStorage.setItem(k,JSON.stringify(Ie))}}catch{}return Ee},[R,A?.codigo_empresa,D,Ft,k,t,j,w,z,Ze]);p.useEffect(()=>{(async()=>{if(!R||!A?.codigo_empresa||!D||Ze)return;const re=cr(z==="week"?Rm(D):D,"yyyy-MM-dd"),we=`${A.codigo_empresa}:${z}:${re}`;if(bt.current===we||at.current)return;at.current=!0;const Ce=++gt.current;xt.current=Date.now();try{localStorage.getItem("debug:agenda")==="1"&&console.log("[AgendaBoot] start",{reqId:Ce,bootKey:we,ts:new Date().toISOString()})}catch{}Re(!0),ie("Carregando quadras");try{if(kr.current){const Gt=Date.now();let Bt=!1;await new Promise(Ht=>{const jr=setInterval(()=>{if(gt.current!==Ce){clearInterval(jr),Ht();return}if(kr.current||(clearInterval(jr),Ht()),!Bt&&Date.now()-Gt>5e3){Bt=!0;try{console.warn("[AgendaBoot] aguardando courtsLoading >5s",{reqId:Ce,bootKey:we})}catch{}}if(Date.now()-Gt>6500){try{console.warn("[AgendaBoot] timeout aguardando courtsLoading, prosseguindo boot",{reqId:Ce,bootKey:we})}catch{}clearInterval(jr),Ht()}},50)})}if(gt.current!==Ce)return;ie("Carregando agendamentos");try{localStorage.getItem("debug:agenda")==="1"&&console.log("[AgendaBoot] stage",{reqId:Ce,stage:"bookings"})}catch{}const ke=Date.now();let Oe=!1;const oe=setInterval(()=>{if(!Oe&&gt.current===Ce&&Date.now()-ke>5e3){Oe=!0;try{console.warn("[AgendaBoot] aguardando fetchBookings >5s",{reqId:Ce,bootKey:we})}catch{}}},250);let Ee=await zs();try{clearInterval(oe)}catch{}if(gt.current!==Ce)return;let Ie=Array.isArray(Ee)?Ee:[];if(Ie.length===0){try{localStorage.getItem("debug:agenda")==="1"&&console.warn("[AgendaBoot] fetchBookings vazio, tentando novamente",{reqId:Ce,bootKey:we})}catch{}if(await new Promise(Gt=>setTimeout(Gt,750)),Ee=await zs(),gt.current!==Ce)return;Ie=Array.isArray(Ee)?Ee:[]}const tt=Ie.map(Gt=>Gt.id).filter(Boolean);try{localStorage.getItem("debug:agenda")==="1"&&console.log("[AgendaBoot] bookings loaded",{reqId:Ce,count:Ie.length,idsCount:tt.length})}catch{}ie("Carregando participantes");try{localStorage.getItem("debug:agenda")==="1"&&console.log("[AgendaBoot] stage",{reqId:Ce,stage:"participants"})}catch{}const vt=Date.now();let Rt=!1;const At=setInterval(()=>{if(!Rt&&gt.current===Ce&&Date.now()-vt>5e3){Rt=!0;try{console.warn("[AgendaBoot] aguardando fetchParticipantsBatch >5s",{reqId:Ce,bootKey:we,ids:tt.length})}catch{}}},250);await il(tt,Ce);try{clearInterval(At)}catch{}bt.current=we}catch(ke){try{console.warn("[AgendaBoot] erro ao carregar agenda:",{reqId:Ce,bootKey:we,message:ke?.message,e:ke})}catch{}}finally{if(at.current=!1,gt.current===Ce){Re(!1),ie("");try{const ke=Date.now()-(xt.current||Date.now());localStorage.getItem("debug:agenda")==="1"&&console.log("[AgendaBoot] done",{reqId:Ce,bootKey:we,ms:ke})}catch{}}}})()},[R,A?.codigo_empresa,D,z,Ze,ir,zs,il]),p.useEffect(()=>{if(w)try{const G=(me||[]).map(re=>`${re.id}:${cr(re.start,"HH:mm")}-${cr(re.end,"HH:mm")}:${re.status}`).join(" | ");console.log("[AgendaDbg] bookings:changed",{count:Array.isArray(me)?me.length:0,summary:G})}catch{}},[me,w]),p.useEffect(()=>{try{const G=Date.now()+1800;It.current=G,j("Picker:suppressClose window set",{until:G})}catch{}},[me]),p.useEffect(()=>{R&&A?.codigo_empresa&&zs()},[R,A?.codigo_empresa,D,Ft,k]);const Si=p.useRef(null),[qo,hc]=p.useState("idle"),[$l,hf]=p.useState(null),oi=p.useRef(!1);p.useEffect(()=>{if(!R||!A?.codigo_empresa)return;const G=_s(D),re=Ta(G,1),we=Ie=>{try{const tt=new Date(Ie);return tt>=G&&tt<re}catch{return!1}},Ce=Ie=>{const tt=Ie?.new||Ie?.old;if(tt&&tt.codigo_empresa===A.codigo_empresa&&(we(tt.inicio)||we(tt.fim))){try{console.debug("[Realtime] agendamentos change",{event:Ie.eventType,id:tt.id})}catch{}Si.current&&clearTimeout(Si.current);try{hf(Date.now())}catch{}if(dt.current){j("Realtime:onChange deferred due to modal open"),oi.current=!0,S("rt:change:deferred",{id:tt.id,event:Ie.eventType});return}j("Realtime:onChange scheduling fetchBookings"),S("rt:change",{id:tt.id,event:Ie.eventType}),Si.current=setTimeout(()=>{try{j("Realtime:debounced fetchBookings fire"),S("rt:debounced:fire"),Be(300),zs()}catch{}},400)}},ke=Ie=>{const tt=Ie?.new||Ie?.old;if(tt&&tt.codigo_empresa===A.codigo_empresa){try{console.debug("[Realtime] agendamento_participantes change",{event:Ie.eventType,agendamento_id:tt.agendamento_id})}catch{}Si.current&&clearTimeout(Si.current);try{hf(Date.now())}catch{}if(dt.current){j("Realtime:onParticipantsChange deferred due to modal open"),oi.current=!0,S("rt:participants:deferred",{agendamento_id:tt.agendamento_id,event:Ie.eventType});return}j("Realtime:onParticipantsChange scheduling fetchBookings"),S("rt:participants",{agendamento_id:tt.agendamento_id,event:Ie.eventType}),Si.current=setTimeout(()=>{try{j("Realtime:participants debounced fetchBookings fire"),S("rt:participants:debounced:fire"),Be(300),zs()}catch{}},400)}},Oe=de.channel(`agendamentos:${A.codigo_empresa}`).on("postgres_changes",{event:"*",schema:"public",table:"agendamentos",filter:`codigo_empresa=eq.${A.codigo_empresa}`},Ce).subscribe(Ie=>{try{console.debug("[Realtime] channel status",Ie)}catch{}try{hc(String(Ie||"unknown"))}catch{}}),oe=de.channel(`agendamento_participantes:${A.codigo_empresa}`).on("postgres_changes",{event:"*",schema:"public",table:"agendamento_participantes",filter:`codigo_empresa=eq.${A.codigo_empresa}`},ke).subscribe(),Ee=setInterval(()=>{dt.current||zs()},3e4);return()=>{try{Si.current&&clearTimeout(Si.current)}catch{}try{de.removeChannel(Oe)}catch{}try{de.removeChannel(oe)}catch{}try{clearInterval(Ee)}catch{}try{hc("polling")}catch{}}},[R,A?.codigo_empresa,D,zs]),p.useEffect(()=>{if(!Ze&&oi.current){oi.current=!1;try{j("Modal closed: flushing pending realtime refresh"),S("rt:flushAfterModalClose"),zs()}catch{}}},[Ze,zs,j]);const[zo,hm]=p.useState(null),pf=p.useRef("");p.useEffect(()=>{try{const G=typeof Kr=="number"&&Date.now()-Kr<6e5,re=tt=>typeof tt=="number"?cr(new Date(tt),"HH:mm:ss",{locale:na}):"",we=tt=>typeof tt=="number"?cr(new Date(tt),"HH:mm",{locale:na}):"",Ce=G?"":"",Oe=String(qo).toUpperCase()==="SUBSCRIBED"||String(qo).toLowerCase()==="polling"?"":"",oe=typeof zo=="number"?"":"",Ee=Array.isArray(me)?me.length:0,Ie=` Agenda | ${Ce} Tempo=${G?"Servidor":"Local"} (${Math.round(Sr)}ms, sync ${re(Kr)}) |  Realtime=${Oe} ${qo}${$l?` (${re($l)})`:""} | ${oe} Prximo=${we(zo)} |  Agendamentos=${Ee}`;pf.current!==Ie&&(pf.current=Ie,console.log(Ie)),typeof window<"u"&&(window.__AgendaConn={usingServer:G,serverOffsetMs:Sr,lastTimeSyncAtMs:Kr,realtimeStatus:qo,lastRealtimeEventAtMs:$l,nextAutoAtMs:zo})}catch{}},[Sr,Kr,qo,$l,Le,zo,A?.codigo_empresa,D,Array.isArray(me)?me.length:0]),p.useEffect(()=>{const G=setInterval(()=>{try{const re=Date.now();if(re<(jt.current||0)){try{localStorage.getItem("debug:agenda")==="1"&&console.log("[AutoDiag] reconcile:skipped returning-from-hidden")}catch{}return}if(Ze){console.log("[AutoDiag] reconcile:skipped modal-open");return}const we=String(qo||"").toUpperCase()==="SUBSCRIBED",Ce=typeof $l=="number"?re-$l:1/0,ke=!we||Ce>7*60*1e3,Oe=typeof zo=="number"?re>zo+60*1e3:!1;if(ke||Oe){console.debug("[Reconcile] forcing fetchBookings (stale=",ke," tickDue=",Oe,")"),zs();try{qs()}catch{}}}catch{}},3e5);return()=>clearInterval(G)},[qo,$l,zo,zs,qs]),p.useEffect(()=>{(async()=>{if(!R||!A?.codigo_empresa||Date.now()<(jt.current||0))return;if(dt.current){j("Participants:skipped (modal open)");return}j("Participants:load start"),S("parts:start");const re=(me||[]).map(Ee=>Ee.id).filter(Boolean),we=cr(D,"yyyy-MM-dd");if(!re.length){if(Me.current!==we){Nt({});try{T&&localStorage.setItem(T,"{}")}catch{}}Me.current=we;return}const Ce=++yr.current,{data:ke,error:Oe}=await de.from("agendamento_participantes").select("id, agendamento_id, codigo_empresa, cliente_id, nome, valor_cota, status_pagamento, finalizadora_id, aplicar_taxa, ordem, is_representante, deleted_at, cliente:clientes!agendamento_participantes_cliente_id_fkey(nome, codigo)").in("agendamento_id",re).is("deleted_at",null).order("ordem",{ascending:!0}).order("id",{ascending:!0});if(yr.current!==Ce)return;if(Oe){console.warn("[Participants] load error",Oe),j("Participants:error",{message:Oe?.message,code:Oe?.code,status:Oe?.status}),S("parts:error",{code:Oe?.code});return}const oe={};for(const Ee of ke||[]){const Ie=Ee.agendamento_id;oe[Ie]||(oe[Ie]=[]);const tt=Ee.nome||(Array.isArray(Ee.cliente)?Ee.cliente[0]?.nome:Ee.cliente?.nome)||"",vt=(Array.isArray(Ee.cliente)?Ee.cliente[0]?.codigo:Ee.cliente?.codigo)||null;oe[Ie].push({...Ee,nome:tt,codigo:vt})}for(const Ee of re){const Ie=Array.isArray(oe[Ee])?oe[Ee].slice():[];Ie.sort((tt,vt)=>{const Rt=Number.isFinite(Number(tt?.ordem))?Number(tt.ordem):Number.MAX_SAFE_INTEGER,At=Number.isFinite(Number(vt?.ordem))?Number(vt.ordem):Number.MAX_SAFE_INTEGER;return Rt!==At?Rt-At:String(tt?.id||"").localeCompare(String(vt?.id||""))}),oe[Ee]=Ie}j("Participants:loaded",{bookings:re.length,rows:(ke||[]).length}),S("parts:loaded",{rows:(ke||[]).length}),Me.current=we,Nt(Ee=>{const Ie={...Ee};for(const tt of re)Ie[tt]=oe[tt]||[];try{T&&localStorage.setItem(T,JSON.stringify(Ie))}catch{}return j("Participants:set state for ids",{ids:re}),S("parts:set",{idsCount:re.length}),Ie}),ae(Ee=>{const Ie=Ee||[];let tt=!1;const vt=Ie.map(Rt=>{const At=oe[Rt.id];if(Array.isArray(At)&&At.length>0){const Gt=(At.find(Bt=>Bt?.is_representante)||At[0])?.nome||"";if(Gt&&Gt!==Rt.customer)return tt=!0,{...Rt,customer:Gt}}return Rt});return tt?vt:Ee})})()},[R,A?.codigo_empresa,me,D,T,j]),p.useEffect(()=>{(async()=>{if(!(!R||!A?.codigo_empresa||!Dr.length)){B(!0);try{const re=cr(D,"yyyy-MM-dd"),we=D.getDay(),{data:Ce,error:ke}=await de.from("quadras_dias_funcionamento").select("*").eq("codigo_empresa",A.codigo_empresa).or(`and(tipo.eq.data_fechamento,data_fechamento.eq.${re}),and(tipo.eq.dia_semana,dia_semana.eq.${we})`);if(ke){console.error("Erro ao carregar dias de funcionamento:",ke);return}const Oe={};Dr.forEach(oe=>{const Ee=Ft[oe];if(!Ee)return;const Ie=Ce?.find(vt=>vt.quadra_id===Ee.id&&vt.tipo==="data_fechamento"&&vt.data_fechamento===re);if(Ie&&!Ie.funciona){Oe[oe]={funciona:!1,motivo:"data_especifica",observacao:Ie.observacao||"Fechamento especial"};return}const tt=Ce?.find(vt=>vt.quadra_id===Ee.id&&vt.tipo==="dia_semana"&&vt.dia_semana===we);tt?Oe[oe]={funciona:tt.funciona,motivo:tt.funciona?"normal":"dia_semana",observacao:tt.funciona?null:"Fechado neste dia da semana"}:Oe[oe]={funciona:!0,motivo:"normal",observacao:null}}),Se(Oe)}catch(re){console.error("Erro ao verificar dias de funcionamento:",re)}finally{B(!1)}}})()},[R,A?.codigo_empresa,D,Dr,Ft]),p.useEffect(()=>{if(!R||!A?.codigo_empresa||Dr.length===0)return;(async()=>{try{const re=new Date(D);re.setDate(re.getDate()-re.getDay());const{data:we,error:Ce}=await de.from("quadras_dias_funcionamento").select("*").eq("codigo_empresa",A.codigo_empresa);if(Ce){console.error("Erro ao carregar funcionamento da semana:",Ce);return}const ke={};for(let Oe=0;Oe<7;Oe++){const oe=new Date(re);oe.setDate(oe.getDate()+Oe);const Ee=cr(oe,"yyyy-MM-dd"),Ie=oe.getDay(),tt={};Dr.forEach(vt=>{const Rt=Ft[vt];if(!Rt)return;const At=we?.find(Bt=>Bt.quadra_id===Rt.id&&Bt.tipo==="data_fechamento"&&Bt.data_fechamento===Ee);if(At&&!At.funciona){tt[vt]={funciona:!1,motivo:"data_especifica",observacao:At.observacao||"Fechamento especial"};return}const Gt=we?.find(Bt=>Bt.quadra_id===Rt.id&&Bt.tipo==="dia_semana"&&Bt.dia_semana===Ie);Gt?tt[vt]={funciona:Gt.funciona,motivo:Gt.funciona?"normal":"dia_semana",observacao:Gt.funciona?null:"Fechado neste dia da semana"}:tt[vt]={funciona:!0,motivo:"normal",observacao:null}}),ke[Ee]=tt}pe(ke)}catch(re){console.error("Erro ao carregar funcionamento da semana:",re)}})()},[R,A?.codigo_empresa,D,Dr,Ft]),p.useEffect(()=>{Object.values(ye).some(re=>!re.funciona)&&ar.current},[ye]),p.useEffect(()=>{if(nt)try{const G=JSON.parse(localStorage.getItem($t)||"[]");Array.isArray(G)&&G.length&&(!zt||zt.length===0)&&(Mt(G),nr(!1))}catch{}},[nt,$t]),p.useEffect(()=>{const G=async()=>{if(!A?.codigo_empresa)return;try{localStorage.getItem("debug:agenda")==="1"&&console.log("[Agenda][Courts] loadCourts:start",{empresa:A.codigo_empresa,hasCache:!!localStorage.getItem($t)})}catch{}try{const ke=JSON.parse(localStorage.getItem($t)||"[]");if(Array.isArray(ke)&&ke.length>0){const Oe=ke[0]?.codigo_empresa;if(Oe&&Oe!==A.codigo_empresa){console.warn(" [Cache Limpo] Quadras de outra empresa detectadas e removidas"),localStorage.removeItem($t),localStorage.removeItem(Kt),Mt([]);try{Tn([])}catch{}try{Jr(null)}catch{}try{setForm(oe=>({...oe,court:""}))}catch{}}}}catch{}(!zt||zt.length===0)&&nr(!0);const{data:re,error:we}=await de.from("quadras").select("id, nome, modalidades, hora_inicio, hora_fim, valor, codigo_empresa, status").eq("codigo_empresa",A.codigo_empresa).eq("status","Ativa").order("nome",{ascending:!0});if(we){console.error("Erro ao buscar quadras:",we),Dn.current?nr(!1):(Dn.current=!0,setTimeout(G,900));try{localStorage.getItem("debug:agenda")==="1"&&console.warn("[Agenda][Courts] loadCourts:error",{empresa:A.codigo_empresa,message:we?.message,code:we?.code})}catch{}return}const Ce=re||[];if(Ce.length===0){let ke=0;try{const Oe=JSON.parse(localStorage.getItem("quadras:list")||"[]");ke=Array.isArray(Oe)?Oe.length:0}catch{}if(ke>0&&!Dn.current){Dn.current=!0,nr(!1),setTimeout(G,700);return}}Dn.current=!1,Mt(Ce);try{localStorage.setItem($t,JSON.stringify(Ce))}catch{}nr(!1);try{localStorage.getItem("debug:agenda")==="1"&&console.log("[Agenda][Courts] loadCourts:done",{empresa:A.codigo_empresa,count:Array.isArray(Ce)?Ce.length:0})}catch{}};R&&A?.codigo_empresa&&G()},[R,A?.codigo_empresa,$t,Kt]),p.useEffect(()=>{try{if(ir)return;const G=Dr||[];form?.court&&!G.includes(form.court)&&setForm(re=>({...re,court:G[0]||""})),(!form?.court||form.court==="")&&G.length>0&&setForm(re=>({...re,court:G[0]}))}catch{}},[ir,Dr,A?.codigo_empresa]),p.useEffect(()=>{if(ir)return;const G=(()=>{try{return JSON.parse(localStorage.getItem(Kt)||"[]")}catch{return[]}})(),re=(()=>{try{return JSON.parse(localStorage.getItem(sr)||"{}")}catch{return{}}})(),we=G.filter(Ce=>Dr.includes(Ce));we.length>0?Tn(we):Fr.length===0&&Tn(Dr),re&&typeof re=="object"&&Qe(Ce=>({...Ce,canceledOnly:!1,...re}))},[ir,Dr.length]),p.useEffect(()=>{try{localStorage.setItem(Kt,JSON.stringify(Fr))}catch{}},[Fr,Kt]),p.useEffect(()=>{try{localStorage.setItem(sr,JSON.stringify(he))}catch{}},[he,sr]);const Es=p.useMemo(()=>{const G=Fr.map(we=>Ft[we]?.hora_inicio||"06:00:00").map(we=>{const[Ce,ke]=String(we).split(":").map(Number);return(Ce||0)*60+(ke||0)});if(!G.length)return a3;const re=Math.min(...G);return Math.floor(re/60)},[Fr,Ft]),po=p.useMemo(()=>{const G=Fr.map(we=>Ft[we]?.hora_fim||"24:00:00").map(we=>{const[Ce,ke]=String(we).split(":").map(Number);return(Ce===0&&ke===0?24:Ce||0)*60+(ke||0)});if(!G.length)return wae;const re=Math.max(...G);return Math.ceil(re/60)},[Fr,Ft]);p.useEffect(()=>{const G=new Date,re=Iu(G),we=Ou(G);setTimeout(()=>{if(!ar.current)return;const ke=Math.max(0,(re-Es)*60+we)/Pa;ar.current.scrollTop=Math.max(0,ke*Ti-120)},150)},[Es]);const L=({booking:G,courtGridStart:re,courtGridEnd:we})=>{const Ce=Ti,ke=ma=>{const Co=Iu(ma),Js=Ou(ma);return Co===0&&Js===0?1440:Co*60+Js},Oe=ke(G.start),oe=ke(G.end),Ee=re!==void 0?re:St?ve.start*60:Es*60,Ie=we!==void 0?we:St?ve.end*60:po*60,tt=Oe-Ee,vt=(Ie-Ee)/Pa;let Rt=Math.floor(tt/Pa);const At=Math.max(0,oe-Oe),Gt=Math.max(1,Math.ceil(At/Pa));let Bt=Rt+Gt;Rt=Math.max(0,Math.min(Rt,vt-1)),Bt=Math.max(0,Math.min(Bt,vt)),Bt<=Rt&&(Bt=Rt+1),Bt=Math.min(Bt,vt);const Ht=Rt*Ce;let jr=(Bt-Rt)*Ce;const vr=di[G.status]||di.confirmed,xn=vr.icon,Kn=vr.border,Un=Gt===1,Er=Un?4:lZe,Br=Ht+Er,zr=Math.max(Un?40:32,jr-Er*2),en=At>=90,cn=2,mr=1.15,Ur=en?(()=>{const ma=Math.min(Math.max((At-90)/90,0),1);return Math.min(mr+ma*(cn-mr),cn)})():1,gr=16,_r=14,Xt=Un?16:24,Lr=Math.round(gr*(en?Ur:1)),br=Math.round(_r*(en?Ur:1)),Gr=Math.round(Xt*(en?Ur:1)),yn=Un?12:16,Zr=Un?12:16,kn=en?Math.min(Ur,1.3):1,ya=Math.round(yn*kn),Ca=Math.round(Zr*kn),ks=tr[G.id]||[],es=ks.filter(ma=>String(ma.status_pagamento||"").toLowerCase()==="pago").length,ka=ks.length;return a.jsxs(xr.div,{layout:Ze?!1:"position",initial:Ze?!1:{opacity:0,y:6},animate:Ze?!1:{opacity:1,y:0},exit:Ze?!1:{opacity:0,y:6},id:`booking-${G.id}`,className:pr("absolute left-2 right-2 rounded-md border-2 bg-surface text-sm shadow-sm z-0 cursor-pointer",Kn,"overflow-hidden transition-all duration-150 hover:bg-surface-2 hover:shadow-md"),style:{top:`${Br}px`,height:`${zr}px`},onClick:async()=>{const ma=Qc(G),Co=new Promise(Us=>setTimeout(Us,600));let Js=null;try{Js=await Promise.race([ma,Co])}catch{}const Is=Js&&Js.booking||me.find(Us=>Us.id===G.id)||G;try{const Us=tr[G.id]||[];console.log("[ORDER:CLICK] booking",{id:G.id,customer:Is?.customer||G.customer,partsCount:Us.length}),Us.length>0&&console.table(Us.map((Zc,pm)=>({idx:pm+1,ordem:Zc?.ordem,nome:Zc?.nome,cliente_id:Zc?.cliente_id}))),console.log("[ORDER:CLICK] agendamento.clientes",Is?.clientes??"(sem campo clientes)")}catch{}or(Is),pt()},children:[a.jsx("div",{className:pr("absolute left-0 top-0 h-full w-[6px] rounded-l-md",vr.accent)}),a.jsx("div",{className:pr("h-full flex",Un?"px-3 py-3":"px-4 py-4"),style:{paddingLeft:ya,paddingRight:ya,paddingTop:Ca,paddingBottom:Ca},children:a.jsxs("div",{className:"flex-1 flex flex-col justify-center",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[a.jsx("p",{className:"font-semibold text-text-primary truncate text-base",style:{fontSize:Lr,lineHeight:1.15},children:Q9(G.customer)}),Un&&a.jsx("span",{className:"text-xs font-bold text-white truncate bg-gradient-to-r from-slate-700 to-slate-800 border border-slate-600/60 rounded-md px-2 py-0.5 whitespace-nowrap shadow-md",style:{fontSize:br},children:G.modality})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsxs("span",{className:pr("text-text-muted font-semibold text-base whitespace-nowrap"),style:{fontSize:Lr},children:[cr(G.start,"HH:mm"),"",cr(G.end,"HH:mm")]}),Un&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(xn,{className:pr(vr.text),style:{width:Gr,height:Gr}}),a.jsx("span",{className:pr("truncate font-semibold",vr.text,"text-base"),style:{fontSize:Lr},children:vr.label})]}),Un&&ka>0&&a.jsxs("span",{className:`text-xs font-semibold rounded-full px-2 py-0.5 border ${es===ka?"text-emerald-300 bg-emerald-500/10 border-emerald-400/30":"text-amber-300 bg-amber-500/10 border-amber-400/30"}`,style:{fontSize:Math.max(11,Math.round(11*(en?Ur:1)))},children:[es,"/",ka]})]}),a.jsxs("div",{className:"mt-1 flex items-center justify-between gap-2 flex-wrap",children:[!Un&&a.jsx("span",{className:"text-xs font-bold text-white truncate bg-gradient-to-r from-slate-700 to-slate-800 border border-slate-600/60 rounded-md px-2.5 py-1 shadow-md",style:{fontSize:br},children:G.modality}),!Un&&a.jsxs("div",{className:"flex items-center gap-1.5 text-base flex-wrap justify-end",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(xn,{className:pr(vr.text),style:{width:Gr,height:Gr}}),a.jsx("span",{className:pr("truncate font-semibold",vr.text),style:{fontSize:Lr},children:(()=>typeof window<"u"&&window.innerWidth<768&&G.status==="in_progress"?"Andamento":vr.label)()})]}),ka>0&&(()=>{const ma=typeof window<"u"&&window.innerWidth<768;return a.jsxs("span",{className:pr("font-bold rounded-full border flex items-center gap-1 whitespace-nowrap",Un?"px-2 py-0.5 text-xs":"px-2.5 py-1 text-sm",es===ka?"text-emerald-300 bg-emerald-500/10 border-emerald-400/30":"text-amber-300 bg-amber-500/10 border-amber-400/30"),style:{fontSize:Math.max(Un?11:13,Math.round((Un?11:13)*(en?Ur:1)))},children:[a.jsx(ei,{className:"w-3 h-3 flex-shrink-0"}),a.jsxs("span",{className:"whitespace-nowrap",children:[es,"/",ka,ma?"":" pagos"]})]})})()]})]})]})})]})},ge=()=>{p.useRef(Math.random().toString(36).slice(2)),hN();const G=p.useRef(0),re=p.useRef(""),we=De=>{if(!De)return"";if(typeof De=="string")return De;const ft=De.nome||De.name||"",Ot=De.codigo??De.code;return Ot!=null?`[${Ot}] ${ft}`:ft},Ce=De=>De?typeof De=="string"?De:De.nome||De.name||"":"",ke=De=>{const ft=Ft[De];if(!ft)return{start:Es*60,end:po*60};const[Ot,Lt]=String(ft.hora_inicio||"06:00:00").split(":").map(Number),[Yt,Pr]=String(ft.hora_fim||"24:00:00").split(":").map(Number),Wr=Yt===0&&Pr===0?24:Yt;return{start:Ot*60+(Lt||0),end:Wr*60+(Pr||0)}},Oe=()=>{const De=Iu(new Date),ft=Ou(new Date),Ot=De*60+ft,Lt=Dr[0]||"",Yt=ke(Lt);return Math.max(Yt.start,Math.min(Yt.end-Pa,Math.round(Ot/Pa)*Pa))},[oe,Ee]=p.useState(()=>{let De=[];try{if(Array.isArray(Gr)&&Gr.length>0?De=Gr:Array.isArray(Xt.current)&&Xt.current.length>0&&(De=Xt.current),De.length>0)try{tt.current=!0}catch{}}catch{}return{selectedClients:De,court:(()=>Dr.find(Lt=>!ye[Lt]||ye[Lt].funciona)||Dr[0]||"")(),modality:pp[0],status:"scheduled",date:D,startMinutes:Oe(),endMinutes:Oe()+60}}),Ie=p.useRef([]),tt=p.useRef(!1),vt=p.useRef(null);p.useEffect(()=>{Ie.current=Array.isArray(oe.selectedClients)?oe.selectedClients:[];try{(Ie.current||[]).length>0&&(tt.current=!0)}catch{}},[oe.selectedClients]);const[Rt,At]=p.useState(!1),[Gt,Bt]=p.useState(""),Ht=p.useRef(""),jr=p.useRef(""),vr=p.useCallback(De=>{try{Ht.current=String(De||""),jr.current=new Error("selectedClients:set").stack||""}catch{}},[]),xn=p.useRef(!1);p.useEffect(()=>{try{if(!Ze||!ze?.id||xn.current)return;const De=tr[ze.id]||[];if(!Array.isArray(De)||De.length===0)return;const ft=De.map(Yt=>({id:Yt.cliente_id,nome:Yt.nome,codigo:Yt.codigo??null})),Ot=Array.isArray(oe.selectedClients)?oe.selectedClients:[];if(!(Ot.length===ft.length&&Ot.every((Yt,Pr)=>Yt&&ft[Pr]&&Yt.id===ft[Pr].id))){try{vr("edit:apply-from-participants")}catch{}Ee(Yt=>({...Yt,selectedClients:ft}));try{Xt.current=ft}catch{}try{Zr(ft)}catch{}try{tt.current=!0}catch{}try{Mr.current=Date.now()+1500}catch{}try{console.log("[ORDER:OPEN_MODAL] chips (aplicados)",ft.map(Yt=>Yt.nome)),console.table(De.map((Yt,Pr)=>({idx:Pr+1,ordem:Yt?.ordem,nome:Yt?.nome,cliente_id:Yt?.cliente_id})))}catch{}}xn.current=!0}catch{}},[Ze,ze?.id,tr]),p.useEffect(()=>{try{if(!Ze)return;const De=Array.isArray(oe.selectedClients)?oe.selectedClients:[];if(De.length>0&&console.log("[ORDER:CHIPS] atual:",De.map(ft=>ft.nome)),ze?.id){const ft=Array.isArray(tr?.[ze.id])?tr[ze.id]:[],Ot=ft.map(Pr=>String(Pr?.cliente_id??"")),Lt=De.map(Pr=>String(Pr?.id??""));if(Ot.length>0&&Ot.join("|")!==Lt.join("|")){console.warn("[ORDER:CHIPS][MISMATCH]",{bookingId:ze.id,ref:ft.map(Pr=>({ordem:Pr?.ordem,nome:Pr?.nome,id:Pr?.cliente_id})),cur:De.map((Pr,Wr)=>({idx:Wr+1,nome:Pr?.nome,id:Pr?.id})),lastReason:Ht.current});try{console.warn(jr.current)}catch{}}}}catch{}},[Ze,oe.selectedClients,ze?.id,tr]);const[Kn,Un]=p.useState(0),Ir=p.useRef(0),Er=p.useRef(!1);p.useEffect(()=>{const De=()=>{try{if(document.visibilityState==="hidden"){Er.current=!!(er||Rt);const ft=Date.now();try{Mr.current=ft+1200}catch{}try{It.current=ft+1200}catch{}try{Ir.current=ft+800}catch{}}else if(document.visibilityState==="visible"){const ft=Er.current;Er.current=!1;const Ot=Date.now();try{Mr.current=Math.max(Mr.current||0,Ot+600)}catch{}try{It.current=Math.max(It.current||0,Ot+600)}catch{}try{Ir.current=Math.max(Ir.current||0,Ot+400)}catch{}ft&&!dt.current&&setTimeout(()=>{dt.current||(At(!0),ln(!0))},60)}}catch{}};return document.addEventListener("visibilitychange",De),()=>document.removeEventListener("visibilitychange",De)},[er,Rt,Ze]),p.useEffect(()=>{},[Rt,er]);const Br=p.useRef(0);p.useEffect(()=>{const De=Array.isArray(oe.selectedClients)?oe.selectedClients.length:-1,ft=Br.current;De!==ft&&(Br.current=De)},[oe.selectedClients,Rt,er]);const[zr,en]=p.useState(!1),[cn,mr]=p.useState(null),[Ur,gr]=p.useState(!1),_r=p.useRef(!1),Xt=p.useRef([]),Lr=p.useRef("init"),br=p.useRef(!1),[Gr,yn]=p.useState([]),Zr=p.useCallback(De=>{yn(De)},[]),kn=p.useRef(null),ya=p.useRef(null),Ca=p.useRef([]);p.useEffect(()=>{er&&Ca.current[Kn]&&Ca.current[Kn]?.scrollIntoView({behavior:"smooth",block:"nearest"})},[Kn,er]),p.useEffect(()=>{er&&Un(0)},[er]);const[ks,es]=p.useState(!1),[ka,ma]=p.useState(!1);p.useState(!1);const[Co,Js]=p.useState(!1);p.useEffect(()=>{if(!s)return;let De=!1;return(async()=>{try{if(!R||!A?.codigo_empresa)return;const ft=await th({somenteAtivas:!0,codigoEmpresa:A.codigo_empresa});De||b(Array.isArray(ft)?ft:[])}catch{}})(),()=>{De=!0}},[s,R,A?.codigo_empresa]),p.useEffect(()=>{if(!s||!Array.isArray(x)||x.length===0)return;const De=String(x[0].id);v(ft=>ft.length===0&&Array.isArray(oe.selectedClients)&&oe.selectedClients.length>0?oe.selectedClients.map(Yt=>({cliente_id:Yt.id,nome:Yt.nome,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:De})):ft.map(Lt=>({...Lt,finalizadora_id:Lt.finalizadora_id&&Lt.finalizadora_id!==""?Lt.finalizadora_id:De})))},[s,x]);const Is=p.useCallback((De,ft)=>{try{const Ot=Date.now(),Lt=Ot<(nn.current||0)||Ot<(It.current||0),Yt=!er,Pr=!!br.current;let Wr=Array.isArray(ft)?ft:[];if(Wr.length===0&&Yt&&Lt&&!Pr){const Vr=Array.isArray(Xt.current)?Xt.current:[];Vr.length>0&&(Wr=Vr)}try{if(!ze&&Array.isArray(Wr)&&Wr.length>0&&vt.current){const Vr=Wr.findIndex(Wn=>Wn&&Wn.id===vt.current);Vr>0&&(Wr=[Wr[Vr],...Wr.filter((Na,ia)=>ia!==Vr)])}}catch{}try{vr(`applySelectedClients:${De}`)}catch{}Ee(Vr=>({...Vr,selectedClients:Wr})),Array.isArray(Wr)&&Wr.length>0&&(Xt.current=Wr,Zr(Wr),br.current=!1);try{Lr.current=De}catch{}}catch{}},[er,Ee,Zr]);p.useState(""),p.useRef(null),p.useEffect(()=>{try{rr.current=Date.now()}catch{}},[Rt,ka]),p.useEffect(()=>{if(w){if(hr.current=Rt,Rt)P("customer-picker",6e3),S("picker:open"),dr.current=!0,ln(!0);else if(S("picker:close"),C("picker-close"),oi.current){oi.current=!1;try{j("Picker closed: flushing pending refresh"),S("picker:flush"),zs()}catch{}}}},[Rt]);const Us=p.useCallback((De,ft={})=>{if(w)try{const Ot=new Date().toISOString(),Lt=ut.current,Yt=!!dr.current,Pr=!!_r.current}catch{}},[w,Ze,Rt,er,ka,zr]);p.useEffect(()=>{w&&Us("state-change",{isCustomerPickerOpen:Rt,effectiveCustomerPickerOpen:er})},[w,Rt,er]),p.useEffect(()=>{if(!Ze||er)return;const De=Array.isArray(oe.selectedClients)?oe.selectedClients:[],ft=Array.isArray(Xt.current)?Xt.current:[],Ot=Date.now()<(Mr.current||0);if(De.length===0&&ft.length>0&&!br.current&&Ot)Lr.current="global:restore",Ee(Lt=>({...Lt,selectedClients:ft}));else if(De.length===0&&ft.length>0&&br.current&&!Ot)try{Xt.current=[]}catch{}},[Ze,er,oe.selectedClients]),p.useEffect(()=>{if(!Ze)return;let De=dr.current;try{const Ot=localStorage.getItem("agenda:customerPicker:desiredAt");if(Ot){const Lt=Number(Ot);Number.isFinite(Lt)&&Date.now()-Lt<3e3&&(De=!0)}}catch{}if(!De||Rt||Date.now()<It.current||et())return;const ft=Date.now();ft-ur.current<800||(ur.current=ft,ut.current="open",At(!0),ln(!0))},[Rt,Ze]),p.useEffect(()=>{const De=Array.isArray(oe.selectedClients)?oe.selectedClients:[];De.length>0&&(Xt.current=De,Zr(De))},[oe.selectedClients]),p.useEffect(()=>{if(!Ze||er||dr.current)return;const De=Array.isArray(oe.selectedClients)?oe.selectedClients:[],ft=(()=>{const Ot=Array.isArray(Xt.current)?Xt.current:[];return Ot&&Ot.length>0?Ot:[]})();De.length===0&&ft.length>0&&!br.current&&(Ee(Ot=>({...Ot,selectedClients:ft})),_r.current=!1)},[er,Ze]);const Zc=p.useRef(0);p.useEffect(()=>{try{const De=Date.now(),ft=Array.isArray(Ie.current)?Ie.current:[],Ot=Array.isArray(Xt.current)?Xt.current:[];if(De-Zc.current>300&&(Zc.current=De),Ze&&!er&&ft.length===0&&Ot.length>0&&!br.current){try{nn.current=Date.now()+2e3}catch{}try{const Lt=It?.current||0,Yt={ts:new Date().toISOString(),reason:"empty-after-close",modalOpen:Ze,pickerOpen:er,formLen:Array.isArray(oe?.selectedClients)?oe.selectedClients.length:NaN,curLen:ft.length,lastLen:Ot.length,clearedByUser:!!br?.current,lastAction:Lr?.current,chipsLen:Array.isArray(Gr)?Gr.length:NaN,clientsLoading:!!ka,suppressUntil:Lt}}catch{}Zr(Ot),Ee(Lt=>({...Lt,selectedClients:[...Ot]}));try{Promise.resolve().then(()=>{Ee(Lt=>({...Lt,selectedClients:[...Xt.current]}))})}catch{}try{requestAnimationFrame(()=>{Ee(Lt=>({...Lt,selectedClients:[...Xt.current||[]]}))})}catch{}setTimeout(()=>{const Lt=Array.isArray(Ie.current)?Ie.current:[],Yt=Array.isArray(Xt.current)?Xt.current:[];Lt.length===0&&Yt.length>0&&Ee(Pr=>({...Pr,selectedClients:[...Yt]}))},25),setTimeout(()=>{const Lt=Array.isArray(Ie.current)?Ie.current:[],Yt=Array.isArray(Xt.current)?Xt.current:[];Lt.length===0&&Yt.length>0&&Ee(Pr=>({...Pr,selectedClients:[...Yt]}))},120),setTimeout(()=>{const Lt=Array.isArray(Ie.current)?Ie.current:[],Yt=Array.isArray(Xt.current)?Xt.current:[];Lt.length===0&&Yt.length>0&&Ee(Pr=>({...Pr,selectedClients:[...Yt]}))},240)}}catch{}},[oe.selectedClients,er,Ze]),p.useEffect(()=>{try{const De=now<(nn.current||0),ft=Array.isArray(Ie.current)?Ie.current:[],Ot=Array.isArray(Xt.current)?Xt.current:[],Lt=now<(Mr.current||0);if(Ze&&!er&&(De||Lt)&&ft.length===0&&Ot.length>0&&!br.current){yn(Ot),Ee(Yt=>({...Yt,selectedClients:[...Ot]}));try{requestAnimationFrame(()=>Ee(Yt=>({...Yt,selectedClients:[...Xt.current||[]]})))}catch{}setTimeout(()=>Ee(Yt=>({...Yt,selectedClients:[...Xt.current||[]]})),32),setTimeout(()=>Ee(Yt=>({...Yt,selectedClients:[...Xt.current||[]]})),96)}}catch{}},[oe.selectedClients,er,Ze]),p.useEffect(()=>{Date.now()<(jt.current||0)},[oe.selectedClients,Ze,er]);const[pm,np]=p.useState([]);p.useEffect(()=>{s&&np([])},[s]);const Uo=p.useRef(!1),go=p.useRef(!1),[Cu,Bl]=p.useState(null);p.useState(null);const ll=p.useRef(!1);p.useEffect(()=>{const De=Array.isArray(oe.selectedClients)?oe.selectedClients:[],ft=Cu,Ot=ft&&De.some(Lt=>Lt&&Lt.id===ft);if(De.length>0&&!Ot){let Lt=De[0]?.id||null;try{if(ze?.id){const Yt=tr?.[ze.id]||[],Pr=Array.isArray(Yt)?Yt.find(Wr=>Wr?.is_representante===!0):null;Pr?.cliente_id&&De.some(Wr=>String(Wr?.id)===String(Pr.cliente_id))&&(Lt=Pr.cliente_id)}}catch{}Bl(Lt)}else De.length===0&&ft&&Bl(null)},[oe.selectedClients,Ze,ze,tr]);const ql=p.useRef(!1),Vo=p.useRef(!1),[ys,Ia]=p.useState(st),Ka=p.useRef(0);p.useEffect(()=>{if(!(Date.now()<(jt.current||0)))if(ka){Ka.current||(Ka.current=Date.now());const ft=setTimeout(()=>{ka&&(!Array.isArray(ys)||ys.length===0)&&ma(!1)},2e3);return()=>clearTimeout(ft)}else Ka.current=0},[ka,ys]);const us=p.useMemo(()=>Array.isArray(oe.selectedClients)?oe.selectedClients:[],[oe.selectedClients]),vo=p.useMemo(()=>{const De=us||[];if(De.length===0)return"Adicionar clientes";const ft=De[0]?.nome||"Cliente",Ot=De.length-1;return Ot>0?`${ft} +${Ot}`:ft},[us]),ed=p.useMemo(()=>{const De=Array.isArray(oe.selectedClients)?oe.selectedClients:[],ft=Array.isArray(Ie.current)?Ie.current:[],Ot=Array.isArray(Xt.current)?Xt.current:[],Lt=Array.isArray(Gr)?Gr:[];return De.length>0&&De.every(Yt=>Yt?.nome)?De:De.length>0?De.map(Yt=>{if(Yt?.nome)return Yt;const Pr=ft.find(Na=>Na?.id===Yt?.id),Wr=Ot.find(Na=>Na?.id===Yt?.id),Vr=Lt.find(Na=>Na?.id===Yt?.id),Wn=(ys||[]).find(Na=>Na?.id===Yt?.id);return{...Yt,nome:Pr?.nome||Wr?.nome||Vr?.nome||Wn?.nome||Yt?.nome||"Cliente"}}):ft.length>0&&ft.every(Yt=>Yt?.nome)?ft:Lt.length>0&&Lt.every(Yt=>Yt?.nome)?Lt:Ot.length>0&&Ot.every(Yt=>Yt?.nome)?Ot:De},[oe.selectedClients,Gr,ys]),ap=!!(Ze&&ze?.id&&!(Array.isArray(tr?.[ze.id])&&tr[ze.id].length>0));p.useEffect(()=>{if(!(Date.now()<(jt.current||0)))try{j("Chips:effective change",{effectiveLen:Array.isArray(us)?us.length:0,formLen:Array.isArray(oe.selectedClients)?oe.selectedClients.length:0,lastLen:Array.isArray(Xt.current)?Xt.current.length:0,pickerOpen:Rt})}catch{}},[us,oe.selectedClients,Rt]);const Pu=p.useRef(null),gm=p.useRef(!1);p.useEffect(()=>{if(Ze){Array.isArray(st)&&st.length>0&&Ia(st);try{if(!ys||ys.length===0){const De=A?.codigo_empresa?`clientes:list:${A.codigo_empresa}`:null;if(De){const ft=JSON.parse(localStorage.getItem(De)||"[]");Array.isArray(ft)&&ft.length>0&&Ia(ft)}}}catch{}}},[Ze,st]),p.useEffect(()=>{Ze||(Pu.current=null,ma(!1))},[Ze]),p.useEffect(()=>{Ze||(Uo.current=!1,go.current=!1,Js(!1),Vo.current=!1)},[Ze]);const Gg=p.useRef(!1);p.useEffect(()=>{if(Ze&&!Gg.current?Gg.current=!0:!Ze&&Gg.current,ze)Au.current=!1;else{if(Au.current)return;Au.current=!0;try{if(Date.now()<(G.current||0))return}catch{}try{dr.current=!1,localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{br.current=!1}catch{}try{try{Xt.current=[]}catch{}try{yn([])}catch{}Ee(De=>({...De,selectedClients:[]}))}catch{}}},[Ze,ze]);const Au=p.useRef(!1);p.useEffect(()=>{if(!Ze){Au.current=!1;try{re.current="";try{Xt.current=[]}catch{}try{yn([])}catch{}try{tt.current=!1}catch{}try{G.current=0}catch{}try{Mr.current=0}catch{}be(!1),Ge(4);try{It.current=0}catch{}try{ut.current=null}catch{}try{dr.current=!1}catch{}Ee(De=>({...De,selectedClients:[]})),Bl(null)}catch{}return}if(ze)Au.current=!1;else{if(Au.current)return;Au.current=!0;try{if(Date.now()<(G.current||0))return}catch{}try{dr.current=!1,localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{br.current=!1}catch{}try{try{Xt.current=[]}catch{}try{yn([])}catch{}Ee(De=>({...De,selectedClients:[]}))}catch{}}},[Ze,ze]);const qd=p.useCallback(async(De={})=>{const{autoSave:ft=!1}=De;if(!Co){Js(!0);try{const Ot=Ft[oe.court];if(!Ot){t({title:"Selecione uma quadra",variant:"destructive"}),Uo.current=!1,go.current=!1;return}const Lt=oe.startMinutes,Yt=oe.endMinutes;if(!(Number.isFinite(Lt)&&Number.isFinite(Yt)&&Yt>Lt)){t({title:"Horrio invlido",variant:"destructive"}),Uo.current=!1,go.current=!1;return}if(!zd(Lt,Yt)){t({title:"Conflito de horrio",description:"O horrio selecionado est ocupado.",variant:"destructive"}),Uo.current=!1,go.current=!1;return}const Wr=(Ma,rs)=>new Date(Ma.getFullYear(),Ma.getMonth(),Ma.getDate(),Math.floor(rs/60),rs%60,0,0),Vr=Wr(oe.date,Lt),Wn=Wr(oe.date,Yt);let Na=Array.isArray(oe.selectedClients)&&oe.selectedClients.length>0?oe.selectedClients:Array.isArray(Ie.current)?Ie.current:[];if((!Na||Na.length===0)&&ze?.id)try{const Ma=Array.isArray(Xt.current)?Xt.current:[];Ma&&Ma.length>0&&(Na=Ma,Ee(rs=>({...rs,selectedClients:Ma})))}catch{}const ia=[...Na];console.log(" [FIX] selNowSnapshot criado:",ia.length,"participantes"),console.log(" [FIX] form.selectedClients:",oe.selectedClients?.length||0),console.log(" [FIX] editingBooking.id:",ze?.id),console.log(" [LOG 3 - FECHAR MODAL AGENDAMENTO] Estado ao salvar:"),console.log("   Participantes selecionados:",ia.length),ia.forEach((Ma,rs)=>{console.log(`   #${rs+1}: ${Ma.nome}`)}),console.log("   participantsForm (contexto):",(m||[]).length),(m||[]).forEach((Ma,rs)=>{console.log(`   #${rs+1}: ${Ma.nome} | Status: ${Ma.status_pagamento} | Valor: ${Ma.valor_cota}`)});let jn=ia,Po=!1,li=!1;if(ze?.id){const rs=(tr[ze.id]||[]).map(fl=>String(fl?.cliente_id??"")),Pi=ia.map(fl=>String(fl?.id??"")),xo=rs.join("|"),ul=Pi.join("|");li=xo!==ul;const Ra=[...rs].sort().join("|"),ao=[...Pi].sort().join("|");Po=Ra!==ao,console.log(" [DEBUG] Comparao de ordem:"),console.log("   ordemAtual:",ul),console.log("   ordemBanco:",xo),console.log("   mudouOrdem:",li),console.log("   mudouParticipantes:",Po)}const Vi=Po||li;let td=0;(!Number.isFinite(td)||td<0||td>=(jn||[]).length)&&(td=0);const dl=jn[0],rd=jn.map(Ce).filter(Boolean);if(!ze?.id&&!dl?.id){t({title:"Selecione um cliente",description:"Para criar um agendamento, selecione pelo menos um cliente.",variant:"destructive"});return}if(ze?.id){const Ma=ze.status,rs=oe.status!==Ma,Pi={quadra_id:Ot.id,cliente_id:dl?.id??null,clientes:rd,inicio:Vr.toISOString(),fim:Wn.toISOString(),modalidade:oe.modality};if(!rs){let Vs=oe.status;try{const ga=fr(),ua=Vr.getTime();if(!!Le?.autoConfirmEnabled&&Number.isFinite(Number(Le?.autoConfirmMinutesBefore))){const ja=Number(Le.autoConfirmMinutesBefore)*6e4,ts=ua-ja;Vs==="confirmed"&&ga<ts?Vs="scheduled":Vs==="scheduled"&&ga>=ts&&(Vs="confirmed")}}catch{}Pi.status=Vs}const{error:xo}=await de.from("agendamentos").update(Pi).eq("codigo_empresa",A.codigo_empresa).eq("id",ze.id);if(xo)throw xo;const{data:ul}=await de.from("agendamento_participantes").select("*").eq("codigo_empresa",A.codigo_empresa).eq("agendamento_id",ze.id).is("deleted_at",null).order("ordem",{ascending:!0}).order("id",{ascending:!0}),Ra=ul||[],ao=(Ra||[]).some(Vs=>{const ga=Number(Vs?.valor_cota)||0,ua=Vs?.status_pagamento||"Pendente";return ga>0||ua==="Pago"});if(console.log(" [SAVE-BOOKING] houveMudancaDeParticipantes:",Po),console.log(" [SAVE-BOOKING] currentArray.length:",Ra.length),console.log(" [SAVE-BOOKING] selNowFinal.length:",jn.length),console.log(" [SAVE-BOOKING] hasPayments:",ao),Vi)if(!jn||jn.length===0)console.error(" [SAVE-BOOKING] PROTEO ACIONADA: No vou deletar participantes com selNowFinal vazio!"),console.error(" [SAVE-BOOKING] Isso evita perda de dados. Verifique por que selNowFinal est vazio.");else if(ao){try{const _n=(Ra||[]).map(ja=>ja?.id).filter(Boolean);if(_n.length>0){const{error:ja}=await de.from("agendamento_participantes").update({ordem:null,is_representante:!1}).in("id",_n).eq("codigo_empresa",A.codigo_empresa).eq("agendamento_id",ze.id).is("deleted_at",null);ja&&console.error("Erro ao liberar ordens antes do update (com pagamentos):",ja)}}catch(_n){console.error("Erro inesperado ao liberar ordens antes do update (com pagamentos):",_n)}const Vs=new Map;try{(Ra||[]).forEach(_n=>{const ja=String(_n?.cliente_id??""),ts=Vs.get(ja)||[];ts.push(_n),Vs.set(ja,ts)})}catch{}const ga=new Map,ua=new Set;for(let _n=0;_n<jn.length;_n++){const ja=jn[_n];if(!ja?.id)continue;const ts=String(ja.id),Ao=ga.get(ts)||0,Os=(Vs.get(ts)||[])[Ao]||null;if(ga.set(ts,Ao+1),Os?.id){ua.add(Os.id);const Ai={cliente_id:ja.id,nome:Os.nome??ja.nome,ordem:_n+1,is_representante:_n===td,deleted_at:null},{error:zl}=await de.from("agendamento_participantes").update(Ai).eq("id",Os.id).eq("codigo_empresa",A.codigo_empresa).eq("agendamento_id",ze.id);zl&&console.error("Erro ao atualizar participante (com pagamentos):",zl)}else{const Ai={codigo_empresa:A.codigo_empresa,agendamento_id:ze.id,cliente_id:ja.id,nome:ja.nome,ordem:_n+1,valor_cota:0,status_pagamento:"Pendente",finalizadora_id:null,aplicar_taxa:!1,pago_em:null,is_representante:_n===td,deleted_at:null},{error:zl}=await de.from("agendamento_participantes").insert([Ai]);zl&&console.error("Erro ao inserir participante (com pagamentos):",zl)}}try{const _n=(Ra||[]).filter(ja=>ja?.id&&!ua.has(ja.id)).map(ja=>ja.id);if(_n.length>0){const{error:ja}=await de.from("agendamento_participantes").update({deleted_at:new Date().toISOString(),is_representante:!1}).in("id",_n).eq("codigo_empresa",A.codigo_empresa).eq("agendamento_id",ze.id);ja&&console.error("Erro ao remover participantes (com pagamentos):",ja)}}catch{}}else{const Vs=Math.min(Ra.length,jn.length);try{const ga=(Ra||[]).map(ua=>ua?.id).filter(Boolean);if(ga.length>0){const{error:ua}=await de.from("agendamento_participantes").update({ordem:null,is_representante:!1}).in("id",ga).eq("codigo_empresa",A.codigo_empresa).eq("agendamento_id",ze.id).is("deleted_at",null);ua&&console.error("Erro ao liberar ordens antes do update:",ua)}}catch(ga){console.error("Erro inesperado ao liberar ordens antes do update:",ga)}try{await de.from("agendamento_participantes").update({is_representante:!1}).eq("codigo_empresa",A.codigo_empresa).eq("agendamento_id",ze.id).is("deleted_at",null)}catch{}for(let ga=0;ga<Vs;ga++){const ua=Ra[ga],_n=jn[ga];if(!ua?.id||!_n?.id)continue;const ja=String(ua.cliente_id)===String(_n.id),ts={cliente_id:_n.id,nome:_n.nome,ordem:ga+1,is_representante:!1,deleted_at:null};ja||(ts.valor_cota=0,ts.status_pagamento="Pendente",ts.finalizadora_id=null,ts.aplicar_taxa=!1,ts.pago_em=null);const{error:Ao}=await de.from("agendamento_participantes").update(ts).eq("id",ua.id).eq("codigo_empresa",A.codigo_empresa).eq("agendamento_id",ze.id);Ao&&console.error("Erro ao atualizar participante:",Ao)}if(jn.length<Ra.length){const ga=Ra.slice(jn.length).map(ua=>ua?.id).filter(Boolean);if(ga.length>0){const{error:ua}=await de.from("agendamento_participantes").update({deleted_at:new Date().toISOString(),is_representante:!1}).in("id",ga).eq("codigo_empresa",A.codigo_empresa).eq("agendamento_id",ze.id);ua&&console.error("Erro ao remover participantes:",ua)}}if(jn.length>Ra.length){const ga=Ra.length,ua=jn.slice(ga).map((_n,ja)=>({codigo_empresa:A.codigo_empresa,agendamento_id:ze.id,cliente_id:_n.id,nome:_n.nome,ordem:ga+ja+1,valor_cota:0,status_pagamento:"Pendente",finalizadora_id:null,aplicar_taxa:!1,pago_em:null,is_representante:!1,deleted_at:null}));if(ua.length>0){const{error:_n}=await de.from("agendamento_participantes").insert(ua);_n&&console.error("Erro ao inserir participantes:",_n)}}try{const ga=td+1;if(Number.isFinite(ga)&&ga>0){const{error:ua}=await de.from("agendamento_participantes").update({is_representante:!0}).eq("codigo_empresa",A.codigo_empresa).eq("agendamento_id",ze.id).eq("ordem",ga).is("deleted_at",null);ua&&console.error("Erro ao marcar representante:",ua)}}catch{}}const fl=dl?.nome||dl?.name||Ce(dl)||rd[0]||ze.customer,gf={...ze,court:oe.court,customer:fl,start:Vr,end:Wn,modality:oe.modality,...rs?{}:{status:Pi.status??oe.status}};if(ae(Vs=>Vs.map(ga=>ga.id===ze.id?gf:ga)),or(gf),rs)try{ht(!1),await hs(ze.id,oe.status,"user")}catch{}if(ft||t({title:"Agendamento atualizado"}),go.current=!0,Uo.current=!1,!ao||Vi){const Vs=new Map;try{(Ra||[]).forEach(_n=>{const ja=String(_n?.cliente_id??""),ts=Vs.get(ja)||[];ts.push(_n),Vs.set(ja,ts)})}catch{}const ga=new Map,ua=jn.map((_n,ja)=>{const ts=String(_n?.id??""),Ao=ga.get(ts)||0,Os=(Vs.get(ts)||[])[Ao]||null;ga.set(ts,Ao+1);const Ai=!!Os;return{cliente_id:_n.id,nome:_n.nome,codigo:_n.codigo||null,valor_cota:Ai?Os.valor_cota??0:0,status_pagamento:Ai?Os.status_pagamento??"Pendente":"Pendente",finalizadora_id:Ai?Os.finalizadora_id??null:null,aplicar_taxa:Ai?Os.aplicar_taxa??!1:!1,ordem:ja+1,is_representante:ja===td,deleted_at:null}});Nt(_n=>({..._n,[ze.id]:ua})),console.log(" [FIX] houveMudancaDeParticipantes =",Po),Po?(console.log(" [FIX] Mudana de participantes detectada - reconstruindo participantsForm"),v(ua.map(_n=>({cliente_id:_n.cliente_id,nome:_n.nome,codigo:_n.codigo,valor_cota:_n.valor_cota?hp(String(Number(_n.valor_cota).toFixed(2))):"",status_pagamento:_n.status_pagamento,finalizadora_id:_n.finalizadora_id?String(_n.finalizadora_id):x?.[0]?.id?String(x[0].id):null,aplicar_taxa:_n.aplicar_taxa})))):(console.log(" [FIX] Sem mudana de participantes - preservando dados de pagamento do contexto"),v(_n=>{const ja=Array.isArray(_n)?_n:[],ts=new Map;try{ja.forEach(Os=>{const Ai=String(Os?.cliente_id??""),zl=ts.get(Ai)||[];zl.push(Os),ts.set(Ai,zl)})}catch{}const Ao=new Map,ci=ua.map(Os=>{const Ai=String(Os?.cliente_id??""),zl=Ao.get(Ai)||0,Eu=(ts.get(Ai)||[])[zl]||null;return Ao.set(Ai,zl+1),Eu?{cliente_id:Os.cliente_id,nome:Eu.nome||Os.nome,codigo:Eu.codigo??Os.codigo,valor_cota:Eu.valor_cota||Os.valor_cota,status_pagamento:Eu.status_pagamento||Os.status_pagamento,finalizadora_id:Eu.finalizadora_id??Os.finalizadora_id,aplicar_taxa:Eu.aplicar_taxa??Os.aplicar_taxa}:Os});return console.log(" [FIX] Dados de pagamento preservados:",ci),ci.length>0?ci:ua})),console.log(" [LOG 3 - RESULTADO FINAL] participantsForm aps atualizao:"),console.log("   Total:",ua.length),ua.forEach((_n,ja)=>{console.log(`   #${ja+1}: ${_n.nome} | Status: ${_n.status_pagamento} | Valor: ${_n.valor_cota}`)})}if(r().catch(Vs=>{console.error("[AgendaPage] Erro ao recarregar alertas:",Vs)}),!ft){try{Xt.current=[]}catch{}try{yn([])}catch{}ht(!1)}return}let xm=null;try{const{data:Ma}=await de.from("agendamentos").select("id, status, codigo").eq("codigo_empresa",A.codigo_empresa).eq("quadra_id",Ot.id).eq("inicio",Vr.toISOString()).eq("fim",Wn.toISOString()).limit(1);Array.isArray(Ma)&&Ma.length>0&&(xm=Ma[0])}catch{}if(xm?.id&&xm.status!=="canceled"){const Ma={id:xm.id,code:xm.codigo,court:oe.court,customer:dl?.nome||rd[0]||"",start:Vr,end:Wn,status:oe.status,modality:oe.modality};ae(rs=>rs.some(xo=>xo.id===xm.id)?rs:[...rs,Ma]),t({title:"Agendamento confirmado"}),go.current=!0,ht(!1);return}if(Wt&&wt>1){const Ma=[],rs=[];for(let Ra=0;Ra<wt;Ra++){const ao=Ta(oe.date,Ra*7),fl=new Date(ao);fl.setHours(Math.floor(oe.startMinutes/60),oe.startMinutes%60,0,0);const gf=new Date(ao);gf.setHours(Math.floor(oe.endMinutes/60),oe.endMinutes%60,0,0),Ma.push({codigo_empresa:A.codigo_empresa,quadra_id:Ot.id,cliente_id:dl?.id??null,clientes:rd,inicio:fl.toISOString(),fim:gf.toISOString(),modalidade:oe.modality,status:oe.status})}const{data:Pi,error:xo}=await de.from("agendamentos").insert(Ma).select("id, codigo, inicio, fim");if(xo)throw xo;const ul=[];for(const Ra of Pi){const ao=jn.map((fl,gf)=>({codigo_empresa:A.codigo_empresa,agendamento_id:Ra.id,cliente_id:fl.id,nome:fl.nome,valor_cota:0,status_pagamento:"Pendente",ordem:gf+1}));ul.push(...ao),rs.push({id:Ra.id,code:Ra.codigo,court:oe.court,customer:dl?.nome||rd[0]||"",start:new Date(Ra.inicio),end:new Date(Ra.fim),status:oe.status,modality:oe.modality})}ul.length>0&&await de.from("agendamento_participantes").insert(ul),ae(Ra=>[...Ra,...rs]),t({title:`${wt} Agendamentos criados!`,description:"Agendamentos recorrentes criados com sucesso.",variant:"success"}),be(!1),Ge(4)}else{const{data:Ma,error:rs}=await de.from("agendamentos").insert({codigo_empresa:A.codigo_empresa,quadra_id:Ot.id,cliente_id:dl?.id??null,clientes:rd,inicio:Vr.toISOString(),fim:Wn.toISOString(),modalidade:oe.modality,status:oe.status}).select("id, codigo").single();if(rs)throw rs;const Pi={id:Ma.id,code:Ma.codigo,court:oe.court,customer:dl?.nome||rd[0]||"",start:Vr,end:Wn,status:oe.status,modality:oe.modality};ae(xo=>[...xo,Pi]),t({title:"Agendamento criado",variant:"success",duration:2e3}),r().catch(xo=>{console.error("[AgendaPage] Erro ao recarregar alertas:",xo)});try{const xo=jn.map((ul,Ra)=>({codigo_empresa:A.codigo_empresa,agendamento_id:Ma.id,cliente_id:ul.id,nome:ul.nome,valor_cota:0,status_pagamento:"Pendente",ordem:Ra+1,is_representante:Ra===0,deleted_at:null}));if(xo.length>0){const{error:ul}=await de.from("agendamento_participantes").insert(xo);if(!ul){const Ra=xo.map(ao=>({agendamento_id:ao.agendamento_id,cliente_id:ao.cliente_id,nome:ao.nome,codigo:jn.find(fl=>fl.id===ao.cliente_id)?.codigo||null,valor_cota:ao.valor_cota,status_pagamento:ao.status_pagamento,ordem:ao.ordem}));Nt(ao=>({...ao,[Ma.id]:Ra}))}}}catch{}}go.current=!0,Uo.current=!1;try{Xt.current=[]}catch{}try{yn([])}catch{}ht(!1)}catch(Ot){t({title:"Erro ao salvar agendamento",description:Ot?.message||"Tentando novamente automaticamente",variant:"destructive"})}finally{Js(!1)}}},[Co,Ft,oe,ze,A,zd,ae,t,ht,hs]),Kg=p.useCallback(async()=>{if(!ze?.id){ht(!1),or(null),tn(null),ll.current=!1,be(!1),Ge(4);return}try{await qd({autoSave:!0})}catch(De){console.error(" [Close] Erro ao salvar ao fechar modal:",De)}finally{try{Xt.current=[]}catch{}try{yn([])}catch{}ht(!1),or(null),tn(null),ll.current=!1,be(!1),Ge(4)}},[ze?.id,qd,yn,or,ht,tn]);p.useEffect(()=>{const De=async()=>{if(!Ze||!A?.codigo_empresa)return;const ft=String(A.codigo_empresa);if(Pu.current!==ft)try{ma(!0);try{const Yt=`clientes:list:${A.codigo_empresa}`,Pr=JSON.parse(localStorage.getItem(Yt)||"[]");if(Array.isArray(Pr)&&Pr.length>0){Ia(Pr);try{Et(Wr=>JSON.stringify(Wr)===JSON.stringify(Pr)?Wr:Pr)}catch{}}}catch{}const{data:Ot,error:Lt}=await de.from("clientes").select("id, nome, codigo, email, telefone, status, codigo_empresa, is_consumidor_final").eq("codigo_empresa",A.codigo_empresa).eq("status","active").eq("flag_cliente",!0).order("nome",{ascending:!0});if(Lt){console.error("Falha ao carregar clientes:",Lt);return}if(Array.isArray(Ot)){if(Ot.length===0){let Yt=0;try{const Pr=`clientes:list:${A.codigo_empresa}`,Wr=JSON.parse(localStorage.getItem(Pr)||"[]");Yt=Array.isArray(Wr)?Wr.length:0}catch{}if(Yt>0&&!gm.current){gm.current=!0,setTimeout(De,700);return}}gm.current=!1,Pu.current=ft,Ia(Ot);try{const Yt=`clientes:list:${A.codigo_empresa}`;localStorage.setItem(Yt,JSON.stringify(Ot))}catch{}try{Et(Yt=>JSON.stringify(Yt)===JSON.stringify(Ot)?Yt:Ot)}catch{}}}catch{}finally{ma(!1)}};De()},[Ze,A?.codigo_empresa]),p.useEffect(()=>{try{if(ze?.id){const Pr=ze?.valor_total,Wr=Number(Pr);if(Pr!=null&&Pr!==""&&Number.isFinite(Wr)){y(hp(String(Wr.toFixed(2))));return}}}catch{}const De=Ft[oe.court];if(!De)return;const ft=Number(De.valor||0);if(!Number.isFinite(ft)||ft<=0)return;const Ot=Math.max(0,oe.endMinutes-oe.startMinutes);if(Ot<=0)return;const Lt=Ot/Pa,Yt=Math.round(ft*Lt*100)/100;y(hp(String(Yt.toFixed(2))))},[Ft,oe.court,oe.startMinutes,oe.endMinutes]),p.useEffect(()=>{if(Ze&&!Vo.current)if(ze){const De=Iu(ze.start)*60+Ou(ze.start),ft=Iu(ze.end)*60+Ou(ze.end),Ot=(()=>{try{if((Dr||[]).includes(ze.court))return ze.court;const Vr=ze.court_id;if(Vr!=null){const Wn=(zt||[]).find(Na=>String(Na.id)===String(Vr));if(Wn?.nome)return Wn.nome}}catch{}return(Dr||[])[0]||""})(),Lt=tr[ze.id]||[],Yt=Lt.filter(Vr=>Vr&&Vr.cliente_id).map(Vr=>({id:Vr.cliente_id,nome:Vr.nome,codigo:Vr.codigo||null})),Pr=Ft[Ot]?.modalidades||pp,Wr=Pr.includes(ze.modality)?ze.modality:Pr[0]||"";try{vr("edit:init-from-cache")}catch{}Ee({selectedClients:Yt,court:Ot,modality:Wr,status:ze.status,date:_s(ze.start),startMinutes:De,endMinutes:ft}),ql.current=!0,v(Lt.map(Vr=>({cliente_id:Vr.cliente_id,nome:Vr.nome,codigo:Vr.codigo,valor_cota:(()=>{const Wn=Number.isFinite(Number(Vr.valor_cota))?Number(Vr.valor_cota):_f(Vr.valor_cota);return hp(String((Number.isFinite(Wn)?Wn:0).toFixed(2)))})(),status_pagamento:Vr.status_pagamento||"Pendente",finalizadora_id:Vr.finalizadora_id||null,aplicar_taxa:Vr.aplicar_taxa||!1}))),Bl(Yt[0]?.id||null),(async()=>{try{const{data:Vr,error:Wn}=await de.from("agendamento_participantes").select("cliente_id, nome, valor_cota, status_pagamento, finalizadora_id, aplicar_taxa, ordem, is_representante, deleted_at, cliente:clientes!agendamento_participantes_cliente_id_fkey ( nome, codigo )").eq("codigo_empresa",A.codigo_empresa).eq("agendamento_id",ze.id).is("deleted_at",null).order("ordem",{ascending:!0}).order("id",{ascending:!0});if(!Wn&&Array.isArray(Vr)){const Na=Vr.slice();try{Bl(String(Na[0]?.cliente_id||"")||null)}catch{}const ia=Na.filter(jn=>jn&&jn.cliente_id).map(jn=>({id:jn.cliente_id,nome:jn.nome||jn.cliente?.nome||"",codigo:jn.cliente?.codigo||null}));Ee(jn=>{try{vr("edit:background-refresh")}catch{}return(Array.isArray(jn.selectedClients)?jn.selectedClients:[]).length>0?jn:{...jn,selectedClients:ia}}),v(Na.map(jn=>({cliente_id:jn.cliente_id,nome:jn.nome||jn.cliente?.nome||"",codigo:jn.cliente?.codigo||null,valor_cota:(()=>{const Po=Number.isFinite(Number(jn.valor_cota))?Number(jn.valor_cota):_f(jn.valor_cota);return hp(String((Number.isFinite(Po)?Po:0).toFixed(2)))})(),status_pagamento:jn.status_pagamento||"Pendente",finalizadora_id:jn.finalizadora_id?String(jn.finalizadora_id):null,aplicar_taxa:jn.aplicar_taxa||!1})))}}catch(Vr){console.error("Falha ao carregar participantes (refresh)",Vr)}})(),Vo.current=!0}else if(Qr){const De=(Dr||[]).includes(Qr.court)?Qr.court:(Dr||[])[0]||"",ft={selectedClients:tt.current?Array.isArray(oe.selectedClients)?oe.selectedClients:[]:[],court:De,modality:(()=>(Ft[De]?.modalidades||pp)[0]||"")(),status:"scheduled",date:Qr.date??D,startMinutes:Qr.startMinutes??Oe(),endMinutes:Qr.endMinutes??Oe()+60};Ee(ft),v([]),ql.current=!0,Vo.current=!0}else{const De=Dr[0]||"",ft=Ft[De]?.modalidades||pp,Ot=Array.isArray(Gr)?Gr:[],Lt=tt.current?Array.isArray(oe.selectedClients)?oe.selectedClients:[]:Ot.length>0?Ot:[];if(!tt.current&&Ot.length>0)try{tt.current=!0}catch{}Ee({selectedClients:Lt,court:De,modality:ft[0]||"",status:"scheduled",date:D,startMinutes:Oe(),endMinutes:Oe()+60}),v([]),ql.current=!0,Vo.current=!0}},[Ze,ze,D,Qr,Dr,pp,tr]),p.useEffect(()=>{if(Ze&&ze){Vo.current=!1,ll.current=!1,tt.current||Ee(De=>({...De,selectedClients:[]}));try{br.current=!1}catch{}}},[ze,Ze]),p.useEffect(()=>{if(Ze)try{ll.current=!1}catch{}},[Ze]),p.useEffect(()=>{if(!Ze||!ze||ll.current)return;const De=tr[ze.id]||[];if(!De.length)return;const ft=De.slice();try{Bl(String(ft[0]?.cliente_id||"")||null)}catch{}const Ot=ft.filter(Lt=>Lt&&Lt.cliente_id).map(Lt=>({id:Lt.cliente_id,nome:Lt.nome,codigo:Lt.codigo||null}));if(Ot.length>0){try{localStorage.getItem("debug:agenda")==="1"&&(console.log("[ORDER-AGENDA] chipsIdsNow:",chipsNow.map(Lt=>Lt.id)),console.log("[ORDER-AGENDA] selectedFromPartsIds:",Ot.map(Lt=>Lt.id)))}catch{}Ee(Lt=>{try{vr("edit:prefill-tardy")}catch{}return(Array.isArray(Lt.selectedClients)?Lt.selectedClients:[]).length>0?Lt:{...Lt,selectedClients:Ot}}),v(ft.map(Lt=>({cliente_id:Lt.cliente_id,nome:Lt.nome,codigo:Lt.codigo||null,valor_cota:(()=>{const Yt=Number.isFinite(Number(Lt.valor_cota))?Number(Lt.valor_cota):_f(Lt.valor_cota);return hp(String((Number.isFinite(Yt)?Yt:0).toFixed(2)))})(),status_pagamento:Lt.status_pagamento||"Pendente",finalizadora_id:Lt.finalizadora_id||null,aplicar_taxa:Lt.aplicar_taxa||!1}))),ll.current=!0}},[Ze,ze,tr]);const Xg=p.useCallback(async()=>{try{if(s)return;if(!ze?.id){o();return}if(Co)return;try{try{Uo.current=!1}catch{}try{go.current=!1}catch{}await qd({autoSave:!0}),await Promise.resolve()}catch{}go.current&&o()}catch{}},[s,ze?.id,Co,qd,o]);p.useEffect(()=>{const De=ft=>{Ze&&(s||ze&&(ft.key==="F3"&&(ft.preventDefault(),es(!0)),ft.key==="F4"&&(ft.preventDefault(),Xg())))};return window.addEventListener("keydown",De),()=>window.removeEventListener("keydown",De)},[Ze,ze,s,Xg,es,qd,Uo,go,ht,oe]);const cl=p.useMemo(()=>{const De=Ft[oe.court];if(!De)return{start:Es*60,end:po*60};const[ft,Ot]=String(De.hora_inicio||"06:00:00").split(":").map(Number),[Lt,Yt]=String(De.hora_fim||"24:00:00").split(":").map(Number),Pr=Lt===0&&Yt===0?24:Lt;return{start:ft*60+(Ot||0),end:Pr*60+(Yt||0)}},[Ft,oe.court,Es,po]),vm=p.useCallback((De,ft)=>{const Ot=cr(oe.date,"yyyy-MM-dd"),Lt=Pr=>{const Wr=Iu(Pr),Vr=Ou(Pr);return Wr===0&&Vr===0?1440:Wr*60+Vr},Yt=Ft?.[oe.court]?.id;return me.filter(Pr=>{const Wr=Pr.court===oe.court,Vr=Yt!=null&&String(Pr.court_id||"")===String(Yt);return(Wr||Vr)&&cr(Pr.start,"yyyy-MM-dd")===Ot&&Pr.status!=="canceled"&&(!ze||Pr.id!==ze.id)}).map(Pr=>[Lt(Pr.start),Lt(Pr.end)]).sort((Pr,Wr)=>Pr[0]-Wr[0])},[me,oe.court,oe.date,ze]),sp=p.useMemo(()=>{try{return vm()}catch{return[]}},[vm]),o2=(De,ft,Ot,Lt)=>De<Lt&&Ot<ft;function zd(De,ft){if(ft<=De||De<cl.start||ft>cl.end)return!1;for(const[Ot,Lt]of sp)if(o2(De,ft,Ot,Lt))return!1;return!0}const J0=De=>{let ft=De+Pa;if(!zd(De,ft))return null;for(;ft+Pa<=cl.end&&zd(De,ft+Pa);)ft+=Pa;return ft},i2=p.useMemo(()=>{const De=cl,ft=[];for(let Ot=De.start;Ot<=De.end;Ot+=Pa){const Lt=zd(Ot,Ot+Pa);let Yt=Math.floor(Ot/60);const Pr=Ot%60;Yt>=24&&Ot===1440&&(Yt=0),ft.push({value:Ot,label:`${String(Yt).padStart(2,"0")}:${String(Pr).padStart(2,"0")}`,available:Lt})}return ft},[cl,sp]),l2=p.useMemo(()=>{const De=J0(oe.startMinutes),ft=[];for(let Ot=oe.startMinutes+Pa;Ot<=cl.end;Ot+=Pa){const Lt=!!De&&Ot<=De;let Yt=Math.floor(Ot/60);const Pr=Ot%60;Yt>=24&&(Yt=Yt%24),ft.push({value:Ot,label:`${String(Yt).padStart(2,"0")}:${String(Pr).padStart(2,"0")}`,available:Lt})}return ft},[oe.startMinutes,sp,cl]);p.useEffect(()=>{if(ql.current){ql.current=!1;return}const ft=(()=>{if(zd(oe.startMinutes,oe.startMinutes+Pa))return oe.startMinutes;for(let Yt=Math.max(cl.start,oe.startMinutes);Yt<=cl.end-Pa;Yt+=Pa)if(zd(Yt,Yt+Pa))return Yt;for(let Yt=cl.start;Yt<=cl.end-Pa;Yt+=Pa)if(zd(Yt,Yt+Pa))return Yt;return oe.startMinutes})();if(ft!==oe.startMinutes){Ee(Yt=>({...Yt,startMinutes:ft}));return}const Ot=J0(ft);if(!Ot)return;let Lt=oe.endMinutes;(!Number.isFinite(Lt)||Lt<=ft||Lt>Ot)&&(Lt=Math.min(ft+60,Ot),Lt<ft+Pa&&(Lt=ft+Pa),Ee(Yt=>({...Yt,endMinutes:Lt})))},[oe.startMinutes,oe.court,oe.date,sp,cl]);const c2=p.useMemo(()=>Ft[oe.court]?.modalidades||pp,[Ft,oe.court]);p.useEffect(()=>{const De=Ft[oe.court]?.modalidades||pp;De.includes(oe.modality)||Ee(ft=>({...ft,modality:De[0]||""}))},[oe.court,Ft]),p.useEffect(()=>{if(ql.current||!nl(oe.date,D))return;if(ye[oe.court]&&!ye[oe.court].funciona){const Ot=Dr.find(Lt=>!ye[Lt]||ye[Lt].funciona);Ot&&Ee(Lt=>({...Lt,court:Ot}))}},[oe.court,oe.date,ye,Dr,D]);const d2=p.useMemo(()=>{const De=Math.max(0,oe.endMinutes-oe.startMinutes),ft=Math.floor(De/60),Ot=De%60;return ft>0&&Ot>0?`${ft}h ${Ot}min`:ft>0?`${ft}h`:`${Ot}min`},[oe.startMinutes,oe.endMinutes]),Yg=p.useMemo(()=>{if(!Ze)return"";const De=new Date,ft=Iu(De)*60+Ou(De),Ot=Number(oe.startMinutes),Lt=Number(oe.endMinutes),Yt=Pr=>{let Wr=Math.floor(Pr/60);const Vr=Pr%60;return Wr>=24&&(Wr=Wr%24),`${String(Wr).padStart(2,"0")}:${String(Vr).padStart(2,"0")}`};if(Le.autoConfirmEnabled&&oe.status==="scheduled"){const Pr=Math.max(0,Ot-Number(Le.autoConfirmMinutesBefore||0));if(ft<Pr)return`Este agendamento est com automao ativa (Confirmar automaticamente s ${Yt(Pr)})`}return Le.autoStartEnabled&&oe.status==="confirmed"&&ft<Ot?`Este agendamento est com automao ativa (Iniciar automaticamente s ${Yt(Ot)})`:Le.autoFinishEnabled&&oe.status==="in_progress"&&ft<Lt?`Este agendamento est com automao ativa (Finalizar automaticamente s ${Yt(Lt)})`:""},[Ze,oe.startMinutes,oe.endMinutes,oe.status,Le]),op=p.useMemo(()=>(m||[]).length,[m]),Ci=p.useMemo(()=>{const ft=(m||[]).map(Vr=>{const Wn=_f(Vr?.valor_cota);return Number.isFinite(Wn)?Wn:0}).reduce((Vr,Wn)=>Vr+Wn,0),Ot=_f(g),Lt=Number.isFinite(Ot)?Ot:0,Yt=Number((Lt-ft).toFixed(2));let Pr=0,Wr=0;for(const Vr of m||[])(Vr?.status_pagamento||"Pendente")==="Pago"?Pr++:Wr++;return{totalAssigned:ft,totalTarget:Lt,diff:Yt,paid:Pr,pending:Wr}},[m,g]);p.useEffect(()=>{const De=_f(g);if(!Number.isFinite(De)||De<=0)return;(m||[]).some(Ot=>_f(Ot?.valor_cota)>=De)&&(m||[]).some(Ot=>Ot.status_pagamento!=="Pago")&&v(Ot=>Ot.map(Lt=>({...Lt,status_pagamento:"Pago"})))},[m,g]),p.useCallback(()=>{const De=(oe.selectedClients||[]).length;if(!De)return;const ft=_f(g);if(!Number.isFinite(ft)||ft<0)return;const Ot=Math.round(ft*100),Lt=Math.floor(Ot/De);let Yt=Ot-Lt*De;v(Pr=>{const Wr=(oe.selectedClients||[]).slice(),Vr=new Map,Wn=new Map;return(Pr||[]).forEach(ia=>{const jn=Wn.get(ia.cliente_id)||[];jn.push(ia),Wn.set(ia.cliente_id,jn)}),Wr.map(ia=>{const jn=Vr.get(ia.id)||0,li=(Wn.get(ia.id)||[])[jn];Vr.set(ia.id,jn+1);const Vi=Lt+(Yt>0?1:0);Yt>0&&Yt--;const td=(Vi/100).toFixed(2),dl=hp(String(td)),rd=_f(dl);return{cliente_id:ia.id,nome:ia.nome,codigo:li?.codigo??ia.codigo??null,valor_cota:dl,status_pagamento:Number.isFinite(rd)&&rd>0?"Pago":"Pendente",finalizadora_id:li?.finalizadora_id??null,aplicar_taxa:li?.aplicar_taxa??!1}})})},[oe.selectedClients,g,v]),p.useCallback(()=>{v(De=>De.map(ft=>({...ft,valor_cota:"",status_pagamento:"Pendente"})))},[v]);const ii=p.useCallback(async()=>{try{dr.current=!1,localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{ut.current="close"}catch{}try{At(!1),ln(!1)}catch{}},[ze?.id,qd]);return a.jsxs(a.Fragment,{children:[da&&a.jsx(mn,{open:!0,onOpenChange:De=>{if(!De&&da){try{da.resolve(!1)}catch{}Xs(null)}},children:a.jsxs(un,{onOpenAutoFocus:De=>De.preventDefault(),children:[a.jsxs(on,{children:[a.jsx(an,{children:"Reativar automao?"}),a.jsx(Nn,{children:"Ao reativar, este agendamento voltar a ser atualizado automaticamente (incio e trmino) pelas regras da agenda."})]}),a.jsx(Qn,{children:a.jsxs("div",{className:"ml-auto flex gap-2",children:[a.jsx(fe,{type:"button",variant:"ghost",className:"border border-white/10",onClick:()=>{try{da?.resolve(!1)}catch{}Xs(null)},children:"Cancelar"}),a.jsx(fe,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white",onClick:()=>{try{da?.resolve(!0)}catch{}Xs(null)},children:"Reativar"})]})})]})}),Ze&&a.jsx(mn,{open:!0,onOpenChange:async De=>{if(De)ht(!0);else{try{const ft=Date.now()<(It.current||0);if(er||zr||ft){try{const Ot={ts:new Date().toISOString(),hook:"Dialog:onOpenChange(blocked)",effectiveCustomerPickerOpen:er,isClientFormOpen:zr,suppressUntil:It.current,formLen:Array.isArray(oe?.selectedClients)?oe.selectedClients.length:NaN,curLen:Array.isArray(Ie.current)?Ie.current.length:NaN,lastLen:Array.isArray(Xt.current)?Xt.current.length:NaN};console.warn("[CustomerPicker][DIALOG:block-close]",Ot)}catch{}return}}catch{}try{const ft={ts:new Date().toISOString(),hook:"Dialog:onOpenChange(allow-close)",effectiveCustomerPickerOpen:er,isClientFormOpen:zr,suppressUntil:It.current,formLen:Array.isArray(oe?.selectedClients)?oe.selectedClients.length:NaN,curLen:Array.isArray(Ie.current)?Ie.current.length:NaN,lastLen:Array.isArray(Xt.current)?Xt.current.length:NaN};console.warn("[CustomerPicker][DIALOG:allow-close]",ft)}catch{}if(s&&console.log("[Dialog] Fechamento solicitado com PaymentModal aberto - iniciando coordenao"),console.log(" [FLUXO CRTICO] Solicitao de fechamento do modal de agendamento recebida"),console.log(" Estado atual:",{isPaymentModalOpen:s,editingBooking:ze?.id,timestamp:new Date().toISOString()}),s&&typeof window<"u"){console.log(" [FLUXO CRTICO] PaymentModal aberto - solicitando save-and-close");try{await new Promise(ft=>{const Ot=()=>{window.removeEventListener("paymentmodal:closed",Ot),console.log(" [FLUXO CRTICO] PaymentModal confirmou fechamento"),ft()},Lt=setTimeout(()=>{window.removeEventListener("paymentmodal:closed",Ot),console.warn(" [FLUXO CRTICO] Timeout aguardando PaymentModal fechar"),ft()},3e3),Yt=()=>{clearTimeout(Lt),Ot()};window.addEventListener("paymentmodal:closed",Yt,{once:!0}),window.dispatchEvent(new Event("paymentmodal:save-and-close"))})}catch{}}await Kg(),console.log(" [FLUXO CRTICO] Modal de agendamento fechado")}},children:a.jsxs(un,{forceMount:!0,disableAnimations:!0,alignTop:!0,className:"sm:max-w-[960px] max-h-[85vh] min-h-[360px] flex flex-col p-0",onOpenAutoFocus:De=>De.preventDefault(),onInteractOutside:async De=>{try{const ft=Date.now()<(It.current||0);if(s||er||zr||ft){try{const Ot={ts:new Date().toISOString(),hook:"DialogContent:onInteractOutside(blocked)",effectiveCustomerPickerOpen:er,isClientFormOpen:zr,isPaymentModalOpen:s,suppressUntil:It.current,formLen:Array.isArray(oe?.selectedClients)?oe.selectedClients.length:NaN,curLen:Array.isArray(Ie.current)?Ie.current.length:NaN,lastLen:Array.isArray(Xt.current)?Xt.current.length:NaN}}catch{}De.preventDefault();return}if(ze?.id){De.preventDefault(),await Kg();return}}catch{}},onEscapeKeyDown:De=>{try{const ft=Date.now()<(It.current||0);if(s||er||zr||ft){De.preventDefault();return}}catch{}},children:[a.jsxs(on,{className:"px-6 pt-6 pb-4 flex-shrink-0",children:[a.jsxs(an,{className:"flex items-center justify-between gap-3 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{children:ze?(()=>{const De=ze?.code,ft=typeof De=="number"?String(De).padStart(3,"0"):null;return ft?`Editar agendamento - ${ft}`:"Editar Agendamento"})():"Novo Agendamento"}),ze?.created_by_isis&&a.jsxs("span",{className:"inline-flex items-center gap-2 px-2.5 py-1 rounded-full border text-xs bg-fuchsia-600/10 text-fuchsia-400 border-fuchsia-700/30",title:"Criado pela sis",children:[a.jsx("span",{className:"rounded-full overflow-hidden bg-background w-4 h-4 flex items-center justify-center shadow-[0_0_0_2px_rgba(0,0,0,0.25)]",children:a.jsx(gi,{size:"xs",className:"w-4 h-4"})}),"Criado pela sis"]})]}),ze&&(()=>{Ci?.pending===0&&op>0;const De=(Ci?.pending||0)>0,ft="inline-flex items-center gap-2 px-2.5 py-1 rounded-full border text-xs",Ot="bg-emerald-600/10 text-emerald-400 border-emerald-700/30",Lt="bg-amber-600/15 text-amber-400 border-amber-700/30",Yt=Pr=>a.jsx("span",{"aria-hidden":!0,className:`inline-block w-2 h-2 rounded-full ${Pr}`});return a.jsxs("span",{className:`${ft} ${De?Lt:Ot}`,title:De?"H pagamentos pendentes":"Todos participantes pagos","aria-live":"polite",children:[Yt(De?"bg-amber-400":"bg-emerald-400"),a.jsx("span",{className:"tracking-wide",children:"Pagos"}),a.jsx("strong",{className:"text-base font-semibold tabular-nums",children:Ci?.paid||0}),a.jsx("span",{className:"opacity-60",children:"/"}),a.jsx("span",{className:"text-base font-semibold tabular-nums",children:op})]})})(),a.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-md border text-sm bg-white/5 border-white/10 text-text-primary mr-12 max-w-full",title:"Data do agendamento",children:[a.jsx(Bs,{className:"w-4 h-4 opacity-80"}),a.jsxs("span",{className:"font-semibold",children:[cr(oe.date,"dd/MM/yyyy"),(()=>{const De=Number(oe?.startMinutes),ft=Number(oe?.endMinutes);if(!(Number.isFinite(De)&&Number.isFinite(ft)&&ft>De))return"";const Lt=Yt=>{let Pr=Math.floor(Yt/60);const Wr=Yt%60;return Pr>=24&&(Pr=Pr%24),`${String(Pr).padStart(2,"0")}:${String(Wr).padStart(2,"0")}`};return`  ${Lt(De)}${Lt(ft)}`})()]})]})]}),a.jsx(Nn,{children:ze?"As alteraes so salvas automaticamente enquanto voc edita.":"Preencha os detalhes para criar uma nova reserva."})]}),a.jsx("div",{className:"flex-1 overflow-y-auto px-6",children:a.jsxs("div",{className:"grid md:grid-cols-2 gap-4 pb-4",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(qe,{htmlFor:"clientes-field",className:"font-bold",children:"Clientes"}),a.jsxs("div",{className:"flex gap-2 mt-1",children:[a.jsxs(vi,{modal:!1,open:er,onOpenChange:De=>{const ft=Date.now(),Ot=ft<(Mr.current||0)||ft<(It.current||0)||ft<(Ir.current||0)||et();if(!((zr||ka)&&De===!1)){if(!De&&Ot){Us("onOpenChange:blocked:guard-window");return}if(!De&&ut.current!=="close"){Us("onOpenChange:blocked:sticky-close");return}if(De){dr.current=!0;try{localStorage.setItem("agenda:customerPicker:desiredAt",String(Date.now()))}catch{}ln(!0),Us("open:accepted")}else{dr.current=!1;try{localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{const Lt=Array.isArray(Ie.current)?[...Ie.current]:[];Lt.length>0?(Lr.current="onOpenChange:close:preserve",Zr(Lt),Is("onOpenChange:close:preserve",Lt)):br.current||(Lr.current="onOpenChange:close:empty",Is("onOpenChange:close:empty",[]))}catch{}try{It.current=Date.now()+1500}catch{}try{const Lt={ts:new Date().toISOString(),hook:"onOpenChange(false)",formLen:Array.isArray(oe?.selectedClients)?oe.selectedClients.length:NaN,curLen:Array.isArray(Ie.current)?Ie.current.length:NaN,lastLen:Array.isArray(Xt.current)?Xt.current.length:NaN,chipsLen:Array.isArray(Gr)?Gr.length:NaN,clientsLoading:!!ka,lastAction:Lr?.current,clearedByUser:!!br?.current,suppressUntil:It.current};console.warn("[CustomerPicker][CLOSE:onOpenChange]",Lt)}catch{}ln(!1),Us("close:accepted")}!De&&_r.current&&(gr(!0),_r.current=!1,setTimeout(()=>gr(!1),1200)),ut.current=De?"open":"close",At(De)}},children:[a.jsx(xi,{asChild:!0,children:a.jsxs(fe,{type:"button",variant:"outline",className:pr("min-w-[180px] justify-between",Ur&&"ring-2 ring-emerald-500/40 ring-offset-2 ring-offset-transparent transition-shadow"),onClick:()=>{Us("trigger:click");try{ut.current="open"}catch{}try{dr.current=!0,localStorage.setItem("agenda:customerPicker:desiredAt",String(Date.now()))}catch{}At(!0),ln(!0),setTimeout(()=>{At(!0),ln(!0),Us("trigger:reassert-open")},30),Us("trigger:after-set-open")},children:[vo,a.jsx(Tg,{className:"w-4 h-4 ml-2 opacity-60"})]})}),a.jsx(ni,{forceMount:!0,side:"bottom",align:"start",className:"w-[360px] p-2 z-[9999]",onPointerDownOutside:De=>{const ft=Date.now();if(ft<(Mr.current||0)||ft<(It.current||0)||ft<(Ir.current||0)||et()){De.preventDefault();return}if(zr||ka){De.preventDefault();return}try{const Lt=Array.isArray(Ie.current)?[...Ie.current]:[];Lt.length>0?(Lr.current="outside:close:snapshot",Xt.current=Lt,Zr(Lt),Is("outside:close:apply",Lt),br.current=!1):(Lr.current="outside:close:empty",br.current&&(Xt.current=[],console.warn("[CustomerPicker][outside:close:empty:cleared]",{ts:new Date().toISOString()})),Is("outside:close:empty",[]))}catch{}try{It.current=Date.now()+1500}catch{}try{const Lt={ts:new Date().toISOString(),hook:"onPointerDownOutside",formLen:Array.isArray(oe?.selectedClients)?oe.selectedClients.length:NaN,curLen:Array.isArray(Ie.current)?Ie.current.length:NaN,lastLen:Array.isArray(Xt.current)?Xt.current.length:NaN,chipsLen:Array.isArray(Gr)?Gr.length:NaN,clientsLoading:!!ka,lastAction:Lr?.current,clearedByUser:!!br?.current,suppressUntil:It.current}}catch{}_r.current=!0,ut.current="close",dr.current=!1;try{localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}At(!1),ln(!1)},onFocusOutside:De=>{Us("focusOutside"),(zr||ka)&&De.preventDefault()},onEscapeKeyDown:De=>{Us("escapeKeyDown"),(zr||ka)&&De.preventDefault()},children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx(Zs,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(rt,{ref:kn,placeholder:"Buscar por cdigo ou nome...",value:Gt,onChange:De=>{Bt(De.target.value),Un(0)},onKeyDown:De=>{if(De.key==="ArrowDown"||De.key==="ArrowUp"){De.preventDefault();const ft=(ys||[]).filter(Wr=>{const Vr=Gt.trim().toLowerCase();return Vr?String(we(Wr)||"").toLowerCase().includes(Vr):!0}),Ot=ft.find(Wr=>Wr?.is_consumidor_final===!0),Yt=ft.filter(Wr=>Wr?.is_consumidor_final!==!0).slice().sort((Wr,Vr)=>{const Wn=typeof Wr=="object"&&Number.isFinite(Number(Wr?.codigo))?Number(Wr.codigo):1/0,Na=typeof Vr=="object"&&Number.isFinite(Number(Vr?.codigo))?Number(Vr.codigo):1/0;if(Wn!==Na)return Wn-Na;const ia=String(Ce(Wr)||"").toLowerCase(),jn=String(Ce(Vr)||"").toLowerCase();return ia.localeCompare(jn)}),Pr=Ot?[Ot,...Yt]:Yt;De.key==="ArrowDown"?Un(Wr=>Math.min(Wr+1,Pr.length-1)):Un(Wr=>Math.max(Wr-1,0))}if(De.key==="Enter"){De.preventDefault();const ft=(ys||[]).filter(Vr=>{const Wn=Gt.trim().toLowerCase();return Wn?String(we(Vr)||"").toLowerCase().includes(Wn):!0}),Ot=ft.find(Vr=>Vr?.is_consumidor_final===!0),Yt=ft.filter(Vr=>Vr?.is_consumidor_final!==!0).slice().sort((Vr,Wn)=>{const Na=typeof Vr=="object"&&Number.isFinite(Number(Vr?.codigo))?Number(Vr.codigo):1/0,ia=typeof Wn=="object"&&Number.isFinite(Number(Wn?.codigo))?Number(Wn.codigo):1/0;if(Na!==ia)return Na-ia;const jn=String(Ce(Vr)||"").toLowerCase(),Po=String(Ce(Wn)||"").toLowerCase();return jn.localeCompare(Po)}),Wr=(Ot?[Ot,...Yt]:Yt)[Kn];if(Wr){const Vr=Wr.id,Wn=Ce(Wr),Na=Wr.codigo,ia={id:Vr,nome:Wn,codigo:Na},jn=[...Array.isArray(Ie.current)?Ie.current:[],ia];try{(Ie.current||[]).length===0&&(vt.current=Vr||null)}catch{}try{br.current=!1}catch{}try{jn.length>0&&(Xt.current=jn)}catch{}try{Ie.current=jn}catch{}Is("keyboard:enter",jn),dr.current=!0;try{localStorage.setItem("agenda:customerPicker:desiredAt",String(Date.now()))}catch{}}}},className:"pl-10 pr-10"}),Gt&&a.jsx("button",{type:"button","aria-label":"Limpar busca",className:"absolute right-2 top-1/2 -translate-y-1/2 text-text-muted hover:text-text-primary p-1 rounded hover:bg-white/10",onClick:()=>{Bt(""),kn.current?.focus()},children:a.jsx(al,{className:"w-4 h-4"})})]}),a.jsxs("div",{ref:ya,className:"max-h-[260px] overflow-y-auto divide-y divide-border rounded-md border border-border",onWheel:De=>{De.stopPropagation()},onTouchMove:De=>{De.stopPropagation()},style:{overscrollBehavior:"contain"},children:[ka&&(ys||[]).length===0&&a.jsx("div",{className:"px-3 py-4 text-sm text-text-muted",children:"Carregando clientes"}),!ka&&(ys||[]).length===0&&a.jsx("div",{className:"px-3 py-4 text-sm text-text-muted",children:"Nenhum cliente encontrado"}),!ka&&(()=>{const De=(ys||[]).filter(Pr=>{const Wr=Gt.trim().toLowerCase();return Wr?String(we(Pr)||"").toLowerCase().includes(Wr):!0}),ft=De.find(Pr=>Pr?.is_consumidor_final===!0),Lt=De.filter(Pr=>Pr?.is_consumidor_final!==!0).slice().sort((Pr,Wr)=>{const Vr=typeof Pr=="object"&&Number.isFinite(Number(Pr?.codigo))?Number(Pr.codigo):1/0,Wn=typeof Wr=="object"&&Number.isFinite(Number(Wr?.codigo))?Number(Wr.codigo):1/0;if(Vr!==Wn)return Vr-Wn;const Na=String(Ce(Pr)||"").toLowerCase(),ia=String(Ce(Wr)||"").toLowerCase();return Na.localeCompare(ia)});return ft?[ft,...Lt]:Lt})().map((De,ft)=>{const Ot=De?.is_consumidor_final===!0,Lt=typeof De=="object"?De.id:null,Yt=Ce(De),Pr=typeof De=="object"?De.codigo:null,Wr=String(Yt||"").toLowerCase(),Vr=ia=>ia.id&&Lt?ia.id===Lt:String(ia.nome||"").toLowerCase()===Wr,Wn=(oe.selectedClients||[]).some(Vr),Na=ft===Kn;return a.jsxs("button",{ref:ia=>{Ca.current[ft]=ia},type:"button",className:`w-full text-left py-3 px-4 flex items-center gap-3 transition-all border-b border-border last:border-0 ${Na?"ring-2 ring-blue-500 ring-inset z-10":""} ${Ot?"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-2 border-l-amber-500/40":Wn?"bg-emerald-600/20 hover:bg-emerald-600/30":"hover:bg-surface-2"}`,onMouseEnter:()=>Un(ft),onMouseDown:ia=>{ia.stopPropagation()},role:"option","aria-checked":Wn,onClick:()=>{const ia={id:Lt,nome:Yt,codigo:Pr},jn=[...Array.isArray(Ie.current)?Ie.current:[],ia];try{(Ie.current||[]).length===0&&(vt.current=Lt||null)}catch{}try{br.current=!1}catch{}try{jn.length>0&&(Xt.current=jn)}catch{}try{Ie.current=jn}catch{}Is("list:add",jn),dr.current=!0;try{localStorage.setItem("agenda:customerPicker:desiredAt",String(Date.now()))}catch{}},children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[Pr!=null&&a.jsxs("span",{className:`inline-flex items-center justify-center w-10 h-10 rounded-full font-bold text-sm transition-colors ${Ot?"bg-amber-500/15 text-amber-300/90 ring-1 ring-amber-500/20":"bg-emerald-600/20 text-emerald-400"}`,children:["#",Pr]}),a.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[a.jsx("span",{className:`font-medium truncate ${Ot?"text-amber-100/90":""}`,children:Yt}),Ot&&a.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium",children:[a.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]})]})]}),(()=>{const ia=(oe.selectedClients||[]).filter(jn=>Vr(jn)).length;return ia>0?a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-7 h-7 rounded-full bg-rose-600 hover:bg-rose-500 text-white text-base font-bold transition-colors",onClick:jn=>{jn.stopPropagation();const Po=Array.isArray(Ie.current)?Ie.current:[],li=Po.findIndex(Vi=>Vr(Vi));if(li!==-1){const Vi=[...Po];Vi.splice(li,1);try{br.current=Vi.length===0}catch{}try{Vi.length===0&&(vt.current=null)}catch{}try{Vi.length>0&&(Xt.current=Vi)}catch{}try{Ie.current=Vi}catch{}Is("list:remove-one",Vi)}},children:"-"}),a.jsx("span",{className:"inline-flex items-center justify-center min-w-[32px] h-7 px-2 rounded-full bg-sky-600 text-white text-base font-bold",children:ia}),a.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-7 h-7 rounded-full bg-emerald-600 hover:bg-emerald-500 text-white text-base font-bold transition-colors",onClick:jn=>{jn.stopPropagation();const Po={id:Lt,nome:Yt,codigo:Pr},li=[...Array.isArray(Ie.current)?Ie.current:[],Po];try{(Ie.current||[]).length===0&&(vt.current=Lt||null)}catch{}try{br.current=!1}catch{}try{li.length>0&&(Xt.current=li)}catch{}try{Ie.current=li}catch{}Is("list:add-one",li)},children:"+"})]}):null})()]},Lt||Wr)})]}),a.jsxs("div",{className:"flex items-center justify-between pt-1",children:[a.jsx(fe,{type:"button",size:"sm",className:"bg-emerald-600 hover:bg-emerald-500 text-white shadow-md ring-2 ring-emerald-400/40 ring-offset-2 ring-offset-transparent",onMouseDown:De=>{try{It.current=Date.now()+3e3}catch{}try{Mr.current=Date.now()+3500}catch{}try{G.current=Date.now()+5e3}catch{}try{ut.current="close"}catch{}try{dr.current=!1,localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}De.stopPropagation()},onClick:()=>{ut.current="close",dr.current=!1;try{G.current=Date.now()+5e3}catch{}try{localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}Ye.current=!0;const ft=Array.isArray(Ie.current)?[...Ie.current]:[];try{ft.length>0&&(Lr.current="conclude:close:snapshot",Xt.current=ft)}catch{}Zr(ft);try{Mr.current=Date.now()+3e3}catch{}Is("conclude:close:apply",ft),Ee(Ot=>({...Ot,selectedClients:[...ft]}));try{br.current=!1}catch{}try{It.current=Date.now()+2500}catch{}At(!1),ln(!1),setTimeout(()=>{try{It.current=Date.now()+2500}catch{}At(!1),ln(!1)},15),setTimeout(()=>{try{It.current=Date.now()+2500}catch{}At(!1),ln(!1)},120);try{It.current=Date.now()+2500}catch{}try{const Ot={ts:new Date().toISOString(),hook:"conclude:click",formLen:Array.isArray(oe?.selectedClients)?oe.selectedClients.length:NaN,curLen:Array.isArray(Ie.current)?Ie.current.length:NaN,lastLen:Array.isArray(Xt.current)?Xt.current.length:NaN,chipsLen:Array.isArray(Gr)?Gr.length:NaN,clientsLoading:!!ka,lastAction:Lr?.current,clearedByUser:!!br?.current,suppressUntil:It.current,selectionLockUntil:Mr.current,restoreGuardUntil:nn.current,modalSessionId:re.current||"",closingAt:null,pickerOpen:!!er,modalOpen:!!Ze}}catch{}setTimeout(()=>{try{Ye.current=!1}catch{}},3e3)},children:"Concluir"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs("span",{className:"text-xs text-text-muted",children:[(us||[]).length," selecionado(s)"]})})]})]})})]}),a.jsx(fe,{type:"button",onClick:()=>{try{const De=Array.isArray(Ie.current)?Ie.current:[];De.length>0&&(Xt.current=De,Zr(De))}catch{}dr.current=!1;try{localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}ut.current="close",At(!1),ln(!1),mr(null),en(!0)},children:"+ Novo"})]}),ap?a.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs text-text-muted",children:[a.jsx(Tc,{className:"w-4 h-4 animate-spin"}),"Carregando participantes..."]}):ed.length>0?a.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:ed.map((De,ft)=>{const Ot=String(De?.nome||"").toLowerCase(),Lt=`${De?.id||Ot}-${ft}`,Yt=De?.id||`__name:${Ot}`;return a.jsxs("span",{className:"text-sm font-medium bg-white/5 border border-white/10 rounded px-2 py-1 flex items-center gap-2",children:[Q9(De.nome),a.jsxs("button",{type:"button","aria-label":"Remover cliente",title:"Remover cliente",className:"text-text-muted hover:text-red-400 p-1 rounded hover:bg-red-500/10",onClick:()=>{j("CustomerPicker:chip:remove",{token:Yt,chipIdx:ft});const Pr=(Array.isArray(Ie.current)?Ie.current:[]).filter((Wr,Vr)=>Vr!==ft);try{br.current=Pr.length===0}catch{}try{Xt.current=Pr}catch{}try{Ie.current=Pr}catch{}Is("chips:remove",Pr)},children:[a.jsx(al,{className:"w-5 h-5"}),a.jsx("span",{className:"sr-only",children:"Remover"})]})]},Lt)})}):null]}),a.jsxs("div",{children:[a.jsx(qe,{htmlFor:"quadra-select",className:"font-bold",children:"Quadra"}),a.jsxs(vn,{value:oe.court,onValueChange:De=>Ee(ft=>({...ft,court:De})),children:[a.jsx(hn,{className:"mt-1",onMouseDown:()=>{er&&setTimeout(ii,0)},children:a.jsx(wn,{children:oe.court&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"inline-block w-2.5 h-2.5 rounded-full",style:{backgroundColor:$m(oe.court)}}),a.jsx("span",{children:oe.court})]})})}),a.jsx(pn,{className:"z-[60]",children:Dr.map(De=>{const ft=cr(oe.date,"yyyy-MM-dd"),Ot=Q[ft]||{},Lt=Ot[De]&&!Ot[De].funciona;return a.jsx(ct,{value:De,disabled:Lt,className:Lt?"opacity-50 cursor-not-allowed":"",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"inline-block w-2.5 h-2.5 rounded-full",style:{backgroundColor:$m(De)}}),a.jsx("span",{children:De}),Lt&&a.jsx("span",{className:"text-xs text-text-muted ml-auto",children:"(Fechada)"})]})},De)})})]})]}),a.jsxs("div",{children:[a.jsx(qe,{htmlFor:"modalidade-select",className:"font-bold",children:"Modalidade"}),a.jsxs(vn,{value:oe.modality,onValueChange:De=>Ee(ft=>({...ft,modality:De})),children:[a.jsx(hn,{className:"mt-1",onMouseDown:()=>{er&&setTimeout(ii,0)},children:a.jsx(wn,{})}),a.jsx(pn,{children:(c2||[]).map(De=>a.jsx(ct,{value:De,children:De},De))})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(qe,{htmlFor:"status-select",className:"font-bold",children:"Status"}),a.jsxs(vn,{value:oe.status,onValueChange:De=>Ee(ft=>({...ft,status:De})),children:[a.jsx(hn,{className:"mt-1",onMouseDown:()=>{er&&setTimeout(ii,0)},children:a.jsx(wn,{})}),a.jsx(pn,{children:Object.keys(di).map(De=>a.jsx(ct,{value:De,children:a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx("span",{"aria-hidden":!0,className:`inline-block h-4 w-1 rounded ${di[De].accent}`}),di[De].label]})},De))})]}),Yg&&a.jsx("div",{className:"mt-1.5 text-xs text-text-primary font-medium bg-brand/5 border border-brand/20 rounded px-2 py-1.5",children:Yg})]}),a.jsxs("div",{children:[a.jsx(qe,{htmlFor:"horario-inicio",className:"font-bold",children:"Horrio"}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsxs(vn,{value:String(oe.startMinutes),onValueChange:De=>Ee(ft=>({...ft,startMinutes:Number(De)})),children:[a.jsx(hn,{className:"w-32","aria-label":"Hora incio",onMouseDown:()=>{er&&setTimeout(ii,0)},children:a.jsx(wn,{})}),a.jsx(pn,{className:"max-h-[300px] z-[60] [&>div]:scrollbar-thin [&>div]:scrollbar-track-surface [&>div]:scrollbar-thumb-brand/40 [&>div]:hover:scrollbar-thumb-brand/60",children:i2.map(De=>a.jsx(ct,{value:String(De.value),disabled:!De.available,className:pr(!De.available&&"opacity-60"),children:a.jsxs("span",{className:"inline-flex items-center gap-2",children:[De.available?a.jsx(Pd,{className:"w-4 h-4 opacity-80"}):a.jsx(Ix,{className:"w-4 h-4 opacity-80"}),De.label]})},De.value))})]}),a.jsxs(vn,{value:String(oe.endMinutes),onValueChange:De=>Ee(ft=>({...ft,endMinutes:Number(De)})),children:[a.jsx(hn,{className:"w-32","aria-label":"Hora fim",onMouseDown:()=>{er&&setTimeout(ii,0)},children:a.jsx(wn,{})}),a.jsx(pn,{className:"max-h-[300px] z-[60] [&>div]:scrollbar-thin [&>div]:scrollbar-track-surface [&>div]:scrollbar-thumb-brand/40 [&>div]:hover:scrollbar-thumb-brand/60",children:l2.map(De=>a.jsx(ct,{value:String(De.value),disabled:!De.available,className:pr(!De.available&&"opacity-60"),children:a.jsxs("span",{className:"inline-flex items-center gap-2",children:[De.available?a.jsx(Pd,{className:"w-4 h-4 opacity-80"}):a.jsx(Ix,{className:"w-4 h-4 opacity-80"}),De.label]})},De.value))})]})]}),a.jsxs("div",{className:"mt-1 inline-block text-xs font-semibold text-text-secondary bg-white/5 border border-white/10 rounded px-2 py-0.5",children:["Durao: ",d2]})]}),!ze&&a.jsxs("div",{className:"border-t border-border pt-4 mt-4",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("input",{type:"checkbox",id:"is-recorrente",checked:Wt,onChange:De=>be(De.target.checked),className:"mt-1 h-4 w-4 rounded border-gray-300 text-brand focus:ring-brand"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{htmlFor:"is-recorrente",className:"font-semibold text-text-primary cursor-pointer",children:"Agendamento Fixo (Recorrente)"}),a.jsx("p",{className:"text-xs text-text-secondary mt-0.5",children:"Criar este agendamento automaticamente nas prximas semanas, no mesmo dia e horrio"})]})]}),Wt&&a.jsxs("div",{className:"ml-7 mt-3 space-y-3",children:[a.jsxs("div",{children:[a.jsx(qe,{htmlFor:"quantidade-semanas",className:"text-sm font-medium",children:"Repetir por quantas semanas?"}),a.jsxs("div",{className:"flex items-center gap-3 mt-1.5",children:[a.jsxs("div",{className:"flex items-center border border-border rounded-md bg-surface-2",children:[a.jsx("button",{type:"button",onClick:()=>Ge(De=>Math.max(2,(De||2)-1)),className:"px-3 py-2 hover:bg-surface-3 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:wt<=2,children:a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),a.jsx("div",{className:"px-4 py-2 min-w-[60px] text-center font-semibold border-x border-border",children:wt}),a.jsx("button",{type:"button",onClick:()=>Ge(De=>(De||2)+1),className:"px-3 py-2 hover:bg-surface-3 transition-colors",children:a.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]}),a.jsxs("span",{className:"text-sm text-text-secondary",children:["semanas (",wt," agendamentos)"]})]})]}),oe.date&&wt>=2&&a.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-3",children:[a.jsx("p",{className:"text-xs font-semibold text-slate-300 mb-2 uppercase tracking-wide",children:"Datas que sero criadas:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from({length:wt}).map((De,ft)=>{const Ot=Ta(oe.date,ft*7);return a.jsxs("div",{className:"inline-flex items-center gap-1.5 bg-slate-700/50 border border-slate-600 rounded px-2 py-1",children:[a.jsx("svg",{className:"w-3.5 h-3.5 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),a.jsx("span",{className:"text-xs font-medium text-white",children:cr(Ot,"dd/MM/yyyy '('EEEE')'",{locale:na})})]},ft)})})]}),a.jsx("div",{className:"bg-slate-800/50 border-l-4 border-blue-600 rounded-r-lg p-3",children:a.jsxs("div",{className:"flex gap-3",children:[a.jsx("div",{className:"flex-shrink-0 mt-0.5",children:a.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),a.jsxs("div",{className:"text-xs text-gray-300",children:[a.jsx("p",{className:"font-semibold mb-1 text-blue-300",children:"Importante: Revise os dados antes de salvar"}),a.jsxs("p",{children:["Sero criados ",a.jsxs("strong",{className:"text-white",children:[wt," agendamentos"]})," incluindo a data selecionada e as prximas ",wt-1," semanas. Editar ou cancelar depois exigir alterar cada agendamento individualmente."]})]})]})})]})]})]})]})}),a.jsx(Qn,{className:"flex-shrink-0 border-t border-border bg-surface px-6 py-3",children:a.jsxs("div",{className:"w-full flex flex-col gap-3 sm:flex-row sm:items-center",children:[ze&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:mr-auto w-full sm:w-auto",children:[a.jsxs(fe,{type:"button",variant:"destructive",className:"bg-red-600 hover:bg-red-500 text-white border border-red-700 w-full sm:w-auto justify-center",onClick:()=>es(!0),children:[a.jsx(Qp,{className:"w-4 h-4 mr-2 opacity-90"}),"Cancelar agendamento",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-red-700/50 rounded border border-red-500/30",children:"F3"})]}),a.jsxs(fe,{type:"button",variant:"secondary",className:"bg-teal-600 hover:bg-teal-500 text-white border-teal-700 w-full sm:w-auto justify-center",onClick:()=>{Xg()},children:[a.jsx(ei,{className:"w-4 h-4 mr-2 opacity-90"}),a.jsx("span",{className:"hidden sm:inline",children:"Gerenciar Pagamentos"}),a.jsx("span",{className:"sm:hidden",children:"Pagamentos"}),a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-teal-700/50 rounded border border-teal-500/30",children:"F4"})]})]}),a.jsx(au,{open:ks,onOpenChange:es,children:a.jsxs(md,{children:[a.jsxs(hd,{children:[a.jsx(gd,{children:"Cancelar agendamento?"}),a.jsx(vd,{children:'Ao cancelar, este agendamento deixar de aparecer na agenda padro. Ele s ser visvel ao selecionar o filtro "Cancelados".'})]}),a.jsxs(pd,{children:[a.jsx(xd,{children:"Voltar"}),a.jsx(su,{className:"bg-red-600 hover:bg-red-500",onClick:async()=>{try{es(!1),ht(!1),await hs(ze.id,"canceled","user"),t({title:"Agendamento cancelado"})}catch(De){t({title:"Erro ao cancelar",description:De?.message||"Tente novamente."})}},children:"Confirmar cancelamento"})]})]})})]}),a.jsxs("div",{className:"flex gap-2 w-full sm:w-auto sm:ml-auto",children:[a.jsxs(fe,{type:"button",variant:"ghost",className:"border border-white/10 flex-1 sm:flex-none",onClick:async()=>{await Kg()},children:["Fechar",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-white/10 rounded border border-white/20",children:"Esc"})]}),!ze?.id&&a.jsxs(fe,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white disabled:opacity-60 disabled:cursor-not-allowed flex-1 sm:flex-none",disabled:Co,onClick:async()=>{try{if(Co)return;if(Wt&&!ze){_e(!0);return}Uo.current=!0,go.current=!1,await qd()}catch{}},children:["Salvar",a.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-emerald-700/50 rounded border border-emerald-500/30",children:""})]})]})]})})]})}),a.jsx(au,{open:Je,onOpenChange:_e,children:a.jsxs(md,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[a.jsxs(hd,{children:[a.jsxs(gd,{className:"flex items-center gap-3 text-xl",children:[a.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-lg bg-orange-600/20 border border-orange-600/40",children:a.jsx("svg",{className:"w-6 h-6 text-orange-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),"Confirmar Criao de Agendamentos Recorrentes"]}),a.jsxs(vd,{className:"space-y-4 mt-4",children:[oe.date&&wt>=2&&a.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-3",children:[a.jsx("p",{className:"text-xs font-semibold text-slate-300 mb-2 uppercase tracking-wide",children:" Datas que sero criadas:"}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:Array.from({length:wt}).map((De,ft)=>{const Ot=Ta(oe.date,ft*7);return a.jsxs("div",{className:"flex items-center gap-2 bg-slate-700/50 border border-slate-600 rounded px-2 py-1.5",children:[a.jsxs("span",{className:"text-xs font-semibold text-slate-400",children:["#",ft+1]}),a.jsx("span",{className:"text-xs font-medium text-white",children:cr(Ot,"dd/MM/yyyy '('EEEE')'",{locale:na})})]},ft)})})]}),a.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-4",children:[a.jsx("h4",{className:"text-sm font-semibold text-slate-300 mb-3 uppercase tracking-wide",children:"Resumo do Agendamento"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-700/50",children:[a.jsx("span",{className:"text-sm text-slate-400",children:"Quadra"}),a.jsx("span",{className:"font-semibold text-white",children:Ft[oe.court]?.name||oe.court})]}),a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-700/50",children:[a.jsx("span",{className:"text-sm text-slate-400",children:"Horrio"}),a.jsxs("span",{className:"font-semibold text-white font-mono",children:[eU(oe.startMinutes)," - ",eU(oe.endMinutes)]})]}),a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-700/50",children:[a.jsx("span",{className:"text-sm text-slate-400",children:"Modalidade"}),a.jsx("span",{className:"font-semibold text-white",children:oe.modality})]}),a.jsxs("div",{className:"flex items-start justify-between py-2",children:[a.jsx("span",{className:"text-sm text-slate-400",children:"Participantes"}),a.jsx("div",{className:"text-right max-w-xs",children:oe.selectedClients?.length>0?a.jsxs("div",{className:"font-semibold text-white",children:[je?oe.selectedClients.map(De=>De.nome).join(", "):oe.selectedClients.slice(0,3).map(De=>De.nome).join(", "),!je&&oe.selectedClients.length>3&&a.jsxs("span",{className:"text-slate-400",children:[" +",oe.selectedClients.length-3]}),oe.selectedClients.length>3&&a.jsxs(a.Fragment,{children:[" ",a.jsx("button",{type:"button",onClick:()=>Ue(!je),className:"text-xs text-blue-400 hover:text-blue-300 underline inline",children:je?"Ver menos":"Ver todos"})]})]}):a.jsx("span",{className:"font-semibold text-white",children:"Nenhum participante"})})]})]})]}),a.jsx("div",{className:"bg-red-900/30 border-l-4 border-red-600 rounded-r-lg p-4",children:a.jsxs("div",{className:"flex gap-3",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"w-5 h-5 text-red-400 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),a.jsx("div",{children:a.jsxs("p",{className:"text-sm text-gray-300",children:[a.jsx("strong",{className:"text-red-300",children:"Importante:"})," Aps criar, editar ou cancelar exigir alterar cada agendamento individualmente. Certifique-se de que todos os dados esto corretos!"]})})]})})]})]}),a.jsxs(pd,{className:"gap-2",children:[a.jsx(xd,{onClick:()=>{_e(!1),Ue(!1)},className:"border-slate-600 hover:bg-slate-800",children:"Cancelar e Revisar"}),a.jsxs(su,{className:"bg-emerald-700 hover:bg-emerald-600 text-white font-semibold",onClick:async()=>{_e(!1),Ue(!1),Uo.current=!0,go.current=!1,await qd()},children:[a.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Confirmar e Criar ",wt," Agendamentos"]})]})]})}),zr&&a.jsx(tne,{open:zr,onOpenChange:De=>{en(De),De||(mr(null),window.__paymentModalCallback&&(window.__paymentModalCallback=null))},client:cn,onSaved:De=>{try{if(De&&typeof De=="object"){console.warn("[CustomerPicker][onSaved:START]",{clientId:De.id,clientName:De.nome,currentSelection:Array.isArray(Ie.current)?Ie.current.length:0});try{G.current=Date.now()+3e3,Mr.current=Date.now()+3e3,nn.current=Date.now()+3e3}catch{}(ys||[]).some(Ot=>typeof Ot=="object"?Ot.id===De.id:!1)||(Ia(Ot=>[...Ot||[],De]),Et(Ot=>[...Ot||[],De])),Ee(Ot=>{const Lt=Array.isArray(Ot.selectedClients)?Ot.selectedClients:[],Yt={id:De.id,nome:De.nome||De.name||Ce(De),codigo:De.codigo},Pr=Lt.filter(Vr=>Vr.id!==De.id),Wr=[Yt,...Pr];try{Ie.current=Wr}catch{}try{Xt.current=Wr}catch{}try{Zr(Wr)}catch{}try{br.current=!1}catch{}return console.warn("[CustomerPicker][onSaved:COMPLETE]",{newClientId:De.id,newClientName:De.nome,totalSelected:Wr.length,refsSynced:!0,protectionActive:!0}),{...Ot,selectedClients:Wr}}),Promise.resolve().then(()=>{try{const Ot=Array.isArray(Ie.current)?Ie.current:[];Ee(Lt=>(Array.isArray(Lt.selectedClients)?Lt.selectedClients:[]).length>0?Lt:Ot.length>0?(console.warn("[CustomerPicker][onSaved:REASSERT]",{count:Ot.length}),{...Lt,selectedClients:[...Ot]}):Lt)}catch{}})}if(window.__paymentModalCallback&&typeof window.__paymentModalCallback=="function")try{window.__protectPaymentModal&&window.__protectPaymentModal(3e3),window.__paymentModalCallback(),window.__paymentModalCallback=null}catch(ft){console.error("[PaymentModal][callback:ERROR]",ft)}}catch(ft){console.error("[CustomerPicker][onSaved:ERROR]",ft)}}}),s&&a.jsx(rZe,{setIsModalOpen:ht,setBookings:ae,form:oe,setForm:Ee,localCustomers:ys,onOpenClientModal:De=>{en(!0),window.__paymentModalCallback=De}}),l&&a.jsx(nZe,{form:oe,setForm:Ee,localCustomers:ys})]})},We=p.useMemo(()=>{const G=cr(D,"yyyy-MM-dd");let re=me.filter(ke=>cr(ke.start,"yyyy-MM-dd")===G);if(!!!Kr){if(re=re.filter(ke=>ke.status!=="canceled"),Qt.trim()){const ke=Qt.trim().toLowerCase();re=re.filter(Oe=>(Oe.customer||"").toLowerCase().includes(ke)||(Oe.court||"").toLowerCase().includes(ke)||(di[Oe.status]?.label||"").toLowerCase().includes(ke))}return re}let Ce=he.canceledOnly?re.filter(ke=>ke.status==="canceled"):re.filter(ke=>ke.status!=="canceled");if(he.pendingPayments&&(Ce=Ce.filter(ke=>{const Oe=tr[ke.id]||[];return Oe.some(Ee=>String(Ee.status_pagamento||"").toLowerCase()!=="pago")&&Oe.length>0})),Qt.trim()){const ke=Qt.trim().toLowerCase();Ce=Ce.filter(Oe=>(Oe.customer||"").toLowerCase().includes(ke)||(Oe.court||"").toLowerCase().includes(ke)||(di[Oe.status]?.label||"").toLowerCase().includes(ke))}try{const ke=Date.now(),Oe=(me||[]).filter(Ee=>cr(Ee.start,"yyyy-MM-dd")===G).filter(Ee=>Ee.status!=="canceled").filter(Ee=>{const Ie=Za.current.get(Ee.id);return Ie&&Ie.src==="automation"&&ke-Ie.ts<2e3}),oe=new Map(Ce.map(Ee=>[Ee.id,Ee]));for(const Ee of Oe)oe.has(Ee.id)||oe.set(Ee.id,Ee);Ce=Array.from(oe.values())}catch{}return Ce},[me,D,he.scheduled,he.canceledOnly,he.pendingPayments,Qt,tr,Kr]),mt=p.useMemo(()=>{const G=cr(D,"yyyy-MM-dd"),re=St||Fr[0],we=me.filter(ke=>cr(ke.start,"yyyy-MM-dd")===G&&ke.status!=="canceled"&&ke.court===re);let Ce=0;return we.forEach(ke=>{const oe=(tr[ke.id]||[]).filter(Ee=>String(Ee.status_pagamento||"").toLowerCase()!=="pago").length;Ce+=oe}),{totalBookings:we.length,totalPendingPayments:Ce}},[me,D,tr,St,Fr]),J=p.useMemo(()=>{const G=Rm(D),re=Ta(G,6);let we=me.filter(Oe=>{const oe=_s(Oe.start),Ee=_s(G),Ie=_s(re);return oe>=Ee&&oe<=Ie});if(!!!Kr){if(we=we.filter(Oe=>Oe.status!=="canceled"),Qt.trim()){const Oe=Qt.trim().toLowerCase();we=we.filter(oe=>(oe.customer||"").toLowerCase().includes(Oe)||(oe.court||"").toLowerCase().includes(Oe)||(di[oe.status]?.label||"").toLowerCase().includes(Oe))}return we}let ke=he.canceledOnly?we.filter(Oe=>Oe.status==="canceled"):we.filter(Oe=>Oe.status!=="canceled");if(he.pendingPayments&&(ke=ke.filter(Oe=>{const oe=tr[Oe.id]||[];return oe.some(Ie=>String(Ie.status_pagamento||"").toLowerCase()!=="pago")&&oe.length>0})),Qt.trim()){const Oe=Qt.trim().toLowerCase();ke=ke.filter(oe=>(oe.customer||"").toLowerCase().includes(Oe)||(oe.court||"").toLowerCase().includes(Oe)||(di[oe.status]?.label||"").toLowerCase().includes(Oe))}try{const Oe=Date.now(),oe=(me||[]).filter(Ie=>{const tt=_s(Ie.start);return tt>=_s(G)&&tt<=_s(re)}).filter(Ie=>Ie.status!=="canceled").filter(Ie=>{const tt=Za.current.get(Ie.id);return tt&&tt.src==="automation"&&Oe-tt.ts<2e3}),Ee=new Map(ke.map(Ie=>[Ie.id,Ie]));for(const Ie of oe)Ee.has(Ie.id)||Ee.set(Ie.id,Ie);ke=Array.from(Ee.values())}catch{}return ke},[me,D,he.scheduled,he.canceledOnly,he.pendingPayments,Qt,tr,Kr]);p.useEffect(()=>{if(!Qt.trim()||!(he.scheduled||he.canceledOnly||he.pendingPayments)||!We||We.length===0)return;const G=[...We].sort((we,Ce)=>we.start-Ce.start)[0];if(!G?.id)return;const re=document.getElementById(`booking-${G.id}`);re?.scrollIntoView&&re.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},[Qt,We,he.scheduled,he.canceledOnly,he.pendingPayments]),p.useEffect(()=>{const G=ar.current,re=Tr.current||{},we=he.canceledOnly&&!re.canceledOnly,Ce=he.scheduled&&!re.scheduled&&!he.canceledOnly,ke=he.pendingPayments&&!re.pendingPayments;if(!G||!we&&!Ce&&!ke){Tr.current={scheduled:he.scheduled,canceledOnly:he.canceledOnly,pendingPayments:he.pendingPayments};return}const Oe=We||[];if(Oe.length===0){Tr.current={scheduled:he.scheduled,canceledOnly:he.canceledOnly,pendingPayments:he.pendingPayments};return}const oe=G.getBoundingClientRect();if(!Oe.some(Ie=>{const tt=document.getElementById(`booking-${Ie.id}`);if(!tt)return!1;const vt=tt.getBoundingClientRect();return vt.bottom>oe.top&&vt.top<oe.bottom})){const Ie=[...Oe].sort((vt,Rt)=>vt.start-Rt.start)[0],tt=Ie&&document.getElementById(`booking-${Ie.id}`);tt?.scrollIntoView&&tt.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}Tr.current={scheduled:he.scheduled,canceledOnly:he.canceledOnly,pendingPayments:he.pendingPayments}},[he.scheduled,he.canceledOnly,he.pendingPayments,We]);const ve=p.useMemo(()=>{if(!St||!Ft[St])return{start:Es,end:po};const G=Ft[St],re=G.hora_inicio||`${Es}:00:00`,we=G.hora_fim||`${po}:00:00`,[Ce,ke]=String(re).split(":").map(Number),[Oe,oe]=String(we).split(":").map(Number),Ee=Oe===0&&oe===0?24:Oe,Ie=Ee*60+(oe||0);return{start:Ce||Es,end:Ee||po,startMinutes:(Ce||0)*60+(ke||0),endMinutes:Ie}},[St,Ft,Es,po]);return p.useMemo(()=>{const G=ve.start,re=ve.end;return Array.from({length:Math.max(0,re-G)},(we,Ce)=>G+Ce)},[ve]),p.useMemo(()=>{const G=ve.start,re=ve.end;return Math.max(0,re-G)*(60/Pa)*Ti},[ve]),a.jsxs(a.Fragment,{children:[a.jsxs(xr.div,{variants:Ze?void 0:dZe,initial:Ze?!1:"hidden",animate:Ze?!1:"visible",className:pr("h-full w-full flex flex-col md:px-0",$&&"fixed inset-0 z-40 bg-surface"),children:[a.jsx(xr.div,{variants:Z9,className:"p-3 bg-surface mb-6 md:rounded-lg",children:a.jsxs("div",{className:"max-w-[1200px] mx-auto w-full flex flex-col gap-3 md:flex-row md:items-center md:gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(fe,{variant:"ghost",size:"icon",className:"h-9 w-9",onClick:()=>U(z==="day"?ub(D,1):ub(D,7)),children:a.jsx(XH,{className:"h-5 w-5"})}),a.jsxs(vi,{children:[a.jsx(xi,{asChild:!0,children:a.jsxs(fe,{variant:"ghost",className:"w-full sm:w-auto max-w-full justify-center text-base font-semibold whitespace-nowrap truncate",children:[a.jsx(Bs,{className:"mr-2 h-5 w-5"}),z==="day"?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"hidden sm:inline",children:cr(D,"EEE, dd 'de' MMMM 'de' yyyy",{locale:na})}),a.jsx("span",{className:"sm:hidden",children:cr(D,"EEE, dd/MM/yyyy",{locale:na})})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"hidden sm:inline",children:cZe(D)}),a.jsxs("span",{className:"sm:hidden",children:[cr(Rm(D),"dd/MM/yyyy")," - ",cr(Ta(Rm(D),6),"dd/MM/yyyy")]})]})]})}),a.jsx(ni,{className:"w-auto p-0",children:a.jsx(yi,{mode:"single",selected:D,onSelect:G=>G&&U(G),initialFocus:!0})})]}),a.jsx(fe,{variant:"ghost",size:"icon",className:"h-9 w-9",onClick:()=>U(z==="day"?Ta(D,1):Ta(D,7)),children:a.jsx(j0,{className:"h-5 w-5"})})]}),Fr.length>0&&a.jsx("div",{className:"hidden md:flex md:justify-center md:flex-1",children:Fr.length===1?a.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg w-52 h-10 border-2 border-brand/30 bg-gradient-to-r from-brand/5 to-brand/10",children:[a.jsx("div",{className:"h-3 w-3 rounded-full shadow-sm",style:{backgroundColor:$m(Fr[0])}}),a.jsx("span",{className:"font-semibold text-sm",children:Fr[0]})]}):a.jsxs(vn,{value:St||Fr[0],onValueChange:G=>{Jr(G)},children:[a.jsx(hn,{className:"w-52 h-10 border-2 border-brand/30 bg-gradient-to-r from-brand/5 to-brand/10 hover:border-brand/50 hover:bg-gradient-to-r hover:from-brand/10 hover:to-brand/15 transition-all shadow-sm",children:a.jsx(wn,{placeholder:"Selecionar quadra"})}),a.jsx(pn,{className:"border-brand/30",children:Fr.map(G=>{const re=$m(G);return a.jsx(ct,{value:G,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"h-3 w-3 rounded-full shadow-sm",style:{backgroundColor:re}}),a.jsx("span",{className:"font-semibold",children:G})]})},G)})})]})}),a.jsxs("div",{className:"flex flex-col gap-3 w-full md:w-auto md:ml-auto",children:[a.jsxs("div",{className:"flex items-center gap-3 justify-center md:hidden",children:[a.jsxs("div",{className:"flex items-center border border-border rounded-lg bg-surface-2/30 p-0.5",children:[a.jsx(fe,{variant:z==="day"?"default":"ghost",size:"sm",className:"h-8 px-3 text-xs font-medium",onClick:()=>W("day"),children:"Dia"}),a.jsx(fe,{variant:z==="week"?"default":"ghost",size:"sm",className:"h-8 px-3 text-xs font-medium",onClick:()=>W("week"),children:"Semana"})]}),a.jsxs(bb,{children:[a.jsx(wb,{asChild:!0,children:a.jsxs(fe,{variant:"outline",size:"sm",className:"gap-2",disabled:Dr.length===0,children:[a.jsx(UF,{className:"h-4 w-4"})," Filtros"]})}),a.jsxs(xx,{align:"end",className:"w-64",children:[a.jsxs("div",{className:"flex items-center justify-between px-2 py-1.5",children:[a.jsx(MT,{className:"p-0",children:"Exibio"}),a.jsx(fe,{variant:"ghost",size:"sm",className:"h-7 text-xs text-text-muted hover:text-text-primary",onClick:()=>Qe({scheduled:!0,available:!0,canceledOnly:!1,pendingPayments:!1}),children:"Limpar"})]}),a.jsx(f_,{}),a.jsx(Nl,{onClick:G=>G.preventDefault(),children:a.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Bs,{className:"h-4 w-4 text-text-muted"}),a.jsx("span",{children:"Agendados"})]}),a.jsx(za,{checked:he.scheduled,onCheckedChange:G=>Qe(re=>({...re,scheduled:!!G,canceledOnly:G?!1:re.canceledOnly}))})]})}),a.jsx(Nl,{onClick:G=>G.preventDefault(),children:a.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(vI,{className:"h-4 w-4 text-text-muted"}),a.jsx("span",{children:"Livres"})]}),a.jsx(za,{checked:he.available,onCheckedChange:G=>Qe(re=>({...re,available:!!G,canceledOnly:G?!1:re.canceledOnly}))})]})}),a.jsx(Nl,{onClick:G=>G.preventDefault(),children:a.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qp,{className:"h-4 w-4 text-rose-400"}),a.jsx("span",{children:"Cancelados"})]}),a.jsx(za,{checked:he.canceledOnly,onCheckedChange:G=>{const re=!!G;Qe(we=>({...we,canceledOnly:re,scheduled:re?!1:we.scheduled,available:re?!1:we.available})),re&&!ot&&He(!0)}})]})}),a.jsx(Nl,{onClick:G=>G.preventDefault(),children:a.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ei,{className:"h-4 w-4 text-warning"}),a.jsx("span",{children:"Pagamentos Pendentes"})]}),a.jsx(za,{checked:he.pendingPayments,onCheckedChange:G=>Qe(re=>({...re,pendingPayments:!!G}))})]})})]})]}),a.jsxs("div",{className:"relative inline-block group",children:[a.jsx(fe,{variant:$?"default":"ghost",size:"icon",className:"h-8 w-8",onClick:()=>X(!$),"aria-label":$?"Minimizar grid":"Expandir grid",children:$?a.jsx($F,{className:"h-4 w-4"}):a.jsx(FF,{className:"h-4 w-4"})}),a.jsx("div",{className:"hidden group-hover:block absolute right-0 mt-1 z-50 pointer-events-none",children:a.jsx("div",{className:"px-2 py-1 rounded-md bg-surface-2 text-xs text-text-primary border border-border shadow",children:$?"Minimizar (F10)":"Expandir (F10)"})})]}),a.jsx(fe,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>H(!0),disabled:Dr.length===0,"aria-label":"Configurar agenda",title:"Configurar agenda",children:a.jsx(Ad,{className:"h-5 w-5"})})]}),a.jsxs("div",{className:"flex items-center gap-3 justify-end flex-shrink-0",children:[a.jsxs("div",{className:"relative w-full sm:w-56",children:[a.jsx(Zs,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(rt,{placeholder:"Buscar agendamento...",className:"pl-9",value:Qt,onChange:G=>fn(G.target.value),onBlur:()=>fn("")}),Qt&&a.jsx("button",{type:"button","aria-label":"Limpar busca",className:"absolute right-2 top-1/2 -translate-y-1/2 px-2 py-0.5 rounded text-xs font-medium text-primary hover:bg-surface-2",onClick:()=>fn(""),children:"Limpar"})]}),a.jsxs(fe,{size:"sm",onClick:()=>{or(null),tn(null),pt()},"aria-label":"Novo agendamento",className:"gap-2",disabled:Dr.length===0||Fr.every(G=>ye[G]&&!ye[G].funciona),children:[a.jsx(Ja,{className:"h-4 w-4"})," Agendar"]})]}),Fr.length>0&&a.jsx("div",{className:"md:hidden flex justify-center",children:Fr.length===1?a.jsxs("div",{className:"inline-flex items-center justify-center gap-3 px-4 py-2 rounded-lg w-auto h-10 max-w-full border-2 border-brand/30 bg-gradient-to-r from-brand/5 to-brand/10",children:[a.jsx("div",{className:"h-3 w-3 rounded-full shadow-sm",style:{backgroundColor:$m(Fr[0])}}),a.jsx("span",{className:"font-semibold text-sm text-center whitespace-nowrap truncate",children:Fr[0]})]}):a.jsxs(vn,{value:Fr[Pt%Fr.length],onValueChange:G=>{const re=Fr.indexOf(G);re!==-1&&lr(re)},children:[a.jsx(hn,{className:"w-48 h-10 border-2 border-brand/30 bg-gradient-to-r from-brand/5 to-brand/10 hover:border-brand/50 hover:bg-gradient-to-r hover:from-brand/10 hover:to-brand/15 transition-all shadow-sm",children:a.jsx(wn,{placeholder:"Selecionar quadra"})}),a.jsx(pn,{className:"border-brand/30",children:Fr.map(G=>{const re=$m(G);return a.jsx(ct,{value:G,children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"h-3 w-3 rounded-full shadow-sm",style:{backgroundColor:re}}),a.jsx("span",{className:"font-semibold",children:G})]})},G)})})]})}),a.jsxs("div",{className:"hidden md:flex items-center gap-3 justify-end",children:[a.jsxs("div",{className:"flex items-center border border-border rounded-lg bg-surface-2/30 p-0.5",children:[a.jsx(fe,{variant:z==="day"?"default":"ghost",size:"sm",className:"h-8 px-3 text-xs font-medium",onClick:()=>W("day"),children:"Dia"}),a.jsx(fe,{variant:z==="week"?"default":"ghost",size:"sm",className:"h-8 px-3 text-xs font-medium",onClick:()=>W("week"),children:"Semana"})]}),a.jsxs(bb,{children:[a.jsx(wb,{asChild:!0,children:a.jsxs(fe,{variant:"outline",size:"sm",className:"gap-2",disabled:Dr.length===0,children:[a.jsx(UF,{className:"h-4 w-4"})," Filtros"]})}),a.jsxs(xx,{align:"end",className:"w-64",children:[a.jsxs("div",{className:"flex items-center justify-between px-2 py-1.5",children:[a.jsx(MT,{className:"p-0",children:"Exibio"}),a.jsx(fe,{variant:"ghost",size:"sm",className:"h-7 text-xs text-text-muted hover:text-text-primary",onClick:()=>Qe({scheduled:!0,available:!0,canceledOnly:!1,pendingPayments:!1}),children:"Limpar"})]}),a.jsx(f_,{}),a.jsx(Nl,{onClick:G=>G.preventDefault(),children:a.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Bs,{className:"h-4 w-4 text-text-muted"}),a.jsx("span",{children:"Agendados"})]}),a.jsx(za,{checked:he.scheduled,onCheckedChange:G=>Qe(re=>({...re,scheduled:!!G,canceledOnly:G?!1:re.canceledOnly}))})]})}),a.jsx(Nl,{onClick:G=>G.preventDefault(),children:a.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(vI,{className:"h-4 w-4 text-text-muted"}),a.jsx("span",{children:"Livres"})]}),a.jsx(za,{checked:he.available,onCheckedChange:G=>Qe(re=>({...re,available:!!G,canceledOnly:G?!1:re.canceledOnly}))})]})}),a.jsx(Nl,{onClick:G=>G.preventDefault(),children:a.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qp,{className:"h-4 w-4 text-rose-400"}),a.jsx("span",{children:"Cancelados"})]}),a.jsx(za,{checked:he.canceledOnly,onCheckedChange:G=>{const re=!!G;Qe(we=>({...we,canceledOnly:re,scheduled:re?!1:we.scheduled,available:re?!1:we.available})),re&&!ot&&He(!0)}})]})}),a.jsx(Nl,{onClick:G=>G.preventDefault(),children:a.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ei,{className:"h-4 w-4 text-warning"}),a.jsx("span",{children:"Pagamentos Pendentes"})]}),a.jsx(za,{checked:he.pendingPayments,onCheckedChange:G=>Qe(re=>({...re,pendingPayments:!!G}))})]})})]})]}),a.jsxs("div",{className:"relative inline-block group",children:[a.jsx(fe,{variant:$?"default":"ghost",size:"icon",className:"h-8 w-8",onClick:()=>X(!$),"aria-label":$?"Minimizar grid":"Expandir grid",children:$?a.jsx($F,{className:"h-4 w-4"}):a.jsx(FF,{className:"h-4 w-4"})}),a.jsx("div",{className:"hidden group-hover:block absolute right-0 mt-1 z-50 pointer-events-none",children:a.jsx("div",{className:"px-2 py-1 rounded-md bg-surface-2 text-xs text-text-primary border border-border shadow",children:$?"Minimizar (F10)":"Expandir (F10)"})})]}),a.jsx(fe,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>H(!0),disabled:Dr.length===0,"aria-label":"Configurar agenda",title:"Configurar agenda",children:a.jsx(Ad,{className:"h-5 w-5"})})]})]})]})}),a.jsx(mn,{open:K,onOpenChange:G=>{G||it(lt),H(G)},children:a.jsxs(un,{className:"sm:max-w-[680px]",onOpenAutoFocus:G=>G.preventDefault(),children:[a.jsx(on,{className:"pb-3 border-b border-border bg-surface-2/40 rounded-t-lg px-2 -mx-2 -mt-2",children:a.jsx(an,{className:"text-base font-semibold tracking-tight",children:"Configuraes da Agenda"})}),a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-secondary",children:[a.jsx(Ro,{className:"h-4 w-4",style:{color:di.confirmed.hex}}),a.jsx("span",{className:"text-sm font-medium",children:"Confirmao automtica"})]}),a.jsxs("div",{className:"rounded-lg border border-border bg-surface-2/40 p-4 space-y-3",style:{borderLeftWidth:3,borderLeftColor:di.confirmed.hex},children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(za,{id:"autoConfirmEnabled",checked:Le.autoConfirmEnabled,onCheckedChange:G=>it(re=>({...re,autoConfirmEnabled:!!G}))}),a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx("span",{className:"inline-block w-2 h-2 rounded-full",style:{backgroundColor:di.confirmed.hex}}),a.jsx(qe,{htmlFor:"autoConfirmEnabled",className:"font-medium",children:"Confirmao automtica"})]})]})}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(qe,{htmlFor:"autoconfirm-hours",className:"text-sm text-text-muted",children:"Confirmar se faltar"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(vn,{value:String(Math.max(0,Math.round((Le.autoConfirmMinutesBefore||0)/60))),onValueChange:G=>it(re=>({...re,autoConfirmMinutesBefore:Math.max(0,Number(G))*60})),disabled:!Le.autoConfirmEnabled,children:[a.jsx(hn,{className:"w-32",children:a.jsx(wn,{placeholder:"Horas"})}),a.jsxs(pn,{align:"start",children:[a.jsx(ct,{value:"0",children:"Imediato"}),a.jsx(ct,{value:"1",children:"1 h"}),a.jsx(ct,{value:"2",children:"2 h"}),a.jsx(ct,{value:"3",children:"3 h"}),a.jsx(ct,{value:"4",children:"4 h"}),a.jsx(ct,{value:"6",children:"6 h"}),a.jsx(ct,{value:"8",children:"8 h"}),a.jsx(ct,{value:"12",children:"12 h"}),a.jsx(ct,{value:"24",children:"24 h"})]})]}),a.jsx("span",{className:"text-sm text-text-muted",children:"antes"})]})]})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-secondary",children:[a.jsx(eG,{className:"h-4 w-4",style:{color:di.in_progress.hex}}),a.jsx("span",{className:"text-sm font-medium",children:"Transies automticas"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"rounded-lg border border-border bg-surface-2/40 p-4 space-y-2",style:{borderLeftWidth:3,borderLeftColor:di.in_progress.hex},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(za,{id:"autoStartEnabled",checked:Le.autoStartEnabled,onCheckedChange:G=>it(re=>({...re,autoStartEnabled:!!G}))}),a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx("span",{className:"inline-block w-2 h-2 rounded-full",style:{backgroundColor:di.in_progress.hex}}),a.jsx(qe,{htmlFor:"autoStartEnabled",className:"font-medium",children:"Iniciar no horrio"})]})]}),a.jsx("p",{className:"text-xs text-text-muted ml-7",children:"Confirmado  Em andamento no horrio de incio."})]}),a.jsxs("div",{className:"rounded-lg border border-border bg-surface-2/40 p-4 space-y-2",style:{borderLeftWidth:3,borderLeftColor:di.finished.hex},children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(za,{id:"autoFinishEnabled",checked:Le.autoFinishEnabled,onCheckedChange:G=>it(re=>({...re,autoFinishEnabled:!!G}))}),a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx("span",{className:"inline-block w-2 h-2 rounded-full",style:{backgroundColor:di.finished.hex}}),a.jsx(qe,{htmlFor:"autoFinishEnabled",className:"font-medium",children:"Finalizar ao trmino"})]})]}),a.jsx("p",{className:"text-xs text-text-muted ml-7",children:"Em andamento  Finalizado no horrio de trmino."})]})]})]})]}),a.jsxs(Qn,{className:"mt-2 gap-2",children:[a.jsx(fe,{type:"button",variant:"ghost",className:"border border-white/10",onClick:()=>H(!1),children:"Cancelar"}),a.jsx(fe,{type:"button",variant:"default",onClick:()=>{console.log(" BOTO SALVAR CLICADO!"),ol()},disabled:Ve,children:Ve?"Salvando":"Salvar"})]})]})}),a.jsx(mn,{open:se,onOpenChange:He,children:a.jsxs(un,{className:"sm:max-w-[520px]",onOpenAutoFocus:G=>G.preventDefault(),children:[a.jsxs(on,{children:[a.jsx(an,{children:"Sobre agendamentos cancelados"}),a.jsx(Nn,{children:"Agendamentos cancelados no aparecem na agenda quando o filtro no est selecionado e no ocupam horrio."})]}),a.jsxs("div",{className:"flex items-start gap-3 mt-2",children:[a.jsx(za,{id:"hide-canceled-info",checked:ot,onCheckedChange:G=>ee(!!G),className:"mt-0.5"}),a.jsx(qe,{htmlFor:"hide-canceled-info",className:"text-sm cursor-pointer text-text-secondary",children:"No mostrar novamente"})]}),a.jsx(Qn,{className:"mt-4",children:a.jsx(fe,{type:"button",onClick:()=>He(!1),children:"Entendi"})})]})}),!ir&&Dr.length===0&&a.jsxs("div",{className:"mb-4 p-4 rounded-lg border border-border bg-surface text-sm flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:"Nenhuma quadra encontrada"}),a.jsx("div",{className:"text-text-muted",children:"Cadastre suas quadras para comear a usar a agenda."})]}),a.jsx(fe,{asChild:!0,className:"w-full sm:w-auto",children:a.jsxs(y4,{to:"/quadras",children:[a.jsx("span",{className:"hidden sm:inline",children:"Ir para Cadastros  Quadras"}),a.jsx("span",{className:"sm:hidden",children:"Adicionar"})]})})]}),ue?a.jsx("div",{className:"mt-4 rounded-xl border border-border bg-surface/70 shadow-sm backdrop-blur supports-[backdrop-filter]:bg-surface/60",children:a.jsxs("div",{className:"flex items-center justify-center gap-4 px-6 py-8",children:[a.jsx("div",{className:"h-10 w-10 shrink-0 rounded-full border-2 border-border/60 border-t-brand animate-spin"}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-text-primary",children:"Carregando agenda"}),a.jsx("div",{className:"text-xs text-text-muted truncate",children:ne||"Aguarde um instante"}),a.jsx("div",{className:"mt-3 h-1.5 w-56 max-w-[70vw] rounded-full bg-border/40 overflow-hidden",children:a.jsx("div",{className:"h-full w-1/2 bg-gradient-to-r from-brand/30 via-brand to-brand/30 animate-pulse"})})]})]})}):a.jsxs(a.Fragment,{children:[Fr.length>0&&z==="week"&&(()=>{const G=St||Fr[0],re=Kr?J.filter(we=>{const Ce=we.court===G,ke=Ft?.[G]||{},Oe=String(ke.id||ke.codigo||""),oe=Oe&&String(we.court_id||"")===Oe;return Ce||oe}):J;return a.jsx(a.Fragment,{children:a.jsx(iZe,{weekStart:Rm(D),weekBookings:re,activeCourtFilter:G,courtsMap:Ft,participantsByAgendamento:tr,onBookingClick:we=>{or(we),ht(!0)},onSlotClick:(we,Ce)=>{or(null);const ke=we.getHours()*60+we.getMinutes(),Oe=Ce||St||Fr[0],oe=cr(we,"yyyy-MM-dd"),Ee=Ft?.[Oe]?.id,Ie=(()=>{try{return(me||[]).filter(Gt=>{const Bt=Gt.court===Oe,Ht=Ee!=null&&String(Gt.court_id||"")===String(Ee);return(Bt||Ht)&&cr(Gt.start,"yyyy-MM-dd")===oe&&Gt.status!=="canceled"}).map(Gt=>Iu(Gt.start)*60+Ou(Gt.start)).filter(Gt=>Gt>ke).sort((Gt,Bt)=>Gt-Bt)[0]}catch{}})(),tt=(()=>{const Gt=Ft[Oe]?.hora_fim;if(!Gt)return po*60;const[Bt,Ht]=String(Gt).split(":").map(Number);return(Bt===0&&(Ht||0)===0?24:Bt)*60+(Ht||0)})(),vt=typeof Ie=="number"?Ie:tt;let Rt=Math.min(ke+60,vt);Rt-ke<30&&(vt-30>=ke?Rt=vt:Rt=Math.min(tt,ke+30));const At={date:_s(we),court:Oe,startMinutes:ke,endMinutes:Rt};console.log("onSlotClick in AgendaPage - BEFORE setPrefill",{slotDate:we,court:Ce,activeCourtFilter:St,selectedCourts:Fr,startMinutes:ke,endMinutes:Rt,prefillData:At}),tn(At),console.log("onSlotClick in AgendaPage - AFTER setPrefill (state not updated yet)"),pt()},statusConfig:di,dayStartHour:Es,dayEndHourExclusive:po,weekDiasFuncionamento:Q,sidebarVisible:e},`weekly-${G}`)})})(),Fr.length>0&&z==="day"&&(()=>{const G=typeof window<"u"&&window.innerWidth<768,re=G?[Fr[Pt%Fr.length]]:St?[St]:Fr,we=G?re[0]:St,Ce=(()=>{if(we&&Ft[we]){const oe=Ft[we],Ee=oe.hora_inicio||`${Es}:00:00`,Ie=oe.hora_fim||`${po}:00:00`,[tt]=String(Ee).split(":").map(Number),[vt,Rt]=String(Ie).split(":").map(Number);let At=vt===0&&Rt===0?24:vt;return Rt>0&&At<24&&(At+=1),{start:tt||Es,end:At||po}}return{start:Es,end:po}})(),ke=Array.from({length:Math.max(0,Ce.end-Ce.start)},(oe,Ee)=>Ce.start+Ee),Oe=Math.max(0,Ce.end-Ce.start)*(60/Pa)*Ti;return re.some(oe=>ye[oe]&&!ye[oe].funciona),a.jsx(a.Fragment,{children:a.jsx(xr.div,{variants:Ze?void 0:Z9,className:pr("bg-surface fx-scroll","overflow-auto",G?"":"rounded-lg border border-border"),ref:ar,style:{flex:"1 1 auto",minWidth:0},children:a.jsxs("div",{className:pr("grid",!G&&"mx-auto"),style:{gridTemplateColumns:G?"60px 1fr":re.length===1?"120px 760px":re.length===2?"120px repeat(2, 520px)":`120px repeat(${re.length}, 1fr)`,width:G?"100%":re.length<=2?"fit-content":void 0,columnGap:G?"4px":"16px"},children:[a.jsxs("div",{className:"sticky left-0 bg-surface z-20",children:[a.jsx("div",{className:"sticky top-0 z-20 h-14 border-b border-r border-border bg-surface flex items-center justify-center px-2",children:a.jsxs(bb,{children:[a.jsx(wb,{asChild:!0,children:a.jsx(fe,{size:"sm",variant:"ghost",className:"hover:bg-surface-2/50 text-lg font-semibold",children:nl(D,new Date)?"Hoje":cr(D,"EEEE",{locale:na})})}),a.jsxs(xx,{align:"center",children:[a.jsx(Nl,{onClick:()=>U(new Date),children:"Hoje"}),a.jsx(f_,{}),(()=>{const oe=["Segunda","Tera","Quarta","Quinta","Sexta","Sbado","Domingo"],Ee=Dd(D,{weekStartsOn:1,locale:na});return oe.map((Ie,tt)=>a.jsx(Nl,{onClick:()=>U(Ta(Ee,tt)),children:Ie},Ie))})()]})]})}),ke.map(oe=>a.jsxs("div",{className:pr("border-r border-border",oe%2===1&&"bg-surface-2/30"),children:[a.jsx("div",{className:"relative border-b border-border/80",style:{height:Ti},children:a.jsxs("span",{className:pr("absolute left-1/2 -translate-x-1/2 top-1/2 -translate-y-1/2 bg-surface rounded font-bold",G?"px-1 text-sm":"px-2 text-lg"),children:[String(oe).padStart(2,"0"),":00"]})}),a.jsx("div",{className:"relative border-b border-border/80",style:{height:Ti},children:a.jsxs("span",{className:pr("absolute left-1/2 -translate-x-1/2 top-1/2 -translate-y-1/2 bg-surface rounded font-bold",G?"px-1 text-sm":"px-2 text-lg"),children:[String(oe).padStart(2,"0"),":30"]})})]},`time-${oe}`))]}),re.map((oe,Ee)=>a.jsxs("div",{className:"relative border-r border-border",children:[a.jsx("div",{className:"h-14 border-b border-border sticky top-0 bg-surface z-10 flex items-center justify-center",children:Ee===0&&a.jsxs("div",{className:"flex items-center justify-center gap-4 px-3",children:[mt.totalBookings>0&&a.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-md bg-surface-2/50",children:[a.jsx("span",{className:"text-lg",children:""}),a.jsx("span",{className:"font-bold text-text-primary",children:mt.totalBookings}),a.jsxs("span",{className:"font-semibold text-xs text-text-muted",children:["agendamento",mt.totalBookings!==1?"s":""]})]}),mt.totalPendingPayments>0&&a.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-md bg-surface-2/50",children:[a.jsx("span",{className:"text-lg",children:""}),a.jsx("span",{className:"font-bold text-text-primary",children:mt.totalPendingPayments}),a.jsxs("span",{className:"font-semibold text-xs text-text-muted",children:["pendente",mt.totalPendingPayments!==1?"s":""]})]}),Y&&!G&&a.jsxs("button",{type:"button",onClick:async()=>{const Ie=await ce(Y),tt=Y.replace(/^https?:\/\//,"");try{navigator.vibrate&&navigator.vibrate(50)}catch{}if(Ie)if(typeof window<"u"&&window.innerWidth<640)try{alert(`Link copiado: ${tt}`)}catch{}else t({title:"Link copiado",description:tt});else t({title:"No foi possvel copiar",description:tt,variant:"destructive"})},className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-md text-xs border border-white/10 bg-surface/60 hover:bg-surface-2/70 hover:border-white/20 transition-colors","aria-label":"Copiar link de agendamento",title:"Copiar link de agendamento",children:[a.jsx(Due,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"link Agendamento"}),a.jsx("span",{className:"sm:hidden",children:a.jsx(YH,{className:"w-4 h-4"})})]})]})}),a.jsxs("div",{className:pr("relative"),style:{height:Oe},children:[ye[oe]&&!ye[oe].funciona?(()=>ke.map(Ie=>a.jsx("div",{className:"absolute w-full cursor-not-allowed bg-surface/60 flex items-center justify-center border-b border-border/30 transition-colors",style:{height:Ti*2,top:ke.indexOf(Ie)*Ti*2},children:a.jsxs("div",{className:"text-center pointer-events-none",children:[a.jsx(j4,{className:"h-5 w-5 text-text-primary mx-auto mb-1"}),a.jsx("div",{className:"text-xs font-medium text-text-primary mb-1",children:"Fechada"}),ye[oe].observacao&&a.jsx("div",{className:"text-xs text-text-muted",children:ye[oe].observacao})]})},`closed-${oe}-${Ie}`)))():null,(he.scheduled||he.canceledOnly||he.pendingPayments)&&(()=>{const Ie=Ce.start*60,tt=Ce.end*60,vt=(()=>{const Kn=Ft[oe]?.hora_inicio,Un=Ft[oe]?.hora_fim,[Ir,Er]=String(Kn||`${Ce.start}:00:00`).split(":").map(Number),[Br,zr]=String(Un||`${Ce.end}:00:00`).split(":").map(Number),en=Br===0&&zr===0?24:Br||0;return{start:(Ir||0)*60+(Er||0),end:en*60+(zr||0)}})(),Rt=Math.max(vt.start,Ie),At=Math.min(vt.end,tt),Gt=Math.max(0,Math.floor((Rt-Ie)/Pa)),Bt=Math.max(Gt,Math.ceil((At-Ie)/Pa)),Ht=Math.max(0,(tt-Ie)/Pa),jr=Gt*Ti,vr=Math.min(Ht,Math.max(0,Bt-Gt)),xn=Math.max(0,(Ht-Bt)*Ti);return a.jsxs(a.Fragment,{children:[jr>0&&a.jsx("div",{style:{height:jr}}),Array.from({length:vr},(Kn,Un)=>{const Ir=Gt+Un,Br=(Math.floor(Ir/(60/Pa))+Math.floor(Ie/60))%2===1;return a.jsx("div",{className:pr("border-b border-border/80",Br&&"bg-surface-2/30"),style:{height:Ti}},`base-${oe}-slot-${Ir}`)}),xn>0&&a.jsx("div",{style:{height:xn}})]})})(),We.filter(Ie=>{if(!Kr)return!0;const tt=Ie.court===oe,vt=Ft?.[oe]||{},Rt=String(vt.id||vt.codigo||""),At=Rt&&String(Ie.court_id||"")===Rt;return tt||At}).map(Ie=>a.jsx(L,{booking:Ie,courtGridStart:Ce.start*60,courtGridEnd:Ce.end*60},Ie.id)),he.available&&!(ye[oe]&&!ye[oe].funciona)&&(()=>{const Ie=(()=>{const vr=Ft[oe]?.hora_inicio;if(!vr)return Es*60;const[xn,Kn]=String(vr).split(":").map(Number);return xn*60+(Kn||0)})(),tt=(()=>{const vr=Ft[oe]?.hora_fim;if(!vr)return po*60;const[xn,Kn]=String(vr).split(":").map(Number);return(xn===0&&Kn===0?24:xn)*60+(Kn||0)})(),vt=vr=>{const xn=Iu(vr),Kn=Ou(vr);return xn===0&&Kn===0?1440:xn*60+Kn},Rt=cr(D,"yyyy-MM-dd"),At=Ft?.[oe]?.id,Gt=me.filter(vr=>{const xn=vr.court===oe,Kn=At!=null&&String(vr.court_id||"")===String(At);return(xn||Kn)&&cr(vr.start,"yyyy-MM-dd")===Rt&&vr.status!=="canceled"}).map(vr=>[vt(vr.start),vt(vr.end)]).sort((vr,xn)=>vr[0]-xn[0]),Bt=[];let Ht=Ie;for(const[vr,xn]of Gt)vr>Ht&&Bt.push([Ht,vr]),Ht=Math.max(Ht,xn);Ht<tt&&Bt.push([Ht,tt]);const jr=({startM:vr,endM:xn})=>{const[Kn,Un]=p.useState(null),Ir=Ce.start*60,Er=Math.floor((vr-Ir)/Pa),Br=Math.max(1,Math.ceil((xn-vr)/Pa)),zr=Er+Br,en=Er*Ti-1,cn=(zr-Er)*Ti+2;let mr=Math.floor(vr/60),Ur=Math.floor(xn/60);mr>=24&&(mr=mr%24),Ur>=24&&(Ur=Ur%24);const gr=`${String(mr).padStart(2,"0")}:${String(vr%60).padStart(2,"0")}`,_r=`${String(Ur).padStart(2,"0")}:${String(xn%60).padStart(2,"0")}`;return a.jsxs("div",{className:pr("absolute left-2 right-2 rounded-md border-2 border-dashed text-sm z-0 cursor-pointer","border-[#10B981]","bg-transparent hover:border-[#10B981]/80 hover:shadow-sm"),style:{top:`${en}px`,height:`${cn}px`},onMouseMove:Xt=>{const Lr=Xt.currentTarget.getBoundingClientRect(),br=Math.min(Math.max(0,Xt.clientY-Lr.top),Lr.height);let Gr=Math.floor(br/Ti);Gr=Math.max(0,Math.min(Gr,Br-1)),Un(Gr)},onMouseLeave:()=>Un(null),onClick:Xt=>{const Lr=Xt.currentTarget.getBoundingClientRect(),br=Math.min(Math.max(0,Xt.clientY-Lr.top),Lr.height),Gr=Math.floor(br/Ti);let yn=vr+Gr*Pa;yn=Math.max(vr,Math.min(yn,xn-Pa));const Zr=(()=>{const Ca=Ft?.[oe]?.id;return me.filter(es=>{const ka=es.court===oe,ma=Ca!=null&&String(es.court_id||"")===String(Ca);return(ka||ma)&&cr(es.start,"yyyy-MM-dd")===Rt}).map(es=>Iu(es.start)*60+Ou(es.start)).filter(es=>es>yn).sort((es,ka)=>es-ka)[0]})(),kn=typeof Zr=="number"?Zr:tt;let ya=Math.min(yn+60,kn);if(ya-yn<30){const Ca=kn-30;Ca>=vr?(yn=Math.max(vr,Math.min(yn,Ca)),ya=kn):(yn=vr,ya=Math.min(kn,xn))}or(null);{const Ca=Dr||[],ks=Ca.includes(oe)?oe:Ca[0]||"";tn({court:ks,date:D,startMinutes:yn,endMinutes:ya})}try{lastNonEmptySelectionRef.current=[],setChipsSnapshot([])}catch{}pt()},title:`Livre: ${gr}${_r}`,children:[Kn!==null&&a.jsx("div",{className:"pointer-events-none absolute left-[6px] right-[6px] rounded-md border border-white/10 bg-white/5",style:{top:`${Kn*Ti}px`,height:`${Ti}px`}}),a.jsxs("div",{className:"h-full px-3 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"font-medium text-[#10B981]",children:"Livre"}),a.jsxs("span",{className:"text-text-muted",children:[gr,"",_r]})]})]})};return Bt.map(([vr,xn],Kn)=>a.jsx(jr,{startM:vr,endM:xn},`free-${oe}-${Kn}`))})()]})]},oe))]})})})})()]})]}),ge()]})}function tU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function rU(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tU(Object(r),!0).forEach(function(n){Q1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Kl(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var nU=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),XE=function(){return Math.random().toString(36).substring(7).split("").join(".")},aU={INIT:"@@redux/INIT"+XE(),REPLACE:"@@redux/REPLACE"+XE(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+XE()}};function fZe(e){if(typeof e!="object"||e===null)return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function jae(e,t,r){var n;if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Kl(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Kl(1));return r(jae)(e,t)}if(typeof e!="function")throw new Error(Kl(2));var s=e,o=t,i=[],l=i,c=!1;function d(){l===i&&(l=i.slice())}function u(){if(c)throw new Error(Kl(3));return o}function f(g){if(typeof g!="function")throw new Error(Kl(4));if(c)throw new Error(Kl(5));var y=!0;return d(),l.push(g),function(){if(y){if(c)throw new Error(Kl(6));y=!1,d();var b=l.indexOf(g);l.splice(b,1),i=null}}}function h(g){if(!fZe(g))throw new Error(Kl(7));if(typeof g.type>"u")throw new Error(Kl(8));if(c)throw new Error(Kl(9));try{c=!0,o=s(o,g)}finally{c=!1}for(var y=i=l,x=0;x<y.length;x++){var b=y[x];b()}return g}function m(g){if(typeof g!="function")throw new Error(Kl(10));s=g,h({type:aU.REPLACE})}function v(){var g,y=f;return g={subscribe:function(b){if(typeof b!="object"||b===null)throw new Error(Kl(11));function w(){b.next&&b.next(u())}w();var j=y(w);return{unsubscribe:j}}},g[nU]=function(){return this},g}return h({type:aU.INIT}),n={dispatch:h,subscribe:f,getState:u,replaceReducer:m},n[nU]=v,n}function sU(e,t){return function(){return t(e.apply(this,arguments))}}function oU(e,t){if(typeof e=="function")return sU(e,t);if(typeof e!="object"||e===null)throw new Error(Kl(16));var r={};for(var n in e){var s=e[n];typeof s=="function"&&(r[n]=sU(s,t))}return r}function _ae(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.length===0?function(n){return n}:t.length===1?t[0]:t.reduce(function(n,s){return function(){return n(s.apply(void 0,arguments))}})}function mZe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(n){return function(){var s=n.apply(void 0,arguments),o=function(){throw new Error(Kl(15))},i={getState:s.getState,dispatch:function(){return o.apply(void 0,arguments)}},l=t.map(function(c){return c(i)});return o=_ae.apply(void 0,l)(s.dispatch),rU(rU({},s),{},{dispatch:o})}}}var Nae=Pe.createContext(null);function hZe(e){e()}var Sae=hZe,pZe=function(t){return Sae=t},gZe=function(){return Sae};function vZe(){var e=gZe(),t=null,r=null;return{clear:function(){t=null,r=null},notify:function(){e(function(){for(var s=t;s;)s.callback(),s=s.next})},get:function(){for(var s=[],o=t;o;)s.push(o),o=o.next;return s},subscribe:function(s){var o=!0,i=r={callback:s,next:null,prev:r};return i.prev?i.prev.next=i:t=i,function(){!o||t===null||(o=!1,i.next?i.next.prev=i.prev:r=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}var iU={notify:function(){},get:function(){return[]}};function Cae(e,t){var r,n=iU;function s(f){return c(),n.subscribe(f)}function o(){n.notify()}function i(){u.onStateChange&&u.onStateChange()}function l(){return!!r}function c(){r||(r=t?t.addNestedSub(i):e.subscribe(i),n=vZe())}function d(){r&&(r(),r=void 0,n.clear(),n=iU)}var u={addNestedSub:s,notifyNestedSubs:o,handleChangeWrapper:i,isSubscribed:l,trySubscribe:c,tryUnsubscribe:d,getListeners:function(){return n}};return u}var Pae=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?p.useLayoutEffect:p.useEffect;function xZe(e){var t=e.store,r=e.context,n=e.children,s=p.useMemo(function(){var l=Cae(t);return{store:t,subscription:l}},[t]),o=p.useMemo(function(){return t.getState()},[t]);Pae(function(){var l=s.subscription;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),o!==t.getState()&&l.notifyNestedSubs(),function(){l.tryUnsubscribe(),l.onStateChange=null}},[s,o]);var i=r||Nae;return Pe.createElement(i.Provider,{value:s},n)}var Aae={exports:{}},ds={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ni=typeof Symbol=="function"&&Symbol.for,gR=Ni?Symbol.for("react.element"):60103,vR=Ni?Symbol.for("react.portal"):60106,Q5=Ni?Symbol.for("react.fragment"):60107,Z5=Ni?Symbol.for("react.strict_mode"):60108,eP=Ni?Symbol.for("react.profiler"):60114,tP=Ni?Symbol.for("react.provider"):60109,rP=Ni?Symbol.for("react.context"):60110,xR=Ni?Symbol.for("react.async_mode"):60111,nP=Ni?Symbol.for("react.concurrent_mode"):60111,aP=Ni?Symbol.for("react.forward_ref"):60112,sP=Ni?Symbol.for("react.suspense"):60113,yZe=Ni?Symbol.for("react.suspense_list"):60120,oP=Ni?Symbol.for("react.memo"):60115,iP=Ni?Symbol.for("react.lazy"):60116,bZe=Ni?Symbol.for("react.block"):60121,wZe=Ni?Symbol.for("react.fundamental"):60117,jZe=Ni?Symbol.for("react.responder"):60118,_Ze=Ni?Symbol.for("react.scope"):60119;function Jc(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case gR:switch(e=e.type,e){case xR:case nP:case Q5:case eP:case Z5:case sP:return e;default:switch(e=e&&e.$$typeof,e){case rP:case aP:case iP:case oP:case tP:return e;default:return t}}case vR:return t}}}function Eae(e){return Jc(e)===nP}ds.AsyncMode=xR;ds.ConcurrentMode=nP;ds.ContextConsumer=rP;ds.ContextProvider=tP;ds.Element=gR;ds.ForwardRef=aP;ds.Fragment=Q5;ds.Lazy=iP;ds.Memo=oP;ds.Portal=vR;ds.Profiler=eP;ds.StrictMode=Z5;ds.Suspense=sP;ds.isAsyncMode=function(e){return Eae(e)||Jc(e)===xR};ds.isConcurrentMode=Eae;ds.isContextConsumer=function(e){return Jc(e)===rP};ds.isContextProvider=function(e){return Jc(e)===tP};ds.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===gR};ds.isForwardRef=function(e){return Jc(e)===aP};ds.isFragment=function(e){return Jc(e)===Q5};ds.isLazy=function(e){return Jc(e)===iP};ds.isMemo=function(e){return Jc(e)===oP};ds.isPortal=function(e){return Jc(e)===vR};ds.isProfiler=function(e){return Jc(e)===eP};ds.isStrictMode=function(e){return Jc(e)===Z5};ds.isSuspense=function(e){return Jc(e)===sP};ds.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Q5||e===nP||e===eP||e===Z5||e===sP||e===yZe||typeof e=="object"&&e!==null&&(e.$$typeof===iP||e.$$typeof===oP||e.$$typeof===tP||e.$$typeof===rP||e.$$typeof===aP||e.$$typeof===wZe||e.$$typeof===jZe||e.$$typeof===_Ze||e.$$typeof===bZe)};ds.typeOf=Jc;Aae.exports=ds;var NZe=Aae.exports,yR=NZe,SZe={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},CZe={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},PZe={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},kae={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},bR={};bR[yR.ForwardRef]=PZe;bR[yR.Memo]=kae;function lU(e){return yR.isMemo(e)?kae:bR[e.$$typeof]||SZe}var AZe=Object.defineProperty,EZe=Object.getOwnPropertyNames,cU=Object.getOwnPropertySymbols,kZe=Object.getOwnPropertyDescriptor,IZe=Object.getPrototypeOf,dU=Object.prototype;function Iae(e,t,r){if(typeof t!="string"){if(dU){var n=IZe(t);n&&n!==dU&&Iae(e,n,r)}var s=EZe(t);cU&&(s=s.concat(cU(t)));for(var o=lU(e),i=lU(t),l=0;l<s.length;++l){var c=s[l];if(!CZe[c]&&!(r&&r[c])&&!(i&&i[c])&&!(o&&o[c])){var d=kZe(t,c);try{AZe(e,c,d)}catch{}}}}return e}var OZe=Iae;const uU=Ua(OZe);var Oae={exports:{}},xs={};/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lP=60103,cP=60106,K1=60107,X1=60108,Y1=60114,J1=60109,Q1=60110,Z1=60112,e2=60113,wR=60120,t2=60115,r2=60116,Tae=60121,Dae=60122,Mae=60117,Rae=60129,Lae=60131;if(typeof Symbol=="function"&&Symbol.for){var Di=Symbol.for;lP=Di("react.element"),cP=Di("react.portal"),K1=Di("react.fragment"),X1=Di("react.strict_mode"),Y1=Di("react.profiler"),J1=Di("react.provider"),Q1=Di("react.context"),Z1=Di("react.forward_ref"),e2=Di("react.suspense"),wR=Di("react.suspense_list"),t2=Di("react.memo"),r2=Di("react.lazy"),Tae=Di("react.block"),Dae=Di("react.server.block"),Mae=Di("react.fundamental"),Rae=Di("react.debug_trace_mode"),Lae=Di("react.legacy_hidden")}function Su(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case lP:switch(e=e.type,e){case K1:case Y1:case X1:case e2:case wR:return e;default:switch(e=e&&e.$$typeof,e){case Q1:case Z1:case r2:case t2:case J1:return e;default:return t}}case cP:return t}}}var TZe=J1,DZe=lP,MZe=Z1,RZe=K1,LZe=r2,FZe=t2,$Ze=cP,BZe=Y1,qZe=X1,zZe=e2;xs.ContextConsumer=Q1;xs.ContextProvider=TZe;xs.Element=DZe;xs.ForwardRef=MZe;xs.Fragment=RZe;xs.Lazy=LZe;xs.Memo=FZe;xs.Portal=$Ze;xs.Profiler=BZe;xs.StrictMode=qZe;xs.Suspense=zZe;xs.isAsyncMode=function(){return!1};xs.isConcurrentMode=function(){return!1};xs.isContextConsumer=function(e){return Su(e)===Q1};xs.isContextProvider=function(e){return Su(e)===J1};xs.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===lP};xs.isForwardRef=function(e){return Su(e)===Z1};xs.isFragment=function(e){return Su(e)===K1};xs.isLazy=function(e){return Su(e)===r2};xs.isMemo=function(e){return Su(e)===t2};xs.isPortal=function(e){return Su(e)===cP};xs.isProfiler=function(e){return Su(e)===Y1};xs.isStrictMode=function(e){return Su(e)===X1};xs.isSuspense=function(e){return Su(e)===e2};xs.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===K1||e===Y1||e===Rae||e===X1||e===e2||e===wR||e===Lae||typeof e=="object"&&e!==null&&(e.$$typeof===r2||e.$$typeof===t2||e.$$typeof===J1||e.$$typeof===Q1||e.$$typeof===Z1||e.$$typeof===Mae||e.$$typeof===Tae||e[0]===Dae)};xs.typeOf=Su;Oae.exports=xs;var UZe=Oae.exports,VZe=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],WZe=["reactReduxForwardedRef"],HZe=[],GZe=[null,null];function KZe(e,t){var r=e[1];return[t.payload,r+1]}function fU(e,t,r){Pae(function(){return e.apply(void 0,t)},r)}function XZe(e,t,r,n,s,o,i){e.current=n,t.current=s,r.current=!1,o.current&&(o.current=null,i())}function YZe(e,t,r,n,s,o,i,l,c,d){if(e){var u=!1,f=null,h=function(){if(!u){var g=t.getState(),y,x;try{y=n(g,s.current)}catch(b){x=b,f=b}x||(f=null),y===o.current?i.current||c():(o.current=y,l.current=y,i.current=!0,d({type:"STORE_UPDATED",payload:{error:x}}))}};r.onStateChange=h,r.trySubscribe(),h();var m=function(){if(u=!0,r.tryUnsubscribe(),r.onStateChange=null,f)throw f};return m}}var JZe=function(){return[null,0]};function QZe(e,t){t===void 0&&(t={});var r=t,n=r.getDisplayName,s=n===void 0?function(w){return"ConnectAdvanced("+w+")"}:n,o=r.methodName,i=o===void 0?"connectAdvanced":o,l=r.renderCountProp,c=l===void 0?void 0:l,d=r.shouldHandleStateChanges,u=d===void 0?!0:d,f=r.storeKey,h=f===void 0?"store":f;r.withRef;var m=r.forwardRef,v=m===void 0?!1:m,g=r.context,y=g===void 0?Nae:g,x=YN(r,VZe),b=y;return function(j){var _=j.displayName||j.name||"Component",S=s(_),C=Yn({},x,{getDisplayName:s,methodName:i,renderCountProp:c,shouldHandleStateChanges:u,storeKey:h,displayName:S,wrappedComponentName:_,WrappedComponent:j}),P=x.pure;function A(D){return e(D.dispatch,C)}var R=P?p.useMemo:function(D){return D()};function O(D){var U=p.useMemo(function(){var xt=D.reactReduxForwardedRef,Ze=YN(D,WZe);return[D.context,xt,Ze]},[D]),z=U[0],W=U[1],$=U[2],X=p.useMemo(function(){return z&&z.Consumer&&UZe.isContextConsumer(Pe.createElement(z.Consumer,null))?z:b},[z,b]),ye=p.useContext(X),Se=!!D.store&&!!D.store.getState&&!!D.store.dispatch;ye&&ye.store;var V=Se?D.store:ye.store,B=p.useMemo(function(){return A(V)},[V]),Q=p.useMemo(function(){if(!u)return GZe;var xt=Cae(V,Se?null:ye.subscription),Ze=xt.notifyNestedSubs.bind(xt);return[xt,Ze]},[V,Se,ye]),pe=Q[0],te=Q[1],Y=p.useMemo(function(){return Se?ye:Yn({},ye,{subscription:pe})},[Se,ye,pe]),ce=p.useReducer(KZe,HZe,JZe),me=ce[0],ae=me[0],le=ce[1];if(ae&&ae.error)throw ae.error;var ue=p.useRef(),Re=p.useRef($),ne=p.useRef(),ie=p.useRef(!1),gt=R(function(){return ne.current&&$===Re.current?ne.current:B(V.getState(),$)},[V,ae,$]);fU(XZe,[Re,ue,ie,$,gt,ne,te]),fU(YZe,[u,V,pe,B,Re,ue,ie,ne,te,le],[V,pe,B]);var bt=p.useMemo(function(){return Pe.createElement(j,Yn({},gt,{ref:W}))},[W,j,gt]),at=p.useMemo(function(){return u?Pe.createElement(X.Provider,{value:Y},bt):bt},[X,bt,Y]);return at}var I=P?Pe.memo(O):O;if(I.WrappedComponent=j,I.displayName=O.displayName=S,v){var M=Pe.forwardRef(function(U,z){return Pe.createElement(I,Yn({},U,{reactReduxForwardedRef:z}))});return M.displayName=S,M.WrappedComponent=j,uU(M,j)}return uU(I,j)}}function mU(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function YE(e,t){if(mU(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var s=0;s<r.length;s++)if(!Object.prototype.hasOwnProperty.call(t,r[s])||!mU(e[r[s]],t[r[s]]))return!1;return!0}function ZZe(e,t){var r={},n=function(i){var l=e[i];typeof l=="function"&&(r[i]=function(){return t(l.apply(void 0,arguments))})};for(var s in e)n(s);return r}function jR(e){return function(r,n){var s=e(r,n);function o(){return s}return o.dependsOnOwnProps=!1,o}}function hU(e){return e.dependsOnOwnProps!==null&&e.dependsOnOwnProps!==void 0?!!e.dependsOnOwnProps:e.length!==1}function Fae(e,t){return function(n,s){s.displayName;var o=function(l,c){return o.dependsOnOwnProps?o.mapToProps(l,c):o.mapToProps(l)};return o.dependsOnOwnProps=!0,o.mapToProps=function(l,c){o.mapToProps=e,o.dependsOnOwnProps=hU(e);var d=o(l,c);return typeof d=="function"&&(o.mapToProps=d,o.dependsOnOwnProps=hU(d),d=o(l,c)),d},o}}function eet(e){return typeof e=="function"?Fae(e):void 0}function tet(e){return e?void 0:jR(function(t){return{dispatch:t}})}function ret(e){return e&&typeof e=="object"?jR(function(t){return ZZe(e,t)}):void 0}const net=[eet,tet,ret];function aet(e){return typeof e=="function"?Fae(e):void 0}function set(e){return e?void 0:jR(function(){return{}})}const oet=[aet,set];function iet(e,t,r){return Yn({},r,e,t)}function cet(e){return function(r,n){n.displayName;var s=n.pure,o=n.areMergedPropsEqual,i=!1,l;return function(d,u,f){var h=e(d,u,f);return i?(!s||!o(h,l))&&(l=h):(i=!0,l=h),l}}}function det(e){return typeof e=="function"?cet(e):void 0}function uet(e){return e?void 0:function(){return iet}}const fet=[det,uet];var met=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function het(e,t,r,n){return function(o,i){return r(e(o,i),t(n,i),i)}}function pet(e,t,r,n,s){var o=s.areStatesEqual,i=s.areOwnPropsEqual,l=s.areStatePropsEqual,c=!1,d,u,f,h,m;function v(w,j){return d=w,u=j,f=e(d,u),h=t(n,u),m=r(f,h,u),c=!0,m}function g(){return f=e(d,u),t.dependsOnOwnProps&&(h=t(n,u)),m=r(f,h,u),m}function y(){return e.dependsOnOwnProps&&(f=e(d,u)),t.dependsOnOwnProps&&(h=t(n,u)),m=r(f,h,u),m}function x(){var w=e(d,u),j=!l(w,f);return f=w,j&&(m=r(f,h,u)),m}function b(w,j){var _=!i(j,u),S=!o(w,d,j,u);return d=w,u=j,_&&S?g():_?y():S?x():m}return function(j,_){return c?b(j,_):v(j,_)}}function get(e,t){var r=t.initMapStateToProps,n=t.initMapDispatchToProps,s=t.initMergeProps,o=YN(t,met),i=r(e,o),l=n(e,o),c=s(e,o),d=o.pure?pet:het;return d(i,l,c,e,o)}var vet=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];function JE(e,t,r){for(var n=t.length-1;n>=0;n--){var s=t[n](e);if(s)return s}return function(o,i){throw new Error("Invalid value of type "+typeof e+" for "+r+" argument when connecting component "+i.wrappedComponentName+".")}}function xet(e,t){return e===t}function yet(e){var t=e===void 0?{}:e,r=t.connectHOC,n=r===void 0?QZe:r,s=t.mapStateToPropsFactories,o=s===void 0?oet:s,i=t.mapDispatchToPropsFactories,l=i===void 0?net:i,c=t.mergePropsFactories,d=c===void 0?fet:c,u=t.selectorFactory,f=u===void 0?get:u;return function(m,v,g,y){y===void 0&&(y={});var x=y,b=x.pure,w=b===void 0?!0:b,j=x.areStatesEqual,_=j===void 0?xet:j,S=x.areOwnPropsEqual,C=S===void 0?YE:S,P=x.areStatePropsEqual,A=P===void 0?YE:P,R=x.areMergedPropsEqual,O=R===void 0?YE:R,I=YN(x,vet),M=JE(m,o,"mapStateToProps"),D=JE(v,l,"mapDispatchToProps"),U=JE(g,d,"mergeProps");return n(f,Yn({methodName:"connect",getDisplayName:function(W){return"Connect("+W+")"},shouldHandleStateChanges:!!m,initMapStateToProps:M,initMapDispatchToProps:D,initMergeProps:U,pure:w,areStatesEqual:_,areOwnPropsEqual:C,areStatePropsEqual:A,areMergedPropsEqual:O},I))}}const $ae=yet();pZe(im.unstable_batchedUpdates);function bet(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Bae(e,t){var r=p.useState(function(){return{inputs:t,result:e()}})[0],n=p.useRef(!0),s=p.useRef(r),o=n.current||!!(t&&s.current.inputs&&bet(t,s.current.inputs)),i=o?s.current:{inputs:t,result:e()};return p.useEffect(function(){n.current=!1,s.current=i},[i]),i.result}function wet(e,t){return Bae(function(){return e},t)}var Wa=Bae,Vn=wet,iu=function(t){var r=t.top,n=t.right,s=t.bottom,o=t.left,i=n-o,l=s-r,c={top:r,right:n,bottom:s,left:o,width:i,height:l,x:o,y:r,center:{x:(n+o)/2,y:(s+r)/2}};return c},_R=function(t,r){return{top:t.top-r.top,left:t.left-r.left,bottom:t.bottom+r.bottom,right:t.right+r.right}},pU=function(t,r){return{top:t.top+r.top,left:t.left+r.left,bottom:t.bottom-r.bottom,right:t.right-r.right}},jet=function(t,r){return{top:t.top+r.y,left:t.left+r.x,bottom:t.bottom+r.y,right:t.right+r.x}},QE={top:0,right:0,bottom:0,left:0},NR=function(t){var r=t.borderBox,n=t.margin,s=n===void 0?QE:n,o=t.border,i=o===void 0?QE:o,l=t.padding,c=l===void 0?QE:l,d=iu(_R(r,s)),u=iu(pU(r,i)),f=iu(pU(u,c));return{marginBox:d,borderBox:iu(r),paddingBox:u,contentBox:f,margin:s,border:i,padding:c}},id=function(t){var r=t.slice(0,-2),n=t.slice(-2);if(n!=="px")return 0;var s=Number(r);return isNaN(s)&&Rh(!1),s},_et=function(){return{x:window.pageXOffset,y:window.pageYOffset}},TS=function(t,r){var n=t.borderBox,s=t.border,o=t.margin,i=t.padding,l=jet(n,r);return NR({borderBox:l,border:s,margin:o,padding:i})},DS=function(t,r){return r===void 0&&(r=_et()),TS(t,r)},qae=function(t,r){var n={top:id(r.marginTop),right:id(r.marginRight),bottom:id(r.marginBottom),left:id(r.marginLeft)},s={top:id(r.paddingTop),right:id(r.paddingRight),bottom:id(r.paddingBottom),left:id(r.paddingLeft)},o={top:id(r.borderTopWidth),right:id(r.borderRightWidth),bottom:id(r.borderBottomWidth),left:id(r.borderLeftWidth)};return NR({borderBox:t,margin:n,padding:s,border:o})},zae=function(t){var r=t.getBoundingClientRect(),n=window.getComputedStyle(t);return qae(r,n)},gU=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function Net(e,t){return!!(e===t||gU(e)&&gU(t))}function Cet(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!Net(e[r],t[r]))return!1;return!0}function wi(e,t){t===void 0&&(t=Cet);var r,n=[],s,o=!1;function i(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];return o&&r===this&&t(l,n)||(s=e.apply(this,l),o=!0,r=this,n=l),s}return i}var Pet=function(t){var r=[],n=null,s=function(){for(var i=arguments.length,l=new Array(i),c=0;c<i;c++)l[c]=arguments[c];r=l,!n&&(n=requestAnimationFrame(function(){n=null,t.apply(void 0,r)}))};return s.cancel=function(){n&&(cancelAnimationFrame(n),n=null)},s};const o1=Pet;function Uae(e,t){}Uae.bind(null,"warn");Uae.bind(null,"error");function Ch(){}function Aet(e,t){return Yn({},e,{},t)}function Sd(e,t,r){var n=t.map(function(s){var o=Aet(r,s.options);return e.addEventListener(s.eventName,s.fn,o),function(){e.removeEventListener(s.eventName,s.fn,o)}});return function(){n.forEach(function(o){o()})}}var Eet="Invariant failed";function MS(e){this.message=e}MS.prototype.toString=function(){return this.message};function rn(e,t){if(!e)throw new MS(Eet)}var ket=function(e){yZ(t,e);function t(){for(var n,s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return n=e.call.apply(e,[this].concat(o))||this,n.callbacks=null,n.unbind=Ch,n.onWindowError=function(l){var c=n.getCallbacks();c.isDragging()&&c.tryAbort();var d=l.error;d instanceof MS&&l.preventDefault()},n.getCallbacks=function(){if(!n.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return n.callbacks},n.setCallbacks=function(l){n.callbacks=l},n}var r=t.prototype;return r.componentDidMount=function(){this.unbind=Sd(window,[{eventName:"error",fn:this.onWindowError}])},r.componentDidCatch=function(s){if(s instanceof MS){this.setState({});return}throw s},r.componentWillUnmount=function(){this.unbind()},r.render=function(){return this.props.children(this.setCallbacks)},t}(Pe.Component),Iet=`
  Press space bar to start a drag.
  When dragging you can use the arrow keys to move the item around and escape to cancel.
  Some screen readers may require you to be in focus mode or to use your pass through key
`,RS=function(t){return t+1},Oet=function(t){return`
  You have lifted an item in position `+RS(t.source.index)+`
`},Vae=function(t,r){var n=t.droppableId===r.droppableId,s=RS(t.index),o=RS(r.index);return n?`
      You have moved the item from position `+s+`
      to position `+o+`
    `:`
    You have moved the item from position `+s+`
    in list `+t.droppableId+`
    to list `+r.droppableId+`
    in position `+o+`
  `},Wae=function(t,r,n){var s=r.droppableId===n.droppableId;return s?`
      The item `+t+`
      has been combined with `+n.draggableId:`
      The item `+t+`
      in list `+r.droppableId+`
      has been combined with `+n.draggableId+`
      in list `+n.droppableId+`
    `},Tet=function(t){var r=t.destination;if(r)return Vae(t.source,r);var n=t.combine;return n?Wae(t.draggableId,t.source,n):"You are over an area that cannot be dropped on"},vU=function(t){return`
  The item has returned to its starting position
  of `+RS(t.index)+`
`},Det=function(t){if(t.reason==="CANCEL")return`
      Movement cancelled.
      `+vU(t.source)+`
    `;var r=t.destination,n=t.combine;return r?`
      You have dropped the item.
      `+Vae(t.source,r)+`
    `:n?`
      You have dropped the item.
      `+Wae(t.draggableId,t.source,n)+`
    `:`
    The item has been dropped while not over a drop area.
    `+vU(t.source)+`
  `},v_={dragHandleUsageInstructions:Iet,onDragStart:Oet,onDragUpdate:Tet,onDragEnd:Det},ji={x:0,y:0},Fi=function(t,r){return{x:t.x+r.x,y:t.y+r.y}},Fc=function(t,r){return{x:t.x-r.x,y:t.y-r.y}},Ph=function(t,r){return t.x===r.x&&t.y===r.y},K0=function(t){return{x:t.x!==0?-t.x:0,y:t.y!==0?-t.y:0}},Eg=function(t,r,n){var s;return n===void 0&&(n=0),s={},s[t]=r,s[t==="x"?"y":"x"]=n,s},i1=function(t,r){return Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2))},xU=function(t,r){return Math.min.apply(Math,r.map(function(n){return i1(t,n)}))},Hae=function(t){return function(r){return{x:t(r.x),y:t(r.y)}}},Met=function(e,t){var r=iu({top:Math.max(t.top,e.top),right:Math.min(t.right,e.right),bottom:Math.min(t.bottom,e.bottom),left:Math.max(t.left,e.left)});return r.width<=0||r.height<=0?null:r},n2=function(t,r){return{top:t.top+r.y,left:t.left+r.x,bottom:t.bottom+r.y,right:t.right+r.x}},yU=function(t){return[{x:t.left,y:t.top},{x:t.right,y:t.top},{x:t.left,y:t.bottom},{x:t.right,y:t.bottom}]},Ret={top:0,right:0,bottom:0,left:0},Let=function(t,r){return r?n2(t,r.scroll.diff.displacement):t},Fet=function(t,r,n){if(n&&n.increasedBy){var s;return Yn({},t,(s={},s[r.end]=t[r.end]+n.increasedBy[r.line],s))}return t},$et=function(t,r){return r&&r.shouldClipSubject?Met(r.pageMarginBox,t):iu(t)},h0=function(e){var t=e.page,r=e.withPlaceholder,n=e.axis,s=e.frame,o=Let(t.marginBox,s),i=Fet(o,n,r),l=$et(i,s);return{page:t,withPlaceholder:r,active:l}},SR=function(e,t){e.frame||rn(!1);var r=e.frame,n=Fc(t,r.scroll.initial),s=K0(n),o=Yn({},r,{scroll:{initial:r.scroll.initial,current:t,diff:{value:n,displacement:s},max:r.scroll.max}}),i=h0({page:e.subject.page,withPlaceholder:e.subject.withPlaceholder,axis:e.axis,frame:o}),l=Yn({},e,{frame:o,subject:i});return l};function LS(e){return Object.values?Object.values(e):Object.keys(e).map(function(t){return e[t]})}function CR(e,t){if(e.findIndex)return e.findIndex(t);for(var r=0;r<e.length;r++)if(t(e[r]))return r;return-1}function rp(e,t){if(e.find)return e.find(t);var r=CR(e,t);if(r!==-1)return e[r]}function Gae(e){return Array.prototype.slice.call(e)}var Kae=wi(function(e){return e.reduce(function(t,r){return t[r.descriptor.id]=r,t},{})}),Xae=wi(function(e){return e.reduce(function(t,r){return t[r.descriptor.id]=r,t},{})}),dP=wi(function(e){return LS(e)}),Bet=wi(function(e){return LS(e)}),X0=wi(function(e,t){var r=Bet(t).filter(function(n){return e===n.descriptor.droppableId}).sort(function(n,s){return n.descriptor.index-s.descriptor.index});return r});function PR(e){return e.at&&e.at.type==="REORDER"?e.at.destination:null}function uP(e){return e.at&&e.at.type==="COMBINE"?e.at.combine:null}var fP=wi(function(e,t){return t.filter(function(r){return r.descriptor.id!==e.descriptor.id})}),qet=function(e){var t=e.isMovingForward,r=e.draggable,n=e.destination,s=e.insideDestination,o=e.previousImpact;if(!n.isCombineEnabled)return null;var i=PR(o);if(!i)return null;function l(g){var y={type:"COMBINE",combine:{draggableId:g,droppableId:n.descriptor.id}};return Yn({},o,{at:y})}var c=o.displaced.all,d=c.length?c[0]:null;if(t)return d?l(d):null;var u=fP(r,s);if(!d){if(!u.length)return null;var f=u[u.length-1];return l(f.descriptor.id)}var h=CR(u,function(g){return g.descriptor.id===d});h===-1&&rn(!1);var m=h-1;if(m<0)return null;var v=u[m];return l(v.descriptor.id)},Y0=function(e,t){return e.descriptor.droppableId===t.descriptor.id},Yae={point:ji,value:0},l1={invisible:{},visible:{},all:[]},zet={displaced:l1,displacedBy:Yae,at:null},kd=function(e,t){return function(r){return e<=r&&r<=t}},Jae=function(e){var t=kd(e.top,e.bottom),r=kd(e.left,e.right);return function(n){var s=t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right);if(s)return!0;var o=t(n.top)||t(n.bottom),i=r(n.left)||r(n.right),l=o&&i;if(l)return!0;var c=n.top<e.top&&n.bottom>e.bottom,d=n.left<e.left&&n.right>e.right,u=c&&d;if(u)return!0;var f=c&&i||d&&o;return f}},Uet=function(e){var t=kd(e.top,e.bottom),r=kd(e.left,e.right);return function(n){var s=t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right);return s}},AR={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},Qae={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"},Vet=function(e){return function(t){var r=kd(t.top,t.bottom),n=kd(t.left,t.right);return function(s){return e===AR?r(s.top)&&r(s.bottom):n(s.left)&&n(s.right)}}},Wet=function(t,r){var n=r.frame?r.frame.scroll.diff.displacement:ji;return n2(t,n)},Het=function(t,r,n){return r.subject.active?n(r.subject.active)(t):!1},Get=function(t,r,n){return n(r)(t)},ER=function(t){var r=t.target,n=t.destination,s=t.viewport,o=t.withDroppableDisplacement,i=t.isVisibleThroughFrameFn,l=o?Wet(r,n):r;return Het(l,n,i)&&Get(l,s,i)},Ket=function(t){return ER(Yn({},t,{isVisibleThroughFrameFn:Jae}))},Zae=function(t){return ER(Yn({},t,{isVisibleThroughFrameFn:Uet}))},Xet=function(t){return ER(Yn({},t,{isVisibleThroughFrameFn:Vet(t.destination.axis)}))},Yet=function(t,r,n){if(typeof n=="boolean")return n;if(!r)return!0;var s=r.invisible,o=r.visible;if(s[t])return!1;var i=o[t];return i?i.shouldAnimate:!0};function Jet(e,t){var r=e.page.marginBox,n={top:t.point.y,right:0,bottom:0,left:t.point.x};return iu(_R(r,n))}function c1(e){var t=e.afterDragging,r=e.destination,n=e.displacedBy,s=e.viewport,o=e.forceShouldAnimate,i=e.last;return t.reduce(function(c,d){var u=Jet(d,n),f=d.descriptor.id;c.all.push(f);var h=Ket({target:u,destination:r,viewport:s,withDroppableDisplacement:!0});if(!h)return c.invisible[d.descriptor.id]=!0,c;var m=Yet(f,i,o),v={draggableId:f,shouldAnimate:m};return c.visible[f]=v,c},{all:[],visible:{},invisible:{}})}function Qet(e,t){if(!e.length)return 0;var r=e[e.length-1].descriptor.index;return t.inHomeList?r:r+1}function bU(e){var t=e.insideDestination,r=e.inHomeList,n=e.displacedBy,s=e.destination,o=Qet(t,{inHomeList:r});return{displaced:l1,displacedBy:n,at:{type:"REORDER",destination:{droppableId:s.descriptor.id,index:o}}}}function FS(e){var t=e.draggable,r=e.insideDestination,n=e.destination,s=e.viewport,o=e.displacedBy,i=e.last,l=e.index,c=e.forceShouldAnimate,d=Y0(t,n);if(l==null)return bU({insideDestination:r,inHomeList:d,displacedBy:o,destination:n});var u=rp(r,function(g){return g.descriptor.index===l});if(!u)return bU({insideDestination:r,inHomeList:d,displacedBy:o,destination:n});var f=fP(t,r),h=r.indexOf(u),m=f.slice(h),v=c1({afterDragging:m,destination:n,displacedBy:o,last:i,viewport:s.frame,forceShouldAnimate:c});return{displaced:v,displacedBy:o,at:{type:"REORDER",destination:{droppableId:n.descriptor.id,index:l}}}}function qh(e,t){return!!t.effected[e]}var Zet=function(e){var t=e.isMovingForward,r=e.destination,n=e.draggables,s=e.combine,o=e.afterCritical;if(!r.isCombineEnabled)return null;var i=s.draggableId,l=n[i],c=l.descriptor.index,d=qh(i,o);return d?t?c:c-1:t?c+1:c},ett=function(e){var t=e.isMovingForward,r=e.isInHomeList,n=e.insideDestination,s=e.location;if(!n.length)return null;var o=s.index,i=t?o+1:o-1,l=n[0].descriptor.index,c=n[n.length-1].descriptor.index,d=r?c:c+1;return i<l||i>d?null:i},ttt=function(e){var t=e.isMovingForward,r=e.isInHomeList,n=e.draggable,s=e.draggables,o=e.destination,i=e.insideDestination,l=e.previousImpact,c=e.viewport,d=e.afterCritical,u=l.at;if(u||rn(!1),u.type==="REORDER"){var f=ett({isMovingForward:t,isInHomeList:r,location:u.destination,insideDestination:i});return f==null?null:FS({draggable:n,insideDestination:i,destination:o,viewport:c,last:l.displaced,displacedBy:l.displacedBy,index:f})}var h=Zet({isMovingForward:t,destination:o,displaced:l.displaced,draggables:s,combine:u.combine,afterCritical:d});return h==null?null:FS({draggable:n,insideDestination:i,destination:o,viewport:c,last:l.displaced,displacedBy:l.displacedBy,index:h})},rtt=function(e){var t=e.displaced,r=e.afterCritical,n=e.combineWith,s=e.displacedBy,o=!!(t.visible[n]||t.invisible[n]);return qh(n,r)?o?ji:K0(s.point):o?s.point:ji},ntt=function(e){var t=e.afterCritical,r=e.impact,n=e.draggables,s=uP(r);s||rn(!1);var o=s.draggableId,i=n[o].page.borderBox.center,l=rtt({displaced:r.displaced,afterCritical:t,combineWith:o,displacedBy:r.displacedBy});return Fi(i,l)},ese=function(t,r){return r.margin[t.start]+r.borderBox[t.size]/2},att=function(t,r){return r.margin[t.end]+r.borderBox[t.size]/2},kR=function(t,r,n){return r[t.crossAxisStart]+n.margin[t.crossAxisStart]+n.borderBox[t.crossAxisSize]/2},wU=function(t){var r=t.axis,n=t.moveRelativeTo,s=t.isMoving;return Eg(r.line,n.marginBox[r.end]+ese(r,s),kR(r,n.marginBox,s))},jU=function(t){var r=t.axis,n=t.moveRelativeTo,s=t.isMoving;return Eg(r.line,n.marginBox[r.start]-att(r,s),kR(r,n.marginBox,s))},stt=function(t){var r=t.axis,n=t.moveInto,s=t.isMoving;return Eg(r.line,n.contentBox[r.start]+ese(r,s),kR(r,n.contentBox,s))},ott=function(e){var t=e.impact,r=e.draggable,n=e.draggables,s=e.droppable,o=e.afterCritical,i=X0(s.descriptor.id,n),l=r.page,c=s.axis;if(!i.length)return stt({axis:c,moveInto:s.page,isMoving:l});var d=t.displaced,u=t.displacedBy,f=d.all[0];if(f){var h=n[f];if(qh(f,o))return jU({axis:c,moveRelativeTo:h.page,isMoving:l});var m=TS(h.page,u.point);return jU({axis:c,moveRelativeTo:m,isMoving:l})}var v=i[i.length-1];if(v.descriptor.id===r.descriptor.id)return l.borderBox.center;if(qh(v.descriptor.id,o)){var g=TS(v.page,K0(o.displacedBy.point));return wU({axis:c,moveRelativeTo:g,isMoving:l})}return wU({axis:c,moveRelativeTo:v.page,isMoving:l})},s3=function(e,t){var r=e.frame;return r?Fi(t,r.scroll.diff.displacement):t},itt=function(t){var r=t.impact,n=t.draggable,s=t.droppable,o=t.draggables,i=t.afterCritical,l=n.page.borderBox.center,c=r.at;return!s||!c?l:c.type==="REORDER"?ott({impact:r,draggable:n,draggables:o,droppable:s,afterCritical:i}):ntt({impact:r,draggables:o,afterCritical:i})},mP=function(e){var t=itt(e),r=e.droppable,n=r?s3(r,t):t;return n},tse=function(e,t){var r=Fc(t,e.scroll.initial),n=K0(r),s=iu({top:t.y,bottom:t.y+e.frame.height,left:t.x,right:t.x+e.frame.width}),o={frame:s,scroll:{initial:e.scroll.initial,max:e.scroll.max,current:t,diff:{value:r,displacement:n}}};return o};function _U(e,t){return e.map(function(r){return t[r]})}function ltt(e,t){for(var r=0;r<t.length;r++){var n=t[r].visible[e];if(n)return n}return null}var ctt=function(e){var t=e.impact,r=e.viewport,n=e.destination,s=e.draggables,o=e.maxScrollChange,i=tse(r,Fi(r.scroll.current,o)),l=n.frame?SR(n,Fi(n.frame.scroll.current,o)):n,c=t.displaced,d=c1({afterDragging:_U(c.all,s),destination:n,displacedBy:t.displacedBy,viewport:i.frame,last:c,forceShouldAnimate:!1}),u=c1({afterDragging:_U(c.all,s),destination:l,displacedBy:t.displacedBy,viewport:r.frame,last:c,forceShouldAnimate:!1}),f={},h={},m=[c,d,u];c.all.forEach(function(g){var y=ltt(g,m);if(y){h[g]=y;return}f[g]=!0});var v=Yn({},t,{displaced:{all:c.all,invisible:f,visible:h}});return v},dtt=function(e,t){return Fi(e.scroll.diff.displacement,t)},IR=function(e){var t=e.pageBorderBoxCenter,r=e.draggable,n=e.viewport,s=dtt(n,t),o=Fc(s,r.page.borderBox.center);return Fi(r.client.borderBox.center,o)},rse=function(e){var t=e.draggable,r=e.destination,n=e.newPageBorderBoxCenter,s=e.viewport,o=e.withDroppableDisplacement,i=e.onlyOnMainAxis,l=i===void 0?!1:i,c=Fc(n,t.page.borderBox.center),d=n2(t.page.borderBox,c),u={target:d,destination:r,withDroppableDisplacement:o,viewport:s};return l?Xet(u):Zae(u)},utt=function(e){var t=e.isMovingForward,r=e.draggable,n=e.destination,s=e.draggables,o=e.previousImpact,i=e.viewport,l=e.previousPageBorderBoxCenter,c=e.previousClientSelection,d=e.afterCritical;if(!n.isEnabled)return null;var u=X0(n.descriptor.id,s),f=Y0(r,n),h=qet({isMovingForward:t,draggable:r,destination:n,insideDestination:u,previousImpact:o})||ttt({isMovingForward:t,isInHomeList:f,draggable:r,draggables:s,destination:n,insideDestination:u,previousImpact:o,viewport:i,afterCritical:d});if(!h)return null;var m=mP({impact:h,draggable:r,droppable:n,draggables:s,afterCritical:d}),v=rse({draggable:r,destination:n,newPageBorderBoxCenter:m,viewport:i.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0});if(v){var g=IR({pageBorderBoxCenter:m,draggable:r,viewport:i});return{clientSelection:g,impact:h,scrollJumpRequest:null}}var y=Fc(m,l),x=ctt({impact:h,viewport:i,destination:n,draggables:s,maxScrollChange:y});return{clientSelection:c,impact:x,scrollJumpRequest:y}},gl=function(t){var r=t.subject.active;return r||rn(!1),r},ftt=function(e){var t=e.isMovingForward,r=e.pageBorderBoxCenter,n=e.source,s=e.droppables,o=e.viewport,i=n.subject.active;if(!i)return null;var l=n.axis,c=kd(i[l.start],i[l.end]),d=dP(s).filter(function(f){return f!==n}).filter(function(f){return f.isEnabled}).filter(function(f){return!!f.subject.active}).filter(function(f){return Jae(o.frame)(gl(f))}).filter(function(f){var h=gl(f);return t?i[l.crossAxisEnd]<h[l.crossAxisEnd]:h[l.crossAxisStart]<i[l.crossAxisStart]}).filter(function(f){var h=gl(f),m=kd(h[l.start],h[l.end]);return c(h[l.start])||c(h[l.end])||m(i[l.start])||m(i[l.end])}).sort(function(f,h){var m=gl(f)[l.crossAxisStart],v=gl(h)[l.crossAxisStart];return t?m-v:v-m}).filter(function(f,h,m){return gl(f)[l.crossAxisStart]===gl(m[0])[l.crossAxisStart]});if(!d.length)return null;if(d.length===1)return d[0];var u=d.filter(function(f){var h=kd(gl(f)[l.start],gl(f)[l.end]);return h(r[l.line])});return u.length===1?u[0]:u.length>1?u.sort(function(f,h){return gl(f)[l.start]-gl(h)[l.start]})[0]:d.sort(function(f,h){var m=xU(r,yU(gl(f))),v=xU(r,yU(gl(h)));return m!==v?m-v:gl(f)[l.start]-gl(h)[l.start]})[0]},NU=function(t,r){var n=t.page.borderBox.center;return qh(t.descriptor.id,r)?Fc(n,r.displacedBy.point):n},mtt=function(t,r){var n=t.page.borderBox;return qh(t.descriptor.id,r)?n2(n,K0(r.displacedBy.point)):n},htt=function(e){var t=e.pageBorderBoxCenter,r=e.viewport,n=e.destination,s=e.insideDestination,o=e.afterCritical,i=s.filter(function(l){return Zae({target:mtt(l,o),destination:n,viewport:r.frame,withDroppableDisplacement:!0})}).sort(function(l,c){var d=i1(t,s3(n,NU(l,o))),u=i1(t,s3(n,NU(c,o)));return d<u?-1:u<d?1:l.descriptor.index-c.descriptor.index});return i[0]||null},a2=wi(function(t,r){var n=r[t.line];return{value:n,point:Eg(t.line,n)}}),ptt=function(t,r,n){var s=t.axis;if(t.descriptor.mode==="virtual")return Eg(s.line,r[s.line]);var o=t.subject.page.contentBox[s.size],i=X0(t.descriptor.id,n),l=i.reduce(function(u,f){return u+f.client.marginBox[s.size]},0),c=l+r[s.line],d=c-o;return d<=0?null:Eg(s.line,d)},nse=function(t,r){return Yn({},t,{scroll:Yn({},t.scroll,{max:r})})},ase=function(t,r,n){var s=t.frame;Y0(r,t)&&rn(!1),t.subject.withPlaceholder&&rn(!1);var o=a2(t.axis,r.displaceBy).point,i=ptt(t,o,n),l={placeholderSize:o,increasedBy:i,oldFrameMaxScroll:t.frame?t.frame.scroll.max:null};if(!s){var c=h0({page:t.subject.page,withPlaceholder:l,axis:t.axis,frame:t.frame});return Yn({},t,{subject:c})}var d=i?Fi(s.scroll.max,i):s.scroll.max,u=nse(s,d),f=h0({page:t.subject.page,withPlaceholder:l,axis:t.axis,frame:u});return Yn({},t,{subject:f,frame:u})},gtt=function(t){var r=t.subject.withPlaceholder;r||rn(!1);var n=t.frame;if(!n){var s=h0({page:t.subject.page,axis:t.axis,frame:null,withPlaceholder:null});return Yn({},t,{subject:s})}var o=r.oldFrameMaxScroll;o||rn(!1);var i=nse(n,o),l=h0({page:t.subject.page,axis:t.axis,frame:i,withPlaceholder:null});return Yn({},t,{subject:l,frame:i})},vtt=function(e){var t=e.previousPageBorderBoxCenter,r=e.moveRelativeTo,n=e.insideDestination,s=e.draggable,o=e.draggables,i=e.destination,l=e.viewport,c=e.afterCritical;if(!r){if(n.length)return null;var d={displaced:l1,displacedBy:Yae,at:{type:"REORDER",destination:{droppableId:i.descriptor.id,index:0}}},u=mP({impact:d,draggable:s,droppable:i,draggables:o,afterCritical:c}),f=Y0(s,i)?i:ase(i,s,o),h=rse({draggable:s,destination:f,newPageBorderBoxCenter:u,viewport:l.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0});return h?d:null}var m=t[i.axis.line]<=r.page.borderBox.center[i.axis.line],v=function(){var y=r.descriptor.index;return r.descriptor.id===s.descriptor.id||m?y:y+1}(),g=a2(i.axis,s.displaceBy);return FS({draggable:s,insideDestination:n,destination:i,viewport:l,displacedBy:g,last:l1,index:v})},xtt=function(e){var t=e.isMovingForward,r=e.previousPageBorderBoxCenter,n=e.draggable,s=e.isOver,o=e.draggables,i=e.droppables,l=e.viewport,c=e.afterCritical,d=ftt({isMovingForward:t,pageBorderBoxCenter:r,source:s,droppables:i,viewport:l});if(!d)return null;var u=X0(d.descriptor.id,o),f=htt({pageBorderBoxCenter:r,viewport:l,destination:d,insideDestination:u,afterCritical:c}),h=vtt({previousPageBorderBoxCenter:r,destination:d,draggable:n,draggables:o,moveRelativeTo:f,insideDestination:u,viewport:l,afterCritical:c});if(!h)return null;var m=mP({impact:h,draggable:n,droppable:d,draggables:o,afterCritical:c}),v=IR({pageBorderBoxCenter:m,draggable:n,viewport:l});return{clientSelection:v,impact:h,scrollJumpRequest:null}},Vc=function(e){var t=e.at;return t?t.type==="REORDER"?t.destination.droppableId:t.combine.droppableId:null},ytt=function(t,r){var n=Vc(t);return n?r[n]:null},btt=function(e){var t=e.state,r=e.type,n=ytt(t.impact,t.dimensions.droppables),s=!!n,o=t.dimensions.droppables[t.critical.droppable.id],i=n||o,l=i.axis.direction,c=l==="vertical"&&(r==="MOVE_UP"||r==="MOVE_DOWN")||l==="horizontal"&&(r==="MOVE_LEFT"||r==="MOVE_RIGHT");if(c&&!s)return null;var d=r==="MOVE_DOWN"||r==="MOVE_RIGHT",u=t.dimensions.draggables[t.critical.draggable.id],f=t.current.page.borderBoxCenter,h=t.dimensions,m=h.draggables,v=h.droppables;return c?utt({isMovingForward:d,previousPageBorderBoxCenter:f,draggable:u,destination:i,draggables:m,viewport:t.viewport,previousClientSelection:t.current.client.selection,previousImpact:t.impact,afterCritical:t.afterCritical}):xtt({isMovingForward:d,previousPageBorderBoxCenter:f,draggable:u,isOver:i,draggables:m,droppables:v,viewport:t.viewport,afterCritical:t.afterCritical})};function Ap(e){return e.phase==="DRAGGING"||e.phase==="COLLECTING"}function sse(e){var t=kd(e.top,e.bottom),r=kd(e.left,e.right);return function(s){return t(s.y)&&r(s.x)}}function wtt(e,t){return e.left<t.right&&e.right>t.left&&e.top<t.bottom&&e.bottom>t.top}function jtt(e){var t=e.pageBorderBox,r=e.draggable,n=e.candidates,s=r.page.borderBox.center,o=n.map(function(i){var l=i.axis,c=Eg(i.axis.line,t.center[l.line],i.page.borderBox.center[l.crossAxisLine]);return{id:i.descriptor.id,distance:i1(s,c)}}).sort(function(i,l){return l.distance-i.distance});return o[0]?o[0].id:null}function _tt(e){var t=e.pageBorderBox,r=e.draggable,n=e.droppables,s=dP(n).filter(function(o){if(!o.isEnabled)return!1;var i=o.subject.active;if(!i||!wtt(t,i))return!1;if(sse(i)(t.center))return!0;var l=o.axis,c=i.center[l.crossAxisLine],d=t[l.crossAxisStart],u=t[l.crossAxisEnd],f=kd(i[l.crossAxisStart],i[l.crossAxisEnd]),h=f(d),m=f(u);return!h&&!m?!0:h?d<c:u>c});return s.length?s.length===1?s[0].descriptor.id:jtt({pageBorderBox:t,draggable:r,candidates:s}):null}var ose=function(t,r){return iu(n2(t,r))},Ntt=function(e,t){var r=e.frame;return r?ose(t,r.scroll.diff.value):t};function ise(e){var t=e.displaced,r=e.id;return!!(t.visible[r]||t.invisible[r])}function Stt(e){var t=e.draggable,r=e.closest,n=e.inHomeList;return r?n&&r.descriptor.index>t.descriptor.index?r.descriptor.index-1:r.descriptor.index:null}var Ctt=function(e){var t=e.pageBorderBoxWithDroppableScroll,r=e.draggable,n=e.destination,s=e.insideDestination,o=e.last,i=e.viewport,l=e.afterCritical,c=n.axis,d=a2(n.axis,r.displaceBy),u=d.value,f=t[c.start],h=t[c.end],m=fP(r,s),v=rp(m,function(y){var x=y.descriptor.id,b=y.page.borderBox.center[c.line],w=qh(x,l),j=ise({displaced:o,id:x});return w?j?h<=b:f<b-u:j?h<=b+u:f<b}),g=Stt({draggable:r,closest:v,inHomeList:Y0(r,n)});return FS({draggable:r,insideDestination:s,destination:n,viewport:i,last:o,displacedBy:d,index:g})},Ptt=4,Att=function(e){var t=e.draggable,r=e.pageBorderBoxWithDroppableScroll,n=e.previousImpact,s=e.destination,o=e.insideDestination,i=e.afterCritical;if(!s.isCombineEnabled)return null;var l=s.axis,c=a2(s.axis,t.displaceBy),d=c.value,u=r[l.start],f=r[l.end],h=fP(t,o),m=rp(h,function(g){var y=g.descriptor.id,x=g.page.borderBox,b=x[l.size],w=b/Ptt,j=qh(y,i),_=ise({displaced:n.displaced,id:y});return j?_?f>x[l.start]+w&&f<x[l.end]-w:u>x[l.start]-d+w&&u<x[l.end]-d-w:_?f>x[l.start]+d+w&&f<x[l.end]+d-w:u>x[l.start]+w&&u<x[l.end]-w});if(!m)return null;var v={displacedBy:c,displaced:n.displaced,at:{type:"COMBINE",combine:{draggableId:m.descriptor.id,droppableId:s.descriptor.id}}};return v},lse=function(e){var t=e.pageOffset,r=e.draggable,n=e.draggables,s=e.droppables,o=e.previousImpact,i=e.viewport,l=e.afterCritical,c=ose(r.page.borderBox,t),d=_tt({pageBorderBox:c,draggable:r,droppables:s});if(!d)return zet;var u=s[d],f=X0(u.descriptor.id,n),h=Ntt(u,c);return Att({pageBorderBoxWithDroppableScroll:h,draggable:r,previousImpact:o,destination:u,insideDestination:f,afterCritical:l})||Ctt({pageBorderBoxWithDroppableScroll:h,draggable:r,destination:u,insideDestination:f,last:o.displaced,viewport:i,afterCritical:l})},OR=function(e,t){var r;return Yn({},e,(r={},r[t.descriptor.id]=t,r))},Ett=function(t){var r=t.previousImpact,n=t.impact,s=t.droppables,o=Vc(r),i=Vc(n);if(!o||o===i)return s;var l=s[o];if(!l.subject.withPlaceholder)return s;var c=gtt(l);return OR(s,c)},ktt=function(e){var t=e.draggable,r=e.draggables,n=e.droppables,s=e.previousImpact,o=e.impact,i=Ett({previousImpact:s,impact:o,droppables:n}),l=Vc(o);if(!l)return i;var c=n[l];if(Y0(t,c)||c.subject.withPlaceholder)return i;var d=ase(c,t,r);return OR(i,d)},Ob=function(e){var t=e.state,r=e.clientSelection,n=e.dimensions,s=e.viewport,o=e.impact,i=e.scrollJumpRequest,l=s||t.viewport,c=n||t.dimensions,d=r||t.current.client.selection,u=Fc(d,t.initial.client.selection),f={offset:u,selection:d,borderBoxCenter:Fi(t.initial.client.borderBoxCenter,u)},h={selection:Fi(f.selection,l.scroll.current),borderBoxCenter:Fi(f.borderBoxCenter,l.scroll.current),offset:Fi(f.offset,l.scroll.diff.value)},m={client:f,page:h};if(t.phase==="COLLECTING")return Yn({phase:"COLLECTING"},t,{dimensions:c,viewport:l,current:m});var v=c.draggables[t.critical.draggable.id],g=o||lse({pageOffset:h.offset,draggable:v,draggables:c.draggables,droppables:c.droppables,previousImpact:t.impact,viewport:l,afterCritical:t.afterCritical}),y=ktt({draggable:v,impact:g,previousImpact:t.impact,draggables:c.draggables,droppables:c.droppables}),x=Yn({},t,{current:m,dimensions:{draggables:c.draggables,droppables:y},impact:g,viewport:l,scrollJumpRequest:i||null,forceShouldAnimate:i?!1:null});return x};function Itt(e,t){return e.map(function(r){return t[r]})}var cse=function(e){var t=e.impact,r=e.viewport,n=e.draggables,s=e.destination,o=e.forceShouldAnimate,i=t.displaced,l=Itt(i.all,n),c=c1({afterDragging:l,destination:s,displacedBy:t.displacedBy,viewport:r.frame,forceShouldAnimate:o,last:i});return Yn({},t,{displaced:c})},dse=function(e){var t=e.impact,r=e.draggable,n=e.droppable,s=e.draggables,o=e.viewport,i=e.afterCritical,l=mP({impact:t,draggable:r,draggables:s,droppable:n,afterCritical:i});return IR({pageBorderBoxCenter:l,draggable:r,viewport:o})},use=function(e){var t=e.state,r=e.dimensions,n=e.viewport;t.movementMode!=="SNAP"&&rn(!1);var s=t.impact,o=n||t.viewport,i=r||t.dimensions,l=i.draggables,c=i.droppables,d=l[t.critical.draggable.id],u=Vc(s);u||rn(!1);var f=c[u],h=cse({impact:s,viewport:o,destination:f,draggables:l}),m=dse({impact:h,draggable:d,droppable:f,draggables:l,viewport:o,afterCritical:t.afterCritical});return Ob({impact:h,clientSelection:m,state:t,dimensions:i,viewport:o})},Ott=function(e){return{index:e.index,droppableId:e.droppableId}},fse=function(e){var t=e.draggable,r=e.home,n=e.draggables,s=e.viewport,o=a2(r.axis,t.displaceBy),i=X0(r.descriptor.id,n),l=i.indexOf(t);l===-1&&rn(!1);var c=i.slice(l+1),d=c.reduce(function(m,v){return m[v.descriptor.id]=!0,m},{}),u={inVirtualList:r.descriptor.mode==="virtual",displacedBy:o,effected:d},f=c1({afterDragging:c,destination:r,displacedBy:o,last:null,viewport:s.frame,forceShouldAnimate:!1}),h={displaced:f,displacedBy:o,at:{type:"REORDER",destination:Ott(t.descriptor)}};return{impact:h,afterCritical:u}},Ttt=function(e,t){return{draggables:e.draggables,droppables:OR(e.droppables,t)}},Dtt=function(e){var t=e.draggable,r=e.offset,n=e.initialWindowScroll,s=TS(t.client,r),o=DS(s,n),i=Yn({},t,{placeholder:Yn({},t.placeholder,{client:s}),client:s,page:o});return i},Mtt=function(e){var t=e.frame;return t||rn(!1),t},Rtt=function(e){var t=e.additions,r=e.updatedDroppables,n=e.viewport,s=n.scroll.diff.value;return t.map(function(o){var i=o.descriptor.droppableId,l=r[i],c=Mtt(l),d=c.scroll.diff.value,u=Fi(s,d),f=Dtt({draggable:o,offset:u,initialWindowScroll:n.scroll.initial});return f})},Ltt=function(e){var t=e.state,r=e.published,n=r.modified.map(function(w){var j=t.dimensions.droppables[w.droppableId],_=SR(j,w.scroll);return _}),s=Yn({},t.dimensions.droppables,{},Kae(n)),o=Xae(Rtt({additions:r.additions,updatedDroppables:s,viewport:t.viewport})),i=Yn({},t.dimensions.draggables,{},o);r.removals.forEach(function(w){delete i[w]});var l={droppables:s,draggables:i},c=Vc(t.impact),d=c?l.droppables[c]:null,u=l.draggables[t.critical.draggable.id],f=l.droppables[t.critical.droppable.id],h=fse({draggable:u,home:f,draggables:i,viewport:t.viewport}),m=h.impact,v=h.afterCritical,g=d&&d.isCombineEnabled?t.impact:m,y=lse({pageOffset:t.current.page.offset,draggable:l.draggables[t.critical.draggable.id],draggables:l.draggables,droppables:l.droppables,previousImpact:g,viewport:t.viewport,afterCritical:v}),x=Yn({phase:"DRAGGING"},t,{phase:"DRAGGING",impact:y,onLiftImpact:m,dimensions:l,afterCritical:v,forceShouldAnimate:!1});if(t.phase==="COLLECTING")return x;var b=Yn({phase:"DROP_PENDING"},x,{phase:"DROP_PENDING",reason:t.reason,isWaiting:!1});return b},o3=function(t){return t.movementMode==="SNAP"},ZE=function(t,r,n){var s=Ttt(t.dimensions,r);return!o3(t)||n?Ob({state:t,dimensions:s}):use({state:t,dimensions:s})};function ek(e){return e.isDragging&&e.movementMode==="SNAP"?Yn({phase:"DRAGGING"},e,{scrollJumpRequest:null}):e}var SU={phase:"IDLE",completed:null,shouldFlush:!1},Ftt=function(e,t){if(e===void 0&&(e=SU),t.type==="FLUSH")return Yn({},SU,{shouldFlush:!0});if(t.type==="INITIAL_PUBLISH"){e.phase!=="IDLE"&&rn(!1);var r=t.payload,n=r.critical,s=r.clientSelection,o=r.viewport,i=r.dimensions,l=r.movementMode,c=i.draggables[n.draggable.id],d=i.droppables[n.droppable.id],u={selection:s,borderBoxCenter:c.client.borderBox.center,offset:ji},f={client:u,page:{selection:Fi(u.selection,o.scroll.initial),borderBoxCenter:Fi(u.selection,o.scroll.initial),offset:Fi(u.selection,o.scroll.diff.value)}},h=dP(i.droppables).every(function(le){return!le.isFixedOnPage}),m=fse({draggable:c,home:d,draggables:i.draggables,viewport:o}),v=m.impact,g=m.afterCritical,y={phase:"DRAGGING",isDragging:!0,critical:n,movementMode:l,dimensions:i,initial:f,current:f,isWindowScrollAllowed:h,impact:v,afterCritical:g,onLiftImpact:v,viewport:o,scrollJumpRequest:null,forceShouldAnimate:null};return y}if(t.type==="COLLECTION_STARTING"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&rn(!1);var x=Yn({phase:"COLLECTING"},e,{phase:"COLLECTING"});return x}if(t.type==="PUBLISH_WHILE_DRAGGING")return e.phase==="COLLECTING"||e.phase==="DROP_PENDING"||rn(!1),Ltt({state:e,published:t.payload});if(t.type==="MOVE"){if(e.phase==="DROP_PENDING")return e;Ap(e)||rn(!1);var b=t.payload.client;return Ph(b,e.current.client.selection)?e:Ob({state:e,clientSelection:b,impact:o3(e)?e.impact:null})}if(t.type==="UPDATE_DROPPABLE_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="COLLECTING")return ek(e);Ap(e)||rn(!1);var w=t.payload,j=w.id,_=w.newScroll,S=e.dimensions.droppables[j];if(!S)return e;var C=SR(S,_);return ZE(e,C,!1)}if(t.type==="UPDATE_DROPPABLE_IS_ENABLED"){if(e.phase==="DROP_PENDING")return e;Ap(e)||rn(!1);var P=t.payload,A=P.id,R=P.isEnabled,O=e.dimensions.droppables[A];O||rn(!1),O.isEnabled===R&&rn(!1);var I=Yn({},O,{isEnabled:R});return ZE(e,I,!0)}if(t.type==="UPDATE_DROPPABLE_IS_COMBINE_ENABLED"){if(e.phase==="DROP_PENDING")return e;Ap(e)||rn(!1);var M=t.payload,D=M.id,U=M.isCombineEnabled,z=e.dimensions.droppables[D];z||rn(!1),z.isCombineEnabled===U&&rn(!1);var W=Yn({},z,{isCombineEnabled:U});return ZE(e,W,!0)}if(t.type==="MOVE_BY_WINDOW_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="DROP_ANIMATING")return e;Ap(e)||rn(!1),e.isWindowScrollAllowed||rn(!1);var $=t.payload.newScroll;if(Ph(e.viewport.scroll.current,$))return ek(e);var X=tse(e.viewport,$);return o3(e)?use({state:e,viewport:X}):Ob({state:e,viewport:X})}if(t.type==="UPDATE_VIEWPORT_MAX_SCROLL"){if(!Ap(e))return e;var ye=t.payload.maxScroll;if(Ph(ye,e.viewport.scroll.max))return e;var Se=Yn({},e.viewport,{scroll:Yn({},e.viewport.scroll,{max:ye})});return Yn({phase:"DRAGGING"},e,{viewport:Se})}if(t.type==="MOVE_UP"||t.type==="MOVE_DOWN"||t.type==="MOVE_LEFT"||t.type==="MOVE_RIGHT"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&rn(!1);var V=btt({state:e,type:t.type});return V?Ob({state:e,impact:V.impact,clientSelection:V.clientSelection,scrollJumpRequest:V.scrollJumpRequest}):e}if(t.type==="DROP_PENDING"){var B=t.payload.reason;e.phase!=="COLLECTING"&&rn(!1);var Q=Yn({phase:"DROP_PENDING"},e,{phase:"DROP_PENDING",isWaiting:!0,reason:B});return Q}if(t.type==="DROP_ANIMATE"){var pe=t.payload,te=pe.completed,Y=pe.dropDuration,ce=pe.newHomeClientOffset;e.phase==="DRAGGING"||e.phase==="DROP_PENDING"||rn(!1);var me={phase:"DROP_ANIMATING",completed:te,dropDuration:Y,newHomeClientOffset:ce,dimensions:e.dimensions};return me}if(t.type==="DROP_COMPLETE"){var ae=t.payload.completed;return{phase:"IDLE",completed:ae,shouldFlush:!1}}return e},$tt=function(t){return{type:"BEFORE_INITIAL_CAPTURE",payload:t}},Btt=function(t){return{type:"LIFT",payload:t}},qtt=function(t){return{type:"INITIAL_PUBLISH",payload:t}},ztt=function(t){return{type:"PUBLISH_WHILE_DRAGGING",payload:t}},Utt=function(){return{type:"COLLECTION_STARTING",payload:null}},Vtt=function(t){return{type:"UPDATE_DROPPABLE_SCROLL",payload:t}},Wtt=function(t){return{type:"UPDATE_DROPPABLE_IS_ENABLED",payload:t}},Htt=function(t){return{type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:t}},mse=function(t){return{type:"MOVE",payload:t}},Gtt=function(t){return{type:"MOVE_BY_WINDOW_SCROLL",payload:t}},Ktt=function(t){return{type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:t}},Xtt=function(){return{type:"MOVE_UP",payload:null}},Ytt=function(){return{type:"MOVE_DOWN",payload:null}},Jtt=function(){return{type:"MOVE_RIGHT",payload:null}},Qtt=function(){return{type:"MOVE_LEFT",payload:null}},TR=function(){return{type:"FLUSH",payload:null}},Ztt=function(t){return{type:"DROP_ANIMATE",payload:t}},DR=function(t){return{type:"DROP_COMPLETE",payload:t}},hse=function(t){return{type:"DROP",payload:t}},ert=function(t){return{type:"DROP_PENDING",payload:t}},pse=function(){return{type:"DROP_ANIMATION_FINISHED",payload:null}},trt=function(e){return function(t){var r=t.getState,n=t.dispatch;return function(s){return function(o){if(o.type!=="LIFT"){s(o);return}var i=o.payload,l=i.id,c=i.clientSelection,d=i.movementMode,u=r();u.phase==="DROP_ANIMATING"&&n(DR({completed:u.completed})),r().phase!=="IDLE"&&rn(!1),n(TR()),n($tt({draggableId:l,movementMode:d}));var f={shouldPublishImmediately:d==="SNAP"},h={draggableId:l,scrollOptions:f},m=e.startPublishing(h),v=m.critical,g=m.dimensions,y=m.viewport;n(qtt({critical:v,dimensions:g,clientSelection:c,movementMode:d,viewport:y}))}}}},rrt=function(e){return function(){return function(t){return function(r){r.type==="INITIAL_PUBLISH"&&e.dragging(),r.type==="DROP_ANIMATE"&&e.dropping(r.payload.completed.result.reason),(r.type==="FLUSH"||r.type==="DROP_COMPLETE")&&e.resting(),t(r)}}}},MR={outOfTheWay:"cubic-bezier(0.2, 0, 0, 1)",drop:"cubic-bezier(.2,1,.1,1)"},d1={opacity:{drop:0,combining:.7},scale:{drop:.75}},RR={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},gp=RR.outOfTheWay+"s "+MR.outOfTheWay,Tb={fluid:"opacity "+gp,snap:"transform "+gp+", opacity "+gp,drop:function(t){var r=t+"s "+MR.drop;return"transform "+r+", opacity "+r},outOfTheWay:"transform "+gp,placeholder:"height "+gp+", width "+gp+", margin "+gp},CU=function(t){return Ph(t,ji)?null:"translate("+t.x+"px, "+t.y+"px)"},i3={moveTo:CU,drop:function(t,r){var n=CU(t);return n?r?n+" scale("+d1.scale.drop+")":n:null}},l3=RR.minDropTime,gse=RR.maxDropTime,nrt=gse-l3,PU=1500,art=.6,srt=function(e){var t=e.current,r=e.destination,n=e.reason,s=i1(t,r);if(s<=0)return l3;if(s>=PU)return gse;var o=s/PU,i=l3+nrt*o,l=n==="CANCEL"?i*art:i;return Number(l.toFixed(2))},ort=function(e){var t=e.impact,r=e.draggable,n=e.dimensions,s=e.viewport,o=e.afterCritical,i=n.draggables,l=n.droppables,c=Vc(t),d=c?l[c]:null,u=l[r.descriptor.droppableId],f=dse({impact:t,draggable:r,draggables:i,afterCritical:o,droppable:d||u,viewport:s}),h=Fc(f,r.client.borderBox.center);return h},irt=function(e){var t=e.draggables,r=e.reason,n=e.lastImpact,s=e.home,o=e.viewport,i=e.onLiftImpact;if(!n.at||r!=="DROP"){var l=cse({draggables:t,impact:i,destination:s,viewport:o,forceShouldAnimate:!0});return{impact:l,didDropInsideDroppable:!1}}if(n.at.type==="REORDER")return{impact:n,didDropInsideDroppable:!0};var c=Yn({},n,{displaced:l1});return{impact:c,didDropInsideDroppable:!0}},lrt=function(e){var t=e.getState,r=e.dispatch;return function(n){return function(s){if(s.type!=="DROP"){n(s);return}var o=t(),i=s.payload.reason;if(o.phase==="COLLECTING"){r(ert({reason:i}));return}if(o.phase!=="IDLE"){var l=o.phase==="DROP_PENDING"&&o.isWaiting;l&&rn(!1),o.phase==="DRAGGING"||o.phase==="DROP_PENDING"||rn(!1);var c=o.critical,d=o.dimensions,u=d.draggables[o.critical.draggable.id],f=irt({reason:i,lastImpact:o.impact,afterCritical:o.afterCritical,onLiftImpact:o.onLiftImpact,home:o.dimensions.droppables[o.critical.droppable.id],viewport:o.viewport,draggables:o.dimensions.draggables}),h=f.impact,m=f.didDropInsideDroppable,v=m?PR(h):null,g=m?uP(h):null,y={index:c.draggable.index,droppableId:c.droppable.id},x={draggableId:u.descriptor.id,type:u.descriptor.type,source:y,reason:i,mode:o.movementMode,destination:v,combine:g},b=ort({impact:h,draggable:u,dimensions:d,viewport:o.viewport,afterCritical:o.afterCritical}),w={critical:o.critical,afterCritical:o.afterCritical,result:x,impact:h},j=!Ph(o.current.client.offset,b)||!!x.combine;if(!j){r(DR({completed:w}));return}var _=srt({current:o.current.client.offset,destination:b,reason:i}),S={newHomeClientOffset:b,dropDuration:_,completed:w};r(Ztt(S))}}}},vse=function(){return{x:window.pageXOffset,y:window.pageYOffset}};function crt(e){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(r){r.target!==window&&r.target!==window.document||e()}}}function drt(e){var t=e.onWindowScroll;function r(){t(vse())}var n=o1(r),s=crt(n),o=Ch;function i(){return o!==Ch}function l(){i()&&rn(!1),o=Sd(window,[s])}function c(){i()||rn(!1),n.cancel(),o(),o=Ch}return{start:l,stop:c,isActive:i}}var urt=function(t){return t.type==="DROP_COMPLETE"||t.type==="DROP_ANIMATE"||t.type==="FLUSH"},frt=function(e){var t=drt({onWindowScroll:function(n){e.dispatch(Gtt({newScroll:n}))}});return function(r){return function(n){!t.isActive()&&n.type==="INITIAL_PUBLISH"&&t.start(),t.isActive()&&urt(n)&&t.stop(),r(n)}}},mrt=function(e){var t=!1,r=!1,n=setTimeout(function(){r=!0}),s=function(i){t||r||(t=!0,e(i),clearTimeout(n))};return s.wasCalled=function(){return t},s},hrt=function(){var e=[],t=function(o){var i=CR(e,function(d){return d.timerId===o});i===-1&&rn(!1);var l=e.splice(i,1),c=l[0];c.callback()},r=function(o){var i=setTimeout(function(){return t(i)}),l={timerId:i,callback:o};e.push(l)},n=function(){if(e.length){var o=[].concat(e);e.length=0,o.forEach(function(i){clearTimeout(i.timerId),i.callback()})}};return{add:r,flush:n}},prt=function(t,r){return t==null&&r==null?!0:t==null||r==null?!1:t.droppableId===r.droppableId&&t.index===r.index},grt=function(t,r){return t==null&&r==null?!0:t==null||r==null?!1:t.draggableId===r.draggableId&&t.droppableId===r.droppableId},vrt=function(t,r){if(t===r)return!0;var n=t.draggable.id===r.draggable.id&&t.draggable.droppableId===r.draggable.droppableId&&t.draggable.type===r.draggable.type&&t.draggable.index===r.draggable.index,s=t.droppable.id===r.droppable.id&&t.droppable.type===r.droppable.type;return n&&s},Ey=function(t,r){r()},Ij=function(t,r){return{draggableId:t.draggable.id,type:t.droppable.type,source:{droppableId:t.droppable.id,index:t.draggable.index},mode:r}},tk=function(t,r,n,s){if(!t){n(s(r));return}var o=mrt(n),i={announce:o};t(r,i),o.wasCalled()||n(s(r))},xrt=function(e,t){var r=hrt(),n=null,s=function(h,m){n&&rn(!1),Ey("onBeforeCapture",function(){var v=e().onBeforeCapture;if(v){var g={draggableId:h,mode:m};v(g)}})},o=function(h,m){n&&rn(!1),Ey("onBeforeDragStart",function(){var v=e().onBeforeDragStart;v&&v(Ij(h,m))})},i=function(h,m){n&&rn(!1);var v=Ij(h,m);n={mode:m,lastCritical:h,lastLocation:v.source,lastCombine:null},r.add(function(){Ey("onDragStart",function(){return tk(e().onDragStart,v,t,v_.onDragStart)})})},l=function(h,m){var v=PR(m),g=uP(m);n||rn(!1);var y=!vrt(h,n.lastCritical);y&&(n.lastCritical=h);var x=!prt(n.lastLocation,v);x&&(n.lastLocation=v);var b=!grt(n.lastCombine,g);if(b&&(n.lastCombine=g),!(!y&&!x&&!b)){var w=Yn({},Ij(h,n.mode),{combine:g,destination:v});r.add(function(){Ey("onDragUpdate",function(){return tk(e().onDragUpdate,w,t,v_.onDragUpdate)})})}},c=function(){n||rn(!1),r.flush()},d=function(h){n||rn(!1),n=null,Ey("onDragEnd",function(){return tk(e().onDragEnd,h,t,v_.onDragEnd)})},u=function(){if(n){var h=Yn({},Ij(n.lastCritical,n.mode),{combine:null,destination:null,reason:"CANCEL"});d(h)}};return{beforeCapture:s,beforeStart:o,start:i,update:l,flush:c,drop:d,abort:u}},yrt=function(e,t){var r=xrt(e,t);return function(n){return function(s){return function(o){if(o.type==="BEFORE_INITIAL_CAPTURE"){r.beforeCapture(o.payload.draggableId,o.payload.movementMode);return}if(o.type==="INITIAL_PUBLISH"){var i=o.payload.critical;r.beforeStart(i,o.payload.movementMode),s(o),r.start(i,o.payload.movementMode);return}if(o.type==="DROP_COMPLETE"){var l=o.payload.completed.result;r.flush(),s(o),r.drop(l);return}if(s(o),o.type==="FLUSH"){r.abort();return}var c=n.getState();c.phase==="DRAGGING"&&r.update(c.critical,c.impact)}}}},brt=function(e){return function(t){return function(r){if(r.type!=="DROP_ANIMATION_FINISHED"){t(r);return}var n=e.getState();n.phase!=="DROP_ANIMATING"&&rn(!1),e.dispatch(DR({completed:n.completed}))}}},wrt=function(e){var t=null,r=null;function n(){r&&(cancelAnimationFrame(r),r=null),t&&(t(),t=null)}return function(s){return function(o){if((o.type==="FLUSH"||o.type==="DROP_COMPLETE"||o.type==="DROP_ANIMATION_FINISHED")&&n(),s(o),o.type==="DROP_ANIMATE"){var i={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){var c=e.getState();c.phase==="DROP_ANIMATING"&&e.dispatch(pse())}};r=requestAnimationFrame(function(){r=null,t=Sd(window,[i])})}}}},jrt=function(e){return function(){return function(t){return function(r){(r.type==="DROP_COMPLETE"||r.type==="FLUSH"||r.type==="DROP_ANIMATE")&&e.stopPublishing(),t(r)}}}},_rt=function(e){var t=!1;return function(){return function(r){return function(n){if(n.type==="INITIAL_PUBLISH"){t=!0,e.tryRecordFocus(n.payload.critical.draggable.id),r(n),e.tryRestoreFocusRecorded();return}if(r(n),!!t){if(n.type==="FLUSH"){t=!1,e.tryRestoreFocusRecorded();return}if(n.type==="DROP_COMPLETE"){t=!1;var s=n.payload.completed.result;s.combine&&e.tryShiftRecord(s.draggableId,s.combine.draggableId),e.tryRestoreFocusRecorded()}}}}}},Nrt=function(t){return t.type==="DROP_COMPLETE"||t.type==="DROP_ANIMATE"||t.type==="FLUSH"},Srt=function(e){return function(t){return function(r){return function(n){if(Nrt(n)){e.stop(),r(n);return}if(n.type==="INITIAL_PUBLISH"){r(n);var s=t.getState();s.phase!=="DRAGGING"&&rn(!1),e.start(s);return}r(n),e.scroll(t.getState())}}}},Crt=function(e){return function(t){return function(r){if(t(r),r.type==="PUBLISH_WHILE_DRAGGING"){var n=e.getState();n.phase==="DROP_PENDING"&&(n.isWaiting||e.dispatch(hse({reason:n.reason})))}}}},Prt=_ae,Art=function(e){var t=e.dimensionMarshal,r=e.focusMarshal,n=e.styleMarshal,s=e.getResponders,o=e.announce,i=e.autoScroller;return jae(Ftt,Prt(mZe(rrt(n),jrt(t),trt(t),lrt,brt,wrt,Crt,Srt(i),frt,_rt(r),yrt(s,o))))},rk=function(){return{additions:{},removals:{},modified:{}}};function Ert(e){var t=e.registry,r=e.callbacks,n=rk(),s=null,o=function(){s||(r.collectionStarting(),s=requestAnimationFrame(function(){s=null;var u=n,f=u.additions,h=u.removals,m=u.modified,v=Object.keys(f).map(function(x){return t.draggable.getById(x).getDimension(ji)}).sort(function(x,b){return x.descriptor.index-b.descriptor.index}),g=Object.keys(m).map(function(x){var b=t.droppable.getById(x),w=b.callbacks.getScrollWhileDragging();return{droppableId:x,scroll:w}}),y={additions:v,removals:Object.keys(h),modified:g};n=rk(),r.publish(y)}))},i=function(u){var f=u.descriptor.id;n.additions[f]=u,n.modified[u.descriptor.droppableId]=!0,n.removals[f]&&delete n.removals[f],o()},l=function(u){var f=u.descriptor;n.removals[f.id]=!0,n.modified[f.droppableId]=!0,n.additions[f.id]&&delete n.additions[f.id],o()},c=function(){s&&(cancelAnimationFrame(s),s=null,n=rk())};return{add:i,remove:l,stop:c}}var xse=function(e){var t=e.scrollHeight,r=e.scrollWidth,n=e.height,s=e.width,o=Fc({x:r,y:t},{x:s,y:n}),i={x:Math.max(0,o.x),y:Math.max(0,o.y)};return i},yse=function(){var e=document.documentElement;return e||rn(!1),e},bse=function(){var e=yse(),t=xse({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,width:e.clientWidth,height:e.clientHeight});return t},krt=function(){var e=vse(),t=bse(),r=e.y,n=e.x,s=yse(),o=s.clientWidth,i=s.clientHeight,l=n+o,c=r+i,d=iu({top:r,left:n,right:l,bottom:c}),u={frame:d,scroll:{initial:e,current:e,max:t,diff:{value:ji,displacement:ji}}};return u},Irt=function(e){var t=e.critical,r=e.scrollOptions,n=e.registry,s=krt(),o=s.scroll.current,i=t.droppable,l=n.droppable.getAllByType(i.type).map(function(f){return f.callbacks.getDimensionAndWatchScroll(o,r)}),c=n.draggable.getAllByType(t.draggable.type).map(function(f){return f.getDimension(o)}),d={draggables:Xae(c),droppables:Kae(l)},u={dimensions:d,critical:t,viewport:s};return u};function AU(e,t,r){if(r.descriptor.id===t.id||r.descriptor.type!==t.type)return!1;var n=e.droppable.getById(r.descriptor.droppableId);return n.descriptor.mode==="virtual"}var Ort=function(e,t){var r=null,n=Ert({callbacks:{publish:t.publishWhileDragging,collectionStarting:t.collectionStarting},registry:e}),s=function(m,v){e.droppable.exists(m)||rn(!1),r&&t.updateDroppableIsEnabled({id:m,isEnabled:v})},o=function(m,v){r&&(e.droppable.exists(m)||rn(!1),t.updateDroppableIsCombineEnabled({id:m,isCombineEnabled:v}))},i=function(m,v){r&&(e.droppable.exists(m)||rn(!1),t.updateDroppableScroll({id:m,newScroll:v}))},l=function(m,v){r&&e.droppable.getById(m).callbacks.scroll(v)},c=function(){if(r){n.stop();var m=r.critical.droppable;e.droppable.getAllByType(m.type).forEach(function(v){return v.callbacks.dragStopped()}),r.unsubscribe(),r=null}},d=function(m){r||rn(!1);var v=r.critical.draggable;m.type==="ADDITION"&&AU(e,v,m.value)&&n.add(m.value),m.type==="REMOVAL"&&AU(e,v,m.value)&&n.remove(m.value)},u=function(m){r&&rn(!1);var v=e.draggable.getById(m.draggableId),g=e.droppable.getById(v.descriptor.droppableId),y={draggable:v.descriptor,droppable:g.descriptor},x=e.subscribe(d);return r={critical:y,unsubscribe:x},Irt({critical:y,registry:e,scrollOptions:m.scrollOptions})},f={updateDroppableIsEnabled:s,updateDroppableIsCombineEnabled:o,scrollDroppable:l,updateDroppableScroll:i,startPublishing:u,stopPublishing:c};return f},wse=function(e,t){return e.phase==="IDLE"?!0:e.phase!=="DROP_ANIMATING"||e.completed.result.draggableId===t?!1:e.completed.result.reason==="DROP"},Trt=function(e){window.scrollBy(e.x,e.y)},Drt=wi(function(e){return dP(e).filter(function(t){return!(!t.isEnabled||!t.frame)})}),Mrt=function(t,r){var n=rp(Drt(r),function(s){return s.frame||rn(!1),sse(s.frame.pageMarginBox)(t)});return n},Rrt=function(e){var t=e.center,r=e.destination,n=e.droppables;if(r){var s=n[r];return s.frame?s:null}var o=Mrt(t,n);return o},Ah={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:function(t){return Math.pow(t,2)},durationDampening:{stopDampeningAt:1200,accelerateAt:360}},Lrt=function(e,t){var r=e[t.size]*Ah.startFromPercentage,n=e[t.size]*Ah.maxScrollAtPercentage,s={startScrollingFrom:r,maxScrollValueAt:n};return s},jse=function(e){var t=e.startOfRange,r=e.endOfRange,n=e.current,s=r-t;if(s===0)return 0;var o=n-t,i=o/s;return i},LR=1,Frt=function(e,t){if(e>t.startScrollingFrom)return 0;if(e<=t.maxScrollValueAt)return Ah.maxPixelScroll;if(e===t.startScrollingFrom)return LR;var r=jse({startOfRange:t.maxScrollValueAt,endOfRange:t.startScrollingFrom,current:e}),n=1-r,s=Ah.maxPixelScroll*Ah.ease(n);return Math.ceil(s)},EU=Ah.durationDampening.accelerateAt,kU=Ah.durationDampening.stopDampeningAt,$rt=function(e,t){var r=t,n=kU,s=Date.now(),o=s-r;if(o>=kU)return e;if(o<EU)return LR;var i=jse({startOfRange:EU,endOfRange:n,current:o}),l=e*Ah.ease(i);return Math.ceil(l)},IU=function(e){var t=e.distanceToEdge,r=e.thresholds,n=e.dragStartTime,s=e.shouldUseTimeDampening,o=Frt(t,r);return o===0?0:s?Math.max($rt(o,n),LR):o},OU=function(e){var t=e.container,r=e.distanceToEdges,n=e.dragStartTime,s=e.axis,o=e.shouldUseTimeDampening,i=Lrt(t,s),l=r[s.end]<r[s.start];return l?IU({distanceToEdge:r[s.end],thresholds:i,dragStartTime:n,shouldUseTimeDampening:o}):-1*IU({distanceToEdge:r[s.start],thresholds:i,dragStartTime:n,shouldUseTimeDampening:o})},Brt=function(e){var t=e.container,r=e.subject,n=e.proposedScroll,s=r.height>t.height,o=r.width>t.width;return!o&&!s?n:o&&s?null:{x:o?0:n.x,y:s?0:n.y}},qrt=Hae(function(e){return e===0?0:e}),_se=function(e){var t=e.dragStartTime,r=e.container,n=e.subject,s=e.center,o=e.shouldUseTimeDampening,i={top:s.y-r.top,right:r.right-s.x,bottom:r.bottom-s.y,left:s.x-r.left},l=OU({container:r,distanceToEdges:i,dragStartTime:t,axis:AR,shouldUseTimeDampening:o}),c=OU({container:r,distanceToEdges:i,dragStartTime:t,axis:Qae,shouldUseTimeDampening:o}),d=qrt({x:c,y:l});if(Ph(d,ji))return null;var u=Brt({container:r,subject:n,proposedScroll:d});return u?Ph(u,ji)?null:u:null},zrt=Hae(function(e){return e===0?0:e>0?1:-1}),FR=function(){var e=function(r,n){return r<0?r:r>n?r-n:0};return function(t){var r=t.current,n=t.max,s=t.change,o=Fi(r,s),i={x:e(o.x,n.x),y:e(o.y,n.y)};return Ph(i,ji)?null:i}}(),Nse=function(t){var r=t.max,n=t.current,s=t.change,o={x:Math.max(n.x,r.x),y:Math.max(n.y,r.y)},i=zrt(s),l=FR({max:o,current:n,change:i});return!l||i.x!==0&&l.x===0||i.y!==0&&l.y===0},$R=function(t,r){return Nse({current:t.scroll.current,max:t.scroll.max,change:r})},Urt=function(t,r){if(!$R(t,r))return null;var n=t.scroll.max,s=t.scroll.current;return FR({current:s,max:n,change:r})},BR=function(t,r){var n=t.frame;return n?Nse({current:n.scroll.current,max:n.scroll.max,change:r}):!1},Vrt=function(t,r){var n=t.frame;return!n||!BR(t,r)?null:FR({current:n.scroll.current,max:n.scroll.max,change:r})},Wrt=function(e){var t=e.viewport,r=e.subject,n=e.center,s=e.dragStartTime,o=e.shouldUseTimeDampening,i=_se({dragStartTime:s,container:t.frame,subject:r,center:n,shouldUseTimeDampening:o});return i&&$R(t,i)?i:null},Hrt=function(e){var t=e.droppable,r=e.subject,n=e.center,s=e.dragStartTime,o=e.shouldUseTimeDampening,i=t.frame;if(!i)return null;var l=_se({dragStartTime:s,container:i.pageMarginBox,subject:r,center:n,shouldUseTimeDampening:o});return l&&BR(t,l)?l:null},TU=function(e){var t=e.state,r=e.dragStartTime,n=e.shouldUseTimeDampening,s=e.scrollWindow,o=e.scrollDroppable,i=t.current.page.borderBoxCenter,l=t.dimensions.draggables[t.critical.draggable.id],c=l.page.marginBox;if(t.isWindowScrollAllowed){var d=t.viewport,u=Wrt({dragStartTime:r,viewport:d,subject:c,center:i,shouldUseTimeDampening:n});if(u){s(u);return}}var f=Rrt({center:i,destination:Vc(t.impact),droppables:t.dimensions.droppables});if(f){var h=Hrt({dragStartTime:r,droppable:f,subject:c,center:i,shouldUseTimeDampening:n});h&&o(f.descriptor.id,h)}},Grt=function(e){var t=e.scrollWindow,r=e.scrollDroppable,n=o1(t),s=o1(r),o=null,i=function(u){o||rn(!1);var f=o,h=f.shouldUseTimeDampening,m=f.dragStartTime;TU({state:u,scrollWindow:n,scrollDroppable:s,dragStartTime:m,shouldUseTimeDampening:h})},l=function(u){o&&rn(!1);var f=Date.now(),h=!1,m=function(){h=!0};TU({state:u,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:m,scrollDroppable:m}),o={dragStartTime:f,shouldUseTimeDampening:h},h&&i(u)},c=function(){o&&(n.cancel(),s.cancel(),o=null)};return{start:l,stop:c,scroll:i}},Krt=function(e){var t=e.move,r=e.scrollDroppable,n=e.scrollWindow,s=function(d,u){var f=Fi(d.current.client.selection,u);t({client:f})},o=function(d,u){if(!BR(d,u))return u;var f=Vrt(d,u);if(!f)return r(d.descriptor.id,u),null;var h=Fc(u,f);r(d.descriptor.id,h);var m=Fc(u,h);return m},i=function(d,u,f){if(!d||!$R(u,f))return f;var h=Urt(u,f);if(!h)return n(f),null;var m=Fc(f,h);n(m);var v=Fc(f,m);return v},l=function(d){var u=d.scrollJumpRequest;if(u){var f=Vc(d.impact);f||rn(!1);var h=o(d.dimensions.droppables[f],u);if(h){var m=d.viewport,v=i(d.isWindowScrollAllowed,m,h);v&&s(d,v)}}};return l},Xrt=function(e){var t=e.scrollDroppable,r=e.scrollWindow,n=e.move,s=Grt({scrollWindow:r,scrollDroppable:t}),o=Krt({move:n,scrollWindow:r,scrollDroppable:t}),i=function(d){if(d.phase==="DRAGGING"){if(d.movementMode==="FLUID"){s.scroll(d);return}d.scrollJumpRequest&&o(d)}},l={scroll:i,start:s.start,stop:s.stop};return l},p0="data-rbd",g0=function(){var e=p0+"-drag-handle";return{base:e,draggableId:e+"-draggable-id",contextId:e+"-context-id"}}(),c3=function(){var e=p0+"-draggable";return{base:e,contextId:e+"-context-id",id:e+"-id"}}(),Yrt=function(){var e=p0+"-droppable";return{base:e,contextId:e+"-context-id",id:e+"-id"}}(),DU={contextId:p0+"-scroll-container-context-id"},Jrt=function(t){return function(r){return"["+r+'="'+t+'"]'}},ky=function(t,r){return t.map(function(n){var s=n.styles[r];return s?n.selector+" { "+s+" }":""}).join(" ")},Qrt="pointer-events: none;",Zrt=function(e){var t=Jrt(e),r=function(){var l=`
      cursor: -webkit-grab;
      cursor: grab;
    `;return{selector:t(g0.contextId),styles:{always:`
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: rgba(0,0,0,0);
          touch-action: manipulation;
        `,resting:l,dragging:Qrt,dropAnimating:l}}}(),n=function(){var l=`
      transition: `+Tb.outOfTheWay+`;
    `;return{selector:t(c3.contextId),styles:{dragging:l,dropAnimating:l,userCancel:l}}}(),s={selector:t(Yrt.contextId),styles:{always:"overflow-anchor: none;"}},o={selector:"body",styles:{dragging:`
        cursor: grabbing;
        cursor: -webkit-grabbing;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        overflow-anchor: none;
      `}},i=[n,r,s,o];return{always:ky(i,"always"),resting:ky(i,"resting"),dragging:ky(i,"dragging"),dropAnimating:ky(i,"dropAnimating"),userCancel:ky(i,"userCancel")}},Wc=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?p.useLayoutEffect:p.useEffect,nk=function(){var t=document.querySelector("head");return t||rn(!1),t},MU=function(t){var r=document.createElement("style");return t&&r.setAttribute("nonce",t),r.type="text/css",r};function ent(e,t){var r=Wa(function(){return Zrt(e)},[e]),n=p.useRef(null),s=p.useRef(null),o=Vn(wi(function(f){var h=s.current;h||rn(!1),h.textContent=f}),[]),i=Vn(function(f){var h=n.current;h||rn(!1),h.textContent=f},[]);Wc(function(){!n.current&&!s.current||rn(!1);var f=MU(t),h=MU(t);return n.current=f,s.current=h,f.setAttribute(p0+"-always",e),h.setAttribute(p0+"-dynamic",e),nk().appendChild(f),nk().appendChild(h),i(r.always),o(r.resting),function(){var m=function(g){var y=g.current;y||rn(!1),nk().removeChild(y),g.current=null};m(n),m(s)}},[t,i,o,r.always,r.resting,e]);var l=Vn(function(){return o(r.dragging)},[o,r.dragging]),c=Vn(function(f){if(f==="DROP"){o(r.dropAnimating);return}o(r.userCancel)},[o,r.dropAnimating,r.userCancel]),d=Vn(function(){s.current&&o(r.resting)},[o,r.resting]),u=Wa(function(){return{dragging:l,dropping:c,resting:d}},[l,c,d]);return u}var Sse=function(e){return e&&e.ownerDocument?e.ownerDocument.defaultView:window};function hP(e){return e instanceof Sse(e).HTMLElement}function tnt(e,t){var r="["+g0.contextId+'="'+e+'"]',n=Gae(document.querySelectorAll(r));if(!n.length)return null;var s=rp(n,function(o){return o.getAttribute(g0.draggableId)===t});return!s||!hP(s)?null:s}function rnt(e){var t=p.useRef({}),r=p.useRef(null),n=p.useRef(null),s=p.useRef(!1),o=Vn(function(h,m){var v={id:h,focus:m};return t.current[h]=v,function(){var y=t.current,x=y[h];x!==v&&delete y[h]}},[]),i=Vn(function(h){var m=tnt(e,h);m&&m!==document.activeElement&&m.focus()},[e]),l=Vn(function(h,m){r.current===h&&(r.current=m)},[]),c=Vn(function(){n.current||s.current&&(n.current=requestAnimationFrame(function(){n.current=null;var h=r.current;h&&i(h)}))},[i]),d=Vn(function(h){r.current=null;var m=document.activeElement;m&&m.getAttribute(g0.draggableId)===h&&(r.current=h)},[]);Wc(function(){return s.current=!0,function(){s.current=!1;var h=n.current;h&&cancelAnimationFrame(h)}},[]);var u=Wa(function(){return{register:o,tryRecordFocus:d,tryRestoreFocusRecorded:c,tryShiftRecord:l}},[o,d,c,l]);return u}function nnt(){var e={draggables:{},droppables:{}},t=[];function r(f){return t.push(f),function(){var m=t.indexOf(f);m!==-1&&t.splice(m,1)}}function n(f){t.length&&t.forEach(function(h){return h(f)})}function s(f){return e.draggables[f]||null}function o(f){var h=s(f);return h||rn(!1),h}var i={register:function(h){e.draggables[h.descriptor.id]=h,n({type:"ADDITION",value:h})},update:function(h,m){var v=e.draggables[m.descriptor.id];v&&v.uniqueId===h.uniqueId&&(delete e.draggables[m.descriptor.id],e.draggables[h.descriptor.id]=h)},unregister:function(h){var m=h.descriptor.id,v=s(m);v&&h.uniqueId===v.uniqueId&&(delete e.draggables[m],n({type:"REMOVAL",value:h}))},getById:o,findById:s,exists:function(h){return!!s(h)},getAllByType:function(h){return LS(e.draggables).filter(function(m){return m.descriptor.type===h})}};function l(f){return e.droppables[f]||null}function c(f){var h=l(f);return h||rn(!1),h}var d={register:function(h){e.droppables[h.descriptor.id]=h},unregister:function(h){var m=l(h.descriptor.id);m&&h.uniqueId===m.uniqueId&&delete e.droppables[h.descriptor.id]},getById:c,findById:l,exists:function(h){return!!l(h)},getAllByType:function(h){return LS(e.droppables).filter(function(m){return m.descriptor.type===h})}};function u(){e.draggables={},e.droppables={},t.length=0}return{draggable:i,droppable:d,subscribe:r,clean:u}}function ant(){var e=Wa(nnt,[]);return p.useEffect(function(){return function(){requestAnimationFrame(e.clean)}},[e]),e}var qR=Pe.createContext(null),$S=function(){var e=document.body;return e||rn(!1),e},snt={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},ont=function(t){return"rbd-announcement-"+t};function int(e){var t=Wa(function(){return ont(e)},[e]),r=p.useRef(null);p.useEffect(function(){var o=document.createElement("div");return r.current=o,o.id=t,o.setAttribute("aria-live","assertive"),o.setAttribute("aria-atomic","true"),Yn(o.style,snt),$S().appendChild(o),function(){setTimeout(function(){var c=$S();c.contains(o)&&c.removeChild(o),o===r.current&&(r.current=null)})}},[t]);var n=Vn(function(s){var o=r.current;if(o){o.textContent=s;return}},[]);return n}var lnt=0,cnt={separator:"::"};function zR(e,t){return t===void 0&&(t=cnt),Wa(function(){return""+e+t.separator+lnt++},[t.separator,e])}function dnt(e){var t=e.contextId,r=e.uniqueId;return"rbd-hidden-text-"+t+"-"+r}function unt(e){var t=e.contextId,r=e.text,n=zR("hidden-text",{separator:"-"}),s=Wa(function(){return dnt({contextId:t,uniqueId:n})},[n,t]);return p.useEffect(function(){var i=document.createElement("div");return i.id=s,i.textContent=r,i.style.display="none",$S().appendChild(i),function(){var c=$S();c.contains(i)&&c.removeChild(i)}},[s,r]),s}var pP=Pe.createContext(null);function Cse(e){var t=p.useRef(e);return p.useEffect(function(){t.current=e}),t}function fnt(){var e=null;function t(){return!!e}function r(i){return i===e}function n(i){e&&rn(!1);var l={abandon:i};return e=l,l}function s(){e||rn(!1),e=null}function o(){e&&(e.abandon(),s())}return{isClaimed:t,isActive:r,claim:n,release:s,tryAbandon:o}}var mnt=9,hnt=13,UR=27,Pse=32,pnt=33,gnt=34,vnt=35,xnt=36,ynt=37,bnt=38,wnt=39,jnt=40,Oj,_nt=(Oj={},Oj[hnt]=!0,Oj[mnt]=!0,Oj),Ase=function(e){_nt[e.keyCode]&&e.preventDefault()},gP=function(){var e="visibilitychange";if(typeof document>"u")return e;var t=[e,"ms"+e,"webkit"+e,"moz"+e,"o"+e],r=rp(t,function(n){return"on"+n in document});return r||e}(),Ese=0,RU=5;function Nnt(e,t){return Math.abs(t.x-e.x)>=RU||Math.abs(t.y-e.y)>=RU}var LU={type:"IDLE"};function Snt(e){var t=e.cancel,r=e.completed,n=e.getPhase,s=e.setPhase;return[{eventName:"mousemove",fn:function(i){var l=i.button,c=i.clientX,d=i.clientY;if(l===Ese){var u={x:c,y:d},f=n();if(f.type==="DRAGGING"){i.preventDefault(),f.actions.move(u);return}f.type!=="PENDING"&&rn(!1);var h=f.point;if(Nnt(h,u)){i.preventDefault();var m=f.actions.fluidLift(u);s({type:"DRAGGING",actions:m})}}}},{eventName:"mouseup",fn:function(i){var l=n();if(l.type!=="DRAGGING"){t();return}i.preventDefault(),l.actions.drop({shouldBlockNextClick:!0}),r()}},{eventName:"mousedown",fn:function(i){n().type==="DRAGGING"&&i.preventDefault(),t()}},{eventName:"keydown",fn:function(i){var l=n();if(l.type==="PENDING"){t();return}if(i.keyCode===UR){i.preventDefault(),t();return}Ase(i)}},{eventName:"resize",fn:t},{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(){n().type==="PENDING"&&t()}},{eventName:"webkitmouseforcedown",fn:function(i){var l=n();if(l.type==="IDLE"&&rn(!1),l.actions.shouldRespectForcePress()){t();return}i.preventDefault()}},{eventName:gP,fn:t}]}function Cnt(e){var t=p.useRef(LU),r=p.useRef(Ch),n=Wa(function(){return{eventName:"mousedown",fn:function(f){if(!f.defaultPrevented&&f.button===Ese&&!(f.ctrlKey||f.metaKey||f.shiftKey||f.altKey)){var h=e.findClosestDraggableId(f);if(h){var m=e.tryGetLock(h,i,{sourceEvent:f});if(m){f.preventDefault();var v={x:f.clientX,y:f.clientY};r.current(),d(m,v)}}}}}},[e]),s=Wa(function(){return{eventName:"webkitmouseforcewillbegin",fn:function(f){if(!f.defaultPrevented){var h=e.findClosestDraggableId(f);if(h){var m=e.findOptionsForDraggable(h);m&&(m.shouldRespectForcePress||e.canGetLock(h)&&f.preventDefault())}}}}},[e]),o=Vn(function(){var f={passive:!1,capture:!0};r.current=Sd(window,[s,n],f)},[s,n]),i=Vn(function(){var u=t.current;u.type!=="IDLE"&&(t.current=LU,r.current(),o())},[o]),l=Vn(function(){var u=t.current;i(),u.type==="DRAGGING"&&u.actions.cancel({shouldBlockNextClick:!0}),u.type==="PENDING"&&u.actions.abort()},[i]),c=Vn(function(){var f={capture:!0,passive:!1},h=Snt({cancel:l,completed:i,getPhase:function(){return t.current},setPhase:function(v){t.current=v}});r.current=Sd(window,h,f)},[l,i]),d=Vn(function(f,h){t.current.type!=="IDLE"&&rn(!1),t.current={type:"PENDING",point:h,actions:f},c()},[c]);Wc(function(){return o(),function(){r.current()}},[o])}var bv;function Pnt(){}var Ant=(bv={},bv[gnt]=!0,bv[pnt]=!0,bv[xnt]=!0,bv[vnt]=!0,bv);function Ent(e,t){function r(){t(),e.cancel()}function n(){t(),e.drop()}return[{eventName:"keydown",fn:function(o){if(o.keyCode===UR){o.preventDefault(),r();return}if(o.keyCode===Pse){o.preventDefault(),n();return}if(o.keyCode===jnt){o.preventDefault(),e.moveDown();return}if(o.keyCode===bnt){o.preventDefault(),e.moveUp();return}if(o.keyCode===wnt){o.preventDefault(),e.moveRight();return}if(o.keyCode===ynt){o.preventDefault(),e.moveLeft();return}if(Ant[o.keyCode]){o.preventDefault();return}Ase(o)}},{eventName:"mousedown",fn:r},{eventName:"mouseup",fn:r},{eventName:"click",fn:r},{eventName:"touchstart",fn:r},{eventName:"resize",fn:r},{eventName:"wheel",fn:r,options:{passive:!0}},{eventName:gP,fn:r}]}function knt(e){var t=p.useRef(Pnt),r=Wa(function(){return{eventName:"keydown",fn:function(o){if(o.defaultPrevented||o.keyCode!==Pse)return;var i=e.findClosestDraggableId(o);if(!i)return;var l=e.tryGetLock(i,u,{sourceEvent:o});if(!l)return;o.preventDefault();var c=!0,d=l.snapLift();t.current();function u(){c||rn(!1),c=!1,t.current(),n()}t.current=Sd(window,Ent(d,u),{capture:!0,passive:!1})}}},[e]),n=Vn(function(){var o={passive:!1,capture:!0};t.current=Sd(window,[r],o)},[r]);Wc(function(){return n(),function(){t.current()}},[n])}var ak={type:"IDLE"},Int=120,Ont=.15;function Tnt(e){var t=e.cancel,r=e.getPhase;return[{eventName:"orientationchange",fn:t},{eventName:"resize",fn:t},{eventName:"contextmenu",fn:function(s){s.preventDefault()}},{eventName:"keydown",fn:function(s){if(r().type!=="DRAGGING"){t();return}s.keyCode===UR&&s.preventDefault(),t()}},{eventName:gP,fn:t}]}function Dnt(e){var t=e.cancel,r=e.completed,n=e.getPhase;return[{eventName:"touchmove",options:{capture:!1},fn:function(o){var i=n();if(i.type!=="DRAGGING"){t();return}i.hasMoved=!0;var l=o.touches[0],c=l.clientX,d=l.clientY,u={x:c,y:d};o.preventDefault(),i.actions.move(u)}},{eventName:"touchend",fn:function(o){var i=n();if(i.type!=="DRAGGING"){t();return}o.preventDefault(),i.actions.drop({shouldBlockNextClick:!0}),r()}},{eventName:"touchcancel",fn:function(o){if(n().type!=="DRAGGING"){t();return}o.preventDefault(),t()}},{eventName:"touchforcechange",fn:function(o){var i=n();i.type==="IDLE"&&rn(!1);var l=o.touches[0];if(l){var c=l.force>=Ont;if(c){var d=i.actions.shouldRespectForcePress();if(i.type==="PENDING"){d&&t();return}if(d){if(i.hasMoved){o.preventDefault();return}t();return}o.preventDefault()}}}},{eventName:gP,fn:t}]}function Mnt(e){var t=p.useRef(ak),r=p.useRef(Ch),n=Vn(function(){return t.current},[]),s=Vn(function(m){t.current=m},[]),o=Wa(function(){return{eventName:"touchstart",fn:function(m){if(!m.defaultPrevented){var v=e.findClosestDraggableId(m);if(v){var g=e.tryGetLock(v,l,{sourceEvent:m});if(g){var y=m.touches[0],x=y.clientX,b=y.clientY,w={x,y:b};r.current(),f(g,w)}}}}}},[e]),i=Vn(function(){var m={capture:!0,passive:!1};r.current=Sd(window,[o],m)},[o]),l=Vn(function(){var h=t.current;h.type!=="IDLE"&&(h.type==="PENDING"&&clearTimeout(h.longPressTimerId),s(ak),r.current(),i())},[i,s]),c=Vn(function(){var h=t.current;l(),h.type==="DRAGGING"&&h.actions.cancel({shouldBlockNextClick:!0}),h.type==="PENDING"&&h.actions.abort()},[l]),d=Vn(function(){var m={capture:!0,passive:!1},v={cancel:c,completed:l,getPhase:n},g=Sd(window,Dnt(v),m),y=Sd(window,Tnt(v),m);r.current=function(){g(),y()}},[c,n,l]),u=Vn(function(){var m=n();m.type!=="PENDING"&&rn(!1);var v=m.actions.fluidLift(m.point);s({type:"DRAGGING",actions:v,hasMoved:!1})},[n,s]),f=Vn(function(m,v){n().type!=="IDLE"&&rn(!1);var g=setTimeout(u,Int);s({type:"PENDING",point:v,actions:m,longPressTimerId:g}),d()},[d,n,s,u]);Wc(function(){return i(),function(){r.current();var v=n();v.type==="PENDING"&&(clearTimeout(v.longPressTimerId),s(ak))}},[n,i,s]),Wc(function(){var m=Sd(window,[{eventName:"touchmove",fn:function(){},options:{capture:!1,passive:!1}}]);return m},[])}var Rnt={input:!0,button:!0,textarea:!0,select:!0,option:!0,optgroup:!0,video:!0,audio:!0};function kse(e,t){if(t==null)return!1;var r=!!Rnt[t.tagName.toLowerCase()];if(r)return!0;var n=t.getAttribute("contenteditable");return n==="true"||n===""?!0:t===e?!1:kse(e,t.parentElement)}function Lnt(e,t){var r=t.target;return hP(r)?kse(e,r):!1}var Fnt=function(e){return iu(e.getBoundingClientRect()).center};function $nt(e){return e instanceof Sse(e).Element}var Bnt=function(){var e="matches";if(typeof document>"u")return e;var t=[e,"msMatchesSelector","webkitMatchesSelector"],r=rp(t,function(n){return n in Element.prototype});return r||e}();function Ise(e,t){return e==null?null:e[Bnt](t)?e:Ise(e.parentElement,t)}function qnt(e,t){return e.closest?e.closest(t):Ise(e,t)}function znt(e){return"["+g0.contextId+'="'+e+'"]'}function Unt(e,t){var r=t.target;if(!$nt(r))return null;var n=znt(e),s=qnt(r,n);return!s||!hP(s)?null:s}function Vnt(e,t){var r=Unt(e,t);return r?r.getAttribute(g0.draggableId):null}function Wnt(e,t){var r="["+c3.contextId+'="'+e+'"]',n=Gae(document.querySelectorAll(r)),s=rp(n,function(o){return o.getAttribute(c3.id)===t});return!s||!hP(s)?null:s}function Hnt(e){e.preventDefault()}function Tj(e){var t=e.expected,r=e.phase,n=e.isLockActive;return e.shouldWarn,!(!n()||t!==r)}function Ose(e){var t=e.lockAPI,r=e.store,n=e.registry,s=e.draggableId;if(t.isClaimed())return!1;var o=n.draggable.findById(s);return!(!o||!o.options.isEnabled||!wse(r.getState(),s))}function Gnt(e){var t=e.lockAPI,r=e.contextId,n=e.store,s=e.registry,o=e.draggableId,i=e.forceSensorStop,l=e.sourceEvent,c=Ose({lockAPI:t,store:n,registry:s,draggableId:o});if(!c)return null;var d=s.draggable.getById(o),u=Wnt(r,d.descriptor.id);if(!u||l&&!d.options.canDragInteractiveElements&&Lnt(u,l))return null;var f=t.claim(i||Ch),h="PRE_DRAG";function m(){return d.options.shouldRespectForcePress}function v(){return t.isActive(f)}function g(S,C){Tj({expected:S,phase:h,isLockActive:v,shouldWarn:!0})&&n.dispatch(C())}var y=g.bind(null,"DRAGGING");function x(S){function C(){t.release(),h="COMPLETED"}h!=="PRE_DRAG"&&(C(),h!=="PRE_DRAG"&&rn(!1)),n.dispatch(Btt(S.liftActionArgs)),h="DRAGGING";function P(A,R){if(R===void 0&&(R={shouldBlockNextClick:!1}),S.cleanup(),R.shouldBlockNextClick){var O=Sd(window,[{eventName:"click",fn:Hnt,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(O)}C(),n.dispatch(hse({reason:A}))}return Yn({isActive:function(){return Tj({expected:"DRAGGING",phase:h,isLockActive:v,shouldWarn:!1})},shouldRespectForcePress:m,drop:function(R){return P("DROP",R)},cancel:function(R){return P("CANCEL",R)}},S.actions)}function b(S){var C=o1(function(A){y(function(){return mse({client:A})})}),P=x({liftActionArgs:{id:o,clientSelection:S,movementMode:"FLUID"},cleanup:function(){return C.cancel()},actions:{move:C}});return Yn({},P,{move:C})}function w(){var S={moveUp:function(){return y(Xtt)},moveRight:function(){return y(Jtt)},moveDown:function(){return y(Ytt)},moveLeft:function(){return y(Qtt)}};return x({liftActionArgs:{id:o,clientSelection:Fnt(u),movementMode:"SNAP"},cleanup:Ch,actions:S})}function j(){var S=Tj({expected:"PRE_DRAG",phase:h,isLockActive:v,shouldWarn:!0});S&&t.release()}var _={isActive:function(){return Tj({expected:"PRE_DRAG",phase:h,isLockActive:v,shouldWarn:!1})},shouldRespectForcePress:m,fluidLift:b,snapLift:w,abort:j};return _}var Knt=[Cnt,knt,Mnt];function Xnt(e){var t=e.contextId,r=e.store,n=e.registry,s=e.customSensors,o=e.enableDefaultSensors,i=[].concat(o?Knt:[],s||[]),l=p.useState(function(){return fnt()})[0],c=Vn(function(b,w){b.isDragging&&!w.isDragging&&l.tryAbandon()},[l]);Wc(function(){var b=r.getState(),w=r.subscribe(function(){var j=r.getState();c(b,j),b=j});return w},[l,r,c]),Wc(function(){return l.tryAbandon},[l.tryAbandon]);for(var d=Vn(function(x){return Ose({lockAPI:l,registry:n,store:r,draggableId:x})},[l,n,r]),u=Vn(function(x,b,w){return Gnt({lockAPI:l,registry:n,contextId:t,store:r,draggableId:x,forceSensorStop:b,sourceEvent:w&&w.sourceEvent?w.sourceEvent:null})},[t,l,n,r]),f=Vn(function(x){return Vnt(t,x)},[t]),h=Vn(function(x){var b=n.draggable.findById(x);return b?b.options:null},[n.draggable]),m=Vn(function(){l.isClaimed()&&(l.tryAbandon(),r.getState().phase!=="IDLE"&&r.dispatch(TR()))},[l,r]),v=Vn(l.isClaimed,[l]),g=Wa(function(){return{canGetLock:d,tryGetLock:u,findClosestDraggableId:f,findOptionsForDraggable:h,tryReleaseLock:m,isLockClaimed:v}},[d,u,f,h,m,v]),y=0;y<i.length;y++)i[y](g)}var Ynt=function(t){return{onBeforeCapture:t.onBeforeCapture,onBeforeDragStart:t.onBeforeDragStart,onDragStart:t.onDragStart,onDragEnd:t.onDragEnd,onDragUpdate:t.onDragUpdate}};function Iy(e){return e.current||rn(!1),e.current}function Jnt(e){var t=e.contextId,r=e.setCallbacks,n=e.sensors,s=e.nonce,o=e.dragHandleUsageInstructions,i=p.useRef(null),l=Cse(e),c=Vn(function(){return Ynt(l.current)},[l]),d=int(t),u=unt({contextId:t,text:o}),f=ent(t,s),h=Vn(function(A){Iy(i).dispatch(A)},[]),m=Wa(function(){return oU({publishWhileDragging:ztt,updateDroppableScroll:Vtt,updateDroppableIsEnabled:Wtt,updateDroppableIsCombineEnabled:Htt,collectionStarting:Utt},h)},[h]),v=ant(),g=Wa(function(){return Ort(v,m)},[v,m]),y=Wa(function(){return Xrt(Yn({scrollWindow:Trt,scrollDroppable:g.scrollDroppable},oU({move:mse},h)))},[g.scrollDroppable,h]),x=rnt(t),b=Wa(function(){return Art({announce:d,autoScroller:y,dimensionMarshal:g,focusMarshal:x,getResponders:c,styleMarshal:f})},[d,y,g,x,c,f]);i.current=b;var w=Vn(function(){var A=Iy(i),R=A.getState();R.phase!=="IDLE"&&A.dispatch(TR())},[]),j=Vn(function(){var A=Iy(i).getState();return A.isDragging||A.phase==="DROP_ANIMATING"},[]),_=Wa(function(){return{isDragging:j,tryAbort:w}},[j,w]);r(_);var S=Vn(function(A){return wse(Iy(i).getState(),A)},[]),C=Vn(function(){return Ap(Iy(i).getState())},[]),P=Wa(function(){return{marshal:g,focus:x,contextId:t,canLift:S,isMovementAllowed:C,dragHandleUsageInstructionsId:u,registry:v}},[t,g,u,x,S,C,v]);return Xnt({contextId:t,store:b,registry:v,customSensors:n,enableDefaultSensors:e.enableDefaultSensors!==!1}),p.useEffect(function(){return w},[w]),Pe.createElement(pP.Provider,{value:P},Pe.createElement(xZe,{context:qR,store:b},e.children))}var Qnt=0;function Znt(){return Wa(function(){return""+Qnt++},[])}function eat(e){var t=Znt(),r=e.dragHandleUsageInstructions||v_.dragHandleUsageInstructions;return Pe.createElement(ket,null,function(n){return Pe.createElement(Jnt,{nonce:e.nonce,contextId:t,setCallbacks:n,dragHandleUsageInstructions:r,enableDefaultSensors:e.enableDefaultSensors,sensors:e.sensors,onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragUpdate:e.onDragUpdate,onDragEnd:e.onDragEnd},e.children)})}var Tse=function(t){return function(r){return t===r}},tat=Tse("scroll"),rat=Tse("auto"),FU=function(t,r){return r(t.overflowX)||r(t.overflowY)},nat=function(t){var r=window.getComputedStyle(t),n={overflowX:r.overflowX,overflowY:r.overflowY};return FU(n,tat)||FU(n,rat)},aat=function(){return!1},sat=function e(t){return t==null?null:t===document.body?aat()?t:null:t===document.documentElement?null:nat(t)?t:e(t.parentElement)},d3=function(e){return{x:e.scrollLeft,y:e.scrollTop}},oat=function e(t){if(!t)return!1;var r=window.getComputedStyle(t);return r.position==="fixed"?!0:e(t.parentElement)},iat=function(e){var t=sat(e),r=oat(e);return{closestScrollable:t,isFixedOnPage:r}},lat=function(e){var t=e.descriptor,r=e.isEnabled,n=e.isCombineEnabled,s=e.isFixedOnPage,o=e.direction,i=e.client,l=e.page,c=e.closest,d=function(){if(!c)return null;var m=c.scrollSize,v=c.client,g=xse({scrollHeight:m.scrollHeight,scrollWidth:m.scrollWidth,height:v.paddingBox.height,width:v.paddingBox.width});return{pageMarginBox:c.page.marginBox,frameClient:v,scrollSize:m,shouldClipSubject:c.shouldClipSubject,scroll:{initial:c.scroll,current:c.scroll,max:g,diff:{value:ji,displacement:ji}}}}(),u=o==="vertical"?AR:Qae,f=h0({page:l,withPlaceholder:null,axis:u,frame:d}),h={descriptor:t,isCombineEnabled:n,isFixedOnPage:s,axis:u,isEnabled:r,client:i,page:l,frame:d,subject:f};return h},cat=function(t,r){var n=zae(t);if(!r||t!==r)return n;var s=n.paddingBox.top-r.scrollTop,o=n.paddingBox.left-r.scrollLeft,i=s+r.scrollHeight,l=o+r.scrollWidth,c={top:s,right:l,bottom:i,left:o},d=_R(c,n.border),u=NR({borderBox:d,margin:n.margin,border:n.border,padding:n.padding});return u},dat=function(e){var t=e.ref,r=e.descriptor,n=e.env,s=e.windowScroll,o=e.direction,i=e.isDropDisabled,l=e.isCombineEnabled,c=e.shouldClipSubject,d=n.closestScrollable,u=cat(t,d),f=DS(u,s),h=function(){if(!d)return null;var v=zae(d),g={scrollHeight:d.scrollHeight,scrollWidth:d.scrollWidth};return{client:v,page:DS(v,s),scroll:d3(d),scrollSize:g,shouldClipSubject:c}}(),m=lat({descriptor:r,isEnabled:!i,isCombineEnabled:l,isFixedOnPage:n.isFixedOnPage,direction:o,client:u,page:f,closest:h});return m},uat={passive:!1},fat={passive:!0},$U=function(e){return e.shouldPublishImmediately?uat:fat};function BS(e){var t=p.useContext(e);return t||rn(!1),t}var Dj=function(t){return t&&t.env.closestScrollable||null};function mat(e){var t=p.useRef(null),r=BS(pP),n=zR("droppable"),s=r.registry,o=r.marshal,i=Cse(e),l=Wa(function(){return{id:e.droppableId,type:e.type,mode:e.mode}},[e.droppableId,e.mode,e.type]),c=p.useRef(l),d=Wa(function(){return wi(function(j,_){t.current||rn(!1);var S={x:j,y:_};o.updateDroppableScroll(l.id,S)})},[l.id,o]),u=Vn(function(){var j=t.current;return!j||!j.env.closestScrollable?ji:d3(j.env.closestScrollable)},[]),f=Vn(function(){var j=u();d(j.x,j.y)},[u,d]),h=Wa(function(){return o1(f)},[f]),m=Vn(function(){var j=t.current,_=Dj(j);j&&_||rn(!1);var S=j.scrollOptions;if(S.shouldPublishImmediately){f();return}h()},[h,f]),v=Vn(function(j,_){t.current&&rn(!1);var S=i.current,C=S.getDroppableRef();C||rn(!1);var P=iat(C),A={ref:C,descriptor:l,env:P,scrollOptions:_};t.current=A;var R=dat({ref:C,descriptor:l,env:P,windowScroll:j,direction:S.direction,isDropDisabled:S.isDropDisabled,isCombineEnabled:S.isCombineEnabled,shouldClipSubject:!S.ignoreContainerClipping}),O=P.closestScrollable;return O&&(O.setAttribute(DU.contextId,r.contextId),O.addEventListener("scroll",m,$U(A.scrollOptions))),R},[r.contextId,l,m,i]),g=Vn(function(){var j=t.current,_=Dj(j);return j&&_||rn(!1),d3(_)},[]),y=Vn(function(){var j=t.current;j||rn(!1);var _=Dj(j);t.current=null,_&&(h.cancel(),_.removeAttribute(DU.contextId),_.removeEventListener("scroll",m,$U(j.scrollOptions)))},[m,h]),x=Vn(function(j){var _=t.current;_||rn(!1);var S=Dj(_);S||rn(!1),S.scrollTop+=j.y,S.scrollLeft+=j.x},[]),b=Wa(function(){return{getDimensionAndWatchScroll:v,getScrollWhileDragging:g,dragStopped:y,scroll:x}},[y,v,g,x]),w=Wa(function(){return{uniqueId:n,descriptor:l,callbacks:b}},[b,l,n]);Wc(function(){return c.current=w.descriptor,s.droppable.register(w),function(){t.current&&y(),s.droppable.unregister(w)}},[b,l,y,w,o,s.droppable]),Wc(function(){t.current&&o.updateDroppableIsEnabled(c.current.id,!e.isDropDisabled)},[e.isDropDisabled,o]),Wc(function(){t.current&&o.updateDroppableIsCombineEnabled(c.current.id,e.isCombineEnabled)},[e.isCombineEnabled,o])}function sk(){}var BU={width:0,height:0,margin:Ret},hat=function(t){var r=t.isAnimatingOpenOnMount,n=t.placeholder,s=t.animate;return r||s==="close"?BU:{height:n.client.borderBox.height,width:n.client.borderBox.width,margin:n.client.margin}},pat=function(t){var r=t.isAnimatingOpenOnMount,n=t.placeholder,s=t.animate,o=hat({isAnimatingOpenOnMount:r,placeholder:n,animate:s});return{display:n.display,boxSizing:"border-box",width:o.width,height:o.height,marginTop:o.margin.top,marginRight:o.margin.right,marginBottom:o.margin.bottom,marginLeft:o.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:s!=="none"?Tb.placeholder:null}};function gat(e){var t=p.useRef(null),r=Vn(function(){t.current&&(clearTimeout(t.current),t.current=null)},[]),n=e.animate,s=e.onTransitionEnd,o=e.onClose,i=e.contextId,l=p.useState(e.animate==="open"),c=l[0],d=l[1];p.useEffect(function(){return c?n!=="open"?(r(),d(!1),sk):t.current?sk:(t.current=setTimeout(function(){t.current=null,d(!1)}),r):sk},[n,c,r]);var u=Vn(function(h){h.propertyName==="height"&&(s(),n==="close"&&o())},[n,o,s]),f=pat({isAnimatingOpenOnMount:c,animate:e.animate,placeholder:e.placeholder});return Pe.createElement(e.placeholder.tagName,{style:f,"data-rbd-placeholder-context-id":i,onTransitionEnd:u,ref:e.innerRef})}var vat=Pe.memo(gat),VR=Pe.createContext(null),xat=function(e){yZ(t,e);function t(){for(var n,s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return n=e.call.apply(e,[this].concat(o))||this,n.state={isVisible:!!n.props.on,data:n.props.on,animate:n.props.shouldAnimate&&n.props.on?"open":"none"},n.onClose=function(){n.state.animate==="close"&&n.setState({isVisible:!1})},n}t.getDerivedStateFromProps=function(s,o){return s.shouldAnimate?s.on?{isVisible:!0,data:s.on,animate:"open"}:o.isVisible?{isVisible:!0,data:o.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:!!s.on,data:s.on,animate:"none"}};var r=t.prototype;return r.render=function(){if(!this.state.isVisible)return null;var s={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(s)},t}(Pe.PureComponent),qU={dragging:5e3,dropAnimating:4500},yat=function(t,r){return r?Tb.drop(r.duration):t?Tb.snap:Tb.fluid},bat=function(t,r){return t?r?d1.opacity.drop:d1.opacity.combining:null},wat=function(t){return t.forceShouldAnimate!=null?t.forceShouldAnimate:t.mode==="SNAP"};function jat(e){var t=e.dimension,r=t.client,n=e.offset,s=e.combineWith,o=e.dropping,i=!!s,l=wat(e),c=!!o,d=c?i3.drop(n,i):i3.moveTo(n),u={position:"fixed",top:r.marginBox.top,left:r.marginBox.left,boxSizing:"border-box",width:r.borderBox.width,height:r.borderBox.height,transition:yat(l,o),transform:d,opacity:bat(i,c),zIndex:c?qU.dropAnimating:qU.dragging,pointerEvents:"none"};return u}function _at(e){return{transform:i3.moveTo(e.offset),transition:e.shouldAnimateDisplacement?null:"none"}}function Nat(e){return e.type==="DRAGGING"?jat(e):_at(e)}function Sat(e,t,r){r===void 0&&(r=ji);var n=window.getComputedStyle(t),s=t.getBoundingClientRect(),o=qae(s,n),i=DS(o,r),l={client:o,tagName:t.tagName.toLowerCase(),display:n.display},c={x:o.marginBox.width,y:o.marginBox.height},d={descriptor:e,placeholder:l,displaceBy:c,client:o,page:i};return d}function Cat(e){var t=zR("draggable"),r=e.descriptor,n=e.registry,s=e.getDraggableRef,o=e.canDragInteractiveElements,i=e.shouldRespectForcePress,l=e.isEnabled,c=Wa(function(){return{canDragInteractiveElements:o,shouldRespectForcePress:i,isEnabled:l}},[o,l,i]),d=Vn(function(m){var v=s();return v||rn(!1),Sat(r,v,m)},[r,s]),u=Wa(function(){return{uniqueId:t,descriptor:r,options:c,getDimension:d}},[r,d,c,t]),f=p.useRef(u),h=p.useRef(!0);Wc(function(){return n.draggable.register(f.current),function(){return n.draggable.unregister(f.current)}},[n.draggable]),Wc(function(){if(h.current){h.current=!1;return}var m=f.current;f.current=u,n.draggable.update(u,m)},[u,n.draggable])}function Pat(e){e.preventDefault()}function Aat(e){var t=p.useRef(null),r=Vn(function(A){t.current=A},[]),n=Vn(function(){return t.current},[]),s=BS(pP),o=s.contextId,i=s.dragHandleUsageInstructionsId,l=s.registry,c=BS(VR),d=c.type,u=c.droppableId,f=Wa(function(){return{id:e.draggableId,index:e.index,type:d,droppableId:u}},[e.draggableId,e.index,d,u]),h=e.children,m=e.draggableId,v=e.isEnabled,g=e.shouldRespectForcePress,y=e.canDragInteractiveElements,x=e.isClone,b=e.mapped,w=e.dropAnimationFinished;if(!x){var j=Wa(function(){return{descriptor:f,registry:l,getDraggableRef:n,canDragInteractiveElements:y,shouldRespectForcePress:g,isEnabled:v}},[f,l,n,y,g,v]);Cat(j)}var _=Wa(function(){return v?{tabIndex:0,role:"button","aria-describedby":i,"data-rbd-drag-handle-draggable-id":m,"data-rbd-drag-handle-context-id":o,draggable:!1,onDragStart:Pat}:null},[o,i,m,v]),S=Vn(function(A){b.type==="DRAGGING"&&b.dropping&&A.propertyName==="transform"&&w()},[w,b]),C=Wa(function(){var A=Nat(b),R=b.type==="DRAGGING"&&b.dropping?S:null,O={innerRef:r,draggableProps:{"data-rbd-draggable-context-id":o,"data-rbd-draggable-id":m,style:A,onTransitionEnd:R},dragHandleProps:_};return O},[o,_,m,b,S,r]),P=Wa(function(){return{draggableId:f.id,type:f.type,source:{index:f.index,droppableId:f.droppableId}}},[f.droppableId,f.id,f.index,f.type]);return h(C,b.snapshot,P)}var Dse=function(e,t){return e===t},Mse=function(e){var t=e.combine,r=e.destination;return r?r.droppableId:t?t.droppableId:null},Eat=function(t){return t.combine?t.combine.draggableId:null},kat=function(t){return t.at&&t.at.type==="COMBINE"?t.at.combine.draggableId:null};function Iat(){var e=wi(function(s,o){return{x:s,y:o}}),t=wi(function(s,o,i,l,c){return{isDragging:!0,isClone:o,isDropAnimating:!!c,dropAnimation:c,mode:s,draggingOver:i,combineWith:l,combineTargetFor:null}}),r=wi(function(s,o,i,l,c,d,u){return{mapped:{type:"DRAGGING",dropping:null,draggingOver:c,combineWith:d,mode:o,offset:s,dimension:i,forceShouldAnimate:u,snapshot:t(o,l,c,d,null)}}}),n=function(o,i){if(o.isDragging){if(o.critical.draggable.id!==i.draggableId)return null;var l=o.current.client.offset,c=o.dimensions.draggables[i.draggableId],d=Vc(o.impact),u=kat(o.impact),f=o.forceShouldAnimate;return r(e(l.x,l.y),o.movementMode,c,i.isClone,d,u,f)}if(o.phase==="DROP_ANIMATING"){var h=o.completed;if(h.result.draggableId!==i.draggableId)return null;var m=i.isClone,v=o.dimensions.draggables[i.draggableId],g=h.result,y=g.mode,x=Mse(g),b=Eat(g),w=o.dropDuration,j={duration:w,curve:MR.drop,moveTo:o.newHomeClientOffset,opacity:b?d1.opacity.drop:null,scale:b?d1.scale.drop:null};return{mapped:{type:"DRAGGING",offset:o.newHomeClientOffset,dimension:v,dropping:j,draggingOver:x,combineWith:b,mode:y,forceShouldAnimate:null,snapshot:t(y,m,x,b,j)}}}return null};return n}function Rse(e){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:e,combineWith:null}}var Oat={mapped:{type:"SECONDARY",offset:ji,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:Rse(null)}};function Tat(){var e=wi(function(i,l){return{x:i,y:l}}),t=wi(Rse),r=wi(function(i,l,c){return l===void 0&&(l=null),{mapped:{type:"SECONDARY",offset:i,combineTargetFor:l,shouldAnimateDisplacement:c,snapshot:t(l)}}}),n=function(l){return l?r(ji,l,!0):null},s=function(l,c,d,u){var f=d.displaced.visible[l],h=!!(u.inVirtualList&&u.effected[l]),m=uP(d),v=m&&m.draggableId===l?c:null;if(!f){if(!h)return n(v);if(d.displaced.invisible[l])return null;var g=K0(u.displacedBy.point),y=e(g.x,g.y);return r(y,v,!0)}if(h)return n(v);var x=d.displacedBy.point,b=e(x.x,x.y);return r(b,v,f.shouldAnimate)},o=function(l,c){if(l.isDragging)return l.critical.draggable.id===c.draggableId?null:s(c.draggableId,l.critical.draggable.id,l.impact,l.afterCritical);if(l.phase==="DROP_ANIMATING"){var d=l.completed;return d.result.draggableId===c.draggableId?null:s(c.draggableId,d.result.draggableId,d.impact,d.afterCritical)}return null};return o}var Dat=function(){var t=Iat(),r=Tat(),n=function(o,i){return t(o,i)||r(o,i)||Oat};return n},Mat={dropAnimationFinished:pse},Rat=$ae(Dat,Mat,null,{context:qR,pure:!0,areStatePropsEqual:Dse})(Aat);function Lse(e){var t=BS(VR),r=t.isUsingCloneFor;return r===e.draggableId&&!e.isClone?null:Pe.createElement(Rat,e)}function Lat(e){var t=typeof e.isDragDisabled=="boolean"?!e.isDragDisabled:!0,r=!!e.disableInteractiveElementBlocking,n=!!e.shouldRespectForcePress;return Pe.createElement(Lse,Yn({},e,{isClone:!1,isEnabled:t,canDragInteractiveElements:r,shouldRespectForcePress:n}))}function Fat(e){var t=p.useContext(pP);t||rn(!1);var r=t.contextId,n=t.isMovementAllowed,s=p.useRef(null),o=p.useRef(null),i=e.children,l=e.droppableId,c=e.type,d=e.mode,u=e.direction,f=e.ignoreContainerClipping,h=e.isDropDisabled,m=e.isCombineEnabled,v=e.snapshot,g=e.useClone,y=e.updateViewportMaxScroll,x=e.getContainerForClone,b=Vn(function(){return s.current},[]),w=Vn(function(O){s.current=O},[]);Vn(function(){return o.current},[]);var j=Vn(function(O){o.current=O},[]),_=Vn(function(){n()&&y({maxScroll:bse()})},[n,y]);mat({droppableId:l,type:c,mode:d,direction:u,isDropDisabled:h,isCombineEnabled:m,ignoreContainerClipping:f,getDroppableRef:b});var S=Pe.createElement(xat,{on:e.placeholder,shouldAnimate:e.shouldAnimatePlaceholder},function(O){var I=O.onClose,M=O.data,D=O.animate;return Pe.createElement(vat,{placeholder:M,onClose:I,innerRef:j,animate:D,contextId:r,onTransitionEnd:_})}),C=Wa(function(){return{innerRef:w,placeholder:S,droppableProps:{"data-rbd-droppable-id":l,"data-rbd-droppable-context-id":r}}},[r,l,S,w]),P=g?g.dragging.draggableId:null,A=Wa(function(){return{droppableId:l,type:c,isUsingCloneFor:P}},[l,P,c]);function R(){if(!g)return null;var O=g.dragging,I=g.render,M=Pe.createElement(Lse,{draggableId:O.draggableId,index:O.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},function(D,U){return I(D,U,O)});return g4.createPortal(M,x())}return Pe.createElement(VR.Provider,{value:A},i(C,v),R())}var ok=function(t,r){return t===r.droppable.type},zU=function(t,r){return r.draggables[t.draggable.id]},$at=function(){var t={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},r=Yn({},t,{shouldAnimatePlaceholder:!1}),n=wi(function(i){return{draggableId:i.id,type:i.type,source:{index:i.index,droppableId:i.droppableId}}}),s=wi(function(i,l,c,d,u,f){var h=u.descriptor.id,m=u.descriptor.droppableId===i;if(m){var v=f?{render:f,dragging:n(u.descriptor)}:null,g={isDraggingOver:c,draggingOverWith:c?h:null,draggingFromThisWith:h,isUsingPlaceholder:!0};return{placeholder:u.placeholder,shouldAnimatePlaceholder:!1,snapshot:g,useClone:v}}if(!l)return r;if(!d)return t;var y={isDraggingOver:c,draggingOverWith:h,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:u.placeholder,shouldAnimatePlaceholder:!0,snapshot:y,useClone:null}}),o=function(l,c){var d=c.droppableId,u=c.type,f=!c.isDropDisabled,h=c.renderClone;if(l.isDragging){var m=l.critical;if(!ok(u,m))return r;var v=zU(m,l.dimensions),g=Vc(l.impact)===d;return s(d,f,g,g,v,h)}if(l.phase==="DROP_ANIMATING"){var y=l.completed;if(!ok(u,y.critical))return r;var x=zU(y.critical,l.dimensions);return s(d,f,Mse(y.result)===d,Vc(y.impact)===d,x,h)}if(l.phase==="IDLE"&&l.completed&&!l.shouldFlush){var b=l.completed;if(!ok(u,b.critical))return r;var w=Vc(b.impact)===d,j=!!(b.impact.at&&b.impact.at.type==="COMBINE"),_=b.critical.droppable.id===d;return w?j?t:r:_?t:r}return r};return o},Bat={updateViewportMaxScroll:Ktt};function qat(){return document.body||rn(!1),document.body}var zat={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:qat},Fse=$ae($at,Bat,null,{context:qR,pure:!0,areStatePropsEqual:Dse})(Fat);Fse.defaultProps=zat;function wv({className:e,...t}){return a.jsx("div",{className:pr("animate-pulse rounded-md bg-muted/20",e),...t})}function vP(e){return{id:e.id,code:e.codigo_produto??"",name:e.nome,category:e.categoria??"",type:e.tipo_produto==="uso_interno"?"Uso Interno":"Venda",cost:Number(e.valor_custo??e.preco_custo??0),price:Number(e.valor_venda??e.preco_venda??0),stock:Number(e.estoque??e.estoque_atual??0),minStock:Number(e.estoque_minimo??0),status:e.status??(e.ativo===!1||Number(e.estoque??0)===0?"inactive":Number(e.estoque??0)>0&&Number(e.estoque??0)<=Number(e.estoque_minimo??0)?"low_stock":"active"),validade:e.validade?new Date(e.validade):null,barcode:e.codigo_barras??"",barcodeBox:e.codigo_barras_caixa??"",reference:e.referencia??"",brand:e.marca??"",group:e.grupo??"",unit:e.unidade??"UN",initialStock:Number(e.estoque_inicial??0),currentStock:Number(e.estoque_atual??e.estoque??0),weight:e.peso!=null?Number(e.peso):null,buyPrice:e.preco_compra!=null?Number(e.preco_compra):null,costsPercent:e.custos_percent!=null?Number(e.custos_percent):null,costPrice:e.preco_custo!=null?Number(e.preco_custo):null,marginPercent:e.lucro_percent!=null?Number(e.lucro_percent):null,salePrice:e.preco_venda!=null?Number(e.preco_venda):null,wholesaleQty:e.qtd_atacado!=null?Number(e.qtd_atacado):null,wholesalePrice:e.preco_atacado!=null?Number(e.preco_atacado):null,commissionPercent:e.comissao_percent!=null?Number(e.comissao_percent):null,discountPercent:e.desconto_percent!=null?Number(e.desconto_percent):null,cfopInterno:e.cfop_interno??"",cstIcmsInterno:e.cst_icms_interno??"",csosnInterno:e.csosn_interno??"",aliqIcmsInterno:e.aliquota_icms_interno!=null?Number(e.aliquota_icms_interno):null,cfopExterno:e.cfop_externo??"",cstIcmsExterno:e.cst_icms_externo??"",csosnExterno:e.csosn_externo??"",aliqIcmsExterno:e.aliquota_icms_externo!=null?Number(e.aliquota_icms_externo):null,cstPisEntrada:e.cst_pis_entrada??"",cstPisSaida:e.cst_pis_saida??"",aliqPisPercent:e.aliquota_pis_percent!=null?Number(e.aliquota_pis_percent):null,aliqCofinsPercent:e.aliquota_cofins_percent!=null?Number(e.aliquota_cofins_percent):null,cstIpi:e.cst_ipi??"",aliqIpiPercent:e.aliquota_ipi_percent!=null?Number(e.aliquota_ipi_percent):null,fcpPercent:e.fcp_percent!=null?Number(e.fcp_percent):null,mvaPercent:e.mva_percent!=null?Number(e.mva_percent):null,baseReduzidaPercent:e.base_reduzida_percent!=null?Number(e.base_reduzida_percent):null,ncm:e.ncm??"",ncmDescription:e.descricao_ncm??"",cest:e.cest??"",active:e.ativo??!0,allowSale:e.permite_venda??!0,payCommission:e.paga_comissao??!1,variablePrice:e.preco_variavel??!1,composition:e.composicao??!1,service:e.servico??!1,hasGrid:e.grade??!1,usePriceTable:e.usar_tabela_preco??!1,fuel:e.combustivel??!1,useImei:e.usa_imei??!1,stockByGrid:e.controle_estoque_por_grade??!1,showInApp:e.mostrar_no_app??!1,dataImportacao:e.data_importacao?new Date(e.data_importacao):null,importadoViaXml:e.importado_via_xml??!1}}async function Uat({from:e,to:t,codigoEmpresa:r,limit:n=1e3}={}){if(!e||!t)throw new Error("Perodo invlido");const s=(e instanceof Date?e:new Date(e)).toISOString(),o=(t instanceof Date?t:new Date(t)).toISOString(),{data:i,error:l}=await Fo(v=>{let g=de.from("comanda_itens").select("produto_id, quantidade, created_at").gte("created_at",s).lte("created_at",o).limit(n).abortSignal(v);return r&&(g=g.eq("codigo_empresa",r)),g},2e4,"Timeout getSoldProductsByPeriod (20s)");if(l)throw l;const c=new Map;for(const v of i||[]){const g=v.produto_id,y=Number(v.quantidade||0);c.set(g,(c.get(g)||0)+y)}const d=Array.from(c.entries()).sort((v,g)=>g[1]-v[1]);if(d.length===0)return[];const u=d.map(([v])=>v),{data:f,error:h}=await Fo(v=>{let g=de.from("produtos").select("id, nome").in("id",u).abortSignal(v);return r&&(g=g.eq("codigo_empresa",r)),g},15e3,"Timeout getSoldProductsByPeriod:produtos (15s)");if(h)throw h;const m=new Map((f||[]).map(v=>[v.id,v.nome]));return d.map(([v,g])=>({id:v,name:m.get(v)||String(v),total:g}))}async function bx({productId:e,delta:t,codigoEmpresa:r}){const n=Number(t);if(!e||!Number.isFinite(n)||n===0)throw new Error("Parmetros invlidos para ajuste de estoque");const{data:s,error:o}=await Fo(d=>{let u=de.from("produtos").select("id, estoque, estoque_atual").eq("id",e).single().abortSignal(d);return r&&(u=u.eq("codigo_empresa",r)),u},1e4,"Timeout get current stock (10s)");if(o)throw o;const l=Number(s?.estoque??s?.estoque_atual??0)+n,{error:c}=await Fo(d=>{let u=de.from("produtos").update({estoque:l,estoque_atual:l}).eq("id",e).abortSignal(d);return r&&(u=u.eq("codigo_empresa",r)),u},1e4,"Timeout update stock (10s)");if(c)throw c;return{id:e,stock:l}}async function Vat({limit:e=5,codigoEmpresa:t}={}){const r=new Date;r.setHours(0,0,0,0);const n=r.toISOString(),{data:s,error:o}=await Fo(h=>{let m=de.from("comanda_itens").select("produto_id, quantidade, created_at").gte("created_at",n).abortSignal(h);return t&&(m=m.eq("codigo_empresa",t)),m},15e3,"Timeout getMostSoldProductsToday (15s)");if(o)throw o;const i=new Map;for(const h of s||[]){const m=h.produto_id,v=Number(h.quantidade||0);i.set(m,(i.get(m)||0)+v)}const l=Array.from(i.entries()).sort((h,m)=>m[1]-h[1]).slice(0,e);if(l.length===0)return[];const c=l.map(([h])=>h),{data:d,error:u}=await Fo(h=>{let m=de.from("produtos").select("id, nome").in("id",c).abortSignal(h);return t&&(m=m.eq("codigo_empresa",t)),m},15e3,"Timeout getMostSoldProductsToday:produtos (15s)");if(u)throw u;const f=new Map((d||[]).map(h=>[h.id,h.nome]));return l.map(([h,m])=>({id:h,name:f.get(h)||String(h),total:m}))}async function UU({codigoEmpresa:e}={}){if(!e)throw new Error("codigoEmpresa  obrigatrio");const{data:t,error:r}=await Fo(l=>de.from("produtos").select("codigo_produto").eq("codigo_empresa",e).order("codigo_produto",{ascending:!0}).abortSignal(l),15e3,"Timeout getNextProductCode (15s)");if(r)throw r;const n=new Set;for(const l of t||[]){const c=(l.codigo_produto||"").trim();if(/^\d+$/.test(c)){const d=parseInt(c,10);Number.isFinite(d)&&d>0&&n.add(d)}}let s=1;const o=(n.size||0)+1e3;let i=0;for(;n.has(s)&&i<o;)s+=1,i+=1;return(!Number.isFinite(s)||s<=0)&&(s=1),String(s).padStart(4,"0")}function $se(e){return{codigo_produto:e.code||null,nome:e.name,categoria:e.category||null,tipo_produto:e.type==="Uso Interno"?"uso_interno":"venda",valor_custo:e.cost!=null?Number(e.cost):0,valor_venda:e.price!=null?Number(e.price):0,estoque:e.stock!=null?Number(e.stock):0,estoque_minimo:e.minStock!=null?Number(e.minStock):0,status:e.status||null,validade:e.validade?new Date(e.validade).toISOString().slice(0,10):null,codigo_barras:e.barcode||null,codigo_barras_caixa:e.barcodeBox||null,referencia:e.reference||null,marca:e.brand||null,grupo:e.group||null,unidade:e.unit||null,estoque_inicial:e.initialStock!=null?Number(e.initialStock):null,estoque_atual:e.currentStock!=null?Number(e.currentStock):null,peso:e.weight!=null?Number(e.weight):null,preco_compra:e.buyPrice!=null?Number(e.buyPrice):null,custos_percent:e.costsPercent!=null?Number(e.costsPercent):null,preco_custo:e.costPrice!=null?Number(e.costPrice):null,lucro_percent:e.marginPercent!=null?Number(e.marginPercent):null,preco_venda:e.salePrice!=null?Number(e.salePrice):null,qtd_atacado:e.wholesaleQty!=null?Number(e.wholesaleQty):null,preco_atacado:e.wholesalePrice!=null?Number(e.wholesalePrice):null,comissao_percent:e.commissionPercent!=null?Number(e.commissionPercent):null,desconto_percent:e.discountPercent!=null?Number(e.discountPercent):null,cfop_interno:e.cfopInterno||null,cst_icms_interno:e.cstIcmsInterno||null,csosn_interno:e.csosnInterno||null,aliquota_icms_interno:e.aliqIcmsInterno!=null?Number(e.aliqIcmsInterno):null,cfop_externo:e.cfopExterno||null,cst_icms_externo:e.cstIcmsExterno||null,csosn_externo:e.csosnExterno||null,aliquota_icms_externo:e.aliqIcmsExterno!=null?Number(e.aliqIcmsExterno):null,cst_pis_entrada:e.cstPisEntrada||null,cst_pis_saida:e.cstPisSaida||null,aliquota_pis_percent:e.aliqPisPercent!=null?Number(e.aliqPisPercent):null,aliquota_cofins_percent:e.aliqCofinsPercent!=null?Number(e.aliqCofinsPercent):null,cst_ipi:e.cstIpi||null,aliquota_ipi_percent:e.aliqIpiPercent!=null?Number(e.aliqIpiPercent):null,fcp_percent:e.fcpPercent!=null?Number(e.fcpPercent):null,mva_percent:e.mvaPercent!=null?Number(e.mvaPercent):null,base_reduzida_percent:e.baseReduzidaPercent!=null?Number(e.baseReduzidaPercent):null,ncm:e.ncm||null,descricao_ncm:e.ncmDescription||null,cest:e.cest||null,ativo:e.active!=null?!!e.active:!0,permite_venda:e.allowSale!=null?!!e.allowSale:!0,paga_comissao:e.payCommission!=null?!!e.payCommission:!1,preco_variavel:e.variablePrice!=null?!!e.variablePrice:!1,composicao:e.composition!=null?!!e.composition:!1,servico:e.service!=null?!!e.service:!1,grade:e.hasGrid!=null?!!e.hasGrid:!1,usar_tabela_preco:e.usePriceTable!=null?!!e.usePriceTable:!1,combustivel:e.fuel!=null?!!e.fuel:!1,usa_imei:e.useImei!=null?!!e.useImei:!1,controle_estoque_por_grade:e.stockByGrid!=null?!!e.stockByGrid:!1,mostrar_no_app:e.showInApp!=null?!!e.showInApp:!1,importado_via_xml:e.importedViaXML===!0,data_importacao:e.dataImportacao?e.dataImportacao instanceof Date?e.dataImportacao.toISOString():new Date(e.dataImportacao).toISOString():null,xml_chave:e.xmlChave||null,xml_numero:e.xmlNumero||null,xml_serie:e.xmlSerie||null,xml_emissao:e.xmlEmissao?new Date(e.xmlEmissao).toISOString():null}}async function bu(e={}){const{includeInactive:t=!1,search:r="",codigoEmpresa:n}=e;console.log("[products.api] ====== listProducts INICIO ======"),console.log("[products.api] Parametros:",{includeInactive:t,search:r,codigoEmpresa:n});const{data:s,error:o}=await Fo(c=>{let d=de.from("produtos").select("*").eq("codigo_empresa",n).order("nome",{ascending:!0}).abortSignal(c);if(t||(d=d.neq("status","inactive"),d=d.or("ativo.is.null,ativo.eq.true"),console.log("[products.api] Filtro aplicado: status != inactive AND (ativo IS NULL OR ativo = true)")),r&&r.trim().length>0){const u=r.trim();d=d.or(`nome.ilike.%${u}%,codigo_produto.ilike.%${u}%`)}return d},15e3,"Timeout listProducts (15s)");if(o)throw console.error("[products.api] listProducts:error",o),o;const i=(s||[]).map(vP);console.log("[products.api] listProducts RETORNOU:",i.length,"produtos"),console.log("[products.api] includeInactive:",t),console.log("[products.api] Produtos:",i.map(c=>({id:c.id,name:c.name,code:c.code})));const l=i.filter(c=>!c.code||c.code.trim()==="");return console.log("[products.api] Produtos SEM cdigo:",l.length),l.length>0&&l.forEach(c=>{console.log("  -",c.name,"| active:",c.active,"| status:",c.status,"| code:",c.code||"NULL")}),i}async function Wat(e={}){const{includeInactive:t=!1,search:r="",codigoEmpresa:n,page:s=1,pageSize:o=100}=e;if(!n)return{data:[],count:0};const i=s>0?s:1,l=o>0?o:100,c=(i-1)*l,d=c+l-1;console.log("[products.api] ====== listProductsPaged INICIO ======",{includeInactive:t,search:r,codigoEmpresa:n,page:i,pageSize:l});try{const{data:u,error:f,count:h}=await Fo(v=>{let g=de.from("produtos").select("*",{count:"exact"}).eq("codigo_empresa",n).order("nome",{ascending:!0}).range(c,d).abortSignal(v);if(t||(g=g.neq("status","inactive"),g=g.or("ativo.is.null,ativo.eq.true")),r&&r.trim().length>0){const y=r.trim();g=g.or(`nome.ilike.%${y}%,codigo_produto.ilike.%${y}%`)}return g},2e4,"Timeout listProductsPaged (20s)");if(f)throw console.error("[products.api] listProductsPaged:error",f),f;const m=(u||[]).map(vP);return console.log("[products.api] listProductsPaged RETORNOU:",m.length,"produtos de",h||0),{data:m,count:h||0}}catch(u){return console.error("[products.api] listProductsPaged:exception",u),{data:[],count:0}}}async function qS(e,t={}){const{codigoEmpresa:r}=t,n=$se(e);r&&(n.codigo_empresa=r),console.info("[products.api] createProduct: payload",n);const s=async()=>Fo(d=>de.from("produtos").insert(n).select("*").single().abortSignal(d),15e3,"Timeout createProduct (15s)"),o=d=>{if(!d)return!1;if(d.code&&String(d.code)==="23505")return!0;const u=[d.message,d.details,d.hint].filter(Boolean).join(" ").toLowerCase();return u.includes("duplicate key")||u.includes("unique constraint")||u.includes("ux_produtos_empresa_codigo_produto")||u.includes("codigo_produto")};let i,l;if({data:i,error:l}=await s(),l&&o(l)&&n.codigo_produto){console.warn("[products.api] createProduct: duplicate code, trying to free code from inactive product");const{data:d,error:u}=await Fo(h=>de.from("produtos").select("id,status").eq("codigo_produto",n.codigo_produto).eq("status","inactive").limit(1).abortSignal(h),15e3,"Timeout find duplicate product (15s)"),f=Array.isArray(d)&&d.length>0?d[0]:null;if(!u&&f&&f.status==="inactive"){const{error:h}=await Fo(m=>de.from("produtos").update({codigo_produto:null}).eq("id",f.id).abortSignal(m),15e3,"Timeout clear duplicate code (15s)");h||({data:i,error:l}=await s())}else{const h=n.codigo_produto;n.codigo_produto=null,console.warn("[products.api] createProduct: no inactive found for duplicate code, retrying with codigo_produto = null (original:",h,")"),{data:i,error:l}=await s()}}if(l)throw console.error("[products.api] createProduct:error",l),l;const c=vP(i);return console.info("[products.api] createProduct: ok",c),c}async function u1(e,t,r={}){const n=$se(t);n.data_importacao=null,console.info("[products.api] updateProduct: id",e,"payload",n);const{data:s,error:o}=await Fo(l=>de.from("produtos").update(n).eq("id",e).select("*").single().abortSignal(l),15e3,"Timeout updateProduct (15s)");if(o)throw console.error("[products.api] updateProduct:error",o),o;const i=vP(s);return console.info("[products.api] updateProduct: ok",i),i}async function Fo(e,t,r){const n=new AbortController,s=setTimeout(()=>n.abort(new Error(r)),t);try{return await e(n.signal)}catch(o){throw o?.name==="AbortError"?new Error(r):o}finally{clearTimeout(s)}}async function WR(e){console.info("[products.api] deleteProduct (soft): id",e);const{error:t}=await Fo(r=>de.from("produtos").update({status:"inactive",codigo_produto:null}).eq("id",e).abortSignal(r),15e3,"Timeout deleteProduct (15s)");if(t)throw console.error("[products.api] deleteProduct:error",t),t;return console.info("[products.api] deleteProduct: ok (inativado)"),!0}async function Hat({ids:e,status:t}){const r=Array.isArray(e)?e.filter(Boolean):[];if(!r.length)throw new Error("Nenhum produto selecionado para atualizao em massa");if(!["active","inactive","low_stock"].includes(t))throw new Error("Status invlido para atualizao em massa");const n=t!=="inactive";console.info("[products.api] bulkUpdateProductStatus:start",{count:r.length,status:t});const{error:s}=await Fo(o=>de.from("produtos").update({status:t,ativo:n}).in("id",r).abortSignal(o),2e4,"Timeout bulkUpdateProductStatus (20s)");if(s)throw console.error("[products.api] bulkUpdateProductStatus:error",s),s;return console.info("[products.api] bulkUpdateProductStatus:ok",{count:r.length,status:t}),!0}async function Gat({ids:e}){const t=Array.isArray(e)?e.filter(Boolean):[];if(!t.length)throw new Error("Nenhum produto selecionado para limpar flag de novo");console.info("[products.api] bulkClearNewFlag:start",{count:t.length});const{error:r}=await Fo(n=>de.from("produtos").update({data_importacao:null}).in("id",t).abortSignal(n),2e4,"Timeout bulkClearNewFlag (20s)");if(r)throw console.error("[products.api] bulkClearNewFlag:error",r),r;return console.info("[products.api] bulkClearNewFlag:ok",{count:t.length}),!0}async function VU(e={}){const{codigoEmpresa:t}=e;console.info("[products.api] listCategories: start");const{data:r,error:n}=await Fo(i=>{let l=de.from("produto_categorias").select("nome").eq("ativa",!0).order("nome",{ascending:!0}).abortSignal(i);return t&&(l=l.eq("codigo_empresa",t)),l},15e3,"Timeout listCategories (15s)");if(n)throw console.error("[products.api] listCategories:error",n),n;const s=[],o=new Set;for(const i of r||[]){const l=(i?.nome||"").trim();if(!l)continue;const c=l.toLowerCase();o.has(c)||(o.add(c),s.push(l))}return console.info("[products.api] listCategories: ok",{count:s.length}),s}async function Kat(e,t={}){const{codigoEmpresa:r}=t,n=String(e||"").trim();if(!n)throw new Error("Nome da categoria invlido");console.info("[products.api] createCategory:",n);const s={nome:n};r&&(s.codigo_empresa=r);const{data:o,error:i}=await Fo(l=>de.from("produto_categorias").insert(s).select("nome").single().abortSignal(l),15e3,"Timeout createCategory (15s)");if(i)throw console.error("[products.api] createCategory:error",i),i;return o?.nome||n}async function Xat(e,t={}){const{codigoEmpresa:r}=t,n=String(e||"").trim();if(!n)throw new Error("Nome da categoria invlido");console.info("[products.api] removeCategory:",n);const{count:s,error:o}=await Fo(d=>{let u=de.from("produtos").select("id",{count:"exact",head:!0}).eq("categoria",n).neq("status","inactive").abortSignal(d);return r&&(u=u.eq("codigo_empresa",r)),u},15e3,"Timeout removeCategory:count (15s)");if(o)throw console.error("[products.api] removeCategory:count:error",o),o;if((s??0)>0){const d=new Error("Categoria possui produtos ativos vinculados");throw console.warn("[products.api] removeCategory: blocked by active products",{nome:n,prodCount:s}),d}const{data:i,error:l}=await Fo(d=>{let u=de.from("produto_categorias").update({ativa:!1}).eq("nome",n).select("nome").abortSignal(d);return r&&(u=u.eq("codigo_empresa",r)),u},15e3,"Timeout removeCategory (15s)");if(l)throw console.error("[products.api] removeCategory:error",l),l;if((Array.isArray(i)?i.length:0)===0){const d=new Error("Categoria no encontrada para desativar");throw console.warn("[products.api] removeCategory: no rows affected",{nome:n}),d}return!0}function Yat({item:e,onApply:t,onClose:r,codigoEmpresa:n}){const{toast:s}=Qa(),[o,i]=p.useState(e?.desconto_tipo||"percentual"),[l,c]=p.useState(e?.desconto_valor||0),[d,u]=p.useState(e?.desconto_motivo||""),[f,h]=p.useState(!1);if(!e)return null;const m=Number(e.price||e.preco_unitario||0),v=Number(e.quantity||e.quantidade||1),g=m*v,y=o==="percentual"?g*(1-l/100):g-l,x=async()=>{try{if(h(!0),l<0){s({title:"Erro",description:"Desconto no pode ser negativo",variant:"destructive"});return}if(o==="percentual"&&l>100){s({title:"Erro",description:"Desconto percentual no pode ser maior que 100%",variant:"destructive"});return}console.log("Aplicando desconto:",{itemId:e.id,desconto_tipo:o,desconto_valor:Number(l),desconto_motivo:d||null,codigoEmpresa:n});const w=await eKe({itemId:e.id,desconto_tipo:o,desconto_valor:Number(l),desconto_motivo:d||null,codigoEmpresa:n});console.log("Resultado:",w),s({title:"Sucesso",description:"Desconto aplicado!",variant:"success"}),t(),r()}catch(w){console.error("Erro ao aplicar desconto:",w),s({title:"Erro",description:w.message||"Falha ao aplicar desconto",variant:"destructive"})}finally{h(!1)}},b=async()=>{try{h(!0),await rKe({itemId:e.id,codigoEmpresa:n}),s({title:"Sucesso",description:"Desconto removido!",variant:"success"}),t(),r()}catch(w){console.error("Erro ao remover desconto:",w),s({title:"Erro",description:w.message||"Falha ao remover desconto",variant:"destructive"})}finally{h(!1)}};return a.jsx(mn,{open:!0,onOpenChange:r,children:a.jsxs(un,{overlayClassName:"z-[90]",className:"sm:max-w-[420px] w-[92vw] max-h-[85vh] flex flex-col animate-none z-[91]",children:[a.jsx(on,{children:a.jsxs(an,{className:"text-lg font-bold",children:["Desconto - ",e.name]})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(qe,{className:"text-sm font-semibold mb-2 block",children:"Tipo de Desconto"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(fe,{variant:o==="percentual"?"default":"outline",onClick:()=>i("percentual"),disabled:f,className:"flex-1",children:"Percentual (%)"}),a.jsx(fe,{variant:o==="fixo"?"default":"outline",onClick:()=>i("fixo"),disabled:f,className:"flex-1",children:"Fixo (R$)"})]})]}),a.jsxs("div",{children:[a.jsxs(qe,{htmlFor:"desconto-valor",className:"text-sm font-semibold",children:["Valor ",o==="percentual"?"(%)":"(R$)"]}),a.jsxs("div",{className:"relative mt-1",children:[a.jsx(rt,{id:"desconto-valor",type:"text",value:o==="percentual"?l===0?"":l:l===0?"":`R$ ${l.toFixed(2)}`,onChange:w=>{let j=w.target.value.trim();if(j===""){c(0);return}o==="fixo"&&(j=j.replace(/[^\d.,]/g,"").replace(",","."));let _=Number(j);isNaN(_)&&(_=0),o==="percentual"&&_>100&&(_=100),_<0&&(_=0),c(_)},placeholder:o==="percentual"?"0":"0,00",disabled:f,className:"mt-1"}),o==="percentual"&&a.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-text-secondary font-semibold",children:"%"})]})]}),a.jsxs("div",{children:[a.jsx(qe,{htmlFor:"desconto-motivo",className:"text-sm font-semibold",children:"Motivo"}),a.jsxs("select",{id:"desconto-motivo",value:d,onChange:w=>u(w.target.value),className:"w-full border border-border rounded-md p-2 mt-1 text-sm bg-background",disabled:f,children:[a.jsx("option",{value:"",children:"Selecione um motivo..."}),a.jsx("option",{value:"Promoo",children:"Promoo"}),a.jsx("option",{value:"Meia entrada",children:"Meia entrada"}),a.jsx("option",{value:"Cortesia",children:"Cortesia"}),a.jsx("option",{value:"Ajuste",children:"Ajuste"}),a.jsx("option",{value:"Outro",children:"Outro"})]})]}),a.jsxs("div",{className:"bg-surface-2 p-4 rounded-lg space-y-2 border border-border",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-text-secondary",children:"Preo Original:"}),a.jsxs("span",{className:"font-semibold",children:["R$ ",g.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-sm text-destructive font-semibold",children:[a.jsx("span",{children:"Desconto:"}),a.jsxs("span",{children:["-R$ ",(g-y).toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-base font-bold border-t border-border pt-2",children:[a.jsx("span",{children:"Total do Item:"}),a.jsxs("span",{className:"text-brand",children:["R$ ",Math.max(0,y).toFixed(2)]})]})]}),d&&a.jsxs("div",{className:"text-xs text-text-secondary bg-surface p-2 rounded",children:[a.jsx("strong",{children:"Motivo:"})," ",d]})]}),a.jsxs(Qn,{className:"flex gap-2",children:[a.jsx(fe,{variant:"outline",onClick:r,disabled:f,children:"Cancelar"}),e.desconto_valor>0&&a.jsxs(fe,{variant:"destructive",onClick:b,disabled:f,size:"sm",className:"gap-2",children:[a.jsx(Ju,{className:"w-4 h-4"}),"Remover"]}),a.jsx(fe,{onClick:x,disabled:f,className:"gap-2",children:f?"Aplicando...":"Aplicar Desconto"})]})]})})}function Jat({comanda:e,subtotal:t,onApply:r,onClose:n,codigoEmpresa:s}){const{toast:o}=Qa(),[i,l]=p.useState(e?.desconto_tipo||"percentual"),[c,d]=p.useState(e?.desconto_valor||0),[u,f]=p.useState(e?.desconto_motivo||""),[h,m]=p.useState(!1);if(!e)return null;const v=i==="percentual"?t*c/100:c,g=Math.max(0,t-v),y=async()=>{try{if(m(!0),c<0){o({title:"Erro",description:"Desconto no pode ser negativo",variant:"destructive"});return}if(i==="percentual"&&c>100){o({title:"Erro",description:"Desconto percentual no pode ser maior que 100%",variant:"destructive"});return}if(v>t){o({title:"Erro",description:"Desconto no pode ser maior que o subtotal",variant:"destructive"});return}console.log("Aplicando desconto comanda:",{comandaId:e.id,desconto_tipo:i,desconto_valor:Number(c),desconto_motivo:u||null,codigoEmpresa:s});const b=await tKe({comandaId:e.id,desconto_tipo:i,desconto_valor:Number(c),desconto_motivo:u||null,codigoEmpresa:s});console.log("Resultado comanda:",b),o({title:"Sucesso",description:"Desconto aplicado na comanda!",variant:"success"}),r(),n()}catch(b){console.error("Erro ao aplicar desconto:",b),o({title:"Erro",description:b.message||"Falha ao aplicar desconto",variant:"destructive"})}finally{m(!1)}},x=async()=>{try{m(!0),await nKe({comandaId:e.id,codigoEmpresa:s}),o({title:"Sucesso",description:"Desconto removido!",variant:"success"}),r(),n()}catch(b){console.error("Erro ao remover desconto:",b),o({title:"Erro",description:b.message||"Falha ao remover desconto",variant:"destructive"})}finally{m(!1)}};return a.jsx(mn,{open:!0,onOpenChange:n,children:a.jsxs(un,{className:"sm:max-w-[420px]",children:[a.jsx(on,{children:a.jsx(an,{className:"text-lg font-bold",children:"Desconto da Comanda"})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(qe,{className:"text-sm font-semibold mb-2 block",children:"Tipo de Desconto"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(fe,{variant:i==="percentual"?"default":"outline",onClick:()=>l("percentual"),disabled:h,className:"flex-1",children:"Percentual (%)"}),a.jsx(fe,{variant:i==="fixo"?"default":"outline",onClick:()=>l("fixo"),disabled:h,className:"flex-1",children:"Fixo (R$)"})]})]}),a.jsxs("div",{children:[a.jsxs(qe,{htmlFor:"desconto-valor",className:"text-sm font-semibold",children:["Valor ",i==="percentual"?"(%)":"(R$)"]}),a.jsxs("div",{className:"relative mt-1",children:[a.jsx(rt,{id:"desconto-valor",type:"text",name:"desconto-valor",autoComplete:"off",autoCorrect:"off",spellCheck:!1,value:i==="percentual"?c===0?"":c:c===0?"":`R$ ${c.toFixed(2)}`,onChange:b=>{let w=b.target.value.trim();if(w===""){d(0);return}i==="fixo"&&(w=w.replace(/[^\d.,]/g,"").replace(",","."));let j=Number(w);isNaN(j)&&(j=0),i==="percentual"&&j>100&&(j=100),j<0&&(j=0),d(j)},placeholder:i==="percentual"?"0":"0,00",disabled:h,className:"mt-1"}),i==="percentual"&&a.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-text-secondary font-semibold",children:"%"})]})]}),a.jsxs("div",{children:[a.jsx(qe,{htmlFor:"desconto-motivo",className:"text-sm font-semibold",children:"Motivo"}),a.jsxs("select",{id:"desconto-motivo",value:u,onChange:b=>f(b.target.value),className:"w-full border border-border rounded-md p-2 mt-1 text-sm bg-background",disabled:h,children:[a.jsx("option",{value:"",children:"Selecione um motivo..."}),a.jsx("option",{value:"Promoo",children:"Promoo"}),a.jsx("option",{value:"Cortesia",children:"Cortesia"}),a.jsx("option",{value:"Ajuste",children:"Ajuste"}),a.jsx("option",{value:"Outro",children:"Outro"})]})]}),a.jsxs("div",{className:"bg-surface-2 p-4 rounded-lg space-y-2 border border-border",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-text-secondary",children:"Subtotal:"}),a.jsxs("span",{className:"font-semibold",children:["R$ ",t.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-sm text-destructive font-semibold",children:[a.jsx("span",{children:"Desconto:"}),a.jsxs("span",{children:["-R$ ",v.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between text-base font-bold border-t border-border pt-2",children:[a.jsx("span",{children:"Total da Comanda:"}),a.jsxs("span",{className:"text-brand",children:["R$ ",g.toFixed(2)]})]})]}),u&&a.jsxs("div",{className:"text-xs text-text-secondary bg-surface p-2 rounded",children:[a.jsx("strong",{children:"Motivo:"})," ",u]})]}),a.jsxs(Qn,{className:"flex gap-2",children:[a.jsx(fe,{variant:"outline",onClick:n,disabled:h,children:"Cancelar"}),e.desconto_valor>0&&a.jsxs(fe,{variant:"destructive",onClick:x,disabled:h,size:"sm",className:"gap-2",children:[a.jsx(Ju,{className:"w-4 h-4"}),"Remover"]}),a.jsx(fe,{onClick:y,disabled:h,className:"gap-2",children:h?"Aplicando...":"Aplicar Desconto"})]})]})})}const Qat={available:{label:"Livre",color:"border-success/50 bg-success/10 text-success",icon:Ro},"in-use":{label:"Em Uso",color:"border-warning/50 bg-warning/10 text-warning",icon:Pd},"awaiting-payment":{label:"Pagamento",color:"border-info/50 bg-info/10 text-info",icon:Zo}};function Zat(){const{toast:e}=Qa(),{userProfile:t,authReady:r}=ms(),n=zi(),[s,o]=p.useState([]),[i,l]=p.useState(null),[c,d]=p.useState(!1),[u,f]=p.useState(0);p.useRef(!1);const[h,m]=p.useState(!1);p.useState([]);const[v,g]=p.useState(!1),[y,x]=p.useState(new Map),[b,w]=p.useState(!1);p.useRef(null),p.useRef(null);const j=p.useRef([]),_=p.useRef(null),[S,C]=p.useState(0),[P,A]=p.useState("tables");p.useRef(null);const[R,O]=p.useState("order");p.useRef(null),p.useRef(null),p.useState(!1);const[I,M]=p.useState(null),[D,U]=p.useState(null),[z,W]=p.useState(!1),[$,X]=p.useState(!1),[ye,Se]=p.useState(!1),[V,B]=p.useState(null),[Q,pe]=p.useState(!1),[te,Y]=p.useState([]),[ce,me]=p.useState(!1),[ae,le]=p.useState(!1),[ue,Re]=p.useState(!1),[ne,ie]=p.useState(!1),[gt,bt]=p.useState(!1),[at,xt]=p.useState(!1),[Ze,ht]=p.useState(!1),[Wt,be]=p.useState(null),[Ct,wt]=p.useState(""),[Ge,Je]=p.useState(!1),[_e,je]=p.useState(!1),[Ue,ze]=p.useState([]),[or,tr]=p.useState(null),[Nt,yr]=p.useState(null),[Me,dt]=p.useState(!1),ut=p.useRef(""),[rr,hr]=p.useState(!1),[It,dr]=p.useState(!1),[ur,er]=p.useState("order"),[ln,Mr]=p.useState(!1),[Ye,$e]=p.useState(""),[Be,et]=p.useState(()=>{try{return typeof window<"u"&&window.innerWidth<=640}catch{return!1}}),[jt,yt]=p.useState(null),[qt,pt]=p.useState(null),[Dt,he]=p.useState(!1);p.useEffect(()=>{const J=t?.codigo_empresa;J&&(async()=>{try{if(Array.isArray(Ue)&&Ue.length>0)return;const ve=await th({somenteAtivas:!0,codigoEmpresa:J});ze(Array.isArray(ve)?ve:[])}catch{}})()},[t?.codigo_empresa]);const Qe=p.useMemo(()=>{const J=new Map,ve=i?.order||[];for(const G of ve){const re=String(G.productId);J.set(re,(J.get(re)||0)+Number(G.quantity||0))}return J},[i?.order]),zt=async J=>{try{const ve=i?.order||[],G=ve.find(vt=>String(vt.productId)===String(J.id));if(!G)return;const re=Number(G.quantity||0)-1;if(String(G.id||"").startsWith("tmp-")){const vt=re>0?ve.map(Gt=>Gt.id===G.id?{...Gt,quantity:re}:Gt):ve.filter(Gt=>Gt.id!==G.id),Rt=vt.reduce((Gt,Bt)=>Gt+Number(Bt.price||0)*Number(Bt.quantity||0),0),At={...i,order:vt,totalHint:Rt};l(At),o(Gt=>Gt.map(Bt=>Bt.id===At.id?{...Bt,totalHint:Rt}:Bt)),setTimeout(async()=>{try{const Bt=(await io({comandaId:i.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(vr=>({id:vr.id,productId:vr.produto_id,name:vr.descricao||"Item",price:Number(vr.preco_unitario||0),quantity:Number(vr.quantidade||1)})),Ht=(Bt||[]).reduce((vr,xn)=>vr+Number(xn.price||0)*Number(xn.quantity||0),0),jr={...i,order:Bt,totalHint:Ht};l(jr),o(vr=>vr.map(xn=>xn.id===jr.id?{...xn,totalHint:Ht}:xn))}catch{}},300);return}const Ce=i,ke=s,Oe=re>0?ve.map(vt=>vt.id===G.id?{...vt,quantity:re}:vt):ve.filter(vt=>vt.id!==G.id),oe=Oe.reduce((vt,Rt)=>vt+Number(Rt.price||0)*Number(Rt.quantity||0),0),Ee={...i,order:Oe,totalHint:oe};l(Ee),o(vt=>vt.map(Rt=>Rt.id===Ee.id?{...Rt,totalHint:oe}:Rt));try{re>0?await dd({itemId:G.id,quantidade:re,codigoEmpresa:t?.codigo_empresa}):await tx({itemId:G.id,codigoEmpresa:t?.codigo_empresa})}catch(vt){throw l(Ce),o(ke),vt}const Ie=Math.max(re,0);let tt=!1;for(let vt=0;vt<3&&!tt;vt++){const At=(await io({comandaId:i.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(Bt=>({id:Bt.id,productId:Bt.produto_id,name:Bt.descricao||"Item",price:Number(Bt.preco_unitario||0),quantity:Number(Bt.quantidade||1)}));if((At.find(Bt=>String(Bt.productId)===String(J.id))?.quantity||0)===Ie){const Bt=At.reduce((jr,vr)=>jr+Number(vr.price||0)*Number(vr.quantity||0),0),Ht={...i,order:At,totalHint:Bt};l(Ht),o(jr=>jr.map(vr=>vr.id===Ht.id?Ht:vr)),tt=!0;break}await new Promise(Bt=>setTimeout(Bt,180*(vt+1)))}try{const vt=await Hm({codigoEmpresa:t?.codigo_empresa}),Rt=new Map;for(const At of vt||[]){const Gt=String(At.produto_id),Bt=Number(At.quantidade||0);Rt.set(Gt,(Rt.get(Gt)||0)+Bt)}x(Rt)}catch(vt){console.error("[decProduct] Erro ao atualizar estoque reservado:",vt)}}catch(ve){console.error("[decProduct] Erro:",ve),e({title:"Falha ao alterar quantidade",description:ve?.message||"Tente novamente",variant:"destructive"})}},Mt=p.useRef(null),ir=p.useCallback(()=>{try{const J=Mt.current;if(!J)return 1;const G=window.getComputedStyle(J).gridTemplateColumns||"";if(G){const we=G.split(" ").filter(Boolean).length;if(we>0)return we}const re=J.querySelector("[data-table-id]");if(re){const we=re.getBoundingClientRect().width,Ce=J.getBoundingClientRect().width;if(we>0)return Math.max(1,Math.floor(Ce/we))}return 1}catch{return 1}},[]),[nr,kr]=p.useState(!1),Ft=p.useRef(!1);p.useEffect(()=>{Ft.current=Ge},[Ge]);const Dr=p.useRef(0),Fr=p.useRef(null),Tn=p.useRef(null),nt=p.useRef(null),$t=p.useRef(null),Kt=p.useRef([]);p.useRef(null);const sr=p.useRef(!1),St=p.useRef(null),Jr=p.useRef(null);$o();const Pt=p.useMemo(()=>(s||[]).find(J=>J.status==="available")?.id||null,[s]),lr=ae||ne||$||v||Ge||Me||h||z||It||ye||b||!1,st=async J=>{try{if(!J)return;if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de gerenciar as mesas.",variant:"warning"});return}if(_e)return;if(je(!0),l(ve=>!ve||ve.id!==J.id?J:ve),J.status==="available"||!J.comandaId){be(J),ie(!0);return}try{await ot(J)}catch{try{const re=(await io({comandaId:J.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(ke=>({id:ke.id,productId:ke.produto_id,name:ke.descricao||"Item",price:Number(ke.preco_unitario||0),quantity:Number(ke.quantidade||1)}));let we=null;try{const Oe=(await ui({comandaId:J.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(oe=>oe?.nome).filter(Boolean);we=Oe.length?Oe.join(", "):null}catch{}const Ce={...J,order:re,customer:we};l(Ce),o(ke=>ke.map(Oe=>Oe.id===Ce.id?Ce:Oe))}catch{}}}finally{je(!1)}};p.useEffect(()=>{const J=()=>{try{et(typeof window<"u"&&window.innerWidth<=640)}catch{et(!1)}};return J(),window.addEventListener("resize",J),()=>window.removeEventListener("resize",J)},[]),p.useEffect(()=>{const J=async ve=>{try{if(b)return;const G=String(ve.target?.tagName||"").toLowerCase();if(["input","textarea","select"].includes(G)||ve.target?.isContentEditable||lr)return;if(ve.key==="F1"){ve.preventDefault();try{const we=(s||[]).filter(Ce=>Ce.status==="available");we.length>0?(l(we[0]),be?.(we[0])):!i&&Array.isArray(s)&&s.length>0&&(l(s[0]),be?.(s[0]))}catch{}ie(!0);return}if(ve.key==="F2"){ve.preventDefault(),i?.comandaId?await nn():e({title:"Nenhuma comanda selecionada",description:"Selecione uma mesa com comanda aberta antes de fechar.",variant:"warning"});return}if(ve.key==="F10"){ve.preventDefault(),c?e({title:"Caixa j est aberto",description:"Use F11 para ver detalhes do caixa.",variant:"info"}):dt(!0);return}if(ve.key==="F11"){ve.preventDefault(),g(!0);return}if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(ve.key)){if(P!=="tables"||!i||!Array.isArray(s)||s.length===0)return;ve.preventDefault(),ve.stopPropagation();let we=Math.max(0,s.findIndex(Ee=>Ee.id===i?.id));we<0&&(we=0);let Ce=ir(),ke=we;ve.key==="ArrowRight"&&(ke=we+1),ve.key==="ArrowLeft"&&(ke=we-1),ve.key==="ArrowDown"&&(ke=we+Ce),ve.key==="ArrowUp"&&(ke=we-Ce);const Oe=s.length;ke=(ke%Oe+Oe)%Oe;const oe=s[ke];oe&&oe.id!==i?.id&&(l(oe),setTimeout(()=>{try{document.querySelector(`[data-table-id="${oe.id}"]`)?.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"})}catch{}},0));return}if(ve.key==="Enter"){if(P!=="tables")return;ve.preventDefault(),ve.stopPropagation(),i&&!_e&&await st(i);return}if(ve.key==="Escape"){if(ve.preventDefault(),i&&(R==="products"||ur==="products")){O("order"),er("order");return}if(i){l(null);return}return}if(ve.key==="p"||ve.key==="P"){if(ve.preventDefault(),h){setTimeout(()=>{try{_.current?.focus()}catch{}},0);return}if(i){w(!0);try{dr(!1)}catch{}return}m(!0),setTimeout(()=>{try{_.current?.focus()}catch{}},50);return}}catch{}};return window.addEventListener("keydown",J),()=>window.removeEventListener("keydown",J)},[lr,i?.id,s,ir,b]),p.useEffect(()=>{try{i?.id&&t?.codigo_empresa&&localStorage.setItem(`vendas:selected:${t.codigo_empresa}`,String(i.id))}catch{}},[i?.id,t?.codigo_empresa]),p.useEffect(()=>{(async()=>{try{if(!i&&t?.codigo_empresa&&Array.isArray(s)&&s.length>0){const ve=localStorage.getItem(`vendas:selected:${t.codigo_empresa}`);if(ve){const G=s.find(re=>String(re.id)===String(ve));if(G)if(A("tables"),G.comandaId)try{await ot(G),A("tables")}catch(re){console.error("[Restore Selection] Erro ao carregar detalhes:",re),localStorage.removeItem(`vendas:selected:${t.codigo_empresa}`)}else localStorage.removeItem(`vendas:selected:${t.codigo_empresa}`)}}}catch(ve){console.error("[Restore Selection] Erro:",ve)}})()},[s,i,t?.codigo_empresa]);const Et=p.useCallback(async()=>{try{const J=await nh({codigoEmpresa:t?.codigo_empresa});d(!!(J&&(J.id||J?.length)))}catch{d(!1)}},[t?.codigo_empresa]),ar=async()=>{const J=t?.codigo_empresa||null;try{if(!J)return;const[ve,G]=await Promise.all([Yw({codigoEmpresa:J}).catch(()=>null),nh({codigoEmpresa:J}).catch(()=>null)]);if(!G?.id){M(null);return}let re=0,we=[];try{we=await ng({caixaSessaoId:G.id,codigoEmpresa:J}),re=(we||[]).filter(ke=>(ke?.tipo||"")==="sangria").reduce((ke,Oe)=>ke+Number(Oe?.valor||0),0)}catch{}const Ce={saldo_inicial:G.saldo_inicial||0,totalPorFinalizadora:ve?.totalPorFinalizadora||ve?.porFinalizadora||{},totalEntradas:ve?.totalEntradas||ve?.entradas||0,totalSangria:re,totalSaidas:re,sessaoId:G.id,movimentacoes:we};Pe.startTransition(()=>{M(Ce)})}catch{Pe.startTransition(()=>{M(null)})}finally{}},Tr=p.useRef(!1);p.useEffect(()=>{v&&!Tr.current?(Tr.current=!0,ar().catch(()=>{})):v||(Tr.current=!1)},[v]);const Qr=p.useRef(!0);p.useEffect(()=>(Qr.current=!0,()=>{Qr.current=!1}),[]);const tn=p.useRef(0),Qt=p.useRef(0),fn=p.useRef(0);p.useEffect(()=>{const J=t?.codigo_empresa||null,ve=J?`vendas:tables:${J}`:null,G=()=>{try{if(!ve)return;const we=JSON.parse(localStorage.getItem(ve)||"[]");Array.isArray(we)&&we.length>0&&o(we)}catch{}};J&&G();const re=async()=>{try{if(!r||!J)return;const we=++fn.current,Ce=setTimeout(()=>{Qr.current&&G()},2e3),ke=setTimeout(()=>{Qr.current&&fn.current===we&&G()},1e4),[Oe,oe]=await Promise.all([rh(J),Hm({codigoEmpresa:J}).catch(()=>[])]);if(Qr.current&&fn.current===we){const Ht=new Map;for(const jr of oe||[]){const vr=String(jr.produto_id),xn=Number(jr.quantidade||0);Ht.set(vr,(Ht.get(vr)||0)+xn)}x(Ht)}let Ee=[];try{Ee=await kc({codigoEmpresa:J})}catch(Ht){console.error("[VendasPage:load] Erro ao carregar comandas abertas:",Ht)}const Ie=await(async()=>{try{return await NS((Ee||[]).map(Ht=>Ht.id),J)}catch{return{}}})(),tt=await(async()=>{try{const Ht=await Promise.all((Ee||[]).map(async jr=>{try{const xn=(await ui({comandaId:jr.id,codigoEmpresa:J})||[]).map(Kn=>Kn?.nome).filter(Boolean);return[jr.id,xn.length?xn.join(", "):null]}catch{return[jr.id,null]}}));return Object.fromEntries(Ht)}catch{return{}}})(),vt=new Map;(Ee||[]).forEach(Ht=>vt.set(Ht.mesa_id,Ht));const At=(Oe||[]).map(Ht=>{const jr=vt.get(Ht.id);let vr,xn=null,Kn=null,Un=0,Ir=null;return jr?(vr=jr.status==="awaiting-payment"||jr.status==="awaiting_payment"?"awaiting-payment":"in-use",xn=jr.id,Kn=tt[jr.id]||null,Un=Ie[jr.id]||0,Ir=jr.aberto_em||null):vr="available",{id:Ht.id,number:Ht.numero,name:Ht.nome||null,status:vr,order:[],customer:Kn,comandaId:xn,totalHint:Un,aberto_em:Ir}}).map(Ht=>i&&Ht.id===i.id?{...Ht,order:i.order||[],customer:i.customer||Ht.customer}:Ht);if(!Qr.current||fn.current!==we){clearTimeout(Ce),clearTimeout(ke);return}if(o(At),(At||[]).length===0)try{ve&&localStorage.removeItem(ve)}catch{}else try{ve&&localStorage.setItem(ve,JSON.stringify(At))}catch{}const Gt=J?`vendas:selected:${J}`:null;if(Gt)try{const Ht=localStorage.getItem(Gt);if(Ht){const jr=At.find(vr=>String(vr.id)===String(Ht));jr&&!jr.comandaId&&localStorage.removeItem(Gt)}}catch{}Qt.current=Array.isArray(At)?At.length:0,tn.current=Date.now();let Bt=null;try{const Ht=J?`vendas:selected:${J}`:null,jr=Ht?localStorage.getItem(Ht):null;if(jr){const vr=At.find(xn=>String(xn.id)===String(jr));vr&&(Bt=vr)}}catch{}Bt?Ge||l(Ht=>!Ht||Ht.id!==Bt.id?Bt:{...Bt,order:Ht.order||Bt.order||[],customer:Ht.customer||Bt.customer||null,observacoes:Ht.observacoes??Bt.observacoes??null,desconto_tipo:Ht.desconto_tipo??Bt.desconto_tipo??null,desconto_valor:Ht.desconto_valor??Bt.desconto_valor??0,desconto_motivo:Ht.desconto_motivo??Bt.desconto_motivo??null}):Ge||l(Ht=>{const jr=Ht?At.find(xn=>xn.id===Ht.id):null;return jr?{...jr,order:Ht.order||jr.order||[],customer:Ht.customer||jr.customer||null,observacoes:Ht.observacoes??jr.observacoes??null,desconto_tipo:Ht.desconto_tipo??jr.desconto_tipo??null,desconto_valor:Ht.desconto_valor??jr.desconto_valor??0,desconto_motivo:Ht.desconto_motivo??jr.desconto_motivo??null}:At[0]||null});try{const Ht=await bu({includeInactive:!1,codigoEmpresa:J});Y(Ht||[])}catch(Ht){console.warn("Falha ao carregar produtos:",Ht?.message||Ht)}clearTimeout(Ce),clearTimeout(ke)}catch(we){console.error("Erro ao carregar mesas:",we)}};return G(),r&&J&&re(),()=>{}},[r,t?.codigo_empresa,lr]),p.useEffect(()=>{!r||!t?.codigo_empresa||Et()},[r,t?.codigo_empresa,Et]),p.useEffect(()=>{let J=!0;return(async()=>{try{if(!t?.codigo_empresa){J&&f(0);return}const ve=await kc({codigoEmpresa:t?.codigo_empresa});if(!J)return;f(Array.isArray(ve)?ve.length:0)}catch{J&&f(0)}})(),()=>{J=!1}},[t?.codigo_empresa,s.length]),p.useEffect(()=>{const J=t?.codigo_empresa||null,ve=J?`vendas:selected:${J}`:null;try{ve&&i?.id&&localStorage.setItem(ve,String(i.id))}catch{}i?.comandaId&&(!i.order||i.order.length===0)&&ot(i)},[i?.id,i?.comandaId]),p.useEffect(()=>()=>{},[i?.comandaId,lr,ye]);const nn=async()=>{try{if(!i?.comandaId){e({title:"Selecione uma mesa com comanda aberta",variant:"warning"});return}await Of({codigoEmpresa:t?.codigo_empresa});try{const re=(await io({comandaId:i.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(Ce=>({id:Ce.id,productId:Ce.produto_id,name:Ce.descricao||"Item",price:Number(Ce.preco_unitario||0),quantity:Number(Ce.quantidade||1),desconto_tipo:Ce.desconto_tipo||null,desconto_valor:Number(Ce.desconto_valor||0),desconto_motivo:Ce.desconto_motivo||null})),we={...i,order:re};l(we),o(Ce=>Ce.map(ke=>ke.id===we.id?we:ke))}catch{}const J=await th({somenteAtivas:!0,codigoEmpresa:t?.codigo_empresa});ze(J||[]);const ve=J&&J[0]&&J[0].id?J[0].id:null;tr(ve),yr(ve),Je(!0)}catch(J){e({title:"Falha ao carregar finalizadoras",description:J?.message||"Tente novamente",variant:"destructive"})}},In=J=>{if(!J.destination)return;const ve=Array.from(s),[G]=ve.splice(J.source.index,1);ve.splice(J.destination.index,0,G),o(ve),e({title:"Layout das mesas atualizado!",description:"As posies foram salvas temporariamente.",variant:"success"})},Dn=(J,ve)=>{let G=0;for(const we of J||[]){let Ce=(we.price||0)*(we.quantity||1);we.desconto_tipo==="percentual"&&we.desconto_valor>0?Ce*=1-we.desconto_valor/100:we.desconto_tipo==="fixo"&&we.desconto_valor>0&&(Ce-=we.desconto_valor),G+=Math.max(0,Ce)}let re=G;return ve?.desconto_tipo==="percentual"&&ve?.desconto_valor>0?re*=1-ve.desconto_valor/100:ve?.desconto_tipo==="fixo"&&ve?.desconto_valor>0&&(re-=ve.desconto_valor),Math.max(0,re)},se=J=>{if(!J)return"";const ve=J.trim().split(/\s+/);return ve.length<=2?J:ve.slice(0,2).join(" ")},He=J=>{if(!J)return"";const ve=re=>String(re).replace(/^\s*[\[]+\s*/g,"").replace(/\s*[\]]+\s*$/g,"").trim(),G=J.split(",").map(re=>ve(re)).filter(Boolean);return G.length===0?"":G.length===1?se(G[0]):`${se(G[0])} +${G.length-1}`},ot=async J=>{try{if(!J?.comandaId)return;const G=(await io({comandaId:J.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(ke=>({id:ke.id,productId:ke.produto_id,name:ke.descricao||"Item",price:Number(ke.preco_unitario||0),quantity:Number(ke.quantidade||1),desconto_tipo:ke.desconto_tipo||null,desconto_valor:Number(ke.desconto_valor||0),desconto_motivo:ke.desconto_motivo||null}));let re=J.customer||null;try{const Oe=(await ui({comandaId:J.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(oe=>oe?.nome).filter(Boolean);re=Oe.length?Oe.join(", "):null}catch{}let we=J;try{const Oe=(await kc({codigoEmpresa:t?.codigo_empresa}))?.find(oe=>oe.id===J.comandaId);Oe&&(we={...J,desconto_tipo:Oe.desconto_tipo||null,desconto_valor:Number(Oe.desconto_valor||0),desconto_motivo:Oe.desconto_motivo||null,observacoes:Oe.observacoes||null})}catch{}const Ce={...we,status:J.status==="awaiting-payment"?"awaiting-payment":"in-use",order:G,customer:re};l(Ce),o(ke=>ke.map(Oe=>Oe.id===Ce.id?Ce:Oe))}catch(ve){console.warn("[VendasPage] Falha ao recarregar detalhes da mesa selecionada:",ve)}},ee=async({showToast:J=!1}={})=>{try{const ve=t?.codigo_empresa;if(!ve)return;const G=await rh(ve);let re=[];try{re=await kc({codigoEmpresa:ve})}catch(Ee){console.error("[refreshTablesLight] Erro ao carregar comandas:",Ee)}const we=new Map((re||[]).map(Ee=>[Ee.mesa_id,Ee])),Ce={},ke={};try{const Ee=(re||[]).map(vt=>vt.id);(await Promise.all(Ee.map(async vt=>{try{return{id:vt,vinculos:await ui({comandaId:vt,codigoEmpresa:ve})}}catch{return{id:vt,vinculos:[]}}}))).forEach(({id:vt,vinculos:Rt})=>{const At=(Rt||[]).map(Gt=>Gt?.nome).filter(Boolean);Ce[vt]=At.length?At.join(", "):null}),(await Promise.all(Ee.map(async vt=>{try{const At=(await io({comandaId:vt,codigoEmpresa:ve})||[]).reduce((Gt,Bt)=>{const Ht=(Bt.quantidade||0)*(Bt.preco_unitario||0)-(Bt.desconto||0);return Gt+Ht},0);return{comandaId:vt,total:At}}catch(Rt){return console.error(`[refreshTablesLight] Erro ao buscar itens da comanda ${vt}:`,Rt),{comandaId:vt,total:0}}}))).forEach(({comandaId:vt,total:Rt})=>{ke[vt]=Rt})}catch(Ee){console.error("[refreshTablesLight] Erro ao carregar clientes/totais:",Ee)}const oe=(G||[]).map(Ee=>{const Ie=we.get(Ee.id);let tt,vt=null,Rt=null,At=0;return Ie?(tt=Ie.status==="awaiting-payment"||Ie.status==="awaiting_payment"?"awaiting-payment":"in-use",vt=Ie.id,Rt=Ce[Ie.id]||null,At=ke[Ie.id]||0):tt="available",{id:Ee.id,number:Ee.numero,name:Ee.nome||null,status:tt,order:[],customer:Rt,comandaId:vt,totalHint:At}}).map(Ee=>{if(i&&Ee.id===i.id)return i.status==="available"?{...Ee,status:"available",comandaId:null,order:[],customer:null,totalHint:0}:Ee.comandaId?{...Ee,order:i.order||[],customer:i.customer||Ee.customer}:{...Ee,order:[],customer:null};try{const Ie=F.current.get(Ee.id);if(Ie&&Date.now()-Ie<3e4)return{...Ee,status:"available",comandaId:null,order:[],customer:null,totalHint:0}}catch{}return Ee});if(o(oe),i){const Ee=oe.find(Ie=>Ie.id===i.id);Ee&&!Ee.comandaId&&l({...Ee,order:[],customer:null})}}catch(ve){console.error("[refreshTablesLight] Erro fatal:",ve),J&&e({title:"Erro ao atualizar mesas",description:"Recarregue a pgina se o problema persistir",variant:"destructive"})}},k=p.useRef(null);p.useEffect(()=>{k.current=i},[i]);const T=p.useRef(null),K=p.useRef(null),H=p.useRef(null),F=p.useRef(new Map);p.useEffect(()=>{const J=t?.codigo_empresa;if(!J)return;try{const re=typeof window<"u"?window.localStorage.getItem("custom-auth-token"):null;if(re&&re.trim())de.realtime.setAuth(re.trim());else{let we="";try{we=(new URL(de.supabaseUrl||"").host||"").split(".")[0]||""}catch{}const Ce=we?`sb-${we}-auth-token`:"sb-auth-token",ke=typeof window<"u"?window.localStorage.getItem(Ce):null;if(ke)try{const Oe=JSON.parse(ke),oe=Oe?.access_token||Oe?.currentSession?.access_token;oe&&de.realtime.setAuth(oe)}catch{}}}catch{}const ve=de.channel(`loja:${J}`),G=re=>{const we=re?.table||re?.table_name||"",Ce=re?.new||re?.old||{},ke=re?.eventType||re?.type||re?.event||"";let Oe=!0;if(we!=="comanda_itens"&&we!=="comanda_clientes"){const oe=Ce?.codigo_empresa;oe!=null&&oe!==""&&(Oe=String(oe)===String(J||""))}if(!Oe){try{console.log("[Realtime][Vendas] IGNORADO por empresa",{t:we,evt:ke,rowEmpresa:Ce?.codigo_empresa,codigoEmpresa:J})}catch{}return}try{console.log("[Realtime][Vendas] payload recebido",{t:we,evt:ke,row:Ce,codigoEmpresa:J})}catch{}(async()=>{try{await ee({showToast:!1})}catch{}})()};if(ve.on("postgres_changes",{event:"*",schema:"public",table:"comandas"},G).on("postgres_changes",{event:"*",schema:"public",table:"comanda_itens"},G).on("postgres_changes",{event:"*",schema:"public",table:"comanda_clientes"},G).on("postgres_changes",{event:"*",schema:"public",table:"pagamentos",filter:`codigo_empresa=eq.${J}`},G).on("postgres_changes",{event:"*",schema:"public",table:"mesas"},G).subscribe(),T.current=ve,H.current)try{clearInterval(H.current)}catch{}return H.current=setInterval(async()=>{if(!Ft.current)try{await ee({showToast:!1})}catch{}},6e4),()=>{if(T.current){try{de.removeChannel(T.current)}catch{}T.current=null}if(K.current){try{clearTimeout(K.current)}catch{}K.current=null}if(H.current){try{clearInterval(H.current)}catch{}H.current=null}}},[t?.codigo_empresa]);const Le=({table:J,provided:ve,isDragging:G})=>{const re=Qat[J.status],we=re.icon,Ce=Array.isArray(J.order)?J.order:[],ke=Ce.filter(vt=>String(vt.id||"").startsWith("tmp-")).reduce((vt,Rt)=>vt+Number(Rt.quantity||0)*Number(Rt.price||0),0),Oe=Ce.filter(vt=>!String(vt.id||"").startsWith("tmp-")).reduce((vt,Rt)=>vt+Number(Rt.quantity||0)*Number(Rt.price||0),0),oe=Number(J.totalHint||0);He(J.customer);const Ee=J.status==="available"&&J.id===Pt,Ie=J.status==="in-use"||J.status==="awaiting-payment"?(oe>0?oe:Oe)+ke:0,tt=J.status==="available"?"text-success bg-success/10 border-success/30":J.status==="in-use"?"text-warning bg-warning/10 border-warning/30":"text-info bg-info/10 border-info/30";return a.jsxs("div",{ref:ve?.innerRef,"data-table-id":J.id,...ve?.draggableProps||{},className:pr("p-4 rounded-lg border bg-surface flex flex-col relative h-44 shadow-sm min-w-[240px]",G&&"shadow-lg",P==="tables"&&i?.id===J.id&&"ring-2 ring-brand/60 bg-surface-2",c?"cursor-pointer":"cursor-not-allowed opacity-60"),onClick:()=>{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de gerenciar as mesas.",variant:"warning"});return}st(J)},children:[a.jsx("div",{...ve?.dragHandleProps||{},className:"absolute top-2 right-2 text-text-muted opacity-60 hover:opacity-100",children:a.jsx(Pue,{size:14})}),a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(we,{className:"w-5 h-5 text-text-secondary"}),a.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[a.jsx("span",{className:"text-lg font-semibold text-text-primary truncate",children:J.name?J.name:`Mesa ${J.number}`}),Ee&&a.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"F1"})]}),a.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[(J.status==="in-use"||J.status==="awaiting-payment")&&J.aberto_em&&a.jsxs("div",{className:"flex items-center gap-0.5 text-xs text-text-secondary",children:[a.jsx(Pd,{className:"w-3.5 h-3.5 text-text-muted"}),a.jsx("span",{className:"font-medium",children:(()=>{try{const vt=new Date(J.aberto_em),At=new Date-vt,Gt=Math.floor(At/6e4),Bt=Math.floor(Gt/60),Ht=Gt%60;return Gt<1?"agora":Bt===0?`${Ht}m`:Bt>0&&Ht===0?`${Bt}h`:`${Bt}h${Ht}m`}catch{return""}})()})]}),a.jsx("span",{className:pr("text-[11px] font-medium px-2 py-0.5 rounded-full border flex-shrink-0",tt),children:re.label})]})]}),a.jsx("div",{className:pr("flex-1 flex items-center justify-center"),children:J.status==="available"?a.jsx("img",{src:"/mesalivre.png",alt:"Mesa livre",className:pr("w-16 h-16 object-contain opacity-80",i?.id===J.id&&"opacity-100")}):J.status==="in-use"?a.jsx("img",{src:"/mesaocupada.png",alt:"Mesa ocupada",className:pr("w-16 h-16 object-contain opacity-80",i?.id===J.id&&"opacity-100")}):a.jsx("div",{className:pr("w-16 h-16 rounded-lg bg-info/20 border-2 border-info/40 flex items-center justify-center",i?.id===J.id&&"bg-info/30 border-info/60"),children:a.jsx(Zo,{className:"w-8 h-8 text-info"})})}),a.jsx("div",{className:"w-full mt-auto",children:J.status==="in-use"||J.status==="awaiting-payment"?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[a.jsx(Pl,{className:"w-3 h-3 text-text-muted flex-shrink-0"}),a.jsx("div",{className:"text-sm sm:text-base font-medium text-text-primary truncate",title:J.customer||"",children:He(J.customer)||""})]}),a.jsxs("div",{className:"flex items-center gap-1 justify-between",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(ei,{className:"w-3 h-3 text-text-muted flex-shrink-0"}),a.jsxs("div",{className:"text-sm font-bold text-text-secondary",children:["R$ ",Ie.toFixed(2)]})]}),a.jsx("button",{onClick:vt=>{vt.stopPropagation(),n(`/historico?mesa=${J.id}`)},className:"p-1 hover:bg-surface-2 rounded transition-colors",title:"Ver histrico desta mesa",children:a.jsx(Zo,{className:"w-4 h-4 text-text-secondary hover:text-text-primary"})})]})]}):a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"text-xs text-text-muted",children:"Sem comanda"}),a.jsx("button",{onClick:vt=>{vt.stopPropagation(),n(`/historico?mesa=${J.id}`)},className:"p-1 hover:bg-surface-2 rounded transition-colors",title:"Ver histrico desta mesa",children:a.jsx(Zo,{className:"w-4 h-4 text-text-secondary hover:text-text-primary"})})]})})]})},it=()=>{const J=i?Dn(i.order,i):0,[ve,G]=p.useState(!1),[re,we]=p.useState([]),[Ce,ke]=p.useState(1),[Oe,oe]=p.useState([]),Ee=p.useRef(new Map),Ie=typeof window<"u"&&window.innerWidth<=640,tt=p.useRef(!1),vt=Er=>{const Br=String(Er||"").replace(/\D/g,"");return Br?Number(Br)/100:0},Rt=Er=>new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Math.max(0,Number(Er)||0)),At=Er=>{const Br=(Ue||[]).find(en=>String(en.id)===String(Er.methodId)),zr=Br&&Br.taxa_percentual!=null?Number(Br.taxa_percentual):0;return Number.isFinite(zr)?zr/100:0},Gt=()=>(re||[]).reduce((Er,Br)=>Er+vt(Br.value),0);p.useEffect(()=>(Tn.current=we,nt.current=ke,$t.current=i?.comandaId||null,()=>{Tn.current=null,nt.current=null,$t.current=null}),[i?.comandaId]),p.useEffect(()=>{Kt.current=re||[]},[re]);const Bt=(Er,Br)=>{try{if(Ie)return;const zr=(re||[]).findIndex(en=>en.id===Br);if(zr>=0){const en=(re||[])[zr+1]||null;if(en&&Ee.current.get(en.id)){const cn=Ee.current.get(en.id);setTimeout(()=>{try{cn.focus(),cn.select?.()}catch{}},0);return}}if(Er&&Er instanceof HTMLElement){const en=Array.from(document.querySelectorAll('input[data-pay-value="1"]')),cn=en.indexOf(Er);if(cn>=0&&en[cn+1]){const mr=en[cn+1];setTimeout(()=>{try{mr.focus(),mr.select?.()}catch{}},0);return}}tt.current=!0,we(en=>{const cn=Oe[0]?.id||"",mr=Ue&&Ue[0]&&Ue[0].id?Ue[0].id:null,Ur=Ce,gr=[...en,{id:Ur,clientId:cn,methodId:mr,value:"",chargeFee:!0}];return ke(_r=>_r+1),Ie||setTimeout(()=>{const _r=Ee.current.get(Ur);if(_r)try{_r.focus(),_r.select?.()}catch{}},0),gr})}catch{}};p.useEffect(()=>{let Er=!0;return(async()=>{try{if(!Ge||!i?.comandaId)return;let zr=[],en=[];try{const[br,Gr]=await Promise.all([GGe({comandaId:i.comandaId,status:"Pendente",codigoEmpresa:t?.codigo_empresa}).catch(()=>[]),ui({comandaId:i.comandaId,codigoEmpresa:t?.codigo_empresa}).catch(()=>[])]);zr=Array.isArray(br)?br:[],en=(Array.isArray(Gr)?Gr:[]).map(Zr=>{const kn=Zr?.cliente_id??Zr?.clientes?.id??Zr?.id??null,ya=Zr?.clientes?.nome??Zr?.nome??Zr?.nome_livre??"";return!kn&&ya?{id:`livre-${Zr?.id||Math.random()}`,nome:ya}:kn?{id:kn,nome:ya}:null}).filter(Boolean)}catch{}if(!Er)return;if(oe(en),Array.isArray(zr)&&zr.length>0){const br=zr.map((Gr,yn)=>{const Zr=Number(Gr.valor||0),ya={id:yn+1,clientId:Gr.cliente_id||null,methodId:Gr.finalizadora_id||null,chargeFee:!0},Ca=At(ya),ks=Zr,es=ya.chargeFee!==!1?ks*(1+Ca):ks;return{...ya,baseValue:ks,value:Rt(es)}});we(br),ke(br.length+1),tt.current=!1;return}let cn=Ue&&Ue[0]&&Ue[0].id?Ue[0].id:null,mr=en[0]?.id||null,Ur="";try{const Gr=(await io({comandaId:i.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).reduce((yn,Zr)=>yn+Number(Zr.quantidade||0)*Number(Zr.preco_unitario||0),0);Gr>0&&(Ur=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Gr))}catch{}const gr=vt(Ur),_r={id:1,clientId:mr,methodId:cn,baseValue:gr,chargeFee:!0},Xt=At(_r),Lr=_r.chargeFee?gr*(1+Xt):gr;we([{..._r,value:Rt(Lr)}]),ke(2),tt.current=!1}catch(zr){console.error(zr)}})(),()=>{Er=!1}},[Ge,i?.comandaId]),p.useEffect(()=>{if(!Ge||!i?.comandaId||!Array.isArray(re)||re.length===0||!tt.current)return;Fr.current&&clearTimeout(Fr.current);const Er=setTimeout(async()=>{if(tt.current)try{const Br=(re||[]).map(zr=>{const en=Number(zr.baseValue||0),cn=(Ue||[]).find(Ur=>String(Ur.id)===String(zr.methodId)),mr=cn?.tipo||cn?.nome||"outros";return{clienteId:zr.clientId||null,finalizadoraId:zr.methodId||null,metodo:mr,valor:en}});Dr.current=Date.now(),await yj({comandaId:i.comandaId,linhas:Br,codigoEmpresa:t?.codigo_empresa})}catch(Br){console.warn("[PayDialog] Falha ao salvar rascunho de pagamentos (debounced):",Br)}},400);return Fr.current=Er,()=>{clearTimeout(Er),Fr.current===Er&&(Fr.current=null)}},[Ge,i?.comandaId,re,Ue,t?.codigo_empresa]),p.useEffect(()=>{let Er=!0;return(async()=>{try{if(!Ge||Array.isArray(Ue)&&Ue.length>0)return;const zr=await th({somenteAtivas:!0,codigoEmpresa:t?.codigo_empresa});if(!Er)return;ze(zr||[])}catch{}})(),()=>{Er=!1}},[Ge]),p.useEffect(()=>{Ge&&(!Array.isArray(Ue)||Ue.length===0||we(Er=>{if(!Array.isArray(Er)||Er.length===0)return Er;const Br=Ue&&Ue[0]&&Ue[0].id?Ue[0].id:null;if(!Br)return Er;let zr=!1;const en=Er.map(cn=>{if(!cn.methodId){zr=!0;const mr={...cn,methodId:Br},Ur=At(mr),gr=mr.chargeFee!==!1?Number(mr.baseValue||0)*(1+Ur):Number(mr.baseValue||0);return{...mr,value:Rt(gr)}}return cn});return zr?en:Er}))},[Ge,Ue]);const Ht=async()=>{try{if(!i?.comandaId)return;const Er=t?.codigo_empresa;if(!Er){e({title:"Empresa no definida",variant:"destructive"});return}if(!Array.isArray(re)||re.length===0){e({title:"Informe os pagamentos",description:"Adicione pelo menos uma forma de pagamento.",variant:"warning"});return}for(const br of re){if(!br.methodId){e({title:"Forma de pagamento faltando",description:"Selecione a finalizadora em todas as linhas.",variant:"warning"});return}if(vt(br.value)<=0){e({title:"Valor invlido",description:"Informe valores maiores que zero.",variant:"warning"});return}}ht(!0);const Br=J>0?J:0,zr=(re||[]).reduce((br,Gr)=>br+vt(Gr.value),0),en=(re||[]).reduce((br,Gr)=>{const yn=Number(Gr.baseValue||0),Zr=At(Gr);return br+(Gr.chargeFee!==!1&&Zr>0?yn*Zr:0)},0),cn=Br+en,mr=zr-cn,Ur=Math.abs(mr),gr=i.comandaId,_r=i.id;o(br=>br.map(Gr=>Gr.id===_r?{...Gr,status:"available",order:[],comandaId:null,customer:null,totalHint:0}:Gr)),l(br=>br&&br.id===_r?null:br),Je(!1);try{dr(!1)}catch{}let Xt=J;if(Xt<=0)try{Xt=(await io({comandaId:gr,codigoEmpresa:t?.codigo_empresa})||[]).reduce((yn,Zr)=>yn+Number(Zr.quantidade||0)*Number(Zr.preco_unitario||0),0)}catch{}G(!0),ht(!0),await Of({codigoEmpresa:t?.codigo_empresa});try{const br=(re||[]).map(Gr=>{const yn=Number(Gr.baseValue||0),Zr=(Ue||[]).find(ya=>String(ya.id)===String(Gr.methodId)),kn=Zr?.tipo||Zr?.nome||"outros";return{clienteId:Gr.clientId||null,finalizadoraId:Gr.methodId||null,metodo:kn,valor:yn}});await yj({comandaId:gr,linhas:br,codigoEmpresa:Er})}catch(br){console.warn("[PayDialog] Falha ao salvar rascunho antes de promover:",br)}await KGe({comandaId:gr,codigoEmpresa:Er}),await d0({comandaId:gr,codigoEmpresa:t?.codigo_empresa,diferencaPagamento:mr});try{t?.codigo_empresa&&localStorage.removeItem(`vendas:tables:${t.codigo_empresa}`)}catch{}try{const br=await rh(t?.codigo_empresa),Gr=await kc({codigoEmpresa:t?.codigo_empresa}),yn={};await Promise.all((Gr||[]).map(async kn=>{try{const Ca=(await ui({comandaId:kn.id,codigoEmpresa:t?.codigo_empresa})||[]).map(ks=>ks?.nome).filter(Boolean);yn[kn.id]=Ca.length?Ca.join(", "):null}catch{yn[kn.id]=null}}));const Zr=(br||[]).map(kn=>{const ya=(Gr||[]).find(Ca=>Ca.mesa_id===kn.id);return{id:kn.id,name:kn.nome||`Mesa ${kn.numero}`,status:ya?"in-use":"available",comandaId:ya?.id||null,customer:ya?yn[ya.id]:null,order:[],totalHint:0,aberto_em:ya?.aberto_em||null}});o(Zr)}catch{}const Lr=Ur>.009?mr>0?` | Diferena cobrada a mais: R$ ${Ur.toFixed(2)}`:` | Diferena cobrada a menos: R$ ${Ur.toFixed(2)}`:"";e({title:"Pagamento registrado",description:`Total itens R$ ${Xt.toFixed(2)} | Pagamentos R$ ${zr.toFixed(2)}${Lr}`,variant:"success"})}catch(Er){e({title:"Falha ao registrar pagamento",description:Er?.message||"Tente novamente",variant:"destructive"})}finally{G(!1),ht(!1)}};re&&re.length>0;const jr=J>0?J:0,vr=(re||[]).reduce((Er,Br)=>Er+vt(Br.value),0),xn=(re||[]).reduce((Er,Br)=>{const zr=Number(Br.baseValue||0),en=At(Br);return Er+(Br.chargeFee!==!1&&en>0?zr*en:0)},0),Kn=jr+xn,Un=vr-Kn,Ir=Math.abs(Un);return a.jsx(mn,{open:Ge,onOpenChange:Je,children:a.jsxs(un,{className:"sm:max-w-xl w-[92vw] h-[85vh] animate-none flex flex-col overflow-hidden",onKeyDown:Er=>Er.stopPropagation(),onKeyDownCapture:Er=>Er.stopPropagation(),onPointerDownOutside:Er=>Er.stopPropagation(),onInteractOutside:Er=>Er.stopPropagation(),children:[a.jsxs(on,{children:[a.jsx(an,{className:"text-2xl font-bold",children:"Fechar Conta"}),a.jsx(Nn,{children:"Divida o pagamento entre clientes e vrias finalizadoras, se necessrio."})]}),a.jsxs("div",{className:"space-y-2",children:[(()=>{let Er=0,Br=0,zr=0;for(const mr of i?.order||[]){const Ur=(mr.price||0)*(mr.quantity||1);Er+=Ur,mr.desconto_tipo==="percentual"&&mr.desconto_valor>0?Br+=Ur*(mr.desconto_valor/100):mr.desconto_tipo==="fixo"&&mr.desconto_valor>0&&(Br+=mr.desconto_valor)}const en=Er-Br;i?.desconto_tipo==="percentual"&&i?.desconto_valor>0?zr=en*(i.desconto_valor/100):i?.desconto_tipo==="fixo"&&i?.desconto_valor>0&&(zr=i.desconto_valor);const cn=Br+zr;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center gap-8 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-text-secondary",children:"Subtotal"}),a.jsxs("span",{className:"font-semibold",children:["R$ ",Er.toFixed(2)]})]}),cn>0&&a.jsxs("div",{className:"flex items-center gap-2 text-destructive",children:[a.jsx("span",{children:"Descontos"}),a.jsxs("span",{className:"font-semibold",children:["-R$ ",cn.toFixed(2)]})]})]}),a.jsxs("div",{className:"border-t border-border pt-1 flex items-center justify-between",children:[a.jsx("div",{className:"font-semibold",children:"Total"}),a.jsxs("div",{className:"font-bold text-lg",children:["R$ ",J.toFixed(2)]})]})]})})(),a.jsxs("div",{className:"flex items-center gap-8 text-xs text-text-muted pt-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{children:"Pagamentos"}),a.jsxs("span",{className:"font-semibold",children:["R$ ",vr.toFixed(2)]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{children:"Diferena"}),a.jsx("span",{className:Ir>.009?Un>0?"font-semibold text-emerald-600":"font-semibold text-amber-600":"font-semibold",children:Ir>.009?`${Un>0?"+":"-"} R$ ${Ir.toFixed(2)}`:"R$ 0,00"})]})]}),a.jsxs("div",{className:"flex-1 space-y-2 overflow-y-auto thin-scroll pr-1",children:[a.jsx(qe,{className:"block",children:"Pagamentos"}),(re||[]).map((Er,Br)=>{const zr=mr=>{if(!mr)return"Cliente";const Ur=(Oe||[]).find(gr=>String(gr.id)===String(mr));return Ur?.nome?Ur.nome:"Cliente"},en=(Oe||[]).length>1,cn=(Oe||[])[0]||null;return(Oe||[]).filter(mr=>String(mr.id)!==String(cn?.id||"")),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-12 gap-2 items-center",children:[a.jsx("div",{className:"sm:col-span-1 flex sm:justify-start",children:re.length>1&&Br>0&&a.jsx(fe,{type:"button",variant:"outline",size:"sm",className:"h-8 w-8",onClick:()=>{tt.current=!0,we(mr=>{const Ur=mr.filter(Lr=>Lr.id!==Er.id);if(Ur.length===0)return[];const gr=J>0?J:0,_r=Math.floor(gr/Ur.length*100)/100,Xt=gr-_r*Ur.length;return Ur.map((Lr,br)=>{const Gr=br===Ur.length-1?_r+Xt:_r,yn={...Lr},Zr=At(yn),ya=yn.chargeFee!==!1&&Zr>0?Gr/(1+Zr):Gr;return{...yn,baseValue:ya,value:Rt(Gr)}})})},children:""})}),Br===0?a.jsx("div",{className:"sm:col-span-4",children:a.jsx("div",{className:"h-9 px-3 rounded-md border border-border bg-surface flex items-center text-sm truncate",children:zr(cn?.id||Er.clientId)})}):en?a.jsx("div",{className:"sm:col-span-4",children:a.jsxs(vn,{value:Er.clientId||"",onValueChange:mr=>we(Ur=>Ur.map(gr=>gr.id===Er.id?{...gr,clientId:mr}:gr)),children:[a.jsx(hn,{className:"w-full truncate",children:a.jsx(wn,{placeholder:"Cliente"})}),a.jsx(pn,{children:(Oe||[]).map(mr=>a.jsx(ct,{value:mr.id,children:mr.nome},mr.id))})]})}):a.jsx("div",{className:"sm:col-span-4",children:a.jsx("div",{className:"h-9 px-3 rounded-md border border-border bg-surface flex items-center text-sm truncate",children:zr(cn?.id||Er.clientId)})}),a.jsx("div",{className:"sm:col-span-4",children:a.jsxs(vn,{value:String(Er.methodId||""),onValueChange:mr=>{tt.current=!0;const Ur=(re||[]).map(gr=>{if(gr.id!==Er.id)return gr;const _r=String(mr),Xt={...gr,methodId:_r},Lr=At(Xt),br=Xt.chargeFee!==!1?Number(Xt.baseValue||0)*(1+Lr):Number(Xt.baseValue||0);return{...Xt,value:Rt(br)}});we(Ur);try{const gr=i?.comandaId,_r=t?.codigo_empresa;if(gr&&_r){const Xt=Ur.map(Lr=>{const br=Number(Lr.baseValue||0),Gr=(Ue||[]).find(Zr=>String(Zr.id)===String(Lr.methodId)),yn=Gr?.tipo||Gr?.nome||"outros";return{clienteId:Lr.clientId||null,finalizadoraId:Lr.methodId||null,metodo:yn,valor:br}});Dr.current=Date.now(),yj({comandaId:gr,linhas:Xt,codigoEmpresa:_r}).then(()=>{}).catch(Lr=>{console.warn("[PayDialog] Falha ao salvar rascunho aps troca de finalizadora (bg):",Lr),tt.current=!0}),tt.current=!1}}catch(gr){console.warn("[PayDialog] Falha ao salvar rascunho aps troca de finalizadora:",gr)}},children:[a.jsx(hn,{className:"w-full truncate",children:a.jsx(wn,{placeholder:"Forma de pagamento"})}),a.jsx(pn,{children:(Ue||[]).map(mr=>a.jsx(ct,{value:String(mr.id),children:mr.nome},String(mr.id)))})]})}),a.jsx("div",{className:"sm:col-span-3",children:a.jsx(rt,{placeholder:"0,00",inputMode:"numeric",value:Er.value,"data-pay-value":"1",ref:mr=>{mr?Ee.current.set(Er.id,mr):Ee.current.delete(Er.id)},onChange:mr=>{tt.current=!0;const Ur=(mr.target.value||"").replace(/\D/g,""),gr=Ur?Number(Ur)/100:0;we(_r=>_r.map(Xt=>{if(Xt.id!==Er.id)return Xt;const Lr=At(Xt),br=Xt.chargeFee!==!1&&Lr>0?gr/(1+Lr):gr,Gr=Xt.chargeFee!==!1?br*(1+Lr):br;return{...Xt,baseValue:br,value:Rt(Gr)}}))},onKeyDown:mr=>{if(mr.stopPropagation(),mr.key==="Enter"){mr.preventDefault(),Bt(mr.currentTarget,Er.id);return}["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(mr.key)||/^[0-9]$/.test(mr.key)||mr.preventDefault()},onBeforeInput:mr=>{const Ur=mr.data??"";Ur&&/\D/.test(Ur)&&mr.preventDefault()}})}),a.jsx("div",{className:"sm:col-span-12 -mt-1 pl-1",children:(()=>{const mr=At(Er),Ur=mr*100,gr=Er.chargeFee!==!1,_r=Er.baseValue!=null?Number(Er.baseValue):(()=>{const br=(Er.value||"").toString().replace(/\D/g,""),Gr=br?Number(br)/100:0;return gr&&mr>0?Gr/(1+mr):Gr})();if(!Ur||Ur<=0||!Number.isFinite(_r)||_r<=0)return null;const Xt=gr?_r*mr:0;return a.jsxs("button",{type:"button",onClick:async()=>{tt.current=!0;const Lr=(re||[]).map(br=>{if(br.id!==Er.id)return br;const Gr=At(br),yn=br.chargeFee!==!1,Zr=br.baseValue!=null?Number(br.baseValue):vt(br.value),kn=yn?Zr:Zr*(1+Gr);return{...br,chargeFee:!yn,baseValue:Zr,value:Rt(kn)}});we(Lr);try{const br=i?.comandaId,Gr=t?.codigo_empresa;if(br&&Gr){const yn=Lr.map(Zr=>({clienteId:Zr.clientId||null,finalizadoraId:Zr.methodId||null,metodo:(Ue||[]).find(kn=>String(kn.id)===String(Zr.methodId))?.tipo||(Ue||[]).find(kn=>String(kn.id)===String(Zr.methodId))?.nome||"outros",valor:Number(Zr.baseValue||0)}));Dr.current=Date.now(),await yj({comandaId:br,linhas:yn,codigoEmpresa:Gr}),tt.current=!1}}catch(br){console.warn("[PayDialog] Falha ao salvar rascunho aps alternar taxa:",br)}},className:["inline-flex items-center gap-2 px-3 py-1 rounded-sm text-xs font-medium border transition-colors",gr?"bg-black text-amber-400 border-amber-500":"bg-surface text-text-secondary border-border hover:border-border-hover"].join(" "),title:gr?"Desmarcar taxa":"Cobrar taxa",children:[a.jsx("span",{className:["inline-block h-3 w-3 rounded-sm border",gr?"bg-amber-500 border-amber-400":"bg-transparent border-border"].join(" ")}),a.jsxs("span",{children:["Taxa R$ ",Xt.toFixed(2)]})]})})()})]},Er.id)}),a.jsx("div",{children:a.jsx(fe,{type:"button",variant:"secondary",size:"sm",className:"pointer-events-auto",onPointerUp:Er=>{Er.preventDefault(),Er.stopPropagation(),tt.current=!0,we(Br=>{const zr=Oe[0]?.id||"",en=Ue&&Ue[0]&&Ue[0].id?Ue[0].id:null,cn=[...Br,{id:Ce,clientId:zr,methodId:en,value:"",chargeFee:!0}],mr=J>0?J:0,Ur=Math.floor(mr/cn.length*100)/100,gr=mr-Ur*cn.length;return cn.map((_r,Xt)=>{const Lr=Xt===cn.length-1?Ur+gr:Ur,br=At(_r),yn=_r.chargeFee!==!1&&br>0?Lr/(1+br):Lr;return{..._r,baseValue:yn,value:Rt(Lr)}})}),ke(Br=>Br+1)},children:"Adicionar forma"})}),(()=>{const Er=Gt(),Br=(re||[]).reduce((cn,mr)=>{const Ur=Number(mr.baseValue||0),gr=At(mr);return cn+(mr.chargeFee!==!1&&gr>0?Ur*gr:0)},0),en=(J>0?J:0)+Br-Er;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"text-sm text-text-secondary flex justify-between",children:[a.jsx("span",{children:"Soma"}),a.jsxs("span",{children:["R$ ",Er.toFixed(2)]})]}),a.jsxs("div",{className:"text-sm font-semibold flex justify-between",children:[a.jsx("span",{children:"Restante"}),a.jsxs("span",{className:Math.abs(en)<.005?"text-success":"text-warning",children:["R$ ",en.toFixed(2)]})]})]})})()]})]}),a.jsxs(Qn,{className:"sticky bottom-0 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/75",children:[a.jsx(fe,{type:"button",variant:"outline",onClick:()=>Je(!1),disabled:ve,children:"Cancelar"}),a.jsx(fe,{type:"button",onClick:Ht,disabled:!(re&&re.length>0&&!ve),children:ve?"Processando...":"Confirmar Pagamento"})]})]})})},lt=Pe.memo(({open:J,onOpenChange:ve,cashSummary:G})=>{const re=jr=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(jr||0)),[we,Ce]=p.useState(!0);p.useEffect(()=>{Ce(!!J)},[J]);const ke=p.useMemo(()=>{const jr=Number(G?.saldo_inicial??G?.saldoInicial??0),vr=G?.totalPorFinalizadora||G?.porFinalizadora||{},xn=Number(G?.totalEntradas??G?.entradas??0),Kn=xn>0?xn:Object.values(vr||{}).reduce((Br,zr)=>Br+Number(zr||0),0),Un=Number(G?.sangria??G?.totalSangria??0),Ir=Number(G?.totalSaidas??G?.saidas??Un),Er=Math.max(0,jr+Kn-Ir);return{saldoInicial:jr,porFinalizadora:vr,entradasInformadas:xn,entradasCalc:Kn,sangriaVal:Un,saidas:Ir,saldoAtual:Er}},[G]);p.useEffect(()=>{if(J&&G){const jr=setTimeout(()=>Ce(!1),50);return()=>clearTimeout(jr)}},[J,G]);const{porFinalizadora:Oe,sangriaVal:oe}=ke,[Ee,Ie]=p.useState(!1),[tt,vt]=p.useState(""),[Rt,At]=p.useState(""),[Gt,Bt]=p.useState(!1),Ht=async()=>{try{Bt(!0);const jr=String(tt||"").replace(/\D/g,""),vr=jr?Number(jr)/100:0;if(vr<=0){e({title:"Valor invlido",description:"Informe um valor positivo.",variant:"warning"});return}await Of({codigoEmpresa:t?.codigo_empresa}),await FT({tipo:"sangria",valor:vr,observacao:Rt,codigoEmpresa:t?.codigo_empresa}),Ie(!1),vt(""),At(""),await ar(),e({title:"Sangria registrada",variant:"success"})}catch(jr){e({title:"Falha ao registrar sangria",description:jr?.message||"Tente novamente",variant:"destructive"})}finally{Bt(!1)}};return a.jsx(mn,{open:J,onOpenChange:ve,children:a.jsxs(un,{forceMount:!0,className:"sm:max-w-lg w-[92vw] max-h-[85vh] animate-none flex flex-col overflow-hidden",onOpenAutoFocus:jr=>jr.preventDefault(),onKeyDown:jr=>jr.stopPropagation(),onKeyDownCapture:jr=>jr.stopPropagation(),onPointerDownOutside:jr=>jr.stopPropagation(),onInteractOutside:jr=>jr.stopPropagation(),children:[a.jsxs(on,{children:[a.jsx(an,{className:"text-2xl font-bold",children:"Detalhes do Caixa"}),a.jsx(Nn,{children:"Resumo da sesso atual do caixa."})]}),we||!G?a.jsxs("div",{className:"px-4 space-y-3",children:[a.jsx(wv,{className:"h-16 w-full"}),a.jsx(wv,{className:"h-16 w-full"}),a.jsx(wv,{className:"h-12 w-full"})]}):a.jsxs("div",{className:"px-1",children:[Object.keys(Oe).length===0?a.jsx("div",{className:"p-3 text-sm text-text-muted border rounded-md",children:"Nenhuma finalizadora registrada ainda."}):a.jsxs(a.Fragment,{children:[a.jsx("ul",{className:"rounded-md border border-border overflow-hidden divide-y divide-border",children:Object.entries(Oe).map(([jr,vr])=>a.jsxs("li",{className:"bg-surface px-3 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:String(jr)}),a.jsx("span",{className:"text-sm font-semibold tabular-nums",children:re(vr)})]},jr))}),a.jsxs("div",{className:"mt-2 rounded-md border border-border bg-surface px-3 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:"Sangrias"}),a.jsx("span",{className:"text-sm font-semibold tabular-nums text-danger",children:re(oe)})]})]}),a.jsx("div",{className:"mt-3 text-xs text-text-muted leading-relaxed px-1",children:'Sadas incluem sangrias e ajustes. Use "Registrar Sangria" para lanar uma retirada.'})]}),a.jsxs(Qn,{className:"flex items-center justify-between gap-2",children:[a.jsx("div",{className:"mr-auto"}),a.jsx(fe,{variant:"destructive",onClick:()=>Ie(!0),children:"Registrar Sangria"}),a.jsx(fe,{variant:"secondary",onClick:()=>ve(!1),children:"Fechar"})]}),a.jsx(mn,{open:Ee,onOpenChange:Ie,children:a.jsxs(un,{className:"sm:max-w-sm w-[92vw] max-h-[85vh] animate-none",onKeyDown:jr=>jr.stopPropagation(),onKeyDownCapture:jr=>jr.stopPropagation(),children:[a.jsxs(on,{children:[a.jsx(an,{className:"text-xl font-bold",children:"Registrar Sangria"}),a.jsx(Nn,{children:"Informe o valor a retirar do caixa e, opcionalmente, uma observao."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx(qe,{htmlFor:"sangria-valor",children:"Valor"}),a.jsx(rt,{id:"sangria-valor",type:"text",inputMode:"numeric",autoComplete:"off",placeholder:"0,00",value:tt,onChange:jr=>{const vr=(jr.target.value||"").replace(/\D/g,""),xn=vr?Number(vr)/100:0,Kn=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(xn);vt(Kn)},onKeyDown:jr=>{jr.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(jr.key)&&(/^[0-9]$/.test(jr.key)||jr.preventDefault())},onBeforeInput:jr=>{const vr=jr.data??"";vr&&/\D/.test(vr)&&jr.preventDefault()}})]}),a.jsxs("div",{children:[a.jsx(qe,{htmlFor:"sangria-obs",children:"Observao"}),a.jsx(rt,{id:"sangria-obs",placeholder:"Opcional",value:Rt,onChange:jr=>At(jr.target.value)})]})]}),a.jsxs(Qn,{children:[a.jsx(fe,{variant:"outline",onClick:()=>Ie(!1),disabled:Gt,children:"Cancelar"}),a.jsx(fe,{onClick:Ht,disabled:Gt,children:Gt?"Registrando...":"Confirmar"})]})]})})]})})}),Vt=()=>{const J=async()=>{if(V)try{await tx({itemId:V.id,codigoEmpresa:t?.codigo_empresa});try{await ot(i)}catch{}e({title:"Item removido",description:V.name,variant:"warning"})}catch(ve){e({title:"Falha ao remover item",description:ve?.message||"Tente novamente",variant:"destructive"})}finally{pe(!1),B(null)}};return a.jsx(au,{open:Q,onOpenChange:pe,children:a.jsxs(md,{children:[a.jsxs(hd,{children:[a.jsx(gd,{children:"Remover item?"}),a.jsxs(vd,{children:['Tem certeza que deseja remover "',V?.name,'" da comanda? Esta ao no pode ser desfeita.']})]}),a.jsxs(pd,{children:[a.jsx(xd,{children:"Cancelar"}),a.jsx(su,{onClick:J,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})})},Ve=()=>{const J=i,ve=J?.order||[],G=J?Dn(ve):0;return a.jsx(mn,{open:$,onOpenChange:X,children:a.jsxs(un,{className:"sm:max-w-xl w-[92vw] animate-none",onKeyDown:re=>re.stopPropagation(),onKeyDownCapture:re=>re.stopPropagation(),onPointerDownOutside:re=>re.stopPropagation(),onInteractOutside:re=>re.stopPropagation(),children:[a.jsxs(on,{children:[a.jsxs(an,{className:"text-2xl font-bold",children:["Comanda da Mesa ",J?.number??""]}),a.jsx(Nn,{children:J?.customer?`Cliente: ${J.customer}`:"Sem cliente vinculado"})]}),a.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto thin-scroll",children:ve.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Nenhum item na comanda."}):a.jsx("ul",{className:"divide-y divide-border",children:ve.map(re=>a.jsxs("li",{className:"py-2 flex items-center justify-between gap-4",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"font-medium truncate",children:re.name}),a.jsxs("div",{className:"text-xs text-text-muted",children:["Qtd: ",re.quantity,"  Unit: R$ ",Number(re.price||0).toFixed(2)]})]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs("div",{className:"font-semibold",children:["R$ ",(Number(re.price||0)*Number(re.quantity||0)).toFixed(2)]})})]},re.id))})}),a.jsxs(Qn,{children:[a.jsxs("div",{className:"mr-auto text-sm font-semibold",children:["Total: R$ ",G.toFixed(2)]}),a.jsx(fe,{variant:"secondary",onClick:()=>X(!1),children:"Fechar"}),J?.comandaId&&a.jsxs(fe,{variant:"outline",onClick:()=>window.open(`/print-comanda?comanda=${J.comandaId}`,"_blank"),children:[a.jsx(tG,{className:"mr-2 h-4 w-4"})," Imprimir"]}),a.jsxs(fe,{onClick:async()=>{X(!1),await nn()},disabled:!J||ve.length===0,children:[a.jsx(ei,{className:"mr-2 h-4 w-4"})," Fechar Conta",a.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-amber-600 border border-amber-700 rounded shadow-sm",children:"F2"})]})]})]})})},kt=p.useMemo(()=>Ve,[i?.id,$]),Sr=({table:J})=>{const[ve,G]=p.useState(""),[re,we]=p.useState(!1),[Ce,ke]=p.useState(!1),Oe=async()=>{if(!(!J?.comandaId||re))try{we(!0),await aKe({comandaId:J.comandaId,observacoes:ve,codigoEmpresa:Number(t?.codigo_empresa)}),e({title:"Observaes salvas",description:"As observaes da comanda foram atualizadas."});try{await ot(J)}catch(oe){console.error("Erro ao recarregar detalhes da comanda aps salvar observaes:",oe)}}catch(oe){oe?.code!=="42804"&&(console.error("Erro ao salvar observao:",oe),e({title:"Erro ao salvar observaes",description:"Tente novamente mais tarde.",variant:"destructive"}))}finally{we(!1)}};return p.useEffect(()=>{if(!J?.comandaId){G("");return}G(J.observacoes||"")},[J?.comandaId,J?.observacoes]),J?a.jsxs("div",{className:"flex flex-col h-full p-4 space-y-4 overflow-y-auto thin-scroll",children:[J.order&&J.order.length>0&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(qe,{className:"text-sm font-semibold",children:"Descontos por Item"}),a.jsx(fe,{size:"xs",variant:"ghost",className:"h-6 px-2 text-[11px]",onClick:()=>ke(oe=>!oe),children:Ce?"Esconder":`Mostrar (${J.order.length})`})]}),Ce&&a.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:J.order.map(oe=>a.jsx("button",{onClick:()=>pt(oe),className:"w-full p-3 rounded border border-border bg-surface hover:bg-surface-2 transition text-left",children:a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("p",{className:"text-sm font-semibold truncate",children:oe.name}),a.jsxs("p",{className:"text-xs text-text-secondary",children:["Qtd: ",oe.quantity,"  R$ ",(oe.price||0).toFixed(2)]})]}),a.jsx("div",{className:"text-right flex-shrink-0",children:oe.desconto_valor>0?a.jsxs("span",{className:"text-xs font-bold text-destructive",children:["-",oe.desconto_tipo==="percentual"?oe.desconto_valor+"%":"R$"+(oe.desconto_valor||0).toFixed(2)]}):a.jsx("span",{className:"text-xs text-text-muted",children:"Sem desconto"})})]})},oe.id))})]}),J.comandaId&&a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsx(qe,{className:"text-sm font-semibold",children:"Observaes"}),re&&a.jsx("span",{className:"text-[11px] text-text-secondary",children:"Salvando..."})]}),a.jsx("textarea",{className:"border border-border rounded p-3 text-sm resize-none bg-background min-h-20",placeholder:"Ex: sem cebola, urgente, etc.",value:ve,onChange:oe=>{const Ee=oe.target.value;G(Ee)},onKeyDown:async oe=>{oe.key==="Enter"&&!oe.shiftKey&&(oe.preventDefault(),await Oe())}})]}),J.comandaId&&a.jsxs("div",{className:"space-y-2",children:[a.jsx(qe,{className:"text-sm font-semibold",children:"Desconto da Comanda"}),a.jsx(fe,{size:"sm",variant:J.desconto_valor>0?"default":"outline",onClick:()=>he(!0),className:"w-full gap-2",children:J.desconto_valor>0?a.jsxs(a.Fragment,{children:[a.jsx("span",{children:"Desconto Ativo:"}),a.jsxs("span",{className:"font-bold",children:["-",J.desconto_tipo==="percentual"?J.desconto_valor+"%":"R$"+J.desconto_valor.toFixed(2)]})]}):"Aplicar Desconto"}),J.desconto_motivo&&a.jsxs("div",{className:"text-xs text-text-secondary bg-surface p-2 rounded border border-border",children:[a.jsx("strong",{children:"Motivo:"})," ",J.desconto_motivo]})]})]}):a.jsx("div",{className:"flex items-center justify-center h-full text-text-muted",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Zo,{className:"mx-auto mb-4 h-12 w-12 opacity-50"}),a.jsx("p",{children:"Selecione uma mesa"})]})})},Or=({table:J})=>{if(!J)return a.jsx("div",{className:"flex items-center justify-center h-full text-text-muted",children:a.jsxs("div",{className:"text-center",children:[a.jsx(lx,{className:"mx-auto mb-4 h-12 w-12 opacity-50"}),a.jsx("p",{children:"Selecione uma mesa para ver a comanda"})]})});if(nr)return a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"p-3 border-b border-border flex items-center justify-between gap-2",children:[a.jsx("div",{className:"h-0 w-0","aria-hidden":"true"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(fe,{size:"sm",className:"h-7 px-2.5 rounded-full text-[12px] font-medium leading-none whitespace-nowrap",disabled:!c,onClick:()=>{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de abrir uma mesa.",variant:"warning"});return}be(J),ie(!0)},children:"Abrir Mesa"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 thin-scroll",children:[a.jsx(wv,{className:"h-20 w-full"}),a.jsx(wv,{className:"h-20 w-full"}),a.jsx(wv,{className:"h-20 w-full"})]}),a.jsxs("div",{className:"p-4 border-t border-border mt-auto",children:[a.jsxs("div",{className:"flex justify-between items-center text-sm font-semibold text-text-secondary mb-2",children:[a.jsx("span",{children:"Total"}),a.jsx("span",{children:"R$ 0,00"})]}),a.jsx(fe,{size:"lg",className:"w-full",disabled:!c,children:"Fechar Conta"})]})]});const ve=Dn(J.order,J),G=He(J.customer),re=async()=>{if(!J?.comandaId)return;const Oe=(await io({comandaId:J.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(tt=>({id:tt.id,productId:tt.produto_id,name:tt.descricao||"Item",price:Number(tt.preco_unitario||0),quantity:Number(tt.quantidade||1)})),oe=(Oe||[]).reduce((tt,vt)=>tt+Number(vt.price||0)*Number(vt.quantity||0),0);let Ee=J.customer||null;try{const vt=(await ui({comandaId:J.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(Rt=>Rt?.nome).filter(Boolean);Ee=vt.length?vt.join(", "):null}catch{}const Ie={...J,order:Oe,customer:Ee,totalHint:oe};l(Ie),o(tt=>tt.map(vt=>vt.id===Ie.id?Ie:vt))},we=async(ke,Oe)=>{try{const Ee=Number(ke.quantity||1)+Oe;if(Ee<=0){B(ke),pe(!0),setTimeout(async()=>{Q||await re()},100);return}const Ie=Number(ke.price||0)*Number(Oe||0);Ie&&(l(tt=>tt&&{...tt,totalHint:Math.max(0,Number(tt.totalHint||0)+Ie)}),o(tt=>tt.map(vt=>vt.id===i?.id?{...vt,totalHint:Math.max(0,Number(vt.totalHint||0)+Ie)}:vt))),await dd({itemId:ke.id,quantidade:Ee,codigoEmpresa:t?.codigo_empresa}),await re(),e({title:"Quantidade atualizada",description:`${ke.name}: ${Ee}`,variant:"success"})}catch(oe){e({title:"Falha ao atualizar quantidade",description:oe?.message||"Tente novamente",variant:"destructive"})}},Ce=async ke=>{B(ke),pe(!0),setTimeout(async()=>{Q||await re()},100)};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-col h-full",onMouseDown:ke=>{ke.target===ke.currentTarget&&ke.preventDefault()},children:[a.jsxs("div",{className:"p-3 border-b border-border flex items-center justify-center md:justify-between gap-2",children:[G?a.jsx("div",{className:"hidden sm:block text-sm font-medium text-text-primary leading-none truncate",title:J.customer||"",children:G}):a.jsx("div",{className:"h-0 w-0","aria-hidden":"true"}),a.jsx("div",{className:"flex items-center gap-2",children:J.comandaId?a.jsxs(a.Fragment,{children:[a.jsxs(fe,{size:"sm",className:"h-8 px-3 rounded-full text-[12px] font-medium leading-none whitespace-nowrap bg-black/60 text-white border border-white/10 shadow-sm hover:bg-black/80 hover:shadow transition-all flex items-center",onClick:()=>{Se(!0);try{w(!1)}catch{}try{W(!1)}catch{}try{Je(!1)}catch{}try{dr(!1)}catch{}try{X(!1)}catch{}},children:[a.jsx(Pl,{size:12,className:"text-white/80 mr-1.5"}),"Clientes"]}),a.jsxs(fe,{size:"sm",variant:"outline",className:"h-8 px-3 rounded-full text-[12px] font-medium leading-none whitespace-nowrap bg-black/60 text-white border border-white/10 shadow-sm hover:bg-black/80 hover:shadow transition-all",onClick:()=>X(!0),children:[a.jsx("span",{className:"inline-flex items-center justify-center h-5 w-5 rounded-full bg-black/40 border border-white/10 mr-1.5",children:a.jsx(Zo,{size:12,className:"text-white/80"})}),"Comanda"]}),a.jsxs(au,{children:[a.jsx(Up,{asChild:!0,children:a.jsx(fe,{size:"sm",className:"h-7 px-2.5 rounded-full text-[12px] font-medium leading-none whitespace-nowrap bg-red-600 hover:bg-red-500 text-white border border-red-600/70 focus:outline-none focus:ring-0 focus-visible:ring-0 shadow-none",children:"Cancelar"})}),a.jsxs(md,{className:"sm:max-w-[420px] animate-none",onKeyDown:ke=>ke.stopPropagation(),children:[a.jsxs(hd,{children:[a.jsx(gd,{children:"Cancelar comanda?"}),a.jsx(vd,{children:"Esta ao no pode ser desfeita. Os itens sero descartados e a mesa voltar a ficar livre."})]}),a.jsxs(pd,{children:[a.jsx(xd,{children:"Voltar"}),a.jsx(su,{disabled:at,onClick:async ke=>{const Oe=ke.currentTarget.closest('[role="alertdialog"]');Oe&&Oe.querySelector("[data-radix-collection-item]")?.click();try{xt(!0);const oe=t?.codigo_empresa;if(oe)try{localStorage.removeItem(`vendas:selected:${oe}`),localStorage.removeItem(`vendas:tables:${oe}`)}catch{}await wz({comandaId:J.comandaId,codigoEmpresa:oe}),l(null);try{dr(!1)}catch{}await ee({showToast:!1}),e({title:"Comanda cancelada",variant:"success"})}catch(oe){console.error("[Cancelar Comanda] Erro:",oe),e({title:"Falha ao cancelar comanda",description:oe?.message||"Tente novamente",variant:"destructive"});try{await ee({showToast:!1})}catch(Ee){console.error("[Cancelar Comanda] Erro ao recarregar aps falha:",Ee)}}finally{xt(!1)}},children:"Confirmar Cancelamento"})]})]})]})]}):a.jsx(fe,{size:"sm",className:"h-7 px-2.5 rounded-full text-[12px] font-medium leading-none whitespace-nowrap",disabled:!c,onClick:()=>{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de abrir uma mesa.",variant:"warning"});return}be(J),ie(!0)},children:"Abrir Mesa"})})]}),a.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto p-3 thin-scroll",children:J.order.length===0?a.jsx("div",{className:"text-center text-text-muted pt-16",children:a.jsx("p",{children:"Comanda vazia. Adicione produtos na aba ao lado."})}):a.jsx("ul",{className:"space-y-3",children:J.order.map(ke=>a.jsxs("li",{className:"p-2 rounded-md border border-border/30 bg-surface",children:[a.jsx("div",{className:"flex-1 min-w-0",children:a.jsx("p",{className:"text-sm font-semibold text-text-primary truncate",title:ke.name,children:ke.name})}),a.jsxs("div",{className:"mt-1 flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(fe,{variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>we(ke,-1),children:a.jsx(Vv,{size:12})}),a.jsx("span",{className:"w-7 text-center font-semibold text-sm",children:ke.quantity}),a.jsx(fe,{variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>we(ke,1),children:a.jsx(Ja,{size:12})})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"text-right flex-1",children:a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsxs("span",{className:"font-bold text-text-primary",children:["R$ ",(ke.price*ke.quantity).toFixed(2)]}),ke.desconto_valor>0&&a.jsxs("span",{className:"text-xs font-semibold text-destructive",children:["-",ke.desconto_tipo==="percentual"?ke.desconto_valor+"%":"R$"+(ke.desconto_valor||0).toFixed(2)]})]})}),a.jsx(fe,{variant:"ghost",size:"icon",className:"text-danger/80 hover:text-danger h-7 w-7",onClick:()=>Ce(ke),children:a.jsx(Ju,{size:14})})]})]})]},ke.id))})}),a.jsxs("div",{className:"p-3 border-t border-border mt-auto space-y-2",children:[a.jsxs("div",{className:"flex justify-between items-center text-sm font-semibold text-text-secondary",children:[a.jsx("span",{children:"Total"}),a.jsxs("span",{children:["R$ ",ve.toFixed(2)]})]}),a.jsxs(fe,{size:"lg",className:"w-full",onClick:nn,children:[a.jsx(ei,{className:"mr-2"})," Fechar Conta",a.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-amber-600 border border-amber-700 rounded shadow-sm",children:"F2"})]})]})]}),a.jsx(it,{})]})},fr=()=>{const[J,ve]=p.useState(""),[G,re]=p.useState(""),we=async()=>{try{if(ce)return;me(!0);const Ce=(J??"").toString().trim(),ke=Ce?Number(Ce):void 0;if(ke!==void 0&&(Number.isNaN(ke)||ke<=0)){e({title:"Nmero invlido",description:"Informe um nmero positivo.",variant:"warning"});return}const Oe=await XGe({numero:ke,nome:(G||"").trim()||void 0,codigoEmpresa:t?.codigo_empresa}),oe={id:Oe.id,number:Oe.numero,name:Oe.nome,status:"available",order:[],customer:null,comandaId:null,totalHint:0};o(Ee=>(Ee.some(vt=>vt.id===oe.id)?Ee.map(vt=>vt.id===oe.id?oe:vt):[...Ee,oe]).slice().sort((vt,Rt)=>Number(vt.number)-Number(Rt.number))),Pe.startTransition(()=>{l(oe),Re(!1)}),e({title:"Mesa criada",description:`Mesa ${Oe.numero} adicionada`,variant:"success"}),ve(""),re("")}catch(Ce){e({title:"Falha ao criar mesa",description:Ce?.message||"Tente novamente",variant:"destructive"})}finally{me(!1)}};return a.jsx(mn,{open:ue,onOpenChange:Ce=>{Re(Ce),Ce||(ve(""),re(""))},children:a.jsxs(un,{className:"sm:max-w-md w-[92vw]",children:[a.jsxs(on,{children:[a.jsx(an,{className:"text-2xl font-bold",children:"Nova Mesa"}),a.jsx(Nn,{children:"Informe o nome da mesa. Se deixar em branco, ser criada com numerao automtica."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(qe,{htmlFor:"nova-mesa-nome",children:"Nome da mesa"}),a.jsx(rt,{id:"nova-mesa-nome",type:"text",placeholder:"Ex: Mesa 1, Varanda, etc.",value:G,onChange:Ce=>re(Ce.target.value),onKeyDown:Ce=>{Ce.stopPropagation(),Ce.key==="Enter"&&!ce&&(Ce.preventDefault(),we())},onKeyPress:Ce=>Ce.stopPropagation()})]}),a.jsxs(Qn,{children:[a.jsx(fe,{type:"button",variant:"outline",onClick:()=>Re(!1),disabled:ce,children:"Cancelar"}),a.jsx(fe,{type:"button",onClick:we,disabled:ce,children:ce?"Criando...":"Criar Mesa"})]})]})})},Kr=async J=>{try{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de adicionar produtos.",variant:"warning"});return}if(!i?.comandaId){e({title:"Selecione uma mesa",description:"Abra a comanda clicando na mesa primeiro.",variant:"destructive"});return}const ve=Number(J.stock??J.currentStock??0),G=y.get(String(J.id))||0,re=Math.max(0,ve-G);if(((i?.order||[]).find(At=>String(At.productId)===String(J.id))?.quantity||0)+1>re){e({title:"Estoque insuficiente",description:`${J.name} - Estoque disponvel: ${re} (${ve} total, ${G} reservado em outras comandas)`,variant:"destructive"});return}const ke=Number(J.salePrice??J.price??0),oe=(await io({comandaId:i.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).find(At=>String(At.produto_id)===String(J.id));let Ee;if(oe){const At=Number(oe.quantidade||0);await dd({itemId:oe.id,quantidade:At+1,codigoEmpresa:t?.codigo_empresa}),Ee={id:oe.id,productId:oe.produto_id,name:oe.descricao||J.name,price:ke,quantity:At+1}}else Ee=await $T({comandaId:i.comandaId,produtoId:J.id,descricao:J.name,quantidade:1,precoUnitario:ke,codigoEmpresa:t?.codigo_empresa});const tt=(await io({comandaId:i.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(At=>({id:At.id,productId:At.produto_id,name:At.descricao||"Item",price:Number(At.preco_unitario||0),quantity:Number(At.quantidade||1)})),vt=(tt||[]).reduce((At,Gt)=>At+Number(Gt.price||0)*Number(Gt.quantity||0),0),Rt={...i,order:tt,totalHint:vt};l(Rt),o(At=>At.map(Gt=>Gt.id===Rt.id?Rt:Gt));try{const At=await Hm({codigoEmpresa:t?.codigo_empresa}),Gt=new Map;for(const Bt of At||[]){const Ht=String(Bt.produto_id),jr=Number(Bt.quantidade||0);Gt.set(Ht,(Gt.get(Ht)||0)+jr)}x(Gt)}catch(At){console.error("[addProductToComanda] Erro ao atualizar estoque reservado:",At)}yt(J.id),setTimeout(()=>{yt(At=>At===J.id?null:At)},500),e({title:"Produto adicionado",variant:"success"})}catch(ve){console.error("[addProductToComanda] EXCEPTION:",ve),e({title:"Falha ao adicionar produto",description:ve?.message||"Tente novamente",variant:"destructive"})}},Pn=()=>{const[J,ve]=p.useState(""),[G,re]=p.useState("all"),we=p.useRef(null),Ce=p.useRef(0),ke=p.useRef(null),oe=(te||[]).slice().sort((Ee,Ie)=>{const tt=Ee.code||"",vt=Ie.code||"";return/^\d+$/.test(tt)&&/^\d+$/.test(vt)?parseInt(tt,10)-parseInt(vt,10):tt.localeCompare(vt)}).filter(Ee=>{const Ie=J.trim().toLowerCase(),tt=!Ie||(Ee.name||"").toLowerCase().includes(Ie)||String(Ee.code||"").toLowerCase().includes(Ie);if(G==="all")return tt;const vt=Number(Ee.stock??Ee.currentStock??0),Rt=y.get(String(Ee.id))||0,At=Math.max(0,vt-Rt);return G==="available"?tt&&At>0:G==="low"?tt&&At>0&&At<=5:G==="out"?tt&&At<=0:tt});return i?a.jsx(mn,{open:b,onOpenChange:Ee=>{if(w(Ee),A(Ee?"panel":"tables"),Ee)try{dr(!1)}catch{}},children:a.jsxs(un,{overlayClassName:"z-[88]",className:"w-[95vw] sm:max-w-4xl max-h-[80vh] sm:max-h-[85vh] flex flex-col p-0 gap-0 focus:outline-none focus-visible:outline-none !overflow-visible z-[89]",style:{scrollBehavior:"auto"},onOpenAutoFocus:Ee=>{Ee.preventDefault(),A("panel")},onWheel:Ee=>{Ee.stopPropagation()},onKeyDown:Ee=>{const Ie=Ee.target,tt=Ie&&(Ie.tagName==="INPUT"||Ie.closest("input")),vt=Ie&&Ie.closest("[data-product-card]");if(!["ArrowDown","ArrowUp","Home","End","Enter","Delete","Escape"].includes(Ee.key)||tt||vt)return;Ee.preventDefault(),Ee.stopPropagation();const Rt=S||0,At=oe.length;if(Ee.key==="ArrowDown"){const Gt=Math.min(Rt+1,At-1);C(Gt),Ce.current=Gt,requestAnimationFrame(()=>j.current[Gt]?.focus());return}if(Ee.key==="ArrowUp"){const Gt=Math.max(Rt-1,0);C(Gt),Ce.current=Gt,requestAnimationFrame(()=>j.current[Gt]?.focus());return}if(Ee.key==="Home"){C(0),Ce.current=0,requestAnimationFrame(()=>j.current[0]?.focus());return}if(Ee.key==="End"){const Gt=Math.max(0,At-1);C(Gt),Ce.current=Gt,requestAnimationFrame(()=>j.current[Gt]?.focus());return}if(Ee.key==="Escape"){w(!1);return}},children:[a.jsxs(on,{className:"px-6 py-4 border-b border-border",children:[a.jsxs(an,{className:"text-2xl font-bold flex items-center gap-3",children:[a.jsx(lx,{className:"w-6 h-6 text-brand"}),"Adicionar Produtos"]}),a.jsxs(Nn,{className:"text-base mt-2",children:["Mesa ",i.number,"  ",He(i.customer)||"Sem cliente"]})]}),a.jsxs("div",{className:"flex flex-col flex-1 min-h-0",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-border bg-surface/50",children:[a.jsxs("div",{className:"relative",children:[a.jsx(Zs,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-text-muted"}),a.jsx("input",{ref:we,type:"text",className:"w-full pl-10 pr-4 py-3 text-base rounded-lg bg-background border-2 border-border focus:border-brand focus:ring-2 focus:ring-brand/20 transition-all outline-none",placeholder:"Digite o nome ou cdigo do produto...",value:J,onChange:Ee=>ve(Ee.target.value),onClick:Ee=>{Ee.stopPropagation(),Ee.currentTarget.focus(),A("panel")},onFocus:Ee=>{Ee.stopPropagation(),A("panel")},onKeyDown:Ee=>{if(Ee.stopPropagation(),Ee.nativeEvent&&typeof Ee.nativeEvent.stopImmediatePropagation=="function"&&Ee.nativeEvent.stopImmediatePropagation(),A("panel"),["ArrowDown","ArrowUp","Home","End","Escape"].includes(Ee.key)){Ee.preventDefault();const Ie=S||0,tt=oe.length;if(Ee.key==="ArrowDown"){C(Math.min(Ie+1,tt-1));return}if(Ee.key==="ArrowUp"){C(Math.max(Ie-1,0));return}if(Ee.key==="Home"){C(0);return}if(Ee.key==="End"){C(tt-1);return}if(Ee.key==="Escape"){w(!1);return}}}})]}),a.jsxs("div",{className:"flex items-center justify-between gap-4 mt-3",children:[a.jsx("button",{onClick:()=>re("all"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${G==="all"?"bg-brand text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Todos"}),a.jsx("button",{onClick:()=>re("available"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${G==="available"?"bg-success text-white":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Disponvel"}),a.jsx("button",{onClick:()=>re("low"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${G==="low"?"bg-warning text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Estoque Baixo"}),a.jsx("button",{onClick:()=>re("out"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${G==="out"?"bg-destructive text-white":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Sem Estoque"}),a.jsxs("div",{className:"hidden sm:flex items-center gap-2 ml-auto text-xs text-text-muted flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface border border-border rounded text-xs font-mono",children:""}),a.jsx("span",{children:"Navegar"})]}),a.jsx("div",{className:"w-px h-3 bg-border"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface border border-border rounded text-xs font-mono",children:"Esc"}),a.jsx("span",{children:"Fechar"})]})]})]})]}),a.jsx("div",{ref:ke,className:"flex-1 overflow-y-auto px-6 py-4 focus:outline-none",tabIndex:-1,onKeyDown:Ee=>{["ArrowDown","ArrowUp","Home","End","PageDown","PageUp","Space"].includes(Ee.key)&&(Ee.preventDefault(),Ee.stopPropagation(),Ee.nativeEvent&&typeof Ee.nativeEvent.stopImmediatePropagation=="function"&&Ee.nativeEvent.stopImmediatePropagation()),Ee.stopPropagation();const Ie=Ee.target,tt=Ie&&(Ie.tagName==="INPUT"||Ie.closest("input"));if(!["ArrowDown","ArrowUp","Home","End","Escape"].includes(Ee.key)||tt)return;const vt=S||0,Rt=oe.length;if(Ee.key==="ArrowDown"){const At=Math.min(vt+1,Rt-1);C(At),Ce.current=At,requestAnimationFrame(()=>j.current[At]?.focus());return}if(Ee.key==="ArrowUp"){const At=Math.max(vt-1,0);C(At),Ce.current=At,requestAnimationFrame(()=>j.current[At]?.focus());return}if(Ee.key==="Home"){C(0),Ce.current=0,requestAnimationFrame(()=>j.current[0]?.focus());return}if(Ee.key==="End"){const At=Math.max(0,Rt-1);C(At),Ce.current=At,requestAnimationFrame(()=>j.current[At]?.focus());return}if(Ee.key==="Escape"){w(!1);return}},children:oe.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center py-12",children:[a.jsx(lx,{className:"w-16 h-16 text-text-muted mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Nenhum produto encontrado"}),a.jsx("p",{className:"text-text-muted mb-4",children:"Tente ajustar sua busca ou cadastre novos produtos"}),a.jsxs(fe,{onClick:()=>{w(!1),n("/produtos")},children:[a.jsx(Ja,{className:"w-4 h-4 mr-2"}),"Cadastrar Produtos"]})]}):a.jsx("div",{className:"flex flex-col gap-1.5",children:oe.map((Ee,Ie)=>{const tt=(i?.order||[]).reduce((Ht,jr)=>Ht+(String(jr.productId)===String(Ee.id)?Number(jr.quantity||0):0),0),vt=Number(Ee.stock??Ee.currentStock??0),Rt=y.get(String(Ee.id))||0,At=Math.max(0,vt-Rt),Gt=Ie===S,Bt=Ee.id===jt;return a.jsxs("div",{ref:Ht=>{j.current[Ie]=Ht},"data-product-card":!0,className:pr("flex items-center gap-2 sm:gap-4 p-2.5 sm:p-3 rounded-lg border-2 transition-colors duration-500 outline-none focus:outline-none focus-visible:outline-none",At===0&&tt===0?"opacity-50 cursor-not-allowed bg-surface-2 border-border":"cursor-pointer",Gt?"border-brand bg-brand/5 shadow-md":At>0?"border-border bg-surface hover:border-brand/50 hover:bg-surface-2":tt>0?"border-border bg-surface":"border-border",Bt&&"bg-brand/8"),tabIndex:At>0||tt>0?0:-1,onKeyDown:Ht=>{if(["ArrowDown","ArrowUp","Home","End","PageDown","PageUp","Space"].includes(Ht.key)&&(Ht.preventDefault(),Ht.stopPropagation(),Ht.nativeEvent&&typeof Ht.nativeEvent.stopImmediatePropagation=="function"&&Ht.nativeEvent.stopImmediatePropagation()),!["ArrowDown","ArrowUp","Home","End","Escape"].includes(Ht.key))return;Ht.stopPropagation();const jr=oe.length;if(Ht.key==="ArrowDown"){const vr=Math.min(Ie+1,jr-1);C(vr),Ce.current=vr,requestAnimationFrame(()=>j.current[vr]?.focus());return}if(Ht.key==="ArrowUp"){const vr=Math.max(Ie-1,0);C(vr),Ce.current=vr,requestAnimationFrame(()=>j.current[vr]?.focus());return}if(Ht.key==="Home"){C(0),Ce.current=0,requestAnimationFrame(()=>j.current[0]?.focus());return}if(Ht.key==="End"){const vr=Math.max(0,jr-1);C(vr),Ce.current=vr,requestAnimationFrame(()=>j.current[vr]?.focus());return}if(Ht.key==="Escape"){w(!1);return}},onClick:()=>{At===0&&tt===0||(C(Ie),Ce.current=Ie,requestAnimationFrame(()=>j.current[Ie]?.focus()))},onMouseDown:Ht=>{if(At===0&&tt===0){Ht.preventDefault();return}Ht.currentTarget.focus()},children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[Ee.code&&a.jsx("span",{className:"px-2 py-0.5 text-xs font-mono font-semibold bg-surface-2 border border-border rounded",children:Ee.code}),a.jsx("h4",{className:"font-semibold text-sm sm:text-base text-text-primary truncate",children:Ee.name})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-[11px] sm:text-xs mt-0.5",children:[a.jsx("span",{className:pr("font-bold",At===0?"text-text-muted":"text-brand"),children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(Ee.salePrice??Ee.price??0))}),a.jsxs("span",{className:"text-text-muted whitespace-nowrap",children:["Estoque: ",a.jsx("span",{className:pr("font-semibold",At<=5?"text-destructive":"text-text-secondary"),children:At})]}),tt>0&&a.jsxs("span",{className:"px-2 py-0.5 bg-brand/10 text-brand text-[11px] font-semibold rounded whitespace-nowrap",children:[tt,"x na comanda"]})]})]}),a.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[a.jsx(fe,{size:"icon",variant:"outline",onClick:Ht=>{Ht.stopPropagation(),zt(Ee)},disabled:tt===0,className:"h-8 w-8 p-0",children:a.jsx(Vv,{className:"w-4 h-4"})}),a.jsx(fe,{size:"icon",onClick:Ht=>{Ht.stopPropagation(),Kr(Ee)},disabled:At===0,className:"h-8 w-8 p-0 bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",children:a.jsx(Ja,{className:"w-4 h-4"})})]})]},Ee.id)})},(i?.order||[]).map(Ee=>`${String(Ee.productId)}:${Number(Ee.quantity||0)}`).join("|"))}),a.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 border-t border-border bg-surface/50",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-2",children:[a.jsxs("div",{className:"hidden sm:block text-sm text-text-muted",children:[oe.length," produto",oe.length!==1?"s":"","  ",(i.order||[]).length," ite",(i.order||[]).length!==1?"ns":"m"," na comanda"]}),a.jsxs("div",{className:"flex items-center justify-end gap-3 w-full sm:w-auto",children:[a.jsxs("div",{className:"text-left sm:text-right",children:[a.jsx("div",{className:"text-xs text-text-muted",children:"Total"}),a.jsx("div",{className:"text-lg sm:text-xl font-bold text-green-600",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(i.totalHint||0)})]}),a.jsx(fe,{onClick:()=>w(!1),className:"px-4 sm:px-6 min-w-[96px] sm:min-w-[120px]",size:"sm",children:"Concluir"})]})]})})]})]})}):null},[qn,zn]=p.useState(null),[sn,qr]=p.useState([]),[Sa,_a]=p.useState(!1),[da,Xs]=p.useState(""),[Ys,Za]=p.useState(!1),[ol,hs]=p.useState([]),[fc,mc]=p.useState(!1),[Ui,Bo]=p.useState(null),[Ll,Bd]=p.useState([]),[qs,Qc]=p.useState(!1),[Fl,il]=p.useState(null),zs=p.useRef(null);p.useEffect(()=>{zs.current=qn},[qn]);const Si=p.useMemo(()=>{const J=new Map;for(const ve of sn||[]){const G=ve.productId,re=Number(ve.quantity||0);J.set(G,(J.get(G)||0)+re)}return J},[sn]),qo=async J=>{if(!J)return;const G=(await io({comandaId:J,codigoEmpresa:t?.codigo_empresa})||[]).map(re=>({id:re.id,productId:re.produto_id,name:re.descricao||"Item",price:Number(re.preco_unitario||0),quantity:Number(re.quantidade||1)}));qr(G)},hc=async J=>{try{const ve=t?.codigo_empresa;if(!ve){e({title:"Empresa no definida",description:"Faa login novamente.",variant:"destructive"});return}let G=qn;if(!G){if(G=(await m_({codigoEmpresa:ve}))?.id,!G){e({title:"Falha ao iniciar venda no balco",description:"No foi possvel criar ou recuperar a comanda.",variant:"destructive"});return}zn(G)}const re=Number(J.salePrice??J.price??0);await $T({comandaId:G,produtoId:J.id,descricao:J.name,quantidade:1,precoUnitario:re,codigoEmpresa:ve}),await qo(G),e({title:"Produto adicionado (balco)",description:J.name,variant:"success"})}catch(ve){e({title:"Falha ao adicionar produto (balco)",description:ve?.message||"Tente novamente",variant:"destructive"})}},$l=async J=>{if(!(!qn||!J)){Za(!1);try{await _b({comandaId:qn,clienteIds:[J],nomesLivres:[],codigoEmpresa:t?.codigo_empresa}),Bo(J),Bd(ve=>{const G=new Set((ve||[]).map(re=>String(re)));return G.add(String(J)),Array.from(G)}),Xs(""),hs([]),e({title:"Cliente associado",variant:"success"})}catch(ve){e({title:"Falha ao associar cliente",description:ve?.message||"Tente novamente",variant:"destructive"}),Za(!0)}}},hf=async()=>{if(qn)try{const J=Dn(sn,null);if(J<=0){e({title:"Sem itens",description:"Adicione itens antes de pagar.",variant:"warning"});return}_a(!0),await Of({codigoEmpresa:t?.codigo_empresa});let ve=Ue;if(!Array.isArray(ve)||ve.length===0)try{ve=await th({somenteAtivas:!0,codigoEmpresa:t?.codigo_empresa}),ze(ve)}catch{}const G=ve?.[0],re=G?.tipo||G?.nome||"outros";await eR({comandaId:qn,finalizadoraId:G?.id,metodo:re,valor:J,codigoEmpresa:t?.codigo_empresa}),await d0({comandaId:qn,codigoEmpresa:t?.codigo_empresa}),e({title:"Pagamento registrado (balco)",description:`R$ ${J.toFixed(2)}`,variant:"success"}),qr([]),zn(null),m(!1)}catch(J){e({title:"Falha no pagamento (balco)",description:J?.message||"Tente novamente",variant:"destructive"})}finally{_a(!1)}},oi=()=>{p.useEffect(()=>{let ve=!0;return(async()=>{if(h)try{_a(!0);const re=t?.codigo_empresa;if(!re){ve&&e({title:"Empresa no definida",description:"Faa login novamente.",variant:"destructive"});return}const we=await ex({codigoEmpresa:re});if(!ve)return;if(we?.id){zn(we.id),await qo(we.id);try{const Ce=await ui({comandaId:we.id,codigoEmpresa:re}),ke=(Ce||[]).map(oe=>oe?.cliente_id).filter(Boolean).map(oe=>String(oe));Bd(ke);const Oe=Array.isArray(Ce)&&Ce.length>0?Ce[0]:null;Oe?.cliente_id&&Bo(Oe.cliente_id)}catch{}}else zn(null),qr([])}catch(re){ve&&e({title:"Falha ao abrir Modo Balco",description:re?.message||"Tente novamente",variant:"destructive"})}finally{ve&&_a(!1)}})(),()=>{ve=!1}},[h]),p.useEffect(()=>{if(!Ys)return;let ve=!0;const re=setTimeout(async()=>{try{mc(!0);const we=await jb({searchTerm:da,limit:20,codigoEmpresa:t?.codigo_empresa});ve&&hs(we||[])}catch{ve&&hs([])}finally{ve&&mc(!1)}},250);return()=>{ve=!1,clearTimeout(re)}},[Ys,da]);const J=Dn(sn,null);return a.jsx(mn,{open:h,onOpenChange:m,children:a.jsxs(un,{className:"max-w-4xl h-[90vh]",onKeyDown:ve=>ve.stopPropagation(),onKeyDownCapture:ve=>ve.stopPropagation(),onPointerDownOutside:ve=>ve.stopPropagation(),onInteractOutside:ve=>ve.stopPropagation(),children:[a.jsxs(on,{children:[a.jsx(an,{className:"text-2xl font-bold",children:"Modo Balco"}),a.jsx(Nn,{children:"Venda rpida para clientes sem mesa."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-6 h-full overflow-hidden pt-4",children:[a.jsxs("div",{className:"col-span-1 flex flex-col border-r border-border pr-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Catlogo de Produtos"}),a.jsx(fe,{variant:"outline",size:"sm",onClick:()=>Za(!0),children:Ui?a.jsxs(a.Fragment,{children:[a.jsx(Ro,{className:"mr-1 h-4 w-4 text-success"})," Cliente"]}):"Cliente"})]}),a.jsxs("div",{className:"relative mb-4",children:[a.jsx(Zs,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(rt,{placeholder:"Buscar produto...",className:"pl-9",value:da,onChange:ve=>Xs(ve.target.value),ref:_})]}),a.jsx("div",{className:"flex-1 overflow-y-auto -mr-4 pr-4 thin-scroll",children:a.jsxs("ul",{className:"space-y-2",children:[(te||[]).filter(ve=>{const G=da.trim().toLowerCase();return G?(ve.name||"").toLowerCase().includes(G)||(ve.code||"").toLowerCase().includes(G):!0}).sort((ve,G)=>{const re=ve.code||"",we=G.code||"";return/^\d+$/.test(re)&&/^\d+$/.test(we)?parseInt(re,10)-parseInt(we,10):re.localeCompare(we)}).map(ve=>{const G=(sn||[]).reduce((ke,Oe)=>ke+(String(Oe.productId)===String(ve.id)?Number(Oe.quantity||0):0),0),re=Number(ve.stock??ve.currentStock??0),we=y.get(String(ve.id))||0,Ce=Math.max(0,re-we);return a.jsxs("li",{className:"flex items-center p-2 rounded-md hover:bg-surface-2 transition-colors",onClick:()=>{il(ve),Qc(!0)},children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("p",{className:"font-semibold truncate",title:`${ve.code?`[${ve.code}] `:""}${ve.name}`,children:[ve.code&&a.jsxs("span",{className:"text-text-muted",children:["[",ve.code,"]"]})," ",ve.name]}),G>0&&a.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-brand/15 text-brand border border-brand/30 flex-shrink-0",children:["x",G]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("p",{className:"text-sm text-text-muted",children:["R$ ",Number(ve.salePrice??ve.price??0).toFixed(2)]}),a.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-surface-2 text-text-secondary border border-border flex-shrink-0",children:["Qtd ",Ce]})]})]}),a.jsx(fe,{size:"icon",className:"flex-shrink-0 bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",onClick:ke=>{ke.stopPropagation(),hc(ve)},"aria-label":`Adicionar ${ve.name}`,children:a.jsx(Ja,{size:16})})]},ve.id)}),(!te||te.length===0)&&a.jsxs("li",{className:"text-center text-text-muted py-8",children:[a.jsx("div",{className:"mb-3",children:"Nenhum produto cadastrado. Cadastre produtos para vender no balco."}),a.jsx(fe,{size:"sm",onClick:()=>n("/produtos"),children:"Cadastrar Produtos"})]})]})})]}),a.jsxs("div",{className:"col-span-1 flex flex-col",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Comanda do Balco"}),a.jsx("div",{className:"flex-1 overflow-y-auto bg-surface-2 rounded-lg p-4 thin-scroll",children:sn.length===0?a.jsx("p",{className:"text-center text-text-muted pt-16",children:"Adicione produtos  comanda."}):a.jsx("ul",{className:"divide-y divide-border",children:sn.map(ve=>a.jsxs("li",{className:"py-2 flex items-center justify-between gap-4",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"font-medium truncate",children:ve.name}),a.jsxs("div",{className:"text-xs text-text-muted",children:["Qtd: ",ve.quantity,"  Unit: R$ ",Number(ve.price||0).toFixed(2)]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"font-semibold mr-2",children:["R$ ",(Number(ve.price||0)*Number(ve.quantity||0)).toFixed(2)]}),a.jsx(fe,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:async()=>{const G=Number(ve.quantity||1)-1;if(G<=0)B(ve),pe(!0),setTimeout(async()=>{Q||await qo(qn)},100);else try{await dd({itemId:ve.id,quantidade:G,codigoEmpresa:t?.codigo_empresa}),await qo(qn)}catch(re){e({title:"Falha ao atualizar",description:re?.message||"Tente novamente",variant:"destructive"})}},children:a.jsx(Vv,{size:14})}),a.jsx("span",{className:"w-8 text-center font-semibold",children:ve.quantity}),a.jsx(fe,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:async()=>{try{await dd({itemId:ve.id,quantidade:Number(ve.quantity||1)+1,codigoEmpresa:t?.codigo_empresa}),await qo(qn)}catch(G){e({title:"Falha ao atualizar",description:G?.message||"Tente novamente",variant:"destructive"})}},children:a.jsx(Ja,{size:14})})]})]},ve.id))})}),a.jsxs("div",{className:"p-4 border-t border-border mt-auto",children:[a.jsxs("div",{className:"flex justify-between items-center text-xl font-bold mb-4",children:[a.jsx("span",{children:"Total"}),a.jsxs("span",{children:["R$ ",J.toFixed(2)]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs(au,{children:[a.jsx(Up,{asChild:!0,children:a.jsx(fe,{size:"lg",className:"flex-1 bg-red-600 hover:bg-red-500 text-white border border-red-600/70",children:"Cancelar"})}),a.jsxs(md,{className:"sm:max-w-[420px] animate-none",onKeyDown:ve=>ve.stopPropagation(),children:[a.jsxs(hd,{children:[a.jsx(gd,{children:"Cancelar comanda do balco?"}),a.jsx(vd,{children:"Os itens sero descartados e o balco ser limpo. Esta ao no pode ser desfeita."})]}),a.jsxs(pd,{children:[a.jsx(xd,{children:"Voltar"}),a.jsx(su,{onClick:async()=>{try{if(!qn){m(!1);return}await wz({comandaId:qn,codigoEmpresa:t?.codigo_empresa}),qr([]),zn(null),m(!1),e({title:"Comanda cancelada (balco)",variant:"success"})}catch(ve){e({title:"Falha ao cancelar",description:ve?.message||"Tente novamente",variant:"destructive"})}},children:"Confirmar Cancelamento"})]})]})]}),a.jsxs(fe,{size:"lg",className:"flex-1",onClick:hf,disabled:Sa||J<=0,children:[a.jsx(ei,{className:"mr-2"})," Finalizar Pagamento"]})]})]})]})]}),Ys&&a.jsx("div",{className:"absolute inset-0 bg-background/80 backdrop-blur-sm flex items-center justify-center",onClick:ve=>{ve.target===ve.currentTarget&&Za(!1)},onKeyDown:ve=>{ve.key==="Escape"&&Za(!1)},children:a.jsxs("div",{className:"bg-surface rounded-lg border border-border shadow-lg w-full max-w-md p-4",role:"dialog","aria-modal":"true",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h4",{className:"text-lg font-semibold",children:"Selecionar Cliente"}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>Za(!1),children:"Fechar"})]}),a.jsxs("div",{className:"relative mb-2",children:[a.jsx(Zs,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(rt,{placeholder:"Nome, e-mail, telefone ou cdigo",className:"pl-9",value:da,onChange:ve=>Xs(ve.target.value)})]}),a.jsx("div",{className:"max-h-64 overflow-auto thin-scroll border rounded-md",children:fc?a.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Carregando clientes..."}):ol.length>0?a.jsx("ul",{children:ol.map(ve=>{const G=Array.isArray(Ll)&&Ll.includes(String(ve.id));return a.jsxs("li",{className:pr("p-2 flex items-center justify-between cursor-pointer hover:bg-surface-2",G&&"bg-surface-2"),onClick:()=>$l(ve.id),children:[a.jsx("div",{children:a.jsxs("div",{className:"font-medium",children:[ve.codigo!=null?String(ve.codigo)+" - ":"",ve.nome]})}),G&&a.jsx(Ro,{size:16,className:"text-success"})]},ve.id)})}):a.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum cliente encontrado."})})]})})]})})},zo=()=>{const J=Fl,ve=J&&Si.get(J.id)||0,G=J?Number(J.salePrice??J.price??0):0,re=we=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(we||0));return a.jsx(mn,{open:qs,onOpenChange:we=>{Qc(we),we||il(null)},children:a.jsxs(un,{className:"sm:max-w-[420px] w-[92vw] max-h-[85vh] flex flex-col animate-none z-[61]",onKeyDown:we=>we.stopPropagation(),onPointerDownOutside:we=>we.stopPropagation(),onInteractOutside:we=>we.stopPropagation(),onEscapeKeyDown:we=>{we.preventDefault(),we.stopPropagation()},children:[a.jsxs(on,{children:[a.jsx(an,{className:"text-xl font-bold break-words",title:J?.name||"",children:J?.name||"Produto"}),a.jsx(Nn,{children:"Detalhes do produto (Balco)."})]}),J?a.jsxs("div",{className:"space-y-3 overflow-y-auto pr-1",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Preo"}),a.jsx("span",{className:"text-sm font-semibold",children:re(G)})]}),J.category?a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Categoria"}),a.jsx("span",{className:"text-sm font-medium",children:J.category})]}):null,a.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[typeof J.stock<"u"&&a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Estoque"}),a.jsx("div",{className:"text-base font-semibold",children:J.stock})]}),typeof J.minStock<"u"&&a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Mnimo"}),a.jsx("div",{className:"text-base font-semibold",children:J.minStock})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Na Comanda"}),a.jsxs("div",{className:"text-base font-semibold",children:["x",ve]})]})]})]}):null,a.jsxs(Qn,{className:"flex items-center justify-between gap-2",children:[a.jsxs(fe,{variant:"ghost",size:"sm",className:"mr-auto inline-flex items-center gap-1",onClick:()=>{J&&n("/produtos",{state:{productId:J.id,productName:J.name}})},children:[a.jsx(Zo,{className:"w-4 h-4"}),a.jsx("span",{children:"Info"})]}),a.jsx(fe,{variant:"outline",onClick:()=>{Qc(!1),il(null)},children:"Fechar"}),a.jsx(fe,{onClick:async()=>{J&&(await hc(J),Qc(!1),il(null))},children:"Adicionar"})]})]})})},hm=()=>{const[J,ve]=p.useState(""),[G,re]=p.useState(!1),[we,Ce]=p.useState([]),[ke,Oe]=p.useState([]),[oe,Ee]=p.useState(0),[Ie,tt]=p.useState(!1),[vt,Rt]=p.useState(0),At=p.useRef([]),Gt=p.useRef(null),Bt=p.useRef(null),Ht=p.useRef(null),jr=p.useRef(null),vr=p.useRef(0),xn=p.useRef(0);p.useEffect(()=>{let Ir=!0;return(async()=>{try{re(!0);const Br=await jb({searchTerm:J,limit:20});if(!Ir)return;const zr=(Br||[]).slice(),en=String(J||"").trim().toLowerCase(),cn=mr=>{const Ur=String(mr?.nome||"").toLowerCase();return en?Ur.startsWith(en)?0:Ur.includes(en)?1:2:2};zr.sort((mr,Ur)=>{const gr=cn(mr),_r=cn(Ur);if(gr!==_r)return gr-_r;const Xt=Number(mr?.codigo||0),Lr=Number(Ur?.codigo||0);return Xt-Lr}),Ce(zr),Rt(0)}catch{if(!Ir)return;Ce([])}finally{Ir&&re(!1)}})(),()=>{Ir=!1}},[J]);const Kn=p.useRef(!1);p.useEffect(()=>{try{ne&&!Kn.current&&(Kn.current=!0,Ht.current&&(Ht.current.scrollTop=0),Gt.current&&(Gt.current.scrollTop=0),Bt.current&&(Bt.current.scrollTop=0)),ne||(Kn.current=!1)}catch{}},[ne]),p.useEffect(()=>{try{ne&&Array.isArray(we)&&we.length>0&&(Rt(0),setTimeout(()=>{try{Gt.current?.focus(),Bt.current&&(Bt.current.scrollTop=0)}catch{}},0))}catch{}},[ne,we.length]);const Un=async(Ir=null)=>{try{if(!Wt)return;bt(!0);const Er=await QGe({mesaId:Wt.id,codigoEmpresa:t?.codigo_empresa}),zr=Array.isArray(Ir)?Ir:ke,en=Array.isArray(zr)?Array.from(new Set(zr)):[];let cn=[],mr=Math.max(0,Number(oe||0));en.length===0&&mr===0&&(mr=1);for(let _r=0;_r<mr;_r++)cn.push("Consumidor");await _b({comandaId:Er.id,clienteIds:en,nomesLivres:cn,codigoEmpresa:t?.codigo_empresa,replace:!0});let Ur=null;try{const _r=await ui({comandaId:Er.id,codigoEmpresa:t?.codigo_empresa}),Lr=(Array.isArray(_r)?_r:[]).map(br=>br?.nome).filter(Boolean);Ur=Lr.length?Lr.join(", "):null}catch(_r){console.error("[confirmOpen] Erro ao buscar vnculos:",_r)}if(!Ur){const _r=Array.isArray(en)?en:[],Xt=Array.isArray(we)?we:[];Ur=_r.length?_r.map(Lr=>Xt.find(br=>br.id===Lr)?.nome).filter(Boolean).join(", "):cn.length>0?cn.join(", "):""}const gr={...Wt,comandaId:Er.id,status:"in-use",customer:Ur||null,order:[]};l(gr),o(_r=>_r.map(Xt=>Xt.id===gr.id?gr:Xt)),await new Promise(_r=>setTimeout(_r,500));try{const _r=await rh(t?.codigo_empresa),Xt=await kc({codigoEmpresa:t?.codigo_empresa}),Lr={},br={},Gr=Array.isArray(Xt)?Xt:[];await Promise.all(Gr.map(async Zr=>{try{const kn=await ui({comandaId:Zr.id,codigoEmpresa:t?.codigo_empresa}),Ca=(Array.isArray(kn)?kn:[]).map(ma=>ma?.nome).filter(Boolean);Lr[Zr.id]=Ca.length?Ca.join(", "):null;const ks=await io({comandaId:Zr.id,codigoEmpresa:t?.codigo_empresa}),ka=(Array.isArray(ks)?ks:[]).reduce((ma,Co)=>{const Js=(Co.quantidade||0)*(Co.preco_unitario||0)-(Co.desconto||0);return ma+Js},0);br[Zr.id]=ka}catch(kn){console.error("[confirmOpen] Erro ao buscar dados da comanda:",kn),Lr[Zr.id]=null,br[Zr.id]=0}}));const yn=(_r||[]).map(Zr=>{const kn=(Xt||[]).find(Ca=>Ca.mesa_id===Zr.id),ya=kn?Lr[kn.id]!==null?Lr[kn.id]:Ur:null;return{id:Zr.id,name:Zr.nome||`Mesa ${Zr.numero}`,status:kn?"in-use":"available",comandaId:kn?.id||null,customer:ya,order:[],totalHint:kn&&br[kn.id]||0,aberto_em:kn?.aberto_em||null}});o(yn)}catch(_r){console.error("[confirmOpen] Erro ao atualizar mesas:",_r)}ie(!1),be(null),wt(""),Oe([]),Ee(0),tt(!1),e({title:"Mesa aberta",description:Ur?`Comanda criada para: ${Ur}`:"Comanda criada.",variant:"success"})}catch(Er){console.error("[confirmOpen] Falha ao abrir mesa:",Er?.message||Er,Er?.stack),e({title:"Falha ao abrir mesa",description:Er?.message||"Tente novamente",variant:"destructive"})}finally{bt(!1)}};return a.jsx(mn,{open:ne,onOpenChange:Ir=>{ie(Ir),Ir||(be(null),wt(""),Oe([]),Ee(0),tt(!1))},children:a.jsxs(un,{className:"w-[95vw] max-w-md h-[560px] max-h-[75vh] flex flex-col animate-none overflow-hidden",onOpenAutoFocus:Ir=>Ir.preventDefault(),onPointerDownOutside:Ir=>{Ir.preventDefault(),Ir.stopPropagation()},onInteractOutside:Ir=>{Ir.preventDefault(),Ir.stopPropagation()},onEscapeKeyDown:Ir=>{Ir.preventDefault(),ie(!1)},onKeyDown:Ir=>{Ir.key==="Escape"&&(Ir.preventDefault(),Ir.stopPropagation(),ie(!1))},ref:Ht,children:[a.jsxs(on,{className:"flex-shrink-0",children:[a.jsxs(an,{className:"text-xl font-bold",children:["Abrir Mesa ",Wt?`#${Wt.number}`:""]}),a.jsx(Nn,{className:"text-sm",children:"Selecione um ou mais clientes para a mesa."})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto thin-scroll min-h-0 space-y-2 py-2",ref:Bt,children:[a.jsxs("div",{children:[a.jsx(qe,{className:"text-sm font-medium mb-1.5 block",children:"Buscar cliente"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(Zs,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(rt,{placeholder:"Nome, telefone ou cdigo",className:"pl-8 h-9 text-sm",value:J,ref:jr,onChange:Ir=>{xn.current=Date.now(),ve(Ir.target.value)},onKeyDown:Ir=>{if(Ir.key==="Enter"){Ir.preventDefault();try{if(Array.isArray(we)&&we.length>0){const Er=Math.min(Math.max(vt||0,0),we.length-1),Br=we[Er];Br?.id&&Oe(zr=>zr.includes(Br.id)?zr.filter(en=>en!==Br.id):[...zr,Br.id])}}catch{}ve(""),setTimeout(()=>{try{Gt.current?.focus()}catch{}},0)}else xn.current=Date.now()}})]}),a.jsx(fe,{type:"button",size:"icon",title:"Cadastrar cliente",className:"h-9 w-9 flex-shrink-0 bg-brand text-black hover:bg-brand/90",onClick:()=>{window.location.href="/clientes"},children:a.jsx(Ja,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"mt-1.5 text-[12px] text-text-muted flex items-center gap-2",children:[a.jsxs("span",{className:"inline-flex items-center gap-1",children:[a.jsx("kbd",{className:"px-1.5 py-0.5 rounded border border-border/70 bg-surface-2",children:""})," seleciona"]}),a.jsxs("span",{className:"inline-flex items-center gap-1",children:[a.jsx("kbd",{className:"px-1.5 py-0.5 rounded border border-border/70 bg-surface-2",children:""})," desmarca"]}),a.jsxs("span",{className:"inline-flex items-center gap-1",children:[a.jsx("kbd",{className:"px-1.5 py-0.5 rounded border border-border/70 bg-surface-2",children:"Enter"})," confirma"]}),a.jsx("span",{className:"inline-flex items-center gap-1",children:"Digite para buscar"})]})]}),a.jsx("div",{className:"min-h-[8px]",children:ke.length>0&&a.jsxs("div",{className:"bg-success/10 border border-success/30 rounded-md p-2.5",children:[a.jsxs("div",{className:"text-xs font-medium text-success mb-1",children:[ke.length," cliente",ke.length>1?"s":""," selecionado",ke.length>1?"s":""]}),a.jsx("div",{className:"text-sm text-text-primary",children:we.filter(Ir=>ke.includes(Ir.id)).map(Ir=>Ir.nome).join(", ")})]})}),a.jsx("div",{className:"border rounded-md focus:outline-none focus:ring-0 focus-visible:outline-none focus-visible:ring-0",role:"listbox","aria-label":"Clientes","aria-activedescendant":we&&we.length>0&&we[vt]&&we[vt].id?`ot-option-${we[vt].id}`:void 0,ref:Gt,tabIndex:0,onKeyDown:Ir=>{try{if(Ir.key&&Ir.key.length===1&&!Ir.ctrlKey&&!Ir.metaKey&&!Ir.altKey||Ir.key==="Backspace"){Ir.preventDefault(),Ir.stopPropagation();let Br=String(J||"");Ir.key==="Backspace"?Br=Br.slice(0,-1):Br+=Ir.key,ve(Br),xn.current=Date.now();try{Bt.current&&(Bt.current.scrollTop=0)}catch{}setTimeout(()=>{try{if(jr.current){jr.current.focus();const zr=Br.length;jr.current.setSelectionRange?.(zr,zr)}}catch{}},0);return}if(["ArrowDown","ArrowUp","Home","End","ArrowRight","ArrowLeft"," "].includes(Ir.key)){let Br=vt||0;const zr=we.length;Ir.key==="ArrowDown"&&(Br=Math.min(Br+1,zr-1)),Ir.key==="ArrowUp"&&(Br=Math.max(Br-1,0)),Ir.key==="Home"&&(Br=0),Ir.key==="End"&&(Br=zr-1),Rt(Br),setTimeout(()=>{try{At.current[Br]?.scrollIntoView({block:"nearest"})}catch{}},0);const en=we[Br],cn=en?.codigo===0;if(Ir.key==="ArrowRight"&&en?.id&&(cn?(tt(!0),Ee(mr=>mr+1)):(wt(""),Oe(mr=>mr.includes(en.id)?mr:[...mr,en.id]))),Ir.key==="ArrowLeft"&&en?.id)if(cn){const mr=Math.max(0,oe-1);Ee(mr),mr===0&&tt(!1)}else Oe(mr=>mr.filter(Ur=>Ur!==en.id));Ir.key===" "&&en?.id&&(wt(""),Oe(mr=>mr.includes(en.id)?mr.filter(Ur=>Ur!==en.id):[...mr,en.id]));return}if(Ir.key==="Enter"){Ir.preventDefault();const Br=Math.min(Math.max(vt||0,0),we.length-1),zr=we[Br];if(Date.now()-xn.current<600||document.activeElement===jr.current||J&&J.length>0){zr?.id&&(wt(""),Oe(mr=>mr.includes(zr.id)?mr.filter(Ur=>Ur!==zr.id):[...mr,zr.id])),ve(""),setTimeout(()=>{try{Gt.current?.focus(),Bt.current&&(Bt.current.scrollTop=0)}catch{}},0);return}if(zr?.id){const mr=ke.includes(zr.id)?ke:[...ke,zr.id];ke.includes(zr.id)||Oe(Ur=>[...Ur,zr.id]),setTimeout(()=>{try{Un(mr)}catch{}},0);return}setTimeout(()=>{try{Un(ke)}catch{}},0);return}}catch{}},children:G?a.jsx("div",{className:"p-3 text-center text-sm text-text-muted",children:"Carregando..."}):we.length>0?a.jsx("ul",{className:"divide-y divide-border",children:we.map((Ir,Er)=>{const Br=Ir.codigo===0,zr=ke.includes(Ir.id),en=Er===(vt||0),cn=Br?oe:0;return a.jsxs("li",{id:`ot-option-${Ir.id}`,ref:mr=>{At.current[Er]=mr},role:"option","aria-selected":en,className:pr("p-2.5 flex items-center gap-2 cursor-pointer transition-colors outline-none focus:outline-none focus-visible:outline-none border border-transparent",Br?"bg-amber-500/5 border-l-2 border-l-amber-500/40":"",zr&&!Br?"bg-success/10 hover:bg-success/15":"hover:bg-surface-2",Ie&&Br?"bg-amber-500/10":"",en?"bg-brand/10":""),onClick:()=>{Br?Ie||(tt(!0),Ee(1)):(wt(""),Oe(mr=>mr.includes(Ir.id)?mr.filter(Ur=>Ur!==Ir.id):[...mr,Ir.id]))},onDoubleClick:()=>{if(!Br){const mr=ke.includes(Ir.id)?ke:[...ke,Ir.id];Oe(mr),setTimeout(()=>{try{Un(mr)}catch{}},0)}},onMouseEnter:()=>{Date.now()-(vr.current||0)>300&&Rt(Er)},tabIndex:-1,children:[a.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[!Br&&a.jsx("span",{className:pr("w-2 h-2 rounded-full flex-shrink-0",zr?"bg-success":en?"bg-brand":"bg-border")}),a.jsxs("div",{className:"font-medium text-sm truncate",children:[Ir.codigo!=null&&Ir.codigo!==0?`${Ir.codigo} - `:"",Ir.nome,Br&&a.jsx("span",{className:"ml-2 text-xs text-amber-600",children:"Cliente Padro"})]})]}),Br?Ie?a.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[a.jsx(fe,{type:"button",size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-red-500/10",onClick:mr=>{mr.stopPropagation();const Ur=Math.max(0,oe-1);Ee(Ur),Ur===0&&tt(!1)},children:a.jsx(Vv,{className:"h-4 w-4"})}),a.jsx("div",{className:"w-8 h-7 flex items-center justify-center bg-surface-2 rounded text-sm font-medium",children:cn}),a.jsx(fe,{type:"button",size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-500/10",onClick:mr=>{mr.stopPropagation(),Ee(Ur=>Ur+1)},children:a.jsx(Ja,{className:"h-4 w-4"})})]}):null:a.jsx("div",{className:"ml-2 flex-shrink-0",children:zr?a.jsx(Ro,{size:18,className:"text-success"}):a.jsx("div",{className:"w-[18px] h-[18px] rounded-full border-2 border-border"})})]},Ir.id)})}):a.jsx("div",{className:"p-4 text-center text-sm text-text-muted",children:"Nenhum cliente encontrado"})})]}),a.jsxs(Qn,{className:"flex-shrink-0 pt-3",children:[a.jsx(fe,{type:"button",variant:"outline",onClick:()=>{ie(!1),be(null),wt(""),Oe([])},children:"Cancelar"}),a.jsx(fe,{onClick:()=>Un(),disabled:!Wt||gt,children:gt?"Abrindo...":"Confirmar Abertura"})]})]})})},pf=()=>{const[J,ve]=p.useState("");return p.useEffect(()=>{ut.current&&ve(ut.current)},[]),a.jsxs(a.Fragment,{children:[a.jsxs(hd,{children:[a.jsx(gd,{children:"Abrir Caixa"}),a.jsx(vd,{children:"Insira o valor inicial (suprimento) para abrir o caixa."})]}),a.jsxs("div",{className:"py-4",children:[a.jsx(qe,{htmlFor:"initial-value",children:"Valor Inicial"}),a.jsxs("div",{className:"relative mt-2",children:[a.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted",children:"R$"}),a.jsx(rt,{id:"initial-value",type:"text",inputMode:"numeric",pattern:"[0-9.,]*",autoComplete:"off",autoCorrect:"off",autoCapitalize:"none",spellCheck:!1,name:"cash-open-initial",placeholder:"0,00",className:"pl-9 font-semibold",value:J,onChange:G=>{const re=(G.target.value||"").replace(/\D/g,""),we=re?Number(re)/100:0,Ce=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(we);ve(Ce),ut.current=Ce},onKeyDown:G=>{G.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(G.key)&&(/^[0-9]$/.test(G.key)||G.preventDefault())},onBeforeInput:G=>{const re=G.data??"";re&&/\D/.test(re)&&G.preventDefault()},onMouseDown:G=>G.stopPropagation()})]})]}),a.jsxs(pd,{children:[a.jsx(xd,{onClick:()=>dt(!1),children:"Cancelar"}),a.jsx(su,{onClick:async()=>{if(!rr){hr(!0);try{const G=String(J).replace(/\./g,"").replace(",","."),re=Number(G)||0;try{localStorage.setItem("cash:opening",String(Date.now()))}catch{}await Of({saldoInicial:re,codigoEmpresa:t?.codigo_empresa}),await Et(),await ee({showToast:!1}),dt(!1),e({title:"Caixa aberto com sucesso!",variant:"success"}),ut.current="",ve("")}catch(G){e({title:"Falha ao abrir caixa",description:G?.message||"Tente novamente",variant:"destructive"})}finally{try{localStorage.removeItem("cash:opening")}catch{}hr(!1)}}},children:"Confirmar Abertura"})]})]})},Es=()=>a.jsxs(au,{open:Me,onOpenChange:dt,children:[a.jsx(Up,{asChild:!0,children:a.jsxs(fe,{variant:"success",size:"sm",disabled:c||rr,onClick:()=>dt(!0),className:"px-3",children:[a.jsx(rG,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 md:hidden",children:"Abrir"}),a.jsx("span",{className:"ml-2 hidden md:inline",children:"Abrir Caixa"}),a.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-emerald-700 border border-emerald-800 rounded shadow-sm",children:"F10"})]})}),a.jsx(md,{className:"sm:max-w-[425px] animate-none",onKeyDown:J=>J.stopPropagation(),onKeyDownCapture:J=>J.stopPropagation(),onEscapeKeyDown:J=>J.preventDefault(),onPointerDownOutside:J=>{J.preventDefault(),J.stopPropagation()},onInteractOutside:J=>{J.preventDefault(),J.stopPropagation()},children:a.jsx(pf,{})})]}),po=()=>{const[J,ve]=p.useState({loading:!1,saldoInicial:0,resumo:null}),[G,re]=p.useState(!1),[we,Ce]=p.useState(!1),[ke,Oe]=p.useState(!1),[oe,Ee]=p.useState(!1),[Ie,tt]=p.useState(""),vt=async()=>{try{ve({loading:!0,saldoInicial:0,resumo:null});const Bt=await nh({codigoEmpresa:t?.codigo_empresa}),Ht=await Yw({codigoEmpresa:t?.codigo_empresa});ve({loading:!1,saldoInicial:Number(Bt?.saldo_inicial||0),resumo:Ht||{totalPorFinalizadora:{}}})}catch{ve({loading:!1,saldoInicial:0,resumo:{totalPorFinalizadora:{}}})}},Rt=J?.resumo?.totalPorFinalizadora||{},At=Object.values(Rt).reduce((Bt,Ht)=>Bt+Number(Ht||0),0),Gt=Number(J.saldoInicial||0)+At;return a.jsxs(a.Fragment,{children:[a.jsxs(au,{open:G,onOpenChange:Bt=>{re(Bt),Bt&&vt()},children:[a.jsx(Up,{asChild:!0,children:a.jsxs(fe,{variant:"destructive",size:"sm",disabled:!c,onClick:()=>re(!0),className:"px-3",children:[a.jsx(Ix,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 md:hidden",children:"Fechar"}),a.jsx("span",{className:"ml-2 hidden md:inline",children:"Fechar Caixa"})]})}),a.jsxs(md,{className:"sm:max-w-[425px] w-[92vw] max-h-[85vh] animate-none",onOpenAutoFocus:Bt=>Bt.preventDefault(),onKeyDown:Bt=>Bt.stopPropagation(),onKeyDownCapture:Bt=>Bt.stopPropagation(),onPointerDownOutside:Bt=>{Bt.preventDefault(),Bt.stopPropagation()},onInteractOutside:Bt=>{Bt.preventDefault(),Bt.stopPropagation()},children:[a.jsxs(hd,{children:[a.jsx(gd,{children:"Fechar Caixa"}),a.jsx(vd,{children:"Confira os valores e confirme o fechamento do caixa. Esta ao  irreversvel."})]}),ke&&a.jsxs("div",{className:"md:hidden mb-2 text-[12px] text-warning bg-warning/10 border border-warning/30 rounded px-2 py-1 flex items-center gap-1",children:[a.jsx(Bc,{className:"h-3.5 w-3.5"}),"Existem comandas abertas. Finalize-as antes de fechar o caixa."]}),J.loading?a.jsx("div",{className:"py-4 text-text-muted",children:"Carregando resumo"}):a.jsxs("div",{className:"py-4 space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Valor Inicial:"})," ",a.jsxs("span",{className:"font-mono",children:["R$ ",Number(J.saldoInicial||0).toFixed(2)]})]}),Object.keys(Rt).length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem pagamentos nesta sesso."}):Object.entries(Rt).map(([Bt,Ht])=>a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("span",{className:"text-text-secondary",children:[String(Bt),":"]})," ",a.jsxs("span",{className:"font-mono",children:["R$ ",Number(Ht||0).toFixed(2)]})]},Bt)),a.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[a.jsx("span",{className:"text-text-primary",children:"Total em Caixa:"})," ",a.jsxs("span",{className:"font-mono text-success",children:["R$ ",Number(Gt||0).toFixed(2)]})]})]}),a.jsxs(pd,{children:[a.jsx(xd,{onClick:()=>re(!1),disabled:oe,children:"Cancelar"}),a.jsx(su,{onClick:()=>{Ce(!0)},disabled:oe,children:"Continuar"})]})]})]}),a.jsx(au,{open:we,onOpenChange:Bt=>{oe||Ce(Bt)},children:a.jsxs(md,{className:"sm:max-w-[425px] w-[92vw] max-h-[85vh] animate-none",onOpenAutoFocus:Bt=>Bt.preventDefault(),onEscapeKeyDown:Bt=>{oe||Bt.preventDefault()},onKeyDown:Bt=>Bt.stopPropagation(),onKeyDownCapture:Bt=>Bt.stopPropagation(),onPointerDownOutside:Bt=>{oe||(Bt.preventDefault(),Bt.stopPropagation())},onInteractOutside:Bt=>{oe||(Bt.preventDefault(),Bt.stopPropagation())},children:[a.jsxs(hd,{children:[a.jsx(gd,{children:"Confirmar Fechamento do Caixa"}),a.jsx(vd,{children:"Informe o saldo final para finalizar o fechamento."})]}),a.jsxs("div",{className:"py-4",children:[a.jsx(qe,{htmlFor:"valor-contado-final",className:"text-sm font-medium text-text-primary mb-2 block",children:"Saldo Final (opcional)"}),a.jsx("input",{id:"valor-contado-final",type:"text",placeholder:"R$ 0,00",value:Ie,onChange:Bt=>{let Ht=Bt.target.value.replace(/\D/g,"");Ht.length>0&&(Ht=(Number(Ht)/100).toFixed(2),Ht=Ht.replace(".",","),Ht="R$ "+Ht),tt(Ht)},className:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-ring"})]}),a.jsxs(pd,{children:[a.jsx(xd,{onClick:()=>{Ce(!1)},disabled:oe,children:"Voltar"}),a.jsx(su,{onClick:async()=>{try{if(oe)return;Ee(!0);const Bt=Number(J.saldoInicial||0)+At,Ht=Ie?Number(Ie.replace(/[^0-9,]/g,"").replace(",",".")):null;await Bre({saldoFinal:Bt,valorFinalDinheiro:Ht,codigoEmpresa:t?.codigo_empresa}),d(!1),typeof requestAnimationFrame=="function"?requestAnimationFrame(()=>{Ce(!1),re(!1),tt(""),e({title:"Caixa fechado!",description:`Saldo final: R$ ${Bt.toFixed(2)}`,duration:4e3})}):(Ce(!1),re(!1),tt(""),e({title:"Caixa fechado!",description:`Saldo final: R$ ${Bt.toFixed(2)}`,duration:4e3})),setTimeout(async()=>{try{await nh({codigoEmpresa:t?.codigo_empresa})}catch{}},0)}catch(Bt){console.error(Bt);const Ht=Bt?.message||"Tente novamente";if(Be){$e(Ht.includes("Existem")?Ht:`Falha ao fechar caixa: ${Ht}`);try{Ce(!1),re(!1)}catch{}typeof requestAnimationFrame=="function"?requestAnimationFrame(()=>{Mr(!0)}):Mr(!0),setTimeout(()=>Mr(!1),2600)}else e({title:"Falha ao fechar caixa",description:Ht,variant:"destructive"})}finally{Ee(!1)}},children:"Confirmar Fechamento"})]})]})})]})},L=()=>{const[J,ve]=p.useState(""),[G,re]=p.useState([]),[we,Ce]=p.useState([]),[ke,Oe]=p.useState(!1),[oe,Ee]=p.useState(new Set),Ie=p.useRef([]),tt=p.useRef(!1),[vt,Rt]=p.useState(0);p.useRef([]);const At=p.useRef(null);p.useRef(0);const[Gt,Bt]=p.useState(!1),[Ht,jr]=p.useState(null),[vr,xn]=p.useState(null),[Kn,Un]=p.useState("");p.useEffect(()=>{let gr=!0;const _r=async()=>{if(!(!ye||!i?.comandaId)&&!(tt.current&&J===""))try{Oe(!0);const Xt=await ui({comandaId:i.comandaId,codigoEmpresa:t?.codigo_empresa});if(!gr)return;const Lr=(Xt||[]).map(yn=>({id:yn.id,cliente_id:yn.cliente_id,nome:yn.nome||"",tipo:yn.tipo||(yn.cliente_id?"cadastrado":"livre")}));Ce(Lr),Ie.current=JSON.parse(JSON.stringify(Lr)),Ee(new Set);const br=await jb({searchTerm:J,limit:50,codigoEmpresa:t?.codigo_empresa});if(!gr)return;const Gr=(br||[]).slice().sort((yn,Zr)=>Number(yn?.codigo||0)-Number(Zr?.codigo||0));re(Gr),Rt(0),tt.current=!0}catch(Xt){console.error("Erro ao carregar clientes:",Xt)}finally{gr&&Oe(!1)}};return ye?(_r(),()=>{gr=!1}):(tt.current=!1,ve(""),()=>{gr=!1})},[ye,i?.comandaId]),p.useEffect(()=>{ye&&Array.isArray(G)&&G.length>0&&(Rt(0),setTimeout(()=>{try{const gr=document.querySelector('[role="dialog"]');if(gr){const _r=gr.querySelector(".overflow-y-auto");_r&&(_r.scrollTop=0)}}catch{}},0))},[ye,G.length]),p.useEffect(()=>(ye&&i?.comandaId?(sr.current=!0,St.current=i.comandaId,Jr.current=gr=>{Ce(gr||[]),Ir(gr||[])}):ye||sr.current&&St.current===i?.comandaId&&(sr.current=!1,St.current=null,Jr.current=null),()=>{ye||(sr.current=!1,St.current=null,Jr.current=null)}),[ye,i?.comandaId]);const Ir=gr=>{try{if(!i?.id)return;const _r=(gr||[]).map(Lr=>Lr?.nome).filter(Boolean),Xt=_r.length?_r.join(", "):null;l(Lr=>Lr&&Lr.id===i.id?{...Lr,customer:Xt}:Lr),o(Lr=>Lr.map(br=>br.id===i.id?{...br,customer:Xt}:br))}catch(_r){console.error("[ManageClientsDialog] Erro ao sincronizar nomes na mesa:",_r)}},Er=()=>{try{console.log("[ManageClientsDialog] addConsumidor clicado")}catch{}i?.comandaId&&(async()=>{try{Oe(!0);const{data:gr,error:_r}=await de.from("comanda_clientes").insert({comanda_id:i.comandaId,nome_livre:"Consumidor",codigo_empresa:t?.codigo_empresa}).select("id, cliente_id, nome_livre").single();if(_r)throw _r;const Xt={id:gr.id,cliente_id:gr.cliente_id,nome:gr.nome_livre||"Consumidor",tipo:"livre"};Ce(Lr=>{const br=[...Lr,Xt];return Ir(br),br}),xn(Xt.id),Un(Xt.nome||"Consumidor")}catch(gr){console.error("[ManageClientsDialog] Erro ao adicionar consumidor:",gr),e({title:"Falha ao adicionar consumidor",description:gr?.message||"Tente novamente",variant:"destructive"})}finally{Oe(!1)}})()},Br=gr=>{try{console.log("[ManageClientsDialog] addClientFromModal clicado:",gr)}catch{}if(!i?.comandaId)return;const _r=G.find(Xt=>Xt.id===gr);_r&&(async()=>{try{Oe(!0);const{data:Xt,error:Lr}=await de.from("comanda_clientes").insert({comanda_id:i.comandaId,cliente_id:gr,codigo_empresa:t?.codigo_empresa}).select("id, cliente_id").single();if(Lr)throw Lr;const br={id:Xt.id,cliente_id:Xt.cliente_id,nome:_r.nome,tipo:"cadastrado"};Ce(Gr=>{const yn=[...Gr,br];return Ir(yn),yn}),Bt(!1)}catch(Xt){console.error("[ManageClientsDialog] Erro ao adicionar cliente:",Xt),e({title:"Falha ao adicionar cliente",description:Xt?.message||"Tente novamente",variant:"destructive"})}finally{Oe(!1)}})()},zr=(gr,_r)=>{const Xt=G.find(br=>br.id===_r);!Xt||!we.find(br=>br.id===gr)||(async()=>{try{if(Oe(!0),String(gr).startsWith("temp-")){const{data:br,error:Gr}=await de.from("comanda_clientes").insert({comanda_id:i.comandaId,cliente_id:_r,codigo_empresa:t?.codigo_empresa}).select("id, cliente_id").single();if(Gr)throw Gr;const yn={id:br.id,cliente_id:br.cliente_id,nome:Xt.nome,tipo:"cadastrado"};Ce(Zr=>{const kn=[...Zr.filter(ya=>ya.id!==gr),yn];return Ir(kn),kn})}else{const{error:br}=await de.from("comanda_clientes").update({cliente_id:_r,nome_livre:null}).eq("id",gr).eq("codigo_empresa",t?.codigo_empresa);if(br)throw br;Ce(Gr=>{const yn=Gr.map(Zr=>Zr.id===gr?{...Zr,cliente_id:_r,nome:Xt.nome,tipo:"cadastrado"}:Zr);return Ir(yn),yn})}jr(null),Bt(!1)}catch(br){console.error("[ManageClientsDialog] Erro ao trocar cliente:",br),e({title:"Falha ao trocar cliente",description:br?.message||"Tente novamente",variant:"destructive"})}finally{Oe(!1)}})()},en=gr=>{if(we.find(Xt=>Xt.id===gr)){if(String(gr).startsWith("temp-")||!i?.comandaId){Ce(Xt=>{const Lr=Xt.filter(br=>br.id!==gr);return Ir(Lr),Lr});return}(async()=>{try{Oe(!0);const{error:Xt}=await de.from("comanda_clientes").delete().eq("id",gr).eq("codigo_empresa",t?.codigo_empresa);if(Xt)throw Xt;Ce(Lr=>{const br=Lr.filter(Gr=>Gr.id!==gr);return Ir(br),br})}catch(Xt){console.error("[ManageClientsDialog] Erro ao remover cliente:",Xt),e({title:"Falha ao remover cliente",description:Xt?.message||"Tente novamente",variant:"destructive"})}finally{Oe(!1)}})()}},cn=gr=>{try{console.log("[ManageClientsDialog] startEditConsumidor clicado:",gr)}catch{}const _r=we.find(Xt=>Xt.id===gr);_r&&(xn(gr),Un(_r.nome||"Consumidor"))},mr=()=>{if(!vr||!i?.comandaId)return;const gr=Kn.trim()||"Consumidor";(async()=>{try{if(Oe(!0),!String(vr).startsWith("temp-")){const{error:_r}=await de.from("comanda_clientes").update({nome_livre:gr}).eq("id",vr).eq("codigo_empresa",t?.codigo_empresa);if(_r)throw _r}Ce(_r=>{const Xt=_r.map(Lr=>Lr.id===vr?{...Lr,nome:gr}:Lr);return Ir(Xt),Xt})}catch(_r){console.error("[ManageClientsDialog] Erro ao salvar consumidor:",_r),e({title:"Falha ao salvar cliente",description:_r?.message||"Tente novamente",variant:"destructive"})}finally{Oe(!1),xn(null),Un("")}})()},Ur=async()=>{Se(!1)};return a.jsxs(mn,{open:ye,onOpenChange:Se,children:[a.jsxs(un,{className:"sm:max-w-[480px] w-[92vw] max-h-[85vh] h-[85vh] animate-none flex flex-col overflow-hidden",onOpenAutoFocus:gr=>gr.preventDefault(),onPointerDownOutside:gr=>{gr.preventDefault(),gr.stopPropagation()},onInteractOutside:gr=>{gr.preventDefault(),gr.stopPropagation()},onEscapeKeyDown:gr=>gr.preventDefault(),children:[a.jsxs(on,{className:"flex-shrink-0",children:[a.jsx(an,{children:"Gerenciar Clientes da Mesa"}),a.jsx(Nn,{children:"Gerencie os clientes vinculados a esta mesa."})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0 space-y-4 thin-scroll",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"text-sm font-medium text-text-primary",children:["Clientes vinculados (",we.length,"):"]}),we.length===0?a.jsx("div",{className:"p-4 text-center text-sm text-text-muted border border-dashed rounded-md",children:"Nenhum cliente vinculado ainda"}):a.jsx("div",{className:"space-y-2",children:we.map(gr=>{const _r=gr.tipo==="livre",Xt=vr===gr.id;return a.jsx("div",{className:pr("flex items-center gap-2 p-2 rounded-md border",_r?"bg-amber-500/10 border-amber-500/30":"bg-surface-2 border-border"),children:Xt?a.jsxs(a.Fragment,{children:[a.jsx(rt,{value:Kn,onChange:Lr=>Un(Lr.target.value),onKeyDown:Lr=>{Lr.key==="Enter"&&mr(),Lr.key==="Escape"&&(xn(null),Un("")),Lr.stopPropagation()},className:"flex-1 h-8",autoFocus:!0}),a.jsx(fe,{size:"sm",onClick:mr,className:"h-8 px-2",children:a.jsx(Ro,{className:"h-4 w-4"})})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:pr("flex-1 text-sm truncate p-1 rounded",_r?"cursor-pointer hover:bg-amber-500/10":"cursor-default"),onClick:()=>_r&&cn(gr.id),title:_r?"Clique para editar":"",children:[a.jsx("span",{children:gr.nome}),_r&&a.jsx("span",{className:"ml-2 text-[11px] px-1.5 py-0.5 rounded bg-amber-500/15 text-amber-600 border border-amber-500/30 align-middle",children:"Cliente Padro"})]}),!_r&&a.jsx(fe,{size:"sm",variant:"ghost",onClick:()=>{jr(gr.id),Bt(!0)},className:"h-7 px-2",title:"Trocar cliente",children:a.jsx(Cl,{className:"h-4 w-4"})}),a.jsx(fe,{size:"sm",variant:"ghost",onClick:()=>en(gr.id),className:"h-7 px-2 text-destructive hover:text-destructive",children:a.jsx(al,{className:"h-4 w-4"})})]})},gr.id)})})]}),a.jsxs(fe,{onClick:()=>{jr(null),Bt(!0)},className:"w-full",size:"sm",children:[a.jsx(Ja,{className:"h-4 w-4 mr-2"}),"Adicionar Cliente"]})]}),a.jsxs(Qn,{children:[a.jsx(fe,{variant:"outline",onClick:()=>Se(!1),disabled:ke,children:"Cancelar"}),a.jsx(fe,{onClick:Ur,disabled:ke,children:ke?"Salvando...":`Confirmar ${oe.size>0?`(${oe.size} alteraes)`:""}`})]})]}),a.jsx(mn,{open:Gt,onOpenChange:Bt,children:a.jsxs(un,{className:"sm:max-w-[500px] max-h-[80vh] flex flex-col",children:[a.jsxs(on,{children:[a.jsx(an,{children:Ht?"Trocar Cliente":"Adicionar Cliente"}),a.jsx(Nn,{children:"Selecione um cliente da lista"})]}),a.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col gap-3",children:[a.jsxs("div",{className:"relative",children:[a.jsx(Zs,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(rt,{placeholder:"Buscar cliente...",className:"pl-9",value:J,onChange:gr=>ve(gr.target.value)})]}),a.jsx("div",{className:"flex-1 border rounded-md overflow-y-auto thin-scroll",role:"listbox","aria-label":"Clientes disponveis",ref:At,tabIndex:0,children:ke?a.jsx("div",{className:"p-4 text-center text-text-muted",children:"Carregando..."}):G.length===0?a.jsx("div",{className:"p-4 text-center text-text-muted",children:"Nenhum cliente encontrado"}):a.jsx("ul",{className:"divide-y divide-border",children:G.map(gr=>{const _r=gr.codigo===0,Xt=we.some(Lr=>Lr.cliente_id===gr.id&&Lr.tipo==="cadastrado");return a.jsxs("li",{className:pr("p-3 cursor-pointer transition-colors flex items-center justify-between",_r?"bg-amber-500/5 hover:bg-amber-500/10":"hover:bg-surface-2"),onClick:()=>{_r?Ht?(jr(null),Bt(!1)):(Er(),Bt(!1)):Ht?zr(Ht,gr.id):Br(gr.id)},children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"font-medium truncate flex items-center gap-2",children:[_r?"Cliente Consumidor":`${gr?.codigo?`${gr.codigo} - `:""}${gr?.nome||""}`,_r&&a.jsx("span",{className:"text-[11px] px-1.5 py-0.5 rounded bg-amber-500/15 text-amber-600 border border-amber-500/30",children:"Cliente Padro"})]}),!_r&&gr.telefone&&a.jsx("div",{className:"text-xs text-text-muted",children:gr.telefone}),_r&&a.jsx("div",{className:"text-xs text-text-muted",children:"Clique para adicionar consumidor"})]}),Xt&&!_r&&a.jsx(Ro,{className:"h-5 w-5 text-success ml-2 flex-shrink-0"})]},gr.id)})})})]}),a.jsx(Qn,{children:a.jsx(fe,{variant:"outline",onClick:()=>Bt(!1),children:"Cancelar"})})]})})]})},ge=()=>{const J=ve=>ve==="available"?"bg-success/10 border-success/30 text-success":ve==="in-use"?"bg-warning/10 border-warning/30 text-warning":ve==="awaiting-payment"?"bg-info/10 border-info/30 text-info":"bg-surface-2 border-border text-text-secondary";return a.jsx("div",{className:"md:hidden space-y-2",children:s.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[a.jsx("div",{className:"text-text-muted mb-4",children:a.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),a.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Nenhuma mesa encontrada"}),a.jsx("p",{className:"text-text-muted mb-4",children:"Crie sua primeira mesa para comear"})]}):s.map(ve=>{const G=Dn(ve.order||[],ve),re=ve.totalHint>0?ve.totalHint:G;return a.jsx("div",{onClick:async()=>{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de gerenciar as mesas.",variant:"warning"});return}await st(ve),ve.status!=="available"&&dr(!0)},className:pr("p-3 rounded-lg border-2 bg-surface transition-all active:scale-[0.98]",J(ve.status),i?.id===ve.id&&"ring-2 ring-brand/60",c?"cursor-pointer":"cursor-not-allowed opacity-60"),children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"flex items-center gap-2 mb-1",children:a.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[a.jsx("h3",{className:"font-bold text-base truncate",children:ve.name||`Mesa ${ve.number}`}),ve.status==="available"&&ve.id===Pt&&a.jsx("kbd",{className:"hidden md:inline px-2 py-1 text-xs font-bold font-mono text-gray-400 bg-transparent border border-gray-300/50 rounded flex-shrink-0",children:"F1"})]})}),ve.status==="in-use"||ve.status==="awaiting-payment"?a.jsxs("div",{className:"space-y-0.5",children:[a.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-text-secondary",children:[a.jsx(Pl,{className:"w-3.5 h-3.5 flex-shrink-0"}),a.jsx("span",{className:"truncate",children:He(ve.customer)||"Sem cliente"})]}),a.jsxs("div",{className:"flex items-center gap-1.5 text-sm font-semibold text-text-primary",children:[a.jsx(ei,{className:"w-3.5 h-3.5 flex-shrink-0"}),a.jsxs("span",{children:["R$ ",re.toFixed(2)]})]})]}):a.jsx("div",{className:"text-xs text-text-muted",children:"Mesa disponvel"})]}),a.jsx("div",{className:"w-12 flex items-center justify-center ml-1 mr-1",children:ve.status==="available"?a.jsx("img",{src:"/mesalivre.png",alt:"Mesa livre",className:"w-10 h-10 object-contain opacity-80"}):a.jsx("img",{src:"/mesaocupada.png",alt:"Mesa ocupada",className:"w-10 h-10 object-contain opacity-80"})}),a.jsx(j0,{className:"w-5 h-5 text-text-muted flex-shrink-0 ml-1"})]})},ve.id)})})},We=()=>i?a.jsx(mn,{open:It,modal:!z,onOpenChange:J=>{!J&&z||(dr(J),J||pt(null),J&&A("tables"))},children:a.jsxs(un,{className:"w-[95vw] sm:max-w-2xl max-h-[85vh] flex flex-col p-0 gap-0 animate-none",children:[a.jsxs("div",{className:"p-4 border-b border-border bg-surface-2",children:[a.jsx("div",{className:"flex items-center justify-between mb-2",children:a.jsx(an,{className:"text-xl font-bold",children:i.name||`Mesa ${i.number}`})}),a.jsx(Nn,{className:"sr-only",children:"Visualizao da comanda e produtos da mesa selecionada"}),(i.status==="in-use"||i.status==="awaiting-payment")&&a.jsxs("div",{className:"flex items-center gap-4 text-sm text-text-secondary",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Pl,{className:"w-4 h-4"}),a.jsx("span",{children:He(i.customer)||"Sem cliente"})]}),i.order&&i.order.length>0&&a.jsxs("div",{className:"flex items-center gap-1 font-semibold text-text-primary",children:[a.jsx(ei,{className:"w-4 h-4"}),a.jsxs("span",{children:["R$ ",(i.totalHint>0?i.totalHint:Dn(i.order||[])).toFixed(2)]})]})]})]}),a.jsxs(Mc,{value:ur,onValueChange:J=>{if(er(J),pt(null),J==="products"&&i){w(!0);try{dr(!1)}catch{}er("order")}},className:"flex flex-col flex-1 min-h-0",children:[a.jsxs(rc,{className:"grid w-full grid-cols-3 m-2 rounded-lg",children:[a.jsx(sa,{value:"order",className:"text-sm flex items-center justify-center gap-2",children:"Comanda"}),a.jsx(sa,{value:"details",className:"text-sm flex items-center justify-center gap-2",children:"Detalhes"}),a.jsxs(sa,{value:"products",className:"text-sm flex items-center justify-center gap-2",onClick:()=>{if(i){w(!0);try{dr(!1)}catch{}}},children:["Produtos",a.jsx("kbd",{className:"hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"P"})]})]}),a.jsx(is,{value:"order",className:"flex-1 overflow-hidden min-h-0 m-0",onKeyDown:J=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(J.key)&&A("tables")},children:a.jsx(Or,{table:i})}),a.jsx(is,{value:"details",className:"flex-1 overflow-hidden min-h-0 m-0",children:a.jsx(Sr,{table:i})})]})]})}):null,mt=()=>{const J=D,ve=J&&Qe.get(J.id)||0,G=J?Number(J.salePrice??J.price??0):0,re=we=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(we||0));return a.jsx(mn,{open:z,onOpenChange:we=>{W(we),we||U(null)},children:a.jsxs(un,{overlayClassName:"z-[70]",className:"sm:max-w-[420px] w-[92vw] max-h-[85vh] flex flex-col animate-none z-[71]",onOpenAutoFocus:we=>{},onKeyDown:we=>we.stopPropagation(),children:[a.jsxs(on,{children:[a.jsx(an,{className:"text-xl font-bold break-words",title:J?.name||"",children:J?.name||"Produto"}),a.jsx(Nn,{children:"Detalhes do produto e aes rpidas."})]}),J?a.jsxs("div",{className:"space-y-3 overflow-y-auto pr-1",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Preo"}),a.jsx("span",{className:"text-sm font-semibold",children:re(G)})]}),J.category?a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Categoria"}),a.jsx("span",{className:"text-sm font-medium",children:J.category})]}):null,a.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[typeof J.stock<"u"&&a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Estoque"}),a.jsx("div",{className:"text-base font-semibold",children:J.stock})]}),typeof J.minStock<"u"&&a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Mnimo"}),a.jsx("div",{className:"text-base font-semibold",children:J.minStock})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Na Comanda"}),a.jsxs("div",{className:"text-base font-semibold",children:["x",ve]})]})]})]}):null,a.jsxs(Qn,{className:"flex items-center justify-between gap-2",children:[a.jsxs(fe,{variant:"ghost",size:"sm",className:"mr-auto inline-flex items-center gap-1",onClick:()=>{J&&n("/produtos",{state:{productId:J.id,productName:J.name}})},children:[a.jsx(Zo,{className:"w-4 h-4"}),a.jsx("span",{children:"Info"})]}),a.jsx(fe,{variant:"outline",onClick:()=>{W(!1),U(null)},children:"Fechar"}),a.jsx(fe,{onClick:async()=>{J&&(await Kr(J),W(!1),U(null))},children:"Adicionar"})]})]})})};return a.jsxs(a.Fragment,{children:[a.jsx(mt,{}),a.jsx(zo,{}),a.jsxs("div",{className:"h-full flex flex-col",children:[a.jsx("div",{className:"md:hidden mb-2 w-full",children:a.jsx(Mc,{value:"mesas",onValueChange:J=>{J==="mesas"&&n("/vendas"),J==="balcao"&&n("/balcao"),J==="historico"&&n("/historico")},children:a.jsxs(rc,{className:"grid w-full grid-cols-3",children:[a.jsx(sa,{value:"mesas",className:"text-xs",title:"Pressione B para alternar",children:"Mesas"}),a.jsx(sa,{value:"balcao",className:"text-xs",title:"Pressione B para alternar",children:"Balco"}),a.jsx(sa,{value:"historico",className:"text-xs",title:"Pressione H para ir ao histrico",children:"Histrico"})]})})}),a.jsxs("div",{className:"flex items-center justify-between mb-2 md:mb-6 gap-2 md:gap-4",children:[a.jsx("div",{className:"hidden md:flex items-center gap-2 md:gap-3",children:a.jsx(Mc,{value:"mesas",onValueChange:J=>{J==="mesas"&&n("/vendas"),J==="balcao"&&n("/balcao"),J==="historico"&&n("/historico")},children:a.jsxs(rc,{className:"inline-flex",children:[a.jsx(sa,{value:"mesas",className:"text-sm",title:"Pressione B para alternar",children:"Mesas"}),a.jsx(sa,{value:"balcao",className:"text-sm",title:"Pressione B para alternar",children:"Balco"}),a.jsx(sa,{value:"historico",className:"text-sm",title:"Pressione H para ir ao histrico",children:"Histrico"})]})})}),a.jsxs("div",{className:"flex items-center gap-1.5 md:gap-3 flex-shrink-0",children:[a.jsx(Es,{}),a.jsx(po,{}),a.jsxs(fe,{variant:"outline",size:"sm",onClick:()=>g(!0),className:"px-3",children:[a.jsx(_4,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 md:hidden",children:"Detalhes"}),a.jsx("span",{className:"ml-2 hidden md:inline",children:"Detalhes do Caixa"}),a.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"F11"})]}),a.jsx("div",{className:"hidden md:block w-px h-6 bg-border mx-1"}),a.jsxs(fe,{onClick:()=>Re(!0),className:"hidden md:flex",size:"sm",children:[a.jsx(Ja,{className:"mr-2 h-4 w-4"})," Nova Mesa",a.jsx("kbd",{className:"ml-2 px-2 py-1 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"F1"})]})]})]}),!c&&u>0&&a.jsxs("div",{className:"md:hidden mb-3 text-[11px] text-warning flex items-center gap-2",children:[a.jsx(Bc,{className:"h-3 w-3"}),"H comandas abertas, mas o caixa parece fechado.",a.jsx(fe,{size:"sm",variant:"outline",className:"h-6 px-2 text-[11px]",onClick:()=>dt(!0),children:"Reabrir sesso"})]}),a.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 overflow-visible min-h-0",children:[a.jsxs("div",{className:"lg:col-span-2 bg-surface rounded-lg border border-border p-4 md:p-6 overflow-y-auto thin-scroll min-h-0",tabIndex:0,onKeyDown:J=>{P==="tables"&&["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(J.key)&&J.preventDefault()},onClick:J=>{J.stopPropagation(),J.preventDefault(),A("tables"),!i&&s.length>0&&l(s[0]),J.currentTarget.focus()},onFocus:()=>{A("tables"),!i&&s.length>0&&l(s[0])},style:{outline:P==="tables"?"2px solid rgba(148, 163, 184, 0.4)":"none",outlineOffset:"-2px",transition:"outline 0.15s ease"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-4 gap-4",children:[a.jsx("h2",{className:"text-xl font-bold",children:"Mapa de Mesas"}),a.jsxs("div",{className:"hidden md:flex items-center gap-2 text-xs text-text-muted flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("kbd",{className:"px-1.5 py-0.5 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:""}),a.jsx("span",{children:"Navegar"})]}),a.jsx("div",{className:"w-px h-3 bg-border"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("kbd",{className:"px-1.5 py-0.5 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"Enter"}),a.jsx("span",{children:"Selecionar"})]})]}),a.jsx(fe,{type:"button",className:"md:hidden h-9 w-9 p-0 bg-amber-400 text-black hover:bg-amber-300 flex-shrink-0",size:"icon",title:"Nova Mesa",onClick:()=>Re(!0),children:a.jsx(Ja,{className:"h-5 w-5"})})]}),a.jsx(ge,{}),a.jsx("div",{className:"hidden md:block",children:a.jsx(eat,{onDragEnd:In,children:a.jsx(Fse,{droppableId:"tables",children:J=>a.jsxs("div",{...J.droppableProps,ref:ve=>{J.innerRef(ve),Mt.current=ve},role:"grid","aria-label":"Lista de mesas",className:"grid gap-5 grid-cols-[repeat(auto-fit,minmax(240px,1fr))]",children:[s.length===0?a.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-12 text-center",children:[a.jsx("div",{className:"text-text-muted mb-4",children:a.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),a.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Nenhuma mesa encontrada"}),a.jsx("p",{className:"text-text-muted mb-4",children:"Crie sua primeira mesa para comear a receber pedidos"}),a.jsxs(fe,{onClick:()=>Re(!0),className:"flex items-center gap-2",children:[a.jsx(Ja,{size:16}),"Criar Nova Mesa"]})]}):s.map((ve,G)=>a.jsx(Lat,{draggableId:ve.id,index:G,children:(re,we)=>a.jsx(Le,{table:ve,provided:re,isDragging:we.isDragging})},ve.id)),J.placeholder]})})})})]}),a.jsx("div",{className:"hidden md:flex bg-surface rounded-lg border border-border flex-col min-h-0 transition-all overflow-hidden",style:{boxShadow:P==="panel"?"inset 0 0 0 2px rgba(148, 163, 184, 0.4)":"none"},children:a.jsxs(Mc,{value:R,onValueChange:J=>{O(J),J==="products"&&i&&(w(!0),O("order"))},className:"flex flex-col h-full",children:[a.jsxs(rc,{className:"grid w-full grid-cols-3 m-2",children:[a.jsx(sa,{value:"order",className:"flex items-center justify-center gap-2 text-xs",children:"Comanda"}),a.jsx(sa,{value:"details",className:"flex items-center justify-center gap-2 text-xs",children:"Detalhes"}),a.jsxs(sa,{value:"products",onClick:()=>{i&&w(!0)},className:"flex items-center justify-center gap-2 text-xs",children:["Produtos",a.jsx("kbd",{className:"hidden md:inline px-1 py-0.5 text-[10px] font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"P"})]})]}),a.jsx(is,{value:"order",className:"flex-1 overflow-hidden min-h-0",children:a.jsx(Or,{table:i})}),a.jsx(is,{value:"details",className:"flex-1 overflow-hidden min-h-0",children:a.jsx(Sr,{table:i})})]})})]})]}),a.jsx(We,{}),a.jsx(oi,{}),a.jsx(lt,{open:v,onOpenChange:g,cashSummary:I}),a.jsx(kt,{}),a.jsx(Vt,{}),ye?a.jsx(L,{}):null,a.jsx(hm,{}),a.jsx(fr,{}),ln&&a.jsx("div",{className:"fixed left-3 right-3 z-[9999]",role:"alert","aria-live":"assertive",style:{bottom:"calc(12px + env(safe-area-inset-bottom, 0px))"},children:a.jsxs("div",{className:"pointer-events-none flex items-start gap-2 rounded-md border border-amber-500 bg-amber-400 text-black px-3 py-2 shadow-lg",children:[a.jsx(Bc,{className:"h-4 w-4 mt-0.5","aria-hidden":"true"}),a.jsx("div",{className:"text-sm font-semibold leading-snug drop-shadow-[0_1px_0_rgba(255,255,255,0.25)]",children:Ye||"Ateno"})]})}),qt&&a.jsx(Yat,{item:qt,onApply:()=>{i&&ot(i)},onClose:()=>{pt(null)},codigoEmpresa:t?.codigo_empresa}),i&&Dt&&a.jsx(Jat,{comanda:i,subtotal:Dn(i.order||[],i),onApply:()=>{i&&ot(i)},onClose:()=>he(!1),codigoEmpresa:t?.codigo_empresa}),(gt||at||Ze)&&a.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/80",children:a.jsxs("div",{className:"px-8 py-6 rounded-xl bg-surface border border-border shadow-2xl flex flex-col items-center gap-4 max-w-sm w-[85vw] text-center",children:[a.jsx("div",{className:"w-8 h-8 rounded-full border-4 border-brand border-t-transparent animate-spin","aria-hidden":"true"}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"block text-base font-semibold text-text-primary",children:gt?"Abrindo mesa...":at?"Cancelando comanda...":"Fechando conta..."}),a.jsx("span",{className:"block text-xs text-text-muted",children:gt?"Aguarde, estamos criando a comanda e sincronizando com os outros dispositivos.":at?"Aguarde, estamos cancelando a comanda e liberando a mesa em todos os dispositivos.":"Aguarde, estamos registrando os pagamentos e liberando a mesa em todos os dispositivos."})]})]})}),p.useMemo(()=>a.jsx(Pn,{},(i?.order||[]).map(J=>`${String(J.productId)}:${Number(J.quantity||0)}`).join("|")),[b,i?.id,i?.order])]})}function est(){const{toast:e}=Qa(),t=zi(),{userProfile:r}=ms(),[n,s]=p.useState(null),[o,i]=p.useState([]),[l,c]=p.useState([]),[d,u]=p.useState(!0),[f,h]=p.useState(!1),[m,v]=p.useState(!1),[g,y]=p.useState(!1),[x,b]=p.useState(""),[w,j]=p.useState(""),[_,S]=p.useState(null),[C,P]=p.useState(null),[A,R]=p.useState(!1),O=p.useRef(!1),[I,M]=p.useState(new Map),[D,U]=p.useState(!1),[z,W]=p.useState(!1),[$,X]=p.useState(!1),[ye,Se]=p.useState(!1),[V,B]=p.useState(null),[Q,pe]=p.useState(!1),[te,Y]=p.useState(!1),[ce,me]=p.useState([]);p.useState(null);const[ae,le]=p.useState(!1),[ue,Re]=p.useState([]),[ne,ie]=p.useState(1),[gt,bt]=p.useState([]),[at,xt]=p.useState(null),[Ze,ht]=p.useState(!1),[Wt,be]=p.useState(null),[Ct,wt]=p.useState(!1),[Ge,Je]=p.useState(""),[_e,je]=p.useState(!1),[Ue,ze]=p.useState(""),[or,tr]=p.useState(()=>{try{return typeof window<"u"&&window.innerWidth<=640}catch{return!1}});p.useEffect(()=>{const ee=()=>{try{tr(typeof window<"u"&&window.innerWidth<=640)}catch{tr(!1)}};return ee(),window.addEventListener("resize",ee),()=>window.removeEventListener("resize",ee)},[]),p.useState("cadastrado");const[Nt,yr]=p.useState(""),[Me,dt]=p.useState([]),[ut,rr]=p.useState([]);p.useState(!1),p.useState(!1);const[hr,It]=p.useState(!1),[dr,ur]=p.useState(!1),[er,ln]=p.useState(0),[Mr,Ye]=p.useState("all"),[$e,Be]=p.useState(()=>{try{return localStorage.getItem("balcao_sort_order")||"code"}catch{return"code"}}),et=p.useRef([]),jt=p.useRef(null),[yt,qt]=p.useState(()=>{try{const ee=localStorage.getItem("balcao_left_panel_width");return ee?parseFloat(ee):50}catch{return 50}}),[pt,Dt]=p.useState(!1),he=p.useRef(null),Qe=p.useRef(0),zt=p.useRef([]);p.useEffect(()=>{zt.current=l},[l]);const Mt=p.useRef(!1);p.useEffect(()=>(Mt.current=!0,()=>{Mt.current=!1}),[]);const ir=p.useRef(null),nr=p.useRef(null),kr=p.useRef(null),Ft=p.useRef(null);p.useEffect(()=>{Ft.current=n},[n]),p.useEffect(()=>{const ee=r?.codigo_empresa;if(!ee)return;try{const K=typeof window<"u"?window.localStorage.getItem("custom-auth-token"):null;if(K&&K.trim())de.realtime.setAuth(K.trim());else{let H="";try{H=(new URL(de.supabaseUrl||"").host||"").split(".")[0]||""}catch{}const F=H?`sb-${H}-auth-token`:"sb-auth-token",Le=typeof window<"u"?window.localStorage.getItem(F):null;if(Le)try{const it=JSON.parse(Le),lt=it?.access_token||it?.currentSession?.access_token;lt&&de.realtime.setAuth(lt)}catch{}}}catch{}const k=de.channel(`loja:${ee}`),T=async K=>{const H=K?.table||K?.table_name||"",F=K?.new||K?.old||{},Le=K?.eventType||K?.type||K?.event||"";try{if(H==="comanda_itens"){const it=K?.new?.comanda_id||K?.old?.comanda_id||F?.comanda_id||null;if(it){const lt=Ft.current;if(lt&&String(lt)===String(it)){try{await fn(lt,2)}catch{}try{const Vt=await Hm({codigoEmpresa:ee}),Ve=new Map;for(const kt of Vt||[])Ve.set(kt.produto_id,(Ve.get(kt.produto_id)||0)+Number(kt.quantidade||0));M(Ve)}catch{}return}try{const Vt=await ex({codigoEmpresa:ee});if(Vt?.id&&String(Vt.id)===String(it)){s(Vt.id);try{await fn(Vt.id,2)}catch{}try{const Ve=await Hm({codigoEmpresa:ee}),kt=new Map;for(const Sr of Ve||[])kt.set(Sr.produto_id,(kt.get(Sr.produto_id)||0)+Number(Sr.quantidade||0));M(kt)}catch{}return}}catch{}}}if(H==="comanda_clientes"){const it=K?.new?.comanda_id||K?.old?.comanda_id||F?.comanda_id||null;if(it&&Ft.current&&String(Ft.current)===String(it)){try{await fn(it,2)}catch{}return}}if(H==="comandas"){const it=F?.mesa_id,lt=F?.id||K?.old?.id||null,Vt=String(F?.status||"").toLowerCase(),Ve=String(Le||"").toUpperCase()==="DELETE"||Vt.includes("fechad")||Vt.includes("closed")||Vt.includes("encerr"),kt=String(Le||"").toUpperCase()==="INSERT";if(Ve&&it==null&&Ft.current&&lt&&String(Ft.current)===String(lt)){c([]),s(null),rr([]),b(""),ur(!1);try{localStorage.removeItem(Qt.comandaId),localStorage.removeItem(Qt.items),localStorage.removeItem(Qt.customerName),localStorage.removeItem(Qt.pendingClientIds),localStorage.removeItem(Qt.clientChosen)}catch{}}if(kt&&it==null&&["open","awaiting-payment","awaiting_payment"].includes(Vt)){s(lt);try{await fn(lt,2)}catch{}}}}catch{}if(nr.current)try{clearTimeout(nr.current)}catch{}nr.current=setTimeout(async()=>{const it=Ft.current;if(it)try{await fn(it,2)}catch{}else try{const lt=await ex({codigoEmpresa:ee});if(lt?.id){s(lt.id);try{await fn(lt.id,2)}catch{}}}catch{}},250)};if(k.on("postgres_changes",{event:"*",schema:"public",table:"comandas",filter:`codigo_empresa=eq.${ee}`},T).on("postgres_changes",{event:"*",schema:"public",table:"comanda_itens"},T).on("postgres_changes",{event:"*",schema:"public",table:"comanda_clientes"},T).subscribe(),ir.current=k,kr.current)try{clearInterval(kr.current)}catch{}return kr.current=setInterval(async()=>{const K=Ft.current;if(K)try{await fn(K,1)}catch{}else try{const H=await ex({codigoEmpresa:ee});if(H?.id){s(H.id);try{await fn(H.id,1)}catch{}}}catch{}},6e4),()=>{if(ir.current){try{de.removeChannel(ir.current)}catch{}ir.current=null}if(nr.current){try{clearTimeout(nr.current)}catch{}nr.current=null}if(kr.current){try{clearInterval(kr.current)}catch{}kr.current=null}}},[r?.codigo_empresa]),p.useEffect(()=>{(l||[]).length>0&&(O.current=!0)},[l]),p.useEffect(()=>{n&&O.current&&(l||[]).length===0&&fn(n,2)},[n,l?.length]),p.useEffect(()=>{if(Q)return;let ee=!0;return(async()=>{try{const k=await nh({codigoEmpresa:r?.codigo_empresa});ee&&U(!!k)}catch{ee&&U(!1)}})(),()=>{ee=!1}},[r?.codigo_empresa,Q]);const Dr=async()=>{const ee=r?.codigo_empresa||null;try{if(!ee)return;Se(!0);const[k,T]=await Promise.all([Yw({codigoEmpresa:ee}).catch(()=>null),nh({codigoEmpresa:ee}).catch(()=>null)]);if(!T?.id){B(null);return}let K=0,H=0,F=[];try{F=await ng({caixaSessaoId:T.id,codigoEmpresa:ee}),K=(F||[]).filter(it=>String(it?.tipo||"").toLowerCase()==="sangria").reduce((it,lt)=>it+Number(lt?.valor||0),0),H=(F||[]).filter(it=>String(it?.tipo||"").toLowerCase()==="suprimento").reduce((it,lt)=>it+Number(lt?.valor||0),0)}catch{}const Le={saldo_inicial:T.saldo_inicial||0,totalPorFinalizadora:k?.totalPorFinalizadora||k?.porFinalizadora||{},totalEntradas:k?.totalEntradas||k?.entradas||0,totalSangria:K,totalSuprimento:H,totalSaidas:K,sessaoId:T.id,movimentacoes:F};B(Le)}catch{B(null)}finally{Se(!1)}};p.useEffect(()=>{let ee=!0;return(async()=>{try{if(!te||!n)return;const T=r?.codigo_empresa;let K=[];try{const Le=await ui({comandaId:n,codigoEmpresa:T});K=(Array.isArray(Le)?Le:[]).map(lt=>{const Vt=lt?.clientes?.id??lt?.cliente_id??lt?.id??null,Ve=lt?.clientes?.nome??lt?.nome??lt?.nome_livre??"";return Vt?{id:Vt,nome:Ve}:null}).filter(Boolean)}catch{K=[]}if(!ee)return;bt(K);const F=Array.isArray(ut)&&ut.length>0?ut:K.map(Le=>Le.id);if(!Array.isArray(F)||F.length===0)return;Re(Le=>{let it=Le&&Le.length?[...Le]:[{id:1,clientId:F[0],methodId:ce[0]?.id||"",value:""}];it[0]||(it[0]={id:1,clientId:F[0],methodId:ce[0]?.id||"",value:""}),it[0].clientId=F[0];const lt=new Set([it[0].clientId].filter(Boolean));for(let Vt=1;Vt<it.length;Vt++){if(!it[Vt].clientId||lt.has(it[Vt].clientId)){const Ve=(F||[]).find(kt=>!lt.has(kt));it[Vt].clientId=Ve||F[0]}lt.add(it[Vt].clientId)}return it})}catch{}})(),()=>{ee=!1}},[te,ut,n,r?.codigo_empresa]);const Fr=ee=>{const k=String(ee||"").replace(/\D/g,"");return k?Number(k)/100:0},Tn=ee=>new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(ee),nt=ee=>(ce||[]).find(k=>String(k.id)===String(ee)),$t=ee=>Number(nt(ee.methodId)?.taxa_percentual||0),Kt=ee=>{const k=Fr(ee.value),T=$t(ee);return!ee.chargeFee||!T?k:k/(1+T/100)},sr=ee=>{const k=Kt(ee),T=$t(ee);return!ee.chargeFee||!T||k<=0?0:k*(T/100)},St=(ee,k)=>{const T=$t(ee);if(ee.chargeFee&&T>0){const K=k*(1+T/100);return{...ee,value:Tn(K)}}return{...ee,value:Tn(k)}},Jr=()=>(ue||[]).reduce((ee,k)=>ee+Kt(k),0),Pt=()=>(ue||[]).reduce((ee,k)=>ee+sr(k),0),lr=()=>Jr()+Pt();p.useEffect(()=>{try{if(!te)return;let ee=0;try{ee=(l||[]).reduce((K,H)=>K+Number(H.quantity||0)*Number(H.price||0),0)}catch{}const k=Jr(),T=ee-k;Math.abs(T)>.009&&Math.abs(T)<=.05&&Array.isArray(ue)&&ue.length>0&&Re(K=>K.map((H,F,Le)=>{if(F!==Le.length-1)return H;const it=Kt(H)+T;return St(H,it)}))}catch{}},[ue,te]);const st=async()=>{try{if(y(!0),!n){e({title:"Nenhuma comanda aberta",description:"Adicione itens para abrir uma comanda.",variant:"warning"});return}const ee=r?.codigo_empresa;if(!ee){e({title:"Empresa no definida",variant:"destructive"});return}try{const{data:H,error:F}=await de.from("comandas").select("id").eq("id",n).eq("codigo_empresa",ee).single();if(F||!H){console.error("[confirmPay] Comanda no encontrada no banco:",n),e({title:"Comanda invlida",description:"A comanda no existe mais. Criando nova comanda...",variant:"warning"}),s(null),c([]);try{localStorage.removeItem(Qt.comandaId),localStorage.removeItem(Qt.items)}catch{}await nn();return}}catch(H){console.error("[confirmPay] Erro ao validar comanda:",H),e({title:"Erro de validao",description:"No foi possvel validar a comanda.",variant:"destructive"});return}if(!Array.isArray(ue)||ue.length===0){e({title:"Informe os pagamentos",description:"Adicione pelo menos uma forma de pagamento.",variant:"warning"});return}for(const H of ue){if(!H.methodId){e({title:"Forma de pagamento faltando",description:"Selecione a finalizadora em todas as linhas.",variant:"warning"});return}if(!String(H.value||"").replace(/\D/g,"")){e({title:"Valor invlido",description:"Informe valores maiores que zero.",variant:"warning"});return}}let k=0;try{k=(await io({comandaId:n,codigoEmpresa:ee})||[]).reduce((F,Le)=>F+Number(Le.quantidade||0)*Number(Le.preco_unitario||0),0)}catch{}const T=Jr(),K=Math.abs(T-k);if(K>.009&&K<=.05){const H=k-T;Re(F=>F.map((Le,it,lt)=>{if(it!==lt.length-1)return Le;const Vt=Kt(Le)+H;return St(Le,Vt)}))}else if(K>.05){const H=k-T;H>0?e({title:"Valor insuficiente",description:`Faltam R$ ${H.toFixed(2)} para fechar o total.`,variant:"warning"}):e({title:"Valor excedente",description:`Excedeu em R$ ${Math.abs(H).toFixed(2)}. Ajuste os valores.`,variant:"warning"});return}le(!0),await Of({codigoEmpresa:ee});for(const H of ue){const F=Fr(H.value),Le=ce.find(lt=>String(lt.id)===String(H.methodId)),it=Le?.nome||Le?.tipo||"outros";await eR({comandaId:n,finalizadoraId:H.methodId,metodo:it,valor:F,status:"Pago",codigoEmpresa:ee,clienteId:H.clientId||null})}await d0({comandaId:n,codigoEmpresa:ee}),s(null),c([]),rr([]),b(""),ur(!1),Re([]);try{localStorage.removeItem(Qt.comandaId),localStorage.removeItem(Qt.items),localStorage.removeItem(Qt.customerName)}catch{}e({title:"Pagamento concludo",description:`Total R$ ${k.toFixed(2)}`,variant:"success"}),Y(!1)}catch(ee){e({title:"Falha ao concluir",description:ee?.message||"Tente novamente",variant:"destructive"})}finally{le(!1),y(!1)}};p.useEffect(()=>{(async()=>{try{if(!z)return;await Dr()}catch{}})()},[z,r?.codigo_empresa]);const Et=()=>{const[ee,k]=p.useState(""),T=p.useRef(null);return p.useEffect(()=>{if(typeof window<"u"&&window.innerWidth<=640)return;const H=setTimeout(()=>{try{T.current?.focus()}catch{}},0);return()=>clearTimeout(H)},[]),a.jsxs(a.Fragment,{children:[a.jsxs(hd,{children:[a.jsx(gd,{children:"Abrir Caixa"}),a.jsx(vd,{children:"Insira o valor inicial (suprimento) para abrir o caixa."})]}),a.jsxs("div",{className:"py-4",children:[a.jsx(qe,{className:"mb-2 block",htmlFor:"open-cash-initial",children:"Saldo inicial"}),a.jsx(rt,{id:"open-cash-initial",ref:T,type:"text",inputMode:"numeric",autoComplete:"off",placeholder:"0,00",value:ee,onChange:K=>{const H=(K.target.value||"").replace(/\D/g,""),F=H?Number(H)/100:0,Le=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(F);k(Le)},onKeyDown:K=>{K.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(K.key)&&(/^[0-9]$/.test(K.key)||K.preventDefault())},onBeforeInput:K=>{const H=K.data??"";H&&/\D/.test(H)&&K.preventDefault()}}),a.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Digite nmeros; a mscara formata em reais automaticamente."})]}),a.jsxs(pd,{children:[a.jsx(xd,{onClick:()=>X(!1),children:"Cancelar"}),a.jsx(su,{onClick:async()=>{try{const K=String(ee||"").replace(/\D/g,""),H=K?Number(K)/100:0;await Of({saldoInicial:H,codigoEmpresa:r?.codigo_empresa}),U(!0),X(!1),e({title:"Caixa aberto com sucesso!",variant:"success"})}catch(K){e({title:"Falha ao abrir caixa",description:K?.message||"Tente novamente",variant:"destructive"})}},children:"Confirmar Abertura"})]})]})},ar=()=>a.jsxs(au,{open:$,onOpenChange:X,children:[a.jsx(Up,{asChild:!0,children:a.jsxs(fe,{variant:"success",size:"sm",disabled:D,onClick:()=>X(!0),className:"px-3",children:[a.jsx(rG,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 md:hidden",children:"Abrir"}),a.jsx("span",{className:"ml-2 hidden md:inline",children:"Abrir Caixa"})]})}),a.jsx(md,{className:"sm:max-w-[425px] w-[92vw] animate-none",onKeyDown:ee=>ee.stopPropagation(),onEscapeKeyDown:ee=>{ee.preventDefault(),ee.stopPropagation()},onPointerDownOutside:ee=>{ee.preventDefault(),ee.stopPropagation()},onFocusOutside:ee=>{ee.preventDefault(),ee.stopPropagation()},onInteractOutside:ee=>{ee.preventDefault(),ee.stopPropagation()},onOpenAutoFocus:ee=>{ee.preventDefault()},onCloseAutoFocus:ee=>{ee.preventDefault()},children:a.jsx(Et,{})})]}),Tr=()=>{const[ee,k]=p.useState({loading:!1,saldoInicial:0,resumo:null}),[T,K]=p.useState(!1),[H,F]=p.useState(""),[Le,it]=p.useState(!1),lt=async()=>{try{k({loading:!0,saldoInicial:0,resumo:null});const fr=await nh({codigoEmpresa:r?.codigo_empresa}),Kr=await Yw({codigoEmpresa:r?.codigo_empresa});k({loading:!1,saldoInicial:Number(fr?.saldo_inicial||0),resumo:Kr||{totalPorFinalizadora:{}}})}catch{k({loading:!1,saldoInicial:0,resumo:{totalPorFinalizadora:{}}})}},Vt=ee?.resumo?.totalPorFinalizadora||{},Ve=Object.values(Vt).reduce((fr,Kr)=>fr+Number(Kr||0),0),kt=Number(ee.saldoInicial||0)+Ve,Sr=Number(V?.totalSuprimento||0),Or=Number(V?.totalSangria||0);return a.jsxs(au,{open:Q,onOpenChange:fr=>{fr&&(pe(!0),it(!1),lt())},children:[a.jsx(Up,{asChild:!0,children:a.jsxs(fe,{variant:"destructive",size:"sm",disabled:!D,onClick:()=>{pe(!0)},className:"px-3",children:[a.jsx(Ix,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2",children:"Fechar Caixa"})]})}),a.jsxs(md,{className:"sm-max-w-[425px] animate-none",onKeyDown:fr=>fr.stopPropagation(),onEscapeKeyDown:fr=>{fr.preventDefault(),fr.stopPropagation()},onPointerDownOutside:fr=>{fr.preventDefault(),fr.stopPropagation()},onFocusOutside:fr=>{fr.preventDefault(),fr.stopPropagation()},onInteractOutside:fr=>{fr.preventDefault(),fr.stopPropagation()},onOpenAutoFocus:fr=>{fr.preventDefault()},onCloseAutoFocus:fr=>{fr.preventDefault()},children:[a.jsxs(hd,{children:[a.jsx(gd,{children:"Fechar Caixa"}),a.jsx(vd,{children:"Confira os valores e confirme o fechamento do caixa. Esta ao  irreversvel."})]}),T&&a.jsxs("div",{className:"md:hidden mb-2 text-[12px] text-warning bg-warning/10 border border-warning/30 rounded px-2 py-1 flex items-center gap-1",children:[a.jsx(Bc,{className:"h-3.5 w-3.5"}),"Existem comandas abertas. Finalize-as antes de fechar o caixa."]}),ee.loading?a.jsx("div",{className:"py-4 text-text-muted",children:"Carregando resumo"}):a.jsx("div",{className:"py-4 space-y-2",children:Le?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Valor Inicial"})," ",a.jsxs("span",{className:"font-mono",children:["R$ ",Number(ee.saldoInicial||0).toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Valor Final"})," ",a.jsx("span",{className:"font-mono",children:(()=>{const fr=String(H||"").replace(/\D/g,""),Kr=fr?Number(fr)/100:0;return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Kr)})()})]})]}),a.jsxs("div",{className:"mt-2",children:[a.jsx(qe,{className:"mb-1 block",children:"Saldo Final (opcional)"}),a.jsx(rt,{type:"text",inputMode:"numeric",placeholder:"0,00",value:H,onChange:fr=>{const Kr=(fr.target.value||"").replace(/\D/g,""),Pn=Kr?Number(Kr)/100:0,qn=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Pn);F(qn)},onKeyDown:fr=>{fr.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(fr.key)&&(/^[0-9]$/.test(fr.key)||fr.preventDefault())},onBeforeInput:fr=>{const Kr=fr.data??"";Kr&&/\D/.test(Kr)&&fr.preventDefault()}})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-xs font-medium text-text-muted uppercase tracking-wide mb-1",children:"Resumo"}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Valor Inicial"})," ",a.jsxs("span",{className:"font-mono",children:["R$ ",Number(ee.saldoInicial||0).toFixed(2)]})]}),Object.keys(Vt).length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem pagamentos nesta sesso."}):a.jsx("div",{className:"space-y-1",children:Object.entries(Vt).map(([fr,Kr])=>a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:String(fr)})," ",a.jsxs("span",{className:"font-mono",children:["R$ ",Number(Kr||0).toFixed(2)]})]},fr))}),a.jsx("div",{className:"my-2 h-px bg-border"}),a.jsx("div",{className:"text-xs font-medium text-text-muted uppercase tracking-wide mb-1",children:"Conferncia"}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Suprimentos"})," ",a.jsxs("span",{className:"font-mono",children:["R$ ",Sr.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Sangrias"})," ",a.jsxs("span",{className:"font-mono",children:["R$ ",Or.toFixed(2)]})]}),a.jsxs("div",{className:"flex justify-between font-medium text-base",children:[a.jsx("span",{className:"text-text-secondary",children:"Total em Caixa"})," ",a.jsxs("span",{className:"font-mono text-success",children:["R$ ",Number(kt||0).toFixed(2)]})]})]})}),a.jsx(pd,{children:Le?a.jsxs(a.Fragment,{children:[a.jsx(fe,{variant:"outline",onClick:()=>it(!1),children:"Voltar"}),a.jsx(fe,{onClick:async()=>{try{try{const Pn=await kc({codigoEmpresa:r?.codigo_empresa});if(Array.isArray(Pn)&&Pn.length>0){or?(K(!0),e({title:"Fechamento bloqueado",description:`Existem ${Pn.length} comandas abertas. Feche todas antes de encerrar o caixa.`,variant:"warning"})):e({title:"Fechamento bloqueado",description:`Existem ${Pn.length} comandas abertas. Feche todas antes de encerrar o caixa.`,variant:"warning",duration:2500});return}}catch{}const fr=String(H||"").replace(/\D/g,""),Kr=fr?Number(fr)/100:0;await Bre({codigoEmpresa:r?.codigo_empresa,valorFinalDinheiro:Kr}),U(!1),pe(!1),e({title:"Caixa fechado!",description:"Fechamento registrado com sucesso.",variant:"success"})}catch(fr){e({title:"Falha ao fechar caixa",description:fr?.message||"Tente novamente",variant:"destructive"})}},children:"Fechar Caixa"})]}):a.jsxs(a.Fragment,{children:[a.jsx(xd,{onClick:()=>pe(!1),children:"Cancelar"}),a.jsx(fe,{onClick:()=>it(!0),children:"Confirmar Fechamento"})]})})]})]})},Qr=()=>{const ee=sn=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(sn||0)),[k,T]=p.useState(!1),[K,H]=p.useState(!1),[F,Le]=p.useState(""),[it,lt]=p.useState(""),[Vt,Ve]=p.useState(!1),kt=async()=>{try{Ve(!0);const sn=String(F||"").replace(/\D/g,""),qr=sn?Number(sn)/100:0;if(qr<=0){e({title:"Valor invlido",description:"Informe um valor positivo.",variant:"warning"});return}await Of({codigoEmpresa:r?.codigo_empresa}),await FT({tipo:"sangria",valor:qr,observacao:it,codigoEmpresa:r?.codigo_empresa}),T(!1),Le(""),lt(""),await Dr(),e({title:"Sangria registrada",variant:"success"})}catch(sn){e({title:"Falha ao registrar sangria",description:sn?.message||"Tente novamente",variant:"destructive"})}finally{Ve(!1)}},[Sr,Or]=p.useState(""),[fr,Kr]=p.useState(""),[Pn,qn]=p.useState(!1),zn=async()=>{try{qn(!0);const sn=String(Sr||"").replace(/\D/g,""),qr=sn?Number(sn)/100:0;if(qr<=0){e({title:"Valor invlido",description:"Informe um valor positivo.",variant:"warning"});return}await Of({codigoEmpresa:r?.codigo_empresa}),await FT({tipo:"suprimento",valor:qr,observacao:fr,codigoEmpresa:r?.codigo_empresa}),H(!1),Or(""),Kr(""),await Dr(),e({title:"Suprimento registrado",variant:"success"})}catch(sn){e({title:"Falha ao registrar suprimento",description:sn?.message||"Tente novamente",variant:"destructive"})}finally{qn(!1)}};return a.jsx(mn,{open:z,onOpenChange:W,children:a.jsxs(un,{className:"sm:max-w-lg w-[92vw] max-h-[85vh] animate-none flex flex-col overflow-hidden",onKeyDown:sn=>sn.stopPropagation(),children:[a.jsxs(on,{children:[a.jsx(an,{className:"text-2xl font-bold",children:"Detalhes do Caixa"}),a.jsx(Nn,{children:ye?"Carregando resumo...":V?"Resumo da sesso atual do caixa.":"Nenhuma sesso de caixa aberta."})]}),V?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex-1 overflow-y-auto pr-1",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border text-center",children:[a.jsx("div",{className:"text-[12px] text-text-secondary whitespace-nowrap mb-1",children:"Saldo Inicial"}),a.jsx("div",{className:"text-base md:text-lg font-bold tabular-nums leading-tight",children:ee(V.saldo_inicial)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border text-center",children:[a.jsx("div",{className:"text-[12px] text-text-secondary whitespace-nowrap mb-1",children:"Entradas"}),a.jsx("div",{className:"text-base md:text-lg font-bold text-success tabular-nums leading-tight",children:ee(V.totalEntradas)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border text-center",children:[a.jsx("div",{className:"text-[12px] text-text-secondary whitespace-nowrap mb-1",children:"Sadas"}),a.jsx("div",{className:"text-base md:text-lg font-bold text-danger tabular-nums leading-tight",children:ee(V.totalSangria)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border text-center",children:[a.jsx("div",{className:"text-[12px] text-text-secondary whitespace-nowrap mb-1",children:"Saldo Atual"}),a.jsx("div",{className:"text-base md:text-lg font-bold tabular-nums leading-tight",children:ee((V.saldo_inicial||0)+(V.totalEntradas||0)-(V.totalSangria||0))})]})]}),a.jsxs("div",{className:"mt-5",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("h4",{className:"text-sm font-semibold text-text-secondary",children:"Totais por Finalizadora"})}),Object.keys(V.totalPorFinalizadora||{}).length===0?a.jsx("div",{className:"p-3 text-sm text-text-muted border rounded-md",children:"Nenhuma finalizadora registrada ainda."}):a.jsx("ul",{className:"rounded-md border border-border overflow-hidden divide-y divide-border",children:Object.entries(V.totalPorFinalizadora||{}).map(([sn,qr])=>a.jsxs("li",{className:"bg-surface px-3 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:String(sn)}),a.jsx("span",{className:"text-sm font-semibold tabular-nums",children:ee(qr)})]},sn))}),a.jsxs("div",{className:"mt-2 rounded-md border border-border bg-surface px-3 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:"Suprimentos"}),a.jsx("span",{className:"text-sm font-semibold tabular-nums text-success",children:ee(V.totalSuprimento||0)})]}),a.jsxs("div",{className:"mt-2 rounded-md border border-border bg-surface px-3 py-2 flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:"Sangrias"}),a.jsx("span",{className:"text-sm font-semibold tabular-nums text-danger",children:ee(V.totalSangria||0)})]})]})]}),a.jsxs(Qn,{className:"flex items-center justify-between gap-2",children:[a.jsx("div",{className:"mr-auto"}),a.jsx(fe,{variant:"outline",onClick:()=>H(!0),children:"Registrar Suprimento"}),a.jsx(fe,{variant:"destructive",onClick:()=>T(!0),children:"Registrar Sangria"}),a.jsx(fe,{variant:"secondary",onClick:()=>W(!1),children:"Fechar"})]}),a.jsx(mn,{open:K,onOpenChange:H,children:a.jsxs(un,{className:"sm:max-w-sm w-[92vw] max-h-[85vh] animate-none",onKeyDown:sn=>sn.stopPropagation(),children:[a.jsxs(on,{children:[a.jsx(an,{className:"text-xl font-bold",children:"Registrar Suprimento"}),a.jsx(Nn,{children:"Informe o valor de entrada no caixa e, opcionalmente, uma observao."})]}),a.jsxs("div",{className:"flex-1 flex flex-col space-y-3",children:[a.jsxs("div",{children:[a.jsx(qe,{htmlFor:"r-valor",children:"Valor"}),a.jsx(rt,{id:"r-valor",type:"text",inputMode:"numeric",autoComplete:"off",placeholder:"0,00",value:Sr,onChange:sn=>{const qr=(sn.target.value||"").replace(/\D/g,""),Sa=qr?Number(qr)/100:0,_a=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Sa);Or(_a)},onKeyDown:sn=>{sn.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(sn.key)&&(/^[0-9]$/.test(sn.key)||sn.preventDefault())},onBeforeInput:sn=>{const qr=sn.data??"";qr&&/\D/.test(qr)&&sn.preventDefault()}})]}),a.jsxs("div",{children:[a.jsx(qe,{htmlFor:"r-obs",children:"Observao"}),a.jsx(rt,{id:"r-obs",placeholder:"Opcional",value:fr,onChange:sn=>Kr(sn.target.value)})]})]}),a.jsxs(Qn,{children:[a.jsx(fe,{variant:"outline",onClick:()=>H(!1),disabled:Pn,children:"Cancelar"}),a.jsx(fe,{onClick:zn,disabled:Pn,children:Pn?"Registrando...":"Confirmar"})]})]})}),a.jsx(mn,{open:k,onOpenChange:T,children:a.jsxs(un,{className:"sm:max-w-sm w-[92vw] max-h-[85vh] animate-none",onKeyDown:sn=>sn.stopPropagation(),children:[a.jsxs(on,{children:[a.jsx(an,{className:"text-xl font-bold",children:"Registrar Sangria"}),a.jsx(Nn,{children:"Informe o valor a retirar do caixa e, opcionalmente, uma observao."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx(qe,{htmlFor:"s-valor",children:"Valor"}),a.jsx(rt,{id:"s-valor",type:"text",inputMode:"numeric",autoComplete:"off",placeholder:"0,00",value:F,onChange:sn=>{const qr=(sn.target.value||"").replace(/\D/g,""),Sa=qr?Number(qr)/100:0,_a=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Sa);Le(_a)},onKeyDown:sn=>{sn.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(sn.key)&&(/^[0-9]$/.test(sn.key)||sn.preventDefault())},onBeforeInput:sn=>{const qr=sn.data??"";qr&&/\D/.test(qr)&&sn.preventDefault()}})]}),a.jsxs("div",{children:[a.jsx(qe,{htmlFor:"s-obs",children:"Observao"}),a.jsx(rt,{id:"s-obs",placeholder:"Opcional",value:it,onChange:sn=>lt(sn.target.value)})]})]}),a.jsxs(Qn,{children:[a.jsx(fe,{variant:"outline",onClick:()=>T(!1),disabled:Vt,children:"Cancelar"}),a.jsx(fe,{onClick:kt,disabled:Vt,children:Vt?"Registrando...":"Confirmar"})]})]})})]}):a.jsx("div",{className:"text-sm text-text-muted",children:"Nenhuma sesso de caixa aberta."})]})})},tn=r?.codigo_empresa||"anon",Qt={comandaId:`balcao:comandaId:${tn}`,items:`balcao:items:${tn}`,customerName:`balcao:customer:${tn}`,clientChosen:`balcao:clientChosen:${tn}`,pendingClientIds:`balcao:pendingClientIds:${tn}`,missCount:`balcao:missCount:${tn}`,lastMissTs:`balcao:lastMissTs:${tn}`},fn=async(ee,k=3)=>{if(!ee)return;const T=r?.codigo_empresa,K=++Qe.current;for(let H=0;H<k;H++)try{const F=await io({comandaId:ee,codigoEmpresa:T});if(K!==Qe.current)return;const Le=(F||[]).map(it=>({id:it.id,productId:it.produto_id,name:it.descricao||"Item",price:Number(it.preco_unitario||0),quantity:Number(it.quantidade||1)}));c(Le);try{const it=await ui({comandaId:ee,codigoEmpresa:T});if(K!==Qe.current)return;const lt=(it||[]).map(kt=>kt?.nome).filter(Boolean),Vt=lt.length?lt.join(", "):"";b(Vt),ur(!!Vt);const Ve=Array.from(new Set((it||[]).map(kt=>kt?.cliente_id).filter(Boolean)));Ve.length>0&&rr(Ve)}catch{b(""),ur(!1)}break}catch(F){if(H===k-1)e({title:"Falha ao atualizar itens",description:F?.message||"Tente novamente",variant:"destructive"});else{const Le=350*(H+1),it=Math.floor(Math.random()*120);await new Promise(lt=>setTimeout(lt,Le+it))}}},nn=async()=>{try{u(!0);let ee=setTimeout(()=>{Mt.current&&u(!1)},1e4);const k=r?.codigo_empresa;if(!k){Mt.current&&u(!1);return}try{const F=localStorage.getItem(Qt.comandaId),Le=JSON.parse(localStorage.getItem(Qt.items)||"[]"),it=localStorage.getItem(Qt.customerName)||"",lt=localStorage.getItem(Qt.clientChosen),Vt=JSON.parse(localStorage.getItem(Qt.pendingClientIds)||"[]");F&&s(Number.isNaN(+F)?F:Number(F)),Array.isArray(Le)&&Le.length>0&&c(Le),it&&b(it),lt==="true"&&ur(!0),Array.isArray(Vt)&&Vt.length>0&&rr(Vt)}catch{}const T=localStorage.getItem(Qt.comandaId),K=T?Number.isNaN(+T)?T:Number(T):null,H=await ex({codigoEmpresa:k}).catch(()=>null);if(H?.id)s(H.id),await fn(H.id);else if(K)s(K),await fn(K,3);else{let F=0,Le=0;try{F=Number(localStorage.getItem(Qt.missCount)||"0"),Le=Number(localStorage.getItem(Qt.lastMissTs)||"0")}catch{}const it=Date.now(),Vt=it-Le<9e4?F+1:1;try{localStorage.setItem(Qt.missCount,String(Vt)),localStorage.setItem(Qt.lastMissTs,String(it))}catch{}try{const Ve=localStorage.getItem(Qt.customerName)||"",kt=localStorage.getItem(Qt.clientChosen)==="true",Sr=JSON.parse(localStorage.getItem(Qt.pendingClientIds)||"[]");b(Ve||""),ur(!!kt),rr(Array.isArray(Sr)?Sr:[])}catch{}if(s(null),Vt>=2){c([]);try{localStorage.removeItem(Qt.comandaId),localStorage.removeItem(Qt.items)}catch{}}else try{const Ve=JSON.parse(localStorage.getItem(Qt.items)||"[]");Array.isArray(Ve)&&Ve.length>0&&c(Ve)}catch{}}try{const F=await bu({includeInactive:!1,search:w?.trim()||void 0,codigoEmpresa:k});Mt.current&&i(F||[])}catch{i([])}clearTimeout(ee)}catch(ee){e({title:"Falha ao carregar Modo Balco",description:ee?.message||"Tente novamente",variant:"destructive"})}finally{Mt.current&&u(!1)}},In=async()=>{try{R(!0),v(!0);const ee=r?.codigo_empresa;if(n&&ee)try{try{await de.from("comanda_itens").delete().eq("comanda_id",n).eq("codigo_empresa",ee)}catch{}try{await de.from("comanda_clientes").delete().eq("comanda_id",n).eq("codigo_empresa",ee)}catch{}await de.from("comandas").delete().eq("id",n).eq("codigo_empresa",ee)}catch{}}finally{s(null),c([]),rr([]),b(""),ur(!1),P(null);try{localStorage.removeItem(Qt.comandaId),localStorage.removeItem(Qt.items),localStorage.removeItem(Qt.customerName)}catch{}R(!1),e({title:"Venda cancelada",variant:"success"}),v(!1)}};p.useEffect(()=>{let ee=!1;(async()=>{await nn(),!ee&&Mt.current&&!n&&(zt.current||[]).length===0&&(ee=!0,setTimeout(()=>{Mt.current&&nn()},700))})()},[r?.codigo_empresa]),p.useEffect(()=>{try{n&&localStorage.setItem(Qt.comandaId,String(n)),localStorage.setItem(Qt.items,JSON.stringify(l||[])),localStorage.setItem(Qt.customerName,x||""),localStorage.setItem(Qt.clientChosen,dr?"true":"false"),n?localStorage.removeItem(Qt.pendingClientIds):localStorage.setItem(Qt.pendingClientIds,JSON.stringify(ut||[]))}catch{}},[n,l,x,dr,ut]),p.useEffect(()=>{const ee=()=>{n&&fn(n,2)},k=()=>{document.visibilityState==="visible"&&n&&fn(n,2)};return window.addEventListener("focus",ee),document.addEventListener("visibilitychange",k),()=>{window.removeEventListener("focus",ee),document.removeEventListener("visibilitychange",k)}},[n]),p.useEffect(()=>{const ee=k=>{const T=k.target;if(!(T&&(T.tagName==="INPUT"||T.tagName==="TEXTAREA"))){if(k.key==="p"||k.key==="P"){k.preventDefault(),jt.current?.focus();return}if((k.key==="c"||k.key==="C")&&D&&dr){k.preventDefault(),It(!0);return}if(k.key==="Escape"){if(Ct){wt(!1);return}if(hr){It(!1);return}if(te){Y(!1);return}if(Ze){ht(!1);return}}}};return window.addEventListener("keydown",ee),()=>window.removeEventListener("keydown",ee)},[D,dr,Ct,hr,te,Ze]),p.useEffect(()=>{const ee=T=>{if(!pt||!he.current)return;const H=he.current.getBoundingClientRect(),F=18;H.width-F;const it=(T.clientX-H.left)/H.width*100;it>=20&&it<=80&&qt(it)},k=()=>{if(pt){Dt(!1);try{localStorage.setItem("balcao_left_panel_width",String(yt))}catch{}}};return pt&&(document.addEventListener("mousemove",ee),document.addEventListener("mouseup",k),document.body.style.cursor="col-resize",document.body.style.userSelect="none"),()=>{document.removeEventListener("mousemove",ee),document.removeEventListener("mouseup",k),document.body.style.cursor="",document.body.style.userSelect=""}},[pt,yt]),p.useEffect(()=>{let ee=!0;const k=setTimeout(async()=>{try{const T=await bu({includeInactive:!1,search:w?.trim()||void 0,codigoEmpresa:r?.codigo_empresa});if(!ee)return;let K=T||[];if(w?.trim()){const H=w.trim().toLowerCase();K=K.filter(F=>(F.name||"").toLowerCase().includes(H)||(F.code||"").toLowerCase().includes(H))}K.sort((H,F)=>{const Le=H.code||"",it=F.code||"";return/^\d+$/.test(Le)&&/^\d+$/.test(it)?parseInt(Le,10)-parseInt(it,10):Le.localeCompare(it)}),i(K)}catch{ee&&i([])}},300);return()=>{ee=!1,clearTimeout(k)}},[w]),p.useEffect(()=>{if(Q)return;let ee=!0;const k=async()=>{try{const K=r?.codigo_empresa;if(!K)return;const H=await Hm({codigoEmpresa:K});if(!ee)return;const F=new Map;for(const Le of H||[]){const it=Le.produto_id,lt=Number(Le.quantidade||0);F.set(it,(F.get(it)||0)+lt)}M(F)}catch(K){console.error("[BalcaoPage] Erro ao buscar estoque reservado:",K),ee&&M(new Map)}};k();const T=setInterval(k,5e3);return()=>{ee=!1,clearInterval(T)}},[r?.codigo_empresa,l,Q]),p.useEffect(()=>{if(Q)return;let ee=!0;const k=setTimeout(async()=>{try{const T=await jb({searchTerm:Nt,limit:20,codigoEmpresa:r?.codigo_empresa});if(!ee)return;const K=(T||[]).slice().sort((H,F)=>Number(H?.codigo||0)-Number(F?.codigo||0));if(dt(K),!n&&!dr&&hr&&(!ut||ut.length===0)){const H=K?.find(F=>F?.codigo===0);if(H){rr([H.id]);try{localStorage.setItem(Qt.pendingClientIds,JSON.stringify([H.id]))}catch{}}}}catch{ee&&dt([])}},250);return()=>{ee=!1,clearTimeout(k)}},[Nt,hr,Q]);const Dn=p.useMemo(()=>l.reduce((ee,k)=>ee+Number(k.price||0)*Number(k.quantity||0),0),[l]),se=p.useMemo(()=>{const ee=new Map;for(const k of l||[]){const T=k.productId;if(!T)continue;const K=Number(k.quantity||0);ee.set(T,(ee.get(T)||0)+K)}return ee},[l]),He=async(ee,k={})=>{try{if(!D){e({title:"Caixa Fechado",description:"Abra o caixa antes de iniciar uma venda.",variant:"warning"});return}if(!dr&&!k.skipClientCheck){P(ee),It(!0),e({title:"Selecione o cliente",description:"Escolha um cliente cadastrado antes de vender.",variant:"warning"});return}const T=r?.codigo_empresa;if(!T){e({title:"Empresa no definida",description:"Faa login novamente.",variant:"destructive"});return}if(_)return;const K=Number(ee.stock??ee.currentStock??0),H=I.get(ee.id)||0,F=Math.max(0,K-H),Le=Number(ee.minStock??0);if(F<=0){e({title:"Sem estoque disponvel",description:`Produto "${ee.name}" est sem estoque (${K} total, ${H} reservado em outras comandas).`,variant:"destructive"});return}S(ee.id);let it=n;const lt=!it;if(!it)try{h(!0);const kt=await m_({codigoEmpresa:T});it=kt.id,s(kt.id),await new Promise(Or=>setTimeout(Or,300));const{data:Sr}=await de.from("comandas").select("id").eq("id",it).eq("codigo_empresa",T).single();if(!Sr)throw new Error("Comanda criada mas no acessvel via RLS")}catch(kt){if(kt?.code==="NO_OPEN_CASH_SESSION"){e({title:"Abra o caixa para vender",description:"Voc precisa abrir o caixa antes de iniciar uma comanda no Balco.",variant:"warning"});return}throw kt}finally{h(!1)}const Vt=Number(ee.salePrice??ee.price??0),Ve=(zt.current||[]).find(kt=>kt.productId===ee.id);Ve?await dd({itemId:Ve.id,quantidade:Number(Ve.quantity||0)+1,codigoEmpresa:T}):await $T({comandaId:it,produtoId:ee.id,descricao:ee.name,quantidade:1,precoUnitario:Vt,codigoEmpresa:T}),await fn(it);try{const kt=await Hm({codigoEmpresa:T}),Sr=new Map;for(const Or of kt||[]){const fr=Or.produto_id,Kr=Number(Or.quantidade||0);Sr.set(fr,(Sr.get(fr)||0)+Kr)}M(Sr)}catch(kt){console.error("[BalcaoPage:addProduct] Erro ao atualizar estoque reservado:",kt)}if(lt)try{const kt=Array.from(new Set(ut||[]));if(kt.length>0){await _b({comandaId:it,clienteIds:kt,nomesLivres:[],codigoEmpresa:T,replace:!0}),await fn(it);const Or=(await ui({comandaId:it,codigoEmpresa:T})||[]).map(fr=>fr?.nome).filter(Boolean);b(Or.length?Or.join(", "):""),ur(!0);try{localStorage.removeItem(Qt.pendingClientIds),localStorage.setItem(Qt.customerName,Or.length?Or.join(", "):""),localStorage.setItem(Qt.clientChosen,"true")}catch(fr){console.error("Erro ao atualizar cache local:",fr)}}}catch(kt){console.error("Erro ao associar clientes:",kt)}K-1<=0?e({title:"ltima unidade vendida",description:`"${ee.name}" esgotou aps esta venda.`,variant:"warning"}):K-1<=Le?e({title:"Estoque baixo",description:`"${ee.name}" atingiu nvel de estoque baixo.`,variant:"warning"}):e({title:"Produto adicionado",description:ee.name,variant:"success"})}catch(T){const K=String(T?.message||"").toLowerCase();T?.code==="OUT_OF_STOCK"||K.includes("sem estoque")?e({title:"Sem estoque",description:"Este produto est sem estoque.",variant:"destructive"}):T?.code==="INSUFFICIENT_STOCK"||K.includes("insuficiente")?e({title:"Estoque insuficiente",description:T?.message||"Quantidade maior que o disponvel.",variant:"destructive"}):e({title:"Falha ao adicionar",description:T?.message||"Tente novamente",variant:"destructive"})}finally{S(null)}},ot=async()=>{try{if(le(!0),!dr){It(!0),e({title:"Selecione o cliente",description:"Escolha um cliente cadastrado antes de pagar.",variant:"warning"}),le(!1);return}const ee=r?.codigo_empresa;if(!ee){e({title:"Empresa no definida",variant:"destructive"});return}if(!n)try{h(!0);const kt=await m_({codigoEmpresa:ee});if(!kt?.id){e({title:"Comanda no encontrada",description:"Abra uma comanda antes de pagar.",variant:"destructive"}),le(!1);return}s(kt.id)}catch(kt){if(kt?.code==="NO_OPEN_CASH_SESSION"){e({title:"Abra o caixa para pagar",description:" necessrio abrir o caixa antes de iniciar/confirmar uma venda.",variant:"warning"}),le(!1);return}throw kt}finally{h(!1)}try{await HGe({comandaId:n,codigoEmpresa:ee})}catch(kt){const Sr=Array.isArray(kt?.items)&&kt.items.length?kt.items.map(Or=>`${Or.name} (solicitado ${Or.solicitado}, estoque ${Or.estoque})`).join("; "):kt?.message||"Estoque insuficiente na comanda";e({title:"Estoque insuficiente",description:Sr,variant:"destructive",duration:7e3}),le(!1);return}const k=await th({somenteAtivas:!0,codigoEmpresa:ee});me(k||[]);let T=[];try{const kt=await ui({comandaId:n,codigoEmpresa:ee});T=(Array.isArray(kt)?kt:[]).map(Or=>{const fr=Or?.cliente_id??Or?.clientes?.id??null,Kr=Or?.clientes?.nome??Or?.nome??Or?.nome_livre??"";return fr?{id:fr,nome:Kr}:null}).filter(Boolean)}catch{T=[]}bt(T);const K=k&&k[0]&&k[0].id?k[0].id:null,H=ut&&ut.length>0?ut[0]:T[0]?.id||null;let F=0;try{F=(await io({comandaId:n,codigoEmpresa:ee})||[]).reduce((Sr,Or)=>Sr+Number(Or.quantidade||0)*Number(Or.preco_unitario||0),0)}catch{}const Le=(k||[]).find(kt=>String(kt.id)===String(K)),it=Number(Le?.taxa_percentual||0),lt=it>0,Vt=lt?F*(1+it/100):F,Ve=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Vt);Re([{id:1,clientId:H,methodId:K,value:Ve,chargeFee:lt}]),ie(2),Y(!0),le(!1);return}catch(ee){if(ee?.code==="NO_OPEN_CASH_SESSION"){e({title:"Abra o caixa para pagar",description:" necessrio abrir o caixa antes de iniciar/confirmar uma venda.",variant:"warning"}),le(!1);return}e({title:"Falha ao iniciar pagamento",description:ee?.message||"Tente novamente",variant:"destructive"})}finally{le(!1)}};return a.jsxs("div",{className:"h-full flex flex-col",children:[a.jsx("div",{className:"md:hidden mb-2 w-full",children:a.jsx(Mc,{value:"balcao",onValueChange:ee=>{ee==="mesas"&&t("/vendas"),ee==="balcao"&&t("/balcao"),ee==="historico"&&t("/historico")},children:a.jsxs(rc,{className:"grid w-full grid-cols-3",children:[a.jsx(sa,{value:"mesas",className:"text-xs",children:"Mesas"}),a.jsx(sa,{value:"balcao",className:"text-xs",children:"Balco"}),a.jsx(sa,{value:"historico",className:"text-xs",children:"Histrico"})]})})}),a.jsxs("div",{className:"flex items-center justify-between mb-2 md:mb-6 gap-2 md:gap-4",children:[a.jsx("div",{className:"hidden md:flex items-center gap-2 md:gap-3",children:a.jsx(Mc,{value:"balcao",onValueChange:ee=>{ee==="mesas"&&t("/vendas"),ee==="balcao"&&t("/balcao"),ee==="historico"&&t("/historico")},children:a.jsxs(rc,{className:"inline-flex",children:[a.jsx(sa,{value:"mesas",className:"text-sm",children:"Mesas"}),a.jsx(sa,{value:"balcao",className:"text-sm",children:"Balco"}),a.jsx(sa,{value:"historico",className:"text-sm",children:"Histrico"})]})})}),a.jsxs("div",{className:"flex items-center gap-1.5 md:gap-3 md:ml-auto",children:[a.jsx(ar,{}),a.jsx(Tr,{}),a.jsxs(fe,{variant:"outline",size:"sm",onClick:()=>W(!0),className:"px-3",children:[a.jsx(_4,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 md:hidden",children:"Detalhes"}),a.jsx("span",{className:"ml-2 hidden md:inline",children:"Detalhes do Caixa"})]})]})]}),a.jsx("div",{className:"md:hidden flex-1 flex flex-col",children:a.jsxs("div",{className:"flex flex-col border rounded-lg border-border overflow-hidden bg-surface flex-1 min-h-0",children:[a.jsxs("div",{className:"p-3 border-b border-border flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Comanda"}),a.jsx("div",{className:"text-base font-bold truncate",children:"Balco"}),dr&&x&&a.jsx("div",{className:"text-[11px] text-text-muted truncate mt-0.5",children:x})]}),a.jsx("div",{className:"flex flex-col items-end gap-1",children:dr?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsxs(fe,{size:"sm",className:"h-8 px-2 text-xs bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",disabled:!D,onClick:()=>{if(!D){e({title:"Caixa Fechado",description:"Abra o caixa antes de adicionar produtos.",variant:"warning"});return}wt(!0)},children:[a.jsx(Ja,{className:"h-4 w-4 mr-1"})," Produto"]}),a.jsx(fe,{size:"sm",variant:"outline",className:"h-8 px-2 text-xs",onClick:()=>It(!0),children:"+ Cliente"})]}),a.jsxs("span",{className:"text-xs text-text-muted whitespace-nowrap",children:["Total: R$ ",Dn.toFixed(2)]})]}):a.jsx(fe,{size:"sm",className:"h-8 px-3 text-xs bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",disabled:!D,onClick:()=>{if(!D){e({title:"Caixa Fechado",description:"Abra o caixa antes de iniciar uma venda.",variant:"warning"});return}It(!0)},children:"Iniciar venda"})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-3 thin-scroll min-h-0",children:dr?l.length===0?a.jsxs("div",{className:"text-center pt-8 text-xs text-text-muted space-y-2",children:[a.jsx("div",{children:"Comanda criada para o cliente."}),a.jsxs("div",{children:["Use o boto ",a.jsx("span",{className:"font-semibold",children:"Produto"})," para adicionar itens."]})]}):a.jsx("ul",{className:"space-y-2",children:l.map(ee=>a.jsxs("li",{className:"p-2 rounded-md border border-border/40 bg-surface-2",children:[a.jsx("div",{className:"text-sm font-medium truncate",title:ee.name,children:ee.name}),a.jsxs("div",{className:"mt-1 flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(fe,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:async k=>{k.stopPropagation();const T=r?.codigo_empresa;if(!T){e({title:"Empresa no definida",variant:"destructive"});return}const K=Number(ee.quantity||1)-1;try{K<=0?(await tx({itemId:ee.id,codigoEmpresa:T}),c(H=>H.filter(F=>F.id!==ee.id))):(await dd({itemId:ee.id,quantidade:K,codigoEmpresa:T}),c(H=>H.map(F=>F.id===ee.id?{...F,quantity:K}:F)))}catch(H){e({title:"Falha ao atualizar item",description:H?.message||"Tente novamente",variant:"destructive"})}},children:"-"}),a.jsx("span",{className:"w-7 text-center text-sm font-semibold",children:ee.quantity}),a.jsx(fe,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:async k=>{k.stopPropagation();const T=r?.codigo_empresa;if(!T){e({title:"Empresa no definida",variant:"destructive"});return}const K=Number(ee.quantity||1)+1;try{await dd({itemId:ee.id,quantidade:K,codigoEmpresa:T}),c(H=>H.map(F=>F.id===ee.id?{...F,quantity:K}:F))}catch(H){e({title:"Falha ao atualizar item",description:H?.message||"Tente novamente",variant:"destructive"})}},children:"+"})]}),a.jsxs("span",{className:"text-sm font-semibold whitespace-nowrap",children:["R$ ",(Number(ee.quantity)*Number(ee.price)).toFixed(2)]})]})]},ee.id))}):a.jsx("div",{className:"text-center pt-8 text-xs text-text-muted space-y-2",children:a.jsxs("div",{children:["Para comear, toque em ",a.jsx("span",{className:"font-semibold",children:"Iniciar venda"})," e selecione o cliente."]})})}),a.jsx("div",{className:"p-3 border-t border-border flex gap-2",children:dr?a.jsxs(a.Fragment,{children:[a.jsx(fe,{className:"flex-1",variant:"outline",size:"sm",onClick:In,disabled:A,children:"Cancelar"}),a.jsx(fe,{className:"flex-1",size:"sm",disabled:Dn<=0,onClick:ot,children:"Finalizar"})]}):a.jsx(fe,{className:"flex-1",size:"sm",variant:"outline",disabled:!D,onClick:()=>{if(!D){e({title:"Caixa Fechado",description:"Abra o caixa antes de iniciar uma venda.",variant:"warning"});return}It(!0)},children:"Iniciar venda"})})]})}),a.jsx(Qr,{}),a.jsx(mn,{open:Ze,onOpenChange:ee=>{ht(ee),ee||xt(null)},children:a.jsxs(un,{className:"sm:max-w-[420px] w-full max-h-[85vh] flex flex-col animate-none",onKeyDown:ee=>ee.stopPropagation(),onPointerDownOutside:ee=>ee.stopPropagation(),onInteractOutside:ee=>ee.stopPropagation(),children:[a.jsxs(on,{children:[a.jsx(an,{className:"text-xl font-bold break-words",title:at?.name||"",children:at?.name||"Produto"}),a.jsx(Nn,{children:"Detalhes do produto e aes rpidas."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Preo"}),a.jsx("span",{className:"text-sm font-semibold",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(at?.price??at?.salePrice??0))})]}),at?.category?a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Categoria"}),a.jsx("span",{className:"text-sm font-medium",children:at.category})]}):null,a.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[typeof at?.stock<"u"&&a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Estoque"}),a.jsx("div",{className:"text-base font-semibold",children:at.stock})]}),typeof at?.minStock<"u"&&a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Mnimo"}),a.jsx("div",{className:"text-base font-semibold",children:at.minStock})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Na Comanda"}),a.jsxs("div",{className:"text-base font-semibold",children:["x",se.get(at?.id)||0]})]})]})]}),a.jsxs(Qn,{className:"flex items-center justify-between gap-2",children:[a.jsxs(fe,{variant:"ghost",size:"sm",className:"mr-auto inline-flex items-center gap-1",onClick:()=>{at&&t("/produtos",{state:{productId:at.id,productName:at.name}})},children:[a.jsx(Zo,{className:"w-4 h-4"}),a.jsx("span",{children:"Info"})]}),a.jsx(fe,{variant:"outline",onClick:()=>{ht(!1),xt(null)},children:"Fechar"}),a.jsx(fe,{onClick:async()=>{at&&(await He(at,{skipClientCheck:!1}),ht(!1),xt(null))},children:"Adicionar"})]})]})}),(f||m||g)&&a.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/80",children:a.jsxs("div",{className:"px-8 py-6 rounded-xl bg-surface border border-border shadow-2xl flex flex-col items-center gap-4 max-w-sm w-[85vw] text-center",children:[a.jsx("div",{className:"w-8 h-8 rounded-full border-4 border-brand border-t-transparent animate-spin","aria-hidden":"true"}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"block text-base font-semibold text-text-primary",children:f?"Abrindo venda...":m?"Cancelando venda...":"Fechando conta..."}),a.jsx("span",{className:"block text-xs text-text-muted",children:f?"Aguarde, estamos iniciando a venda e sincronizando com os dispositivos.":m?"Aguarde, estamos cancelando a venda e limpando os itens.":"Aguarde, estamos registrando o pagamento e encerrando a venda."})]})]})}),a.jsx(mn,{open:Ct,onOpenChange:wt,children:a.jsxs(un,{className:"sm:max-w-xl w-[92vw] max-h-[85vh] flex flex-col overflow-hidden animate-none",onOpenAutoFocus:ee=>ee.preventDefault(),onKeyDown:ee=>ee.stopPropagation(),children:[a.jsxs(on,{children:[a.jsx(an,{className:"text-xl font-bold",children:"Adicionar Produtos"}),a.jsx(Nn,{children:"Busque e adicione produtos  comanda do balco."})]}),a.jsx("div",{className:"p-4 pt-0",children:a.jsxs("div",{className:"relative",children:[a.jsx(Zs,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(rt,{placeholder:"Buscar produto...",className:"pl-9",value:Ge,onChange:ee=>Je(ee.target.value)})]})}),a.jsxs("div",{className:"flex-1 overflow-y-auto px-4 pb-4 thin-scroll",children:[a.jsx("ul",{className:"space-y-2",children:(o||[]).filter(ee=>{const k=(Ge||"").toLowerCase();if(!k)return!0;const T=String(ee.name||ee.descricao||"").toLowerCase(),K=String(ee.code||ee.codigo||"").toLowerCase();return T.includes(k)||K.includes(k)}).sort((ee,k)=>{const T=ee.code?parseInt(ee.code,10):999999,K=k.code?parseInt(k.code,10):999999;return T-K}).map(ee=>{const k=se.get(ee.id)||0,T=Number(ee.stock??ee.currentStock??0),K=Math.max(0,T-k),H=Number(ee.salePrice??ee.price??0);return a.jsxs("li",{className:"flex items-center p-2 rounded-md hover:bg-surface-2 transition-colors border border-border/40",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("p",{className:"font-semibold truncate max-w-[200px]",title:`${ee.code?`[${ee.code}] `:""}${ee.name}`,children:[ee.code&&a.jsxs("span",{className:"text-text-muted",children:["[",ee.code,"]"]})," ",ee.name]}),k>0&&a.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-brand/15 text-brand border border-brand/30 flex-shrink-0",children:["x",k]}),a.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-surface-2 text-text-secondary border border-border flex-shrink-0",children:["Qtd ",K]})]}),a.jsxs("p",{className:"text-sm text-text-muted",children:["R$ ",H.toFixed(2)]})]}),a.jsx(fe,{size:"icon",className:"flex-shrink-0 bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",onClick:async()=>{await He(ee)},"aria-label":`Adicionar ${ee.name}`,children:a.jsx(Ja,{className:"h-4 w-4"})})]},ee.id)})}),Array.isArray(o)&&o.length===0&&a.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[a.jsx(lx,{className:"w-16 h-16 text-text-muted mb-4"}),a.jsx("p",{className:"text-sm text-text-muted",children:"Nenhum produto encontrado."})]})]}),a.jsx(Qn,{children:a.jsx(fe,{variant:"outline",onClick:()=>wt(!1),children:"Fechar"})})]})}),a.jsxs("div",{ref:he,className:"hidden md:flex gap-0 h-full overflow-hidden relative",children:[a.jsxs("div",{className:"flex flex-col border rounded-lg border-border overflow-hidden",style:{width:`${yt}%`},children:[a.jsxs("div",{className:"p-4 border-b border-border space-y-3 cursor-pointer",onClick:ee=>{ee.target.tagName==="INPUT"||ee.target.tagName==="BUTTON"||ee.target.closest("button")||jt.current?.focus()},children:[a.jsxs("div",{className:"relative",children:[a.jsx(Zs,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(rt,{placeholder:"Buscar produto...",className:"pl-9",value:w,onChange:ee=>j(ee.target.value),onKeyDown:ee=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(ee.key)&&ee.stopPropagation()}})]}),a.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("button",{onClick:()=>Ye("all"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${Mr==="all"?"bg-brand text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Todos"}),a.jsx("button",{onClick:()=>Ye("available"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${Mr==="available"?"bg-success text-white":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Disponvel"}),a.jsx("button",{onClick:()=>Ye("low"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${Mr==="low"?"bg-warning text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Estoque Baixo"}),a.jsx("button",{onClick:()=>Ye("out"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${Mr==="out"?"bg-destructive text-white":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Sem Estoque"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>{Be("code");try{localStorage.setItem("balcao_sort_order","code")}catch{}},className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${$e==="code"?"bg-brand text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,title:"Ordenar por cdigo",children:"Cdigo"}),a.jsx("button",{onClick:()=>{Be("name");try{localStorage.setItem("balcao_sort_order","name")}catch{}},className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${$e==="name"?"bg-brand text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,title:"Ordenar por nome",children:"A-Z"})]})]}),a.jsx("div",{className:"flex items-center gap-4 text-sm text-text-muted cursor-pointer",onClick:()=>jt.current?.focus(),children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("kbd",{className:"px-2 py-1 bg-surface border border-border rounded text-xs font-mono",children:""}),a.jsx("span",{children:"Navegar"})]})})]}),a.jsx("div",{ref:jt,className:"flex-1 overflow-y-auto p-4 thin-scroll focus:outline-none focus:ring-2 focus:ring-brand/20",tabIndex:0,onClick:()=>jt.current?.focus(),onKeyDown:ee=>{const k=o.filter(H=>{const F=w.trim().toLowerCase(),Le=!F||(H.name||"").toLowerCase().includes(F)||String(H.code||"").toLowerCase().includes(F);if(Mr==="all")return Le;const it=I.get(H.id)||0,lt=Number(H.stock??H.currentStock??0),Vt=Math.max(0,lt-it);return Mr==="available"?Le&&Vt>0:Mr==="low"?Le&&Vt>0&&Vt<=5:Mr==="out"?Le&&Vt<=0:Le}).sort((H,F)=>{if($e==="name"){const Le=(H.name||"").toLowerCase(),it=(F.name||"").toLowerCase();return Le.localeCompare(it)}else{const Le=H.code?parseInt(H.code,10):999999,it=F.code?parseInt(F.code,10):999999;return Le-it}});if(!["ArrowDown","ArrowUp","Home","End"].includes(ee.key))return;ee.preventDefault();const T=er||0,K=k.length;if(ee.key==="ArrowDown"){const H=Math.min(T+1,K-1);ln(H),requestAnimationFrame(()=>et.current[H]?.scrollIntoView({block:"nearest"}))}if(ee.key==="ArrowUp"){const H=Math.max(T-1,0);ln(H),requestAnimationFrame(()=>et.current[H]?.scrollIntoView({block:"nearest"}))}if(ee.key==="Home"&&(ln(0),requestAnimationFrame(()=>et.current[0]?.scrollIntoView({block:"nearest"}))),ee.key==="End"){const H=Math.max(0,K-1);ln(H),requestAnimationFrame(()=>et.current[H]?.scrollIntoView({block:"nearest"}))}},children:(o||[]).length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full py-12",children:[a.jsx(lx,{className:"w-16 h-16 text-text-muted mb-4"}),a.jsx("p",{className:"text-lg font-semibold text-text-primary mb-2",children:"Nenhum produto cadastrado"}),a.jsx("p",{className:"text-sm text-text-muted mb-6 text-center",children:"Cadastre produtos para comear a vender"}),a.jsxs(fe,{onClick:()=>t("/produtos"),children:[a.jsx(Ja,{className:"mr-2 h-4 w-4"}),"Cadastrar Produto"]})]}):a.jsx("ul",{className:"space-y-2",children:o.filter(ee=>{const k=w.trim().toLowerCase(),T=!k||(ee.name||"").toLowerCase().includes(k)||String(ee.code||"").toLowerCase().includes(k);if(Mr==="all")return T;const K=I.get(ee.id)||0,H=Number(ee.stock??ee.currentStock??0),F=Math.max(0,H-K);return Mr==="available"?T&&F>0:Mr==="low"?T&&F>0&&F<=5:Mr==="out"?T&&F<=0:T}).sort((ee,k)=>{if($e==="name"){const T=(ee.name||"").toLowerCase(),K=(k.name||"").toLowerCase();return T.localeCompare(K)}else{const T=ee.code?parseInt(ee.code,10):999999,K=k.code?parseInt(k.code,10):999999;return T-K}}).map((ee,k)=>{const T=se.get(ee.id)||0,K=I.get(ee.id)||0,H=Number(ee.stock??ee.currentStock??0),F=Math.max(0,H-K),Le=Number(ee.salePrice??ee.price??0),it=k===er;return a.jsx(Pe.Fragment,{children:a.jsxs("li",{ref:lt=>{et.current[k]=lt},className:`flex items-center gap-3 p-2 rounded-md transition-colors border-2 ${it?"border-brand bg-brand/5":"border-transparent hover:bg-surface-2"} ${F===0&&T===0?"opacity-50 cursor-not-allowed":""}`,onClick:()=>{ln(k),jt.current?.focus()},children:[a.jsxs("div",{className:"flex-1 min-w-0 cursor-pointer",onClick:lt=>{lt.stopPropagation(),xt({...ee,qty:T,remaining:F,price:Le}),ht(!0)},children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsxs("p",{className:"font-semibold truncate",title:`${ee.code?`[${ee.code}] `:""}${ee.name}`,children:[ee.code&&a.jsxs("span",{className:"text-text-muted",children:["[",ee.code,"]"]})," ",ee.name]}),T>0&&a.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-brand/15 text-brand border border-brand/30 flex-shrink-0",children:["x",T]})]}),a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsxs("p",{className:"text-sm text-text-muted",children:["R$ ",Le.toFixed(2)]}),a.jsxs("span",{className:`text-xs font-medium whitespace-nowrap ${F<=0?"text-destructive":F<=5?"text-warning":"text-text-secondary"}`,children:["Estoque: ",F]})]})]}),a.jsx(fe,{size:"icon",className:"flex-shrink-0 bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",onClick:lt=>{lt.stopPropagation(),He(ee)},disabled:F===0,"aria-label":`Adicionar ${ee.name}`,children:a.jsx(Ja,{className:"h-4 w-4"})})]})},ee.id)})})})]}),a.jsx("div",{className:"w-2 bg-border hover:bg-brand cursor-col-resize transition-colors flex-shrink-0 mx-2",onMouseDown:()=>Dt(!0),title:"Arraste para redimensionar"}),a.jsxs("div",{className:"flex flex-col border rounded-lg border-border overflow-hidden",style:{width:`${100-yt}%`},children:[a.jsxs("div",{className:"p-3 border-b border-border flex items-center justify-between gap-2 flex-wrap",children:[a.jsxs("div",{className:"min-w-0 flex-shrink",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Comanda"}),a.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[a.jsx("span",{className:"text-base font-bold whitespace-nowrap",children:"Balco"}),x?a.jsx("span",{className:"truncate text-[11px] px-2 py-0.5 rounded-full border border-border bg-surface-2 text-text-secondary",children:x}):null]})]}),a.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0 flex-wrap",children:[a.jsxs(fe,{size:"sm",className:"md:hidden h-8 px-2 text-xs whitespace-nowrap bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",disabled:!D,onClick:()=>{if(!D){e({title:"Caixa Fechado",description:"Abra o caixa antes de adicionar produtos.",variant:"warning"});return}wt(!0)},title:"Adicionar produto",children:[a.jsx(Ja,{className:"h-4 w-4 mr-1"}),"Produto"]}),dr&&a.jsx(fe,{size:"sm",variant:"outline",className:"h-8 px-2 text-xs whitespace-nowrap",disabled:!D,onClick:()=>{if(!D){e({title:"Caixa Fechado",description:"Abra o caixa antes de adicionar clientes.",variant:"warning"});return}It(!0)},children:"+ Cliente"}),dr?a.jsxs(au,{children:[a.jsx(Up,{asChild:!0,children:a.jsx(fe,{size:"sm",className:"h-8 px-2 text-xs whitespace-nowrap bg-red-600 hover:bg-red-500 text-white border border-red-600/70 focus:outline-none focus:ring-0 focus-visible:ring-0 shadow-none",disabled:A,children:A?"Cancelando...":"Cancelar"})}),a.jsxs(md,{className:"sm:max-w-[420px] animate-none",onKeyDown:ee=>ee.stopPropagation(),children:[a.jsxs(hd,{children:[a.jsx(gd,{children:"Cancelar venda do balco?"}),a.jsx(vd,{children:"Os itens sero descartados e a venda ser limpa. Esta ao no pode ser desfeita."})]}),a.jsxs(pd,{children:[a.jsx(xd,{children:"Voltar"}),a.jsx(su,{onClick:In,children:"Confirmar Cancelamento"})]})]})]}):a.jsx(fe,{size:"sm",variant:"outline",className:"h-8 px-2 text-xs opacity-60 cursor-not-allowed whitespace-nowrap",disabled:!0,children:"Cancelar"})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4 thin-scroll",children:dr?l.length===0?a.jsx("div",{className:"text-center text-text-muted pt-16",children:'Comanda vazia. Use o boto "+" para adicionar produtos.'}):a.jsx("ul",{className:"space-y-3 pr-1",children:l.map(ee=>a.jsxs("li",{className:"p-2 rounded-md border border-border/30 bg-surface hover:bg-surface-2 transition-colors",children:[a.jsx("div",{className:"min-w-0 flex-1",children:a.jsx("div",{className:"font-medium truncate",title:ee.name,children:ee.name})}),a.jsxs("div",{className:"mt-1 flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(fe,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:async k=>{k.stopPropagation();const T=r?.codigo_empresa;if(!T){e({title:"Empresa no definida",variant:"destructive"});return}const K=Number(ee.quantity||1)-1;try{K<=0?(await tx({itemId:ee.id,codigoEmpresa:T}),c(H=>H.filter(F=>F.id!==ee.id))):(await dd({itemId:ee.id,quantidade:K,codigoEmpresa:T}),c(H=>H.map(F=>F.id===ee.id?{...F,quantity:K}:F)));try{const H=await Hm({codigoEmpresa:T}),F=new Map;for(const Le of H||[]){const it=Le.produto_id,lt=Number(Le.quantidade||0);F.set(it,(F.get(it)||0)+lt)}M(F)}catch(H){console.error("[BalcaoPage:removeItem] Erro ao atualizar estoque reservado:",H)}}catch(H){const F=String(H?.message||"").toLowerCase();H?.code==="INSUFFICIENT_STOCK"||F.includes("insuficiente")?e({title:"Estoque insuficiente",description:H?.message||"Quantidade maior que o disponvel.",variant:"warning"}):e({title:"Falha ao atualizar item",description:H?.message||"Tente novamente",variant:"destructive"})}},children:"-"}),a.jsx("span",{className:"w-7 text-center font-semibold",children:ee.quantity}),a.jsx(fe,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:async k=>{k.stopPropagation();const T=r?.codigo_empresa;if(!T){e({title:"Empresa no definida",variant:"destructive"});return}const K=Number(ee.quantity||1)+1;try{await dd({itemId:ee.id,quantidade:K,codigoEmpresa:T}),c(H=>H.map(F=>F.id===ee.id?{...F,quantity:K}:F))}catch(H){const F=String(H?.message||"").toLowerCase();H?.code==="INSUFFICIENT_STOCK"||F.includes("insuficiente")?e({title:"Estoque insuficiente",description:H?.message||"Quantidade maior que o disponvel.",variant:"warning"}):e({title:"Falha ao atualizar item",description:H?.message||"Tente novamente",variant:"destructive"})}},children:"+"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("span",{className:"font-semibold whitespace-nowrap",children:["R$ ",(Number(ee.quantity)*Number(ee.price)).toFixed(2)]}),a.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-surface text-text-secondary border border-border",children:["x",ee.quantity]})]})]})]},ee.id))}):a.jsxs("div",{className:"text-center pt-12",children:[a.jsx("div",{className:"text-sm text-text-secondary mb-3",children:"Para comear, inicie uma nova venda e selecione o cliente."}),a.jsx(fe,{disabled:!D,onClick:()=>{if(!D){e({title:"Caixa Fechado",description:"Abra o caixa antes de iniciar uma venda.",variant:"warning"});return}It(!0)},children:"Iniciar nova venda"})]})}),a.jsxs("div",{className:"p-4 border-t border-border",children:[a.jsxs("div",{className:"flex justify-between items-center text-lg font-bold mb-3",children:[a.jsx("span",{children:"Total"}),a.jsxs("span",{children:["R$ ",Dn.toFixed(2)]})]}),a.jsx(fe,{size:"lg",className:"w-full",onClick:ot,disabled:Dn<=0,children:"Finalizar Pagamento"})]})]})]}),a.jsx(mn,{open:te,onOpenChange:Y,children:a.jsxs(un,{className:"sm:max-w-xl w-[92vw] max-h-[90vh] flex flex-col overflow-hidden animate-none",onKeyDown:ee=>ee.stopPropagation(),children:[a.jsxs(on,{children:[a.jsx(an,{className:"text-2xl font-bold",children:"Fechar Conta"}),a.jsx(Nn,{children:"Divida o pagamento entre clientes e vrias finalizadoras, se necessrio."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[a.jsx("span",{children:"Total"}),a.jsxs("span",{children:["R$ ",Dn.toFixed(2)]})]}),a.jsxs("div",{className:"flex-1 space-y-2 overflow-y-auto thin-scroll pr-1",children:[a.jsx(qe,{className:"block",children:"Pagamentos"}),(()=>null)(),(()=>null)(),(ue||[]).map((ee,k)=>{const T=F=>{if(!F)return x||"Cliente";const Le=String(F),it=(gt||[]).find(Vt=>String(Vt.id)===Le);if(it?.nome)return it.nome;const lt=(Me||[]).find(Vt=>String(Vt.id)===Le);return lt?.nome?lt.nome:x||"Cliente"},K=(gt||[]).length>1,H=(gt||[])[0]||null;return(gt||[]).filter(F=>String(F.id)!==String(H?.id||"")),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-12 gap-2 items-start",children:[a.jsx("div",{className:"sm:col-span-1 flex sm:justify-start",children:ue.length>1&&k>0&&a.jsx(fe,{type:"button",variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>{Re(F=>{const Le=F.filter(Ve=>Ve.id!==ee.id);if(Le.length===0)return[];const it=(l||[]).reduce((Ve,kt)=>Ve+Number(kt.quantity||0)*Number(kt.price||0),0),lt=Math.floor(it/Le.length*100)/100,Vt=it-lt*Le.length;return Le.map((Ve,kt)=>{const Sr=kt===Le.length-1?lt+Vt:lt;return St(Ve,Sr)})})},children:a.jsx(al,{className:"h-4 w-4"})})}),k===0?a.jsx("div",{className:"sm:col-span-4",children:a.jsx("div",{className:"h-9 px-3 rounded-md border border-border bg-surface flex items-center text-sm truncate",children:T(H?.id||ee.clientId)})}):K?a.jsx("div",{className:"sm:col-span-4",children:a.jsxs(vn,{value:ee.clientId||"",onValueChange:F=>Re(Le=>Le.map(it=>it.id===ee.id?{...it,clientId:F}:it)),children:[a.jsx(hn,{className:"w-full truncate",children:a.jsx(wn,{placeholder:"Cliente"})}),a.jsx(pn,{children:(gt||[]).map(F=>a.jsx(ct,{value:F.id,children:F.nome},F.id))})]})}):a.jsx("div",{className:"sm:col-span-4",children:a.jsx("div",{className:"h-9 px-3 rounded-md border border-border bg-surface flex items-center text-sm truncate",children:T(H?.id||ee.clientId)})}),a.jsxs("div",{className:"sm:col-span-4",children:[a.jsxs(vn,{value:ee.methodId||"",onValueChange:F=>Re(Le=>Le.map(it=>{if(it.id!==ee.id)return it;const lt=nt(F),Vt=Number(lt?.taxa_percentual||0);if(Vt>0){const kt=Kt(it)*(1+Vt/100);return{...it,methodId:F,chargeFee:!0,value:Tn(kt)}}else{const Ve=Kt(it);return{...it,methodId:F,chargeFee:!1,value:Tn(Ve)}}})),children:[a.jsx(hn,{className:"w-full h-9 truncate",children:a.jsx(wn,{placeholder:"Forma de pagamento"})}),a.jsx(pn,{children:(ce||[]).map(F=>a.jsx(ct,{value:F.id,children:F.nome},F.id))})]}),(()=>{const F=$t(ee);if(!F)return null;const Le=sr(ee),it=!!ee.chargeFee;return a.jsx("div",{className:"mt-1",children:a.jsxs("button",{type:"button",onClick:()=>Re(lt=>lt.map(Vt=>{if(Vt.id!==ee.id)return Vt;const Ve=Kt(Vt);if(!it){const kt=Ve*(1+F/100);return{...Vt,chargeFee:!0,value:Tn(kt)}}return{...Vt,chargeFee:!1,value:Tn(Ve)}})),className:["inline-flex items-center gap-2 px-3 py-1 rounded-sm text-xs font-medium border transition-colors",it?"bg-black text-amber-400 border-amber-500":"bg-surface text-text-secondary border-border hover:border-border-hover"].join(" "),title:it?"Desmarcar taxa":"Cobrar taxa",children:[a.jsx("span",{className:["inline-block h-3 w-3 rounded-sm border",it?"bg-amber-500 border-amber-400":"bg-transparent border-border"].join(" ")}),a.jsxs("span",{children:["Taxa R$ ",Le.toFixed(2)]})]})})})()]}),a.jsx("div",{className:"sm:col-span-3",children:a.jsx(rt,{placeholder:"0,00",inputMode:"numeric",value:ee.value,className:"h-9",onChange:F=>{const Le=(F.target.value||"").replace(/\D/g,""),it=Le?Number(Le)/100:0,lt=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(it);Re(Vt=>Vt.map(Ve=>Ve.id===ee.id?{...Ve,value:lt}:Ve))},onKeyDown:F=>{F.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(F.key)&&(/^[0-9]$/.test(F.key)||F.preventDefault())},onBeforeInput:F=>{const Le=F.data??"";Le&&/\D/.test(Le)&&F.preventDefault()}})})]},ee.id)}),a.jsx("div",{children:a.jsx(fe,{type:"button",variant:"secondary",size:"sm",onClick:()=>{Re(ee=>{const T=Array.isArray(ut)&&ut.length>0?ut:(gt||[]).map(Or=>Or.id),K=new Set(ee.map(Or=>Or.clientId).filter(Boolean)),F=(T||[]).filter(Or=>!K.has(Or))[0]||T[0]||"",Le=ce[0]?.id||"",it=nt(Le),lt=Number(it?.taxa_percentual||0)>0,Vt=[...ee,{id:ne,clientId:F,methodId:Le,value:"",chargeFee:lt}],Ve=(l||[]).reduce((Or,fr)=>Or+Number(fr.quantity||0)*Number(fr.price||0),0),kt=Math.floor(Ve/Vt.length*100)/100,Sr=Ve-kt*Vt.length;return Vt.map((Or,fr)=>{const Kr=fr===Vt.length-1?kt+Sr:kt;return St(Or,Kr)})}),ie(ee=>ee+1)},children:"Adicionar forma"})}),(()=>{const ee=lr(),k=Pt(),H=(l||[]).reduce((F,Le)=>F+Number(Le.quantity||0)*Number(Le.price||0),0)+k-ee;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"text-sm text-text-secondary flex justify-between",children:[a.jsx("span",{children:"Soma"}),a.jsxs("span",{children:["R$ ",ee.toFixed(2)]})]}),a.jsxs("div",{className:"text-sm text-text-secondary flex justify-between",children:[a.jsx("span",{children:"Taxas"}),a.jsxs("span",{children:["R$ ",k.toFixed(2)]})]}),a.jsxs("div",{className:"text-sm font-semibold flex justify-between",children:[a.jsx("span",{children:"Restante"}),a.jsxs("span",{className:Math.abs(H)<.005?"text-success":"text-warning",children:["R$ ",H.toFixed(2)]})]})]})})()]})]}),a.jsxs(Qn,{children:[a.jsx(fe,{variant:"outline",onClick:()=>Y(!1),disabled:ae,children:"Cancelar"}),a.jsx(fe,{onClick:st,disabled:ae,children:ae?"Processando...":"Confirmar Pagamento"})]})]})}),a.jsx(mn,{open:hr,onOpenChange:ee=>It(ee),children:a.jsxs(un,{className:"max-w-lg",onOpenAutoFocus:ee=>ee.preventDefault(),onKeyDown:ee=>ee.stopPropagation(),children:[a.jsxs(on,{children:[a.jsx(an,{className:"text-2xl font-bold",children:"Identificar Cliente"}),a.jsx(Nn,{children:"Selecione um cliente cadastrado para esta venda."})]}),a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"w-full",children:[a.jsx(qe,{className:"mb-1 block",children:"Buscar cliente"}),a.jsxs("div",{className:"flex items-center gap-2 justify-between",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(Zs,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(rt,{placeholder:"Nome, e-mail, telefone ou cdigo",className:"pl-9",value:Nt,onChange:ee=>yr(ee.target.value),onKeyDown:ee=>ee.stopPropagation()})]}),a.jsx(fe,{type:"button",size:"icon",title:"Cadastrar cliente",className:"ml-2 bg-brand text-black hover:bg-brand/90 border border-brand",onClick:()=>{window.location.href="/clientes"},children:a.jsx(Ja,{className:"h-4 w-4"})})]}),a.jsx("div",{className:"mt-2 max-h-48 overflow-auto border rounded-md thin-scroll",children:a.jsxs("ul",{children:[(Me||[]).map(ee=>{const k=(ut||[]).includes(ee.id);return a.jsxs("li",{className:`p-2 flex items-center justify-between cursor-pointer hover:bg-surface-2 ${ee?.codigo===0?"bg-warning/10 border-l-4 border-warning":""} ${k?"bg-surface-2":""}`,onClick:()=>{rr(T=>{const K=new Set(T||[]);K.has(ee.id)?K.delete(ee.id):K.add(ee.id);const H=Array.from(K);try{localStorage.setItem(Qt.pendingClientIds,JSON.stringify(H))}catch{}return H})},children:[a.jsx("div",{children:a.jsxs("div",{className:"font-medium",children:[ee.codigo!=null?String(ee.codigo)+" - ":"",ee.nome,ee?.codigo===0&&a.jsx("span",{className:"ml-2 text-xs text-warning",children:"(Padro)"})]})}),a.jsx(Ro,{size:16,className:k?"text-success":"text-text-muted opacity-40"})]},ee.id)}),(!Me||Me.length===0)&&a.jsx("li",{className:"p-2 text-sm text-text-muted",children:"Nenhum cliente encontrado."})]})})]})}),a.jsxs(Qn,{children:[a.jsx(fe,{variant:"outline",onClick:()=>It(!1),children:"Fechar"}),a.jsx(fe,{onClick:async()=>{try{const ee=Array.from(new Set(ut||[]));if(ee.length===0){e({title:"Selecione pelo menos um cliente",variant:"warning"});return}const k=r?.codigo_empresa;if(n){try{const{data:H,error:F}=await de.from("comandas").select("id").eq("id",n).eq("codigo_empresa",k).single();if(F||!H){console.error("[ClientWizard] Comanda no encontrada:",n),e({title:"Comanda invlida",description:"A comanda no existe mais. Reiniciando...",variant:"warning"}),s(null),c([]),ur(!1),b("");try{localStorage.removeItem(Qt.comandaId),localStorage.removeItem(Qt.items),localStorage.removeItem(Qt.customerName),localStorage.removeItem(Qt.clientChosen)}catch{}It(!1);return}}catch(H){console.error("[ClientWizard] Erro ao validar comanda:",H),e({title:"Erro de validao",variant:"destructive"});return}try{await _b({comandaId:n,clienteIds:ee,nomesLivres:[],codigoEmpresa:k,replace:!0})}catch(H){if(H?.message?.includes("violates foreign key")){console.error("[ClientWizard] Foreign key error, limpando cache:",H),s(null),c([]);try{localStorage.removeItem(Qt.comandaId),localStorage.removeItem(Qt.items)}catch{}e({title:"Comanda invlida",description:"Reinicie a venda.",variant:"destructive"}),It(!1);return}if(!H?.message?.includes("duplicate"))throw H}const K=(await ui({comandaId:n,codigoEmpresa:k})||[]).map(H=>H?.nome).filter(Boolean);b(K.length?K.join(", "):""),ur(!0),It(!1)}else{if(!k){e({title:"Empresa no definida",variant:"destructive"});return}try{h(!0);const T=await m_({codigoEmpresa:k});if(!T?.id){e({title:"Falha ao abrir venda",description:"No foi possvel criar a comanda.",variant:"destructive"});return}const K=T.id;await _b({comandaId:K,clienteIds:ee,nomesLivres:[],codigoEmpresa:k,replace:!0}),s(K);const H=(Me||[]).filter(Le=>ee.includes(Le.id)).map(Le=>Le?.nome).filter(Boolean),F=H.length?H.join(", "):"";b(F),ur(!0);try{localStorage.setItem(Qt.comandaId,String(K)),localStorage.setItem(Qt.customerName,F||""),localStorage.setItem(Qt.clientChosen,"true"),localStorage.removeItem(Qt.pendingClientIds)}catch{}try{await fn(K,2)}catch{}It(!1)}catch(T){console.error("[ClientWizard] Erro ao criar comanda de balco:",T),e({title:"Falha ao iniciar venda",description:T?.message||"Tente novamente.",variant:"destructive"});return}finally{h(!1)}}if(C){const T=C;P(null),await He(T,{skipClientCheck:!0})}}catch(ee){e({title:"Falha ao iniciar venda",description:ee?.message||"Tente novamente",variant:"destructive"})}},children:"Confirmar"})]})]})}),a.jsx(mn,{open:!!Wt,onOpenChange:ee=>!ee&&be(null),children:a.jsx(un,{className:"sm:max-w-[425px]",children:Wt&&a.jsxs(a.Fragment,{children:[a.jsxs(on,{children:[a.jsx(an,{className:"text-lg",children:Wt.name}),a.jsx(Nn,{className:"text-sm",children:"Detalhes do item"})]}),a.jsxs("div",{className:"grid gap-4 py-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-sm font-medium",children:"Preo Unitrio"}),a.jsxs("p",{className:"text-lg font-bold",children:["R$ ",Number(Wt.price).toFixed(2)]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-sm font-medium",children:"Quantidade"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(fe,{size:"sm",variant:"outline",className:"h-8 w-8 p-0",onClick:async ee=>{ee.stopPropagation();const k=r?.codigo_empresa;if(!k){e({title:"Empresa no definida",variant:"destructive"});return}const T=Math.max(0,Wt.quantity-1);try{T<=0?(await tx({itemId:Wt.id,codigoEmpresa:k}),be(null)):(await dd({itemId:Wt.id,quantidade:T,codigoEmpresa:k}),be({...Wt,quantity:T}));const K=await io({comandaId:n,codigoEmpresa:k});c((K||[]).map(H=>({id:H.id,productId:H.produto_id,name:H.descricao||"Item",price:Number(H.preco_unitario||0),quantity:Number(H.quantidade||1)})))}catch(K){e({title:"Erro ao atualizar quantidade",description:K?.message||"Tente novamente",variant:"destructive"})}},children:"-"}),a.jsx("span",{className:"w-8 text-center font-semibold",children:Wt.quantity}),a.jsx(fe,{size:"sm",variant:"outline",className:"h-8 w-8 p-0",onClick:async ee=>{ee.stopPropagation();const k=r?.codigo_empresa;if(!k){e({title:"Empresa no definida",variant:"destructive"});return}const T=Wt.quantity+1;try{await dd({itemId:Wt.id,quantidade:T,codigoEmpresa:k}),be({...Wt,quantity:T});const K=await io({comandaId:n,codigoEmpresa:k});c((K||[]).map(H=>({id:H.id,productId:H.produto_id,name:H.descricao||"Item",price:Number(H.preco_unitario||0),quantity:Number(H.quantidade||1)})))}catch(K){e({title:"Erro ao atualizar quantidade",description:K?.message||"Tente novamente",variant:"destructive"})}},children:"+"})]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-sm font-medium",children:"Subtotal"}),a.jsxs("p",{className:"text-lg font-bold",children:["R$ ",(Wt.quantity*Wt.price).toFixed(2)]})]})]}),a.jsx(Qn,{children:a.jsx(fe,{variant:"destructive",onClick:async()=>{try{const ee=r?.codigo_empresa;if(!ee){e({title:"Empresa no definida",variant:"destructive"});return}await tx({itemId:Wt.id,codigoEmpresa:ee});const k=await io({comandaId:n,codigoEmpresa:ee});c((k||[]).map(T=>({id:T.id,productId:T.produto_id,name:T.descricao||"Item",price:Number(T.preco_unitario||0),quantity:Number(T.quantidade||1)}))),be(null),e({title:"Item removido",variant:"success"})}catch(ee){e({title:"Falha ao remover item",description:ee?.message||"Tente novamente",variant:"destructive"})}},children:"Remover Item"})})]})})}),_e&&a.jsx("div",{className:"fixed left-3 right-3 z-[9999] md:hidden",role:"alert","aria-live":"assertive",style:{bottom:"calc(12px + env(safe-area-inset-bottom, 0px))"},children:a.jsxs("div",{className:"pointer-events-none flex items-start gap-2 rounded-md border border-amber-500 bg-amber-400 text-black px-3 py-2 shadow-lg",children:[a.jsx(Bc,{className:"h-4 w-4 mt-0.5","aria-hidden":"true"}),a.jsx("div",{className:"text-sm font-semibold leading-snug drop-shadow-[0_1px_0_rgba(255,255,255,0.25)]",children:Ue||"Ateno"})]})})]})}async function Bse({userId:e,scope:t}){if(!e||!t)return null;try{const{data:r,error:n}=await de.from("user_ui_settings").select("settings").eq("user_id",e).eq("scope",t).maybeSingle();return n?(console.error("[user_ui_settings] getUserUISettings:error",n),null):r?.settings||null}catch(r){return console.error("[user_ui_settings] getUserUISettings:exception",r),null}}async function qse({userId:e,scope:t,settings:r}){if(!(!e||!t))try{const n={user_id:e,scope:t,settings:r||{},updated_at:new Date().toISOString()},{error:s}=await de.from("user_ui_settings").upsert(n,{onConflict:"user_id,scope"});s&&console.error("[user_ui_settings] saveUserUISettings:error",s)}catch(n){console.error("[user_ui_settings] saveUserUISettings:exception",n)}}function zS(e){try{const r=new DOMParser().parseFromString(e,"text/xml"),n=r.querySelector("parsererror");if(n)throw new Error("XML invlido: "+n.textContent);const s=tst(r),o=rst(r),i=nst(r),l=ast(r),c=i.reduce((u,f)=>u+(f.valorTotal||0),0),d={produtos:i,fornecedor:o,pagamentos:l,nfe:{...s,totalNota:c},success:!0};return console.log("[XMLParser] Resultado final:",d),{data:d,success:!0}}catch(t){return console.error("[XMLParser] Erro ao fazer parse do XML:",t),{produtos:[],fornecedor:null,nfe:null,success:!1,error:t.message}}}function tst(e){const t=e.querySelector("ide");if(!t)return null;let r="";const n=e.querySelector("chNFe");if(n&&(r=n.textContent.trim()),!r){const s=e.querySelector("infNFe");if(s){const o=s.getAttribute("Id");o&&(r=o.replace("NFe",""))}}return{numero:Gn(t,"nNF"),serie:Gn(t,"serie"),dataEmissao:Gn(t,"dhEmi"),chaveAcesso:r,tipo:Gn(t,"tpNF")==="0"?"Entrada":"Sada",naturezaOperacao:Gn(t,"natOp"),modelo:Gn(t,"mod")||null}}function rst(e){const t=e.querySelector("emit");return t?{cnpj:Gn(t,"CNPJ"),razaoSocial:Gn(t,"xNome"),nomeFantasia:Gn(t,"xFant"),endereco:{logradouro:Gn(t,"xLgr"),numero:Gn(t,"nro"),bairro:Gn(t,"xBairro"),cidade:Gn(t,"xMun"),uf:Gn(t,"UF"),cep:Gn(t,"CEP"),codigoIBGE:Gn(t,"cMun"),fone:Gn(t,"fone")},ie:Gn(t,"IE"),iest:Gn(t,"IEST"),im:Gn(t,"IM"),crt:Gn(t,"CRT")}:null}function nst(e){const t=e.querySelectorAll("det"),r=new Map;return t.forEach((n,s)=>{const o=n.querySelector("prod"),i=n.querySelector("imposto");if(!o)return;const l=Gn(o,"cProd"),c=Gn(o,"cEAN"),d=Gn(o,"xProd"),u=parseFloat(Gn(o,"qCom")||"0"),f=c&&c!=="SEM GTIN"?`ean:${c}`:l?`cod:${l}`:`nome:${d.toLowerCase().trim()}`;if(r.has(f)){const h=r.get(f);h.quantidade+=u,h.valorTotal+=parseFloat(Gn(o,"vProd")||"0")}else{const h={codigo:l,ean:c,nome:d,ncm:Gn(o,"NCM"),cest:Gn(o,"CEST"),cfop:Gn(o,"CFOP"),unidade:Gn(o,"uCom"),quantidade:u,valorUnitario:parseFloat(Gn(o,"vUnCom")||"0"),precoVenda:parseFloat(Gn(o,"vUnCom")||"0"),valorTotal:parseFloat(Gn(o,"vProd")||"0"),desconto:parseFloat(Gn(o,"vDesc")||"0"),impostos:ost(i),descricao:d,origem:s+1};r.set(f,h)}}),Array.from(r.values())}function ast(e){const t=e.querySelectorAll("pag"),r=[];return t.forEach(n=>{const s=Gn(n,"tPag"),o=parseFloat(Gn(n,"vPag")||"0");s&&r.push({codigoSefaz:s,valor:o,nome:sst(s)})}),console.log("[XMLParser] Pagamentos extrados:",r),r}function sst(e){return{"01":"Dinheiro","02":"Cheque","03":"Carto de Crdito","04":"Carto de Dbito","05":"Carto da Loja",10:"Vale Alimentao",11:"Vale Refeio",12:"Vale Presente",13:"Vale Combustvel",14:"Duplicata Mercantil",15:"Boleto Bancrio",16:"Depsito Bancrio",17:"PIX Dinmico",18:"Transferncia Bancria",19:"Programa de Fidelidade",20:"PIX Esttico",21:"Crdito em Loja",22:"Pagamento Eletrnico",90:"Sem Pagamento",99:"Outros"}[e]||"Outros"}function ost(e){if(!e)return{};const t={},r=e.querySelector("ICMS");if(r){const i=r.children[0];i&&(t.icms={cst:Gn(i,"CST"),csosn:Gn(i,"CSOSN"),aliquota:parseFloat(Gn(i,"pICMS")||"0"),valor:parseFloat(Gn(i,"vICMS")||"0"),orig:Gn(i,"orig"),fcpAliquota:parseFloat(Gn(i,"pFCP")||"0"),mva:parseFloat(Gn(i,"pMVAST")||"0"),pRedBC:parseFloat(Gn(i,"pRedBC")||"0")})}const n=e.querySelector("PIS");if(n){const i=n.children[0];i&&(t.pis={cst:Gn(i,"CST"),aliquota:parseFloat(Gn(i,"pPIS")||"0"),valor:parseFloat(Gn(i,"vPIS")||"0")})}const s=e.querySelector("COFINS");if(s){const i=s.children[0];i&&(t.cofins={cst:Gn(i,"CST"),aliquota:parseFloat(Gn(i,"pCOFINS")||"0"),valor:parseFloat(Gn(i,"vCOFINS")||"0")})}const o=e.querySelector("IPI");if(o){const i=o.querySelector("IPITrib");i&&(t.ipi={cst:Gn(i,"CST"),aliquota:parseFloat(Gn(i,"pIPI")||"0"),valor:parseFloat(Gn(i,"vIPI")||"0")})}return t}function Gn(e,t){if(!e)return"";const r=e.querySelector(t);return r?r.textContent.trim():""}function US(e,t){const r=e.unidade?.toUpperCase().trim()||"";if(e.ean&&e.ean!=="SEM GTIN"){const s=t.find(i=>{const l=i.unit?.toUpperCase().trim()||"";return i.barcode===e.ean&&l===r});if(s)return s;const o=t.find(i=>i.barcode===e.ean);o&&console.log("[xmlParser] EAN igual mas unidade diferente (no considerar o mesmo produto):",{ean:e.ean,unidadeXML:r,unidadeSistema:(o.unit||"").toUpperCase()})}if(e.codigo){const s=t.find(i=>{const l=i.unit?.toUpperCase().trim()||"";return i.code===e.codigo&&l===r});if(s)return s;const o=t.find(i=>i.code===e.codigo);o&&console.log("[xmlParser] Cdigo igual mas unidade diferente (no considerar o mesmo produto):",{codigo:e.codigo,unidadeXML:r,unidadeSistema:(o.unit||"").toUpperCase()})}const n=e.nome?.toLowerCase().trim()||"";if(n){const s=t.find(o=>{const i=o.name?.toLowerCase().trim()||"",l=o.unit?.toUpperCase().trim()||"",c=i===n,d=l===r,u=c&&d;return c&&!d&&(console.log("[xmlParser] Nome igual mas UNIDADE diferente - NO  o mesmo produto:"),console.log("  Nome XML:",n,"| Unidade XML:",r),console.log("  Nome Sistema:",i,"| Unidade Sistema:",l)),u&&(console.log("[xmlParser] MATCH ENCONTRADO (nome + unidade):"),console.log("  XML:",n,"| Unidade:",r),console.log("  Sistema:",i,"| Unidade:",l),console.log("  Produto:",o)),u});if(s)return console.log("[xmlParser] Produto existente encontrado por nome + unidade:",s.name,s.unit),s}return console.log("[xmlParser] Nenhum produto encontrado para:",n,"| Unidade:",r),null}function u3(e,t){const r=e.valorUnitario||0,n=30,s=r>0?r/(1-n/100):0;return{code:e.codigo||"",name:e.nome||"",barcode:e.ean&&e.ean!=="SEM GTIN"?e.ean:"",ncm:e.ncm||"",cest:e.cest||"",unit:e.unidade||"UN",costPrice:r,salePrice:s,price:s,stock:0,minStock:0,status:"active",active:!0,type:"Venda",category:"Importados",cfopInterno:e.cfop||"",cstIcmsInterno:e.impostos?.icms?.cst||"",csosnInterno:e.impostos?.icms?.csosn||"",aliqIcmsInterno:e.impostos?.icms?.aliquota||0,fcpPercent:e.impostos?.icms?.fcpAliquota||0,mvaPercent:e.impostos?.icms?.mva||0,baseReduzidaPercent:e.impostos?.icms?.pRedBC||0,cstPisEntrada:e.impostos?.pis?.cst||"",aliqPisPercent:e.impostos?.pis?.aliquota||0,aliqCofinsPercent:e.impostos?.cofins?.aliquota||0,cstIpi:e.impostos?.ipi?.cst||"",aliqIpiPercent:e.impostos?.ipi?.aliquota||0,codigo_empresa:t,importedViaXML:!0,dataImportacao:new Date,xmlChave:e?.xmlChave||null,xmlNumero:e?.xmlNumero||null,xmlSerie:e?.xmlSerie||null,xmlEmissao:e?.xmlEmissao||null}}async function ist(e,t){if(!e||!t)return null;const r=e.replace(/\D/g,"");try{const{data:n,error:s}=await de.from("clientes").select("*").eq("codigo_empresa",t).eq("cnpj",r).eq("flag_fornecedor",!0).maybeSingle();if(s)throw s;return n}catch(n){throw console.error("[Suppliers] Erro ao buscar fornecedor:",n),n}}async function lst(e,t){if(!e||!t)throw new Error("Dados do fornecedor e cdigo da empresa so obrigatrios");const r=e.cnpj?.replace(/\D/g,"")||"";if(!r)throw new Error("CNPJ do fornecedor no encontrado no XML");const n={codigo_empresa:t,tipo_pessoa:"PJ",cnpj:r,nome:e.razaoSocial||"Fornecedor Importado",apelido:e.nomeFantasia||e.razaoSocial,flag_fornecedor:!0,flag_cliente:!1,status:"active",endereco:e.endereco?.logradouro||null,numero:e.endereco?.numero||null,complemento:e.endereco?.complemento||null,bairro:e.endereco?.bairro||null,cidade:e.endereco?.cidade||null,uf:e.endereco?.uf||null,cep:e.endereco?.cep?.replace(/\D/g,"")||null,cidade_ibge:e.endereco?.codigoIBGE||null,telefone:e.endereco?.fone||null,ie:e.ie||null,iest:e.iest||null,im:e.im||null};try{const{data:s,error:o}=await de.from("clientes").insert(n).select().single();if(o)throw o;return console.log("[Suppliers] Fornecedor criado:",s),s}catch(s){throw console.error("[Suppliers] Erro ao criar fornecedor:",s),s}}async function cst(e,t){if(!e?.cnpj)throw new Error("CNPJ do fornecedor no encontrado no XML");try{const r=await ist(e.cnpj,t);if(r){console.log("[Suppliers] Fornecedor encontrado:",r.razao_social||r.nome);const s={},o=e.endereco||{},i=l=>l==null||String(l).trim()===""?null:l;return!i(r.ie)&&i(e.ie)&&(s.ie=e.ie),!i(r.iest)&&i(e.iest)&&(s.iest=e.iest),!i(r.im)&&i(e.im)&&(s.im=e.im),!i(r.endereco)&&i(o.logradouro)&&(s.endereco=o.logradouro),!i(r.numero)&&i(o.numero)&&(s.numero=o.numero),!i(r.complemento)&&i(o.complemento)&&(s.complemento=o.complemento),!i(r.bairro)&&i(o.bairro)&&(s.bairro=o.bairro),!i(r.cidade)&&i(o.cidade)&&(s.cidade=o.cidade),!i(r.uf)&&i(o.uf)&&(s.uf=o.uf),!i(r.cep)&&i(o.cep)&&(s.cep=String(o.cep).replace(/\D/g,"")),!i(r.cidade_ibge)&&i(o.codigoIBGE)&&(s.cidade_ibge=o.codigoIBGE),!i(r.telefone)&&i(o.fone)&&(s.telefone=o.fone),!i(r.nome)&&i(e.razaoSocial)&&(s.nome=e.razaoSocial),!i(r.apelido)&&(i(e.nomeFantasia)||i(e.razaoSocial))&&(s.apelido=e.nomeFantasia||e.razaoSocial),Object.keys(s).length>0?(await de.from("clientes").update(s).eq("id",r.id),console.log("[Suppliers] Fornecedor atualizado com campos faltantes:",s),{...r,...s}):r}return console.log("[Suppliers] Criando novo fornecedor:",e.razaoSocial),await lst(e,t)}catch(r){throw console.error("[Suppliers] Erro ao buscar/criar fornecedor:",r),r}}async function dst(e){if(!e)return[];try{const{data:t,error:r}=await de.from("clientes").select("*").eq("codigo_empresa",e).eq("flag_fornecedor",!0).order("nome",{ascending:!0});if(r)throw r;return t||[]}catch(t){return console.error("[Suppliers] Erro ao listar fornecedores:",t),[]}}async function ust(e,t){if(!e||!t)return null;try{const{data:r,error:n}=await de.from("compras").select("*").eq("codigo_empresa",t).eq("chave_nfe",e).order("ativo",{ascending:!1}).maybeSingle();if(n)throw n;return r}catch(r){throw console.error("[Purchases] Erro ao buscar compra:",r),r}}async function fst(e){const t={codigo_empresa:e.codigoEmpresa,fornecedor_id:e.fornecedorId,chave_nfe:e.chaveNfe,numero_nfe:e.numeroNfe,serie_nfe:e.serieNfe,data_emissao:e.dataEmissao,tipo_operacao:e.tipoOperacao,natureza_operacao:e.naturezaOperacao,valor_produtos:e.valorProdutos,valor_total:e.valorTotal,forma_pagamento:e.formaPagamento||null,status:"processada",observacoes:e.observacoes||null,xml_completo:e.xmlCompleto||null};try{const{data:r,error:n}=await de.from("compras").insert(t).select().single();if(n)throw n;return console.log("[Purchases] Compra criada:",r.numero_nfe,"ID:",r.id),r}catch(r){throw console.error("[Purchases] Erro ao criar compra:",r),r}}async function zse(e,t){if(!e||!t||t.length===0)throw new Error("ID da compra e itens so obrigatrios");const r=t.map(n=>({compra_id:e,produto_id:n.produtoId||null,codigo_produto_xml:n.codigoProdutoXML||null,nome_produto_xml:n.nomeProdutoXML,ean_xml:n.eanXML||null,ncm_xml:n.ncmXML||null,cfop_xml:n.cfopXML||null,unidade_xml:n.unidadeXML||null,quantidade:n.quantidade,valor_unitario:n.valorUnitario,valor_total:n.valorTotal,valor_desconto:n.valorDesconto||0,valor_frete:n.valorFrete||0,valor_seguro:n.valorSeguro||0,valor_outras_despesas:n.valorOutrasDespesas||0,icms_aliquota:n.icmsAliquota||null,icms_valor:n.icmsValor||null,ipi_aliquota:n.ipiAliquota||null,ipi_valor:n.ipiValor||null,pis_aliquota:n.pisAliquota||null,pis_valor:n.pisValor||null,cofins_aliquota:n.cofinsAliquota||null,cofins_valor:n.cofinsValor||null,vinculado_manualmente:n.vinculadoManualmente||!1,observacoes:n.observacoes||null,selecionado_na_importacao:n.selecionadoNaImportacao||!1}));try{const{data:n,error:s}=await de.from("compras_itens").insert(r).select();if(s)throw s;return console.log("[Purchases] Itens criados:",n.length),n}catch(n){throw console.error("[Purchases] Erro ao criar itens:",n),n}}async function mst(e,t={}){if(!e)return{data:[],count:0};try{const r=t.page&&t.page>0?t.page:1,n=t.pageSize&&t.pageSize>0?t.pageSize:100,s=(r-1)*n,o=s+n-1;let i=de.from("compras").select("*,fornecedor:clientes!compras_fornecedor_id_fkey(id,nome,cnpj)",{count:"exact"}).eq("codigo_empresa",e);t.apenasInativas?i=i.eq("ativo",!1):t.incluirInativas||(i=i.eq("ativo",!0)),t.status&&(i=i.eq("status",t.status)),t.fornecedorId&&(i=i.eq("fornecedor_id",t.fornecedorId)),t.dataInicio&&(i=i.gte("data_emissao",t.dataInicio)),t.dataFim&&(i=i.lte("data_emissao",t.dataFim)),i=i.order("data_emissao",{ascending:!1}).range(s,o);const{data:l,error:c,count:d}=await i;if(c)throw c;return{data:l||[],count:d??0}}catch(r){return console.error("[Purchases] Erro ao listar compras:",r),{data:[],count:0}}}async function Use(e){try{const{data:t,error:r}=await de.from("compras_itens").select(`
        *,
        produto:produto_id(id, nome, codigo_produto, codigo_barras, data_importacao)
      `).eq("compra_id",e).order("criado_em",{ascending:!0});if(r)throw console.error("[Purchases] Erro ao buscar itens:",r),r;return t}catch(t){throw console.error("[Purchases] Erro ao buscar itens:",t),t}}async function hst(e,t,r){if(!e||!t)throw new Error("ID da compra e motivo so obrigatrios");try{const{data:n,error:s}=await de.from("compras").update({ativo:!1,motivo_inativacao:t,inativado_em:new Date().toISOString(),inativado_por:r}).eq("id",e).select().single();if(s)throw s;return console.log("[Purchases] Compra inativada:",e),n}catch(n){throw console.error("[Purchases] Erro ao inativar compra:",n),n}}async function pst(e){try{console.log("[Purchases] Deletando itens da compra:",e);const{error:t}=await de.from("compras_itens").delete().eq("compra_id",e);if(t)throw console.error("[Purchases] Erro ao deletar itens:",t),t;return console.log("[Purchases] Itens deletados com sucesso"),!0}catch(t){throw console.error("[Purchases] Erro ao deletar itens:",t),t}}async function gst(e,t){try{return console.log("[Purchases] Reprocessando XML da compra:",e),await pst(e),await zse(e,t),console.log("[Purchases] XML reprocessado com sucesso"),!0}catch(r){throw console.error("[Purchases] Erro ao reprocessar XML:",r),r}}async function vst(e,t){try{console.log("[Purchases] Atualizando compra:",e,t);const{data:r,error:n}=await de.from("compras").update({fornecedor_id:t.fornecedorId,numero_nfe:t.numeroNfe,serie_nfe:t.serieNfe,data_emissao:t.dataEmissao,tipo_operacao:t.tipoOperacao,natureza_operacao:t.naturezaOperacao,valor_produtos:t.valorProdutos,valor_total:t.valorTotal,forma_pagamento:t.formaPagamento,observacoes:t.observacoes,atualizado_em:new Date().toISOString()}).eq("id",e).select().single();if(n)throw console.error("[Purchases] Erro ao atualizar compra:",n),n;return console.log("[Purchases] Compra atualizada:",r),r}catch(r){throw console.error("[Purchases] Erro ao atualizar compra:",r),r}}function Vse({isOpen:e,onClose:t,onSelect:r,currentProduct:n}){const{userProfile:s}=ms(),[o,i]=p.useState([]),[l,c]=p.useState(!0),[d,u]=p.useState(""),[f,h]=p.useState(null);p.useEffect(()=>{e&&s?.codigo_empresa&&m()},[e,s?.codigo_empresa]);const m=async()=>{try{c(!0),console.log("[ProductSelectionModal] Carregando produtos para empresa:",s.codigo_empresa);const x=await bu({codigoEmpresa:s.codigo_empresa,includeInactive:!1,search:""});console.log("[ProductSelectionModal] Produtos carregados:",x?.length||0),console.log("[ProductSelectionModal] Primeiro produto:",x?.[0]),console.log("[ProductSelectionModal] Estrutura do produto:",Object.keys(x?.[0]||{})),i(x||[])}catch(x){console.error("[ProductSelectionModal] Erro ao carregar produtos:",x),i([])}finally{c(!1)}},v=p.useMemo(()=>{if(console.log("[ProductSelectionModal] Filtrando produtos. Total:",o.length,"Busca:",d),!d.trim())return o;const x=d.toLowerCase().trim(),b=o.filter(w=>(w.name||w.nome)?.toLowerCase().includes(x)||(w.code||w.codigo_produto)?.toLowerCase().includes(x)||(w.barcode||w.codigo_barras)?.toLowerCase().includes(x));return console.log("[ProductSelectionModal] Produtos filtrados:",b.length),b},[o,d]),g=()=>{f?(console.log("[ProductSelectionModal] Produto selecionado para vinculao:",f),console.log("[ProductSelectionModal] ID do produto:",f.id),console.log("[ProductSelectionModal] Nome do produto:",f.name),r(f),y()):console.log("[ProductSelectionModal] ERRO: Nenhum produto selecionado")},y=()=>{u(""),h(null),t()};return a.jsx(mn,{open:e,onOpenChange:y,children:a.jsxs(un,{className:"w-[95vw] sm:max-w-3xl max-h-[80vh] overflow-hidden flex flex-col bg-black text-white border border-neutral-700",children:[a.jsxs(on,{className:"bg-neutral-900 -mx-6 -mt-6 mb-4 px-6 py-4 border-b border-neutral-600",children:[a.jsxs(an,{className:"flex items-center gap-2 text-white",children:[a.jsx(Td,{className:"h-5 w-5 text-yellow-500"}),"Selecionar Produto para Vinculao"]}),a.jsx(Nn,{className:"text-neutral-300",children:"Busque e selecione um produto cadastrado para vincular ao item do XML"})]}),a.jsx("div",{className:"px-6 pb-4",children:a.jsxs("div",{className:"relative",children:[a.jsx(Zs,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-neutral-400"}),a.jsx(rt,{placeholder:"Buscar por nome, cdigo do produto ou cdigo de barras...",value:d,onChange:x=>u(x.target.value),className:"pl-10 bg-neutral-900 border-neutral-600 text-white placeholder-neutral-400 focus:border-yellow-500",autoFocus:!0})]})}),a.jsx("div",{className:"flex-1 overflow-hidden flex flex-col px-6",children:l?a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-500 mb-4"}),a.jsx("p",{className:"text-neutral-400",children:"Carregando produtos..."})]})}):v.length===0?a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Td,{className:"h-12 w-12 text-neutral-400 mx-auto mb-4"}),a.jsx("p",{className:"text-neutral-400",children:d?"Nenhum produto encontrado":"Nenhum produto cadastrado"}),d&&a.jsx("p",{className:"text-sm text-neutral-500 mt-2",children:"Tente buscar por nome, cdigo ou cdigo de barras"})]})}):a.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:a.jsx("ul",{className:"space-y-2",children:v.map(x=>{const b=x.code||x.codigo_produto,w=x.name||x.nome||"Produto sem nome",j=x.stock||x.estoque||0,_=Number(x.salePrice||x.preco_venda||0),S=f?.id===x.id;return a.jsxs("li",{className:`flex items-center gap-3 p-3 rounded-lg transition-all cursor-pointer border-2 ${S?"border-yellow-500 bg-yellow-500/10":"border-neutral-600 bg-black hover:border-yellow-400 hover:bg-neutral-900"}`,onClick:()=>h(x),children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"flex items-center gap-2 mb-1",children:a.jsxs("p",{className:"font-semibold text-white truncate",title:`${b?`[${b}] `:""}${w}`,children:[b&&a.jsxs("span",{className:"text-neutral-400",children:["[",b,"]"]})," ",w]})}),a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsxs("p",{className:"text-sm text-neutral-300",children:["R$ ",_.toFixed(2)]}),a.jsxs("span",{className:"text-xs font-medium text-neutral-400 whitespace-nowrap",children:["Estoque: ",j]})]})]}),S&&a.jsx(Yf,{className:"h-5 w-5 text-yellow-500 flex-shrink-0"})]},x.id)})})})}),a.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-neutral-600 px-6 pb-6",children:[a.jsxs("div",{className:"text-sm text-neutral-400",children:[v.length," produto",v.length!==1?"s":"",d&&` encontrado${v.length!==1?"s":""}`]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(fe,{variant:"outline",onClick:y,className:"border-neutral-600 text-neutral-300 hover:bg-neutral-700",children:"Cancelar"}),a.jsxs(fe,{onClick:g,disabled:!f,className:"gap-2 bg-yellow-600 hover:bg-yellow-700 text-black",children:[a.jsx(Yf,{className:"h-4 w-4"}),"Vincular Produto"]})]})]})]})})}function Wse({isOpen:e,onClose:t,onConfirm:r,products:n,editedProducts:s,isReprocess:o=!1,allProducts:i=[]}){if(!e||!n)return null;const l=n.filter(d=>d.selected),c=l.reduce((d,u,f)=>{const h=u.originalIndex!==void 0?u.originalIndex:f,m=s[h]||{},v=m.linkedProductId,g=m.updatePrice,y=Number(m.quantity||m.qty||u.xml?.quantidade||0);let x=0;if(m.salePrice!=null?x=Number(m.salePrice):m.margin!=null&&u.xml?.valorUnitario?x=Number(u.xml.valorUnitario)*(1+m.margin/100):u.xml?.precoVenda&&(x=Number(u.xml.precoVenda)),u.isNew&&!v)d.newProducts.push({name:m.name||u.xml?.nome,quantity:y,price:x,total:y*(u.xml?.valorUnitario||0),xmlName:u.xml?.nome});else if(v||u.existing){const b=v&&i.find(C=>C.id===v)||u.existing,w=Number(b?.stock||0),j=Number(b?.preco_venda||b?.salePrice||b?.price||0),_=o?0:y,S=o?w:w+y;d.updatedProducts.push({name:b?.name||m.name||u.xml?.nome,currentStock:w,newStock:S,stockChange:_,currentPrice:j,newPrice:g?x:j,priceChange:g?x-j:0,willUpdatePrice:g,total:y*(u.xml?.valorUnitario||0),xmlName:u.xml?.nome,isLinked:!!v,linkedProductId:v,linkedProductName:v?b?.name:null})}else v&&d.linkedProducts.push({xmlName:u.xml?.nome,linkedName:m.name||u.xml?.nome,quantity:y,total:y*(u.xml?.valorUnitario||0),linkedProductId:v});return d.totalValue+=y*(u.xml?.valorUnitario||0),d.totalItems+=y,d},{newProducts:[],updatedProducts:[],linkedProducts:[],totalValue:0,totalItems:0});return a.jsx(mn,{open:e,onOpenChange:t,children:a.jsxs(un,{className:"max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsx(on,{children:a.jsxs(an,{className:"flex items-center gap-2",children:[a.jsx(Xf,{className:"h-5 w-5 text-warning"}),"Confirmar ",o?"Reprocessamento":"Importao"]})}),a.jsxs("div",{className:"flex-1 overflow-y-auto space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-surface border border-border rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-primary mb-2",children:[a.jsx(Td,{className:"h-4 w-4 text-warning"}),a.jsx("span",{className:"font-medium",children:"Total de Produtos"})]}),a.jsx("p",{className:"text-2xl font-bold text-text-primary",children:l.length})]}),a.jsxs("div",{className:"bg-surface border border-border rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-primary mb-2",children:[a.jsx(Aue,{className:"h-4 w-4 text-warning"}),a.jsx("span",{className:"font-medium",children:"Total de Itens"})]}),a.jsx("p",{className:"text-2xl font-bold text-text-primary",children:c.totalItems})]}),a.jsxs("div",{className:"bg-surface border border-border rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-primary mb-2",children:[a.jsx(ei,{className:"h-4 w-4 text-warning"}),a.jsx("span",{className:"font-medium",children:"Valor Total"})]}),a.jsxs("p",{className:"text-2xl font-bold text-text-primary",children:["R$ ",c.totalValue.toFixed(2)]})]})]}),!o&&c.newProducts.length>0&&a.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[a.jsx("div",{className:"p-4 border-b border-border",children:a.jsxs("h3",{className:"font-semibold text-text-primary flex items-center gap-2",children:[a.jsx(Ja,{className:"h-4 w-4 text-success"}),"Produtos que sero criados (",c.newProducts.length,")"]})}),a.jsx("div",{className:"p-4 space-y-3",children:c.newProducts.map((d,u)=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-surface-2 rounded-lg border border-border",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-text-primary",children:d.name}),a.jsxs("p",{className:"text-sm text-text-muted",children:["Quantidade: ",d.quantity,"  Preo unit.: R$ ",(d.total/d.quantity).toFixed(2),"  Total: R$ ",d.total.toFixed(2)]})]}),a.jsx("div",{className:"text-right",children:a.jsxs("p",{className:"font-medium text-warning",children:["R$ ",d.total.toFixed(2)]})})]},u))})]}),!o&&c.updatedProducts.length>0&&a.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[a.jsx("div",{className:"p-4 border-b border-border",children:a.jsxs("h3",{className:"font-semibold text-text-primary flex items-center gap-2",children:[a.jsx(Jp,{className:"h-4 w-4 text-info"}),"Produtos que sero atualizados (",c.updatedProducts.length,")"]})}),a.jsx("div",{className:"p-4 space-y-3",children:c.updatedProducts.map((d,u)=>a.jsx("div",{className:"p-3 bg-surface-2 rounded-lg border border-border",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[d.isLinked?a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(ZH,{className:"h-4 w-4 text-warning"}),a.jsxs("p",{className:"font-medium text-text-primary",children:[d.xmlName,"  ",d.linkedProductName||d.name]})]}):a.jsx("p",{className:"font-medium text-text-primary",children:d.name}),a.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[o?a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-text-muted",children:"Estoque:"}),a.jsx("span",{className:"font-medium text-text-primary",children:d.currentStock}),a.jsx("span",{className:"text-text-muted",children:"(sem alterao no reprocesso)"})]}):a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-text-muted",children:"Estoque:"}),a.jsx("span",{className:"font-medium text-text-primary",children:d.currentStock}),a.jsx(Jf,{className:"h-3 w-3 text-success"}),a.jsx("span",{className:"font-medium text-success",children:d.newStock}),a.jsxs("span",{className:"text-success",children:["(+",d.stockChange,")"]})]}),d.willUpdatePrice&&d.priceChange!==0&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-text-muted",children:"Preo:"}),a.jsxs("span",{className:"font-medium text-text-primary",children:["R$ ",d.currentPrice.toFixed(2)]}),d.priceChange>0?a.jsx(Jf,{className:"h-3 w-3 text-success"}):a.jsx(Uue,{className:"h-3 w-3 text-destructive"}),a.jsxs("span",{className:`font-medium ${d.priceChange>0?"text-success":"text-destructive"}`,children:["R$ ",d.newPrice.toFixed(2)]}),a.jsxs("span",{className:d.priceChange>0?"text-success":"text-destructive",children:["(",d.priceChange>0?"+":"","R$ ",d.priceChange.toFixed(2),")"]})]})]})]}),a.jsxs("div",{className:"text-right",children:[o?a.jsxs("p",{className:"text-xs text-text-muted",children:["Total NF-e (custo): R$ ",d.total.toFixed(2)]}):a.jsxs("p",{className:"text-xs text-text-muted",children:["Unit.: R$ ",(d.total/d.stockChange).toFixed(2)]}),a.jsxs("p",{className:"font-medium text-warning",children:["R$ ",d.total.toFixed(2)]})]})]})},u))})]}),o&&a.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[a.jsx("div",{className:"p-4 border-b border-border",children:a.jsxs("h3",{className:"font-semibold text-text-primary flex items-center gap-2",children:[a.jsx(Jp,{className:"h-4 w-4 text-info"}),"Itens da NF-e que sero reprocessados (",l.length,")"]})}),a.jsx("div",{className:"p-4 space-y-3",children:l.map((d,u)=>{const f=d.originalIndex!==void 0?d.originalIndex:u,h=s[f]||{},m=Number(h.quantity||h.qty||d.xml?.quantidade||0),v=Number(d.xml?.valorUnitario||0),g=m*v;return a.jsxs("div",{className:"flex items-center justify-between p-3 bg-surface-2 rounded-lg border border-border",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-text-primary",children:d.xml?.nome}),a.jsxs("p",{className:"text-sm text-text-muted",children:["Quantidade: ",m,"  Valor unit.: R$ ",v.toFixed(2),"  Total: R$ ",g.toFixed(2)]})]}),a.jsx("div",{className:"text-right",children:a.jsxs("p",{className:"font-medium text-warning",children:["R$ ",g.toFixed(2)]})})]},u)})})]}),a.jsx("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Xf,{className:"h-5 w-5 text-warning flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-warning mb-2",children:o?"Ateno - Reprocessamento":"Ateno - Importao"}),a.jsxs("ul",{className:"text-sm text-text-muted space-y-1",children:[o?a.jsxs(a.Fragment,{children:[a.jsx("li",{children:" Os itens atuais da compra sero substitudos pelos selecionados"}),a.jsx("li",{children:" As quantidades de estoque sero ajustadas conforme as mudanas"}),a.jsx("li",{children:" Esta ao no pode ser desfeita automaticamente"})]}):a.jsxs(a.Fragment,{children:[a.jsx("li",{children:" Os produtos selecionados sero criados ou atualizados no sistema"}),a.jsx("li",{children:" As quantidades sero adicionadas ao estoque atual"}),a.jsx("li",{children:" Uma nova compra ser registrada no histrico"})]}),a.jsx("li",{children:" Verifique cuidadosamente as informaes antes de confirmar"})]})]})]})})]}),a.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-border",children:[a.jsxs("div",{className:"text-sm text-text-muted",children:[l.length," produto",l.length!==1?"s":""," selecionado",l.length!==1?"s":""]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(fe,{variant:"outline",onClick:t,children:"Cancelar"}),a.jsxs(fe,{onClick:r,className:"gap-2",children:[a.jsx(Jp,{className:"h-4 w-4"}),"Confirmar ",o?"Reprocessamento":"Importao"]})]})]})]})})}function xst({open:e,onOpenChange:t,products:r,codigoEmpresa:n,onSuccess:s}){const{toast:o}=Qa(),[i,l]=p.useState("upload"),[c,d]=p.useState(null),[u,f]=p.useState(null),[h,m]=p.useState([]),[v,g]=p.useState(!1),[y,x]=p.useState({created:0,updated:0,errors:0,details:[]}),[b,w]=p.useState({}),[j,_]=p.useState({}),[S,C]=p.useState({isOpen:!1,productIndex:null,currentProduct:null}),[P,A]=p.useState({isOpen:!1}),R=()=>{const B=u?.nfe?.modelo;return B==="55"?"NF-e":B==="65"?"NFC-e":"NF-e / NFC-e"},O=async B=>{const Q=B.target.files?.[0];if(!Q){console.log("[XMLImport] Nenhum arquivo selecionado");return}if(console.log("[XMLImport] Arquivo selecionado:",Q.name),!Q.name.endsWith(".xml")){o({title:"Arquivo invlido",description:"Selecione um arquivo XML vlido.",variant:"destructive"});return}d(Q);try{console.log("[XMLImport] Lendo contedo do arquivo...");const pe=await Q.text();console.log("[XMLImport] Arquivo lido, parseando XML...");const te=zS(pe);if(console.log("[XMLImport] XML parseado:",te),!te.success){o({title:"Erro ao ler XML",description:te.error||"XML invlido",variant:"destructive"});return}if(!te.data?.produtos||te.data.produtos.length===0){o({title:"Nenhum produto encontrado",description:"O XML no contm produtos.",variant:"warning"});return}f(te.data);let Y=r;try{Y=await bu({search:"",codigoEmpresa:n,includeInactive:!0})||r,console.log("[XMLImport] Produtos carregados para validao:",Y.length),console.log("[XMLImport] Nomes dos produtos:",Y.map(le=>le.name))}catch(ae){console.warn("[XMLImport] No foi possvel carregar lista completa, usando cache:",ae)}const ce=te.data.produtos.map((ae,le)=>{const ue=US(ae,Y),Re={...ae};if(ae.impostos){const{icms:ne,pis:ie,cofins:gt,ipi:bt}=ae.impostos;ne&&(Re.icmsAliquota=ne.aliquota??Re.icmsAliquota,Re.icmsValor=ne.valor??Re.icmsValor),bt&&(Re.ipiAliquota=bt.aliquota??Re.ipiAliquota,Re.ipiValor=bt.valor??Re.ipiValor),ie&&(Re.pisAliquota=ie.aliquota??Re.pisAliquota,Re.pisValor=ie.valor??Re.pisValor),gt&&(Re.cofinsAliquota=gt.aliquota??Re.cofinsAliquota,Re.cofinsValor=gt.valor??Re.cofinsValor)}return{xml:Re,existing:ue,isNew:!ue,willCreate:!ue,willUpdate:!!ue,selected:!0,index:le}});m(ce);const me={};ce.forEach((ae,le)=>{ae.xml.precoVenda&&(me[le]={salePrice:Number(ae.xml.precoVenda)})}),console.log("[XMLImport] Pr-populando editedProducts:",me),w(me),console.log("[XMLImport] Preview preparado, mudando para step preview. Total produtos:",ce.length),l("preview")}catch(pe){console.error("[XMLImport] Erro ao processar arquivo:",pe),o({title:"Erro ao processar XML",description:pe.message,variant:"destructive"})}},I=()=>{A({isOpen:!0})},M=async()=>{A({isOpen:!1});let B="";if(c)try{B=await c.text()}catch(Y){console.error("[XMLImport] Erro ao ler XML:",Y),o({title:"Erro ao ler XML",description:"No foi possvel ler o arquivo XML.",variant:"destructive"});return}l("processing"),g(!0);const Q={created:0,updated:0,errors:0,skipped:0,details:[],supplierId:null},pe=h.filter(Y=>Y.selected);if(pe.length===0){o({title:"Nenhum produto selecionado",description:"Selecione ao menos um produto para importar.",variant:"warning"}),g(!1),l("preview");return}let te=null;if(u?.fornecedor)try{te=await cst(u.fornecedor,n),Q.supplierId=te.id,console.log("[XMLImport] Fornecedor processado:",te.razao_social,"ID:",te.id)}catch(Y){console.error("[XMLImport] Erro ao processar fornecedor:",Y),o({title:"Aviso",description:"No foi possvel criar/vincular o fornecedor, mas os produtos sero importados.",variant:"warning"})}console.log("[XMLImport] Processando apenas produtos selecionados:",pe.length);for(const Y of pe){const ce=b[Y.index]||{},me=ce.name||Y.xml.nome,ae=ce.qty!==void 0?ce.qty:Number(Y.xml.quantidade),le=ce.margin,ue=ce.salePrice,Re=ce.linkedProductId;try{if(Re&&Re!=="force-new"){ae>0&&await bx({productId:Re,delta:ae,codigoEmpresa:n}),Q.updated++,Q.details.push({produto:me,acao:`Vinculado - Estoque atualizado (+${ae})`,status:"success"});continue}if(Y.isNew||Re==="force-new"){const ne=u3(Y.xml,n);if(ce.name&&(ne.name=ce.name),ue!=null)ne.salePrice=ue,ne.price=ue;else if(le!=null&&le>0){const ie=ne.costPrice||0;if(ie>0){const gt=ie*(1+le/100);ne.salePrice=gt,ne.price=gt}}else ne.salePrice!=null&&ne.price==null&&(ne.price=ne.salePrice);ne.stock=ae,ne.initialStock=ae,ne.currentStock=ae,ne.importedViaXML=!0,ne.category="Importados",u?.nfe&&(ne.xmlChave=u.nfe.chaveAcesso||null,ne.xmlNumero=u.nfe.numero||null,ne.xmlSerie=u.nfe.serie||null,ne.xmlEmissao=u.nfe.dataEmissao||null);try{await qS(ne,{codigoEmpresa:n}),Q.created++,Q.details.push({produto:me,acao:"Criado",status:"success"})}catch(ie){if(ie.message?.includes("duplicate")||ie.message?.includes("unique constraint")){console.warn("[XMLImport] Produto j existe, tentando atualizar estoque:",Y.xml.nome);const bt=(await bu({search:Y.xml.nome,codigoEmpresa:n,includeInactive:!0})).find(at=>{const xt=(at.name||"").toLowerCase().trim()===(Y.xml.nome||"").toLowerCase().trim(),Ze=(at.unit||"").toUpperCase().trim()===(Y.xml.unidade||"").toUpperCase().trim(),ht=(at.barcode||"")===(Y.xml.ean||""),Wt=(at.code||"")===(Y.xml.codigo||""),be=xt&&Ze||ht&&Ze||Wt&&Ze;return!be&&(ht||Wt)&&!Ze&&console.log("[XMLImport] Encontrado mesmo EAN/Cdigo porm unidade diferente. NO unir:",{nomeSistema:at.name,unidadeSistema:at.unit,nomeXML:Y.xml.nome,unidadeXML:Y.xml.unidade,ean:Y.xml.ean,codigo:Y.xml.codigo}),be});if(bt&&Number(Y.xml.quantidade)>0)await bx({productId:bt.id,delta:Number(Y.xml.quantidade)||0,codigoEmpresa:n}),Q.updated++,Q.details.push({produto:Y.xml.nome,acao:"J existe - Estoque atualizado",status:"success"});else if(bt)Q.skipped++,Q.details.push({produto:Y.xml.nome,acao:"Sem quantidade para ajustar",status:"warning"});else try{console.log("[XMLImport] Duplicate report mas no encontrou por nome+unidade/EAN+unidade/cdigo+unidade. Tentando criar novo produto.");const at=u3(Y.xml,n);at.salePrice!=null&&at.price==null&&(at.price=at.salePrice);const xt=Number(Y.xml.quantidade)||0;at.stock=xt,at.initialStock=xt,at.currentStock=xt,await qS(at,{codigoEmpresa:n}),Q.created++,Q.details.push({produto:Y.xml.nome,acao:"Criado aps checagem",status:"success"})}catch(at){console.warn("[XMLImport] Falhou ao criar aps duplicate:",at),Q.skipped++,Q.details.push({produto:Y.xml.nome,acao:"Falha ao criar aps duplicate",status:"warning"})}}else throw ie}}else{const ne=Number(Y.xml.quantidade)||0;if(ne>0&&await bx({productId:Y.existing.id,delta:ne,codigoEmpresa:n}),ce.updatePrice===!0){const gt=Number(Y.xml.valorUnitario)||0;if(gt>0)try{const bt={costPrice:gt};if(ue!=null)bt.salePrice=ue,bt.price=ue;else if(le!=null&&le>0){const at=gt*(1+le/100);bt.salePrice=at,bt.price=at}await u1(Y.existing.id,bt)}catch(bt){console.warn("[XMLImport] Falha ao atualizar preo do produto existente",bt)}}try{const gt=Y.existing||{},bt=Y.xml.impostos||{},at=bt.icms||{},xt=bt.pis||{},Ze=bt.cofins||{},ht=bt.ipi||{},Wt={},be=Ct=>Ct==null||typeof Ct=="string"&&Ct.trim()==="";be(gt.ncm)&&Y.xml.ncm&&(Wt.ncm=Y.xml.ncm),be(gt.cfopInterno)&&Y.xml.cfop&&(Wt.cfopInterno=Y.xml.cfop),be(gt.cstIcmsInterno)&&at.cst&&(Wt.cstIcmsInterno=at.cst),be(gt.csosnInterno)&&at.csosn&&(Wt.csosnInterno=at.csosn),be(gt.cstIpi)&&ht.cst&&(Wt.cstIpi=ht.cst),be(gt.cstPisEntrada)&&xt.cst&&(Wt.cstPisEntrada=xt.cst),gt.aliqIcmsInterno==null&&Number(at.aliquota||0)>0&&(Wt.aliqIcmsInterno=Number(at.aliquota)),gt.aliqIpiPercent==null&&Number(ht.aliquota||0)>=0&&(Wt.aliqIpiPercent=Number(ht.aliquota)),gt.aliqPisPercent==null&&Number(xt.aliquota||0)>=0&&(Wt.aliqPisPercent=Number(xt.aliquota)),gt.aliqCofinsPercent==null&&Number(Ze.aliquota||0)>=0&&(Wt.aliqCofinsPercent=Number(Ze.aliquota)),gt.fcpPercent==null&&Number(at.fcpAliquota||0)>0&&(Wt.fcpPercent=Number(at.fcpAliquota)),gt.mvaPercent==null&&Number(at.mva||0)>0&&(Wt.mvaPercent=Number(at.mva)),gt.baseReduzidaPercent==null&&Number(at.pRedBC||0)>0&&(Wt.baseReduzidaPercent=Number(at.pRedBC)),Object.keys(Wt).length>0&&(await u1(Y.existing.id,Wt),console.log("[XMLImport] Produto existente atualizado com fiscais faltantes",{id:Y.existing.id,patch:Wt}))}catch(gt){console.warn("[XMLImport] Falha ao completar fiscais no produto existente",gt)}Q.updated++,Q.details.push({produto:Y.xml.nome,acao:ne>0?`Estoque +${ne} (somado)`:"Verificado",status:"success"})}}catch(ne){console.error("[XMLImport] Erro ao processar produto:",Y.xml.nome,ne),Q.errors++,Q.details.push({produto:Y.xml.nome,acao:"Erro",status:"error",error:ne.message})}}if(u?.nfe?.chaveAcesso&&te)try{const Y=await ust(u.nfe.chaveAcesso,n);let ce=Y;if(!Y||!Y.ativo){const ae={codigoEmpresa:n,fornecedorId:te.id,chaveNfe:u.nfe.chaveAcesso,numeroNfe:u.nfe.numero,serieNfe:u.nfe.serie,dataEmissao:u.nfe.dataEmissao,tipoOperacao:u.nfe.tipo||"Entrada",naturezaOperacao:u.nfe.naturezaOperacao,valorProdutos:u.nfe.totalNota||0,valorTotal:u.nfe.totalNota||0,xmlCompleto:B,formaPagamento:u.pagamentos&&u.pagamentos.length>0?u.pagamentos.map(le=>le.nome).join(", "):null};ce=await fst(ae),console.log("[XMLImport] Nova compra registrada:",ce.numero_nfe)}else console.log("[XMLImport] NF-e j existe, adicionando novos itens:",Y.numero_nfe),Q.purchaseAlreadyExists=!0;const me=pe.map(ae=>{const le=b[ae.index]||{},ue=le.linkedProductId;let Re=null;return ue&&ue!=="force-new"?Re=ue:ae.existing&&!ue&&(Re=ae.existing.id),{produtoId:Re,codigoProdutoXML:ae.xml.codigo,nomeProdutoXML:ae.xml.nome,eanXML:ae.xml.ean,ncmXML:ae.xml.ncm,cfopXML:ae.xml.cfop,unidadeXML:ae.xml.unidade,quantidade:le.qty!==void 0?le.qty:Number(ae.xml.quantidade),valorUnitario:Number(ae.xml.valorUnitario)||0,valorTotal:Number(ae.xml.valorTotal)||0,valorDesconto:ae.xml.valorDesconto||0,valorFrete:ae.xml.valorFrete||0,valorSeguro:ae.xml.valorSeguro||0,valorOutrasDespesas:ae.xml.valorOutrasDespesas||0,icmsAliquota:ae.xml.icmsAliquota,icmsValor:ae.xml.icmsValor,ipiAliquota:ae.xml.ipiAliquota,ipiValor:ae.xml.ipiValor,pisAliquota:ae.xml.pisAliquota,pisValor:ae.xml.pisValor,cofinsAliquota:ae.xml.cofinsAliquota,cofinsValor:ae.xml.cofinsValor,vinculadoManualmente:!!le.linkedProductId,observacoes:le.observacoes||null,selecionadoNaImportacao:ae.selected}});await zse(ce.id,me),console.log("[XMLImport] Itens adicionados  compra:",me.length),Q.purchaseId=ce.id}catch(Y){console.error("[XMLImport] Erro ao registrar compra:",Y)}x(Q),g(!1),l("done"),Q.purchaseAlreadyExists?o({title:"NF-e j importada!",description:`Esta NF-e j existe no sistema. ${Q.created} produto(s) criado(s), ${Q.updated} atualizado(s).`,variant:"warning"}):Q.errors===0?o({title:"Importao concluda!",description:`${Q.created} produto(s) criado(s), ${Q.updated} atualizado(s).`,variant:"success"}):o({title:"Importao concluda com erros",description:`${Q.created} criado(s), ${Q.updated} atualizado(s), ${Q.errors} erro(s).`,variant:"warning"}),s&&s()},D=()=>{console.log("[XMLImport] Fechando modal"),l("upload"),d(null),f(null),m([]),w({}),_({}),x({created:0,updated:0,errors:0,details:[]}),t(!1)};Pe.useEffect(()=>{e&&console.log("[XMLImport] Modal aberto. Step atual:",i)},[e,i]);const U=()=>{l("upload"),d(null),f(null),m([]),w({}),_({})},z=B=>{m(Q=>Q.map((pe,te)=>te===B?{...pe,selected:!pe.selected}:pe))},W=()=>{const B=h.every(Q=>Q.selected);m(Q=>Q.map(pe=>({...pe,selected:!B})))},$=(B,Q,pe)=>{w(te=>({...te,[B]:{...te[B],[Q]:pe}}))},X=(B,Q)=>{console.log("[XMLImportModal] handleLinkProduct chamado:",{index:B,productId:Q}),console.log("[XMLImportModal] Estado editedProducts completo antes:",b),console.log("[XMLImportModal] Estado editedProducts[index] antes:",b[B]),w(pe=>{console.log("[XMLImportModal] Estado prev no setEditedProducts:",pe);const te={...pe,[B]:{...pe[B],linkedProductId:Q}};return console.log("[XMLImportModal] Novo estado editedProducts:",te),te})},ye=(B,Q)=>!B||!Q?0:B*(1+Q/100),Se=(B,Q,pe)=>b[B]?.[Q]??pe,V=B=>{_(Q=>({...Q,[B]:!Q[B]}))};return a.jsxs(mn,{open:e,onOpenChange:D,children:[a.jsxs(un,{className:"w-[95vw] sm:max-w-4xl max-h-[85vh] flex flex-col",children:[a.jsxs(on,{className:"flex-shrink-0",children:[a.jsxs(an,{className:"flex items-center gap-2 text-2xl font-bold",children:[a.jsx("span",{children:"Importar XML de Compra"}),u?.nfe&&a.jsx("span",{className:"inline-flex items-center rounded-full bg-surface-2 border border-border px-2 py-0.5 text-xs font-semibold text-text-muted uppercase tracking-wide",children:R()})]}),a.jsxs(Nn,{children:[i==="upload"&&"Selecione o arquivo XML da nota fiscal de entrada",i==="preview"&&"Revise os produtos que sero importados",i==="processing"&&"Processando produtos...",i==="done"&&"Importao finalizada"]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto px-2 py-1",children:[i==="upload"&&a.jsx("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:a.jsx("div",{className:"w-full max-w-md",children:a.jsxs("label",{htmlFor:"xml-upload",className:"flex flex-col items-center justify-center w-full h-64 border-2 border-dashed border-border rounded-lg cursor-pointer bg-surface hover:bg-surface-2 transition-colors",children:[a.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[a.jsx(P4,{className:"w-12 h-12 mb-4 text-text-muted"}),a.jsx("p",{className:"mb-2 text-sm text-text-primary font-semibold",children:"Clique para selecionar ou arraste o arquivo"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Arquivo XML de NF-e (Nota Fiscal Eletrnica)"})]}),a.jsx("input",{id:"xml-upload",type:"file",accept:".xml",className:"hidden",onChange:O})]})})}),i==="preview"&&a.jsxs("div",{className:"space-y-4",children:[u?.nfe&&a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsxs("div",{className:"flex items-start justify-between gap-4 mb-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("h3",{className:"font-semibold mb-2",children:["Informaes da ",R()]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Nmero:"})," ",a.jsx("span",{className:"font-mono",children:u.nfe.numero})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Srie:"})," ",a.jsx("span",{className:"font-mono",children:u.nfe.serie})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Tipo:"})," ",a.jsx("span",{children:u.nfe.tipo})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Fornecedor:"})," ",a.jsx("span",{children:u.fornecedor?.razaoSocial})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-2 min-w-[200px]",children:[a.jsxs("div",{className:"bg-brand/10 rounded-lg p-3 border border-brand/20",children:[a.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Valor Total NF-e"}),a.jsxs("p",{className:"text-xl font-bold text-brand",children:["R$ ",Number(u.nfe.totalNota||0).toFixed(2)]})]}),u.pagamentos&&u.pagamentos.length>0&&a.jsxs("div",{className:"bg-success/10 rounded-lg p-2.5 border border-success/20",children:[a.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Forma de Pagamento"}),a.jsx("p",{className:"text-sm font-semibold text-success",children:u.pagamentos.map(B=>B.nome).join(", ")})]})]})]}),u.nfe.chaveAcesso&&a.jsxs("div",{className:"mt-2 pt-2 border-t border-border",children:[a.jsx("span",{className:"text-text-muted text-xs",children:"Chave de Acesso:"}),a.jsx("p",{className:"font-mono text-xs break-all",children:u.nfe.chaveAcesso})]})]}),a.jsxs("div",{className:"flex items-center justify-between gap-4 px-2",children:[a.jsx(fe,{variant:"outline",size:"sm",onClick:W,children:h.every(B=>B.selected)?"Desmarcar Todos":"Selecionar Todos"}),a.jsxs("span",{className:"text-sm text-text-muted",children:[h.filter(B=>B.selected).length," de ",h.length," selecionados"]})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsx("h3",{className:"font-semibold mb-3 text-base",children:"Produtos Encontrados"}),a.jsx("div",{className:"space-y-2",children:h.map((B,Q)=>{const pe=Se(Q,"linkedProductId",null),te=Se(Q,"name",B.xml.nome),Y=Se(Q,"quantity",B.xml.quantidade),ce=Se(Q,"margin",B.xml.margem),me=Se(Q,"salePrice",null),ae=B.xml.valorUnitario||0;let le=me;le==null&&!B.isNew&&B.existing&&(le=Number(B.existing.preco_venda||B.existing.salePrice||B.existing.price||0)),le==null&&ce!=null&&(le=ye(ae,ce)),le==null&&B.xml.precoVenda&&(le=Number(B.xml.precoVenda));let ue=null;if(ce!=null)ue=ce;else if(le!=null&&ae>0&&le>0){const ne=(le-ae)/ae*100;ue=Math.max(-999,Math.min(9999,ne))}const Re=j[Q];return a.jsxs("div",{className:pr("rounded-lg border transition-all",B.selected?B.isNew?"bg-success/10 border-success/30":"bg-info/10 border-info/30":"bg-surface opacity-60 border-border"),children:[a.jsxs("div",{className:"p-3 flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx("input",{type:"checkbox",checked:B.selected,onChange:()=>z(Q),className:"w-4 h-4 rounded border-border accent-warning cursor-pointer"}),a.jsx("button",{onClick:()=>V(Q),className:"p-0.5 hover:bg-surface-2 rounded transition-colors",children:Re?a.jsx(Tg,{className:"w-4 h-4 text-text-muted"}):a.jsx(j0,{className:"w-4 h-4 text-text-muted"})}),a.jsx("div",{children:B.isNew?a.jsx(Ja,{className:"w-5 h-5 text-success"}):a.jsx(Jp,{className:"w-5 h-5 text-info"})})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-baseline justify-between gap-2",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"font-semibold text-sm truncate",children:te}),a.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-text-muted mt-0.5",children:[B.xml.codigo&&a.jsxs("span",{className:"flex-shrink-0",children:["#",B.xml.codigo]}),a.jsxs("span",{children:["Qtd: ",Y]})]})]}),a.jsx("div",{className:"flex-shrink-0 ml-2",children:B.isNew?a.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-success/20 text-success font-medium",children:"Novo"}):a.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-info/20 text-info font-medium",children:"Cadastrado"})})]}),a.jsxs("div",{className:"mt-1 text-[11px] text-text-muted",children:[a.jsxs("span",{children:["R$ ",Number(ae).toFixed(2),le?`  R$ ${le.toFixed(2)}`:""]}),ue!=null&&a.jsxs("span",{className:"ml-2 "+(ue>0?"text-success":ue<0?"text-destructive":"text-text-muted"),children:[ue.toFixed(1),"%"]})]})]})]}),Re&&a.jsxs("div",{className:"px-3 pb-3 pt-0 space-y-3 border-t border-border/50",children:[a.jsxs("div",{className:"mt-3",children:[a.jsx("label",{className:"text-sm font-medium text-text-primary mb-1 block",children:"Nome do Produto"}),a.jsx("input",{type:"text",value:te,onChange:ne=>$(Q,"name",ne.target.value),disabled:!B.selected,className:"w-full px-3 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 disabled:cursor-not-allowed"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Quantidade"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{type:"button",onClick:()=>$(Q,"qty",Math.max(0,Y-1)),disabled:!B.selected||Y<=0,className:"w-9 h-9 rounded-md border border-border bg-surface hover:bg-surface-2 disabled:opacity-30 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:a.jsx(Vv,{className:"w-4 h-4"})}),a.jsx("input",{type:"text",value:Y,onChange:ne=>{const ie=ne.target.value.replace(/\D/g,"");$(Q,"qty",ie===""?0:Number(ie))},disabled:!B.selected,className:"w-14 text-center px-2 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50"}),a.jsx("button",{type:"button",onClick:()=>$(Q,"qty",Y+1),disabled:!B.selected,className:"w-9 h-9 rounded-md bg-warning hover:bg-warning/90 disabled:opacity-30 disabled:cursor-not-allowed transition-colors flex items-center justify-center text-black font-bold shadow-sm",children:a.jsx(Ja,{className:"w-4 h-4"})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Margem %"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:(()=>{const ne=Se(Q,"margin",null);if(ne!=null)return String(ne);if(!B.isNew&&B.existing&&ae>0){const ie=Number(B.existing.preco_venda||B.existing.salePrice||B.existing.price||0);if(ie>0)return((ie-ae)/ae*100).toFixed(1)}return""})(),onChange:ne=>{const ie=ne.target.value;if(ie===""){$(Q,"margin",null);return}const gt=ie.replace(/[^0-9.,\-]/g,"").replace(",",".");if(gt==="."||gt==="-"||gt==="-.")return;const bt=parseFloat(gt);if(!isNaN(bt)&&($(Q,"margin",bt),ae>0)){const at=ye(ae,bt);$(Q,"salePrice",at)}},disabled:!B.selected,placeholder:"0",className:"w-24 pl-3 pr-6 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 text-right"}),a.jsx("span",{className:"absolute right-1.5 top-1/2 -translate-y-1/2 text-sm text-text-muted pointer-events-none",children:"%"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Custo"}),a.jsx("div",{className:"px-3 py-2 bg-surface/50 rounded-md border border-border",children:a.jsxs("span",{className:"text-sm font-semibold",children:["R$ ",ae.toFixed(2)]})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Preo Venda"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-sm text-text-muted pointer-events-none",children:"R$"}),a.jsx("input",{type:"text",value:(()=>{const ne=Se(Q,"salePrice",le);return ne==null?"":Number(ne).toFixed(2).replace(".",",")})(),onChange:ne=>{const ie=ne.target.value.replace(/\D/g,"");if(ie===""){$(Q,"salePrice",null);return}const gt=Number(ie)/100;if($(Q,"salePrice",gt),gt>0&&ae>0){const bt=(gt-ae)/ae*100;$(Q,"margin",Math.round(bt*100)/100)}},disabled:!B.selected,placeholder:"0,00",className:"w-28 pl-7 pr-3 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 text-right font-semibold text-success"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-text-primary mb-1 block",children:B.isNew?"Vincular a Produto Existente (Opcional)":"Ao para este Produto"}),a.jsx("div",{className:"flex gap-2",children:a.jsxs(vn,{value:pe==="force-new"?"force-new":pe||(B.isNew?"new":B.existing?.id||"new"),onValueChange:ne=>{ne==="new"||ne===B.existing?.id?X(Q,null):ne==="search"?C({isOpen:!0,productIndex:Q,currentProduct:B}):X(Q,ne)},disabled:!B.selected,children:[a.jsx(hn,{className:"flex-1 hover:bg-white/5 transition-colors text-xs sm:text-sm",children:a.jsx(wn,{placeholder:B.isNew?"Criar novo":"Atualizar existente",children:pe&&pe!=="force-new"&&pe!=="new"?(()=>{const ne=r?.find(ie=>ie.id===pe);return ne?`Vinculado: ${ne.name}`:B.isNew?"Criar novo":"Atualizar existente"})():pe==="force-new"?"Criar novo (ignorar)":B.isNew?"Criar novo":"Atualizar existente"})}),a.jsxs(pn,{className:"max-h-[300px] overflow-y-auto text-xs sm:text-sm",children:[B.isNew?a.jsx(ct,{value:"new",children:"Criar novo produto"}):a.jsxs(ct,{value:B.existing?.id||"new",children:["Atualizar: ",B.existing?.name," (Estoque: ",B.existing?.stock||0,")"]}),!B.isNew&&a.jsx(ct,{value:"force-new",children:"Criar novo (ignorar existente)"}),a.jsx(ct,{value:"search",children:"Buscar produto para vincular"})]})]})})]}),!B.isNew&&a.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:Se(Q,"updatePrice",!1),onChange:ne=>$(Q,"updatePrice",ne.target.checked),disabled:!B.selected,className:"w-4 h-4 rounded border-border bg-surface text-brand focus:ring-2 focus:ring-brand/50 disabled:opacity-50 disabled:cursor-not-allowed"}),a.jsx("span",{className:"text-text-secondary",children:"Atualizar preo de custo e venda deste produto"})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 text-xs",children:[B.xml.codigo&&a.jsxs("span",{className:"px-2 py-1 bg-surface rounded border border-border",children:["Cdigo: ",B.xml.codigo]}),B.xml.ean&&B.xml.ean!=="SEM GTIN"&&a.jsxs("span",{className:"px-2 py-1 bg-surface rounded border border-border",children:["EAN: ",B.xml.ean]}),a.jsxs("span",{className:"px-2 py-1 bg-surface rounded border border-border",children:["Unidade: ",B.xml.unidade]})]})]})]},Q)})})]}),a.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full bg-success"}),a.jsxs("span",{children:[h.filter(B=>B.isNew&&B.selected).length," novos"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full bg-info"}),a.jsxs("span",{children:[h.filter(B=>!B.isNew&&B.selected).length," existentes"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-3 h-3 rounded-full bg-warning"}),a.jsxs("span",{children:[h.filter(B=>b[B.index]?.linkedProductId).length," vinculados"]})]})]})]}),i==="processing"&&a.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[a.jsx(Tc,{className:"w-12 h-12 animate-spin text-warning mb-4"}),a.jsx("p",{className:"text-lg font-semibold",children:"Processando produtos..."}),a.jsx("p",{className:"text-sm text-text-muted",children:"Aguarde enquanto importamos os produtos"})]}),i==="done"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-6 border border-border text-center",children:[a.jsx(Ro,{className:"w-16 h-16 text-success mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-bold mb-2",children:"Importao Concluda!"}),a.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-success",children:y.created}),a.jsx("p",{className:"text-sm text-text-muted",children:"Criados"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-info",children:y.updated}),a.jsx("p",{className:"text-sm text-text-muted",children:"Atualizados"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-danger",children:y.errors}),a.jsx("p",{className:"text-sm text-text-muted",children:"Erros"})]})]})]}),y.details.length>0&&a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsx("h3",{className:"font-semibold mb-3",children:"Detalhes"}),a.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:y.details.map((B,Q)=>a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[B.status==="success"?a.jsx(Ro,{className:"w-4 h-4 text-success flex-shrink-0"}):a.jsx(Bc,{className:"w-4 h-4 text-danger flex-shrink-0"}),a.jsx("span",{className:"flex-1 truncate",children:B.produto}),a.jsx("span",{className:pr("text-xs px-2 py-1 rounded",B.status==="success"?"bg-success/20 text-success":"bg-danger/20 text-danger"),children:B.acao})]},Q))})]})]})]}),a.jsxs(Qn,{children:[i==="upload"&&a.jsx(fe,{variant:"outline",onClick:D,children:"Cancelar"}),i==="preview"&&a.jsxs(a.Fragment,{children:[a.jsx(fe,{variant:"outline",onClick:U,children:"Voltar"}),a.jsxs(fe,{onClick:I,disabled:h.filter(B=>B.selected).length===0,children:["Confirmar Importao (",h.filter(B=>B.selected).length," de ",h.length," produtos)"]})]}),i==="done"&&a.jsx(fe,{onClick:D,children:"Fechar"})]})]}),a.jsx(Vse,{isOpen:S.isOpen,onClose:()=>C({isOpen:!1,productIndex:null,currentProduct:null}),onSelect:B=>{console.log("[XMLImportModal] onSelect chamado com produto:",B),console.log("[XMLImportModal] Index do produto:",S.productIndex),X(S.productIndex,B.id),C({isOpen:!1,productIndex:null,currentProduct:null})},currentProduct:S.currentProduct}),a.jsx(Wse,{isOpen:P.isOpen,onClose:()=>A({isOpen:!1}),onConfirm:M,products:h.map((B,Q)=>({...B,originalIndex:Q})),editedProducts:b,allProducts:r,isReprocess:!1})]})}const yst=[],bst=[],wst={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},f3={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},WU="produtosPage:settings";function jst(e){const t=["Cdigo","Produto","Categoria","Tipo","Unidade","Preo Custo","Preo Venda","% Lucro","Estoque","Estoque Mn.","Validade","Status","Ativo","EAN-13","EAN-13 Caixa","Referncia","Marca","Grupo","NCM","Descrio NCM","CEST","Usar CSOSN","CFOP Interno","CST ICMS Interno","CSOSN Interno","Aliq ICMS Interno (%)","CFOP Externo","CST ICMS Externo","CSOSN Externo","Aliq ICMS Externo (%)","CST PIS Entrada","CST PIS Sada","Aliq PIS (%)","Aliq COFINS (%)","CST IPI","Aliq IPI (%)","FCP (%)","MVA (%)","Base Reduzida (%)"],r=";",n=g=>{const y=Number(g??0);return Number.isFinite(y)?y.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):"0,00"},s=g=>`R$ ${n(g)}`,o=g=>{const y=Number(g??0);return Number.isFinite(y)?y.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""},i=g=>{if(!g)return"";try{if(typeof g=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(g)){const[x,b,w]=g.split("-");return`${w}/${b}/${x}`}const y=new Date(g);if(!isNaN(y)){const x=String(y.getDate()).padStart(2,"0"),b=String(y.getMonth()+1).padStart(2,"0"),w=y.getFullYear();return`${x}/${b}/${w}`}}catch{}return String(g)},l=g=>g==="active"?"Ativo":g==="low_stock"?"Estoque Baixo":g==="inactive"?"Inativo":"",c=g=>g?"Sim":"No",d=g=>g??"",u=g=>{const y=g==null?"":String(g);return/[";\n]/.test(y)?`"${y.replace(/"/g,'""')}"`:y},f=[];f.push("\uFEFF"+t.join(r));for(const g of e){const y=[d(g.code),d(g.name),d(g.category),d(g.type),d(g.unit),s(g.costPrice),s(g.price??g.salePrice),o(g.marginPercent),Number(g.stock??0),Number(g.minStock??0),i(g.validade),l(g.status),c(g.active!==!1),d(g.barcode),d(g.barcodeBox),d(g.reference),d(g.brand),d(g.group),d(g.ncm),d(g.ncmDescription),d(g.cest),g.useCsosn?"Sim":"",d(g.cfopInterno),d(g.cstIcmsInterno),d(g.csosnInterno),o(g.aliqIcmsInterno),d(g.cfopExterno),d(g.cstIcmsExterno),d(g.csosnExterno),o(g.aliqIcmsExterno),d(g.cstPisEntrada),d(g.cstPisSaida),o(g.aliqPisPercent),o(g.aliqCofinsPercent),d(g.cstIpi),o(g.aliqIpiPercent),o(g.fcpPercent),o(g.mvaPercent),o(g.baseReduzidaPercent)].map(u).join(r);f.push(y)}const h=new Blob([f.join(`
`)],{type:"text/csv;charset=utf-8;"}),m=URL.createObjectURL(h),v=document.createElement("a");v.href=m,v.download="produtos.csv",document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(m)}function Cc(e,{action:t}={}){const r=String(e?.message||e||"").toLowerCase();if(r.includes("categoria possui produtos ativos vinculados"))return{title:"No  possvel remover",description:"Existem produtos ativos vinculados a esta categoria. Inative ou recategoriz-os antes."};if(r.includes("categoria no encontrada"))return{title:"Categoria no encontrada",description:"No foi possvel localizar a categoria para desativao."};if(r.includes("duplicate key")&&r.includes("ux_produtos_empresa_codigo_produto"))return{title:"Cdigo j cadastrado",description:"J existe um produto com este cdigo na sua empresa. Informe outro cdigo."};if(r.includes("duplicate key")&&r.includes("unique constraint"))return{title:"Registro j existe",description:"J existe um registro com estes dados."};if(r.includes("permission denied")||r.includes("violates row-level security")||r.includes("rls"))return{title:"Sem permisso",description:"Voc no tem permisso para executar esta ao."};const n=r.match(/null value in column "([^"]+)" violates not-null constraint/);return n?{title:"Campo obrigatrio",description:`Preencha o campo "${n[1].replace(/_/g," ")}".`}:r.includes("invalid input syntax")||r.includes("invalid input value")?{title:"Valor invlido",description:"Revise os valores informados (formato invlido)."}:r.includes("violates check constraint")?{title:"Valor invlido",description:"Os dados informados no atendem s regras do sistema."}:r.includes("violates foreign key constraint")?r.includes("update or delete on table")?{title:"No  possvel excluir",description:"Existem registros vinculados que impedem a excluso."}:{title:"Relao invlida",description:"O registro relacionado no foi encontrado ou  invlido."}:r.includes("failed to fetch")||r.includes("networkerror")||r.includes("network error")?{title:"Falha de conexo",description:"Verifique sua internet e tente novamente."}:r.includes("timeout")?{title:"Tempo esgotado",description:"A operao demorou demais. Tente novamente."}:r.includes("rate limit")||r.includes("too many requests")||r.includes("status code 429")?{title:"Muitas solicitaes",description:"Aguarde alguns segundos e tente novamente."}:t==="save"?{title:"Falha ao salvar",description:"No foi possvel salvar o produto. Tente novamente."}:t==="delete"?{title:"Falha ao inativar",description:"No foi possvel inativar o produto."}:t==="fetch"?{title:"Erro ao carregar",description:"No foi possvel atualizar a lista de produtos."}:t==="export"?{title:"Falha ao exportar",description:"No foi possvel gerar o arquivo."}:{title:"Erro",description:e?.message||"Ocorreu um erro."}}const ik=({icon:e,title:t,value:r,subtitle:n,color:s,onClick:o,isActive:i})=>{const l=e;return a.jsxs(xr.div,{variants:f3,className:pr("bg-surface rounded-2xl border-2 p-3 sm:p-4 flex flex-col justify-between gap-2 cursor-pointer transition-all duration-300",i?`${s}/30 border-${s}`:"border-border hover:border-border-hover"),onClick:o,children:[a.jsxs("div",{className:"flex items-center justify-between gap-2 min-w-0",children:[a.jsx("p",{className:"text-text-secondary text-xs sm:text-sm font-semibold leading-snug whitespace-nowrap overflow-hidden text-ellipsis",children:t}),a.jsx(l,{className:pr("w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0",s)})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs sm:text-sm font-semibold text-text-primary leading-tight whitespace-nowrap overflow-hidden text-ellipsis",children:r}),a.jsx("p",{className:"hidden sm:block text-xs text-text-muted",children:n})]})]})};function _st({open:e,onOpenChange:t,product:r,onSave:n,categories:s,onCreateCategory:o,suggestedCode:i,onRefreshProducts:l,products:c}){const{toast:d}=Qa(),{userProfile:u}=ms(),[f,h]=p.useState("dados"),[m,v]=p.useState(r?.code||""),[g,y]=p.useState(r?.name||""),[x,b]=p.useState(r?.category||""),[w,j]=p.useState(r?.type||"Venda"),[_,S]=p.useState(r?.unit||"UN"),[C,P]=p.useState(r?.active??!0),[A,R]=p.useState(r?.barcode||""),[O,I]=p.useState(r?.barcodeBox||""),[M,D]=p.useState(r?.reference||""),[U,z]=p.useState(r?.brand||""),[W,$]=p.useState(r?.group||""),[X,ye]=p.useState(!!r?.allowSale),[Se,V]=p.useState(!!r?.payCommission),[B,Q]=p.useState(!!r?.variablePrice),[pe,te]=p.useState(!!r?.composition),[Y,ce]=p.useState(!!r?.service),[me,ae]=p.useState(!!r?.hasGrid),[le,ue]=p.useState(!!r?.usePriceTable),[Re,ne]=p.useState(!!r?.fuel),[ie,gt]=p.useState(!!r?.useImei),[bt,at]=p.useState(!!r?.stockByGrid),[xt,Ze]=p.useState(!!r?.showInApp),[ht,Wt]=p.useState(r?.costPrice!=null?Number(r.costPrice).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):r?.cost!=null?Number(r.cost).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""),[be,Ct]=p.useState(r?.salePrice!=null?Number(r.salePrice).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):r?.price!=null?Number(r.price).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""),[wt,Ge]=p.useState(r?.marginPercent!=null?String(Number(r.marginPercent).toFixed(2)).replace(".",","):""),[Je,_e]=p.useState(r?.stock?String(r.stock):""),[je,Ue]=p.useState(r?.minStock?String(r.minStock):""),[ze,or]=p.useState(r?.status||"active"),[tr,Nt]=p.useState(r?.validade||null),[yr,Me]=p.useState(!1),[dt,ut]=p.useState(!1),[rr,hr]=p.useState(""),[It,dr]=p.useState(!0),[ur,er]=p.useState(!!(r?.csosnInterno||r?.csosnExterno)),[ln,Mr]=p.useState(r?.cfopInterno||""),[Ye,$e]=p.useState(r?.cstIcmsInterno||""),[Be,et]=p.useState(r?.csosnInterno||""),[jt,yt]=p.useState(r?.aliqIcmsInterno!=null?String(r.aliqIcmsInterno).replace(".",","):""),[qt,pt]=p.useState(r?.cfopExterno||""),[Dt,he]=p.useState(r?.cstIcmsExterno||""),[Qe,zt]=p.useState(r?.csosnExterno||""),[Mt,ir]=p.useState(r?.aliqIcmsExterno!=null?String(r.aliqIcmsExterno).replace(".",","):""),[nr,kr]=p.useState(r?.cstPisEntrada||""),[Ft,Dr]=p.useState(r?.cstPisSaida||""),[Fr,Tn]=p.useState(r?.aliqPisPercent!=null?String(r.aliqPisPercent).replace(".",","):""),[nt,$t]=p.useState(r?.aliqCofinsPercent!=null?String(r.aliqCofinsPercent).replace(".",","):""),[Kt,sr]=p.useState(r?.cstIpi||""),[St,Jr]=p.useState(r?.aliqIpiPercent!=null?String(r.aliqIpiPercent).replace(".",","):""),[Pt,lr]=p.useState(r?.fcpPercent!=null?String(r.fcpPercent).replace(".",","):""),[st,Et]=p.useState(r?.mvaPercent!=null?String(r.mvaPercent).replace(".",","):""),[ar,Tr]=p.useState(r?.baseReduzidaPercent!=null?String(r.baseReduzidaPercent).replace(".",","):""),[Qr,tn]=p.useState(r?.ncm||""),[Qt,fn]=p.useState(r?.ncmDescription||""),[nn,In]=p.useState(r?.cest||""),[Dn,se]=p.useState(!1),[He,ot]=p.useState(!1),ee=Ve=>{const kt=String(Ve||"").replace(/\D/g,"");return(kt?Number(kt)/100:0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})},k=Ve=>{if(!Ve)return 0;const kt=String(Ve).replace(/\./g,"").replace(",","."),Sr=Number(kt);return Number.isFinite(Sr)?Sr:0},T=Ve=>{const kt=String(Ve||"").replace(/[^\d,]/g,"");return kt?`% ${kt}`:""},K=Ve=>{if(Ve==null||Ve==="")return 0;const kt=String(Ve).replace(/\./g,"").replace(",","."),Sr=Number(kt);return Number.isFinite(Sr)?Sr:0},H=Ve=>String(Ve||"").replace(/\D/g,"").slice(0,13),F=Ve=>String(Ve||"").replace(/\D/g,"").slice(0,4),Le=Ve=>String(Ve||"").replace(/\D/g,"").slice(0,8),it=Ve=>String(Ve||"").replace(/\D/g,"").slice(0,7);p.useEffect(()=>{v(r?.code||""),y(r?.name||""),b(r?.category||""),j(r?.type||"Venda"),S(r?.unit||"UN"),P(r?.active??!0),R(r?.barcode||""),I(r?.barcodeBox||""),D(r?.reference||""),z(r?.brand||""),$(r?.group||""),ye(!!r?.allowSale),V(!!r?.payCommission),Q(!!r?.variablePrice),te(!!r?.composition),ce(!!r?.service),ae(!!r?.hasGrid),ue(!!r?.usePriceTable),ne(!!r?.fuel),gt(!!r?.useImei),at(!!r?.stockByGrid),Ze(!!r?.showInApp),Wt(r?.costPrice!=null?Number(r.costPrice).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):r?.cost!=null?Number(r.cost).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""),Ct(r?.salePrice!=null?Number(r.salePrice).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):r?.price!=null?Number(r.price).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""),Ge(r?.marginPercent!=null?String(Number(r.marginPercent).toFixed(2)).replace(".",","):""),_e(r?.stock?String(r.stock):""),Ue(r?.minStock?String(r.minStock):""),or(r?.status||"active"),Nt(r?.validade||null),er(!!(r?.csosnInterno||r?.csosnExterno)),Mr(r?.cfopInterno||""),$e(r?.cstIcmsInterno||""),et(r?.csosnInterno||""),yt(r?.aliqIcmsInterno!=null?String(r.aliqIcmsInterno).replace(".",","):""),pt(r?.cfopExterno||""),he(r?.cstIcmsExterno||""),zt(r?.csosnExterno||""),ir(r?.aliqIcmsExterno!=null?String(r.aliqIcmsExterno).replace(".",","):""),kr(r?.cstPisEntrada||""),Dr(r?.cstPisSaida||""),Tn(r?.aliqPisPercent!=null?String(r.aliqPisPercent).replace(".",","):""),$t(r?.aliqCofinsPercent!=null?String(r.aliqCofinsPercent).replace(".",","):""),sr(r?.cstIpi||""),Jr(r?.aliqIpiPercent!=null?String(r.aliqIpiPercent).replace(".",","):""),lr(r?.fcpPercent!=null?String(r.fcpPercent).replace(".",","):""),Et(r?.mvaPercent!=null?String(r.mvaPercent).replace(".",","):""),Tr(r?.baseReduzidaPercent!=null?String(r.baseReduzidaPercent).replace(".",","):""),tn(r?.ncm||""),fn(r?.ncmDescription||""),In(r?.cest||""),dr(!0),!r&&i&&!m&&v(i),se(!1),ot(!1)},[r,e]);const lt=p.useRef("salePrice");p.useEffect(()=>{if(lt.current==="salePrice"){const Ve=k(ht),kt=k(be);if(kt>0){const Sr=(kt-Ve)/kt*100;Ge(Sr.toFixed(2).replace(".",","))}else Ge("")}},[ht,be]),p.useEffect(()=>{if(lt.current==="marginPercent"){const Ve=setTimeout(()=>{const kt=k(ht),Sr=K(wt);if(console.log("[Margem] Custo:",kt,"Margem:",Sr),kt>0&&Sr>0)if(Sr>=100){const Or=kt*(1+Sr/100);console.log("[Margem] Preo calculado (markup):",Or),Ct(Or.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}))}else{const Or=kt/(1-Sr/100);console.log("[Margem] Preo calculado (margem):",Or),Ct(Or.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}))}},500);return()=>clearTimeout(Ve)}},[wt,ht]);const Vt=async Ve=>{if(Ve.preventDefault(),yr)return;const kt=[];if(g?.trim()||kt.push("Descrio"),_?.trim()||kt.push("Unidade"),w||kt.push("Tipo de Produto"),k(be)<=0&&kt.push("Preo de Venda"),kt.length){d({title:"Preencha os campos obrigatrios",description:kt.join(", "),variant:"destructive"});return}console.log("[ProdutosPage] handleSave - Estado active antes de salvar:",C);let Sr=ze;C?ze==="inactive"&&C&&(Sr="active"):Sr="inactive",console.log("[ProdutosPage] handleSave - Status ajustado:",Sr);const Or={id:r?.id,code:m?.trim()||"",name:g,category:x,type:w,stock:Number(Je||0),minStock:Number(je||0),status:Sr,validade:tr,unit:_,active:C,barcode:H(A),barcodeBox:H(O),reference:M?.trim()||null,brand:U?.trim()||null,group:W?.trim()||null,cost:k(ht),price:k(be),buyPrice:null,costsPercent:null,costPrice:k(ht),salePrice:k(be),marginPercent:K(wt),allowSale:X,payCommission:Se,variablePrice:B,composition:pe,service:Y,hasGrid:me,usePriceTable:le,fuel:Re,useImei:ie,stockByGrid:bt,showInApp:xt,cfopInterno:F(ln)||null,cstIcmsInterno:ur?null:Ye||null,csosnInterno:ur&&Be||null,aliqIcmsInterno:K(jt),cfopExterno:F(qt)||null,cstIcmsExterno:ur?null:Dt||null,csosnExterno:ur&&Qe||null,aliqIcmsExterno:K(Mt),cstPisEntrada:nr||null,cstPisSaida:Ft||null,aliqPisPercent:K(Fr),aliqCofinsPercent:K(nt),cstIpi:Kt||null,aliqIpiPercent:K(St),fcpPercent:K(Pt),mvaPercent:K(st),baseReduzidaPercent:K(ar),ncm:Le(Qr)||null,ncmDescription:Qt||null,cest:it(nn)||null};try{Me(!0),console.log("[Produtos] Salvando produto",Or);const fr=2e4,Kr=new Promise((Pn,qn)=>setTimeout(()=>qn(new Error("Timeout ao salvar produto (20s)")),fr));await Promise.race([n(Or),Kr]),d({title:"Produto salvo",description:"O produto foi salvo com sucesso.",variant:"success",duration:4e3,className:"bg-amber-500 text-black shadow-xl"}),t(!1)}catch(fr){console.error("[Produtos] Erro ao salvar",fr);const Kr=Cc(fr,{action:"save"});d({title:Kr.title,description:Kr.description,variant:"destructive",duration:6e3})}finally{Me(!1)}};return p.useEffect(()=>{e||Me(!1)},[e]),a.jsxs(mn,{open:e,onOpenChange:t,children:[a.jsxs(un,{className:"w-[90vw] sm:max-w-[780px] max-h-[80vh] sm:max-h-[85vh] flex flex-col",onKeyDown:Ve=>{Ve.key==="F5"&&(Ve.preventDefault(),Vt(Ve)),Ve.key==="Escape"&&(Ve.preventDefault(),t(!1))},children:[a.jsx(on,{children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx(an,{className:"text-lg sm:text-xl",children:r?"Detalhes do Produto":"Novo Produto"}),a.jsx(Nn,{className:"text-xs sm:text-sm",children:"Preencha as informaes e use as abas para navegar."})]})})}),a.jsx("form",{onSubmit:Vt,className:"grid gap-4 py-2 flex-1 overflow-y-auto pr-1 fx-scroll",children:a.jsxs(Mc,{value:f,onValueChange:h,className:"w-full",children:[a.jsx("div",{className:"sm:hidden mb-4",children:a.jsxs(vn,{value:f,onValueChange:h,children:[a.jsx(hn,{className:"w-full",children:a.jsx(wn,{})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"dados",children:"Dados"}),a.jsx(ct,{value:"estoque",children:"Estoque"}),a.jsx(ct,{value:"preco",children:"Preo e Lucro"}),a.jsx(ct,{value:"impostos",children:"Impostos"}),a.jsx(ct,{value:"outras",children:"Outras Info"})]})]})}),a.jsxs(rc,{className:"hidden sm:grid grid-cols-5 gap-1",children:[a.jsx(sa,{value:"dados",children:"Dados"}),a.jsx(sa,{value:"estoque",children:"Estoque"}),a.jsx(sa,{value:"preco",children:"Preo e Lucro"}),a.jsx(sa,{value:"impostos",children:"Impostos"}),a.jsx(sa,{value:"outras",children:"Outras Info"})]}),a.jsx("div",{className:"mt-2 text-[10px] sm:text-[11px] text-text-muted",children:"* Campo obrigatrio"}),a.jsxs(is,{value:"dados",className:"space-y-3 mt-2",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsxs(qe,{htmlFor:"code",className:"text-left sm:text-right text-xs sm:text-sm",children:["Cdigo ",a.jsx("span",{className:"text-text-muted text-[10px] sm:text-xs",children:"(auto)"})]}),a.jsx(rt,{id:"code",value:m,onChange:Ve=>v(Ve.target.value.replace(/\D/g,"")),className:"col-span-1 sm:col-span-3 text-sm",placeholder:i||"Ex.: 0001",disabled:!It})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsxs(qe,{htmlFor:"name",className:"text-left sm:text-right text-xs sm:text-sm",children:["Descrio ",!g?.trim()&&a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(rt,{id:"name",value:g,onChange:Ve=>y(Ve.target.value),className:"col-span-1 sm:col-span-3 text-sm",disabled:!It})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{htmlFor:"category",className:"text-left sm:text-right text-xs sm:text-sm",children:"Categoria"}),a.jsxs("div",{className:"col-span-3 flex gap-2 items-center",children:[a.jsxs(vn,{value:x,onValueChange:Ve=>It&&b(Ve),children:[a.jsx(hn,{className:"w-full",disabled:!It,children:a.jsx(wn,{placeholder:"Selecione..."})}),a.jsx(pn,{children:s.map(Ve=>a.jsx(ct,{value:Ve,children:Ve},Ve))})]}),a.jsxs(fe,{type:"button",onClick:()=>ut(Ve=>!Ve),className:"bg-amber-500 hover:bg-amber-400 text-black inline-flex items-center gap-2 whitespace-nowrap px-3",title:dt?"Fechar":"Adicionar nova categoria",disabled:!It,children:[a.jsx("span",{className:"font-bold",children:"+"}),a.jsx("span",{children:"Novo"})]})]})]}),dt&&a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx("div",{className:"col-span-1"}),a.jsxs("div",{className:"col-span-3 flex gap-2",children:[a.jsx(rt,{value:rr,onChange:Ve=>hr(Ve.target.value),placeholder:"Nome da nova categoria"}),a.jsx(fe,{type:"button",onClick:async()=>{const Ve=rr.trim();if(Ve)try{if(s.includes(Ve)){d({title:"Categoria j existe",description:"Escolha outro nome.",variant:"destructive"});return}await o?.(Ve),b(Ve),hr(""),ut(!1),d({title:"Categoria adicionada",description:"Ela j est selecionada no formulrio.",variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(kt){console.error("[Produto] add category inline:error",kt);const Sr=Cc(kt,{action:"save"});d({title:Sr.title,description:Sr.description,variant:"destructive"})}},children:"Adicionar"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsxs(qe,{htmlFor:"unit",className:"text-left sm:text-right text-xs sm:text-sm",children:["Unidade ",!_?.trim()&&a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsxs(vn,{value:_,onValueChange:Ve=>It&&S(Ve),children:[a.jsx(hn,{className:"col-span-1 sm:col-span-3 text-sm",disabled:!It,children:a.jsx(wn,{placeholder:"Selecione a unidade"})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"UN",children:"UN - Unidade"}),a.jsx(ct,{value:"CX",children:"CX - Caixa"}),a.jsx(ct,{value:"PC",children:"PC - Pea"}),a.jsx(ct,{value:"KG",children:"KG - Quilograma"}),a.jsx(ct,{value:"G",children:"G - Grama"}),a.jsx(ct,{value:"L",children:"L - Litro"}),a.jsx(ct,{value:"ML",children:"ML - Mililitro"}),a.jsx(ct,{value:"M",children:"M - Metro"}),a.jsx(ct,{value:"M2",children:"M - Metro Quadrado"}),a.jsx(ct,{value:"M3",children:"M - Metro Cbico"}),a.jsx(ct,{value:"PAR",children:"PAR - Par"}),a.jsx(ct,{value:"DZ",children:"DZ - Dzia"}),a.jsx(ct,{value:"FD",children:"FD - Fardo"}),a.jsx(ct,{value:"SC",children:"SC - Saco"}),a.jsx(ct,{value:"PT",children:"PT - Pacote"}),a.jsx(ct,{value:"SERV",children:"SERV - Servio"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsxs(qe,{className:"text-left sm:text-right text-xs sm:text-sm",children:["Tipo ",!w&&a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsxs(vn,{value:w,onValueChange:Ve=>It&&j(Ve),children:[a.jsx(hn,{className:"col-span-1 sm:col-span-3 text-sm",disabled:!It,children:a.jsx(wn,{placeholder:"Selecione o tipo"})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"Venda",children:"Produto para Venda"}),a.jsx(ct,{value:"Uso Interno",children:"Produto de Uso Interno"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{className:"text-left sm:text-right text-xs sm:text-sm",children:"Ativo"}),a.jsx("div",{className:"col-span-1 sm:col-span-3",children:r?a.jsxs(a.Fragment,{children:[a.jsx(za,{checked:C,onCheckedChange:Ve=>{console.log("[ProdutosPage] Checkbox active mudou para:",Ve),P(!!Ve)},disabled:!It}),a.jsx("span",{className:"ml-2 text-xs sm:text-sm",children:"Ativo"})]}):a.jsxs(vn,{value:C?"ativo":"inativo",onValueChange:Ve=>{console.log("[ProdutosPage] Select active mudou para:",Ve),P(Ve==="ativo")},children:[a.jsx(hn,{className:"w-full sm:w-48 text-sm",disabled:!It,children:a.jsx(wn,{placeholder:"Selecione"})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"ativo",children:"Ativo"}),a.jsx(ct,{value:"inativo",children:"Inativo"})]})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{htmlFor:"barcode",className:"text-left sm:text-right text-xs sm:text-sm",children:"EAN-13"}),a.jsx(rt,{id:"barcode",value:A,onChange:Ve=>R(H(Ve.target.value)),className:"col-span-1 sm:col-span-3 text-sm",placeholder:"789...",disabled:!It})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsxs(qe,{htmlFor:"validade",className:"text-left sm:text-right text-xs sm:text-sm",children:["Validade ",a.jsx("span",{className:"text-text-muted text-[10px] sm:text-xs",children:"(Opcional)"})]}),a.jsxs(vi,{children:[a.jsx(xi,{asChild:!0,children:a.jsxs(fe,{variant:"outline",className:pr("col-span-1 sm:col-span-3 justify-start text-left font-normal text-xs sm:text-sm",!tr&&"text-muted-foreground"),disabled:!It,children:[a.jsx(t_,{className:"mr-2 h-3 w-3 sm:h-4 sm:w-4"}),tr?cr(tr,"dd/MM/yyyy"):a.jsx("span",{children:"Selecione a data"})]})}),a.jsx(ni,{className:"p-0 w-[280px] sm:w-[300px]",children:a.jsx("div",{className:"w-[280px] sm:w-[300px] min-h-[300px] sm:min-h-[332px]",children:a.jsx(yi,{mode:"single",selected:tr,onSelect:Nt,initialFocus:!0,fixedWeeks:!0})})})]})]})]}),a.jsx(is,{value:"estoque",className:"space-y-3 mt-2",children:a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"grid grid-cols-2 items-center gap-2",children:[a.jsx(qe,{htmlFor:"stock",className:"text-right",children:"Estoque"}),a.jsx(rt,{id:"stock",value:Je,onChange:Ve=>_e(Ve.target.value.replace(/[^0-9]/g,"")),disabled:!It,className:"col-span-1",inputMode:"numeric"})]}),a.jsxs("div",{className:"grid grid-cols-2 items-center gap-4",children:[a.jsx(qe,{htmlFor:"minStock",className:"text-right",children:"Estoque Mn."}),a.jsx(rt,{id:"minStock",value:je,onChange:Ve=>Ue(Ve.target.value.replace(/[^0-9]/g,"")),disabled:!It,inputMode:"numeric"})]})]})}),a.jsxs(is,{value:"preco",className:"space-y-3 mt-2",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{htmlFor:"costPrice",className:"text-xs sm:text-right",children:"Preo de Custo (R$)"}),a.jsx(rt,{id:"costPrice",inputMode:"numeric",placeholder:"Ex.: 10,00",value:`R$ ${ht||"0,00"}`,onChange:Ve=>{Wt(ee(Ve.target.value))},disabled:!It,className:"sm:col-span-3 text-xs sm:text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsxs(qe,{htmlFor:"salePrice",className:"text-xs sm:text-right",children:["Preo de Venda (R$) ",(!be||k(be)<=0)&&a.jsx("span",{className:"text-danger",children:"*"})]}),a.jsx(rt,{id:"salePrice",inputMode:"numeric",placeholder:"Ex.: 15,00",value:`R$ ${be||"0,00"}`,onChange:Ve=>{lt.current="salePrice",Ct(ee(Ve.target.value))},disabled:!It,className:"sm:col-span-3 text-xs sm:text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{htmlFor:"marginPercent",className:"text-xs sm:text-right",children:"% de Lucro (Margem)"}),a.jsx(rt,{id:"marginPercent",type:"text",placeholder:"Ex.: 40",value:wt?`% ${wt}`:"",onChange:Ve=>{lt.current="marginPercent";const kt=Ve.target.value.replace(/[^\d,]/g,"");Ge(kt)},onBlur:()=>{if(lt.current==="marginPercent"){const Ve=k(ht),kt=K(wt);if(Ve>0&&kt>0)if(kt>=100){const Sr=Ve*(1+kt/100);Ct(Sr.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}))}else{const Sr=Ve/(1-kt/100);Ct(Sr.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}))}}},disabled:!It,className:"sm:col-span-3 text-xs sm:text-sm"})]})]}),a.jsxs(is,{value:"impostos",className:"space-y-4 mt-2",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(za,{id:"useCsosn",checked:ur,onCheckedChange:Ve=>er(!!Ve),disabled:!It}),a.jsx(qe,{htmlFor:"useCsosn",className:"cursor-pointer text-xs sm:text-sm",children:"Usar CSOSN (Simples Nacional)"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-xs sm:text-sm font-semibold",children:"ICMS - Operao Interna"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{className:"text-xs sm:text-right",children:"CFOP"}),a.jsx(rt,{value:ln,onChange:Ve=>Mr(F(Ve.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"5102",disabled:!It})]}),!ur&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{className:"text-xs sm:text-right",children:"CST"}),a.jsx(rt,{value:Ye,onChange:Ve=>$e(Ve.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"00, 20, 40...",disabled:!It})]}),ur&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{className:"text-xs sm:text-right",children:"CSOSN"}),a.jsx(rt,{value:Be,onChange:Ve=>et(Ve.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"101, 102...",disabled:!It})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{className:"text-xs sm:text-right",children:"Alquota ICMS (%)"}),a.jsx(rt,{value:`${jt||""}`,onChange:Ve=>yt(T(Ve.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"0,00",disabled:!It})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-xs sm:text-sm font-semibold",children:"ICMS - Operao Externa"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{className:"text-xs sm:text-right",children:"CFOP"}),a.jsx(rt,{value:qt,onChange:Ve=>pt(F(Ve.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"6102",disabled:!It})]}),!ur&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{className:"text-xs sm:text-right",children:"CST"}),a.jsx(rt,{value:Dt,onChange:Ve=>he(Ve.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"00, 20, 40...",disabled:!It})]}),ur&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{className:"text-xs sm:text-right",children:"CSOSN"}),a.jsx(rt,{value:Qe,onChange:Ve=>zt(Ve.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"101, 102...",disabled:!It})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{className:"text-xs sm:text-right",children:"Alquota ICMS (%)"}),a.jsx(rt,{value:`${Mt||""}`,onChange:Ve=>ir(T(Ve.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"0,00",disabled:!It})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-xs sm:text-sm font-semibold",children:"PIS/COFINS"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{className:"text-xs sm:text-right",children:"CST PIS Entrada"}),a.jsx(rt,{value:nr,onChange:Ve=>kr(Ve.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"50, 70...",disabled:!It})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{className:"text-xs sm:text-right",children:"CST PIS Sada"}),a.jsx(rt,{value:Ft,onChange:Ve=>Dr(Ve.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"01, 04...",disabled:!It})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{className:"text-xs sm:text-right",children:"Alquota PIS (%)"}),a.jsx(rt,{value:`${Fr||""}`,onChange:Ve=>Tn(T(Ve.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"0,65",disabled:!It})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{className:"text-xs sm:text-right",children:"Alquota COFINS (%)"}),a.jsx(rt,{value:`${nt||""}`,onChange:Ve=>$t(T(Ve.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"3,00",disabled:!It})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-xs sm:text-sm font-semibold",children:"IPI"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{className:"text-xs sm:text-right",children:"CST IPI"}),a.jsx(rt,{value:Kt,onChange:Ve=>sr(Ve.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"50, 99...",disabled:!It})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{className:"text-xs sm:text-right",children:"Alquota IPI (%)"}),a.jsx(rt,{value:`${St||""}`,onChange:Ve=>Jr(T(Ve.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"0,00",disabled:!It})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-6",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{className:"text-xs sm:text-right",children:"FCP (%)"}),a.jsx(rt,{value:`${Pt||""}`,onChange:Ve=>lr(T(Ve.target.value)),placeholder:"2,00",disabled:!It,className:"text-xs sm:text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{className:"text-xs sm:text-right",children:"MVA (%)"}),a.jsx(rt,{value:`${st||""}`,onChange:Ve=>Et(T(Ve.target.value)),placeholder:"40,00",disabled:!It,className:"text-xs sm:text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{className:"text-xs sm:text-right",children:"Base Reduzida (%)"}),a.jsx(rt,{value:`${ar||""}`,onChange:Ve=>Tr(T(Ve.target.value)),placeholder:"0,00",disabled:!It,className:"text-xs sm:text-sm"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-6",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{className:"text-xs sm:text-right",children:"NCM"}),a.jsx(rt,{value:Qr,onChange:Ve=>tn(Le(Ve.target.value)),placeholder:"00000000",disabled:!It,className:"text-xs sm:text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{className:"text-xs sm:text-right",children:"CEST"}),a.jsx(rt,{value:nn,onChange:Ve=>In(it(Ve.target.value)),placeholder:"0000000",disabled:!It,className:"text-xs sm:text-sm"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4 sm:col-span-1",children:[a.jsx(qe,{className:"text-xs sm:text-right",children:"Descrio NCM"}),a.jsx(rt,{value:Qt,onChange:Ve=>fn(Ve.target.value),placeholder:"Descrio do NCM",disabled:!It,className:"text-xs sm:text-sm"})]})]})]}),a.jsxs(is,{value:"outras",className:"space-y-3 mt-2",children:[r&&a.jsxs("div",{className:"pb-4 mb-4 border-b border-border",children:[a.jsx(fe,{type:"button",onClick:()=>se(!0),disabled:!It,className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground",children:"Desmembrar e Unir Produto"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Divida o preo por quantidade e opcionalmente una com outro produto"})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{htmlFor:"barcode2",className:"text-xs sm:text-right",children:"Cdigo de Barras"}),a.jsx(rt,{id:"barcode2",value:A,onChange:Ve=>R(H(Ve.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"EAN-13",disabled:!It})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{htmlFor:"barcodeBox",className:"text-xs sm:text-right",children:"Cdigo Barras (Caixa)"}),a.jsx(rt,{id:"barcodeBox",value:O,onChange:Ve=>I(H(Ve.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"EAN-13 da caixa",disabled:!It})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{htmlFor:"reference",className:"text-xs sm:text-right",children:"Referncia"}),a.jsx(rt,{id:"reference",value:M,onChange:Ve=>D(Ve.target.value),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"Ex.: REF-123",disabled:!It})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{htmlFor:"brand",className:"text-xs sm:text-right",children:"Marca"}),a.jsx(rt,{id:"brand",value:U,onChange:Ve=>z(Ve.target.value),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"Ex.: Nike",disabled:!It})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[a.jsx(qe,{htmlFor:"group",className:"text-xs sm:text-right",children:"Grupo"}),a.jsx(rt,{id:"group",value:W,onChange:Ve=>$(Ve.target.value),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"Ex.: Calados",disabled:!It})]})]}),!1]})}),a.jsxs(Qn,{children:[a.jsx(vh,{asChild:!0,children:a.jsx(fe,{type:"button",variant:"secondary",children:"Cancelar"})}),a.jsx(fe,{type:"button",onClick:Vt,disabled:yr||!It,title:"F5 para salvar",children:yr?"Salvando...":"Salvar Produto"})]})]}),a.jsx(Nst,{open:Dn,onOpenChange:se,product:r,currentPrice:be,allProducts:c,userProfile:u,onApply:async(Ve,kt,Sr,Or)=>{if(!Sr)Ct(Ve),_e(kt),se(!1),d({title:"Preo desmembrado!",description:`Preo unitrio: R$ ${k(Ve).toFixed(2)} | Estoque: ${kt}`,variant:"success"});else try{const fr=Number(kt),Kr=await bx({productId:Sr.id,delta:fr,codigoEmpresa:u?.codigo_empresa}),Pn=Number(Kr?.stock??Number(Sr.stock||0)+fr);if(Or){const qn={...Sr,stock:Pn,salePrice:k(Ve),price:k(Ve)};await u1(Sr.id,qn)}await WR(r.id),d({title:"Produto desmembrado e unido!",description:`${Sr.name}: novo estoque = ${Pn} | preo unitrio = R$ ${k(Ve).toFixed(2)}`,variant:"success"}),se(!1),t(!1);try{typeof l=="function"&&l()}catch{}}catch(fr){console.error("[Desmembrar e Unir] Erro:",fr),d({title:"Erro ao processar",description:fr?.message||"Tente novamente",variant:"destructive"})}}})]})}function Nst({open:e,onOpenChange:t,product:r,currentPrice:n,allProducts:s,userProfile:o,onApply:i}){const[l,c]=p.useState(""),[d,u]=p.useState(""),[f,h]=p.useState(!1),[m,v]=p.useState(""),[g,y]=p.useState(null),[x,b]=p.useState(!1),w=P=>{const A=String(P||"").replace(/\D/g,"");return(A?Number(A)/100:0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})},j=P=>{if(!P)return 0;const A=String(P).replace(/\./g,"").replace(",","."),R=Number(A);return Number.isFinite(R)?R:0};p.useEffect(()=>{e&&n&&(c(n),u(""),h(!1),v(""),y(null),b(!1))},[e,n]);const _=l&&d&&Number(d)>0?j(l)/Number(d):0,S=(s||[]).filter(P=>{if(!r||P.id===r.id)return!1;if(!m.trim())return!0;const A=m.toLowerCase();return(P.name||"").toLowerCase().includes(A)||(P.code||"").toLowerCase().includes(A)}).slice(0,10),C=g?Number(d||0)+Number(g.stock||0):0;return a.jsx(mn,{open:e,onOpenChange:t,children:a.jsxs(un,{className:"w-[95vw] sm:max-w-[650px] max-h-[85vh] flex flex-col overflow-y-auto",children:[a.jsxs(on,{children:[a.jsx(an,{children:"Desmembrar e Unir Produto"}),a.jsx(Nn,{children:"Divida o preo por quantidade e opcionalmente una com outro produto"})]}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"text-sm font-semibold",children:"1. Desmembrar Preo"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(qe,{children:"Valor Total (R$)"}),a.jsx(rt,{inputMode:"numeric",placeholder:"0,00",value:`R$ ${l||"0,00"}`,onChange:P=>c(w(P.target.value))})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(qe,{children:"Quantidade de Unidades"}),a.jsx(rt,{type:"text",inputMode:"numeric",placeholder:"0",value:d,onChange:P=>u(P.target.value.replace(/[^0-9]/g,""))})]}),_>0&&a.jsx("div",{className:"bg-muted/50 border border-border p-3 rounded-lg",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Preo Unitrio:"}),a.jsxs("span",{className:"text-lg font-bold",children:["R$ ",_.toFixed(2)]})]})})]}),_>0&&a.jsxs("div",{className:"space-y-3 border-t pt-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(za,{id:"wantToMerge",checked:f,onCheckedChange:P=>{h(!!P),P||(y(null),v(""),b(!1))}}),a.jsx(qe,{htmlFor:"wantToMerge",className:"cursor-pointer text-sm font-semibold",children:"2. Unir com outro produto (opcional)"})]}),f&&a.jsxs("div",{className:"space-y-3 ml-6",children:[a.jsx("div",{className:"bg-muted/30 border border-border p-3 rounded-lg",children:a.jsxs("p",{className:"text-xs text-muted-foreground",children:[a.jsx("strong",{children:"Produto atual:"})," ",r?.name," (ser inativado aps unio)"]})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(qe,{children:"Buscar Produto Destino"}),a.jsx(rt,{placeholder:"Digite o nome ou cdigo...",value:m,onChange:P=>v(P.target.value)})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(qe,{className:"text-xs",children:["Produtos Disponveis (",S.length,")"]}),a.jsx("div",{className:"max-h-48 overflow-y-auto space-y-1 border border-border rounded-lg p-2",children:S.length===0?a.jsx("p",{className:"text-xs text-muted-foreground p-2 text-center",children:"Nenhum produto encontrado"}):S.map(P=>a.jsx("div",{onClick:()=>y(P),className:pr("p-2 rounded-md cursor-pointer border transition-colors",g?.id===P.id?"bg-primary/10 border-primary":"bg-background hover:bg-muted/50 border-transparent"),children:a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium truncate",children:P.name}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:[P.code&&`Cdigo: ${P.code}  `,"Estoque: ",P.stock||0,"  R$ ",Number(P.price||P.salePrice||0).toFixed(2)]})]}),g?.id===P.id&&a.jsx(Ro,{className:"w-4 h-4 text-primary flex-shrink-0"})]})},P.id))})]}),g&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"bg-primary/5 border border-primary/20 p-3 rounded-lg",children:[a.jsx("p",{className:"text-xs font-medium mb-1",children:"Resumo da Unio:"}),a.jsxs("div",{className:"text-xs space-y-0.5 text-muted-foreground",children:[a.jsxs("p",{children:[" Destino: ",a.jsx("strong",{children:g.name})]}),a.jsxs("p",{children:[" Estoque atual: ",g.stock||0]}),a.jsxs("p",{children:[" Estoque a somar: +",d]}),a.jsxs("p",{className:"text-primary font-bold",children:[" Novo estoque: ",C]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(za,{id:"updatePrice",checked:x,onCheckedChange:P=>b(!!P)}),a.jsxs(qe,{htmlFor:"updatePrice",className:"cursor-pointer text-xs",children:["Atualizar preo do destino para R$ ",_.toFixed(2)]})]})]})]})]})]}),a.jsxs(Qn,{children:[a.jsx(fe,{variant:"outline",onClick:()=>t(!1),children:"Cancelar"}),a.jsx(fe,{onClick:()=>{if(_>0){const P=_.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2});i(P,d,f?g:null,x)}},disabled:_<=0||f&&!g,children:f&&g?"Desmembrar e Unir":"Aplicar Desmembramento"})]})]})})}function Sst({open:e,onOpenChange:t,categories:r,onAddCategory:n,onRemoveCategory:s}){const{toast:o}=Qa(),[i,l]=p.useState(""),[c,d]=p.useState(!1),u=async()=>{const h=i.trim();if(h){if(r.includes(h)){o({title:"Categoria j existe",description:"Escolha outro nome.",variant:"destructive"});return}try{d(!0),await n(h),l(""),o({title:"Categoria adicionada",description:"Ela j aparece na lista.",variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(m){console.error("[Categorias] add:error",m);const v=Cc(m,{action:"save"});o({title:v.title,description:v.description,variant:"destructive"})}finally{d(!1)}}},f=async h=>{try{d(!0),await s(h),o({title:"Categoria desativada",description:"A categoria foi marcada como inativa.",variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(m){console.error("[Categorias] remove:error",m);const v=Cc(m,{action:"save"});o({title:v.title,description:v.description,variant:"destructive"})}finally{d(!1)}};return a.jsx(mn,{open:e,onOpenChange:t,children:a.jsxs(un,{className:"w-[90vw] sm:max-w-[480px]",children:[a.jsxs(on,{children:[a.jsx(an,{children:"Gerenciar Categorias"}),a.jsx(Nn,{children:"Adicione ou remova categorias de produtos."})]}),a.jsxs("div",{className:"py-4 space-y-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(rt,{value:i,onChange:h=>l(h.target.value),placeholder:"Nome da nova categoria"}),a.jsx(fe,{onClick:u,disabled:c,children:c?"Processando...":"Adicionar"})]}),a.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:r.map(h=>a.jsxs("div",{className:"flex items-center justify-between bg-surface-2 p-2 rounded-md",children:[a.jsx("span",{className:"font-semibold",children:h}),a.jsx(fe,{variant:"ghost",size:"icon",className:"h-8 w-8 text-danger/80 hover:text-danger",onClick:()=>f(h),disabled:c,children:a.jsx(Ju,{size:14})})]},h))})]})]})})}function Cst(){const{toast:e}=Qa(),{userProfile:t,authReady:r}=ms();$o();const[n,s]=p.useState(yst),[o,i]=p.useState(bst),[l,c]=p.useState([]),[d,u]=p.useState("");p.useState("list");const[f,h]=p.useState(!0),[m,v]=p.useState(null),[g,y]=p.useState(!1),[x,b]=p.useState(!1),[w,j]=p.useState("all"),[_,S]=p.useState(""),[C,P]=p.useState({type:"all",category:"all",status:"active",newOnly:!1}),[A,R]=p.useState(!1),[O,I]=p.useState(!1),[M,D]=p.useState(!1),[U,z]=p.useState(null),[W,$]=p.useState({by:"code",dir:"asc"}),X=p.useRef(!0),ye=p.useRef(0),Se=p.useRef(0);p.useRef(!1);const[V,B]=p.useState(!1),[Q,pe]=p.useState("paged"),te=Q==="paged",[Y,ce]=p.useState(1),[me]=p.useState(100),[ae,le]=p.useState(0);p.useEffect(()=>(X.current=!0,()=>{X.current=!1}),[]),p.useEffect(()=>{try{const he=localStorage.getItem(WU);if(!he)return;const Qe=JSON.parse(he);Qe&&typeof Qe=="object"&&((Qe.listMode==="paged"||Qe.listMode==="all")&&pe(Qe.listMode),typeof Qe.showStats=="boolean"&&h(Qe.showStats))}catch{}},[]),p.useEffect(()=>{(async()=>{if(!t?.codigo_empresa||!t?.id&&!t?.user_id)return;const Qe=t.id||t.user_id,zt=`produtos:${t.codigo_empresa}`,Mt=await Bse({userId:Qe,scope:zt});Mt&&((Mt.listMode==="paged"||Mt.listMode==="all")&&pe(Mt.listMode),typeof Mt.showStats=="boolean"&&h(Mt.showStats))})()},[t?.codigo_empresa,t?.id]),p.useEffect(()=>{try{const he={listMode:Q,showStats:f};localStorage.setItem(WU,JSON.stringify(he))}catch{}if(t?.codigo_empresa&&(t?.id||t?.user_id)){const he=t.id||t.user_id,Qe=`produtos:${t.codigo_empresa}`;qse({userId:he,scope:Qe,settings:{listMode:Q,showStats:f}})}},[Q,f,t?.codigo_empresa,t?.id]);const ue=async()=>{const he=t?.codigo_empresa||null;if(!r||!he)return;const Qe=`produtos:list:${he}`;R(!0);const zt=setTimeout(()=>{if(X.current)try{const Mt=JSON.parse(localStorage.getItem(Qe)||"[]");Array.isArray(Mt)&&Mt.length>0&&(console.warn("[Produtos] slow fallback: using cached snapshot"),s(Mt))}catch{}},2e3);try{const Mt=C.status==="all"||C.status==="inactive";let ir=[];if(te){console.log("[Produtos] refetchProducts - modo paginado - Filtro status:",C.status,"includeInactive:",Mt,"page:",Y,"pageSize:",me);const nr=await Wat({includeInactive:Mt,search:_,codigoEmpresa:he,page:Y,pageSize:me});if(!X.current)return;ir=nr?.data||[];const kr=nr?.count||0;console.log("[Produtos] refetchProducts - Produtos carregados (paginado):",ir.length,"de",kr),s(ir),le(kr)}else{if(console.log("[Produtos] refetchProducts - modo TODOS - Filtro status:",C.status,"includeInactive:",Mt),ir=await bu({includeInactive:Mt,search:_,codigoEmpresa:he}),!X.current)return;console.log("[Produtos] refetchProducts - Produtos carregados (todos):",ir.length),s(ir),le(ir.length)}try{localStorage.setItem(Qe,JSON.stringify(ir))}catch{}Se.current=ir.length,ye.current=Date.now()}catch(Mt){console.error("[Produtos] refetchProducts:error",Mt);const ir=Cc(Mt,{action:"fetch"});e({title:ir.title,description:ir.description,variant:"destructive"})}finally{clearTimeout(zt),R(!1)}};p.useEffect(()=>{const he=(()=>{try{const nr=localStorage.getItem("auth:userProfile");return nr&&JSON.parse(nr)?.codigo_empresa||null}catch{return null}})(),Qe=t?.codigo_empresa||he;if(!Qe)return;const zt=`produtos:list:${Qe}`,Mt=(()=>{try{return JSON.parse(localStorage.getItem(zt)||"[]")}catch{return[]}})();Array.isArray(Mt)&&Mt.length>0&&(s(Mt),Se.current=Mt.length);const ir=async(nr=3)=>{for(let kr=0;kr<nr;kr++)try{if(X.current){await ue();break}}catch(Ft){console.warn(`[ProdutosPage] Tentativa ${kr+1} falhou:`,Ft),kr===nr-1?console.error("[ProdutosPage] Todas as tentativas falharam"):await new Promise(Dr=>setTimeout(Dr,1e3*(kr+1)))}};try{const nr=JSON.parse(localStorage.getItem(`produtos:cats:${Qe}`)||"[]");Array.isArray(nr)&&nr.length>0&&i(nr)}catch{}if(r&&t?.codigo_empresa){const nr=setTimeout(()=>ir(),100);return(async()=>{try{const kr=await VU({codigoEmpresa:t.codigo_empresa});if(!X.current)return;i(kr);try{localStorage.setItem(`produtos:cats:${t.codigo_empresa}`,JSON.stringify(kr))}catch{}}catch(kr){console.error("[Categorias] load on mount:error",kr)}})(),()=>clearTimeout(nr)}},[r,t?.codigo_empresa]),p.useEffect(()=>{const he=()=>{(Date.now()-(ye.current||0)>3e4||Se.current===0)&&ue()},Qe=()=>{document.visibilityState==="visible"&&(Date.now()-(ye.current||0)>3e4||Se.current===0)&&ue()};return window.addEventListener("focus",he),document.addEventListener("visibilitychange",Qe),()=>{window.removeEventListener("focus",he),document.removeEventListener("visibilitychange",Qe)}},[r,t?.codigo_empresa]),p.useEffect(()=>{ce(1),r&&ue()},[C.status,r]),p.useEffect(()=>{const he=setTimeout(()=>{ce(1),r&&ue()},300);return()=>clearTimeout(he)},[_,r]),p.useEffect(()=>{ce(1),r&&ue()},[Q,r]);const[Re,ne]=p.useState("N/A");p.useEffect(()=>{let he=!0;return(async()=>{try{const Qe=await Vat({limit:1,codigoEmpresa:t?.codigo_empresa});if(!he)return;if(Array.isArray(Qe)&&Qe.length>0){const zt=Qe[0];ne(`${zt.name} (${zt.total})`)}else ne("")}catch{he&&ne("N/A")}})(),()=>{he=!1}},[t?.codigo_empresa]);const[ie,gt]=p.useState(!1),[bt,at]=p.useState(()=>{const he=new Date;return he.setHours(0,0,0,0),he}),[xt,Ze]=p.useState(!1),[ht,Wt]=p.useState(()=>new Date),[be,Ct]=p.useState(!1),[wt,Ge]=p.useState([]),[Je,_e]=p.useState(!1),je=async()=>{try{Ct(!0);const he=await Uat({from:bt,to:ht,codigoEmpresa:t?.codigo_empresa});Ge(he||[])}catch(he){e({title:"Falha ao carregar vendas do perodo",description:he?.message||"Tente novamente",variant:"destructive"})}finally{Ct(!1)}},Ue=p.useMemo(()=>{const he=new Date;return{mostSold:Re,lowStock:n.filter(Qe=>Qe.status==="low_stock"||Qe.stock>0&&Qe.stock<=Qe.minStock).length,expired:n.filter(Qe=>Qe.validade&&Qe.validade<he).length}},[n,Re]),ze=p.useMemo(()=>{const he=new Date;return n.filter(Qe=>{const zt=w==="all"?!0:w==="low_stock"?Qe.status==="low_stock"||Qe.stock>0&&Qe.stock<=Qe.minStock:w==="expired"?Qe.validade&&Qe.validade<he:!1,Mt=C.status==="all"?!0:Qe.status===C.status,ir=C.type==="all"||Qe.type===C.type,nr=C.category==="all"||Qe.category===C.category,kr=!C.newOnly||Qe.dataImportacao&&(()=>Math.floor((new Date-Qe.dataImportacao)/864e5)<=7)();return zt&&Mt&&ir&&nr&&kr})},[n,w,C]),or=he=>he?.dataImportacao?Math.floor((new Date-he.dataImportacao)/(1e3*60*60*24))<=7:!1,tr=p.useMemo(()=>{const he=[...ze],Qe=W.dir==="asc"?1:-1,zt=(ir,nr)=>Number.isFinite(ir)?ir:nr,Mt=ir=>{if(!ir)return NaN;if(ir instanceof Date)return ir.getTime();const nr=new Date(ir);return Number.isNaN(nr.getTime())?NaN:nr.getTime()};return he.sort((ir,nr)=>{if(W.by==="code"){const kr=zt(parseInt((ir.code||"").trim(),10),1/0),Ft=zt(parseInt((nr.code||"").trim(),10),1/0);return kr===Ft?0:kr>Ft?Qe:-Qe}if(W.by==="name"){const kr=(ir.name||"").toString(),Ft=(nr.name||"").toString();return kr.localeCompare(Ft,"pt-BR",{sensitivity:"base"})*Qe}if(W.by==="validade"){const kr=zt(Mt(ir.validade),1/0),Ft=zt(Mt(nr.validade),1/0);return kr===Ft?0:kr>Ft?Qe:-Qe}return 0}),he},[ze,W]),Nt=p.useMemo(()=>{if(!me)return 1;const he=Math.ceil((ae||0)/me);return he>0?he:1},[ae,me]),yr=he=>{$(Qe=>Qe.by===he?{by:he,dir:Qe.dir==="asc"?"desc":"asc"}:{by:he,dir:"asc"})},Me=he=>{j(Qe=>Qe===he?"all":he)},dt=()=>{at(()=>{const he=new Date;return he.setHours(0,0,0,0),he}),Wt(new Date),gt(!0),setTimeout(je,0)},ut=(he,Qe)=>{P(zt=>({...zt,[he]:Qe}))},rr=async()=>{v(null);const he=t?.codigo_empresa||null;let Qe="";if(he)try{Qe=await UU({codigoEmpresa:he})}catch(zt){console.error("[Produtos] handleAddNew: falha ao obter prximo cdigo",zt)}u(Qe||""),y(!0)},hr=he=>{v(he),y(!0)},It=()=>{try{jst(tr),e({title:"Exportao concluda",description:`${tr.length} produto(s) exportado(s).`,variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(he){console.error("[Produtos] export:error",he);const Qe=Cc(he,{action:"export"});e({title:Qe.title,description:Qe.description,variant:"destructive"})}},dr=he=>{c(Qe=>Qe.includes(he)?Qe.filter(zt=>zt!==he):[...Qe,he])},ur=()=>{const he=tr.map(Qe=>Qe.id);he.length&&c(he)},er=()=>{c([])},ln=he=>{he?ur():er()},Mr=p.useMemo(()=>tr.filter(he=>l.includes(he.id)),[tr,l]),Ye=p.useMemo(()=>Mr.some(or),[Mr]),$e=async he=>{if(l.length)try{await Hat({ids:l,status:he}),await ue(),er(),e({title:he==="inactive"?"Produtos inativados":"Produtos atualizados",description:`${l.length} produto(s) atualizado(s).`,variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(Qe){const zt=Cc(Qe,{action:"save"});e({title:zt.title,description:zt.description,variant:"destructive"})}},Be=async()=>{if(!(!l.length||!Ye))try{await Gat({ids:l}),await ue(),er(),e({title:"Novos removidos",description:"A etiqueta de novo foi removida dos produtos selecionados.",variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(he){const Qe=Cc(he,{action:"save"});e({title:Qe.title,description:Qe.description,variant:"destructive"})}},et=async()=>{const he=t?.codigo_empresa||null;if(!(!r||!he))try{const Qe=await VU({codigoEmpresa:he});if(!X.current)return;i(Qe);try{localStorage.setItem(`produtos:cats:${he}`,JSON.stringify(Qe))}catch{}}catch(Qe){console.error("[Categorias] load on mount:error",Qe)}},jt=async he=>{i(Qe=>{if(Qe.includes(he))return Qe;const zt=[...Qe,he];return zt.sort((Mt,ir)=>Mt.localeCompare(ir,"pt-BR")),zt});try{await Kat(he,{codigoEmpresa:t?.codigo_empresa}),await et()}catch(Qe){i(Mt=>Mt.filter(ir=>ir!==he)),console.error("[Categorias] add:error",Qe);const zt=Cc(Qe,{action:"save"});e({title:zt.title,description:zt.description,variant:"destructive"})}},yt=async he=>{if(n.some(Mt=>Mt.category===he&&Mt.status!=="inactive"))throw new Error("Categoria possui produtos ativos vinculados");const zt=o;i(Mt=>Mt.filter(ir=>ir!==he));try{await Xat(he,{codigoEmpresa:t?.codigo_empresa}),await et()}catch(Mt){i(zt),console.error("[Categorias] remove:error",Mt);const ir=Cc(Mt,{action:"save"});e({title:ir.title,description:ir.description,variant:"destructive"})}},qt=async he=>{try{if(console.log("[Produtos] handleSaveProduct",he),!he||typeof he!="object"){console.warn("[Produtos] handleSaveProduct chamado sem payload vlido. Ignorando.");return}const Qe=t?.codigo_empresa||null;if(!he.code&&Qe)try{const Mt=await UU({codigoEmpresa:Qe});he.code=Mt}catch(Mt){console.error("[Produtos] Falha ao obter prximo cdigo automtico",Mt)}const zt=async Mt=>{const nr=new Promise((kr,Ft)=>setTimeout(()=>Ft(new Error("Timeout update/create (12s)")),12e3));return Promise.race([Mt,nr])};if(he.id){const Mt=await zt(u1(he.id,he,{codigoEmpresa:Qe}));console.log("[Produtos] Produto atualizado - active:",Mt.active,"status:",Mt.status),s(ir=>ir.map(nr=>nr.id===Mt.id?Mt:nr)),await ue(),console.log("[Produtos] Refetch concludo aps update")}else{he.dataImportacao||(he.dataImportacao=new Date);const Mt=await zt(qS(he,{codigoEmpresa:Qe}));console.log("[Produtos] Produto criado",Mt),s(ir=>[Mt,...ir]),setTimeout(()=>{ue().catch(ir=>console.error("[Produtos] refetch ps-create falhou",ir))},0)}}catch(Qe){console.error("[Produtos] Erro no handleSaveProduct",Qe);const zt=Cc(Qe,{action:"save"});throw e({title:zt.title,description:zt.description,variant:"destructive"}),Qe}},pt=he=>{z(he),I(!0)},Dt=async()=>{if(U?.id)try{D(!0),await WR(U.id),s(Qe=>Qe.filter(zt=>zt.id!==U.id)),await ue();const he=Cc(null,{action:"delete"});e({variant:"success",title:he.title,description:`Produto "${U.name}" foi inativado com sucesso.`})}catch(he){const Qe=Cc(he,{action:"delete"});e({variant:"destructive",...Qe})}finally{D(!1),I(!1),z(null)}};return a.jsxs(a.Fragment,{children:[a.jsxs(xr.div,{variants:wst,initial:"hidden",animate:"visible",className:"flex flex-col",children:[a.jsxs(xr.div,{variants:f3,className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-black text-text-primary tracking-tighter",children:"Controle de Produtos"}),a.jsx("p",{className:"text-text-secondary hidden md:block",children:"Controle total sobre seu inventrio e estoque."})]}),a.jsx(fe,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full hidden md:flex items-center justify-center",onClick:()=>B(!0),"aria-label":"Configuraes da aba",title:"Configuraes da aba",children:a.jsx(Ad,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"hidden md:flex items-center gap-2 flex-wrap",children:[a.jsx(fe,{variant:"outline",size:"icon",onClick:()=>h(he=>!he),title:f?"Ocultar resumo":"Mostrar resumo","aria-label":f?"Ocultar resumo":"Mostrar resumo",children:f?a.jsx(Yp,{className:"h-4 w-4"}):a.jsx(hg,{className:"h-4 w-4"})}),a.jsxs(fe,{variant:"outline",onClick:It,children:[a.jsx(uo,{className:"mr-2 h-4 w-4"})," Exportar"]}),a.jsxs(fe,{variant:"secondary",onClick:()=>Ze(!0),children:[a.jsx(Zo,{className:"mr-2 h-4 w-4"})," Importar XML"]}),a.jsxs(fe,{onClick:rr,children:[a.jsx(Ja,{className:"mr-2 h-4 w-4"})," Novo Produto"]})]}),a.jsxs("div",{className:"mt-2 flex md:hidden items-center gap-2",children:[a.jsxs(fe,{variant:"outline",className:"h-9 px-3 rounded-xl flex items-center gap-1 text-xs",onClick:It,title:"Exportar CSV","aria-label":"Exportar CSV",children:[a.jsx(uo,{className:"h-4 w-4"}),a.jsx("span",{children:"CSV"})]}),a.jsxs(fe,{variant:"secondary",className:"h-9 px-3 rounded-xl flex items-center gap-1 text-xs",onClick:()=>Ze(!0),title:"Importar XML","aria-label":"Importar XML",children:[a.jsx(Zo,{className:"h-4 w-4"}),a.jsx("span",{children:"XML"})]}),a.jsxs(fe,{className:"h-9 px-3 rounded-xl flex items-center gap-1 text-xs",onClick:rr,title:"Novo Produto","aria-label":"Novo Produto",children:[a.jsx(Ja,{className:"h-4 w-4"}),a.jsx("span",{children:"Prod"})]}),a.jsxs(fe,{variant:"outline",className:"h-9 px-3 rounded-xl flex items-center gap-1 text-xs",onClick:()=>b(!0),title:"Gerenciar categorias","aria-label":"Gerenciar categorias",children:[a.jsx(q2,{className:"h-4 w-4"}),a.jsx("span",{children:"Cat."})]}),a.jsx(fe,{variant:"outline",size:"icon",className:"h-9 w-9 rounded-xl flex items-center justify-center ml-auto",onClick:()=>B(!0),title:"Configuraes da aba","aria-label":"Configuraes da aba",children:a.jsx(Ad,{className:"h-4 w-4"})}),a.jsx(fe,{variant:"outline",size:"icon",className:"h-10 w-10 rounded-xl flex items-center justify-center ml-auto",onClick:()=>h(he=>!he),title:f?"Ocultar resumo":"Mostrar resumo","aria-label":f?"Ocultar resumo":"Mostrar resumo",children:f?a.jsx(Yp,{className:"h-5 w-5"}):a.jsx(hg,{className:"h-5 w-5"})})]})]}),f&&a.jsxs("div",{className:"grid grid-cols-3 gap-3 md:gap-6 mb-6",children:[a.jsx(ik,{icon:Dc,title:a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"hidden md:inline",children:"Mais Vendido (Dia)"}),a.jsx("span",{className:"md:hidden",children:"+ vendidos"})]}),value:Ue.mostSold,subtitle:"Produto com mais sadas hoje",color:"text-brand",onClick:dt}),a.jsx(ik,{icon:Xf,title:a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"hidden md:inline",children:"Estoque Baixo"}),a.jsx("span",{className:"md:hidden",children:"Est. baixo"})]}),value:Ue.lowStock,subtitle:"Produtos precisando de reposio",color:"text-warning",onClick:()=>Me("low_stock"),isActive:w==="low_stock"}),a.jsx(ik,{icon:t_,title:a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"hidden md:inline",children:"Vendidos"}),a.jsx("span",{className:"md:hidden",children:"Vencidos"})]}),value:Ue.expired,subtitle:"Produtos fora da data de validade",color:"text-danger",onClick:()=>Me("expired"),isActive:w==="expired"})]}),a.jsx(mn,{open:ie,onOpenChange:gt,children:a.jsxs(un,{className:"max-w-2xl",onKeyDown:he=>he.stopPropagation(),children:[a.jsxs(on,{children:[a.jsx(an,{className:"text-xl font-bold",children:"Vendas por Perodo"}),a.jsx(Nn,{children:"Selecione o intervalo de datas e visualize os produtos vendidos."})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 items-end",children:[a.jsxs("div",{children:[a.jsx(qe,{className:"mb-1 block",children:"Incio"}),a.jsxs(vi,{children:[a.jsx(xi,{asChild:!0,children:a.jsxs(fe,{variant:"outline",className:"w-full justify-start",children:[a.jsx(t_,{className:"mr-2 h-4 w-4"}),bt?cr(bt,"dd/MM/yyyy"):"Incio"]})}),a.jsx(ni,{className:"p-0 w-[300px]",children:a.jsx("div",{className:"w-[300px] min-h-[332px]",children:a.jsx(yi,{mode:"single",selected:bt,onSelect:he=>he&&at(he),initialFocus:!0,fixedWeeks:!0})})})]})]}),a.jsxs("div",{children:[a.jsx(qe,{className:"mb-1 block",children:"Fim"}),a.jsxs(vi,{children:[a.jsx(xi,{asChild:!0,children:a.jsxs(fe,{variant:"outline",className:"w-full justify-start",children:[a.jsx(t_,{className:"mr-2 h-4 w-4"}),ht?cr(ht,"dd/MM/yyyy"):"Fim"]})}),a.jsx(ni,{className:"p-0 w-[300px]",children:a.jsx("div",{className:"w-[300px] min-h-[332px]",children:a.jsx(yi,{mode:"single",selected:ht,onSelect:he=>he&&Wt(he),initialFocus:!0,fixedWeeks:!0})})})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(fe,{type:"button",onClick:je,disabled:be,className:"w-full",children:be?"Carregando...":"Aplicar"}),a.jsx(fe,{type:"button",variant:"secondary",onClick:()=>{try{const he=wt||[],Qe=";",zt=()=>{const kr=["Produto;Quantidade"];for(const Ft of he)kr.push(`${(Ft.name||"").replace(/;/g,",")}${Qe}${Number(Ft.total||0)}`);return kr.join(`
`)},Mt=new Blob(["\uFEFF"+zt()],{type:"text/csv;charset=utf-8;"}),ir=URL.createObjectURL(Mt),nr=document.createElement("a");nr.href=ir,nr.download="vendas-periodo.csv",document.body.appendChild(nr),nr.click(),document.body.removeChild(nr),URL.revokeObjectURL(ir),e({title:"Exportao concluda",description:`${he.length} linha(s)`,variant:"success"})}catch(he){e({title:"Falha ao exportar",description:he?.message||"Tente novamente",variant:"destructive"})}},children:"Exportar CSV"})]})]}),a.jsx("div",{className:"mt-3 border rounded-md max-h-[50vh] overflow-auto thin-scroll",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-surface-2",children:[a.jsx("th",{className:"text-left p-2",children:"Produto"}),a.jsx("th",{className:"text-right p-2",children:"Quantidade"})]})}),a.jsxs("tbody",{children:[(wt||[]).length===0&&!be&&a.jsx("tr",{children:a.jsx("td",{colSpan:2,className:"p-3 text-text-muted",children:"Nenhum item no perodo."})}),(wt||[]).map(he=>a.jsxs("tr",{className:"border-t border-border",children:[a.jsx("td",{className:"p-2",children:he.name}),a.jsx("td",{className:"p-2 text-right font-mono",children:Number(he.total||0)})]},he.id))]})]})}),a.jsx(Qn,{children:a.jsx(vh,{asChild:!0,children:a.jsx(fe,{type:"button",variant:"secondary",children:"Fechar"})})})]})}),a.jsx(mn,{open:V,onOpenChange:B,children:a.jsxs(un,{className:"max-w-2xl",children:[a.jsx(on,{children:a.jsx(an,{children:"Configuraes da aba"})}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-[11px] font-medium text-text-muted",children:"Modo de listagem"}),a.jsxs(vn,{value:Q,onValueChange:pe,children:[a.jsx(hn,{className:"w-[200px] h-8 text-xs",children:a.jsx(wn,{placeholder:"Paginado"})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"paged",children:"Paginado (100 por pgina)"}),a.jsx(ct,{value:"all",children:"Todos (sem paginao)"})]})]})]}),a.jsx("div",{className:"flex items-center justify-between pt-1",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(za,{id:"produtos-show-stats",checked:f,onCheckedChange:h}),a.jsx("label",{htmlFor:"produtos-show-stats",className:"text-xs font-medium text-text-primary",children:"Mostrar cards de resumo no topo"})]})})]}),a.jsx(Qn,{children:a.jsx(vh,{asChild:!0,children:a.jsx(fe,{type:"button",variant:"secondary",children:"Fechar"})})})]})}),a.jsxs(xr.div,{variants:f3,className:"bg-surface rounded-lg border border-border flex flex-col",children:[a.jsxs("div",{className:"p-3 pb-4 sm:p-4 border-b border-border space-y-3 flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(Zs,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(rt,{placeholder:"Buscar por nome ou cdigo...",className:"pl-9 text-sm",value:_,onChange:he=>S(he.target.value)})]}),a.jsx(fe,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full flex md:hidden items-center justify-center",onClick:()=>_e(!0),"aria-label":"Abrir filtros",title:"Filtros",children:a.jsx(gI,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"hidden md:flex w-full items-center gap-3",children:[a.jsx("div",{className:"flex-1 min-w-[120px]",children:a.jsxs(vn,{value:C.type,onValueChange:he=>ut("type",he),children:[a.jsx(hn,{className:"w-full text-xs sm:text-sm bg-surface-2 border border-border rounded-full px-3",children:a.jsx(wn,{})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"all",children:"Tipos"}),a.jsx(ct,{value:"Venda",children:"Venda"}),a.jsx(ct,{value:"Uso Interno",children:"Uso Interno"})]})]})}),a.jsx("div",{className:"flex-1 min-w-[140px]",children:a.jsxs(vn,{value:C.category,onValueChange:he=>ut("category",he),children:[a.jsx(hn,{className:"w-full text-xs sm:text-sm bg-surface-2 border border-border rounded-full px-3",children:a.jsx(wn,{})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"all",children:"Categorias"}),o.map(he=>a.jsx(ct,{value:he,children:he},he))]})]})}),a.jsx("div",{className:"flex-1 max-w-[180px]",children:a.jsxs(vn,{value:C.status,onValueChange:he=>ut("status",he),children:[a.jsx(hn,{className:"w-full text-xs sm:text-sm bg-surface-2 border border-border rounded-full px-3",children:a.jsx(wn,{})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"all",children:"Status"}),a.jsx(ct,{value:"active",children:"Ativo"}),a.jsx(ct,{value:"low_stock",children:"Estoque Baixo"}),a.jsx(ct,{value:"inactive",children:"Inativo"})]})]})}),a.jsxs("div",{className:"flex-1 flex justify-end gap-2 min-w-[160px]",children:[a.jsxs(fe,{variant:"outline",onClick:()=>ut("newOnly",!C.newOnly),className:pr("text-xs sm:text-sm rounded-full px-3 border border-border bg-surface-2 hover:bg-surface flex items-center gap-1 whitespace-nowrap",C.newOnly&&"bg-amber-500 text-black border-amber-500 hover:bg-amber-400"),size:"sm",children:[a.jsx("span",{className:"mr-1",children:""}),a.jsx("span",{children:"Novos"})]}),a.jsxs(fe,{variant:"outline",onClick:()=>b(!0),className:"text-xs sm:text-sm rounded-full px-3 border border-border bg-surface-2 hover:bg-surface flex items-center gap-1 whitespace-nowrap",size:"sm",children:[a.jsx(q2,{className:"h-3 w-3 sm:h-4 sm:w-4"}),a.jsx("span",{children:"Categorias"})]}),a.jsx(fe,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full flex items-center justify-center",onClick:()=>B(he=>!he),"aria-label":"Configuraes da aba",title:"Configuraes da aba",children:a.jsx(Ad,{className:"h-4 w-4"})})]})]})]}),l.length>0&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"px-3 sm:px-4 py-2.5 border-b border-border flex md:hidden items-center gap-2 text-xs",children:[a.jsxs("span",{className:"font-medium mr-2",children:[l.length," sel."]}),a.jsxs("button",{type:"button",className:"flex items-center gap-1.5 px-3 py-1.5 rounded-full border border-border bg-surface-2",onClick:()=>{const he=tr.length>0&&tr.every(Qe=>l.includes(Qe.id));ln(!he)},children:[a.jsx(za,{checked:tr.length>0&&tr.every(he=>l.includes(he.id)),className:"h-4 w-4"}),a.jsx("span",{children:"Todos"})]}),a.jsxs("div",{className:"flex items-center gap-1.5 ml-auto",children:[a.jsx(fe,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>$e("active"),children:a.jsx(Ro,{className:"h-4 w-4"})}),a.jsx(fe,{variant:"outline",size:"icon",className:"h-8 w-8 text-danger border-danger/60 hover:bg-danger/10",onClick:()=>$e("inactive"),children:a.jsx(Ju,{className:"h-4 w-4"})}),Ye&&a.jsx(fe,{variant:"outline",size:"icon",className:"h-8 w-8 border-amber-500/70 text-amber-700 hover:bg-amber-500/10",onClick:Be,children:a.jsx(q2,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{className:"hidden md:flex px-4 py-2 border-b border-border items-center gap-3 text-xs",children:[a.jsx("span",{className:"font-medium text-text-secondary whitespace-nowrap",children:l.length===0?"Nenhum item selecionado":`${l.length} produto${l.length>1?"s":""} selecionado${l.length>1?"s":""}`}),a.jsxs("div",{className:"flex flex-1 flex-wrap items-center justify-end gap-2",children:[a.jsxs(fe,{variant:"outline",size:"xs",className:"h-7 px-3 rounded-full border border-border bg-surface-2 hover:bg-surface flex items-center gap-1",onClick:ur,children:[a.jsx(Ro,{className:"h-3 w-3"}),a.jsx("span",{children:"Marcar filtrados"})]}),a.jsxs(fe,{variant:"outline",size:"xs",className:"h-7 px-3 rounded-full border border-border bg-surface-2 hover:bg-surface flex items-center gap-1",onClick:er,children:[a.jsx(gI,{className:"h-3 w-3"}),a.jsx("span",{children:"Limpar seleo"})]}),a.jsxs(fe,{size:"xs",variant:"outline",className:"h-7 px-3 rounded-full border-emerald-500/70 text-emerald-300 bg-emerald-500/10 hover:bg-emerald-500/20 flex items-center gap-1",onClick:()=>$e("active"),children:[a.jsx(Ro,{className:"h-3 w-3"}),a.jsx("span",{children:"Ativar itens"})]}),a.jsxs(fe,{size:"xs",variant:"outline",className:"h-7 px-3 rounded-full text-danger border-danger/60 hover:bg-danger/10 flex items-center gap-1",onClick:()=>$e("inactive"),children:[a.jsx(Yp,{className:"h-3 w-3"}),a.jsx("span",{children:"Desativar itens"})]}),Ye&&a.jsxs(fe,{size:"xs",variant:"outline",className:"h-7 px-3 rounded-full border-amber-500/70 text-amber-500 hover:bg-amber-500/10 flex items-center gap-1",onClick:Be,children:[a.jsx(q2,{className:"h-3 w-3"}),a.jsx("span",{children:'Limpar tag "Novo"'})]})]})]})]}),a.jsx("div",{children:tr.length===0?a.jsxs("div",{className:"p-10 text-center text-text-secondary",children:[a.jsx("p",{className:"text-lg mb-3",children:"Nenhum produto cadastrado."}),a.jsxs(fe,{onClick:rr,children:[a.jsx(Ja,{className:"mr-2 h-4 w-4"}),"Cadastrar primeiro produto"]})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"md:hidden p-3 space-y-3",children:tr.map(he=>{const Qe=l.includes(he.id);return a.jsxs("div",{className:pr("rounded-lg border bg-surface p-4 space-y-3 cursor-pointer",Qe?"border-brand/70 bg-brand/5":"border-border"),onClick:()=>hr(he),children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsx("button",{type:"button",className:"pt-1 pr-2 -ml-1 flex items-center justify-center w-9 h-9",onClick:zt=>{zt.stopPropagation(),dr(he.id)},children:a.jsx(za,{checked:Qe,className:"h-5 w-5 border-2"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h3",{className:"font-semibold text-base text-text-primary truncate",title:he.name,children:he.name}),he.dataImportacao&&(()=>Math.floor((new Date-he.dataImportacao)/864e5)<=7?a.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-brand/20 text-brand text-xs font-medium flex-shrink-0",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Novo"})]}):null)()]}),a.jsx("p",{className:"text-xs text-text-muted mt-0.5",children:he.category||"Sem categoria"})]}),a.jsx("span",{className:pr("inline-flex px-2 py-0.5 rounded-full text-xs border flex-shrink-0",he.status==="active"&&"bg-emerald-50/5 border-emerald-500/30 text-emerald-400",he.status==="low_stock"&&"bg-amber-50/5 border-amber-500/30 text-amber-400",he.status==="inactive"&&"bg-surface-2 border-border text-text-muted"),children:he.status==="active"?"Ativo":he.status==="low_stock"?"Estoque Baixo":"Inativo"})]}),a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs text-text-muted",children:[he.code&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx("span",{children:"Cd."}),a.jsx("span",{className:"font-mono text-text-primary text-xs",children:he.code})]}),a.jsx("span",{className:"mx-1 text-text-muted",children:""}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx("span",{children:"R$"}),a.jsx("span",{className:"font-semibold text-text-primary",children:he.price.toFixed(2)})]}),a.jsx("span",{className:"mx-1 text-text-muted",children:""}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx("span",{children:"Est."}),a.jsx("span",{className:"font-medium text-text-primary",children:he.stock})]}),he.validade&&a.jsx("span",{className:"mx-1 text-text-muted",children:""}),he.validade&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx("span",{children:"Val."}),a.jsx("span",{className:"text-text-primary",children:(()=>{const zt=he.validade instanceof Date?he.validade:K6(String(he.validade));return isNaN(zt)?"-":cr(zt,"dd/MM/yy")})()})]}),a.jsxs("div",{className:"ml-auto flex items-center gap-1",children:[a.jsx(fe,{variant:"outline",size:"icon",onClick:zt=>{zt.stopPropagation(),hr(he)},className:"h-7 w-7",children:a.jsx(Cl,{className:"h-3.5 w-3.5"})}),a.jsx(fe,{variant:"outline",size:"icon",onClick:zt=>{zt.stopPropagation(),pt(he)},className:"h-7 w-7 text-danger hover:text-danger",children:a.jsx(Ju,{className:"h-3.5 w-3.5"})})]})]})]},he.id)})}),a.jsx("div",{className:"hidden md:block rounded-lg border border-border overflow-hidden",children:a.jsxs("table",{className:"w-full text-sm bg-surface table-fixed",children:[a.jsx("thead",{className:"bg-surface-2 text-text-secondary",children:a.jsxs("tr",{className:"border-b border-border",children:[a.jsx("th",{className:"p-3 w-10 text-center",children:a.jsx(za,{checked:tr.length>0&&tr.every(he=>l.includes(he.id)),onCheckedChange:he=>ln(!!he)})}),a.jsxs("th",{className:"p-3 text-left font-semibold select-none cursor-pointer whitespace-nowrap w-[110px]",onClick:()=>yr("code"),children:["Cdigo ",W.by==="code"?W.dir==="asc"?"":"":""]}),a.jsxs("th",{className:"p-3 text-left font-semibold select-none cursor-pointer whitespace-nowrap w-[40%]",onClick:()=>yr("name"),children:["Produto ",W.by==="name"?W.dir==="asc"?"":"":""]}),a.jsx("th",{className:"p-3 text-left font-semibold whitespace-nowrap w-[18%]",children:"Categoria"}),a.jsx("th",{className:"p-3 text-right font-semibold whitespace-nowrap w-[120px]",children:"Preo"}),a.jsx("th",{className:"p-3 text-right font-semibold whitespace-nowrap w-[110px]",children:"Estoque"}),a.jsxs("th",{className:"p-3 text-center font-semibold select-none cursor-pointer whitespace-nowrap w-[120px]",onClick:()=>yr("validade"),children:["Validade ",W.by==="validade"?W.dir==="asc"?"":"":""]}),a.jsx("th",{className:"p-3 text-center font-semibold whitespace-nowrap w-[140px]",children:"Status"}),a.jsx("th",{className:"p-3 text-right font-semibold whitespace-nowrap w-[90px]",children:"Aes"})]})}),a.jsx("tbody",{className:"text-text-primary divide-y divide-border",children:tr.map(he=>a.jsxs("tr",{className:"hover:bg-surface-2 transition-colors group cursor-pointer align-middle",children:[a.jsx("td",{className:"p-3 text-center align-middle",children:a.jsx(za,{checked:l.includes(he.id),onCheckedChange:()=>dr(he.id)})}),a.jsx("td",{className:"p-3 font-mono text-sm text-text-secondary align-middle whitespace-nowrap",onClick:()=>hr(he),children:he.code||"-"}),a.jsx("td",{className:"p-3 font-semibold align-middle text-text-primary whitespace-nowrap overflow-hidden text-ellipsis",onClick:()=>hr(he),title:he.name,children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"truncate",children:he.name}),he.dataImportacao&&(()=>Math.floor((new Date-he.dataImportacao)/864e5)<=7?a.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-brand/20 text-brand text-xs font-medium flex-shrink-0",children:[a.jsx("span",{children:""}),a.jsx("span",{children:"Novo"})]}):null)()]})}),a.jsx("td",{className:"p-3 text-text-secondary align-middle whitespace-nowrap",onClick:()=>hr(he),children:he.category}),a.jsxs("td",{className:"p-3 text-right font-mono tabular-nums align-middle whitespace-nowrap",onClick:()=>hr(he),children:["R$ ",he.price.toFixed(2)]}),a.jsx("td",{className:"p-3 text-right font-mono tabular-nums align-middle whitespace-nowrap",onClick:()=>hr(he),children:he.stock}),a.jsx("td",{className:"p-3 text-center font-mono tabular-nums whitespace-nowrap",onClick:()=>hr(he),children:(()=>{if(!he.validade)return"-";const Qe=he.validade instanceof Date?he.validade:K6(String(he.validade));return isNaN(Qe)?"-":cr(Qe,"dd/MM/yy")})()}),a.jsx("td",{className:"p-3 text-center whitespace-nowrap",onClick:()=>hr(he),children:a.jsx("span",{className:pr("px-2 py-1 text-xs font-bold rounded-full",he.status==="active"&&"bg-success/10 text-success",he.status==="low_stock"&&"bg-warning/10 text-warning",he.status==="inactive"&&"bg-danger/10 text-danger"),children:he.status==="active"?"Ativo":he.status==="low_stock"?"Estoque Baixo":"Inativo"})}),a.jsx("td",{className:"p-3 whitespace-nowrap",children:a.jsx("div",{className:"flex items-center justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:a.jsx(fe,{variant:"ghost",size:"icon",className:"h-8 w-8 text-text-muted hover:text-danger",onClick:Qe=>{Qe.stopPropagation(),pt(he)},children:a.jsx(Ju,{size:14})})})})]},he.id))})]})})]})}),te&&a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between mt-4 gap-2 text-xs sm:text-sm text-text-muted px-3 sm:px-4 pb-3",children:[a.jsxs("span",{children:["Pgina ",Y," de ",Nt," (",ae," produto(s))"]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(fe,{type:"button",variant:"outline",size:"sm",onClick:()=>ce(he=>Math.max(1,he-1)),disabled:Y<=1,children:"Anterior"}),a.jsx(fe,{type:"button",variant:"outline",size:"sm",onClick:()=>ce(he=>Math.min(Nt,he+1)),disabled:Y>=Nt,children:"Prxima"})]})]})]})]}),a.jsx(_st,{open:g,onOpenChange:y,product:m,categories:o,onSave:qt,onCreateCategory:jt,suggestedCode:m?void 0:d,onRefreshProducts:ue,products:n}),a.jsx(mn,{open:O,onOpenChange:I,children:a.jsxs(un,{className:"sm:max-w-[480px]",children:[a.jsxs(on,{children:[a.jsx(an,{children:"Excluir produto"}),a.jsxs(Nn,{children:["Tem certeza que deseja excluir o produto",U?` "${U.name}"`:"","? Esta ao no pode ser desfeita."]})]}),a.jsxs(Qn,{children:[a.jsx(vh,{asChild:!0,children:a.jsx(fe,{type:"button",variant:"secondary",disabled:M,children:"Cancelar"})}),a.jsx(fe,{type:"button",variant:"destructive",onClick:Dt,disabled:M,children:M?"Excluindo...":"Excluir"})]})]})}),a.jsx(xst,{open:xt,onOpenChange:Ze,products:n,codigoEmpresa:t?.codigo_empresa,onSuccess:()=>{ue(),Ze(!1)}}),a.jsx(mn,{open:Je,onOpenChange:_e,children:a.jsxs(un,{className:"w-[90vw] sm:max-w-[420px]",children:[a.jsx(on,{children:a.jsx(an,{className:"text-base",children:"Filtros de Produtos"})}),a.jsxs("div",{className:"space-y-3 py-2 text-xs",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(qe,{className:"text-xs",children:"Tipo"}),a.jsxs(vn,{value:C.type,onValueChange:he=>ut("type",he),children:[a.jsx(hn,{className:"text-xs",children:a.jsx(wn,{})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"all",children:"Todos"}),a.jsx(ct,{value:"Venda",children:"Venda"}),a.jsx(ct,{value:"Uso Interno",children:"Uso Interno"})]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(qe,{className:"text-xs",children:"Categoria"}),a.jsxs(vn,{value:C.category,onValueChange:he=>ut("category",he),children:[a.jsx(hn,{className:"text-xs",children:a.jsx(wn,{})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"all",children:"Todas"}),o.map(he=>a.jsx(ct,{value:he,children:he},he))]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(qe,{className:"text-xs",children:"Status"}),a.jsxs(vn,{value:C.status,onValueChange:he=>ut("status",he),children:[a.jsx(hn,{className:"text-xs",children:a.jsx(wn,{})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"all",children:"Todos"}),a.jsx(ct,{value:"active",children:"Ativo"}),a.jsx(ct,{value:"low_stock",children:"Estoque Baixo"}),a.jsx(ct,{value:"inactive",children:"Inativo"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2 pt-1",children:[a.jsx(za,{id:"mobileNewOnly",checked:!!C.newOnly,onCheckedChange:he=>ut("newOnly",!!he)}),a.jsx(qe,{htmlFor:"mobileNewOnly",className:"text-xs flex items-center gap-1",children:a.jsx("span",{children:"Somente Novos"})})]})]}),a.jsxs(Qn,{className:"flex justify-between mt-2",children:[a.jsx(fe,{type:"button",variant:"outline",size:"sm",className:"text-xs",onClick:()=>{P({type:"all",category:"all",status:"active",newOnly:!1}),_e(!1)},children:"Limpar"}),a.jsx(fe,{type:"button",size:"sm",className:"text-xs",onClick:()=>_e(!1),children:"Aplicar"})]})]})}),a.jsx(Sst,{open:x,onOpenChange:b,categories:o,onAddCategory:jt,onRemoveCategory:yt})]})}function Pst({purchase:e,items:t,onClose:r,onEdit:n,onReprocess:s,onDownloadXML:o,onInactivate:i}){if(!e)return null;const l=t.reduce((d,u)=>d+Number(u.valor_total||0),0),c=d=>d?.data_importacao?Awe(new Date,new Date(d.data_importacao))<=7:!1;return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-3 py-4 bg-black/60 backdrop-blur-sm",children:a.jsxs("div",{className:"relative w-[95vw] sm:w-full sm:max-w-4xl max-h-[85vh] bg-surface rounded-xl shadow-2xl border border-border overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"relative bg-surface border-b border-border p-4",children:[a.jsx("button",{onClick:r,className:"absolute top-3 right-3 p-1.5 hover:bg-surface-2 rounded-lg transition-colors",children:a.jsx(al,{className:"h-4 w-4 text-text-muted"})}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 sm:gap-4 pr-0 sm:pr-10",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"p-2 bg-brand/10 rounded-lg",children:a.jsx(Zo,{className:"h-5 w-5 text-brand"})}),a.jsxs("div",{children:[a.jsxs("h2",{className:"text-xl font-bold text-text-primary mb-0.5",children:["NF-e ",e.numero_nfe,e.serie_nfe&&` / Srie ${e.serie_nfe}`]}),a.jsx("p",{className:"text-text-muted text-xs",children:e.natureza_operacao||"Nota Fiscal Eletrnica"})]})]}),a.jsxs("div",{className:"mt-3 sm:mt-0 sm:text-right",children:[a.jsx("p",{className:"text-text-muted text-xs mb-0.5",children:"Valor Total"}),a.jsxs("p",{className:"text-xl sm:text-2xl font-bold text-success whitespace-nowrap",children:["R$ ",Number(e.valor_total||0).toFixed(2)]})]})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6 space-y-6",children:a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-surface-2 rounded-lg border border-border p-4",children:a.jsxs("div",{className:"flex flex-col gap-3",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex-shrink-0 mt-0.5",children:a.jsx(Uu,{className:"h-4 w-4 text-brand"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"text-xs font-medium text-text-muted mb-0.5",children:"Fornecedor"}),a.jsx("p",{className:"font-semibold text-base text-text-primary leading-snug break-words",children:e.fornecedor?.nome||"No identificado"}),e.fornecedor?.cnpj&&a.jsxs("p",{className:"text-xs text-text-muted mt-0.5",children:["CNPJ: ",e.fornecedor.cnpj]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 lg:grid-cols-5 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(Bs,{className:"h-3.5 w-3.5 text-info"}),a.jsx("span",{className:"text-xs font-medium text-text-muted",children:"Emisso"})]}),a.jsx("p",{className:"font-semibold text-text-primary",children:e.data_emissao?cr(new Date(e.data_emissao),"dd/MM/yyyy",{locale:na}):"No informada"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(Vue,{className:"h-3.5 w-3.5 text-warning"}),a.jsx("span",{className:"text-xs font-medium text-text-muted",children:"Operao"})]}),a.jsx("p",{className:"font-semibold text-text-primary",children:e.tipo_operacao||"Entrada"})]}),e.forma_pagamento&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(Qm,{className:"h-3.5 w-3.5 text-success"}),a.jsx("span",{className:"text-xs font-medium text-text-muted",children:"Pagamento"})]}),a.jsx("p",{className:"font-semibold text-text-primary",children:e.forma_pagamento})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-medium text-text-muted mb-1",children:"Valor dos Produtos"}),a.jsxs("p",{className:"font-semibold text-text-primary",children:["R$ ",l.toFixed(2)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-medium text-text-muted mb-1",children:"Valor Total NF-e"}),a.jsxs("p",{className:"font-semibold text-brand",children:["R$ ",Number(e.valor_total||0).toFixed(2)]})]})]})]})}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-base font-semibold text-text-primary flex items-center gap-2 mb-3",children:[a.jsx(Td,{className:"h-4 w-4 text-brand"}),"Produtos da NF-e",a.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-brand/10 text-brand font-medium ml-2",children:t.length})]}),a.jsx("div",{className:"space-y-2",children:t.map((d,u)=>a.jsx("div",{className:"p-3 bg-surface-2 rounded-lg border border-border hover:border-brand/30 transition-colors",children:a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsx("div",{className:"flex-1 min-w-0",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-brand/10 text-brand text-xs font-bold flex items-center justify-center mt-0.5",children:u+1}),a.jsxs("div",{className:"flex-1",children:[d.produto?.nome?a.jsxs(a.Fragment,{children:[a.jsxs("p",{className:"font-medium text-base text-text-primary mb-0.5",children:["Produto atual: ",d.produto.nome]}),d.nome_produto_xml&&a.jsxs("p",{className:"text-xs text-text-muted mb-1",children:["XML original: ",a.jsx("span",{className:"font-medium text-text-primary",children:d.nome_produto_xml})]})]}):a.jsx("p",{className:"font-medium text-sm text-text-primary mb-1",children:d.nome_produto_xml}),a.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-0.5 text-xs text-text-muted mb-1.5",children:[(d.produto?.codigo_produto||d.codigo_produto_xml)&&a.jsxs("span",{children:[a.jsx("span",{className:"font-medium",children:"Cd:"})," ",d.produto?.codigo_produto||d.codigo_produto_xml]}),d.ean_xml&&d.ean_xml!=="SEM GTIN"&&a.jsxs("span",{children:[a.jsx("span",{className:"font-medium",children:"EAN:"})," ",d.ean_xml]}),d.ncm_xml&&a.jsxs("span",{children:[a.jsx("span",{className:"font-medium",children:"NCM:"})," ",d.ncm_xml]}),d.unidade_xml&&a.jsxs("span",{children:[a.jsx("span",{className:"font-medium",children:"Un:"})," ",d.unidade_xml]}),d.produto&&a.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-success/20 text-success font-medium",children:" Cadastrado"}),d.produto&&c(d.produto)&&a.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-brand/20 text-brand font-medium",children:[a.jsx(vI,{className:"h-3 w-3"}),"Novo"]}),d.vinculado_manualmente&&a.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-warning/20 text-warning font-medium",children:" Vinculado"}),!d.produto&&a.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-text-muted/20 text-text-muted font-medium",children:" No importado"})]})]})]})}),a.jsxs("div",{className:"flex-shrink-0 text-right",children:[a.jsxs("div",{className:"mb-1.5",children:[a.jsx("span",{className:"text-xs text-text-muted mr-1",children:"Qtd:"}),a.jsx("span",{className:"font-bold text-base text-warning",children:d.quantidade})]}),a.jsxs("div",{className:"space-y-0.5",children:[a.jsxs("p",{className:"text-xs text-text-muted",children:["Unit: ",a.jsxs("span",{className:"font-semibold text-success",children:["R$ ",Number(d.valor_unitario||0).toFixed(2)]})]}),a.jsxs("p",{className:"text-sm font-bold text-text-primary",children:["Total: R$ ",Number(d.valor_total||0).toFixed(2)]})]})]})]})},u))})]}),e.chave_nfe&&a.jsxs("div",{className:"p-3 bg-surface-2 rounded-lg border border-border",children:[a.jsxs("p",{className:"text-xs font-medium text-text-muted mb-1.5 flex items-center gap-1.5",children:[a.jsx(Zo,{className:"h-3 w-3"}),"Chave de Acesso NF-e:"]}),a.jsx("p",{className:"font-mono text-xs text-text-primary break-all leading-relaxed select-all",children:e.chave_nfe})]})]})}),a.jsxs("div",{className:"p-3 sm:p-4 bg-surface-2 border-t border-border flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[a.jsx("div",{className:"flex flex-wrap gap-2",children:e.ativo&&a.jsxs(a.Fragment,{children:[a.jsxs(fe,{onClick:()=>n?.(e),size:"sm",variant:"outline",className:"gap-2",children:[a.jsx(Cl,{className:"h-4 w-4"}),"Editar"]}),a.jsxs(fe,{onClick:()=>s?.(e),size:"sm",variant:"outline",className:"gap-2",disabled:!e.xml_completo,children:[a.jsx(Jp,{className:"h-4 w-4"}),"Reprocessar"]}),e.xml_completo&&a.jsx(a.Fragment,{children:a.jsxs(fe,{onClick:()=>o?.(e),size:"sm",variant:"outline",className:"gap-2",children:[a.jsx(uo,{className:"h-4 w-4"}),"XML"]})}),a.jsxs(fe,{onClick:()=>i?.(e),size:"sm",variant:"outline",className:"gap-2 text-destructive hover:text-destructive",children:[a.jsx(Ju,{className:"h-4 w-4"}),"Inativar"]})]})}),a.jsx(fe,{onClick:r,variant:"outline",className:"w-full sm:w-auto",children:"Fechar"})]})]})})}function Ast({open:e,onOpenChange:t,purchase:r,products:n,codigoEmpresa:s,onSuccess:o,autoFile:i}){const{toast:l}=Qa(),[c,d]=p.useState("upload"),[u,f]=p.useState(null),[h,m]=p.useState(null),[v,g]=p.useState([]),[y,x]=p.useState(!1),[b,w]=p.useState({created:0,updated:0,errors:0,details:[]}),[j,_]=p.useState({}),[S,C]=p.useState({}),[P,A]=p.useState({}),[R,O]=p.useState({isOpen:!1,productIndex:null,currentProduct:null}),[I,M]=p.useState({isOpen:!1}),D=()=>{const Y=h?.nfe?.modelo||r?.modelo_nfe;return Y==="55"?"NF-e":Y==="65"?"NFC-e":"NF-e / NFC-e"},U=(Y,ce,me)=>j[Y]?.[ce]??me,z=(Y,ce)=>!Y||!ce?0:Y*(1+ce/100),W=Y=>{C(ce=>({...ce,[Y]:!ce[Y]}))},$=(Y,ce,me)=>{console.log("[XMLReprocessModal] handleEditProduct chamado:",{index:Y,field:ce,value:me}),_(ae=>{const le={...ae,[Y]:{...ae[Y],[ce]:me}};return console.log("[XMLReprocessModal] Novo estado editedProducts:",le),le})},X=Y=>{g(ce=>ce.map((me,ae)=>{if(ae===Y){const le=!me.selected;return A(ue=>({...ue,[Y]:le})),{...me,selected:le}}return me}))},ye=(Y,ce)=>{console.log("[XMLReprocessModal] handleLinkProduct chamado:",{index:Y,productId:ce}),console.log("[XMLReprocessModal] Estado editedProducts antes:",j[Y]),$(Y,"linkedProductId",ce),console.log("[XMLReprocessModal] Estado editedProducts depois:",{...j,[Y]:{...j[Y],linkedProductId:ce}})};p.useEffect(()=>{i&&e&&Se(i)},[i,e]);const Se=async Y=>{f(Y);try{console.log("[XMLReprocess] Processando arquivo automtico..."),console.log("[XMLReprocess] Purchase data:",r);const me=await Y.text();console.log("[XMLReprocess] XML content length:",me.length);const ae=zS(me);if(!ae.success){l({title:"Erro ao ler XML",description:ae.error||"XML invlido",variant:"destructive"});return}console.log("[XMLReprocess] Dados parseados:",ae.data),console.log("[XMLReprocess] Produtos encontrados:",ae.data?.produtos?.length||0),console.log("[XMLReprocess] Comparando chaves:",{xmlChave:ae.data?.nfe?.chaveAcesso,purchaseChave:r?.chave_nfe,match:ae.data?.nfe?.chaveAcesso===r?.chave_nfe}),m(ae.data);const le=await Use(r.id);console.log("[XMLReprocess] Itens da compra original:",le.length);const ue=ae.data?.produtos?.map((ne,ie)=>{const gt=US(ne,n),bt=!gt,at=le.find(ht=>ne.codigo&&ht.codigo_produto_xml?ht.codigo_produto_xml===ne.codigo:ht.nome_produto_xml===ne.nome),xt=!!at,Ze=at?.selecionado_na_importacao||!1;return console.log(`[XMLReprocess] Produto ${ie+1}: ${ne.nome}`),console.log(`  - Cdigo XML: ${ne.codigo}`),console.log("  - originalItem encontrado:",at?`${at.nome_produto_xml} (cdigo: ${at.codigo_produto_xml})`:"NO ENCONTRADO"),console.log(`  - wasImported: ${xt}`),console.log(`  - wasSelectedInOriginalImport: ${Ze}`),{index:ie,xml:ne,existing:gt,isNew:bt,wasImported:xt,selected:P[ie]!==void 0?P[ie]:xt}})||[];console.log("[XMLReprocess] Preview preparado:",ue.length,"produtos"),console.log("[XMLReprocess] Produtos marcados:",ue.filter(ne=>ne.selected).length),console.log("[XMLReprocess] Produtos importados originalmente:",ue.filter(ne=>ne.wasImported).length),console.log("[XMLReprocess] Items da compra original detalhado:"),le.forEach((ne,ie)=>{console.log(`  ${ie+1}. ${ne.nome_produto_xml} (cdigo: ${ne.codigo_produto_xml}) - selecionado_na_importacao: ${ne.selecionado_na_importacao}`)}),g(ue);const Re={};ue.forEach((ne,ie)=>{ne.xml.precoVenda&&(Re[ie]={salePrice:Number(ne.xml.precoVenda)})}),console.log("[XMLReprocess] Pr-populando editedProducts:",Re),_(Re),d("preview")}catch(me){console.error("[XMLReprocess] Erro ao processar arquivo automtico:",me),l({title:"Erro",description:"Erro ao processar o XML salvo.",variant:"destructive"})}},V=async Y=>{const ce=Y.target.files?.[0];if(!ce){console.log("[XMLReprocess] Nenhum arquivo selecionado");return}if(console.log("[XMLReprocess] Arquivo selecionado:",ce.name),!ce.name.endsWith(".xml")){l({title:"Arquivo invlido",description:"Selecione um arquivo XML vlido.",variant:"destructive"});return}f(ce);try{console.log("[XMLReprocess] Lendo contedo do arquivo...");const me=await ce.text();console.log("[XMLReprocess] Arquivo lido, parseando XML...");const ae=zS(me);if(console.log("[XMLReprocess] XML parseado:",ae),!ae.success){l({title:"Erro ao ler XML",description:ae.error||"XML invlido",variant:"destructive"});return}if(!ae.data?.produtos||ae.data.produtos.length===0){l({title:"Nenhum produto encontrado",description:"O XML no contm produtos.",variant:"warning"});return}if(ae.data?.nfe?.chaveAcesso!==r?.chave_nfe){l({title:"XML incompatvel",description:"Este XML no corresponde  NF-e selecionada. Verifique a chave de acesso.",variant:"destructive"});return}m(ae.data);let le=n;try{le=await bu({search:"",codigoEmpresa:s,includeInactive:!0})||n,console.log("[XMLReprocess] Produtos carregados para validao:",le.length)}catch(ne){console.warn("[XMLReprocess] No foi possvel carregar lista completa, usando cache:",ne)}const ue=ae.data.produtos.map((ne,ie)=>{const gt=US(ne,le);return{xml:ne,existing:gt,isNew:!gt,willCreate:!gt,willUpdate:!!gt,selected:!0,index:ie}});g(ue);const Re={};ue.forEach((ne,ie)=>{ne.xml.precoVenda&&(Re[ie]={salePrice:Number(ne.xml.precoVenda)})}),console.log("[XMLReprocess] Pr-populando editedProducts:",Re),_(Re),console.log("[XMLReprocess] Preview preparado, mudando para step preview. Total produtos:",ue.length),d("preview")}catch(me){console.error("[XMLReprocess] Erro ao processar arquivo:",me),l({title:"Erro",description:"Erro ao processar o arquivo XML.",variant:"destructive"})}},B=()=>{M({isOpen:!0})},Q=async()=>{if(M({isOpen:!1}),!h||!r){l({title:"Erro",description:"Dados insuficientes para reprocessamento.",variant:"destructive"});return}x(!0),d("processing");const Y={created:0,updated:0,removed:0,errors:0,details:[]},ce=v.filter(ae=>ae.selected),me=v.filter(ae=>!ae.selected);console.log("[XMLReprocess] Iniciando reprocessamento para compra:",r.id),console.log("[XMLReprocess] Produtos selecionados:",ce.length),console.log("[XMLReprocess] Produtos desmarcados:",me.length);try{for(const ae of me){const ue=(j[ae.index]||{}).name||ae.xml.nome,Re=Number(ae.xml.quantidade);try{if(ae.isNew){const ne=ae.existing;ne&&(await WR(ne.id),Y.removed++,Y.details.push({produto:ue,acao:"Produto removido (era novo e foi desmarcado)",status:"success"}))}else{const ne=ae.existing;ne&&Re>0&&(await bx({productId:ne.id,delta:-Re,codigoEmpresa:r.codigo_empresa}),Y.updated++,Y.details.push({produto:ue,acao:`Estoque revertido -${Re}`,status:"success"}))}}catch(ne){console.error(`[XMLReprocess] Erro ao processar produto desmarcado: ${ue}`,ne),Y.errors++,Y.details.push({produto:ue,acao:`Erro ao reverter: ${ne.message}`,status:"error"})}}for(const ae of ce){const le=j[ae.index]||{},ue=le.name||ae.xml.nome,Re=le.qty!==void 0?le.qty:Number(ae.xml.quantidade),ne=le.margin,ie=le.salePrice,gt=le.linkedProductId;try{if(ae.isNew&&(!gt||gt==="new")){const bt=u3(ae.xml,r.codigo_empresa);if(ue&&(bt.name=ue),ie!=null)bt.salePrice=ie,bt.price=ie;else if(ne!=null&&ne>0){const xt=bt.costPrice||0;if(xt>0){const Ze=xt*(1+ne/100);bt.salePrice=Ze,bt.price=Ze}}else bt.salePrice!=null&&bt.price==null&&(bt.price=bt.salePrice);const at=await qS(bt,{codigoEmpresa:r.codigo_empresa});Re>0&&await bx({productId:at.id,delta:Re,codigoEmpresa:r.codigo_empresa}),Y.created++,Y.details.push({produto:ue,acao:Re>0?`Criado com estoque ${Re}`:"Criado",status:"success"})}else{const bt=gt&&gt!=="force-new"&&gt!=="new"?n.find(at=>at.id===gt):ae.existing;if(le.updatePrice&&bt){const at=Number(ae.xml.valorUnitario)||0,xt={};if(at>0&&(xt.costPrice=at),ie!=null)xt.salePrice=ie,xt.price=ie;else if(ne!=null&&ne>0&&at>0){const Ze=at*(1+ne/100);xt.salePrice=Ze,xt.price=Ze}await u1(bt.id,xt)}Y.updated++,Y.details.push({produto:ue,acao:le.updatePrice?"Preo atualizado":"Mantido sem alteraes",status:"success"})}}catch(bt){console.error(`[XMLReprocess] Erro ao processar produto: ${ue}`,bt),Y.errors++,Y.details.push({produto:ue,acao:`Erro: ${bt.message}`,status:"error"})}}}catch(ae){console.error("[XMLReprocess] Erro geral no reprocessamento:",ae),Y.errors++,Y.details.push({produto:"Sistema",acao:`Erro geral: ${ae.message}`,status:"error",error:ae.message})}try{const ae=ce.map(le=>{const ue=j[le.index]||{},Re=ue.linkedProductId;let ne=null;return Re&&Re!=="force-new"?ne=Re:!le.isNew&&Re!=="force-new"&&(ne=le.existing?.id||null),{produtoId:ne,codigoProdutoXML:le.xml.codigo,nomeProdutoXML:le.xml.nome,eanXML:le.xml.ean,ncmXML:le.xml.ncm,cfopXML:le.xml.cfop,unidadeXML:le.xml.unidade,quantidade:ue.qty!==void 0?ue.qty:Number(le.xml.quantidade),valorUnitario:Number(le.xml.valorUnitario)||0,valorTotal:Number(le.xml.valorTotal)||0,vinculadoManualmente:!!Re&&Re!=="force-new"}});await gst(r.id,ae),console.log("[XMLReprocess] Itens reprocessados:",ae.length)}catch(ae){console.error("[XMLReprocess] Erro ao reprocessar itens da compra:",ae),Y.errors++,Y.details.push({produto:"Itens da NF-e",acao:"Erro ao reprocessar",status:"error",error:ae.message})}w(Y),x(!1),d("done"),Y.errors===0?l({title:"Reprocessamento concludo!",description:`${Y.created} produto(s) criado(s), ${Y.updated} atualizado(s).`,variant:"success"}):l({title:"Reprocessamento com erros",description:`${Y.errors} erro(s) encontrado(s). Verifique os detalhes.`,variant:"destructive"}),o&&o()};p.useEffect(()=>{e||(d("upload"),f(null),m(null),g([]),_({}),C({}),w({created:0,updated:0,errors:0,details:[]}),x(!1),A({}))},[e]);const pe=()=>{t(!1)},te=v.filter(Y=>Y.selected).length;return a.jsxs(mn,{open:e,onOpenChange:pe,children:[a.jsxs(un,{className:"w-[95vw] sm:max-w-4xl max-h-[85vh] overflow-hidden flex flex-col",children:[a.jsxs(on,{children:[a.jsxs(an,{className:"flex items-center gap-2",children:[a.jsx(Jp,{className:"h-5 w-5"}),a.jsx("span",{children:"Reprocessar XML"}),a.jsx("span",{className:"inline-flex items-center rounded-full bg-surface-2 border border-border px-2 py-0.5 text-xs font-semibold text-text-muted uppercase tracking-wide",children:D()}),a.jsx("span",{className:"text-sm text-text-muted",children:r?.numero_nfe})]}),a.jsx(Nn,{children:"Reimporte o XML para atualizar os produtos e itens desta NF-e. Os itens atuais sero substitudos pelos novos."})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto",children:[c==="upload"&&a.jsx("div",{className:"space-y-6",children:a.jsxs("div",{className:"border-2 border-dashed border-border rounded-lg p-8 text-center",children:[a.jsx(P4,{className:"h-12 w-12 mx-auto text-text-muted mb-4"}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Selecione o arquivo XML"}),a.jsxs("p",{className:"text-text-muted mb-4",children:["Faa upload do XML da NF-e ",r?.numero_nfe," para reprocessar os produtos"]}),a.jsx("input",{type:"file",accept:".xml",onChange:V,className:"hidden",id:"xml-reprocess-upload"}),a.jsx("label",{htmlFor:"xml-reprocess-upload",children:a.jsx(fe,{asChild:!0,children:a.jsx("span",{children:"Selecionar XML"})})})]})}),c==="preview"&&h&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4",children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Informaes da NF-e"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Nmero:"})," ",h.nfe.numero]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Srie:"})," ",h.nfe.serie]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Modelo:"})," ",D()]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Fornecedor:"})," ",h.fornecedor?.nome]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Total:"})," R$ ",Number(h.nfe.totalNota||0).toFixed(2)]})]})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"font-semibold text-base",children:"Produtos Encontrados"}),a.jsxs("span",{className:"text-sm text-text-muted",children:[v.filter(Y=>Y.selected).length," de ",v.length," selecionados"]})]}),a.jsx("div",{className:"space-y-2",children:v.map((Y,ce)=>{const me=U(ce,"name",Y.xml.nome),ae=U(ce,"qty",Number(Y.xml.quantidade)),le=U(ce,"linkedProductId",null),ue=Y.xml.valorUnitario||0,Re=U(ce,"margin",null);let ie=U(ce,"salePrice",null);ie==null&&!Y.isNew&&Y.existing&&(ie=Number(Y.existing.preco_venda||Y.existing.salePrice||Y.existing.price||0)),ie==null&&Re!=null&&(ie=z(ue,Re)),ie==null&&Y.xml.precoVenda&&(ie=Number(Y.xml.precoVenda));let gt=null;if(Re!=null)gt=Re;else if(ie!=null&&ue>0&&ie>0){const at=(ie-ue)/ue*100;gt=Math.max(-999,Math.min(9999,at))}const bt=S[ce];return a.jsxs("div",{className:pr("rounded-lg border transition-all",Y.selected?"bg-info/10 border-info/30":"bg-surface opacity-60 border-border"),children:[a.jsxs("div",{className:"p-3 flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx("input",{type:"checkbox",checked:Y.selected,onChange:()=>X(ce),className:"w-4 h-4 rounded border-border accent-warning cursor-pointer"}),a.jsx("button",{onClick:()=>W(ce),className:"p-0.5 hover:bg-surface-2 rounded transition-colors",children:bt?a.jsx(Tg,{className:"w-4 h-4 text-text-muted"}):a.jsx(j0,{className:"w-4 h-4 text-text-muted"})}),a.jsx("div",{children:le?a.jsx(ZH,{className:"w-5 h-5 text-warning"}):a.jsx(Jp,{className:"w-5 h-5 text-info"})})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-baseline justify-between gap-2",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("p",{className:"font-semibold text-sm truncate",children:le&&le!=="force-new"&&le!=="new"?(()=>{const at=n.find(xt=>xt.id===le);return at?at.name:me})():me}),a.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-text-muted mt-0.5",children:[Y.xml.codigo&&a.jsxs("span",{className:"flex-shrink-0",children:["#",Y.xml.codigo]}),a.jsxs("span",{children:["Qtd: ",ae]})]})]}),a.jsx("div",{className:"flex-shrink-0 ml-2",children:le?a.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-warning/20 text-warning font-medium",children:"Vinculado"}):a.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-info/20 text-info font-medium",children:"Cadastrado"})})]}),a.jsxs("div",{className:"mt-1 text-[11px] text-text-muted",children:[a.jsxs("span",{children:["R$ ",ue.toFixed(2),ie?`  R$ ${ie.toFixed(2)}`:""]}),gt!=null&&a.jsxs("span",{className:"ml-2 "+(gt>0?"text-success":gt<0?"text-destructive":"text-text-muted"),children:[gt.toFixed(1),"%"]})]})]})]}),bt&&a.jsxs("div",{className:"px-3 pb-3 pt-0 space-y-3 border-t border-border/50",children:[a.jsxs("div",{className:"mt-3",children:[a.jsx("label",{className:"text-sm font-medium text-text-primary mb-1 block",children:"Nome do Produto"}),a.jsx("input",{type:"text",value:me,onChange:at=>$(ce,"name",at.target.value),disabled:!Y.selected,className:"w-full px-3 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 disabled:cursor-not-allowed"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Quantidade"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{type:"button",onClick:()=>$(ce,"qty",Math.max(0,ae-1)),disabled:!Y.selected||ae<=0,className:"w-9 h-9 rounded-md border border-border bg-surface hover:bg-surface-2 disabled:opacity-30 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:a.jsx(Vv,{className:"w-4 h-4"})}),a.jsx("input",{type:"text",value:ae,onChange:at=>{const xt=at.target.value.replace(/\D/g,"");$(ce,"qty",xt===""?0:Number(xt))},disabled:!Y.selected,className:"w-14 text-center px-2 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50"}),a.jsx("button",{type:"button",onClick:()=>$(ce,"qty",ae+1),disabled:!Y.selected,className:"w-9 h-9 rounded-md bg-warning hover:bg-warning/90 disabled:opacity-30 disabled:cursor-not-allowed transition-colors flex items-center justify-center text-black font-bold shadow-sm",children:a.jsx(Ja,{className:"w-4 h-4"})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Margem %"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:(()=>{const at=U(ce,"margin",null);return at!=null?String(at):""})(),onChange:at=>{const xt=at.target.value;if(xt===""){$(ce,"margin",null),$(ce,"salePrice",null);return}const Ze=xt.replace(/[^0-9.,\-]/g,"").replace(",",".");if(Ze==="."||Ze==="-"||Ze==="-.")return;const ht=parseFloat(Ze);if(!isNaN(ht)&&($(ce,"margin",ht),ue>0)){const Wt=z(ue,ht);$(ce,"salePrice",Wt)}},disabled:!Y.selected,placeholder:"0",className:"w-24 pl-3 pr-6 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 text-right"}),a.jsx("span",{className:"absolute right-1.5 top-1/2 -translate-y-1/2 text-sm text-text-muted pointer-events-none",children:"%"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Custo"}),a.jsx("div",{className:"px-3 py-2 bg-surface/50 rounded-md border border-border",children:a.jsxs("span",{className:"text-sm font-semibold",children:["R$ ",ue.toFixed(2)]})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Preo Venda"}),a.jsxs("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-sm text-text-muted pointer-events-none",children:"R$"}),a.jsx("input",{type:"text",value:(()=>{const at=U(ce,"salePrice",ie);return at==null?"":Number(at).toFixed(2).replace(".",",")})(),onChange:at=>{const xt=at.target.value.replace(/\D/g,"");if(xt===""){$(ce,"salePrice",null);return}const Ze=Number(xt)/100;if($(ce,"salePrice",Ze),Ze>0&&ue>0){const ht=(Ze-ue)/ue*100;$(ce,"margin",Math.round(ht*100)/100)}},disabled:!Y.selected,placeholder:"0,00",className:"w-28 pl-7 pr-3 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 text-right font-semibold text-success"})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2 mt-3",children:[a.jsx("input",{type:"checkbox",id:`update-price-${ce}`,checked:U(ce,"updatePrice",!1),onChange:at=>$(ce,"updatePrice",at.target.checked),disabled:!Y.selected,className:"w-4 h-4 text-brand bg-surface border-border rounded focus:ring-brand focus:ring-2 disabled:opacity-50"}),a.jsx("label",{htmlFor:`update-price-${ce}`,className:"text-sm text-text-primary select-none cursor-pointer",children:"Atualizar preo do produto no sistema"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-text-primary mb-1 block",children:"Vincular a Produto Existente (Opcional)"}),a.jsxs(vn,{value:le==="force-new"?"force-new":le||(Y.isNew?"new":Y.existing?.id||"new"),onValueChange:at=>{at==="new"||at===Y.existing?.id?ye(ce,null):at==="search"?O({isOpen:!0,productIndex:ce,currentProduct:Y}):ye(ce,at)},disabled:!Y.selected,children:[a.jsx(hn,{className:"w-full hover:bg-white/5 transition-colors",children:a.jsx(wn,{placeholder:Y.isNew?" Criar como novo produto":" Atualizar produto existente"})}),a.jsxs(pn,{className:"max-h-[300px] overflow-y-auto",children:[Y.isNew?a.jsx(ct,{value:"new",children:" Criar como novo produto"}):a.jsxs(ct,{value:Y.existing?.id||"new",children:[" Atualizar: ",Y.existing?.name," (Estoque atual: ",Y.existing?.stock||0,")"]}),!Y.isNew&&a.jsx(ct,{value:"force-new",children:" Criar como novo produto (ignorar existente)"}),a.jsx(ct,{value:"search",children:" Buscar produto para vincular..."})]})]})]})]})]},ce)})})]})]}),c==="processing"&&a.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[a.jsx(Tc,{className:"h-12 w-12 animate-spin text-brand mb-4"}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Reprocessando XML..."}),a.jsx("p",{className:"text-text-muted",children:"Atualizando produtos e itens da NF-e"})]}),c==="done"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"text-center py-6",children:[b.errors===0?a.jsx(Ro,{className:"h-12 w-12 text-success mx-auto mb-4"}):a.jsx(Bc,{className:"h-12 w-12 text-warning mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:b.errors===0?"Reprocessamento Concludo!":"Reprocessamento com Erros"}),a.jsxs("div",{className:"text-text-muted",children:[b.created," produto(s) criado(s), ",b.updated," atualizado(s)",b.errors>0&&`, ${b.errors} erro(s)`]})]}),b.details.length>0&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-3",children:"Detalhes do Reprocessamento"}),a.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:b.details.map((Y,ce)=>a.jsxs("div",{className:pr("flex items-center gap-3 p-2 rounded",Y.status==="success"?"bg-green-50 text-green-800":Y.status==="error"?"bg-red-50 text-red-800":"bg-gray-50 text-gray-800"),children:[Y.status==="success"?a.jsx(Ro,{className:"h-4 w-4 flex-shrink-0"}):a.jsx(Bc,{className:"h-4 w-4 flex-shrink-0"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"font-medium truncate",children:Y.produto}),a.jsx("div",{className:"text-xs",children:Y.acao}),Y.error&&a.jsx("div",{className:"text-xs mt-1 opacity-75",children:Y.error})]})]},ce))})]})]})]}),a.jsxs(Qn,{children:[c==="upload"&&a.jsx(fe,{variant:"outline",onClick:pe,children:"Cancelar"}),c==="preview"&&a.jsxs(a.Fragment,{children:[a.jsx(fe,{variant:"outline",onClick:()=>d("upload"),children:"Voltar"}),a.jsxs(fe,{onClick:B,disabled:te===0,children:["Reprocessar (",te," produtos)"]})]}),c==="done"&&a.jsx(fe,{onClick:pe,children:"Fechar"})]})]}),a.jsx(Vse,{isOpen:R.isOpen,onClose:()=>O({isOpen:!1,productIndex:null,currentProduct:null}),onSelect:Y=>{console.log("[XMLReprocessModal] onSelect chamado com produto:",Y),console.log("[XMLReprocessModal] Index do produto:",R.productIndex),ye(R.productIndex,Y.id),O({isOpen:!1,productIndex:null,currentProduct:null})},currentProduct:R.currentProduct}),a.jsx(Wse,{isOpen:I.isOpen,onClose:()=>M({isOpen:!1}),onConfirm:Q,products:v.map((Y,ce)=>({...Y,originalIndex:ce})),editedProducts:j,allProducts:n,isReprocess:!0})]})}const HU="comprasPage:settings";function Est(){const{user:e,userProfile:t}=ms(),[r,n]=p.useState([]),[s,o]=p.useState(!0),[i,l]=p.useState(""),[c,d]=p.useState(null),[u,f]=p.useState([]),[h,m]=p.useState(!1),[v,g]=p.useState(()=>Tl(new Date)),[y,x]=p.useState(()=>qC(new Date)),[b,w]=p.useState("all"),[j,_]=p.useState(!0),[S,C]=p.useState(!1),[P,A]=p.useState("active"),[R,O]=p.useState({show:!1,purchase:null}),[I,M]=p.useState(""),[D,U]=p.useState({show:!1,purchase:null}),[z,W]=p.useState({}),[$,X]=p.useState({show:!1,purchase:null}),[ye,Se]=p.useState([]),[V,B]=p.useState(!1),[Q,pe]=p.useState(!1),[te,Y]=p.useState("paged"),ce=te==="paged",[me,ae]=p.useState(1),[le]=p.useState(100),[ue,Re]=p.useState(0),ne=je=>{const Ue=String(je||"").replace(/\D/g,"");return(Ue?Number(Ue)/100:0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})},ie=je=>{if(!je.xml_completo){alert("XML no disponvel para esta NF-e");return}const Ue=new Blob([je.xml_completo],{type:"text/xml;charset=utf-8"}),ze=URL.createObjectURL(Ue),or=document.createElement("a");or.href=ze,or.download=`${je.chave_nfe}.xml`,document.body.appendChild(or),or.click(),document.body.removeChild(or),URL.revokeObjectURL(ze)},gt=async je=>{if(!je.xml_completo){alert("XML no disponvel para reprocessamento automtico");return}if(confirm("Deseja reprocessar esta NF-e? Isso substituir todos os itens atuais pelos dados do XML original."))try{console.log("[ComprasPage] Iniciando reprocessamento para purchase:",je),console.log("[ComprasPage] Chave NF-e:",je.chave_nfe),console.log("[ComprasPage] XML disponvel:",!!je.xml_completo);const Ue=new Blob([je.xml_completo],{type:"text/xml"}),ze=new File([Ue],`${je.chave_nfe}.xml`,{type:"text/xml"});X({show:!0,purchase:je,autoFile:ze})}catch(Ue){console.error("Erro no reprocessamento automtico:",Ue),alert("Erro ao iniciar reprocessamento automtico")}},bt=je=>{if(!je)return 0;const Ue=String(je).replace(/\./g,"").replace(",",".");return parseFloat(Ue)||0};p.useEffect(()=>{try{const je=localStorage.getItem(HU);if(!je)return;const Ue=JSON.parse(je);Ue&&typeof Ue=="object"&&((Ue.listMode==="paged"||Ue.listMode==="all")&&Y(Ue.listMode),typeof Ue.showStats=="boolean"&&_(Ue.showStats))}catch{}},[]),p.useEffect(()=>{(async()=>{if(!e?.id||!t?.codigo_empresa)return;const Ue=`compras:${t.codigo_empresa}`,ze=await Bse({userId:e.id,scope:Ue});ze&&((ze.listMode==="paged"||ze.listMode==="all")&&Y(ze.listMode),typeof ze.showStats=="boolean"&&_(ze.showStats))})()},[e?.id,t?.codigo_empresa]),p.useEffect(()=>{try{const je={listMode:te,showStats:j};localStorage.setItem(HU,JSON.stringify(je))}catch{}if(e?.id&&t?.codigo_empresa){const je=`compras:${t.codigo_empresa}`;qse({userId:e.id,scope:je,settings:{listMode:te,showStats:j}})}},[te,j,e?.id,t?.codigo_empresa]),p.useEffect(()=>{t?.codigo_empresa&&(xt(),at())},[t,P,b,v,y,me,te]),p.useEffect(()=>{ae(1)},[P,b,v,y,te]);const at=async()=>{try{const je=await bu({codigoEmpresa:t.codigo_empresa});Se(je||[])}catch(je){console.error("[Compras] Erro ao carregar produtos:",je)}},xt=async()=>{try{o(!0);let je=null,Ue=null;if(v){const yr=new Date(v);yr.setHours(0,0,0,0),je=yr.toISOString()}if(y){const yr=new Date(y);yr.setHours(23,59,59,999),Ue=yr.toISOString()}const tr={incluirInativas:P==="all"||P==="inactive",apenasInativas:P==="inactive",fornecedorId:b!=="all"?b:void 0,dataInicio:je,dataFim:Ue,page:ce?me:1,pageSize:ce?le:1e4},Nt=await mst(t.codigo_empresa,tr);n(Nt?.data||[]),Re(Nt?.count||0)}catch(je){console.error("[Compras] Erro ao carregar compras:",je)}finally{o(!1)}},Ze=async je=>{d(je),m(!0);try{const Ue=await Use(je.id);f(Ue||[])}catch(Ue){console.error("[Compras] Erro ao carregar itens:",Ue),f([])}finally{m(!1)}},ht=()=>{d(null),f([])},Wt=je=>{U({show:!0,purchase:je}),W({numeroNfe:je.numero_nfe||"",serieNfe:je.serie_nfe||"",dataEmissao:je.data_emissao?je.data_emissao.split("T")[0]:"",tipoOperacao:je.tipo_operacao||"",naturezaOperacao:je.natureza_operacao||"",valorProdutos:ne((je.valor_produtos||0)*100),valorTotal:ne((je.valor_total||0)*100),formaPagamento:je.forma_pagamento||"",observacoes:je.observacoes||""})},be=async()=>{try{await vst(D.purchase.id,{...z,valorProdutos:bt(z.valorProdutos),valorTotal:bt(z.valorTotal),fornecedorId:D.purchase.fornecedor_id}),await xt(),U({show:!1,purchase:null}),W({}),console.log("Compra editada com sucesso!")}catch(je){console.error("Erro ao editar compra:",je)}},Ct=p.useMemo(()=>{const je=new Map;return r.forEach(Ue=>{Ue.fornecedor?.id&&je.set(Ue.fornecedor.id,Ue.fornecedor)}),Array.from(je.values())},[r]),wt=p.useMemo(()=>r.filter(je=>{if(i){const Ue=i.toLowerCase();if(!(je.numero_nfe?.toLowerCase().includes(Ue)||je.fornecedor?.nome?.toLowerCase().includes(Ue)||je.chave_nfe?.toLowerCase().includes(Ue)))return!1}return!0}),[r,i]),Ge=p.useMemo(()=>{const je=wt.reduce((Nt,yr)=>Nt+Number(yr.valor_total||0),0),Ue=wt.length,ze=Ue>0?je/Ue:0,or={};wt.forEach(Nt=>{const yr=Nt.fornecedor?.id||"unknown",Me=Nt.fornecedor?.nome||"No identificado";or[yr]||(or[yr]={name:Me,total:0,count:0}),or[yr].total+=Number(Nt.valor_total||0),or[yr].count+=1});const tr=Object.values(or).sort((Nt,yr)=>yr.total-Nt.total).slice(0,5);return{total:je,count:Ue,avgTicket:ze,topSuppliers:tr}},[wt]),Je=p.useMemo(()=>{if(!le)return 1;const je=Math.ceil((ue||0)/le);return je>0?je:1},[ue,le]),_e=()=>{const je=["NF-e","Serie","Data Emissao","Fornecedor","CNPJ","Tipo","Valor Total","Valor Produtos","Forma Pagamento"],Ue=wt.map(Nt=>[Nt.numero_nfe||"",Nt.serie_nfe||"",Nt.data_emissao?cr(new Date(Nt.data_emissao),"dd/MM/yyyy"):"",(Nt.fornecedor?.nome||"").replace(/,/g," "),Nt.fornecedor?.cnpj||"",Nt.tipo_operacao||"",Number(Nt.valor_total||0).toFixed(2),Number(Nt.valor_produtos||0).toFixed(2),(Nt.forma_pagamento||"").replace(/,/g," ")]),ze=[je,...Ue].map(Nt=>Nt.join(";")).join(`
`),or=new Blob(["\uFEFF"+ze],{type:"text/csv;charset=utf-8;"}),tr=document.createElement("a");tr.href=URL.createObjectURL(or),tr.download=`compras_${cr(new Date,"yyyy-MM-dd")}.csv`,tr.click()};return a.jsxs("div",{className:"px-3 py-4 md:p-6 max-w-7xl mx-auto",children:[a.jsx("div",{className:"mb-4",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-3 md:gap-4 mb-2",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsx("h1",{className:"text-3xl font-bold text-text-primary",children:"Compras (NF-e)"}),a.jsx(fe,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full flex items-center justify-center",onClick:()=>pe(!0),"aria-label":"Configuraes da aba",title:"Configuraes da aba",children:a.jsx(Ad,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"flex flex-row flex-wrap items-end gap-2",children:[a.jsxs("div",{className:"flex-1 min-w-[140px]",children:[a.jsx("label",{className:"text-xs font-medium text-text-muted block mb-1",children:"Perodo Inicial"}),a.jsxs(vi,{modal:!0,children:[a.jsx(xi,{asChild:!0,children:a.jsxs(fe,{variant:"outline",className:"w-full justify-start text-left font-normal h-9 text-sm",children:[a.jsx(Bs,{className:"mr-2 h-4 w-4"}),v?cr(v,"dd/MM/yyyy"):a.jsx("span",{children:"Selecionar"})]})}),a.jsx(ni,{className:"w-auto p-0 z-50",align:"end",children:a.jsx(yi,{mode:"single",selected:v,onSelect:g,locale:na})})]})]}),a.jsxs("div",{className:"flex-1 min-w-[140px]",children:[a.jsx("label",{className:"text-xs font-medium text-text-muted block mb-1",children:"Perodo Final"}),a.jsxs(vi,{modal:!0,children:[a.jsx(xi,{asChild:!0,children:a.jsxs(fe,{variant:"outline",className:"w-full justify-start text-left font-normal h-9 text-sm",children:[a.jsx(Bs,{className:"mr-2 h-4 w-4"}),y?cr(y,"dd/MM/yyyy"):a.jsx("span",{children:"Selecionar"})]})}),a.jsx(ni,{className:"w-auto p-0 z-50",align:"end",children:a.jsx(yi,{mode:"single",selected:y,onSelect:x,locale:na})})]})]}),(v||y)&&a.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>{g(null),x(null)},className:"h-8 px-3 text-xs",children:"Limpar"})]})]})}),j&&wt.length>0&&a.jsxs("div",{className:"mb-4 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsxs("div",{className:"bg-surface rounded-lg border border-border px-2 py-3 flex flex-col items-center justify-center text-center",children:[a.jsxs("div",{className:"flex items-center gap-1 text-text-muted text-[11px] mb-1",children:[a.jsx(Zo,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:"NF-es"})]}),a.jsx("p",{className:"text-lg md:text-2xl font-bold text-text-primary leading-none",children:Ge.count})]}),a.jsxs("div",{className:"bg-surface rounded-lg border border-border px-2 py-3 flex flex-col items-center justify-center text-center",children:[a.jsxs("div",{className:"flex items-center gap-1 text-text-muted text-[11px] mb-1",children:[a.jsx(ei,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:"Total"})]}),a.jsxs("p",{className:"text-base md:text-2xl font-bold text-success leading-none whitespace-nowrap",children:["R$ ",Ge.total.toFixed(2)]})]}),a.jsxs("div",{className:"bg-surface rounded-lg border border-border px-2 py-3 flex flex-col items-center justify-center text-center",children:[a.jsxs("div",{className:"flex items-center gap-1 text-text-muted text-[11px] mb-1",children:[a.jsx(Uu,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:"Fornec."})]}),a.jsx("p",{className:"text-lg md:text-2xl font-bold text-info leading-none",children:Ct.length})]})]}),Ge.topSuppliers.length>0&&a.jsxs("div",{className:"bg-surface rounded-lg border border-border p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("h3",{className:"font-semibold text-text-primary flex items-center gap-2",children:[a.jsx(e_,{className:"h-4 w-4"}),"Top 5 Fornecedores"]}),a.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>C(!0),className:"text-xs",children:"Ver Todos"})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:Ge.topSuppliers.map((je,Ue)=>{const ze=je.total/Ge.total*100;return a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between text-xs",children:[a.jsx("span",{className:"text-text-primary font-medium truncate flex-1",title:je.name,children:je.name}),a.jsxs("span",{className:"text-text-muted text-xs ml-2 flex-shrink-0",children:["R$ ",je.total.toFixed(2)]})]}),a.jsx("div",{className:"w-full bg-surface-2 rounded-full h-1.5",children:a.jsx("div",{className:"bg-brand rounded-full h-1.5 transition-all",style:{width:`${ze}%`}})})]},Ue)})})]})]}),a.jsx("div",{className:"mb-6 space-y-4",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3 md:gap-4 md:flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2 w-full md:flex-1 md:min-w-[250px]",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(Zs,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(rt,{placeholder:"Buscar por NF-e, fornecedor ou chave...",value:i,onChange:je=>l(je.target.value),className:"pl-10"})]}),a.jsx(fe,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full flex md:hidden items-center justify-center",onClick:()=>B(je=>!je),"aria-label":"Filtros",children:a.jsx(gI,{className:"h-4 w-4"})})]}),V&&a.jsxs("div",{className:"md:hidden mt-1 space-y-3 px-0.5",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-text-muted",children:"Fornecedor"}),a.jsxs(vn,{value:b,onValueChange:w,children:[a.jsxs(hn,{className:"w-full text-sm",children:[a.jsx(Uu,{className:"h-4 w-4 mr-2 flex-shrink-0"}),a.jsx("div",{className:"truncate",children:a.jsx(wn,{placeholder:"Todos"})})]}),a.jsxs(pn,{children:[a.jsx(ct,{value:"all",children:"Todos"}),Ct.map(je=>a.jsx(ct,{value:je.id,children:a.jsx("div",{className:"truncate max-w-[220px]",title:je.nome,children:je.nome})},je.id))]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-text-muted",children:"Status"}),a.jsxs(vn,{value:P,onValueChange:A,children:[a.jsx(hn,{className:"w-full text-sm",children:a.jsx(wn,{})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"active",children:"Apenas ativas"}),a.jsx(ct,{value:"all",children:"Todas"}),a.jsx(ct,{value:"inactive",children:"Apenas inativas"})]})]})]}),a.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1 border-t border-border/60",children:[a.jsxs(fe,{type:"button",variant:"ghost",size:"sm",className:"gap-2 text-xs px-2",onClick:()=>_(!j),children:[a.jsx(e_,{className:"h-4 w-4"}),j?"Ocultar estatsticas":"Mostrar estatsticas"]}),a.jsxs(fe,{type:"button",variant:"outline",size:"sm",onClick:_e,disabled:wt.length===0,className:"gap-1 text-xs px-3",children:[a.jsx(uo,{className:"h-4 w-4"}),"CSV"]})]})]}),a.jsxs("div",{className:"hidden md:flex md:items-center md:gap-4 md:flex-wrap w-full",children:[a.jsxs(vn,{value:b,onValueChange:w,children:[a.jsxs(hn,{className:"w-full md:w-[220px]",children:[a.jsx(Uu,{className:"h-4 w-4 mr-2 flex-shrink-0"}),a.jsx("div",{className:"truncate",children:a.jsx(wn,{placeholder:"Fornecedor"})})]}),a.jsxs(pn,{children:[a.jsx(ct,{value:"all",children:"Todos"}),Ct.map(je=>a.jsx(ct,{value:je.id,children:a.jsx("div",{className:"truncate max-w-[180px]",title:je.nome,children:je.nome})},je.id))]})]}),a.jsxs(fe,{variant:"outline",onClick:_e,disabled:wt.length===0,className:"gap-2 w-full sm:w-auto justify-center",children:[a.jsx(uo,{className:"h-4 w-4"}),"Exportar CSV"]}),a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsxs(fe,{variant:"ghost",size:"sm",onClick:()=>_(!j),className:"gap-2",children:[a.jsx(e_,{className:"h-4 w-4"}),j?"Ocultar":"Mostrar"]}),a.jsxs(vn,{value:P,onValueChange:A,children:[a.jsx(hn,{className:"w-[140px]",children:a.jsx(wn,{})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"active",children:"Apenas ativas"}),a.jsx(ct,{value:"all",children:"Todas"}),a.jsx(ct,{value:"inactive",children:"Apenas inativas"})]})]})]})]})]})}),s?a.jsxs("div",{className:"text-center py-12 bg-surface rounded-lg border border-border",children:[a.jsx(Td,{className:"h-12 w-12 mx-auto text-text-muted mb-4"}),a.jsx("p",{className:"text-text-muted",children:i?"Nenhuma compra encontrada":"Nenhuma NF-e importada ainda"}),a.jsx("p",{className:"text-sm text-text-muted mt-2",children:"Importe XMLs de NF-e na pgina de Produtos"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"grid gap-3",children:wt.map(je=>a.jsx("div",{className:`rounded-lg border overflow-hidden transition-all hover:shadow-lg ${je.ativo===!1?"bg-gray-900/60 border-red-500 shadow-red-500/20":"bg-surface border-border hover:border-brand/50"}`,onClick:()=>Ze(je),children:a.jsx("div",{className:"p-4",children:a.jsx("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 sm:gap-4",children:a.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[a.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[a.jsx(Zo,{className:"h-6 w-6 text-brand mt-0.5 flex-shrink-0"}),a.jsx("div",{className:"min-w-0",children:a.jsxs("h3",{className:`font-semibold text-sm md:text-base leading-snug ${je.ativo===!1?"text-red-600":"text-text-primary"}`,children:["NF-e ",je.numero_nfe," / Srie ",je.serie_nfe,je.ativo===!1&&a.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 bg-red-100 text-red-700 text-[10px] rounded-full font-medium align-middle",children:"INATIVA"})]})})]}),a.jsx("div",{className:"sm:hidden flex items-center",children:a.jsxs("span",{className:"text-success font-semibold text-xs whitespace-nowrap pr-2",children:["R$ ",Number(je.valor_total||0).toFixed(2)]})})]}),a.jsxs("div",{className:"space-y-2.5",children:[a.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[a.jsx(Uu,{className:"h-5 w-5 flex-shrink-0 text-brand"}),a.jsx("span",{className:"font-medium text-text-primary text-sm md:text-base overflow-hidden truncate",title:je.fornecedor?.nome||"Fornecedor no identificado",children:je.fornecedor?.nome||"Fornecedor no identificado"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1.5 text-xs md:text-sm text-text-muted",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Bs,{className:"h-4 w-4"}),a.jsx("span",{children:je.data_emissao?cr(new Date(je.data_emissao),"dd/MM/yyyy",{locale:na}):"Data no informada"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Td,{className:"h-4 w-4"}),a.jsx("span",{children:je.tipo_operacao||"Entrada"})]}),je.chave_nfe&&a.jsxs("div",{className:"text-[10px] md:text-xs max-w-[180px] md:max-w-xs overflow-hidden whitespace-nowrap truncate",children:[a.jsx("span",{className:"font-medium",children:"Chave:"})," ",je.chave_nfe.length>20?je.chave_nfe.slice(0,20)+"...":je.chave_nfe]})]}),je.natureza_operacao&&a.jsx("p",{className:"text-[10px] md:text-xs text-text-muted overflow-hidden whitespace-nowrap truncate",title:je.natureza_operacao,children:je.natureza_operacao})]})]}),a.jsxs("div",{className:"hidden sm:flex sm:flex-col sm:gap-3 sm:mt-0 sm:w-auto",children:[a.jsx("div",{className:"w-full flex justify-end",children:a.jsxs("div",{className:"text-right text-text-muted",children:[a.jsxs("span",{className:"text-success font-semibold text-base md:text-lg whitespace-nowrap",children:["R$ ",Number(je.valor_total||0).toFixed(2)]}),a.jsxs("p",{className:"text-[11px] md:text-xs mt-0.5",children:["Produtos: R$ ",Number(je.valor_produtos||0).toFixed(2)]})]})}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 w-full justify-end",children:[a.jsxs(fe,{onClick:Ue=>{Ue.stopPropagation(),Ze(je)},size:"sm",className:"gap-2 w-full justify-center",children:[a.jsx(hg,{className:"h-4 w-4"}),a.jsx("span",{className:"text-xs sm:text-sm",children:"Detalhes"})]}),je.ativo&&a.jsxs(fe,{onClick:Ue=>{Ue.stopPropagation(),Wt(je)},size:"sm",variant:"outline",className:"gap-2 w-full justify-center",children:[a.jsx(Cl,{className:"h-4 w-4"}),a.jsx("span",{className:"text-xs sm:text-sm",children:"Editar"})]})]})]})]})})})},je.id))}),ce&&a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between mt-4 gap-2 text-xs sm:text-sm text-text-muted",children:[a.jsxs("span",{children:["Pgina ",me," de ",Je," (",ue," NF-es)"]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(fe,{type:"button",variant:"outline",size:"sm",onClick:()=>ae(je=>Math.max(1,je-1)),disabled:me<=1,children:"Anterior"}),a.jsx(fe,{type:"button",variant:"outline",size:"sm",onClick:()=>ae(je=>Math.min(Je,je+1)),disabled:me>=Je,children:"Prxima"})]})]})]}),a.jsx(mn,{open:Q,onOpenChange:pe,children:a.jsxs(un,{className:"w-[90vw] sm:max-w-md max-h-[80vh] flex flex-col",children:[a.jsx(on,{children:a.jsx(an,{children:"Configuraes de Compras"})}),a.jsxs("div",{className:"space-y-4 text-sm",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-medium text-text-muted",children:"Modo de listagem"}),a.jsxs(vn,{value:te,onValueChange:Y,children:[a.jsx(hn,{className:"w-full h-9 text-sm",children:a.jsx(wn,{placeholder:"Paginado"})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"paged",children:"Paginado (100 por pgina)"}),a.jsx(ct,{value:"all",children:"Todos (sem paginao)"})]})]})]}),a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(za,{id:"compras-show-stats",checked:j,onCheckedChange:_}),a.jsx("label",{htmlFor:"compras-show-stats",className:"text-xs font-medium text-text-primary",children:"Mostrar cards de estatsticas"})]})})]})]})}),a.jsx(mn,{open:R.show,onOpenChange:je=>O({show:je,purchase:null}),children:a.jsxs(un,{className:"w-[90vw] sm:max-w-md",children:[a.jsx(on,{children:a.jsx(an,{children:"Inativar NF-e"})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("p",{className:"text-sm text-text-muted",children:["Tem certeza que deseja inativar a NF-e ",a.jsx("strong",{children:R.purchase?.numero_nfe}),"?"]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-2",children:"Motivo da inativao:"}),a.jsx(rt,{value:I,onChange:je=>M(je.target.value),placeholder:"Ex: NF-e duplicada, erro na importao...",className:"w-full"})]}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx(fe,{variant:"outline",onClick:()=>{O({show:!1,purchase:null}),M("")},children:"Cancelar"}),a.jsx(fe,{variant:"destructive",onClick:async()=>{if(!I.trim()){alert("Por favor, informe o motivo da inativao");return}try{await hst(R.purchase.id,I.trim(),t.id),O({show:!1,purchase:null}),M(""),xt()}catch(je){console.error("Erro ao inativar compra:",je),alert("Erro ao inativar NF-e. Tente novamente.")}},disabled:!I.trim(),children:"Inativar"})]})]})]})}),c&&a.jsx(Pst,{purchase:c,items:h?[]:u,onClose:ht,onEdit:Wt,onReprocess:gt,onDownloadXML:ie,onInactivate:je=>O({show:!0,purchase:je})}),a.jsx(mn,{open:S,onOpenChange:C,children:a.jsxs(un,{className:"w-[90vw] sm:max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[a.jsx(on,{children:a.jsx(an,{children:"Todos os Fornecedores"})}),a.jsx("div",{className:"px-6 py-3 bg-surface-2 border-y border-border",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-muted",children:"Valor Total Geral"}),a.jsxs("span",{className:"text-2xl font-bold text-success",children:["R$ ",Ge.total.toFixed(2)]})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto",children:a.jsx("div",{className:"space-y-3 pr-2",children:Object.entries(wt.reduce((je,Ue)=>{const ze=Ue.fornecedor?.id||"unknown",or=Ue.fornecedor?.nome||"No identificado";return je[ze]||(je[ze]={name:or,total:0,count:0}),je[ze].total+=Number(Ue.valor_total||0),je[ze].count+=1,je},{})).sort(([,je],[,Ue])=>Ue.total-je.total).map(([je,Ue],ze)=>{const or=Ue.total/Ge.total*100;return a.jsxs("div",{className:"p-3 bg-surface-2 rounded-lg border border-border",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-brand/10 text-brand text-xs font-bold flex items-center justify-center",children:ze+1}),a.jsx("span",{className:"font-medium text-text-primary",children:Ue.name})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"font-bold text-success",children:["R$ ",Ue.total.toFixed(2)]}),a.jsxs("p",{className:"text-xs text-text-muted",children:[Ue.count," NF-es"]})]})]}),a.jsx("div",{className:"w-full bg-surface rounded-full h-2",children:a.jsx("div",{className:"bg-brand rounded-full h-2 transition-all",style:{width:`${or}%`}})})]},je)})})})]})}),a.jsx(mn,{open:D.show,onOpenChange:je=>U({show:je,purchase:null}),children:a.jsxs(un,{className:"w-[90vw] sm:max-w-2xl max-h-[80vh] flex flex-col",onOpenAutoFocus:je=>je.preventDefault(),children:[a.jsx(on,{children:a.jsx(an,{children:"Editar NF-e"})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Nmero NF-e"}),a.jsx(rt,{value:z.numeroNfe||"",onChange:je=>W(Ue=>({...Ue,numeroNfe:je.target.value})),placeholder:"Nmero da NF-e"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Srie"}),a.jsx(rt,{value:z.serieNfe||"",onChange:je=>W(Ue=>({...Ue,serieNfe:je.target.value})),placeholder:"Srie"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Data de Emisso"}),a.jsx(rt,{type:"date",value:z.dataEmissao||"",onChange:je=>W(Ue=>({...Ue,dataEmissao:je.target.value}))})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Tipo de Operao"}),a.jsxs(vn,{value:z.tipoOperacao||"",onValueChange:je=>W(Ue=>({...Ue,tipoOperacao:je})),children:[a.jsx(hn,{children:a.jsx(wn,{placeholder:"Selecione o tipo"})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"Entrada",children:"0 - Entrada"}),a.jsx(ct,{value:"Sada",children:"1 - Sada"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Natureza da Operao"}),a.jsxs(vn,{value:z.naturezaOperacao||"",onValueChange:je=>W(Ue=>({...Ue,naturezaOperacao:je})),children:[a.jsx(hn,{children:a.jsx(wn,{placeholder:"Selecione a natureza"})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"Compra para comercializao",children:"Compra para comercializao"}),a.jsx(ct,{value:"Compra para industrializao",children:"Compra para industrializao"}),a.jsx(ct,{value:"Compra para uso ou consumo",children:"Compra para uso ou consumo"}),a.jsx(ct,{value:"Compra de ativo imobilizado",children:"Compra de ativo imobilizado"}),a.jsx(ct,{value:"Compra de material para uso ou consumo",children:"Compra de material para uso ou consumo"}),a.jsx(ct,{value:"Devoluo de venda de produo do estabelecimento",children:"Devoluo de venda de produo do estabelecimento"}),a.jsx(ct,{value:"Devoluo de venda de mercadoria adquirida ou recebida de terceiros",children:"Devoluo de venda de mercadoria adquirida ou recebida de terceiros"}),a.jsx(ct,{value:"Remessa de mercadoria por conta e ordem de terceiros",children:"Remessa de mercadoria por conta e ordem de terceiros"}),a.jsx(ct,{value:"Retorno de mercadoria remetida por conta e ordem de terceiros",children:"Retorno de mercadoria remetida por conta e ordem de terceiros"}),a.jsx(ct,{value:"Remessa para industrializao por encomenda",children:"Remessa para industrializao por encomenda"}),a.jsx(ct,{value:"Retorno de mercadoria remetida para industrializao por encomenda",children:"Retorno de mercadoria remetida para industrializao por encomenda"}),a.jsx(ct,{value:"Transferncia de produo do estabelecimento",children:"Transferncia de produo do estabelecimento"}),a.jsx(ct,{value:"Transferncia de mercadoria adquirida ou recebida de terceiros",children:"Transferncia de mercadoria adquirida ou recebida de terceiros"})]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Valor dos Produtos"}),a.jsx(rt,{inputMode:"numeric",placeholder:"R$ 0,00",value:`R$ ${z.valorProdutos||"0,00"}`,onChange:je=>W(Ue=>({...Ue,valorProdutos:ne(je.target.value)}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Valor Total"}),a.jsx(rt,{inputMode:"numeric",placeholder:"R$ 0,00",value:`R$ ${z.valorTotal||"0,00"}`,onChange:je=>W(Ue=>({...Ue,valorTotal:ne(je.target.value)}))})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Forma de Pagamento"}),a.jsxs(vn,{value:z.formaPagamento||"",onValueChange:je=>W(Ue=>({...Ue,formaPagamento:je})),children:[a.jsx(hn,{children:a.jsx(wn,{placeholder:"Selecione a forma de pagamento"})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"01 - Dinheiro",children:"01 - Dinheiro"}),a.jsx(ct,{value:"02 - Cheque",children:"02 - Cheque"}),a.jsx(ct,{value:"03 - Carto de Crdito",children:"03 - Carto de Crdito"}),a.jsx(ct,{value:"04 - Carto de Dbito",children:"04 - Carto de Dbito"}),a.jsx(ct,{value:"05 - Carto da Loja (Private Label)",children:"05 - Carto da Loja (Private Label)"}),a.jsx(ct,{value:"10 - Vale Alimentao",children:"10 - Vale Alimentao"}),a.jsx(ct,{value:"11 - Vale Refeio",children:"11 - Vale Refeio"}),a.jsx(ct,{value:"12 - Vale Presente",children:"12 - Vale Presente"}),a.jsx(ct,{value:"13 - Vale Combustvel",children:"13 - Vale Combustvel"}),a.jsx(ct,{value:"14 - Duplicata Mercantil",children:"14 - Duplicata Mercantil"}),a.jsx(ct,{value:"15 - Boleto Bancrio",children:"15 - Boleto Bancrio"}),a.jsx(ct,{value:"16 - Depsito Bancrio",children:"16 - Depsito Bancrio"}),a.jsx(ct,{value:"17 - PIX Dinmico (QR-Code)",children:"17 - PIX Dinmico (QR-Code)"}),a.jsx(ct,{value:"18 - Transferncia Bancria / Carteira Digital",children:"18 - Transferncia Bancria / Carteira Digital"}),a.jsx(ct,{value:"19 - Programa de Fidelidade / Cashback",children:"19 - Programa de Fidelidade / Cashback"}),a.jsx(ct,{value:"20 - PIX Esttico",children:"20 - PIX Esttico"}),a.jsx(ct,{value:"21 - Crdito em Loja",children:"21 - Crdito em Loja"}),a.jsx(ct,{value:"22 - Pagamento Eletrnico no Informado",children:"22 - Pagamento Eletrnico no Informado"}),a.jsx(ct,{value:"90 - Sem Pagamento",children:"90 - Sem Pagamento"}),a.jsx(ct,{value:"99 - Outros",children:"99 - Outros"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Observaes"}),a.jsx(rt,{value:z.observacoes||"",onChange:je=>W(Ue=>({...Ue,observacoes:je.target.value})),placeholder:"Observaes adicionais"})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[a.jsx(fe,{variant:"outline",onClick:()=>U({show:!1,purchase:null}),children:"Cancelar"}),a.jsx(fe,{onClick:be,children:"Salvar Alteraes"})]})]})]})}),a.jsx(Ast,{open:$.show,onOpenChange:je=>X({show:je,purchase:null}),purchase:$.purchase,products:ye,codigoEmpresa:t?.codigo_empresa,autoFile:$.autoFile,onSuccess:()=>{xt(),X({show:!1,purchase:null})}})]})}const yl=Pe.forwardRef(({className:e,...t},r)=>a.jsx("div",{className:"relative w-full overflow-auto",children:a.jsx("table",{ref:r,className:pr("w-full caption-bottom text-sm",e),...t})}));yl.displayName="Table";const bl=Pe.forwardRef(({className:e,...t},r)=>a.jsx("thead",{ref:r,className:pr("[&_tr]:border-b",e),...t}));bl.displayName="TableHeader";const wl=Pe.forwardRef(({className:e,...t},r)=>a.jsx("tbody",{ref:r,className:pr("[&_tr:last-child]:border-0",e),...t}));wl.displayName="TableBody";const kst=Pe.forwardRef(({className:e,...t},r)=>a.jsx("tfoot",{ref:r,className:pr("bg-primary font-medium text-primary-foreground",e),...t}));kst.displayName="TableFooter";const qa=Pe.forwardRef(({className:e,...t},r)=>a.jsx("tr",{ref:r,className:pr("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));qa.displayName="TableRow";const On=Pe.forwardRef(({className:e,...t},r)=>a.jsx("th",{ref:r,className:pr("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));On.displayName="TableHead";const bn=Pe.forwardRef(({className:e,...t},r)=>a.jsx("td",{ref:r,className:pr("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));bn.displayName="TableCell";const Ist=Pe.forwardRef(({className:e,...t},r)=>a.jsx("caption",{ref:r,className:pr("mt-4 text-sm text-muted-foreground",e),...t}));Ist.displayName="TableCaption";const Ost={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},Hse={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},Mj=({icon:e,title:t,value:r,color:n,onClick:s,isActive:o})=>{const i=e;return a.jsxs(xr.div,{variants:Hse,className:pr("bg-surface rounded-lg border p-4 flex items-center gap-4 cursor-pointer transition-all duration-200",o?"border-brand ring-2 ring-brand/50":"border-border hover:border-brand/50"),onClick:s,children:[a.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${n}/20`,children:a.jsx(i,{className:`w-6 h-6 ${n}`})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-text-secondary text-sm font-medium",children:t}),a.jsx("p",{className:"text-2xl font-bold text-text-primary",children:r})]})]})};function Tst({open:e,onOpenChange:t,client:r,onEdit:n,onInactivate:s,codigoEmpresa:o}){const{toast:i}=Qa(),l={scheduled:{bg:"bg-[#3B82F6]/10",text:"text-[#3B82F6]",border:"border-[#3B82F6]/30"},confirmed:{bg:"bg-[#22C55E]/10",text:"text-[#22C55E]",border:"border-[#22C55E]/30"},in_progress:{bg:"bg-[#FACC15]/10",text:"text-[#FACC15]",border:"border-[#FACC15]/30"},finished:{bg:"bg-[#6B7280]/10",text:"text-[#6B7280]",border:"border-[#6B7280]/30"},canceled:{bg:"bg-[#EF4444]/10",text:"text-[#EF4444]",border:"border-[#EF4444]/30"},absent:{bg:"bg-[#F97316]/10",text:"text-[#F97316]",border:"border-[#F97316]/30"}},c=({label:M,value:D})=>a.jsxs("div",{className:"grid grid-cols-12 items-start gap-3 py-2 border-b border-border/50",children:[a.jsx("div",{className:"col-span-5 sm:col-span-4",children:a.jsx("span",{className:"block text-[11px] uppercase tracking-wide text-text-muted font-semibold",children:M})}),a.jsx("div",{className:"col-span-7 sm:col-span-8",children:a.jsx("span",{className:"block text-sm font-medium text-text-primary break-words",children:D})})]}),[d,u]=p.useState(!1),[f,h]=p.useState([]),[m,v]=p.useState(!1),[g,y]=p.useState([]),x=p.useRef(!1),b=p.useRef(!1),[w,j]=p.useState(!1),[_,S]=p.useState(null),[C,P]=p.useState(!1),[A,R]=p.useState(null),O=p.useMemo(()=>{try{const M=(f||[]).map(U=>({kind:"comanda",ts:new Date(U.aberto_em||U.created_at||0).getTime(),data:U})),D=(g||[]).map(U=>({kind:"agendamento",ts:new Date(U.inicio||0).getTime(),data:U}));return[...M,...D].sort((U,z)=>z.ts-U.ts).slice(0,10)}catch{return[]}},[f,g]),I=async M=>{try{if(j(!0),S(M?.kind||null),P(!0),R(null),M?.kind==="comanda"){const D=M?.data?.comanda_id;if(!D){P(!1);return}let U=de.from("comanda_itens").select("id, quantidade, preco_unitario, desconto, produto:produtos!comanda_itens_produto_id_fkey ( nome )").eq("comanda_id",D);o&&(U=U.eq("codigo_empresa",o));const{data:z}=await U,W=(z||[]).map(Y=>({id:Y.id,quantidade:Y.quantidade,preco_unitario:Y.preco_unitario,desconto:Y.desconto,produto_nome:Y.produto?.[0]?.nome||Y.produto?.nome||"Item"}));let $=de.from("pagamentos").select("id, valor, status, recebido_em, metodo").eq("comanda_id",D);o&&($=$.eq("codigo_empresa",o));const{data:X}=await $,ye=X||[];let Se=de.from("comanda_clientes").select("cliente:clientes!comanda_clientes_cliente_id_fkey ( id, nome, email, telefone )").eq("comanda_id",D);o&&(Se=Se.eq("codigo_empresa",o));const{data:V}=await Se,B=(V||[]).map(Y=>Y.cliente?.[0]||Y.cliente).filter(Boolean),Q=(W||[]).reduce((Y,ce)=>Y+(Number(ce.quantidade||0)*Number(ce.preco_unitario||0)-Number(ce.desconto||0)),0),pe=(ye||[]).filter(Y=>(Y.status||"Pago")!=="Cancelado"&&(Y.status||"Pago")!=="Estornado").reduce((Y,ce)=>Y+Number(ce.valor||0),0),te=Math.max(0,Q-pe);R({comandaId:D,mesa_title:M?.data?.mesa_title||"Balco",status:M?.data?.status||"open",itens:W||[],pagamentos:ye||[],clientes:B,totalItens:Q,totalPagos:pe,saldo:te,aberto_em:M?.data?.aberto_em||M?.data?.created_at||null,fechado_em:M?.data?.fechado_em||null})}else if(M?.kind==="agendamento"){const D=M?.data?.id;if(!D){P(!1);return}let U=[];try{const{data:$}=await de.from("agendamento_participantes").select("cliente_id, nome, valor_cota, status_pagamento").eq("agendamento_id",D).limit(200);U=$||[]}catch{U=[]}const z=Array.from(new Set((U||[]).map($=>$.cliente_id).filter(Boolean)));let W=[];if(W=(U||[]).map($=>({id:$.cliente_id,nome:$.nome||null,email:null,telefone:null,codigo:null,valor_cota:$.valor_cota??null,status_pagamento:$.status_pagamento||null})),z.length>0)try{const{data:$}=await de.from("clientes").select("id,nome,email,telefone,codigo").in("id",z),X=new Map(($||[]).map(ye=>[String(ye.id),ye]));W=W.map(ye=>{const Se=X.get(String(ye.id));return Se?{...ye,nome:ye.nome||Se.nome,email:Se.email,telefone:Se.telefone,codigo:Se.codigo}:ye})}catch{}R({id:D,inicio:M?.data?.inicio||null,fim:M?.data?.fim||null,status:M?.data?.status||null,modalidade:M?.data?.modalidade||null,quadra_nome:M?.data?.quadra_nome||null,participantes:W})}}catch{}finally{P(!1)}};return p.useEffect(()=>{let M=!1;if(e&&(x.current=!1,b.current=!1),e&&r?.id&&!o)return u(!1),v(!1),()=>{M=!0};const D=async()=>{if(!e||!r?.id)return;u(!0);const z=Number(r?.codigo??-1)===0;let W=de.from("comanda_clientes").select("comanda_id, created_at");z?W=W.is("cliente_id",null):W=W.eq("cliente_id",r.id),W=W.order("created_at",{ascending:!1}).limit(50),o&&(W=W.eq("codigo_empresa",o));const{data:$,error:X}=await W;if(X)throw X;const ye=Array.from(new Set(($||[]).map(pe=>pe.comanda_id).filter(Boolean)));let Se=[];if(!z){let pe=de.from("comandas").select("id, status, aberto_em, fechado_em").eq("cliente_id",r.id).order("aberto_em",{ascending:!1}).limit(10);o&&(pe=pe.eq("codigo_empresa",o));const{data:te,error:Y}=await pe;if(Y)throw Y;Se=te||[]}const V=Array.from(new Set((Se||[]).map(pe=>pe.id))),B=Array.from(new Set([...ye,...V]));if(B.length===0){h([]),u(!1);return}let Q;try{Q=setTimeout(()=>u(!1),1e4)}catch{}try{let pe=de.from("comandas").select("id,status,aberto_em,fechado_em, mesa:mesas!comandas_mesa_id_fkey ( nome, numero )").in("id",B);o&&(pe=pe.eq("codigo_empresa",o));const{data:te,error:Y}=await pe;if(Y)throw Y;const ce=new Map((te||[]).map(ht=>[ht.id,ht]));let me=de.from("comanda_itens").select("comanda_id, quantidade, preco_unitario, desconto").in("comanda_id",B);o&&(me=me.eq("codigo_empresa",o));const{data:ae,error:le}=await me;if(le)throw le;const ue={};for(const ht of ae||[]){const Wt=Number(ht.quantidade||0)*Number(ht.preco_unitario||0),be=Number(ht.desconto||0);ue[ht.comanda_id]=(ue[ht.comanda_id]||0)+Math.max(0,Wt-be)}let Re=de.from("pagamentos").select("comanda_id, valor, status, recebido_em, metodo").in("comanda_id",B);o&&(Re=Re.eq("codigo_empresa",o));const{data:ne,error:ie}=await Re;if(ie)throw ie;const gt={};for(const ht of ne||[])(ht.status||"Pago")!=="Cancelado"&&(ht.status||"Pago")!=="Estornado"&&(gt[ht.comanda_id]=(gt[ht.comanda_id]||0)+Number(ht.valor||0));const bt=(ht,Wt=null)=>{const be=ce.get(ht)||{},Ct=Number(ue[ht]||0),wt=Number(gt[ht]||0),Ge=Math.max(0,Ct-wt),Je=be.mesa?.[0]?.nome||be.mesa?.nome||null,_e=be.mesa?.[0]?.numero||be.mesa?.numero||null,je=Je||(_e!=null?`Mesa ${_e}`:"Balco");return{comanda_id:ht,created_at:Wt,aberto_em:be.aberto_em||null,fechado_em:be.fechado_em||null,status:be.status||"open",total:Ct,pago:wt,saldo:Ge,mesa_title:je}},at=($||[]).map(ht=>bt(ht.comanda_id,ht.created_at)),xt=(Se||[]).filter(ht=>!(ye||[]).includes(ht.id)).map(ht=>bt(ht.id,ht.aberto_em)),Ze=[...at,...xt].sort((ht,Wt)=>{const be=new Date(ht.aberto_em||ht.created_at||0).getTime();return new Date(Wt.aberto_em||Wt.created_at||0).getTime()-be}).slice(0,10);if(!M&&Ze.length===0&&!x.current){x.current=!0,console.debug("[ClientDetailsModal] loadHistory: empty result, retrying once..."),setTimeout(()=>{e&&r?.id&&D()},700);return}M||h(Ze)}catch(pe){i({title:"Falha ao carregar histrico do cliente",description:pe?.message||"Tente novamente",variant:"destructive"})}finally{try{clearTimeout(Q)}catch{}M||u(!1)}},U=async()=>{if(!e||!r?.id)return;v(!0);let z;try{z=setTimeout(()=>v(!1),1e4)}catch{}try{console.debug("[ClientDetailsModal] loadBookings: start",{clientId:r.id,codigoEmpresa:o});let W=de.from("agendamentos").select(`
            id, inicio, fim, status, modalidade,
            quadra:quadra_id ( nome )
          `).eq("cliente_id",r.id).order("inicio",{ascending:!1}).limit(10);o&&(W=W.eq("codigo_empresa",o));const{data:$,error:X}=await W;if(X)throw X;const ye=($||[]).map(me=>({id:me.id,inicio:me.inicio,fim:me.fim,status:me.status,modalidade:me.modalidade,quadra_nome:me.quadra?.[0]?.nome||me.quadra?.nome||null}));let Se=de.from("v_agendamento_participantes").select("agendamento_id").eq("cliente_id",r.id).limit(30);const{data:V,error:B}=await Se;if(B)throw B;const Q=Array.from(new Set((V||[]).map(me=>me.agendamento_id).filter(Boolean))),pe=new Set((ye||[]).map(me=>me.id)),te=Q.filter(me=>!pe.has(me));let Y=[];if(te.length>0){let me=de.from("agendamentos").select(`
              id, inicio, fim, status, modalidade,
              quadra:quadra_id ( nome )
            `).in("id",te);o&&(me=me.eq("codigo_empresa",o));const{data:ae,error:le}=await me;if(le)throw le;Y=(ae||[]).map(ue=>({id:ue.id,inicio:ue.inicio,fim:ue.fim,status:ue.status,modalidade:ue.modalidade,quadra_nome:ue.quadra?.[0]?.nome||ue.quadra?.nome||null}))}const ce=[...ye,...Y].sort((me,ae)=>new Date(ae.inicio)-new Date(me.inicio)).slice(0,10);if(!M&&ce.length===0&&!b.current){b.current=!0,console.debug("[ClientDetailsModal] loadBookings: empty result, retrying once..."),setTimeout(()=>{e&&r?.id&&U()},700);return}M||y(ce)}catch(W){console.warn("[ClientDetailsModal] Falha ao carregar agendamentos do cliente:",W)}finally{try{clearTimeout(z)}catch{}M||v(!1)}};return D(),U(),()=>{M=!0,e||(u(!1),v(!1))}},[e,r?.id,o]),r?a.jsx(mn,{open:e,onOpenChange:t,children:a.jsxs(un,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto w-full",children:[a.jsxs(on,{children:[a.jsx(an,{children:"Detalhes do Cliente"}),a.jsx(Nn,{children:"Informaes cadastrais e histrico recente deste cliente."})]}),a.jsxs("div",{className:"p-4 sm:p-6 space-y-6 sm:space-y-8",children:[a.jsx("div",{className:"overflow-hidden",children:a.jsx("div",{className:"flex items-start justify-between gap-4",children:a.jsxs("div",{className:"min-w-0",children:[a.jsx("h2",{className:"text-xl sm:text-2xl font-extrabold tracking-tight text-text-primary truncate",children:r.nome}),a.jsxs("div",{className:"mt-2 flex items-center flex-wrap gap-2",children:[a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-semibold bg-surface-2 border border-border text-text-secondary",children:["Cdigo: ",a.jsx("span",{className:"text-text-primary font-mono",children:r.codigo})]}),a.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold border ${r.status==="active"?"bg-emerald-500/10 text-emerald-400 border-emerald-400/30":"bg-rose-500/10 text-rose-400 border-rose-400/30"}`,children:r.status==="active"?"Ativo":"Inativo"}),r.flag_cliente&&a.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-blue-500/10 text-blue-500 border border-blue-500/30",children:"Cliente"}),r.flag_fornecedor&&a.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-purple-500/10 text-purple-500 border border-purple-500/30",children:"Fornecedor"})]}),a.jsx("span",{className:"mt-2 block text-sm text-text-secondary truncate",children:r.email||""})]})})}),a.jsx("div",{className:"grid grid-cols-1 gap-8",children:a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-text-secondary mb-2",children:"Informaes Cadastrais"}),a.jsxs("div",{className:"bg-surface-2 p-3 sm:p-4 rounded-lg space-y-1",children:[a.jsx(c,{label:"Cdigo",value:r.codigo}),a.jsx(c,{label:"CPF/CNPJ",value:r.cpf||r.cnpj||""}),a.jsx(c,{label:"Telefone",value:r.telefone||""}),a.jsx(c,{label:"Aniversrio",value:r.aniversario?new Date(r.aniversario).toLocaleDateString("pt-BR"):""}),a.jsx(c,{label:"Email",value:r.email||""}),a.jsx(c,{label:"Status",value:r.status==="active"?"Ativo":"Inativo"})]})]})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-primary",children:[a.jsx(Eue,{className:"w-5 h-5 text-text-secondary"}),a.jsx("h4",{className:"font-semibold",children:"Histrico Recente"})]}),a.jsx("div",{className:"bg-surface-2 p-3 sm:p-4 rounded-lg",children:d&&m?a.jsx("div",{className:"text-center py-8 text-sm text-text-muted",children:"Carregando histrico..."}):O&&O.length>0?a.jsx("div",{className:"max-h-64 overflow-y-auto thin-scroll pr-1",children:a.jsx("div",{className:"space-y-3",children:O.map((M,D)=>a.jsxs("div",{className:"group flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-3 p-3 rounded-md border border-border/60 bg-background cursor-pointer transition-colors transition-shadow hover:bg-surface-2/60 hover:shadow-md hover:border-brand/30",title:"Clique para ver detalhes",onClick:()=>I(M),children:[a.jsx("div",{className:"min-w-0",children:M.kind==="comanda"?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-sm font-semibold text-text-primary truncate",children:M.data.mesa_title||"Balco"}),a.jsx("div",{className:"text-xs text-text-secondary truncate",children:(()=>{const U=M.data;return U.aberto_em?new Date(U.aberto_em).toLocaleString("pt-BR"):new Date(U.created_at).toLocaleString("pt-BR")})()})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-sm font-semibold text-text-primary truncate",children:M.data.modalidade||"Agendamento"}),a.jsxs("div",{className:"text-xs text-text-secondary truncate",children:[new Date(M.data.inicio).toLocaleString("pt-BR"),"  ",M.data.quadra_nome||"Quadra"]})]})}),a.jsx("div",{className:"flex items-center gap-2 sm:gap-3 w-full sm:w-auto justify-between sm:justify-end",children:M.kind==="comanda"?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:pr("px-2 py-1 text-[11px] font-semibold rounded-full border",M.data.status==="closed"||M.data.fechado_em?"bg-success/10 text-success border-success/30":M.data.status==="awaiting-payment"?"bg-info/10 text-info border-info/30":"bg-warning/10 text-warning border-warning/30"),children:M.data.status==="closed"||M.data.fechado_em?"Fechada":M.data.status==="awaiting-payment"?"Pagamento":"Em uso"}),a.jsx("span",{className:"opacity-0 group-hover:opacity-100 transition-opacity text-[11px] text-text-secondary whitespace-nowrap",children:"Clique para detalhes"})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:pr("px-2 py-1 text-[11px] font-semibold rounded-full border",(()=>{const U=String(M.data.status||"").toLowerCase(),z=l[U]||l.scheduled;return`${z.bg} ${z.text} ${z.border}`})()),children:(()=>{switch(M.data.status){case"finished":return"Finalizado";case"canceled":return"Cancelado";case"in_progress":return"Em andamento";case"confirmed":return"Confirmado";case"absent":return"Ausente";case"scheduled":default:return"Agendado"}})()}),a.jsx("span",{className:"opacity-0 group-hover:opacity-100 transition-opacity text-[11px] text-text-secondary whitespace-nowrap",children:"Clique para detalhes"})]})})]},`${M.kind}-${D}`))})}):a.jsx("div",{className:"text-center py-8 text-sm text-text-muted",children:"Sem registros recentes para este cliente."})})]}),a.jsx(mn,{open:w,onOpenChange:j,children:a.jsxs(un,{className:"sm:max-w-[700px] w-full max-h-[85vh] overflow-y-auto",children:[a.jsxs(on,{children:[a.jsx(an,{children:_==="comanda"?A?.mesa_title||"Detalhes da Comanda":"Detalhes do Agendamento"}),a.jsx(Nn,{children:_==="comanda"?"Itens e pagamentos desta comanda.":"Informaes do agendamento e participantes."}),a.jsxs("div",{className:"mt-2 flex items-center gap-2 flex-wrap",children:[a.jsx("span",{className:"text-xs text-text-secondary",children:"Cliente:"}),a.jsx("span",{className:"text-sm font-medium text-text-primary",children:r?.nome||""}),a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-semibold bg-surface-2 border border-border text-text-secondary",children:["Cdigo: ",a.jsx("span",{className:"text-text-primary font-mono",children:r?.codigo??""})]})]})]}),a.jsx("div",{className:"space-y-4",children:C?a.jsx("div",{className:"text-sm text-text-muted",children:"Carregando detalhes..."}):_==="comanda"&&A?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Status"}),a.jsx("p",{className:"font-semibold",children:(()=>{const M=String(A.status||"").toLowerCase();return M==="closed"||A.fechado_em?"Fechada":M==="awaiting-payment"?"Aguardando pagamento":"Aberta"})()})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Abertura"}),a.jsx("p",{className:"font-semibold",children:A.aberto_em?new Date(A.aberto_em).toLocaleString("pt-BR"):""})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Fechamento"}),a.jsx("p",{className:"font-semibold",children:A.fechado_em?new Date(A.fechado_em).toLocaleString("pt-BR"):""})]})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-semibold mb-2",children:"Itens"}),a.jsxs("div",{className:"border rounded-md divide-y divide-border",children:[(A.itens||[]).map(M=>a.jsxs("div",{className:"p-2 flex flex-col sm:grid sm:grid-cols-12 gap-1 sm:gap-2 text-sm",children:[a.jsx("div",{className:"sm:col-span-6 font-medium",children:M.produto_nome||"Item"}),a.jsxs("div",{className:"sm:col-span-2 sm:text-right text-text-muted",children:["Qtd: ",Number(M.quantidade||0)]}),a.jsxs("div",{className:"sm:col-span-2 sm:text-right",children:["R$ ",Number(M.preco_unitario||0).toFixed(2)]}),a.jsx("div",{className:"sm:col-span-2 sm:text-right text-text-secondary",children:Number(M.desconto||0)?`- R$ ${Number(M.desconto||0).toFixed(2)}`:""})]},M.id)),(!A.itens||A.itens.length===0)&&a.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum item."})]})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-semibold mb-2",children:"Pagamentos"}),a.jsxs("div",{className:"border rounded-md divide-y divide-border",children:[(A.pagamentos||[]).map(M=>a.jsxs("div",{className:"p-2 flex items-center justify-between text-sm",children:[a.jsxs("span",{className:"truncate",children:[M.metodo||""," ",M.status?`(${M.status})`:""]}),a.jsxs("span",{className:"font-semibold",children:["R$ ",Number(M.valor||0).toFixed(2)]})]},M.id)),(!A.pagamentos||A.pagamentos.length===0)&&a.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum pagamento registrado."})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Total de Itens"}),a.jsxs("p",{className:"font-bold",children:["R$ ",Number(A.totalItens||0).toFixed(2)]})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Total Pago"}),a.jsxs("p",{className:"font-bold text-success",children:["R$ ",Number(A.totalPagos||0).toFixed(2)]})]})]})]}):_==="agendamento"&&A?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Modalidade"}),a.jsx("p",{className:"font-semibold",children:A.modalidade||""})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Quadra"}),a.jsx("p",{className:"font-semibold",children:A.quadra_nome||""})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Incio"}),a.jsx("p",{className:"font-semibold",children:A.inicio?new Date(A.inicio).toLocaleString("pt-BR"):""})]}),a.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Fim"}),a.jsx("p",{className:"font-semibold",children:A.fim?new Date(A.fim).toLocaleString("pt-BR"):""})]})]}),a.jsxs("div",{children:[a.jsx("h5",{className:"text-sm font-semibold mb-2",children:"Participantes"}),a.jsxs("div",{className:"border rounded-md divide-y divide-border",children:[(A.participantes||[]).map((M,D)=>a.jsxs("div",{className:"p-2 text-sm flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-3",children:[a.jsx("div",{className:"min-w-0",children:a.jsxs("div",{className:"flex items-center gap-2",children:[M.codigo!==null&&M.codigo!==void 0&&a.jsxs("span",{className:`text-xs font-bold rounded px-1.5 py-0.5 shrink-0 ${String(M.status_pagamento||"").toLowerCase()==="pago"?"text-emerald-400 bg-emerald-600/20 border border-emerald-700/40":"text-amber-400 bg-amber-600/20 border border-amber-700/40"}`,children:["#",M.codigo]}),a.jsx("span",{className:"font-medium truncate",children:M.nome||"Participante"})]})}),a.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 w-full sm:w-auto justify-between sm:justify-end",children:[M.valor_cota!=null&&a.jsxs("span",{className:"text-xs font-semibold text-text-secondary",children:["R$ ",Number(M.valor_cota||0).toFixed(2)]}),a.jsx("span",{className:`text-[11px] font-semibold rounded-full px-2 py-0.5 border ${String(M.status_pagamento||"").toLowerCase()==="pago"?"bg-success/10 text-success border-success/30":"bg-warning/10 text-warning border-warning/30"}`,children:String(M.status_pagamento||M.status_pagamento_text||"Pendente")})]})]},`${M.id}-${D}`)),(!A.participantes||A.participantes.length===0)&&a.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum participante encontrado."})]})]})]}):a.jsx("div",{className:"text-sm text-text-muted",children:"Nenhuma informao para exibir."})}),a.jsx(Qn,{children:a.jsx(fe,{variant:"outline",onClick:()=>j(!1),children:"Fechar"})})]})})]}),a.jsxs(Qn,{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 sm:gap-0 sm:justify-between",children:[!r?.is_consumidor_final&&a.jsx("div",{className:"w-full sm:flex-1",children:a.jsxs(fe,{type:"button",variant:"destructive",className:"bg-red-600 hover:bg-red-500 text-white w-full sm:w-auto",onClick:()=>s?.(r),children:[a.jsx(nG,{className:"mr-2 h-4 w-4"})," Inativar Cliente"]})}),a.jsxs("div",{className:"flex gap-2 w-full sm:w-auto sm:ml-auto",children:[a.jsx(vh,{asChild:!0,children:a.jsx(fe,{type:"button",variant:"secondary",className:"flex-1 sm:flex-none",children:"Fechar"})}),!r?.is_consumidor_final&&a.jsxs(fe,{onClick:()=>n(r),className:"flex-1 sm:flex-none",children:[a.jsx(Cl,{className:"mr-2 h-4 w-4"})," Editar Cliente"]})]})]})]})}):null}function Dst(){const{toast:e}=Qa(),{userProfile:t,authReady:r}=ms(),n=$o(),[s,o]=p.useState(()=>{try{const B=localStorage.getItem("auth:userProfile"),Q=B&&JSON.parse(B)?.codigo_empresa||null,pe=Q?`clientes:list:${Q}`:"clientes:list",te=JSON.parse(localStorage.getItem(pe)||"[]");return Array.isArray(te)?te:[]}catch{return[]}}),[i,l]=p.useState(!1),[c,d]=p.useState(!0),[u,f]=p.useState(!1),[h,m]=p.useState(!1),[v,g]=p.useState(null),[y,x]=p.useState(null),[b,w]=p.useState({searchTerm:"",status:"all",tipo:"todos"}),j=p.useRef(!1),_=p.useRef(0),S=p.useRef(0),C=p.useRef(!1);p.useEffect(()=>{n.state?.openModal&&!u&&!C.current&&(C.current=!0,f(!0),window.history.replaceState({},document.title))},[n.state?.openModal,u]);const P=async()=>{try{const B=s&&s.length>0;if(B||l(!0),!t?.codigo_empresa)return;const Q=`clientes:list:${t.codigo_empresa}`;let pe=de.from("clientes").select("*, is_consumidor_final").eq("codigo_empresa",t.codigo_empresa).order("codigo",{ascending:!0});if(b.searchTerm.trim()!==""){const ae=b.searchTerm.trim();/^\d+$/.test(ae)?pe=pe.or(`codigo.eq.${ae},nome.ilike.%${ae}%,email.ilike.%${ae}%,telefone.ilike.%${ae}%`):pe=pe.or(`nome.ilike.%${ae}%,email.ilike.%${ae}%,telefone.ilike.%${ae}%`)}b.status!=="all"&&(pe=pe.eq("status",b.status));const te=setTimeout(()=>{try{if(!B){const ae=JSON.parse(localStorage.getItem(Q)||"[]");Array.isArray(ae)&&ae.length>0&&(console.warn("[Clientes] slow fallback: using cached snapshot"),o(ae),S.current=ae.length)}}catch{}},2e3),{data:Y,error:ce}=await pe;if(ce){if(!j.current){j.current=!0,setTimeout(P,900);return}throw ce}const me=Y||[];if(me.length===0&&B&&!j.current){j.current=!0,setTimeout(P,700);return}j.current=!1,o(me);try{localStorage.setItem(Q,JSON.stringify(me))}catch{}S.current=me.length,_.current=Date.now()}catch(B){e({title:"Erro ao carregar clientes",description:B.message,variant:"destructive"})}finally{l(!1);try{clearTimeout(slowFallback)}catch{}}};p.useEffect(()=>{try{const B=localStorage.getItem("auth:userProfile"),Q=t?.codigo_empresa||B&&JSON.parse(B)?.codigo_empresa||null;if(Q){const pe=`clientes:list:${Q}`,te=JSON.parse(localStorage.getItem(pe)||"[]");Array.isArray(te)&&te.length&&s.length===0&&(o(te),S.current=te.length)}}catch{}if(r&&t?.codigo_empresa){const B=setTimeout(P,50);return()=>clearTimeout(B)}return()=>{}},[r,t?.codigo_empresa]),p.useEffect(()=>{if(r&&t?.codigo_empresa){const B=setTimeout(P,200);return()=>clearTimeout(B)}return()=>{}},[b.searchTerm,b.status,r,t?.codigo_empresa]),p.useEffect(()=>{const B=()=>{(Date.now()-(_.current||0)>3e4||S.current===0)&&r&&t?.codigo_empresa&&P()},Q=()=>{document.visibilityState==="visible"&&(Date.now()-(_.current||0)>3e4||S.current===0)&&r&&t?.codigo_empresa&&P()};return window.addEventListener("focus",B),document.addEventListener("visibilitychange",Q),()=>{window.removeEventListener("focus",B),document.removeEventListener("visibilitychange",Q)}},[r,t?.codigo_empresa]);const A=p.useMemo(()=>{const Q=new Date().getMonth();return{total:s.length,birthdays:s.filter(pe=>pe.aniversario&&new Date(pe.aniversario).getMonth()===Q).length,active:s.filter(pe=>pe.status==="active").length}},[s]);function R(B){const Q=["Cdigo","Tipo Pessoa","Nome/Razo Social","Apelido/Nome Fantasia","CPF","CNPJ","RG","IE","Email","Telefone","Fone 2","Celular 1","Celular 2","WhatsApp","CEP","Endereo","Nmero","Complemento","Bairro","Cidade","UF","Cidade IBGE","Limite Crdito","Tipo Recebimento","Regime Tributrio","Tipo Contribuinte","Aniversrio","Sexo","Estado Civil","Nome da Me","Nome do Pai","Observaes"," Cliente"," Fornecedor"," Funcionrio"," Administradora"," Parceiro","CCF/SPC","Status"],pe=";",te=ne=>{if(!ne)return"";try{const ie=new Date(ne);if(!isNaN(ie)){const gt=String(ie.getDate()).padStart(2,"0"),bt=String(ie.getMonth()+1).padStart(2,"0"),at=ie.getFullYear();return`${gt}/${bt}/${at}`}}catch{}return String(ne)},Y=ne=>{const ie=Number(ne??0);return Number.isFinite(ie)?ie.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""},ce=ne=>ne?"Sim":"No",me=ne=>{const ie=ne==null?"":String(ne);return/[";\n]/.test(ie)?`"${ie.replace(/"/g,'""')}"`:ie},ae=[];ae.push("\uFEFF"+Q.join(pe));for(const ne of B){const ie=[ne.codigo??"",ne.tipo_pessoa||"",ne.nome||"",ne.apelido||"",ne.cpf||"",ne.cnpj||"",ne.rg||"",ne.ie||"",ne.email||"",ne.telefone||"",ne.fone2||"",ne.celular1||"",ne.celular2||"",ne.whatsapp||"",ne.cep||"",ne.endereco||"",ne.numero||"",ne.complemento||"",ne.bairro||"",ne.cidade||"",ne.uf||"",ne.cidade_ibge||"",Y(ne.limite_credito),ne.tipo_recebimento||"",ne.regime_tributario||"",ne.tipo_contribuinte||"",te(ne.aniversario),ne.sexo||"",ne.estado_civil||"",ne.nome_mae||"",ne.nome_pai||"",ne.observacoes||"",ce(!!ne.flag_cliente),ce(!!ne.flag_fornecedor),ce(!!ne.flag_funcionario),ce(!!ne.flag_administradora),ce(!!ne.flag_parceiro),ce(!!ne.flag_ccf_spc),ne.status==="active"?"Ativo":"Inativo"].map(me).join(pe);ae.push(ie)}const le=new Blob([ae.join(`
`)],{type:"text/csv;charset=utf-8;"}),ue=URL.createObjectURL(le),Re=document.createElement("a");Re.href=ue,Re.download="clientes.csv",document.body.appendChild(Re),Re.click(),document.body.removeChild(Re),URL.revokeObjectURL(ue)}const O=()=>{try{R(I),e({title:"Exportao concluda",description:`${I.length} cliente(s) exportado(s).`,variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(B){e({title:"Falha ao exportar",description:B?.message||"No foi possvel gerar o arquivo.",variant:"destructive"})}},I=p.useMemo(()=>(new Date().getMonth(),s.filter(Q=>{const pe=b.searchTerm.toLowerCase()===""||(Q.nome||"").toLowerCase().includes(b.searchTerm.toLowerCase())||(Q.cpf||"").includes(b.searchTerm)||(Q.telefone||"").includes(b.searchTerm),te=b.status==="all"||Q.status===b.status;let Y=!0;return b.tipo==="clientes"?Y=Q.flag_cliente===!0:b.tipo==="fornecedores"?Y=Q.flag_fornecedor===!0:b.tipo==="ambos"&&(Y=Q.flag_cliente===!0&&Q.flag_fornecedor===!0),pe&&te&&Y})),[s,b]),[M,D]=p.useState({by:"codigo",dir:"asc"}),U=B=>{D(Q=>Q.by===B&&Q.dir==="asc"?{by:B,dir:"desc"}:{by:B,dir:"asc"})},z=p.useMemo(()=>{const B=I.find(ce=>ce?.is_consumidor_final===!0),pe=[...I.filter(ce=>ce?.is_consumidor_final!==!0)],te=M.dir==="asc"?1:-1,Y=(ce,me)=>Number.isFinite(ce)?ce:me;return pe.sort((ce,me)=>{if(M.by==="codigo"){const ae=Y(parseInt(String(ce.codigo||"").trim(),10),1/0),le=Y(parseInt(String(me.codigo||"").trim(),10),1/0);return ae===le?0:ae>le?te:-te}if(M.by==="nome"){const ae=(ce.nome||"").toString(),le=(me.nome||"").toString();return ae.localeCompare(le,"pt-BR",{sensitivity:"base"})*te}return 0}),B?[B,...pe]:pe},[I,M]),W=B=>{g(B),m(!0)},$=()=>{x(null),f(!0)},X=B=>{m(!1),x(B),f(!0)},ye=async B=>{try{const{error:Q}=await de.from("clientes").update({status:"inactive"}).eq("id",B.id);if(Q)throw Q;m(!1),e({title:"Cliente inativado",description:`${B.nome} foi marcado como inativo.`}),P()}catch(Q){e({title:"Erro ao inativar cliente",description:Q.message,variant:"destructive"})}},Se=()=>{w({searchTerm:"",status:"all",tipo:"todos"})},V=b.searchTerm!==""||b.status!=="all"||b.tipo!=="todos";return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"h-full flex flex-col",children:a.jsxs(xr.div,{variants:Ost,initial:"hidden",animate:"visible",children:[a.jsxs(xr.div,{variants:Hse,className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-black text-text-primary tracking-tighter",children:"Clientes & Fornecedores"}),a.jsx("p",{className:"text-sm text-text-secondary",children:"Gesto completa de clientes e fornecedores"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 w-full sm:w-auto",children:[a.jsx(fe,{variant:"outline",size:"icon",onClick:()=>d(B=>!B),title:c?"Ocultar resumo":"Mostrar resumo","aria-label":c?"Ocultar resumo":"Mostrar resumo",className:"flex-shrink-0",children:c?a.jsx(Yp,{className:"h-4 w-4"}):a.jsx(hg,{className:"h-4 w-4"})}),a.jsxs(fe,{variant:"outline",onClick:O,className:"text-sm",children:[a.jsx(uo,{className:"mr-2 h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Exportar"}),a.jsx("span",{className:"sm:hidden",children:"CSV"})]}),a.jsxs(fe,{onClick:$,className:"text-sm",children:[a.jsx(Ja,{className:"mr-2 h-4 w-4"})," ",a.jsx("span",{className:"hidden xs:inline",children:"Novo"}),a.jsx("span",{className:"xs:hidden",children:"Novo"})]})]})]}),c&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[a.jsx(Mj,{icon:Pl,title:"Total de Clientes",value:s.filter(B=>B.flag_cliente).length,color:"text-brand",onClick:()=>w(B=>({...B,tipo:"clientes"})),isActive:b.tipo==="clientes"}),a.jsx(Mj,{icon:Pl,title:"Total de Fornecedores",value:s.filter(B=>B.flag_fornecedor).length,color:"text-purple-500",onClick:()=>w(B=>({...B,tipo:"fornecedores"})),isActive:b.tipo==="fornecedores"}),a.jsx(Mj,{icon:Cue,title:"Aniversariantes do Ms",value:A.birthdays,color:"text-info",onClick:()=>w(B=>({...B,tipo:"todos"})),isActive:b.tipo==="todos"}),a.jsx(Mj,{icon:Jf,title:"Ativos",value:A.active,color:"text-success",onClick:()=>w(B=>({...B,status:"active"})),isActive:b.status==="active"})]}),a.jsx(xr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:a.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[a.jsxs("div",{className:"p-4 border-b border-border flex flex-col gap-4",children:[a.jsxs("div",{className:"relative w-full",children:[a.jsx(Zs,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(rt,{placeholder:"Buscar por nome, CPF ou telefone...",className:"pl-9",value:b.searchTerm,onChange:B=>w(Q=>({...Q,searchTerm:B.target.value}))})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsxs(vn,{value:b.tipo,onValueChange:B=>w(Q=>({...Q,tipo:B})),children:[a.jsx(hn,{className:"w-full sm:w-[200px]",children:a.jsx(wn,{placeholder:"Tipo"})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"todos",children:"Todos"}),a.jsx(ct,{value:"clientes",children:"Apenas Clientes"}),a.jsx(ct,{value:"fornecedores",children:"Apenas Fornecedores"}),a.jsx(ct,{value:"ambos",children:"Clientes e Fornecedores"})]})]}),a.jsxs(vn,{value:b.status,onValueChange:B=>w(Q=>({...Q,status:B})),children:[a.jsx(hn,{className:"w-full sm:w-[180px]",children:a.jsx(wn,{placeholder:"Status"})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"all",children:"Todos os Status"}),a.jsx(ct,{value:"active",children:"Ativos"}),a.jsx(ct,{value:"inactive",children:"Inativos"})]})]}),V&&a.jsxs(fe,{variant:"ghost",onClick:Se,className:"w-full sm:w-auto",children:[a.jsx(Qp,{className:"mr-2 h-4 w-4"}),"Limpar Filtros"]})]})]}),a.jsx("div",{className:"md:hidden space-y-3 p-4",children:i?a.jsx("div",{className:"text-center py-8 text-text-muted",children:"Carregando..."}):z.length>0?z.map(B=>{const Q=B?.is_consumidor_final===!0;return a.jsxs("div",{className:pr("rounded-lg border bg-surface p-4 space-y-3 cursor-pointer transition-all",Q?"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-4 border-l-amber-500/40 border-t-border border-r-border border-b-border":"border-border hover:border-brand/50"),onClick:()=>W(B),children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsx("span",{className:pr("font-mono text-sm font-semibold",Q?"text-amber-300/90":"text-text-primary"),children:B.codigo}),a.jsx("span",{className:pr("px-2 py-0.5 text-xs font-semibold rounded-full flex-shrink-0",B.status==="active"?"bg-success/10 text-success":"bg-danger/10 text-danger"),children:B.status==="active"?"Ativo":"Inativo"})]}),a.jsxs("div",{children:[a.jsx("h3",{className:pr("font-semibold text-base mb-1",Q?"text-amber-100/90":"text-text-primary"),children:B.nome||""}),Q&&a.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium mb-1",children:[a.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]}),a.jsx("p",{className:"text-sm text-text-muted",children:B.cpf&&`CPF: ${B.cpf}`||B.cnpj&&`CNPJ: ${B.cnpj}`||(B.apelido?`Apelido: ${B.apelido}`:" ")})]}),a.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[B.flag_cliente&&a.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-blue-500/10 text-blue-500 border border-blue-500/30",children:"Cliente"}),B.flag_fornecedor&&a.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-purple-500/10 text-purple-500 border border-purple-500/30",children:"Fornecedor"})]}),(B.telefone||B.email)&&a.jsxs("div",{children:[a.jsx("span",{className:"text-xs text-text-muted block mb-1",children:"Contato"}),a.jsx("span",{className:"text-sm font-medium",children:B.telefone||B.email})]}),a.jsx("div",{className:"text-xs text-text-muted text-center pt-2 border-t border-border/50",children:"Toque para ver detalhes"})]},B.id)}):a.jsx("div",{className:"text-center py-8 text-text-muted",children:"Nenhum cliente encontrado com os filtros aplicados."})}),a.jsx("div",{className:"hidden md:block",children:a.jsxs(yl,{children:[a.jsx(bl,{className:"sticky top-0 bg-surface-2 z-10",children:a.jsxs(qa,{className:"border-b border-border",children:[a.jsxs(On,{className:"select-none cursor-pointer text-text-secondary",onClick:()=>U("codigo"),title:"Ordenar por cdigo",children:["Cdigo ",M.by==="codigo"?M.dir==="asc"?"":"":""]}),a.jsxs(On,{className:"text-text-secondary select-none cursor-pointer",onClick:()=>U("nome"),title:"Ordenar por nome",children:["Cliente ",M.by==="nome"?M.dir==="asc"?"":"":""]}),a.jsx(On,{className:"text-text-secondary",children:"Contato"}),a.jsx(On,{className:"text-text-secondary",children:"Tipo"}),a.jsx(On,{className:"text-text-secondary",children:"Status"})]})}),a.jsx(wl,{children:i?a.jsx(qa,{children:a.jsx(bn,{colSpan:5,className:"h-24 text-center",children:"Carregando..."})}):z.length>0?z.map(B=>{const Q=B?.is_consumidor_final===!0;return a.jsxs(qa,{className:pr("cursor-pointer transition-all",Q?"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-2 border-l-amber-500/40":"hover:bg-surface-2"),onClick:()=>W(B),children:[a.jsx(bn,{className:pr("font-mono text-base font-semibold",Q?"text-amber-300/90":"text-text-primary"),children:B.codigo}),a.jsx(bn,{children:a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("span",{className:pr("text-base font-semibold truncate",Q?"text-amber-100/90":"text-text-primary"),children:B.nome||""}),Q&&a.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium",children:[a.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]}),a.jsx("span",{className:"text-xs text-text-muted truncate",children:B.cpf&&`CPF: ${B.cpf}`||B.cnpj&&`CNPJ: ${B.cnpj}`||(B.apelido?`Apelido: ${B.apelido}`:" ")})]})}),a.jsx(bn,{children:a.jsx("div",{className:"flex flex-col",children:a.jsx("span",{className:"text-sm truncate",children:B.telefone||B.email||""})})}),a.jsx(bn,{children:a.jsxs("div",{className:"flex flex-wrap gap-1",children:[B.flag_cliente&&a.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-blue-500/10 text-blue-500 border border-blue-500/30",children:"Cliente"}),B.flag_fornecedor&&a.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-purple-500/10 text-purple-500 border border-purple-500/30",children:"Fornecedor"})]})}),a.jsx(bn,{children:a.jsx("span",{className:pr("px-2 py-1 text-xs font-semibold rounded-full",B.status==="active"?"bg-success/10 text-success":"bg-danger/10 text-danger"),children:B.status==="active"?"Ativo":"Inativo"})})]},B.id)}):a.jsx(qa,{children:a.jsx(bn,{colSpan:5,className:"h-24 text-center",children:"Nenhum cliente encontrado com os filtros aplicados."})})})]})})]})})]})}),a.jsx(tne,{open:u,onOpenChange:f,client:y,onSaved:P}),a.jsx(Tst,{open:h,onOpenChange:m,client:v,onEdit:X,onInactivate:ye,codigoEmpresa:t?.codigo_empresa})]})}const Mst=[],Rst={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},Gse={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},lk=({icon:e,title:t,value:r,color:n})=>{const s=e;return a.jsxs(xr.div,{variants:Gse,className:"bg-surface rounded-lg border border-border p-4 flex items-center gap-4",children:[a.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${n}/20`,children:a.jsx(s,{className:`w-6 h-6 ${n}`})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-text-secondary text-sm font-medium",children:t}),a.jsx("p",{className:"text-2xl font-bold text-text-primary",children:r})]})]})};function Lst({open:e,onOpenChange:t,member:r,onEdit:n}){return r?a.jsx(mn,{open:e,onOpenChange:t,children:a.jsxs(un,{className:"sm:max-w-[500px] w-full",children:[a.jsx(on,{children:a.jsx(an,{children:"Detalhes do Funcionrio"})}),a.jsxs("div",{className:"p-4 sm:p-6 space-y-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-xl font-bold",children:r.name}),a.jsx("p",{className:"text-brand font-semibold",children:r.role})]}),a.jsxs("div",{className:"bg-surface-2 p-8 rounded-lg text-center border border-border",children:[a.jsx("p",{className:"text-lg font-semibold text-text-secondary",children:" Em desenvolvimento"}),a.jsx("p",{className:"text-sm text-text-muted mt-2",children:"Detalhes completos do funcionrio estaro disponveis em breve."})]})]}),a.jsxs(Qn,{className:"flex flex-col sm:flex-row gap-2 sm:gap-0",children:[a.jsx(vh,{asChild:!0,children:a.jsx(fe,{type:"button",variant:"secondary",className:"w-full sm:w-auto",children:"Fechar"})}),a.jsxs(fe,{onClick:()=>n(r),className:"w-full sm:w-auto",children:[a.jsx(Cl,{className:"mr-2 h-4 w-4"})," Editar"]})]})]})}):null}function Fst({open:e,onOpenChange:t,member:r,onSave:n,loading:s}){const{toast:o}=Qa(),[i,l]=p.useState(r?.name||""),[c,d]=p.useState(r?.role||"");p.useEffect(()=>{e&&(l(r?.name||""),d(r?.role||""))},[r,e]);const u=async f=>{if(f.preventDefault(),!i.trim()){o({title:"Nome  obrigatrio",variant:"destructive"});return}await n({name:i.trim(),role:c.trim()})};return a.jsx(mn,{open:e,onOpenChange:t,children:a.jsxs(un,{className:"sm:max-w-[700px] w-full",children:[a.jsxs(on,{children:[a.jsx(an,{children:r?"Editar Funcionrio":"Novo Funcionrio"}),a.jsx(Nn,{children:"Informe apenas nome e cargo. O cargo  livre (texto)."})]}),a.jsx("form",{onSubmit:u,className:"py-2",children:a.jsx("div",{className:"bg-surface-2 border border-border rounded-lg p-4 space-y-4",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(qe,{htmlFor:"name",children:"Nome"}),a.jsxs("div",{className:"relative",children:[a.jsx(Uu,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(rt,{id:"name",value:i,onChange:f=>l(f.target.value),className:"pl-9",placeholder:"Ex.: Maria Silva"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(qe,{htmlFor:"role",children:"Cargo"}),a.jsxs("div",{className:"relative",children:[a.jsx(Iue,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(rt,{id:"role",value:c,onChange:f=>d(f.target.value),className:"pl-9",placeholder:"Ex.: Gerente, Caixa, ..."})]})]})]})})}),a.jsxs(Qn,{className:"flex flex-col sm:flex-row gap-2 sm:gap-0",children:[a.jsx(vh,{asChild:!0,children:a.jsx(fe,{type:"button",variant:"secondary",className:"w-full sm:w-auto",children:"Cancelar"})}),a.jsx(fe,{type:"submit",onClick:u,disabled:!!s,className:"w-full sm:w-auto",children:s?"Salvando...":"Salvar"})]})]})})}function $st(){const{company:e,authReady:t,userProfile:r}=ms(),{toast:n}=Qa(),[s,o]=p.useState(Mst),[i,l]=p.useState(!1),[c,d]=p.useState(!1),[u,f]=p.useState(null),[h,m]=p.useState(null),[v,g]=p.useState(""),[y,x]=p.useState(!1),b=p.useRef(!1),w=p.useRef(!0);p.useEffect(()=>(w.current=!0,()=>{w.current=!1}),[]);const j=async()=>{try{const M=e?.codigo_empresa||null;if(!M&&!e?.id)return;const D=M?`team:list:${M}`:"team:list",U=setTimeout(()=>{if(w.current)try{const V=localStorage.getItem(D),B=V?JSON.parse(V):[];Array.isArray(B)&&B.length>0&&(console.warn("[Equipe] slow fallback: using cached snapshot"),o(B))}catch{}},5e3);let z=de.from("colaboradores").select("*").order("nome",{ascending:!0});M&&(z=z.eq("codigo_empresa",M));const{data:W,error:$}=await z;if($){if(!b.current){b.current=!0,setTimeout(j,800);return}throw $}let ye=(W||[]).map(V=>({id:V.id,name:V.nome||"",role:V.cargo||"user",status:V.ativo===!1?"inactive":"active",online:!1,permissions:{}}));const Se=r?.codigo_empresa&&e?.codigo_empresa&&r.codigo_empresa===e.codigo_empresa;if(r?.id&&Se&&(ye.some(B=>B.id===r.id)||(ye=[{id:r.id,name:r.nome||"Voc",role:r.cargo||"user",status:"active",online:!1,permissions:{}},...ye])),!w.current)return;o(ye);try{localStorage.setItem(D,JSON.stringify(ye))}catch{}}catch(M){console.error("Falha ao carregar equipe:",M);const D=e?.codigo_empresa||null,U=D?`team:list:${D}`:"team:list";try{const z=localStorage.getItem(U);z&&w.current&&o(JSON.parse(z))}catch{}}finally{b.current=!1}};p.useEffect(()=>{const M=e?.codigo_empresa||null;if(!(!t||!M)){try{const D=localStorage.getItem(`team:list:${M}`),U=D?JSON.parse(D):[];Array.isArray(U)&&U.length>0&&o(U)}catch{}j()}},[t,e?.codigo_empresa]),p.useEffect(()=>{const M=()=>{document.visibilityState==="visible"&&t&&(e?.codigo_empresa||e?.id)&&j()},D=()=>{t&&(e?.codigo_empresa||e?.id)&&j()};return document.addEventListener("visibilitychange",M),window.addEventListener("focus",D),()=>{document.removeEventListener("visibilitychange",M),window.removeEventListener("focus",D)}},[t,e?.codigo_empresa,e?.id]);const _=p.useMemo(()=>({total:s.length,active:s.filter(M=>M.status==="active").length,inactive:s.filter(M=>M.status==="inactive").length}),[s]),S=p.useMemo(()=>s.filter(M=>M.name.toLowerCase().includes(v.toLowerCase())||M.role.toLowerCase().includes(v.toLowerCase())),[s,v]),C=M=>{f(M),d(!0)},P=()=>{m(null),l(!0)},A=M=>{d(!1),m(M),l(!0)},R=M=>{m(M),l(!0)},O=async({name:M,role:D})=>{try{if(x(!0),!e?.codigo_empresa&&!e?.id)throw new Error("Empresa no encontrada para o usurio atual.");let U=e?.codigo_empresa||null;if(!U&&e?.id){const{data:z}=await de.from("empresas").select("codigo_empresa").eq("id",e.id).single();U=z?.codigo_empresa||null}if(!U)throw new Error("Empresa sem cdigo. Defina o cdigo da empresa antes de adicionar colaboradores.");if(h){const{error:z}=await de.from("colaboradores").update({nome:M,cargo:D}).eq("id",h.id);if(z)throw z;n({title:"Funcionrio atualizado",description:h.name,variant:"default"})}else{const{error:z}=await de.from("colaboradores").insert({codigo_empresa:U,nome:M,cargo:D,ativo:!0});if(z)throw z;n({title:"Funcionrio criado com sucesso",description:M,variant:"success"})}await j(),l(!1),m(null)}catch(U){n({title:"Erro ao salvar funcionrio",description:U.message||String(U),variant:"destructive"})}finally{x(!1)}},I=async M=>{try{if(!(e?.id||e?.codigo_empresa))return;const D=s[0]?.id;if(M.id===D){n({title:"Ao no permitida",description:"No  possvel desativar o primeiro funcionrio.",variant:"destructive"});return}if(r?.id&&M.id===r.id){n({title:"Ao no permitida",description:"Voc no pode desativar o seu prprio usurio.",variant:"destructive"});return}if(s.filter(z=>z.status==="active").length<=1){n({title:"Ao no permitida",description:"Deve haver pelo menos um funcionrio ativo.",variant:"destructive"});return}const{error:U}=await de.from("colaboradores").update({ativo:!1}).eq("id",M.id);if(U)throw U;n({title:"Funcionrio desativado",description:M.name}),await j()}catch(D){n({title:"Erro ao desativar",description:D.message||String(D),variant:"destructive"})}};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"h-full flex flex-col",children:a.jsxs(xr.div,{variants:Rst,initial:"hidden",animate:"visible",children:[a.jsxs(xr.div,{variants:Gse,className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-black text-text-primary tracking-tighter",children:"Gesto de Equipe"}),a.jsx("p",{className:"text-sm sm:text-base text-text-secondary",children:"Controle de funcionrios, permisses e logs."})]}),a.jsxs(fe,{onClick:P,disabled:!t||!e?.codigo_empresa,title:t?e?.codigo_empresa?"":"Empresa sem cdigo. Defina o cdigo da empresa antes.":"Aguardando autenticao...",children:[a.jsx(Ja,{className:"mr-2 h-4 w-4"})," Novo Funcionrio"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsx(lk,{icon:Pl,title:"Total",value:_.total,color:"text-brand"}),a.jsx(lk,{icon:Wue,title:"Ativos",value:_.active,color:"text-success"}),a.jsx(lk,{icon:que,title:"Desativados",value:_.inactive,color:"text-danger"})]}),a.jsx(xr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:a.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[a.jsx("div",{className:"p-4 border-b border-border",children:a.jsxs("div",{className:"relative",children:[a.jsx(Zs,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(rt,{placeholder:"Buscar por nome ou cargo...",className:"pl-9",value:v,onChange:M=>g(M.target.value)})]})}),a.jsx("div",{className:"md:hidden p-4 space-y-3",children:S.length===0?a.jsx("div",{className:"text-center py-10 text-text-muted",children:"Nenhum funcionrio cadastrado."}):S.map((M,D)=>a.jsxs("div",{className:"rounded-lg border border-border bg-surface p-4 space-y-3",onClick:()=>C(M),children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-semibold text-base text-text-primary truncate",children:M.name}),a.jsx("p",{className:"text-sm text-text-muted mt-0.5",children:M.role})]}),a.jsx("span",{className:pr("inline-flex px-2 py-0.5 rounded-full text-xs font-semibold flex-shrink-0",M.status==="active"?"bg-success/10 text-success":"bg-danger/10 text-danger"),children:M.status==="active"?"Ativo":"Inativo"})]}),a.jsxs("div",{className:"flex gap-2 pt-2",children:[a.jsx(fe,{variant:"outline",size:"sm",onClick:U=>{U.stopPropagation(),C(M)},className:"flex-1",children:"Ver Detalhes"}),a.jsx(fe,{variant:"outline",size:"sm",onClick:U=>{U.stopPropagation(),R(M)},children:a.jsx(Cl,{className:"h-3 w-3"})}),a.jsxs(bb,{children:[a.jsx(wb,{asChild:!0,children:a.jsx(fe,{variant:"outline",size:"sm",onClick:U=>U.stopPropagation(),children:a.jsx(BF,{className:"h-3 w-3"})})}),a.jsx(xx,{align:"end",children:a.jsx(Nl,{className:"text-danger",disabled:D===0||s.filter(U=>U.status==="active").length<=1||r?.id&&M.id===r.id,onClick:U=>{U.stopPropagation(),I(M)},children:"Desativar"})})]})]})]},M.id))}),a.jsx("div",{className:"hidden md:block",children:a.jsxs(yl,{children:[a.jsx(bl,{children:a.jsxs(qa,{children:[a.jsx(On,{children:"Funcionrio"}),a.jsx(On,{children:"Cargo"}),a.jsx(On,{children:"Status"}),a.jsx(On,{className:"w-[80px] text-center",children:"Aes"})]})}),a.jsxs(wl,{children:[S.length===0&&a.jsx(qa,{children:a.jsx(bn,{colSpan:4,className:"text-center py-10 text-text-muted",children:"Nenhum funcionrio cadastrado."})}),S.map((M,D)=>a.jsxs(qa,{className:"cursor-pointer",onClick:()=>C(M),children:[a.jsx(bn,{className:"font-medium",children:a.jsx("div",{className:"flex items-center gap-3",children:a.jsx("span",{children:M.name})})}),a.jsx(bn,{children:M.role}),a.jsx(bn,{children:a.jsx("span",{className:pr("px-2 py-1 text-xs font-semibold rounded-full",M.status==="active"?"bg-success/10 text-success":"bg-danger/10 text-danger"),children:M.status==="active"?"Ativo":"Inativo"})}),a.jsx(bn,{className:"text-center",children:a.jsxs(bb,{children:[a.jsx(wb,{asChild:!0,children:a.jsx(fe,{variant:"ghost",className:"h-8 w-8 p-0 mx-auto",onClick:U=>U.stopPropagation(),children:a.jsx(BF,{className:"h-4 w-4"})})}),a.jsxs(xx,{align:"end",children:[a.jsx(Nl,{onClick:U=>{U.stopPropagation(),C(M)},children:"Ver Detalhes"}),a.jsx(Nl,{onClick:U=>{U.stopPropagation(),R(M)},children:"Editar"}),a.jsx(Nl,{className:"text-danger",disabled:D===0||s.filter(U=>U.status==="active").length<=1||r?.id&&M.id===r.id,onClick:U=>{U.stopPropagation(),I(M)},children:"Desativar"})]})]})})]},M.id))]})]})})]})})]})}),a.jsx(Fst,{open:i,onOpenChange:l,member:h,onSave:O,loading:y}),a.jsx(Lst,{open:c,onOpenChange:d,member:u,onEdit:A})]})}const Bst="v2.0.0";function km({title:e,icon:t,children:r,className:n="",collapsible:s=!1,defaultOpen:o=!0}){return s?a.jsx("div",{className:`bg-surface rounded-lg border border-border shadow-sm ${n}`,children:a.jsxs("details",{className:"group",open:o,children:[a.jsxs("summary",{className:"list-none cursor-pointer select-none p-4 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[t&&a.jsx(t,{className:"w-5 h-5 text-brand"}),a.jsx("h3",{className:"text-base font-semibold",children:e})]}),a.jsx("span",{className:"text-xs text-text-secondary group-open:rotate-180 transition-transform",children:""})]}),a.jsx("div",{className:"px-4 pb-4",children:r})]})}):a.jsxs("div",{className:`bg-surface rounded-lg border border-border shadow-sm p-4 ${n}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t&&a.jsx(t,{className:"w-5 h-5 text-brand"}),a.jsx("h3",{className:"text-base font-semibold",children:e})]}),r]})}function Im({label:e,value:t}){return a.jsxs("div",{className:"flex items-center justify-between gap-3 py-1 text-sm",children:[a.jsx("span",{className:"text-text-secondary",children:e}),a.jsx("span",{className:"font-medium truncate",children:t||""})]})}function qst(){const{userProfile:e,company:t,authReady:r,loading:n}=ms();$o();const[s,o]=p.useState("Agenda"),[i,l]=p.useState("Mdia"),[c,d]=p.useState(""),[u,f]=p.useState(""),[h,m]=p.useState(!0),[v,g]=p.useState(()=>window.__installPrompt||null),[y,x]=p.useState(!1),[b,w]=p.useState(!1),[j,_]=p.useState(!1),[S,C]=p.useState("unknown"),P="Fluxo7 Arena",A="fluxo7team@gmail.com",R="https://wa.me/5534998936088",O="tel:+5534998936088",I="+55 (34) 99893-6088";p.useEffect(()=>{try{const X=window.matchMedia("(pointer:fine)"),ye=()=>m(X.matches);return ye(),X.addEventListener?.("change",ye),()=>X.removeEventListener?.("change",ye)}catch{m(!0)}},[]),p.useEffect(()=>{const X=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;w(X);const ye=navigator.userAgent;ye.includes("Chrome")&&!ye.includes("Edg")?C("chrome"):ye.includes("Edg")?C("edge"):ye.includes("Firefox")?C("firefox"):ye.includes("Safari")&&!ye.includes("Chrome")?C("safari"):C("other"),(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone)&&x(!0),window.__installPrompt&&!v&&g(window.__installPrompt);const Se=()=>{x(!0),g(null),_(!1)};return window.addEventListener("appinstalled",Se),()=>{window.removeEventListener("appinstalled",Se)}},[v]);const M=async()=>{if(v)try{await v.prompt();const{outcome:X}=await v.userChoice;X==="accepted"?(x(!0),_(!1)):_(!0),g(null),window.__installPrompt=null}catch(X){console.error("Erro ao mostrar prompt de instalao:",X),_(!0)}else _(!0)},D=()=>{navigator.share?navigator.share({title:"F7 Arena",text:"Adicione F7 Arena  sua tela inicial",url:window.location.href}).catch(()=>{alert(`Para adicionar  tela inicial:

1. Toque no boto de Compartilhar (cone de quadrado com seta)
2. Role para baixo
3. Toque em "Adicionar  Tela de Incio"`)}):alert(`Para adicionar  tela inicial:

1. Toque no boto de Compartilhar (cone de quadrado com seta)
2. Role para baixo
3. Toque em "Adicionar  Tela de Incio"`)},U=p.useMemo(()=>{try{return{empresa:t?.nome||t?.fantasia||t?.razao_social||t?.razaoSocial||t?.displayName||t?.codigo_empresa||"",usuario:e?.nome||e?.name||e?.email||"",dataHora:new Date().toLocaleString("pt-BR")}}catch{return{empresa:"",usuario:"",dataHora:new Date().toLocaleString("pt-BR")}}},[t?.nome,t?.fantasia,t?.razao_social,t?.razaoSocial,t?.displayName,t?.codigo_empresa,e?.nome,e?.name,e?.email]),z=p.useMemo(()=>[`[${P} - Suporte]`,`Assunto: ${c||"(sem assunto)"} `,`Categoria: ${s} `,`Severidade: ${i}`,"","Descrio:",(u||"(adicione uma descrio detalhada, passos para reproduzir, prints se possvel)")+`
`," Dados ",`Empresa: ${U.empresa}`,`Usurio: ${U.usuario}`,`Data e Hora: ${U.dataHora}`].join(`
`),[c,s,i,u,U]),W=`${R}?text=${encodeURIComponent(z)}`,$=`mailto:${A}?subject=${encodeURIComponent(`[Suporte] ${c||"Assunto"}`)}&body=${encodeURIComponent(z)}`;return a.jsxs("div",{className:"px-4 md:px-6 lg:px-8 py-4 md:py-6",children:[a.jsxs("div",{className:"bg-surface rounded-xl border border-border p-5 md:p-6 mb-6",children:[a.jsxs("div",{className:"flex items-start md:items-center justify-between gap-4 flex-col md:flex-row",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-brand/10 border border-brand/30 flex items-center justify-center",children:a.jsx(QH,{className:"w-5 h-5 text-brand"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl md:text-2xl font-semibold",children:"Suporte"}),a.jsx("p",{className:"text-sm text-text-secondary",children:"Precisa de ajuda? Fale com a gente ou consulte as respostas rpidas abaixo."})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[a.jsx("div",{className:"w-10 h-10 bg-brand rounded-xl flex items-center justify-center",children:a.jsx(Dc,{className:"w-6 h-6 text-primary-foreground"})}),a.jsxs("div",{className:"flex items-baseline",children:[a.jsx("span",{className:"font-extrabold text-base md:text-xl",style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{className:"font-extrabold text-base md:text-xl",style:{color:"#FFAA33"},children:"7"}),a.jsx("span",{className:"font-medium text-base md:text-xl",style:{color:"#B0B0B0"},children:" Arena"})]})]}),a.jsxs("div",{className:"text-xs text-text-secondary mt-1",children:["Verso ",Bst]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-4",children:[a.jsx(km,{title:"Status",icon:B2,children:a.jsxs("div",{className:"grid grid-cols-1 gap-1",children:[a.jsx(Im,{label:"Empresa",value:U.empresa}),a.jsx(Im,{label:"Usurio",value:`${U.usuario}`})]})}),a.jsx(km,{title:"Fale com a gente",icon:aA,children:a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs("a",{href:R,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 rounded-md bg-brand text-black hover:opacity-90 transition",children:[a.jsx(aA,{className:"w-4 h-4"})," WhatsApp"]}),a.jsxs("a",{href:`mailto:${A}`,className:"inline-flex items-center gap-2 px-3 py-2 rounded-md border border-border hover:bg-surface-2 transition",children:[a.jsx(Ox,{className:"w-4 h-4"})," E-mail"]}),a.jsxs("a",{href:O,className:"inline-flex items-center gap-2 px-3 py-2 rounded-md border border-border hover:bg-surface-2 transition",children:[a.jsx(tw,{className:"w-4 h-4"})," ",h?I:"Telefone"]})]})}),!y&&b&&a.jsx(km,{title:"Adicionar  Tela Inicial",icon:sA,children:a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-sm text-text-secondary",children:"Crie um atalho do F7 Arena na sua tela inicial para acesso rpido."}),a.jsxs("button",{onClick:D,className:"w-full inline-flex items-center justify-center gap-2 px-4 py-3 rounded-md bg-brand text-black font-medium hover:opacity-90 transition",children:[a.jsx(zF,{className:"w-4 h-4"})," Criar Atalho"]}),a.jsxs("details",{className:"text-xs text-text-muted",children:[a.jsx("summary",{className:"cursor-pointer hover:text-text-secondary",children:"Como fazer manualmente?"}),a.jsxs("div",{className:"mt-2 space-y-1 pl-2",children:[a.jsxs("p",{children:["1. Toque no boto ",a.jsx(zF,{className:"inline w-3 h-3"})," (Compartilhar)"]}),a.jsx("p",{children:'2. Role para baixo e toque em "Adicionar  Tela de Incio"'}),a.jsx("p",{children:'3. Toque em "Adicionar"'})]})]})]})}),!y&&!b&&a.jsx(km,{title:"Instalar Aplicativo",icon:sA,children:a.jsxs("div",{className:"space-y-2",children:[a.jsx("p",{className:"text-sm text-text-secondary",children:"Instale o F7 Arena no seu dispositivo para acesso rpido e experincia completa de aplicativo."}),a.jsxs("button",{onClick:M,className:"w-full inline-flex items-center justify-center gap-2 px-4 py-3 rounded-md bg-brand text-black font-medium hover:opacity-90 transition",children:[a.jsx(uo,{className:"w-4 h-4"})," Instalar App"]}),a.jsx("p",{className:"text-xs text-text-muted text-center",children:"Pode demorar alguns segundos. Se no aparecer nada, veja as instrues no tutorial."})]})}),y&&a.jsx(km,{title:"Aplicativo Instalado",icon:B2,children:a.jsxs("div",{className:"flex items-center gap-2 text-sm text-success",children:[a.jsx(B2,{className:"w-4 h-4"}),a.jsx("span",{children:"F7 Arena est instalado no seu dispositivo!"})]})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsx("div",{className:"lg:col-span-2 space-y-3",children:a.jsx(km,{title:"Perguntas Frequentes (FAQ)",children:a.jsxs("div",{className:"divide-y divide-border/60",children:[a.jsxs("details",{className:"py-3",children:[a.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Como abrir comanda de balco?"}),a.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"Abra o caixa antes. A tela de balco utiliza uma comanda sem mesa (mesa_id nulo). Se no existir, o sistema cria ao abrir o balco; caso o caixa esteja fechado, a abertura da comanda  bloqueada."})]}),a.jsxs("details",{className:"py-3",children:[a.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Por que no consigo fechar o caixa?"}),a.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"O fechamento  bloqueado se houver comandas com itens em aberto (inclui balco e mesas). Finalize ou feche as comandas pendentes antes de encerrar o caixa."})]}),a.jsxs("details",{className:"py-3",children:[a.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Como adicionar participantes no agendamento?"}),a.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"No modal de agendamento, selecione um ou mais clientes. Aps salvar, o chip de pagamentos  atualizado imediatamente. Se no visualizar, recarregue os dados da agenda."})]}),a.jsxs("details",{className:"py-3",children:[a.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Como ver o histrico completo do cliente?"}),a.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"Abra o cliente e utilize o Histrico Recente, que combina comandas e agendamentos em uma nica timeline com totais e status."})]}),a.jsxs("details",{className:"py-3",children:[a.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Como ajustar estoque mnimo e ver mais vendidos?"}),a.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"Na aba de Produtos voc pode gerenciar estoque, preos e relatrios. Utilize filtros e exportaes para anlise."})]})]})})}),a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"space-y-3 lg:sticky lg:top-6",children:[a.jsx(km,{title:"Reportar um problema",icon:vue,collapsible:!0,defaultOpen:!1,children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-secondary",children:"Categoria"}),a.jsxs("select",{value:s,onChange:X=>o(X.target.value),className:"w-full mt-1 px-2 py-2 rounded-md bg-background border border-border",children:[a.jsx("option",{children:"Agenda"}),a.jsx("option",{children:"Vendas"}),a.jsx("option",{children:"Clientes"}),a.jsx("option",{children:"Produtos"}),a.jsx("option",{children:"Financeiro"}),a.jsx("option",{children:"Outros"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-secondary",children:"Severidade"}),a.jsxs("select",{value:i,onChange:X=>l(X.target.value),className:"w-full mt-1 px-2 py-2 rounded-md bg-background border border-border",children:[a.jsx("option",{children:"Baixa"}),a.jsx("option",{children:"Mdia"}),a.jsx("option",{children:"Alta"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-secondary",children:"Assunto"}),a.jsx("input",{value:c,onChange:X=>d(X.target.value),placeholder:"Ex.: Erro ao salvar agendamento",className:"w-full mt-1 px-3 py-2 rounded-md bg-background border border-border"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-text-secondary",children:"Descrio"}),a.jsx("textarea",{value:u,onChange:X=>f(X.target.value),rows:4,placeholder:"Descreva o que aconteceu, passos para reproduzir, expectativa.",className:"w-full mt-1 px-3 py-2 rounded-md bg-background border border-border resize-y"})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 pt-1",children:[a.jsxs("a",{href:W,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 rounded-md bg-brand text-black hover:opacity-90 transition",children:[a.jsx(aA,{className:"w-4 h-4"})," Enviar no WhatsApp"]}),a.jsxs("a",{href:$,className:"inline-flex items-center gap-2 px-3 py-2 rounded-md border border-border hover:bg-surface-2 transition",children:[a.jsx(Ox,{className:"w-4 h-4"})," Enviar por E-mail"]}),a.jsxs("a",{href:O,className:"inline-flex items-center gap-2 px-3 py-2 rounded-md border border-border hover:bg-surface-2 transition",children:[a.jsx(tw,{className:"w-4 h-4"})," ",h?I:"Ligar agora"]})]})]})}),a.jsx(km,{title:"Diagnstico",icon:_ue,children:a.jsxs("div",{className:"space-y-1 text-sm",children:[a.jsx(Im,{label:"Empresa",value:U.empresa}),a.jsx(Im,{label:"Usurio",value:`${U.usuario}`}),a.jsx(Im,{label:"Data/Hora",value:U.dataHora}),a.jsx(Im,{label:"Canal - WhatsApp",value:"(34) 99893-6088"}),a.jsx(Im,{label:"Canal - E-mail",value:"fluxo7team@gmail.com"}),a.jsx(Im,{label:"Canal - Telefone",value:"(34) 99893-6088"})]})})]})})]}),a.jsx(mn,{open:j,onOpenChange:_,children:a.jsxs(un,{className:"max-w-2xl max-h-[85vh] overflow-y-auto",children:[a.jsx(on,{children:a.jsxs(an,{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl bg-brand/10 border border-brand/30 flex items-center justify-center",children:a.jsx(uo,{className:"w-6 h-6 text-brand"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold",children:"Como Instalar o F7 Arena"}),a.jsx("p",{className:"text-sm text-text-secondary font-normal",children:"Siga as instrues para o seu navegador"})]})]})}),a.jsxs("div",{className:"mt-6 space-y-6",children:[(S==="chrome"||S==="edge")&&a.jsxs("div",{className:"bg-gradient-to-br from-brand/10 to-brand/5 rounded-xl p-6 border-2 border-brand/30",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-brand flex items-center justify-center",children:a.jsx(wue,{className:"w-6 h-6 text-black"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold",children:"Chrome (Celular)"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Siga os passos abaixo"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:a.jsxs("div",{className:"flex gap-3 items-start",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-brand text-black flex items-center justify-center font-bold",children:"1"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-semibold mb-2",children:["Toque nos 3 pontinhos ",a.jsx("span",{className:"text-2xl",children:""})]}),a.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"No canto superior direito da tela"}),a.jsx("div",{className:"bg-background/50 rounded-md p-3 border border-border/50",children:a.jsx("p",{className:"text-xs text-text-muted",children:" Os 3 pontinhos ficam ao lado da barra de endereo"})})]})]})}),a.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:a.jsxs("div",{className:"flex gap-3 items-start",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-brand text-black flex items-center justify-center font-bold",children:"2"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold mb-3",children:"Procure uma destas opes:"}),a.jsxs("div",{className:"space-y-2 mb-3",children:[a.jsx("div",{className:"bg-brand/20 rounded-md p-3 border-2 border-brand/40",children:a.jsx("p",{className:"font-bold text-center text-base",children:' "Instalar aplicativo"'})}),a.jsxs("div",{className:"flex items-center justify-center gap-2 text-text-muted text-sm font-medium",children:[a.jsx("div",{className:"h-px bg-border flex-1"}),a.jsx("span",{children:"OU"}),a.jsx("div",{className:"h-px bg-border flex-1"})]}),a.jsx("div",{className:"bg-brand/20 rounded-md p-3 border-2 border-brand/40",children:a.jsx("p",{className:"font-bold text-center text-base",children:' "Adicionar  tela inicial"'})})]}),a.jsx("p",{className:"text-sm text-text-secondary",children:"Toque em qualquer uma dessas opes no menu"})]})]})}),a.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:a.jsxs("div",{className:"flex gap-3 items-start",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-brand text-black flex items-center justify-center font-bold",children:"3"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold mb-2",children:"Confirme a instalao"}),a.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"Aparecer uma janela perguntando se deseja instalar"}),a.jsx("div",{className:"bg-success/10 rounded-md p-3 border border-success/30",children:a.jsx("p",{className:"text-sm font-medium text-center",children:' Toque em "Instalar"'})})]})]})}),a.jsxs("div",{className:"bg-success/5 rounded-lg p-4 border border-success/20",children:[a.jsx("p",{className:"text-sm font-medium text-success mb-1",children:" Pronto!"}),a.jsx("p",{className:"text-xs text-text-secondary",children:"O app aparecer na sua tela inicial e voc poder abri-lo como qualquer outro aplicativo!"})]})]})]}),S==="firefox"&&a.jsxs("div",{className:"bg-gradient-to-br from-orange-500/10 to-orange-500/5 rounded-xl p-6 border-2 border-orange-500/30",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-orange-500 flex items-center justify-center",children:a.jsx($ue,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold",children:"Firefox (Celular)"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Siga os passos abaixo"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:a.jsxs("div",{className:"flex gap-3 items-start",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-orange-500 text-white flex items-center justify-center font-bold",children:"1"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-semibold mb-2",children:["Toque nos 3 pontinhos ",a.jsx("span",{className:"text-2xl",children:""})]}),a.jsx("p",{className:"text-sm text-text-secondary",children:"No canto inferior direito da tela"})]})]})}),a.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:a.jsxs("div",{className:"flex gap-3 items-start",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-orange-500 text-white flex items-center justify-center font-bold",children:"2"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold mb-3",children:"Procure uma destas opes:"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"bg-orange-500/20 rounded-md p-3 border-2 border-orange-500/40",children:a.jsx("p",{className:"font-bold text-center text-base",children:' "Instalar"'})}),a.jsxs("div",{className:"flex items-center justify-center gap-2 text-text-muted text-sm font-medium",children:[a.jsx("div",{className:"h-px bg-border flex-1"}),a.jsx("span",{children:"OU"}),a.jsx("div",{className:"h-px bg-border flex-1"})]}),a.jsx("div",{className:"bg-orange-500/20 rounded-md p-3 border-2 border-orange-500/40",children:a.jsx("p",{className:"font-bold text-center text-base",children:' "Adicionar  tela inicial"'})})]})]})]})}),a.jsxs("div",{className:"bg-success/5 rounded-lg p-4 border border-success/20",children:[a.jsx("p",{className:"text-sm font-medium text-success mb-1",children:" Pronto!"}),a.jsx("p",{className:"text-xs text-text-secondary",children:"O app ser adicionado  sua tela inicial!"})]})]})]}),(S==="safari"||S==="other")&&a.jsxs("div",{className:"bg-gradient-to-br from-purple-500/10 to-purple-500/5 rounded-xl p-6 border-2 border-purple-500/30",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-500 flex items-center justify-center",children:a.jsx(sA,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-bold",children:"Outros Navegadores"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Instrues gerais"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border",children:[a.jsx("p",{className:"font-semibold mb-3",children:"Procure no menu do navegador:"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"bg-purple-500/10 rounded-md p-3 border border-purple-500/30",children:a.jsx("p",{className:"font-medium",children:' "Instalar aplicativo"'})}),a.jsx("div",{className:"bg-purple-500/10 rounded-md p-3 border border-purple-500/30",children:a.jsx("p",{className:"font-medium",children:' "Adicionar  tela inicial"'})}),a.jsx("div",{className:"bg-purple-500/10 rounded-md p-3 border border-purple-500/30",children:a.jsx("p",{className:"font-medium",children:' "Criar atalho"'})})]})]}),a.jsx("div",{className:"bg-background/50 rounded-lg p-4 border border-border/50",children:a.jsx("p",{className:"text-sm text-text-muted",children:" Geralmente a opo est no menu de 3 pontos ou 3 linhas do navegador"})})]})]}),a.jsxs("div",{className:"bg-brand/5 rounded-lg p-4 border border-brand/20",children:[a.jsxs("h4",{className:"font-semibold mb-2 flex items-center gap-2",children:[a.jsx(B2,{className:"w-5 h-5 text-brand"}),"Benefcios do App Instalado"]}),a.jsxs("ul",{className:"space-y-1.5 text-sm text-text-secondary",children:[a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-brand"}),"Acesso rpido direto da rea de trabalho ou menu iniciar"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-brand"}),"Funciona em tela cheia, sem barras do navegador"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-brand"}),"Notificaes e atualizaes automticas"]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-brand"}),"Melhor desempenho e experincia de uso"]})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{onClick:()=>_(!1),className:"px-6 py-2.5 rounded-md bg-surface-2 hover:bg-surface text-text-primary font-medium transition",children:"Entendi"})})]})]})})]})}function Kse(e,t,r,n,s){n=n||{};var o=1.15,i=s.internal.scaleFactor,l=s.internal.getFontSize()/i,c=s.getLineHeightFactor?s.getLineHeightFactor():o,d=l*c,u=/\r\n|\r|\n/g,f="",h=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(f=typeof e=="string"?e.split(u):e,h=f.length||1),r+=l*(2-o),n.valign==="middle"?r-=h/2*d:n.valign==="bottom"&&(r-=h*d),n.halign==="center"||n.halign==="right"){var m=l;if(n.halign==="center"&&(m*=.5),f&&h>=1){for(var v=0;v<f.length;v++)s.text(f[v],t-s.getStringUnitWidth(f[v])*m,r),r+=d;return s}t-=s.getStringUnitWidth(e)*m}return n.halign==="justify"?s.text(e,t,r,{maxWidth:n.maxWidth||100,align:"justify"}):s.text(e,t,r),s}var GU={},wx=function(){function e(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(t,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=t:GU=t},e.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},e.prototype.applyStyles=function(t,r){var n,s,o;r===void 0&&(r=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var i=this.jsPDFDocument.internal.getFont(),l=i.fontStyle,c=i.fontName;if(t.font&&(c=t.font),t.fontStyle){l=t.fontStyle;var d=this.getFontList()[c];d&&d.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(d[0]),l=d[0])}if(this.jsPDFDocument.setFont(c,l),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!r){var u=e.unifyColor(t.fillColor);u&&(n=this.jsPDFDocument).setFillColor.apply(n,u),u=e.unifyColor(t.textColor),u&&(s=this.jsPDFDocument).setTextColor.apply(s,u),u=e.unifyColor(t.lineColor),u&&(o=this.jsPDFDocument).setDrawColor.apply(o,u),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(t,r,n){return this.jsPDFDocument.splitTextToSize(t,r,n)},e.prototype.rect=function(t,r,n,s,o){return this.jsPDFDocument.rect(t,r,n,s,o)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return GU||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e}(),m3=function(e,t){return m3=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])},m3(e,t)};function Xse(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");m3(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Yse=function(e){Xse(t,e);function t(r){var n=e.call(this)||this;return n._element=r,n}return t}(Array);function zst(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function Ust(e){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[e]}function VS(e,t,r){r.applyStyles(t,!0);var n=Array.isArray(e)?e:[e],s=n.map(function(o){return r.getTextWidth(o)}).reduce(function(o,i){return Math.max(o,i)},0);return s}function Jse(e,t,r,n){var s=t.settings.tableLineWidth,o=t.settings.tableLineColor;e.applyStyles({lineWidth:s,lineColor:o});var i=Qse(s,!1);i&&e.rect(r.x,r.y,t.getWidth(e.pageSize().width),n.y-r.y,i)}function Qse(e,t){var r=e>0,n=t||t===0;return r&&n?"DF":r?"S":n?"F":null}function xP(e,t){var r,n,s,o;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=t}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(r=e.left)!==null&&r!==void 0?r:t,top:(n=e.top)!==null&&n!==void 0?n:t,right:(s=e.right)!==null&&s!==void 0?s:t,bottom:(o=e.bottom)!==null&&o!==void 0?o:t}):(typeof e!="number"&&(e=t),{top:e,right:e,bottom:e,left:e})}function Zse(e,t){var r=xP(t.settings.margin,0);return e.pageSize().width-(r.left+r.right)}function Vst(e,t,r,n,s){var o={},i=1.3333333333333333,l=ck(t,function(w){return s.getComputedStyle(w).backgroundColor});l!=null&&(o.fillColor=l);var c=ck(t,function(w){return s.getComputedStyle(w).color});c!=null&&(o.textColor=c);var d=Hst(n,r);d&&(o.cellPadding=d);var u="borderTopColor",f=i*r,h=n.borderTopWidth;if(n.borderBottomWidth===h&&n.borderRightWidth===h&&n.borderLeftWidth===h){var m=(parseFloat(h)||0)/f;m&&(o.lineWidth=m)}else o.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/f,right:(parseFloat(n.borderRightWidth)||0)/f,bottom:(parseFloat(n.borderBottomWidth)||0)/f,left:(parseFloat(n.borderLeftWidth)||0)/f},o.lineWidth.top||(o.lineWidth.right?u="borderRightColor":o.lineWidth.bottom?u="borderBottomColor":o.lineWidth.left&&(u="borderLeftColor"));var v=ck(t,function(w){return s.getComputedStyle(w)[u]});v!=null&&(o.lineColor=v);var g=["left","right","center","justify"];g.indexOf(n.textAlign)!==-1&&(o.halign=n.textAlign),g=["middle","bottom","top"],g.indexOf(n.verticalAlign)!==-1&&(o.valign=n.verticalAlign);var y=parseInt(n.fontSize||"");isNaN(y)||(o.fontSize=y/i);var x=Wst(n);x&&(o.fontStyle=x);var b=(n.fontFamily||"").toLowerCase();return e.indexOf(b)!==-1&&(o.font=b),o}function Wst(e){var t="";return(e.fontWeight==="bold"||e.fontWeight==="bolder"||parseInt(e.fontWeight)>=700)&&(t="bold"),(e.fontStyle==="italic"||e.fontStyle==="oblique")&&(t+="italic"),t}function ck(e,t){var r=eoe(e,t);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var s=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],o=parseInt(n[4]);return o===0||isNaN(s[0])||isNaN(s[1])||isNaN(s[2])?null:s}function eoe(e,t){var r=t(e);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?e.parentElement==null?null:eoe(e.parentElement,t):r}function Hst(e,t){var r=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],n=96/(72/t),s=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,o=r.map(function(l){return parseInt(l||"0")/n}),i=xP(o,0);return s>i.top&&(i.top=s),s>i.bottom&&(i.bottom=s),i}function toe(e,t,r,n,s){var o,i;n===void 0&&(n=!1),s===void 0&&(s=!1);var l;typeof t=="string"?l=r.document.querySelector(t):l=t;var c=Object.keys(e.getFontList()),d=e.scaleFactor(),u=[],f=[],h=[];if(!l)return console.error("Html table could not be found with input: ",t),{head:u,body:f,foot:h};for(var m=0;m<l.rows.length;m++){var v=l.rows[m],g=(i=(o=v?.parentElement)===null||o===void 0?void 0:o.tagName)===null||i===void 0?void 0:i.toLowerCase(),y=Gst(c,d,r,v,n,s);y&&(g==="thead"?u.push(y):g==="tfoot"?h.push(y):f.push(y))}return{head:u,body:f,foot:h}}function Gst(e,t,r,n,s,o){for(var i=new Yse(n),l=0;l<n.cells.length;l++){var c=n.cells[l],d=r.getComputedStyle(c);if(s||d.display!=="none"){var u=void 0;o&&(u=Vst(e,c,t,d,r)),i.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:u,_element:c,content:Kst(c)})}}var f=r.getComputedStyle(n);if(i.length>0&&(s||f.display!=="none"))return i}function Kst(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),t.innerText||t.textContent||""}function Xst(e,t,r){for(var n=0,s=[e,t,r];n<s.length;n++){var o=s[n];o&&typeof o!="object"&&console.error("The options parameter should be of type object, is: "+typeof o),o.startY&&typeof o.startY!="number"&&(console.error("Invalid value for startY option",o.startY),delete o.startY)}}function $f(e,t,r,n,s){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(e),i=1;i<arguments.length;i++){var l=arguments[i];if(l!=null)for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(o[c]=l[c])}return o}function HR(e,t){var r=new wx(e),n=r.getDocumentOptions(),s=r.getGlobalOptions();Xst(s,n,t);var o=$f({},s,n,t),i;typeof window<"u"&&(i=window);var l=Yst(s,n,t),c=Jst(s,n,t),d=Qst(r,o),u=eot(r,o,i);return{id:t.tableId,content:u,hooks:c,styles:l,settings:d}}function Yst(e,t,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},s=function(c){if(c==="columnStyles"){var d=e[c],u=t[c],f=r[c];n.columnStyles=$f({},d,u,f)}else{var h=[e,t,r],m=h.map(function(v){return v[c]||{}});n[c]=$f({},m[0],m[1],m[2])}},o=0,i=Object.keys(n);o<i.length;o++){var l=i[o];s(l)}return n}function Jst(e,t,r){for(var n=[e,t,r],s={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},o=0,i=n;o<i.length;o++){var l=i[o];l.didParseCell&&s.didParseCell.push(l.didParseCell),l.willDrawCell&&s.willDrawCell.push(l.willDrawCell),l.didDrawCell&&s.didDrawCell.push(l.didDrawCell),l.willDrawPage&&s.willDrawPage.push(l.willDrawPage),l.didDrawPage&&s.didDrawPage.push(l.didDrawPage)}return s}function Qst(e,t){var r,n,s,o,i,l,c,d,u,f,h,m,v=xP(t.margin,40/e.scaleFactor()),g=(r=Zst(e,t.startY))!==null&&r!==void 0?r:v.top,y;t.showFoot===!0?y="everyPage":t.showFoot===!1?y="never":y=(n=t.showFoot)!==null&&n!==void 0?n:"everyPage";var x;t.showHead===!0?x="everyPage":t.showHead===!1?x="never":x=(s=t.showHead)!==null&&s!==void 0?s:"everyPage";var b=(o=t.useCss)!==null&&o!==void 0?o:!1,w=t.theme||(b?"plain":"striped"),j=!!t.horizontalPageBreak,_=(i=t.horizontalPageBreakRepeat)!==null&&i!==void 0?i:null;return{includeHiddenHtml:(l=t.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:b,theme:w,startY:g,margin:v,pageBreak:(c=t.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(d=t.rowPageBreak)!==null&&d!==void 0?d:"auto",tableWidth:(u=t.tableWidth)!==null&&u!==void 0?u:"auto",showHead:x,showFoot:y,tableLineWidth:(f=t.tableLineWidth)!==null&&f!==void 0?f:0,tableLineColor:(h=t.tableLineColor)!==null&&h!==void 0?h:200,horizontalPageBreak:j,horizontalPageBreakRepeat:_,horizontalPageBreakBehaviour:(m=t.horizontalPageBreakBehaviour)!==null&&m!==void 0?m:"afterAllRows"}}function Zst(e,t){var r=e.getLastAutoTable(),n=e.scaleFactor(),s=e.pageNumber(),o=!1;if(r&&r.startPageNumber){var i=r.startPageNumber+r.pageNumber-1;o=i===s}return typeof t=="number"?t:(t==null||t===!1)&&o&&r?.finalY!=null?r.finalY+20/n:null}function eot(e,t,r){var n=t.head||[],s=t.body||[],o=t.foot||[];if(t.html){var i=t.includeHiddenHtml;if(r){var l=toe(e,t.html,r,i,t.useCss)||{};n=l.head||n,s=l.body||n,o=l.foot||n}else console.error("Cannot parse html in non browser environment")}var c=t.columns||tot(n,s,o);return{columns:c,head:n,body:s,foot:o}}function tot(e,t,r){var n=e[0]||t[0]||r[0]||[],s=[];return Object.keys(n).filter(function(o){return o!=="_element"}).forEach(function(o){var i=1,l;Array.isArray(n)?l=n[parseInt(o)]:l=n[o],typeof l=="object"&&!Array.isArray(l)&&(i=l?.colSpan||1);for(var c=0;c<i;c++){var d=void 0;Array.isArray(n)?d=s.length:d=o+(c>0?"_".concat(c):"");var u={dataKey:d};s.push(u)}}),s}var WS=function(){function e(t,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=t.getDocument()}return e}(),roe=function(e){Xse(t,e);function t(r,n,s,o,i,l){var c=e.call(this,r,n,l)||this;return c.cell=s,c.row=o,c.column=i,c.section=o.section,c}return t}(WS),noe=function(){function e(t,r){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return e.prototype.getHeadHeight=function(t){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.getFootHeight=function(t){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(t,r,n,s,o,i){for(var l=0,c=r;l<c.length;l++){var d=c[l],u=new roe(t,this,n,s,o,i),f=d(u)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],f)return!1}return!0},e.prototype.callEndPageHooks=function(t,r){t.applyStyles(t.userStyles);for(var n=0,s=this.hooks.didDrawPage;n<s.length;n++){var o=s[n];o(new WS(t,this,r))}},e.prototype.callWillDrawPageHooks=function(t,r){for(var n=0,s=this.hooks.willDrawPage;n<s.length;n++){var o=s[n];o(new WS(t,this,r))}},e.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(s,o){return s+o.wrappedWidth},0);return r}else{var n=this.settings.margin;return t-n.left-n.right}},e}(),GR=function(){function e(t,r,n,s,o){o===void 0&&(o=!1),this.height=0,this.raw=t,t instanceof Yse&&(this.raw=t._element,this.element=t._element),this.index=r,this.section=n,this.cells=s,this.spansMultiplePages=o}return e.prototype.getMaxCellHeight=function(t){var r=this;return t.reduce(function(n,s){var o;return Math.max(n,((o=r.cells[s.index])===null||o===void 0?void 0:o.height)||0)},0)},e.prototype.hasRowSpan=function(t){var r=this;return t.filter(function(n){var s=r.cells[n.index];return s?s.rowSpan>1:!1}).length>0},e.prototype.canEntireRowFit=function(t,r){return this.getMaxCellHeight(r)<=t},e.prototype.getMinimumRowHeight=function(t,r){var n=this;return t.reduce(function(s,o){var i=n.cells[o.index];if(!i)return 0;var l=r.getLineHeight(i.styles.fontSize),c=i.padding("vertical"),d=c+l;return d>s?d:s},0)},e}(),KR=function(){function e(t,r,n){var s;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=t;var o=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,o=(s=t.content)!==null&&s!==void 0?s:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var i=o!=null?""+o:"",l=/\r\n|\r|\n/g;this.text=i.split(l)}return e.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");t=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var s=this.width-this.padding("horizontal");n=this.x+s/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:t}},e.prototype.getContentHeight=function(t,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,s=this.styles.fontSize/t*r,o=n*s+this.padding("vertical");return Math.max(o,this.styles.minCellHeight)},e.prototype.padding=function(t){var r=xP(this.styles.cellPadding,0);return t==="vertical"?r.top+r.bottom:t==="horizontal"?r.left+r.right:r[t]},e}(),aoe=function(){function e(t,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=r,this.index=n}return e.prototype.getMaxCustomCellWidth=function(t){for(var r=0,n=0,s=t.allRows();n<s.length;n++){var o=s[n],i=o.cells[this.index];i&&typeof i.styles.cellWidth=="number"&&(r=Math.max(r,i.styles.cellWidth))}return r},e}();function rot(e,t){not(e,t);var r=[],n=0;t.columns.forEach(function(o){var i=o.getMaxCustomCellWidth(t);i?o.width=i:(o.width=o.wrappedWidth,r.push(o)),n+=o.width});var s=t.getWidth(e.pageSize().width)-n;s&&(s=h3(r,s,function(o){return Math.max(o.minReadableWidth,o.minWidth)})),s&&(s=h3(r,s,function(o){return o.minWidth})),s=Math.abs(s),!t.settings.horizontalPageBreak&&s>.1/e.scaleFactor()&&(s=s<1?s:Math.round(s),console.warn("Of the table content, ".concat(s," units width could not fit page"))),sot(t),oot(t,e),aot(t)}function not(e,t){var r=e.scaleFactor(),n=t.settings.horizontalPageBreak,s=Zse(e,t);t.allRows().forEach(function(o){for(var i=0,l=t.columns;i<l.length;i++){var c=l[i],d=o.cells[c.index];if(d){var u=t.hooks.didParseCell;t.callCellHooks(e,u,d,o,c,null);var f=d.padding("horizontal");d.contentWidth=VS(d.text,d.styles,e)+f;var h=VS(d.text.join(" ").split(/[^\S\u00A0]+/),d.styles,e);if(d.minReadableWidth=h+d.padding("horizontal"),typeof d.styles.cellWidth=="number")d.minWidth=d.styles.cellWidth,d.wrappedWidth=d.styles.cellWidth;else if(d.styles.cellWidth==="wrap"||n===!0)d.contentWidth>s?(d.minWidth=s,d.wrappedWidth=s):(d.minWidth=d.contentWidth,d.wrappedWidth=d.contentWidth);else{var m=10/r;d.minWidth=d.styles.minCellWidth||m,d.wrappedWidth=d.contentWidth,d.minWidth>d.wrappedWidth&&(d.wrappedWidth=d.minWidth)}}}}),t.allRows().forEach(function(o){for(var i=0,l=t.columns;i<l.length;i++){var c=l[i],d=o.cells[c.index];if(d&&d.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,d.wrappedWidth),c.minWidth=Math.max(c.minWidth,d.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,d.minReadableWidth);else{var u=t.styles.columnStyles[c.dataKey]||t.styles.columnStyles[c.index]||{},f=u.cellWidth||u.minCellWidth;f&&typeof f=="number"&&(c.minWidth=f,c.wrappedWidth=f)}d&&(d.colSpan>1&&!c.minWidth&&(c.minWidth=d.minWidth),d.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=d.minWidth))}})}function h3(e,t,r){for(var n=t,s=e.reduce(function(m,v){return m+v.wrappedWidth},0),o=0;o<e.length;o++){var i=e[o],l=i.wrappedWidth/s,c=n*l,d=i.width+c,u=r(i),f=d<u?u:d;t-=f-i.width,i.width=f}if(t=Math.round(t*1e10)/1e10,t){var h=e.filter(function(m){return t<0?m.width>r(m):!0});h.length&&(t=h3(h,t,r))}return t}function aot(e){for(var t={},r=1,n=e.allRows(),s=0;s<n.length;s++)for(var o=n[s],i=0,l=e.columns;i<l.length;i++){var c=l[i],d=t[c.index];if(r>1)r--,delete o.cells[c.index];else if(d)d.cell.height+=o.height,r=d.cell.colSpan,delete o.cells[c.index],d.left--,d.left<=1&&delete t[c.index];else{var u=o.cells[c.index];if(!u)continue;if(u.height=o.height,u.rowSpan>1){var f=n.length-s,h=u.rowSpan>f?f:u.rowSpan;t[c.index]={cell:u,left:h,row:o}}}}}function sot(e){for(var t=e.allRows(),r=0;r<t.length;r++)for(var n=t[r],s=null,o=0,i=0,l=0;l<e.columns.length;l++){var c=e.columns[l];if(i-=1,i>1&&e.columns[l+1])o+=c.width,delete n.cells[c.index];else if(s){var d=s;delete n.cells[c.index],s=null,d.width=c.width+o}else{var d=n.cells[c.index];if(!d)continue;if(i=d.colSpan,o=0,d.colSpan>1){s=d,o+=c.width;continue}d.width=c.width+o}}}function oot(e,t){for(var r={count:0,height:0},n=0,s=e.allRows();n<s.length;n++){for(var o=s[n],i=0,l=e.columns;i<l.length;i++){var c=l[i],d=o.cells[c.index];if(d){t.applyStyles(d.styles,!0);var u=d.width-d.padding("horizontal");if(d.styles.overflow==="linebreak")d.text=t.splitTextToSize(d.text,u+1/t.scaleFactor(),{fontSize:d.styles.fontSize});else if(d.styles.overflow==="ellipsize")d.text=KU(d.text,u,d.styles,t,"...");else if(d.styles.overflow==="hidden")d.text=KU(d.text,u,d.styles,t,"");else if(typeof d.styles.overflow=="function"){var f=d.styles.overflow(d.text,u);typeof f=="string"?d.text=[f]:d.text=f}d.contentHeight=d.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var h=d.contentHeight/d.rowSpan;d.rowSpan>1&&r.count*r.height<h*d.rowSpan?r={height:h,count:d.rowSpan}:r&&r.count>0&&r.height>h&&(h=r.height),h>o.height&&(o.height=h)}}r.count--}}function KU(e,t,r,n,s){return e.map(function(o){return iot(o,t,r,n,s)})}function iot(e,t,r,n,s){var o=1e4*n.scaleFactor();if(t=Math.ceil(t*o)/o,t>=VS(e,r,n))return e;for(;t<VS(e+s,r,n)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+s}function XR(e,t){var r=new wx(e),n=lot(t,r.scaleFactor()),s=new noe(t,n);return rot(r,s),r.applyStyles(r.userStyles),s}function lot(e,t){var r=e.content,n=dot(r.columns);if(r.head.length===0){var s=XU(n,"head");s&&r.head.push(s)}if(r.foot.length===0){var s=XU(n,"foot");s&&r.foot.push(s)}var o=e.settings.theme,i=e.styles;return{columns:n,head:dk("head",r.head,n,i,o,t),body:dk("body",r.body,n,i,o,t),foot:dk("foot",r.foot,n,i,o,t)}}function dk(e,t,r,n,s,o){var i={},l=t.map(function(c,d){for(var u=0,f={},h=0,m=0,v=0,g=r;v<g.length;v++){var y=g[v];if(i[y.index]==null||i[y.index].left===0)if(m===0){var x=void 0;Array.isArray(c)?x=c[y.index-h-u]:x=c[y.dataKey];var b={};typeof x=="object"&&!Array.isArray(x)&&(b=x?.styles||{});var w=uot(e,y,d,s,n,o,b),j=new KR(x,w,e);f[y.dataKey]=j,f[y.index]=j,m=j.colSpan-1,i[y.index]={left:j.rowSpan-1,times:m}}else m--,h++;else i[y.index].left--,m=i[y.index].times,u++}return new GR(c,d,e,f)});return l}function XU(e,t){var r={};return e.forEach(function(n){if(n.raw!=null){var s=cot(t,n.raw);s!=null&&(r[n.dataKey]=s)}}),Object.keys(r).length>0?r:null}function cot(e,t){if(e==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(e==="foot"&&typeof t=="object")return t.footer;return null}function dot(e){return e.map(function(t,r){var n,s;return typeof t=="object"?s=(n=t.dataKey)!==null&&n!==void 0?n:r:s=r,new aoe(s,t,r)})}function uot(e,t,r,n,s,o,i){var l=Ust(n),c;e==="head"?c=s.headStyles:e==="body"?c=s.bodyStyles:e==="foot"&&(c=s.footStyles);var d=$f({},l.table,l[e],s.styles,c),u=s.columnStyles[t.dataKey]||s.columnStyles[t.index]||{},f=e==="body"?u:{},h=e==="body"&&r%2===0?$f({},l.alternateRow,s.alternateRowStyles):{},m=zst(o),v=$f({},m,d,h,f);return $f(v,i)}function fot(e,t,r){var n;r===void 0&&(r={});var s=Zse(e,t),o=new Map,i=[],l=[],c=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?c=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(c=[t.settings.horizontalPageBreakRepeat]),c.forEach(function(h){var m=t.columns.find(function(v){return v.dataKey===h||v.index===h});m&&!o.has(m.index)&&(o.set(m.index,!0),i.push(m.index),l.push(t.columns[m.index]),s-=m.wrappedWidth)});for(var d=!0,u=(n=r?.start)!==null&&n!==void 0?n:0;u<t.columns.length;){if(o.has(u)){u++;continue}var f=t.columns[u].wrappedWidth;if(d||s>=f)d=!1,i.push(u),l.push(t.columns[u]),s-=f;else break;u++}return{colIndexes:i,columns:l,lastIndex:u-1}}function mot(e,t){for(var r=[],n=0;n<t.columns.length;n++){var s=fot(e,t,{start:n});s.columns.length&&(r.push(s),n=s.lastIndex)}return r}function YR(e,t){var r=t.settings,n=r.startY,s=r.margin,o={x:s.left,y:n},i=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),l=n+s.bottom+i;if(r.pageBreak==="avoid"){var c=t.body,d=c.reduce(function(h,m){return h+m.height},0);l+=d}var u=new wx(e);(r.pageBreak==="always"||r.startY!=null&&l>u.pageSize().height)&&(ooe(u),o.y=s.top),t.callWillDrawPageHooks(u,o);var f=$f({},o);t.startPageNumber=u.pageNumber(),r.horizontalPageBreak?hot(u,t,f,o):(u.applyStyles(u.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&t.head.forEach(function(h){return sm(u,t,h,o,t.columns)}),u.applyStyles(u.userStyles),t.body.forEach(function(h,m){var v=m===t.body.length-1;HS(u,t,h,v,f,o,t.columns)}),u.applyStyles(u.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&t.foot.forEach(function(h){return sm(u,t,h,o,t.columns)})),Jse(u,t,f,o),t.callEndPageHooks(u,o),t.finalY=o.y,e.lastAutoTable=t,u.applyStyles(u.userStyles)}function hot(e,t,r,n){var s=mot(e,t),o=t.settings;if(o.horizontalPageBreakBehaviour==="afterAllRows")s.forEach(function(d,u){e.applyStyles(e.userStyles),u>0?Db(e,t,r,n,d.columns,!0):YU(e,t,n,d.columns),pot(e,t,r,n,d.columns),uk(e,t,n,d.columns)});else for(var i=-1,l=s[0],c=function(){var d=i;if(l){e.applyStyles(e.userStyles);var u=l.columns;i>=0?Db(e,t,r,n,u,!0):YU(e,t,n,u),d=JU(e,t,i+1,n,u),uk(e,t,n,u)}var f=d-i;s.slice(1).forEach(function(h){e.applyStyles(e.userStyles),Db(e,t,r,n,h.columns,!0),JU(e,t,i+1,n,h.columns,f),uk(e,t,n,h.columns)}),i=d};i<t.body.length-1;)c()}function YU(e,t,r,n){var s=t.settings;e.applyStyles(e.userStyles),(s.showHead==="firstPage"||s.showHead==="everyPage")&&t.head.forEach(function(o){return sm(e,t,o,r,n)})}function pot(e,t,r,n,s){e.applyStyles(e.userStyles),t.body.forEach(function(o,i){var l=i===t.body.length-1;HS(e,t,o,l,r,n,s)})}function JU(e,t,r,n,s,o){e.applyStyles(e.userStyles),o=o??t.body.length;var i=Math.min(r+o,t.body.length),l=-1;return t.body.slice(r,i).forEach(function(c,d){var u=r+d===t.body.length-1,f=soe(e,t,u,n);c.canEntireRowFit(f,s)&&(sm(e,t,c,n,s),l=r+d)}),l}function uk(e,t,r,n){var s=t.settings;e.applyStyles(e.userStyles),(s.showFoot==="lastPage"||s.showFoot==="everyPage")&&t.foot.forEach(function(o){return sm(e,t,o,r,n)})}function got(e,t,r){var n=r.getLineHeight(e.styles.fontSize),s=e.padding("vertical"),o=Math.floor((t-s)/n);return Math.max(0,o)}function vot(e,t,r,n){var s={};e.spansMultiplePages=!0,e.height=0;for(var o=0,i=0,l=r.columns;i<l.length;i++){var c=l[i],d=e.cells[c.index];if(d){Array.isArray(d.text)||(d.text=[d.text]);var u=new KR(d.raw,d.styles,d.section);u=$f(u,d),u.text=[];var f=got(d,t,n);d.text.length>f&&(u.text=d.text.splice(f,d.text.length));var h=n.scaleFactor(),m=n.getLineHeightFactor();d.contentHeight=d.getContentHeight(h,m),d.contentHeight>=t&&(d.contentHeight=t,u.styles.minCellHeight-=t),d.contentHeight>e.height&&(e.height=d.contentHeight),u.contentHeight=u.getContentHeight(h,m),u.contentHeight>o&&(o=u.contentHeight),s[c.index]=u}}var v=new GR(e.raw,-1,e.section,s,!0);v.height=o;for(var g=0,y=r.columns;g<y.length;g++){var c=y[g],u=v.cells[c.index];u&&(u.height=v.height);var d=e.cells[c.index];d&&(d.height=e.height)}return v}function xot(e,t,r,n){var s=e.pageSize().height,o=n.settings.margin,i=o.top+o.bottom,l=s-i;t.section==="body"&&(l-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=t.getMinimumRowHeight(n.columns,e),d=c<r;if(c>l)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!d)return!1;var u=t.hasRowSpan(n.columns),f=t.getMaxCellHeight(n.columns)>l;return f?(u&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(u||n.settings.rowPageBreak==="avoid")}function HS(e,t,r,n,s,o,i){var l=soe(e,t,n,o);if(r.canEntireRowFit(l,i))sm(e,t,r,o,i);else if(xot(e,r,l,t)){var c=vot(r,l,t,e);sm(e,t,r,o,i),Db(e,t,s,o,i),HS(e,t,c,n,s,o,i)}else Db(e,t,s,o,i),HS(e,t,r,n,s,o,i)}function sm(e,t,r,n,s){n.x=t.settings.margin.left;for(var o=0,i=s;o<i.length;o++){var l=i[o],c=r.cells[l.index];if(!c){n.x+=l.width;continue}e.applyStyles(c.styles),c.x=n.x,c.y=n.y;var d=t.callCellHooks(e,t.hooks.willDrawCell,c,r,l,n);if(d===!1){n.x+=l.width;continue}yot(e,c,n);var u=c.getTextPos();Kse(c.text,u.x,u.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,c,r,l,n),n.x+=l.width}n.y+=r.height}function yot(e,t,r){var n=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),typeof n.lineWidth=="number"){var s=Qse(n.lineWidth,n.fillColor);s&&e.rect(t.x,r.y,t.width,t.height,s)}else typeof n.lineWidth=="object"&&(n.fillColor&&e.rect(t.x,r.y,t.width,t.height,"F"),bot(e,t,r,n.lineWidth))}function bot(e,t,r,n){var s,o,i,l;n.top&&(s=r.x,o=r.y,i=r.x+t.width,l=r.y,n.right&&(i+=.5*n.right),n.left&&(s-=.5*n.left),c(n.top,s,o,i,l)),n.bottom&&(s=r.x,o=r.y+t.height,i=r.x+t.width,l=r.y+t.height,n.right&&(i+=.5*n.right),n.left&&(s-=.5*n.left),c(n.bottom,s,o,i,l)),n.left&&(s=r.x,o=r.y,i=r.x,l=r.y+t.height,n.top&&(o-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.left,s,o,i,l)),n.right&&(s=r.x+t.width,o=r.y,i=r.x+t.width,l=r.y+t.height,n.top&&(o-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.right,s,o,i,l));function c(d,u,f,h,m){e.getDocument().setLineWidth(d),e.getDocument().line(u,f,h,m,"S")}}function soe(e,t,r,n){var s=t.settings.margin.bottom,o=t.settings.showFoot;return(o==="everyPage"||o==="lastPage"&&r)&&(s+=t.getFootHeight(t.columns)),e.pageSize().height-n.y-s}function Db(e,t,r,n,s,o){s===void 0&&(s=[]),o===void 0&&(o=!1),e.applyStyles(e.userStyles),t.settings.showFoot==="everyPage"&&!o&&t.foot.forEach(function(l){return sm(e,t,l,n,s)}),t.callEndPageHooks(e,n);var i=t.settings.margin;Jse(e,t,r,n),ooe(e),t.pageNumber++,n.x=i.left,n.y=i.top,r.y=i.top,t.callWillDrawPageHooks(e,n),t.settings.showHead==="everyPage"&&(t.head.forEach(function(l){return sm(e,t,l,n,s)}),e.applyStyles(e.userStyles))}function ooe(e){var t=e.pageNumber();e.setPage(t+1);var r=e.pageNumber();return r===t?(e.addPage(),!0):!1}function ioe(e){e.API.autoTable=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t[0],s=HR(this,n),o=XR(this,s);return YR(this,o),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(t,r,n,s){Kse(t,r,n,s,this)},e.API.autoTableSetDefaults=function(t){return wx.setDefaults(t,this),this},e.autoTableSetDefaults=function(t,r){wx.setDefaults(t,r)},e.API.autoTableHtmlToJson=function(t,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var s=new wx(this),o=toe(s,t,window,r,!1),i=o.head,l=o.body,c=((n=i[0])===null||n===void 0?void 0:n.map(function(d){return d.content}))||[];return{columns:c,rows:l,data:l}}}var fk;function QU(e,t){var r=HR(e,t),n=XR(e,r);YR(e,n)}function wot(e,t){var r=HR(e,t);return XR(e,r)}function jot(e,t){YR(e,t)}try{if(typeof window<"u"&&window){var ZU=window,eV=ZU.jsPDF||((fk=ZU.jspdf)===null||fk===void 0?void 0:fk.jsPDF);eV&&ioe(eV)}}catch(e){console.error("Could not apply autoTable plugin",e)}const _ot=Object.freeze(Object.defineProperty({__proto__:null,Cell:KR,CellHookData:roe,Column:aoe,HookData:WS,Row:GR,Table:noe,__createTable:wot,__drawTable:jot,applyPlugin:ioe,autoTable:QU,default:QU},Symbol.toStringTag,{value:"Module"})),Not={hidden:{opacity:0},visible:{opacity:1,transition:{when:"beforeChildren",staggerChildren:.08,delayChildren:.1}}},xl={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}};function Rj({icon:e,label:t,value:r,delta:n,positive:s=!0,color:o="brand"}){return a.jsxs(xr.div,{variants:xl,className:"fx-card border-0 ring-0 outline-none shadow-none",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider",children:[a.jsx(e,{className:`w-4 h-4 text-${o}`}),a.jsx("span",{children:t})]}),n!=null&&a.jsxs("div",{className:`text-xs font-bold ${s?"text-success":"text-danger"}`,children:[s?"+":"",n]})]}),a.jsx("div",{className:"text-3xl font-bold text-text-primary tabular-nums",children:r})]})}function Sot(){const{toast:e}=Qa(),{userProfile:t}=ms(),[r,n]=hC(),[s,o]=p.useState(r.get("tab")||"visao-geral"),[i,l]=p.useState(!1),[c,d]=p.useState(()=>{const se=new Date;return new Date(se.getFullYear(),se.getMonth(),1).toISOString().slice(0,10)}),[u,f]=p.useState(()=>new Date().toISOString().slice(0,10)),[h,m]=p.useState(null),[v,g]=p.useState(0),[y,x]=p.useState(0),[b,w]=p.useState([]),[j,_]=p.useState([]),[S,C]=p.useState([]),[P,A]=p.useState([]),[R,O]=p.useState([]),[I,M]=p.useState(0),[D,U]=p.useState(0),[z,W]=p.useState(!1),[$,X]=p.useState(!1),[ye,Se]=p.useState(null),[V,B]=p.useState([]),[Q,pe]=p.useState(!1),[te,Y]=p.useState(!1),[ce,me]=p.useState(!1),[ae,le]=p.useState(null),[ue,Re]=p.useState([]),[ne,ie]=p.useState([]);p.useState({open:!1,tipo:"suprimento",valor:"",observacao:"",loading:!1});const[gt,bt]=p.useState(!1),[at,xt]=p.useState(!1),[Ze,ht]=p.useState(null),[Wt,be]=p.useState([]),[Ct,wt]=p.useState(""),[Ge,Je]=p.useState("all"),[_e,je]=p.useState("all"),[Ue,ze]=p.useState([]),[or,tr]=p.useState(""),[Nt,yr]=p.useState("all"),[Me,dt]=p.useState("all"),[ut,rr]=p.useState(new Set),[hr,It]=p.useState(!1),[dr,ur]=p.useState(!1),[er,ln]=p.useState(null),[Mr,Ye]=p.useState([]),[$e,Be]=p.useState(!1),[et,jt]=p.useState([]);p.useState("");const yt=se=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(se||0)),qt=se=>Number(se||0).toFixed(2),pt=async(se,He,ot,ee)=>{try{const{default:k}=await ef(()=>Promise.resolve().then(()=>tZe),void 0);await ef(()=>Promise.resolve().then(()=>_ot),void 0);const T=new k("p","mm","a4"),K=T.internal.pageSize.getWidth();if(T.setFontSize(20),T.setTextColor(245,158,11),T.text(se,14,20),T.setDrawColor(245,158,11),T.setLineWidth(.5),T.line(14,23,K-14,23),T.setFontSize(10),T.setTextColor(100,100,100),T.text(`Perodo: ${c||"N/A"} at ${u||"N/A"}`,14,30),T.text(`Gerado em: ${new Date().toLocaleString("pt-BR")}`,14,35),typeof T.autoTable=="function"){T.autoTable({head:[He],body:ot,startY:42,theme:"striped",headStyles:{fillColor:[245,158,11],textColor:[255,255,255],fontStyle:"bold",fontSize:11},bodyStyles:{fontSize:10,textColor:[50,50,50]},alternateRowStyles:{fillColor:[249,249,249]},margin:{top:42,left:14,right:14}});const H=T.lastAutoTable.finalY||50;T.setFontSize(8),T.setTextColor(150,150,150),T.text("Relatrio gerado por Fluxo7Arena - Sistema de Gesto de Quadras Esportivas",K/2,H+15,{align:"center"})}else{let H=45;T.setFontSize(11),T.setTextColor(0,0,0),He.forEach((F,Le)=>{const it=14+Le*60;T.text(F,it,H)}),H+=7,T.setFontSize(10),ot.forEach(F=>{F.forEach((Le,it)=>{const lt=14+it*60;T.text(String(Le),lt,H)}),H+=6})}T.save(`${ee}_${cr(new Date,"yyyy-MM-dd")}.pdf`),e({title:"PDF baixado com sucesso!",description:"O arquivo foi salvo na sua pasta de downloads"})}catch(k){console.error("Erro ao gerar PDF:",k),e({title:"Erro ao gerar PDF",description:k.message,variant:"destructive"})}},Dt=async()=>{try{const se=["Abertura","Fechamento","Saldo Inicial","Saldo Final","Valor Final (Dinheiro)","Diferena","Status"],He=(ne||[]).map(ot=>[ot?.aberto_em?new Date(ot.aberto_em).toLocaleString("pt-BR"):"-",ot?.fechado_em?new Date(ot.fechado_em).toLocaleString("pt-BR"):"-",yt(ot?.saldo_inicial||0),ot?.saldo_final!=null?yt(ot.saldo_final):yt(0),ot?.valor_final_dinheiro!=null?yt(ot.valor_final_dinheiro):"",ot?.diferenca_dinheiro!=null?yt(ot.diferenca_dinheiro):"",String(ot?.status||"").toUpperCase()]);await pt("Fechamentos de Caixa",se,He,"fechamentos_caixa")}catch(se){e({title:"Erro ao exportar PDF",description:se?.message||"Tente novamente",variant:"destructive"})}},he=()=>{try{const se=";",ot=[["Abertura","Fechamento","Saldo Inicial","Saldo Final","Valor Final (Dinheiro)","Diferena","Status"].join(se)];(ne||[]).forEach(K=>{const H=K?.aberto_em?new Date(K.aberto_em).toLocaleString("pt-BR"):"-",F=K?.fechado_em?new Date(K.fechado_em).toLocaleString("pt-BR"):"-",Le=Number(K?.saldo_inicial||0).toFixed(2).replace(".",","),it=(K?.saldo_final!=null?Number(K.saldo_final):0).toFixed(2).replace(".",","),lt=K?.valor_final_dinheiro!=null?Number(K.valor_final_dinheiro):null,Vt=K?.diferenca_dinheiro!=null?Number(K.diferenca_dinheiro):null,Ve=String(K?.status||"").toUpperCase();ot.push([H,F,Le,it,lt!=null?lt.toFixed(2).replace(".",","):"",Vt!=null?Vt.toFixed(2).replace(".",","):"",Ve].join(se))});const ee=new Blob(["\uFEFF"+ot.join(`
`)],{type:"text/csv;charset=utf-8;"}),k=URL.createObjectURL(ee),T=document.createElement("a");T.href=k,T.download=`fechamentos_caixa_${new Date().toISOString().slice(0,10)}.csv`,document.body.appendChild(T),T.click(),document.body.removeChild(T),URL.revokeObjectURL(k),e({title:"CSV baixado com sucesso!"})}catch(se){e({title:"Erro ao exportar CSV",description:se?.message||"Tente novamente",variant:"destructive"})}},Qe=({cx:se,cy:He,midAngle:ot,outerRadius:ee,percent:k})=>{const T=Math.PI/180,K=(ee||0)+12,H=se+K*Math.cos(-ot*T),F=He+K*Math.sin(-ot*T);return a.jsx("text",{x:H,y:F,fill:"#fff",textAnchor:H>se?"start":"end",dominantBaseline:"central",style:{pointerEvents:"none",fontSize:15,fontWeight:700},children:`${Math.round((k||0)*100)}%`})},zt=se=>{const He=$t!=null&&$t!==se;return{transition:"opacity 320ms ease-in-out, filter 320ms ease-in-out",opacity:He?.25:1,filter:He?"grayscale(15%)":"none",cursor:"pointer"}};p.useEffect(()=>{(async()=>{if(!dr||!er||er.origem!=="Comanda"||!er.comanda_id){Ye([]),jt([]);return}try{Be(!0);const He=t?.codigo_empresa;let ot=de.from("comanda_itens").select("descricao, quantidade, preco_unitario").eq("comanda_id",er.comanda_id);He&&(ot=ot.eq("codigo_empresa",He));const{data:ee}=await ot;Ye(ee||[]);let k=de.from("pagamentos").select("id, valor, metodo, status, finalizadoras!pagamentos_finalizadora_id_fkey(nome)").eq("comanda_id",er.comanda_id);He&&(k=k.eq("codigo_empresa",He));const{data:T}=await k;jt(T||[])}catch(He){console.warn("[Financeiro][RecebimentoModal] Falha ao carregar itens da comanda:",He?.message),Ye([]),jt([])}finally{Be(!1)}})()},[dr,er,t?.codigo_empresa]);const Mt=async()=>{try{l(!0);const se=Ft(c)||void 0,He=Dr(u)||void 0,ot=t?.codigo_empresa;console.debug("[Financeiro][VisaoGeral] Carregando com perodo:",{fromISO:se,toISO:He,codigo:ot});const ee=await Nd({from:se,to:He}).catch(()=>null);m(ee||{totalPorFinalizadora:{},totalEntradas:0,totalVendasBrutas:0,totalDescontos:0,totalVendasLiquidas:0}),console.debug("[Financeiro][VisaoGeral] Resumo calculado:",ee);try{let k=de.from("pagamentos").select("valor, status").eq("codigo_empresa",ot);se&&(k=k.gte("recebido_em",se)),He&&(k=k.lte("recebido_em",He));const{data:T}=await k,K=(T||[]).reduce((it,lt)=>{const Vt=lt.status||"Pago";return Vt==="Cancelado"||Vt==="Estornado"?it:it+Number(lt.valor||0)},0);g(K);let H=de.from("agendamentos").select("id").eq("codigo_empresa",ot);se&&(H=H.gte("inicio",se)),He&&(H=H.lte("inicio",He));const{data:F}=await H;let Le=0;if(F&&F.length>0){const it=F.map(Vt=>Vt.id),{data:lt}=await de.from("agendamento_participantes").select("valor_cota, aplicar_taxa, finalizadoras!agp_finalizadora_id_fkey(taxa_percentual)").eq("codigo_empresa",ot).in("agendamento_id",it).eq("status_pagamento","Pago");Le=(lt||[]).reduce((Vt,Ve)=>{let kt=Number(Ve.valor_cota||0);if(Ve.aplicar_taxa===!0){const Sr=Number(Ve.finalizadoras?.taxa_percentual||0);Sr>0&&(kt=kt/(1+Sr/100))}return Vt+kt},0)}x(Le),console.debug("[Financeiro][VisaoGeral] Receitas por origem:",{totalComandas:K,totalAg:Le})}catch(k){console.warn("[Financeiro][VisaoGeral] Falha ao calcular KPIs por origem:",k?.message),g(0),x(0)}try{let k=de.from("pagamentos").select("valor, status, origem").eq("codigo_empresa",ot).eq("origem","xml");se&&(k=k.gte("recebido_em",se)),He&&(k=k.lte("recebido_em",He));const{data:T}=await k,K=(T||[]).reduce((F,Le)=>["Cancelado","Estornado"].includes(Le.status)?F:F+Number(Le.valor||0),0);M(K);const{count:H}=await de.from("produtos").select("id",{count:"exact",head:!0}).eq("codigo_empresa",ot).or("importado_via_xml.is.true,categoria.ilike.Importados").gte("criado_em",se).lte("criado_em",He);U(H||0)}catch(k){console.warn("[Financeiro][VisaoGeral] Falha KPIs XML:",k?.message),M(0),U(0)}if(ot){let k=de.from("comandas").select("id").eq("status","closed");ot&&(k=k.eq("codigo_empresa",ot)),se&&(k=k.gte("fechado_em",se)),He&&(k=k.lte("fechado_em",He));const{data:T,error:K}=await k;if(K)throw K;const H=(T||[]).map(lt=>lt.id);console.debug("[Financeiro][VisaoGeral] Comandas fechadas:",H.length);let F=[];if(H.length>0){let lt=de.from("comanda_itens").select("produto_id, quantidade, preco_unitario, produtos!comanda_itens_produto_id_fkey(nome)").in("comanda_id",H);ot&&(lt=lt.eq("codigo_empresa",ot));const{data:Vt}=await lt;F=Vt||[]}const Le={};(F||[]).forEach(lt=>{const Vt=lt.produtos?.nome||"Produto sem nome",Ve=Number(lt.quantidade||0),kt=Ve*Number(lt.preco_unitario||0);Le[Vt]||(Le[Vt]={quantidade:0,valor:0}),Le[Vt].quantidade+=Ve,Le[Vt].valor+=kt});const it=Object.entries(Le).map(([lt,Vt])=>({nome:lt,quantidade:Vt.quantidade,valor:Vt.valor})).sort((lt,Vt)=>Vt.valor-lt.valor);C(it),w(it.slice(0,5)),console.debug("[Financeiro][VisaoGeral] Produtos agregados:",{total:it.length,top5:it.slice(0,5)})}if(ot)try{let k=de.from("pagamentos").select("comanda_id, valor, status").eq("codigo_empresa",ot).neq("status","Cancelado").neq("status","Estornado");se&&(k=k.gte("recebido_em",se)),He&&(k=k.lte("recebido_em",He));const{data:T}=await k;console.debug("[Financeiro][VisaoGeral] Pagamentos carregados:",(T||[]).length);const K=Array.from(new Set((T||[]).map(Ve=>Ve.comanda_id).filter(Boolean)));let H=[];if(K.length>0){let Ve=de.from("comanda_clientes").select("comanda_id, cliente_id, nome_livre").in("comanda_id",K).eq("codigo_empresa",ot);const{data:kt}=await Ve;H=kt||[]}console.debug("[Financeiro][VisaoGeral] Vinculos comanda_clientes:",H.length);const F=Array.from(new Set(H.map(Ve=>Ve.cliente_id).filter(Boolean))),Le={};if(F.length>0){const{data:Ve}=await de.from("clientes").select("id, nome").in("id",F).eq("codigo_empresa",ot);(Ve||[]).forEach(kt=>{Le[kt.id]=kt.nome})}const it={};H.forEach(Ve=>{const kt=Ve.nome_livre||Le[Ve.cliente_id]||`Cliente ${Ve.cliente_id||""}`;it[Ve.comanda_id]||(it[Ve.comanda_id]=new Set),kt&&it[Ve.comanda_id].add(kt)});const lt={};(T||[]).forEach(Ve=>{const kt=Array.from(it[Ve.comanda_id]||[]),Sr=Number(Ve.valor||0);if(kt.length===0){const Or="Sem cliente";lt[Or]||(lt[Or]={id:null,nome:Or,valor:0}),lt[Or].valor+=Sr}else kt.forEach(Or=>{lt[Or]||(lt[Or]={id:null,nome:Or,valor:0}),lt[Or].valor+=Sr})});try{const Ve=new Map(Object.values(Le).map((zn,sn)=>[Object.keys(Le)[sn],zn]));let kt=de.from("v_agendamento_participantes").select("agendamento_id, cliente_id, valor_cota, status_pagamento, status_pagamento_text");ot&&(kt=kt.eq("codigo_empresa",ot));let{data:Sr}=await kt;Sr=Sr||[];const Or=Array.from(new Set(Sr.map(zn=>zn.agendamento_id).filter(Boolean)));let fr=new Set;if(Or.length>0){let zn=de.from("agendamentos").select("id, inicio").in("id",Or);ot&&(zn=zn.eq("codigo_empresa",ot));const{data:sn}=await zn,qr=se?new Date(se).getTime():null,Sa=He?new Date(He).getTime():null;(sn||[]).forEach(_a=>{const da=_a?.inicio?new Date(_a.inicio).getTime():null;da!=null&&(qr==null||da>=qr)&&(Sa==null||da<=Sa)&&fr.add(_a.id)})}const Kr=Sr.filter(zn=>fr.has(zn.agendamento_id));console.debug("[Financeiro][Agendamentos] participantes no perodo (by agendamento.inicio):",Kr.length);const qn=Array.from(new Set((Kr||[]).map(zn=>zn.cliente_id).filter(Boolean).map(String))).filter(zn=>!Ve.has(zn));if(qn.length>0){const{data:zn}=await de.from("clientes").select("id,nome").in("id",qn);(zn||[]).forEach(sn=>Ve.set(String(sn.id),sn.nome))}(Kr||[]).forEach(zn=>{const sn=String(zn.status_pagamento||zn.status_pagamento_text||"pago").toLowerCase();if(["cancelado","estornado"].includes(sn))return;const qr=zn.cliente_id,Sa=qr?Ve.get(String(qr))||`Cliente ${qr}`:null;if(!Sa)return;const _a=Number(zn.valor_cota||0);lt[Sa]||(lt[Sa]={id:qr||null,nome:Sa,valor:0}),lt[Sa].valor+=_a})}catch{}const Vt=Object.values(lt).sort((Ve,kt)=>kt.valor-Ve.valor);A(Vt),_(Vt.slice(0,5)),console.debug("[Financeiro][VisaoGeral] Clientes agregados:",{total:Vt.length,top5:Vt.slice(0,5)})}catch(k){console.error("Erro ao carregar top clientes:",k),_([]),A([])}if(ot&&se&&He)try{let k=de.from("pagamentos").select("recebido_em, valor, status").eq("codigo_empresa",ot).gte("recebido_em",se).lte("recebido_em",He).order("recebido_em",{ascending:!0});const{data:T}=await k;let K=de.from("v_agendamentos_detalhado").select("inicio, valor_pago, status_pagamento").eq("codigo_empresa",ot).eq("status_pagamento","Pago").gte("inicio",se).lte("inicio",He).order("inicio",{ascending:!0});const{data:H}=await K,F={};(T||[]).forEach(it=>{if(["Cancelado","Estornado"].includes(it.status))return;const lt=new Date(it.recebido_em).toLocaleDateString("pt-BR");F[lt]=(F[lt]||0)+Number(it.valor||0)}),(H||[]).forEach(it=>{const lt=new Date(it.inicio).toLocaleDateString("pt-BR");F[lt]=(F[lt]||0)+Number(it.valor_pago||0)});const Le=Object.entries(F).map(([it,lt])=>({data:it,valor:lt})).sort((it,lt)=>{const[Vt,Ve,kt]=it.data.split("/").map(Number),[Sr,Or,fr]=lt.data.split("/").map(Number);return new Date(kt,Ve-1,Vt).getTime()-new Date(fr,Or-1,Sr).getTime()});O(Le),console.debug("[Financeiro][VisaoGeral] Evoluo diria:",Le.length,"dias")}catch(k){console.warn("[Financeiro][VisaoGeral] Falha ao calcular evoluo diria:",k?.message),O([])}else O([])}catch(se){e({title:"Falha ao carregar viso geral",description:se?.message||"Tente novamente",variant:"destructive"})}finally{l(!1)}},ir=async()=>{try{const se=t?.codigo_empresa,He=await nh({codigoEmpresa:se});if(me(!!He),He){const[ee,k]=await Promise.all([Yw({codigoEmpresa:se}),ng({caixaSessaoId:He.id,codigoEmpresa:se})]);le(ee||null),Re(k||[])}else le(null),Re([]);const ot=await qre({limit:50,codigoEmpresa:se});if(console.log("[FinanceiroPage][loadCaixa] Histrico recebido de listarFechamentosCaixa:",ot?.length,"sesses"),ot&&ot.length>0){console.log("[FinanceiroPage][loadCaixa] Primeira sesso do histrico:",ot[0]);const ee=ot.filter(k=>k.valor_final_dinheiro!=null);console.log("[FinanceiroPage][loadCaixa] Sesses com valor_final_dinheiro:",ee.length,"/",ot.length)}ie(ot||[])}catch(se){e({title:"Falha ao carregar caixa",description:se?.message,variant:"destructive"})}},nr=async()=>{try{l(!0);const se=t?.codigo_empresa,He=Ft(c)||void 0,ot=Dr(u)||void 0;let ee=de.from("pagamentos").select("id, comanda_id, valor, status, metodo, recebido_em, origem, xml_chave, finalizadoras!pagamentos_finalizadora_id_fkey(nome)").eq("codigo_empresa",se).order("recebido_em",{ascending:!1});He&&(ee=ee.gte("recebido_em",He)),ot&&(ee=ee.lte("recebido_em",ot));const{data:k}=await ee;let T=new Map,K=new Map;try{const lt=Array.from(new Set((k||[]).map(Vt=>Vt.comanda_id).filter(Boolean)));if(lt.length>0){const{data:Vt}=await de.from("comandas").select("id, cliente_id, tipo").in("id",lt).eq("codigo_empresa",se),Ve=Array.from(new Set((Vt||[]).map(Or=>Or.cliente_id).filter(Boolean)));let kt=new Map;if(Ve.length>0){const{data:Or}=await de.from("clientes").select("id, nome").in("id",Ve).eq("codigo_empresa",se);kt=new Map((Or||[]).map(fr=>[fr.id,fr.nome]))}for(const Or of Vt||[]){if(!Or)continue;const fr=kt.get(Or.cliente_id)||null;T.set(Or.id,fr),K.set(Or.id,Or.tipo||null)}const Sr=(Vt||[]).filter(Or=>!Or?.cliente_id).map(Or=>Or.id);if(Sr.length>0)try{const{data:Or}=await de.from("comanda_clientes").select("comanda_id, cliente_id").in("comanda_id",Sr).eq("codigo_empresa",se),fr=Array.from(new Set((Or||[]).map(Kr=>Kr.cliente_id).filter(Boolean)));if(fr.length>0){const{data:Kr}=await de.from("clientes").select("id, nome").in("id",fr).eq("codigo_empresa",se),Pn=new Map((Kr||[]).map(qn=>[qn.id,qn.nome]));for(const qn of Or||[]){const zn=Pn.get(qn.cliente_id)||null;zn&&!T.get(qn.comanda_id)&&T.set(qn.comanda_id,zn)}}}catch{console.debug("[Financeiro][Recebimentos] comanda_clientes indisponvel (ok)")}}}catch(lt){console.warn("[Financeiro][Recebimentos] Falha ao buscar clientes de comandas:",lt?.message)}let H=de.from("v_agendamentos_detalhado").select("agendamento_id, agendamento_codigo, inicio, quadra_nome, participante_nome, valor_cota, status_pagamento, finalizadora_nome").eq("codigo_empresa",se).eq("status_pagamento","Pago").order("inicio",{ascending:!1});He&&(H=H.gte("inicio",He)),ot&&(H=H.lte("inicio",ot));const{data:F}=await H,Le=(k||[]).map(lt=>({id:lt.id,origem:K.get(lt.comanda_id||"")==="balcao"?"Balco":"Comanda",comanda_id:lt.comanda_id||null,recebido_em:lt.recebido_em,finalizadoras:lt.finalizadoras,metodo:lt.metodo,valor:lt.valor,status:lt.status,descricao:T.get(lt.comanda_id||"")||null,fonte:lt.origem||"manual",xml_chave:lt.xml_chave||null})),it=(F||[]).map((lt,Vt)=>({id:`ag-${lt.agendamento_id}-${Vt}`,origem:"Agendamento",recebido_em:lt.inicio,finalizadoras:lt.finalizadora_nome?{nome:lt.finalizadora_nome}:null,metodo:lt.finalizadora_nome||null,valor:lt.valor_cota,status:lt.status_pagamento,descricao:`#${lt.agendamento_codigo} - ${lt.participante_nome} (${lt.quadra_nome||""})`,agendamento_codigo:lt.agendamento_codigo,quadra_nome:lt.quadra_nome,participante_nome:lt.participante_nome,fonte:null}));be([...Le,...it])}catch(se){e({title:"Falha ao carregar recebimentos",description:se?.message,variant:"destructive"})}finally{l(!1)}},kr=async()=>{try{l(!0);const se=t?.codigo_empresa,He=Ft(c)||void 0,ot=Dr(u)||void 0;let ee=de.from("v_agendamentos_detalhado").select("agendamento_id, agendamento_codigo, inicio, fim, quadra_nome, participante_nome, cliente_id, valor_cota, finalizadora_nome, status_pagamento").eq("codigo_empresa",se).order("inicio",{ascending:!1});He&&(ee=ee.gte("inicio",He)),ot&&(ee=ee.lte("inicio",ot));const{data:k}=await ee,T=[...new Set((k||[]).map(F=>F.cliente_id).filter(Boolean))];let K={};if(T.length>0){const{data:F}=await de.from("clientes").select("id, is_consumidor_final, codigo").in("id",T).eq("codigo_empresa",se);F&&(K=Object.fromEntries(F.map(Le=>[Le.id,Le])))}const H=(k||[]).map(F=>({...F,is_consumidor_final:K[F.cliente_id]?.is_consumidor_final||!1,cliente_codigo:K[F.cliente_id]?.codigo||null}));ze(H)}catch(se){e({title:"Falha ao carregar agendamentos",description:se?.message,variant:"destructive"})}finally{l(!1)}};p.useEffect(()=>{n({tab:s})},[s]);const Ft=se=>{if(!se)return null;if(typeof se=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(se)){const[He,ot,ee]=se.split("-").map(Number);return new Date(He,ot-1,ee,0,0,0,0).toISOString()}return new Date(se).toISOString()},Dr=se=>{if(!se)return null;if(typeof se=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(se)){const[He,ot,ee]=se.split("-").map(Number);return new Date(He,ot-1,ee,23,59,59,999).toISOString()}return new Date(se).toISOString()};p.useEffect(()=>{t?.codigo_empresa&&(s==="visao-geral"||s==="relatorios"?Mt():s==="caixa"?ir():s==="recebimentos"?nr():s==="agendamentos"&&kr())},[s,c,u,t?.codigo_empresa]);const Fr=p.useMemo(()=>{const se=h?.totalPorFinalizadora||{},He=Object.entries(se).map(([ot,ee])=>({name:ot,valor:Number(ee||0)}));return He.sort((ot,ee)=>ee.valor-ot.valor),He},[h]),[Tn,nt]=p.useState(null),[$t,Kt]=p.useState(null),sr={start:90,end:-270},St=(se,He,ot)=>se+(He-se)*ot,Jr=se=>se<.5?4*se*se*se:1-Math.pow(-2*se+2,3)/2,Pt=se=>{const He=Number(v||0),ot=Number(y||0),ee=Math.max(1e-4,He+ot),k=360*(He/ee);return se===0?{a:sr.start,b:sr.start-k}:{a:sr.start-k,b:sr.end}},[lr,st]=p.useState({from:null,to:null,t:1}),Et=$t??Tn;p.useEffect(()=>{if(Et==null)return;const se=Pt(Et);st(T=>({from:T.to||se,to:se,t:0}));let He;const ot=performance.now(),ee=380,k=T=>{const K=Math.min(1,(T-ot)/ee),H=Jr(K);st(F=>({...F,t:H})),K<1&&(He=requestAnimationFrame(k))};return He=requestAnimationFrame(k),()=>He&&cancelAnimationFrame(He)},[Et,v,y]);const ar=86,Tr=94,Qr=80,[tn,Qt]=p.useState({from:[ar,ar],to:[ar,ar],t:1});p.useEffect(()=>{const se=Et===0?[Tr,Qr]:Et===1?[Qr,Tr]:[ar,ar];Qt(T=>({from:T.to||se,to:se,t:0}));let He;const ot=performance.now(),ee=380,k=T=>{const K=Math.min(1,(T-ot)/ee),H=Jr(K);Qt(F=>({...F,t:H})),K<1&&(He=requestAnimationFrame(k))};return He=requestAnimationFrame(k),()=>He&&cancelAnimationFrame(He)},[Et]);const fn=({cx:se,cy:He,outerRadius:ot})=>{if(!lr.from||!lr.to)return null;const ee=St(lr.from.a,lr.to.a,lr.t),k=St(lr.from.b,lr.to.b,lr.t),T=Et===0?"#22C55E":"#F59E0B";return a.jsx(_M,{cx:se,cy:He,innerRadius:0,outerRadius:(ot||0)+4,startAngle:ee,endAngle:k,fill:T,fillOpacity:.18,stroke:"transparent"})},nn=p.useMemo(()=>{let se=Wt;if(Ct){const He=Ct.toLowerCase();se=se.filter(ot=>(ot.descricao||"").toLowerCase().includes(He)||(ot.finalizadoras?.nome||"").toLowerCase().includes(He)||String(ot.valor||"").includes(He)||(ot.origem||"").toLowerCase().includes(He))}return Ge!=="all"&&(se=se.filter(He=>(He.finalizadoras?.nome||He.metodo)===Ge)),_e!=="all"&&(se=se.filter(He=>(He.fonte||"manual")===_e)),se},[Wt,Ct,Ge,_e]),In=p.useMemo(()=>{const se={};return(Ue||[]).forEach(He=>{const ot=He.agendamento_id||He.agendamento_codigo;se[ot]||(se[ot]={agendamento_id:He.agendamento_id,agendamento_codigo:He.agendamento_codigo,inicio:He.inicio,fim:He.fim,quadra_nome:He.quadra_nome,participantes:[],total:0,totalPago:0,totalPendente:0,statusGeral:"Pendente",representante:"",representanteClienteId:null,representanteCodigo:null,isRepresentanteConsumidor:!1}),se[ot].participantes.push(He),se[ot].total+=Number(He.valor_cota||0),He.status_pagamento==="Pago"?se[ot].totalPago+=Number(He.valor_cota||0):se[ot].totalPendente+=Number(He.valor_cota||0)}),Object.values(se).forEach(He=>{const ot=He.participantes.every(k=>k.status_pagamento==="Pago");if(He.participantes.every(k=>k.status_pagamento==="Cancelado")?He.statusGeral="Cancelado":ot?He.statusGeral="Pago":He.statusGeral="Pendente",He.participantes.length>0){let k=He.participantes.find(K=>!K.is_consumidor_final);k||(k=He.participantes[0]);let T=k?.participante_nome||"";k?.is_consumidor_final&&T&&(T.toLowerCase().includes("cliente consumidor")||(T=T)),He.representante=T,He.representanteClienteId=k?.cliente_id||null,He.representanteCodigo=k?.is_consumidor_final?0:k?.cliente_codigo??null,He.isRepresentanteConsumidor=k?.is_consumidor_final||!1}}),Object.values(se).sort((He,ot)=>new Date(ot.inicio)-new Date(He.inicio))},[Ue]),Dn=p.useMemo(()=>{const se=or.toLowerCase().trim();return In.filter(He=>{if(Nt!=="all"&&(Nt==="Pago"&&He.statusGeral!=="Pago"||Nt==="Pendente"&&He.statusGeral!=="Pendente"||Nt==="Cancelado"&&He.statusGeral!=="Cancelado")||Me!=="all"&&!He.participantes.some(K=>K.finalizadora_nome===Me))return!1;if(!se)return!0;const ot=String(He.agendamento_codigo||""),ee=String(He.quadra_nome||"").toLowerCase(),k=He.participantes.map(T=>String(T.participante_nome||"").toLowerCase()).join(" ");return ot.includes(se)||ee.includes(se)||k.includes(se)})},[In,or,Nt,Me]);return a.jsx(a.Fragment,{children:a.jsxs(xr.div,{variants:Not,initial:"hidden",animate:"visible",className:"space-y-6",children:[a.jsx(xr.div,{variants:xl,className:"fx-card p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Financeiro"}),a.jsx("p",{className:"text-sm text-text-secondary",children:"Gesto completa das finanas da empresa"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row flex-wrap items-stretch sm:items-center gap-3 w-full sm:w-auto",children:[a.jsxs("div",{className:"flex flex-col justify-center flex-1 sm:flex-initial",children:[a.jsx("label",{className:"text-xs text-text-secondary mb-1",children:"Incio"}),a.jsxs(vi,{children:[a.jsx(xi,{asChild:!0,children:a.jsxs(fe,{variant:"outline",className:"h-9 w-full sm:w-[160px] pl-3 pr-3 flex items-center gap-2 justify-start text-left font-medium bg-black border-warning/40 text-white hover:bg-black/80 hover:border-warning",children:[a.jsx(Bs,{className:"h-5 w-5 text-warning flex-shrink-0"}),a.jsx("span",{className:"font-mono tracking-wide text-sm leading-none",children:c?cr(new Date(c+"T00:00:00"),"dd/MM/yyyy",{locale:na}):"Selecione"})]})}),a.jsx(ni,{className:"w-auto p-0 bg-black border-warning/40",align:"start",children:a.jsx(yi,{mode:"single",selected:c?new Date(c+"T00:00:00"):void 0,onSelect:se=>se&&d(cr(se,"yyyy-MM-dd")),initialFocus:!0,classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md border-warning/40"}})})]})]}),a.jsxs("div",{className:"flex flex-col justify-center flex-1 sm:flex-initial",children:[a.jsx("label",{className:"text-xs text-text-secondary mb-1",children:"Fim"}),a.jsxs(vi,{children:[a.jsx(xi,{asChild:!0,children:a.jsxs(fe,{variant:"outline",className:"h-9 w-full sm:w-[160px] pl-3 pr-3 flex items-center gap-2 justify-start text-left font-medium bg-black border-warning/40 text-white hover:bg-black/80 hover:border-warning",children:[a.jsx(Bs,{className:"h-5 w-5 text-warning flex-shrink-0"}),a.jsx("span",{className:"font-mono tracking-wide text-sm leading-none",children:u?cr(new Date(u+"T00:00:00"),"dd/MM/yyyy",{locale:na}):"Selecione"})]})}),a.jsx(ni,{className:"w-auto p-0 bg-black border-warning/40",align:"start",children:a.jsx(yi,{mode:"single",selected:u?new Date(u+"T00:00:00"):void 0,onSelect:se=>se&&f(cr(se,"yyyy-MM-dd")),initialFocus:!0,classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md border-warning/40"}})})]})]})]})]})}),a.jsxs(Mc,{value:s,onValueChange:o,children:[a.jsx("div",{className:"md:hidden mb-4",children:a.jsxs(vn,{value:s,onValueChange:o,children:[a.jsx(hn,{className:"w-full h-11 bg-black border-warning/40 text-white",children:a.jsx(wn,{placeholder:"Selecione uma aba"})}),a.jsxs(pn,{className:"bg-black text-white border-warning/40",children:[a.jsx(ct,{value:"visao-geral",children:"Viso Geral"}),a.jsx(ct,{value:"caixa",children:"Caixa"}),a.jsx(ct,{value:"recebimentos",children:"Recebimentos"}),a.jsx(ct,{value:"agendamentos",children:"Agendamentos"}),a.jsx(ct,{value:"relatorios",children:"Relatrios"})]})]})}),a.jsxs(rc,{className:"hidden md:grid w-full grid-cols-5",children:[a.jsx(sa,{value:"visao-geral",children:"Viso Geral"}),a.jsx(sa,{value:"caixa",children:"Caixa"}),a.jsx(sa,{value:"recebimentos",children:"Recebimentos"}),a.jsx(sa,{value:"agendamentos",children:"Agendamentos"}),a.jsx(sa,{value:"relatorios",children:"Relatrios"})]}),a.jsxs(is,{value:"visao-geral",className:"space-y-6 mt-6",children:[a.jsxs(xr.div,{variants:xl,className:"grid grid-cols-1 sm:grid-cols-4 gap-4",children:[a.jsx(Rj,{icon:aG,label:"Total Geral",value:yt(Number(v||0)+Number(y||0)),color:"brand"}),a.jsx(Rj,{icon:y1,label:"Comandas",value:yt(v),color:"success"}),a.jsx(Rj,{icon:Bs,label:"Agendamentos",value:yt(y),color:"success"}),a.jsx(Rj,{icon:Qm,label:"XML (Recebimentos)",value:yt(I),color:"success"})]}),a.jsxs(xr.div,{variants:xl,className:"fx-card p-4 border-0 ring-0 outline-none shadow-none",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider",children:[a.jsx(Qm,{className:"w-4 h-4 text-brand"}),a.jsx("span",{children:"Proporo de Receita"})]})}),Number(v||0)+Number(y||0)===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem receitas no perodo."}):a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:[a.jsx("div",{className:"w-full md:flex-1 h-[280px]",children:a.jsx(fb,{width:"100%",height:"100%",children:a.jsxs(aUe,{children:[a.jsxs(cf,{data:function(){const se=St(tn.from?.[0]??ar,tn.to?.[0]??ar,tn.t),He=St(tn.from?.[1]??ar,tn.to?.[1]??ar,tn.t);return[{name:"Comandas",value:Number(v||0),fill:"#22C55E",outerRadius:se},{name:"Agendamentos",value:Number(y||0),fill:"#F59E0B",outerRadius:He}]}(),dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",innerRadius:0,stroke:"transparent",label:!1,labelLine:!1,isAnimationActive:!0,animationBegin:50,animationDuration:500,startAngle:sr.start,endAngle:sr.end,activeIndex:Et,activeShape:void 0,onMouseEnter:(se,He)=>nt(He),onMouseLeave:()=>nt(null),onClick:(se,He)=>{Kt(ot=>ot===He?null:He),nt(He)},children:[a.jsx(vw,{fill:"#22C55E",style:zt(0)},"c"),a.jsx(vw,{fill:"#F59E0B",style:zt(1)},"a")]}),fn({cx:"50%",cy:"50%",outerRadius:92}),a.jsx(cf,{data:function(){const se=St(tn.from?.[0]??ar,tn.to?.[0]??ar,tn.t),He=St(tn.from?.[1]??ar,tn.to?.[1]??ar,tn.t);return[{name:"Comandas",value:Number(v||0),fill:"transparent",outerRadius:se},{name:"Agendamentos",value:Number(y||0),fill:"transparent",outerRadius:He}]}(),dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",innerRadius:0,stroke:"transparent",label:Qe,labelLine:!1,isAnimationActive:!1,startAngle:sr.start,endAngle:sr.end}),a.jsx(Xl,{formatter:se=>yt(se),contentStyle:{background:"rgba(10, 10, 10, 0.95)",border:"1px solid #fbbf24",borderRadius:"8px",padding:"8px 10px",color:"#fff"},labelStyle:{color:"#fff"},itemStyle:{color:"#fff"},cursor:{fill:"rgba(251, 191, 36, 0.06)"}})]})})}),a.jsx("div",{className:"w-full md:w-64 space-y-3 md:pr-2",children:[{name:"Comandas",value:Number(v||0),color:"#22C55E"},{name:"Agendamentos",value:Number(y||0),color:"#F59E0B"}].map((se,He)=>a.jsxs("div",{className:`flex items-center justify-between px-3 py-2 rounded-md transition-all duration-200 ${Tn===He?"bg-white/5":"hover:bg-white/5"} cursor-pointer ${$t!=null&&$t!==He?"opacity-60":""}`,onMouseEnter:()=>nt(He),onMouseLeave:()=>nt(null),onClick:()=>Kt(ot=>ot===He?null:He),role:"button",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"inline-block w-3 h-3 rounded-sm",style:{backgroundColor:se.color}}),a.jsx("span",{className:"text-sm text-text-secondary",children:se.name})]}),a.jsx("div",{className:`text-sm font-semibold ${$t!=null&&$t!==He?"opacity-70":""}`,children:yt(se.value)})]},se.name))})]})]}),a.jsxs(xr.div,{variants:xl,className:"fx-card p-4 border-0 ring-0 outline-none shadow-none",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider",children:[a.jsx(Qm,{className:"w-4 h-4 text-brand"}),a.jsx("span",{children:"Entradas por Finalizadora"})]})}),Fr.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem pagamentos no perodo."}):a.jsx("div",{className:"h-[280px]",children:a.jsx(fb,{width:"100%",height:"100%",children:a.jsxs(nUe,{data:Fr,margin:{top:8,right:8,left:8,bottom:8},children:[a.jsx(mS,{strokeDasharray:"3 3",stroke:"#333"}),a.jsx(Fh,{dataKey:"name",stroke:"#aaa"}),a.jsx($h,{stroke:"#aaa",tickFormatter:se=>yt(se),width:80}),a.jsx(Xl,{formatter:se=>yt(se),labelFormatter:se=>`Finalizadora: ${se}`,contentStyle:{background:"rgba(10, 10, 10, 0.95)",border:"1px solid #fbbf24",borderRadius:"8px",padding:"8px 12px",color:"#fff"},cursor:{fill:"rgba(251, 191, 36, 0.1)"}}),a.jsx(Zp,{}),a.jsx(zg,{dataKey:"valor",name:"Valor",fill:"#fbbf24"})]})})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[a.jsxs(xr.div,{variants:xl,className:"fx-card p-4 border-0 ring-0 outline-none focus-visible:outline-none shadow-none cursor-pointer",onClick:()=>W(!0),children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider mb-3",children:[a.jsx(Td,{className:"w-4 h-4 text-brand"}),a.jsx("span",{children:"Produtos mais vendidos"}),S.length>5&&a.jsx(fe,{variant:"outline",size:"xs",className:"ml-auto h-7 px-2",onClick:()=>W(!0),children:"Ver todos"})]}),b.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem dados no perodo."}):a.jsx("div",{className:"space-y-2",children:b.map((se,He)=>a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-border last:border-0",children:[a.jsxs("span",{className:"text-sm text-text-primary",children:[He+1,". ",se.nome]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs text-text-secondary",children:yt(se.valor)}),a.jsxs("span",{className:"text-sm font-bold text-brand",children:["x",se.quantidade]})]})]},He))})]}),a.jsxs(xr.div,{variants:xl,className:"fx-card p-4 border-0 ring-0 outline-none focus-visible:outline-none shadow-none cursor-pointer",onClick:()=>X(!0),children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider mb-3",children:[a.jsx(Pl,{className:"w-4 h-4 text-brand"}),a.jsx("span",{children:"Clientes (por valor pago)"}),P.length>5&&a.jsx(fe,{variant:"outline",size:"xs",className:"ml-auto h-7 px-2",onClick:()=>X(!0),children:"Ver todos"})]}),j.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem dados no perodo."}):a.jsx("div",{className:"space-y-2",children:j.map((se,He)=>a.jsxs("button",{className:"w-full flex items-center justify-between py-2 border-b border-border last:border-0 hover:bg-surface-2 rounded-sm px-2 text-left",onClick:()=>{Se(se),X(!0)},children:[a.jsxs("span",{className:"text-sm text-text-primary",children:[He+1,". ",se.nome]}),a.jsx("span",{className:"text-sm font-bold text-success",children:yt(se.valor)})]},He))})]})]})]}),a.jsx(is,{value:"agendamentos",className:"space-y-6 mt-6",children:a.jsxs(xr.div,{variants:xl,className:"fx-card p-4 border-0 ring-0 outline-none shadow-none",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4",children:[a.jsx("h2",{className:"text-lg font-bold",children:"Agendamentos (Pagamentos por Participante)"}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:items-center",children:[a.jsxs("div",{className:"relative",children:[a.jsx(Zs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(rt,{placeholder:"Buscar (#cdigo, participante, quadra)",value:or,onChange:se=>tr(se.target.value),className:"pl-10 pr-10 w-full md:w-[260px] bg-black border-warning/40 text-white placeholder:text-white/60"}),a.jsxs(vi,{open:hr,onOpenChange:It,children:[a.jsx(xi,{asChild:!0,children:a.jsx(fe,{variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-7 w-7 p-0 hover:bg-warning/20",title:"Selecionar cliente",children:a.jsx("svg",{className:"h-4 w-4 text-warning",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})}),a.jsx(ni,{className:"w-[280px] p-2 bg-surface border-border",align:"end",children:a.jsxs("div",{className:"space-y-1 max-h-[300px] overflow-y-auto",children:[a.jsx("div",{className:"text-xs font-semibold text-text-secondary px-2 py-1 sticky top-0 bg-surface z-10",children:"Selecionar Cliente"}),(()=>{const se=new Map;Ue.forEach(ot=>{const ee=ot.participante_nome;ee&&!se.has(ee)&&se.set(ee,{nome:ee,codigo:ot.cliente_codigo||0,is_consumidor:ot.is_consumidor_final||!1})});const He=Array.from(se.values()).sort((ot,ee)=>ot.is_consumidor!==ee.is_consumidor?ot.is_consumidor?1:-1:ot.nome.localeCompare(ee.nome));return He.length===0?a.jsx("div",{className:"text-sm text-text-muted text-center py-4",children:"Nenhum participante encontrado"}):He.map((ot,ee)=>a.jsxs("button",{onClick:()=>{tr(ot.nome),It(!1)},className:"w-full flex items-center gap-2 px-2 py-2 hover:bg-surface-2 rounded text-left transition-colors",children:[a.jsxs("span",{className:`inline-flex items-center justify-center min-w-[24px] h-5 px-1 rounded text-[10px] font-bold ${ot.codigo===0?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",ot.codigo]}),a.jsx("span",{className:"text-sm text-text-primary flex-1 truncate",children:ot.nome})]},ee))})()]})})]})]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[a.jsxs(vn,{value:Nt,onValueChange:yr,children:[a.jsx(hn,{className:"w-full md:w-[170px] h-9 bg-black border-warning/40 text-white",children:a.jsx(wn,{placeholder:"Todos os Status"})}),a.jsxs(pn,{className:"bg-black text-white border-warning/40",children:[a.jsx(ct,{value:"all",children:"Todos os Status"}),a.jsx(ct,{value:"Pago",children:"Pago"}),a.jsx(ct,{value:"Pendente",children:"Pendente"}),a.jsx(ct,{value:"Cancelado",children:"Cancelado"})]})]}),a.jsxs(vn,{value:Me,onValueChange:dt,children:[a.jsx(hn,{className:"w-full md:w-[220px] h-9 bg-black border-warning/40 text-white",children:a.jsx(wn,{placeholder:"Todas as Finalizadoras"})}),a.jsxs(pn,{className:"bg-black text-white border-warning/40",children:[a.jsx(ct,{value:"all",children:"Todas as Finalizadoras"}),[...new Set((Ue||[]).map(se=>se.finalizadora_nome).filter(Boolean))].map(se=>a.jsx(ct,{value:se,children:se},se))]})]})]}),a.jsxs(fe,{variant:"outline",size:"sm",onClick:()=>{try{const se=";",ot=[["Data","Horrio","Cdigo","Representante","Quadra","Participantes","Total","Pago","Pendente","Status"].join(se)];Dn.forEach(Le=>{const it=Le.inicio?new Date(Le.inicio).toLocaleDateString("pt-BR"):"",lt=Le.inicio&&Le.fim?`${new Date(Le.inicio).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}-${new Date(Le.fim).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}`:"",Vt=Le.participantes.length,Ve=Le.participantes.filter(fr=>fr.status_pagamento==="Pago").length,kt=Le.participantes.filter(fr=>fr.status_pagamento==="Pendente").length,Sr=String(qt(Le.total)).replace(".",","),Or=[it,lt,Le.agendamento_codigo??"",(Le.representante??"").replace(/"/g,'""'),(Le.quadra_nome??"").replace(/"/g,'""'),Vt,Sr,Ve,kt,Le.statusGeral??""].map(fr=>`"${fr}"`).join(se);ot.push(Or)});const ee="\uFEFF"+ot.join(`
`),k=new Blob([ee],{type:"text/csv;charset=utf-8;"}),T=URL.createObjectURL(k),K=document.createElement("a");K.href=T;const H=c?new Date(c+"T00:00:00").toLocaleDateString("pt-BR").replace(/\//g,"-"):"",F=u?new Date(u+"T00:00:00").toLocaleDateString("pt-BR").replace(/\//g,"-"):"";K.download=`agendamentos_${H}_a_${F}.csv`,document.body.appendChild(K),K.click(),document.body.removeChild(K),URL.revokeObjectURL(T),e({title:"CSV exportado com sucesso!"})}catch(se){e({title:"Falha ao exportar CSV",description:se?.message,variant:"destructive"})}},children:[a.jsx(uo,{className:"h-4 w-4 mr-2"})," Exportar CSV"]})]})]}),i?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-brand border-r-transparent"}),a.jsx("p",{className:"mt-4 text-text-muted",children:"Carregando..."})]}):Dn.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem registros no perodo."}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs(yl,{children:[a.jsx(bl,{children:a.jsxs(qa,{children:[a.jsx(On,{className:"w-12"}),a.jsx(On,{children:"Data/Hora"}),a.jsx(On,{children:"Cdigo"}),a.jsx(On,{children:"Representante"}),a.jsx(On,{children:"Quadra"}),a.jsx(On,{className:"text-right",children:"Participantes"}),a.jsx(On,{className:"text-right",children:"Total"}),a.jsx(On,{children:"Status"})]})}),a.jsx(wl,{children:Dn.map(se=>{const He=ut.has(se.agendamento_id||se.agendamento_codigo);return a.jsxs(Pe.Fragment,{children:[a.jsxs(qa,{className:"cursor-pointer hover:bg-surface-2",onClick:()=>{const ot=se.agendamento_id||se.agendamento_codigo;rr(ee=>{const k=new Set(ee);return k.has(ot)?k.delete(ot):k.add(ot),k})},children:[a.jsx(bn,{children:a.jsx("div",{className:`transition-transform ${He?"rotate-90":""}`,children:""})}),a.jsx(bn,{children:se.inicio?a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-xs text-text-secondary",children:new Date(se.inicio).toLocaleDateString("pt-BR")}),a.jsxs("span",{className:"font-medium",children:[new Date(se.inicio).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),se.fim&&` - ${new Date(se.fim).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}`]})]}):""}),a.jsxs(bn,{className:"font-semibold",children:["#",se.agendamento_codigo||""]}),a.jsx(bn,{children:a.jsxs("div",{className:"flex items-center gap-2",children:[se.representanteCodigo!==null&&se.representanteCodigo!==void 0&&a.jsxs("span",{className:`inline-flex items-center justify-center min-w-[32px] h-6 px-1.5 rounded text-xs font-bold ${se.representanteCodigo===0||se.representanteCodigo==="0"?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",se.representanteCodigo]}),a.jsx("span",{className:"text-text-primary",children:se.representante||""})]})}),a.jsx(bn,{children:se.quadra_nome||""}),a.jsx(bn,{className:"text-right",children:se.participantes.length}),a.jsx(bn,{className:"text-right font-semibold",children:yt(se.total)}),a.jsx(bn,{children:a.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${se.statusGeral==="Pago"?"bg-success/20 text-success":se.statusGeral==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:se.statusGeral==="Parcial"?"Pendente":se.statusGeral})})]}),He&&se.participantes.map((ot,ee)=>{const k=ot.is_consumidor_final?0:ot.cliente_codigo??null;return a.jsxs(qa,{className:"bg-surface-2/30 hover:bg-surface-2/50 transition-colors",children:[a.jsx(bn,{}),a.jsx(bn,{colSpan:2}),a.jsx(bn,{className:"pl-8 text-sm text-text-secondary",children:a.jsxs("div",{className:"flex items-center gap-2",children:[k!=null&&a.jsxs("span",{className:`inline-flex items-center justify-center min-w-[28px] h-5 px-1 rounded text-[10px] font-bold ${k===0||k==="0"?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",k]}),a.jsx("span",{children:ot.participante_nome||""})]})}),a.jsx(bn,{className:"text-sm text-text-secondary",children:ot.finalizadora_nome||""}),a.jsx(bn,{}),a.jsx(bn,{className:"text-right text-sm font-medium",children:yt(ot.valor_cota)}),a.jsx(bn,{className:"text-sm",children:a.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs ${ot.status_pagamento==="Pago"?"bg-success/20 text-success":ot.status_pagamento==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:ot.status_pagamento||"Pendente"})})]},`${se.agendamento_codigo}-${ee}`)})]},se.agendamento_id||se.agendamento_codigo)})})]})}),a.jsx("div",{className:"md:hidden space-y-3",children:Dn.map(se=>{const He=ut.has(se.agendamento_id||se.agendamento_codigo);return a.jsxs("div",{className:"bg-surface-2 rounded-lg overflow-hidden",children:[a.jsxs("div",{className:"p-4 cursor-pointer",onClick:()=>{const ot=se.agendamento_id||se.agendamento_codigo;rr(ee=>{const k=new Set(ee);return k.has(ot)?k.delete(ot):k.add(ot),k})},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`transition-transform text-text-secondary ${He?"rotate-90":""}`,children:""}),a.jsxs("div",{className:"text-sm font-semibold text-text-primary",children:["#",se.agendamento_codigo||""]})]}),a.jsx("div",{className:`text-xs px-2 py-1 rounded-full ${se.statusGeral==="Pago"?"bg-success/20 text-success":se.statusGeral==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:se.statusGeral==="Parcial"?"Pendente":se.statusGeral})]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Data:"}),a.jsx("span",{className:"text-text-primary",children:se.inicio?new Date(se.inicio).toLocaleDateString("pt-BR"):""})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Horrio:"}),a.jsx("span",{className:"text-text-primary font-medium",children:se.inicio&&se.fim?`${new Date(se.inicio).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})} - ${new Date(se.fim).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}`:""})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-text-secondary",children:"Representante:"}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[se.representanteCodigo!==null&&se.representanteCodigo!==void 0&&a.jsxs("span",{className:`inline-flex items-center justify-center min-w-[28px] h-5 px-1 rounded text-[10px] font-bold ${se.representanteCodigo===0||se.representanteCodigo==="0"?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",se.representanteCodigo]}),a.jsx("span",{className:"text-text-primary font-medium",children:se.representante||""})]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Quadra:"}),a.jsx("span",{className:"text-text-primary font-medium",children:se.quadra_nome||""})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Participantes:"}),a.jsx("span",{className:"text-text-primary",children:se.participantes.length})]}),a.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-border/50",children:[a.jsx("span",{className:"text-text-secondary",children:"Total:"}),a.jsx("span",{className:"font-bold text-lg text-success",children:yt(se.total)})]})]})]}),He&&a.jsx("div",{className:"border-t border-border/50 bg-surface-2/20",children:se.participantes.map((ot,ee)=>{const k=ot.is_consumidor_final?0:ot.cliente_codigo??null;return a.jsxs("div",{className:"px-4 py-3 border-b border-border/30 last:border-b-0",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[k!=null&&a.jsxs("span",{className:`inline-flex items-center justify-center min-w-[24px] h-4 px-1 rounded text-[9px] font-bold ${k===0||k==="0"?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",k]}),a.jsx("div",{className:"font-medium text-sm",children:ot.participante_nome||""})]}),a.jsx("div",{className:`text-xs px-2 py-0.5 rounded-full ${ot.status_pagamento==="Pago"?"bg-success/20 text-success":ot.status_pagamento==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:ot.status_pagamento||"Pendente"})]}),a.jsxs("div",{className:"flex justify-between text-xs",children:[a.jsx("span",{className:"text-text-secondary",children:ot.finalizadora_nome||""}),a.jsx("span",{className:"font-semibold text-success",children:yt(ot.valor_cota)})]})]},ee)})})]},se.agendamento_id||se.agendamento_codigo)})})]})]})}),a.jsx(is,{value:"caixa",className:"space-y-6 mt-6",children:a.jsxs(xr.div,{variants:xl,className:"fx-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[a.jsx("h3",{className:"text-base font-bold",children:"Fechamentos Anteriores"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(fe,{variant:"outline",size:"sm",onClick:he,children:[a.jsx(uo,{className:"h-4 w-4 mr-2"})," CSV"]}),a.jsxs(fe,{variant:"outline",size:"sm",onClick:Dt,children:[a.jsx(Zg,{className:"h-4 w-4 mr-2"})," PDF"]})]})]}),ne.length===0?a.jsx("div",{className:"text-sm text-text-secondary",children:"Nenhum fechamento encontrado."}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs(yl,{children:[a.jsx(bl,{children:a.jsxs(qa,{children:[a.jsx(On,{children:"Aberto em"}),a.jsx(On,{children:"Fechado em"}),a.jsx(On,{className:"text-right",children:"Saldo Inicial"}),a.jsx(On,{className:"text-right",children:"Saldo Final (contado)"}),a.jsx(On,{children:"Status"})]})}),a.jsxs(wl,{children:[(()=>{console.log("[FinanceiroPage][Render] Renderizando histrico, total de sesses:",ne.length);const se=ne.filter(He=>He.valor_final_dinheiro!=null);return console.log("[FinanceiroPage][Render] Sesses com valor_final_dinheiro no render:",se.length),ne.length>0&&console.log("[FinanceiroPage][Render] Primeira sesso no array history:",ne[0]),null})(),ne.map(se=>a.jsxs(qa,{className:"cursor-pointer hover:bg-surface-2",onClick:async()=>{bt(!0),xt(!0),ht(null);try{const He=t?.codigo_empresa,ot=typeof performance<"u"&&performance.now?performance.now():Date.now();console.log("[Caixa][Fechamento][Open]",{sessaoId:se.id,from:se.aberto_em,to:se.fechado_em,codigo:He});let ee=await SS({caixaSessaoId:se.id,codigoEmpresa:He}),T=(Kr=>{if(!Kr)return null;if(Kr.total_bruto!=null||Kr.por_finalizadora!=null){let Pn=Kr.por_finalizadora;if(Pn&&typeof Pn=="string")try{Pn=JSON.parse(Pn)}catch{Pn={}}return{from:Kr.periodo_de||null,to:Kr.periodo_ate||null,totalPorFinalizadora:Pn||{},totalEntradas:Number(Kr.total_entradas||0),totalVendasBrutas:Number(Kr.total_bruto||0),totalDescontos:Number(Kr.total_descontos||0),totalVendasLiquidas:Number(Kr.total_liquido||0)}}return Kr})(ee);T||(console.log("[Caixa][Fechamento] Snapshot ausente, calculando resumo por perodo..."),T=await Nd({from:se.aberto_em,to:se.fechado_em||new Date().toISOString(),codigoEmpresa:He}));const K={...se,saldo_inicial:ee&&typeof ee.saldo_inicial<"u"?Number(ee.saldo_inicial):se.saldo_inicial,saldo_final:ee&&typeof ee.saldo_final<"u"?Number(ee.saldo_final):se.saldo_final};if(!T||!T.totalPorFinalizadora||Object.keys(T.totalPorFinalizadora).length===0)try{const Kr=se.aberto_em,Pn=se.fechado_em||new Date().toISOString();let qn=de.from("pagamentos").select("metodo, valor, status, recebido_em, finalizadoras:finalizadoras!pagamentos_finalizadora_id_fkey(nome)").gte("recebido_em",Kr).lte("recebido_em",Pn);He&&(qn=qn.eq("codigo_empresa",He));const{data:zn}=await qn,sn={};let qr=0;for(const Sa of zn||[]){if(!((Sa.status||"Pago")!=="Cancelado"&&(Sa.status||"Pago")!=="Estornado"))continue;const da=Sa.finalizadoras?.nome||Sa.metodo||"Outros",Xs=Number(Sa.valor||0);sn[da]=(sn[da]||0)+Xs,qr+=Xs}T={...T||{},totalPorFinalizadora:sn,totalEntradas:Number(T?.totalEntradas||0)||qr},console.log("[Caixa][Fechamento][FallbackPF]",{methods:Object.keys(sn).length})}catch{}const F=await ng({caixaSessaoId:se.id,codigoEmpresa:He}),Le=ee&&ee.movimentos?ee.movimentos:null,it=se.aberto_em,lt=se.fechado_em||new Date().toISOString();let Vt=de.from("pagamentos").select("id, valor, status, metodo, recebido_em, finalizadoras:finalizadoras!pagamentos_finalizadora_id_fkey(nome)").gte("recebido_em",it).lte("recebido_em",lt).order("recebido_em",{ascending:!1});He&&(Vt=Vt.eq("codigo_empresa",He));const{data:Ve}=await Vt;console.log("[Caixa][Fechamento][Pays]",{count:(Ve||[]).length});const kt=ee&&typeof ee.valor_final_dinheiro<"u"?Number(ee.valor_final_dinheiro):null;ht({resumo:T,movimentacoes:F,movimentosAgg:Le,pagamentos:Ve||[],sessao:K,valorFinalContado:kt});const Sr=typeof performance<"u"&&performance.now?performance.now():Date.now(),Or=Array.isArray(F)?F.length:0,fr=T&&T.totalPorFinalizadora?Object.keys(T.totalPorFinalizadora).length:0;console.log("[Caixa][Fechamento][Loaded]",{sessaoId:se.id,finCount:fr,movCount:Or,ms:Math.round(Sr-ot)})}catch(He){console.error("[Caixa][Fechamento][Error]",{sessaoId:se.id,message:He?.message,code:He?.code}),e({title:"Falha ao carregar fechamento",description:He?.message||"Tente novamente",variant:"destructive"})}finally{xt(!1)}},children:[a.jsx(bn,{children:se.aberto_em?new Date(se.aberto_em).toLocaleString("pt-BR"):""}),a.jsx(bn,{children:se.fechado_em?new Date(se.fechado_em).toLocaleString("pt-BR"):""}),a.jsx(bn,{className:"text-right",children:yt(se.saldo_inicial)}),a.jsx(bn,{className:"text-right",children:se.valor_final_dinheiro!=null?yt(se.valor_final_dinheiro):""}),a.jsx(bn,{children:String(se.status||"").toLowerCase()==="open"?"Aberto":"Fechado"})]},se.id))]})]})}),a.jsx("div",{className:"md:hidden space-y-3",children:ne.map(se=>a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 cursor-pointer hover:bg-surface-2/80 transition-colors",onClick:async()=>{bt(!0),xt(!0),ht(null);try{const He=t?.codigo_empresa;let ot=await SS({caixaSessaoId:se.id,codigoEmpresa:He}),k=(Le=>{if(!Le)return null;if(Le.total_bruto!=null||Le.por_finalizadora!=null){let it=Le.por_finalizadora;if(it&&typeof it=="string")try{it=JSON.parse(it)}catch{it={}}return{from:Le.periodo_de||null,to:Le.periodo_ate||null,totalPorFinalizadora:it||{},totalEntradas:Number(Le.total_entradas||0),totalVendasBrutas:Number(Le.total_bruto||0),totalDescontos:Number(Le.total_descontos||0),totalVendasLiquidas:Number(Le.total_liquido||0)}}return Le})(ot);k||(k=await Nd({from:se.aberto_em,to:se.fechado_em||new Date().toISOString(),codigoEmpresa:He}));const T={...se,saldo_inicial:ot&&typeof ot.saldo_inicial<"u"?Number(ot.saldo_inicial):se.saldo_inicial,saldo_final:ot&&typeof ot.saldo_final<"u"?Number(ot.saldo_final):se.saldo_final},K=await ng({caixaSessaoId:se.id,codigoEmpresa:He}),H=ot&&ot.movimentos?ot.movimentos:null,F=ot&&typeof ot.valor_final_dinheiro<"u"?Number(ot.valor_final_dinheiro):null;ht({resumo:k,movimentacoes:K,movimentosAgg:H,sessao:T,pagamentos:[],valorFinalContado:F})}catch(He){console.error("[Caixa][Fechamento][Error]",He),e({title:"Erro ao carregar detalhes",description:He?.message,variant:"destructive"})}finally{xt(!1)}},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"text-sm font-semibold text-text-primary",children:["Sesso #",se.id]}),a.jsx("div",{className:`text-xs px-2 py-1 rounded-full ${se.status==="fechado"?"bg-success/20 text-success":"bg-warning/20 text-warning"}`,children:String(se.status||"").toLowerCase()==="open"?"Aberto":"Fechado"})]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Aberto em:"}),a.jsx("span",{className:"text-text-primary",children:se.aberto_em?new Date(se.aberto_em).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):""})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Fechado em:"}),a.jsx("span",{className:"text-text-primary",children:se.fechado_em?new Date(se.fechado_em).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):""})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Saldo Inicial:"}),a.jsx("span",{className:"font-semibold text-info",children:yt(se.saldo_inicial)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Saldo Final (contado):"}),a.jsx("span",{className:"font-semibold text-success",children:se.valor_final_dinheiro!=null?yt(se.valor_final_dinheiro):""})]})]}),a.jsx("div",{className:"mt-3 text-xs text-text-muted text-center",children:"Toque para ver detalhes"})]},se.id))})]})]})}),a.jsx(is,{value:"recebimentos",className:"space-y-6 mt-6",children:a.jsxs(xr.div,{variants:xl,className:"fx-card p-4 border-0 ring-0 outline-none shadow-none",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4",children:[a.jsx("h2",{className:"text-lg font-bold",children:"Todos os Recebimentos"}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx(Zs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(rt,{placeholder:"Buscar...",value:Ct,onChange:se=>wt(se.target.value),className:"pl-10 w-full md:w-[200px]"})]}),a.jsxs(vn,{value:_e,onValueChange:je,children:[a.jsx(hn,{className:"w-full md:w-[160px] h-9 bg-black border-warning/40 text-white",children:a.jsx(wn,{placeholder:"Todas as Fontes"})}),a.jsxs(pn,{className:"bg-black text-white border-warning/40",children:[a.jsx(ct,{value:"all",children:"Todas as Fontes"}),a.jsx(ct,{value:"manual",children:"Manual"}),a.jsx(ct,{value:"xml",children:"XML"})]})]}),a.jsxs(fe,{variant:"outline",size:"sm",onClick:()=>{try{const se=nn||[],ot=[["Data/Hora","Origem","Fonte","Descrio","Finalizadora","Valor","Status"].join(";")];for(const Le of se){const it=[Le.recebido_em?new Date(Le.recebido_em).toLocaleString("pt-BR"):"",Le.origem??"",Le.fonte??"",(Le.descricao??"").replaceAll('"','""'),(Le.finalizadoras?.nome||Le.metodo||"").replaceAll('"','""'),String(qt(Le.valor)).replace(".",","),Le.status??""].map(lt=>`"${String(lt)}"`).join(";");ot.push(it)}const ee="\uFEFF"+ot.join(`
`),k=new Blob([ee],{type:"text/csv;charset=utf-8;"}),T=URL.createObjectURL(k),K=c?new Date(c+"T00:00:00").toLocaleDateString("pt-BR"):"",H=u?new Date(u+"T00:00:00").toLocaleDateString("pt-BR"):"",F=document.createElement("a");F.href=T,F.download=`recebimentos_${K}_a_${H}.csv`,document.body.appendChild(F),F.click(),document.body.removeChild(F),URL.revokeObjectURL(T)}catch(se){e({title:"Falha ao exportar CSV",description:se?.message,variant:"destructive"})}},children:[a.jsx(uo,{className:"h-4 w-4 mr-2"})," Exportar CSV"]})]})]}),i?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-brand border-r-transparent"}),a.jsx("p",{className:"mt-4 text-text-muted",children:"Carregando..."})]}):nn.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem registros no perodo."}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs(yl,{children:[a.jsx(bl,{children:a.jsxs(qa,{children:[a.jsx(On,{children:"Data/Hora"}),a.jsx(On,{children:"Origem"}),a.jsx(On,{children:"Fonte"}),a.jsx(On,{children:"Descrio"}),a.jsx(On,{children:"Finalizadora"}),a.jsx(On,{className:"text-right",children:"Valor"}),a.jsx(On,{children:"Status"})]})}),a.jsx(wl,{children:nn.map(se=>a.jsxs(qa,{className:"cursor-pointer hover:bg-surface-2",onClick:()=>{ln(se),ur(!0)},children:[a.jsx(bn,{children:se.recebido_em?new Date(se.recebido_em).toLocaleString("pt-BR"):""}),a.jsx(bn,{children:se.origem||""}),a.jsx(bn,{children:se.fonte?se.fonte.toUpperCase():""}),a.jsx(bn,{className:"truncate max-w-[260px]",title:se.descricao||"",children:se.descricao||""}),a.jsx(bn,{children:se.finalizadoras?.nome||se.metodo||""}),a.jsx(bn,{className:"text-right font-semibold",children:yt(se.valor)}),a.jsx(bn,{children:se.status||""})]},se.id))})]})}),a.jsx("div",{className:"md:hidden space-y-3",children:nn.map(se=>a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 cursor-pointer hover:bg-surface-2/80 transition-colors",onClick:()=>{ln(se),ur(!0)},children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-sm font-semibold text-text-primary",children:se.origem||"Recebimento"}),a.jsx("div",{className:`text-xs px-2 py-1 rounded-full ${se.status==="Pago"?"bg-success/20 text-success":se.status==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:se.status||"Pendente"})]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Data/Hora:"}),a.jsx("span",{className:"text-text-primary",children:se.recebido_em?new Date(se.recebido_em).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):""})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Fonte:"}),a.jsx("span",{className:"text-text-primary font-medium",children:se.fonte?se.fonte.toUpperCase():""})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-secondary",children:"Finalizadora:"}),a.jsx("span",{className:"text-text-primary",children:se.finalizadoras?.nome||se.metodo||""})]}),se.descricao&&a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsx("span",{className:"text-text-secondary",children:"Descrio:"}),a.jsx("span",{className:"text-text-primary text-xs bg-surface/50 p-2 rounded",children:se.descricao})]}),a.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-border/50",children:[a.jsx("span",{className:"text-text-secondary",children:"Valor:"}),a.jsx("span",{className:"font-bold text-lg text-success",children:yt(se.valor)})]})]}),a.jsx("div",{className:"mt-3 text-xs text-text-muted text-center",children:"Toque para ver detalhes"})]},se.id))})]})]})}),a.jsxs(is,{value:"relatorios",className:"space-y-6 mt-6",children:[a.jsxs(xr.div,{variants:xl,className:"fx-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[a.jsx(ei,{className:"w-5 h-5 text-success"}),"Faturamento Consolidado"]}),a.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Resumo geral das receitas no perodo"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(fe,{variant:"outline",size:"sm",className:"bg-success/10 border-success/40 text-success hover:bg-success/20",onClick:()=>{const He=[["Mtrica","Valor"],["Receita de Comandas",yt(v)],["Receita de Agendamentos",yt(y)],["Receita Total",yt(Number(v||0)+Number(y||0))],["Perodo",`${c||"N/A"} at ${u||"N/A"}`]].map(T=>T.map(K=>`"${K}"`).join(";")).join(`
`),ot=new Blob(["\uFEFF"+He],{type:"text/csv;charset=utf-8;"}),ee=URL.createObjectURL(ot),k=document.createElement("a");k.href=ee,k.download=`faturamento_consolidado_${cr(new Date,"yyyy-MM-dd")}.csv`,k.click(),URL.revokeObjectURL(ee),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[a.jsx(uo,{className:"w-4 h-4 mr-2"}),"CSV"]}),a.jsxs(fe,{variant:"outline",size:"sm",className:"bg-success/10 border-success/40 text-success hover:bg-success/20",onClick:()=>{const se=[["Receita de Comandas",yt(v)],["Receita de Agendamentos",yt(y)],["Receita Total",yt(Number(v||0)+Number(y||0))]];pt("Faturamento Consolidado",["Mtrica","Valor"],se,"faturamento_consolidado")},children:[a.jsx(Zg,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"p-4 bg-success/5 border border-success/20 rounded-lg",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Receita Comandas"}),a.jsx("div",{className:"text-2xl font-bold text-success",children:yt(v)}),a.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Vendas no perodo"})]}),a.jsxs("div",{className:"p-4 bg-purple-500/5 border border-purple-500/20 rounded-lg",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Receita Agendamentos"}),a.jsx("div",{className:"text-2xl font-bold text-purple-400",children:yt(y)}),a.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Reservas pagas"})]}),a.jsxs("div",{className:"p-4 bg-brand/5 border border-brand/20 rounded-lg",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Receita Total"}),a.jsx("div",{className:"text-2xl font-bold text-brand",children:yt(Number(v||0)+Number(y||0))}),a.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Perodo selecionado"})]})]})]}),a.jsxs(xr.div,{variants:xl,className:"fx-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[a.jsx(Qm,{className:"w-5 h-5 text-info"}),"Pagamentos por Mtodo"]}),a.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Distribuio por finalizadora"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(fe,{variant:"outline",size:"sm",className:"bg-info/10 border-info/40 text-info hover:bg-info/20",onClick:()=>{const se=h?.totalPorFinalizadora||{},He=Object.entries(se).map(([F,Le])=>[F,yt(Le)]).sort((F,Le)=>{const it=Number(String(F[1]).replace(/[^\d,]/g,"").replace(",","."));return Number(String(Le[1]).replace(/[^\d,]/g,"").replace(",","."))-it}),ot=Object.values(se).reduce((F,Le)=>F+Le,0),k=[["Mtodo de Pagamento","Valor","% do Total"],...He.map(([F,Le])=>{const lt=((Object.entries(se).find(([Vt])=>Vt===F)?.[1]||0)/ot*100).toFixed(1)+"%";return[F,Le,lt]}),["TOTAL",yt(ot),"100%"]].map(F=>F.map(Le=>`"${Le}"`).join(";")).join(`
`),T=new Blob(["\uFEFF"+k],{type:"text/csv;charset=utf-8;"}),K=URL.createObjectURL(T),H=document.createElement("a");H.href=K,H.download=`pagamentos_por_metodo_${cr(new Date,"yyyy-MM-dd")}.csv`,H.click(),URL.revokeObjectURL(K),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[a.jsx(uo,{className:"w-4 h-4 mr-2"}),"CSV"]}),a.jsxs(fe,{variant:"outline",size:"sm",className:"bg-info/10 border-info/40 text-info hover:bg-info/20",onClick:()=>{const se=h?.totalPorFinalizadora||{},He=Object.values(se).reduce((ee,k)=>ee+k,0),ot=Object.entries(se).sort(([,ee],[,k])=>k-ee).map(([ee,k])=>[ee,yt(k),(k/He*100).toFixed(1)+"%"]);ot.push(["TOTAL",yt(He),"100%"]),pt("Pagamentos por Mtodo",["Mtodo","Valor","% do Total"],ot,"pagamentos_por_metodo")},children:[a.jsx(Zg,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),Object.keys(h?.totalPorFinalizadora||{}).length===0?a.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem pagamentos no perodo."}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs(yl,{children:[a.jsx(bl,{children:a.jsxs(qa,{children:[a.jsx(On,{children:"Mtodo de Pagamento"}),a.jsx(On,{className:"text-right",children:"Valor"}),a.jsx(On,{className:"text-right",children:"% do Total"})]})}),a.jsxs(wl,{children:[Object.entries(h?.totalPorFinalizadora||{}).sort(([,se],[,He])=>He-se).map(([se,He])=>{const ot=Object.values(h?.totalPorFinalizadora||{}).reduce((k,T)=>k+T,0),ee=(He/ot*100).toFixed(1);return a.jsxs(qa,{children:[a.jsx(bn,{className:"font-medium",children:se}),a.jsx(bn,{className:"text-right font-semibold",children:yt(He)}),a.jsxs(bn,{className:"text-right text-text-secondary",children:[ee,"%"]})]},se)}),a.jsxs(qa,{className:"bg-surface-2 font-bold",children:[a.jsx(bn,{children:"TOTAL"}),a.jsx(bn,{className:"text-right",children:yt(Object.values(h?.totalPorFinalizadora||{}).reduce((se,He)=>se+He,0))}),a.jsx(bn,{className:"text-right",children:"100%"})]})]})]})})]}),a.jsxs(xr.div,{variants:xl,className:"fx-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[a.jsx(Td,{className:"w-5 h-5 text-purple-400"}),"Produtos Mais Vendidos"]}),a.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Top produtos por faturamento"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(fe,{variant:"outline",size:"sm",className:"bg-purple-500/10 border-purple-500/40 text-purple-400 hover:bg-purple-500/20",onClick:()=>{const He=[["Posio","Produto","Faturamento"],...S.slice(0,50).map((T,K)=>[K+1,T.nome,yt(T.valor)])].map(T=>T.map(K=>`"${K}"`).join(";")).join(`
`),ot=new Blob(["\uFEFF"+He],{type:"text/csv;charset=utf-8;"}),ee=URL.createObjectURL(ot),k=document.createElement("a");k.href=ee,k.download=`produtos_vendidos_${cr(new Date,"yyyy-MM-dd")}.csv`,k.click(),URL.revokeObjectURL(ee),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[a.jsx(uo,{className:"w-4 h-4 mr-2"}),"CSV"]}),a.jsxs(fe,{variant:"outline",size:"sm",className:"bg-purple-500/10 border-purple-500/40 text-purple-400 hover:bg-purple-500/20",onClick:()=>{const se=S.slice(0,50).map((He,ot)=>[ot+1,He.nome,yt(He.valor)]);pt("Produtos Mais Vendidos",["#","Produto","Faturamento"],se,"produtos_vendidos")},children:[a.jsx(Zg,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),S.length===0?a.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem produtos vendidos no perodo."}):a.jsxs("div",{className:"overflow-x-auto",children:[a.jsxs(yl,{children:[a.jsx(bl,{children:a.jsxs(qa,{children:[a.jsx(On,{className:"w-16",children:"#"}),a.jsx(On,{children:"Produto"}),a.jsx(On,{className:"text-right",children:"Faturamento"})]})}),a.jsx(wl,{children:S.slice(0,20).map((se,He)=>a.jsxs(qa,{children:[a.jsx(bn,{className:"text-text-secondary font-mono",children:He+1}),a.jsx(bn,{className:"font-medium",children:se.nome}),a.jsx(bn,{className:"text-right font-semibold",children:yt(se.valor)})]},`${se.nome}-${He}`))})]}),S.length>20&&a.jsx("div",{className:"text-center mt-4",children:a.jsxs(fe,{variant:"ghost",size:"sm",className:"text-brand hover:text-brand/80",onClick:()=>W(!0),children:["Ver todos os ",S.length," produtos"]})})]})]}),a.jsxs(xr.div,{variants:xl,className:"fx-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[a.jsx(Pl,{className:"w-5 h-5 text-warning"}),"Clientes que Mais Consomem"]}),a.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Ranking por faturamento total"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(fe,{variant:"outline",size:"sm",className:"bg-warning/10 border-warning/40 text-warning hover:bg-warning/20",onClick:()=>{const He=[["Posio","Cliente","Faturamento"],...P.slice(0,50).map((T,K)=>[K+1,T.nome,yt(T.valor)])].map(T=>T.map(K=>`"${K}"`).join(";")).join(`
`),ot=new Blob(["\uFEFF"+He],{type:"text/csv;charset=utf-8;"}),ee=URL.createObjectURL(ot),k=document.createElement("a");k.href=ee,k.download=`clientes_top_${cr(new Date,"yyyy-MM-dd")}.csv`,k.click(),URL.revokeObjectURL(ee),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[a.jsx(uo,{className:"w-4 h-4 mr-2"}),"CSV"]}),a.jsxs(fe,{variant:"outline",size:"sm",className:"bg-warning/10 border-warning/40 text-warning hover:bg-warning/20",onClick:()=>{const se=P.slice(0,50).map((He,ot)=>[ot+1,He.nome,yt(He.valor)]);pt("Clientes que Mais Consomem",["#","Cliente","Total Gasto"],se,"clientes_top")},children:[a.jsx(Zg,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),P.length===0?a.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem dados de clientes no perodo."}):a.jsxs("div",{className:"overflow-x-auto",children:[a.jsxs(yl,{children:[a.jsx(bl,{children:a.jsxs(qa,{children:[a.jsx(On,{className:"w-16",children:"#"}),a.jsx(On,{children:"Cliente"}),a.jsx(On,{className:"text-right",children:"Total Gasto"})]})}),a.jsx(wl,{children:P.slice(0,20).map((se,He)=>a.jsxs(qa,{children:[a.jsx(bn,{className:"text-text-secondary font-mono",children:He+1}),a.jsx(bn,{className:"font-medium",children:se.nome}),a.jsx(bn,{className:"text-right font-semibold",children:yt(se.valor)})]},`${se.nome}-${He}`))})]}),P.length>20&&a.jsx("div",{className:"text-center mt-4",children:a.jsxs(fe,{variant:"ghost",size:"sm",className:"text-brand hover:text-brand/80",onClick:()=>X(!0),children:["Ver todos os ",P.length," clientes"]})})]})]}),a.jsxs(xr.div,{variants:xl,className:"fx-card p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[a.jsx(Jf,{className:"w-5 h-5 text-success"}),"Evoluo Diria de Receitas"]}),a.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Faturamento dia a dia no perodo"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(fe,{variant:"outline",size:"sm",className:"bg-success/10 border-success/40 text-success hover:bg-success/20",onClick:()=>{const He=[["Data","Receita"],...R.map(T=>[T.data,yt(T.valor)])].map(T=>T.map(K=>`"${K}"`).join(";")).join(`
`),ot=new Blob(["\uFEFF"+He],{type:"text/csv;charset=utf-8;"}),ee=URL.createObjectURL(ot),k=document.createElement("a");k.href=ee,k.download=`evolucao_diaria_${cr(new Date,"yyyy-MM-dd")}.csv`,k.click(),URL.revokeObjectURL(ee),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[a.jsx(uo,{className:"w-4 h-4 mr-2"}),"CSV"]}),a.jsxs(fe,{variant:"outline",size:"sm",className:"bg-success/10 border-success/40 text-success hover:bg-success/20",onClick:()=>{const se=R.map(He=>[He.data,yt(He.valor)]);pt("Evoluo Diria de Receitas",["Data","Receita"],se,"evolucao_diaria")},children:[a.jsx(Zg,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),R.length===0?a.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem dados de evoluo no perodo."}):a.jsx("div",{className:"h-80",children:a.jsx(fb,{width:"100%",height:"100%",children:a.jsxs(jee,{data:R,margin:{top:5,right:20,bottom:5,left:0},children:[a.jsx(mS,{strokeDasharray:"3 3",stroke:"#2a2a2a"}),a.jsx(Fh,{dataKey:"data",stroke:"#888",tick:{fill:"#888",fontSize:11},tickFormatter:se=>{const He=se.split("/");return`${He[0]}/${He[1]}`}}),a.jsx($h,{stroke:"#888",tick:{fill:"#888",fontSize:11},tickFormatter:se=>`R$ ${(se/1e3).toFixed(0)}k`}),a.jsx(Xl,{contentStyle:{backgroundColor:"#1a1a1a",border:"1px solid #333",borderRadius:"8px"},labelStyle:{color:"#fff"},itemStyle:{color:"#22C55E"},formatter:se=>[yt(se),"Receita"]}),a.jsx(U0,{type:"monotone",dataKey:"valor",stroke:"#22C55E",strokeWidth:2,dot:{fill:"#22C55E",r:4},activeDot:{r:6}})]})})})]})]})]}),a.jsx(mn,{open:dr,onOpenChange:ur,children:a.jsxs(un,{className:"max-w-lg",children:[a.jsxs(on,{children:[a.jsx(an,{className:"text-xl font-bold",children:"Detalhes do Recebimento"}),a.jsx(Nn,{children:er?.origem==="Comanda"?"Operao de comanda":er?.origem==="Agendamento"?"Operao de agendamento":"Operao"})]}),er&&a.jsxs("div",{className:"space-y-3 text-sm",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Data/Hora"}),a.jsx("div",{className:"font-medium",children:er.recebido_em?new Date(er.recebido_em).toLocaleString("pt-BR"):""})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Valor"}),a.jsx("div",{className:"font-semibold",children:yt(er.valor)})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Origem"}),a.jsx("div",{children:er.origem||""})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Fonte"}),a.jsx("div",{children:er.fonte?er.fonte.toUpperCase():""})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Finalizadora"}),a.jsx("div",{children:er.finalizadoras?.nome||er.metodo||""})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Status"}),a.jsx("div",{children:er.status||""})]})]}),er.origem==="Comanda"&&a.jsxs("div",{className:"mt-2 p-3 rounded border border-border",children:[a.jsx("div",{className:"font-semibold mb-2",children:"Comanda"}),a.jsx("div",{className:"grid grid-cols-2 gap-3",children:a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Cliente"}),a.jsx("div",{children:er.descricao||""})]})}),a.jsxs("div",{className:"mt-3",children:[a.jsx("div",{className:"text-text-muted mb-1",children:"Produtos"}),$e?a.jsx("div",{className:"text-xs text-text-muted",children:"Carregando itens..."}):Mr.length===0?a.jsx("div",{className:"text-xs text-text-muted",children:"Sem itens encontrados."}):a.jsx("div",{className:"max-h-48 overflow-y-auto space-y-1",children:Mr.map((se,He)=>a.jsxs("div",{className:"text-xs flex justify-between gap-3",children:[a.jsxs("div",{className:"truncate",children:[a.jsx("span",{className:"font-mono",children:qt(se.quantidade)}),a.jsx("span",{children:" x "}),a.jsx("span",{className:"font-medium",children:se.descricao})]}),a.jsx("div",{className:"whitespace-nowrap",children:yt(Number(se.preco_unitario||0)*Number(se.quantidade||0))})]},He))})]}),a.jsxs("div",{className:"mt-4",children:[a.jsx("div",{className:"text-text-muted mb-1",children:"Pagamentos"}),et.length===0?a.jsx("div",{className:"text-xs text-text-muted",children:"Sem pagamentos adicionais."}):a.jsxs("div",{className:"space-y-1",children:[et.map((se,He)=>a.jsxs("div",{className:"text-xs flex justify-between gap-3",children:[a.jsx("div",{className:"truncate",children:a.jsx("span",{className:"font-medium",children:se.finalizadoras?.nome||se.metodo||""})}),a.jsx("div",{className:"whitespace-nowrap",children:yt(se.valor)})]},se.id||He)),a.jsxs("div",{className:"text-xs flex justify-between gap-3 pt-2 border-t border-border",children:[a.jsx("div",{className:"font-semibold",children:"Total"}),a.jsx("div",{className:"font-semibold",children:yt(et.reduce((se,He)=>se+Number(He.valor||0),0))})]})]})]})]}),er.origem==="Agendamento"&&a.jsxs("div",{className:"mt-2 p-3 rounded border border-border",children:[a.jsx("div",{className:"font-semibold mb-2",children:"Agendamento"}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Cdigo"}),a.jsxs("div",{className:"font-mono",children:["#",er.agendamento_codigo]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-text-muted",children:"Participante"}),a.jsx("div",{children:er.participante_nome})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("div",{className:"text-text-muted",children:"Quadra"}),a.jsx("div",{children:er.quadra_nome||""})]})]})]})]})]})}),a.jsx(mn,{open:z,onOpenChange:W,children:a.jsxs(un,{className:"max-w-2xl bg-surface text-text-primary border-0",children:[a.jsxs(on,{children:[a.jsx(an,{children:"Todos os Produtos"}),a.jsx(Nn,{children:"Ordenados por valor de vendas"})]}),a.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:a.jsxs(yl,{children:[a.jsx(bl,{children:a.jsxs(qa,{children:[a.jsx(On,{children:"Produto"}),a.jsx(On,{className:"text-center",children:"Quantidade"}),a.jsx(On,{className:"text-right",children:"Valor Total"})]})}),a.jsx(wl,{children:S.map((se,He)=>a.jsxs(qa,{children:[a.jsxs(bn,{children:[He+1,". ",se.nome]}),a.jsxs(bn,{className:"text-center",children:["x",se.quantidade]}),a.jsx(bn,{className:"text-right font-semibold",children:yt(se.valor)})]},`${se.nome}-${He}`))})]})})]})}),a.jsx(mn,{open:gt,onOpenChange:bt,children:a.jsxs(un,{className:"sm:max-w-[900px] w-full max-h-[85vh] overflow-y-auto bg-surface text-text-primary border-0",children:[a.jsxs(on,{children:[a.jsx(an,{children:"Fechamento do Caixa"}),a.jsxs(Nn,{children:[Ze?.sessao?.aberto_em?`${new Date(Ze.sessao.aberto_em).toLocaleString("pt-BR")}`:"",Ze?.sessao?.fechado_em?`  ${new Date(Ze.sessao.fechado_em).toLocaleString("pt-BR")}`:""]})]}),at?a.jsx("div",{className:"text-sm text-text-muted",children:"Carregando..."}):Ze?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Saldo Inicial"}),a.jsx("p",{className:"text-2xl font-bold tabular-nums",children:yt(Ze.sessao?.saldo_inicial)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Total do Dia"}),a.jsx("p",{className:"text-2xl font-bold text-success tabular-nums",children:(()=>{const se=Number(Ze.resumo?.totalEntradas||0),He=Array.isArray(Ze.movimentacoes)?Ze.movimentacoes:[];let ot=0,ee=0,k=0,T=0;for(const H of He){const F=String(H?.tipo||"").toLowerCase(),Le=Number(H?.valor||0);F==="suprimento"?ot+=Le:F==="sangria"?ee+=Le:F==="troco"?k+=Le:F==="ajuste"&&(T+=Le)}const K=se+ot+T-ee-k;return yt(K)})()})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Saldo Final (contado)"}),a.jsx("p",{className:"text-2xl font-bold tabular-nums",children:(()=>{const se=Ze&&typeof Ze.valorFinalContado=="number"?Ze.valorFinalContado:null;return se!=null?yt(se):""})()})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Descontos"}),a.jsx("p",{className:"text-2xl font-bold text-warning tabular-nums",children:yt(Ze.resumo?.totalDescontos)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Lquido"}),a.jsx("p",{className:"text-2xl font-bold tabular-nums",children:yt(Ze.resumo?.totalVendasLiquidas)})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Entradas por Finalizadora"}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2",children:Ze.resumo?.totalPorFinalizadora&&Object.keys(Ze.resumo.totalPorFinalizadora).length>0?Object.entries(Ze.resumo.totalPorFinalizadora).map(([se,He])=>a.jsxs("div",{className:"bg-surface-2 rounded-md p-2 border border-border flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-text-secondary truncate",children:String(se)}),a.jsx("span",{className:"text-sm font-semibold",children:yt(He)})]},se)):a.jsx("div",{className:"text-sm text-text-muted",children:"Sem pagamentos."})})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Movimentaes"}),!Ze.movimentacoes||Ze.movimentacoes.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem movimentaes nesta sesso."}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs(yl,{children:[a.jsx(bl,{children:a.jsxs(qa,{children:[a.jsx(On,{children:"Data"}),a.jsx(On,{children:"Tipo"}),a.jsx(On,{children:"Obs"}),a.jsx(On,{className:"text-right",children:"Valor"})]})}),a.jsx(wl,{children:Ze.movimentacoes.map(se=>a.jsxs(qa,{children:[a.jsx(bn,{children:se.created_at?new Date(se.created_at).toLocaleString("pt-BR"):""}),a.jsx(bn,{className:"capitalize",children:se.tipo||""}),a.jsx(bn,{className:"truncate max-w-[280px]",title:se.observacao||"",children:se.observacao||""}),a.jsx(bn,{className:"text-right font-semibold",children:yt(se.valor)})]},se.id))})]})})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Recebimentos"}),!Ze.pagamentos||Ze.pagamentos.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem recebimentos no perodo deste caixa."}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs(yl,{children:[a.jsx(bl,{children:a.jsxs(qa,{children:[a.jsx(On,{children:"Data/Hora"}),a.jsx(On,{children:"Finalizadora"}),a.jsx(On,{className:"text-right",children:"Valor"}),a.jsx(On,{children:"Status"})]})}),a.jsx(wl,{children:Ze.pagamentos.map(se=>a.jsxs(qa,{children:[a.jsx(bn,{children:se.recebido_em?new Date(se.recebido_em).toLocaleString("pt-BR"):""}),a.jsx(bn,{children:se.finalizadoras?.nome||se.metodo||""}),a.jsx(bn,{className:"text-right font-semibold",children:yt(se.valor)}),a.jsx(bn,{children:se.status||""})]},se.id))})]})})]})]}):a.jsx("div",{className:"text-sm text-text-muted",children:"Sem dados."})]})}),a.jsx(mn,{open:$,onOpenChange:se=>{X(se),se||(Se(null),B([]))},children:a.jsxs(un,{className:"max-w-2xl bg-surface text-text-primary border-0",children:[a.jsxs(on,{children:[a.jsx(an,{children:"Clientes"}),a.jsx(Nn,{children:"Ordenados por valor pago no perodo selecionado"})]}),a.jsx("div",{className:"max-h-[60vh] overflow-y-auto border border-border rounded-md",children:a.jsxs(yl,{children:[a.jsx(bl,{children:a.jsxs(qa,{children:[a.jsx(On,{children:"Cliente"}),a.jsx(On,{className:"text-right",children:"Pago"})]})}),a.jsx(wl,{children:P.map((se,He)=>a.jsxs(qa,{className:"cursor-pointer hover:bg-brand/10",onClick:async()=>{Y(!0),Se(se),pe(!0);try{const ot=Ft(c),ee=Dr(u),k=(se.nome||"").trim(),T=t?.codigo_empresa;let K=de.from("clientes").select("id, nome").eq("codigo_empresa",T).ilike("nome",`%${k}%`);const{data:H}=await K,F=new Set((H||[]).map(Pn=>Pn.id));let Le=de.from("comanda_clientes").select("comanda_id").eq("codigo_empresa",T).ilike("nome_livre",`%${k}%`);const{data:it}=await Le;let lt=new Set((it||[]).map(Pn=>Pn.comanda_id));if(F.size>0){let Pn=de.from("comanda_clientes").select("comanda_id, cliente_id").eq("codigo_empresa",T).in("cliente_id",Array.from(F));const{data:qn}=await Pn;(qn||[]).forEach(zn=>lt.add(zn.comanda_id))}const Vt=Array.from(lt);let Ve=de.from("pagamentos").select("id, valor, recebido_em, metodo, finalizadoras!pagamentos_finalizadora_id_fkey(nome), comanda_id, status").in("comanda_id",Vt).neq("status","Cancelado").neq("status","Estornado").order("recebido_em",{ascending:!1}).limit(50);ot&&(Ve=Ve.gte("recebido_em",ot)),ee&&(Ve=Ve.lte("recebido_em",ee));const{data:kt}=await Ve,Sr=kt||[],Or=Array.from(new Set(Sr.map(Pn=>Pn.comanda_id).filter(Boolean))),fr={};if(Or.length>0){let Pn=de.from("comandas").select("id, tipo, mesa_id").in("id",Or);const{data:qn}=await Pn,zn=Array.from(new Set((qn||[]).map(qr=>qr.mesa_id).filter(Boolean))),sn={};if(zn.length>0){let qr=de.from("mesas").select("id, numero, nome").in("id",zn);const{data:Sa}=await qr;(Sa||[]).forEach(_a=>{sn[_a.id]=(_a.nome||`Mesa ${_a.numero||""}`).trim()})}(qn||[]).forEach(qr=>{let Sa="";const _a=String(qr?.tipo||"").toLowerCase();_a==="balcao"||_a==="balco"?Sa="Balco":_a==="mesa"||qr.mesa_id?Sa=sn[qr.mesa_id]||"Mesa":_a==="agendamento"&&(Sa="Agendamento"),fr[qr.id]=Sa})}let Kr=Sr.map(Pn=>({...Pn,origem:Pn.comanda_id&&fr[Pn.comanda_id]||""}));try{const Pn=t?.codigo_empresa;let qn=[];if(F&&F.size>0){let da=de.from("v_agendamento_participantes").select("id, agendamento_id, cliente_id, valor_cota, status_pagamento, status_pagamento_text").in("cliente_id",Array.from(F));Pn&&(da=da.eq("codigo_empresa",Pn));const{data:Xs}=await da;if(qn=Xs||[],qn.length===0&&Pn){let Ys=de.from("v_agendamento_participantes").select("id, agendamento_id, cliente_id, valor_cota, status_pagamento, status_pagamento_text").in("cliente_id",Array.from(F));const{data:Za}=await Ys;qn=Za||[]}}let zn=[...qn];const sn=Array.from(new Set(zn.map(da=>da.agendamento_id).filter(Boolean)));let qr=new Set;const Sa={};if(sn.length>0){let da=de.from("agendamentos").select("id, inicio").in("id",sn);Pn&&(da=da.eq("codigo_empresa",Pn));const{data:Xs}=await da,Ys=ot?new Date(ot).getTime():null,Za=ee?new Date(ee).getTime():null;(Xs||[]).forEach(ol=>{const hs=ol?.inicio?new Date(ol.inicio).getTime():null;hs!=null&&(Ys==null||hs>=Ys)&&(Za==null||hs<=Za)&&qr.add(ol.id),ol?.id&&(Sa[ol.id]=ol.inicio||null)})}zn=zn.filter(da=>qr.has(da.agendamento_id));const _a=new Set;console.debug("[Financeiro][Agendamentos][Detalhe] encontrados:",zn.length),zn.forEach(da=>{const Xs=`${da.id}`;if(_a.has(Xs))return;_a.add(Xs);const Ys=String(da.status_pagamento||da.status_pagamento_text||"pago").toLowerCase();if(["cancelado","estornado"].includes(Ys))return;const Za=da.finalizadora_nome||da.metodo||da.metodo_pagamento||da.forma_pagamento||"Agendamento";Kr.push({id:`ag-${da.id}`,recebido_em:Sa[da.agendamento_id]||null,finalizadoras:Za?{nome:Za}:null,metodo:Za,origem:"Agendamento",valor:da.valor_cota})})}catch{}B(Kr)}finally{pe(!1)}},children:[a.jsx(bn,{children:se.nome}),a.jsx(bn,{className:"text-right font-semibold",children:yt(se.valor)})]},`${se.nome}-${He}`))})]})})]})}),a.jsx(mn,{open:te,onOpenChange:Y,children:a.jsxs(un,{className:"max-w-5xl w-[95vw] md:w-[90vw] max-h-[85vh] bg-surface text-text-primary border-0 overflow-hidden flex flex-col",children:[a.jsxs(on,{className:"flex-shrink-0",children:[a.jsx(an,{className:"text-lg md:text-xl",children:"Detalhes do Cliente"}),a.jsx(Nn,{className:"text-sm md:text-base",children:ye?.nome})]}),ye?a.jsxs("div",{className:"space-y-4 flex-1 overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"flex items-center justify-between p-3 md:p-4 bg-surface-2 rounded-lg flex-shrink-0",children:[a.jsx("span",{className:"text-sm md:text-base text-text-secondary",children:"Total Pago no Perodo"}),a.jsx("span",{className:"text-lg md:text-2xl font-bold text-success",children:yt(ye.valor)})]}),Q?a.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Carregando detalhes..."}):V.length===0?a.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem pagamentos no perodo selecionado."}):a.jsx("div",{className:"flex-1 overflow-auto border border-border rounded-md",children:a.jsxs(yl,{children:[a.jsx(bl,{className:"sticky top-0 bg-surface z-10",children:a.jsxs(qa,{children:[a.jsx(On,{className:"text-xs md:text-sm w-[70px] md:w-auto",children:"Data"}),a.jsx(On,{className:"text-xs md:text-sm w-[80px] md:w-auto",children:"Finaliz."}),a.jsx(On,{className:"text-xs md:text-sm w-[60px] md:w-auto",children:"Origem"}),a.jsx(On,{className:"text-right text-xs md:text-sm w-[70px] md:w-auto",children:"Valor"})]})}),a.jsx(wl,{children:V.map(se=>a.jsxs(qa,{children:[a.jsx(bn,{className:"text-xs md:text-sm w-[70px] md:w-auto",children:a.jsx("div",{className:"text-[10px] md:text-xs leading-tight",children:se.recebido_em?new Date(se.recebido_em).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}):""})}),a.jsx(bn,{className:"text-xs md:text-sm w-[80px] md:w-auto",children:a.jsx("div",{className:"truncate max-w-[80px] md:max-w-[200px] text-[10px] md:text-xs",title:se.finalizadoras?.nome||se.metodo||"",children:se.finalizadoras?.nome||se.metodo||""})}),a.jsx(bn,{className:"text-xs md:text-sm w-[60px] md:w-auto",children:a.jsx("div",{className:"truncate max-w-[60px] md:max-w-[150px] text-[10px] md:text-xs",title:se.origem||"",children:se.origem||""})}),a.jsx(bn,{className:"text-right font-semibold text-xs md:text-sm w-[70px] md:w-auto",children:a.jsx("div",{className:"text-[10px] md:text-xs whitespace-nowrap",children:yt(se.valor)})})]},se.id))})]})})]}):a.jsx("div",{className:"text-sm text-text-muted py-8 text-center",children:"Nenhum cliente selecionado"})]})})]})})}const Cot={hidden:{opacity:0},visible:{opacity:1,transition:{when:"beforeChildren",staggerChildren:.06,delayChildren:.05}}},JR={hidden:{opacity:0,y:12},visible:{opacity:1,y:0,transition:{duration:.35}}};function Pot({children:e,className:t=""}){return a.jsx(xr.div,{variants:JR,className:`fx-card ${t}`,children:e})}const mk=({icon:e,title:t,value:r,subtitle:n,color:s})=>{const o=e;return a.jsxs(xr.div,{variants:JR,className:"bg-surface rounded-lg border-2 border-border hover:border-border-hover p-4 flex flex-col justify-between gap-2 transition-all duration-300",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("p",{className:"text-text-secondary text-sm font-semibold",children:t}),a.jsx(o,{className:`w-5 h-5 ${s}`})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-2xl font-bold text-text-primary",children:r}),a.jsx("p",{className:"text-xs text-text-muted",children:n})]})]})};function tV({label:e,...t}){return a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:e}),a.jsx("input",{...t,className:`bg-surface-2 border border-border rounded-md px-3 py-2 text-sm ${t.className||""}`})]})}function Aot(){const{toast:e}=Qa(),{userProfile:t,authReady:r}=ms(),n=p.useRef(!1),[s,o]=p.useState(()=>{try{const be=JSON.parse(localStorage.getItem("quadras:list")||"[]");return Array.isArray(be)?be:[]}catch{return[]}}),[i,l]=p.useState(()=>{try{const be=JSON.parse(localStorage.getItem("quadras:list")||"[]");return!(Array.isArray(be)&&be.length>0)}catch{return!0}}),[c,d]=p.useState(!1),[u,f]=p.useState(!1),[h,m]=p.useState({nome:"",descricao:"",modalidades:[],tipo:"Descoberta",status:"Ativa",hora_inicio:"06:00",hora_fim:"23:59",valor_hora:""}),[v,g]=p.useState(""),[y,x]=p.useState(!1),[b,w]=p.useState(null),[j,_]=p.useState({nome:"",descricao:"",modalidades:[],tipo:"Descoberta",status:"Ativa",hora_inicio:"06:00",hora_fim:"23:59",valor_hora:""}),[S,C]=p.useState(""),[P,A]=p.useState(!0),[R,O]=p.useState({mostUsed:"-",topClient:"-",totalBookings:"-"}),[I,M]=p.useState(!1),[D,U]=p.useState(null),[z,W]=p.useState({0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0}),[$,X]=p.useState([]),[ye,Se]=p.useState(""),[V,B]=p.useState(""),[Q,pe]=p.useState(!1),te=be=>{if(!be)return null;const[Ct,wt]=String(be).split(":");return`${Ct.padStart(2,"0")}:${wt.padStart(2,"0")}:00`},Y=be=>{const Ct=String(be??"").replace(/\D/g,"");if(!Ct)return"";const wt=(Number(Ct)/100).toFixed(2),[Ge,Je]=wt.split(".");return`${Ge.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${Je}`},ce=be=>{if(be==null||be==="")return NaN;const Ct=String(be).replace(/\./g,"").replace(",","."),wt=parseFloat(Ct);return Number.isFinite(wt)?wt:NaN},me=(be,Ct=!1)=>{if(be==null||!Number.isFinite(Number(be)))return"-";const Ge=Number(be).toFixed(2).split("."),Je=Ge[0],_e=Ge[1],Ue=`${Je.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${_e}`;return Ct?`R$ ${Ue}`:Ue},ae=be=>{if(!be)return"";const[Ct,wt]=String(be).split(":");return`${String(Ct).padStart(2,"0")}:${String(wt).padStart(2,"0")}`},le=be=>{if(!be)return 0;const[Ct,wt]=String(be).split(":").map(Number);return(Ct===0&&wt===0?24:Ct||0)*60+(wt||0)},ue=be=>{if(!be)return!1;const Ct=String(be).split(":");if(Ct.length<2)return!1;const wt=Number(Ct[1]);return wt===0||wt===30},Re=be=>{if(!be)return"";const[Ct,wt]=String(be).split(":");let Ge=Math.max(0,Math.min(23,parseInt(Ct||"0",10))),Je=Math.max(0,Math.min(59,parseInt(wt||"0",10)));const _e=Math.round(Je/30);if(_e>=2?(Ge+=1,Je=0):Je=_e*30,Ge>=24)return"23:59";const je=String(Ge).padStart(2,"0"),Ue=String(Je).padStart(2,"0");return`${je}:${Ue}`};p.useEffect(()=>{if(!c)return;const be=setTimeout(()=>{console.error("[Quadras] add/update stuck >15s",{route:"/quadras",codigo_empresa:t?.codigo_empresa,editingId:b,formQuadra:h,editForm:j})},15e3);return()=>clearTimeout(be)},[c,t?.codigo_empresa,b,h,j]);const ne=async()=>{if(!t?.codigo_empresa)return;const be=s&&s.length>0;be||l(!0);const{data:Ct,error:wt}=await de.from("quadras").select("*").eq("codigo_empresa",t.codigo_empresa).order("nome",{ascending:!0});if(wt){if(!n.current){n.current=!0,setTimeout(ne,800),be||l(!1);return}e({title:"Erro ao carregar quadras",description:wt.message}),be||l(!1);return}const Ge=Ct||[];if(Ge.length===0&&be&&!n.current){n.current=!0,setTimeout(ne,600),be||l(!1);return}n.current=!1,o(Ge);try{localStorage.setItem("quadras:list",JSON.stringify(Ge))}catch{}be||l(!1)},ie=be=>{w(be.id),_({nome:be.nome||"",descricao:be.descricao||"",modalidades:Array.isArray(be.modalidades)?be.modalidades:be.modalidades?[be.modalidades]:[],tipo:be.tipo||"Descoberta",status:be.status||"Ativa",hora_inicio:ae(be.hora_inicio||"06:00:00"),hora_fim:ae(be.hora_fim||"24:00:00")||"23:59",valor_hora:be.valor!=null&&be.valor!==""?Y(String((Number(be.valor)*2).toFixed(2))):""}),C(""),x(!0)},gt=async()=>{if(!j.nome?.trim()){e({title:"Nome obrigatrio",description:"Informe um nome para a quadra."});return}if(!j.hora_inicio||!j.hora_fim){e({title:"Horrio obrigatrio",description:"Informe horrio de abertura e fechamento."});return}if(!ue(j.hora_inicio)||!ue(j.hora_fim)){e({title:"Intervalo invlido",description:"Use apenas horrios em horas cheias ou :30."});return}if(le(j.hora_fim)<=le(j.hora_inicio)){e({title:"Horrio invlido",description:"Fechamento deve ser depois da abertura."});return}if(!j.modalidades?.length){e({title:"Adicione ao menos uma modalidade",description:"Informe e adicione uma modalidade usando o boto +."});return}if(!t?.codigo_empresa||!b){e({title:"Atualizao indisponvel",description:"Dados insuficientes para atualizar."});return}d(!0);const be={nome:j.nome.trim(),descricao:j.descricao?.trim()||null,modalidades:j.modalidades,tipo:j.tipo,status:j.status,hora_inicio:te(j.hora_inicio),hora_fim:te(j.hora_fim==="24:00"?"23:59":j.hora_fim)};if(j.valor_hora!=null&&String(j.valor_hora).trim()!==""){const Je=ce(j.valor_hora);!Number.isNaN(Je)&&Number.isFinite(Je)&&(be.valor=Math.round(Je/2*100)/100)}else be.valor=null;const Ct=(Je,_e)=>Promise.race([Je,new Promise((je,Ue)=>setTimeout(()=>Ue(new Error("Timeout ao atualizar quadra (>12s)")),_e))]);let wt,Ge;try{({data:wt,error:Ge}=await Ct(de.from("quadras").update(be).eq("codigo_empresa",t.codigo_empresa).eq("id",b).select("id,nome,descricao,modalidades,tipo,status,hora_inicio,hora_fim,valor").single(),12e3))}catch(Je){console.error("update timeout/error",Je),e({title:"Tempo excedido",description:"Sem resposta do servidor ao atualizar. Verifique conexo e tente novamente."}),d(!1);return}if(d(!1),Ge){e({title:"Erro ao atualizar quadra",description:Ge.message});return}if(!wt){await ne(),e({title:"Quadra atualizada",description:`${be.nome} foi atualizada.`}),x(!1),w(null),C("");return}e({title:"Quadra atualizada",description:`${wt.nome} foi atualizada.`}),x(!1),w(null),C(""),o(Je=>Je.map(_e=>_e.id===wt.id?wt:_e).sort((_e,je)=>_e.nome.localeCompare(je.nome)))};p.useEffect(()=>{try{const be=JSON.parse(localStorage.getItem("quadras:list")||"[]");Array.isArray(be)&&be.length&&s.length===0&&(o(be),l(!1))}catch{}},[]),p.useEffect(()=>{r&&t?.codigo_empresa&&(ne(),bt())},[r,t?.codigo_empresa]);const bt=async()=>{if(t?.codigo_empresa)try{const be=new Date;be.setDate(be.getDate()-30);const{data:Ct}=await de.from("agendamentos").select("quadra_id, cliente_id, quadras!inner(nome), clientes(nome, codigo)").eq("codigo_empresa",t.codigo_empresa).gte("inicio",be.toISOString()).neq("status","canceled");if(!Ct||Ct.length===0){O({mostUsed:"Sem dados",topClient:"Sem dados",totalBookings:"0"});return}const wt={};Ct.forEach(je=>{const Ue=je.quadras?.nome||"Sem nome";wt[Ue]=(wt[Ue]||0)+1});const Ge=Object.entries(wt).sort((je,Ue)=>Ue[1]-je[1])[0],Je={};Ct.forEach(je=>{if(je.cliente_id&&je.clientes?.nome){const Ue=je.clientes?.codigo;if(Ue===0||Ue==="0")return;const ze=je.clientes.nome;Je[ze]=(Je[ze]||0)+1}});const _e=Object.entries(Je).sort((je,Ue)=>Ue[1]-je[1])[0];O({mostUsed:Ge?`${Ge[0]} (${Ge[1]})`:"Sem dados",topClient:_e?`${_e[0]} (${_e[1]})`:"Sem dados",totalBookings:Ct.length.toString()})}catch(be){console.error("Erro ao carregar stats:",be),O({mostUsed:"Erro",topClient:"Erro",totalBookings:"0"})}},at=async()=>{if(console.groupCollapsed("[Quadras] addQuadra: CLICK"),console.time("[Quadras] addQuadra duration"),console.log("pre-validate",{codigo_empresa:t?.codigo_empresa,formQuadra:h}),!h.nome?.trim()){e({title:"Nome obrigatrio",description:"Informe um nome para a quadra."}),console.warn("validation: missing nome"),console.groupEnd();return}if(!h.modalidades?.length){e({title:"Adicione ao menos uma modalidade",description:"Informe e adicione uma modalidade usando o boto +."});return}if(!h.hora_inicio||!h.hora_fim){e({title:"Horrio obrigatrio",description:"Informe horrio de abertura e fechamento."});return}if(!ue(h.hora_inicio)||!ue(h.hora_fim)){e({title:"Intervalo invlido",description:"Use apenas horrios em horas cheias ou :30."});return}if(le(h.hora_fim)<=le(h.hora_inicio)){e({title:"Horrio invlido",description:"Fechamento deve ser depois da abertura."});return}if(!t?.codigo_empresa){e({title:"Empresa no localizada",description:"Associe o usurio a uma empresa para cadastrar quadras."});return}d(!0),console.log("validated, building payload");const be={codigo_empresa:t.codigo_empresa,nome:h.nome.trim(),descricao:h.descricao?.trim()||null,modalidades:h.modalidades,tipo:h.tipo,status:h.status,hora_inicio:te(h.hora_inicio),hora_fim:te(h.hora_fim==="24:00"?"23:59":h.hora_fim)};if(h.valor_hora!=null&&String(h.valor_hora).trim()!==""){const Je=ce(h.valor_hora);!Number.isNaN(Je)&&Number.isFinite(Je)&&(be.valor=Math.round(Je/2*100)/100)}console.log("payload",be);const Ct=(Je,_e)=>Promise.race([Je,new Promise((je,Ue)=>setTimeout(()=>Ue(new Error("Timeout ao inserir quadra (>12s)")),_e))]);let wt,Ge;try{({data:wt,error:Ge}=await Ct(de.from("quadras").insert(be).select("id,nome,descricao,modalidades,tipo,status,hora_inicio,hora_fim,valor").single(),12e3))}catch(Je){d(!1),console.error("insert timeout/error",Je),e({title:"Tempo excedido",description:"Sem resposta do servidor ao cadastrar. Verifique conexo e tente novamente."}),console.timeEnd("[Quadras] addQuadra duration"),console.groupEnd();return}if(d(!1),Ge){e({title:"Erro ao cadastrar quadra",description:Ge.message}),console.error("insert error",{code:Ge.code,message:Ge.message,details:Ge.details}),console.timeEnd("[Quadras] addQuadra duration"),console.groupEnd();return}if(!wt){console.warn("insert success sem representao; recarregando lista"),await ne(),e({title:"Quadra adicionada",description:`${be.nome} foi cadastrada.`}),m({nome:"",descricao:"",modalidades:[],tipo:"Descoberta",status:"Ativa",hora_inicio:"06:00",hora_fim:"23:59",valor_hora:""}),f(!1),g(""),console.timeEnd("[Quadras] addQuadra duration"),console.groupEnd();return}console.log("insert success",{id:wt?.id,nome:wt?.nome}),e({title:"Quadra adicionada",description:`${wt.nome} foi cadastrada.`}),m({nome:"",descricao:"",modalidades:[],tipo:"Descoberta",status:"Ativa",hora_inicio:"06:00",hora_fim:"23:59",valor_hora:""}),f(!1),g(""),o(Je=>[wt,...Je].sort((_e,je)=>_e.nome.localeCompare(je.nome))),console.timeEnd("[Quadras] addQuadra duration"),console.groupEnd()},xt=async be=>{U(be),pe(!0);try{const{data:Ct,error:wt}=await de.from("quadras_dias_funcionamento").select("*").eq("quadra_id",be.id).eq("codigo_empresa",t.codigo_empresa);if(wt)throw wt;const Ge={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0},Je=[];Ct?.forEach(_e=>{_e.tipo==="dia_semana"?Ge[_e.dia_semana]=_e.funciona:_e.tipo==="data_fechamento"&&Je.push(_e)}),W(Ge),X(Je),M(!0)}catch(Ct){console.error("Erro ao carregar dias de funcionamento:",Ct),e({title:"Erro",description:"No foi possvel carregar as configuraes."})}finally{pe(!1)}},Ze=async()=>{if(D){pe(!0);try{await de.from("quadras_dias_funcionamento").delete().eq("quadra_id",D.id).eq("tipo","dia_semana");const be=Object.entries(z).map(([wt,Ge])=>({quadra_id:D.id,codigo_empresa:t.codigo_empresa,tipo:"dia_semana",dia_semana:parseInt(wt),funciona:Ge,observacao:"Configurao de dias da semana"})),{error:Ct}=await de.from("quadras_dias_funcionamento").insert(be);if(Ct)throw Ct;e({title:"Sucesso",description:"Dias da semana salvos com sucesso!"})}catch(be){console.error("Erro ao salvar dias da semana:",be),e({title:"Erro",description:"No foi possvel salvar as configuraes."})}finally{pe(!1)}}},ht=async()=>{if(!(!D||!ye)){pe(!0);try{const{data:be,error:Ct}=await de.from("quadras_dias_funcionamento").insert({quadra_id:D.id,codigo_empresa:t.codigo_empresa,tipo:"data_fechamento",data_fechamento:ye,funciona:!1,observacao:V||"Fechamento especial"}).select().single();if(Ct)throw Ct;X(wt=>[...wt,be]),Se(""),B(""),e({title:"Sucesso",description:"Data de fechamento adicionada!"})}catch(be){console.error("Erro ao adicionar data de fechamento:",be),e({title:"Erro",description:"No foi possvel adicionar a data de fechamento."})}finally{pe(!1)}}},Wt=async be=>{pe(!0);try{const{error:Ct}=await de.from("quadras_dias_funcionamento").delete().eq("id",be);if(Ct)throw Ct;X(wt=>wt.filter(Ge=>Ge.id!==be)),e({title:"Sucesso",description:"Data de fechamento removida!"})}catch(Ct){console.error("Erro ao remover data de fechamento:",Ct),e({title:"Erro",description:"No foi possvel remover a data de fechamento."})}finally{pe(!1)}};return a.jsx(a.Fragment,{children:a.jsxs(xr.div,{variants:Cot,initial:"hidden",animate:"visible",className:"space-y-6",children:[a.jsxs(xr.div,{variants:JR,className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-black text-text-primary tracking-tighter",children:"Controle de Quadras"}),a.jsx("p",{className:"text-text-secondary",children:"Gerencie as quadras e horrios disponveis."})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(fe,{variant:"outline",size:"icon",onClick:()=>A(be=>!be),title:P?"Ocultar resumo":"Mostrar resumo","aria-label":P?"Ocultar resumo":"Mostrar resumo",children:P?a.jsx(Yp,{className:"h-4 w-4"}):a.jsx(hg,{className:"h-4 w-4"})}),a.jsx(fe,{onClick:()=>f(!0),className:"shadow-sm",children:"Adicionar Quadra"})]})]}),P&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsx(mk,{icon:Dc,title:"Quadra Mais Usada",value:R.mostUsed,subtitle:"ltimos 30 dias",color:"text-brand"}),a.jsx(mk,{icon:Pl,title:"Cliente Top",value:R.topClient,subtitle:"Mais agendamentos no ms",color:"text-purple"}),a.jsx(mk,{icon:Jf,title:"Total de Agendamentos",value:R.totalBookings,subtitle:"ltimos 30 dias",color:"text-success"})]}),a.jsxs(Pot,{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-bold text-text-primary",children:"Quadras"}),a.jsx("div",{className:"text-xs text-text-muted",children:i?"Carregando...":`${s.length} registro(s)`})]}),!i&&s.length===0?a.jsxs("div",{className:"text-sm text-text-muted py-8 text-center",children:[a.jsx("div",{className:"font-medium mb-1",children:"Nenhuma quadra cadastrada"}),a.jsx("div",{className:"mb-4",children:'Clique em "Adicionar Quadra" para cadastrar a primeira.'}),a.jsx(fe,{onClick:()=>f(!0),children:"Adicionar Quadra"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"md:hidden space-y-3",children:s.map(be=>a.jsxs("div",{className:"rounded-lg border border-border bg-surface p-4 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[a.jsx("span",{className:"inline-block w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:$m(be.nome),boxShadow:"0 0 0 2px rgba(255,255,255,0.06)"},"aria-hidden":"true"}),a.jsx("span",{className:"font-semibold text-base text-text-primary truncate",children:be.nome})]}),a.jsx("span",{className:`inline-flex px-2 py-0.5 rounded-full text-xs border flex-shrink-0 ${be.status==="Ativa"?"bg-emerald-50/5 border-emerald-500/30 text-emerald-400":be.status==="Manuteno"?"bg-amber-50/5 border-amber-500/30 text-amber-400":"bg-surface-2 border-border text-text-muted"}`,children:be.status})]}),Array.isArray(be.modalidades)&&be.modalidades.length>0&&a.jsxs("div",{children:[a.jsx("span",{className:"text-xs text-text-muted mb-1 block",children:"Modalidades"}),a.jsx("div",{className:"flex flex-wrap gap-1",children:be.modalidades.map(Ct=>a.jsx("span",{className:"inline-flex px-2 py-0.5 rounded-full bg-surface-2 border border-border text-xs",children:Ct},Ct))})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-xs text-text-muted block mb-1",children:"Valor/hora"}),a.jsx("span",{className:"text-sm font-medium",children:be.valor==null||be.valor===""?"-":me(Number(be.valor)*2,!0)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-xs text-text-muted block mb-1",children:"Funcionamento"}),a.jsxs("span",{className:"text-sm font-medium",children:[ae(be.hora_inicio)," - ",ae(be.hora_fim==="24:00:00"?"23:59:00":be.hora_fim)]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs(fe,{variant:"outline",size:"sm",onClick:()=>xt(be),className:"flex items-center gap-1",children:[a.jsx(Bs,{className:"h-3 w-3"}),"Dias"]}),a.jsx(fe,{variant:"outline",size:"sm",onClick:()=>ie(be),children:"Editar"})]})]},be.id))}),a.jsx("div",{className:"hidden md:block overflow-x-auto rounded-lg border border-border bg-surface-0",children:a.jsxs(yl,{children:[a.jsx(bl,{className:"bg-surface-2/60 backdrop-blur supports-[backdrop-filter]:bg-surface-2/70",children:a.jsxs(qa,{children:[a.jsx(On,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Nome"}),a.jsx(On,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Modalidades"}),a.jsx(On,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Valor por hora"}),a.jsx(On,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Funcionamento"}),a.jsx(On,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Status"}),a.jsx(On,{className:"text-right text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Aes"})]})}),a.jsx(wl,{children:s.map(be=>a.jsxs(qa,{className:"hover:bg-surface-2/40 transition-colors",children:[a.jsx(bn,{className:"font-medium text-sm md:text-base text-text-primary",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"inline-block w-2.5 h-2.5 rounded-full",style:{backgroundColor:$m(be.nome),boxShadow:"0 0 0 2px rgba(255,255,255,0.06)"},"aria-hidden":"true"}),a.jsx("span",{children:be.nome})]})}),a.jsx(bn,{className:"text-sm md:text-base",children:Array.isArray(be.modalidades)&&be.modalidades.length>0?a.jsx("div",{className:"flex flex-wrap gap-1",children:be.modalidades.map(Ct=>a.jsx("span",{className:"inline-flex px-2 py-0.5 rounded-full bg-surface-2 border border-border text-[11px] md:text-xs",children:Ct},Ct))}):be.modalidades||""}),a.jsx(bn,{className:"text-sm md:text-base",children:be.valor==null||be.valor===""?"-":a.jsx("span",{className:"inline-flex px-2 py-0.5 rounded-full bg-surface-2 border border-border text-[11px] md:text-xs",children:me(Number(be.valor)*2,!0)})}),a.jsxs(bn,{className:"text-sm md:text-base",children:[ae(be.hora_inicio)," - ",ae(be.hora_fim==="24:00:00"?"23:59:00":be.hora_fim)]}),a.jsx(bn,{className:"text-sm md:text-base",children:a.jsx("span",{className:`inline-flex px-2 py-0.5 rounded-full text-[11px] md:text-xs border ${be.status==="Ativa"?"bg-emerald-50/5 border-emerald-500/30 text-emerald-400":be.status==="Manuteno"?"bg-amber-50/5 border-amber-500/30 text-amber-400":"bg-surface-2 border-border text-text-muted"}`,children:be.status})}),a.jsx(bn,{className:"text-right",children:a.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[a.jsxs(fe,{variant:"outline",size:"sm",onClick:()=>xt(be),className:"text-sm",children:[a.jsx(Bs,{className:"h-3 w-3 mr-1"}),"Dias"]}),a.jsx(fe,{variant:"outline",size:"sm",onClick:()=>ie(be),className:"text-sm",children:"Editar"})]})})]},be.id))})]})})]})]}),a.jsx(mn,{open:u,onOpenChange:f,children:a.jsxs(un,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[a.jsxs(on,{children:[a.jsx(an,{children:"Adicionar Quadra"}),a.jsx(Nn,{children:"Cadastre uma nova quadra da sua empresa."})]}),a.jsxs("div",{className:"grid gap-4 py-2",children:[a.jsx(tV,{label:"Nome",value:h.nome,onChange:be=>m({...h,nome:be.target.value}),placeholder:"Ex.: Quadra Society 2"}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Descrio (opcional)"}),a.jsx("textarea",{value:h.descricao,onChange:be=>m({...h,descricao:be.target.value}),placeholder:"Ex.: Quadra oficial com grama sinttica, iluminao LED, vestirios completos",rows:3,className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm resize-none"})]}),a.jsxs("div",{className:"flex flex-col gap-2 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Modalidades"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"text",value:v,onChange:be=>g(be.target.value),onKeyDown:be=>{if(be.key==="Enter"){be.preventDefault();const Ct=v.trim();if(!Ct)return;m(wt=>wt.modalidades.some(Je=>Je.toLowerCase()===Ct.toLowerCase())?wt:{...wt,modalidades:[...wt.modalidades,Ct]}),g("")}},placeholder:"Ex.: Society",className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm w-60 sm:w-72 focus:outline-none focus:ring-2 focus:ring-primary/30"}),a.jsx(fe,{type:"button",variant:"secondary",className:"bg-amber-500 hover:bg-amber-400 text-black disabled:opacity-50 disabled:cursor-not-allowed",disabled:!v.trim(),onClick:()=>{const be=v.trim();be&&(m(Ct=>Ct.modalidades.some(Ge=>Ge.toLowerCase()===be.toLowerCase())?Ct:{...Ct,modalidades:[...Ct.modalidades,be]}),g(""))},"aria-label":"Adicionar modalidade",title:"Adicionar modalidade",children:"+"})]}),h.modalidades.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2",children:h.modalidades.map(be=>a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full border border-border bg-surface-2 text-xs",children:[a.jsx("span",{className:"px-0.5",children:be}),a.jsx("button",{type:"button",className:"text-text-muted hover:text-destructive/80",onClick:()=>m(Ct=>({...Ct,modalidades:Ct.modalidades.filter(wt=>wt!==be)})),"aria-label":`Remover ${be}`,title:`Remover ${be}`,children:""})]},be))})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Tipo"}),a.jsxs("select",{value:h.tipo,onChange:be=>m({...h,tipo:be.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[a.jsx("option",{children:"Descoberta"}),a.jsx("option",{children:"Coberta"})]})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Valor por hora (R$)"}),a.jsx("input",{type:"text",inputMode:"decimal",step:"0.01",placeholder:"0,00",value:h.valor_hora,onChange:be=>m({...h,valor_hora:Y(be.target.value)}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm w-40"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Abertura"}),a.jsx("input",{type:"time",step:"1800",value:h.hora_inicio,onChange:be=>m({...h,hora_inicio:be.target.value}),onBlur:be=>m(Ct=>({...Ct,hora_inicio:Re(be.target.value)})),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Fechamento"}),a.jsx("input",{type:"time",step:"1800",value:h.hora_fim,onChange:be=>m({...h,hora_fim:be.target.value}),onBlur:be=>m(Ct=>({...Ct,hora_fim:Re(be.target.value)})),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Status"}),a.jsxs("select",{value:h.status,onChange:be=>m({...h,status:be.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[a.jsx("option",{children:"Ativa"}),a.jsx("option",{children:"Inativa"}),a.jsx("option",{children:"Manuteno"})]})]})]}),a.jsx(Qn,{children:a.jsx(fe,{onClick:at,disabled:c||h.modalidades.length===0,children:c?"Adicionando...":"Salvar"})})]})}),a.jsx(mn,{open:y,onOpenChange:x,children:a.jsxs(un,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[a.jsxs(on,{children:[a.jsx(an,{children:"Editar Quadra"}),a.jsx(Nn,{children:"Atualize os dados da quadra selecionada."})]}),a.jsxs("div",{className:"grid gap-4 py-2",children:[a.jsx(tV,{label:"Nome",value:j.nome,onChange:be=>_({...j,nome:be.target.value}),placeholder:"Ex.: Quadra Society 2"}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Descrio (opcional)"}),a.jsx("textarea",{value:j.descricao,onChange:be=>_({...j,descricao:be.target.value}),placeholder:"Ex.: Quadra oficial com grama sinttica, iluminao LED, vestirios completos",rows:3,className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm resize-none"})]}),a.jsxs("div",{className:"flex flex-col gap-2 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Modalidades"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"text",value:S,onChange:be=>C(be.target.value),onKeyDown:be=>{if(be.key==="Enter"){be.preventDefault();const Ct=S.trim();if(!Ct)return;_(wt=>wt.modalidades.some(Je=>Je.toLowerCase()===Ct.toLowerCase())?wt:{...wt,modalidades:[...wt.modalidades,Ct]}),C("")}},placeholder:"Ex.: Society",className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm w-60 sm:w-72 focus:outline-none focus:ring-2 focus:ring-primary/30"}),a.jsx(fe,{type:"button",variant:"secondary",onClick:()=>{const be=S.trim();be&&(_(Ct=>Ct.modalidades.some(Ge=>Ge.toLowerCase()===be.toLowerCase())?Ct:{...Ct,modalidades:[...Ct.modalidades,be]}),C(""))},children:"+"})]}),j.modalidades.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2",children:j.modalidades.map(be=>a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full border border-border bg-surface-2 text-xs",children:[a.jsx("span",{className:"px-0.5",children:be}),a.jsx("button",{type:"button",className:"text-text-muted hover:text-destructive/80",onClick:()=>_(Ct=>({...Ct,modalidades:Ct.modalidades.filter(wt=>wt!==be)})),"aria-label":`Remover ${be}`,title:`Remover ${be}`,children:""})]},be))})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Tipo"}),a.jsxs("select",{value:j.tipo,onChange:be=>_({...j,tipo:be.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[a.jsx("option",{children:"Descoberta"}),a.jsx("option",{children:"Coberta"})]})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Valor por hora (R$)"}),a.jsx("input",{type:"text",inputMode:"decimal",step:"0.01",placeholder:"0,00",value:j.valor_hora,onChange:be=>_({...j,valor_hora:Y(be.target.value)}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm w-40"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Abertura"}),a.jsx("input",{type:"time",step:"1800",value:j.hora_inicio,onChange:be=>_({...j,hora_inicio:be.target.value}),onBlur:be=>_(Ct=>({...Ct,hora_inicio:Re(be.target.value)})),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Fechamento"}),a.jsx("input",{type:"time",step:"1800",value:j.hora_fim,onChange:be=>_({...j,hora_fim:be.target.value}),onBlur:be=>_(Ct=>({...Ct,hora_fim:Re(be.target.value)})),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Status"}),a.jsxs("select",{value:j.status,onChange:be=>_({...j,status:be.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[a.jsx("option",{children:"Ativa"}),a.jsx("option",{children:"Inativa"}),a.jsx("option",{children:"Manuteno"})]})]})]}),a.jsx(Qn,{children:a.jsx(fe,{onClick:gt,disabled:c||j.modalidades.length===0,children:c?"Salvando...":"Salvar alteraes"})})]})}),a.jsx(mn,{open:I,onOpenChange:M,children:a.jsxs(un,{className:"sm:max-w-[600px] max-h-[90vh] overflow-hidden pointer-events-none",children:[a.jsx("div",{className:"fixed inset-0 z-50 backdrop-blur-lg bg-black/60 flex items-center justify-center pointer-events-auto",children:a.jsx("div",{className:"rounded-2xl border border-white/30 bg-slate-900 shadow-2xl max-w-sm w-full text-center mx-4",children:a.jsxs("div",{className:"px-8 py-10",children:[a.jsxs("div",{className:"flex items-center justify-center gap-4 mb-8",children:[a.jsx("div",{className:"w-14 h-14 bg-brand rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(Dc,{className:"w-8 h-8 text-primary-foreground"})}),a.jsxs("div",{className:"flex items-baseline select-none",children:[a.jsx("span",{className:"font-extrabold text-3xl",style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{className:"font-extrabold text-3xl",style:{color:"#FFAA33"},children:"7"}),a.jsx("span",{className:"font-medium text-3xl",style:{color:"#FFFFFF"},children:" Arena"})]})]}),a.jsx("div",{className:"text-2xl font-bold text-white mb-3",children:"Em Desenvolvimento"}),a.jsx("p",{className:"text-base text-gray-200",children:"Esta funcionalidade est sendo desenvolvida e em breve estar disponvel."}),a.jsx("div",{className:"mt-8 flex items-center justify-center",children:a.jsx(fe,{variant:"outline",onClick:()=>M(!1),children:"Fechar"})})]})})}),a.jsxs(on,{children:[a.jsxs(an,{className:"flex items-center gap-2",children:[a.jsx(Bs,{className:"h-5 w-5"}),"Dias de Funcionamento - ",D?.nome]}),a.jsx(Nn,{children:"Configure os dias da semana que a quadra funciona e adicione datas especficas de fechamento."})]}),Q?a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsx("div",{className:"text-sm text-text-muted",children:"Carregando configuraes..."})}):a.jsxs("div",{className:"space-y-6 py-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold text-text-primary mb-3",children:"Dias da Semana"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[{key:0,label:"Domingo",short:"Dom"},{key:1,label:"Segunda",short:"Seg"},{key:2,label:"Tera",short:"Ter"},{key:3,label:"Quarta",short:"Qua"},{key:4,label:"Quinta",short:"Qui"},{key:5,label:"Sexta",short:"Sex"},{key:6,label:"Sbado",short:"Sb"}].map(be=>a.jsxs("label",{className:"flex items-center gap-2 p-3 rounded-lg border border-border hover:bg-surface-2/50 cursor-pointer transition-colors",children:[a.jsx("input",{type:"checkbox",checked:z[be.key],onChange:Ct=>W(wt=>({...wt,[be.key]:Ct.target.checked})),className:"w-4 h-4 text-primary bg-surface-2 border-border rounded focus:ring-primary focus:ring-2"}),a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-sm font-medium text-text-primary",children:be.short}),a.jsx("span",{className:"text-xs text-text-muted hidden sm:block",children:be.label})]})]},be.key))}),a.jsx("div",{className:"mt-4",children:a.jsx(fe,{onClick:Ze,disabled:Q,size:"sm",children:Q?"Salvando...":"Salvar Dias da Semana"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold text-text-primary mb-3",children:"Datas de Fechamento"}),a.jsx("div",{className:"bg-surface-2/30 rounded-lg p-4 mb-4",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"Data"}),a.jsx("input",{type:"date",value:ye,onChange:be=>Se(be.target.value),className:"w-full bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"Observao"}),a.jsx("input",{type:"text",placeholder:"Ex: Feriado, Manuteno",value:V,onChange:be=>B(be.target.value),className:"w-full bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]}),a.jsx("div",{className:"flex items-end",children:a.jsx(fe,{onClick:ht,disabled:!ye||Q,size:"sm",className:"w-full sm:w-auto",children:"Adicionar"})})]})}),$.length>0?a.jsx("div",{className:"space-y-2",children:$.map(be=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-surface-2/50 rounded-lg border border-border",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Pd,{className:"h-4 w-4 text-text-muted"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-text-primary",children:new Date(be.data_fechamento+"T00:00:00").toLocaleDateString("pt-BR")}),be.observacao&&a.jsx("div",{className:"text-xs text-text-muted",children:be.observacao})]})]}),a.jsx(fe,{variant:"outline",size:"sm",onClick:()=>Wt(be.id),disabled:Q,className:"text-destructive hover:text-destructive hover:bg-destructive/10",children:a.jsx(al,{className:"h-3 w-3"})})]},be.id))}):a.jsx("div",{className:"text-center py-6 text-sm text-text-muted",children:"Nenhuma data de fechamento configurada"})]})]}),a.jsx(Qn,{children:a.jsx(fe,{variant:"outline",onClick:()=>M(!1),children:"Fechar"})})]})})]})})}async function QR({url:e,body:t}){const r=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),n=await r.text();let s;try{s=n?JSON.parse(n):null}catch{s={raw:n}}if(!r.ok){const o=s?.message||s?.erro||r.statusText||"Erro na API Transmite Nota",i=new Error(o);throw i.status=r.status,i.response=s??n,i}return s}function yP(e,t){const r=String(e||"").replace(/\/$/,""),n=t.startsWith("/")?t:`/${t}`;return`${r}${n}`}async function Eot({baseUrl:e,apiKey:t,cnpj:r}){const n=yP(e,"/ConsultarEmissaoNotaNfce/");try{const s=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ApiKey:t||"",Cnpj:(r||"").replace(/\D/g,""),Dados:{}})}),o=await s.text();let i;try{i=o?JSON.parse(o):null}catch{}const l=s.status;return l===200?{reachable:!0,authorized:!0,status:l,response:i??o}:l===400?{reachable:!0,authorized:!0,status:l,response:i??o}:l===401||l===403?{reachable:!0,authorized:!1,status:l,response:i??o}:l===404?{reachable:!1,authorized:!1,status:l,response:i??o}:{reachable:!0,authorized:null,status:l,response:i??o}}catch(s){return{reachable:!1,authorized:!1,error:s?.message||String(s)}}}async function kot({baseUrl:e,apiKey:t,cnpj:r,dados:n}){if(!e)throw new Error("baseUrl obrigatrio");if(!t)throw new Error("apiKey obrigatrio");if(!r)throw new Error("cnpj obrigatrio");if(!n)throw new Error("dados obrigatrio");const s=yP(e,"/EnviarNfce/");return QR({url:s,body:{ApiKey:t,Cnpj:r,Dados:n}})}async function rV({baseUrl:e,apiKey:t,cnpj:r,dados:n}){const s=yP(e,"/ConsultarEmissaoNotaNfce/");return QR({url:s,body:{ApiKey:t,Cnpj:r,Dados:n}})}async function Iot({baseUrl:e,apiKey:t,cnpj:r,dados:n}){const s=yP(e,"/CancelarNfce/");return QR({url:s,body:{ApiKey:t,Cnpj:r,Dados:n}})}function Lj(e){const r=(e?.ambiente||"homologacao").toLowerCase()==="producao",n=r?e?.transmitenota_base_url_prod||e?.transmitenota_base_url||"":e?.transmitenota_base_url_hml||e?.transmitenota_base_url||"",s=r?e?.transmitenota_apikey_prod||e?.transmitenota_apikey||"":e?.transmitenota_apikey_hml||e?.transmitenota_apikey||"";return{baseUrl:n,apiKey:s,cnpj:(e?.cnpj||"").replace(/\D/g,"")}}const Oot={hidden:{opacity:0},visible:{opacity:1,transition:{when:"beforeChildren",staggerChildren:.06,delayChildren:.05}}},Tot={hidden:{opacity:0,y:12},visible:{opacity:1,y:0,transition:{duration:.35}}};function nV({children:e,className:t=""}){return a.jsx(xr.div,{variants:Tot,className:`fx-card ${t}`,children:e})}function ko({label:e,...t}){return a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:e}),a.jsx("input",{...t,className:`bg-surface-2 border border-border rounded-md px-3 py-2 text-sm ${t.className||""}`})]})}function Dot(e){return e.replace(/\D/g,"").replace(/(\d{2})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1/$2").replace(/(\d{4})(\d)/,"$1-$2").substring(0,18)}function Mot(e){return e.replace(/\D/g,"").replace(/(\d{2})(\d)/,"($1) $2").replace(/(\d{4})(\d)/,"$1-$2").substring(0,15)}function Nf(e){return String(e||"").replace(/\D/g,"")}function Rot(){const{toast:e}=Qa(),{company:t,userProfile:r,reloadCompany:n}=ms(),[s,o]=p.useState(!1),[i,l]=p.useState({razao_social:"",nome_fantasia:"",cnpj:"",email:"",telefone:"",endereco:"",logo_url:"",inscricao_estadual:"",regime_tributario:"",ambiente:"homologacao",logradouro:"",numero:"",complemento:"",bairro:"",cidade:"",uf:"",cep:"",codigo_municipio_ibge:"",nfce_serie:"1",nfce_numeracao:"1",nfce_itoken:"",nfe_serie:"",nfe_numeracao:"",transmitenota_apikey:"",transmitenota_base_url:"",transmitenota_base_url_hml:"",transmitenota_apikey_hml:"",transmitenota_base_url_prod:"",transmitenota_apikey_prod:""}),c=p.useRef(null),[d,u]=p.useState(""),f=p.useRef(!0);p.useEffect(()=>(f.current=!0,()=>{f.current=!1}),[]),p.useEffect(()=>{(async()=>{try{const x=r?.codigo_empresa||null;if(!x)return;const b=`empresa:form:${x}`;try{const C=localStorage.getItem(b);if(C){const P=JSON.parse(C);P&&typeof P=="object"&&(l(A=>({...A,...P})),P.logo_url&&u(`${P.logo_url.split("?")[0]}?v=${Date.now()}`))}}catch{}const w=setTimeout(()=>{if(f.current)try{const C=localStorage.getItem(b);if(C){const P=JSON.parse(C);P&&typeof P=="object"&&(console.warn("[Empresas] slow fallback: using cached form"),l(A=>({...A,...P})),P.logo_url&&u(`${P.logo_url.split("?")[0]}?v=${Date.now()}`))}}catch{}},5e3),{data:j,error:_}=await de.from("empresas").select("*").eq("codigo_empresa",x).single();if(clearTimeout(w),_)throw _;if(!f.current)return;const S={razao_social:j?.razao_social||"",nome_fantasia:j?.nome_fantasia||j?.nome||"",cnpj:j?.cnpj||"",email:j?.email||"",telefone:j?.telefone||"",endereco:j?.endereco||"",logo_url:j?.logo_url||"",inscricao_estadual:j?.inscricao_estadual||"",regime_tributario:j?.regime_tributario!=null?String(j.regime_tributario):"",ambiente:j?.ambiente||"homologacao",logradouro:j?.logradouro||"",numero:j?.numero||"",complemento:j?.complemento||"",bairro:j?.bairro||"",cidade:j?.cidade||"",uf:j?.uf||"",cep:j?.cep||"",codigo_municipio_ibge:j?.codigo_municipio_ibge||"",nfce_serie:j?.nfce_serie!=null?String(j.nfce_serie):"1",nfce_numeracao:j?.nfce_numeracao!=null?String(j.nfce_numeracao):"1",nfce_itoken:j?.nfce_itoken||"",nfe_serie:j?.nfe_serie!=null?String(j.nfe_serie):"",nfe_numeracao:j?.nfe_numeracao!=null?String(j.nfe_numeracao):"",transmitenota_apikey:j?.transmitenota_apikey||"",transmitenota_base_url:j?.transmitenota_base_url||"",transmitenota_base_url_hml:j?.transmitenota_base_url_hml||"",transmitenota_apikey_hml:j?.transmitenota_apikey_hml||"",transmitenota_base_url_prod:j?.transmitenota_base_url_prod||"",transmitenota_apikey_prod:j?.transmitenota_apikey_prod||""};l(S),u(S.logo_url?`${S.logo_url.split("?")[0]}?v=${Date.now()}`:"");try{localStorage.setItem(b,JSON.stringify(S))}catch{}}catch(x){console.warn("Falha ao carregar empresa:",x)}})()},[r?.codigo_empresa]),p.useEffect(()=>{if(!i.logo_url){u("");return}const y=i.logo_url.split("?")[0];u(`${y}?v=${Date.now()}`)},[i.logo_url]);const h=async y=>{if(y.preventDefault(),!s){if(!i.razao_social?.trim()||!i.cnpj?.trim()){e({title:"Campos obrigatrios",description:"Preencha Razo Social e CNPJ."});return}if(!r?.codigo_empresa){e({title:"Empresa no vinculada",description:"No foi possvel identificar a empresa do usurio para salvar."});return}try{o(!0);const x={nome:i.nome_fantasia||i.razao_social||"Empresa",razao_social:i.razao_social||null,nome_fantasia:i.nome_fantasia||null,cnpj:i.cnpj?.replace(/\D/g,"")||null,email:i.email||null,telefone:i.telefone||null,endereco:i.endereco||null,logo_url:i.logo_url||null,inscricao_estadual:i.inscricao_estadual?.trim()||null,regime_tributario:i.regime_tributario?Number(i.regime_tributario):null,ambiente:i.ambiente||"homologacao",logradouro:i.logradouro?.trim()||null,numero:i.numero?.trim()||null,complemento:i.complemento?.trim()||null,bairro:i.bairro?.trim()||null,cidade:i.cidade?.trim()||null,uf:(i.uf||"").toUpperCase().slice(0,2)||null,cep:Nf(i.cep)||null,codigo_municipio_ibge:i.codigo_municipio_ibge?.trim()||null,nfce_serie:i.nfce_serie?Number(i.nfce_serie):null,nfce_numeracao:i.nfce_numeracao?Number(i.nfce_numeracao):null,nfce_itoken:i.nfce_itoken?.trim()||null,nfe_serie:i.nfe_serie?Number(i.nfe_serie):null,nfe_numeracao:i.nfe_numeracao?Number(i.nfe_numeracao):null,transmitenota_apikey:i.transmitenota_apikey?.trim()||null,transmitenota_base_url:i.transmitenota_base_url?.trim()||null,transmitenota_base_url_hml:i.transmitenota_base_url_hml?.trim()||null,transmitenota_apikey_hml:i.transmitenota_apikey_hml?.trim()||null,transmitenota_base_url_prod:i.transmitenota_base_url_prod?.trim()||null,transmitenota_apikey_prod:i.transmitenota_apikey_prod?.trim()||null},b=async(w,j=1)=>{try{const{error:_}=await de.from("empresas").upsert({codigo_empresa:r.codigo_empresa,...w},{onConflict:"codigo_empresa"}).select("id").single();if(_)throw _;return!0}catch(_){const C=String(_?.message||"").match(/the '([^']+)' column|column\s+"([^"]+)"\s+of/i),P=C&&(C[1]||C[2])?C[1]||C[2]:null;if(P&&w.hasOwnProperty(P)&&j<=5){console.warn("[Empresas] Removendo coluna inexistente e tentando novamente:",P);const A={...w};return delete A[P],await b(A,j+1)}throw _}};await b(x),await n?.(),e({title:"Dados salvos",description:"As informaes da empresa foram atualizadas."})}catch(x){console.error(x);const b=(x?.message||x?.hint||"").toString()||"No foi possvel salvar os dados. Verifique as permisses e tente novamente.";e({title:"Erro ao salvar",description:b})}finally{o(!1)}}},m=async y=>{try{const x=y.target.files?.[0];if(!x)return;if(!r?.codigo_empresa){e({title:"Empresa no vinculada",description:"Seu usurio no est associado a uma empresa."});return}const b=x.name.split(".").pop()?.toLowerCase()||"png",w=`${r.codigo_empresa}/logo.${b}`,j=(()=>{try{return(localStorage.getItem("custom-auth-token")||"").trim()}catch{return""}})();if(j){const C=`${GI}/storage/v1/object/logos/${w}`,P=await fetch(C,{method:"POST",headers:{Authorization:`Bearer ${j}`,apikey:KI,"x-upsert":"true","Content-Type":x.type||"application/octet-stream"},body:x});if(!P.ok){const A=await P.text();let R;try{R=A?JSON.parse(A):null}catch{}const O=R?.message||R?.error||P.statusText||"Falha no upload",I=new Error(O);throw I.status=P.status,I.response=R||A,I}}else{const{data:{session:C}}=await de.auth.getSession(),P=C?.access_token||"";if(P){const A=`${GI}/storage/v1/object/logos/${w}`,R=await fetch(A,{method:"POST",headers:{Authorization:`Bearer ${P}`,apikey:KI,"x-upsert":"true","Content-Type":x.type||"application/octet-stream"},body:x});if(!R.ok){const O=await R.text();let I;try{I=O?JSON.parse(O):null}catch{}const M=I?.message||I?.error||R.statusText||"Falha no upload",D=new Error(M);throw D.status=R.status,D.response=I||O,D}}else{const{error:A}=await de.storage.from("logos").upload(w,x,{upsert:!0,contentType:x.type||void 0});if(A)throw A}}const{data:_}=de.storage.from("logos").getPublicUrl(w),S=_?.publicUrl||"";l(C=>({...C,logo_url:S})),u(S?`${S}?v=${Date.now()}`:""),e({title:"Logo enviada",description:"A imagem foi carregada com sucesso. Lembre-se de salvar."})}catch(x){console.error("Falha no upload da logo:",x),e({title:"Erro no upload",description:"No foi possvel enviar a logo. Tente outro arquivo."})}finally{c.current&&(c.current.value="")}};function v(y){return String(y||"").normalize("NFD").replace(/\p{Diacritic}/gu,"").toLowerCase().trim()}async function g(){const y=Nf(i.cnpj);if(y.length!==14){e({title:"CNPJ invlido",description:"Informe 14 dgitos para buscar.",variant:"destructive"});return}try{o(!0);const x=await fetch(`https://brasilapi.com.br/api/cnpj/v1/${y}`);if(!x.ok){let D="Falha ao consultar CNPJ";try{const U=await x.json();U?.message&&(D=U.message)}catch{}throw new Error(D)}const b=await x.json();try{console.info("[empresas] BuscarCNPJ:payload",b)}catch{}const w=b.razao_social||b.nome||"",j=b.nome_fantasia||"",_=b.logradouro||"",S=(b.numero||"").toString(),C=b.complemento||"",P=b.bairro||"",A=b.municipio||b.localidade||"",R=b.uf||"",O=Nf(b.cep);let I="";try{if(A&&R){const D=await fetch(`https://brasilapi.com.br/api/ibge/municipios/v1/${R}`);if(D.ok){const U=await D.json(),z=v(A),W=(U||[]).find($=>v($.nome)===z);(W?.codigo_ibge||W?.codigo)&&(I=String(W.codigo_ibge||W.codigo))}}}catch{}const M=`${_}${S?", "+S:""}${P?" - "+P:""}${A||R?" - "+A+"/"+R:""}`;l(D=>({...D,razao_social:w,nome_fantasia:j||w,logradouro:_,numero:S,complemento:C,bairro:P,cidade:A,uf:R,cep:O,endereco:M||D.endereco,codigo_municipio_ibge:I||""}));try{console.info("[empresas] BuscarCNPJ:setForm",{razao:w,fantasia:j,logradouro:_,numero:S,complemento:C,bairro:P,cidade:A,uf:R,cep:O,codigoIBGE:I,enderecoFull:M})}catch{}e({title:"CNPJ carregado",description:"Dados preenchidos automaticamente."})}catch(x){e({title:"Falha ao buscar CNPJ",description:x.message||"Tente novamente.",variant:"destructive"})}finally{o(!1)}}return a.jsx(a.Fragment,{children:a.jsxs(xr.div,{variants:Oot,initial:"hidden",animate:"visible",className:"space-y-6",children:[a.jsx(nV,{children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsx("h1",{className:"text-xl font-bold text-text-primary",children:"Cadastros  Empresa"})})}),a.jsxs(nV,{children:[a.jsx("h2",{className:"text-lg font-bold text-text-primary mb-4",children:"Dados da Empresa"}),a.jsxs("form",{onSubmit:h,className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsx(ko,{label:"Razo Social",value:i.razao_social,onChange:y=>l({...i,razao_social:y.target.value}),placeholder:"Ex.: Fluxo7 Arena LTDA"}),a.jsx(ko,{label:"Nome Fantasia",value:i.nome_fantasia,onChange:y=>l({...i,nome_fantasia:y.target.value}),placeholder:"Ex.: Fluxo7 Arena"}),a.jsxs("div",{className:"flex items-end gap-2",children:[a.jsx("div",{className:"flex-1",children:a.jsx(ko,{label:"CNPJ",type:"text",inputMode:"numeric",value:i.cnpj,onChange:y=>l({...i,cnpj:Dot(y.target.value)}),placeholder:"00.000.000/0000-00"})}),a.jsx(fe,{type:"button",variant:"outline",onClick:g,disabled:s,children:"Buscar CNPJ"})]}),a.jsx(ko,{label:"Email",type:"email",value:i.email,onChange:y=>l({...i,email:y.target.value}),placeholder:"contato@empresa.com"}),a.jsx(ko,{label:"Telefone",type:"tel",inputMode:"tel",value:i.telefone,onChange:y=>l({...i,telefone:Mot(y.target.value)}),placeholder:"(11) 99999-9999"}),a.jsx(ko,{label:"Endereo",value:i.endereco,onChange:y=>l({...i,endereco:y.target.value}),placeholder:"Rua, nmero, bairro, cidade",className:"md:col-span-2 lg:col-span-2"}),a.jsxs("div",{className:"md:col-span-2 lg:col-span-3 grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx(ko,{label:"Inscrio Estadual",value:i.inscricao_estadual,onChange:y=>l({...i,inscricao_estadual:y.target.value})}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Regime Tributrio (CRT)"}),a.jsxs("select",{value:i.regime_tributario,onChange:y=>l({...i,regime_tributario:y.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"Selecione"}),a.jsx("option",{value:"1",children:"1 - Simples Nacional"}),a.jsx("option",{value:"2",children:"2 - Simples (excesso sublimite)"}),a.jsx("option",{value:"3",children:"3 - Regime Normal"})]})]}),a.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Ambiente"}),a.jsxs("select",{value:i.ambiente,onChange:y=>l({...i,ambiente:y.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[a.jsx("option",{value:"homologacao",children:"Homologao"}),a.jsx("option",{value:"producao",children:"Produo"})]})]})]}),a.jsxs("div",{className:"md:col-span-2 lg:col-span-3 grid grid-cols-1 md:grid-cols-6 gap-4",children:[a.jsx("div",{className:"md:col-span-3",children:a.jsx(ko,{label:"Logradouro",value:i.logradouro,onChange:y=>l({...i,logradouro:y.target.value})})}),a.jsx("div",{className:"md:col-span-1",children:a.jsx(ko,{label:"Nmero",value:i.numero,onChange:y=>l({...i,numero:y.target.value})})}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(ko,{label:"Complemento",value:i.complemento,onChange:y=>l({...i,complemento:y.target.value})})}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(ko,{label:"Bairro",value:i.bairro,onChange:y=>l({...i,bairro:y.target.value})})}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(ko,{label:"Cidade",value:i.cidade,onChange:y=>l({...i,cidade:y.target.value})})}),a.jsx("div",{className:"md:col-span-1",children:a.jsx(ko,{label:"UF",value:i.uf,onChange:y=>l({...i,uf:(y.target.value||"").toUpperCase().slice(0,2)}),placeholder:"UF"})}),a.jsx("div",{className:"md:col-span-1",children:a.jsx(ko,{label:"CEP",value:i.cep,onChange:y=>l({...i,cep:Nf(y.target.value).slice(0,8)}),placeholder:"00000000"})}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(ko,{label:"Cdigo IBGE Municpio (cMun)",value:i.codigo_municipio_ibge,onChange:y=>l({...i,codigo_municipio_ibge:Nf(y.target.value).slice(0,7)})})})]}),a.jsxs("div",{className:"md:col-span-2 lg:col-span-3 grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx(ko,{label:"NFC-e Srie",value:i.nfce_serie,onChange:y=>l({...i,nfce_serie:Nf(y.target.value).slice(0,3)})}),a.jsx(ko,{label:"NFC-e Numerao Inicial",value:i.nfce_numeracao,onChange:y=>l({...i,nfce_numeracao:Nf(y.target.value).slice(0,9)})}),a.jsx(ko,{label:"NFC-e IToken (CSC)",value:i.nfce_itoken,onChange:y=>l({...i,nfce_itoken:y.target.value})})]}),a.jsxs("div",{className:"md:col-span-2 lg:col-span-3 grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx(ko,{label:"NF-e Srie (opcional)",value:i.nfe_serie,onChange:y=>l({...i,nfe_serie:Nf(y.target.value).slice(0,3)})}),a.jsx(ko,{label:"NF-e Numerao (opcional)",value:i.nfe_numeracao,onChange:y=>l({...i,nfe_numeracao:Nf(y.target.value).slice(0,9)})})]}),!1,a.jsx("div",{className:"md:col-span-2 lg:col-span-2 grid grid-cols-1 gap-3",children:a.jsxs("div",{className:"flex items-center gap-4",children:[d||i.logo_url?a.jsx("img",{src:d||i.logo_url,alt:"Logo da empresa",className:"w-16 h-16 rounded-md object-cover border border-border"}):a.jsx("div",{className:"w-16 h-16 rounded-md border border-dashed border-border/60 bg-surface-2/40 flex items-center justify-center text-xs text-text-muted",children:"Sem logo"}),a.jsxs("div",{className:"flex flex-col gap-1 text-sm",children:[a.jsx("span",{className:"text-xs text-text-muted",children:"Upload da Logo"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(fe,{type:"button",variant:"outline",onClick:()=>c.current?.click(),className:"px-3",children:"Escolher imagem"}),a.jsx("input",{ref:c,type:"file",accept:"image/*",onChange:m,className:"hidden"}),(d||i.logo_url)&&a.jsx("span",{className:"text-xs text-text-muted truncate max-w-[260px]",title:i.logo_url||d,children:"Logo selecionada"})]}),a.jsx("span",{className:"text-[11px] text-text-muted",children:"Formatos: PNG/JPG. Tamanho recomendado: 256x256."})]})]})}),a.jsx("div",{className:"flex items-end",children:a.jsx(fe,{type:"submit",className:"w-full md:w-auto",disabled:s,children:s?"Salvando...":"Salvar"})})]})]})]})})}const Lot={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},x_={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},aV=[{codigo:"01",nome:"Dinheiro"},{codigo:"02",nome:"Cheque"},{codigo:"03",nome:"Carto de Crdito"},{codigo:"04",nome:"Carto de Dbito"},{codigo:"05",nome:"Carto da Loja (Private Label)"},{codigo:"10",nome:"Vale Alimentao"},{codigo:"11",nome:"Vale Refeio"},{codigo:"12",nome:"Vale Presente"},{codigo:"13",nome:"Vale Combustvel"},{codigo:"14",nome:"Duplicata Mercantil"},{codigo:"15",nome:"Boleto Bancrio"},{codigo:"16",nome:"Depsito Bancrio"},{codigo:"17",nome:"PIX Dinmico (QR-Code)"},{codigo:"18",nome:"Transferncia Bancria / Carteira Digital"},{codigo:"19",nome:"Programa de Fidelidade / Cashback"},{codigo:"20",nome:"PIX Esttico"},{codigo:"21",nome:"Crdito em Loja"},{codigo:"22",nome:"Pagamento Eletrnico no Informado"},{codigo:"90",nome:"Sem Pagamento"},{codigo:"99",nome:"Outros"}],hk=({icon:e,title:t,value:r,subtitle:n,color:s,onClick:o,isActive:i})=>a.jsx(xr.div,{variants:x_,onClick:o,className:pr("bg-surface rounded-lg border md:border-2 p-3 md:p-4 transition-all text-center h-[90px] md:h-auto",o?"cursor-pointer hover:shadow-md":"",i?`border-${s} bg-${s}/5`:"border-border",o&&!i?"hover:border-border-hover":""),children:a.jsxs("div",{className:"flex flex-col items-center justify-center gap-1 md:flex-row md:items-center md:gap-3 h-full",children:[a.jsx("div",{className:pr("p-1.5 md:p-2 rounded-lg",`bg-${s}/10`),children:a.jsx(e,{className:pr("w-4 h-4 md:w-5 md:h-5",`text-${s}`)})}),a.jsxs("div",{className:"flex-1 md:text-left",children:[a.jsx("p",{className:"text-base md:text-2xl font-bold text-text-primary leading-none",children:r}),a.jsx("p",{className:"text-[10px] md:text-xs font-semibold text-text-secondary md:mt-0.5",children:t}),a.jsx("p",{className:"hidden md:block text-xs text-text-muted",children:n})]})]})});function Fot(){const{toast:e}=Qa(),{userProfile:t,authReady:r}=ms(),[n,s]=p.useState([]),[o,i]=p.useState(!1),[l,c]=p.useState(!1),[d,u]=p.useState(""),[f,h]=p.useState("all"),[m,v]=p.useState("all"),[g,y]=p.useState(!0),[x,b]=p.useState(null),[w,j]=p.useState(!1),[_,S]=p.useState(null),[C,P]=p.useState({codigo_interno:"",codigo_sefaz:"",nome:"",taxa_percentual:"",ativo:!0}),[A,R]=p.useState(!1),[O,I]=p.useState(""),[M,D]=p.useState(!1),[U,z]=p.useState(null),[W,$]=p.useState(null),[X,ye]=p.useState(!1),[Se,V]=p.useState("mes"),[B,Q]=p.useState(!1),[pe,te]=p.useState([]),[Y,ce]=p.useState("customizado"),[me,ae]=p.useState(""),[le,ue]=p.useState(""),[Re,ne]=p.useState(!1),[ie,gt]=p.useState(!1);p.useEffect(()=>{const _e=()=>{try{gt(typeof window<"u"&&window.innerWidth<=640)}catch{}};return _e(),window.addEventListener("resize",_e),()=>window.removeEventListener("resize",_e)},[]);const bt=async()=>{try{i(!0);const _e=t?.codigo_empresa;if(!_e)return;const je=await th({somenteAtivas:!1,codigoEmpresa:_e});console.log(" Finalizadoras carregadas:",je),console.log(" Primeira finalizadora:",je?.[0]),s(Array.isArray(je)?je:[])}catch(_e){e({title:"Erro ao carregar",description:_e?.message,variant:"destructive"})}finally{i(!1)}},at=p.useMemo(()=>{const _e=n.length,je=n.filter(tr=>tr.ativo).length,Ue=n.length>0?n.reduce((tr,Nt)=>{const yr=Nt.nome||"Sem nome";return tr[yr]=(tr[yr]||0)+1,tr},{}):{},ze=Object.entries(Ue).sort((tr,Nt)=>Nt[1]-tr[1])[0],or=ze?ze[0]:"-";return{total:_e,ativas:je,maisUsada:or}},[n]),xt=p.useMemo(()=>{let _e=[...n];if(d){const je=d.toLowerCase();_e=_e.filter(Ue=>{const ze=String(Ue.tipo||"").toLowerCase(),or=String(Ue.nome||"").toLowerCase(),tr=String(Ue.codigo_interno||"").toLowerCase(),Nt=je.replace(/\D/g,""),yr=String(Ue.codigo_interno||"").replace(/\D/g,"");return ze.includes(je)||or.includes(je)||tr.includes(je)||!!Nt&&yr===Nt})}return f!=="all"&&(_e=_e.filter(je=>je.tipo===f)),m!=="all"&&(_e=_e.filter(je=>m==="active"?je.ativo:!je.ativo)),x==="ativas"&&(_e=_e.filter(je=>je.ativo)),_e.sort((je,Ue)=>{const ze=parseInt(je.codigo_interno)||0,or=parseInt(Ue.codigo_interno)||0;return ze-or}),_e},[n,d,f,m,x]),Ze=()=>{S(null);const _e=n.reduce((Ue,ze)=>{const or=parseInt(ze.codigo_interno)||0;return or>Ue?or:Ue},0),je=String(_e+1).padStart(2,"0");P({codigo_interno:je,codigo_sefaz:"",nome:"",taxa_percentual:"",ativo:!0}),j(!0)},ht=_e=>{S(_e),P({codigo_interno:_e.codigo_interno||"",codigo_sefaz:_e.codigo_sefaz||"",nome:_e.nome||"",taxa_percentual:_e.taxa_percentual!=null?String(_e.taxa_percentual):"",ativo:_e.ativo!==!1}),j(!0)},Wt=async(_e,je="mes")=>{try{ye(!0);const Ue=t?.codigo_empresa;if(!Ue)return;const ze=new Date;let or,tr=ze.toISOString();switch(je){case"hoje":or=new Date(ze.setHours(0,0,0,0)).toISOString();break;case"semana":or=new Date(ze.setDate(ze.getDate()-7)).toISOString();break;case"mes":or=new Date(ze.setMonth(ze.getMonth()-1)).toISOString();break;default:or=new Date(ze.setMonth(ze.getMonth()-1)).toISOString()}const{data:Nt,error:yr}=await de.from("pagamentos").select("valor, recebido_em, status").eq("finalizadora_id",_e).eq("codigo_empresa",Ue).gte("recebido_em",or).lte("recebido_em",tr).neq("status","Cancelado").neq("status","Estornado");if(yr)throw yr;const Me=Nt?.length||0,dt=Nt?.reduce((hr,It)=>hr+(Number(It.valor)||0),0)||0,ut=Me>0?dt/Me:0,rr=Nt?.[Nt.length-1]?.recebido_em||null;$({transacoes:Me,faturamento:dt,ticketMedio:ut,ultimaUtilizacao:rr})}catch(Ue){console.error("Erro ao carregar estatsticas:",Ue),e({title:"Erro ao carregar estatsticas",description:Ue?.message,variant:"destructive"})}finally{ye(!1)}},be=async(_e="customizado",je=null,Ue=null)=>{try{ne(!0);const ze=t?.codigo_empresa;if(!ze)return;let or,tr;if(_e==="customizado"&&je&&Ue)or=new Date(je).toISOString(),tr=new Date(Ue+"T23:59:59").toISOString();else{const ut=new Date;switch(tr=ut.toISOString(),_e){case"hoje":or=new Date(ut.setHours(0,0,0,0)).toISOString();break;case"semana":or=new Date(ut.setDate(ut.getDate()-7)).toISOString();break;case"mes":or=new Date(ut.setMonth(ut.getMonth()-1)).toISOString();break;default:or=new Date(ut.setMonth(ut.getMonth()-1)).toISOString()}}const{data:Nt,error:yr}=await de.from("pagamentos").select("finalizadora_id, valor, finalizadoras!pagamentos_finalizadora_id_fkey(id, codigo_interno, nome)").eq("codigo_empresa",ze).gte("recebido_em",or).lte("recebido_em",tr).neq("status","Cancelado").neq("status","Estornado");if(yr)throw yr;const Me={};Nt?.forEach(ut=>{const rr=ut.finalizadora_id;rr&&(Me[rr]||(Me[rr]={id:rr,codigo:ut.finalizadoras?.codigo_interno||"-",nome:ut.finalizadoras?.nome||"Sem nome",total:0,transacoes:0}),Me[rr].total+=Number(ut.valor)||0,Me[rr].transacoes+=1)});const dt=Object.values(Me).sort((ut,rr)=>rr.total-ut.total);te(dt)}catch(ze){console.error("Erro ao carregar ranking:",ze),e({title:"Erro ao carregar ranking",description:ze?.message,variant:"destructive"})}finally{ne(!1)}},Ct=()=>{Q(!0),ce("customizado");const _e=new Date,je=new Date;je.setMonth(je.getMonth()-1),ae(je.toISOString().split("T")[0]),ue(_e.toISOString().split("T")[0]),be("customizado",je.toISOString().split("T")[0],_e.toISOString().split("T")[0])},wt=_e=>{z(_e),D(!0),V("mes"),Wt(_e.id,"mes")},Ge=async()=>{try{if(!C.nome?.trim()){e({title:"Nome  obrigatrio",variant:"warning"});return}if(!C.codigo_sefaz){e({title:"Cdigo SEFAZ  obrigatrio",variant:"warning"});return}if(C.codigo_interno?.trim()&&n.some(ze=>ze.codigo_interno===C.codigo_interno.trim()&&(!_||ze.id!==_.id))){e({title:"Cdigo j existe",description:"Este cdigo interno j est em uso por outra finalizadora",variant:"warning"});return}c(!0);const _e=t?.codigo_empresa,je={codigo_interno:C.codigo_interno?.trim()||null,codigo_sefaz:C.codigo_sefaz,nome:C.nome.trim(),tipo:"outros",taxa_percentual:C.taxa_percentual===""?null:Number(C.taxa_percentual),ativo:C.ativo};_?(await VGe(_.id,je,_e),e({title:"Finalizadora atualizada!",variant:"success"})):(await UGe(je,_e),e({title:"Finalizadora criada!",variant:"success"})),j(!1),await bt()}catch(_e){e({title:"Erro ao salvar",description:_e?.message,variant:"destructive"})}finally{c(!1)}},Je=async _e=>{try{await WGe(_e.id,!_e.ativo,t?.codigo_empresa),e({title:_e.ativo?"Desativada":"Ativada",variant:"success"}),await bt()}catch(je){e({title:"Erro ao alterar status",description:je?.message,variant:"destructive"})}};return p.useEffect(()=>{r&&t?.codigo_empresa&&bt()},[r,t?.codigo_empresa]),a.jsxs(a.Fragment,{children:[a.jsxs(xr.div,{variants:Lot,initial:"hidden",animate:"visible",className:"flex-1 space-y-6 p-4 md:p-6",children:[a.jsxs(xr.div,{variants:x_,className:"flex items-center justify-between gap-2",children:[a.jsx("div",{className:"min-w-0",children:a.jsx("h1",{className:"text-2xl md:text-3xl font-black text-text-primary tracking-tight leading-tight",children:"Finalizadoras"})}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx(fe,{variant:"ghost",size:"icon",onClick:()=>y(!g),className:"h-9 w-9",children:g?a.jsx(Yp,{className:"h-5 w-5"}):a.jsx(hg,{className:"h-5 w-5"})}),a.jsxs(fe,{onClick:Ze,className:"gap-2 h-9 px-3 whitespace-nowrap",children:[a.jsx(Ja,{className:"h-4 w-4"}),a.jsx("span",{className:"md:hidden",children:"Nova"}),a.jsx("span",{className:"hidden md:inline",children:"Nova Finalizadora"})]})]})]}),g&&a.jsxs("div",{className:"grid grid-cols-3 gap-3 md:grid-cols-3 md:gap-6",children:[a.jsx(hk,{icon:Qm,title:"Total",value:at.total,subtitle:"Finalizadoras cadastradas",color:"brand"}),a.jsx(hk,{icon:ei,title:"Ativas",value:at.ativas,subtitle:"Disponveis para uso",color:"success",onClick:()=>b(x==="ativas"?null:"ativas"),isActive:x==="ativas"}),a.jsx(hk,{icon:Jf,title:"Mais Usada",value:at.maisUsada,subtitle:"Mtodo mais popular",color:"warning",onClick:Ct})]}),a.jsx(xr.div,{variants:x_,className:"bg-surface rounded-lg border border-border p-4",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative min-w-0 basis-0 flex-grow",children:[a.jsx(Zs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(rt,{placeholder:"Buscar finalizadora...",value:d,onChange:_e=>u(_e.target.value),className:"pl-10 h-11"})]}),a.jsxs(vn,{value:m,onValueChange:v,children:[a.jsx(hn,{className:"w-[110px] md:w-[180px]",children:a.jsx(wn,{placeholder:"Filtrar por status"})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"all",children:"Todos"}),a.jsx(ct,{value:"active",children:"Ativas"}),a.jsx(ct,{value:"inactive",children:"Inativas"})]})]})]})}),a.jsx(xr.div,{variants:x_,className:"bg-surface rounded-lg border border-border overflow-hidden",children:o?a.jsxs("div",{className:"p-12 text-center",children:[a.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-brand border-r-transparent"}),a.jsx("p",{className:"mt-4 text-text-muted",children:"Carregando..."})]}):xt.length===0?a.jsxs("div",{className:"p-12 text-center text-text-muted",children:[a.jsx(Qm,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),a.jsx("p",{children:"Nenhuma finalizadora encontrada"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"md:hidden divide-y divide-border",children:xt.map(_e=>a.jsxs("div",{className:"p-3 flex flex-col gap-2 hover:bg-surface-2/50 cursor-pointer",onClick:()=>wt(_e),children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[a.jsx("span",{className:"px-2 py-0.5 rounded-md bg-surface-2 border border-border font-mono text-xs text-text-secondary",children:_e.codigo_interno||"-"}),a.jsx("span",{className:"font-semibold text-sm text-text-primary truncate",title:_e.nome,children:_e.nome})]}),a.jsxs("span",{className:pr("inline-flex items-center gap-1.5 px-2 py-0.5 rounded-full text-[11px] font-medium",_e.ativo?"bg-success/10 text-success":"bg-muted/10 text-muted"),children:[a.jsx("span",{className:pr("w-1.5 h-1.5 rounded-full",_e.ativo?"bg-success":"bg-muted")}),_e.ativo?"Ativa":"Inativa"]})]}),a.jsxs("div",{className:"flex items-center justify-between text-xs text-text-secondary",children:[a.jsx("div",{className:"flex items-center gap-3",children:a.jsxs("span",{children:["Taxa: ",_e.taxa_percentual?`${_e.taxa_percentual}%`:"-"]})}),a.jsxs("div",{className:"flex items-center gap-2",onClick:je=>je.stopPropagation(),children:[a.jsx(fe,{variant:"ghost",size:"sm",className:"h-7 px-2",onClick:()=>ht(_e),children:a.jsx(Cl,{className:"h-4 w-4"})}),a.jsx(fe,{variant:_e.ativo?"ghost":"default",size:"sm",className:"h-7 px-2",onClick:()=>Je(_e),children:_e.ativo?"Desativar":"Ativar"})]})]})]},_e.id))}),a.jsx("div",{className:"hidden md:block overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-surface-2 border-b border-border",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-6 py-4 text-sm font-semibold text-text-secondary",children:"Cdigo"}),a.jsx("th",{className:"text-left px-6 py-4 text-sm font-semibold text-text-secondary",children:"Descrio"}),a.jsx("th",{className:"text-left px-6 py-4 text-sm font-semibold text-text-secondary",children:"Taxa (%)"}),a.jsx("th",{className:"text-center px-6 py-4 text-sm font-semibold text-text-secondary",children:"Status"}),a.jsx("th",{className:"text-right px-6 py-4 text-sm font-semibold text-text-secondary",children:"Aes"})]})}),a.jsx("tbody",{className:"divide-y divide-border",children:xt.map(_e=>a.jsxs("tr",{className:"hover:bg-surface-2/50 transition-colors cursor-pointer",onClick:()=>wt(_e),children:[a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:"font-mono text-sm text-text-primary",children:_e.codigo_interno||"-"})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:"font-semibold text-text-primary",children:_e.nome})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:"text-text-secondary",children:_e.taxa_percentual?`${_e.taxa_percentual}%`:"-"})}),a.jsx("td",{className:"px-6 py-4 text-center",children:a.jsxs("span",{className:pr("inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-medium",_e.ativo?"bg-success/10 text-success":"bg-muted/10 text-muted"),children:[a.jsx("span",{className:pr("w-2 h-2 rounded-full",_e.ativo?"bg-success":"bg-muted")}),_e.ativo?"Ativa":"Inativa"]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex justify-end gap-2",onClick:je=>je.stopPropagation(),children:[a.jsx(fe,{variant:"ghost",size:"sm",onClick:()=>ht(_e),children:a.jsx(Cl,{className:"h-4 w-4"})}),a.jsx(fe,{variant:_e.ativo?"ghost":"default",size:"sm",onClick:()=>Je(_e),children:_e.ativo?"Desativar":"Ativar"})]})})]},_e.id))})]})})]})})]}),a.jsx(mn,{open:w,onOpenChange:j,children:a.jsxs(un,{className:"sm:max-w-[500px] w-[92vw] max-h-[90vh] overflow-y-auto",children:[a.jsxs(on,{children:[a.jsx(an,{children:_?"Editar Finalizadora":"Nova Finalizadora"}),a.jsx(Nn,{children:_?"Atualize as informaes da finalizadora":"Adicione um novo mtodo de pagamento"})]}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(qe,{htmlFor:"codigo_interno",children:"Cdigo Finalizadora"}),a.jsx(rt,{id:"codigo_interno",type:"text",placeholder:"Ex: 01, 02, 03...",value:C.codigo_interno,onChange:_e=>P({...C,codigo_interno:_e.target.value})}),a.jsx("p",{className:"text-xs text-text-muted",children:"Gerado automaticamente, mas pode ser editado"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(qe,{htmlFor:"nome",children:"Descrio *"}),a.jsx(rt,{id:"nome",placeholder:"Ex: PIX, Dinheiro, Carto de Crdito...",value:C.nome,onChange:_e=>P({...C,nome:_e.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(qe,{htmlFor:"codigo_sefaz",children:"Forma de Pagamento NF-e/NFC-e *"}),a.jsx(fe,{type:"button",variant:"outline",className:"justify-between w-full",onClick:()=>R(!0),children:C.codigo_sefaz?`${C.codigo_sefaz} - ${aV.find(_e=>_e.codigo===C.codigo_sefaz)?.nome||""}`:"Selecione a forma de pagamento"}),a.jsx("p",{className:"text-xs text-text-muted",children:"A lista abrir em um modal com rolagem."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(qe,{htmlFor:"taxa",children:"Taxa"}),a.jsxs("div",{className:"relative",children:[a.jsx(rt,{id:"taxa",inputMode:"decimal",placeholder:"0,00",className:"pr-10",value:C.taxa_percentual,onChange:_e=>{const je=String(_e.target.value).replace(/[^0-9.,]/g,"").replace(/,/g,".");if(je===""){P({...C,taxa_percentual:""});return}const Ue=Number(je);if(Number.isFinite(Ue)){const ze=Math.max(0,Math.min(100,Ue));P({...C,taxa_percentual:String(ze)})}},onBlur:()=>{const _e=String(C.taxa_percentual||"").replace(/,/g,".");if(_e==="")return;const je=Number(_e);if(Number.isFinite(je)){const Ue=Math.max(0,Math.min(100,je));P(ze=>({...ze,taxa_percentual:Ue.toFixed(2)}))}}}),a.jsx("span",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-text-muted text-sm",children:"%"})]}),a.jsx("p",{className:"text-xs text-text-muted",children:"Deixe vazio se no houver taxa"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"ativo",checked:C.ativo,onChange:_e=>P({...C,ativo:_e.target.checked}),className:"h-4 w-4 rounded border-border"}),a.jsx(qe,{htmlFor:"ativo",className:"text-sm font-normal cursor-pointer",children:"Finalizadora ativa"})]})]}),a.jsxs(Qn,{children:[a.jsx(fe,{variant:"outline",onClick:()=>j(!1),disabled:l,children:"Cancelar"}),a.jsx(fe,{onClick:Ge,disabled:l,children:l?"Salvando...":"Salvar"})]})]})}),a.jsx(mn,{open:A,onOpenChange:R,children:a.jsxs(un,{className:"sm:max-w-[520px] w-[92vw]",children:[a.jsxs(on,{children:[a.jsx(an,{children:"Selecionar Forma de Pagamento (SEFAZ)"}),a.jsx(Nn,{children:"Busque por cdigo ou nome"})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(rt,{placeholder:"Ex.: 03, crdito, pix...",value:O,onChange:_e=>I(_e.target.value)}),a.jsx("div",{className:"max-h-[420px] overflow-auto fx-scroll rounded-md border border-border",children:a.jsx("ul",{className:"divide-y divide-border",children:aV.filter(_e=>{const je=(O||"").toLowerCase();return je?_e.codigo.includes(je)||String(_e.nome).toLowerCase().includes(je):!0}).map(_e=>a.jsx("li",{children:a.jsxs("button",{type:"button",className:`w-full text-left px-3 py-2 hover:bg-surface-2 ${C.codigo_sefaz===_e.codigo?"bg-surface-2":""}`,onClick:()=>{P(je=>({...je,codigo_sefaz:_e.codigo})),R(!1)},children:[a.jsx("span",{className:"font-mono mr-2 text-text-secondary",children:_e.codigo}),a.jsx("span",{children:_e.nome})]})},_e.codigo))})})]})]})}),a.jsx(mn,{open:M,onOpenChange:D,children:a.jsxs(un,{className:"sm:max-w-[700px] w-[92vw] max-h-[90vh] overflow-y-auto",children:[a.jsxs(on,{children:[a.jsx(an,{children:"Detalhes da Finalizadora"}),a.jsx(Nn,{children:"Estatsticas e informaes completas"})]}),U&&a.jsxs("div",{className:"space-y-6 py-4",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsx("h3",{className:"font-semibold text-text-primary mb-3",children:"Informaes"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Cdigo Finalizadora"}),a.jsx("p",{className:"font-mono text-sm text-text-primary",children:U.codigo_interno||"-"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Forma de Pagamento NF-e/NFC-e"}),a.jsx("p",{className:"font-mono text-sm text-text-primary",children:U.codigo_sefaz||"-"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Descrio"}),a.jsx("p",{className:"font-medium text-text-primary",children:U.nome})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Taxa"}),a.jsx("p",{className:"font-medium text-text-primary",children:U.taxa_percentual?`${U.taxa_percentual}%`:"Sem taxa"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Status"}),a.jsxs("span",{className:pr("inline-flex items-center gap-2 px-2 py-1 rounded-full text-xs font-medium",U.ativo?"bg-success/10 text-success":"bg-muted/10 text-muted"),children:[a.jsx("span",{className:pr("w-2 h-2 rounded-full",U.ativo?"bg-success":"bg-muted")}),U.ativo?"Ativa":"Inativa"]})]})]})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsx("h3",{className:"font-semibold text-text-primary mb-3",children:"Perodo de Anlise"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(fe,{variant:Se==="hoje"?"default":"outline",size:"sm",onClick:()=>{V("hoje"),Wt(U.id,"hoje")},children:"Hoje"}),a.jsx(fe,{variant:Se==="semana"?"default":"outline",size:"sm",onClick:()=>{V("semana"),Wt(U.id,"semana")},children:"7 Dias"}),a.jsx(fe,{variant:Se==="mes"?"default":"outline",size:"sm",onClick:()=>{V("mes"),Wt(U.id,"mes")},children:"30 Dias"})]})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsx("h3",{className:"font-semibold text-text-primary mb-3",children:"Estatsticas de Uso"}),X?a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsx("div",{className:"h-6 w-6 animate-spin rounded-full border-2 border-brand border-t-transparent"})}):W?a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Total de Transaes"}),a.jsx("span",{className:"font-semibold text-text-primary",children:W.transacoes})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Faturamento Total"}),a.jsxs("span",{className:"font-semibold text-success",children:["R$ ",W.faturamento.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"Ticket Mdio"}),a.jsxs("span",{className:"font-semibold text-text-primary",children:["R$ ",W.ticketMedio.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:"ltima Utilizao"}),a.jsx("span",{className:"font-medium text-text-muted",children:W.ultimaUtilizacao?new Date(W.ultimaUtilizacao).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Nunca utilizada"})]})]}):a.jsx("div",{className:"text-center py-8 text-text-muted",children:a.jsx("p",{className:"text-sm",children:"Nenhum dado disponvel"})})]})]}),a.jsxs(Qn,{children:[a.jsx(fe,{variant:"outline",onClick:()=>D(!1),children:"Fechar"}),a.jsxs(fe,{onClick:()=>{D(!1),ht(U)},children:[a.jsx(Cl,{className:"h-4 w-4 mr-2"}),"Editar"]})]})]})}),a.jsx(mn,{open:B,onOpenChange:Q,children:a.jsxs(un,{className:"sm:max-w-[700px] w-[92vw] max-h-[90vh] overflow-y-auto",children:[a.jsxs(on,{children:[a.jsx(an,{children:"Ranking de Finalizadoras"}),a.jsx(Nn,{children:"Faturamento por forma de pagamento"})]}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx(fe,{variant:Y==="hoje"?"default":"outline",size:"sm",className:"flex-1 min-w-[70px]",onClick:()=>{ce("hoje"),be("hoje")},children:"Hoje"}),a.jsx(fe,{variant:Y==="semana"?"default":"outline",size:"sm",className:"flex-1 min-w-[70px]",onClick:()=>{ce("semana"),be("semana")},children:"7 Dias"}),a.jsx(fe,{variant:Y==="mes"?"default":"outline",size:"sm",className:"flex-1 min-w-[70px]",onClick:()=>{ce("mes"),be("mes")},children:"30 Dias"}),a.jsx(fe,{variant:Y==="customizado"?"default":"outline",size:"sm",className:"flex-1 min-w-[70px]",onClick:()=>ce("customizado"),children:"Perodo"})]}),Y==="customizado"&&(ie?a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx(qe,{className:"text-xs",children:"Data Inicial"}),a.jsx("input",{type:"date",className:"mt-1 h-9 w-full rounded-md border border-border bg-surface px-2 text-sm text-text-primary",value:me,onChange:_e=>ae(_e.target.value)})]}),a.jsxs("div",{children:[a.jsx(qe,{className:"text-xs",children:"Data Final"}),a.jsx("input",{type:"date",className:"mt-1 h-9 w-full rounded-md border border-border bg-surface px-2 text-sm text-text-primary",value:le,onChange:_e=>ue(_e.target.value)})]})]}),a.jsx(fe,{className:"w-full",onClick:()=>be("customizado",me,le),disabled:!me||!le||Re,children:Re?"Buscando...":"Buscar"})]}):a.jsxs("div",{className:"flex gap-3 items-end",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx(qe,{children:"Data Inicial"}),a.jsxs(vi,{children:[a.jsx(xi,{asChild:!0,children:a.jsxs(fe,{variant:"outline",className:pr("w-full justify-start text-left font-normal",!me&&"text-text-muted"),children:[a.jsx(Bs,{className:"mr-2 h-4 w-4"}),me?new Date(me+"T12:00:00").toLocaleDateString("pt-BR"):"Selecione"]})}),a.jsx(ni,{className:"w-auto p-0 bg-surface border border-border",align:"start",children:a.jsx(PT,{mode:"single",selected:me?new Date(me+"T12:00:00"):void 0,onSelect:_e=>{if(_e){const je=_e.getFullYear(),Ue=String(_e.getMonth()+1).padStart(2,"0"),ze=String(_e.getDate()).padStart(2,"0");ae(`${je}-${Ue}-${ze}`)}},className:"p-3"})})]})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx(qe,{children:"Data Final"}),a.jsxs(vi,{children:[a.jsx(xi,{asChild:!0,children:a.jsxs(fe,{variant:"outline",className:pr("w-full justify-start text-left font-normal",!le&&"text-text-muted"),children:[a.jsx(Bs,{className:"mr-2 h-4 w-4"}),le?new Date(le+"T12:00:00").toLocaleDateString("pt-BR"):"Selecione"]})}),a.jsx(ni,{className:"w-auto p-0 bg-surface border border-border",align:"start",children:a.jsx(PT,{mode:"single",selected:le?new Date(le+"T12:00:00"):void 0,onSelect:_e=>{if(_e){const je=_e.getFullYear(),Ue=String(_e.getMonth()+1).padStart(2,"0"),ze=String(_e.getDate()).padStart(2,"0");ue(`${je}-${Ue}-${ze}`)}},className:"p-3"})})]})]}),a.jsx(fe,{onClick:()=>be("customizado",me,le),disabled:!me||!le||Re,children:"Buscar"})]}))]}),Re?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-brand border-t-transparent"})}):pe.length===0?a.jsx("div",{className:"text-center py-12 text-text-muted",children:a.jsx("p",{children:"Nenhuma transao no perodo selecionado"})}):a.jsx("div",{className:"space-y-3",children:pe.map((_e,je)=>a.jsx("div",{className:"bg-surface-2 rounded-lg p-3 md:p-4 border border-border",children:a.jsxs("div",{className:"flex items-start md:items-center justify-between gap-3",children:[a.jsxs("div",{className:"flex items-start md:items-center gap-2 md:gap-3 flex-1 min-w-0",children:[a.jsxs("div",{className:pr("flex items-center justify-center w-7 h-7 md:w-8 md:h-8 rounded-full font-bold text-xs md:text-sm flex-shrink-0",je===0?"bg-warning/20 text-warning":je===1?"bg-info/20 text-info":je===2?"bg-success/20 text-success":"bg-muted/20 text-muted"),children:[je+1,""]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2",children:[a.jsx("span",{className:"font-mono text-[10px] md:text-xs text-text-muted",children:_e.codigo}),a.jsx("span",{className:"font-semibold text-sm md:text-base text-text-primary truncate",children:_e.nome})]}),a.jsxs("p",{className:"text-[10px] md:text-xs text-text-muted",children:[_e.transacoes," transaes"]})]})]}),a.jsxs("div",{className:"text-right flex-shrink-0",children:[a.jsxs("p",{className:"text-base md:text-lg font-bold text-success whitespace-nowrap",children:["R$ ",_e.total.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),a.jsxs("p",{className:"text-[10px] md:text-xs text-text-muted whitespace-nowrap",children:["Mdia: R$ ",(_e.total/_e.transacoes).toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})]})},_e.id))})]}),a.jsx(Qn,{children:a.jsx(fe,{variant:"outline",onClick:()=>Q(!1),children:"Fechar"})})]})})]})}function $ot(){return a.jsxs("div",{className:"p-8",children:[a.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Pgina de Teste"}),a.jsx("p",{children:"Esta  uma pgina de teste para verificar se o roteamento est funcionando corretamente."})]})}function Bot(){const[e,t]=p.useState(!1),[r,n]=p.useState(""),[s,o]=p.useState("Manuteno em andamento. Volte em breve!"),[i,l]=p.useState(!1),[c,d]=p.useState("");p.useEffect(()=>{try{const h=localStorage.getItem("maintenance:active")==="false",m=localStorage.getItem("maintenance:end")||"",v=localStorage.getItem("maintenance:message")||"Manuteno em andamento. Volte em breve!";t(h),n(m),o(v)}catch{}},[]);const u=h=>{if(h?.preventDefault(),e&&!r){alert("Defina uma data de trmino para a manuteno");return}localStorage.setItem("maintenance:active",e),localStorage.setItem("maintenance:end",r),localStorage.setItem("maintenance:message",s),window.dispatchEvent(new Event("storage")),l(!1),d(" Configuraes salvas!"),setTimeout(()=>d(""),3e3)},f=()=>{const h=!e;if(t(h),localStorage.setItem("maintenance:active",String(h)),h&&!r){const m=new Date;m.setDate(m.getDate()+1);const v=m.toISOString().slice(0,16);n(v),localStorage.setItem("maintenance:end",v)}window.dispatchEvent(new Event("storage")),d(h?" Modo manuteno ATIVADO":" Modo manuteno DESATIVADO"),setTimeout(()=>d(""),3e3)};return a.jsxs("div",{className:"max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-lg mt-10",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Controle de Manuteno"}),a.jsx("button",{onClick:f,className:`inline-flex items-center px-4 py-2 rounded-md font-medium ${e?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:e?"Manuteno ATIVA":"Manuteno INATIVA"})]}),e&&a.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"font-medium text-lg",children:"Configuraes"}),a.jsxs("button",{onClick:()=>l(!i),className:"text-blue-600 hover:text-blue-800 flex items-center gap-1 text-sm",children:[a.jsx(Cl,{className:"w-4 h-4"}),i?"Ocultar":"Editar"]})]}),i?a.jsxs("form",{onSubmit:u,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Trmino"}),a.jsx("div",{className:"relative",children:a.jsx("input",{type:"datetime-local",value:r,onChange:h=>n(h.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",min:new Date().toISOString().slice(0,16),required:!0})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mensagem de Manuteno"}),a.jsx("textarea",{value:s,onChange:h=>o(h.target.value),rows:3,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"Ex: Estamos em manuteno programada. Volte em breve!",required:!0})]}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Cancelar"}),a.jsxs("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[a.jsx(Bue,{className:"inline w-4 h-4 mr-1"}),"Salvar"]})]})]}):a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Trmino:"}),a.jsx("p",{className:"text-gray-900",children:r?new Date(r).toLocaleString():"No definido"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Mensagem:"}),a.jsx("p",{className:"text-gray-900 whitespace-pre-line",children:s})]})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg text-sm text-gray-600",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Como usar:"}),a.jsxs("ol",{className:"list-decimal pl-5 space-y-1",children:[a.jsx("li",{children:"Ative/desative o boto no topo"}),a.jsx("li",{children:"Defina a data de trmino e uma mensagem amigvel"}),a.jsx("li",{children:"Salve as configuraes"}),a.jsx("li",{children:"Para acessar durante a manuteno, use a senha no link"})]})]}),c&&a.jsx("div",{className:"fixed bottom-4 right-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded shadow-lg",children:c})]})}function qot(e){const t=new URLSearchParams(e.startsWith("#")?e.slice(1):e),r=t.get("access_token"),n=t.get("refresh_token");return{access_token:r,refresh_token:n}}const zot=()=>{const{toast:e}=Qa(),t=zi(),[r,n]=p.useState(""),[s,o]=p.useState(""),[i,l]=p.useState(!1),[c,d]=p.useState(!1),u=p.useMemo(()=>qot(window.location.hash),[]);p.useEffect(()=>{(async()=>{const{data:{session:m}}=await de.auth.getSession();if(m){d(!0);return}if(u.access_token&&u.refresh_token){const{data:v,error:g}=await de.auth.setSession({access_token:u.access_token,refresh_token:u.refresh_token});g&&e({title:"Link invlido ou expirado",description:"Abra o link do email novamente.",variant:"destructive"}),d(!!v?.session)}else e({title:"Link invlido",description:"Abra o link de redefinio enviado por email.",variant:"destructive"})})()},[]);const f=async h=>{if(h.preventDefault(),r.length<6){e({title:"Senha muito curta",description:"A senha deve ter pelo menos 6 caracteres.",variant:"destructive"});return}if(r!==s){e({title:"Senhas no conferem",description:"As senhas digitadas so diferentes.",variant:"destructive"});return}l(!0);const{data:m,error:v}=await de.auth.updateUser({password:r});if(l(!1),v){e({title:"Erro ao redefinir senha",description:v.message||"Tente novamente.",variant:"destructive"});return}e({title:"Senha redefinida",description:"Voc j pode acessar o sistema.",variant:"default"}),t("/")};return a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-6",children:a.jsxs("div",{className:"w-full max-w-md bg-surface rounded-xl border border-border p-6 shadow",children:[a.jsx("h1",{className:"text-2xl font-semibold mb-2 text-text-primary",children:"Redefinir senha"}),a.jsx("p",{className:"text-sm text-text-secondary mb-6",children:"Defina uma nova senha para sua conta."}),a.jsxs("form",{onSubmit:f,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm mb-1 text-text-secondary",children:"Nova senha"}),a.jsx(rt,{type:"password",value:r,onChange:h=>n(h.target.value),placeholder:"",disabled:!c||i})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm mb-1 text-text-secondary",children:"Confirmar nova senha"}),a.jsx(rt,{type:"password",value:s,onChange:h=>o(h.target.value),placeholder:"",disabled:!c||i})]}),a.jsx(fe,{type:"submit",className:"w-full",disabled:!c||i,children:i?"Salvando...":"Salvar nova senha"})]})]})})};function Uot(e){return e&&typeof e=="object"&&"default"in e?e.default:e}var loe=p,Vot=Uot(loe);function sV(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wot(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var Hot=!!(typeof window<"u"&&window.document&&window.document.createElement);function Got(e,t,r){if(typeof e!="function")throw new Error("Expected reducePropsToState to be a function.");if(typeof t!="function")throw new Error("Expected handleStateChangeOnClient to be a function.");if(typeof r<"u"&&typeof r!="function")throw new Error("Expected mapStateOnServer to either be undefined or a function.");function n(s){return s.displayName||s.name||"Component"}return function(o){if(typeof o!="function")throw new Error("Expected WrappedComponent to be a React component.");var i=[],l;function c(){l=e(i.map(function(u){return u.props})),d.canUseDOM?t(l):r&&(l=r(l))}var d=function(u){Wot(f,u);function f(){return u.apply(this,arguments)||this}f.peek=function(){return l},f.rewind=function(){if(f.canUseDOM)throw new Error("You may only call rewind() on the server. Call peek() to read the current state.");var v=l;return l=void 0,i=[],v};var h=f.prototype;return h.UNSAFE_componentWillMount=function(){i.push(this),c()},h.componentDidUpdate=function(){c()},h.componentWillUnmount=function(){var v=i.indexOf(this);i.splice(v,1),c()},h.render=function(){return Vot.createElement(o,this.props)},f}(loe.PureComponent);return sV(d,"displayName","SideEffect("+n(o)+")"),sV(d,"canUseDOM",Hot),d}}var Kot=Got;const Xot=Ua(Kot);var Yot=typeof Element<"u",Jot=typeof Map=="function",Qot=typeof Set=="function",Zot=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function y_(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r,n,s;if(Array.isArray(e)){if(r=e.length,r!=t.length)return!1;for(n=r;n--!==0;)if(!y_(e[n],t[n]))return!1;return!0}var o;if(Jot&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(o=e.entries();!(n=o.next()).done;)if(!t.has(n.value[0]))return!1;for(o=e.entries();!(n=o.next()).done;)if(!y_(n.value[1],t.get(n.value[0])))return!1;return!0}if(Qot&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(o=e.entries();!(n=o.next()).done;)if(!t.has(n.value[0]))return!1;return!0}if(Zot&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(r=e.length,r!=t.length)return!1;for(n=r;n--!==0;)if(e[n]!==t[n])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&typeof e.valueOf=="function"&&typeof t.valueOf=="function")return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&typeof e.toString=="function"&&typeof t.toString=="function")return e.toString()===t.toString();if(s=Object.keys(e),r=s.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!Object.prototype.hasOwnProperty.call(t,s[n]))return!1;if(Yot&&e instanceof Element)return!1;for(n=r;n--!==0;)if(!((s[n]==="_owner"||s[n]==="__v"||s[n]==="__o")&&e.$$typeof)&&!y_(e[s[n]],t[s[n]]))return!1;return!0}return e!==e&&t!==t}var eit=function(t,r){try{return y_(t,r)}catch(n){if((n.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw n}};const tit=Ua(eit);/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var oV=Object.getOwnPropertySymbols,rit=Object.prototype.hasOwnProperty,nit=Object.prototype.propertyIsEnumerable;function ait(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function sit(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;var n=Object.getOwnPropertyNames(t).map(function(o){return t[o]});if(n.join("")!=="0123456789")return!1;var s={};return"abcdefghijklmnopqrst".split("").forEach(function(o){s[o]=o}),Object.keys(Object.assign({},s)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var oit=sit()?Object.assign:function(e,t){for(var r,n=ait(e),s,o=1;o<arguments.length;o++){r=Object(arguments[o]);for(var i in r)rit.call(r,i)&&(n[i]=r[i]);if(oV){s=oV(r);for(var l=0;l<s.length;l++)nit.call(r,s[l])&&(n[s[l]]=r[s[l]])}}return n};const iit=Ua(oit);var lg={BODY:"bodyAttributes",HTML:"htmlAttributes",TITLE:"titleAttributes"},xa={BASE:"base",BODY:"body",HEAD:"head",HTML:"html",LINK:"link",META:"meta",NOSCRIPT:"noscript",SCRIPT:"script",STYLE:"style",TITLE:"title"};Object.keys(xa).map(function(e){return xa[e]});var Hs={CHARSET:"charset",CSS_TEXT:"cssText",HREF:"href",HTTPEQUIV:"http-equiv",INNER_HTML:"innerHTML",ITEM_PROP:"itemprop",NAME:"name",PROPERTY:"property",REL:"rel",SRC:"src",TARGET:"target"},GS={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},f1={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate"},lit=Object.keys(GS).reduce(function(e,t){return e[GS[t]]=t,e},{}),cit=[xa.NOSCRIPT,xa.SCRIPT,xa.STYLE],lu="data-react-helmet",dit=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uit=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},fit=function(){function e(t,r){for(var n=0;n<r.length;n++){var s=r[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),Gl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mit=function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},iV=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r},hit=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e},p3=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return r===!1?String(t):String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")},pit=function(t){var r=jx(t,xa.TITLE),n=jx(t,f1.TITLE_TEMPLATE);if(n&&r)return n.replace(/%s/g,function(){return Array.isArray(r)?r.join(""):r});var s=jx(t,f1.DEFAULT_TITLE);return r||s||void 0},git=function(t){return jx(t,f1.ON_CHANGE_CLIENT_STATE)||function(){}},pk=function(t,r){return r.filter(function(n){return typeof n[t]<"u"}).map(function(n){return n[t]}).reduce(function(n,s){return Gl({},n,s)},{})},vit=function(t,r){return r.filter(function(n){return typeof n[xa.BASE]<"u"}).map(function(n){return n[xa.BASE]}).reverse().reduce(function(n,s){if(!n.length)for(var o=Object.keys(s),i=0;i<o.length;i++){var l=o[i],c=l.toLowerCase();if(t.indexOf(c)!==-1&&s[c])return n.concat(s)}return n},[])},Oy=function(t,r,n){var s={};return n.filter(function(o){return Array.isArray(o[t])?!0:(typeof o[t]<"u"&&wit("Helmet: "+t+' should be of type "Array". Instead found type "'+dit(o[t])+'"'),!1)}).map(function(o){return o[t]}).reverse().reduce(function(o,i){var l={};i.filter(function(h){for(var m=void 0,v=Object.keys(h),g=0;g<v.length;g++){var y=v[g],x=y.toLowerCase();r.indexOf(x)!==-1&&!(m===Hs.REL&&h[m].toLowerCase()==="canonical")&&!(x===Hs.REL&&h[x].toLowerCase()==="stylesheet")&&(m=x),r.indexOf(y)!==-1&&(y===Hs.INNER_HTML||y===Hs.CSS_TEXT||y===Hs.ITEM_PROP)&&(m=y)}if(!m||!h[m])return!1;var b=h[m].toLowerCase();return s[m]||(s[m]={}),l[m]||(l[m]={}),s[m][b]?!1:(l[m][b]=!0,!0)}).reverse().forEach(function(h){return o.push(h)});for(var c=Object.keys(l),d=0;d<c.length;d++){var u=c[d],f=iit({},s[u],l[u]);s[u]=f}return o},[]).reverse()},jx=function(t,r){for(var n=t.length-1;n>=0;n--){var s=t[n];if(s.hasOwnProperty(r))return s[r]}return null},xit=function(t){return{baseTag:vit([Hs.HREF,Hs.TARGET],t),bodyAttributes:pk(lg.BODY,t),defer:jx(t,f1.DEFER),encode:jx(t,f1.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:pk(lg.HTML,t),linkTags:Oy(xa.LINK,[Hs.REL,Hs.HREF],t),metaTags:Oy(xa.META,[Hs.NAME,Hs.CHARSET,Hs.HTTPEQUIV,Hs.PROPERTY,Hs.ITEM_PROP],t),noscriptTags:Oy(xa.NOSCRIPT,[Hs.INNER_HTML],t),onChangeClientState:git(t),scriptTags:Oy(xa.SCRIPT,[Hs.SRC,Hs.INNER_HTML],t),styleTags:Oy(xa.STYLE,[Hs.CSS_TEXT],t),title:pit(t),titleAttributes:pk(lg.TITLE,t)}},g3=function(){var e=Date.now();return function(t){var r=Date.now();r-e>16?(e=r,t(r)):setTimeout(function(){g3(t)},0)}}(),lV=function(t){return clearTimeout(t)},yit=typeof window<"u"?window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||g3:global.requestAnimationFrame||g3,bit=typeof window<"u"?window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||lV:global.cancelAnimationFrame||lV,wit=function(t){return console&&typeof console.warn=="function"&&console.warn(t)},Ty=null,jit=function(t){Ty&&bit(Ty),t.defer?Ty=yit(function(){cV(t,function(){Ty=null})}):(cV(t),Ty=null)},cV=function(t,r){var n=t.baseTag,s=t.bodyAttributes,o=t.htmlAttributes,i=t.linkTags,l=t.metaTags,c=t.noscriptTags,d=t.onChangeClientState,u=t.scriptTags,f=t.styleTags,h=t.title,m=t.titleAttributes;v3(xa.BODY,s),v3(xa.HTML,o),_it(h,m);var v={baseTag:jv(xa.BASE,n),linkTags:jv(xa.LINK,i),metaTags:jv(xa.META,l),noscriptTags:jv(xa.NOSCRIPT,c),scriptTags:jv(xa.SCRIPT,u),styleTags:jv(xa.STYLE,f)},g={},y={};Object.keys(v).forEach(function(x){var b=v[x],w=b.newTags,j=b.oldTags;w.length&&(g[x]=w),j.length&&(y[x]=v[x].oldTags)}),r&&r(),d(t,g,y)},coe=function(t){return Array.isArray(t)?t.join(""):t},_it=function(t,r){typeof t<"u"&&document.title!==t&&(document.title=coe(t)),v3(xa.TITLE,r)},v3=function(t,r){var n=document.getElementsByTagName(t)[0];if(n){for(var s=n.getAttribute(lu),o=s?s.split(","):[],i=[].concat(o),l=Object.keys(r),c=0;c<l.length;c++){var d=l[c],u=r[d]||"";n.getAttribute(d)!==u&&n.setAttribute(d,u),o.indexOf(d)===-1&&o.push(d);var f=i.indexOf(d);f!==-1&&i.splice(f,1)}for(var h=i.length-1;h>=0;h--)n.removeAttribute(i[h]);o.length===i.length?n.removeAttribute(lu):n.getAttribute(lu)!==l.join(",")&&n.setAttribute(lu,l.join(","))}},jv=function(t,r){var n=document.head||document.querySelector(xa.HEAD),s=n.querySelectorAll(t+"["+lu+"]"),o=Array.prototype.slice.call(s),i=[],l=void 0;return r&&r.length&&r.forEach(function(c){var d=document.createElement(t);for(var u in c)if(c.hasOwnProperty(u))if(u===Hs.INNER_HTML)d.innerHTML=c.innerHTML;else if(u===Hs.CSS_TEXT)d.styleSheet?d.styleSheet.cssText=c.cssText:d.appendChild(document.createTextNode(c.cssText));else{var f=typeof c[u]>"u"?"":c[u];d.setAttribute(u,f)}d.setAttribute(lu,"true"),o.some(function(h,m){return l=m,d.isEqualNode(h)})?o.splice(l,1):i.push(d)}),o.forEach(function(c){return c.parentNode.removeChild(c)}),i.forEach(function(c){return n.appendChild(c)}),{oldTags:o,newTags:i}},doe=function(t){return Object.keys(t).reduce(function(r,n){var s=typeof t[n]<"u"?n+'="'+t[n]+'"':""+n;return r?r+" "+s:s},"")},Nit=function(t,r,n,s){var o=doe(n),i=coe(r);return o?"<"+t+" "+lu+'="true" '+o+">"+p3(i,s)+"</"+t+">":"<"+t+" "+lu+'="true">'+p3(i,s)+"</"+t+">"},Sit=function(t,r,n){return r.reduce(function(s,o){var i=Object.keys(o).filter(function(d){return!(d===Hs.INNER_HTML||d===Hs.CSS_TEXT)}).reduce(function(d,u){var f=typeof o[u]>"u"?u:u+'="'+p3(o[u],n)+'"';return d?d+" "+f:f},""),l=o.innerHTML||o.cssText||"",c=cit.indexOf(t)===-1;return s+"<"+t+" "+lu+'="true" '+i+(c?"/>":">"+l+"</"+t+">")},"")},uoe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.keys(t).reduce(function(n,s){return n[GS[s]||s]=t[s],n},r)},Cit=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.keys(t).reduce(function(n,s){return n[lit[s]||s]=t[s],n},r)},Pit=function(t,r,n){var s,o=(s={key:r},s[lu]=!0,s),i=uoe(n,o);return[Pe.createElement(xa.TITLE,i,r)]},Ait=function(t,r){return r.map(function(n,s){var o,i=(o={key:s},o[lu]=!0,o);return Object.keys(n).forEach(function(l){var c=GS[l]||l;if(c===Hs.INNER_HTML||c===Hs.CSS_TEXT){var d=n.innerHTML||n.cssText;i.dangerouslySetInnerHTML={__html:d}}else i[c]=n[l]}),Pe.createElement(t,i)})},Sf=function(t,r,n){switch(t){case xa.TITLE:return{toComponent:function(){return Pit(t,r.title,r.titleAttributes)},toString:function(){return Nit(t,r.title,r.titleAttributes,n)}};case lg.BODY:case lg.HTML:return{toComponent:function(){return uoe(r)},toString:function(){return doe(r)}};default:return{toComponent:function(){return Ait(t,r)},toString:function(){return Sit(t,r,n)}}}},foe=function(t){var r=t.baseTag,n=t.bodyAttributes,s=t.encode,o=t.htmlAttributes,i=t.linkTags,l=t.metaTags,c=t.noscriptTags,d=t.scriptTags,u=t.styleTags,f=t.title,h=f===void 0?"":f,m=t.titleAttributes;return{base:Sf(xa.BASE,r,s),bodyAttributes:Sf(lg.BODY,n,s),htmlAttributes:Sf(lg.HTML,o,s),link:Sf(xa.LINK,i,s),meta:Sf(xa.META,l,s),noscript:Sf(xa.NOSCRIPT,c,s),script:Sf(xa.SCRIPT,d,s),style:Sf(xa.STYLE,u,s),title:Sf(xa.TITLE,{title:h,titleAttributes:m},s)}},Eit=function(t){var r,n;return n=r=function(s){mit(o,s);function o(){return uit(this,o),hit(this,s.apply(this,arguments))}return o.prototype.shouldComponentUpdate=function(l){return!tit(this.props,l)},o.prototype.mapNestedChildrenToProps=function(l,c){if(!c)return null;switch(l.type){case xa.SCRIPT:case xa.NOSCRIPT:return{innerHTML:c};case xa.STYLE:return{cssText:c}}throw new Error("<"+l.type+" /> elements are self-closing and can not contain children. Refer to our API for more information.")},o.prototype.flattenArrayTypeChildren=function(l){var c,d=l.child,u=l.arrayTypeChildren,f=l.newChildProps,h=l.nestedChildren;return Gl({},u,(c={},c[d.type]=[].concat(u[d.type]||[],[Gl({},f,this.mapNestedChildrenToProps(d,h))]),c))},o.prototype.mapObjectTypeChildren=function(l){var c,d,u=l.child,f=l.newProps,h=l.newChildProps,m=l.nestedChildren;switch(u.type){case xa.TITLE:return Gl({},f,(c={},c[u.type]=m,c.titleAttributes=Gl({},h),c));case xa.BODY:return Gl({},f,{bodyAttributes:Gl({},h)});case xa.HTML:return Gl({},f,{htmlAttributes:Gl({},h)})}return Gl({},f,(d={},d[u.type]=Gl({},h),d))},o.prototype.mapArrayTypeChildrenToProps=function(l,c){var d=Gl({},c);return Object.keys(l).forEach(function(u){var f;d=Gl({},d,(f={},f[u]=l[u],f))}),d},o.prototype.warnOnInvalidChildren=function(l,c){return!0},o.prototype.mapChildrenToProps=function(l,c){var d=this,u={};return Pe.Children.forEach(l,function(f){if(!(!f||!f.props)){var h=f.props,m=h.children,v=iV(h,["children"]),g=Cit(v);switch(d.warnOnInvalidChildren(f,m),f.type){case xa.LINK:case xa.META:case xa.NOSCRIPT:case xa.SCRIPT:case xa.STYLE:u=d.flattenArrayTypeChildren({child:f,arrayTypeChildren:u,newChildProps:g,nestedChildren:m});break;default:c=d.mapObjectTypeChildren({child:f,newProps:c,newChildProps:g,nestedChildren:m});break}}}),c=this.mapArrayTypeChildrenToProps(u,c),c},o.prototype.render=function(){var l=this.props,c=l.children,d=iV(l,["children"]),u=Gl({},d);return c&&(u=this.mapChildrenToProps(c,u)),Pe.createElement(t,u)},fit(o,null,[{key:"canUseDOM",set:function(l){t.canUseDOM=l}}]),o}(Pe.Component),r.propTypes={base:Hn.object,bodyAttributes:Hn.object,children:Hn.oneOfType([Hn.arrayOf(Hn.node),Hn.node]),defaultTitle:Hn.string,defer:Hn.bool,encodeSpecialCharacters:Hn.bool,htmlAttributes:Hn.object,link:Hn.arrayOf(Hn.object),meta:Hn.arrayOf(Hn.object),noscript:Hn.arrayOf(Hn.object),onChangeClientState:Hn.func,script:Hn.arrayOf(Hn.object),style:Hn.arrayOf(Hn.object),title:Hn.string,titleAttributes:Hn.object,titleTemplate:Hn.string},r.defaultProps={defer:!0,encodeSpecialCharacters:!0},r.peek=t.peek,r.rewind=function(){var s=t.rewind();return s||(s=foe({baseTag:[],bodyAttributes:{},encodeSpecialCharacters:!0,htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}})),s},n},kit=function(){return null},Iit=Xot(xit,jit,foe)(kit),m1=Eit(Iit);m1.renderStatic=m1.rewind;function vl(e){return e??""}function Fj(e){return String(e||"").replace(/\D/g,"")}function Oit(){const{userProfile:e}=ms(),{toast:t}=Qa(),r=zi(),[n,s]=p.useState(!0),[o,i]=p.useState(!1),[l,c]=p.useState(null),[d,u]=p.useState({inscricao_estadual:"",regime_tributario:"",logradouro:"",numero:"",complemento:"",bairro:"",cidade:"",uf:"",cep:"",codigo_municipio_ibge:"",nfce_serie:"1",nfce_numeracao:"1",nfce_itoken:"",nfe_serie:"",nfe_numeracao:"",ambiente:"homologacao",transmitenota_apikey:"",transmitenota_base_url:"",transmitenota_base_url_hml:"",transmitenota_apikey_hml:"",transmitenota_base_url_prod:"",transmitenota_apikey_prod:""});p.useEffect(()=>{async function v(){if(!e?.codigo_empresa)return;s(!0);const{data:g,error:y}=await de.from("empresas").select("*").eq("codigo_empresa",e.codigo_empresa).single();y?t({title:"Erro ao carregar",description:y.message,variant:"destructive"}):g&&(c(g),u({inscricao_estadual:vl(g.inscricao_estadual),regime_tributario:g.regime_tributario?String(g.regime_tributario):"",logradouro:vl(g.logradouro),numero:vl(g.numero),complemento:vl(g.complemento),bairro:vl(g.bairro),cidade:vl(g.cidade),uf:vl(g.uf),cep:Fj(g.cep),codigo_municipio_ibge:vl(g.codigo_municipio_ibge),nfce_serie:g.nfce_serie!=null?String(g.nfce_serie):"1",nfce_numeracao:g.nfce_numeracao!=null?String(g.nfce_numeracao):"1",nfce_itoken:vl(g.nfce_itoken),nfe_serie:g.nfe_serie!=null?String(g.nfe_serie):"",nfe_numeracao:g.nfe_numeracao!=null?String(g.nfe_numeracao):"",ambiente:g.ambiente||"homologacao",transmitenota_apikey:vl(g.transmitenota_apikey),transmitenota_base_url:vl(g.transmitenota_base_url),transmitenota_base_url_hml:vl(g.transmitenota_base_url_hml),transmitenota_apikey_hml:vl(g.transmitenota_apikey_hml),transmitenota_base_url_prod:vl(g.transmitenota_base_url_prod),transmitenota_apikey_prod:vl(g.transmitenota_apikey_prod)})),s(!1)}v()},[e?.codigo_empresa]);const f=v=>g=>{const y=g?.target?g.target.value:g;u(x=>({...x,[v]:y}))};async function h(v){if(v?.preventDefault?.(),!e?.codigo_empresa)return;const g={inscricao_estadual:d.inscricao_estadual?.trim()||null,regime_tributario:d.regime_tributario?Number(d.regime_tributario):null,logradouro:d.logradouro?.trim()||null,numero:d.numero?.trim()||null,complemento:d.complemento?.trim()||null,bairro:d.bairro?.trim()||null,cidade:d.cidade?.trim()||null,uf:d.uf?.trim().toUpperCase()||null,cep:Fj(d.cep)||null,codigo_municipio_ibge:d.codigo_municipio_ibge?.trim()||null,nfce_serie:d.nfce_serie?Number(d.nfce_serie):null,nfce_numeracao:d.nfce_numeracao?Number(d.nfce_numeracao):null,nfce_itoken:d.nfce_itoken?.trim()||null,nfe_serie:d.nfe_serie?Number(d.nfe_serie):null,nfe_numeracao:d.nfe_numeracao?Number(d.nfe_numeracao):null,ambiente:d.ambiente||"homologacao",transmitenota_apikey:d.transmitenota_apikey?.trim()||null,transmitenota_base_url:d.transmitenota_base_url?.trim()||null,transmitenota_base_url_hml:d.transmitenota_base_url_hml?.trim()||null,transmitenota_apikey_hml:d.transmitenota_apikey_hml?.trim()||null,transmitenota_base_url_prod:d.transmitenota_base_url_prod?.trim()||null,transmitenota_apikey_prod:d.transmitenota_apikey_prod?.trim()||null};try{i(!0);const{error:y}=await de.from("empresas").update(g).eq("codigo_empresa",e.codigo_empresa).select("id").single();if(y)throw y;t({title:"Configuraes salvas",description:"Dados fiscais atualizados."})}catch(y){t({title:"Erro ao salvar",description:y.message,variant:"destructive"})}finally{i(!1)}}async function m(v){const g=Fj(l?.cnpj||"");if(g.length!==14){t({title:"CNPJ invlido",description:"Salve um CNPJ vlido (14 dgitos) nos dados da empresa.",variant:"destructive"});return}const y=v==="prod",x=y?d.transmitenota_base_url_prod||"":d.transmitenota_base_url_hml||"",b=y?d.transmitenota_apikey_prod||"":d.transmitenota_apikey_hml||"";if(!x||!b){t({title:"Configurao incompleta",description:"Preencha Base URL e ApiKey do ambiente selecionado.",variant:"destructive"});return}try{const w=await Eot({baseUrl:x,apiKey:b,cnpj:g});if(!w.reachable){t({title:"Sem conexo",description:w.error||`Endpoint inacessvel (${w.status||"sem status"})`,variant:"destructive"});return}if(w.authorized===!1){t({title:"Credenciais invlidas",description:`HTTP ${w.status}. Verifique ApiKey e CNPJ.`,variant:"destructive"});return}const j=w.status===200?"OK":w.status===400?"Conectado (dados mnimos ausentes, mas credenciais e URL vlidas)":`Conectado (HTTP ${w.status})`;t({title:`Conexo ${y?"PROD":"HML"}: sucesso`,description:j})}catch(w){t({title:"Falha no teste",description:w.message||"Erro inesperado",variant:"destructive"})}}return a.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-6",children:[a.jsx(m1,{children:a.jsx("title",{children:"Configurao Fiscal"})}),a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx(fe,{type:"button",variant:"outline",size:"sm",onClick:()=>r(-1),children:"Voltar"}),a.jsxs("div",{className:"text-right",children:[a.jsx("h1",{className:"text-2xl font-semibold leading-tight",children:"Configurao Fiscal"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Dados que sero usados na emisso de NFC-e/NF-e."})]})]}),a.jsxs("form",{onSubmit:h,className:"grid gap-6 bg-surface border border-border rounded-lg p-4 shadow-sm",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx(qe,{children:"Inscrio Estadual"}),a.jsx(rt,{value:d.inscricao_estadual,onChange:f("inscricao_estadual")})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Regime Tributrio (CRT)"}),a.jsxs(vn,{value:d.regime_tributario,onValueChange:f("regime_tributario"),children:[a.jsx(hn,{children:a.jsx(wn,{placeholder:"Selecione"})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"1",children:"1 - Simples Nacional"}),a.jsx(ct,{value:"2",children:"2 - Simples Nacional (excesso sublimite)"}),a.jsx(ct,{value:"3",children:"3 - Regime Normal"})]})]})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Ambiente"}),a.jsxs(vn,{value:d.ambiente,onValueChange:f("ambiente"),children:[a.jsx(hn,{children:a.jsx(wn,{})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"homologacao",children:"Homologao"}),a.jsx(ct,{value:"producao",children:"Produo"})]})]})]})]}),a.jsxs("div",{className:"border-t border-border/40 pt-4 grid grid-cols-1 sm:grid-cols-4 gap-3",children:[a.jsxs("div",{className:"sm:col-span-3",children:[a.jsx(qe,{children:"Logradouro"}),a.jsx(rt,{value:d.logradouro,onChange:f("logradouro")})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Nmero"}),a.jsx(rt,{value:d.numero,onChange:f("numero")})]}),a.jsxs("div",{className:"sm:col-span-2",children:[a.jsx(qe,{children:"Complemento"}),a.jsx(rt,{value:d.complemento,onChange:f("complemento")})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Bairro"}),a.jsx(rt,{value:d.bairro,onChange:f("bairro")})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"CEP"}),a.jsx(rt,{value:d.cep,onChange:v=>f("cep")({target:{value:Fj(v.target.value)}})})]}),a.jsxs("div",{className:"sm:col-span-2",children:[a.jsx(qe,{children:"Cidade"}),a.jsx(rt,{value:d.cidade,onChange:f("cidade")})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"UF"}),a.jsx(rt,{value:d.uf,onChange:v=>f("uf")({target:{value:String(v.target.value||"").toUpperCase().slice(0,2)}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Cdigo IBGE Municpio (cMun)"}),a.jsx(rt,{value:d.codigo_municipio_ibge,onChange:f("codigo_municipio_ibge")})]})]}),a.jsxs("div",{className:"border-t border-border/40 pt-4 grid grid-cols-1 sm:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx(qe,{children:"NFC-e Srie"}),a.jsx(rt,{value:d.nfce_serie,onChange:f("nfce_serie")})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"NFC-e Numerao Inicial"}),a.jsx(rt,{value:d.nfce_numeracao,onChange:f("nfce_numeracao")})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"NFC-e IToken (CSC)"}),a.jsx(rt,{value:d.nfce_itoken,onChange:f("nfce_itoken")})]})]}),a.jsxs("div",{className:"border-t border-border/40 pt-4 grid grid-cols-1 sm:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx(qe,{children:"NF-e Srie (opcional)"}),a.jsx(rt,{value:d.nfe_serie,onChange:f("nfe_serie")})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"NF-e Numerao (opcional)"}),a.jsx(rt,{value:d.nfe_numeracao,onChange:f("nfe_numeracao")})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"ApiKey Transmite Nota (opcional)"}),a.jsx(rt,{value:d.transmitenota_apikey,onChange:f("transmitenota_apikey")})]})]}),a.jsxs("div",{className:"border-t border-border/40 pt-4 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"border border-border rounded-md p-3",children:[a.jsx("div",{className:"text-xs text-muted-foreground mb-2",children:"Transmite Nota  Homologao"}),a.jsx(qe,{className:"text-xs",children:"Base URL (HML)"}),a.jsx(rt,{value:d.transmitenota_base_url_hml,onChange:f("transmitenota_base_url_hml"),placeholder:"https://..."}),a.jsx("div",{className:"mt-3"}),a.jsx(qe,{className:"text-xs",children:"ApiKey (HML)"}),a.jsx(rt,{value:d.transmitenota_apikey_hml,onChange:f("transmitenota_apikey_hml")}),a.jsx("div",{className:"mt-3",children:a.jsx(fe,{type:"button",variant:"outline",size:"sm",onClick:()=>m("hml"),disabled:o||n,children:n?"Testando...":"Testar conexo HML"})})]}),a.jsxs("div",{className:"border border-border rounded-md p-3",children:[a.jsx("div",{className:"text-xs text-muted-foreground mb-2",children:"Transmite Nota  Produo"}),a.jsx(qe,{className:"text-xs",children:"Base URL (PROD)"}),a.jsx(rt,{value:d.transmitenota_base_url_prod,onChange:f("transmitenota_base_url_prod"),placeholder:"https://..."}),a.jsx("div",{className:"mt-3"}),a.jsx(qe,{className:"text-xs",children:"ApiKey (PROD)"}),a.jsx(rt,{value:d.transmitenota_apikey_prod,onChange:f("transmitenota_apikey_prod")}),a.jsx("div",{className:"mt-3",children:a.jsx(fe,{type:"button",variant:"outline",size:"sm",onClick:()=>m("prod"),disabled:o||n,children:n?"Testando...":"Testar conexo PROD"})})]})]}),a.jsx("div",{className:"flex gap-3 mt-4",children:a.jsx(fe,{type:"submit",disabled:o||n,children:o?"Salvando...":"Salvar Configuraes"})})]})]})}function Mb(e){return String(e||"").replace(/\D/g,"")}function _v(e){const t=Number(e??0);return Number.isFinite(t)?t.toFixed(2):"0.00"}function Tit(e){return e==null?"":String(e)}function Dit(e){return e?.length,0}function Mit(e,t){if(!e?.length)return"90";const r=e[0];return t.find(s=>s.id===r.finalizadora_id)?.codigo_sefaz||"99"}function Rit(e,t){if(t){const r=Mb(t.cpf||t.cnpj||t.cpf_cnpj||t.cpf_cnpj_limpo);return{nome:t.nome||t.nome_completo||t.razao_social||"",cpf_cnpj:r||void 0,ie:t.inscricao_estadual||void 0,email:t.email||void 0,telefone:Mb(t.telefone)||void 0,endereco:{logradouro:t.logradouro||t.endereco||"",numero:Tit(t.numero||""),complemento:t.complemento||"",bairro:t.bairro||"",municipio:t.municipio||t.cidade||"",uf:t.uf||"",cep:Mb(t.cep),codigo_cidade:t.codigo_municipio||t.codigo_municipio_ibge||void 0,pais:t.pais||"Brasil"},indicador_ie_destinatario:t.indicador_ie_destinatario||9}}return null}async function Iv({comandaId:e,codigoEmpresa:t}){if(!e)throw new Error("comandaId obrigatrio");if(!t)throw new Error("codigoEmpresa obrigatrio");const{data:r,error:n}=await de.from("empresas").select("*").eq("codigo_empresa",t).single();if(n)throw n;const{data:s,error:o}=await de.from("comandas").select("*").eq("codigo_empresa",t).eq("id",e).single();if(o)throw o;let i=null;if(s.cliente_id){const{data:_}=await de.from("clientes").select("*").eq("id",s.cliente_id).single();i=_||null}else{const{data:_}=await de.from("comanda_clientes").select("clientes:clientes!comanda_clientes_cliente_id_fkey(*)").eq("comanda_id",s.id).limit(1),S=Array.isArray(_)&&_.length?_[0]:null;S?.clientes&&(i=S.clientes)}const{data:l,error:c}=await de.from("comanda_itens").select("*").eq("comanda_id",s.id);if(c)throw c;const d=Array.from(new Set(l.map(_=>_.produto_id).filter(Boolean)));let u=new Map;if(d.length){const{data:_}=await de.from("produtos").select("*").in("id",d);(_||[]).forEach(S=>u.set(S.id,S))}const{data:f}=await de.from("pagamentos").select("*").eq("comanda_id",s.id),h=Array.from(new Set((f||[]).map(_=>_.finalizadora_id).filter(Boolean)));let m=[];if(h.length){const{data:_}=await de.from("finalizadoras").select("*").in("id",h);m=_||[]}const v=l.reduce((_,S)=>_+Number(S.quantidade||0)*Number(S.preco_unitario||0),0),g=l.reduce((_,S)=>_+Number(S.desconto||0),0),y=v-g,x=Rit(s,i),b={tipo_operacao:1,natureza_operacao:"Venda de mercadoria",forma_pagamento:Dit(f),meio_pagamento:Mit(f,m),data_emissao:new Date(s.fechado_em||s.updated_at||Date.now()).toLocaleDateString("pt-BR"),data_saida_entrada:new Date(s.fechado_em||Date.now()).toLocaleDateString("pt-BR"),hora_saida_entrada:new Date(s.fechado_em||Date.now()).toTimeString().slice(0,8),finalidade_emissao:1,valor_frete:"0",valor_seguro:"0",valor_ipi:"0",valor_total:_v(y),valor_total_sem_desconto:_v(v),...x?{nome_destinatario:x.nome,cnpj_destinatario:x.cpf_cnpj,inscricao_estadual_destinatario:x.ie,email_destinatario:x.email,telefone_destinatario:x.telefone,logradouro_destinatario:x.endereco.logradouro,numero_destinatario:x.endereco.numero,complemento_destinatario:x.endereco.complemento,bairro_destinatario:x.endereco.bairro,municipio_destinatario:x.endereco.municipio,codigo_cidade:x.endereco.codigo_cidade,uf_destinatario:x.endereco.uf,pais_destinatario:x.endereco.pais,cep_destinatario:x.endereco.cep,indicador_ie_destinatario:x.indicador_ie_destinatario}:{},Itens:l.map((_,S)=>{const C=u.get(_.produto_id)||{},P=Number(_.quantidade||0),A=Number(_.preco_unitario||0),R=Number(_.desconto||0),O=P*A-R,I=C.cfop_interno||C.cfop||5102,M=(C.ncm||"").replace(/\D/g,"").slice(0,8)||"",D=C.unidade||C.unit||"UN",U=C.csosn_interno||C.csosn||null;C.cst_icms_interno||C.cstIcmsInterno;const z=C.cst_pis_saida||C.cstPisSaida||"07",W=C.cst_cofins_saida||C.cstCofinsSaida||"07",$=C.icms_origem??0;return{numero_item:S+1,codigo_produto:C.code||C.codigo||C.id,descricao:C.name||C.descricao||_.descricao||"Item",cfop:Number(I),unidade_comercial:D,quantidade_comercial:P,valor_unitario_comercial:_v(A),codigo_ncm:M,valor_desconto:R?_v(R):"",valor_frete:"",valor_seguro:"",valor_outras_despesas:"",valor_total:_v(O),valor_total_sem_desconto:_v(P*A),icms_csosn:U?Number(U):void 0,icms_orig:Number($)||0,pis_situacao_tributaria:z,base_calculo_pis:"",aliquota_pis:"",valor_pis:"",cofins_situacao_tributaria:W,base_calculo_cofins:"",aliquota_cofins:"",valor_cofins:""}})},w=[];r?.inscricao_estadual||w.push("Inscrio Estadual (empresa)"),r?.regime_tributario||w.push("CRT/Regime Tributrio (empresa)"),(!r?.cidade||!r?.uf)&&w.push("Cidade/UF (empresa)"),r?.codigo_municipio_ibge||w.push("Cdigo IBGE do municpio (empresa)"),r?.nfce_serie||w.push("NFC-e Srie (empresa)"),!r?.nfce_itoken&&r?.ambiente==="producao"&&w.push("NFC-e IToken/CSC (produo)"),Mb(r?.cnpj)||w.push("CNPJ da empresa"),l.forEach(_=>{const S=u.get(_.produto_id)||{};S.ncm||w.push(`Produto ${S.name||S.id}: NCM`),!S.cfop_interno&&!S.cfop&&w.push(`Produto ${S.name||S.id}: CFOP interno`)});const j={ApiKey:r?.transmitenota_apikey||"",Cnpj:Mb(r?.cnpj),Dados:b};return{empresa:r,comanda:s,cliente:i,itens:l,pagamentos:f,finalizadoras:m,payload:j,missing:w}}async function Lit({comandaId:e,codigoEmpresa:t,modelo:r="65",overrides:n={}}){if(!e)throw new Error("ID da comanda  obrigatrio");if(!t)throw new Error("Cdigo da empresa  obrigatrio");const{data:s,error:o}=await de.from("vendas").select("*").eq("id",e).eq("codigo_empresa",t).single();if(o)throw new Error(`Erro ao buscar comanda: ${o.message}`);if(!s)throw new Error("Comanda no encontrada");const{data:i,error:l}=await de.from("itens_venda").select(`
      *,
      produtos!itens_venda_produto_id_fkey (
        id,
        nome,
        codigo,
        ncm,
        cest,
        cfopInterno,
        cfopExterno,
        cstIcmsInterno,
        cstIcmsExterno,
        csosnInterno,
        csosnExterno,
        aliqIcmsInterno,
        aliqIcmsExterno,
        cstPisEntrada,
        cstPisSaida,
        aliqPisPercent,
        aliqCofinsPercent,
        cstIpi,
        aliqIpiPercent
      )
    `).eq("comanda_id",e).eq("codigo_empresa",t);if(l)throw new Error(`Erro ao buscar itens: ${l.message}`);const{data:c,error:d}=await de.from("pagamentos").select(`
      *,
      finalizadoras!pagamentos_finalizadora_id_fkey (
        id,
        codigo_sefaz,
        nome
      )
    `).eq("comanda_id",e).eq("codigo_empresa",t).neq("status","Cancelado").neq("status","Estornado");if(d)throw new Error(`Erro ao buscar pagamentos: ${d.message}`);const{data:u,error:f}=await de.from("empresas").select("*").eq("codigo_empresa",t).single();if(f)throw new Error(`Erro ao buscar empresa: ${f.message}`);let h=null;if(s.cliente_id){const{data:m}=await de.from("clientes").select("*").eq("id",s.cliente_id).eq("codigo_empresa",t).single();h=m}return moe({comanda:s,itens:i||[],pagamentos:c||[],empresa:u,cliente:h,modelo:r,overrides:n})}async function Fit({codigoEmpresa:e,empresa:t,cliente:r,itens:n,pagamentos:s,modelo:o="55",overrides:i={}}){let l=t;if(!l){if(!e)throw new Error("codigoEmpresa obrigatrio quando empresa no for fornecida");const{data:f,error:h}=await de.from("empresas").select("*").eq("codigo_empresa",e).single();if(h)throw new Error(`Erro ao buscar empresa: ${h.message}`);l=f}const c={numero:i?.nNF||"1",desconto:0},d=Array.isArray(n)?n.map(f=>({preco_unitario:Number(f.preco_unitario)||0,quantidade:Number(f.quantidade)||1,preco_total:Number(f.preco_total!=null?f.preco_total:(Number(f.preco_unitario)||0)*(Number(f.quantidade)||1)),produtos:f.produtos||{id:f.produto_id||f.id,nome:f.nome||f.descricao||"Produto",codigo:f.codigo||String(f.produto_id||f.id||""),ncm:f.ncm||"",cest:f.cest||"",cfopInterno:f.cfop||f.cfopInterno,cstIcmsInterno:f.cstIcmsInterno,csosnInterno:f.csosnInterno,aliqIcmsInterno:f.aliqIcmsInterno,cstPisSaida:f.cstPisSaida,aliqPisPercent:f.aliqPisPercent,aliqCofinsPercent:f.aliqCofinsPercent}})):[],u=Array.isArray(s)&&s.length?s:[{finalizadoras:{codigo_sefaz:"99"},valor:d.reduce((f,h)=>f+(Number(h.preco_total)||0),0)}];return moe({comanda:c,itens:d,pagamentos:u,empresa:l,cliente:r,modelo:o,overrides:i})}function moe({comanda:e,itens:t,pagamentos:r,empresa:n,cliente:s,modelo:o="65",overrides:i={}}){const c=new Date().toISOString(),d=String(i.nNF||e.numero||"1"),u=o==="55"?"55":"65",f=u==="55"?"NF-e":"NFC-e",h=t.reduce((D,U)=>D+(Number(U.preco_total)||0),0),m=Number(e.desconto)||0,v=h-m,g=String(i.natOp||"VENDA"),y=String(i.serie||"1"),x=String(i.tpAmb||(n.ambiente==="producao"?"1":"2")),b=String(i.tpNF||"1"),w=String(i.indFinal||"1"),j=String(i.indPres||"1"),_=s&&s.uf&&n.uf&&s.uf!==n.uf?"2":"1",S=String(i.idDest||_),P=String({AC:"12",AL:"27",AM:"13",AP:"16",BA:"29",CE:"23",DF:"53",ES:"32",GO:"52",MA:"21",MG:"31",MS:"50",MT:"51",PA:"15",PB:"25",PE:"26",PI:"22",PR:"41",RJ:"33",RN:"24",RO:"11",RR:"14",RS:"43",SC:"42",SE:"28",SP:"35",TO:"17"}[(n.uf||"").toUpperCase()]||n.codigo_uf||"35"),A=String(n.codigo_municipio_ibge||n.codigo_municipio||""),R=s?`
    <dest>
      <${s.tipo_pessoa==="PJ"?"CNPJ":"CPF"}>${s.cpf_cnpj||""}</${s.tipo_pessoa==="PJ"?"CNPJ":"CPF"}>
      <xNome>${Hl(s.nome||s.razao_social||"")}</xNome>
      <enderDest>
        <xLgr>${Hl(s.logradouro||"")}</xLgr>
        <nro>${Hl(s.numero||"S/N")}</nro>
        <xBairro>${Hl(s.bairro||"")}</xBairro>
        <cMun>${s.codigo_municipio||s.codigo_municipio_ibge||""}</cMun>
        <xMun>${Hl(s.municipio||s.cidade||"")}</xMun>
        <UF>${s.uf||""}</UF>
        <CEP>${(s.cep||"").replace(/\D/g,"")}</CEP>
        <cPais>1058</cPais>
        <xPais>BRASIL</xPais>
      </enderDest>
      <indIEDest>9</indIEDest>
      ${s.email?`<email>${Hl(s.email)}</email>`:""}
    </dest>`:`
    <dest>
      <indIEDest>9</indIEDest>
    </dest>`,O=t.map((D,U)=>{const z=D.produtos||{},W=Number(D.preco_unitario)||0,$=Number(D.quantidade)||1,X=Number(D.preco_total)||W*$;return`
    <det nItem="${U+1}">
      <prod>
        <cProd>${Hl(z.codigo||D.produto_id)}</cProd>
        <cEAN>SEM GTIN</cEAN>
        <xProd>${Hl(z.nome||"Produto")}</xProd>
        <NCM>${z.ncm||"00000000"}</NCM>
        ${z.cest?`<CEST>${z.cest}</CEST>`:""}
        <CFOP>${z.cfopInterno||"5102"}</CFOP>
        <uCom>UN</uCom>
        <qCom>${$.toFixed(4)}</qCom>
        <vUnCom>${W.toFixed(10)}</vUnCom>
        <vProd>${X.toFixed(2)}</vProd>
        <cEANTrib>SEM GTIN</cEANTrib>
        <uTrib>UN</uTrib>
        <qTrib>${$.toFixed(4)}</qTrib>
        <vUnTrib>${W.toFixed(10)}</vUnTrib>
        <indTot>1</indTot>
      </prod>
      <imposto>
        <ICMS>
          ${z.csosnInterno?`
          <ICMSSN102>
            <orig>0</orig>
            <CSOSN>${z.csosnInterno}</CSOSN>
          </ICMSSN102>`:`
          <ICMS00>
            <orig>0</orig>
            <CST>${z.cstIcmsInterno||"00"}</CST>
            <modBC>3</modBC>
            <vBC>${X.toFixed(2)}</vBC>
            <pICMS>${z.aliqIcmsInterno||"0.00"}</pICMS>
            <vICMS>${(X*(Number(z.aliqIcmsInterno)||0)/100).toFixed(2)}</vICMS>
          </ICMS00>`}
        </ICMS>
        <PIS>
          <PISAliq>
            <CST>${z.cstPisSaida||"01"}</CST>
            <vBC>${X.toFixed(2)}</vBC>
            <pPIS>${z.aliqPisPercent||"0.00"}</pPIS>
            <vPIS>${(X*(Number(z.aliqPisPercent)||0)/100).toFixed(2)}</vPIS>
          </PISAliq>
        </PIS>
        <COFINS>
          <COFINSAliq>
            <CST>${z.cstPisSaida||"01"}</CST>
            <vBC>${X.toFixed(2)}</vBC>
            <pCOFINS>${z.aliqCofinsPercent||"0.00"}</pCOFINS>
            <vCOFINS>${(X*(Number(z.aliqCofinsPercent)||0)/100).toFixed(2)}</vCOFINS>
          </COFINSAliq>
        </COFINS>
      </imposto>
    </det>`}).join(""),I=r.map(D=>{const U=D.finalizadoras?.codigo_sefaz||"99",z=Number(D.valor)||0;return`
    <pag>
      <detPag>
        <tPag>${U}</tPag>
        <vPag>${z.toFixed(2)}</vPag>
      </detPag>
    </pag>`}).join("");return`<?xml version="1.0" encoding="UTF-8"?>
<nfeProc versao="4.00" xmlns="http://www.portalfiscal.inf.br/nfe">
  <NFe xmlns="http://www.portalfiscal.inf.br/nfe">
    <infNFe versao="4.00" Id="NFe${n.cnpj||""}${d.padStart(9,"0")}">
      <ide>
        <cUF>${P}</cUF>
        <cNF>${d.padStart(8,"0")}</cNF>
        <natOp>${g}</natOp>
        <mod>${u}</mod>
        <serie>${y}</serie>
        <nNF>${d}</nNF>
        <dhEmi>${c}</dhEmi>
        <tpNF>${b}</tpNF>
        <idDest>${S}</idDest>
        <cMunFG>${A}</cMunFG>
        <tpImp>4</tpImp>
        <tpEmis>1</tpEmis>
        <tpAmb>${x}</tpAmb>
        <finNFe>1</finNFe>
        <indFinal>${w}</indFinal>
        <indPres>${j}</indPres>
        <procEmi>0</procEmi>
        <verProc>1.0.0</verProc>
      </ide>
      <emit>
        <CNPJ>${n.cnpj||""}</CNPJ>
        <xNome>${Hl(n.razao_social||n.nome_fantasia||"")}</xNome>
        <xFant>${Hl(n.nome_fantasia||"")}</xFant>
        <enderEmit>
          <xLgr>${Hl(n.logradouro||"")}</xLgr>
          <nro>${Hl(n.numero||"S/N")}</nro>
          <xBairro>${Hl(n.bairro||"")}</xBairro>
          <cMun>${n.codigo_municipio_ibge||n.codigo_municipio||""}</cMun>
          <xMun>${Hl(n.municipio||n.cidade||"")}</xMun>
          <UF>${n.uf||""}</UF>
          <CEP>${(n.cep||"").replace(/\D/g,"")}</CEP>
          <cPais>1058</cPais>
          <xPais>BRASIL</xPais>
          <fone>${(n.telefone||"").replace(/\D/g,"")}</fone>
        </enderEmit>
        <IE>${n.inscricao_estadual||""}</IE>
        <CRT>${n.regime_tributario||"1"}</CRT>
      </emit>
      ${R}
      ${O}
      <total>
        <ICMSTot>
          <vBC>0.00</vBC>
          <vICMS>0.00</vICMS>
          <vICMSDeson>0.00</vICMSDeson>
          <vFCP>0.00</vFCP>
          <vBCST>0.00</vBCST>
          <vST>0.00</vST>
          <vFCPST>0.00</vFCPST>
          <vFCPSTRet>0.00</vFCPSTRet>
          <vProd>${h.toFixed(2)}</vProd>
          <vFrete>0.00</vFrete>
          <vSeg>0.00</vSeg>
          <vDesc>${m.toFixed(2)}</vDesc>
          <vII>0.00</vII>
          <vIPI>0.00</vIPI>
          <vIPIDevol>0.00</vIPIDevol>
          <vPIS>0.00</vPIS>
          <vCOFINS>0.00</vCOFINS>
          <vOutro>0.00</vOutro>
          <vNF>${v.toFixed(2)}</vNF>
        </ICMSTot>
      </total>
      <transp>
        <modFrete>9</modFrete>
      </transp>
      ${I}
      <infAdic>
        <infCpl>Comanda: ${e.id} | Modelo: ${f}</infCpl>
      </infAdic>
    </infNFe>
  </NFe>
</nfeProc>`}function Hl(e){return e?String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):""}const dV=[{code:"1102",desc:"Compra para industrializao, comercializao ou prestao de servios"},{code:"5101",desc:"Venda de produo do estabelecimento"},{code:"5102",desc:"Venda de mercadoria adquirida de terceiros"},{code:"5103",desc:"Venda de produo do estabelecimento, efetuada fora do estabelecimento"},{code:"5104",desc:"Venda de mercadoria adquirida de terceiros, efetuada fora do estabelecimento"},{code:"5405",desc:"Venda de mercadoria adquirida de terceiros, sujeita a ST"},{code:"5949",desc:"Outras sadas de mercadorias no especificadas"},{code:"5915",desc:"Remessa em bonificao, doao ou brinde"},{code:"5109",desc:"Venda de produo do estabelecimento, destinada a no contribuinte"},{code:"5110",desc:"Venda de mercadoria adquirida de terceiros, destinada a no contribuinte"},{code:"5401",desc:"Venda de produo do estabelecimento, sujeita a ST"},{code:"5403",desc:"Venda de mercadoria, de terceiros, sujeita a ST, efetuada pelo industrial substituto"},{code:"2102",desc:"Compra para industrializao, comercializao ou prestao de servios (fora do estado)"},{code:"6101",desc:"Venda de produo do estabelecimento (fora do estado)"},{code:"6102",desc:"Venda de mercadoria adquirida de terceiros (fora do estado)"},{code:"6403",desc:"Venda de produo do estabelecimento, sujeita a ST (fora do estado)"},{code:"6915",desc:"Remessa em bonificao, doao ou brinde (fora do estado)"}],KS=!1,$it="",Bit="Estamos em manuteno no momento. Voltaremos em breve.";function ld(e){return Number(e||0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}function uV(e){if(!e)return"";try{return new Date(e).toLocaleString("pt-BR")}catch{return""}}function Nv({label:e,value:t,onChange:r}){const[n,s]=Pe.useState(!1),o=Pe.useRef(null),i=Pe.useRef(null),[l,c]=Pe.useState({top:0,left:0}),d=m=>{try{const[v,g,y]=String(m||"").split("-").map(Number);return v&&g&&y?new Date(v,g-1,y):null}catch{return null}},u=m=>{const v=g=>String(g).padStart(2,"0");return`${m.getFullYear()}-${v(m.getMonth()+1)}-${v(m.getDate())}`},f=Pe.useCallback(()=>{if(!i.current)return;const m=i.current.getBoundingClientRect(),v=320,g=Math.min(Math.max(8,m.left),window.innerWidth-v-8),y=Math.min(m.bottom+6,window.innerHeight-8-300);c({top:y,left:g})},[]);Pe.useEffect(()=>{const m=v=>{n&&o.current&&!o.current.contains(v.target)&&s(!1)};return window.addEventListener("mousedown",m),()=>window.removeEventListener("mousedown",m)},[n]),Pe.useEffect(()=>{if(!n)return;f();const m=()=>f(),v=()=>f();return window.addEventListener("scroll",m,!0),window.addEventListener("resize",v),()=>{window.removeEventListener("scroll",m,!0),window.removeEventListener("resize",v)}},[n,f]);const h=d(t);return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"relative",ref:o,children:a.jsx("button",{ref:i,type:"button",className:"h-7 px-2 rounded-md bg-surface border border-border text-xs",onClick:()=>s(m=>!m),children:t?new Date(t+"T00:00:00").toLocaleDateString("pt-BR"):e})}),n&&g4.createPortal(a.jsx("div",{className:"fixed z-[1000] p-2 bg-black text-white border border-warning/40 rounded-md shadow-xl",style:{top:l.top,left:l.left},children:a.jsx(yi,{mode:"single",selected:h||void 0,onSelect:m=>{m&&(r(u(m)),s(!1))},showOutsideDays:!0,classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md",table:"w-full"}})}),document.body)]})}function qit(){const{userProfile:e}=ms(),t=e?.codigo_empresa,{toast:r}=Qa(),n=zi(),[s,o]=p.useState([]),[i,l]=p.useState(!1),[c,d]=p.useState(""),[u,f]=p.useState("all"),h=k=>String(k).padStart(2,"0"),m=new Date,v=m.getFullYear(),g=m.getMonth()+1,y=`${v}-${h(g)}-01`,x=`${v}-${h(g)}-${h(new Date(v,g,0).getDate())}`,[b,w]=p.useState(y),[j,_]=p.useState(x),[S,C]=p.useState(!1),[P,A]=p.useState(null),[R,O]=p.useState("nfce"),[I,M]=p.useState(!1),[D,U]=p.useState(!1);p.useEffect(()=>{try{const k=String({}.VITE_MAINTENANCE_MODE||"").toLowerCase()==="true",T=localStorage.getItem("maintenance:active")==="true",K=localStorage.getItem("maintenance:end"),H=K?new Date>new Date(K):!1,F=(!!KS||k||T)&&!H,Le=(()=>{try{const it=localStorage.getItem("maintenance:bypass")==="1",lt=sessionStorage.getItem("maintenance:bypass")==="1",Vt=document.cookie.split(";").some(Ve=>Ve.trim()==="fx_maint_bypass=1");return it||lt||Vt}catch{return!1}})();M(F),U(Le)}catch{M(!!KS),U(!1)}},[]);const[z,W]=p.useState(!1),[$,X]=p.useState(!1),[ye,Se]=p.useState(null),[V,B]=p.useState([]),[Q,pe]=p.useState([]),[te,Y]=p.useState(!1),[ce,me]=p.useState(!1),[ae,le]=p.useState(""),[ue,Re]=p.useState(null),[ne,ie]=p.useState({natOp:"VENDA",serie:"1",nNF:"",indFinal:"1",indPres:"1",idDest:""}),[gt,bt]=p.useState(!1),[at,xt]=p.useState(!1),[Ze,ht]=p.useState(""),[Wt,be]=p.useState(!1),Ct=new Date,wt=`${Ct.getFullYear()}-${h(Ct.getMonth()+1)}-${h(Ct.getDate())}`,[Ge,Je]=p.useState({natOp:"VENDA",serie:"1",nNF:"",indFinal:"1",indPres:"1",idDest:"",finNFe:"1",data_emissao:wt,data_saida:wt,tipo_nota:"saida",baixar_estoque:!0,destacar_st:!1,cfop_padrao:"5102",indIntermed:"0",intermediador_cnpj:"",intermediador_id:"",parte_tipo:"cliente",party_id:"",party_codigo:"",tipo_pessoa:"PJ",cpf_cnpj:"",nome:"",email:"",telefone:"",inscricao_estadual:"",ie_isento:!1,logradouro:"",numero:"",bairro:"",cidade:"",uf:"",cep:"",codigo_municipio_ibge:"",itens:[{descricao:"",codigo:"",cod_barras:"",ncm:"",cest:"",cfop:"5102",unidade:"UN",quantidade:"1",preco_unitario:"0.00",desconto_valor:"0.00",desconto_percent:"",acrescimos_valor:"0.00",frete_valor:"0.00",seguro_valor:"0.00",obs:"",dest_icms:!1,dest_icms_info:!1,benef_fiscal:!1,impostos:{origem:"",icms:{cst:"",csosn:"",base:"",aliquota:"",valor:"",desonerado_valor:"",desoneracao_motivo:"",operacao_valor:"",aliq_diferimento:"",valor_diferido:"",reducao_percent:"",reducao_motivo:"",ad_rem:"",ad_rem_retencao:"",monofasico_bc:"",monofasico_valor:"",mono_retencao_bc:"",mono_retencao_valor:"",mono_cobrado_ant_bc:"",mono_cobrado_ant_valor:"",proprio_devido_valor:""},icmsst:{base:"",aliquota:"",valor:""},fcp:{base:"",aliquota:"",valor:""},fcpst:{base:"",aliquota:"",valor:""},pis:{cst:"",aliquota:"",valor:""},cofins:{cst:"",aliquota:"",valor:""},ipi:{cst:"",aliquota:"",valor:"",tipo_calculo:"nenhum",valor_unit:""},combustivel:{uf:"",perc_origem_uf:"",indicador_importacao:""},cide:{base:"",aliq:"",valor:""},iss:{aliquota:"",valor:""}}}],totais:{desconto_geral:"0.00",frete:"0.00",outras_despesas:"0.00"},pagamentos:[{tipo:"Dinheiro",bandeira:"",cnpj_credenciadora:"",valor:"",parcelas:"",troco:""}],transporte:{tipo_frete:"",transportadora:"",placa:"",volumes:"",peso_liquido:"",peso_bruto:""},adicionais:{obs_gerais:"",info_fisco:"",info_cliente:"",referencia_doc:""}}),[_e,je]=p.useState("cliente"),[Ue,ze]=p.useState(!1),[or,tr]=p.useState(""),[Nt,yr]=p.useState([]),[Me,dt]=p.useState(""),[ut,rr]=p.useState(null),[hr,It]=p.useState(!1),[dr,ur]=p.useState(null),[er,ln]=p.useState(!1);p.useState(!1);const[Mr,Ye]=p.useState(""),[$e,Be]=p.useState([]),[et,jt]=p.useState("cliente"),[yt,qt]=p.useState([]),[pt,Dt]=p.useState(null),[he,Qe]=p.useState(""),[zt,Mt]=p.useState(!1);p.useState(!1),p.useState("");const[ir,nr]=p.useState(!0),kr=k=>String(k||"").replace(/\D/g,""),Ft=k=>{const T=String(k??"").replace(/\./g,"").replace(",","."),K=Number(T);return Number.isFinite(K)?K:0};p.useEffect(()=>{Je(k=>({...k,baixar_estoque:k.tipo_nota!=="entrada"}))},[Ge.tipo_nota]),p.useEffect(()=>{Je(k=>({...k,cfop_padrao:Kt(k.uf)}))},[Ge.tipo_nota,or,Ge.uf]);const Dr=p.useRef(Ge.cfop_padrao);p.useEffect(()=>{const k=Dr.current,T=Ge.cfop_padrao||"";Dr.current=T,!(!ir||!T)&&Je(K=>{const H=K.itens||[];let F=!1;const Le=H.map(it=>{const lt=String(it.cfop||"");return lt===""||k&&lt===k?(F=!0,{...it,cfop:T}):it});return F?{...K,itens:Le}:K})},[Ge.cfop_padrao,ir]);const Fr=k=>T=>{const K=String(T?.target?.tagName||"").toLowerCase();["input","select","button","svg","path","textarea"].includes(K)||Dt(pt===k?null:k)},Tn=k=>{const T=String(k||"").replace(/\D/g,"");if(!T)return"";const K=T.slice(0,Math.max(1,T.length-2)),H=T.slice(-2).padStart(2,"0");return`${Number(K).toLocaleString("pt-BR")},${H}`},nt=Array.isArray(dV)?dV:[];p.useEffect(()=>{let k=!1;async function T(){if(t)try{const{data:K}=await de.from("empresas").select("uf").eq("codigo_empresa",t).single();k||tr(K?.uf||"")}catch{}}return T(),()=>{k=!0}},[t]),p.useEffect(()=>{let k=!0;async function T(){if(!(!at||!t))try{const K=await bu({includeInactive:!1,codigoEmpresa:t});k&&yr(K||[])}catch{k&&yr([])}}return T(),()=>{k=!1}},[at,t]);const $t=p.useMemo(()=>{const k=(Me||"").trim().toLowerCase();return k?Nt.filter(T=>(T.name||"").toLowerCase().includes(k)||(T.code||"").toLowerCase().includes(k)).slice(0,100):Nt.slice(0,100)},[Nt,Me]),Kt=(k,T=Ge.tipo_nota)=>{const K=String(or||"").toUpperCase(),H=String(k||"").toUpperCase(),Le=!!K&&!!H?H===K:!0;return T!=="entrada"?Le?"5102":"6102":Le?"1102":"2102"},sr=k=>{const K=(nt.find(H=>H.code===k)?.desc||"").toLowerCase();return Ge.tipo_nota==="entrada"&&(K.includes("compra")||K.includes("entrada"))?"COMPRA":K.includes("venda")?"VENDA":K.includes("devolu")?"DEVOLUCAO":K.includes("transfer")?"TRANSFERENCIA":K.includes("bonifica")?"BONIFICACAO":K.includes("remessa")?"REMESSA":K.includes("demonstra")?"DEMONSTRACAO":Ge.natOp||"VENDA"},St=(k,T)=>{Je(K=>{const H=[...K.itens],F=T?.cfopInterno||T?.cfopExterno||Kt(K.uf),Le=Number(T?.price??T?.salePrice??0)||0,it=String(K.uf||"").toUpperCase()===String(or||"").toUpperCase(),lt=it?T?.cstIcmsInterno||"":T?.cstIcmsExterno||"",Vt=it?T?.csosnInterno||"":T?.csosnExterno||"",Ve=it?T?.aliqIcmsInterno??null:T?.aliqIcmsExterno??null,kt=T?.cstPisSaida||((T?.aliqPisPercent??null)!=null?"01":""),Sr=T?.aliqPisPercent??null,Or=(T?.aliqCofinsPercent??null)!=null?"01":"",fr=T?.aliqCofinsPercent??null,Kr=T?.cstIpi||"",Pn=T?.aliqIpiPercent??null;H[k]={...H[k],descricao:T?.name||H[k].descricao,codigo:T?.code||H[k].codigo,cod_barras:T?.barcode||T?.ean||T?.gtin||T?.bar_code||H[k].cod_barras,unidade:(T?.unit||"UN").toString().toUpperCase(),ncm:T?.ncm||H[k].ncm,cest:T?.cest||H[k].cest,cfop:F||H[k].cfop,preco_unitario:Le?Le.toFixed(2):H[k].preco_unitario,impostos:{...H[k].impostos||{},icms:{...H[k].impostos?.icms||{},cst:lt||H[k].impostos?.icms?.cst||"",csosn:Vt||H[k].impostos?.icms?.csosn||"",aliquota:Ve!=null?String(Ve):H[k].impostos?.icms?.aliquota||""},pis:{...H[k].impostos?.pis||{},cst:kt||H[k].impostos?.pis?.cst||"",aliquota:Sr!=null?String(Sr):H[k].impostos?.pis?.aliquota||""},cofins:{...H[k].impostos?.cofins||{},cst:Or||H[k].impostos?.cofins?.cst||"",aliquota:fr!=null?String(fr):H[k].impostos?.cofins?.aliquota||""},ipi:{...H[k].impostos?.ipi||{},cst:Kr||H[k].impostos?.ipi?.cst||"",aliquota:Pn!=null?String(Pn):H[k].impostos?.ipi?.aliquota||""}}};const qn=sr(F||H[k].cfop);return{...K,itens:H,natOp:qn}}),rr(null)};p.useEffect(()=>{let k=!0;async function T(){if(er)try{if(et==="fornecedor"){const K=await dst(t);k&&Be(K||[])}else{const K=await jb({searchTerm:Mr,limit:50,codigoEmpresa:t});k&&Be(K||[])}}catch{k&&Be([])}}return T(),()=>{k=!1}},[er,Mr,et,t]);const Jr=p.useMemo(()=>{const k=(Mr||"").trim().toLowerCase();return k?($e||[]).filter(T=>{const K=String(T.codigo||T.codigo_cliente||T.codigo_fornecedor||T.code||"").toLowerCase(),H=String(T.nome||T.razao_social||T.apelido||"").toLowerCase(),F=String(T.cnpj||T.cpf||"").toLowerCase();return K.includes(k)||H.includes(k)||F.includes(k)}):$e||[]},[$e,Mr]),Pt=async k=>{const T=String(k||"").replace(/\D/g,"");if(!(!T||!t))try{let K=de.from("clientes").select("*").eq("codigo_empresa",t).eq("codigo",Number(T)).limit(1);Ge.tipo_nota==="entrada"&&(K=K.eq("is_fornecedor",!0));const{data:H}=await K.single();H&&lr(H)}catch{}},lr=k=>{if(!k)return;const T=(k.tipo_pessoa||"PJ")==="PJ"||!!k.cnpj;Je(K=>({...K,parte_tipo:et,party_id:k.id||"",party_codigo:String(k.codigo||k.codigo_cliente||k.codigo_fornecedor||k.code||""),tipo_pessoa:T?"PJ":"PF",cpf_cnpj:(k.cnpj||k.cpf||"").toString(),nome:k.nome||k.razao_social||k.apelido||"",email:k.email||"",telefone:k.telefone||"",logradouro:k.endereco||k.logradouro||"",numero:k.numero||"",bairro:k.bairro||"",cidade:k.cidade||"",uf:k.uf||"",cep:k.cep||"",codigo_municipio_ibge:k.cidade_ibge||k.codigo_municipio_ibge||"",inscricao_estadual:k.ie||k.inscricao_estadual||"",ie_isento:k.ie==="ISENTO"||!1})),ln(!1)};p.useEffect(()=>{let k=!0;async function T(){if(!(!at||_e!=="pagamento"))try{const K=await th({somenteAtivas:!0,codigoEmpresa:t});k&&qt(Array.isArray(K)?K:[])}catch{k&&qt([])}}return T(),()=>{k=!1}},[at,_e,t]);const st=k=>/.+@.+\..+/.test(String(k||"")),Et=async k=>{const T=kr(k);if(T.length===8)try{ze(!0);let K=null;try{const H=await fetch(`https://brasilapi.com.br/api/cep/v2/${T}`);H.ok&&(K=await H.json())}catch{}if(!K)try{const H=await fetch(`https://viacep.com.br/ws/${T}/json/`);H.ok&&(K=await H.json())}catch{}if(K){const H=K.street||K.logradouro||"",F=K.neighborhood||K.bairro||"",Le=K.city||K.localidade||"",it=(K.state||K.uf||"").toString().toUpperCase().slice(0,2),lt=K.city_ibge_code||K.ibge||"";Je(Vt=>({...Vt,logradouro:H||Vt.logradouro,bairro:F||Vt.bairro,cidade:Le||Vt.cidade,uf:it||Vt.uf,codigo_municipio_ibge:lt||Vt.codigo_municipio_ibge}))}}finally{ze(!1)}},ar=()=>{try{const k=localStorage.getItem("auth:userProfile");return k&&JSON.parse(k)?.codigo_empresa||null}catch{return null}},Tr=()=>{let k=null,T=null;if(b&&(k=new Date(b+"T00:00:00").toISOString()),j){const K=new Date(j+"T00:00:00");K.setDate(K.getDate()+1),T=K.toISOString()}return{fromISO:k,toISOExclusive:T}},Qr=async()=>{if(t){l(!0);try{let k=de.from("comandas").select("*").eq("codigo_empresa",t).not("fechado_em","is",null).neq("status","cancelled").order("aberto_em",{ascending:!1}).limit(300);const{fromISO:T,toISOExclusive:K}=Tr();T&&(k=k.gte("aberto_em",T)),K&&(k=k.lt("aberto_em",K));const{data:H,error:F}=await k;if(F)throw F;const Le=H||[],it=Le.map(fr=>fr.id);let lt={};if(it.length)try{lt=await NS(it,t)}catch{lt={}}let Vt=[];try{Vt=await rh(t)}catch{Vt=[]}const Ve=new Map((Vt||[]).map(fr=>[fr.id,fr.numero]));let kt={},Sr={};try{kt=await RT(it)}catch{kt={}}try{Sr=await LT(it)}catch{Sr={}}const Or=Le.map(fr=>({...fr,total:Number(lt[fr.id]||0),mesaNumero:Ve.get(fr.mesa_id),clientesStr:Array.isArray(kt[fr.id])?kt[fr.id].join(", "):kt[fr.id]||"",finalizadorasStr:Array.isArray(Sr[fr.id])?Sr[fr.id].join(", "):Sr[fr.id]||""}));o(Or)}catch(k){r({title:"Erro ao carregar",description:k.message,variant:"destructive"})}finally{l(!1)}}};p.useEffect(()=>{Qr()},[t,b,j]),p.useEffect(()=>{let k=!1;async function T(){if(t)try{const{data:K}=await de.from("empresas").select("cnpj, inscricao_estadual, regime_tributario, cidade, uf, codigo_municipio_ibge, nfce_serie, nfce_itoken, ambiente, transmitenota_apikey, transmitenota_base_url, transmitenota_apikey_hml, transmitenota_base_url_hml, transmitenota_apikey_prod, transmitenota_base_url_prod").eq("codigo_empresa",t).single();if(k)return;const H=[],F=Ve=>String(Ve||"").replace(/\D/g,"");(!F(K?.cnpj)||F(K?.cnpj).length!==14)&&H.push("CNPJ"),K?.inscricao_estadual||H.push("Inscrio Estadual"),K?.regime_tributario||H.push("CRT"),(!K?.cidade||!K?.uf)&&H.push("Cidade/UF"),K?.codigo_municipio_ibge||H.push("cMun IBGE"),K?.nfce_serie||H.push("Srie NFC-e");const Le=String(K?.ambiente||"homologacao");Le==="producao"&&!K?.nfce_itoken&&H.push("CSC/IToken");const it=Le==="producao",lt=it?!!K?.transmitenota_apikey_prod||!!K?.transmitenota_apikey:!!K?.transmitenota_apikey_hml||!!K?.transmitenota_apikey,Vt=it?!!K?.transmitenota_base_url_prod||!!K?.transmitenota_base_url:!!K?.transmitenota_base_url_hml||!!K?.transmitenota_base_url;lt||H.push(it?"ApiKey (PROD)":"ApiKey (HML)"),Vt||H.push(it?"Base URL (PROD)":"Base URL (HML)"),pe(H)}catch{}}return T(),()=>{k=!0}},[t]),p.useEffect(()=>{if(!t)return;const k=setInterval(()=>{Qr()},2e4);return()=>clearInterval(k)},[t,b,j]);const tn=p.useMemo(()=>{const k=(c||"").trim().toLowerCase(),T=K=>{const H=K.nf_status||"pendente";return S?H==="pendente"||H==="rejeitada":u==="all"?!0:H===u};return(s||[]).filter(K=>T(K)).filter(K=>k?(K.xml_chave||"").toLowerCase().includes(k)||String(K.nf_numero||"").includes(k):!0)},[s,c,u,S]),Qt=k=>{const T=(k||"pendente").toLowerCase(),K={pendente:"bg-amber-500/15 text-amber-400 border border-amber-400/30",processando:"bg-blue-500/15 text-blue-400 border border-blue-400/30",autorizada:"bg-emerald-500/15 text-emerald-400 border border-emerald-400/30",rejeitada:"bg-red-500/15 text-red-400 border border-red-400/30",cancelada:"bg-gray-500/15 text-gray-400 border border-gray-400/30"};return K[T]||K.pendente},fn=async k=>{try{X(!0);const T=t||ar(),{payload:K,missing:H}=await Iv({comandaId:k,codigoEmpresa:T});Se(K),B(H||[]),W(!0)}catch(T){r({title:"Falha ao gerar prvia",description:T.message,variant:"destructive"})}finally{X(!1)}},nn=async(k,T)=>{await de.from("comandas").update(T).eq("id",k).eq("codigo_empresa",t)},In=async k=>{Re(k);try{const{data:T}=await de.from("empresas").select("nfe_serie, ambiente, uf").eq("codigo_empresa",t).single();ie(K=>({...K,serie:String(T?.nfe_serie||"1")}))}catch{}le(""),Y(!0)},Dn=async()=>{if(ue)try{me(!0);const k=await Lit({comandaId:ue,codigoEmpresa:t,modelo:"55",overrides:ne});le(k),r({title:"XML NF-e gerado"})}catch(k){r({title:"Falha ao gerar XML",description:k.message,variant:"destructive"})}finally{me(!1)}},se=async()=>{if(!(!ae||!ue))try{bt(!0);const k=`nfe/${t}/${ue}-${Date.now()}.xml`,T=new Blob([ae],{type:"text/xml;charset=utf-8"}),{error:K}=await de.storage.from("fiscal").upload(k,T,{contentType:"text/xml"});if(K)throw K;const{data:H}=await de.storage.from("fiscal").getPublicUrl(k),F=H?.publicUrl||null;await de.from("comandas").update({nf_xml_url:F||k,nf_status:"pendente"}).eq("id",ue).eq("codigo_empresa",t);try{const Le=s.find(lt=>lt.id===ue),it=Number(Le?.total||0);await de.from("notas_fiscais").insert({codigo_empresa:t,origem:"comanda",comanda_id:ue,modelo:"55",numero:ne.nNF?Number(ne.nNF):null,serie:ne.serie?Number(ne.serie):null,status:"pendente",xml_url:F||k,pdf_url:null,valor_total:isFinite(it)?it:null,destinatario:null})}catch{}r({title:"XML salvo",description:F?"Link pblico gerado.":"Arquivo salvo no Storage."}),await Qr()}catch(k){r({title:"Falha ao salvar XML",description:k.message,variant:"destructive"})}finally{bt(!1)}},He=async k=>{try{l(!0);const{empresa:T,payload:K,missing:H}=await Iv({comandaId:k,codigoEmpresa:t});if(H&&H.length){r({title:"Pendncias para emisso",description:H.join(", "),variant:"destructive"});return}const F=Lj(T);if(!F.cnpj||F.cnpj.length!==14){r({title:"CNPJ invlido",description:"CNPJ da empresa est ausente ou invlido (14 dgitos).",variant:"destructive"});return}if(!F.apiKey||!F.baseUrl){r({title:"Configurao fiscal incompleta",description:"Preencha Base URL e ApiKey do ambiente atual nas Configuraes.",variant:"destructive"});return}await nn(k,{nf_status:"processando"});let Le;try{Le=await kot({baseUrl:F.baseUrl,apiKey:F.apiKey,cnpj:F.cnpj,dados:K.Dados})}catch(fr){throw await nn(k,{nf_status:"rejeitada"}),fr}const it=Le?.chave||Le?.Chave||Le?.chaveAcesso||null,lt=Le?.numero||Le?.Numero||null,Vt=Le?.serie||Le?.Serie||null,Ve=Le?.pdf_url||Le?.PdfUrl||null,kt=Le?.xml_url||Le?.XmlUrl||null,Sr=Le?.protocolo||Le?.Protocolo||null,Or=!!(Le?.autorizada||Le?.Autorizada||Le?.sucesso||Le?.Sucesso||it);await nn(k,{nf_status:Or?"autorizada":"processando",xml_chave:it,nf_numero:lt,nf_serie:Vt,nf_pdf_url:Ve,nf_xml_url:kt,xml_protocolo:Sr}),r({title:Or?"NFC-e autorizada":"Emisso enviada",description:Or?"Documento autorizado.":"Aguardando autorizao."}),await Qr()}catch(T){r({title:"Falha ao emitir",description:T.message,variant:"destructive"})}finally{l(!1)}},ot=async k=>{try{l(!0);const T=s.find(Or=>Or.id===k);if(!T)return;const{empresa:K}=await Iv({comandaId:k,codigoEmpresa:t}),H=Lj(K),F=T.xml_chave?{chave:T.xml_chave}:{numero:T.nf_numero,serie:T.nf_serie},Le=await rV({baseUrl:H.baseUrl,apiKey:H.apiKey,cnpj:H.cnpj,dados:F}),it=Le?.status||Le?.Status||(Le?.autorizada?"autorizada":T.nf_status),lt=Le?.pdf_url||Le?.PdfUrl||T.nf_pdf_url,Vt=Le?.xml_url||Le?.XmlUrl||T.nf_xml_url,Ve=Le?.chave||Le?.Chave||T.xml_chave,kt=Le?.numero||Le?.Numero||T.nf_numero,Sr=Le?.serie||Le?.Serie||T.nf_serie;await nn(k,{nf_status:it,nf_pdf_url:lt,nf_xml_url:Vt,xml_chave:Ve,nf_numero:kt,nf_serie:Sr}),r({title:"Consulta concluda"}),await Qr()}catch(T){r({title:"Falha ao consultar",description:T.message,variant:"destructive"})}finally{l(!1)}},ee=async k=>{try{const T=window.prompt("Informe o motivo do cancelamento:");if(!T)return;l(!0);const{empresa:K}=await Iv({comandaId:k,codigoEmpresa:t}),H=Lj(K),F=s.find(it=>it.id===k),Le=F.xml_chave?{chave:F.xml_chave,motivo:T}:{numero:F.nf_numero,serie:F.nf_serie,motivo:T};await Iot({baseUrl:H.baseUrl,apiKey:H.apiKey,cnpj:H.cnpj,dados:Le}),await nn(k,{nf_status:"cancelada"}),r({title:"NFC-e cancelada"}),await Qr()}catch(T){r({title:"Falha ao cancelar",description:T.message,variant:"destructive"})}finally{l(!1)}};return a.jsxs("div",{className:"relative p-4",children:[a.jsx(m1,{children:a.jsx("title",{children:"Central Fiscal"})}),a.jsxs("div",{className:"absolute inset-0 z-[10] flex justify-center items-start pt-10 pb-8 pointer-events-auto",children:[a.jsx("div",{className:"absolute inset-0 bg-black/85 backdrop-blur-md"}),a.jsxs("div",{className:"relative max-w-xl w-[min(92vw,640px)] rounded-2xl border border-warning/50 bg-gradient-to-br from-surface via-surface-2 to-surface shadow-2xl px-6 py-7 text-center flex flex-col items-center gap-4",children:[a.jsxs("div",{className:"inline-flex items-center gap-3 px-3 py-1 rounded-full bg-warning/10 border border-warning/40 text-warning text-xs font-semibold uppercase tracking-wide",children:[a.jsx("span",{className:"w-5 h-5 rounded-full bg-warning text-black flex items-center justify-center text-[11px] font-black",children:"NF"}),a.jsx("span",{children:"Central Fiscal em desenvolvimento"})]}),a.jsx("div",{className:"flex items-center justify-center w-14 h-14 rounded-2xl bg-warning/15 border border-warning/50 text-warning shadow-lg",children:a.jsx(Zo,{className:"w-7 h-7"})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h2",{className:"text-2xl font-bold text-text-primary",children:"Em breve: painel fiscal completo diretamente no F7 Arena"}),a.jsx("p",{className:"text-sm text-text-secondary leading-relaxed",children:"Estamos construindo a nova Central Fiscal para acompanhar emisses de NFC-e e NF-e, revisar pendncias e acessar detalhes das notas em um s lugar."})]}),a.jsxs("div",{className:"w-full text-left text-xs md:text-sm text-text-secondary bg-surface/70 border border-white/5 rounded-xl p-4 space-y-2",children:[a.jsx("p",{className:"font-semibold text-text-primary mb-1",children:"Enquanto isso, voc pode:"}),a.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[a.jsxs("li",{children:["Ajustar as configuraes fiscais da empresa na aba ",a.jsx("strong",{children:"Configurao Fiscal"}),";"]}),a.jsx("li",{children:"Validar CNPJ, inscrio estadual e parmetros da NFC-e/NF-e;"}),a.jsx("li",{children:"Integrar ou revisar os dados da API de emisso fiscal."})]})]}),a.jsx("p",{className:"text-[11px] text-text-muted",children:"Esta aba est em modo de desenvolvimento e ainda no deve ser utilizada em produo."})]})]}),a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h1",{className:"text-xl font-semibold",children:"Central Fiscal"}),a.jsx(fe,{type:"button",variant:"outline",size:"sm",className:"rounded-full",onClick:()=>n("/configuracao-fiscal"),title:"Configurao Fiscal",children:a.jsx(Ad,{className:"w-4 h-4"})})]}),Q.length>0&&a.jsx("div",{className:"mb-4 p-3 rounded-md border border-warning/40 bg-warning/10 text-warning",children:a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-sm",children:"Pendncias fiscais da empresa"}),a.jsxs("p",{className:"text-xs",children:["Preencha: ",Q.join(", "),"."]})]}),a.jsx(fe,{size:"sm",className:"bg-warning text-black hover:bg-warning/90",onClick:()=>n("/configuracao-fiscal"),children:"Corrigir agora"})]})}),a.jsxs(Mc,{value:R,onValueChange:O,className:"w-full",children:[a.jsxs(rc,{className:"mb-3",children:[a.jsx(sa,{value:"nfce",children:"NFC-e"}),a.jsx(sa,{value:"nfe",children:"NF-e"})]}),a.jsxs(is,{value:"nfce",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(qe,{className:"text-sm",children:"Buscar"}),a.jsx(rt,{value:c,onChange:k=>d(k.target.value),placeholder:"Chave, nmero...",className:"w-60"})]}),a.jsx(qe,{className:"text-sm ml-1",children:"Status"}),a.jsxs(vn,{value:u,onValueChange:f,children:[a.jsx(hn,{className:"w-[170px] rounded-full",children:a.jsx(wn,{placeholder:"Selecionar status"})}),a.jsxs(pn,{className:"rounded-xl",children:[a.jsx(ct,{value:"all",children:"Todos"}),a.jsx(ct,{value:"pendente",children:"Pendente"}),a.jsx(ct,{value:"processando",children:"Em andamento"}),a.jsx(ct,{value:"autorizada",children:"Autorizada"}),a.jsx(ct,{value:"rejeitada",children:"Rejeitada"}),a.jsx(ct,{value:"cancelada",children:"Cancelada"})]})]}),a.jsx(qe,{className:"text-sm ml-2",children:"Perodo"}),a.jsxs("div",{className:"inline-flex items-center gap-2",children:[a.jsx(Nv,{label:"Perodo inicial",value:b,onChange:w}),a.jsx("span",{className:"text-text-secondary",children:"at"}),a.jsx(Nv,{label:"Perodo final",value:j,onChange:_})]}),a.jsxs("div",{className:"inline-flex items-center gap-2 ml-2 text-sm",children:[a.jsx(za,{checked:S,onCheckedChange:C,className:"rounded-full border-warning data-[state=checked]:bg-warning"}),a.jsx("span",{children:"Somente pendentes/rejeitadas"})]})]}),a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(fe,{size:"sm",variant:"outline",disabled:!P,onClick:()=>(async()=>{const k=s.find(T=>T.id===P);if(k){if(k.nf_pdf_url){window.open(k.nf_pdf_url,"_blank");return}try{l(!0);const{empresa:T}=await Iv({comandaId:k.id,codigoEmpresa:t}),K=Lj(T),H=k.xml_chave?{chave:k.xml_chave}:{numero:k.nf_numero,serie:k.nf_serie},F=await rV({baseUrl:K.baseUrl,apiKey:K.apiKey,cnpj:K.cnpj,dados:H}),Le=F?.pdf_url||F?.PdfUrl;Le?(await de.from("comandas").update({nf_pdf_url:Le}).eq("id",k.id).eq("codigo_empresa",t),window.open(Le,"_blank")):r({title:"Sem PDF disponvel",description:"Documento ainda no possui DANFE.",variant:"destructive"}),await Qr()}catch(T){r({title:"Falha ao visualizar",description:T.message,variant:"destructive"})}finally{l(!1)}}})(),children:"Visualizar"}),a.jsx(fe,{size:"sm",disabled:!P||!["pendente","rejeitada"].includes(s.find(k=>k.id===P)?.nf_status||"pendente"),onClick:()=>He(P),children:"Emitir"}),a.jsx(fe,{size:"sm",variant:"outline",disabled:!P||s.find(k=>k.id===P)?.nf_status!=="processando",onClick:()=>ot(P),children:"Consultar"}),a.jsx(fe,{size:"sm",variant:"destructive",disabled:!P||s.find(k=>k.id===P)?.nf_status!=="autorizada",onClick:()=>ee(P),children:"Cancelar"})]}),a.jsx("div",{className:"bg-surface rounded border border-border overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-surface-2 text-text-secondary",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-3 py-2",children:"Abertura"}),a.jsx("th",{className:"text-left px-3 py-2",children:"Status"}),a.jsx("th",{className:"text-left px-3 py-2",children:"Chave"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Total"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Aes"})]})}),a.jsxs("tbody",{children:[(!tn||tn.length===0)&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-3 py-4 text-center text-text-muted",children:i?"Carregando...":"Nada por aqui"})}),tn.map(k=>{const T=k.nf_status||"pendente";return a.jsxs("tr",{className:`border-t border-border/60 transition-colors ${P===k.id?"bg-surface-2 ring-2 ring-[#FF7A1A]/60 rounded-md":"hover:bg-surface-2/50"}`,onClick:()=>A(k.id),children:[a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:uV(k.aberto_em)}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-[11px] ${Qt(T)}`,children:T})}),a.jsx("td",{className:"px-3 py-2 break-all max-w-[380px]",children:k.xml_chave||""}),a.jsxs("td",{className:"px-3 py-2 text-right whitespace-nowrap",children:["R$ ",ld(k.total||k.total_com_desconto)]}),a.jsxs("td",{className:"px-3 py-2 text-right whitespace-nowrap flex gap-2 justify-end",children:[(T==="pendente"||T==="rejeitada")&&a.jsxs(a.Fragment,{children:[a.jsx(fe,{size:"sm",variant:"outline",onClick:()=>fn(k.id),children:"Pr-Emisso"}),a.jsx(fe,{size:"sm",onClick:()=>He(k.id),children:"Emitir"})]}),T==="processando"&&a.jsx(fe,{size:"sm",variant:"outline",onClick:()=>ot(k.id),children:"Consultar"}),T==="autorizada"&&a.jsx(fe,{size:"sm",variant:"destructive",onClick:()=>ee(k.id),children:"Cancelar"}),k.nf_pdf_url&&a.jsx("a",{className:"inline-flex",href:k.nf_pdf_url,target:"_blank",rel:"noreferrer",children:a.jsx(fe,{size:"sm",variant:"outline",children:"DANFE"})}),k.nf_xml_url&&a.jsx("a",{className:"inline-flex",href:k.nf_xml_url,target:"_blank",rel:"noreferrer",children:a.jsx(fe,{size:"sm",variant:"outline",children:"XML"})})]})]},k.id)})]})]})})]}),a.jsxs(is,{value:"nfe",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(qe,{className:"text-sm",children:"Buscar"}),a.jsx(rt,{value:c,onChange:k=>d(k.target.value),placeholder:"Chave, nmero...",className:"w-60"})]}),a.jsx(qe,{className:"text-sm ml-1",children:"Status"}),a.jsxs(vn,{value:u,onValueChange:f,children:[a.jsx(hn,{className:"w-[170px] rounded-full",children:a.jsx(wn,{placeholder:"Selecionar status"})}),a.jsxs(pn,{className:"rounded-xl",children:[a.jsx(ct,{value:"all",children:"Todos"}),a.jsx(ct,{value:"pendente",children:"Pendente"}),a.jsx(ct,{value:"processando",children:"Em andamento"}),a.jsx(ct,{value:"autorizada",children:"Autorizada"}),a.jsx(ct,{value:"rejeitada",children:"Rejeitada"}),a.jsx(ct,{value:"cancelada",children:"Cancelada"})]})]}),a.jsx(qe,{className:"text-sm ml-2",children:"Perodo"}),a.jsxs("div",{className:"inline-flex items-center gap-2",children:[a.jsx(Nv,{label:"Perodo inicial",value:b,onChange:w}),a.jsx("span",{className:"text-text-secondary",children:"at"}),a.jsx(Nv,{label:"Perodo final",value:j,onChange:_})]}),a.jsxs("div",{className:"inline-flex items-center gap-2 ml-2 text-sm",children:[a.jsx(za,{checked:S,onCheckedChange:C,className:"rounded-full border-warning data-[state=checked]:bg-warning"}),a.jsx("span",{children:"Somente pendentes/rejeitadas"})]}),a.jsx("div",{className:"ml-auto",children:a.jsx(fe,{size:"sm",onClick:()=>{ht(""),xt(!0)},children:"Nova NF-e"})})]}),a.jsx("div",{className:"bg-surface rounded border border-border overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-surface-2 text-text-secondary",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-3 py-2",children:"Abertura"}),a.jsx("th",{className:"text-left px-3 py-2",children:"Status"}),a.jsx("th",{className:"text-left px-3 py-2",children:"Chave"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Total"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Aes"})]})}),a.jsxs("tbody",{children:[(!tn||tn.length===0)&&a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"px-3 py-4 text-center text-text-muted",children:i?"Carregando...":"Nada por aqui"})}),tn.map(k=>{const T=k.nf_status||"pendente";return a.jsxs("tr",{className:`border-t border-border/60 transition-colors ${P===k.id?"bg-surface-2 ring-2 ring-[#FF7A1A]/60 rounded-md":"hover:bg-surface-2/50"}`,onClick:()=>A(k.id),children:[a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:uV(k.aberto_em)}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-[11px] ${Qt(T)}`,children:T})}),a.jsx("td",{className:"px-3 py-2 break-all max-w-[380px]",children:k.xml_chave||""}),a.jsxs("td",{className:"px-3 py-2 text-right whitespace-nowrap",children:["R$ ",ld(k.total||k.total_com_desconto)]}),a.jsxs("td",{className:"px-3 py-2 text-right whitespace-nowrap flex gap-2 justify-end",children:[a.jsx(fe,{size:"sm",onClick:()=>In(k.id),children:"Gerar XML NF-e"}),a.jsx(fe,{size:"sm",variant:"outline",disabled:!0,children:"Emitir via API (em breve)"}),k.nf_xml_url&&a.jsx("a",{className:"inline-flex",href:k.nf_xml_url,target:"_blank",rel:"noreferrer",children:a.jsx(fe,{size:"sm",variant:"outline",children:"XML"})})]})]},k.id)})]})]})})]})]}),a.jsx(mn,{open:z,onOpenChange:W,children:a.jsxs(un,{className:"max-w-[800px]",children:[a.jsxs(on,{children:[a.jsx(an,{children:"Pr-Emisso NFC-e"}),a.jsx(Nn,{children:"Revise os dados e pendncias antes de emitir."})]}),$?a.jsx("div",{className:"p-4 text-center text-text-muted",children:"Gerando prvia"}):a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"border border-border rounded p-2 bg-surface-2",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"JSON (EnviarNfce)"}),a.jsx("pre",{className:"text-[11px] whitespace-pre-wrap break-all max-h-[360px] overflow-auto",children:ye?JSON.stringify(ye,null,2):""})]}),a.jsxs("div",{className:"border border-border rounded p-2 bg-surface-2",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Pendncias"}),!V||V.length===0?a.jsx("div",{className:"text-sm text-emerald-500",children:"Nenhuma pendncia encontrada."}):a.jsx("ul",{className:"list-disc pl-5 text-sm",children:V.map((k,T)=>a.jsx("li",{children:k},T))})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[a.jsx(fe,{variant:"outline",onClick:()=>W(!1),children:"Fechar"}),a.jsx(fe,{disabled:!0,children:"Emitir (desabilitado)"})]})]})}),a.jsx(mn,{open:er,onOpenChange:ln,children:a.jsxs(un,{className:"w-[95vw] sm:max-w-[700px] max-h-[80vh] overflow-y-auto",children:[a.jsxs(on,{children:[a.jsxs(an,{children:["Selecionar ",et==="fornecedor"?"fornecedor":"cliente"]}),a.jsx(Nn,{children:"Busque pelo cdigo, nome ou documento e escolha a parte."})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(fe,{size:"sm",variant:et==="cliente"?"default":"outline",onClick:()=>jt("cliente"),children:"Clientes"}),a.jsx(fe,{size:"sm",variant:et==="fornecedor"?"default":"outline",onClick:()=>jt("fornecedor"),children:"Fornecedores"})]}),a.jsx("div",{className:"flex-1 min-w-[200px]",children:a.jsx(rt,{placeholder:"Buscar por cdigo, nome ou documento",value:Mr,onChange:k=>Ye(k.target.value)})}),a.jsxs("span",{className:"text-xs text-text-secondary",children:[Jr.length," itens"]})]}),a.jsxs("div",{className:"border border-border rounded-md divide-y divide-border",children:[Jr.map(k=>a.jsxs("div",{className:"grid grid-cols-12 items-center px-3 py-2 hover:bg-surface-2 cursor-pointer",onClick:()=>lr(k),children:[a.jsx("div",{className:"col-span-2 text-xs font-medium",children:String(k.codigo||k.codigo_cliente||k.codigo_fornecedor||k.code||"")}),a.jsx("div",{className:"col-span-6 text-sm truncate",title:k.nome||k.razao_social||"",children:k.nome||k.razao_social||"Sem nome"}),a.jsxs("div",{className:"col-span-4 text-xs text-text-secondary text-right",children:[(k.cnpj||k.cpf||"").toString()," ",k.cidade?` ${k.cidade}/${k.uf||""}`:""]})]},k.id)),Jr.length===0&&a.jsx("div",{className:"text-xs text-text-secondary px-3 py-2",children:"Nenhum registro encontrado"})]}),a.jsx("div",{className:"flex justify-end mt-3",children:a.jsx(fe,{variant:"outline",onClick:()=>ln(!1),children:"Fechar"})})]})}),a.jsx(mn,{open:hr,onOpenChange:It,children:a.jsxs(un,{className:"w-[95vw] sm:max-w-[700px] max-h-[80vh] overflow-y-auto",children:[a.jsxs(on,{children:[a.jsx(an,{children:"Selecionar produto"}),a.jsx(Nn,{children:"Busque pelo nome ou cdigo para preencher o item."})]}),a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(rt,{placeholder:"Buscar produto por nome ou cdigo",value:Me,onChange:k=>dt(k.target.value)}),a.jsxs("span",{className:"text-xs text-text-secondary",children:[$t.length," itens"]})]}),a.jsxs("div",{className:"border border-border rounded-md divide-y divide-border",children:[$t.map(k=>a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 hover:bg-surface-2 cursor-pointer",onClick:()=>{dr!=null&&St(dr,k),It(!1)},children:[a.jsxs("div",{className:"text-sm",children:[k.name," ",a.jsx("span",{className:"text-text-secondary",children:k.code?`(${k.code})`:""})]}),a.jsxs("div",{className:"text-xs text-text-secondary",children:["NCM ",k.ncm||"","  UN ",String(k.unit||"UN").toUpperCase(),"  R$ ",ld(k.price??k.salePrice??0)]})]},k.id)),$t.length===0&&a.jsx("div",{className:"text-xs text-text-secondary px-3 py-2",children:"Nenhum produto encontrado"})]}),a.jsx("div",{className:"flex justify-end mt-3",children:a.jsx(fe,{variant:"outline",onClick:()=>It(!1),children:"Fechar"})})]})}),a.jsx(mn,{open:at,onOpenChange:xt,children:a.jsxs(un,{className:"w-[960px] max-w-[96vw] h-[85vh] overflow-hidden flex flex-col",children:[a.jsxs(on,{children:[a.jsx(an,{children:"Criar NF-e (manual)"}),a.jsx(Nn,{children:"Preencha os dados nas abas para gerar o XML."})]}),a.jsxs(Mc,{value:_e,onValueChange:je,className:"w-full flex-1 overflow-hidden flex flex-col",children:[a.jsxs(rc,{className:"mb-3 w-full flex flex-wrap justify-start gap-1",children:[a.jsx(sa,{value:"cliente",children:"Cabealho"}),a.jsx(sa,{value:"itens",children:"Produtos"}),a.jsx(sa,{value:"impostos",children:"Impostos"}),a.jsx(sa,{value:"totais",children:"Totais"}),a.jsx(sa,{value:"pagamento",children:"Pagamento"}),a.jsx(sa,{value:"transporte",children:"Transporte"}),a.jsx(sa,{value:"adicionais",children:"Informaes"}),a.jsx(sa,{value:"rastreabilidade",children:"Rastreabilidade"})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto pr-1",children:[_e==="cliente"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 mb-2",children:[a.jsxs("div",{children:[a.jsx(qe,{children:"Tipo da Nota"}),a.jsxs(vn,{value:Ge.tipo_nota,onValueChange:k=>Je(T=>({...T,tipo_nota:k,natOp:k==="entrada"?"COMPRA":T.natOp||"VENDA"})),children:[a.jsx(hn,{className:"h-9",children:a.jsx(wn,{})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"saida",children:"Sada"}),a.jsx(ct,{value:"entrada",children:"Entrada"})]})]})]}),a.jsxs("div",{children:[a.jsxs(qe,{children:[Ge.tipo_nota==="entrada"?"Fornecedor":"Cliente"," (cdigo)"]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(rt,{className:"h-9 w-[110px]",inputMode:"numeric",value:Ge.party_codigo,onChange:k=>Je(T=>({...T,party_codigo:k.target.value.replace(/\D/g,"")})),onKeyDown:k=>{k.key==="Enter"&&(k.preventDefault(),Pt(Ge.party_codigo))},onBlur:()=>Pt(Ge.party_codigo),placeholder:""}),a.jsx(fe,{type:"button",size:"icon",variant:"ghost",title:"Selecionar",onClick:()=>{Ye(""),jt(Ge.tipo_nota==="entrada"?"fornecedor":"cliente"),ln(!0)},children:a.jsx(Zs,{className:"h-4 w-4"})}),(Ge.party_codigo||Ge.nome||Ge.cpf_cnpj)&&a.jsx(fe,{type:"button",size:"icon",variant:"ghost",title:"Limpar",onClick:()=>Je(k=>({...k,party_id:"",party_codigo:"",tipo_pessoa:"PJ",cpf_cnpj:"",nome:"",email:"",telefone:"",inscricao_estadual:"",ie_isento:!1,logradouro:"",numero:"",bairro:"",cidade:"",uf:"",cep:"",codigo_municipio_ibge:""})),children:a.jsx(al,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Data Emisso"}),a.jsx(Nv,{label:"Data Emisso",value:Ge.data_emissao,onChange:k=>Je(T=>({...T,data_emissao:k}))})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Data Sada"}),a.jsx(Nv,{label:"Data Sada",value:Ge.data_saida,onChange:k=>Je(T=>({...T,data_saida:k}))})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 mb-2",children:[a.jsxs("div",{children:[a.jsx(qe,{children:"Natureza (natOp)"}),a.jsx(rt,{className:"h-8",list:"natop-list",value:Ge.natOp,onChange:k=>Je(T=>({...T,natOp:k.target.value}))})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Srie"}),a.jsx(rt,{className:"h-8",value:Ge.serie,onChange:k=>Je(T=>({...T,serie:k.target.value}))})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Nmero (nNF)"}),a.jsx(rt,{className:"h-8",value:Ge.nNF,onChange:k=>Je(T=>({...T,nNF:k.target.value}))})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 mb-2",children:[a.jsxs("div",{children:[a.jsx(qe,{children:"Finalidade da NF"}),a.jsxs(vn,{value:Ge.finNFe,onValueChange:k=>Je(T=>({...T,finNFe:k})),children:[a.jsx(hn,{className:"h-9",children:a.jsx(wn,{})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"1",children:"Normal"}),a.jsx(ct,{value:"2",children:"Complementar"}),a.jsx(ct,{value:"3",children:"Ajuste"}),a.jsx(ct,{value:"4",children:"Devoluo"})]})]})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Local de Destino"}),a.jsxs(vn,{value:Ge.idDest,onValueChange:k=>Je(T=>({...T,idDest:k})),children:[a.jsx(hn,{className:"h-9",children:a.jsx(wn,{})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"1",children:"Operao Interna"}),a.jsx(ct,{value:"2",children:"Interestadual"}),a.jsx(ct,{value:"3",children:"Exterior"})]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 mb-2",children:[a.jsxs("div",{children:[a.jsx(qe,{children:"Indicador de presena"}),a.jsxs(vn,{value:Ge.indPres,onValueChange:k=>Je(T=>({...T,indPres:k})),children:[a.jsx(hn,{className:"h-9",children:a.jsx(wn,{})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"0",children:"No se aplica"}),a.jsx(ct,{value:"1",children:"Operao presencial"}),a.jsx(ct,{value:"2",children:"No presencial (internet)"}),a.jsx(ct,{value:"3",children:"No presencial (teleatendimento)"}),a.jsx(ct,{value:"4",children:"Entrega a domiclio"}),a.jsx(ct,{value:"9",children:"Outros"})]})]})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Intermediador/Marketplace"}),a.jsxs(vn,{value:Ge.indIntermed,onValueChange:k=>Je(T=>({...T,indIntermed:k})),children:[a.jsx(hn,{className:"h-9",children:a.jsx(wn,{})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"0",children:"Sem intermediador"}),a.jsx(ct,{value:"1",children:"Com intermediador"})]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(za,{checked:Ge.indFinal==="1",onCheckedChange:k=>Je(T=>({...T,indFinal:k?"1":"0"}))}),a.jsx("span",{className:"text-sm",children:"Consumidor Final"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(za,{checked:!!Ge.baixar_estoque,onCheckedChange:k=>Je(T=>({...T,baixar_estoque:!!k}))}),a.jsx("span",{className:"text-sm",children:"Baixar Estoque"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(za,{checked:!!Ge.destacar_st,onCheckedChange:k=>Je(T=>({...T,destacar_st:!!k}))}),a.jsx("span",{className:"text-sm",children:"Destacar Substituio Trib."})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(za,{id:"autoApplyCfop",checked:!!ir,onCheckedChange:k=>nr(!!k)}),a.jsx(qe,{htmlFor:"autoApplyCfop",className:"text-xs",children:"Aplicar CFOP padro automaticamente aos itens"})]})]}),Ge.indIntermed==="1"&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 mb-2",children:[a.jsxs("div",{children:[a.jsx(qe,{children:"CNPJ Intermediador"}),a.jsx(rt,{inputMode:"numeric",placeholder:"Somente nmeros",value:Ge.intermediador_cnpj,onChange:k=>Je(T=>({...T,intermediador_cnpj:kr(k.target.value)}))})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(qe,{children:"Identificador no Intermediador"}),a.jsx(rt,{value:Ge.intermediador_id,onChange:k=>Je(T=>({...T,intermediador_id:k.target.value}))})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 mb-2",children:a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(qe,{children:"CFOP padro"}),a.jsxs(vn,{value:Ge.cfop_padrao||"",onValueChange:k=>{Qe(""),Je(T=>({...T,cfop_padrao:k,natOp:sr(k)}))},children:[a.jsx(hn,{className:"mt-1 w-full truncate h-8 text-xs",children:a.jsx(wn,{placeholder:"Selecionar CFOP"})}),a.jsxs(pn,{className:"max-h-[300px] overflow-auto w-[360px] sm:w-[420px]",children:[a.jsx("div",{className:"sticky top-0 z-10 p-2 bg-background",children:a.jsx(rt,{className:"h-8 text-xs",placeholder:"Filtrar CFOP ou descrio",value:he,onChange:k=>Qe(k.target.value)})}),nt.filter(k=>{const T=he.trim().toLowerCase();return T?k.code.toLowerCase().includes(T)||(k.desc||"").toLowerCase().includes(T):!0}).map(k=>a.jsx(ct,{value:k.code,title:`${k.code}  ${k.desc}`,children:`${k.code} - ${(k.desc||"").slice(0,60)}`},k.code))]})]})]})})]}),a.jsx(is,{value:"cliente",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx(qe,{children:"Tipo pessoa"}),a.jsxs(vn,{value:Ge.tipo_pessoa,onValueChange:k=>Je(T=>({...T,tipo_pessoa:k})),children:[a.jsx(hn,{children:a.jsx(wn,{})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"PJ",children:"PJ"}),a.jsx(ct,{value:"PF",children:"PF"})]})]})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"CPF/CNPJ"}),a.jsx(rt,{inputMode:"numeric",placeholder:"Somente nmeros",value:Ge.cpf_cnpj,onChange:k=>Je(T=>({...T,cpf_cnpj:kr(k.target.value)}))})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Nome/Razo"}),a.jsx(rt,{value:Ge.nome,onChange:k=>Je(T=>({...T,nome:k.target.value}))})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Inscrio Estadual"}),a.jsx(rt,{value:Ge.inscricao_estadual,onChange:k=>Je(T=>({...T,inscricao_estadual:k.target.value})),disabled:Ge.ie_isento})]}),a.jsxs("div",{className:"flex items-center gap-2 mt-6",children:[a.jsx(za,{checked:Ge.ie_isento,onCheckedChange:k=>Je(T=>({...T,ie_isento:!!k,inscricao_estadual:k?"ISENTO":T.inscricao_estadual}))}),a.jsx("span",{className:"text-sm",children:"IE Isento"})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Telefone"}),a.jsx(rt,{inputMode:"numeric",placeholder:"(DD) 9XXXX-XXXX",value:Ge.telefone,onChange:k=>Je(T=>({...T,telefone:kr(k.target.value)}))})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Email"}),a.jsx(rt,{value:Ge.email,onChange:k=>Je(T=>({...T,email:k.target.value}))})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Logradouro"}),a.jsx(rt,{value:Ge.logradouro,onChange:k=>Je(T=>({...T,logradouro:k.target.value}))})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Nmero"}),a.jsx(rt,{value:Ge.numero,onChange:k=>Je(T=>({...T,numero:k.target.value}))})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Bairro"}),a.jsx(rt,{value:Ge.bairro,onChange:k=>Je(T=>({...T,bairro:k.target.value}))})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Cidade"}),a.jsx(rt,{value:Ge.cidade,onChange:k=>Je(T=>({...T,cidade:k.target.value}))})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"UF"}),a.jsx(rt,{value:Ge.uf,onChange:k=>Je(T=>({...T,uf:k.target.value.toUpperCase().slice(0,2)}))})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"CEP"}),a.jsx(rt,{inputMode:"numeric",placeholder:"00000000",value:Ge.cep,onChange:k=>Je(T=>({...T,cep:kr(k.target.value).slice(0,8)})),onBlur:()=>Et(Ge.cep)}),Ue&&a.jsx("div",{className:"text-xs text-text-secondary mt-1",children:"Buscando endereo"})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"cMun IBGE"}),a.jsx(rt,{inputMode:"numeric",placeholder:"Cdigo do municpio (IBGE)",value:Ge.codigo_municipio_ibge,onChange:k=>Je(T=>({...T,codigo_municipio_ibge:kr(k.target.value)}))})]})]})}),a.jsx(is,{value:"itens",children:a.jsxs("div",{className:"space-y-2",children:[Ge.itens.map((k,T)=>a.jsxs("div",{className:"space-y-1 border border-border rounded-md p-2",onClick:Fr(T),children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-1 items-start",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(qe,{children:"Cdigo"}),a.jsx(rt,{className:"h-8 text-xs",value:k.codigo,onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],codigo:K.target.value},{...H,itens:F}}),onKeyDown:K=>{if(K.key==="Enter"){const H=(Nt||[]).find(F=>String(F.code||"")===String((k.codigo||"").trim()));H&&St(T,H)}},onBlur:()=>{const K=(Nt||[]).find(H=>String(H.code||"")===String((k.codigo||"").trim()));K&&St(T,K)}})]}),a.jsxs("div",{className:"md:col-span-3 min-w-0",children:[a.jsx(qe,{children:"Descrio"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(rt,{className:"h-8 text-xs flex-1",value:k.descricao,onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],descricao:K.target.value},{...H,itens:F}})}),a.jsx(fe,{type:"button",size:"icon",variant:"ghost",title:"Buscar produto",onClick:()=>{ur(T),dt(""),It(!0)},children:a.jsx(Zs,{className:"h-4 w-4"})}),a.jsx(fe,{type:"button",size:"icon",variant:"ghost",className:"text-text-secondary hover:text-red-500",title:"Remover item",onClick:()=>Je(K=>({...K,itens:K.itens.filter((H,F)=>F!==T)})),children:a.jsx(Ju,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{className:"md:col-span-2 min-w-0",children:[a.jsx(qe,{children:"CFOP"}),a.jsxs(vn,{value:k.cfop||"",onValueChange:K=>{Qe(""),Je(H=>{const F=[...H.itens];return F[T]={...F[T],cfop:K},{...H,itens:F,natOp:sr(K)}})},children:[a.jsx(hn,{className:"mt-1 w-full truncate h-8 text-xs",children:a.jsx(wn,{placeholder:"Selecionar CFOP"})}),a.jsxs(pn,{className:"max-h-[300px] overflow-auto w-[360px] sm:w-[420px]",children:[a.jsx("div",{className:"sticky top-0 z-10 p-2 bg-background",children:a.jsx(rt,{className:"h-8 text-xs",placeholder:"Filtrar CFOP ou descrio",value:he,onChange:K=>Qe(K.target.value)})}),nt.filter(K=>{const H=he.trim().toLowerCase();return H?K.code.toLowerCase().includes(H)||(K.desc||"").toLowerCase().includes(H):!0}).map(K=>a.jsx(ct,{value:K.code,title:`${K.code}  ${K.desc}`,children:`${K.code} - ${(K.desc||"").slice(0,60)}`},K.code))]})]})]}),a.jsxs("div",{className:"md:col-span-1",children:[a.jsx(qe,{children:"Unid."}),a.jsx(rt,{className:"h-8 text-xs",list:"unid-list",placeholder:"UN, KG, LT",value:k.unidade,onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],unidade:K.target.value.toUpperCase().slice(0,5)},{...H,itens:F}})})]}),a.jsxs("div",{className:"md:col-span-1",children:[a.jsx(qe,{children:"Cd. Barras"}),a.jsx(rt,{className:"h-8 text-xs",value:k.cod_barras||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],cod_barras:K.target.value},{...H,itens:F}}),onKeyDown:K=>{if(K.key==="Enter"){const H=String((k.cod_barras||"").trim()),F=(Nt||[]).find(Le=>[Le.barcode,Le.ean,Le.gtin,Le.bar_code].some(it=>String(it||"")===H));F&&St(T,F)}},onBlur:()=>{const K=String((k.cod_barras||"").trim()),H=(Nt||[]).find(F=>[F.barcode,F.ean,F.gtin,F.bar_code].some(Le=>String(Le||"")===K));H&&St(T,H)}})]}),a.jsxs("div",{className:"md:col-span-1",children:[a.jsx(qe,{children:"Qtd"}),a.jsx(rt,{className:"h-8 text-xs",inputMode:"decimal",value:k.quantidade,onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],quantidade:K.target.value.replace(/[^0-9.,]/g,"")},{...H,itens:F}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(qe,{children:"Preo"}),a.jsx(rt,{className:"h-8 text-xs",inputMode:"decimal",value:k.preco_unitario,onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],preco_unitario:Tn(K.target.value)},{...H,itens:F}})})]})]}),a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-text-secondary mt-1",children:[a.jsx("div",{className:"truncate",children:`Item ${T+1}: ${k.codigo?k.codigo+" - ":""}${k.descricao||""}`}),a.jsx("div",{children:`Total item: R$ ${ld((Ft(k.preco_unitario)||0)*(Ft(k.quantidade)||1)-(Ft(k.desconto_percent)?(Ft(k.preco_unitario)||0)*(Ft(k.quantidade)||1)*(Ft(k.desconto_percent)||0)/100:Ft(k.desconto_valor)||0)+(Ft(k.acrescimos_valor)||0)+(Ft(k.frete_valor)||0)+(Ft(k.seguro_valor)||0))}`})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(za,{checked:!!k.dest_icms,onCheckedChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],dest_icms:!!K},{...H,itens:F}})}),a.jsx("span",{className:"text-xs",children:"Destacar ICMS"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(za,{checked:!!k.dest_icms_info,onCheckedChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],dest_icms_info:!!K},{...H,itens:F}})}),a.jsx("span",{className:"text-xs",children:"ICMS na Info. Adicional"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(za,{checked:!!k.benef_fiscal,onCheckedChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],benef_fiscal:!!K},{...H,itens:F}})}),a.jsx("span",{className:"text-xs",children:"Benefcio Fiscal"})]})]}),pt===T&&a.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-12 gap-1",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(qe,{children:"NCM"}),a.jsx(rt,{className:"h-8 text-xs",inputMode:"numeric",placeholder:"8 dgitos",value:k.ncm,onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],ncm:kr(K.target.value).slice(0,8)},{...H,itens:F}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(qe,{children:"CEST"}),a.jsx(rt,{className:"h-8 text-xs",value:k.cest||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],cest:K.target.value},{...H,itens:F}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(qe,{children:"Desc. (R$)"}),a.jsx(rt,{className:"h-8 text-xs",inputMode:"decimal",value:k.desconto_valor||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],desconto_valor:Tn(K.target.value)},{...H,itens:F}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(qe,{children:"Desc. (%)"}),a.jsx(rt,{className:"h-8 text-xs",inputMode:"decimal",value:k.desconto_percent||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],desconto_percent:K.target.value.replace(/[^0-9.,]/g,"")},{...H,itens:F}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(qe,{children:"Acrscimos"}),a.jsx(rt,{className:"h-8 text-xs",inputMode:"decimal",value:k.acrescimos_valor||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],acrescimos_valor:Tn(K.target.value)},{...H,itens:F}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(qe,{children:"Frete (R$)"}),a.jsx(rt,{className:"h-8 text-xs",inputMode:"decimal",value:k.frete_valor||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],frete_valor:Tn(K.target.value)},{...H,itens:F}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(qe,{children:"Seguro (R$)"}),a.jsx(rt,{className:"h-8 text-xs",inputMode:"decimal",value:k.seguro_valor||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],seguro_valor:Tn(K.target.value)},{...H,itens:F}})})]}),a.jsxs("div",{className:"md:col-span-12",children:[a.jsx(qe,{children:"Observaes"}),a.jsx(rt,{className:"h-8 text-xs",value:k.obs||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],obs:K.target.value},{...H,itens:F}})})]})]})]},T)),a.jsx("div",{className:"flex justify-start",children:a.jsx(fe,{size:"sm",variant:"outline",onClick:()=>{Je(k=>{const T={descricao:"",codigo:"",cod_barras:"",ncm:"",cest:"",cfop:k.cfop_padrao||"5102",unidade:"UN",quantidade:"1",preco_unitario:"0.00",desconto_valor:"0.00",desconto_percent:"",acrescimos_valor:"0.00",frete_valor:"0.00",seguro_valor:"0.00",obs:"",dest_icms:!1,dest_icms_info:!1,benef_fiscal:!1,impostos:{origem:"",icms:{cst:"",csosn:"",base:"",aliquota:"",valor:"",desonerado_valor:"",desoneracao_motivo:"",operacao_valor:"",aliq_diferimento:"",valor_diferido:""},icmsst:{base:"",aliquota:"",valor:""},fcp:{base:"",aliquota:"",valor:""},fcpst:{base:"",aliquota:"",valor:""},pis:{cst:"",aliquota:"",valor:""},cofins:{cst:"",aliquota:"",valor:""},ipi:{cst:"",aliquota:"",valor:"",tipo_calculo:"nenhum",valor_unit:""},iss:{aliquota:"",valor:""}}};return{...k,itens:[...k.itens,T]}})},children:"Adicionar item"})}),a.jsx("div",{className:"mt-2 overflow-x-auto border border-border rounded",children:a.jsxs("table",{className:"min-w-full text-[11px]",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-text-secondary",children:[a.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Item"}),a.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Produto"}),a.jsx("th",{className:"text-left font-medium px-2 py-1",children:"Descrio"}),a.jsx("th",{className:"text-left font-medium px-2 py-1",children:"UN"}),a.jsx("th",{className:"text-left font-medium px-2 py-1",children:"CST"}),a.jsx("th",{className:"text-right font-medium px-2 py-1",children:"Qtde"}),a.jsx("th",{className:"text-right font-medium px-2 py-1",children:"Vr. Unit"}),a.jsx("th",{className:"text-right font-medium px-2 py-1",children:"Vr. ICMS"}),a.jsx("th",{className:"text-right font-medium px-2 py-1",children:"Vr. ICMS-ST"}),a.jsx("th",{className:"text-right font-medium px-2 py-1",children:"Vr. FCP"}),a.jsx("th",{className:"text-right font-medium px-2 py-1",children:"Total Item"})]})}),a.jsx("tbody",{children:Ge.itens.map((k,T)=>{const K=Ft(k.preco_unitario)||0,H=Ft(k.quantidade)||1,F=K*H,Le=Ft(k.desconto_percent)||0,it=Ft(k.desconto_valor)||0,lt=Ft(k.acrescimos_valor)||0,Vt=Le?F*Le/100:it,Ve=F-Vt+lt+(Ft(k.frete_valor)||0)+(Ft(k.seguro_valor)||0),kt=k.impostos?.icms?.cst||k.impostos?.icms?.csosn||"",Sr=Ft(k.impostos?.icms?.valor)||0,Or=Ft(k.impostos?.icmsst?.valor)||0,fr=Ft(k.impostos?.fcp?.valor)||0;return a.jsxs("tr",{className:"border-t border-border/60",children:[a.jsx("td",{className:"px-2 py-1",children:T+1}),a.jsx("td",{className:"px-2 py-1 whitespace-nowrap",children:k.codigo||""}),a.jsx("td",{className:"px-2 py-1 truncate max-w-[320px]",children:k.descricao||""}),a.jsx("td",{className:"px-2 py-1",children:k.unidade||"UN"}),a.jsx("td",{className:"px-2 py-1",children:kt||""}),a.jsx("td",{className:"px-2 py-1 text-right",children:ld(H)}),a.jsx("td",{className:"px-2 py-1 text-right",children:ld(K)}),a.jsx("td",{className:"px-2 py-1 text-right",children:ld(Sr)}),a.jsx("td",{className:"px-2 py-1 text-right",children:ld(Or)}),a.jsx("td",{className:"px-2 py-1 text-right",children:ld(fr)}),a.jsx("td",{className:"px-2 py-1 text-right",children:ld(Ve)})]},T)})})]})})]})}),a.jsx(is,{value:"impostos",children:a.jsx("div",{className:"space-y-3",children:Ge.itens.map((k,T)=>a.jsxs("div",{className:"border border-border rounded-md p-2 cursor-pointer",onClick:Fr(T),children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[a.jsxs("div",{className:"text-sm font-medium truncate",children:["Item ",T+1,": ",k.codigo?`${k.codigo} - `:"",k.descricao||""]}),a.jsxs("div",{className:"text-xs text-text-secondary flex gap-3",children:[a.jsxs("span",{children:["ICMS ",k.impostos?.icms?.cst||k.impostos?.icms?.csosn||"","/",k.impostos?.icms?.aliquota||"","%"]}),a.jsxs("span",{children:["PIS ",k.impostos?.pis?.cst||"","/",k.impostos?.pis?.aliquota||"","%"]}),a.jsxs("span",{children:["COFINS ",k.impostos?.cofins?.cst||"","/",k.impostos?.cofins?.aliquota||"","%"]}),a.jsxs("span",{children:["FCP ",k.impostos?.fcp?.aliquota||"","%"]}),a.jsxs("span",{children:["IPI ",k.impostos?.ipi?.cst||"","/",k.impostos?.ipi?.aliquota||"","%"]}),a.jsx("span",{children:`Total R$ ${ld((Ft(k.preco_unitario)||0)*(Ft(k.quantidade)||1)-(Ft(k.desconto_percent)?(Ft(k.preco_unitario)||0)*(Ft(k.quantidade)||1)*(Ft(k.desconto_percent)||0)/100:Ft(k.desconto_valor)||0)+(Ft(k.acrescimos_valor)||0)+(Ft(k.frete_valor)||0)+(Ft(k.seguro_valor)||0))}`})]})]}),pt===T&&a.jsxs("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-6 gap-2",children:[a.jsxs("div",{children:[a.jsx(qe,{children:"Origem"}),a.jsx(rt,{value:k.impostos?.origem||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,origem:K.target.value}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"ICMS CST"}),a.jsx(rt,{value:k.impostos?.icms?.cst||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,icms:{...F[T].impostos.icms,cst:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"CSOSN"}),a.jsx(rt,{value:k.impostos?.icms?.csosn||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,icms:{...F[T].impostos.icms,csosn:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Base ICMS"}),a.jsx(rt,{value:k.impostos?.icms?.base||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,icms:{...F[T].impostos.icms,base:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Alquota ICMS (%)"}),a.jsx(rt,{value:k.impostos?.icms?.aliquota||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,icms:{...F[T].impostos.icms,aliquota:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Valor ICMS"}),a.jsx(rt,{value:k.impostos?.icms?.valor||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,icms:{...F[T].impostos.icms,valor:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Base ICMS-ST"}),a.jsx(rt,{value:k.impostos?.icmsst?.base||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,icmsst:{...F[T].impostos.icmsst,base:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Alquota ICMS-ST (%)"}),a.jsx(rt,{value:k.impostos?.icmsst?.aliquota||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,icmsst:{...F[T].impostos.icmsst,aliquota:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Valor ICMS-ST"}),a.jsx(rt,{value:k.impostos?.icmsst?.valor||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,icmsst:{...F[T].impostos.icmsst,valor:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"FCP Base"}),a.jsx(rt,{value:k.impostos?.fcp?.base||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,fcp:{...F[T].impostos.fcp,base:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"FCP Alquota (%)"}),a.jsx(rt,{value:k.impostos?.fcp?.aliquota||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,fcp:{...F[T].impostos.fcp,aliquota:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"FCP Valor"}),a.jsx(rt,{value:k.impostos?.fcp?.valor||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,fcp:{...F[T].impostos.fcp,valor:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"FCP-ST Base"}),a.jsx(rt,{value:k.impostos?.fcpst?.base||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,fcpst:{...F[T].impostos.fcpst,base:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"FCP-ST Alquota (%)"}),a.jsx(rt,{value:k.impostos?.fcpst?.aliquota||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,fcpst:{...F[T].impostos.fcpst,aliquota:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"FCP-ST Valor"}),a.jsx(rt,{value:k.impostos?.fcpst?.valor||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,fcpst:{...F[T].impostos.fcpst,valor:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"ICMS Desonerado (R$)"}),a.jsx(rt,{value:k.impostos?.icms?.desonerado_valor||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,icms:{...F[T].impostos.icms,desonerado_valor:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(qe,{children:"Motivo da Desonerao"}),a.jsx(rt,{value:k.impostos?.icms?.desoneracao_motivo||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,icms:{...F[T].impostos.icms,desoneracao_motivo:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"ICMS Operao (R$)"}),a.jsx(rt,{value:k.impostos?.icms?.operacao_valor||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,icms:{...F[T].impostos.icms,operacao_valor:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Alquota Diferimento (%)"}),a.jsx(rt,{value:k.impostos?.icms?.aliq_diferimento||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,icms:{...F[T].impostos.icms,aliq_diferimento:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Valor ICMS Diferido"}),a.jsx(rt,{value:k.impostos?.icms?.valor_diferido||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,icms:{...F[T].impostos.icms,valor_diferido:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"PIS CST"}),a.jsx(rt,{value:k.impostos?.pis?.cst||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,pis:{...F[T].impostos.pis,cst:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"PIS Alquota (%)"}),a.jsx(rt,{value:k.impostos?.pis?.aliquota||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,pis:{...F[T].impostos.pis,aliquota:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"PIS Valor"}),a.jsx(rt,{value:k.impostos?.pis?.valor||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,pis:{...F[T].impostos.pis,valor:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"COFINS CST"}),a.jsx(rt,{value:k.impostos?.cofins?.cst||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,cofins:{...F[T].impostos.cofins,cst:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"COFINS Alquota (%)"}),a.jsx(rt,{value:k.impostos?.cofins?.aliquota||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,cofins:{...F[T].impostos.cofins,aliquota:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"COFINS Valor"}),a.jsx(rt,{value:k.impostos?.cofins?.valor||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,cofins:{...F[T].impostos.cofins,valor:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"IPI CST"}),a.jsx(rt,{value:k.impostos?.ipi?.cst||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,ipi:{...F[T].impostos.ipi,cst:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"IPI - Tipo de Clculo"}),a.jsxs(vn,{value:k.impostos?.ipi?.tipo_calculo||"nenhum",onValueChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,ipi:{...F[T].impostos.ipi,tipo_calculo:K}}},{...H,itens:F}}),children:[a.jsx(hn,{className:"h-8 text-xs"}),a.jsxs(pn,{children:[a.jsx(ct,{value:"aliquota",children:"Alquota"}),a.jsx(ct,{value:"valor_unit",children:"Vl Unit."}),a.jsx(ct,{value:"nenhum",children:"Nenhum"})]})]})]}),(k.impostos?.ipi?.tipo_calculo||"nenhum")==="aliquota"&&a.jsxs("div",{children:[a.jsx(qe,{children:"IPI Alquota (%)"}),a.jsx(rt,{value:k.impostos?.ipi?.aliquota||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,ipi:{...F[T].impostos.ipi,aliquota:K.target.value}}},{...H,itens:F}})})]}),(k.impostos?.ipi?.tipo_calculo||"nenhum")==="valor_unit"&&a.jsxs("div",{children:[a.jsx(qe,{children:"IPI Valor Unitrio"}),a.jsx(rt,{value:k.impostos?.ipi?.valor_unit||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,ipi:{...F[T].impostos.ipi,valor_unit:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"IPI Valor"}),a.jsx(rt,{value:k.impostos?.ipi?.valor||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,ipi:{...F[T].impostos.ipi,valor:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"ISS Alquota (%)"}),a.jsx(rt,{value:k.impostos?.iss?.aliquota||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,iss:{...F[T].impostos.iss,aliquota:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"ISS Valor"}),a.jsx(rt,{value:k.impostos?.iss?.valor||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,iss:{...F[T].impostos.iss,valor:K.target.value}}},{...H,itens:F}})})]}),a.jsx("div",{className:"md:col-span-6",children:a.jsxs("details",{children:[a.jsx("summary",{className:"text-xs text-text-secondary cursor-pointer select-none",children:"Impostos 2 (Avanado)"}),a.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-6 gap-2",children:[a.jsxs("div",{children:[a.jsx(qe,{children:"AD Rem"}),a.jsx(rt,{value:k.impostos?.icms?.ad_rem||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,icms:{...F[T].impostos.icms,ad_rem:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"AD Rem Reteno"}),a.jsx(rt,{value:k.impostos?.icms?.ad_rem_retencao||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,icms:{...F[T].impostos.icms,ad_rem_retencao:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"BC Monofsico"}),a.jsx(rt,{value:k.impostos?.icms?.monofasico_bc||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,icms:{...F[T].impostos.icms,monofasico_bc:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"ICMS Monofsico"}),a.jsx(rt,{value:k.impostos?.icms?.monofasico_valor||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,icms:{...F[T].impostos.icms,monofasico_valor:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"BC Mono Reteno"}),a.jsx(rt,{value:k.impostos?.icms?.mono_retencao_bc||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,icms:{...F[T].impostos.icms,mono_retencao_bc:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"ICMS Mono Reteno"}),a.jsx(rt,{value:k.impostos?.icms?.mono_retencao_valor||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,icms:{...F[T].impostos.icms,mono_retencao_valor:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"% Reduo"}),a.jsx(rt,{value:k.impostos?.icms?.reducao_percent||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,icms:{...F[T].impostos.icms,reducao_percent:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Motivo da Reduo"}),a.jsx(rt,{value:k.impostos?.icms?.reducao_motivo||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,icms:{...F[T].impostos.icms,reducao_motivo:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"BC Mono Cobrado Ant."}),a.jsx(rt,{value:k.impostos?.icms?.mono_cobrado_ant_bc||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,icms:{...F[T].impostos.icms,mono_cobrado_ant_bc:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"ICMS Mono Cobrado Ant."}),a.jsx(rt,{value:k.impostos?.icms?.mono_cobrado_ant_valor||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,icms:{...F[T].impostos.icms,mono_cobrado_ant_valor:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"ICMS Prprio Devido"}),a.jsx(rt,{value:k.impostos?.icms?.proprio_devido_valor||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,icms:{...F[T].impostos.icms,proprio_devido_valor:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{className:"md:col-span-6 border-t border-border/40 pt-2",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Grupo indicador da origem do combustvel"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-2",children:[a.jsxs("div",{children:[a.jsx(qe,{children:"UF"}),a.jsx(rt,{value:k.impostos?.combustivel?.uf||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,combustivel:{...F[T].impostos.combustivel,uf:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"% origem UF"}),a.jsx(rt,{value:k.impostos?.combustivel?.perc_origem_uf||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,combustivel:{...F[T].impostos.combustivel,perc_origem_uf:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(qe,{children:"Indicador de importao"}),a.jsx(rt,{value:k.impostos?.combustivel?.indicador_importacao||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,combustivel:{...F[T].impostos.combustivel,indicador_importacao:K.target.value}}},{...H,itens:F}})})]})]})]}),a.jsxs("div",{className:"md:col-span-6 border-t border-border/40 pt-2",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"CIDE"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-2",children:[a.jsxs("div",{children:[a.jsx(qe,{children:"Aliq. CIDE"}),a.jsx(rt,{value:k.impostos?.cide?.aliq||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,cide:{...F[T].impostos.cide,aliq:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"BC CIDE"}),a.jsx(rt,{value:k.impostos?.cide?.base||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,cide:{...F[T].impostos.cide,base:K.target.value}}},{...H,itens:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Vl. CIDE"}),a.jsx(rt,{value:k.impostos?.cide?.valor||"",onChange:K=>Je(H=>{const F=[...H.itens];return F[T]={...F[T],impostos:{...F[T].impostos,cide:{...F[T].impostos.cide,valor:K.target.value}}},{...H,itens:F}})})]})]})]})]})]})})]})]},T))})}),a.jsx(is,{value:"totais",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[a.jsxs("div",{children:[a.jsx(qe,{children:"Desconto Geral (R$)"}),a.jsx(rt,{value:Ge.totais.desconto_geral,onChange:k=>Je(T=>({...T,totais:{...T.totais,desconto_geral:k.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Frete (R$)"}),a.jsx(rt,{value:Ge.totais.frete,onChange:k=>Je(T=>({...T,totais:{...T.totais,frete:k.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Outras Despesas (R$)"}),a.jsx(rt,{value:Ge.totais.outras_despesas,onChange:k=>Je(T=>({...T,totais:{...T.totais,outras_despesas:k.target.value}}))})]}),a.jsxs("div",{className:"mt-6 text-sm",children:[a.jsx("span",{className:"text-text-secondary",children:"Total itens: "}),ld(Ge.itens.reduce((k,T)=>{const K=Ft(T.preco_unitario),H=Ft(T.quantidade)||1,F=Ft(T.desconto_percent)||0,Le=Ft(T.desconto_valor)||0,it=Ft(T.acrescimos_valor)||0,lt=K*H,Vt=F?lt*F/100:Le;return k+(lt-Vt+it)},0))]})]})}),a.jsx(is,{value:"pagamento",children:a.jsxs("div",{className:"space-y-3",children:[Ge.pagamentos.map((k,T)=>a.jsxs("div",{className:"grid grid-cols-1 gap-2 items-end md:[grid-template-columns:2fr_1fr_1fr_1fr_auto]",children:[a.jsxs("div",{children:[a.jsx(qe,{children:"Finalizadora"}),a.jsxs(vn,{value:k.finalizadora_id||"",onValueChange:K=>Je(H=>{const F=[...H.pagamentos],Le=(yt||[]).find(it=>String(it.id)===String(K));return F[T]={...F[T],finalizadora_id:K,tipo:Le?.nome||F[T].tipo},{...H,pagamentos:F}}),children:[a.jsx(hn,{className:"h-9",children:a.jsx(wn,{placeholder:yt.length?"Selecionar":"Carregando"})}),a.jsx(pn,{children:yt.map(K=>a.jsx(ct,{value:K.id,children:`${K?.codigo_interno!=null&&String(K.codigo_interno).trim()!==""?String(K.codigo_interno).padStart(2,"0")+" - ":""}${K?.nome||""}`},K.id))})]})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Valor"}),a.jsx(rt,{className:"h-9",inputMode:"decimal",value:k.valor||"",onChange:K=>Je(H=>{const F=[...H.pagamentos];return F[T]={...F[T],valor:Tn(K.target.value)},{...H,pagamentos:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Parcelas"}),a.jsx(rt,{className:"h-9",inputMode:"numeric",value:k.parcelas||"",onChange:K=>Je(H=>{const F=[...H.pagamentos];return F[T]={...F[T],parcelas:kr(K.target.value)},{...H,pagamentos:F}})})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Troco"}),a.jsx(rt,{className:"h-9",inputMode:"decimal",value:k.troco||"",onChange:K=>Je(H=>{const F=[...H.pagamentos];return F[T]={...F[T],troco:Tn(K.target.value)},{...H,pagamentos:F}})})]}),a.jsx("div",{className:"flex items-end justify-end",children:a.jsx(fe,{type:"button",size:"icon",variant:"ghost",className:"text-red-500 hover:text-red-600",title:"Remover pagamento",onClick:()=>Je(K=>({...K,pagamentos:K.pagamentos.filter((H,F)=>F!==T)})),children:a.jsx(Ju,{className:"h-4 w-4"})})})]},T)),a.jsx("div",{className:"flex justify-start",children:a.jsx(fe,{size:"sm",variant:"outline",onClick:()=>Je(k=>{const T=(yt||[])[0];return{...k,pagamentos:[...k.pagamentos,{finalizadora_id:T?.id||"",tipo:T?.nome||"Dinheiro",valor:""}]}}),children:"Adicionar pagamento"})})]})}),a.jsx(is,{value:"transporte",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx(qe,{children:"Tipo do frete"}),a.jsx(rt,{value:Ge.transporte.tipo_frete,onChange:k=>Je(T=>({...T,transporte:{...T.transporte,tipo_frete:k.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Transportadora"}),a.jsx(rt,{value:Ge.transporte.transportadora,onChange:k=>Je(T=>({...T,transporte:{...T.transporte,transportadora:k.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Placa"}),a.jsx(rt,{value:Ge.transporte.placa,onChange:k=>Je(T=>({...T,transporte:{...T.transporte,placa:k.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Volumes"}),a.jsx(rt,{value:Ge.transporte.volumes,onChange:k=>Je(T=>({...T,transporte:{...T.transporte,volumes:k.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Peso lquido"}),a.jsx(rt,{value:Ge.transporte.peso_liquido,onChange:k=>Je(T=>({...T,transporte:{...T.transporte,peso_liquido:k.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Peso bruto"}),a.jsx(rt,{value:Ge.transporte.peso_bruto,onChange:k=>Je(T=>({...T,transporte:{...T.transporte,peso_bruto:k.target.value}}))})]})]})}),a.jsx(is,{value:"adicionais",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx(qe,{children:"Observaes gerais"}),a.jsx(rt,{value:Ge.adicionais.obs_gerais,onChange:k=>Je(T=>({...T,adicionais:{...T.adicionais,obs_gerais:k.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Info para o Fisco"}),a.jsx(rt,{value:Ge.adicionais.info_fisco,onChange:k=>Je(T=>({...T,adicionais:{...T.adicionais,info_fisco:k.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Info para o Cliente"}),a.jsx(rt,{value:Ge.adicionais.info_cliente,onChange:k=>Je(T=>({...T,adicionais:{...T.adicionais,info_cliente:k.target.value}}))})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Referncia documento"}),a.jsx(rt,{value:Ge.adicionais.referencia_doc,onChange:k=>Je(T=>({...T,adicionais:{...T.adicionais,referencia_doc:k.target.value}}))})]})]})}),a.jsx(is,{value:"rastreabilidade",children:a.jsx("div",{className:"text-sm text-text-secondary",children:"Rastreabilidade de Produtos"})})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[a.jsx(fe,{variant:"outline",onClick:()=>xt(!1),children:"Fechar"}),a.jsx(fe,{onClick:async()=>{try{const k=[],T=kr(Ge.cpf_cnpj);Ge.tipo_pessoa==="PF"&&T&&T.length!==11&&k.push("CPF deve ter 11 dgitos"),Ge.tipo_pessoa==="PJ"&&T&&T.length!==14&&k.push("CNPJ deve ter 14 dgitos"),Ge.nome||k.push("Nome/Razo no informado"),Ge.email&&!st(Ge.email)&&k.push("Email invlido"),Ge.uf&&Ge.uf.length!==2&&k.push("UF deve ter 2 letras"),Ge.cep&&kr(Ge.cep).length!==8&&k.push("CEP deve ter 8 dgitos"),Ge.codigo_municipio_ibge||k.push("Cdigo IBGE do municpio  obrigatrio");const K=[];if(Ge.itens.forEach((Ve,kt)=>{Ve.descricao||K.push(`Item ${kt+1}: descrio obrigatria`),(!Ve.ncm||kr(Ve.ncm).length!==8)&&K.push(`Item ${kt+1}: NCM deve ter 8 dgitos`),(!Ve.cfop||kr(Ve.cfop).length!==4)&&K.push(`Item ${kt+1}: CFOP deve ter 4 dgitos`),Ft(Ve.quantidade)<=0&&K.push(`Item ${kt+1}: quantidade deve ser > 0`),Ft(Ve.preco_unitario)<=0&&K.push(`Item ${kt+1}: preo deve ser > 0`)}),k.push(...K),k.length){r({title:"Pendncias para gerar XML",description:k.join(`
`),variant:"destructive"});return}const H=Ge.itens.map(Ve=>{const kt=Ft(Ve.preco_unitario)||0,Sr=Ft(Ve.quantidade)||1,Or=kt*Sr,fr=Ft(Ve.desconto_percent)||0,Kr=Ft(Ve.desconto_valor)||0,Pn=Ft(Ve.acrescimos_valor)||0,qn=fr?Or*fr/100:Kr,zn=Or-qn+Pn;return{preco_unitario:kt,quantidade:Sr,preco_total:zn,produtos:{nome:Ve.descricao||"Produto",codigo:Ve.codigo||"",ncm:Ve.ncm||"",cfopInterno:Ve.cfop||"5102"}}}),Le=H.reduce((Ve,kt)=>Ve+(Number(kt.preco_total)||0),0)-(Ft(Ge.totais.desconto_geral)||0)+(Ft(Ge.totais.frete)||0)+(Ft(Ge.totais.outras_despesas)||0),it={tipo_pessoa:Ge.tipo_pessoa,cpf_cnpj:kr(Ge.cpf_cnpj),nome:Ge.nome,email:Ge.email,logradouro:Ge.logradouro,numero:Ge.numero,bairro:Ge.bairro,cidade:Ge.cidade,uf:Ge.uf,cep:kr(Ge.cep),codigo_municipio_ibge:Ge.codigo_municipio_ibge,inscricao_estadual:Ge.ie_isento?"ISENTO":Ge.inscricao_estadual,telefone:Ge.telefone},lt=Ge.pagamentos&&Ge.pagamentos.length?Ge.pagamentos.map(Ve=>({finalizadoras:{codigo_sefaz:(yt||[]).find(Or=>String(Or.id)===String(Ve.finalizadora_id))?.codigo_sefaz||"99"},valor:Ft(Ve.valor)||0})):[{finalizadoras:{codigo_sefaz:"99"},valor:Le}],Vt=await Fit({codigoEmpresa:t,cliente:it,itens:H,pagamentos:lt,modelo:"55",overrides:{natOp:Ge.natOp,serie:Ge.serie,nNF:Ge.nNF,indFinal:Ge.indFinal,indPres:Ge.indPres,idDest:Ge.idDest,tpNF:Ge.tipo_nota==="entrada"?"0":"1"}});ht(Vt),Mt(!0),r({title:"XML NF-e gerado"})}catch(k){r({title:"Falha ao gerar XML",description:k.message,variant:"destructive"})}},children:"Gerar XML"})]}),!1]})}),a.jsx(mn,{open:zt,onOpenChange:Mt,children:a.jsxs(un,{className:"w-[95vw] sm:max-w-[800px] max-h-[85vh] overflow-y-auto",children:[a.jsxs(on,{children:[a.jsx(an,{children:"XML gerado"}),a.jsx(Nn,{children:"Faa o download ou salve no Supabase."})]}),a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Prvia do XML"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(fe,{size:"sm",variant:"outline",onClick:()=>fV(`nfe-manual-${Date.now()}.xml`,Ze),children:"Baixar XML"}),a.jsx(fe,{size:"sm",onClick:async()=>{try{be(!0);const k=`nfe/${t}/manual-${Date.now()}.xml`,T=new Blob([Ze],{type:"text/xml;charset=utf-8"}),{error:K}=await de.storage.from("fiscal").upload(k,T,{contentType:"text/xml"});if(K)throw K;r({title:"XML salvo no Supabase"})}catch(k){r({title:"Falha ao salvar",description:k.message,variant:"destructive"})}finally{be(!1)}},disabled:Wt,children:Wt?"Salvando...":"Salvar no Supabase"})]})]}),a.jsx("pre",{className:"text-[11px] whitespace-pre-wrap break-all max-h-[360px] overflow-auto border border-border rounded p-2 bg-surface-2",children:Ze})]})}),a.jsx(mn,{open:te,onOpenChange:Y,children:a.jsxs(un,{className:"w-[95vw] sm:max-w-[680px] md:max-w-[860px] lg:max-w-[900px] max-h-[85vh] overflow-y-auto",children:[a.jsxs(on,{children:[a.jsx(an,{children:"Emisso NF-e (XML offline)"}),a.jsx(Nn,{children:"Preencha os campos abaixo e gere o XML da NF-e. Transmisso para SEFAZ ficar para a prxima etapa."})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx(qe,{children:"Natureza da Operao (natOp)"}),a.jsx(rt,{value:ne.natOp,onChange:k=>ie(T=>({...T,natOp:k.target.value})),placeholder:"VENDA"})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Srie"}),a.jsx(rt,{value:ne.serie,onChange:k=>ie(T=>({...T,serie:k.target.value}))})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Nmero (nNF)"}),a.jsx(rt,{value:ne.nNF,onChange:k=>ie(T=>({...T,nNF:k.target.value})),placeholder:"(opcional)"})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Destino da Operao (idDest)"}),a.jsxs(vn,{value:ne.idDest||"",onValueChange:k=>ie(T=>({...T,idDest:k})),children:[a.jsx(hn,{children:a.jsx(wn,{placeholder:"Automtico"})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"",children:"Automtico"}),a.jsx(ct,{value:"1",children:"Interna (mesmo estado)"}),a.jsx(ct,{value:"2",children:"Interestadual"}),a.jsx(ct,{value:"3",children:"Exterior"})]})]})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Consumidor Final (indFinal)"}),a.jsxs(vn,{value:ne.indFinal,onValueChange:k=>ie(T=>({...T,indFinal:k})),children:[a.jsx(hn,{children:a.jsx(wn,{})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"1",children:"Sim"}),a.jsx(ct,{value:"0",children:"No"})]})]})]}),a.jsxs("div",{children:[a.jsx(qe,{children:"Presena do Comprador (indPres)"}),a.jsxs(vn,{value:ne.indPres,onValueChange:k=>ie(T=>({...T,indPres:k})),children:[a.jsx(hn,{children:a.jsx(wn,{})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"1",children:"Operao presencial"}),a.jsx(ct,{value:"2",children:"No presencial, internet"}),a.jsx(ct,{value:"4",children:"Entrega em domiclio"}),a.jsx(ct,{value:"9",children:"No se aplica"})]})]})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[a.jsx(fe,{variant:"outline",onClick:()=>Y(!1),children:"Fechar"}),a.jsx(fe,{onClick:Dn,disabled:ce,children:ce?"Gerando...":"Gerar XML"})]}),ae&&a.jsxs("div",{className:"mt-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:"Prvia do XML Gerado"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(fe,{size:"sm",variant:"outline",onClick:()=>fV(`nfe-${ue||"doc"}.xml`,ae),children:"Baixar XML"}),a.jsx(fe,{size:"sm",onClick:se,disabled:gt,children:gt?"Salvando...":"Salvar no Supabase"})]})]}),a.jsx("pre",{className:"text-[11px] whitespace-pre-wrap break-all max-h-[360px] overflow-auto border border-border rounded p-2 bg-surface-2",children:ae})]})]})})]})}function fV(e,t){try{const r=new Blob([t],{type:"text/xml;charset=utf-8"}),n=URL.createObjectURL(r),s=document.createElement("a");s.href=n,s.download=e,document.body.appendChild(s),s.click(),s.remove(),URL.revokeObjectURL(n)}catch{}}const zit=(e,t,r)=>e.split(/(\*\*.*?\*\*)/g).map((s,o)=>{if(s.startsWith("**")&&s.endsWith("**")){const i=s.slice(2,-2);return a.jsx("strong",{className:`font-black ${t?r?"text-white":"text-[#000000]":"text-white"}`,style:{fontWeight:900,textShadow:t?r?"0 0 1px rgba(0,0,0,0.25)":"0 0 1px rgba(0,0,0,0.3)":"0 0 1px rgba(255,255,255,0.5)"},children:i},o)}return s}),hoe=({message:e})=>{const t=e.from==="isis",r=t&&e?.color==="green",n=t&&e?.color==="system",[s,o]=p.useState(!1),{selections:i}=zC(),{clientIdentified:l,userInitial:c}=p.useMemo(()=>{const u=i?.contato?.nome||i?.cliente?.nome||"",f=String(u).trim(),h=f?f[0]:"",m=h&&/[A-Za-z---]/.test(h)?h.toUpperCase():"U";return{clientIdentified:!!u,userInitial:m}},[i?.contato?.nome,i?.cliente?.nome]),d=async u=>{try{if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(u);else{const f=document.createElement("textarea");f.value=u,f.style.position="fixed",f.style.top="0",f.style.left="0",f.style.opacity="0",document.body.appendChild(f),f.focus(),f.select(),document.execCommand("copy"),document.body.removeChild(f)}o(!0),setTimeout(()=>o(!1),1800)}catch{}};return a.jsx(xr.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.4,ease:[.22,1,.36,1]},className:`flex ${t?"justify-start":"justify-end"} mb-4 md:mb-6`,children:a.jsxs("div",{className:`flex items-end gap-2 md:gap-3 max-w-[90%] md:max-w-[85%] lg:max-w-[75%] ${!t&&"flex-row-reverse"}`,children:[t?a.jsx(gi,{size:"sm",variant:"message",className:"md:w-14 md:h-14"}):l?a.jsx("div",{className:"w-10 h-10 md:w-14 md:h-14 rounded-full flex items-center justify-center flex-shrink-0 bg-brand/10 text-brand ring-2 ring-brand/60",children:a.jsx("span",{className:"font-extrabold text-base md:text-lg leading-none select-none",children:c})}):a.jsx("div",{className:"w-10 h-10 md:w-14 md:h-14 rounded-full flex items-center justify-center flex-shrink-0 bg-surface border border-white/10 text-text-muted",children:a.jsx(Uu,{className:"w-5 h-5 md:w-6 md:h-6"})}),a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("div",{className:`relative px-3 py-2.5 md:px-5 md:py-3.5 backdrop-blur-sm transition-all duration-300 ${t?r?"bg-emerald-600/90 border border-emerald-400 text-white rounded-2xl rounded-bl-sm shadow-lg shadow-emerald-600/30":n?"bg-surface/70 border border-white/10 text-text-muted rounded-2xl rounded-bl-sm":"bg-brand border border-brand text-[#0A0A0A] rounded-2xl rounded-bl-sm shadow-lg shadow-brand/20":"bg-surface/70 border border-white/10 text-text-primary rounded-2xl rounded-br-sm"}`,children:[a.jsx("p",{className:"text-[15px] md:text-[15px] font-bold leading-relaxed whitespace-pre-wrap tracking-wide relative",children:zit(e.text,t,r)}),e.copyable&&a.jsx("button",{type:"button",onClick:()=>d(e.copyText||(typeof e.text=="string"?e.text:"")),className:`absolute right-2 bottom-2 p-1.5 md:p-2 rounded-full border shadow-sm transition ${t?"bg-white/80 border-white/40 text-[#0A0A0A] hover:bg-white":"bg-white/10 border-white/10 text-text-primary hover:bg-white/20"}`,"aria-label":"Copiar texto",children:s?a.jsx(Yf,{className:"w-4 h-4"}):a.jsx(YH,{className:"w-4 h-4"})})]}),a.jsx("p",{className:`text-[10px] md:text-[10px] text-text-muted px-2 ${t?"text-left":"text-right"}`,children:cr(e.timestamp,"HH:mm")})]})]})})};function Uit(){const[e,t]=p.useState([]),[r,n]=p.useState(""),[s,o]=p.useState(!1),[i,l]=p.useState(""),[c,d]=p.useState(!0),u=p.useRef(null),{company:f,userProfile:h,user:m}=ms();p.useEffect(()=>{const b={id:Date.now()+Math.random(),from:"isis",text:"Ol! Eu sou a verso Premium da sis, integrada  OpenAI. Em que posso ajudar? ",timestamp:new Date};t([b])},[]),p.useEffect(()=>{const b=setTimeout(()=>{u.current?.scrollIntoView({behavior:"smooth",block:"end"})},100);return()=>clearTimeout(b)},[e,s]);const v=b=>{t(w=>[...w,{id:Date.now()+Math.random(),timestamp:new Date,...b}])},g=b=>{const w=String(b||"").toLowerCase();return w?w.includes("agend")||w.includes("agenda")?w.includes("hoje")?"Consultando os agendamentos de hoje...":w.includes("amanh")?"Consultando os agendamentos de amanh...":"Consultando seus agendamentos...":w.includes("cliente")?"Buscando informaes de clientes...":w.includes("caixa")||w.includes("faturamento")||w.includes("financeiro")||w.includes("venda")||w.includes("pagamento")?"Analisando movimentaes da sua arena...":w.includes("quadra")||w.includes("reserva")?"Verificando horrios e quadras disponveis...":"...":"..."},y=async(b,w)=>{try{const j=f?.codigoEmpresa||f?.codigo_empresa||null,_=h?.id||m?.id||null,S=h?.nome||m?.email||null,C=h?.cargo||null,P=new Date,A=new Date(P.getFullYear(),P.getMonth(),P.getDate(),0,0,0,0),R=new Date(A);R.setDate(R.getDate()+1);const O=A.toISOString(),I=R.toISOString(),M=Array.isArray(w)?w.map($=>({role:$.from==="isis"?"assistant":"user",content:$.text})):[],{data:D,error:U}=await de.functions.invoke("chat-proxy",{body:{message:b,empresaCodigo:j,usuarioId:_,usuarioNome:S,usuarioCargo:C,data_inicio:O,data_fim:I,history:M}});if(U)throw U;const z=typeof D?.reply=="string"&&D.reply.trim().length>0?D.reply:"Certo! (resposta provisria)";let W=Array.isArray(D?.replies)?D.replies.filter($=>typeof $=="string"&&$.trim().length>0):[];if(W.length===0&&(W=[z]),console.log("[sis][response]",{replies:W,raw:D}),D)try{console.log("[sis][response raw JSON]",JSON.stringify(D,null,2))}catch{}for(let $=0;$<W.length;$++){const X=W[$];v({from:"isis",text:X}),$<W.length-1&&await new Promise(ye=>setTimeout(ye,600))}o(!1),l("")}catch{v({from:"isis",text:"No momento, estou operando em modo de demonstrao. Em breve estarei 100% conectada  OpenAI aqui na aba Premium! "}),o(!1),l("")}},x=async b=>{b.preventDefault();const w=r.trim();if(!w)return;const j=[...e];console.log("[sis][question]",{message:w}),v({from:"user",text:w}),n(""),o(!0),l(g(w)),await y(w,j)};return a.jsxs("div",{className:"flex h-full w-full relative",children:[a.jsxs("div",{className:"flex-1 flex flex-col pointer-events-none",children:[a.jsxs("div",{className:"flex-1 overflow-y-auto px-3 md:px-6 py-4 md:py-6",children:[e.map(b=>a.jsx(hoe,{message:b},b.id)),s&&a.jsx(xr.div,{initial:{opacity:0},animate:{opacity:1},className:"flex justify-start mb-4",children:a.jsx("div",{className:"px-4 py-2 rounded-2xl bg-brand border border-brand text-[#0A0A0A] flex items-center gap-2 animate-pulse",children:i&&i!=="..."?a.jsxs(a.Fragment,{children:[a.jsx("span",{role:"img","aria-label":"pensando",children:""}),a.jsx("span",{children:i})]}):a.jsx("span",{className:"font-semibold tracking-widest",children:"..."})})}),a.jsx("div",{ref:u})]}),a.jsx("div",{className:"sticky bottom-0 px-3 md:px-6 pb-3 md:pb-6 pt-3 md:pt-4 bg-gradient-to-t from-background via-background to-transparent",children:a.jsxs("form",{onSubmit:x,className:"flex items-center gap-2 bg-surface/70 border border-white/10 rounded-xl px-3 py-2.5",children:[a.jsx(KH,{className:"w-5 h-5 text-text-muted"}),a.jsx("input",{value:r,onChange:b=>n(b.target.value),placeholder:"Escreva aqui",className:"flex-1 bg-transparent outline-none text-sm"}),a.jsxs("button",{type:"submit",disabled:!r.trim(),className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm font-semibold transition ${r.trim()?"bg-brand text-bg":"bg-surface/40 text-text-muted cursor-not-allowed"}`,children:[a.jsx(S4,{className:"w-4 h-4"}),"Enviar"]})]})})]}),c&&a.jsx("div",{className:"absolute inset-0 z-10 backdrop-blur-lg bg-black/60 flex items-center justify-center pointer-events-auto rounded-lg overflow-hidden",children:a.jsx(xr.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},transition:{duration:.5,ease:[.22,1,.36,1]},className:"rounded-2xl border border-white/30 bg-gradient-to-br from-slate-900 via-slate-900 to-slate-800 shadow-2xl max-w-sm w-full text-center mx-4 overflow-hidden",children:a.jsxs("div",{className:"px-8 py-10",children:[a.jsx(xr.div,{initial:{scale:.8},animate:{scale:1},transition:{delay:.2,duration:.4},className:"flex items-center justify-center mb-8",children:a.jsx("div",{className:"w-24 h-24 rounded-full p-[3px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400 shadow-[0_0_20px_rgba(168,85,247,0.5)] overflow-hidden",children:a.jsx("div",{className:"w-full h-full rounded-full overflow-hidden bg-background flex items-center justify-center",children:a.jsx(gi,{size:"lg"})})})}),a.jsxs(xr.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3,duration:.4},children:[a.jsx("div",{className:"text-3xl font-black bg-clip-text text-transparent bg-gradient-to-r from-fuchsia-400 via-violet-300 to-emerald-300 mb-4",children:"sis"}),a.jsx("p",{className:"text-sm text-gray-300 mb-6 leading-relaxed",children:"Em breve sua assistente IA vai estar pronta para revolucionar a gesto da sua arena. "}),a.jsxs("div",{className:"space-y-3 text-left",children:[a.jsxs("div",{className:"flex items-start gap-3 text-sm text-gray-200",children:[a.jsx("span",{className:"text-emerald-400 font-bold mt-0.5",children:""}),a.jsx("span",{children:"Gerencie agendamentos com inteligncia artificial"})]}),a.jsxs("div",{className:"flex items-start gap-3 text-sm text-gray-200",children:[a.jsx("span",{className:"text-violet-400 font-bold mt-0.5",children:""}),a.jsx("span",{children:"Otimize sua agenda e maximize ocupao"})]}),a.jsxs("div",{className:"flex items-start gap-3 text-sm text-gray-200",children:[a.jsx("span",{className:"text-fuchsia-400 font-bold mt-0.5",children:""}),a.jsx("span",{children:"Insights inteligentes sobre sua arena"})]})]})]})]})})})]})}function Vit(){const{company:e}=ms(),{clearIsisAlerts:t}=E1(),r=e?.codigo_empresa||e?.codigoEmpresa||null,[n,s]=p.useState(!0),[o,i]=p.useState(null),[l,c]=p.useState(!1),[d,u]=p.useState(null),[f,h]=p.useState(""),[m,v]=p.useState(""),[g,y]=p.useState(!1),[x,b]=p.useState(!1),[w,j]=p.useState(!1),[_,S]=p.useState(""),[C,P]=p.useState(""),[A,R]=p.useState(""),[O,I]=p.useState(!1),[M,D]=p.useState({agendamentosIsisTotal:0,agendamentosIsisHoje:0,agendamentosIsis7d:0,agendamentosTotal7d:0,cancelamentosIsis7d:0,perDay7d:[],topQuadras30d:[],ultimasInteracoes:[]}),[U,z]=p.useState({}),W=te=>{if(!te)return"";const Y=te instanceof Date?te:new Date(te);if(isNaN(Y.getTime()))return"";const ce=Y.getFullYear(),me=String(Y.getMonth()+1).padStart(2,"0"),ae=String(Y.getDate()).padStart(2,"0");return`${ce}-${me}-${ae}`},$=te=>{if(!te)return null;const Y=/^([0-9]{4})-([0-9]{2})-([0-9]{2})$/.exec(String(te));if(!Y)return null;const ce=parseInt(Y[1],10),me=parseInt(Y[2],10)-1,ae=parseInt(Y[3],10),le=new Date(ce,me,ae,0,0,0,0);return isNaN(le.getTime())?null:le},X=te=>{try{if(!te)return"";const Y=te instanceof Date?te:new Date(te);return isNaN(Y.getTime())?"":Y.toLocaleDateString("pt-BR")}catch{return""}};p.useEffect(()=>{try{t?.()}catch{}},[t]),p.useEffect(()=>{if(!r||f||m)return;const te=new Date,Y=new Date;Y.setDate(Y.getDate()-6);const ce=W(Y),me=W(te);try{console.log("[IsisAnalytics] Init default range (auto-fill):",{startYmd:ce,endYmd:me})}catch{}h(ce),v(me)},[r]),p.useEffect(()=>{!g||!e?.id||(async()=>{try{b(!0);const{data:te,error:Y}=await de.from("agenda_settings").select("isis_cancel_min_hours_before, isis_subdomain, isis_display_name").eq("empresa_id",e.id).single();if(Y&&Y.code!=="PGRST116")throw Y;if(te)S(te.isis_cancel_min_hours_before??""),P(te.isis_subdomain||""),R(te.isis_display_name||"");else{const ce=(e.nome_fantasia||"").toLowerCase().replace(/[^a-z0-9]+/g,"");P(ce),R(e.nome_fantasia||"")}}catch(te){console.error("[IsisSettings] Erro ao carregar:",te)}finally{b(!1)}})()},[g,e?.id,e?.nome_fantasia]);const ye=async()=>{if(e?.id)try{j(!0);const te=_===""?null:parseInt(_,10);if(te!==null&&(isNaN(te)||te<0)){alert("Horas de cancelamento deve ser um nmero >= 0"),j(!1);return}const Y=(C||"").toLowerCase().replace(/[^a-z0-9]+/g,"");if(!Y){alert("Subdomnio no pode estar vazio"),j(!1);return}const ce=(A||"").trim();if(!ce){alert("Nome de exibio no pode estar vazio"),j(!1);return}const{error:me}=await de.from("agenda_settings").upsert({empresa_id:e.id,isis_cancel_min_hours_before:te,isis_subdomain:Y,isis_display_name:ce},{onConflict:"empresa_id"});if(me)throw me;P(Y),R(ce),I(!1),y(!1)}catch(te){console.error("[IsisSettings] Erro ao salvar:",te),alert("Erro ao salvar configuraes: "+(te?.message||"desconhecido"))}finally{j(!1)}},Se={hidden:{opacity:0},visible:{opacity:1,transition:{when:"beforeChildren",staggerChildren:.1,delayChildren:.15}}},V={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.6,ease:[.22,1,.36,1]}}},B=({icon:te,title:Y,value:ce,color:me="brand"})=>a.jsxs(xr.div,{variants:V,className:"fx-card",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("div",{className:"flex items-center justify-center h-10 w-10 rounded-md border border-white/10 bg-white/5",style:{color:`var(--${me})`},children:a.jsx(te,{className:"h-5 w-5"})})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-semibold text-text-secondary uppercase tracking-wider mb-2",children:Y}),a.jsx("p",{className:"text-3xl font-bold text-text-primary tabular-nums tracking-tight",children:ce})]})]}),Q=p.useMemo(()=>(M.perDay7d||[]).map(te=>({name:new Date(te.date).toLocaleDateString(void 0,{day:"2-digit",month:"2-digit"}),total:te.total,isis:te.isis})),[M.perDay7d]);p.useEffect(()=>{let te=!0;return(async()=>{try{s(!0),i(null);const Y=dt=>{const ut=new Date(dt);return ut.setHours(0,0,0,0),ut},ce=dt=>{const ut=new Date(dt);return ut.setHours(23,59,59,999),ut},me=Y(new Date),ae=ce(new Date),le=new Date;le.setDate(le.getDate()-6);const ue=Y(le),Re=ae,ne=new Date;ne.setDate(ne.getDate()-29);const ie=Y(ne);console.log("[IsisAnalytics] codigoEmpresa:",r,"company obj:",e);const{count:gt,error:bt}=await de.from("agendamentos").select("id",{count:"exact",head:!0}).eq("codigo_empresa",r).eq("created_by_isis",!0);if(bt)throw bt;console.log("[IsisAnalytics] HOJE intervalo criado_em:",me.toISOString(),"->",ae.toISOString());let xt=(await de.from("agendamentos").select("id",{count:"exact",head:!0}).eq("codigo_empresa",r).eq("created_by_isis",!0).gte("criado_em",me.toISOString()).lte("criado_em",ae.toISOString()))?.count??null;if(xt==null){const{data:dt}=await de.from("agendamentos").select("id").eq("codigo_empresa",r).eq("created_by_isis",!0).gte("criado_em",me.toISOString()).lte("criado_em",ae.toISOString());xt=(dt||[]).length}console.log("[IsisAnalytics] agIsisHoje (count resolved):",xt),console.log("[IsisAnalytics] 7d intervalo criado_em:",ue.toISOString(),"->",Re.toISOString());const{data:Ze}=await de.from("agendamentos").select("id, criado_em").eq("codigo_empresa",r).eq("created_by_isis",!0).gte("criado_em",ue.toISOString()).lte("criado_em",Re.toISOString());console.log("[IsisAnalytics] agIsis7dRows length:",(Ze||[]).length);const{data:ht}=await de.from("agendamentos").select("id, inicio").eq("codigo_empresa",r).gte("inicio",ue.toISOString()).lte("inicio",Re.toISOString());let be=(await de.from("agendamentos").select("id",{count:"exact",head:!0}).eq("codigo_empresa",r).eq("canceled_by","isis").gte("canceled_at",ue.toISOString()).lte("canceled_at",Re.toISOString()))?.count??null;if(be==null){const{data:dt}=await de.from("agendamentos").select("id").eq("codigo_empresa",r).eq("canceled_by","isis").gte("canceled_at",ue.toISOString()).lte("canceled_at",Re.toISOString());be=(dt||[]).length}console.log("[IsisAnalytics] cancelamentosIsis7d (count resolved - canceled_by=isis):",be);const Ct=Array.isArray(Ze)?Ze.length:0,wt=Array.isArray(ht)?ht.length:0,Ge=dt=>{const ut=new Date(dt);return ut.setHours(0,0,0,0),ut.toISOString().slice(0,10)},Je={};for(let dt=0;dt<7;dt++){const ut=new Date(ue);ut.setDate(ue.getDate()+dt),Je[Ge(ut)]={date:new Date(ut),isis:0,total:0}}(ht||[]).forEach(dt=>{const ut=Ge(dt.inicio);Je[ut]&&(Je[ut].total+=1)}),(Ze||[]).forEach(dt=>{const ut=dt.inicio||dt.criado_em,rr=Ge(ut);Je[rr]&&(Je[rr].isis+=1)});const _e=Object.values(Je),{data:je}=await de.from("agendamentos").select("quadra_id").eq("codigo_empresa",r).eq("created_by_isis",!0).gte("inicio",ie.toISOString()).lte("inicio",ae.toISOString()),Ue=new Map;(je||[]).forEach(dt=>{dt?.quadra_id&&Ue.set(dt.quadra_id,(Ue.get(dt.quadra_id)||0)+1)});const ze=Array.from(Ue.keys());let or={};if(ze.length>0){const{data:dt}=await de.from("quadras").select("id, nome").in("id",ze);(dt||[]).forEach(ut=>{or[ut.id]=ut.nome})}const tr=Array.from(Ue.entries()).map(([dt,ut])=>({id:dt,nome:or[dt]||"Quadra",count:ut})).sort((dt,ut)=>ut.count-dt.count).slice(0,5),{data:Nt}=await de.from("agendamentos").select("modalidade").eq("codigo_empresa",r).eq("created_by_isis",!0).gte("inicio",ie.toISOString()).lte("inicio",ae.toISOString()),yr=new Map;(Nt||[]).forEach(dt=>{const ut=(dt?.modalidade||"").trim();ut&&yr.set(ut,(yr.get(ut)||0)+1)});const Me=Array.from(yr.entries()).map(([dt,ut])=>({nome:dt,count:ut})).sort((dt,ut)=>ut.count-dt.count).slice(0,5);if(!te)return;D(dt=>({...dt,agendamentosIsisTotal:gt||0,agendamentosIsisHoje:xt||0,agendamentosIsis7d:Ct,agendamentosTotal7d:wt,cancelamentosIsis7d:be||0,perDay7d:_e,topQuadras30d:tr,topModalidades30d:Me})),s(!1)}catch(Y){if(!te)return;i(Y?.message||"Erro ao carregar mtricas"),s(!1)}})(),()=>{te=!1}},[r,e?.nome_fantasia,e?.razao_social]),p.useEffect(()=>{let te=!0;return(async()=>{if(r)try{c(!0),u(null);const Y=Je=>{const _e=new Date(Je);return _e.setHours(0,0,0,0),_e},ce=Je=>{const _e=new Date(Je);return _e.setHours(23,59,59,999),_e},ae=W(new Date),le=new Date;le.setDate(le.getDate()-6);const ue=W(le),Re=f||ue,ne=m||ae;let ie=de.from("agendamentos").select("id, codigo, inicio, fim, criado_em, status, cliente_id, clientes, quadra_id").eq("codigo_empresa",r).eq("created_by_isis",!0).order("criado_em",{ascending:!1}).order("inicio",{ascending:!1});const gt=!!(Re||ne),bt=Re?Y($(Re)).toISOString():null,at=ne?ce($(ne)).toISOString():null;if(bt||at){const Je=[],_e=[];bt&&_e.push(`criado_em.gte.${bt}`),at&&_e.push(`criado_em.lte.${at}`),_e.length>0&&Je.push(`and(${_e.join(",")})`);const je=["criado_em.is.null"];bt&&je.push(`inicio.gte.${bt}`),at&&je.push(`inicio.lte.${at}`),Je.push(`and(${je.join(",")})`),ie=ie.or(Je.join(","))}ie=ie.limit(gt?200:10);try{console.log("[IsisAnalytics] Fetch lastAgs with range (effective):",{effStart:Re,effEnd:ne,hasAnyFilter:gt,limit:gt?200:10})}catch{}const{data:xt,error:Ze}=await ie;if(Ze){try{console.error("[IsisAnalytics] lastAgs query error:",Ze)}catch{}throw Ze}try{console.log("[IsisAnalytics] lastAgs length:",(xt||[]).length)}catch{}const ht=Array.from(new Set((xt||[]).map(Je=>Je.cliente_id).filter(Boolean)));let Wt={};if(ht.length>0){const{data:Je}=await de.from("clientes").select("id, nome").in("id",ht);(Je||[]).forEach(_e=>{Wt[_e.id]=_e.nome})}const be=Array.from(new Set((xt||[]).map(Je=>Je.quadra_id).filter(Boolean)));let Ct={};if(be.length>0){const{data:Je}=await de.from("quadras").select("id, nome").in("id",be);(Je||[]).forEach(_e=>{Ct[_e.id]=_e.nome})}const wt=(xt||[]).map(Je=>Je.id);let Ge={};if(wt.length>0){const{data:Je}=await de.from("agendamento_participantes").select("agendamento_id, nome, status_pagamento, valor_cota").in("agendamento_id",wt).order("agendamento_id",{ascending:!0});(Je||[]).forEach(_e=>{Ge[_e.agendamento_id]||(Ge[_e.agendamento_id]=[]),Ge[_e.agendamento_id].push(_e)})}if(!te)return;z({}),D(Je=>({...Je,ultimasInteracoes:(xt||[]).map(_e=>({..._e,cliente_nome:Wt[_e.cliente_id]||null,participantes:Ge[_e.id]||[],quadra_nome:Ct[_e.quadra_id]||null}))})),c(!1)}catch(Y){if(!te)return;u(Y?.message||"Erro ao carregar agendamentos"),c(!1)}})(),()=>{te=!1}},[r,f,m]);const pe=p.useMemo(()=>e?.nome_fantasia||e?.razao_social||"sua arena",[e]);return a.jsxs(xr.div,{variants:Se,initial:"hidden",animate:"visible",className:"space-y-4",children:[a.jsxs(xr.div,{variants:V,className:"bg-surface/70 backdrop-blur-sm relative p-4 md:p-6 rounded-xl border border-white/10 overflow-hidden shadow-1",children:[a.jsx("div",{className:"absolute inset-0 bg-court-pattern opacity-[0.03] mix-blend-overlay"}),a.jsxs("div",{className:"relative z-10 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[a.jsx("div",{className:"rounded-full p-[2px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400 shadow-[0_0_12px_rgba(168,85,247,0.35)] flex-shrink-0",children:a.jsx("div",{className:"rounded-full overflow-hidden bg-background w-10 h-10 sm:w-12 sm:h-12 grid place-items-center",children:a.jsx(gi,{size:"xs",className:"w-10 h-10 sm:w-12 sm:h-12"})})}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsxs("h1",{className:"text-xl sm:text-2xl font-black text-text-primary tracking-tight flex items-center gap-2 flex-wrap",children:[a.jsx(e_,{className:"h-5 w-5 sm:h-6 sm:w-6 text-brand flex-shrink-0"}),a.jsx("span",{className:"truncate",children:"Anlises da sis"})]}),a.jsxs("p",{className:"text-xs sm:text-sm text-text-secondary mt-1 line-clamp-2",children:["Como a sis est ajudando ",pe," a converter conversas em reservas."]})]})]}),a.jsx("button",{type:"button",onClick:()=>y(!0),className:"inline-flex items-center justify-center w-10 h-10 sm:w-11 sm:h-11 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 hover:border-white/20 transition-all duration-200 text-text-secondary hover:text-text-primary flex-shrink-0 self-end sm:self-auto",title:"Configuraes da sis",children:a.jsx(Ad,{className:"h-5 w-5"})})]})]}),n?a.jsxs(xr.div,{initial:{opacity:0},animate:{opacity:1},className:"flex flex-col items-center justify-center py-20 gap-4",children:[a.jsx("div",{className:"relative",children:a.jsx("div",{className:"rounded-full p-[3px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400 shadow-[0_0_20px_rgba(168,85,247,0.4)] animate-pulse",children:a.jsx("div",{className:"rounded-full overflow-hidden bg-background w-20 h-20 grid place-items-center",children:a.jsx(gi,{size:"sm",className:"w-20 h-20"})})})}),a.jsxs("div",{className:"flex items-center gap-2 text-text-muted",children:[a.jsx(Tc,{className:"h-5 w-5 animate-spin"}),a.jsx("span",{className:"text-sm font-medium",children:"Carregando anlises da sis..."})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-3 mt-4 w-full max-w-md",children:[a.jsx("div",{className:"h-24 bg-white/5 rounded-lg animate-pulse"}),a.jsx("div",{className:"h-24 bg-white/5 rounded-lg animate-pulse"}),a.jsx("div",{className:"h-24 bg-white/5 rounded-lg animate-pulse"})]})]}):o?a.jsx("div",{className:"text-danger text-sm",children:o}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx(B,{icon:pC,title:"Agendamentos feitos (hoje)",value:M.agendamentosIsisHoje,color:"success"}),a.jsx(B,{icon:Jf,title:"Agendamentos feitos (7 dias)",value:M.agendamentosIsis7d,color:"info"}),a.jsx(B,{icon:Qp,title:"Cancelamentos",value:M.cancelamentosIsis7d,color:"danger"})]}),a.jsxs(xr.div,{variants:V,className:"fx-card",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsxs("h2",{className:"text-base font-bold text-text-primary flex items-center",children:[a.jsx(Jf,{className:"mr-2 h-5 w-5 text-brand"}),"Distribuio  ltimos 7 dias"]})}),a.jsx("div",{className:"px-1 pb-2",children:a.jsx(fb,{width:"100%",height:220,children:a.jsxs(jee,{data:Q,margin:{top:8,right:12,left:0,bottom:0},children:[a.jsx(mS,{strokeDasharray:"3 3",stroke:"var(--border)",opacity:.5}),a.jsx(Fh,{dataKey:"name",tick:{fontSize:11,fill:"var(--text-muted)"},tickLine:!1,axisLine:{stroke:"var(--border)"}}),a.jsx($h,{allowDecimals:!1,tick:{fontSize:11,fill:"var(--text-muted)"},tickLine:!1,axisLine:{stroke:"var(--border)"},width:28}),a.jsx(Xl,{cursor:{stroke:"var(--border)",strokeDasharray:"3 3"},contentStyle:{background:"rgba(10,10,10,0.85)",borderColor:"var(--border)",color:"var(--text-primary)",borderRadius:"8px"},formatter:te=>[te,"sis (feitos)"]}),a.jsx(U0,{type:"monotone",dataKey:"isis",name:"sis (feitos)",stroke:"var(--brand)",strokeWidth:2.2,dot:{r:3,strokeWidth:1.5,stroke:"var(--brand)",fill:"var(--background)"},activeDot:{r:5}})]})})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs(xr.div,{variants:V,className:"fx-card",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("h2",{className:"text-base font-bold text-text-primary",children:"Top quadras  ltimos 30 dias (sis)"})}),M.topQuadras30d.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Nenhum agendamento nos ltimos 30 dias."}):a.jsx("ul",{className:"divide-y divide-border",children:M.topQuadras30d.map(te=>a.jsxs("li",{className:"py-2 text-sm flex items-center justify-between",children:[a.jsx("span",{className:"font-medium",children:te.nome}),a.jsx("span",{className:"text-text-muted",children:te.count})]},te.id))})]}),a.jsxs(xr.div,{variants:V,className:"fx-card",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsx("h2",{className:"text-base font-bold text-text-primary",children:"Top modalidades  ltimos 30 dias (sis)"})}),!M.topModalidades30d||M.topModalidades30d.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem dados recentes."}):a.jsx("ul",{className:"divide-y divide-border",children:M.topModalidades30d.map((te,Y)=>a.jsxs("li",{className:"py-2 text-sm flex items-center justify-between",children:[a.jsx("span",{className:"font-medium",children:te.nome}),a.jsx("span",{className:"text-text-muted",children:te.count})]},`${te.nome}-${Y}`))})]})]})]}),!n&&a.jsxs(xr.div,{variants:V,className:"fx-card",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h2",{className:"text-sm sm:text-base font-bold text-text-primary",children:"ltimos agendamentos criados pela sis"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"hidden sm:flex items-center gap-2",children:[a.jsxs(vi,{children:[a.jsx(xi,{asChild:!0,children:a.jsxs(fe,{type:"button",variant:"ghost",className:"h-9 px-3 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 hover:border-white/20 transition-all duration-200 text-xs font-semibold text-text-primary",title:"Data incio (criado em)",children:[a.jsx(Bs,{className:"h-4 w-4 text-text-secondary"}),a.jsx("span",{children:f?X($(f)):"Incio"})]})}),a.jsx(ni,{className:"w-auto p-0",children:a.jsx(yi,{mode:"single",selected:$(f)||void 0,onSelect:te=>h(te?W(te):""),locale:na,initialFocus:!0})})]}),a.jsx("span",{className:"text-xs text-text-secondary select-none",children:"at"}),a.jsxs(vi,{children:[a.jsx(xi,{asChild:!0,children:a.jsxs(fe,{type:"button",variant:"ghost",className:"h-9 px-3 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 hover:border-white/20 transition-all duration-200 text-xs font-semibold text-text-primary",title:"Data fim (criado em)",children:[a.jsx(Bs,{className:"h-4 w-4 text-text-secondary"}),a.jsx("span",{children:m?X($(m)):"Fim"})]})}),a.jsx(ni,{className:"w-auto p-0",children:a.jsx(yi,{mode:"single",selected:$(m)||void 0,onSelect:te=>v(te?W(te):""),locale:na,initialFocus:!0})})]})]}),null]})]}),a.jsxs("div",{className:"sm:hidden mb-3 rounded-lg border border-white/10 bg-white/5 p-2",children:[a.jsxs("div",{className:"grid [grid-template-columns:1fr_auto_1fr] gap-2 mb-2",children:[a.jsxs(vi,{children:[a.jsx(xi,{asChild:!0,children:a.jsxs(fe,{type:"button",variant:"ghost",className:"w-full h-9 px-3 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 hover:border-white/20 transition-all duration-200 text-xs font-semibold text-text-primary justify-between",title:"Data incio (criado em)",children:[a.jsx(Bs,{className:"h-4 w-4 text-text-secondary"}),a.jsx("span",{className:"truncate",children:f?X($(f)):"Incio"})]})}),a.jsx(ni,{className:"w-auto p-0",children:a.jsx(yi,{mode:"single",selected:$(f)||void 0,onSelect:te=>h(te?W(te):""),locale:na,initialFocus:!0})})]}),a.jsx("div",{className:"flex items-center justify-center text-xs text-text-secondary select-none",children:"at"}),a.jsxs(vi,{children:[a.jsx(xi,{asChild:!0,children:a.jsxs(fe,{type:"button",variant:"ghost",className:"w-full h-9 px-3 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 hover:border-white/20 transition-all duration-200 text-xs font-semibold text-text-primary justify-between",title:"Data fim (criado em)",children:[a.jsx(Bs,{className:"h-4 w-4 text-text-secondary"}),a.jsx("span",{className:"truncate",children:m?X($(m)):"Fim"})]})}),a.jsx(ni,{className:"w-auto p-0",children:a.jsx(yi,{mode:"single",selected:$(m)||void 0,onSelect:te=>v(te?W(te):""),locale:na,initialFocus:!0})})]})]}),null]}),l?a.jsxs("div",{className:"flex items-center gap-2 text-text-muted text-sm py-6",children:[a.jsx(Tc,{className:"h-4 w-4 animate-spin"}),a.jsx("span",{children:"Carregando agendamentos..."})]}):d?a.jsx("div",{className:"text-danger text-sm",children:d}):M.ultimasInteracoes.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Nenhum agendamento recente."}):a.jsx("div",{className:"overflow-x-auto -mx-4 sm:mx-0",children:a.jsx("div",{className:"inline-block min-w-full align-middle",children:a.jsx("div",{className:"overflow-hidden",children:a.jsxs("table",{className:"min-w-full text-xs sm:text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"text-text-secondary border-b border-white/10",children:[a.jsx("th",{className:"w-8 py-2 pl-4 sm:pl-0"}),a.jsx("th",{className:"text-left py-2 pr-2 whitespace-nowrap",children:"Cdigo"}),a.jsx("th",{className:"text-left py-2 pr-2 whitespace-nowrap",children:"Cliente"}),a.jsx("th",{className:"text-left py-2 pr-2 whitespace-nowrap hidden sm:table-cell",children:"Quadra"}),a.jsx("th",{className:"text-left py-2 pr-2 whitespace-nowrap",children:"Data"}),a.jsx("th",{className:"text-left py-2 pr-2 whitespace-nowrap hidden md:table-cell",children:"Horrio"}),a.jsx("th",{className:"text-left py-2 pr-2 whitespace-nowrap",children:"Status"}),a.jsx("th",{className:"text-left py-2 pr-2 whitespace-nowrap hidden lg:table-cell",children:"Participantes"}),a.jsx("th",{className:"text-left py-2 pr-4 sm:pr-2 whitespace-nowrap hidden xl:table-cell",children:"Criado em"})]})}),a.jsx("tbody",{children:M.ultimasInteracoes.map(te=>{const Y=te.inicio?new Date(te.inicio):null,ce=te.fim?new Date(te.fim):null,me=Y?Y.toLocaleDateString():"-",ae=Y&&ce?`${Y.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})} - ${ce.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`:"-",le=Array.isArray(te.participantes)?te.participantes.length:Array.isArray(te.clientes)?te.clientes.length:0,ue=!!U[te.id],Re=()=>z(bt=>({...bt,[te.id]:!bt[te.id]})),ne=String(te.status||"").toLowerCase(),gt={scheduled:{label:"Agendado",cls:"bg-info/15 text-info border border-info/20"},confirmed:{label:"Confirmado",cls:"bg-success/15 text-success border border-success/20"},in_progress:{label:"Em andamento",cls:"bg-brand/15 text-brand border border-brand/20"},finished:{label:"Finalizado",cls:"bg-success/15 text-success border border-success/20"},canceled:{label:"Cancelado",cls:"bg-danger/15 text-danger border border-danger/20"},no_show:{label:"No-show",cls:"bg-warning/15 text-warning border border-warning/20"}}[ne]||{label:te.status||"",cls:"bg-white/10 text-text-secondary border border-white/15"};return a.jsxs(a.Fragment,{children:[a.jsxs("tr",{className:`border-b border-white/10 align-top ${ue?"bg-white/[0.03]":"hover:bg-white/[0.02]"} transition-colors`,children:[a.jsx("td",{className:"py-2 pl-4 sm:pl-0",children:a.jsx("button",{type:"button","aria-label":ue?"Recolher":"Expandir",onClick:bt=>{bt.stopPropagation(),Re()},className:`inline-flex items-center justify-center w-6 h-6 rounded-md border border-white/10 hover:bg-white/5 transition-colors ${ue?"rotate-180":""}`,children:a.jsx(Tg,{className:"w-3 h-3 sm:w-4 sm:h-4 text-text-secondary"})})}),a.jsxs("td",{className:"py-2 pr-2 font-semibold text-text-primary whitespace-nowrap",children:["#",te.codigo]}),a.jsx("td",{className:"py-2 pr-2 max-w-[120px] truncate",children:te.cliente_nome||Array.isArray(te.clientes)&&te.clientes[0]||""}),a.jsx("td",{className:"py-2 pr-2 hidden sm:table-cell max-w-[100px] truncate",children:te.quadra_nome||""}),a.jsx("td",{className:"py-2 pr-2 whitespace-nowrap",children:me}),a.jsx("td",{className:"py-2 pr-2 hidden md:table-cell whitespace-nowrap text-xs",children:ae}),a.jsx("td",{className:"py-2 pr-2",children:a.jsx("span",{className:`px-1.5 sm:px-2 py-0.5 rounded-full text-[10px] sm:text-[11px] font-bold tracking-wide whitespace-nowrap ${gt.cls}`,children:gt.label})}),a.jsx("td",{className:"py-2 pr-2 hidden lg:table-cell",children:a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white/10 text-text-primary text-xs font-semibold",children:[a.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-brand/70"}),le]})}),a.jsx("td",{className:"py-2 pr-4 sm:pr-2 hidden xl:table-cell text-xs whitespace-nowrap",children:te.criado_em?new Date(te.criado_em).toLocaleString():"-"})]},te.id),ue&&a.jsx("tr",{children:a.jsxs("td",{colSpan:9,className:"p-3 sm:p-4 bg-white/[0.035] border-b border-white/10",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-[10px] sm:text-[11px] uppercase tracking-wider text-text-muted",children:"Criado em"}),a.jsx("div",{className:"font-medium text-text-primary text-xs sm:text-sm",children:te.criado_em?new Date(te.criado_em).toLocaleString():"-"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[10px] sm:text-[11px] uppercase tracking-wider text-text-muted",children:"Incio"}),a.jsx("div",{className:"font-medium text-text-primary text-xs sm:text-sm",children:te.inicio?new Date(te.inicio).toLocaleString():"-"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[10px] sm:text-[11px] uppercase tracking-wider text-text-muted",children:"Trmino"}),a.jsx("div",{className:"font-medium text-text-primary text-xs sm:text-sm",children:te.fim?new Date(te.fim).toLocaleString():"-"})]})]}),a.jsxs("div",{className:"sm:hidden mb-3 grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wider text-text-muted",children:"Quadra"}),a.jsx("div",{className:"font-medium text-text-primary text-xs truncate",children:te.quadra_nome||""})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wider text-text-muted",children:"Horrio"}),a.jsx("div",{className:"font-medium text-text-primary text-xs",children:ae})]})]}),a.jsxs("div",{className:"text-[10px] sm:text-[11px] uppercase tracking-wider text-text-muted mb-2",children:["Participantes (",le,")"]}),Array.isArray(te.participantes)&&te.participantes.length>0?a.jsx("ul",{className:"grid grid-cols-1 gap-1.5",children:te.participantes.map((bt,at)=>a.jsxs("li",{className:"flex items-center justify-between py-1.5 px-2 sm:px-3 rounded-md border border-white/10 bg-white/5 gap-2",children:[a.jsx("span",{className:"text-text-primary font-medium text-xs sm:text-sm truncate flex-1",children:bt.nome}),a.jsx("span",{className:`px-1.5 sm:px-2 py-0.5 rounded-full text-[10px] sm:text-[11px] font-bold tracking-wide whitespace-nowrap flex-shrink-0 ${bt.status_pagamento==="Pago"?"bg-success/15 text-success border border-success/20":"bg-warning/15 text-warning border border-warning/20"}`,children:bt.status_pagamento})]},at))}):a.jsx("div",{className:"text-text-muted text-xs sm:text-sm",children:"Sem participantes cadastrados"})]})})]})})})]})})})})]}),g&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",onClick:()=>y(!1),children:a.jsxs(xr.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-surface border border-white/10 rounded-xl shadow-2xl w-full max-w-lg p-6 space-y-4",onClick:te=>te.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h2",{className:"text-xl font-bold text-text-primary flex items-center gap-2",children:[a.jsx(Ad,{className:"h-5 w-5 text-brand"})," Configuraes da sis"]}),a.jsx("button",{type:"button",onClick:()=>y(!1),className:"inline-flex items-center justify-center w-8 h-8 rounded-lg hover:bg-white/10 transition-colors text-text-secondary hover:text-text-primary",children:a.jsx(Qp,{className:"h-5 w-5"})})]}),x?a.jsxs("div",{className:"flex items-center gap-2 text-text-muted py-8 justify-center",children:[a.jsx(Tc,{className:"h-5 w-5 animate-spin"})," Carregando..."]}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"block text-sm font-semibold text-text-primary",children:"Cancelamento (horas antes)"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Tempo mnimo (em horas) antes do agendamento para permitir cancelamento via sis."}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("input",{type:"number",min:"0",step:"1",value:_,onChange:te=>S(te.target.value),placeholder:"Ex: 2",className:"w-24 px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-text-primary text-center placeholder:text-text-muted focus:outline-none focus:ring-2 focus:ring-brand/50 focus:border-brand transition-all"}),a.jsx("span",{className:"text-sm text-text-muted",children:"horas"})]}),a.jsx("p",{className:"text-xs text-text-muted italic",children:"Deixe vazio para permitir cancelamento a qualquer momento."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"block text-sm font-semibold text-text-primary",children:"Nome de exibio"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Nome que aparecer no header da pgina de agendamento da sis."}),a.jsx("input",{type:"text",value:A,onChange:te=>R(te.target.value),placeholder:"Arena Palace",className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-text-primary placeholder:text-text-muted focus:outline-none focus:ring-2 focus:ring-brand/50 focus:border-brand transition-all"}),a.jsx("p",{className:"text-xs text-text-muted italic",children:"Este  o nome que seus clientes vero ao acessar a sis."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"block text-sm font-semibold text-text-primary",children:"Link de agendamento"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Personalize o subdomnio do link de agendamento da sis."}),O?a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"text",value:C,onChange:te=>P(te.target.value.toLowerCase().replace(/[^a-z0-9]+/g,"")),placeholder:"arenapalace",autoFocus:!0,className:"flex-1 px-3 py-2 bg-white/5 border border-white/10 rounded-lg text-text-primary placeholder:text-text-muted focus:outline-none focus:ring-2 focus:ring-brand/50 focus:border-brand transition-all"}),a.jsx("span",{className:"text-sm text-text-muted",children:".f7arena.com"})]}):a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white/5 border border-white/10 rounded-lg group hover:border-white/20 transition-all cursor-pointer",onClick:()=>I(!0),children:[a.jsxs("span",{className:"flex-1 text-text-primary font-mono",children:[C||"arenapalace",".f7arena.com"]}),a.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-7 h-7 rounded-md hover:bg-white/10 transition-colors text-text-muted group-hover:text-text-primary",title:"Editar subdomnio",children:a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}),a.jsx("path",{d:"m15 5 4 4"})]})})]})]}),a.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>{y(!1),I(!1)},disabled:w,className:"flex-1 px-4 py-2 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 transition-colors text-text-secondary hover:text-text-primary font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancelar"}),a.jsx("button",{type:"button",onClick:ye,disabled:w,className:"flex-1 px-4 py-2 rounded-lg bg-brand hover:bg-brand/90 transition-colors text-white font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:w?a.jsxs(a.Fragment,{children:[a.jsx(Tc,{className:"h-4 w-4 animate-spin"})," Salvando..."]}):"Salvar"})]})]})]})})]})}function Wit({open:e,onOpenChange:t,codigoEmpresa:r,onSuccess:n}){const{toast:s}=Qa(),[o,i]=p.useState("upload"),[l,c]=p.useState(null),[d,u]=p.useState(null),[f,h]=p.useState(!1),[m,v]=p.useState({success:!1,comandaId:null,error:null}),g=async j=>{const _=j.target.files?.[0];if(_){if(!_.name.endsWith(".xml")){s({title:"Arquivo invlido",description:"Selecione um arquivo XML vlido.",variant:"destructive"});return}c(_);try{const S=await _.text(),C=zS(S);if(!C.success){s({title:"Erro ao ler XML",description:C.error||"XML invlido",variant:"destructive"});return}if(!C.produtos||C.produtos.length===0){s({title:"Nenhum produto encontrado",description:"O XML no contm produtos.",variant:"warning"});return}if(C.nfe?.tipo!=="Sada"){s({title:"Tipo de nota incorreto",description:"Este XML  de entrada. Use a importao em Produtos para notas de entrada.",variant:"warning"});return}u(C),i("preview")}catch(S){console.error("[XMLSalesImport] Erro ao processar arquivo:",S),s({title:"Erro ao processar XML",description:S.message,variant:"destructive"})}}},y=async()=>{i("processing"),h(!0);try{const j=await bu({searchTerm:"",limit:1e4,codigoEmpresa:r}),_=d.nfe?.dataEmissao?new Date(d.nfe.dataEmissao):new Date,S=d.nfe?.chaveAcesso||"",{data:C,error:P}=await de.from("comandas").insert({codigo_empresa:r,mesa_id:null,status:"closed",aberto_em:_.toISOString(),fechado_em:_.toISOString(),observacao:`Importado de XML - NF-e ${d.nfe?.numero||""}${S?`
Chave: ${S}`:""}`,origem:"xml",xml_chave:S||null}).select().single();if(P)throw P;const A=[],R=[];for(const I of d.produtos){const M=US(I,j);if(M){A.push({comanda_id:C.id,produto_id:M.id,descricao:I.nome,quantidade:I.quantidade,preco_unitario:I.valorUnitario,desconto:I.desconto||0,codigo_empresa:r});const D=Math.max(0,(M.stock||M.estoque||0)-I.quantidade);await de.from("produtos").update({estoque:D}).eq("id",M.id).eq("codigo_empresa",r)}else R.push(I.nome)}if(A.length>0){const{error:I}=await de.from("comanda_itens").insert(A);if(I)throw I}const O=d.pagamentos||[];if(O.length>0){const{data:I}=await de.from("finalizadoras").select("id, codigo_sefaz, nome").eq("codigo_empresa",r).eq("ativo",!0),M=new Map((I||[]).map(z=>[z.codigo_sefaz,z])),D=O.map(z=>{const W=M.get(z.codigoSefaz);return{comanda_id:C.id,finalizadora_id:W?.id||null,metodo:z.descricao.toLowerCase(),valor:z.valor,status:"Pago",recebido_em:_.toISOString(),codigo_empresa:r,origem:"xml",xml_chave:S||null}}),{error:U}=await de.from("pagamentos").insert(D);if(U)throw U}else{const I=d.produtos.reduce((D,U)=>D+(U.valorTotal||0),0),{error:M}=await de.from("pagamentos").insert({comanda_id:C.id,finalizadora_id:null,metodo:"outros",valor:I,status:"Pago",recebido_em:_.toISOString(),codigo_empresa:r,origem:"xml",xml_chave:S||null});if(M)throw M}console.log("[XMLSalesImport] Venda importada com sucesso. Comanda ID:",C.id),R.length>0?s({title:"Venda importada com avisos",description:`${A.length} produto(s) registrado(s), ${R.length} no encontrado(s).`,variant:"warning",duration:5e3}):s({title:"Venda importada com sucesso!",description:`${A.length} produto(s) registrado(s). Total: R$ ${w.toFixed(2)}`,variant:"success"}),v({success:!0,comandaId:C.id,error:null,produtosNaoEncontrados:R,totalItens:A.length,totalVenda:w,dataEmissao:_.toISOString().slice(0,10)}),i("done"),n&&n(_.toISOString().slice(0,10))}catch(j){console.error("[XMLSalesImport] Erro ao importar:",j),v({success:!1,comandaId:null,error:j.message}),i("done"),s({title:"Erro ao importar XML",description:j.message,variant:"destructive"})}finally{h(!1)}},x=()=>{i("upload"),c(null),u(null),v({success:!1,comandaId:null,error:null}),t(!1)},b=()=>{i("upload"),c(null),u(null)},w=d?.produtos?.reduce((j,_)=>j+(_.valorTotal||0),0)||0;return a.jsx(mn,{open:e,onOpenChange:t,children:a.jsxs(un,{className:"max-w-3xl max-h-[90vh] flex flex-col overflow-hidden",children:[a.jsxs(on,{children:[a.jsx(an,{className:"text-2xl font-bold",children:"Importar XML de Venda (NF-e)"}),a.jsxs(Nn,{children:[o==="upload"&&"Selecione o arquivo XML da nota fiscal de sada",o==="preview"&&"Revise os dados da venda que ser importada",o==="processing"&&"Processando venda...",o==="done"&&"Importao finalizada"]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto px-1",children:[o==="upload"&&a.jsx("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:a.jsxs("div",{className:"w-full max-w-md",children:[a.jsxs("label",{htmlFor:"xml-sales-upload",className:"flex flex-col items-center justify-center w-full h-64 border-2 border-dashed border-border rounded-lg cursor-pointer bg-surface hover:bg-surface-2 transition-colors",children:[a.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[a.jsx(P4,{className:"w-12 h-12 mb-4 text-text-muted"}),a.jsx("p",{className:"mb-2 text-sm text-text-primary font-semibold",children:"Clique para selecionar ou arraste o arquivo"}),a.jsx("p",{className:"text-xs text-text-muted",children:"XML de NF-e de Sada (Venda)"})]}),a.jsx("input",{id:"xml-sales-upload",type:"file",accept:".xml",className:"hidden",onChange:g})]}),l&&a.jsxs("div",{className:"mt-4 p-3 bg-surface-2 rounded-lg flex items-center gap-2",children:[a.jsx(Zo,{className:"w-5 h-5 text-success"}),a.jsx("span",{className:"text-sm text-text-primary",children:l.name})]})]})}),o==="preview"&&a.jsxs("div",{className:"space-y-4",children:[d?.nfe&&a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsx("h3",{className:"font-semibold mb-3",children:"Informaes da NF-e"}),d.fornecedor&&a.jsxs("div",{className:"mb-3 pb-3 border-b border-border",children:[a.jsx("div",{className:"text-sm font-semibold text-text-primary mb-1",children:d.fornecedor.razaoSocial||d.fornecedor.nomeFantasia||"Fornecedor"}),a.jsxs("div",{className:"text-xs text-text-muted",children:[d.fornecedor.cnpj&&`CNPJ: ${d.fornecedor.cnpj}`,d.fornecedor.endereco?.cidade&&d.fornecedor.endereco?.uf&&`  ${d.fornecedor.endereco.cidade}/${d.fornecedor.endereco.uf}`]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-3",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Nmero:"})," ",a.jsx("span",{className:"font-mono",children:d.nfe.numero})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Srie:"})," ",a.jsx("span",{className:"font-mono",children:d.nfe.serie})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Tipo:"})," ",a.jsx("span",{className:"text-warning font-semibold",children:d.nfe.tipo})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-text-muted",children:"Data:"})," ",a.jsx("span",{children:new Date(d.nfe.dataEmissao).toLocaleDateString("pt-BR")})]})]}),d.nfe.naturezaOperacao&&a.jsxs("div",{className:"mb-2 text-sm",children:[a.jsx("span",{className:"text-text-muted",children:"Natureza:"})," ",a.jsx("span",{className:"font-medium",children:d.nfe.naturezaOperacao})]}),d.nfe.totalNota!==void 0&&a.jsxs("div",{className:"mb-3 text-sm",children:[a.jsx("span",{className:"text-text-muted",children:"Total da Nota:"})," ",a.jsxs("span",{className:"font-mono font-semibold text-lg text-success",children:["R$ ",d.nfe.totalNota.toFixed(2)]})]}),d.nfe.chaveAcesso&&a.jsxs("div",{className:"mt-3 pt-3 border-t border-border",children:[a.jsx("span",{className:"text-text-muted text-xs",children:"Chave de Acesso:"}),a.jsx("p",{className:"font-mono text-xs break-all",children:d.nfe.chaveAcesso})]})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsxs("h3",{className:"font-semibold mb-3",children:["Produtos da Venda (",d.produtos.length,")"]}),a.jsx("div",{className:"space-y-2",children:d.produtos.map((j,_)=>a.jsxs("div",{className:"p-3 rounded-lg border border-border bg-surface flex items-start gap-3",children:[a.jsx(y1,{className:"w-5 h-5 text-warning flex-shrink-0 mt-0.5"}),a.jsx("div",{className:"flex-1 min-w-0",children:a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"font-semibold text-sm truncate",children:j.nome}),a.jsxs("p",{className:"text-xs text-text-muted",children:[j.codigo&&`Cdigo: ${j.codigo}  `,"Qtd: ",j.quantidade," ",j.unidade]})]}),a.jsxs("div",{className:"text-right flex-shrink-0",children:[a.jsxs("p",{className:"text-sm font-semibold",children:["R$ ",j.valorTotal.toFixed(2)]}),a.jsxs("p",{className:"text-xs text-text-muted",children:["Unit: R$ ",j.valorUnitario.toFixed(2)]})]})]})})]},_))})]}),d.pagamentos&&d.pagamentos.length>0&&a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsxs("h3",{className:"font-semibold mb-3",children:["Formas de Pagamento (",d.pagamentos.length,")"]}),a.jsx("div",{className:"space-y-2",children:d.pagamentos.map((j,_)=>a.jsxs("div",{className:"p-3 rounded-lg border border-border bg-surface flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-sm",children:j.descricao}),a.jsxs("p",{className:"text-xs text-text-muted",children:["Cdigo SEFAZ: ",j.codigoSefaz]})]}),a.jsxs("p",{className:"text-sm font-semibold",children:["R$ ",j.valor.toFixed(2)]})]},_))})]}),a.jsx("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Bc,{className:"w-5 h-5 text-warning flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-sm mb-1",children:"Ateno: Venda Externa"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Esta venda ser registrada no histrico como uma venda externa (importada de XML). O estoque dos produtos ser subtrado automaticamente."})]})]})}),a.jsxs("div",{className:"flex items-center justify-between text-lg font-bold",children:[a.jsx("span",{children:"Total da Venda:"}),a.jsxs("span",{className:"text-success",children:["R$ ",w.toFixed(2)]})]})]}),o==="processing"&&a.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[a.jsx(Tc,{className:"w-12 h-12 animate-spin text-warning mb-4"}),a.jsx("p",{className:"text-lg font-semibold",children:"Processando venda..."}),a.jsx("p",{className:"text-sm text-text-muted",children:"Criando comanda e atualizando estoque"})]}),o==="done"&&a.jsx("div",{className:"space-y-4",children:a.jsx("div",{className:"bg-surface-2 rounded-lg p-6 border border-border text-center",children:m.success?a.jsxs(a.Fragment,{children:[a.jsx(Ro,{className:"w-16 h-16 text-success mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-bold mb-2",children:"Venda Importada com Sucesso!"}),a.jsx("p",{className:"text-sm text-text-muted mb-4",children:"A venda foi registrada no histrico"}),m.produtosNaoEncontrados&&m.produtosNaoEncontrados.length>0&&a.jsxs("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-3 text-left",children:[a.jsx("p",{className:"text-sm font-semibold mb-2",children:" Produtos no encontrados:"}),a.jsx("ul",{className:"text-xs text-text-muted space-y-1",children:m.produtosNaoEncontrados.map((j,_)=>a.jsxs("li",{children:[" ",j]},_))})]})]}):a.jsxs(a.Fragment,{children:[a.jsx(Bc,{className:"w-16 h-16 text-danger mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-bold mb-2",children:"Erro na Importao"}),a.jsx("p",{className:"text-sm text-text-muted",children:m.error||"Ocorreu um erro ao importar a venda"})]})})})]}),a.jsxs(Qn,{children:[o==="upload"&&a.jsx(fe,{variant:"outline",onClick:x,children:"Cancelar"}),o==="preview"&&a.jsxs(a.Fragment,{children:[a.jsx(fe,{variant:"outline",onClick:b,children:"Voltar"}),a.jsx(fe,{onClick:y,children:"Confirmar Importao"})]}),o==="done"&&a.jsx(fe,{onClick:x,children:"Fechar"})]})]})})}const Hit={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},Dy={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}};function Git(e,t=300){const[r,n]=p.useState(e);return p.useEffect(()=>{const s=setTimeout(()=>n(e),t);return()=>clearTimeout(s)},[e,t]),r}function $j({value:e,onChange:t}){const[r,n]=p.useState(!1),s=p.useRef(null),o=p.useRef(null),i=p.useRef(null),[l,c]=p.useState({top:0,left:0,width:0,center:!1,mode:"fixed"});p.useEffect(()=>{function g(b){const w=b.target,j=s.current&&s.current.contains(w),_=i.current&&i.current.contains(w);!j&&!_&&n(!1)}function y(b){b.key==="Escape"&&n(!1)}function x(){r&&d()}return window.addEventListener("mousedown",g),window.addEventListener("keydown",y),window.addEventListener("scroll",x,!0),window.addEventListener("resize",x),()=>{window.removeEventListener("mousedown",g),window.removeEventListener("keydown",y),window.removeEventListener("scroll",x,!0),window.removeEventListener("resize",x)}},[r]),p.useEffect(()=>{if(r){const g=requestAnimationFrame(()=>{d();const y=requestAnimationFrame(()=>d());return()=>cancelAnimationFrame(y)});return()=>cancelAnimationFrame(g)}},[r]),p.useEffect(()=>{if(r&&l.mode==="overlay"){const g=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=g}}},[r,l.mode]);const d=()=>{try{const g=o.current;if(!g)return;const y=g.getBoundingClientRect(),x=window.innerWidth,b=window.innerHeight,w=8,j=Math.max(y.width,280),_=Math.min(x-w*2,360),S=Math.min(j,_);let C=320;if(i.current)try{C=i.current.getBoundingClientRect().height||C}catch{}if(x<=640){c({top:0,left:0,width:Math.min(x-w*2,360),center:!0,mode:"overlay"});return}const P=s.current,A=P?P.getBoundingClientRect():y,R=y.bottom-A.top+6,O=Math.max(y.width,280);c({top:R,left:0,width:O,center:!1,mode:"anchor"})}catch{}},u=g=>{try{const[y,x,b]=String(g||"").split("-").map(Number);return!y||!x||!b?null:new Date(y,x-1,b)}catch{return null}},f=g=>{const y=x=>String(x).padStart(2,"0");return`${g.getFullYear()}-${y(g.getMonth()+1)}-${y(g.getDate())}`},h=g=>{const y=x=>String(x).padStart(2,"0");return`${y(g.getDate())}/${y(g.getMonth()+1)}/${g.getFullYear()}`},m=u(e),v=m?h(m):"";return a.jsxs("div",{className:"relative",ref:s,children:[a.jsx("button",{type:"button",className:"absolute left-2 top-1/2 -translate-y-1/2 p-1 rounded hover:bg-warning/10 focus:outline-none",onMouseDown:g=>{g.preventDefault()},onClick:()=>{n(g=>!g),setTimeout(d,0)},"aria-label":"Abrir calendrio",children:a.jsx(yue,{className:"h-4 w-4 text-warning"})}),typeof window<"u"&&window.innerWidth<=640?a.jsx("button",{type:"button",ref:o,onMouseDown:g=>{g.preventDefault()},onClick:()=>{n(!0),setTimeout(d,0)},className:"pl-9 pr-3 h-10 w-full text-left bg-surface text-text-primary border border-warning/40 rounded-md",children:v||"Selecionar data"}):a.jsx(rt,{type:"text",readOnly:!0,ref:o,inputMode:"none",onMouseDown:g=>{g.preventDefault()},onClick:()=>{n(g=>!g),setTimeout(d,0)},className:"pl-9 pr-3 w-full bg-surface text-text-primary border border-warning/40 focus-visible:ring-warning focus-visible:border-warning",value:v}),r&&(l.mode==="overlay"?a.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/50",onClick:g=>{g.target===g.currentTarget&&n(!1)},children:a.jsx("div",{ref:i,className:"bg-black text-white border border-warning/40 rounded-md shadow-xl p-2 w-[92vw] max-w-[360px]",children:a.jsx(yi,{mode:"single",selected:m||void 0,onSelect:g=>{g&&(t(f(g)),n(!1))},showOutsideDays:!0,className:"",classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md",table:"w-full"}})})}):l.mode==="anchor"?a.jsx("div",{ref:i,className:"absolute z-[999] bg-black text-white border border-warning/40 rounded-md shadow-xl p-2 left-0",style:{top:`${l.top}px`,minWidth:`${l.width}px`,maxWidth:"92vw"},children:a.jsx(yi,{mode:"single",selected:m||void 0,onSelect:g=>{g&&(t(f(g)),n(!1))},showOutsideDays:!0,className:"",classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md",table:"w-full"}})}):a.jsx("div",{ref:i,className:"fixed z-[999] bg-black text-white border border-warning/40 rounded-md shadow-xl p-2",style:{top:`${l.top}px`,left:`${l.left}px`,width:`${l.width}px`,maxWidth:"92vw"},children:a.jsx(yi,{mode:"single",selected:m||void 0,onSelect:g=>{g&&(t(f(g)),n(!1))},showOutsideDays:!0,className:"",classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md",table:"w-full"}})}))]})}function Kit(){const{toast:e}=Qa(),t=zi(),{userProfile:r}=ms(),[n]=hC(),s=n.get("mesa"),[o,i]=p.useState(!1),[l,c]=p.useState([]),[d,u]=p.useState(()=>s?"":new Date().toISOString().slice(0,10)),[f,h]=p.useState(()=>s?"":new Date().toISOString().slice(0,10)),[m,v]=p.useState(()=>s?"all":"closed"),[g,y]=p.useState(""),x=Git(g,350),[b,w]=p.useState("all"),[j,_]=p.useState("comandas"),[S,C]=p.useState(!1),[P,A]=p.useState(""),[R,O]=p.useState(null),[I,M]=p.useState({loading:!1,itens:[],pagamentos:[]}),[D,U]=p.useState(null),[z,W]=p.useState({open:!1,loading:!1,resumo:null,periodo:{from:null,to:null},movs:[]}),[$,X]=p.useState(!1),[ye,Se]=p.useState(!1),[V,B]=p.useState(null),[Q,pe]=p.useState([]),te=async Me=>{try{Se(!0);const dt=Ct();if(!dt)throw new Error("Empresa no detectada");const{payload:ut,missing:rr}=await Iv({comandaId:Me,codigoEmpresa:dt});B(ut),pe(rr||[]),X(!0)}catch(dt){e({title:"Falha ao gerar prvia",description:dt?.message||"Tente novamente",variant:"destructive"})}finally{Se(!1)}},[Y,ce]=p.useState(!1),[me,ae]=p.useState(!1),[le,ue]=p.useState(!1),Re=async()=>{try{e({title:"Gerando CSV...",description:"Aguarde enquanto preparamos o arquivo",variant:"default"});const Me=await bz({status:m,from:d||void 0,to:f||void 0,search:x||"",limit:1e4,offset:0});if(!Me||Me.length===0){e({title:"Nenhum dado para exportar",variant:"warning"});return}const dt=Me.map(Be=>Be.id),ut=await NS(dt,r?.codigo_empresa),rr=await rh(r?.codigo_empresa),hr=new Map(rr.map(Be=>[Be.id,Be.numero])),It=await RT(dt),dr=await LT(dt),ur=Me.map(Be=>{const et=Be.mesa_id?`Mesa ${hr.get(Be.mesa_id)||"?"}`:"Balco",jt=It[Be.id]||"Sem cliente",yt=dr[Be.id],qt=Array.isArray(yt)?yt.join(", "):yt||"No informado",pt=Be.fechado_em?"Fechada":"Aberta";return{Tipo:Be.tipo==="balcao"?"Balco":"Mesa","Mesa/Local":et,"Cliente(s)":jt,Status:pt,Abertura:new Date(Be.aberto_em).toLocaleString("pt-BR"),Fechamento:Be.fechado_em?new Date(Be.fechado_em).toLocaleString("pt-BR"):"-","Total (R$)":Number(ut[Be.id]||0).toFixed(2),"Forma(s) Pagamento":qt,Observaes:Be.observacao||"-"}}),er=Object.keys(ur[0]),ln=[er.join(";"),...ur.map(Be=>er.map(et=>{const jt=Be[et]||"";return`"${String(jt).replace(/"/g,'""')}"`}).join(";"))].join(`
`),Mr=new Blob(["\uFEFF"+ln],{type:"text/csv;charset=utf-8;"}),Ye=document.createElement("a"),$e=URL.createObjectURL(Mr);Ye.setAttribute("href",$e),Ye.setAttribute("download",`historico_comandas_${new Date().toISOString().slice(0,10)}.csv`),Ye.style.visibility="hidden",document.body.appendChild(Ye),Ye.click(),document.body.removeChild(Ye),e({title:"CSV exportado!",description:`${ur.length} comandas exportadas`,variant:"success"})}catch(Me){console.error("Erro ao exportar CSV:",Me),e({title:"Erro ao exportar",description:Me.message,variant:"destructive"})}},ne=async()=>{try{if(e({title:"Gerando CSV...",description:"Aguarde enquanto preparamos o arquivo",variant:"default"}),!l||l.length===0){e({title:"Nenhum dado para exportar",variant:"warning"});return}const Me=l.map(dr=>{const ur=dr.status==="open"?"Aberto":dr.status==="closed"?"Fechado":dr.status;return{"Data Abertura":dr.aberto_em?new Date(dr.aberto_em).toLocaleString("pt-BR"):"-","Data Fechamento":dr.fechado_em?new Date(dr.fechado_em).toLocaleString("pt-BR"):"-",Status:ur,"Saldo Inicial (R$)":Number(dr.saldo_inicial||0).toFixed(2),"Saldo Final (R$)":Number(dr.saldo_final||0).toFixed(2),"Valor Contado (R$)":dr.valor_final_dinheiro?Number(dr.valor_final_dinheiro).toFixed(2):"-","Diferena (R$)":dr.diferenca_dinheiro?Number(dr.diferenca_dinheiro).toFixed(2):"-"}}),dt=Object.keys(Me[0]),ut=[dt.join(";"),...Me.map(dr=>dt.map(ur=>{const er=dr[ur]||"";return`"${String(er).replace(/"/g,'""')}"`}).join(";"))].join(`
`),rr=new Blob(["\uFEFF"+ut],{type:"text/csv;charset=utf-8;"}),hr=document.createElement("a"),It=URL.createObjectURL(rr);hr.setAttribute("href",It),hr.setAttribute("download",`fechamentos_caixa_${new Date().toISOString().slice(0,10)}.csv`),hr.style.visibility="hidden",document.body.appendChild(hr),hr.click(),document.body.removeChild(hr),e({title:"CSV exportado!",description:`${Me.length} fechamentos exportados`,variant:"success"})}catch(Me){console.error("Erro ao exportar CSV:",Me),e({title:"Erro ao exportar",description:Me.message,variant:"destructive"})}},ie=100,[gt,bt]=p.useState(0),[at,xt]=p.useState(!1),Ze=p.useRef(!1),ht=p.useRef(0),Wt=p.useRef(0),be=p.useRef(!1),Ct=()=>{try{const Me=localStorage.getItem("auth:userProfile");return Me&&JSON.parse(Me)?.codigo_empresa||null}catch{return null}},wt=p.useMemo(()=>`hist:comandas:${Ct()||"na"}:${d}:${f}:${m}:${b}:${(x||"").trim()}`,[d,f,m,b,x]),Ge=async({append:Me=!1,skipCacheWrite:dt=!1}={})=>{try{i(!0);const ut=Ct();if(!ut){i(!1);return}const rr=setTimeout(()=>i(!1),1e4);if(j==="comandas"){const hr=!!(x&&x.trim()),It=hr?1e3:ie,dr=hr?0:gt;console.log("[HistoricoComandasPage] Carregando com:",{status:m,from:d,to:f,search:x,mesaId:s,searching:hr,effLimit:It});const ur=await bz({status:m,from:d,to:f,search:s||x,limit:It,offset:dr});console.log("[HistoricoComandasPage] Resultado:",ur?.length||0,"comandas");const er=(ur||[]).map(jt=>jt.id);let ln={};if(er.length>0)try{ln=await NS(er,ut)}catch{ln={}}let Mr=[];try{Mr=await rh(ut)}catch{Mr=[]}const Ye=new Map((Mr||[]).map(jt=>[jt.id,jt.numero]));let $e={},Be={};try{$e=await RT(er)}catch{$e={}}try{Be=await LT(er)}catch{Be={}}const et=(ur||[]).map(jt=>{const yt=$e[jt.id],qt=Be[jt.id];return{...jt,statusDerived:jt.status==="cancelled"?"cancelled":jt.fechado_em?"closed":jt.status||"open",total:Number(ln[jt.id]||0),mesaNumero:Ye.get(jt.mesa_id),clientesStr:Array.isArray(yt)?yt.join(", "):yt||"",finalizadorasStr:Array.isArray(qt)?qt.join(", "):qt||""}});if(xt(hr?!1:(ur||[]).length===ie),c(Me?jt=>[...jt,...et]:et),!dt)try{localStorage.setItem(wt,JSON.stringify({ts:Date.now(),rows:et}))}catch{}}else{const hr=await qre({from:d,to:f,limit:100,offset:0,codigoEmpresa:ut});c(hr||[])}clearTimeout(rr)}catch(ut){e({title:"Falha ao carregar histrico",description:ut?.message||"Tente novamente",variant:"destructive"})}finally{i(!1),ht.current=Date.now()}};p.useEffect(()=>{s&&(async()=>{try{const ut=(await rh(r?.codigo_empresa)||[]).find(rr=>rr.id===s);ut&&A(`Mesa ${ut.numero}`)}catch{}})()},[s,r?.codigo_empresa]),p.useEffect(()=>{if(Ze.current=!0,j==="comandas")try{const Me=localStorage.getItem(wt);if(Me){const dt=JSON.parse(Me);dt&&Array.isArray(dt.rows)&&Date.now()-Number(dt.ts||0)<12e4&&c(dt.rows)}}catch{}return()=>{Ze.current=!1}},[wt,j]),p.useEffect(()=>{j==="comandas"&&(bt(0),xt(!1)),Ge({append:!1})},[m,x,d,f,j]),p.useEffect(()=>{if(!o&&j==="comandas"&&l.length===0){const Me=setTimeout(()=>{Ze.current&&Ge({append:!1,skipCacheWrite:!1})},1500);return()=>clearTimeout(Me)}},[l.length,o,j]),p.useEffect(()=>{const Me=()=>{document.visibilityState==="visible"&&Date.now()-(ht.current||0)>3e4&&Ge({append:!1})},dt=()=>{Date.now()-(ht.current||0)>3e4&&Ge({append:!1})};return window.addEventListener("visibilitychange",Me),window.addEventListener("focus",dt),()=>{window.removeEventListener("visibilitychange",Me),window.removeEventListener("focus",dt)}},[wt,j]);const Je=async Me=>{O(Me),M({loading:!0,itens:[],pagamentos:[]});const dt=Ct();be.current=!0;const ut=++Wt.current,rr=setTimeout(()=>{Wt.current===ut&&be.current&&M(hr=>({...hr,loading:!1}))},1e4);if(!dt){clearTimeout(rr),Wt.current===ut&&be.current&&M({loading:!1,itens:[],pagamentos:[]});return}try{const hr=(l||[]).find(It=>It.id===Me)||null;if(hr){const It=hr.mesa_id==null?"Balco":hr.mesaNumero!=null?`Mesa ${hr.mesaNumero}`:"Comanda";U({mesaLabel:It,clientesStr:hr.clientesStr||"",aberto_em:hr.aberto_em||null,fechado_em:hr.fechado_em||null,tipo:hr.mesa_id==null?"balcao":"comanda",status:hr.statusDerived||hr.status||"open",diferenca_pagamento:typeof hr.diferenca_pagamento=="number"?hr.diferenca_pagamento:0})}else U(null)}catch{U(null)}try{const hr=async()=>{const[dr,ur]=await Promise.all([io({comandaId:Me,codigoEmpresa:dt}),$re({comandaId:Me,codigoEmpresa:dt})]);let er=[];try{er=await ui({comandaId:Me,codigoEmpresa:dt})}catch{}console.log("[openDetail] clientesVinc:",er);const ln=new Map((er||[]).map($e=>{const Be=$e?.cliente_id??$e?.clientes?.id??null,et=$e?.clientes?.nome??$e?.nome??$e?.nome_livre??"";return console.log(`[openDetail] Mapeando cliente: cid=${Be}, nome=${et}`),Be?[String(Be),et]:null}).filter(Boolean));console.log("[openDetail] nomeById map:",Array.from(ln.entries()));const Mr=[...Array.from(ln.values()),...(er||[]).filter($e=>!$e?.cliente_id&&($e?.nome_livre||$e?.nome)).map($e=>$e?.nome_livre||$e?.nome||"Consumidor")];console.log("[openDetail] clientesDisponiveis:",Mr),console.log("[openDetail] pagamentos:",ur);const Ye=(ur||[]).map(($e,Be)=>{let et="";return $e?.cliente_id?(et=ln.get(String($e.cliente_id))||"",!et&&Mr.length>0&&(et=Mr[Be%Mr.length])):Mr.length>0&&(et=Mr[Be%Mr.length]),console.log(`[openDetail] Pagamento ${Be}: cliente_id=${$e?.cliente_id}, clienteNome=${et}`),{...$e,cliente_nome:et,finalizadora_nome:$e?.finalizadoras?.nome||$e?.metodo||""}});return{itens:dr||[],pagamentos:Ye}};let It=await hr();It.itens.length===0&&It.pagamentos.length===0&&(await new Promise(dr=>setTimeout(dr,700)),It=await hr()),Wt.current===ut&&be.current&&M({loading:!1,itens:It.itens,pagamentos:It.pagamentos})}catch(hr){Wt.current===ut&&be.current&&M({loading:!1,itens:[],pagamentos:[]}),e({title:"Falha ao carregar detalhes",description:hr?.message||"Tente novamente",variant:"destructive"})}finally{clearTimeout(rr),Wt.current===ut&&be.current&&M(hr=>({...hr,loading:!1}))}},_e=p.useMemo(()=>({sum:l.reduce((dt,ut)=>dt+Number(ut.total||0),0)}),[l]),je=Me=>(Me||"").toString().toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,""),Ue=p.useMemo(()=>{const Me=(x||"").trim(),dt=je(Me),rr=l.filter(hr=>{const It=hr.mesa_id==null;return!(b==="balcao"&&!It||b==="comanda"&&It)}).filter(hr=>{const It=hr.statusDerived||(hr.status==="cancelled"?"cancelled":hr.fechado_em?"closed":hr.status||"open");return m==="closed"?It==="closed":m==="open"?It==="open":m==="awaiting-payment"?It==="awaiting-payment":m==="cancelled"?It==="cancelled":!0});return dt?rr.filter(hr=>{const It=hr.mesaNumero!=null?String(hr.mesaNumero):"",dr=hr.mesa_id==null?"balcao":`mesa ${It}`;return[It,dr,hr.clientesStr||"",hr.finalizadorasStr||"",hr.mesa_id==null?"balcao":"comanda",hr.statusDerived||hr.status||""].map(je).join(" | ").includes(dt)}):rr},[l,x,b,m]),ze=Me=>Me==="open"?"Aberta":Me==="awaiting-payment"?"Pagamento":Me==="closed"?"Fechada":Me==="cancelled"?"Cancelada":Me||"",or=Me=>{if(!Me)return"";try{return new Date(Me).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return""}},tr=Me=>{const dt=String(Me||"").toLowerCase();return dt==="open"?"Aberto":dt==="closed"?"Fechado":""},Nt=Me=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(Me||0)),yr=Me=>Me==="open"?"text-info bg-info/10 border-info/30":Me==="awaiting-payment"?"text-warning bg-warning/10 border-warning/30":Me==="closed"?"text-success bg-success/10 border-success/30":Me==="cancelled"?"text-red-400 bg-red-500/10 border-red-500/30":"text-text-secondary bg-transparent border-border/50";return a.jsxs(xr.div,{variants:Hit,initial:"hidden",animate:"visible",className:"min-h-screen flex flex-col",children:[a.jsxs(xr.div,{variants:Dy,className:"mb-6 gap-3 flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[a.jsx(Mc,{value:"historico",onValueChange:Me=>{Me==="mesas"&&t("/vendas"),Me==="balcao"&&t("/balcao"),Me==="historico"&&t("/historico")},children:a.jsxs(rc,{className:"grid w-full sm:w-auto grid-cols-3 sm:inline-flex",children:[a.jsx(sa,{value:"mesas",children:"Mesas"}),a.jsx(sa,{value:"balcao",children:"Balco"}),a.jsx(sa,{value:"historico",children:"Histrico"})]})}),a.jsxs("div",{className:"w-full flex items-center gap-2 sm:gap-3",children:[a.jsxs("div",{className:"flex sm:hidden items-center gap-2 w-full",children:[a.jsxs(vn,{value:j,onValueChange:_,children:[a.jsx(hn,{className:"w-[160px] text-sm",children:a.jsx(wn,{placeholder:"Selecionar"})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"comandas",children:"Comandas"}),a.jsx(ct,{value:"fechamentos",children:"Fechamentos"})]})]}),a.jsxs("div",{className:"ml-auto text-xs text-text-secondary whitespace-nowrap",children:["Total: ",a.jsxs("span",{className:"font-semibold text-text-primary",children:["R$ ",_e.sum.toFixed(2)]})]}),j==="comandas"&&a.jsx(fe,{type:"button",size:"icon",variant:"outline",className:"h-9 w-9 sm:hidden",onClick:()=>ae(!0),title:"Aes",children:a.jsx(uo,{className:"h-4 w-4"})}),j==="fechamentos"&&a.jsx(fe,{type:"button",size:"icon",variant:"outline",className:"h-9 w-9 sm:hidden",onClick:ne,title:"Exportar",children:a.jsx(uo,{className:"h-4 w-4"})})]}),a.jsx("div",{className:"hidden sm:flex items-center gap-2 sm:gap-3 ml-auto",children:a.jsx(Mc,{value:j,onValueChange:_,className:"w-full sm:w-auto",children:a.jsxs(rc,{className:"w-full grid grid-cols-2 sm:w-auto sm:inline-flex text-sm",children:[a.jsx(sa,{value:"comandas",className:"text-sm",children:"Comandas"}),a.jsx(sa,{value:"fechamentos",className:"text-sm",children:"Fechamentos"})]})})})]}),a.jsxs("div",{className:"hidden sm:flex w-full sm:w-auto items-center gap-2 sm:gap-3",children:[j==="comandas"&&a.jsxs(a.Fragment,{children:[a.jsxs(fe,{variant:"secondary",size:"sm",className:"hidden sm:inline-flex",onClick:()=>ce(!0),children:[a.jsx(Zo,{className:"mr-2 h-4 w-4"}),"Importar XML"]}),a.jsxs(fe,{variant:"outline",size:"sm",className:"hidden sm:inline-flex",onClick:Re,children:[a.jsx(uo,{className:"mr-1 h-3 w-3"}),"Exportar"]}),a.jsx("button",{className:"hidden sm:inline-block text-xs text-text-muted hover:text-text-primary transition-colors",onClick:()=>{if(le){const Me=new Date().toISOString().slice(0,10);u(Me),h(Me),ue(!1)}else u(""),h(""),ue(!0);bt(0)},title:le?"Voltar ao filtro de hoje":"Mostrar todas as comandas",children:le?"":""}),a.jsxs("div",{className:"text-sm text-text-secondary whitespace-nowrap ml-auto",children:["Total: ",a.jsxs("span",{className:"font-semibold text-text-primary",children:["R$ ",_e.sum.toFixed(2)]})]})]}),j==="fechamentos"&&a.jsxs(fe,{variant:"outline",size:"sm",className:"hidden sm:inline-flex",onClick:ne,children:[a.jsx(uo,{className:"mr-1 h-3 w-3"}),"Exportar"]})]})]}),a.jsx(mn,{open:me,onOpenChange:ae,children:a.jsxs(un,{className:"sm:hidden w-[92vw] max-w-[360px] p-2",onOpenAutoFocus:Me=>Me.preventDefault(),onKeyDown:Me=>Me.stopPropagation(),children:[a.jsxs(on,{children:[a.jsx(an,{className:"text-base",children:"Aes"}),a.jsx(Nn,{children:"Escolha uma ao para Comandas"})]}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsxs(fe,{variant:"secondary",onClick:()=>{ae(!1),ce(!0)},children:[a.jsx(Zo,{className:"mr-2 h-4 w-4"})," Importar XML"]}),a.jsxs(fe,{variant:"outline",onClick:()=>{ae(!1),Re()},children:[a.jsx(uo,{className:"mr-2 h-4 w-4"})," Exportar CSV"]})]})]})}),j==="comandas"&&a.jsxs("div",{className:"flex items-center justify-between mt-2",children:[a.jsxs("div",{className:"text-xs text-text-secondary",children:["Carregadas ",l.length," ",l.length===1?"comanda":"comandas"]}),at&&a.jsx(fe,{size:"sm",variant:"outline",disabled:o,onClick:async()=>{const Me=gt+ie;bt(Me),await Ge({append:!0})},children:"Carregar mais"})]}),j==="comandas"&&a.jsxs("div",{className:"sm:hidden bg-surface rounded-lg border border-border p-3 mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(Zs,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(rt,{placeholder:"Buscar...",className:"pl-9 h-9 text-sm",value:g,onChange:Me=>y(Me.target.value)})]}),a.jsx(fe,{size:"sm",variant:"outline",className:"h-9",onClick:()=>C(Me=>!Me),children:S?"Ocultar":"Filtros"})]}),a.jsxs("div",{className:"mt-1 text-[11px] text-text-secondary truncate",children:[d||"","  ",f||""]})]}),j==="comandas"&&a.jsx(xr.div,{variants:Dy,className:`bg-surface rounded-lg border border-border p-4 mb-4 ${S?"":"hidden"} sm:block`,children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[a.jsxs("div",{children:[a.jsx(qe,{className:"mb-1 block",children:"Perodo Inicial"}),a.jsx($j,{value:d,onChange:u})]}),a.jsxs("div",{children:[a.jsx(qe,{className:"mb-1 block",children:"Perodo Final"}),a.jsx($j,{value:f,onChange:h})]}),a.jsxs("div",{className:"md:col-span-2 hidden sm:block",children:[a.jsxs(qe,{className:"mb-1 block",children:["Busca ",P&&a.jsxs("span",{className:"text-xs text-warning ml-1",children:["(",P,")"]})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Zs,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),a.jsx(rt,{placeholder:"Mesa, status (fechada/aberta) ou cliente",className:"pl-9 pr-12",value:g,onChange:Me=>y(Me.target.value)}),s&&a.jsx(fe,{size:"sm",variant:"ghost",className:"absolute right-1 top-1/2 -translate-y-1/2 h-7 text-xs",onClick:()=>{t("/historico")},children:" Limpar"})]})]}),a.jsxs("div",{children:[a.jsx(qe,{className:"mb-1 block",children:"Status"}),a.jsxs(vn,{value:m,onValueChange:v,children:[a.jsx(hn,{className:"w-full text-xs",children:a.jsx(wn,{placeholder:"Selecionar status"})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"closed",children:"Fechadas"}),a.jsx(ct,{value:"open",children:"Abertas"}),a.jsx(ct,{value:"awaiting-payment",children:"Pagamento"}),a.jsx(ct,{value:"cancelled",children:"Canceladas"})]})]})]}),a.jsxs("div",{children:[a.jsx(qe,{className:"mb-1 block",children:"Tipo"}),a.jsxs(vn,{value:b,onValueChange:w,children:[a.jsx(hn,{className:"w-full text-xs",children:a.jsx(wn,{placeholder:"Selecionar tipo"})}),a.jsxs(pn,{children:[a.jsx(ct,{value:"all",children:"Todos"}),a.jsx(ct,{value:"comanda",children:"Comandas"}),a.jsx(ct,{value:"balcao",children:"Balco"})]})]})]})]})}),j==="comandas"&&a.jsxs(xr.div,{variants:Dy,className:"bg-surface rounded-lg border border-border p-0 overflow-hidden",children:[a.jsx("div",{className:"hidden sm:block overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-surface-2 text-text-secondary",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-4 py-3 whitespace-nowrap",children:"Local"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Clientes"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Status"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Finalizadora"}),a.jsx("th",{className:"text-left px-4 py-3 whitespace-nowrap",children:"Abertura"}),a.jsx("th",{className:"text-right px-4 py-3 whitespace-nowrap",children:"Diferena"}),a.jsx("th",{className:"text-right px-4 py-3",children:"Total"}),a.jsx("th",{className:"text-right px-4 py-3 whitespace-nowrap",children:"Fiscal"})]})}),a.jsxs("tbody",{children:[Ue.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"px-4 py-6 text-center text-text-muted",children:"Nenhuma comanda encontrada no perodo."})}),Ue.map(Me=>a.jsxs("tr",{className:"border-t border-border/70 hover:bg-warning/10 cursor-pointer transition-all duration-150 hover:translate-x-[1px]",onClick:()=>Je(Me.id),children:[a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:Me.mesa_id==null?"Balco":Me.mesaNumero!=null?`Mesa ${Me.mesaNumero}`:""}),a.jsx("td",{className:"px-4 py-2 break-words",title:Me.clientesStr||"",children:Me.clientesStr||""}),a.jsx("td",{className:"px-4 py-2",children:a.jsx("span",{className:pr("inline-flex items-center text-[11px] font-medium px-2 py-0.5 rounded-full border",yr(Me.statusDerived||Me.status)),children:ze(Me.statusDerived||Me.status)})}),a.jsx("td",{className:"px-4 py-2 break-words",title:Me.finalizadorasStr||"",children:Me.finalizadorasStr||""}),a.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:or(Me.aberto_em)}),a.jsx("td",{className:"px-4 py-2 text-right whitespace-nowrap",children:(()=>{const dt=typeof Me.diferenca_pagamento=="number"?Me.diferenca_pagamento:0;if(Math.abs(dt)<.005)return a.jsx("span",{className:"text-xs text-text-muted",children:"R$ 0,00"});const ut=dt>0?"text-emerald-500":"text-amber-500",rr=dt>0?"+":"-";return a.jsx("span",{className:`text-xs font-semibold ${ut}`,children:`${rr} R$ ${Math.abs(dt).toFixed(2)}`})})()}),a.jsx("td",{className:"px-4 py-2 text-right font-semibold whitespace-nowrap",children:Nt(Me.total)}),a.jsx("td",{className:"px-4 py-2 text-right whitespace-nowrap",children:Me.fechado_em&&(!Me.nf_status||Me.nf_status==="rejeitada")&&a.jsx(fe,{size:"sm",variant:"outline",onClick:dt=>{dt.stopPropagation(),te(Me.id)},children:"Pr-Emisso"})})]},Me.id))]})]})}),a.jsxs("div",{className:"sm:hidden divide-y divide-border",children:[Ue.length===0&&a.jsx("div",{className:"p-4 text-center text-text-muted",children:"Nenhuma comanda encontrada no perodo."}),Ue.map(Me=>a.jsxs("button",{className:"w-full text-left p-3 active:bg-warning/10",onClick:()=>Je(Me.id),children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"text-xs text-text-secondary",children:Me.mesa_id==null?"Balco":Me.mesaNumero!=null?`Mesa ${Me.mesaNumero}`:"Comanda"}),a.jsx("div",{className:"font-semibold truncate max-w-[220px]",children:Me.clientesStr||"Sem cliente"})]}),a.jsx("div",{children:a.jsx("div",{className:pr("inline-flex items-center text-[10px] font-medium px-2 py-0.5 rounded-full border",yr(Me.statusDerived||Me.status)),children:ze(Me.statusDerived||Me.status)})})]}),a.jsx("div",{className:"mt-1 text-xs text-text-secondary truncate",children:Me.finalizadorasStr||""}),a.jsxs("div",{className:"mt-2 flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"flex-1 min-w-0 text-[11px] text-text-muted truncate pr-2",children:[or(Me.aberto_em),Me.fechado_em?`  ${or(Me.fechado_em)}`:""]}),a.jsxs("div",{className:"flex-shrink-0 text-right min-w-[84px]",children:[a.jsx("div",{className:"text-[11px]",children:(()=>{const dt=typeof Me.diferenca_pagamento=="number"?Me.diferenca_pagamento:0;if(Math.abs(dt)<.005)return a.jsx("span",{className:"text-text-muted",children:"Dif.: R$ 0,00"});const ut=dt>0?"text-emerald-500":"text-amber-500",rr=dt>0?"+":"-";return a.jsx("span",{className:ut,children:`Dif.: ${rr} R$ ${Math.abs(dt).toFixed(2)}`})})()}),a.jsx("div",{className:"font-mono font-semibold whitespace-nowrap",children:Nt(Me.total)})]})]}),Me.fechado_em&&(!Me.nf_status||Me.nf_status==="rejeitada")&&a.jsx("div",{className:"mt-2 flex justify-end",children:a.jsx(fe,{size:"sm",variant:"outline",onClick:dt=>{dt.preventDefault(),dt.stopPropagation(),te(Me.id)},children:"Pr-Emisso"})})]},Me.id))]})]}),a.jsx(mn,{open:$,onOpenChange:X,children:a.jsxs(un,{className:"max-w-[800px]",children:[a.jsxs(on,{children:[a.jsx(an,{children:"Pr-Emisso NFC-e"}),a.jsx(Nn,{children:"Revise os dados e pendncias antes de emitir."})]}),ye?a.jsx("div",{className:"p-4 text-center text-text-muted",children:"Gerando prvia"}):a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"border border-border rounded p-2 bg-surface-2",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"JSON (EnviarNfce)"}),a.jsx("pre",{className:"text-[11px] whitespace-pre-wrap break-all max-h-[360px] overflow-auto",children:V?JSON.stringify(V,null,2):""})]}),a.jsxs("div",{className:"border border-border rounded p-2 bg-surface-2",children:[a.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Pendncias"}),!Q||Q.length===0?a.jsx("div",{className:"text-sm text-emerald-500",children:"Nenhuma pendncia encontrada."}):a.jsx("ul",{className:"list-disc pl-5 text-sm",children:Q.map((Me,dt)=>a.jsx("li",{children:Me},dt))})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[a.jsx(fe,{variant:"outline",onClick:()=>X(!1),children:"Fechar"}),a.jsx(fe,{disabled:!0,children:"Emitir (desabilitado)"})]})]})}),j==="fechamentos"&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"sm:hidden bg-surface rounded-lg border border-border p-3 mb-3",children:a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("div",{className:"text-sm font-medium",children:"Filtros"}),a.jsx(fe,{size:"sm",variant:"outline",onClick:()=>C(Me=>!Me),children:S?"Ocultar filtros":"Mostrar filtros"})]})}),a.jsx(xr.div,{variants:Dy,className:`bg-surface rounded-lg border border-border p-4 mb-4 ${S?"":"hidden"} sm:block`,children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[a.jsxs("div",{children:[a.jsx(qe,{className:"mb-1 block",children:"Perodo Inicial"}),a.jsx($j,{value:d,onChange:u})]}),a.jsxs("div",{children:[a.jsx(qe,{className:"mb-1 block",children:"Perodo Final"}),a.jsx($j,{value:f,onChange:h})]})]})}),a.jsxs(xr.div,{variants:Dy,className:"bg-surface rounded-lg border border-border p-4 overflow-hidden",children:[a.jsxs("div",{className:"sm:hidden space-y-2",children:[o&&(!l||l.length===0)&&a.jsxs("div",{className:"px-2 py-3 text-center text-text-muted",children:[a.jsx(Tc,{className:"inline mr-2 h-4 w-4 animate-spin"}),"Carregando fechamentos"]}),(!l||l.length===0)&&!o&&a.jsx("div",{className:"px-2 py-3 text-center text-text-muted",children:"Nenhum fechamento encontrado no perodo."}),(l||[]).map(Me=>a.jsxs("button",{onClick:async()=>{try{W({open:!0,loading:!0,resumo:null,periodo:{from:Me.aberto_em,to:Me.fechado_em},movs:[],movimentosAgg:null,saldos:{inicial:Me?.saldo_inicial??null,final:Me?.saldo_final??null}});const dt=Ct(),[ut,rr]=await Promise.all([SS({caixaSessaoId:Me.id,codigoEmpresa:dt}).catch(()=>null),ng({caixaSessaoId:Me.id,codigoEmpresa:dt}).catch(()=>[])]);let hr=ut?.movimentos||null;if(!hr&&Array.isArray(rr)){const dr={suprimentos:0,sangrias:0,ajustes:0,troco:0};for(const ur of rr){const er=String(ur?.tipo||"").toLowerCase(),ln=Number(ur?.valor||0);er==="suprimento"?dr.suprimentos+=ln:er==="sangria"?dr.sangrias+=ln:er==="ajuste"?dr.ajustes+=ln:er==="troco"&&(dr.troco+=ln)}hr=dr}const It=ut?{totalDescontos:Number(ut.total_descontos||0),totalVendasLiquidas:Number(ut.total_liquido||0),totalEntradas:Number(ut.total_entradas||0),totalPorFinalizadora:ut.por_finalizadora||{}}:null;W({open:!0,loading:!1,resumo:It,periodo:{from:ut?.periodo_de||Me.aberto_em,to:ut?.periodo_ate||Me.fechado_em},movs:rr||[],movimentosAgg:hr,saldos:{inicial:Me?.saldo_inicial??null,final:Me?.saldo_final??null}})}catch{W({open:!0,loading:!1,resumo:null,periodo:{from:Me.aberto_em,to:Me.fechado_em},movs:[],movimentosAgg:null,saldos:{inicial:Me?.saldo_inicial??null,final:Me?.saldo_final??null}})}},className:"w-full text-left p-3 rounded-lg border border-border hover:bg-surface-2 transition",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsxs("div",{className:"text-xs text-text-secondary",children:[or(Me.aberto_em),a.jsx("span",{className:"mx-1",children:""}),or(Me.fechado_em)]}),a.jsx("div",{className:"text-[11px] px-2 py-0.5 rounded-full border bg-success/10 text-success border-success/30",children:tr(Me.status)})]}),a.jsxs("div",{className:"mt-1 grid grid-cols-2 gap-2 text-xs",children:[a.jsxs("div",{className:"bg-surface-2 rounded p-2 border border-border",children:[a.jsx("div",{className:"text-[10px] text-text-secondary",children:"Saldo Inicial"}),a.jsx("div",{className:"font-semibold",children:Me?.saldo_inicial!=null?Nt(Me.saldo_inicial):""})]}),a.jsxs("div",{className:"bg-surface-2 rounded p-2 border border-border",children:[a.jsx("div",{className:"text-[10px] text-text-secondary",children:"Saldo Final (contado)"}),a.jsx("div",{className:"font-semibold",children:Me?.valor_final_dinheiro!=null?Nt(Me.valor_final_dinheiro):""})]})]})]},Me.id))]}),a.jsx("div",{className:"hidden sm:block overflow-x-auto max-h-[60vh] overflow-y-auto pr-2 sm:pr-3",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-surface-2 text-text-secondary",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-4 py-3",children:"Abertura"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Fechamento"}),a.jsx("th",{className:"text-left px-4 py-3",children:"Status"}),a.jsx("th",{className:"text-right px-4 py-3",children:"Saldo Inicial"}),a.jsx("th",{className:"text-right px-4 py-3",children:"Saldo Final (contado)"})]})}),a.jsxs("tbody",{children:[o&&(!l||l.length===0)&&a.jsx("tr",{children:a.jsxs("td",{colSpan:5,className:"px-4 py-6 text-center text-text-muted",children:[a.jsx(Tc,{className:"inline mr-2 h-4 w-4 animate-spin"}),"Carregando fechamentos"]})}),(!l||l.length===0)&&a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"px-4 py-6 text-center text-text-muted",children:"Nenhum fechamento encontrado no perodo."})}),(l||[]).map(Me=>a.jsxs("tr",{className:"border-t border-border/70 hover:bg-success/10 cursor-pointer transition-all duration-150 hover:translate-x-[1px]",onClick:async()=>{try{W({open:!0,loading:!0,resumo:null,periodo:{from:Me.aberto_em,to:Me.fechado_em},movs:[],movimentosAgg:null,saldos:{inicial:Me?.saldo_inicial??null,final:Me?.saldo_final??null}});const dt=async()=>{const hr=Ct(),[It,dr]=await Promise.all([SS({caixaSessaoId:Me.id,codigoEmpresa:hr}).catch(()=>null),ng({caixaSessaoId:Me.id,codigoEmpresa:hr}).catch(()=>[])]);return{snap:It,movs:dr}};let{snap:ut,movs:rr}=await dt();if(ut||(await new Promise(hr=>setTimeout(hr,700)),{snap:ut,movs:rr}=await dt()),ut){const hr={totalDescontos:Number(ut.total_descontos||0),totalVendasLiquidas:Number(ut.total_liquido||0),totalEntradas:Number(ut.total_entradas||0),totalPorFinalizadora:ut.por_finalizadora||{}};let It=ut.movimentos||null;if(!It&&Array.isArray(rr)){const dr={suprimentos:0,sangrias:0,ajustes:0,troco:0};for(const ur of rr){const er=String(ur?.tipo||"").toLowerCase(),ln=Number(ur?.valor||0);er==="suprimento"?dr.suprimentos+=ln:er==="sangria"?dr.sangrias+=ln:er==="ajuste"?dr.ajustes+=ln:er==="troco"&&(dr.troco+=ln)}It=dr}W({open:!0,loading:!1,resumo:hr,periodo:{from:ut.periodo_de||Me.aberto_em,to:ut.periodo_ate||Me.fechado_em},movs:rr||[],movimentosAgg:It,saldos:{inicial:typeof ut.saldo_inicial<"u"?Number(ut.saldo_inicial):Me?.saldo_inicial??null,final:typeof ut.valor_final_dinheiro<"u"?Number(ut.valor_final_dinheiro):Me?.valor_final_dinheiro??null}})}else{const hr=Ct(),It=await Nd({from:Me.aberto_em,to:Me.fechado_em||new Date().toISOString(),codigoEmpresa:hr});let dr=null;if(Array.isArray(rr)){const ur={suprimentos:0,sangrias:0,ajustes:0,troco:0};for(const er of rr){const ln=String(er?.tipo||"").toLowerCase(),Mr=Number(er?.valor||0);ln==="suprimento"?ur.suprimentos+=Mr:ln==="sangria"?ur.sangrias+=Mr:ln==="ajuste"?ur.ajustes+=Mr:ln==="troco"&&(ur.troco+=Mr)}dr=ur}W({open:!0,loading:!1,resumo:It||null,periodo:{from:Me.aberto_em,to:Me.fechado_em},movs:rr||[],movimentosAgg:dr,saldos:{inicial:Me?.saldo_inicial??null,final:Me?.valor_final_dinheiro??null}})}}catch{W({open:!0,loading:!1,resumo:null,periodo:{from:Me.aberto_em,to:Me.fechado_em},movs:[],movimentosAgg:null,saldos:{inicial:Me?.saldo_inicial??null,final:Me?.valor_final_dinheiro??null}})}},children:[a.jsx("td",{className:"px-4 py-2",children:or(Me.aberto_em)}),a.jsx("td",{className:"px-4 py-2",children:or(Me.fechado_em)}),a.jsx("td",{className:"px-4 py-2",children:tr(Me.status)}),a.jsx("td",{className:"px-4 py-2 text-right",children:Me?.saldo_inicial!=null?Nt(Me.saldo_inicial):""}),a.jsx("td",{className:"px-4 py-2 text-right",children:Me?.valor_final_dinheiro!=null?Nt(Me.valor_final_dinheiro):""})]},Me.id))]})]})})]})]}),j==="comandas"&&a.jsx(mn,{open:!!R,onOpenChange:Me=>{Me?be.current=!0:(be.current=!1,O(null),M({loading:!1,itens:[],pagamentos:[]}),U(null))},children:a.jsxs(un,{className:"sm:max-w-4xl w-[92vw] max-h-[90vh] overflow-hidden flex flex-col animate-none",onKeyDown:Me=>Me.stopPropagation(),children:[a.jsxs(on,{children:[a.jsxs(an,{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("span",{children:D?a.jsxs("span",{children:[D.mesaLabel,D.clientesStr?a.jsxs("span",{className:"text-text-secondary",children:["  ",D.clientesStr]}):null]}):a.jsxs(a.Fragment,{children:["Comanda #",R||""]})}),D&&a.jsxs("div",{className:"flex gap-2",children:[a.jsx("span",{className:pr("text-xs px-2 py-0.5 rounded-full border",yr(D.status)),children:D.status==="closed"?"Fechada":D.status==="open"?"Aberta":"Cancelada"}),a.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full border bg-info/10 text-info border-info/30",children:D.tipo==="balcao"?"Balco":D.tipo==="comanda"?"Mesa":"Importada"})]})]}),a.jsx(Nn,{className:"space-y-1",children:D?a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[D.aberto_em?a.jsxs(a.Fragment,{children:["Abertura: ",or(D.aberto_em)]}):"",D.fechado_em&&a.jsxs(a.Fragment,{children:[" ",""," ","Fechamento: ",or(D.fechado_em),(()=>{const Me=new Date(D.aberto_em),ut=new Date(D.fechado_em)-Me,rr=Math.floor(ut/6e4),hr=Math.floor(rr/60),It=rr%60;return rr>0?a.jsxs("span",{className:"text-text-muted",children:[" (",hr>0?`${hr}h `:"",It,"min)"]}):null})()]})]}),D.observacao&&a.jsx("div",{className:"text-xs text-text-muted",children:D.observacao.includes("Importado de XML")?a.jsxs("span",{className:"text-warning",children:[" ",D.observacao.split(`
`)[0]]}):a.jsxs("span",{children:["Obs: ",D.observacao]})})]}):a.jsx(a.Fragment,{children:"Itens e pagamentos registrados."})})]}),I.loading?a.jsxs("div",{className:"p-6 text-center text-text-muted",children:[a.jsx(Tc,{className:"mr-2 inline h-4 w-4 animate-spin"})," Carregando..."]}):a.jsxs("div",{className:"space-y-4 overflow-y-auto flex-1 px-1",children:[(()=>{const Me=I.itens.reduce((dr,ur)=>dr+Number(ur.quantidade||0)*Number(ur.preco_unitario||0),0),dt=I.itens.reduce((dr,ur)=>dr+Number(ur.desconto||0),0),ut=Me-dt,rr=I.pagamentos.reduce((dr,ur)=>dr+Number(ur.valor||0),0),hr=typeof D?.diferenca_pagamento=="number"?D.diferenca_pagamento:null,It=hr??rr-ut;return a.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[a.jsx("h3",{className:"font-semibold mb-3",children:"Resumo Financeiro"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-text-muted",children:"Subtotal"}),a.jsxs("span",{className:"font-mono font-semibold",children:["R$ ",Me.toFixed(2)]})]}),dt>0&&a.jsxs("div",{className:"flex items-center gap-2 text-warning",children:[a.jsx("span",{children:"Desconto"}),a.jsxs("span",{className:"font-mono font-semibold",children:["-R$ ",dt.toFixed(2)]})]})]}),a.jsxs("div",{className:"flex justify-between font-semibold pt-2 border-t border-border",children:[a.jsx("span",{children:"Total:"}),a.jsxs("span",{className:"font-mono text-lg",children:["R$ ",ut.toFixed(2)]})]}),a.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[a.jsxs("div",{className:"flex items-center gap-2 text-success",children:[a.jsx("span",{children:"Pagamentos"}),a.jsxs("span",{className:"font-mono",children:["R$ ",rr.toFixed(2)]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-text-secondary",children:"Diferena"}),a.jsx("span",{className:pr("font-semibold",Math.abs(It)<.005?"text-text-muted":It>0?"text-emerald-500":"text-amber-500"),children:Math.abs(It)<.005?"R$ 0,00":`${It>0?"+":"-"} R$ ${Math.abs(It).toFixed(2)}`})]})]})]})]})})(),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"border rounded-md p-3",children:[a.jsxs("div",{className:"font-semibold mb-2",children:["Itens (",I.itens.length,")"]}),I.itens.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem itens."}):a.jsx("ul",{className:"text-sm space-y-2 max-h-64 overflow-auto thin-scroll",children:I.itens.map(Me=>{const dt=Number(Me.quantidade||0)*Number(Me.preco_unitario||0),ut=Number(Me.desconto||0),rr=dt-ut;return a.jsx("li",{className:"border-b border-border/50 pb-2 last:border-0",children:a.jsxs("div",{className:"flex justify-between items-start gap-2",children:[a.jsxs("span",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"font-medium truncate",children:Me.descricao}),a.jsxs("div",{className:"text-xs text-text-muted",children:[Me.quantidade," x R$ ",Number(Me.preco_unitario||0).toFixed(2),ut>0&&a.jsxs("span",{className:"text-warning",children:[" (desc: R$ ",ut.toFixed(2),")"]})]})]}),a.jsxs("span",{className:"font-mono font-semibold whitespace-nowrap",children:["R$ ",rr.toFixed(2)]})]})},Me.id)})})]}),a.jsxs("div",{className:"border rounded-md p-3",children:[a.jsxs("div",{className:"font-semibold mb-2",children:["Pagamentos (",I.pagamentos.length,")"]}),I.pagamentos.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Sem registros."}):a.jsx("ul",{className:"text-sm space-y-2 max-h-64 overflow-auto thin-scroll",children:I.pagamentos.map(Me=>a.jsxs("li",{className:"flex justify-between gap-2 border-b border-border/50 pb-2 last:border-0",children:[a.jsxs("span",{className:"pr-2 break-words flex-1",children:[Me.cliente_nome?a.jsx("div",{className:"font-medium",children:Me.cliente_nome}):a.jsx("div",{className:"text-text-muted",children:"Sem cliente"}),a.jsx("div",{className:"text-xs text-text-secondary",children:Me.finalizadora_nome||"Outros"})]}),a.jsxs("span",{className:"font-mono font-semibold whitespace-nowrap",children:["R$ ",Number(Me.valor||0).toFixed(2)]})]},Me.id))})]})]})]}),a.jsx(Qn,{children:a.jsx(fe,{size:"sm",variant:"secondary",onClick:()=>{O(null)},children:"Fechar"})})]})}),j==="fechamentos"&&a.jsx(mn,{open:z.open,onOpenChange:Me=>{Me||W({open:!1,loading:!1,resumo:null,periodo:{from:null,to:null}})},children:a.jsxs(un,{className:"sm:max-w-2xl w-[92vw] max-h-[85vh] animate-none flex flex-col overflow-hidden overflow-x-hidden",onKeyDown:Me=>Me.stopPropagation(),children:[a.jsxs(on,{children:[a.jsx(an,{children:"Fechamento do Perodo"}),a.jsxs(Nn,{children:[z.periodo.from?or(z.periodo.from):""," ","at"," ",z.periodo.to?or(z.periodo.to):""]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto pr-1",children:z.loading?a.jsxs("div",{className:"p-3 sm:p-4 text-text-muted",children:[a.jsx(Tc,{className:"inline mr-2 h-4 w-4 animate-spin"}),"Carregando resumo"]}):a.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Saldo Inicial"}),a.jsx("p",{className:"text-xl font-bold",children:Nt(z?.saldos?.inicial??0)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Entradas (pagamentos)"}),a.jsx("p",{className:"text-xl font-bold text-success",children:Nt(z.resumo?.totalEntradas||0)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border col-span-2 sm:col-span-1",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Saldo Final (contado)"}),a.jsx("p",{className:"text-xl font-bold",children:z?.saldos?.final!=null?Nt(z.saldos.final):""})]})]}),a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 gap-2 sm:gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Descontos"}),a.jsx("p",{className:"text-xl font-bold text-warning",children:Nt(z.resumo?.totalDescontos||0)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Lquido"}),a.jsx("p",{className:"text-xl font-bold",children:Nt(z.resumo?.totalVendasLiquidas||0)})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold mb-1",children:"Por Finalizadora"}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:z.resumo?.totalPorFinalizadora&&Object.keys(z.resumo.totalPorFinalizadora).length>0?Object.entries(z.resumo.totalPorFinalizadora).map(([Me,dt])=>a.jsxs("div",{className:"flex items-center justify-between bg-surface-2 rounded-md p-2 border border-border",children:[a.jsx("span",{className:"text-sm text-text-secondary",children:String(Me)}),a.jsx("span",{className:"text-sm font-semibold",children:Nt(dt)})]},Me)):a.jsx("div",{className:"text-sm text-text-muted",children:"Sem dados de finalizadoras"})})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold mb-1",children:"Resumo de Movimentaes"}),z.movimentosAgg?a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3",children:[a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Suprimentos"}),a.jsx("p",{className:"text-lg font-bold text-success",children:Nt(z.movimentosAgg?.suprimentos||0)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Sangrias"}),a.jsx("p",{className:"text-lg font-bold text-danger",children:Nt(z.movimentosAgg?.sangrias||0)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Ajustes"}),a.jsx("p",{className:"text-lg font-bold",children:Nt(z.movimentosAgg?.ajustes||0)})]}),a.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[a.jsx("p",{className:"text-xs text-text-secondary",children:"Troco"}),a.jsx("p",{className:"text-lg font-bold",children:Nt(z.movimentosAgg?.troco||0)})]})]}):a.jsx("div",{className:"text-sm text-text-muted",children:"Sem movimentaes agregadas nesta sesso."})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold mb-1",children:"Movimentaes"}),!z.movs||z.movs.length===0?a.jsx("div",{className:"text-sm text-text-muted",children:"Nenhuma movimentao registrada"}):a.jsxs(a.Fragment,{children:[a.jsx("ul",{className:"sm:hidden divide-y divide-border rounded-md border border-border overflow-hidden",children:z.movs.map((Me,dt)=>a.jsxs("li",{className:"px-3 py-2",children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-xs text-text-secondary whitespace-nowrap",children:or(Me.criado_em)}),a.jsx("span",{className:"text-sm font-semibold whitespace-nowrap",children:Nt(Me.valor||0)})]}),a.jsxs("div",{className:"mt-0.5 flex items-center gap-2 text-xs",children:[a.jsx("span",{className:"px-1.5 py-0.5 rounded bg-surface-2 border border-border text-text-secondary whitespace-nowrap",children:String(Me.tipo||"").toUpperCase()}),a.jsx("span",{className:"text-xs text-text-primary whitespace-normal break-words flex-1",children:Me.observacao||""})]})]},dt))}),a.jsx("div",{className:"hidden sm:block rounded-md border border-border overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-surface-2",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left px-3 py-2",children:"Data"}),a.jsx("th",{className:"text-left px-3 py-2",children:"Tipo"}),a.jsx("th",{className:"text-left px-3 py-2",children:"Obs"}),a.jsx("th",{className:"text-right px-3 py-2",children:"Valor"})]})}),a.jsx("tbody",{children:z.movs.map((Me,dt)=>a.jsxs("tr",{className:"border-t border-border/60",children:[a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:or(Me.criado_em)}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:String(Me.tipo||"").toUpperCase()}),a.jsx("td",{className:"px-3 py-2 whitespace-normal break-words",children:Me.observacao||""}),a.jsx("td",{className:"px-3 py-2 text-right font-semibold whitespace-nowrap",children:Nt(Me.valor||0)})]},dt))})]})})]})]})]})})]})}),a.jsx(Wit,{open:Y,onOpenChange:ce,codigoEmpresa:r?.codigo_empresa,onSuccess:async Me=>{ce(!1),Me&&(u(Me),h(Me)),await new Promise(dt=>setTimeout(dt,500)),bt(0),await Ge({append:!1})}})]})}function Xit(){const{userProfile:e}=ms(),[t]=hC(),r=t.get("comanda"),[n,s]=p.useState(!0),[o,i]=p.useState(null),[l,c]=p.useState([]),[d,u]=p.useState([]),[f,h]=p.useState([]),[m,v]=p.useState(null),[g,y]=p.useState(""),[x,b]=p.useState("");p.useEffect(()=>{(async()=>{try{if(!r||!e?.codigo_empresa)return;try{const{data:M,error:D}=await de.from("empresas").select("nome_fantasia, nome").eq("codigo_empresa",e.codigo_empresa).single();if(D&&console.warn("[PrintComandaPage] Erro ao buscar empresa:",D.message),M){const U=M.nome_fantasia||M.nome||"";console.log("[PrintComandaPage] Empresa carregada:",M,"-> nome exibido:",U),b(U)}else console.warn("[PrintComandaPage] Empresa no encontrada para codigo_empresa:",e.codigo_empresa)}catch(M){console.warn("[PrintComandaPage] Exceo ao carregar empresa:",M)}const{data:C}=await de.from("comandas").select("mesa_id, observacoes").eq("id",r).eq("codigo_empresa",e.codigo_empresa).single();if(C?.mesa_id){const{data:M}=await de.from("mesas").select("numero").eq("id",C.mesa_id).eq("codigo_empresa",e.codigo_empresa).single();v(M)}y(C?.observacoes||"");const[P,A,R]=await Promise.all([io({comandaId:r,codigoEmpresa:e.codigo_empresa}),ui({comandaId:r,codigoEmpresa:e.codigo_empresa}),$re({comandaId:r,codigoEmpresa:e.codigo_empresa})]);c(P||[]),u(A||[]),h(R||[]);const O=(P||[]).reduce((M,D)=>M+Number(D.quantidade||0)*Number(D.preco_unitario||0),0),I=(R||[]).reduce((M,D)=>M+Number(D.valor||0),0);i({id:r,totalItens:O,totalPagamentos:I,diferenca:I-O})}catch(C){console.error("Erro ao carregar comanda:",C)}finally{s(!1)}})()},[r,e?.codigo_empresa]);const w=()=>{window.print()},j=()=>{window.history.back()};if(n)return a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand mx-auto mb-4"}),a.jsx("p",{className:"text-text-muted",children:"Carregando comanda..."})]})});if(!o)return a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-text-muted mb-4",children:"Comanda no encontrada"}),a.jsxs(fe,{onClick:j,variant:"outline",children:[a.jsx(tb,{className:"mr-2 h-4 w-4"}),"Voltar"]})]})});const _=(d||[]).map(S=>S?.nome||S?.nome_livre||"").filter(Boolean).join(", ")||"Sem cliente";return o.totalItens,o.totalPagamentos,a.jsxs("div",{className:"w-screen h-screen bg-gray-100 flex flex-col print:bg-white print:p-0",children:[a.jsxs("div",{className:"flex gap-2 p-4 bg-white border-b border-gray-200 print:hidden",children:[a.jsxs(fe,{onClick:j,size:"sm",className:"bg-black text-white hover:bg-black/80 border border-black shadow-sm",children:[a.jsx(tb,{className:"mr-2 h-4 w-4"}),"Voltar"]}),a.jsxs(fe,{onClick:w,size:"sm",className:"ml-auto",children:[a.jsx(tG,{className:"mr-2 h-4 w-4"}),"Imprimir"]})]}),a.jsx("div",{className:"flex-1 overflow-auto flex items-start justify-center p-4 print:p-0 print:overflow-visible print:flex-none",children:a.jsxs("div",{className:"w-80 border border-black p-6 bg-white print:border-0 print:p-0 print:w-full",children:[a.jsxs("div",{className:"text-center mb-4 border-b border-black pb-3",children:[a.jsx("p",{className:"text-xs font-semibold text-black mb-2",children:x||" "}),a.jsx("h1",{className:"text-xl font-bold text-black",children:"COMANDA"}),m&&a.jsxs("p",{className:"text-xs text-black mt-1",children:["Mesa ",m.numero]}),a.jsx("p",{className:"text-xs text-black mt-1",children:new Date().toLocaleString("pt-BR")})]}),a.jsxs("div",{className:"mb-6 pb-4 border-b border-black",children:[a.jsx("p",{className:"text-sm font-semibold text-black",children:"CLIENTE:"}),a.jsx("p",{className:"text-sm text-black",children:_})]}),a.jsx("div",{className:"mb-6 pb-4 border-b border-black",children:a.jsx("div",{className:"space-y-2",children:l.map((S,C)=>{const P=Number(S.quantidade||0)*Number(S.preco_unitario||0);return a.jsxs("div",{className:"flex justify-between text-sm text-black",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("span",{children:S.descricao||"Item"}),a.jsxs("span",{className:"ml-2 text-xs",children:["x",S.quantidade]})]}),a.jsxs("span",{className:"font-semibold",children:["R$ ",P.toFixed(2)]})]},C)})})}),g&&a.jsxs("div",{className:"mb-4 pb-3",children:[a.jsx("p",{className:"text-xs font-semibold text-black mb-1",children:"OBS:"}),a.jsx("p",{className:"text-xs text-black border-b border-black pb-3",children:g})]}),a.jsx("div",{className:"text-center pt-4",children:a.jsxs("p",{className:"text-lg font-bold text-black mt-2",children:["TOTAL: R$ ",o.totalItens.toFixed(2)]})}),a.jsxs("div",{className:"text-center mt-8 pt-4 border-t border-black text-xs text-black",children:[a.jsx("p",{children:"Obrigado pela preferncia!"}),a.jsx("p",{className:"mt-2",children:"Fluxo7Arena"})]})]})}),a.jsx("style",{children:`
        @media print {
          body {
            margin: 0;
            padding: 0;
            background: white;
          }
          .print\\:hidden {
            display: none !important;
          }
          .print\\:border-0 {
            border: none !important;
          }
          .print\\:p-0 {
            padding: 0 !important;
          }
        }
      `})]})}const Yit="18810778",Sv={hidden:{opacity:0,x:20},visible:{opacity:1,x:0,transition:{duration:.3}},exit:{opacity:0,x:-20,transition:{duration:.2}}};function Jit(e){return e.replace(/\D/g,"").replace(/(\d{2})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1/$2").replace(/(\d{4})(\d)/,"$1-$2").substring(0,18)}function Qit(e){return e.replace(/\D/g,"").replace(/(\d{2})(\d)/,"($1) $2").replace(/(\d{5})(\d)/,"$1-$2").substring(0,15)}async function Zit(){try{const{data:e,error:t}=await de.from("empresas").select("codigo_empresa").order("codigo_empresa",{ascending:!1}).limit(100);if(t)return console.warn("Erro ao buscar cdigos:",t),"1";let r=0;return e&&e.length>0&&e.forEach(n=>{const s=parseInt(n.codigo_empresa);!isNaN(s)&&s>r&&(r=s)}),(r+1).toString()}catch(e){return console.warn("Erro ao gerar cdigo:",e),"1"}}function elt(){const{toast:e}=Qa(),t=zi(),[r,n]=p.useState(1),[s,o]=p.useState(!1),[i,l]=p.useState(!1),[c,d]=p.useState(""),[u,f]=p.useState({email:"",nomeUsuario:"",cargo:"",razaoSocial:"",nomeFantasia:"",cnpj:"",emailEmpresa:"",telefone:"",endereco:"",quadras:[],mesas:[],categorias:[]}),[h,m]=p.useState(null),v=W=>{W.preventDefault(),c===Yit?(l(!0),n(2),e({title:"Acesso liberado",description:"Bem-vindo ao formulrio de criao de empresa."})):(e({title:"Senha incorreta",description:"Tente novamente.",variant:"destructive"}),d(""))},g=()=>!0,y=()=>u.razaoSocial.trim()?u.nomeFantasia.trim()?!0:(e({title:"Nome Fantasia obrigatrio",variant:"destructive"}),!1):(e({title:"Razo Social obrigatria",variant:"destructive"}),!1),x=()=>{r===2&&!g()||r===3&&!y()||n(r+1)},b=()=>{n(r-1)},w=()=>{const W=u.quadras.length+1;f({...u,quadras:[...u.quadras,{nome:`Quadra ${W}`}]})},j=W=>{f({...u,quadras:u.quadras.filter(($,X)=>X!==W)})},_=()=>{const W=u.mesas.length+1;f({...u,mesas:[...u.mesas,{numero:W,nome:`Mesa ${W}`}]})},S=W=>{f({...u,mesas:u.mesas.filter(($,X)=>X!==W)})},C=()=>{const W=prompt("Digite o nome da categoria:");W&&W.trim()&&f({...u,categorias:[...u.categorias,{nome:W.trim(),descricao:""}]})},P=W=>{f({...u,categorias:u.categorias.filter(($,X)=>X!==W)})},A=async()=>{try{o(!0);try{const V={user:{email:u.email?.trim()||null,nome:u.nomeUsuario?.trim()||null,cargo:u.cargo?.trim()||"admin"},empresa:{razao_social:u.razaoSocial?.trim()||null,nome_fantasia:u.nomeFantasia?.trim()||null,cnpj:u.cnpj?u.cnpj.replace(/\D/g,""):null,email:u.emailEmpresa?.trim()||null,telefone:u.telefone?.trim()||null,endereco:u.endereco?.trim()||null},quadras:u.quadras||[],mesas:u.mesas||[],categorias:u.categorias||[]},{data:B,error:Q}=await de.rpc("create_company_full",{payload:V});if(!Q&&B&&B.codigo_empresa){m({success:!0,codigoEmpresa:B.codigo_empresa,email:u.email,nomeEmpresa:u.nomeFantasia,numQuadras:(u.quadras||[]).length,numMesas:(u.mesas||[]).length,numCategorias:(u.categorias||[]).length}),n(6),e({title:" Empresa criada com sucesso!",description:`Cdigo: ${B.codigo_empresa}`});return}else Q&&console.warn("RPC create_company_full indisponvel/erro. Usando fluxo local.",Q?.message||Q)}catch(V){console.warn("Falha ao tentar RPC create_company_full. Usando fluxo local.",V?.message||V)}let W=null;u.email.trim()&&(console.log("Email fornecido:",u.email),console.log("Nota: O vnculo com o usurio ser criado no primeiro login"),W=null);const $=await Zit();console.log("Cdigo da empresa gerado:",$);const{data:X,error:ye}=await de.from("empresas").insert({codigo_empresa:$,nome:u.nomeFantasia,razao_social:u.razaoSocial,nome_fantasia:u.nomeFantasia,cnpj:u.cnpj?u.cnpj.replace(/\D/g,""):null,email:u.emailEmpresa||null,telefone:u.telefone||null,endereco:u.endereco||null}).select().single();if(ye)throw new Error("Erro ao criar empresa: "+ye.message);const{error:Se}=await de.from("empresa_counters").insert({empresa_id:X.id,next_cliente_codigo:1,next_agendamento_codigo:1});if(Se&&console.warn("Erro ao criar contador:",Se),u.email.trim()||u.nomeUsuario.trim())try{const V="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(pe){const te=Math.random()*16|0;return(pe==="x"?te:te&3|8).toString(16)}),{error:B}=await de.from("usuarios").insert({id:V,email:u.email||null,nome:u.nomeUsuario||null,papel:u.cargo||"admin",codigo_empresa:$});B&&console.warn("Aviso ao criar usurio:",B.message);const{error:Q}=await de.from("colaboradores").insert({id:V,nome:u.nomeUsuario||"Administrador",cargo:u.cargo||"admin",ativo:!0,codigo_empresa:$});Q&&console.warn("Aviso ao criar colaborador:",Q.message),u.email&&(console.log(" APS O PRIMEIRO LOGIN, execute este SQL no Supabase:"),console.log(`
-- Atualizar ID do colaborador com o ID real do auth.users
UPDATE public.colaboradores 
SET id = (SELECT id FROM auth.users WHERE email = '${u.email}')
WHERE codigo_empresa = '${$}' AND id = '${V}';

-- Atualizar ID do usurio
UPDATE public.usuarios 
SET id = (SELECT id FROM auth.users WHERE email = '${u.email}')
WHERE codigo_empresa = '${$}' AND id = '${V}';
            `))}catch(V){console.warn("Erro ao criar registros de usurio:",V)}try{await de.from("agenda_settings").insert({empresa_id:X.id,auto_confirm_enabled:!1,auto_start_enabled:!0,auto_finish_enabled:!0})}catch(V){console.warn("Aviso: no foi possvel criar agenda_settings agora (provvel RLS). Ser configurado aps o primeiro login.",V?.message||V)}if(u.quadras.length>0){const V=u.quadras.map(B=>({nome:B.nome,codigo_empresa:$}));await de.from("quadras").insert(V)}if(u.mesas.length>0){const V=u.mesas.map(B=>({numero:B.numero,nome:B.nome,codigo_empresa:$,status:"available"}));await de.from("mesas").insert(V)}if(u.categorias.length>0){const V=u.categorias.map(B=>({nome:B.nome,descricao:B.descricao||null,codigo_empresa:$,ativa:!0}));await de.from("produto_categorias").insert(V)}m({success:!0,codigoEmpresa:$,email:u.email,nomeEmpresa:u.nomeFantasia,numQuadras:u.quadras.length,numMesas:u.mesas.length,numCategorias:u.categorias.length}),n(6),e({title:" Empresa criada com sucesso!",description:`Cdigo: ${$}`})}catch(W){console.error("Erro ao criar empresa:",W),e({title:"Erro ao criar empresa",description:W.message,variant:"destructive"})}finally{o(!1)}},R=()=>{if(r===1||r===6)return null;const W=(r-1)/4*100;return a.jsxs("div",{className:"mb-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsxs("span",{className:"text-sm text-text-muted",children:["Etapa ",r-1," de 4"]}),a.jsxs("span",{className:"text-sm text-text-muted",children:[Math.round(W),"%"]})]}),a.jsx("div",{className:"h-2 bg-surface-2 rounded-full overflow-hidden",children:a.jsx(xr.div,{className:"h-full bg-brand",initial:{width:0},animate:{width:`${W}%`},transition:{duration:.3}})})]})},O=()=>a.jsxs(xr.div,{variants:Sv,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-md mx-auto",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:a.jsx(Ix,{className:"w-8 h-8 text-brand"})}),a.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:"rea Restrita"}),a.jsx("p",{className:"text-text-muted",children:"Digite a senha para acessar"})]}),a.jsxs("form",{onSubmit:v,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(qe,{htmlFor:"senha",children:"Senha de Acesso"}),a.jsx(rt,{id:"senha",type:"password",value:c,onChange:W=>d(W.target.value),placeholder:"Digite a senha",className:"text-center text-lg tracking-widest",autoFocus:!0})]}),a.jsxs(fe,{type:"submit",className:"w-full",children:["Acessar",a.jsx($2,{className:"ml-2 h-4 w-4"})]})]})]},"step1"),I=()=>a.jsxs(xr.div,{variants:Sv,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:a.jsx(Uu,{className:"w-8 h-8 text-brand"})}),a.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Primeiro Usurio"}),a.jsx("p",{className:"text-text-muted",children:"Informaes do administrador da empresa"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx(qe,{htmlFor:"email",children:"Email cadastrado no Supabase Auth"}),a.jsx(rt,{id:"email",type:"email",value:u.email,onChange:W=>f({...u,email:W.target.value}),placeholder:"usuario@email.com"}),a.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Este email j deve estar cadastrado no Supabase Auth"})]}),a.jsxs("div",{children:[a.jsx(qe,{htmlFor:"nomeUsuario",children:"Nome Completo"}),a.jsx(rt,{id:"nomeUsuario",type:"text",value:u.nomeUsuario,onChange:W=>f({...u,nomeUsuario:W.target.value}),placeholder:"Joo Silva"})]}),a.jsxs("div",{children:[a.jsx(qe,{htmlFor:"cargo",children:"Cargo na Empresa"}),a.jsx(rt,{id:"cargo",type:"text",value:u.cargo,onChange:W=>f({...u,cargo:W.target.value}),placeholder:"Ex: Proprietrio, Gerente, Administrador, Scio, etc."}),a.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Digite o cargo que voc ocupa na empresa"})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx(fe,{type:"button",variant:"outline",onClick:()=>t("/"),className:"flex-1",children:"Cancelar"}),a.jsxs(fe,{type:"button",onClick:x,className:"flex-1",children:["Prximo",a.jsx($2,{className:"ml-2 h-4 w-4"})]})]})]})]},"step2"),M=()=>a.jsxs(xr.div,{variants:Sv,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:a.jsx(K_,{className:"w-8 h-8 text-brand"})}),a.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Dados da Empresa"}),a.jsx("p",{className:"text-text-muted",children:"Informaes cadastrais da empresa"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(qe,{htmlFor:"razaoSocial",children:"Razo Social *"}),a.jsx(rt,{id:"razaoSocial",type:"text",value:u.razaoSocial,onChange:W=>f({...u,razaoSocial:W.target.value}),placeholder:"Empresa LTDA"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(qe,{htmlFor:"nomeFantasia",children:"Nome Fantasia *"}),a.jsx(rt,{id:"nomeFantasia",type:"text",value:u.nomeFantasia,onChange:W=>f({...u,nomeFantasia:W.target.value}),placeholder:"Minha Empresa"}),a.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Como a empresa aparecer no sistema"})]}),a.jsxs("div",{children:[a.jsx(qe,{htmlFor:"cnpj",children:"CNPJ"}),a.jsx(rt,{id:"cnpj",type:"text",value:u.cnpj,onChange:W=>f({...u,cnpj:Jit(W.target.value)}),placeholder:"00.000.000/0000-00"})]}),a.jsxs("div",{children:[a.jsx(qe,{htmlFor:"telefone",children:"Telefone"}),a.jsx(rt,{id:"telefone",type:"tel",value:u.telefone,onChange:W=>f({...u,telefone:Qit(W.target.value)}),placeholder:"(11) 99999-9999"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(qe,{htmlFor:"emailEmpresa",children:"Email da Empresa"}),a.jsx(rt,{id:"emailEmpresa",type:"email",value:u.emailEmpresa,onChange:W=>f({...u,emailEmpresa:W.target.value}),placeholder:"contato@empresa.com"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(qe,{htmlFor:"endereco",children:"Endereo Completo (opcional)"}),a.jsx(rt,{id:"endereco",type:"text",value:u.endereco,onChange:W=>f({...u,endereco:W.target.value}),placeholder:"Rua X, 123, Bairro, Cidade - UF"})]})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsxs(fe,{type:"button",variant:"outline",onClick:b,className:"flex-1",children:[a.jsx(tb,{className:"mr-2 h-4 w-4"}),"Voltar"]}),a.jsxs(fe,{type:"button",onClick:x,className:"flex-1",children:["Prximo",a.jsx($2,{className:"ml-2 h-4 w-4"})]})]})]})]},"step3"),D=()=>a.jsxs(xr.div,{variants:Sv,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:a.jsx(Ad,{className:"w-8 h-8 text-brand"})}),a.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Configurao Inicial"}),a.jsx("p",{className:"text-text-muted",children:"Adicione dados iniciais ou pule esta etapa"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(kue,{className:"w-5 h-5 text-brand"}),a.jsx("h3",{className:"font-semibold text-text-primary",children:"Quadras Esportivas"})]}),a.jsxs(fe,{type:"button",onClick:w,size:"sm",className:"gap-2",children:[a.jsx(Ja,{className:"w-4 h-4"}),"Adicionar Quadra"]})]}),u.quadras.length>0?a.jsx("div",{className:"space-y-2",children:u.quadras.map((W,$)=>a.jsxs("div",{className:"flex items-center justify-between bg-background rounded-md p-3 border border-border",children:[a.jsx("span",{className:"text-sm text-text-primary",children:W.nome}),a.jsx(fe,{type:"button",variant:"ghost",size:"sm",onClick:()=>j($),className:"h-8 w-8 p-0 text-danger hover:text-danger hover:bg-danger/10",children:a.jsx(al,{className:"w-4 h-4"})})]},$))}):a.jsx("p",{className:"text-sm text-text-muted text-center py-4",children:"Nenhuma quadra adicionada"})]}),a.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Pl,{className:"w-5 h-5 text-brand"}),a.jsx("h3",{className:"font-semibold text-text-primary",children:"Mesas da Loja"})]}),a.jsxs(fe,{type:"button",onClick:_,size:"sm",className:"gap-2",children:[a.jsx(Ja,{className:"w-4 h-4"}),"Adicionar Mesa"]})]}),u.mesas.length>0?a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:u.mesas.map((W,$)=>a.jsxs("div",{className:"flex items-center justify-between bg-background rounded-md p-3 border border-border",children:[a.jsx("span",{className:"text-sm text-text-primary",children:W.nome}),a.jsx(fe,{type:"button",variant:"ghost",size:"sm",onClick:()=>S($),className:"h-8 w-8 p-0 text-danger hover:text-danger hover:bg-danger/10",children:a.jsx(al,{className:"w-4 h-4"})})]},$))}):a.jsx("p",{className:"text-sm text-text-muted text-center py-4",children:"Nenhuma mesa adicionada"})]}),a.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Td,{className:"w-5 h-5 text-brand"}),a.jsx("h3",{className:"font-semibold text-text-primary",children:"Categorias de Produtos"})]}),a.jsxs(fe,{type:"button",onClick:C,size:"sm",className:"gap-2",children:[a.jsx(Ja,{className:"w-4 h-4"}),"Adicionar Categoria"]})]}),u.categorias.length>0?a.jsx("div",{className:"space-y-2",children:u.categorias.map((W,$)=>a.jsxs("div",{className:"flex items-center justify-between bg-background rounded-md p-3 border border-border",children:[a.jsx("span",{className:"text-sm text-text-primary",children:W.nome}),a.jsx(fe,{type:"button",variant:"ghost",size:"sm",onClick:()=>P($),className:"h-8 w-8 p-0 text-danger hover:text-danger hover:bg-danger/10",children:a.jsx(al,{className:"w-4 h-4"})})]},$))}):a.jsx("p",{className:"text-sm text-text-muted text-center py-4",children:"Nenhuma categoria adicionada"})]}),a.jsx("div",{className:"bg-info/10 border border-info/30 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Bc,{className:"w-5 h-5 text-info mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-text-primary mb-1",children:"Configuraes Opcionais"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Voc pode adicionar quadras, mesas e categorias agora ou configurar depois no sistema."})]})]})}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsxs(fe,{type:"button",variant:"outline",onClick:b,className:"flex-1",children:[a.jsx(tb,{className:"mr-2 h-4 w-4"}),"Voltar"]}),a.jsxs(fe,{type:"button",onClick:x,className:"flex-1",children:["Prximo",a.jsx($2,{className:"ml-2 h-4 w-4"})]})]})]})]},"step4"),U=()=>a.jsxs(xr.div,{variants:Sv,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:a.jsx(Ro,{className:"w-8 h-8 text-brand"})}),a.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Reviso Final"}),a.jsx("p",{className:"text-text-muted",children:"Confira os dados antes de criar a empresa"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[a.jsxs("h3",{className:"font-semibold text-text-primary mb-4 flex items-center gap-2",children:[a.jsx(Uu,{className:"w-5 h-5"}),"Primeiro Usurio"]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Email:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.email})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Nome:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.nomeUsuario})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Cargo:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.cargo})]})]})]}),a.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[a.jsxs("h3",{className:"font-semibold text-text-primary mb-4 flex items-center gap-2",children:[a.jsx(K_,{className:"w-5 h-5"}),"Empresa"]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Razo Social:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.razaoSocial})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Nome Fantasia:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.nomeFantasia})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"CNPJ:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.cnpj})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Email:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.emailEmpresa})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Telefone:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.telefone})]}),u.endereco&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Endereo:"}),a.jsx("span",{className:"text-text-primary font-medium text-right",children:u.endereco})]})]})]}),a.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[a.jsxs("h3",{className:"font-semibold text-text-primary mb-4 flex items-center gap-2",children:[a.jsx(Ad,{className:"w-5 h-5"}),"Configuraes Iniciais"]}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Quadras:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.quadras.length})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Mesas:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.mesas.length})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Categorias de Produtos:"}),a.jsx("span",{className:"text-text-primary font-medium",children:u.categorias.length})]})]})]}),a.jsx("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Bc,{className:"w-5 h-5 text-warning mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-text-primary mb-1",children:"Ateno"}),a.jsx("p",{className:"text-xs text-text-muted",children:"Esta ao criar a empresa no banco de dados. Certifique-se de que todos os dados esto corretos."})]})]})}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsxs(fe,{type:"button",variant:"outline",onClick:b,className:"flex-1",disabled:s,children:[a.jsx(tb,{className:"mr-2 h-4 w-4"}),"Voltar"]}),a.jsx(fe,{type:"button",onClick:A,className:"flex-1 bg-emerald-600 hover:bg-emerald-500",disabled:s,children:s?a.jsxs(a.Fragment,{children:[a.jsx(Tc,{className:"mr-2 h-4 w-4 animate-spin"}),"Criando..."]}):a.jsx(a.Fragment,{children:" Criar Empresa"})})]})]})]},"step5"),z=()=>a.jsxs(xr.div,{variants:Sv,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-success/10 rounded-full mb-6",children:a.jsx(Ro,{className:"w-12 h-12 text-success"})}),a.jsx("h2",{className:"text-3xl font-bold text-text-primary mb-2",children:" Empresa Criada!"}),a.jsx("p",{className:"text-text-muted",children:"Tudo pronto para comear a usar o sistema"})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-brand/10 border border-brand/30 rounded-lg p-6",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-sm text-text-muted mb-2",children:"Cdigo da Empresa"}),a.jsx("p",{className:"text-3xl font-bold text-brand font-mono",children:h?.codigoEmpresa})]})}),a.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[a.jsx("h3",{className:"font-semibold text-text-primary mb-4",children:"Dados de Acesso"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Email:"}),a.jsx("span",{className:"text-text-primary font-medium",children:h?.email})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-text-muted",children:"Senha:"}),a.jsx("span",{className:"text-text-primary font-medium",children:"(a que voc definiu no Supabase)"})]})]})]}),a.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[a.jsx("h3",{className:"font-semibold text-text-primary mb-4",children:"Dados Criados"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:""}),a.jsx("div",{className:"text-xs text-text-muted",children:"Empresa"})]}),a.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:""}),a.jsx("div",{className:"text-xs text-text-muted",children:"Configuraes"})]}),a.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:h?.numQuadras}),a.jsx("div",{className:"text-xs text-text-muted",children:"Quadras"})]}),a.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:h?.numMesas}),a.jsx("div",{className:"text-xs text-text-muted",children:"Mesas"})]}),a.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:h?.numCategorias}),a.jsx("div",{className:"text-xs text-text-muted",children:"Categorias"})]}),a.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:""}),a.jsx("div",{className:"text-xs text-text-muted",children:"Pronto para Uso"})]})]})]}),a.jsx("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Bc,{className:"w-5 h-5 text-warning mt-0.5"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-text-primary mb-2",children:" IMPORTANTE: Execute o SQL Antes de Fazer Login"}),a.jsxs("div",{className:"space-y-2 text-xs text-text-muted",children:[a.jsx("p",{className:"font-semibold text-text-primary",children:"Para vincular seu usurio  empresa, siga estes passos:"}),a.jsxs("ol",{className:"list-decimal list-inside space-y-1 ml-2",children:[a.jsxs("li",{children:["Abra o ",a.jsx("strong",{children:"Console do Navegador"})," (pressione F12)"]}),a.jsxs("li",{children:["Procure pela mensagem ",a.jsx("strong",{children:'" APS O PRIMEIRO LOGIN, execute este SQL"'})]}),a.jsx("li",{children:"Copie o comando SQL que aparece no console"}),a.jsxs("li",{children:["Acesse o ",a.jsx("strong",{children:"Supabase  SQL Editor"})]}),a.jsx("li",{children:"Cole e execute o SQL"}),a.jsx("li",{children:"Agora sim, faa login normalmente"})]}),a.jsx("p",{className:"mt-2 text-warning font-medium",children:' Se no executar o SQL, voc ver o erro "Empresa no vinculada"'})]})]})]})}),a.jsx("div",{className:"pt-4",children:a.jsx(fe,{type:"button",onClick:()=>t("/"),className:"w-full bg-brand hover:bg-brand/90",children:"Ir para Login"})})]})]},"step6");return a.jsx(a.Fragment,{children:a.jsx("div",{className:"min-h-screen bg-background text-text-primary p-8",children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[R(),a.jsxs(dge,{mode:"wait",children:[r===1&&O(),r===2&&I(),r===3&&M(),r===4&&D(),r===5&&U(),r===6&&z()]})]})})})}const tlt=()=>a.jsx(xr.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:"flex justify-start mb-6",children:a.jsxs("div",{className:"flex items-end gap-3 max-w-[85%] md:max-w-[75%]",children:[a.jsx(gi,{size:"md",variant:"message"}),a.jsx("div",{className:"px-4 py-3 bg-brand border border-brand backdrop-blur-sm rounded-2xl rounded-bl-sm shadow-lg shadow-brand/20",children:a.jsx("div",{className:"flex gap-1.5",children:[0,1,2].map(e=>a.jsx(xr.div,{className:"w-2.5 h-2.5 md:w-2 md:h-2 bg-[#0A0A0A] rounded-full",animate:{y:[0,-6,0],opacity:[.4,1,.4]},transition:{duration:.8,repeat:1/0,delay:e*.2,ease:"easeInOut"}},e))})})]})}),rlt=({buttons:e,onSelect:t,disabled:r=!1,hideText:n=!1,hidden:s=!1})=>a.jsx(xr.div,{initial:{opacity:0,y:10,gridTemplateRows:"1fr"},animate:{opacity:s?0:1,y:s?-8:0,gridTemplateRows:s?"0fr":"1fr"},transition:{duration:.6,ease:[.16,1,.3,1]},className:`grid ml-12 md:ml-[68px] overflow-hidden transition-all duration-500 ${s?"mb-0 md:mb-0 pointer-events-none":"mb-2 md:mb-3"}`,children:a.jsx("div",{className:"flex flex-wrap gap-2 md:gap-2.5",children:e.map((o,i)=>a.jsx(xr.button,{initial:{opacity:0,scale:.92,y:4,filter:"blur(2px)"},animate:{opacity:s||n?0:1,scale:s?.96:1,y:s?-8:0,filter:s?"blur(3.5px)":"blur(0px)"},transition:{duration:s?.4:.45,delay:s?i*.03:.2+i*.05,ease:[.16,1,.3,1]},whileHover:{scale:r?1:1.02,y:r?0:-2},whileTap:{scale:r?1:.98},onClick:()=>!r&&t(o),disabled:r,className:`
              group relative px-5 py-3.5 md:px-6 md:py-4 rounded-xl font-semibold text-[15px] md:text-[15px]
              transition-all duration-300 ease-out
              ${r?"bg-surface/30 text-text-muted cursor-not-allowed border border-white/5":"bg-surface/70 backdrop-blur-sm text-text-primary border border-white/10 hover:border-brand/70 hover:bg-brand/10 hover:text-brand hover:shadow-lg hover:shadow-brand/20 shadow-md"}
              ${n?"opacity-0 pointer-events-none":""}
            `,children:a.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1 relative z-10",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[o.icon&&!n&&a.jsx("span",{className:`text-base md:text-lg transition-transform duration-300 ${!r&&"group-hover:scale-110"}`,children:o.icon}),!n&&a.jsx("span",{className:"font-semibold",children:o.label})]}),o.subtitle&&!n&&a.jsx("span",{className:"text-[12px] md:text-xs opacity-70 pl-6 md:pl-7 font-normal",children:o.subtitle})]})},o.value||i))})}),nlt=({children:e,onButtonClick:t,hideButtonTexts:r=!1})=>{const{messages:n,isTyping:s,chatEndRef:o}=zC(),[i,l]=p.useState(0),[c,d]=p.useState(void 0);return p.useEffect(()=>{const u=f=>{const h=!!f?.detail?.expanded,m=typeof window<"u"&&window.innerWidth<768,v=m?280:320,g=140,y=m?8:20,x=Math.max(0,v-g+y);l(h?x:0),d(h&&m?0:void 0)};try{window.addEventListener("isis-participantes-expand",u)}catch{}return()=>{try{window.removeEventListener("isis-participantes-expand",u)}catch{}}},[]),a.jsxs("div",{className:"flex flex-col min-h-full",children:[a.jsxs("div",{className:"flex-1 px-3 md:px-6 py-4 md:py-8",style:{paddingBottom:i,paddingTop:c},children:[n.map(u=>a.jsxs(xr.div,{layout:"position",transition:{duration:.35,ease:[.16,1,.3,1]},children:[a.jsx(hoe,{message:u}),u.type==="buttons"&&u.buttons&&a.jsx("div",{className:`overflow-hidden transition-all duration-500 ${u.buttonsHidden?"max-h-0 mb-0 md:mb-0":"max-h-[480px]"}`,children:a.jsx(rlt,{buttons:u.buttons,onSelect:f=>(t||u.onButtonClick)?.(f,u.id),disabled:u.disabled,hideText:r,hidden:!!u.buttonsHidden})})]},u.id)),s&&a.jsx(tlt,{}),a.jsx("div",{ref:o})]}),a.jsx("div",{className:"sticky bottom-0 px-3 md:px-6 pb-3 md:pb-6 pt-3 md:pt-4 bg-gradient-to-t from-background via-background to-transparent",children:e})]})},alt=({onSubmit:e,onMudarData:t,onMudarQuadra:r,hasMultipleQuadras:n=!1,disabled:s=!1,horariosDisponiveis:o=[],esportes:i=[]})=>{const[l,c]=p.useState(""),[d,u]=p.useState(""),[f,h]=p.useState(""),m=o.map((g,y)=>{let x=o[y].fim,b=0,w=y+1;for(;w<o.length&&o[w].inicio===x;)b++,x=o[w].fim,w++;const j=b>=1;return{value:g.inicio,label:g.inicio,available:j}}),v=(()=>{if(!l)return[];const g=o.findIndex(w=>w.inicio===l);if(g===-1)return[];const y=[];let x=o[g].fim,b=0;for(let w=g+1;w<o.length;w++){const j=o[w];if(j.inicio!==x)break;b++,b>=1&&y.push({value:j.fim,label:j.fim,available:!0}),x=j.fim}return y})();return p.useEffect(()=>{l&&d&&f&&!s&&e({inicio:l,fim:d,esporte:f})},[l,d,f]),p.useEffect(()=>{l&&u("")},[l]),a.jsxs(xr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},className:"flex flex-col gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-sm md:text-xs",children:[a.jsx(Pd,{className:"w-4 h-4"}),a.jsx("span",{className:"font-medium",children:"Horrio desejado"})]}),a.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{htmlFor:"horario-inicio",className:"text-xs text-text-muted mb-1 block",children:"Incio"}),a.jsxs(vn,{value:l,onValueChange:c,disabled:s,children:[a.jsx(hn,{className:"w-full bg-surface/70 backdrop-blur-sm border-white/10 text-[15px] md:text-sm",children:a.jsx(wn,{placeholder:"Selecione"})}),a.jsx(pn,{className:"max-h-[300px] z-[60]",children:m.filter(g=>g.available).map(g=>a.jsx(ct,{value:g.value,children:a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx(Pd,{className:"w-4 h-4 opacity-80"}),g.label]})},g.value))})]})]}),a.jsx("div",{className:"text-text-muted font-bold text-lg pt-5",children:""}),a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{htmlFor:"horario-fim",className:"text-xs text-text-muted mb-1 block",children:"Trmino"}),a.jsxs(vn,{value:d,onValueChange:u,disabled:!l||s,children:[a.jsx(hn,{className:"w-full bg-surface/70 backdrop-blur-sm border-white/10 text-[15px] md:text-sm",children:a.jsx(wn,{placeholder:"Selecione"})}),a.jsx(pn,{className:"max-h-[300px] z-[60]",children:v.filter(g=>g.available).map(g=>a.jsx(ct,{value:g.value,children:a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx(Pd,{className:"w-4 h-4 opacity-80"}),g.label]})},g.value))})]})]})]}),a.jsxs("div",{className:"flex items-end gap-2 md:gap-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{htmlFor:"esporte",className:"text-xs text-text-muted mb-1 block",children:"Esporte"}),a.jsxs(vn,{value:f,onValueChange:h,disabled:s,children:[a.jsx(hn,{className:"w-full bg-surface/70 backdrop-blur-sm border-white/10 text-[15px] md:text-sm",children:a.jsx(wn,{placeholder:"Selecione o esporte"})}),a.jsx(pn,{className:"max-h-[300px] z-[60]",children:i.map(g=>a.jsx(ct,{value:g,children:g},g))})]})]}),t&&a.jsxs(xr.button,{type:"button",onClick:t,disabled:s,whileHover:{scale:s?1:1.05},whileTap:{scale:s?1:.95},className:`
              px-4 py-2.5 rounded-xl font-medium text-sm
              transition-all duration-300 shrink-0
              flex items-center gap-2
              ${s?"bg-surface/30 text-text-muted cursor-not-allowed":"bg-surface/70 backdrop-blur-sm border border-white/10 text-text-primary hover:bg-surface/90 hover:border-white/20"}
            `,children:[a.jsx(Bs,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden md:inline",children:"Mudar Data"}),a.jsx("span",{className:"md:hidden",children:"data"})]}),n&&r&&a.jsxs(xr.button,{type:"button",onClick:r,disabled:s,whileHover:{scale:s?1:1.05},whileTap:{scale:s?1:.95},className:`
              px-4 py-2.5 rounded-xl font-medium text-sm
              transition-all duration-300 shrink-0
              flex items-center gap-2
              ${s?"bg-surface/30 text-text-muted cursor-not-allowed":"bg-surface/70 backdrop-blur-sm border border-white/10 text-text-primary hover:bg-surface/90 hover:border-white/20"}
            `,children:[a.jsx(Dc,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden md:inline",children:"Mudar Quadra"}),a.jsx("span",{className:"md:hidden",children:"Quadra"})]})]})]})},slt=({onSubmit:e,tipo:t,onTrocarTipo:r,disabled:n=!1,mostrarBotaoTrocar:s=!0})=>{const[o,i]=p.useState(""),[l,c]=p.useState(!1),[d,u]=p.useState(!1);p.useEffect(()=>{i("")},[t]);const f=w=>{if(w){const j=cr(w,"dd/MM/yyyy",{locale:na});i(j),u(!1)}},h=w=>{const j=w.replace(/\D/g,"");return j.length<=2?`(${j}`:j.length<=7?`(${j.slice(0,2)}) ${j.slice(2)}`:j.length===10?`(${j.slice(0,2)}) ${j.slice(2,6)}-${j.slice(6)}`:j.length===11?`(${j.slice(0,2)}) ${j.slice(2,7)}-${j.slice(7)}`:`(${j.slice(0,2)}) ${j.slice(2,7)}-${j.slice(7,11)}`},m=w=>{const j=w.replace(/\D/g,"");return j.length<=2?j:j.length<=4?`${j.slice(0,2)}/${j.slice(2)}`:j.length<=8?`${j.slice(0,2)}/${j.slice(2,4)}/${j.slice(4)}`:`${j.slice(0,2)}/${j.slice(2,4)}/${j.slice(4,8)}`},v=w=>{const j=w.target.value;if(t==="telefone"){const _=h(j);i(_)}else if(t==="data_custom"){const _=m(j);i(_)}else i(j)},g=w=>{if(w.preventDefault(),!(!o.trim()||n))if(t==="telefone"){const j=o.replace(/\D/g,"");j.length===11&&(e(j),i(""))}else t==="data_custom"?o.trim()&&(e(o.trim()),i("")):o.includes("@")&&o.includes(".")&&(e(o.trim()),i(""))},y=w=>{w.key==="Enter"&&(w.preventDefault(),g(w))},x=w=>{if(w.length!==10)return{valida:!1,erro:"Data incompleta"};const j=/^(\d{2})\/(\d{2})\/(\d{4})$/,_=w.match(j);if(!_)return{valida:!1,erro:"Formato invlido"};const[,S,C,P]=_,A=new Date(parseInt(P),parseInt(C)-1,parseInt(S));if(isNaN(A.getTime())||A.getDate()!==parseInt(S)||A.getMonth()!==parseInt(C)-1||A.getFullYear()!==parseInt(P))return{valida:!1,erro:"Data invlida"};const R=new Date;return R.setHours(0,0,0,0),A.setHours(0,0,0,0),A<R?{valida:!1,erro:"Data no passado"}:{valida:!0,erro:null}},b=()=>t==="telefone"?o.replace(/\D/g,"").length===11:t==="data_custom"?x(o).valida:o.includes("@")&&o.includes(".");return a.jsxs(xr.form,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},onSubmit:g,className:"flex flex-col gap-3 max-w-md mx-auto",children:[a.jsx("div",{className:"relative",children:a.jsxs("div",{className:`
          flex items-center gap-2 px-3 py-2.5 rounded-xl
          bg-surface/70 backdrop-blur-sm
          border-2 transition-all duration-300
          ${l?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
        `,children:[t!=="data_custom"&&a.jsx("div",{className:`
              shrink-0 transition-colors duration-300
              ${l?"text-brand":"text-text-muted"}
            `,children:t==="telefone"?a.jsx(tw,{className:"w-4 h-4"}):a.jsx(Ox,{className:"w-4 h-4"})}),a.jsxs("div",{className:"flex-1 relative flex items-center",children:[a.jsx("input",{type:t==="data_custom"?"text":t==="telefone"?"tel":"email",value:o,onChange:v,onKeyDown:y,onFocus:()=>c(!0),onBlur:()=>c(!1),placeholder:t==="telefone"?"(00) 00000-0000":t==="data_custom"?"DD/MM/AAAA":"email@exemplo.com",disabled:n,className:`
                w-full bg-transparent text-text-primary placeholder:text-text-muted
                outline-none text-[17px] md:text-base font-medium
                ${t==="data_custom"?"pr-12":""}
                ${n?"opacity-50 cursor-not-allowed":""}
              `}),t==="data_custom"&&a.jsxs(vi,{open:d,onOpenChange:u,children:[a.jsx(xi,{asChild:!0,children:a.jsx(xr.button,{type:"button",whileHover:{scale:1.1},whileTap:{scale:.9},disabled:n,className:`
                      absolute right-1 w-10 h-10 rounded-xl flex items-center justify-center transition-all duration-300
                      bg-brand/10 text-brand hover:bg-brand hover:text-white
                      border border-brand/20 hover:border-brand/40
                      shadow-md hover:shadow-lg hover:shadow-brand/30
                      ${n?"opacity-50 cursor-not-allowed":"cursor-pointer"}
                    `,children:a.jsx(Bs,{className:"w-5 h-5"})})}),a.jsx(ni,{className:"w-auto p-0",align:"end",children:a.jsx(yi,{mode:"single",selected:o?(()=>{try{const[w,j,_]=o.split("/");return new Date(parseInt(_),parseInt(j)-1,parseInt(w))}catch{return}})():void 0,onSelect:f,disabled:w=>{const j=new Date;return j.setHours(0,0,0,0),w<j},initialFocus:!0})})]})]}),a.jsx(xr.button,{type:"submit",whileHover:{scale:b()?1.1:1},whileTap:{scale:b()?.9:1},disabled:!b()||n,className:`
              shrink-0 w-9 h-9 rounded-full flex items-center justify-center transition-all duration-300
              ${b()?"bg-brand text-bg shadow-md hover:shadow-lg hover:shadow-brand/30":"bg-surface-light text-text-muted cursor-not-allowed opacity-50"}
            `,children:a.jsx(S4,{className:"w-4 h-4"})})]})}),t==="telefone"&&o&&a.jsx("div",{className:"text-xs text-center",children:(()=>{const w=o.replace(/\D/g,""),j=w.length===11,_=w.length>0&&!j;return j?a.jsx("span",{className:"text-green-400 flex items-center justify-center gap-1",children:" Telefone vlido"}):_?a.jsxs("span",{className:"text-yellow-400 flex items-center justify-center gap-1",children:[" Digite todos os dgitos (",w.length,"/11)"]}):null})()}),t==="data_custom"&&o&&a.jsx("div",{className:"text-xs text-center",children:(()=>{const w=x(o);return w.valida?a.jsx("span",{className:"text-green-400 flex items-center justify-center gap-1",children:" Data vlida"}):o.length>0?a.jsxs("span",{className:"text-red-400 flex items-center justify-center gap-1",children:[" ",w.erro]}):null})()}),s&&t!=="data_custom"&&a.jsx("button",{type:"button",onClick:r,className:"text-sm text-brand/80 hover:text-brand hover:underline self-center py-1 px-3 rounded-lg hover:bg-brand/5 transition-all",children:t==="telefone"?a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(Ox,{className:"w-4 h-4"}),"Prefiro usar e-mail"]}):a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(tw,{className:"w-4 h-4"}),"Prefiro usar telefone"]})})]})},olt=({onSubmit:e,disabled:t=!1,valorInicial:r=null,tipoInicial:n="telefone",onCorrigirTelefone:s,onCorrigirEmail:o})=>{const[i,l]=p.useState(""),[c,d]=p.useState(n==="telefone"&&r||""),[u,f]=p.useState(n==="email"&&r||""),[h,m]=p.useState(null),v=b=>{const w=b.replace(/\D/g,"");return w.length<=2?`(${w}`:w.length<=7?`(${w.slice(0,2)}) ${w.slice(2)}`:w.length<=11?`(${w.slice(0,2)}) ${w.slice(2,7)}-${w.slice(7,11)}`:`(${w.slice(0,2)}) ${w.slice(2,7)}-${w.slice(7,11)}`},g=b=>{const w=v(b.target.value);d(w)},y=b=>{if(b.preventDefault(),!i.trim())return;const w=c.replace(/\D/g,"").length>=10,j=u.trim().includes("@")&&u.trim().includes(".");if(!w&&!j)return;const _={nome:i.trim(),telefone:w?c.replace(/\D/g,""):null,email:j?u.trim():null};e(_)},x=()=>{if(!i.trim())return!1;const b=c.replace(/\D/g,"").length>=10,w=u.trim().includes("@")&&u.trim().includes(".");return b||w};return a.jsxs(xr.form,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},onSubmit:y,className:"flex flex-col gap-3",children:[a.jsxs("div",{className:`
        flex items-center gap-3 px-4 py-3 rounded-2xl
        bg-surface/70 backdrop-blur-sm
        border-2 transition-all duration-300
        ${h==="nome"?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
      `,children:[a.jsx(Uu,{className:`w-5 h-5 transition-colors ${h==="nome"?"text-brand":"text-text-muted"}`}),a.jsx("input",{type:"text",value:i,onChange:b=>l(b.target.value),onFocus:()=>m("nome"),onBlur:()=>m(null),placeholder:"Seu nome completo",disabled:t,className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-[17px] md:text-base font-medium"})]}),a.jsxs("div",{className:`
        flex items-center gap-3 px-4 py-3 rounded-2xl
        bg-surface/70 backdrop-blur-sm
        border-2 transition-all duration-300
        ${h==="telefone"?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
      `,children:[a.jsx(tw,{className:`w-5 h-5 transition-colors ${h==="telefone"?"text-brand":"text-text-muted"}`}),a.jsx("input",{type:"tel",value:c,onChange:g,onFocus:()=>m("telefone"),onBlur:()=>m(null),placeholder:"(00) 00000-0000",disabled:t,className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-[17px] md:text-base font-medium"})]}),a.jsxs("div",{className:`
        flex items-center gap-3 px-4 py-3 rounded-2xl
        bg-surface/70 backdrop-blur-sm
        border-2 transition-all duration-300
        ${h==="email"?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
      `,children:[a.jsx(Ox,{className:`w-5 h-5 transition-colors ${h==="email"?"text-brand":"text-text-muted"}`}),a.jsx("input",{type:"email",value:u,onChange:b=>f(b.target.value),onFocus:()=>m("email"),onBlur:()=>m(null),placeholder:"email@exemplo.com (opcional)",disabled:t,className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-[17px] md:text-base font-medium"})]}),(s||o)&&a.jsx("div",{className:"-mt-1 mb-1",children:n==="email"&&o?a.jsx("button",{type:"button",onClick:o,className:"text-xs text-brand/80 hover:text-brand underline underline-offset-4 px-1 py-0.5 rounded-md hover:bg-brand/5",children:"Informei o e-mail errado"}):s&&a.jsx("button",{type:"button",onClick:s,className:"text-xs text-brand/80 hover:text-brand underline underline-offset-4 px-1 py-0.5 rounded-md hover:bg-brand/5",children:"Informei o telefone errado"})}),a.jsxs(xr.button,{type:"submit",whileHover:{scale:x()?1.02:1},whileTap:{scale:x()?.98:1},disabled:!x()||t,className:`
          flex items-center justify-center gap-2 py-3 px-6 rounded-2xl
          font-semibold text-base transition-all duration-300
          ${x()?"bg-brand text-bg shadow-lg shadow-brand/20 hover:shadow-xl hover:shadow-brand/30":"bg-surface-light text-text-muted cursor-not-allowed opacity-50"}
        `,children:[a.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M5 13l4 4L19 7"})}),"Continuar"]}),a.jsx("p",{className:"text-xs text-text-muted text-center",children:"Preencha pelo menos telefone ou e-mail"})]})},ilt=({participantesAtuais:e=[],onAdicionar:t,onRemover:r,onFinalizar:n,disabled:s=!1,onAdicionarLote:o,selfName:i,onFixedRolesDetected:l,initialModalidade:c="",modalidadeOptions:d=[]})=>{const[u,f]=p.useState(""),[h,m]=p.useState(!1),[v,g]=p.useState(!1),y=p.useRef(null),[x,b]=p.useState(!1),[w,j]=p.useState(""),[_,S]=p.useState(!1),[C,P]=p.useState([]),[A,R]=p.useState([]),[O,I]=p.useState({}),[M,D]=p.useState(!1),[U,z]=p.useState(!1),[W,$]=p.useState(null),[X,ye]=p.useState(!1),Se=p.useRef(null),V=p.useRef(null),[B,Q]=p.useState(c||"");p.useEffect(()=>{Q(c||"")},[c]),p.useEffect(()=>{const _e=()=>{g(window.innerWidth<768)};return _e(),window.addEventListener("resize",_e),()=>window.removeEventListener("resize",_e)},[]),p.useEffect(()=>{if(x){const _e=document.body.style.overflow;return document.body.style.overflow="hidden",P([]),R([]),I({}),D(!1),z(!1),$(null),()=>{document.body.style.overflow=_e}}},[x]),p.useEffect(()=>{if(x&&ne&&(!C||C.length===0)){const _e=te(ne);P([ne]),I({[_e]:!0}),$(_e),z(!0),D(!0)}},[x]);const pe=_e=>_e.normalize("NFD").replace(/[\u0300-\u036f]/g,""),te=_e=>pe(String(_e||"").trim().toLowerCase()).replace(/\s+/g," "),Y=_e=>String(_e||"").replace(/^\s*[*-]+/g,"").replace(/^\s*\d+\s*[\-\)\.]\s*/g,"").replace(/^[\W_]+|[\W_]+$/g,"").replace(//g,"").replace(/@[\S]+/g,"").replace(/\(\s*[mf]\s*\)/gi,"").replace(/\(\s*[mf][^)]*\)?/gi,"").replace(/\s{2,}/g," ").trim(),ce=_e=>/^(espera|lista\s+de\s+espera)\b/i.test(pe(String(_e||"").trim().toLowerCase())),me=_e=>/^(jogador|jogadores|goleiro|goleiros|convocado|convocados|jogadore?s)\b/i.test(pe(String(_e||"").trim().toLowerCase())),ae=_e=>{const je=pe(String(_e||"")).trim().toLowerCase();return/^(jogador|jogadores|goleiro|goleiros|convocado|convocados|levantador|levantadores)\b/.test(je)||/^(lista\s+de\s+espera|convidad\w*)\b/.test(je)},le=_e=>{const je=String(_e||"").split(/\r?\n/);let Ue=!1,ze=!1;const or=[];for(const yr of je){const Me=String(yr||"").trim();if(!Me)continue;if(ce(Me)){Ue=!0;continue}if(Ue)continue;if(me(Me)){ze=!0;continue}if(!ze)continue;const dt=Y(Me),ut=/[A-Za-z---]/.test(dt);dt&&dt.length>=2&&dt.length<=60&&ut&&!/[0-9@]/.test(dt)&&or.push(dt.split(/\s+/).map(hr=>hr&&hr[0].toUpperCase()+hr.slice(1).toLowerCase()).join(" "))}const tr=new Set,Nt=[];for(const yr of or){const Me=te(yr);!Me||tr.has(Me)||(tr.add(Me),Nt.push(yr))}return Nt},ue=_e=>/^(reservas?)\b/i.test(pe(String(_e||"").trim().toLowerCase())),Re=_e=>{const je=String(_e||"").split(/\r?\n/),Ue=[];let ze=!1,or=!1;for(const tr of je){const Nt=String(tr||"").trim();if(!Nt)continue;if(ce(Nt)){ze=!0,or=!1;continue}if(me(Nt)||ue(Nt)){ze=!1,or=!0;continue}if(ze||!or)continue;const yr=Y(Nt),Me=/[A-Za-z---]/.test(yr);if(!(yr&&yr.length>=2&&yr.length<=60&&Me&&!/[0-9@]/.test(yr)))continue;const ut=yr.split(/\s+/).map(rr=>rr&&rr[0].toUpperCase()+rr.slice(1).toLowerCase()).join(" ");ae(ut)||Ue.push(ut)}return Ue};new Set((e||[]).map(_e=>te(_e.nome)));const ne=i?String(i).trim():e&&e[0]&&e[0].nome?String(e[0].nome).trim():null,ie=ne?te(ne):null,gt=_e=>pe(String(_e||"").toLowerCase()).split(/\s+/).map(je=>je.trim()).filter(je=>je.length>=3),bt=_e=>{if(!ne)return!1;const je=String(_e||"").trim();if(!je)return!1;if(te(je)===ie)return!0;const Ue=gt(ne),ze=gt(je);return Ue.length===0||ze.length===0?!1:ze.some(or=>Ue.includes(or))},at=_e=>{const je=new Set;if(!_e)return je;const Ue=String(_e).split(/\r?\n/);let ze=!1;for(let or of Ue){const tr=pe(String(or||"")).toLowerCase().trim();if(!ze){/^\s*[*\-]?\s*((lista\s+de\s+)?espera|convidad\w*)\b[\s:]*$/i.test(tr)&&(ze=!0);continue}if(/^\s*\*\s*\w+|^\s*(convocad|jogad|levanta|goleir)\w*/i.test(pe(or))){ze=!1;continue}const Nt=String(or).replace(/^\s*[*\-]+\s*/g,"").replace(/^\s*\d+\)?\s*/g,"").replace(/^[\W_]+/,"").trim(),yr=/[A-Za-z---]/.test(Nt);Nt&&yr&&!/[0-9@]/.test(Nt)&&Nt.length>=2&&Nt.length<=60&&je.add(te(Nt))}return je},xt=_e=>{const je=String(_e||"").split(/\r?\n/),Ue={levantadores:[],goleiros:[]};let ze=null;for(let or of je){const tr=pe(String(or||"")).toLowerCase().trim();if(/^\s*[*\-]?\s*levanta(dor|dores|dor(es)?)\b/i.test(tr)){ze="levantadores";continue}if(/^\s*[*\-]?\s*goleir(o|os|a|as)\b/i.test(tr)){ze="goleiros";continue}if(ze){if(/(^|\s)jogador(e|es)\b/.test(tr)){ze=null;continue}if(/^\s*[*\-]?\s*(convocad|lista\s+de\s+(espera|reserva)|convidad)\b/i.test(tr)){ze=null;continue}if(/^\s*[*_]{1,3}\s*[a-z-]+/i.test(tr)){ze=null;continue}if(/^\s*[*\-]?\s*(levanta|goleir)\b/i.test(tr)){ze=null;continue}}if(!ze)continue;const Nt=String(or).replace(/^\s*[*\-]+\s*/g,"").replace(/^\s*\d+\)?\s*/g,"").replace(/^[\W_]+/,"").trim(),yr=/[A-Za-z---]/.test(Nt);if(!(Nt&&yr&&!/[0-9@]/.test(Nt)&&Nt.length>=2&&Nt.length<=60))continue;const dt=Nt.toLowerCase().split(/\s+/).map(rr=>rr&&rr[0].toUpperCase()+rr.slice(1)).join(" "),ut=te(dt);ze==="levantadores"?Ue.levantadores.some(rr=>te(rr)===ut)||Ue.levantadores.push(dt):ze==="goleiros"&&(Ue.goleiros.some(rr=>te(rr)===ut)||Ue.goleiros.push(dt))}return Ue},Ze=_e=>{_e.preventDefault(),!(!u.trim()||s)&&(t(u.trim()),f(""),setTimeout(()=>{y.current?.focus()},100))},ht=_e=>{_e.key==="Enter"&&!v&&(_e.preventDefault(),_e.shiftKey?n&&n(B):Ze(_e))},Wt=async()=>{if(w.trim()){S(!0),P([]),R([]),I({});try{try{console.group("[Isis Import] start"),console.debug("[Isis Import] input.length=%s preview=%o",w.length,w.slice(0,180))}catch{}const{data:_e,error:je}=await de.functions.invoke("parse-participants",{body:{text:w,locale:"pt-BR"}});if(je)throw je;if(_e&&typeof _e.source=="string"){console.log("[Isis Import] source=",_e.source);try{console.debug("[Isis Import] edge.meta keys=%o",Object.keys(_e||{}))}catch{}}const Ue=at(w);try{console.debug("[Isis Import] waitlist.count=%s sample=%o",Ue.size,Array.from(Ue).slice(0,8))}catch{}const ze=Array.isArray(_e?.roles?.levantadores)?_e.roles.levantadores:[],or=Array.isArray(_e?.roles?.goleiros)?_e.roles.goleiros:[],tr=ze.length||or.length?{levantadores:ze,goleiros:or}:xt(w);try{console.debug("[Isis Import] roles.edge lev=%s gol=%s",ze.length,or.length)}catch{}try{ze.length||or.length||console.debug("[Isis Import] roles.local lev=%s gol=%s",tr.levantadores.length,tr.goleiros.length)}catch{}const Nt=Array.isArray(_e?.extracted)?_e.extracted:[];let yr=Nt.filter(Mr=>!Ue.has(te(Mr)));yr=yr.filter(Mr=>!ae(Mr));try{console.debug("[Isis Import] extracted.raw=%s filtered=%s sample=%o",Nt.length,yr.length,yr.slice(0,10))}catch{}try{if(yr.length<6&&/(goleir|jogador)/i.test(pe(w))){const Ye=le(w);try{console.debug("[Isis Import] local.mainOnly=%s sample=%o",Ye.length,Ye.slice(0,10))}catch{}const $e=[...yr],Be=new Set($e.map(te));for(const et of Ye){const jt=te(et);!jt||Be.has(jt)||Ue.has(jt)||(Be.add(jt),$e.push(et))}yr=$e.filter(et=>!ae(et));try{console.debug("[Isis Import] boosted.count=%s",yr.length)}catch{}}}catch{}const Me=yr.some(Mr=>bt(Mr)),dt=Array.isArray(_e?.invalid)?_e.invalid:[],ut=[],rr=new Set;for(const Mr of yr){const Ye=Y(Mr);if(!Ye)continue;const $e=te(Ye);if(!$e||rr.has($e))continue;rr.add($e);const Be=Ye.split(/\s+/).map(et=>et&&et[0].toUpperCase()+et.slice(1).toLowerCase()).join(" ");ut.push(Be)}try{console.debug("[Isis Import] uniques.count=%s sample=%o",ut.length,ut.slice(0,12))}catch{}try{console.debug("[Isis Import] invalid.count=%s sample=%o",dt.length,dt.slice(0,6))}catch{}try{console.debug("[Isis Import] detectedSelf=%s self=%o",Me,ne)}catch{}const hr=le(w),It=new Map(hr.map((Mr,Ye)=>[te(Mr),Ye])),dr=Re(w);let ur=dr&&dr.length?dr.slice(0,200):(()=>{const Mr=ut.map((Ye,$e)=>({n:Ye,i:$e}));return Mr.sort((Ye,$e)=>{const Be=It.has(te(Ye.n))?It.get(te(Ye.n)):Number.MAX_SAFE_INTEGER,et=It.has(te($e.n))?It.get(te($e.n)):Number.MAX_SAFE_INTEGER;return Be!==et?Be-et:Ye.i-$e.i}),Mr.map(Ye=>Ye.n).slice(0,50)})(),er=ur.findIndex(Mr=>bt(Mr));if(er>=0){const Mr=ur[er];$(te(Mr)),ur=[Mr,...ur.filter((Ye,$e)=>$e!==er)]}else if(ne){const Mr=te(ne);$(Mr),z(!0),ur=[ne,...ur]}else $(null);P(ur),R(dt);const ln={};ne&&(ln[te(ne)]=!0),ut.slice(0,50).forEach(Mr=>{ln[te(Mr)]=!0}),I(ln),D(!0),z(Me||!!ne);try{typeof l=="function"?l(tr):window.dispatchEvent(new CustomEvent("isis:fixed-roles",{detail:tr}))}catch{}try{console.debug("[Isis Import] final.suggested.count=%s sample=%o",ur.length,ur.slice(0,12))}catch{}try{console.groupEnd?.()}catch{}}catch(_e){try{console.error("[Isis Import] error=%o",_e)}catch{}const je=at(w),Ue=xt(w),ze=w.split(/[\n,;]+/).map(dt=>dt.trim()).filter(Boolean),or=ze.some(dt=>{const ut=dt.replace(/^[\W_]+|[\W_]+$/g,"");return bt(ut)}),tr=[],Nt=new Set;for(const dt of ze){const ut=dt.replace(/^[\W_]+|[\W_]+$/g,""),rr=te(ut),hr=/[A-Za-z---]/.test(ut);if(!(ut.length>=2&&ut.length<=60&&hr&&!/[0-9@]/.test(ut))||!rr||je.has(rr)||Nt.has(rr))continue;Nt.add(rr);const dr=ut.toLowerCase().split(/\s+/).map(ur=>ur&&ur[0].toUpperCase()+ur.slice(1)).join(" ");tr.push(dr)}let yr=tr.slice(0,50);if(ne){const dt=te(ne);$(dt),z(!0),yr=[ne,...yr]}P(yr);const Me={};ne&&(Me[te(ne)]=!0),tr.slice(0,50).forEach(dt=>{Me[te(dt)]=!0}),I(Me),D(!0),z(or||!!ne);try{typeof l=="function"?l(Ue):window.dispatchEvent(new CustomEvent("isis:fixed-roles",{detail:Ue}))}catch{}}finally{S(!1)}}},be=_e=>{const je=te(_e);I(Ue=>({...Ue,[je]:!Ue[je]}))},Ct=()=>{const _e={...O};C.forEach(je=>{_e[te(je)]=!0}),I(_e)},wt=()=>{const _e={...O};C.forEach(je=>{_e[te(je)]=!1}),I(_e)},Ge=()=>{const _e=C.filter(je=>{const Ue=te(je);return W&&Ue===W?!1:O[Ue]});_e.length!==0&&(typeof o=="function"?o(_e):_e.forEach(je=>t(je)),b(!1),j(""),P([]),R([]),I({}))},Je=()=>{j(""),P([]),R([]),I({}),D(!1),z(!1),$(null)};return a.jsxs(xr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},className:"flex flex-col gap-3 w-full",children:[a.jsxs("div",{ref:V,className:"flex items-center justify-end gap-2 scroll-mt-24 md:scroll-mt-28",children:[a.jsx("button",{type:"button",disabled:s,onClick:()=>b(!0),className:`px-3 py-1.5 rounded-lg text-sm font-semibold transition-all ${s?"bg-surface/30 text-text-muted cursor-not-allowed":"bg-surface/80 hover:bg-surface/60 border border-white/10 text-text-primary"}`,children:"Importar lista"}),a.jsx("div",{className:"relative",children:a.jsxs(vn,{value:B,onValueChange:Q,disabled:s,children:[a.jsx(hn,{className:"min-w-[160px] bg-surface/70 backdrop-blur-sm border-white/10 text-sm",children:a.jsx(wn,{placeholder:"Modalidade"})}),a.jsxs(pn,{className:"max-h-[300px] z-[70]",children:[(Array.isArray(d)?d:[]).map(_e=>a.jsx(ct,{value:String(_e),children:String(_e)},String(_e))),(!d||d.length===0)&&a.jsx(ct,{value:"",children:"Selecionar modalidade"})]})]})}),a.jsx("button",{type:"button",onClick:()=>{ye(_e=>{const je=!_e;try{window.dispatchEvent(new CustomEvent("isis-participantes-expand",{detail:{expanded:je}}))}catch{}return je}),setTimeout(()=>{try{V.current?.scrollIntoView({behavior:"smooth",block:"start"})}catch{}},50)},className:`p-2 rounded-lg border transition-all ${X?"bg-white/10 border-brand/40 text-brand shadow-sm":"hover:bg-white/10 border-white/10"}`,"aria-label":X?"Recolher lista":"Expandir lista","aria-pressed":X,children:X?a.jsx(Tg,{className:"w-4 h-4"}):a.jsx(bue,{className:"w-4 h-4"})})]}),e.length>0&&a.jsx("div",{ref:Se,className:`flex flex-col gap-1.5 ${X?"max-h-[360px] md:max-h-[320px]":"max-h-[140px]"} overflow-y-auto px-1 transition-all`,children:e.map((_e,je)=>a.jsxs(xr.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.2},className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm ${_e.principal?"bg-brand/10 border border-brand/30":"bg-surface/50 border border-white/10"}`,children:[a.jsx("span",{className:"w-7 shrink-0",children:a.jsx("span",{className:`inline-flex items-center justify-center px-2 py-0.5 rounded-md text-[11px] font-extrabold ${_e.principal?"bg-brand/20 text-brand":"bg-white/10 text-text-primary"}`,children:je+1})}),a.jsx("span",{className:"text-base shrink-0",children:_e.principal?"":""}),a.jsxs("span",{className:`flex-1 font-medium truncate ${_e.principal?"text-brand":"text-text-primary"}`,children:[_e.nome,_e.principal&&a.jsx("span",{className:"ml-1.5 text-xs opacity-70",children:"(voc)"})]}),!_e.principal&&r&&a.jsx(xr.button,{type:"button",onClick:()=>r(je),whileHover:{scale:1.1},whileTap:{scale:.9},className:"shrink-0 p-1 rounded-full hover:bg-red-500/20 text-red-400 hover:text-red-300 transition-colors",title:"Remover participante",children:a.jsx(al,{className:"w-4 h-4"})})]},je))}),a.jsxs("form",{onSubmit:Ze,className:"flex flex-col gap-2",children:[a.jsxs("div",{className:`
          flex items-center gap-2 px-3 py-2.5 rounded-xl
          bg-surface/70 backdrop-blur-sm
          border-2 transition-all duration-300
          ${h?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
        `,children:[a.jsx(Gue,{className:`w-4 h-4 shrink-0 transition-colors ${h?"text-brand":"text-text-muted"}`}),a.jsx("input",{ref:y,type:"text",value:u,onChange:_e=>f(_e.target.value),onKeyDown:ht,onFocus:()=>m(!0),onBlur:()=>m(!1),placeholder:v?"Nome":"Nome do participante",disabled:s,autoComplete:"off",className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-base font-medium min-w-0"}),a.jsx(xr.button,{type:"submit",whileHover:{scale:u.trim()?1.05:1},whileTap:{scale:u.trim()?.95:1},disabled:!u.trim()||s,className:`
              px-3 py-1.5 rounded-lg transition-all duration-300 text-sm font-semibold shrink-0
              ${u.trim()?"bg-brand text-bg shadow-md":"bg-surface-light text-text-muted cursor-not-allowed opacity-50"}
            `,children:"Adicionar"})]}),a.jsx(xr.button,{type:"button",onClick:()=>n&&n(B),disabled:s,whileHover:{scale:s?1:1.05},whileTap:{scale:s?1:.95},className:`
            w-full px-6 py-3.5 rounded-xl font-bold text-base
            transition-all duration-300
            ${s?"bg-surface/30 text-text-muted cursor-not-allowed":"bg-brand text-bg shadow-lg hover:shadow-xl hover:shadow-brand/30"}
          `,children:a.jsxs("span",{className:"flex items-center justify-center gap-2",children:[a.jsx(Yf,{className:"w-5 h-5"}),"Confirmar Participantes (",e.length,")"]})}),!v&&a.jsxs("p",{className:"text-xs text-text-muted text-center mt-1",children:[" ",a.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface rounded text-[10px]",children:"Enter"})," adiciona  ",a.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface rounded text-[10px]",children:"Shift+Enter"})," confirma"]})]}),x&&typeof document<"u"&&im.createPortal(a.jsxs("div",{className:"fixed inset-0 z-[9999] overflow-y-auto",children:[a.jsx("div",{className:"fixed inset-0 bg-black/75 backdrop-blur-sm",onClick:()=>!_&&b(!1)}),a.jsx("div",{className:"min-h-screen flex items-start justify-center pt-24 md:pt-16 pb-8 px-3",children:a.jsxs("div",{className:"relative w-[96vw] max-w-5xl bg-gradient-to-br from-surface via-background to-surface border border-white/10 rounded-3xl shadow-2xl flex flex-col overflow-hidden",children:[a.jsxs("div",{className:"sticky top-0 z-10 px-5 py-4 border-b border-white/10 bg-surface/70 backdrop-blur flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(gi,{size:"sm",variant:"header"}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-base md:text-lg font-extrabold text-text-primary leading-tight",children:C.length>0?"Sugestes encontradas":"Importar participantes"}),a.jsx("p",{className:"text-[11px] md:text-xs text-text-muted",children:C.length>0?`Selecione os nomes para adicionar (${C.length})`:"Cole sua lista e processe com IA"})]})]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("button",{type:"button",disabled:_,onClick:()=>b(!1),className:"p-2 rounded-lg hover:bg-white/10",children:a.jsx(al,{className:"w-5 h-5"})})})]}),a.jsx("div",{className:"flex-1 max-h-[70vh] overflow-y-auto p-4 md:p-5",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 h-full",children:[a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsx("label",{className:"text-xs text-text-muted mb-2",children:"Sua lista"}),a.jsx("textarea",{value:w,onChange:_e=>j(_e.target.value),disabled:_,placeholder:`Exemplo:
1) Joo Silva
2) Maria Clara
3) Pedro Henrique

Dica: nomes sob os cabealhos 'Lista de espera', 'Lista de reserva' ou 'Convidados' sero ignorados.

Cole sua lista (um por linha ou separados por vrgula) e clique em Processar com sis`,className:"w-full min-h-[320px] max-h-[320px] resize-none overflow-y-auto bg-surface border border-white/10 rounded-xl p-3 outline-none text-sm focus:ring-2 focus:ring-brand/40"}),a.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[a.jsx("button",{type:"button",onClick:Je,disabled:_&&!w.trim(),className:"px-4 py-2 rounded-xl font-semibold bg-surface border border-white/10 text-text-primary hover:bg-white/10 disabled:opacity-60",children:"Apagar"}),a.jsx("button",{type:"button",onClick:Wt,disabled:_||!w.trim(),className:"px-5 py-2.5 rounded-xl font-semibold shadow-lg transition bg-gradient-to-r from-brand to-emerald-500 text-white hover:shadow-emerald-500/30 disabled:opacity-60 disabled:cursor-not-allowed",children:_?"Processando":"Processar com sis"})]})]}),a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs text-text-muted",children:[a.jsx("span",{children:"Sugeridos"}),a.jsx("span",{className:"inline-flex items-center justify-center px-2 py-0.5 rounded-full bg-white/10",children:C.length})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:Ct,disabled:_,className:"px-2 py-1 text-xs rounded-lg bg-surface hover:bg-white/10 disabled:opacity-50",children:"Selecionar todos"}),a.jsx("button",{type:"button",onClick:wt,disabled:_,className:"px-2 py-1 text-xs rounded-lg bg-surface hover:bg-white/10 disabled:opacity-50",children:"Limpar"})]})]}),a.jsx("div",{className:"min-h-[320px] max-h-[320px] overflow-y-auto border border-white/10 rounded-xl bg-surface",children:_?a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative w-5 h-5",children:[a.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-tr from-brand to-emerald-500 opacity-30"}),a.jsx("div",{className:"absolute inset-0 rounded-full border-2 border-transparent [border-image:linear-gradient(to_right,var(--tw-gradient-from),var(--tw-gradient-to))_1] animate-spin"})]}),a.jsx("span",{className:"text-xs font-semibold text-text-primary",children:"Processando com IA"})]}),a.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-white/10 text-text-muted",children:"Premium"})]}),a.jsx("div",{className:"space-y-2",children:Array.from({length:10}).map((_e,je)=>a.jsxs("div",{className:"flex items-center justify-between px-3 py-2 rounded-lg bg-white/[0.03] overflow-hidden",children:[a.jsxs("div",{className:"flex items-center gap-2 min-w-0 w-full",children:[a.jsx("span",{className:"w-7 shrink-0",children:a.jsx("span",{className:"inline-flex items-center justify-center px-2 py-0.5 rounded-md text-[11px] font-extrabold bg-white/10 text-text-muted",children:je+1})}),a.jsx("div",{className:"relative h-3 w-full max-w-[220px] rounded bg-white/10 overflow-hidden",children:a.jsx("div",{className:"absolute inset-0 -translate-x-full animate-[shimmer_1.2s_infinite] bg-gradient-to-r from-transparent via-white/20 to-transparent"})})]}),a.jsx("div",{className:"h-4 w-4 rounded bg-white/10"})]},je))}),a.jsx("style",{children:"@keyframes shimmer{100%{transform:translateX(100%);}}"})]}):a.jsx("ul",{className:"divide-y divide-white/5",children:C.map((_e,je)=>{const Ue=te(_e),ze=M&&U&&W&&Ue===W;return a.jsxs("li",{className:`flex items-center justify-between px-3 py-2 ${ze?"bg-white/5":""}`,children:[a.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[a.jsx("span",{className:"w-7 shrink-0",children:a.jsx("span",{className:`inline-flex items-center justify-center px-2 py-0.5 rounded-md text-[11px] font-extrabold ${ze?"bg-emerald-600/25 text-emerald-400":"bg-white/10 text-text-primary"}`,children:je+1})}),a.jsx("span",{className:"text-sm truncate pr-1",children:_e}),ze&&a.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-emerald-600/20 text-emerald-400 border border-emerald-500/30 shrink-0",children:"Voc"})]}),a.jsx("input",{type:"checkbox",className:"w-4 h-4",checked:ze?!0:!!O[Ue],onChange:()=>!ze&&be(_e),disabled:ze})]},`${Ue}-${je}`)})})}),M&&C.length===0&&w.trim()&&!_&&a.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum nome novo encontrado."}),A.length>0&&a.jsxs("div",{className:"mt-2 text-xs text-text-muted flex items-center gap-2",children:[a.jsx("span",{children:"Ignorados"}),a.jsx("span",{className:"inline-flex items-center justify-center px-2 py-0.5 rounded-full bg-white/10",children:A.length})]}),a.jsx("div",{className:"mt-3 flex items-center justify-end",children:a.jsx("button",{type:"button",onClick:Ge,disabled:_||C.filter(_e=>O[te(_e)]).length===0,className:`px-5 py-2.5 rounded-xl font-semibold ${_||C.filter(_e=>O[te(_e)]).length===0?"bg-surface/30 text-text-muted cursor-not-allowed":"bg-emerald-600 text-white shadow-lg hover:shadow-emerald-600/30 transition"}`,children:(()=>`Adicionar selecionados (${C.reduce((je,Ue)=>{const ze=te(Ue);return M&&U&&W&&ze===W?je+1:je+(O[ze]?1:0)},0)})`)()})})]})]})})]})})]}),document.body)]})},llt=({onSubmit:e,disabled:t=!1})=>{const[r,n]=p.useState(0),[s,o]=p.useState(0),[i,l]=p.useState(""),[c,d]=p.useState(!1),u=g=>{g.preventDefault(),!(r===0||t)&&e({rating:r,comentario:i.trim()||null,timestamp:new Date().toISOString()})},f=g=>{t||n(g)},h=g=>{t||o(g)},m=()=>{t||o(0)},v=s||r;return a.jsx(xr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},className:"w-full mb-8 md:mb-4",children:a.jsx("div",{className:"bg-background/98 backdrop-blur-3xl border-2 border-white/50 rounded-3xl p-6 md:p-8 shadow-2xl relative z-50",children:a.jsxs("form",{onSubmit:u,className:"flex flex-col gap-6",children:[a.jsxs("div",{className:"flex flex-col items-center gap-4",children:[a.jsx("div",{className:"flex items-center gap-2",children:[1,2,3,4,5].map(g=>a.jsx(xr.button,{type:"button",onClick:()=>f(g),onMouseEnter:()=>h(g),onMouseLeave:m,disabled:t,whileHover:{scale:t?1:1.2},whileTap:{scale:t?1:.9},className:`
                    p-2 transition-all duration-200 rounded-full
                    ${t?"cursor-not-allowed":"cursor-pointer hover:bg-brand/10"}
                  `,children:a.jsx(zue,{className:`w-8 h-8 md:w-10 md:h-10 transition-all duration-200 ${g<=v?"fill-yellow-400 text-yellow-400 drop-shadow-lg":"text-text-muted hover:text-yellow-300"}`})},g))}),r>0&&a.jsx(xr.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-center",children:a.jsxs("p",{className:"text-base font-semibold text-text-primary",children:[r===1&&" Muito ruim",r===2&&" Ruim",r===3&&" Regular",r===4&&" Bom",r===5&&" Excelente"]})})]}),r>0&&a.jsx("div",{className:"w-full h-px bg-white/10 my-2"}),r>0&&a.jsxs(xr.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{duration:.3,delay:.2},className:"flex flex-col gap-4",children:[a.jsxs("label",{className:"text-base font-semibold text-text-primary flex items-center gap-2",children:[a.jsx(Fue,{className:"w-5 h-5 text-brand"}),"Comentrio (opcional)"]}),a.jsx("div",{className:`
                flex items-start gap-2 px-4 py-3 rounded-xl
                bg-background/60 backdrop-blur-sm
                border-2 transition-all duration-300
                ${c?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
              `,children:a.jsx("textarea",{value:i,onChange:g=>l(g.target.value),onFocus:()=>d(!0),onBlur:()=>d(!1),placeholder:"Conte-nos mais sobre sua experincia...",disabled:t,rows:3,maxLength:500,className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-base resize-none min-w-0"})}),a.jsxs("div",{className:"text-sm text-text-muted text-right",children:[i.length,"/500"]})]}),r>0&&a.jsx(xr.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.4},className:"mt-2 mb-4",children:a.jsxs(xr.button,{type:"submit",disabled:t,whileHover:{scale:t?1:1.02},whileTap:{scale:t?1:.98},className:`
                w-full px-6 py-4 rounded-2xl font-bold text-lg
                transition-all duration-300 flex items-center justify-center gap-3
                shadow-xl border-2
                ${t?"bg-surface text-text-muted cursor-not-allowed border-white/10":"bg-gradient-to-r from-brand to-brand/90 text-white shadow-brand/30 hover:shadow-2xl hover:shadow-brand/40 border-brand/20 hover:from-brand/90 hover:to-brand"}
              `,children:[a.jsx(S4,{className:"w-6 h-6"}),"Enviar Avaliao"]})})]})})})},clt=({message:e="Carregando..."})=>{const t=[" sis IA iniciando..."," Processando dados em tempo real..."," IA analisando disponibilidade..."," sis aprendendo suas preferncias..."," Assistente virtual ativando..."," IA otimizando seu agendamento..."," sis calculando melhores opes..."," Sincronizando com IA..."," Inteligncia artificial carregando..."," sis processando informaes..."],r=t[Math.floor(Math.random()*t.length)];return a.jsxs("div",{className:"min-h-screen bg-background flex items-center justify-center relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-background via-surface/30 to-background",children:a.jsx(xr.div,{className:"absolute inset-0 opacity-20",animate:{background:["radial-gradient(circle at 20% 50%, #FF6600 0%, transparent 50%)","radial-gradient(circle at 80% 50%, #FFAA33 0%, transparent 50%)","radial-gradient(circle at 50% 20%, #FF6600 0%, transparent 50%)","radial-gradient(circle at 20% 50%, #FF6600 0%, transparent 50%)"]},transition:{duration:4,repeat:1/0,ease:"easeInOut"}})}),a.jsx("div",{className:"absolute inset-0 pointer-events-none",children:[...Array(6)].map((n,s)=>a.jsx(xr.div,{className:"absolute w-2 h-2 rounded-full",style:{background:s%2===0?"#FF6600":"#FFAA33",left:`${Math.random()*100}%`,top:`${Math.random()*100}%`},animate:{y:[-20,-100,-20],opacity:[0,1,0],scale:[.5,1,.5]},transition:{duration:3+Math.random()*2,repeat:1/0,delay:Math.random()*2,ease:"easeInOut"}},s))}),a.jsxs(xr.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.8,ease:[.22,1,.36,1]},className:"relative z-10 text-center",children:[a.jsxs("div",{className:"mb-8 flex flex-col items-center gap-6",children:[a.jsxs(xr.div,{className:"relative",animate:{rotateY:[0,360]},transition:{duration:4,repeat:1/0,ease:"easeInOut"},children:[a.jsx(xr.div,{className:"absolute inset-0 rounded-2xl blur-xl opacity-60",style:{background:"#FFAA33"},animate:{scale:[1,1.2,1],opacity:[.4,.8,.4]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}}),a.jsx(xr.div,{className:"relative w-20 h-20 md:w-24 md:h-24 rounded-2xl flex items-center justify-center",style:{background:"#FFAA33"},whileHover:{scale:1.05},children:a.jsx(Dc,{className:"w-12 h-12 md:w-14 md:h-14 text-white",strokeWidth:2})})]}),a.jsxs(xr.div,{className:"flex items-baseline gap-1",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.3},children:[a.jsx(xr.span,{className:"font-extrabold text-4xl md:text-5xl",style:{color:"#FF6600"},animate:{textShadow:["0 0 10px rgba(255, 102, 0, 0.5)","0 0 20px rgba(255, 102, 0, 0.8)","0 0 10px rgba(255, 102, 0, 0.5)"]},transition:{duration:2,repeat:1/0},children:"Fluxo"}),a.jsx(xr.span,{className:"font-extrabold text-4xl md:text-5xl",style:{color:"#FFAA33"},animate:{textShadow:["0 0 10px rgba(255, 170, 51, 0.5)","0 0 20px rgba(255, 170, 51, 0.8)","0 0 10px rgba(255, 170, 51, 0.5)"]},transition:{duration:2,repeat:1/0,delay:.1},children:"7"}),a.jsx(xr.span,{className:"font-medium text-4xl md:text-5xl ml-2",style:{color:"#B0B0B0"},initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:.6},children:"Arena"})]})]}),a.jsx("div",{className:"w-64 md:w-80 mx-auto mb-6",children:a.jsx("div",{className:"h-1 bg-surface/30 rounded-full overflow-hidden",children:a.jsx(xr.div,{className:"h-full rounded-full",style:{background:"linear-gradient(90deg, #FFAA33, #FFD700, #FFAA33)"},animate:{x:[-100,300]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},initial:{x:-100}})})}),a.jsxs(xr.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:.8},className:"space-y-3",children:[a.jsx(xr.p,{className:"text-base md:text-lg font-medium text-text-primary px-4",animate:{opacity:[.7,1,.7]},transition:{duration:1.5,repeat:1/0},children:r}),a.jsx("div",{className:"flex justify-center gap-1",children:[0,1,2].map(n=>a.jsx(xr.div,{className:"w-2 h-2 rounded-full",style:{background:"#FFAA33"},animate:{scale:[.8,1.2,.8],opacity:[.5,1,.5]},transition:{duration:1,repeat:1/0,delay:n*.2}},n))})]})]})]})},dlt={greeting:["Ol! Eu sou a Isis  Vou te ajudar a agendar sua quadra! Qual voc prefere?","Oi! Sou a Isis!  Vamos agendar? Me diz, qual quadra voc quer?","E a! Isis aqui! Bora marcar sua partida? Qual quadra te interessa?","Ol!  Prazer, sou a Isis! Qual quadra voc quer reservar?","Opa! Isis na rea! Vamos agendar sua quadra? Qual delas?","Seja bem-vindo! Sou a Isis e vou facilitar sua reserva! Qual quadra?"],afterQuadra:["Boa escolha! {quadra}  tima!  Para qual dia?","Perfeito! {quadra}  top! Qual dia voc quer?","{quadra} confirmada!  Me diz, que dia?","Show! {quadra}  sucesso aqui! Qual o dia?","Anotado! {quadra}  Agora me fala o dia:","Excelente! {quadra}  uma das melhores! Para quando?"],afterData:["Beleza! {data} anotado!  Qual horrio voc prefere?","timo! {data} t disponvel! Que horas?","{data}  logo ali!  Me diz o horrio:","Confirmado {data}! Qual horrio te atende melhor?","Perfeito! {data}  Agora escolhe o horrio:","Show! {data} t livre! Qual o melhor horrio pra voc?"],afterHorario:["{horario}  seu!  Qual modalidade?","Reservado {horario}!  Vai ser qual modalidade?","Fechou {horario}! Qual esporte?","{horario} confirmado! Me diz a modalidade:","Show! {horario}  E a modalidade ...?","Perfeito! {horario} garantido! Qual modalidade?"],afterModalidade:["{modalidade}! Massa!  Quantas pessoas vo jogar?","Vai ser {modalidade}! Legal! Quantos jogadores?","{modalidade}  bom demais!  Quantas pessoas?","Top! {modalidade}  Me diz quantas pessoas:","{modalidade} confirmado! Quantos vo jogar?","timo! {modalidade}  show! Quantos participantes?"],askNames:["Agora preciso dos nomes! Digite cada um (um por linha):","Beleza! Me manda os nomes dos participantes:","Show! Lista os nomes pra mim:","timo! Quais so os nomes?","Perfeito! Me passa os nomes de todo mundo:","Legal! Agora os nomes dos jogadores:"],askContact:["ltimos dados! Qual seu nome completo?","Agora preciso do seu nome e telefone:","Quase l! Me passa seu nome e WhatsApp:","Beleza! Seus dados para contato:","Falta pouco! Nome completo e telefone:","ltima etapa! Qual seu nome e telefone?"],reviewData:["timo! Vamos conferir tudo antes de confirmar:","Perfeito! Revisa comigo os dados:","Show! Confirma se t tudo certo:","Beleza! D uma olhada se est correto:","Legal! Vamos revisar juntos:","Massa! Confere os detalhes aqui:"],confirmation:[" Tudo certo! Agendamento #{codigo} confirmado!"," Pronto! Seu agendamento #{codigo} est garantido!"," Feito! Cdigo #{codigo} confirmado!"," Sucesso! Agendamento #{codigo} t na agenda!"," Confirmado! #{codigo}  seu!"," Show! Agendamento #{codigo} marcado!"],thankYou:["Obrigada por agendar conosco! At logo! ","Valeu! Te vejo no jogo! ","Brigada! Bom jogo! ","Obrigada! At a partida! ","Valeu pela preferncia! At breve! ","Obrigada! Qualquer coisa,  s voltar aqui! "],loading:["Deixa eu verificar...","S um momento...","Aguarda um pouquinho...","Consultando aqui...","Verificando pra voc..."],error:["Ops! Algo deu errado. Vamos tentar de novo?","Eita! Tive um problema aqui. Podemos recomear?","Putz! Deu erro. Tenta novamente?","Opa! Algo no funcionou. Vamos de novo?","Caramba! Erro aqui. Pode tentar novamente?"],noAvailability:["Puts... esse horrio j foi reservado.  Escolhe outro?","Eita! Esse j est ocupado. Que tal outro horrio?","Opa! Esse horrio acabou de ser reservado. Tem outro?","Poxa! Algum reservou esse agora mesmo. Outro horrio?","Xiii! Esse j foi. Bora escolher outro?"]},Cv=(e,t={})=>{const r=dlt[e];if(!r||r.length===0)return console.warn(`[Isis] Nenhuma variao encontrada para step: ${e}`),"Ol! Como posso ajudar?";const n=Math.floor(Math.random()*r.length);let s=r[n];return Object.keys(t).forEach(o=>{const i=new RegExp(`\\{${o}\\}`,"g");s=s.replace(i,t[o])}),s},mV=e=>{try{const t=JSON.parse(localStorage.getItem("isis-feedbacks")||"[]");return t.push(e),localStorage.setItem("isis-feedbacks",JSON.stringify(t)),console.log("[ISIS Feedback] Salvo localmente como fallback:",e.id),e}catch(t){return console.error("[ISIS Feedback] Erro ao salvar localmente:",t),e}},ult=async e=>{const t={id:Date.now()+Math.random().toString(36).substr(2,9),timestamp:new Date().toISOString(),estrelas:e?.rating??null,nome_cliente:e?.cliente_nome??null,empresa:e?.empresa_nome??null,projeto:"fluxo7arena",comentario:e?.comentario??null};try{const r={id:t.id,cod_cliente:e?.cliente_codigo??e?.cliente_id??e?.cod_cliente??null,nome_cliente:e?.cliente_nome||null,empresa:e?.empresa_nome||null,projeto:"fluxo7arena",nota:e?.rating??null,comentario:e?.comentario||null,conversa:Array.isArray(e?.conversaArray)?JSON.stringify(e.conversaArray):typeof e?.conversa=="string"?e.conversa:null,timestamp:t.timestamp},{error:n}=await EY.from("isis").insert(r);return n?(console.error("[Supabase ISIS] Erro ao inserir feedback:",n),mV({...t,projeto:"fluxo7arena"})):(console.log("[Supabase ISIS] Feedback inserido com sucesso:",r.id),t)}catch(r){return console.error("[Supabase ISIS] Exceo ao inserir feedback, salvando localmente:",r),mV(t)}},flt=()=>{const{nomeFantasia:e}=cde(),t=Pe.useMemo(()=>{try{if(typeof window>"u")return null;const Ye=window.location.host||"",$e="f7arena.com";if(!Ye.endsWith($e))return null;const Be=Ye.slice(0,-$e.length).replace(/\.$/,"");if(!Be)return null;const et=Be.toLowerCase();return et==="www"?null:et}catch{return null}},[]),r=e||t;zi();const[n,s]=p.useState(null),{currentStep:o,selections:i,addIsisMessage:l,addIsisMessageWithButtons:c,addUserMessage:d,disableAllButtons:u,removeMessageById:f,hideButtonsInMessage:h,updateSelection:m,updateContact:v,nextStep:g,setIsLoading:y,setIsTyping:x,chatEndRef:b,sessionId:w,messages:j}=zC(),[_,S]=p.useState(null),[C,P]=p.useState([]),[A,R]=p.useState([]),[O,I]=p.useState(!0),[M,D]=p.useState("telefone"),[U,z]=p.useState(!1),[W,$]=p.useState(null),[X,ye]=p.useState(null),[Se,V]=p.useState(!1),[B,Q]=p.useState(null),[pe,te]=p.useState(null);if(typeof window<"u"&&new URLSearchParams(window.location.search||"").get("crash")==="1")throw new Error("Isis forced crash test");const Y=Ye=>Ye?Ye.replace(/([A-Z])/g," $1").replace(/([0-9]+)/g," $1").trim().split(/[\s_-]+/).filter(Boolean).map(Be=>Be.charAt(0).toUpperCase()+Be.slice(1).toLowerCase()).join(" "):"",ce=Pe.useMemo(()=>_?_.isis_display_name?_.isis_display_name:r?Y(r):_.nome_fantasia?_.nome_fantasia:_.razao_social?_.razao_social:"Arena":"",[_,r]),me=Pe.useMemo(()=>_?.logo_url?`${_.logo_url}?v=${Date.now()}`:_?.logo_url||"",[_?.logo_url]);p.useEffect(()=>{(async()=>{if(!r){I(!1);return}try{const Be=decodeURIComponent(r).toLowerCase().replace(/[\s\-_]+/g,"").trim();let et=null,jt=null;try{const{data:pt,error:Dt}=await de.rpc("get_empresa_public_by_isis_subdomain",{p_subdomain:Be});!Dt&&pt&&pt.length>0&&(et=pt[0],jt=pt[0]?.isis_display_name||null)}catch{}try{if(!et){const{data:pt}=await de.from("agenda_settings").select("empresa_id, isis_subdomain, isis_display_name, empresas(codigo_empresa, nome_fantasia, razao_social, nome, logo_url, telefone, id)").eq("isis_subdomain",Be).single();pt?.empresas&&(et=pt.empresas,jt=pt.isis_display_name)}}catch{}if(!et){let pt=null;try{const{data:Dt,error:he}=await de.rpc("get_empresa_public_by_slug",{p_slug:Be});!he&&Dt&&Dt.length>0&&(pt=Dt[0])}catch{}et=pt||null}if(!et){const{data:pt,error:Dt}=await de.from("empresas").select("codigo_empresa, nome_fantasia, razao_social, nome, logo_url, id");if(!Dt&&Array.isArray(pt)){const he=pt.find(Qe=>[Qe?.nome_fantasia||"",Qe?.razao_social||"",Qe?.nome||""].some(Mt=>Mt.toLowerCase().replace(/[\s\-_]+/g,"").trim()===Be));he&&(et=he)}}const yt=et?.id||et?.codigo_empresa;if(et&&!jt&&yt)try{let pt=null,Dt=null;if(et.id){const he=await de.from("agenda_settings").select("isis_subdomain, empresa_id").eq("empresa_id",et.id).single();pt=he.data,Dt=he.error}else if(et.codigo_empresa){const{data:he}=await de.from("empresas").select("id").eq("codigo_empresa",et.codigo_empresa).single();if(he?.id){const Qe=await de.from("agenda_settings").select("isis_subdomain, empresa_id").eq("empresa_id",he.id).single();pt=Qe.data,Dt=Qe.error}}if(pt?.isis_subdomain){console.error("[Isis] Acesso bloqueado. Use o subdomnio configurado."),s(null),I(!1);return}}catch{}if(!et){console.error("[Isis] Empresa no encontrada"),s(null),I(!1);return}if(!jt&&et.id)try{const{data:pt}=await de.from("agenda_settings").select("isis_display_name").eq("empresa_id",et.id).single();pt?.isis_display_name&&(jt=pt.isis_display_name)}catch{}const qt={...et,isis_display_name:jt};S(qt),s(et.codigo_empresa),I(!1)}catch($e){console.error("[Isis] Erro ao buscar empresa:",$e),s(null),I(!1)}})()},[r]),p.useEffect(()=>{const Ye=$e=>{try{$e.preventDefault()}catch{}Q($e)};return window.addEventListener("beforeinstallprompt",Ye),()=>window.removeEventListener("beforeinstallprompt",Ye)},[]),p.useEffect(()=>{try{if(!(new URLSearchParams(window.location.search||"").get("install")==="1"))return;const Be=window.__installPrompt||B,et=()=>{const jt=[" Como instalar o app:",""," Chrome (Android/PC):","  1) Toque nos 3 pontinhos () do navegador",'  2) Escolha "Instalar app" ou "Adicionar  tela inicial"','  3) Confirme em "Instalar"',""," Safari (iPhone/iPad):","  1) Toque no boto Compartilhar (quadrado com seta )",'  2) Selecione "Adicionar  Tela de Incio"','  3) Toque em "Adicionar"'].join(`
`);l(jt,400),setTimeout(()=>{l("Beleza! O que voc gostaria de fazer agora?",600),setTimeout(()=>{try{Ze()}catch{}},800)},700)};(async()=>{try{Be?.prompt&&(Be===B&&Q(null),Be===window.__installPrompt&&(window.__installPrompt=null),await Be.prompt(),await Be.userChoice)}catch{}et()})()}catch{}},[B]),p.useEffect(()=>{!n||O||!i.cliente&&!Se&&(V(!0),setTimeout(()=>{le()},2500))},[n,O,i.cliente,Se]),p.useEffect(()=>{(async()=>{if(!n){I(!1);return}try{console.log("[useEffect] Definindo empresa atual para RLS:",n),await de.rpc("set_current_empresa",{empresa_codigo:String(n)}),await Wt()}catch($e){console.error("[useEffect] Erro ao definir empresa para RLS:",$e),await Wt()}})()},[n]);const ae=()=>{const $e=new Date().getHours();return $e>=5&&$e<12?"Bom dia":$e>=12&&$e<18?"Boa tarde":"Boa noite"},le=()=>{console.log("[DEBUG] iniciarIdentificacao INICIOU:",{loadingEmpresa:O,empresa:_?.nome_fantasia,timestamp:new Date().toISOString()}),D("telefone"),z(!1);const Ye=ae(),$e=[`**${Ye}!** Tudo bem? 

Sou a **sis**, assistente virtual da **${ce}** e estou aqui para tornar seu **agendamento** super fcil!

Para comear, qual seu **telefone** ou **e-mail**?`,`Hey! **${Ye}!**  **sis** na rea!

Sou a assistente virtual da **${ce}** e vim facilitar sua vida.

Bora **agendar**? Me passa seu **telefone** ou **e-mail**:`,`**${Ye}!** Prazer em te atender! 

Sou a **sis** da **${ce}**, sua assistente virtual para **agendamentos**.

Para comear, preciso do seu **telefone** ou **e-mail**:`,`Opa! **${Ye}!**  **sis** aqui, sua assistente virtual da **${ce}**!

Vamos **marcar seu horrio**?  rapidinho!

Me informa seu **telefone** ou **e-mail**:`,`**${Ye}!** Seja bem-vindo! 

Eu sou a **sis**, sua assistente virtual aqui na **${ce}**.

Vou te ajudar a **agendar seu horrio** rapidinho!

Informe seu **telefone** ou **e-mail**:`],Be=Math.floor(Math.random()*$e.length);console.log("[DEBUG] Mostrando indicador de digitao primeiro:",{loadingEmpresa:O,timestamp:new Date().toISOString()}),x(!0),setTimeout(()=>{console.log("[DEBUG] Fazendo scroll inicial para mostrar indicador de digitao"),b.current?.scrollIntoView({behavior:"smooth",block:"end"})},300),setTimeout(()=>{console.log("[DEBUG] Enviando mensagem da Isis aps indicador de digitao"),x(!1),l($e[Be],0),setTimeout(()=>{console.log("[DEBUG] Fazendo scroll aps mensagem aparecer"),b.current?.scrollIntoView({behavior:"smooth",block:"end"})},100)},3500),setTimeout(()=>{console.log("[DEBUG] Mostrando input"),z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"end"})},200)},3500+600),g("identificacao")},ue=async Ye=>{try{console.log("[DEBUG] Buscando cliente com valor:",Ye),console.log("[DEBUG] Cdigo empresa:",n);const $e=Ye.replace(/\D/g,"");if($e.length>=10){console.log("[DEBUG] Buscando telefone:",$e);const{data:jt,error:yt}=await de.from("clientes").select("id, nome, email, telefone, whatsapp, celular1, codigo").eq("codigo_empresa",n).eq("status","active");if(yt)throw yt;console.log("[DEBUG] Total de clientes ativos:",jt?.length);const qt=jt?.find(pt=>{const Dt=(pt.telefone||"").replace(/\D/g,""),he=(pt.whatsapp||"").replace(/\D/g,""),Qe=(pt.celular1||"").replace(/\D/g,"");return Dt.includes($e)||he.includes($e)||Qe.includes($e)});return console.log("[DEBUG] Cliente encontrado:",qt),qt||null}const{data:Be,error:et}=await de.from("clientes").select("id, nome, email, telefone, whatsapp, codigo").eq("codigo_empresa",n).eq("status","active").ilike("email",`%${Ye}%`);if(et)throw et;return Be?.[0]||null}catch($e){return console.error("Erro ao buscar cliente:",$e),null}},Re=Ye=>{const $e=Ye.trim().split(" ").filter(Be=>Be);return $e.length===1?$e[0]:$e.length>=2?`${$e[0]} ${$e[1]}`:$e[0]},ne=async Ye=>{if(!Ye){l("Por favor, informe a data desejada.",400);return}const $e=/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/,Be=Ye.match($e);if(!Be){l("**Formato invlido!** Por favor, use o formato DD/MM/AAAA (exemplo: 15/12/2024)",400);return}const[,et,jt,yt]=Be,qt=new Date(parseInt(yt),parseInt(jt)-1,parseInt(et));if(isNaN(qt.getTime())||qt.getDate()!==parseInt(et)||qt.getMonth()!==parseInt(jt)-1||qt.getFullYear()!==parseInt(yt)){l("**Data invlida!** Verifique se o dia, ms e ano esto corretos.",400);return}const pt=new Date;if(pt.setHours(0,0,0,0),qt.setHours(0,0,0,0),qt<pt){l("**Data no passado!** Por favor, escolha uma data de hoje em diante.",400);return}d(Ye);const Dt=cr(qt,"dd/MM/yyyy",{locale:na}),he=cr(qt,"EEEE",{locale:na});y(!0);const Qe=await Ge(i.quadra.id,qt);if(y(!1),Qe.fechada){if(Qe.motivo==="data_especifica")l(`**Ops!** A quadra estar **fechada** no dia **${Dt}** (${he}). 

**Motivo:** ${Qe.observacao}`,800);else if(Qe.motivo==="dia_semana"){const nr=cr(qt,"EEEE",{locale:na});l(`**Ops!** A quadra no funciona ${nr==="domingo"||nr==="sbado"?"aos":"s"} **${nr}s**. 

Escolha outro dia da semana!`,800)}setTimeout(()=>{l("Digite **outra data** no formato DD/MM/AAAA:",1200),setTimeout(()=>{z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},200)},400)},1200);return}m("data",qt),z(!1),D("telefone"),l(`**Perfeito!** Data escolhida: **${Dt}** (${he}) `,600);const zt=Qe.slots;if(zt.length===0){l("Ops! No encontrei **horrios disponveis** para esse dia.  Que tal tentar outra data?",800),setTimeout(()=>{perguntarData()},1200);return}const Mt=Je(zt);let ir="";Mt.length===1?ir=`Tenho **horrios livres** das **${Mt[0].inicio}** s **${Mt[0].fim}**! `:ir=`Tenho **horrios livres** ${Mt.map((kr,Ft)=>Ft===Mt.length-1?`e das **${kr.inicio}** s **${kr.fim}**`:Ft===0?`das **${kr.inicio}** s **${kr.fim}**`:`das **${kr.inicio}** s **${kr.fim}**`).join(", ")}! `,l(ir,1e3),setTimeout(()=>{l("Escolha o horrio de incio e trmino: ",1200),g("horario"),setTimeout(()=>{z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1e3)},1600)},ie=async Ye=>{if(M==="data_custom")return await ne(Ye);if(!Ye){l("Por favor, informe seu telefone ou e-mail.",400);return}const $e=M==="telefone"?`(${Ye.slice(0,2)}) ${Ye.slice(2,7)}-${Ye.slice(7)}`:Ye;d($e);const Be=await ue(Ye);if(Be){m("cliente",Be),z(!1);const et=Re(Be.nome),jt=[`**${et}!** `,`Opa, **${et}!** `,`E a, **${et}!** `,`**${et}!** Que bom te ver! `,`Fala, **${et}!** `,`**${et}!** Tudo bem? `,`Hey, **${et}!** `],yt=Math.floor(Math.random()*jt.length);l(jt[yt],600);let qt="telefone";try{qt=i?.identificacao_tipo||M||"telefone",te(qt==="email"?"email":"telefone")}catch{}const pt=qt==="email"?"email":"telefone";setTimeout(()=>{Ze(pt)},600)}else m("identificacao_valor",$e),m("identificacao_tipo",M),z(!1),l("No encontrei seu cadastro. Sem problemas! Vamos fazer rapidinho. ",800),l("Preciso de algumas informaes:",1400),setTimeout(()=>{z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},200),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},600)},1400+800),g("cadastro")},gt=async Ye=>{let $e=`Nome: ${Ye.nome}`;if(Ye.telefone){const Be=`(${Ye.telefone.slice(0,2)}) ${Ye.telefone.slice(2,7)}-${Ye.telefone.slice(7)}`;$e+=`
Telefone: ${Be}`}Ye.email&&($e+=`
E-mail: ${Ye.email}`),d($e),z(!1),await bt(Ye.nome,Ye.email,Ye.telefone)},bt=async(Ye,$e,Be)=>{try{y(!0);try{if(Be){const pt=String(Be||"").replace(/\D/g,""),{data:Dt,error:he}=await de.from("clientes").select("id, nome, email, telefone, whatsapp, celular1, codigo").eq("codigo_empresa",n).eq("status","active");if(!he&&Array.isArray(Dt)){const Qe=Dt.find(zt=>{const Mt=(zt.telefone||"").replace(/\D/g,""),ir=(zt.whatsapp||"").replace(/\D/g,""),nr=(zt.celular1||"").replace(/\D/g,"");return Mt===pt||ir===pt||nr===pt});if(Qe){y(!1),m("cliente_sugerido",Qe),c(`Encontrei um cadastro existente para este telefone: **${Re(Qe.nome)}**.  voc?`,[{label:" Sim, sou eu",value:"confirm_cliente_existente"},{label:" No, quero corrigir",value:"corrigir_cadastro"}],200),z(!1),g("confirmar_cliente_existente");return}}}if($e){const pt=String($e||"").trim().toLowerCase(),{data:Dt,error:he}=await de.from("clientes").select("id, nome, email, telefone, whatsapp, codigo").eq("codigo_empresa",n).eq("status","active").ilike("email",pt);if(!he&&Array.isArray(Dt)&&Dt.length>0){const Qe=Dt.find(zt=>String(zt.email||"").trim().toLowerCase()===pt)||null;if(Qe){y(!1),m("cliente_sugerido",Qe),c(`Este e-mail j possui cadastro: **${Re(Qe.nome)}**.  voc?`,[{label:" Sim, sou eu",value:"confirm_cliente_existente"},{label:" No, quero corrigir",value:"corrigir_cadastro"}],200),z(!1),g("confirmar_cliente_existente");return}}}}catch{}l(Cv("loading"));const{data:et}=await de.from("empresa_counters").select("next_cliente_codigo").eq("empresa_id",_?.id).single(),jt=et?.next_cliente_codigo||1,{data:yt,error:qt}=await de.from("clientes").insert({codigo_empresa:n,codigo:jt,nome:Ye,email:$e||null,telefone:Be,whatsapp:Be,status:"active"}).select("id, nome, email, telefone, whatsapp, codigo").single();if(qt){if(qt.code==="23505"&&qt.message.includes("uq_clientes_empresa_codigo")){console.log("[Isis] Cdigo duplicado, tentando prximo cdigo...");const{data:pt,error:Dt}=await de.from("clientes").insert({codigo_empresa:n,codigo:jt+1,nome:Ye,email:$e||null,telefone:Be,whatsapp:Be,status:"active"}).select("id, nome, email, telefone, whatsapp, codigo").single();if(Dt)throw Dt;await de.from("empresa_counters").update({next_cliente_codigo:jt+2}).eq("empresa_id",_?.id),y(!1),z(!1),m("cliente",pt),l(`Pronto, ${Ye}! Cadastro realizado com sucesso! `,800),setTimeout(()=>{ht()},1400);return}throw qt}await de.from("empresa_counters").update({next_cliente_codigo:jt+1}).eq("empresa_id",_?.id),y(!1),z(!1),m("cliente",yt),l(`Pronto, ${Ye}! Cadastro realizado com sucesso! `,800),setTimeout(()=>{ht()},1400)}catch(et){console.error("Erro ao criar cliente:",et),y(!1),l("Ops! Erro ao criar cadastro. Tente novamente.",400)}},at=()=>{const Ye=new Date,$e=Ta(Ye,1),Be=[{label:`Hoje (${cr(Ye,"dd/MM")})`,value:cr(Ye,"yyyy-MM-dd"),icon:"",date:Ye},{label:`Amanh (${cr($e,"dd/MM")})`,value:cr($e,"yyyy-MM-dd"),icon:"",date:$e},{label:"Outro dia...",value:"custom",icon:""}];Array.isArray(C)&&C.length>1&&Be.push({label:"Mudar quadra",value:"mudar_quadra",icon:""}),Be.push({label:" Menu",value:"menu",action:"menu"}),c("Para qual dia voc gostaria de agendar?",Be,600),g("data")},xt=()=>{d(" Mudar Data"),z(!1),setTimeout(()=>{at()},400)},Ze=(Ye=null)=>{const $e=["O que voc gostaria de fazer hoje?","Como posso te ajudar?","Qual  o plano para hoje?","O que vamos fazer?","Em que posso te auxiliar?","Qual sua necessidade hoje?","Como posso ser til?"],Be=$e[Math.floor(Math.random()*$e.length)];let et=[{label:"Fazer Agendamento",value:"novo_agendamento",icon:""},{label:"Editar Agendamento",value:"buscar_agendamento",icon:""},{label:"Finalizar Atendimento",value:"finalizar_atendimento",icon:""}];const jt=Ye||pe;jt==="telefone"?et=[et[0],et[1],{label:"Informei o telefone errado",value:"corrigir_telefone",icon:""},et[2]]:jt==="email"&&(et=[et[0],et[1],{label:"Informei o e-mail errado",value:"corrigir_email",icon:""},et[2]]),c(Be,et,600),pe&&setTimeout(()=>te(null),0)},ht=async()=>{let Ye=C,$e=_;if(!Ye||Ye.length===0){const Be=await Wt(!1);if(Ye=Be.quadras,$e=Be.empresa,!Ye||Ye.length===0){console.error("[iniciarAgendamento] Quadras ainda no disponveis aps carregar!"),l("Ops! No consegui carregar as quadras. Tente novamente.",600);return}}if(!$e){console.error("[iniciarAgendamento] Empresa no disponvel!"),l("Ops! No consegui carregar os dados da empresa. Tente novamente.",600);return}setTimeout(()=>{be(Ye,$e,!0)},800)},Wt=async(Ye=!0)=>{try{Ye&&I(!0);const $e=Date.now(),Be=3500,{data:et,error:jt}=await de.from("empresas").select("*").eq("codigo_empresa",n).single();if(jt)throw jt;if(!et)return l_({title:"Empresa no encontrada",description:"Verifique o cdigo e tente novamente",variant:"destructive"}),{empresa:null,quadras:[]};S(he=>({...et,isis_display_name:he?.isis_display_name||et.isis_display_name})),m("empresa",et);const{data:yt,error:qt}=await de.from("quadras").select("id, nome, modalidades, hora_inicio, hora_fim, valor, codigo_empresa, status, descricao").eq("codigo_empresa",String(n)).eq("status","Ativa").order("nome",{ascending:!0});if(qt)throw console.error("[loadEmpresa] Erro ao buscar quadras:",qt),qt;if(!yt||yt.length===0){console.warn("[loadEmpresa] Nenhuma quadra encontrada devido a RLS. Criando quadra temporria.");const he=[{id:"temp-quadra-1004",nome:"Quadra Principal",modalidades:["Futebol","Futsal"],hora_inicio:"07:00:00",hora_fim:"22:00:00",valor:30,codigo_empresa:String(n),status:"Ativa",descricao:"Quadra temporria (problema de permisso)"}];return P(he),{empresa:et,quadras:he}}P(yt||[]);const pt=Date.now()-$e,Dt=Math.max(0,Be-pt);return Dt>0&&await new Promise(he=>setTimeout(he,Dt)),{empresa:et,quadras:yt||[]}}catch($e){console.error("[Isis] Erro ao carregar empresa:",$e);const Be=Date.now()-startTime,et=Math.max(0,minLoadingTime-Be);return et>0&&await new Promise(jt=>setTimeout(jt,et)),l_({title:"Erro ao carregar",description:"No foi possvel carregar os dados da empresa",variant:"destructive"}),{empresa:null,quadras:[]}}finally{Ye&&I(!1)}},be=(Ye,$e,Be=!1)=>{if(ae(),Ye.length===1){const yt=Ye[0];if(Be){const qt=[`Perfeito! Agora vamos **agendar** seu horrio na **${yt.nome}!** `,`timo! Vou te ajudar a **marcar sua partida** na **${yt.nome}!** `,`Show! Bora **agendar** a **${yt.nome}?** `,`Perfeito! Vamos **marcar sua reserva** na **${yt.nome}!** `],pt=Math.floor(Math.random()*qt.length),Dt=qt[pt];l(Dt)}m("quadra",yt),setTimeout(()=>{const qt=new Date,pt=Ta(qt,1),Dt=[{label:`Hoje (${cr(qt,"dd/MM")})`,value:cr(qt,"yyyy-MM-dd"),icon:"",date:qt},{label:`Amanh (${cr(pt,"dd/MM")})`,value:cr(pt,"yyyy-MM-dd"),icon:"",date:pt},{label:"Outro dia...",value:"custom",icon:""},{label:" Menu",value:"menu",action:"menu"}];c("Para qual dia voc gostaria de agendar?",Dt,800),g("data")},1200);return}let et;if(Be){const yt=["Qual quadra voc quer reservar? ","Qual quadra te interessa? ","Me diz, qual quadra? ","Qual quadra voc prefere? ","Bora escolher a quadra? Qual delas? "],qt=Math.floor(Math.random()*yt.length);et=yt[qt]}else return;const jt=Ye.map(yt=>({label:yt.nome,subtitle:yt.descricao||null,value:yt.id,icon:"",quadra:yt}));jt.push({label:" Menu",value:"menu",action:"menu"}),c(et,jt),g("quadra")},Ct=async Ye=>{if(Ye.action==="menu"){d(" Menu");try{ye(null)}catch{}try{m("editing_agendamento",null)}catch{}try{m("quadra",null)}catch{}try{m("data",null)}catch{}try{m("horario",null)}catch{}try{m("modalidade",null)}catch{}try{m("quantidade",null)}catch{}try{m("nomes",[])}catch{}try{m("participantes",[])}catch{}try{m("levantadores",[])}catch{}try{m("goleiros",[])}catch{}try{m("fixos",[])}catch{}try{m("fixoRoles",{})}catch{}try{$(null)}catch{}try{z(!1)}catch{}g("identificacao"),setTimeout(()=>{Ze()},400);return}const $e=Ye.quadra;if(!$e){console.error("[handleQuadraSelection] Quadra no encontrada no boto:",Ye);return}if(d($e.nome),m("quadra",$e),o==="review"){z(!1),$("horario"),y(!0);const qt=await Ge($e.id,i.data,X?.id);if(y(!1),qt.fechada){const Dt=cr(i.data,"dd/MM/yyyy",{locale:na}),he=cr(i.data,"EEEE",{locale:na});if(qt.motivo==="data_especifica")l(`**Ops!** A **${$e.nome}** estar **fechada** no dia **${Dt}** (${he}). 

**Motivo:** ${qt.observacao}`,800);else if(qt.motivo==="dia_semana"){const Qe=cr(i.data,"EEEE",{locale:na}),zt=Qe==="domingo"||Qe==="sbado"?"aos":"s";l(`**Ops!** A **${$e.nome}** no funciona ${zt} **${Qe}s**. `,800)}setTimeout(()=>{l("Escolha **outra quadra** ou **mude a data**:",1200),setTimeout(()=>{at()},400)},1600);return}const pt=qt.slots;if(pt&&pt.length>0){const Dt=Je(pt);let he="";Dt.length===1?he=`Tenho **horrios livres** das **${Dt[0].inicio}** s **${Dt[0].fim}**! `:he=`Tenho **horrios livres** ${Dt.map((zt,Mt)=>Mt===Dt.length-1?`e das **${zt.inicio}** s **${zt.fim}**`:Mt===0?`das **${zt.inicio}** s **${zt.fim}**`:`das **${zt.inicio}** s **${zt.fim}**`).join(", ")}! `,console.log("[handleQuadraSelection] Mostrando horrios disponveis e input de horrio"),l(he,600),setTimeout(()=>{l("Escolha o horrio de incio e trmino: ",800),setTimeout(()=>{console.log("[handleQuadraSelection] Ativando showInput=true"),z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1e3)},800)}else console.log("[handleQuadraSelection] Nenhum horrio disponvel"),l("Ops! No encontrei **horrios disponveis** para essa quadra nesse dia. "),setTimeout(()=>{l("Que tal tentar **outra data**? ",800),setTimeout(()=>{at()},400)},1200);return}console.log("[handleQuadraSelection] Fluxo normal (no edio)");const Be=Cv("afterQuadra",{quadra:$e.nome});l(Be,600);const et=new Date,jt=Ta(et,1),yt=[{label:`Hoje (${cr(et,"dd/MM")})`,value:cr(et,"yyyy-MM-dd"),icon:"",date:et},{label:`Amanh (${cr(jt,"dd/MM")})`,value:cr(jt,"yyyy-MM-dd"),icon:"",date:jt},{label:"Outro dia...",value:"custom",icon:""},{label:" Menu",value:"menu",action:"menu"}];c("Para qual dia voc gostaria de agendar?",yt,1e3),g("data")},wt=async Ye=>{if(console.log("[handleDataSelection] Iniciando...",{button:Ye,currentStep:o}),Ye.action==="menu"){d(" Menu");try{ye(null)}catch{}try{m("editing_agendamento",null)}catch{}try{m("quadra",null)}catch{}try{m("data",null)}catch{}try{m("horario",null)}catch{}try{m("modalidade",null)}catch{}try{m("quantidade",null)}catch{}try{m("nomes",[])}catch{}try{m("participantes",[])}catch{}try{m("levantadores",[])}catch{}try{m("goleiros",[])}catch{}try{m("fixos",[])}catch{}try{m("fixoRoles",{})}catch{}try{$(null)}catch{}try{z(!1)}catch{}g("identificacao"),setTimeout(()=>{Ze()},400);return}if(Ye.value==="custom"){d(" Outro dia..."),l("**Perfeito!** Me informe a **data desejada** no formato DD/MM/AAAA:",600),D("data_custom"),setTimeout(()=>{z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},800);return}const $e=Ye.date;if(!$e){console.error("[handleDataSelection] Data no encontrada no boto:",Ye);return}if(d(Ye.label),m("data",$e),!!i?.editing_agendamento||!!X){console.log("[handleDataSelection] Modo edio detectado - recarregando horrios"),console.log("[handleDataSelection] Quadra ID:",i.quadra?.id),console.log("[handleDataSelection] Nova Data:",$e),z(!1),$("horario"),y(!0);const pt=await Ge(i.quadra.id,$e,X?.id);if(console.log("[handleDataSelection] Resultado:",pt),y(!1),pt.fechada){const he=cr($e,"dd/MM/yyyy",{locale:na}),Qe=cr($e,"EEEE",{locale:na});if(pt.motivo==="data_especifica")l(`**Ops!** A quadra estar **fechada** no dia **${he}** (${Qe}). 

**Motivo:** ${pt.observacao}`,800);else if(pt.motivo==="dia_semana"){const zt=cr($e,"EEEE",{locale:na});l(`**Ops!** A quadra no funciona ${zt==="domingo"||zt==="sbado"?"aos":"s"} **${zt}s**. `,800)}setTimeout(()=>{l("Escolha **outra data**:",1200),setTimeout(()=>{at()},400)},1600);return}const Dt=pt.slots;if(Dt&&Dt.length>0){const he=Je(Dt);let Qe="";he.length===1?Qe=`Tenho **horrios livres** das **${he[0].inicio}** s **${he[0].fim}**! `:Qe=`Tenho **horrios livres** ${he.map((Mt,ir)=>ir===he.length-1?`e das **${Mt.inicio}** s **${Mt.fim}**`:ir===0?`das **${Mt.inicio}** s **${Mt.fim}**`:`das **${Mt.inicio}** s **${Mt.fim}**`).join(", ")}! `,console.log("[handleDataSelection] Mostrando horrios disponveis e input"),l(Qe,600),setTimeout(()=>{l("Escolha o horrio de incio e trmino: ",800),setTimeout(()=>{console.log("[handleDataSelection] Ativando showInput=true"),z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1e3)},800)}else console.log("[handleDataSelection] Nenhum horrio disponvel"),l("Ops! No encontrei **horrios disponveis** para essa quadra nesse dia.  Tente outra data.");return}console.log("[handleDataSelection] Fluxo normal (no edio)"),y(!0);const et=await Ge(i.quadra.id,$e);if(console.log("[handleDataSelection] Resultado (fluxo normal):",et),y(!1),et.fechada){const pt=cr($e,"dd/MM/yyyy",{locale:na}),Dt=cr($e,"EEEE",{locale:na});if(et.motivo==="data_especifica")l(`**Ops!** A quadra estar **fechada** no dia **${pt}** (${Dt}). 

**Motivo:** ${et.observacao}`,800);else if(et.motivo==="dia_semana"){const he=cr($e,"EEEE",{locale:na});l(`**Ops!** A quadra no funciona ${he==="domingo"||he==="sbado"?"aos":"s"} **${he}s**. 

Escolha outro dia da semana!`,800)}setTimeout(()=>{l("Que tal tentar **outra data**? ",1200),setTimeout(()=>{at()},400)},1600);return}const jt=et.slots;if(jt.length===0){console.log("[handleDataSelection] Nenhum horrio disponvel"),l("Ops! No encontrei **horrios disponveis** para esse dia.  Que tal tentar outro dia?"),setTimeout(()=>{l("Escolha **outra data**:",800),setTimeout(()=>{at()},400)},1200);return}const yt=Je(jt);let qt="";yt.length===1?qt=`Tenho **horrios livres** das **${yt[0].inicio}** s **${yt[0].fim}**! `:qt=`Tenho **horrios livres** ${yt.map((Dt,he)=>he===yt.length-1?`e das **${Dt.inicio}** s **${Dt.fim}**`:he===0?`das **${Dt.inicio}** s **${Dt.fim}**`:`das **${Dt.inicio}** s **${Dt.fim}**`).join(", ")}! `,l(qt,800),setTimeout(()=>{l("Escolha o horrio de incio e trmino: ",1e3),g("horario"),setTimeout(()=>{z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},200),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},600),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},1e3)},1e3+600)},1400)},Ge=async(Ye,$e,Be=null)=>{try{console.log("[loadHorariosDisponiveis] quadraId:",Ye),console.log("[loadHorariosDisponiveis] data:",$e);const et=C.find(Fr=>Fr.id===Ye);if(!et)return console.error("[loadHorariosDisponiveis] Quadra no encontrada:",Ye),[];console.log("[loadHorariosDisponiveis] Quadra encontrada:",et.nome),console.log("[loadHorariosDisponiveis] Horrio funcionamento:",et.hora_inicio,"-",et.hora_fim);const jt=cr($e,"yyyy-MM-dd"),yt=$e.getDay();console.log("[loadHorariosDisponiveis] Verificando funcionamento para:",jt,"dia da semana:",yt);const{data:qt,error:pt}=await de.from("quadras_dias_funcionamento").select("*").eq("codigo_empresa",n).eq("quadra_id",Ye).or(`and(tipo.eq.data_fechamento,data_fechamento.eq.${jt}),and(tipo.eq.dia_semana,dia_semana.eq.${yt})`);if(pt)console.error("[loadHorariosDisponiveis] Erro ao buscar configuraes de funcionamento:",pt);else{console.log("[loadHorariosDisponiveis] Configuraes encontradas:",qt?.length||0);const Fr=qt?.find(nt=>nt.tipo==="data_fechamento"&&nt.data_fechamento===jt);if(Fr&&!Fr.funciona)return console.log("[loadHorariosDisponiveis] Quadra fechada em data especfica:",Fr.observacao),{slots:[],fechada:!0,motivo:"data_especifica",observacao:Fr.observacao||"Fechamento especial"};const Tn=qt?.find(nt=>nt.tipo==="dia_semana"&&nt.dia_semana===yt);if(Tn&&!Tn.funciona)return console.log("[loadHorariosDisponiveis] Quadra no funciona neste dia da semana"),{slots:[],fechada:!0,motivo:"dia_semana",observacao:`Quadra fechada s ${["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"][yt]}s`};console.log("[loadHorariosDisponiveis] Quadra funciona normalmente na data selecionada")}const Dt=_s($e),he=Ta(Dt,1);let Qe=de.from("agendamentos").select("inicio, fim, status").eq("codigo_empresa",n).eq("quadra_id",Ye).gte("inicio",Dt.toISOString()).lt("inicio",he.toISOString()).neq("status","canceled");Be&&(Qe=Qe.neq("id",Be),console.log("[loadHorariosDisponiveis] Excluindo agendamento sendo editado:",Be));const{data:zt,error:Mt}=await Qe;if(Mt)throw Mt;console.log("[loadHorariosDisponiveis] Agendamentos encontrados:",zt?.length||0);const ir=parseInt(et.hora_inicio?.split(":")[0]||"6");let nr=parseInt(et.hora_fim?.split(":")[0]||"24");nr===0&&(nr=24);const kr=new Date,Ft=_s($e).getTime()===_s(kr).getTime(),Dr=[];for(let Fr=ir;Fr<nr;Fr++)for(let Tn of[0,30]){const nt=aj(nj($e,Fr),Tn),$t=q6(nt,30);if(Ft&&nt<kr)continue;zt?.some(sr=>{const St=new Date(sr.inicio),Jr=new Date(sr.fim),Pt=Math.floor(nt.getTime()/6e4),lr=Math.floor($t.getTime()/6e4),st=Math.floor(St.getTime()/6e4),Et=Math.floor(Jr.getTime()/6e4);return lr===st||Pt===Et?!1:Pt<Et&&lr>st})||Dr.push({inicio:cr(nt,"HH:mm"),fim:cr($t,"HH:mm"),inicioDate:nt,fimDate:$t})}return console.log("[loadHorariosDisponiveis] Total de slots disponveis:",Dr.length),R(Dr),{slots:Dr,fechada:!1,motivo:null,observacao:null}}catch(et){return console.error("[loadHorariosDisponiveis] Erro ao carregar horrios:",et),R([]),{slots:[],fechada:!1,motivo:"erro",observacao:"Erro ao carregar horrios"}}},Je=Ye=>{if(Ye.length===0)return[];const $e=[];let Be={inicio:Ye[0].inicio,fim:Ye[0].fim};for(let jt=1;jt<Ye.length;jt++)Ye[jt].inicio===Be.fim?Be.fim=Ye[jt].fim:($e.push(Be),Be={inicio:Ye[jt].inicio,fim:Ye[jt].fim});$e.push(Be);const et=jt=>{const[yt,qt]=jt.split(":").map(Number);return yt===0&&qt===0?24*60:yt*60+qt};return $e.filter(jt=>et(jt.fim)-et(jt.inicio)>=60)},_e=({inicio:Ye,fim:$e,esporte:Be})=>{const[et,jt]=Ye.split(":").map(Number),[yt,qt]=$e.split(":").map(Number),pt=i.data,Dt=aj(nj(pt,et),jt),he=yt===0&&qt===0?aj(nj(Ta(pt,1),0),0):aj(nj(pt,yt),qt),Qe={inicio:Ye,fim:$e,inicioDate:Dt,fimDate:he};if(d(`${Qe.inicio} - ${Qe.fim}  ${Be}`),console.log("[handleHorarioSubmit] Atualizando horrio:",Qe),console.log("[handleHorarioSubmit] Atualizando esporte:",Be),m("horario",Qe),m("esporte",Be),z(!1),o==="review"||W==="horario"){setTimeout(()=>{$(null),g("review"),Nt(Qe,Be)},600);return}const zt=i.participantes||[];if(!(Array.isArray(zt)&&zt.length>0)){const nr=[{nome:i.cliente.nome,cliente_id:i.cliente.id,principal:!0}];m("participantes",nr)}const ir=Re(i.cliente.nome);l(`Perfeito! ${ir}, voc j est na lista! `,800),l('Quer adicionar mais pessoas? Digite o nome e clique em "Adicionar" para cada um, ou finalize quando quiser.',1400),setTimeout(()=>{z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},200),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},600)},1400+600),g("participantes")},je=async()=>{const Ye=i?.quadra?.id,$e=i?.data,Be=i?.horario;if(!Ye||!$e||!Be?.inicioDate||!Be?.fimDate)return{ok:!0,conflito:!1};const et=await Ge(Ye,$e,null);if(et?.fechada)return{ok:!0,conflito:!0,motivo:"fechada",detalhe:et};const jt=Array.isArray(et?.slots)?et.slots:[],yt=Be.inicioDate,qt=Be.fimDate,pt=(he,Qe)=>{const zt=he.getTime(),Mt=Qe.getTime();return jt.some(ir=>ir?.inicioDate?.getTime?.()===zt&&ir?.fimDate?.getTime?.()===Mt)};let Dt=new Date(yt);for(;Dt.getTime()<qt.getTime();){const he=q6(Dt,30);if(!pt(Dt,he))return{ok:!0,conflito:!0,motivo:"conflito"};Dt=he}return{ok:!0,conflito:!1}},Ue=Ye=>{if(!Ye||!Ye.trim())return;const $e=i.participantes||[],Be={nome:Ye.trim(),cliente_id:null,principal:!1},et=[...$e,Be];m("participantes",et)},ze=Ye=>{if(!Array.isArray(Ye)||Ye.length===0)return;const $e=he=>String(he||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim().replace(/\s+/g," "),Be=i.cliente,et=Be?.nome?String(Be.nome).trim():null,jt=et?$e(et):null,yt=i.participantes||[],qt=yt.length>0?yt:et&&Be?[{nome:et,cliente_id:Be.id,principal:!0}]:[],pt=[];if(!!i?.editing_agendamento){let he=qt.find(Qe=>Qe.principal)||(et&&Be?{nome:et,cliente_id:Be.id,principal:!0}:null);he&&pt.push({...he,principal:!0}),Ye.forEach(Qe=>{const zt=String(Qe||"").trim();if(!zt)return;const Mt=$e(zt);jt&&Mt===jt||pt.push({nome:zt,cliente_id:null,principal:!1})})}else qt.forEach(he=>{const Qe=$e(he.nome),zt=jt&&Qe===jt;pt.push({...he,principal:zt})}),Ye.forEach(he=>{const Qe=String(he||"").trim();if(!Qe)return;const zt=$e(Qe);jt&&zt===jt||pt.push({nome:Qe,cliente_id:null,principal:!1})});pt.length===0&&et&&Be&&pt.push({nome:et,cliente_id:Be.id,principal:!0}),m("participantes",pt)},or=Ye=>{const $e=i.participantes||[];if(Ye===0)return;const Be=$e.filter((et,jt)=>jt!==Ye);m("participantes",Be)},tr=Ye=>{const $e=i.participantes||[];if($e.length===0){l("Voc precisa ter pelo menos 1 participante!",400);return}try{const et=(Ye||"").trim();et&&et!==i.esporte&&m("esporte",et)}catch{}z(!1);const Be=$e.length;if(Be===1)d(" Apenas eu por enquanto");else{const et=$e.filter(jt=>!jt.principal).map(jt=>jt.nome).join(", ");d(` Eu + ${et} (${Be} pessoas)`)}setTimeout(()=>{$(null);try{const et=(Ye||"").trim();Nt(null,et||null)}catch{Nt()}},600)},Nt=(Ye=null,$e=null,Be=!1,et=null,jt=null,yt=null,qt=null)=>{const pt=Ye||i.horario,Dt=$e||i.esporte,he=et||i.quadra,Qe=jt||i.data,zt=yt||i.participantes||[],Mt=!!(qt||i?.editing_agendamento||X);if(console.log("[mostrarResumo] Selections atuais:",i),console.log("[mostrarResumo] Horrio usado:",pt),console.log("[mostrarResumo] Esporte usado:",Dt),console.log("[mostrarResumo] Quadra atual:",he),console.log("[mostrarResumo] Data atual:",Qe),console.log("[mostrarResumo] Modo edio inicial:",Be),!Qe||!pt||!he){console.error("[mostrarResumo] Dados obrigatrios faltando:",{dataFinal:Qe,horarioFinal:pt,quadraFinal:he});return}if(!Be){const ot=Cv("reviewData");l(ot,400)}const ir=zt.map((ot,ee)=>{const k=ee===0?"":"",T=ee===0?" (voc)":"";return`${k} ${ot.nome}${T}`}).join(`
`),nr=cr(Qe,"dd/MM/yyyy",{locale:na}),kr=cr(Qe,"EEEE",{locale:na}),[Ft,Dr]=pt.inicio.split(":").map(Number),[Fr,Tn]=pt.fim.split(":").map(Number);let nt=Fr*60+Tn-(Ft*60+Dr);Fr===0&&Tn===0&&(nt=24*60-(Ft*60+Dr));const $t=Math.floor(nt/60),Kt=nt%60,sr=Kt>0?`${$t}h ${Kt}min`:`${$t}h`,St=he.valor||0,Jr=nt/30,Pt=Math.round(St*Jr*100)/100,lr=Pt/zt.length;console.log("[mostrarResumo] Clculo do valor:"),console.log("- Valor por meia hora:",St),console.log("- Slots de 30min:",Jr),console.log("- Durao em minutos:",nt),console.log("- Valor total:",Pt),console.log("- Participantes:",zt.length),console.log("- Valor dividido:",lr);const st=i?.empresa?.endereco&&String(i.empresa.endereco).trim().length>0?String(i.empresa.endereco).trim():null,Et=st?`
 **Endereo**
${st}
`:"",ar=ot=>{if(!ot)return"N/A";const ee=String(ot).replace(/\D/g,"");return ee.length===11?`(${ee.slice(0,2)}) ${ee.slice(2,7)}-${ee.slice(7)}`:ee.length===10?`(${ee.slice(0,2)}) ${ee.slice(2,6)}-${ee.slice(6)}`:ot},Tr=i.cliente.telefone||i.cliente.whatsapp||null,Qr=ar(Tr),tn=` **RESUMO DO AGENDAMENTO**

 **Quadra**
${he.nome}${Et}
 **Data**
${nr} (${kr})

 **Horrio**
${pt.inicio} s ${pt.fim}
 Durao: **${sr}**

 **Modalidade**
${Dt}

 **Participantes** (${zt.length})
${ir}

 **Valor Total**
R$ **${Pt.toFixed(2).replace(".",",")}**
 **Valor Dividido**
R$ **${lr.toFixed(2).replace(".",",")}** por pessoa

 **Responsvel**
${i.cliente.nome}
 ${Qr}`,Qt=Be?200:1e3,fn=tn.replace(/\*\*(.+?)\*\*/g,"*$1*");l({text:tn,copyable:!0,copyText:fn},Qt);const nn=[{label:Mt?"Salvar Alteraes":"Confirmar Agendamento",value:Mt?"confirm":"criar agendamento",icon:""}],In=[];C.length>1&&In.push({label:"Editar Quadra",value:"edit_quadra",icon:""}),In.push({label:"Editar Data",value:"edit_data",icon:""}),In.push({label:"Editar Horrio e Esporte",value:"edit_horario",icon:""}),In.push({label:"Editar Participantes",value:"edit_participantes",icon:""}),(Be||Mt&&!i?.editing_agendamento)&&In.push({label:"Gerar Times",value:"gerar_times",icon:""}),Mt&&In.push({label:"Cancelar Agendamento",value:"cancelar_agendamento",icon:""});const se=[...nn,...In];se.push({label:" Menu",value:"menu",action:"menu"}),c("Est tudo correto?",se,Be?400:1600),g("review")},yr=(Ye,$e=!1)=>{l($e?" **Perfeito!** Suas **alteraes** foram **salvas com sucesso!**":" **Pronto!** Seu **agendamento** foi **confirmado com sucesso!**",600,"green");const et=i.participantes||[],jt=et.map(St=>` ${St.nome}`).join(`
`),yt=cr(i.data,"dd/MM/yyyy",{locale:na}),qt=cr(i.data,"EEEE",{locale:na}),[pt,Dt]=i.horario.inicio.split(":").map(Number),[he,Qe]=i.horario.fim.split(":").map(Number);let zt=he*60+Qe-(pt*60+Dt);he===0&&Qe===0&&(zt=24*60-(pt*60+Dt));const Mt=Math.floor(zt/60),ir=zt%60,nr=ir>0?`${Mt}h ${ir}min`:`${Mt}h`,kr=i.quadra.valor||0,Ft=zt/30,Dr=Math.round(kr*Ft*100)/100,Fr=et.length>0?Dr/et.length:0,Tn=i?.empresa?.endereco&&String(i.empresa.endereco).trim().length>0?String(i.empresa.endereco).trim():null,nt=Tn?`
 **Endereo**
${Tn}
`:"",$t=` **AGENDAMENTO CONFIRMADO**

 **Cdigo:** #${Ye.codigo}

 **Local**
${i.quadra.nome}${nt}

 **Quando**
${yt} (${qt})
 ${i.horario.inicio} s ${i.horario.fim} **(${nr})**

 **Modalidade**
${i.esporte}

 **Participantes** (${et.length})
${jt}

 **Valor Total:** R$ **${Dr.toFixed(2).replace(".",",")}**
 **Valor Dividido:** R$ **${Fr.toFixed(2).replace(".",",")}** por pessoa

 **Responsvel:** ${i.cliente.nome}`,Kt=$t.replace(/\*\*(.+?)\*\*/g,"*$1*");l({text:$t,copyable:!0,copyText:Kt},1200),c("O que voc gostaria de fazer?",[{label:"Gerar Times",value:"gerar_times",icon:""},{label:"Editar Agendamento",value:"editar_agendamento",icon:""},{label:"Cancelar Agendamento",value:"cancelar_agendamento",icon:""},{label:"Finalizar Atendimento",value:"finalizar",icon:""}],1800)},Me=async()=>{try{x(!0)}catch{}try{const Ye=(i.participantes||[]).map(st=>String(st?.nome||"").trim()).filter(Boolean);if(!Ye||Ye.length===0){l("No h participantes suficientes para formar times.");return}const $e=String(i?.esporte||i?.quadra?.tipo||"").toLowerCase();let Be=0,et="unknown";try{console.log("[Teams] Start generation modalidade=%o",$e)}catch{}try{const{data:st}=await de.functions.invoke("infer-team-size",{body:{modalidade:$e,quadra:i?.quadra||null,totalPlayers:(i.participantes||[]).length}});try{console.log("[Teams] Edge infer-team-size response=%o",st)}catch{}st&&Number(st.teamSize)>0&&(Be=Number(st.teamSize),et="edge")}catch{}if(!Be)if(/(praia|areia)/i.test($e)){Be=5,et="fallback:beach";try{console.log("[Teams] Fallback matched: praia/areia -> teamSize=5")}catch{}}else if(/(v[o]lei|voleibol)/i.test($e)){Be=6,et="fallback:volley";try{console.log("[Teams] Fallback matched: volei/voleibol -> teamSize=6")}catch{}}else if(/(hand|handebol)/i.test($e)){Be=7,et="fallback:hand";try{console.log("[Teams] Fallback matched: handebol -> teamSize=7")}catch{}}else if(/(futsal|society)/i.test($e)){Be=5,et="fallback:futsal";try{console.log("[Teams] Fallback matched: futsal/society -> teamSize=5")}catch{}}else if(/(futebol|campo)/i.test($e)){Be=11,et="fallback:campo";try{console.log("[Teams] Fallback matched: futebol/campo -> teamSize=11")}catch{}}else{Be=5,et="fallback:default";try{console.log("[Teams] Fallback matched: default -> teamSize=5")}catch{}}{const st=String($e||"").toLowerCase(),Et=/(v[o]lei|voleibol)/.test(st),ar=/(praia|areia)/.test(st),Tr=Be;Et&&(Be=ar?5:6),Et&&(et=ar?"forced:beach":"forced:volley");try{console.log("[Teams] Normalization: isVolley=%s isBeach=%s before=%s after=%s source=%s",Et,ar,Tr,Be,et)}catch{}}const jt=st=>String(st||"").trim().toLowerCase(),yt=Array.isArray(i?.fixos)?i.fixos:[],qt=Array.isArray(i?.goleiros)?i.goleiros:[],pt=Array.isArray(i?.levantadores)?i.levantadores:[],Dt=new Set([...yt,...qt,...pt].map(jt).filter(Boolean)),he=st=>Dt.has(jt(st)),Qe=(()=>{const st={},Et=i?.fixoRoles;if(Et&&typeof Et=="object")for(const ar of Object.keys(Et))st[ar]=Et[ar];return qt.forEach(ar=>{st[jt(ar)]="Goleiro"}),pt.forEach(ar=>{st[jt(ar)]="Levantador"}),st})(),zt=st=>he(st)?` (${Qe[jt(st)]||"Fixo"})`:"",Mt=Ye.filter(he),nr=Ye.filter(st=>!he(st)).slice();for(let st=nr.length-1;st>0;st--){const Et=Math.floor(Math.random()*(st+1));[nr[st],nr[Et]]=[nr[Et],nr[st]]}Be<2&&(Be=2);const kr=st=>st.map((Et,ar)=>`${ar+1}) ${Et}${zt(Et)}`).join(`
`)||"",Ft=Ye.length;let Dr=0;if(Ft>=2*Be){Dr=Math.max(2,Math.floor(Ft/Be));try{console.log("[Teams] Brute rule: canMakeTwoBase=true -> teamCount=%s teamSize=%s",Dr,Be)}catch{}}else{const st=Be;Be>5&&(Be=5),Dr=Math.ceil(Ft/Be);try{console.log("[Teams] Brute rule: canMakeTwoBase=false -> forceSize %s->%s, teamCount=%s",st,Be,Dr)}catch{}}let nt=` **Times gerados (${$e?$e[0].toUpperCase()+$e.slice(1):"modalidade"})**`;const $t=["","","","","",""],Kt=($e||"").toLowerCase(),sr=/(fut|society|sal[a]o)/.test(Kt),St=/(v[o]lei|volei|voleibol)/.test(Kt);try{console.log("[Teams] teamSize=%s totalPlayers=%s teamCount=%s isVolleyLike=%s isSoccerLike=%s source=%s",Be,Ft,Dr,St,sr,et)}catch{}if(Dr>=2){const st=Array.from({length:Dr},()=>[]);if(sr&&qt.length>0)for(let Qt=0;Qt<Dr;Qt++){const fn=qt[Qt%qt.length],nn=st[Qt].some(In=>qt.includes(In));st[Qt].length<Be&&!nn&&!st[Qt].includes(fn)&&st[Qt].push(fn)}if(St&&pt.length>0)for(let Qt=0;Qt<Dr;Qt++){const fn=pt[Qt%pt.length],nn=st[Qt].some(In=>pt.includes(In));st[Qt].length<Be&&!nn&&!st[Qt].includes(fn)&&st[Qt].push(fn)}const Et=Mt.filter(Qt=>!qt.includes(Qt)&&!pt.includes(Qt));if(Et.length>0){let Qt=0;for(const fn of Et){let nn=0;for(;nn<Dr&&st[Qt].length>=Be;)Qt=(Qt+1)%Dr,nn++;st[Qt].length<Be&&st[Qt].push(fn),Qt=(Qt+1)%Dr}}for(const Qt of nr){let fn=0,nn=1/0;for(let In=0;In<st.length;In++)st[In].length<nn&&st[In].length<Be&&(nn=st[In].length,fn=In);st[fn].length<Be&&st[fn].push(Qt)}for(let Qt=0;Qt<st.length;Qt++)for(;st[Qt].length<Be;)if(sr&&qt.length>0){if(st[Qt].some(In=>qt.includes(In)))break;const nn=qt.find(In=>!st[Qt].includes(In));if(nn)st[Qt].push(nn);else break}else if(St&&pt.length>0){if(st[Qt].some(In=>pt.includes(In)))break;const nn=pt.find(In=>!st[Qt].includes(In));if(nn)st[Qt].push(nn);else break}else break;const ar=Dr*Be,Tr=Ft>ar?[...Mt,...nr].slice(ar):[];sr&&qt.length>0?Tr.some(fn=>qt.includes(fn))||Tr.unshift(qt[0]):St&&pt.length>0&&(Tr.some(fn=>pt.includes(fn))||Tr.unshift(pt[0]));try{const Qt=st.map(fn=>fn.length);console.log("[Teams] Final distribution teamSize=%s teams=%o reservas=%o",Be,Qt,Tr)}catch{}const Qr=[];for(;Tr.length>=Be;)Qr.push(Tr.splice(0,Be));st.concat(Qr).forEach((Qt,fn)=>{const nn=$t[fn%$t.length];nt+=`

**${nn} Time ${fn+1} (${Qt.length})**:
${kr(Qt)}`}),Tr.length&&(nt+=`

** Reservas (${Tr.length})**:
${kr(Tr)}`)}else{const st=[...Mt,...nr];if(st.length===0){l("No h participantes suficientes para formar times.");return}if(st.length===1)nt+=`

 Ainda no h jogadores suficientes para formar 2 times. Adicione mais participantes.`,nt+=`

** Time 1 (1)**:
1) ${st[0]}${zt(st[0])}`;else{const Et=Math.min(Be,Math.ceil(st.length/2)),ar=Math.min(Be,st.length-Et),Tr=st.slice(0,Et),Qr=st.slice(Et,Et+ar);nt+=`

 Jogadores insuficientes para 2 equipes completas de ${Be}. Montei 2 times balanceados de ${Tr.length} e ${Qr.length}.`,nt+=`

** Time 1 (${Tr.length})**:
${kr(Tr)}`,nt+=`

** Time 2 (${Qr.length})**:
${kr(Qr)}`}}const Jr=nt.replace(/\*\*(.+?)\*\*/g,"*$1*");l({text:nt,copyable:!0,copyText:Jr},600);const lr=[...!0?[{label:"Gerar novamente",value:"gerar_times_again",icon:""}]:[],{label:"Concluir",value:"aceitar_times",icon:""}];c("Tudo certo com os times?",lr,1400)}catch{l("No foi possvel gerar times agora. Tente novamente.")}},dt=async Ye=>{if(Ye.action==="menu"){d(" Menu");try{ye(null)}catch{}try{m("editing_agendamento",null)}catch{}try{m("quadra",null)}catch{}try{m("data",null)}catch{}try{m("horario",null)}catch{}try{m("modalidade",null)}catch{}try{m("quantidade",null)}catch{}try{m("nomes",[])}catch{}try{m("participantes",[])}catch{}try{m("levantadores",[])}catch{}try{m("goleiros",[])}catch{}try{m("fixos",[])}catch{}try{m("fixoRoles",{})}catch{}try{$(null)}catch{}try{z(!1)}catch{}g("identificacao"),setTimeout(()=>{Ze()},400);return}if(Ye.quadra){await Ct(Ye);return}if(Ye.date){await wt(Ye);return}if(Ye.agendamento){const $e=cr(new Date(Ye.agendamento.inicio),"dd/MM/yyyy",{locale:na}),Be=cr(new Date(Ye.agendamento.inicio),"HH:mm"),et=cr(new Date(Ye.agendamento.fim),"HH:mm");d(`${$e}  ${Be}-${et}`),await rr(Ye.agendamento);return}switch(Ye.value){case"novo_agendamento":{d(" Fazer Agendamento");try{ye(null)}catch{}try{m("editing_agendamento",null)}catch{}try{m("quadra",null)}catch{}try{m("data",null)}catch{}try{m("horario",null)}catch{}try{m("modalidade",null)}catch{}try{m("quantidade",null)}catch{}try{m("nomes",[])}catch{}try{m("participantes",[])}catch{}try{m("levantadores",[])}catch{}try{m("goleiros",[])}catch{}try{m("fixos",[])}catch{}try{m("fixoRoles",{})}catch{}try{$(null)}catch{}try{z(!1)}catch{}await ht();break}case"buscar_agendamento":{d(" Editar Agendamento"),l("Vou buscar seus agendamentos...",600),ut();break}case"finalizar_atendimento":{d(" Finalizar Atendimento");try{resetConversation()}catch{}l("Atendimento finalizado. Se precisar,  s me chamar de novo! ",400);break}case"corrigir_telefone":{d(" Informei o telefone errado"),m("cliente",null),m("identificacao_valor",null),D("telefone"),z(!0),g("identificacao");break}case"corrigir_email":{d(" Informei o e-mail errado"),m("cliente",null),m("identificacao_valor",null),D("email"),z(!0),g("identificacao");break}case"continuar_fluxo":{Ze();break}case"gerar_times":case"gerar_times_again":{d(Ye.value==="gerar_times_again"?" Gerar novamente":" Gerar Times"),await Me();break}case"aceitar_times":{d(" Concluir"),l("Beleza! O que voc gostaria de fazer agora?",400),setTimeout(()=>{Ze()},800);break}case"confirm":const $e=!!i?.editing_agendamento||!!X;d($e?" Salvar Alteraes":" Confirmar Agendamento"),$e?await ur():await er();break;case"criar agendamento":d(" Confirmar Agendamento"),await er();break;case"edit_quadra":d(" Editar Quadra");const et=C.map(nr=>({label:nr.nome,value:nr.id,icon:"",subtitle:nr.descricao||nr.tipo||null,quadra:nr}));c("Qual quadra voc quer?",et,600);break;case"edit_data":d(" Editar Data");const jt=new Date,yt=Ta(jt,1),qt=[{label:`Hoje (${cr(jt,"dd/MM")})`,value:cr(jt,"yyyy-MM-dd"),icon:"",date:jt},{label:`Amanh (${cr(yt,"dd/MM")})`,value:cr(yt,"yyyy-MM-dd"),icon:"",date:yt},{label:"Outro dia...",value:"custom",icon:""}];c("Para qual dia?",qt,600),g("data");break;case"edit_horario":d(" Editar Horrio e Esporte"),z(!1),$("horario"),y(!0);const pt=await Ge(i.quadra.id,i.data,X?.id);if(y(!1),pt.fechada){const nr=cr(i.data,"dd/MM/yyyy",{locale:na}),kr=cr(i.data,"EEEE",{locale:na});if(pt.motivo==="data_especifica")l(`**Ops!** A quadra estar **fechada** no dia **${nr}** (${kr}). 

**Motivo:** ${pt.observacao}`,800);else if(pt.motivo==="dia_semana"){const Ft=cr(i.data,"EEEE",{locale:na});l(`**Ops!** A quadra no funciona ${Ft==="domingo"||Ft==="sbado"?"aos":"s"} **${Ft}s**. `,800)}setTimeout(()=>{l("No  possvel editar o horrio. Escolha **outra data** ou **quadra**:",1200),setTimeout(()=>{at()},400)},1600);return}const Dt=pt.slots;if(Dt&&Dt.length>0){const nr=Je(Dt);let kr="";nr.length===1?kr=`Tenho **horrios livres** das **${nr[0].inicio}** s **${nr[0].fim}**! `:kr=`Tenho **horrios livres** ${nr.map((Dr,Fr)=>Fr===nr.length-1?`e das **${Dr.inicio}** s **${Dr.fim}**`:Fr===0?`das **${Dr.inicio}** s **${Dr.fim}**`:`das **${Dr.inicio}** s **${Dr.fim}**`).join(", ")}! `,l(kr,600),setTimeout(()=>{l("Escolha o horrio de incio e trmino: ",800),setTimeout(()=>{z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1e3)},800)}else l("Ops! No encontrei **horrios disponveis**. ");break;case"edit_participantes":d(" Editar Participantes"),z(!1),$("participantes"),l("Edite a lista de participantes:",600),setTimeout(()=>{z(!0),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},200)},800);break;case"finalizar":d(" Finalizar Atendimento");const he=["Pronto! Seu agendamento est confirmado! ","Perfeito! Agendamento realizado com sucesso! ","Tudo certo! Seu horrio est garantido! ","Sucesso! Agendamento confirmado! "],Qe=he[Math.floor(Math.random()*he.length)];l(Qe,800),setTimeout(()=>{It()},1400);break;case"cancelar_agendamento":d(" Cancelar Agendamento");const zt=[{label:"Sim, cancelar",value:"confirmar_cancelamento",icon:""},{label:"No, voltar",value:"voltar_cancelamento",icon:""}],Mt=["Tem certeza que deseja cancelar este agendamento?","Confirma o cancelamento do agendamento?","Realmente quer cancelar? Esta ao no pode ser desfeita.","Deseja mesmo cancelar este agendamento?"],ir=Mt[Math.floor(Math.random()*Mt.length)];c(ir,zt,600);break;case"confirmar_cancelamento":await hr();break;case"voltar_cancelamento":d(" Voltar"),l("Ok! Voltando ao resumo do agendamento.",400),setTimeout(()=>{Nt(null,null,!0,null,null,null,X)},800);break;case"editar_agendamento":d(" Editar Agendamento"),l("Claro! O que voc gostaria de alterar?",600),setTimeout(()=>{Nt(null,null,!0)},800);break;case"novo_agendamento":d(" Fazer Agendamento"),ht();break;case"buscar_agendamento":d(" Editar Agendamento"),l("Vou buscar seus agendamentos...",600),ut();break;case"finalizar_atendimento":d(" Finalizar Atendimento"),It();break;default:console.warn("[Isis] Ao no reconhecida:",Ye.value)}},ut=async()=>{try{console.log("[buscarAgendamentosCliente] Iniciando busca de agendamentos...");const{data:Ye,error:$e}=await de.from("agendamentos").select(`
          id,
          codigo,
          inicio,
          fim,
          modalidade,
          status,
          valor_total,
          quadras!inner(nome, descricao, valor)
        `).eq("codigo_empresa",n).eq("cliente_id",i.cliente.id).in("status",["scheduled","confirmed"]).gte("inicio",new Date().toISOString()).order("inicio",{ascending:!0});if($e)throw $e;if(!Ye||Ye.length===0){l("No encontrei agendamentos futuros para voc. ",800),l("Que tal fazer um novo agendamento? ",1400),setTimeout(()=>{ht()},2e3);return}if(Ye.length===1){const Be=Ye[0],et=cr(new Date(Be.inicio),"dd/MM/yyyy",{locale:na}),jt=cr(new Date(Be.inicio),"HH:mm"),yt=cr(new Date(Be.fim),"HH:mm");l(`Encontrei seu agendamento para ${et} das ${jt} s ${yt} - ${Be.modalidade}! `,800),setTimeout(()=>{rr(Be)},1200)}else{l(`Encontrei ${Ye.length} agendamentos futuros! Qual voc quer editar?`,800);const Be=Ye.map(et=>{const jt=new Date(et.inicio),yt=cr(jt,"dd/MM/yyyy",{locale:na}),qt=cr(jt,"EEEE",{locale:na}),pt=cr(jt,"HH:mm"),Dt=cr(new Date(et.fim),"HH:mm"),he=(new Date(et.fim)-jt)/(1e3*60),Qe=Math.floor(he/60),zt=he%60;let Mt="";Qe>0?Mt=zt>0?`${Qe}h${zt}m`:`${Qe}h`:Mt=`${zt}m`;const ir=Number(et.quadras?.valor??0),nr=he/30,Ft=(Math.round(ir*nr*100)/100).toFixed(2).replace(".",","),Dr=new Date,Fr=new Date(Dr);Fr.setDate(Dr.getDate()+1);let Tn="";return jt.toDateString()===Dr.toDateString()?Tn="Hoje":jt.toDateString()===Fr.toDateString()?Tn="Amanh":Tn=`${qt.charAt(0).toUpperCase()+qt.slice(1)}, ${yt}`,{label:`${Tn}  ${pt}-${Dt}`,value:`editar_agendamento_${et.id}`,icon:"",subtitle:`${et.quadras?.nome||"Quadra"}  ${et.modalidade||""}  ${Mt}`,agendamento:et}});setTimeout(()=>{c("Escolha o agendamento:",Be,600)},1200)}}catch(Ye){console.error("[Isis] Erro ao buscar agendamentos:",Ye),l("Ops! Tive um problema ao buscar seus agendamentos. ",800),l("Que tal tentar fazer um novo agendamento?",1400),setTimeout(()=>{ht()},2e3)}},rr=async Ye=>{try{console.log("[carregarAgendamentoParaEdicao] Iniciando carregamento do agendamento:",Ye.id),console.debug("[carregarAgendamentoParaEdicao] Iniciando JOIN: agendamentos  quadras, agendamento_participantes");const{data:$e,error:Be}=await de.from("agendamentos").select(`
          *,
          quadras(id, nome, descricao, modalidades, valor),
          agendamento_participantes(nome, cliente_id, ordem, is_representante)
        `).eq("id",Ye.id).single();if(console.debug("[carregarAgendamentoParaEdicao] Resultado JOIN:",{hasError:!!Be,error:Be?.message,code:Be?.code,participantes_len:Array.isArray($e?.agendamento_participantes)?$e.agendamento_participantes.length:null}),Be)throw console.error("[Isis] Erro ao buscar agendamento:",Be),new Error(`Agendamento no encontrado ou inacessvel: ${Be.message}`);if(!$e)throw new Error("Agendamento no encontrado");const et=new Date($e.inicio),jt=cr(et,"HH:mm"),yt=cr(new Date($e.fim),"HH:mm");let qt=$e.quadras||null;if(!qt)try{const{data:Mt}=await de.from("quadras").select("id, nome, descricao, modalidades, valor").eq("id",$e.quadra_id).single();qt=Mt||null}catch{}m("quadra",qt),m("data",et),m("horario",{inicio:jt,fim:yt,inicioDate:new Date($e.inicio),fimDate:new Date($e.fim)}),m("esporte",$e.modalidade);const pt=$e.cliente_id||i.cliente?.id||null;let Dt=$e.agendamento_participantes||[];if(!Dt||Dt.length===0)try{console.debug("[carregarAgendamentoParaEdicao] JOIN sem participantes. Fazendo SELECT direto em agendamento_participantes...");const{data:Mt,error:ir}=await de.from("agendamento_participantes").select("nome, cliente_id, codigo_empresa, ordem, is_representante").eq("agendamento_id",Ye.id).order("ordem",{ascending:!0});console.debug("[carregarAgendamentoParaEdicao] SELECT direto participantes:",{hasError:!!ir,error:ir?.message,code:ir?.code,count:Array.isArray(Mt)?Mt.length:null}),Array.isArray(Mt)&&Mt.length>0&&(Dt=Mt.map(nr=>({nome:nr.nome,cliente_id:nr.cliente_id,ordem:nr.ordem,is_representante:nr.is_representante})))}catch(Mt){console.debug("[carregarAgendamentoParaEdicao] Falha no SELECT direto participantes:",Mt?.message||Mt)}const he=[...Dt].sort((Mt,ir)=>{const nr=Number(Mt?.ordem??0),kr=Number(ir?.ordem??0);return Number.isFinite(nr)&&Number.isFinite(kr)&&nr!==kr?nr-kr:0}),Qe=(()=>{const Mt=he.findIndex(ir=>!!ir?.is_representante);if(Mt>=0)return Mt;if(pt){const ir=he.findIndex(nr=>nr?.cliente_id===pt);if(ir>=0)return ir}return 0})(),zt=he.map((Mt,ir)=>({nome:Mt.nome,cliente_id:Mt.cliente_id,principal:ir===Qe}));m("participantes",zt);try{m("editing_agendamento",!0)}catch{}try{const Mt=$e?.meta_roles||null;if(Mt&&typeof Mt=="object"){const ir=Array.isArray(Mt.levantadores)?Mt.levantadores:[],nr=Array.isArray(Mt.goleiros)?Mt.goleiros:[],kr=Array.isArray(Mt.fixos)?Mt.fixos:Array.from(new Set([...ir,...nr])),Ft=Mt.fixoRoles&&typeof Mt.fixoRoles=="object"?Mt.fixoRoles:{};m("levantadores",ir),m("goleiros",nr),m("fixos",kr),m("fixoRoles",Ft)}else{const ir=`f7a:fixos:${$e.id}`,nr=JSON.parse(localStorage.getItem(ir)||"null");if(nr&&typeof nr=="object"){const kr=Array.isArray(nr.levantadores)?nr.levantadores:[],Ft=Array.isArray(nr.goleiros)?nr.goleiros:[],Dr=Array.isArray(nr.fixos)?nr.fixos:Array.from(new Set([...kr,...Ft])),Fr=nr.fixoRoles&&typeof nr.fixoRoles=="object"?nr.fixoRoles:{};m("levantadores",kr),m("goleiros",Ft),m("fixos",Dr),m("fixoRoles",Fr)}}}catch{}ye($e),l("Perfeito! Aqui esto os detalhes do seu agendamento:",600),setTimeout(()=>{const Mt={inicio:jt,fim:yt,inicioDate:new Date($e.inicio),fimDate:new Date($e.fim)};qt?(Nt(Mt,$e.modalidade,!0,qt,et,zt,$e),g("review")):(l("No consegui carregar os dados da quadra deste agendamento. Vamos escolher a quadra novamente?",800),setTimeout(()=>{const ir=C.map(nr=>({label:nr.nome,value:nr.id,icon:"",subtitle:nr.descricao||nr.tipo||null,quadra:nr}));c("Qual quadra voc quer?",ir,600)},1200))},1400)}catch($e){console.error("[Isis] Erro ao carregar agendamento:",$e),$e.message.includes("no encontrado")?(l("Ops! Este agendamento no foi encontrado ou pode ter sido cancelado. ",800),l("Vou buscar seus agendamentos atualizados...",1400),setTimeout(()=>{ut()},2e3)):(l("Ops! Tive um problema ao carregar o agendamento. ",800),l("Que tal tentar fazer um novo agendamento?",1400),setTimeout(()=>{ht()},2e3))}},hr=async()=>{if(!X){console.error("[Isis] Nenhum agendamento para cancelar");return}try{console.groupCollapsed("[Isis][Cancel] start"),console.log("[Isis][Cancel] agendamentoCriado:",{id:X?.id,inicio:X?.inicio,fim:X?.fim,status:X?.status,codigo_empresa:X?.codigo_empresa,empresa_id:X?.empresa_id,cliente_id:X?.cliente_id}),console.log("[Isis][Cancel] empresa:",{id:_?.id,codigo_empresa:_?.codigo_empresa,nome_fantasia:_?.nome_fantasia,razao_social:_?.razao_social,isis_display_name:_?.isis_display_name,isis_cancel_min_hours_before:_?.isis_cancel_min_hours_before,telefone:_?.telefone}),console.groupEnd(),y(!0);let $e=_?.isis_cancel_min_hours_before;if($e==null)try{const pt=(()=>{try{return decodeURIComponent(r||"")}catch{return String(r||"")}})(),Dt=String(pt).toLowerCase().replace(/[\s\-_]+/g,"").trim();console.log("[Isis][Cancel] minHours missing. Trying RPC fallback with slug:",{slugRaw:pt,slugNorm:Dt});try{const{data:he,error:Qe}=await de.rpc("get_empresa_public_by_isis_subdomain",{p_subdomain:Dt});if(console.log("[Isis][Cancel] rpc:get_empresa_public_by_isis_subdomain:",{hasError:!!Qe,error:Qe?.message,code:Qe?.code,len:Array.isArray(he)?he.length:null}),!Qe&&Array.isArray(he)&&he[0]){const zt=he[0]?.isis_cancel_min_hours_before;zt!=null&&($e=zt)}}catch(he){console.log("[Isis][Cancel] rpc subdomain threw:",he?.message||he)}if($e==null)try{const{data:he,error:Qe}=await de.rpc("get_empresa_public_by_slug",{p_slug:Dt});if(console.log("[Isis][Cancel] rpc:get_empresa_public_by_slug:",{hasError:!!Qe,error:Qe?.message,code:Qe?.code,len:Array.isArray(he)?he.length:null}),!Qe&&Array.isArray(he)&&he[0]){const zt=he[0]?.isis_cancel_min_hours_before;zt!=null&&($e=zt)}}catch(he){console.log("[Isis][Cancel] rpc slug threw:",he?.message||he)}}catch(pt){console.log("[Isis][Cancel] fallback unexpected error:",pt?.message||pt)}if(console.log("[Isis][Cancel] minHours(raw):",$e,"type:",typeof $e),$e!=null){const pt=new Date(X.inicio),Dt=new Date,he=pt-Dt,Qe=he/(1e3*60*60);if(console.log("[Isis][Cancel] timing:",{agendamentoInicio:pt?.toISOString?.()||String(pt),agora:Dt?.toISOString?.()||String(Dt),diffMs:he,diffHours:Qe}),Qe<$e){console.warn("[Isis][Cancel] BLOCKED by minHours rule:",{diffHours:Qe,minHours:$e}),y(!1);const zt=_?.telefone||"a arena",Mt=_?.isis_display_name||_?.nome_fantasia||_?.razao_social||"a arena",ir=[` Ops! S  possvel cancelar com ${$e} hora${$e>1?"s":""} de antecedncia. Este agendamento est muito prximo.`,` Desculpe! O cancelamento s pode ser feito com ${$e} hora${$e>1?"s":""} de antecedncia. Seu agendamento j est prximo demais.`],kr=`${ir[Math.floor(Math.random()*ir.length)]}

 Para mais informaes ou cancelamento de ltima hora, entre em contato diretamente com a ${Mt}: ${zt}`;l(kr,600),setTimeout(()=>{l("O que voc gostaria de fazer agora?",800),setTimeout(()=>{Ze()},1200)},1200);return}}const Be={status:"canceled",canceled_by:"isis",canceled_at:new Date().toISOString()};console.log("[Isis][Cancel] proceeding to cancel. update payload:",Be);const{data:et,error:jt}=await de.from("agendamentos").update(Be).eq("id",X.id);if(console.log("[Isis][Cancel] supabase update result:",{hasError:!!jt,error:jt?.message,code:jt?.code,data:et}),jt)throw jt;y(!1);const yt=[" Agendamento cancelado com sucesso!"," Pronto! Seu agendamento foi cancelado."," Cancelamento realizado! Agendamento removido."," Feito! O agendamento foi cancelado com sucesso."],qt=yt[Math.floor(Math.random()*yt.length)];l(qt,600),ye(null),setTimeout(()=>{l("O que voc gostaria de fazer agora?",800),setTimeout(()=>{Ze()},1200)},1200)}catch(Ye){console.error("[Isis] Erro ao cancelar agendamento:",Ye),y(!1);const $e=Cv("error");l($e)}},It=()=>{u();const Ye=["Antes de finalizar, que tal me dar uma avaliao? ","Para finalizar, gostaria que avaliasse nosso atendimento! ","Quase pronto! Me ajuda com uma avaliao rpida? ","ltima etapa! Como foi nosso atendimento hoje? ","Para encerrar, que nota voc daria para nosso atendimento? ","Ei, que tal me contar como foi a experincia? ","Curiosa para saber: como voc avalia nosso atendimento? ","Rapidinho aqui: o que achou do nosso servio? ","Me conta a, como foi para voc hoje? ","Sua opinio  super importante! Como foi tudo? ","Sua avaliao nos ajuda a melhorar! Como foi? ","Para continuarmos evoluindo, como voc nos avalia? ","Queremos sempre melhorar! Que nota voc daria? ","Seu feedback  ouro para ns! Como foi o atendimento? ","Ajude-nos a ser ainda melhores! Qual sua avaliao? ","Espero ter te ajudado bem! Como voc me avalia? ","Fiz um bom trabalho hoje? Me conta sua opinio! ","Consegui resolver tudo certinho? Que tal uma avaliao? ","Antes de voc ir, me diz como foi nossa conversa? ","Sua experincia foi boa? Adoraria saber! ","Obrigada pela confiana! Como foi para voc? ","Foi um prazer te atender! Que nota voc daria? ","Agradeo pela pacincia! Como avalia nosso servio? ","Muito obrigada! Me conta como foi tudo? ","Pode ser sincero(a)! Como foi o atendimento? ","Sem papas na lngua: que nota voc daria? ","Honestamente, como voc nos avalia? ","Sua opinio real  importante! Como foi? ","Para finalizar o atendimento, preciso da sua avaliao! ","Processo quase concludo! Falta s sua avaliao! ","ltima etapa do nosso protocolo: sua opinio! ","Para encerrar com chave de ouro: como nos avalia? "],$e=Ye[Math.floor(Math.random()*Ye.length)];l($e,800),setTimeout(()=>{z(!0),g("avaliacao"),setTimeout(()=>{b.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1200)},dr=async Ye=>{try{const $e=Array.isArray(j)?[...j]:[],Be=`${Ye.rating} estrela${Ye.rating>1?"s":""}`,et=Ye.comentario?` ${Be}
 "${Ye.comentario}"`:` ${Be}`;d(et),z(!1),y(!0);const jt=$e.map(Qe=>({ts:Qe.timestamp instanceof Date?Qe.timestamp.toISOString():new Date(Qe.timestamp||Date.now()).toISOString(),from:Qe.from==="isis"?"assistant":"user",text:String(Qe.text??"")}));let yt=-1;for(let Qe=jt.length-1;Qe>=0;Qe--)if(jt[Qe].from==="assistant"){yt=Qe;break}const qt=yt>=0?jt.slice(0,yt+1):jt;await ult({rating:Number(Ye.rating),comentario:Ye.comentario||null,cliente_codigo:i?.cliente?.codigo??null,cliente_nome:i?.cliente?.nome||i?.cliente?.name||null,empresa_nome:_?.nome_fantasia||_?.razao_social||"Desconhecida",conversaArray:qt}),y(!1);const pt=new Date().getHours();let Dt;pt>=5&&pt<12?Dt="Tenha um timo dia! ":pt>=12&&pt<18?Dt="Tenha uma tima tarde! ":pt>=18&&pt<22?Dt="Tenha uma tima noite! ":Dt="Tenha uma boa noite! ";let he;if(Ye.rating>=4){const Qe=[` **Muito obrigada pela avaliao!** A **${ce}** agradece imensamente! Foi um prazer te atender! ${Dt}`,` **Que bom que gostou!** A **${ce}** fica muito feliz! Volte sempre! ${Dt}`,` **Perfeito!** A **${ce}** agradece de corao! Espero ter ajudado! ${Dt}`,` **Adorei seu feedback!** A **${ce}** est muito grata! Nos vemos em breve! ${Dt}`,` **Excelente!** A **${ce}** agradece pela confiana! At a prxima! ${Dt}`,` **Uau, que nota incrvel!** A **${ce}** est nas nuvens! Obrigada! ${Dt}`,` **Voc  demais!** A **${ce}** adora clientes como voc! ${Dt}`,` **Top demais!** A **${ce}** se sente campe com seu feedback! ${Dt}`,` **Que alegria!** A **${ce}** fica radiante com sua avaliao! ${Dt}`,` **Sensacional!** A **${ce}** est celebrando sua nota! ${Dt}`,` **Amei sua avaliao!** Fico feliz em saber que te atendi bem! A **${ce}** agradece! ${Dt}`,` **Que feedback maravilhoso!** Me deixou super feliz! A **${ce}**  grata! ${Dt}`,` **Seu carinho me emociona!** A **${ce}** tem sorte de ter voc! ${Dt}`,` **Voc iluminou meu dia!** A **${ce}** agradece de todo corao! ${Dt}`,` **Nota mxima!** A **${ce}** te espera sempre de braos abertos! ${Dt}`,` **Cliente 5 estrelas!** A **${ce}** adora te ter aqui! Volte logo! ${Dt}`,` **Voc  especial!** A **${ce}** sempre ter um lugar especial para voc! ${Dt}`,` **Show de avaliao!** A **${ce}** te aguarda para a prxima apresentao! ${Dt}`];he=Qe[Math.floor(Math.random()*Qe.length)]}else if(Ye.rating===3){const Qe=[` **Obrigada pelo feedback!** A **${ce}** vai melhorar ainda mais! ${Dt}`,` **Agradecemos sua avaliao!** A **${ce}** est trabalhando para evoluir! ${Dt}`,` **Obrigada!** A **${ce}** valoriza seu retorno! Foi um prazer te atender! ${Dt}`,` **Toda avaliao nos faz crescer!** A **${ce}** agradece sua sinceridade! ${Dt}`,` **Feedback valioso!** A **${ce}** usa cada retorno para evoluir! ${Dt}`,` **Obrigada pela nota!** A **${ce}** est sempre buscando melhorar! ${Dt}`,` **Seu retorno  importante!** A **${ce}** vai usar para aprimorar nosso servio! ${Dt}`,` **Agradecemos a oportunidade!** A **${ce}** espera te surpreender na prxima! ${Dt}`,` **Obrigada pela dica!** A **${ce}** vai trabalhar para te conquistar! ${Dt}`,` **Toda crtica construtiva  bem-vinda!** A **${ce}** agradece! ${Dt}`];he=Qe[Math.floor(Math.random()*Qe.length)]}else{const Qe=[` **Obrigada pela sinceridade.** A **${ce}** vai trabalhar para melhorar! ${Dt}`,` **Agradecemos seu feedback.** A **${ce}** est comprometida em evoluir! ${Dt}`,` **Obrigada por compartilhar.** A **${ce}** vai usar seu retorno para melhorar! ${Dt}`,` **Lamentamos no ter atendido suas expectativas.** A **${ce}** vai se esforar mais! ${Dt}`,` **Sentimos muito pela experincia.** A **${ce}** levar isso muito a srio! ${Dt}`,` **Assumimos a responsabilidade.** A **${ce}** vai fazer melhor da prxima vez! ${Dt}`,` **Sua insatisfao nos preocupa.** A **${ce}** vai revisar todos os processos! ${Dt}`,` **Obrigada pelo alerta!** A **${ce}** espera uma nova chance de te impressionar! ${Dt}`,` **Vamos melhorar!** A **${ce}** promete que da prxima vez ser diferente! ${Dt}`,` **Seu feedback  nosso combustvel!** A **${ce}** vai usar para crescer! ${Dt}`,` **J estamos trabalhando nas melhorias!** A **${ce}** agradece sua pacincia! ${Dt}`,` **Sua honestidade  valiosa!** A **${ce}** prefere a verdade para evoluir! ${Dt}`,` **Crticas nos fazem crescer!** A **${ce}** agradece sua coragem de falar! ${Dt}`];he=Qe[Math.floor(Math.random()*Qe.length)]}l(he,600),setTimeout(()=>{l("Atendimento finalizado.",0,"system")},1200)}catch($e){console.error("[Isis] Erro ao enviar avaliao:",$e),y(!1);const Be=new Date().getHours();let et;Be>=5&&Be<12?et="Tenha um timo dia! ":Be>=12&&Be<18?et="Tenha uma tima tarde! ":Be>=18&&Be<22?et="Tenha uma tima noite! ":et="Tenha uma boa noite! ";const jt=[`Ops! Tive um problema ao salvar sua avaliao, mas a **${ce}** agradece muito seu feedback! ${et}`,` No consegui salvar sua avaliao, mas a **${ce}** agradece imensamente! ${et}`,` Deu uma travadinha aqui, mas sua opinio j ficou guardada no meu corao! A **${ce}** agradece! ${et}`,` Ops, falhei na tecnologia, mas no falhei em te ouvir! A **${ce}** valoriza seu feedback! ${et}`,` Parece que o sistema deu soluo, mas sua avaliao foi ouvida! A **${ce}** agradece! ${et}`,` A internet no colaborou, mas sua opinio chegou at mim! A **${ce}**  grata! ${et}`,` Problema tcnico aqui, mas o importante  que voc compartilhou! A **${ce}** agradece! ${et}`,` O sistema travou, mas sua avaliao no passou despercebida! A **${ce}** valoriza! ${et}`],yt=jt[Math.floor(Math.random()*jt.length)];l(yt,600),setTimeout(()=>{l("Atendimento finalizado.",0,"system")},1200)}},ur=async()=>{if(!X){console.error("[Isis] Nenhum agendamento para atualizar");return}try{y(!0);const Ye=i.cliente,$e=i.participantes||[],{data:Be}=await de.from("clientes").select("id").eq("codigo_empresa",n).eq("is_consumidor_final",!0).single(),et=$e.find(Kt=>Kt.principal),jt=$e.filter(Kt=>!Kt.principal),yt=et?[et,...jt]:$e,qt=yt.map(Kt=>Kt.nome),pt=et?.cliente_id||Ye?.id||null,[Dt,he]=i.horario.inicio.split(":").map(Number),[Qe,zt]=i.horario.fim.split(":").map(Number);let Mt=Qe*60+zt-(Dt*60+he);Qe===0&&zt===0&&(Mt=24*60-(Dt*60+he));const ir=i.quadra.valor||0,nr=Mt/30,kr=Math.round(ir*nr*100)/100,Ft={levantadores:Array.isArray(i.levantadores)?i.levantadores:[],goleiros:Array.isArray(i.goleiros)?i.goleiros:[],fixos:Array.isArray(i.fixos)?i.fixos:[],fixoRoles:i.fixoRoles&&typeof i.fixoRoles=="object"?i.fixoRoles:{}},{data:Dr,error:Fr}=await de.from("agendamentos").update({quadra_id:i.quadra.id,cliente_id:pt,clientes:qt,inicio:i.horario.inicioDate.toISOString(),fim:i.horario.fimDate.toISOString(),modalidade:i.esporte,valor_total:kr,meta_roles:Ft}).eq("id",X.id).select().single();if(Fr)throw Fr;const{error:Tn}=await de.from("agendamento_participantes").delete().eq("agendamento_id",X.id);if(Tn)throw Tn;const nt=yt.map((Kt,sr)=>({agendamento_id:Dr.id,codigo_empresa:n,cliente_id:Kt.cliente_id||(Kt.principal?Ye.id:Be?.id||null),nome:Kt.nome,valor_cota:0,status_pagamento:"Pendente",ordem:sr+1,is_representante:sr===0})),{error:$t}=await de.from("agendamento_participantes").insert(nt);if($t)throw $t;y(!1),ye(Dr);try{const Kt=`f7a:fixos:${Dr.id}`,sr={levantadores:i.levantadores||[],goleiros:i.goleiros||[],fixos:i.fixos||[],fixoRoles:i.fixoRoles||{}};localStorage.setItem(Kt,JSON.stringify(sr))}catch{}yr(Dr,!0),g("confirmation")}catch(Ye){console.error("[Isis] Erro ao atualizar agendamento:",Ye),y(!1);const $e=Cv("error");l($e)}},er=async()=>{try{y(!0);const Ye=await je();if(!Ye?.ok)throw new Error("No foi possvel validar disponibilidade do horrio");if(Ye?.conflito){y(!1),z(!1);try{m("horario",null)}catch{}try{m("esporte",null)}catch{}try{$(null)}catch{}Ye?.motivo==="fechada"?l(`**Ops!** Parece que este dia ficou **indisponvel** agora. 

Vamos escolher outra data?`,800):l(`**Ops!** Algum acabou de reservar esse horrio antes de voc. 

Vamos escolher outra data?`,800),setTimeout(()=>{at()},900);return}const $e=i.cliente,Be=i.participantes||[],{data:et}=await de.from("clientes").select("id").eq("codigo_empresa",n).eq("is_consumidor_final",!0).single(),jt=Be.find(Pt=>Pt.principal),yt=Be.filter(Pt=>!Pt.principal),qt=jt?[jt,...yt]:Be,pt=qt.map(Pt=>Pt.nome),Dt=jt?.cliente_id||$e?.id||null,[he,Qe]=i.horario.inicio.split(":").map(Number),[zt,Mt]=i.horario.fim.split(":").map(Number);let ir=zt*60+Mt-(he*60+Qe);zt===0&&Mt===0&&(ir=24*60-(he*60+Qe));const nr=i.quadra.valor||0,kr=ir/30,Ft=Math.round(nr*kr*100)/100,Dr={levantadores:Array.isArray(i.levantadores)?i.levantadores:[],goleiros:Array.isArray(i.goleiros)?i.goleiros:[],fixos:Array.isArray(i.fixos)?i.fixos:[],fixoRoles:i.fixoRoles&&typeof i.fixoRoles=="object"?i.fixoRoles:{}};let Fr=null;try{const Pt=String(w||"").trim();/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$/.test(Pt)&&(Fr=Pt)}catch{}const{data:Tn}=await de.from("agendamentos").select("codigo").eq("codigo_empresa",n).order("codigo",{ascending:!1}).limit(1).single();let nt=Tn?Tn.codigo+1:1;console.log("[criarAgendamento] ltimo cdigo usado:",Tn?.codigo),console.log("[criarAgendamento] Prximo cdigo inicial:",nt);let $t,Kt=0;const sr=10;for(;!$t&&Kt<sr;){Kt++,console.log("[criarAgendamento] Tentativa",Kt,"com cdigo:",nt);const Pt={codigo:nt,codigo_empresa:n,quadra_id:i.quadra.id,cliente_id:Dt,clientes:pt,inicio:i.horario.inicioDate.toISOString(),fim:i.horario.fimDate.toISOString(),modalidade:i.esporte,status:"scheduled",valor_total:Ft,meta_roles:Dr,created_by_isis:!0};if(Fr)try{const{data:Et}=await de.from("isis_chat_sessions").select("id").eq("id",Fr).single();Et?.id&&(Pt.isis_session_id=Fr)}catch{}const{data:lr,error:st}=await de.from("agendamentos").insert(Pt).select("id, codigo").single();if(st)if(st.code==="23505")console.log("[criarAgendamento] Cdigo",nt,"j existe, tentando prximo..."),nt++;else throw st;else $t=lr,console.log("[criarAgendamento] Agendamento criado com cdigo:",$t.codigo)}if(!$t)throw new Error("No foi possvel gerar um cdigo nico aps "+sr+" tentativas");try{const{data:Pt}=await de.from("empresas").select("id").eq("codigo_empresa",n).single();Pt&&(await de.from("empresa_counters").update({next_agendamento_codigo:$t.codigo+1}).eq("empresa_id",Pt.id),console.log("[criarAgendamento] Counter atualizado para:",$t.codigo+1))}catch(Pt){console.warn("[criarAgendamento] Erro ao atualizar counter:",Pt)}const St=qt.map((Pt,lr)=>({codigo_empresa:n,agendamento_id:$t.id,cliente_id:Pt.cliente_id||(Pt.principal?$e.id:et?.id||null),nome:Pt.nome,valor_cota:0,status_pagamento:"Pendente",ordem:lr+1,is_representante:lr===0})),{error:Jr}=await de.from("agendamento_participantes").insert(St);if(Jr)throw Jr;y(!1),ye($t);try{const Pt=`f7a:fixos:${$t.id}`,lr={levantadores:i.levantadores||[],goleiros:i.goleiros||[],fixos:i.fixos||[],fixoRoles:i.fixoRoles||{}};localStorage.setItem(Pt,JSON.stringify(lr))}catch{}yr($t),g("confirmation")}catch(Ye){console.error("[Isis] Erro ao criar agendamento:",Ye),y(!1);const $e=Cv("error");l($e),l_({title:"Erro ao criar agendamento",description:Ye.message||"Tente novamente",variant:"destructive"})}},ln=(Ye,$e)=>{if(u(),$e)try{h($e)}catch{}switch(o){case"quadra":Ct(Ye);break;case"data":{if((Ye?.value||"").toString()==="mudar_quadra"){try{z(!1);const et=(C||[]).map(jt=>({label:jt.nome,value:jt.id,icon:"",subtitle:jt.descricao||jt.tipo||null,quadra:jt}));et.length>0&&(c("Qual quadra voc quer?",et,400),g("quadra"))}catch{}break}wt(Ye)}break;case"identificacao":dt(Ye);break;case"review":dt(Ye);break;case"confirmation":dt(Ye);break;case"confirmar_cliente_existente":{const Be=(Ye?.value||"").toString();if(Be==="confirm_cliente_existente"){const et=i?.cliente_sugerido||null;if(et){m("cliente",et),m("cliente_sugerido",null);const jt=Re(et.nome||"");l(`Perfeito, **${jt}**! `,300),z(!1),setTimeout(()=>{try{Ze()}catch{}},700)}else z(!0),g("identificacao")}else Be==="corrigir_cadastro"&&(l("Sem problemas! Vamos corrigir seus dados. ",300),z(!0),g("cadastro"));break}default:console.warn("[Isis] Nenhum handler para step:",o)}},Mr=()=>U?o==="participantes"||o==="review"&&U&&W==="participantes"?a.jsx(ilt,{participantesAtuais:i.participantes||[],onAdicionar:Ue,onRemover:or,onFinalizar:tr,onAdicionarLote:ze,selfName:i.cliente?.nome,initialModalidade:i.esporte||"",modalidadeOptions:Array.isArray(i.quadra?.modalidades)&&i.quadra.modalidades.length>0?i.quadra.modalidades:i.esporte?[i.esporte]:[],onFixedRolesDetected:Ye=>{try{const $e=Array.isArray(Ye?.levantadores)?Ye.levantadores:[],Be=Array.isArray(Ye?.goleiros)?Ye.goleiros:[],et=qt=>String(qt||"").trim().toLowerCase(),jt=Array.from(new Set([...$e,...Be])),yt={};$e.forEach(qt=>{yt[et(qt)]="Levantador"}),Be.forEach(qt=>{yt[et(qt)]="Goleiro"}),m("levantadores",$e),m("goleiros",Be),m("fixos",jt),m("fixoRoles",yt),X?.id&&(async()=>{try{const qt={levantadores:$e,goleiros:Be,fixos:jt,fixoRoles:yt};await de.from("agendamentos").update({meta_roles:qt}).eq("id",X.id)}catch(qt){console.debug("[Isis] Falha ao persistir meta_roles imediatos:",qt?.message||qt)}})()}catch{}}}):o==="identificacao"||M==="data_custom"?a.jsx(slt,{tipo:M,onSubmit:ie,onTrocarTipo:()=>{D(M==="telefone"?"email":"telefone")}}):o==="cadastro"?a.jsx(olt,{onSubmit:gt,valorInicial:i.identificacao_valor,tipoInicial:i.identificacao_tipo||"telefone",onCorrigirTelefone:()=>{try{l("Sem problemas! Informe seu telefone novamente:",400)}catch{}m("cliente",null),m("identificacao_valor",null),D("telefone"),g("identificacao"),z(!0)},onCorrigirEmail:()=>{try{l("Sem problemas! Informe seu e-mail novamente:",400)}catch{}m("cliente",null),m("identificacao_valor",null),D("email"),g("identificacao"),z(!0)}}):o==="horario"||o==="review"&&U&&W==="horario"?a.jsx(alt,{onSubmit:_e,onMudarData:xt,onMudarQuadra:()=>{try{z(!1),$("horario"),g("review");const Ye=(C||[]).map($e=>({label:$e.nome,value:$e.id,icon:"",subtitle:$e.descricao||$e.tipo||null,quadra:$e}));Ye.length>0&&c("Qual quadra voc quer?",Ye,600)}catch{}},hasMultipleQuadras:(C||[]).length>1,horariosDisponiveis:A,esportes:i.quadra?.modalidades||[]}):o==="avaliacao"?a.jsx(llt,{onSubmit:dr}):null:null;return r?O?a.jsx(clt,{message:"Preparando sua experincia..."}):_?a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsx(xr.header,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},className:"bg-surface/70 backdrop-blur-xl border-b border-white/10 sticky top-0 z-20 shadow-lg",children:a.jsxs("div",{className:"container mx-auto px-4 md:px-6 py-3 md:py-4 flex items-center justify-between gap-3 md:gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[a.jsxs("div",{className:"relative group",children:[a.jsx("div",{className:"transition-all duration-300 group-hover:scale-105",children:a.jsx(gi,{size:"md",variant:"header",className:"md:w-20 md:h-20"})}),a.jsx("div",{className:"absolute bottom-0 right-0 w-3 h-3 md:w-4 md:h-4 bg-success rounded-full border-2 border-surface"})]}),a.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[a.jsx("h1",{className:"font-bold text-text-primary text-lg md:text-2xl tracking-tight leading-none",children:"sis"}),a.jsxs("div",{className:"relative group w-fit",children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-500 via-purple-500 to-pink-500 blur-md opacity-60 group-hover:opacity-100 animate-pulse rounded-md"}),a.jsxs("div",{className:"relative px-2 py-0.5 md:px-2.5 md:py-1 bg-gradient-to-r from-cyan-500/20 via-purple-500/20 to-pink-500/20 backdrop-blur-sm border border-cyan-500/50 rounded-md flex items-center gap-1 md:gap-1.5 shadow-lg",children:[a.jsxs("svg",{className:"w-2.5 h-2.5 md:w-3 md:h-3 text-cyan-400",fill:"currentColor",viewBox:"0 0 20 20",children:[a.jsx("path",{d:"M13 7H7v6h6V7z"}),a.jsx("path",{fillRule:"evenodd",d:"M7 2a1 1 0 012 0v1h2V2a1 1 0 112 0v1h2a2 2 0 012 2v2h1a1 1 0 110 2h-1v2h1a1 1 0 110 2h-1v2a2 2 0 01-2 2h-2v1a1 1 0 11-2 0v-1H9v1a1 1 0 11-2 0v-1H5a2 2 0 01-2-2v-2H2a1 1 0 110-2h1V9H2a1 1 0 010-2h1V5a2 2 0 012-2h2V2zM5 5h10v10H5V5z",clipRule:"evenodd"})]}),a.jsx("span",{className:"text-[9px] md:text-[10px] font-bold bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:"chat"}),a.jsxs("div",{className:"hidden md:flex gap-0.5",children:[a.jsx("span",{className:"w-1 h-1 bg-cyan-400 rounded-full animate-pulse",style:{animationDelay:"0ms"}}),a.jsx("span",{className:"w-1 h-1 bg-purple-400 rounded-full animate-pulse",style:{animationDelay:"150ms"}}),a.jsx("span",{className:"w-1 h-1 bg-pink-400 rounded-full animate-pulse",style:{animationDelay:"300ms"}})]})]})]})]})]}),a.jsx("div",{className:"flex flex-1 justify-end md:justify-center",children:a.jsxs("div",{className:"group relative",children:[a.jsx("div",{className:"hidden md:block absolute inset-0 bg-gradient-to-r from-brand/20 via-brand/10 to-brand/20 blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),a.jsxs("div",{className:"relative flex items-center gap-2.5 md:gap-3 px-4 py-2 md:px-5 md:py-2.5 bg-gradient-to-r from-surface via-surface-2 to-surface backdrop-blur-sm rounded-lg md:rounded-xl border border-brand/20 shadow-md md:shadow-lg",children:[a.jsxs("div",{className:"relative w-9 h-9 md:w-10 md:h-10 shrink-0 overflow-hidden rounded-lg border border-white/10 bg-surface-2/60 grid place-items-center shadow-[0_0_0_3px_RGBA(0,0,0,0.2)] group-hover:border-white/20 transition-colors duration-300",children:[me?a.jsx("img",{src:me,alt:"Logo da empresa",className:"w-full h-full object-cover",onError:Ye=>{Ye.target.style.display="none",Ye.target.nextSibling.style.display="block"}}):null,a.jsx(K_,{className:`w-5 h-5 md:w-6 md:h-6 opacity-80 ${me?"hidden":"block"}`,strokeWidth:2})]}),a.jsx("h2",{className:"text-sm md:text-base font-bold text-text-primary tracking-wide truncate max-w-[140px] md:max-w-none",children:ce})]})]})}),a.jsxs("div",{className:"hidden md:flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-brand rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(Dc,{className:"w-7 h-7 text-primary-foreground"})}),a.jsxs("div",{className:"hidden lg:flex items-baseline",children:[a.jsx("span",{className:"font-extrabold text-xl",style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{className:"font-extrabold text-xl",style:{color:"#FFAA33"},children:"7"}),a.jsx("span",{className:"font-medium text-xl",style:{color:"#B0B0B0"},children:" Arena"})]})]})]})}),a.jsx("div",{className:"container mx-auto max-w-5xl pb-6 md:pb-6 mb-12 md:mb-0",children:a.jsx(nlt,{onButtonClick:ln,hideButtonTexts:o==="avaliacao",children:Mr()})}),a.jsx(xr.footer,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5,delay:.3},className:"md:hidden fixed bottom-0 left-0 right-0 bg-surface/90 backdrop-blur-xl border-t border-white/10 z-20 shadow-lg",children:a.jsx("div",{className:"flex items-center justify-center py-2",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-6 h-6 bg-brand rounded-lg flex items-center justify-center",children:a.jsx(Dc,{className:"w-4 h-4 text-primary-foreground"})}),a.jsxs("div",{className:"flex items-baseline",children:[a.jsx("span",{className:"font-extrabold text-sm",style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{className:"font-extrabold text-sm",style:{color:"#FFAA33"},children:"7"}),a.jsx("span",{className:"font-medium text-sm",style:{color:"#B0B0B0"},children:" Arena"})]})]})})})]}):a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:a.jsxs(xr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center max-w-2xl",children:[a.jsx(xr.div,{className:"mb-8 flex justify-center",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5,delay:.2},children:a.jsxs("div",{className:"relative",children:[a.jsx(gi,{size:"xl",variant:"header"}),a.jsx(xr.div,{className:"absolute inset-0 rounded-full border-4 border-brand/30",animate:{scale:[1,1.2,1],opacity:[.5,0,.5]},transition:{duration:2,repeat:1/0}})]})}),a.jsxs(xr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"space-y-6",children:[a.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-text-primary mb-4",children:[ae(),"! Tentando Agendar? "]}),a.jsxs("div",{className:"bg-surface/70 backdrop-blur-sm border border-white/10 rounded-2xl p-8 shadow-xl",children:[a.jsxs("p",{className:"text-xl text-text-primary mb-6 leading-relaxed",children:["Entre em contato com o dono da quadra e solicite o ",a.jsx("strong",{children:"link de agendamento"}),"."]}),a.jsxs("div",{className:"bg-surface-2/50 border border-white/5 rounded-xl p-6 mb-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-3 flex items-center gap-2",children:[a.jsx(KH,{className:"w-5 h-5 text-brand"}),"Formato do Link"]}),a.jsxs("div",{className:"bg-background/60 border border-white/10 rounded-lg p-4 font-mono text-base md:text-lg",children:[a.jsx("span",{className:"text-brand font-bold",children:"nomedaempresa"}),a.jsx("span",{className:"text-text-muted",children:".f7arena.com"})]}),a.jsx("p",{className:"mt-2 text-xs text-text-muted",children:"(sem traos)"})]})]})]}),a.jsx(xr.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.6},className:"mt-12 flex items-center justify-center",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-brand rounded-xl flex items-center justify-center shadow-lg",children:a.jsx(Dc,{className:"w-6 h-6 text-primary-foreground"})}),a.jsxs("div",{className:"flex items-baseline",children:[a.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FFAA33"},children:"7"}),a.jsx("span",{className:"font-medium text-2xl",style:{color:"#B0B0B0"},children:" Arena"})]})]})})]})}):a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:a.jsxs(xr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center max-w-2xl",children:[a.jsx(xr.div,{className:"mb-8 flex justify-center",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5,delay:.2},children:a.jsxs("div",{className:"relative",children:[a.jsx(gi,{size:"xl",variant:"header"}),a.jsx(xr.div,{className:"absolute inset-0 rounded-full border-4 border-brand/30",animate:{scale:[1,1.2,1],opacity:[.5,0,.5]},transition:{duration:2,repeat:1/0}})]})}),a.jsxs(xr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"space-y-6",children:[a.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-text-primary mb-4",children:[ae(),"! Tentando Agendar?"]}),a.jsx("div",{className:"bg-surface/70 backdrop-blur-sm border border-white/10 rounded-2xl p-8 shadow-xl",children:a.jsx("p",{className:"text-xl text-text-primary mb-4 leading-relaxed",children:"Entre em contato com o dono da quadra e solicite o link de agendamento."})})]}),a.jsx(xr.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.6},className:"mt-12 flex items-center justify-center",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-brand rounded-xl flex items-center justify-center shadow-lg",children:a.jsx(Dc,{className:"w-6 h-6 text-primary-foreground"})}),a.jsxs("div",{className:"flex items-baseline",children:[a.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FFAA33"},children:"7"}),a.jsx("span",{className:"font-medium text-2xl",style:{color:"#B0B0B0"},children:" Arena"})]})]})})]})})};function hV(){return a.jsx(poe,{children:a.jsx(IY,{children:a.jsx(mlt,{children:a.jsx(flt,{})})})})}function mlt({children:e}){const{selections:t}=zC(),[r,n]=Pe.useState({name:"",phone:"",source:"init"});return Pe.useEffect(()=>{const s=()=>{try{const c=t?.empresa||null;if(c){const d=c.isis_display_name||c.nome_fantasia||c.razao_social||c.nome||"",u=c.telefone||"";if(d||u)return{name:d,phone:u}}}catch{}return null},o=()=>{try{const c=window.location.host||"",d=window.location.pathname||"",u="f7arena.com";if(c.endsWith(u)){const h=c.slice(0,-u.length).replace(/\.$/,"").toLowerCase();if(h&&h!=="www")return h}const f=d.match(/\/agendar\/([^\/?#]+)/i);if(f&&f[1])return decodeURIComponent(f[1])}catch{}return null},i=s();if(i){try{console.info("[IsisError][Meta] Using context data",{name:!!i.name,phone:!!i.phone})}catch{}n({name:i.name,phone:i.phone,source:"context"});return}const l=o();if(!l){try{console.warn("[IsisError][Meta] No slug inferred from URL")}catch{}n(c=>c.name||c.phone?c:{name:"",phone:"",source:"none"});return}(async()=>{try{try{console.info("[IsisError][Meta] Start fetch by slug",{slug:l})}catch{}const c=String(l||"").toLowerCase().replace(/[\s\-_]+/g,"").trim();let d="",u="",f="";try{const{data:g,error:y}=await de.rpc("get_empresa_public_by_slug",{p_slug:c});if(!y&&Array.isArray(g)&&g.length>0){const x=g[0]||{};d=x.isis_display_name||x.nome_fantasia||x.razao_social||x.nome||"",x.telefone&&(u=x.telefone,f="rpc.telefone");try{console.info("[IsisError][Meta] RPC result",{hasName:!!d,phoneSource:f,hasPhone:!!u})}catch{}}}catch{}if(!d||!u)try{const{data:g}=await de.from("agenda_settings").select("isis_display_name, empresas(nome_fantasia, razao_social, nome, telefone)").eq("isis_subdomain",c).single(),y=g?.empresas||{};d=d||g?.isis_display_name||y?.nome_fantasia||y?.razao_social||y?.nome||"",!u&&y?.telefone&&(u=y.telefone,f="settings.telefone");try{console.info("[IsisError][Meta] Settings result",{hasName:!!d,phoneSource:f,hasPhone:!!u})}catch{}}catch{}const m=d||(g=>{try{return String(g||"").replace(/[\s_\-]+/g," ").trim().split(" ").filter(Boolean).map(x=>x.charAt(0).toUpperCase()+x.slice(1).toLowerCase()).join(" ")}catch{return g}})(l),v=u||"";try{console.info("[IsisError][Meta] Final",{finalName:m,hasPhone:!!v,phoneSource:f||"none"})}catch{}n({name:m,phone:v,source:f||"computed"})}catch(c){try{console.error("[IsisError][Meta] Exception during meta fetch",c)}catch{}n({name:l,phone:"",source:"error"})}})()},[t?.empresa]),a.jsx(poe,{companyName:r.name,companyPhone:r.phone,children:e})}class poe extends Pe.Component{constructor(t){super(t),this.state={hasError:!1,companyName:"",companyPhone:""}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(t,r){try{console.error("[Isis] Uncaught error:",t,r)}catch{}(!this.props.companyName||!this.props.companyPhone)&&(async()=>{try{const n=()=>{try{const d=typeof window<"u"&&window.location.host||"",u=typeof window<"u"&&window.location.pathname||"",f="f7arena.com";if(d&&d.endsWith(f)){const m=d.slice(0,-f.length).replace(/\.$/,"").toLowerCase();if(m&&m!=="www")return m}const h=u.match(/\/agendar\/([^\/?#]+)/i);if(h&&h[1])return decodeURIComponent(h[1])}catch{}return null},s=d=>{try{return String(d||"").replace(/[\s_\-]+/g," ").trim().split(" ").filter(Boolean).map(f=>f.charAt(0).toUpperCase()+f.slice(1).toLowerCase()).join(" ")}catch{return d}},o=n();if(!o)return;const i=String(o).toLowerCase().replace(/[\s\-_]+/g,"").trim();let l="",c="";try{const{data:d,error:u}=await de.rpc("get_empresa_public_by_slug",{p_slug:i});if(!u&&Array.isArray(d)&&d.length>0){const f=d[0]||{};l=f.isis_display_name||f.nome_fantasia||f.razao_social||f.nome||"",f.telefone&&(c=f.telefone);try{console.info("[IsisError][Outer] RPC",{hasName:!!l,hasPhone:!!c})}catch{}}}catch{}if(!l||!c)try{const{data:d}=await de.from("agenda_settings").select("isis_display_name, empresas(nome_fantasia, razao_social, nome, telefone)").eq("isis_subdomain",i).single(),u=d?.empresas||{};l=l||d?.isis_display_name||u?.nome_fantasia||u?.razao_social||u?.nome||"",!c&&u?.telefone&&(c=u.telefone);try{console.info("[IsisError][Outer] Settings",{hasName:!!l,hasPhone:!!c})}catch{}}catch{}this.setState({companyName:l||s(o),companyPhone:c||""})}catch(n){try{console.error("[IsisError][Outer] meta fetch failed",n)}catch{}}})()}render(){if(this.state.hasError){try{console.info("[IsisError][Render] Props",{companyName:this.props.companyName,companyPhone:this.props.companyPhone})}catch{}const t=()=>{try{const i=typeof window<"u"&&window.location.host||"",l=typeof window<"u"&&window.location.pathname||"",c="f7arena.com";if(i&&i.endsWith(c)){const u=i.slice(0,-c.length).replace(/\.$/,"").toLowerCase();if(u&&u!=="www")return u}const d=l.match(/\/agendar\/([^\/?#]+)/i);if(d&&d[1])return decodeURIComponent(d[1])}catch{}return null},r=i=>{try{const l=String(i||"").replace(/\D/g,"");return l.length>=11?`(${l.slice(0,2)}) ${l.slice(2,7)}-${l.slice(7,11)}`:l.length>=10?`(${l.slice(0,2)}) ${l.slice(2,6)}-${l.slice(6,10)}`:i||""}catch{return i||""}},n=t(),s=this.props.companyName||this.state.companyName||n||"a arena",o=r(this.props.companyPhone||this.state.companyPhone||"");return a.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-background text-text-primary p-6",children:a.jsxs("div",{className:"w-full max-w-xl mx-auto rounded-3xl border border-white/10 bg-surface/80 backdrop-blur-md shadow-2xl p-8 text-center",children:[a.jsx("div",{className:"flex justify-center mb-4",children:a.jsx(gi,{size:"xl"})}),a.jsx("h1",{className:"text-3xl md:text-4xl font-extrabold tracking-tight mb-3",children:" Ops, ocorreu um erro!"}),a.jsxs("p",{className:"text-base md:text-lg opacity-90 leading-relaxed mb-3",children:["Pode ser um ",a.jsx("span",{className:"font-semibold",children:"problema no seu dispositivo"})," ou na sua ",a.jsx("span",{className:"font-semibold",children:"conexo de rede"}),"."]}),a.jsxs("p",{className:"text-base md:text-lg opacity-90 leading-relaxed mb-6",children:[a.jsx("span",{className:"font-semibold",children:"Tente novamente"}),", experimente ",a.jsx("span",{className:"font-semibold",children:"outro navegador"})," ou ",a.jsx("span",{className:"font-semibold",children:"outra rede"}),"."]}),a.jsxs("p",{className:"text-base md:text-lg leading-relaxed mb-6",children:["Se persistir, ",a.jsx("span",{className:"font-semibold",children:"entre em contato"})," com ",a.jsx("span",{className:"font-semibold",children:s}),o?a.jsxs(a.Fragment,{children:[" ","pelo nmero ",a.jsx("span",{className:"font-semibold font-mono",children:o}),"."]}):"."]}),a.jsx("div",{className:"flex items-center justify-center gap-3",children:a.jsx("button",{onClick:()=>{try{window.location.reload()}catch{}},className:"inline-flex items-center justify-center rounded-xl px-5 py-3 bg-brand text-bg font-semibold shadow-lg shadow-brand/20 hover:shadow-xl hover:shadow-brand/30 transition-all",children:" Recarregar pgina"})})]})})}return this.props.children}}const pV="f740028922";function gV(e){try{return cr(e,"EEE, d 'de' MMM 's' HH:mm",{locale:na})}catch{return""}}function vV(){const e=$o(),t=zi(),r=!!KS||typeof window<"u"&&localStorage.getItem("maintenance:active")==="true",[n,s]=p.useState(""),[o,i]=p.useState("");p.useEffect(()=>{try{s(localStorage.getItem("maintenance:end")||""),i(localStorage.getItem("maintenance:message")||"");const f=h=>{h.key==="maintenance:end"&&s(h.newValue||""),h.key==="maintenance:message"&&i(h.newValue||"")};return window.addEventListener("storage",f),()=>window.removeEventListener("storage",f)}catch{}},[]);const l=n||$it||{}.VITE_MAINTENANCE_END||"",c=o&&o.trim()?o:Bit,d=p.useMemo(()=>{if(!l)return null;const f=new Date(l);return isNaN(f.getTime())?null:f},[l]),u=p.useMemo(()=>c?.trim()?c:d?`Estamos em manuteno e voltaremos at ${gV(d)}.`:"Estamos em manuteno no momento. Voltaremos em breve.",[c,d]);return p.useEffect(()=>{try{window.f7MaintenanceBypass=f=>{const h=String(f||"")===pV;if(h){try{localStorage.setItem("maintenance:bypass","1")}catch{}try{sessionStorage.setItem("maintenance:bypass","1")}catch{}try{document.cookie="fx_maint_bypass=1; path=/; max-age=2592000"}catch{}try{sessionStorage.removeItem("auth:returnUrl")}catch{}t("/login",{replace:!0})}else console.warn("[Maintenance] Senha invlida.");return h},window.f7MaintenanceReset=()=>{try{localStorage.removeItem("maintenance:bypass")}catch{}console.info("[Maintenance] Bypass removido.")}}catch{}},[t]),p.useEffect(()=>{const h=String(e.pathname||"").split("/").filter(Boolean),m=h[h.length-1]||"",v=new URLSearchParams(e.search||""),y=v.get("senha")||v.get("pwd")||v.get("code")||""||m;if(y&&y===pV){try{localStorage.setItem("maintenance:bypass","1")}catch{}try{sessionStorage.setItem("maintenance:bypass","1")}catch{}try{document.cookie="fx_maint_bypass=1; path=/; max-age=2592000"}catch{}try{sessionStorage.removeItem("auth:returnUrl")}catch{}t("/login",{replace:!0})}},[e,t]),a.jsxs("div",{className:"min-h-screen relative overflow-hidden bg-gradient-to-b from-[#0f1324] via-[#0b0f1c] to-[#070a14] text-white",children:[a.jsx("div",{className:"pointer-events-none absolute -top-40 left-1/2 -translate-x-1/2 w-[90rem] h-[90rem] rounded-full opacity-30 blur-3xl",style:{background:"radial-gradient(50% 50% at 50% 50%, rgba(76,110,245,0.45) 0%, rgba(76,110,245,0.18) 40%, rgba(0,0,0,0) 70%)"}}),a.jsxs("div",{className:"relative z-10 mx-auto max-w-4xl px-6 py-16 md:py-24",children:[a.jsxs("div",{className:"mx-auto max-w-3xl rounded-3xl border border-white/10 bg-white/[0.02] backdrop-blur-xl shadow-[0_0_60px_-10px_rgba(76,110,245,0.5)] p-6 md:p-10",children:[a.jsx("div",{className:"text-center mb-8",children:a.jsxs("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"w-16 h-16 bg-brand rounded-xl flex items-center justify-center mr-4",children:a.jsx(Dc,{className:"w-8 h-8 text-primary-foreground"})}),a.jsxs("div",{children:[a.jsxs("h1",{className:"text-5xl font-extrabold",children:[a.jsx("span",{style:{color:"#FF6600"},children:"Fluxo"}),a.jsx("span",{style:{color:"#FFAA33"},children:"7"})]}),a.jsx("p",{className:"text-2xl font-semibold",style:{color:"#B0B0B0"},children:"Arena"})]})]})}),a.jsxs("div",{className:"flex items-center justify-center gap-3 text-red-400 mb-4",children:[a.jsx(j4,{className:"w-6 h-6"}),a.jsx("span",{className:"font-semibold tracking-wide",children:"Modo de Manuteno"})]}),a.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start gap-8",children:[a.jsx("div",{className:"shrink-0",children:a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute -inset-4 bg-brand/20 blur-2xl rounded-full"}),a.jsx("div",{className:"relative rounded-2xl p-1 bg-gradient-to-b from-brand/40 to-transparent",children:a.jsx(gi,{size:"xl",variant:"header"})})]})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h1",{className:"text-2xl md:text-3xl font-bold leading-tight",children:"Oi! Eu sou a Isis "}),a.jsx("p",{className:"text-white/80 mt-3 text-base md:text-lg leading-relaxed",children:u}),a.jsxs("div",{className:"mt-5 grid grid-cols-1 md:grid-cols-2 gap-3 text-sm text-white/80",children:[d&&a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-white/10 bg-white/[0.03] px-3 py-2",children:[a.jsx(Pd,{className:"w-4 h-4 text-brand"}),a.jsxs("span",{children:["Previso de retorno: ",a.jsx("strong",{className:"text-white/90",children:gV(d)})]})]}),a.jsxs("div",{className:"flex items-center gap-2 rounded-xl border border-white/10 bg-white/[0.03] px-3 py-2",children:[a.jsx(Bs,{className:"w-4 h-4 text-brand"}),a.jsx("span",{children:"Vamos cuidar de tudo para voc jogar melhor "})]})]})]})]})]}),a.jsx("p",{className:"mt-6 text-center text-white/50 text-sm",children:r?"Modo de manuteno ativo":"Modo de manuteno inativo"})]})]})}function hlt(){const[e,t]=p.useState(!0),[r,n]=p.useState(!1),s=()=>{t(d=>!d)},o=$o(),i=zi(),l=o.pathname==="/agenda",c=o.pathname==="/isis/analytics";return p.useEffect(()=>{const d=u=>{const f=String(u.target?.tagName||"").toLowerCase();if(!(["input","textarea","select"].includes(f)||u.target?.isContentEditable)&&!u.repeat){if(String(u.key).toLowerCase()==="b"){u.preventDefault();const h=String(o?.pathname||"").toLowerCase();console.log("[Global Hotkey B] Current path:",h),h.includes("balcao")?(console.log("[Global Hotkey B] Navigating to /vendas"),i("/vendas")):(console.log("[Global Hotkey B] Navigating to /balcao"),i("/balcao"));return}if(String(u.key).toLowerCase()==="h"){u.preventDefault(),i("/historico");return}}};return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[o,i]),p.useEffect(()=>{try{typeof window<"u"&&window.innerWidth<768&&c&&t(!1)}catch{}},[c]),a.jsx(j2e,{children:a.jsx(p2e,{children:a.jsx(_2e,{children:a.jsxs("div",{className:"relative flex h-screen bg-background text-text-primary",children:[a.jsxs(m1,{children:[a.jsx("title",{children:"F7 Arena"}),a.jsx("meta",{name:"description",content:"Software para gesto de quadras esportivas."})]}),a.jsx(xge,{isVisible:e,setIsVisible:t,sidebarPinned:r}),e&&a.jsx("button",{type:"button",onClick:()=>t(!1),className:"md:hidden fixed inset-0 z-30 bg-black/40","aria-label":"Fechar menu lateral"}),a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[a.jsx(g2e,{onToggleSidebar:s,sidebarVisible:e,sidebarPinned:r}),a.jsx("main",{className:pr("flex-1 overflow-x-hidden overflow-y-auto bg-background",l?"p-0 md:p-8":"p-8"),children:a.jsxs(Zj,{children:[a.jsx(Ya,{path:"/",element:a.jsx(dUe,{})}),a.jsx(Ya,{path:"/agenda",element:a.jsx(uZe,{sidebarVisible:e})}),a.jsx(Ya,{path:"/isis",element:a.jsx(IY,{children:a.jsx(Uit,{})})}),a.jsx(Ya,{path:"/isis/analytics",element:a.jsx(Vit,{})}),a.jsx(Ya,{path:"/vendas",element:a.jsx(Zat,{})}),a.jsx(Ya,{path:"/balcao",element:a.jsx(est,{})}),a.jsx(Ya,{path:"/produtos",element:a.jsx(Cst,{})}),a.jsx(Ya,{path:"/compras",element:a.jsx(Est,{})}),a.jsx(Ya,{path:"/clientes",element:a.jsx(Dst,{})}),a.jsx(Ya,{path:"/equipe",element:a.jsx($st,{})}),a.jsx(Ya,{path:"/financeiro",element:a.jsx(Sot,{})}),a.jsx(Ya,{path:"/caixa",element:a.jsx(BH,{to:"/financeiro?tab=caixa",replace:!0})}),a.jsx(Ya,{path:"/quadras",element:a.jsx(Aot,{})}),a.jsx(Ya,{path:"/empresas",element:a.jsx(Rot,{})}),a.jsx(Ya,{path:"/finalizadoras",element:a.jsx(Fot,{})}),a.jsx(Ya,{path:"/configuracao-fiscal",element:a.jsx(Oit,{})}),a.jsx(Ya,{path:"/fiscal",element:a.jsx(qit,{})}),a.jsx(Ya,{path:"/test-page",element:a.jsx($ot,{})}),a.jsx(Ya,{path:"/historico",element:a.jsx(Kit,{})}),a.jsx(Ya,{path:"/suporte",element:a.jsx(qst,{})})]})})]})]})})})})}function plt(){$o();const[e,t]=p.useState(!1),[r,n]=p.useState(!1),s=String({}.VITE_MAINTENANCE_MODE||"").toLowerCase()==="true",o=Pe.useMemo(()=>{try{if(typeof window>"u")return null;const c=window.location.host||"",d="f7arena.com";if(!c.endsWith(d))return null;const u=c.slice(0,-d.length).replace(/\.$/,"").toLowerCase();return!u||u==="www"?null:u}catch{return null}},[]);p.useEffect(()=>{try{const c=()=>{const u=localStorage.getItem("maintenance:active")==="true",f=localStorage.getItem("maintenance:end");return u&&f&&new Date>new Date(f)?(localStorage.removeItem("maintenance:active"),!1):u};t(localStorage.getItem("maintenance:bypass")==="1"),n(c());const d=u=>{if(!u||!u.key){n(c()),t(localStorage.getItem("maintenance:bypass")==="1");return}u.key==="maintenance:bypass"&&t(u.newValue==="1"),(u.key==="maintenance:active"||u.key==="maintenance:end")&&n(c())};return window.addEventListener("storage",d),()=>window.removeEventListener("storage",d)}catch{}},[]);const i=!!KS||s||r,l=(()=>{try{const c=localStorage.getItem("maintenance:bypass")==="1",d=(()=>{try{return sessionStorage.getItem("maintenance:bypass")==="1"}catch{return!1}})(),u=(()=>{try{return document.cookie.split(";").some(f=>f.trim()==="fx_maint_bypass=1")}catch{return!1}})();return c||d||u}catch{return!1}})();return i&&!l?a.jsxs(Zj,{children:[a.jsx(Ya,{path:"/maintenance",element:a.jsx(vV,{})}),a.jsx(Ya,{path:"*",element:a.jsx(BH,{to:"/maintenance",replace:!0})})]}):o?a.jsx(Zj,{children:a.jsx(Ya,{path:"/*",element:a.jsx(hV,{})})}):a.jsxs(Zj,{children:[a.jsx(Ya,{path:"/reset-password",element:a.jsx(zot,{})}),a.jsx(Ya,{path:"/40028922",element:a.jsx(elt,{})}),a.jsx(Ya,{path:"/agendar/:nomeFantasia",element:a.jsx(hV,{})}),a.jsx(Ya,{path:"/maintenance",element:a.jsx(vV,{})}),a.jsx(Ya,{path:"/backenddeploy",element:a.jsx(Bot,{})}),a.jsx(Ya,{path:"/print-comanda",element:a.jsx(Y6,{children:a.jsx(Xit,{})})}),a.jsx(Ya,{path:"/*",element:a.jsx(Y6,{children:a.jsx(hlt,{})})})]})}var ZR="ToastProvider",[eL,glt,vlt]=R5("Toast"),[goe,oct]=Ld("Toast",[vlt]),[xlt,bP]=goe(ZR),voe=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:s="right",swipeThreshold:o=50,children:i}=e,[l,c]=p.useState(null),[d,u]=p.useState(0),f=p.useRef(!1),h=p.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${ZR}\`. Expected non-empty \`string\`.`),a.jsx(eL.Provider,{scope:t,children:a.jsx(xlt,{scope:t,label:r,duration:n,swipeDirection:s,swipeThreshold:o,toastCount:d,viewport:l,onViewportChange:c,onToastAdd:p.useCallback(()=>u(m=>m+1),[]),onToastRemove:p.useCallback(()=>u(m=>m-1),[]),isFocusedToastEscapeKeyDownRef:f,isClosePausedRef:h,children:i})})};voe.displayName=ZR;var xoe="ToastViewport",ylt=["F8"],x3="toast.viewportPause",y3="toast.viewportResume",yoe=p.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=ylt,label:s="Notifications ({hotkey})",...o}=e,i=bP(xoe,r),l=glt(r),c=p.useRef(null),d=p.useRef(null),u=p.useRef(null),f=p.useRef(null),h=$a(t,f,i.onViewportChange),m=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),v=i.toastCount>0;p.useEffect(()=>{const y=x=>{n.length!==0&&n.every(w=>x[w]||x.code===w)&&f.current?.focus()};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[n]),p.useEffect(()=>{const y=c.current,x=f.current;if(v&&y&&x){const b=()=>{if(!i.isClosePausedRef.current){const S=new CustomEvent(x3);x.dispatchEvent(S),i.isClosePausedRef.current=!0}},w=()=>{if(i.isClosePausedRef.current){const S=new CustomEvent(y3);x.dispatchEvent(S),i.isClosePausedRef.current=!1}},j=S=>{!y.contains(S.relatedTarget)&&w()},_=()=>{y.contains(document.activeElement)||w()};return y.addEventListener("focusin",b),y.addEventListener("focusout",j),y.addEventListener("pointermove",b),y.addEventListener("pointerleave",_),window.addEventListener("blur",b),window.addEventListener("focus",w),()=>{y.removeEventListener("focusin",b),y.removeEventListener("focusout",j),y.removeEventListener("pointermove",b),y.removeEventListener("pointerleave",_),window.removeEventListener("blur",b),window.removeEventListener("focus",w)}}},[v,i.isClosePausedRef]);const g=p.useCallback(({tabbingDirection:y})=>{const b=l().map(w=>{const j=w.ref.current,_=[j,...Olt(j)];return y==="forwards"?_:_.reverse()});return(y==="forwards"?b.reverse():b).flat()},[l]);return p.useEffect(()=>{const y=f.current;if(y){const x=b=>{const w=b.altKey||b.ctrlKey||b.metaKey;if(b.key==="Tab"&&!w){const _=document.activeElement,S=b.shiftKey;if(b.target===y&&S){d.current?.focus();return}const A=g({tabbingDirection:S?"backwards":"forwards"}),R=A.findIndex(O=>O===_);gk(A.slice(R+1))?b.preventDefault():S?d.current?.focus():u.current?.focus()}};return y.addEventListener("keydown",x),()=>y.removeEventListener("keydown",x)}},[l,g]),a.jsxs(kge,{ref:c,role:"region","aria-label":s.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:v?void 0:"none"},children:[v&&a.jsx(b3,{ref:d,onFocusFromOutsideViewport:()=>{const y=g({tabbingDirection:"forwards"});gk(y)}}),a.jsx(eL.Slot,{scope:r,children:a.jsx(ta.ol,{tabIndex:-1,...o,ref:h})}),v&&a.jsx(b3,{ref:u,onFocusFromOutsideViewport:()=>{const y=g({tabbingDirection:"backwards"});gk(y)}})]})});yoe.displayName=xoe;var boe="ToastFocusProxy",b3=p.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...s}=e,o=bP(boe,r);return a.jsx(zM,{tabIndex:0,...s,ref:t,style:{position:"fixed"},onFocus:i=>{const l=i.relatedTarget;!o.viewport?.contains(l)&&n()}})});b3.displayName=boe;var s2="Toast",blt="toast.swipeStart",wlt="toast.swipeMove",jlt="toast.swipeCancel",_lt="toast.swipeEnd",woe=p.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:s,onOpenChange:o,...i}=e,[l,c]=tm({prop:n,defaultProp:s??!0,onChange:o,caller:s2});return a.jsx(Yc,{present:r||l,children:a.jsx(Clt,{open:l,...i,ref:t,onClose:()=>c(!1),onPause:cc(e.onPause),onResume:cc(e.onResume),onSwipeStart:gn(e.onSwipeStart,d=>{d.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:gn(e.onSwipeMove,d=>{const{x:u,y:f}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","move"),d.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${f}px`)}),onSwipeCancel:gn(e.onSwipeCancel,d=>{d.currentTarget.setAttribute("data-swipe","cancel"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:gn(e.onSwipeEnd,d=>{const{x:u,y:f}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","end"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${f}px`),c(!1)})})})});woe.displayName=s2;var[Nlt,Slt]=goe(s2,{onClose(){}}),Clt=p.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:s,open:o,onClose:i,onEscapeKeyDown:l,onPause:c,onResume:d,onSwipeStart:u,onSwipeMove:f,onSwipeCancel:h,onSwipeEnd:m,...v}=e,g=bP(s2,r),[y,x]=p.useState(null),b=$a(t,D=>x(D)),w=p.useRef(null),j=p.useRef(null),_=s||g.duration,S=p.useRef(0),C=p.useRef(_),P=p.useRef(0),{onToastAdd:A,onToastRemove:R}=g,O=cc(()=>{y?.contains(document.activeElement)&&g.viewport?.focus(),i()}),I=p.useCallback(D=>{!D||D===1/0||(window.clearTimeout(P.current),S.current=new Date().getTime(),P.current=window.setTimeout(O,D))},[O]);p.useEffect(()=>{const D=g.viewport;if(D){const U=()=>{I(C.current),d?.()},z=()=>{const W=new Date().getTime()-S.current;C.current=C.current-W,window.clearTimeout(P.current),c?.()};return D.addEventListener(x3,z),D.addEventListener(y3,U),()=>{D.removeEventListener(x3,z),D.removeEventListener(y3,U)}}},[g.viewport,_,c,d,I]),p.useEffect(()=>{o&&!g.isClosePausedRef.current&&I(_)},[o,_,g.isClosePausedRef,I]),p.useEffect(()=>(A(),()=>R()),[A,R]);const M=p.useMemo(()=>y?Aoe(y):null,[y]);return g.viewport?a.jsxs(a.Fragment,{children:[M&&a.jsx(Plt,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite",children:M}),a.jsx(Nlt,{scope:r,onClose:O,children:im.createPortal(a.jsx(eL.ItemSlot,{scope:r,children:a.jsx(Ege,{asChild:!0,onEscapeKeyDown:gn(l,()=>{g.isFocusedToastEscapeKeyDownRef.current||O(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:a.jsx(ta.li,{tabIndex:0,"data-state":o?"open":"closed","data-swipe-direction":g.swipeDirection,...v,ref:b,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:gn(e.onKeyDown,D=>{D.key==="Escape"&&(l?.(D.nativeEvent),D.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,O()))}),onPointerDown:gn(e.onPointerDown,D=>{D.button===0&&(w.current={x:D.clientX,y:D.clientY})}),onPointerMove:gn(e.onPointerMove,D=>{if(!w.current)return;const U=D.clientX-w.current.x,z=D.clientY-w.current.y,W=!!j.current,$=["left","right"].includes(g.swipeDirection),X=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,ye=$?X(0,U):0,Se=$?0:X(0,z),V=D.pointerType==="touch"?10:2,B={x:ye,y:Se},Q={originalEvent:D,delta:B};W?(j.current=B,Bj(wlt,f,Q,{discrete:!1})):xV(B,g.swipeDirection,V)?(j.current=B,Bj(blt,u,Q,{discrete:!1}),D.target.setPointerCapture(D.pointerId)):(Math.abs(U)>V||Math.abs(z)>V)&&(w.current=null)}),onPointerUp:gn(e.onPointerUp,D=>{const U=j.current,z=D.target;if(z.hasPointerCapture(D.pointerId)&&z.releasePointerCapture(D.pointerId),j.current=null,w.current=null,U){const W=D.currentTarget,$={originalEvent:D,delta:U};xV(U,g.swipeDirection,g.swipeThreshold)?Bj(_lt,m,$,{discrete:!0}):Bj(jlt,h,$,{discrete:!0}),W.addEventListener("click",X=>X.preventDefault(),{once:!0})}})})})}),g.viewport)})]}):null}),Plt=e=>{const{__scopeToast:t,children:r,...n}=e,s=bP(s2,t),[o,i]=p.useState(!1),[l,c]=p.useState(!1);return klt(()=>i(!0)),p.useEffect(()=>{const d=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(d)},[]),l?null:a.jsx(P0,{asChild:!0,children:a.jsx(zM,{...n,children:o&&a.jsxs(a.Fragment,{children:[s.label," ",r]})})})},Alt="ToastTitle",joe=p.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return a.jsx(ta.div,{...n,ref:t})});joe.displayName=Alt;var Elt="ToastDescription",_oe=p.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return a.jsx(ta.div,{...n,ref:t})});_oe.displayName=Elt;var Noe="ToastAction",Soe=p.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?a.jsx(Poe,{altText:r,asChild:!0,children:a.jsx(tL,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${Noe}\`. Expected non-empty \`string\`.`),null)});Soe.displayName=Noe;var Coe="ToastClose",tL=p.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,s=Slt(Coe,r);return a.jsx(Poe,{asChild:!0,children:a.jsx(ta.button,{type:"button",...n,ref:t,onClick:gn(e.onClick,s.onClose)})})});tL.displayName=Coe;var Poe=p.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...s}=e;return a.jsx(ta.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...s,ref:t})});function Aoe(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),Ilt(n)){const s=n.ariaHidden||n.hidden||n.style.display==="none",o=n.dataset.radixToastAnnounceExclude==="";if(!s)if(o){const i=n.dataset.radixToastAnnounceAlt;i&&t.push(i)}else t.push(...Aoe(n))}}),t}function Bj(e,t,r,{discrete:n}){const s=r.originalEvent.currentTarget,o=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?J4(s,o):s.dispatchEvent(o)}var xV=(e,t,r=0)=>{const n=Math.abs(e.x),s=Math.abs(e.y),o=n>s;return t==="left"||t==="right"?o&&n>r:!o&&s>r};function klt(e=()=>{}){const t=cc(e);qi(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function Ilt(e){return e.nodeType===e.ELEMENT_NODE}function Olt(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function gk(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var Tlt=voe,Eoe=yoe,koe=woe,Ioe=joe,Ooe=_oe,Toe=Soe,Doe=tL;const Dlt=Tlt,Moe=Pe.forwardRef(({className:e,...t},r)=>a.jsx(Eoe,{ref:r,className:pr("fixed z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));Moe.displayName=Eoe.displayName;const Mlt=Y4("group relative pointer-events-auto flex w-full items-start justify-between gap-4 overflow-hidden rounded-lg border p-4 pr-8 shadow-xl transition-all data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=open]:sm:slide-in-from-bottom-full data-[state=closed]:slide-out-to-right-full",{variants:{variant:{default:"bg-warning text-black border-warning",destructive:"bg-danger text-white border-danger",success:"bg-success text-white border-success",info:"bg-info text-black border-info",warning:"bg-warning text-black border-warning"}},defaultVariants:{variant:"default"}}),Roe=Pe.forwardRef(({className:e,variant:t,...r},n)=>a.jsx(koe,{ref:n,className:pr(Mlt({variant:t}),e),...r}));Roe.displayName=koe.displayName;const Rlt=Pe.forwardRef(({className:e,...t},r)=>a.jsx(Toe,{ref:r,className:pr("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-destructive/30 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));Rlt.displayName=Toe.displayName;const Loe=Pe.forwardRef(({className:e,...t},r)=>a.jsx(Doe,{ref:r,className:pr("absolute right-2 top-2 rounded-md p-1 text-white/80 transition-opacity hover:text-white focus:outline-none focus:ring-2 focus:ring-white/50 group-[.default]:text-black/70 group-[.default]:hover:text-black",e),...t,children:a.jsx(al,{className:"h-4 w-4"})}));Loe.displayName=Doe.displayName;const Foe=Pe.forwardRef(({className:e,...t},r)=>a.jsx(Ioe,{ref:r,className:pr("text-sm font-semibold",e),...t}));Foe.displayName=Ioe.displayName;const $oe=Pe.forwardRef(({className:e,...t},r)=>a.jsx(Ooe,{ref:r,className:pr("text-sm",e),...t}));$oe.displayName=Ooe.displayName;function Llt(){const{toasts:e}=Qa();return a.jsxs(Dlt,{children:[e.map(({id:t,title:r,description:n,action:s,dismiss:o,...i})=>a.jsxs(Roe,{...i,children:[a.jsxs("div",{className:"grid gap-1",children:[r&&a.jsx(Foe,{children:r}),n&&a.jsx($oe,{children:n})]}),s,a.jsx(Loe,{onClick:o})]},t)),a.jsx(Moe,{})]})}function Flt(){"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js",{scope:"/"}).then(e=>{setInterval(()=>{e.update()},6e4),e.addEventListener("updatefound",()=>{const t=e.installing;t.addEventListener("statechange",()=>{t.state==="installed"&&navigator.serviceWorker.controller&&window.confirm("Nova verso disponvel! Deseja atualizar agora?")&&(t.postMessage({type:"SKIP_WAITING"}),window.location.reload())})})}).catch(e=>{console.error("[SW] Erro ao registrar Service Worker:",e)}),navigator.serviceWorker.addEventListener("controllerchange",()=>{window.location.reload()})})}Flt();window.screen?.orientation?.lock&&window.screen.orientation.lock("portrait").catch(e=>{console.log("[Orientation] Lock no suportado ou j bloqueado:",e.message)});window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),window.__installPrompt=e},{passive:!1});window.addEventListener("appinstalled",()=>{window.__installPrompt=null});vk.createRoot(document.getElementById("root")).render(a.jsx(Tde,{children:a.jsxs(gwe,{children:[a.jsx(plt,{}),a.jsx(Llt,{})]})}));export{Q1e as _,rl as c,Ua as g};
