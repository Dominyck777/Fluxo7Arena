var _ie=Object.defineProperty;var Sie=(e,t,r)=>t in e?_ie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var ro=(e,t,r)=>(Sie(e,typeof t!="symbol"?t+"":t,r),r);function Cie(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var Us=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qa(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Pie(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var jU={exports:{}},aS={},NU={exports:{}},_a={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I1=Symbol.for("react.element"),Aie=Symbol.for("react.portal"),Eie=Symbol.for("react.fragment"),kie=Symbol.for("react.strict_mode"),Oie=Symbol.for("react.profiler"),Iie=Symbol.for("react.provider"),Tie=Symbol.for("react.context"),Die=Symbol.for("react.forward_ref"),Mie=Symbol.for("react.suspense"),Rie=Symbol.for("react.memo"),Lie=Symbol.for("react.lazy"),IR=Symbol.iterator;function $ie(e){return e===null||typeof e!="object"?null:(e=IR&&e[IR]||e["@@iterator"],typeof e=="function"?e:null)}var _U={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},SU=Object.assign,CU={};function Ux(e,t,r){this.props=e,this.context=t,this.refs=CU,this.updater=r||_U}Ux.prototype.isReactComponent={};Ux.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ux.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function PU(){}PU.prototype=Ux.prototype;function T4(e,t,r){this.props=e,this.context=t,this.refs=CU,this.updater=r||_U}var D4=T4.prototype=new PU;D4.constructor=T4;SU(D4,Ux.prototype);D4.isPureReactComponent=!0;var TR=Array.isArray,AU=Object.prototype.hasOwnProperty,M4={current:null},EU={key:!0,ref:!0,__self:!0,__source:!0};function kU(e,t,r){var n,a={},i=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(i=""+t.key),t)AU.call(t,n)&&!EU.hasOwnProperty(n)&&(a[n]=t[n]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];a.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)a[n]===void 0&&(a[n]=l[n]);return{$$typeof:I1,type:e,key:i,ref:s,props:a,_owner:M4.current}}function Fie(e,t){return{$$typeof:I1,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function R4(e){return typeof e=="object"&&e!==null&&e.$$typeof===I1}function Bie(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var DR=/\/+/g;function B5(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Bie(""+e.key):t.toString(36)}function Q2(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case I1:case Aie:s=!0}}if(s)return s=e,a=a(s),e=n===""?"."+B5(s,0):n,TR(a)?(r="",e!=null&&(r=e.replace(DR,"$&/")+"/"),Q2(a,t,r,"",function(d){return d})):a!=null&&(R4(a)&&(a=Fie(a,r+(!a.key||s&&s.key===a.key?"":(""+a.key).replace(DR,"$&/")+"/")+e)),t.push(a)),1;if(s=0,n=n===""?".":n+":",TR(e))for(var l=0;l<e.length;l++){i=e[l];var c=n+B5(i,l);s+=Q2(i,t,r,c,a)}else if(c=$ie(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=n+B5(i,l++),s+=Q2(i,t,r,c,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function Mw(e,t,r){if(e==null)return e;var n=[],a=0;return Q2(e,n,"","",function(i){return t.call(r,i,a++)}),n}function qie(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var gl={current:null},Z2={transition:null},zie={ReactCurrentDispatcher:gl,ReactCurrentBatchConfig:Z2,ReactCurrentOwner:M4};function OU(){throw Error("act(...) is not supported in production builds of React.")}_a.Children={map:Mw,forEach:function(e,t,r){Mw(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Mw(e,function(){t++}),t},toArray:function(e){return Mw(e,function(t){return t})||[]},only:function(e){if(!R4(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};_a.Component=Ux;_a.Fragment=Eie;_a.Profiler=Oie;_a.PureComponent=T4;_a.StrictMode=kie;_a.Suspense=Mie;_a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zie;_a.act=OU;_a.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=SU({},e.props),a=e.key,i=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,s=M4.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)AU.call(t,c)&&!EU.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:I1,type:e.type,key:a,ref:i,props:n,_owner:s}};_a.createContext=function(e){return e={$$typeof:Tie,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Iie,_context:e},e.Consumer=e};_a.createElement=kU;_a.createFactory=function(e){var t=kU.bind(null,e);return t.type=e,t};_a.createRef=function(){return{current:null}};_a.forwardRef=function(e){return{$$typeof:Die,render:e}};_a.isValidElement=R4;_a.lazy=function(e){return{$$typeof:Lie,_payload:{_status:-1,_result:e},_init:qie}};_a.memo=function(e,t){return{$$typeof:Rie,type:e,compare:t===void 0?null:t}};_a.startTransition=function(e){var t=Z2.transition;Z2.transition={};try{e()}finally{Z2.transition=t}};_a.unstable_act=OU;_a.useCallback=function(e,t){return gl.current.useCallback(e,t)};_a.useContext=function(e){return gl.current.useContext(e)};_a.useDebugValue=function(){};_a.useDeferredValue=function(e){return gl.current.useDeferredValue(e)};_a.useEffect=function(e,t){return gl.current.useEffect(e,t)};_a.useId=function(){return gl.current.useId()};_a.useImperativeHandle=function(e,t,r){return gl.current.useImperativeHandle(e,t,r)};_a.useInsertionEffect=function(e,t){return gl.current.useInsertionEffect(e,t)};_a.useLayoutEffect=function(e,t){return gl.current.useLayoutEffect(e,t)};_a.useMemo=function(e,t){return gl.current.useMemo(e,t)};_a.useReducer=function(e,t,r){return gl.current.useReducer(e,t,r)};_a.useRef=function(e){return gl.current.useRef(e)};_a.useState=function(e){return gl.current.useState(e)};_a.useSyncExternalStore=function(e,t,r){return gl.current.useSyncExternalStore(e,t,r)};_a.useTransition=function(){return gl.current.useTransition()};_a.version="18.3.1";NU.exports=_a;var p=NU.exports;const ye=qa(p),L4=Cie({__proto__:null,default:ye},[p]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uie=p,Vie=Symbol.for("react.element"),Wie=Symbol.for("react.fragment"),Hie=Object.prototype.hasOwnProperty,Gie=Uie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Kie={key:!0,ref:!0,__self:!0,__source:!0};function IU(e,t,r){var n,a={},i=null,s=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)Hie.call(t,n)&&!Kie.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:Vie,type:e,key:i,ref:s,props:a,_owner:Gie.current}}aS.Fragment=Wie;aS.jsx=IU;aS.jsxs=IU;jU.exports=aS;var o=jU.exports,PE={},TU={exports:{}},Sc={},DU={exports:{}},MU={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t($,Y){var de=$.length;$.push(Y);e:for(;0<de;){var xe=de-1>>>1,q=$[xe];if(0<a(q,Y))$[xe]=Y,$[de]=q,de=xe;else break e}}function r($){return $.length===0?null:$[0]}function n($){if($.length===0)return null;var Y=$[0],de=$.pop();if(de!==Y){$[0]=de;e:for(var xe=0,q=$.length,L=q>>>1;xe<L;){var W=2*(xe+1)-1,ne=$[W],le=W+1,K=$[le];if(0>a(ne,de))le<q&&0>a(K,ne)?($[xe]=K,$[le]=de,xe=le):($[xe]=ne,$[W]=de,xe=W);else if(le<q&&0>a(K,de))$[xe]=K,$[le]=de,xe=le;else break e}}return Y}function a($,Y){var de=$.sortIndex-Y.sortIndex;return de!==0?de:$.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,l=s.now();e.unstable_now=function(){return s.now()-l}}var c=[],d=[],u=1,f=null,m=3,h=!1,v=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w($){for(var Y=r(d);Y!==null;){if(Y.callback===null)n(d);else if(Y.startTime<=$)n(d),Y.sortIndex=Y.expirationTime,t(c,Y);else break;Y=r(d)}}function j($){if(g=!1,w($),!v)if(r(c)!==null)v=!0,U(_);else{var Y=r(d);Y!==null&&z(j,Y.startTime-$)}}function _($,Y){v=!1,g&&(g=!1,x(P),P=-1),h=!0;var de=m;try{for(w(Y),f=r(c);f!==null&&(!(f.expirationTime>Y)||$&&!S());){var xe=f.callback;if(typeof xe=="function"){f.callback=null,m=f.priorityLevel;var q=xe(f.expirationTime<=Y);Y=e.unstable_now(),typeof q=="function"?f.callback=q:f===r(c)&&n(c),w(Y)}else n(c);f=r(c)}if(f!==null)var L=!0;else{var W=r(d);W!==null&&z(j,W.startTime-Y),L=!1}return L}finally{f=null,m=de,h=!1}}var C=!1,E=null,P=-1,k=5,M=-1;function S(){return!(e.unstable_now()-M<k)}function I(){if(E!==null){var $=e.unstable_now();M=$;var Y=!0;try{Y=E(!0,$)}finally{Y?T():(C=!1,E=null)}}else C=!1}var T;if(typeof b=="function")T=function(){b(I)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,B=D.port2;D.port1.onmessage=I,T=function(){B.postMessage(null)}}else T=function(){y(I,0)};function U($){E=$,C||(C=!0,T())}function z($,Y){P=y(function(){$(e.unstable_now())},Y)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function($){$.callback=null},e.unstable_continueExecution=function(){v||h||(v=!0,U(_))},e.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<$?Math.floor(1e3/$):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function($){switch(m){case 1:case 2:case 3:var Y=3;break;default:Y=m}var de=m;m=Y;try{return $()}finally{m=de}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function($,Y){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var de=m;m=$;try{return Y()}finally{m=de}},e.unstable_scheduleCallback=function($,Y,de){var xe=e.unstable_now();switch(typeof de=="object"&&de!==null?(de=de.delay,de=typeof de=="number"&&0<de?xe+de:xe):de=xe,$){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=de+q,$={id:u++,callback:Y,priorityLevel:$,startTime:de,expirationTime:q,sortIndex:-1},de>xe?($.sortIndex=de,t(d,$),r(c)===null&&$===r(d)&&(g?(x(P),P=-1):g=!0,z(j,de-xe))):($.sortIndex=q,t(c,$),v||h||(v=!0,U(_))),$},e.unstable_shouldYield=S,e.unstable_wrapCallback=function($){var Y=m;return function(){var de=m;m=Y;try{return $.apply(this,arguments)}finally{m=de}}}})(MU);DU.exports=MU;var Yie=DU.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xie=p,Nc=Yie;function Rr(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var RU=new Set,rb={};function sg(e,t){Xv(e,t),Xv(e+"Capture",t)}function Xv(e,t){for(rb[e]=t,e=0;e<t.length;e++)RU.add(t[e])}var _f=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),AE=Object.prototype.hasOwnProperty,Jie=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,MR={},RR={};function Qie(e){return AE.call(RR,e)?!0:AE.call(MR,e)?!1:Jie.test(e)?RR[e]=!0:(MR[e]=!0,!1)}function Zie(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function ese(e,t,r,n){if(t===null||typeof t>"u"||Zie(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function vl(e,t,r,n,a,i,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var Ss={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ss[e]=new vl(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ss[t]=new vl(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ss[e]=new vl(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ss[e]=new vl(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ss[e]=new vl(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ss[e]=new vl(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ss[e]=new vl(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ss[e]=new vl(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ss[e]=new vl(e,5,!1,e.toLowerCase(),null,!1,!1)});var $4=/[\-:]([a-z])/g;function F4(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace($4,F4);Ss[t]=new vl(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace($4,F4);Ss[t]=new vl(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace($4,F4);Ss[t]=new vl(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ss[e]=new vl(e,1,!1,e.toLowerCase(),null,!1,!1)});Ss.xlinkHref=new vl("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ss[e]=new vl(e,1,!1,e.toLowerCase(),null,!0,!0)});function B4(e,t,r,n){var a=Ss.hasOwnProperty(t)?Ss[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(ese(t,r,a,n)&&(r=null),n||a===null?Qie(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Lf=Xie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Rw=Symbol.for("react.element"),av=Symbol.for("react.portal"),ov=Symbol.for("react.fragment"),q4=Symbol.for("react.strict_mode"),EE=Symbol.for("react.profiler"),LU=Symbol.for("react.provider"),$U=Symbol.for("react.context"),z4=Symbol.for("react.forward_ref"),kE=Symbol.for("react.suspense"),OE=Symbol.for("react.suspense_list"),U4=Symbol.for("react.memo"),fm=Symbol.for("react.lazy"),FU=Symbol.for("react.offscreen"),LR=Symbol.iterator;function P0(e){return e===null||typeof e!="object"?null:(e=LR&&e[LR]||e["@@iterator"],typeof e=="function"?e:null)}var Yo=Object.assign,q5;function iy(e){if(q5===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);q5=t&&t[1]||""}return`
`+q5+e}var z5=!1;function U5(e,t){if(!e||z5)return"";z5=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var a=d.stack.split(`
`),i=n.stack.split(`
`),s=a.length-1,l=i.length-1;1<=s&&0<=l&&a[s]!==i[l];)l--;for(;1<=s&&0<=l;s--,l--)if(a[s]!==i[l]){if(s!==1||l!==1)do if(s--,l--,0>l||a[s]!==i[l]){var c=`
`+a[s].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=s&&0<=l);break}}}finally{z5=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?iy(e):""}function tse(e){switch(e.tag){case 5:return iy(e.type);case 16:return iy("Lazy");case 13:return iy("Suspense");case 19:return iy("SuspenseList");case 0:case 2:case 15:return e=U5(e.type,!1),e;case 11:return e=U5(e.type.render,!1),e;case 1:return e=U5(e.type,!0),e;default:return""}}function IE(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ov:return"Fragment";case av:return"Portal";case EE:return"Profiler";case q4:return"StrictMode";case kE:return"Suspense";case OE:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case $U:return(e.displayName||"Context")+".Consumer";case LU:return(e._context.displayName||"Context")+".Provider";case z4:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case U4:return t=e.displayName||null,t!==null?t:IE(e.type)||"Memo";case fm:t=e._payload,e=e._init;try{return IE(e(t))}catch{}}return null}function rse(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return IE(t);case 8:return t===q4?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ah(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function BU(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function nse(e){var t=BU(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(s){n=""+s,i.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Lw(e){e._valueTracker||(e._valueTracker=nse(e))}function qU(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=BU(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Oj(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function TE(e,t){var r=t.checked;return Yo({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function $R(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ah(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function zU(e,t){t=t.checked,t!=null&&B4(e,"checked",t,!1)}function DE(e,t){zU(e,t);var r=ah(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ME(e,t.type,r):t.hasOwnProperty("defaultValue")&&ME(e,t.type,ah(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function FR(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function ME(e,t,r){(t!=="number"||Oj(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var sy=Array.isArray;function Pv(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ah(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function RE(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Rr(91));return Yo({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function BR(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Rr(92));if(sy(r)){if(1<r.length)throw Error(Rr(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ah(r)}}function UU(e,t){var r=ah(t.value),n=ah(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function qR(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function VU(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function LE(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?VU(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var $w,WU=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for($w=$w||document.createElement("div"),$w.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=$w.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function nb(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var vy={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ase=["Webkit","ms","Moz","O"];Object.keys(vy).forEach(function(e){ase.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),vy[t]=vy[e]})});function HU(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||vy.hasOwnProperty(e)&&vy[e]?(""+t).trim():t+"px"}function GU(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=HU(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var ose=Yo({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $E(e,t){if(t){if(ose[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Rr(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Rr(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Rr(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Rr(62))}}function FE(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var BE=null;function V4(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var qE=null,Av=null,Ev=null;function zR(e){if(e=M1(e)){if(typeof qE!="function")throw Error(Rr(280));var t=e.stateNode;t&&(t=cS(t),qE(e.stateNode,e.type,t))}}function KU(e){Av?Ev?Ev.push(e):Ev=[e]:Av=e}function YU(){if(Av){var e=Av,t=Ev;if(Ev=Av=null,zR(e),t)for(e=0;e<t.length;e++)zR(t[e])}}function XU(e,t){return e(t)}function JU(){}var V5=!1;function QU(e,t,r){if(V5)return e(t,r);V5=!0;try{return XU(e,t,r)}finally{V5=!1,(Av!==null||Ev!==null)&&(JU(),YU())}}function ab(e,t){var r=e.stateNode;if(r===null)return null;var n=cS(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Rr(231,t,typeof r));return r}var zE=!1;if(_f)try{var A0={};Object.defineProperty(A0,"passive",{get:function(){zE=!0}}),window.addEventListener("test",A0,A0),window.removeEventListener("test",A0,A0)}catch{zE=!1}function ise(e,t,r,n,a,i,s,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(u){this.onError(u)}}var xy=!1,Ij=null,Tj=!1,UE=null,sse={onError:function(e){xy=!0,Ij=e}};function lse(e,t,r,n,a,i,s,l,c){xy=!1,Ij=null,ise.apply(sse,arguments)}function cse(e,t,r,n,a,i,s,l,c){if(lse.apply(this,arguments),xy){if(xy){var d=Ij;xy=!1,Ij=null}else throw Error(Rr(198));Tj||(Tj=!0,UE=d)}}function lg(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function ZU(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function UR(e){if(lg(e)!==e)throw Error(Rr(188))}function dse(e){var t=e.alternate;if(!t){if(t=lg(e),t===null)throw Error(Rr(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return UR(a),e;if(i===n)return UR(a),t;i=i.sibling}throw Error(Rr(188))}if(r.return!==n.return)r=a,n=i;else{for(var s=!1,l=a.child;l;){if(l===r){s=!0,r=a,n=i;break}if(l===n){s=!0,n=a,r=i;break}l=l.sibling}if(!s){for(l=i.child;l;){if(l===r){s=!0,r=i,n=a;break}if(l===n){s=!0,n=i,r=a;break}l=l.sibling}if(!s)throw Error(Rr(189))}}if(r.alternate!==n)throw Error(Rr(190))}if(r.tag!==3)throw Error(Rr(188));return r.stateNode.current===r?e:t}function eV(e){return e=dse(e),e!==null?tV(e):null}function tV(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=tV(e);if(t!==null)return t;e=e.sibling}return null}var rV=Nc.unstable_scheduleCallback,VR=Nc.unstable_cancelCallback,use=Nc.unstable_shouldYield,fse=Nc.unstable_requestPaint,ui=Nc.unstable_now,mse=Nc.unstable_getCurrentPriorityLevel,W4=Nc.unstable_ImmediatePriority,nV=Nc.unstable_UserBlockingPriority,Dj=Nc.unstable_NormalPriority,hse=Nc.unstable_LowPriority,aV=Nc.unstable_IdlePriority,oS=null,Au=null;function pse(e){if(Au&&typeof Au.onCommitFiberRoot=="function")try{Au.onCommitFiberRoot(oS,e,void 0,(e.current.flags&128)===128)}catch{}}var zd=Math.clz32?Math.clz32:xse,gse=Math.log,vse=Math.LN2;function xse(e){return e>>>=0,e===0?32:31-(gse(e)/vse|0)|0}var Fw=64,Bw=4194304;function ly(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Mj(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,s=r&268435455;if(s!==0){var l=s&~a;l!==0?n=ly(l):(i&=s,i!==0&&(n=ly(i)))}else s=r&~a,s!==0?n=ly(s):i!==0&&(n=ly(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-zd(t),a=1<<r,n|=e[r],t&=~a;return n}function yse(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bse(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-zd(i),l=1<<s,c=a[s];c===-1?(!(l&r)||l&n)&&(a[s]=yse(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function VE(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function oV(){var e=Fw;return Fw<<=1,!(Fw&4194240)&&(Fw=64),e}function W5(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function T1(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-zd(t),e[t]=r}function wse(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-zd(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function H4(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-zd(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var ao=0;function iV(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var sV,G4,lV,cV,dV,WE=!1,qw=[],Tm=null,Dm=null,Mm=null,ob=new Map,ib=new Map,vm=[],jse="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function WR(e,t){switch(e){case"focusin":case"focusout":Tm=null;break;case"dragenter":case"dragleave":Dm=null;break;case"mouseover":case"mouseout":Mm=null;break;case"pointerover":case"pointerout":ob.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ib.delete(t.pointerId)}}function E0(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=M1(t),t!==null&&G4(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function Nse(e,t,r,n,a){switch(t){case"focusin":return Tm=E0(Tm,e,t,r,n,a),!0;case"dragenter":return Dm=E0(Dm,e,t,r,n,a),!0;case"mouseover":return Mm=E0(Mm,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return ob.set(i,E0(ob.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,ib.set(i,E0(ib.get(i)||null,e,t,r,n,a)),!0}return!1}function uV(e){var t=ip(e.target);if(t!==null){var r=lg(t);if(r!==null){if(t=r.tag,t===13){if(t=ZU(r),t!==null){e.blockedOn=t,dV(e.priority,function(){lV(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ej(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=HE(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);BE=n,r.target.dispatchEvent(n),BE=null}else return t=M1(r),t!==null&&G4(t),e.blockedOn=r,!1;t.shift()}return!0}function HR(e,t,r){ej(e)&&r.delete(t)}function _se(){WE=!1,Tm!==null&&ej(Tm)&&(Tm=null),Dm!==null&&ej(Dm)&&(Dm=null),Mm!==null&&ej(Mm)&&(Mm=null),ob.forEach(HR),ib.forEach(HR)}function k0(e,t){e.blockedOn===t&&(e.blockedOn=null,WE||(WE=!0,Nc.unstable_scheduleCallback(Nc.unstable_NormalPriority,_se)))}function sb(e){function t(a){return k0(a,e)}if(0<qw.length){k0(qw[0],e);for(var r=1;r<qw.length;r++){var n=qw[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Tm!==null&&k0(Tm,e),Dm!==null&&k0(Dm,e),Mm!==null&&k0(Mm,e),ob.forEach(t),ib.forEach(t),r=0;r<vm.length;r++)n=vm[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<vm.length&&(r=vm[0],r.blockedOn===null);)uV(r),r.blockedOn===null&&vm.shift()}var kv=Lf.ReactCurrentBatchConfig,Rj=!0;function Sse(e,t,r,n){var a=ao,i=kv.transition;kv.transition=null;try{ao=1,K4(e,t,r,n)}finally{ao=a,kv.transition=i}}function Cse(e,t,r,n){var a=ao,i=kv.transition;kv.transition=null;try{ao=4,K4(e,t,r,n)}finally{ao=a,kv.transition=i}}function K4(e,t,r,n){if(Rj){var a=HE(e,t,r,n);if(a===null)tP(e,t,n,Lj,r),WR(e,n);else if(Nse(a,e,t,r,n))n.stopPropagation();else if(WR(e,n),t&4&&-1<jse.indexOf(e)){for(;a!==null;){var i=M1(a);if(i!==null&&sV(i),i=HE(e,t,r,n),i===null&&tP(e,t,n,Lj,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else tP(e,t,n,null,r)}}var Lj=null;function HE(e,t,r,n){if(Lj=null,e=V4(n),e=ip(e),e!==null)if(t=lg(e),t===null)e=null;else if(r=t.tag,r===13){if(e=ZU(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Lj=e,null}function fV(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mse()){case W4:return 1;case nV:return 4;case Dj:case hse:return 16;case aV:return 536870912;default:return 16}default:return 16}}var Nm=null,Y4=null,tj=null;function mV(){if(tj)return tj;var e,t=Y4,r=t.length,n,a="value"in Nm?Nm.value:Nm.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===a[i-n];n++);return tj=a.slice(e,1<n?1-n:void 0)}function rj(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function zw(){return!0}function GR(){return!1}function Cc(e){function t(r,n,a,i,s){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?zw:GR,this.isPropagationStopped=GR,this}return Yo(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=zw)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=zw)},persist:function(){},isPersistent:zw}),t}var Vx={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},X4=Cc(Vx),D1=Yo({},Vx,{view:0,detail:0}),Pse=Cc(D1),H5,G5,O0,iS=Yo({},D1,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:J4,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==O0&&(O0&&e.type==="mousemove"?(H5=e.screenX-O0.screenX,G5=e.screenY-O0.screenY):G5=H5=0,O0=e),H5)},movementY:function(e){return"movementY"in e?e.movementY:G5}}),KR=Cc(iS),Ase=Yo({},iS,{dataTransfer:0}),Ese=Cc(Ase),kse=Yo({},D1,{relatedTarget:0}),K5=Cc(kse),Ose=Yo({},Vx,{animationName:0,elapsedTime:0,pseudoElement:0}),Ise=Cc(Ose),Tse=Yo({},Vx,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Dse=Cc(Tse),Mse=Yo({},Vx,{data:0}),YR=Cc(Mse),Rse={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Lse={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$se={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Fse(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=$se[e])?!!t[e]:!1}function J4(){return Fse}var Bse=Yo({},D1,{key:function(e){if(e.key){var t=Rse[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=rj(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Lse[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:J4,charCode:function(e){return e.type==="keypress"?rj(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?rj(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),qse=Cc(Bse),zse=Yo({},iS,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),XR=Cc(zse),Use=Yo({},D1,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:J4}),Vse=Cc(Use),Wse=Yo({},Vx,{propertyName:0,elapsedTime:0,pseudoElement:0}),Hse=Cc(Wse),Gse=Yo({},iS,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Kse=Cc(Gse),Yse=[9,13,27,32],Q4=_f&&"CompositionEvent"in window,yy=null;_f&&"documentMode"in document&&(yy=document.documentMode);var Xse=_f&&"TextEvent"in window&&!yy,hV=_f&&(!Q4||yy&&8<yy&&11>=yy),JR=String.fromCharCode(32),QR=!1;function pV(e,t){switch(e){case"keyup":return Yse.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function gV(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var iv=!1;function Jse(e,t){switch(e){case"compositionend":return gV(t);case"keypress":return t.which!==32?null:(QR=!0,JR);case"textInput":return e=t.data,e===JR&&QR?null:e;default:return null}}function Qse(e,t){if(iv)return e==="compositionend"||!Q4&&pV(e,t)?(e=mV(),tj=Y4=Nm=null,iv=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return hV&&t.locale!=="ko"?null:t.data;default:return null}}var Zse={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ZR(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Zse[e.type]:t==="textarea"}function vV(e,t,r,n){KU(n),t=$j(t,"onChange"),0<t.length&&(r=new X4("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var by=null,lb=null;function ele(e){AV(e,0)}function sS(e){var t=cv(e);if(qU(t))return e}function tle(e,t){if(e==="change")return t}var xV=!1;if(_f){var Y5;if(_f){var X5="oninput"in document;if(!X5){var eL=document.createElement("div");eL.setAttribute("oninput","return;"),X5=typeof eL.oninput=="function"}Y5=X5}else Y5=!1;xV=Y5&&(!document.documentMode||9<document.documentMode)}function tL(){by&&(by.detachEvent("onpropertychange",yV),lb=by=null)}function yV(e){if(e.propertyName==="value"&&sS(lb)){var t=[];vV(t,lb,e,V4(e)),QU(ele,t)}}function rle(e,t,r){e==="focusin"?(tL(),by=t,lb=r,by.attachEvent("onpropertychange",yV)):e==="focusout"&&tL()}function nle(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return sS(lb)}function ale(e,t){if(e==="click")return sS(t)}function ole(e,t){if(e==="input"||e==="change")return sS(t)}function ile(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Yd=typeof Object.is=="function"?Object.is:ile;function cb(e,t){if(Yd(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!AE.call(t,a)||!Yd(e[a],t[a]))return!1}return!0}function rL(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function nL(e,t){var r=rL(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=rL(r)}}function bV(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?bV(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function wV(){for(var e=window,t=Oj();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Oj(e.document)}return t}function Z4(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function sle(e){var t=wV(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&bV(r.ownerDocument.documentElement,r)){if(n!==null&&Z4(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=nL(r,i);var s=nL(r,n);a&&s&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var lle=_f&&"documentMode"in document&&11>=document.documentMode,sv=null,GE=null,wy=null,KE=!1;function aL(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;KE||sv==null||sv!==Oj(n)||(n=sv,"selectionStart"in n&&Z4(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),wy&&cb(wy,n)||(wy=n,n=$j(GE,"onSelect"),0<n.length&&(t=new X4("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=sv)))}function Uw(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var lv={animationend:Uw("Animation","AnimationEnd"),animationiteration:Uw("Animation","AnimationIteration"),animationstart:Uw("Animation","AnimationStart"),transitionend:Uw("Transition","TransitionEnd")},J5={},jV={};_f&&(jV=document.createElement("div").style,"AnimationEvent"in window||(delete lv.animationend.animation,delete lv.animationiteration.animation,delete lv.animationstart.animation),"TransitionEvent"in window||delete lv.transitionend.transition);function lS(e){if(J5[e])return J5[e];if(!lv[e])return e;var t=lv[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in jV)return J5[e]=t[r];return e}var NV=lS("animationend"),_V=lS("animationiteration"),SV=lS("animationstart"),CV=lS("transitionend"),PV=new Map,oL="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function vh(e,t){PV.set(e,t),sg(t,[e])}for(var Q5=0;Q5<oL.length;Q5++){var Z5=oL[Q5],cle=Z5.toLowerCase(),dle=Z5[0].toUpperCase()+Z5.slice(1);vh(cle,"on"+dle)}vh(NV,"onAnimationEnd");vh(_V,"onAnimationIteration");vh(SV,"onAnimationStart");vh("dblclick","onDoubleClick");vh("focusin","onFocus");vh("focusout","onBlur");vh(CV,"onTransitionEnd");Xv("onMouseEnter",["mouseout","mouseover"]);Xv("onMouseLeave",["mouseout","mouseover"]);Xv("onPointerEnter",["pointerout","pointerover"]);Xv("onPointerLeave",["pointerout","pointerover"]);sg("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));sg("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));sg("onBeforeInput",["compositionend","keypress","textInput","paste"]);sg("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));sg("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));sg("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cy="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ule=new Set("cancel close invalid load scroll toggle".split(" ").concat(cy));function iL(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,cse(n,t,void 0,e),e.currentTarget=null}function AV(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var s=n.length-1;0<=s;s--){var l=n[s],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&a.isPropagationStopped())break e;iL(a,l,d),i=c}else for(s=0;s<n.length;s++){if(l=n[s],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&a.isPropagationStopped())break e;iL(a,l,d),i=c}}}if(Tj)throw e=UE,Tj=!1,UE=null,e}function Eo(e,t){var r=t[ZE];r===void 0&&(r=t[ZE]=new Set);var n=e+"__bubble";r.has(n)||(EV(t,e,2,!1),r.add(n))}function eP(e,t,r){var n=0;t&&(n|=4),EV(r,e,n,t)}var Vw="_reactListening"+Math.random().toString(36).slice(2);function db(e){if(!e[Vw]){e[Vw]=!0,RU.forEach(function(r){r!=="selectionchange"&&(ule.has(r)||eP(r,!1,e),eP(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Vw]||(t[Vw]=!0,eP("selectionchange",!1,t))}}function EV(e,t,r,n){switch(fV(t)){case 1:var a=Sse;break;case 4:a=Cse;break;default:a=K4}r=a.bind(null,t,r,e),a=void 0,!zE||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function tP(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var l=n.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(s===4)for(s=n.return;s!==null;){var c=s.tag;if((c===3||c===4)&&(c=s.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;s=s.return}for(;l!==null;){if(s=ip(l),s===null)return;if(c=s.tag,c===5||c===6){n=i=s;continue e}l=l.parentNode}}n=n.return}QU(function(){var d=i,u=V4(r),f=[];e:{var m=PV.get(e);if(m!==void 0){var h=X4,v=e;switch(e){case"keypress":if(rj(r)===0)break e;case"keydown":case"keyup":h=qse;break;case"focusin":v="focus",h=K5;break;case"focusout":v="blur",h=K5;break;case"beforeblur":case"afterblur":h=K5;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=KR;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=Ese;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=Vse;break;case NV:case _V:case SV:h=Ise;break;case CV:h=Hse;break;case"scroll":h=Pse;break;case"wheel":h=Kse;break;case"copy":case"cut":case"paste":h=Dse;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=XR}var g=(t&4)!==0,y=!g&&e==="scroll",x=g?m!==null?m+"Capture":null:m;g=[];for(var b=d,w;b!==null;){w=b;var j=w.stateNode;if(w.tag===5&&j!==null&&(w=j,x!==null&&(j=ab(b,x),j!=null&&g.push(ub(b,j,w)))),y)break;b=b.return}0<g.length&&(m=new h(m,v,null,r,u),f.push({event:m,listeners:g}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",m&&r!==BE&&(v=r.relatedTarget||r.fromElement)&&(ip(v)||v[Sf]))break e;if((h||m)&&(m=u.window===u?u:(m=u.ownerDocument)?m.defaultView||m.parentWindow:window,h?(v=r.relatedTarget||r.toElement,h=d,v=v?ip(v):null,v!==null&&(y=lg(v),v!==y||v.tag!==5&&v.tag!==6)&&(v=null)):(h=null,v=d),h!==v)){if(g=KR,j="onMouseLeave",x="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(g=XR,j="onPointerLeave",x="onPointerEnter",b="pointer"),y=h==null?m:cv(h),w=v==null?m:cv(v),m=new g(j,b+"leave",h,r,u),m.target=y,m.relatedTarget=w,j=null,ip(u)===d&&(g=new g(x,b+"enter",v,r,u),g.target=w,g.relatedTarget=y,j=g),y=j,h&&v)t:{for(g=h,x=v,b=0,w=g;w;w=Sg(w))b++;for(w=0,j=x;j;j=Sg(j))w++;for(;0<b-w;)g=Sg(g),b--;for(;0<w-b;)x=Sg(x),w--;for(;b--;){if(g===x||x!==null&&g===x.alternate)break t;g=Sg(g),x=Sg(x)}g=null}else g=null;h!==null&&sL(f,m,h,g,!1),v!==null&&y!==null&&sL(f,y,v,g,!0)}}e:{if(m=d?cv(d):window,h=m.nodeName&&m.nodeName.toLowerCase(),h==="select"||h==="input"&&m.type==="file")var _=tle;else if(ZR(m))if(xV)_=ole;else{_=nle;var C=rle}else(h=m.nodeName)&&h.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(_=ale);if(_&&(_=_(e,d))){vV(f,_,r,u);break e}C&&C(e,m,d),e==="focusout"&&(C=m._wrapperState)&&C.controlled&&m.type==="number"&&ME(m,"number",m.value)}switch(C=d?cv(d):window,e){case"focusin":(ZR(C)||C.contentEditable==="true")&&(sv=C,GE=d,wy=null);break;case"focusout":wy=GE=sv=null;break;case"mousedown":KE=!0;break;case"contextmenu":case"mouseup":case"dragend":KE=!1,aL(f,r,u);break;case"selectionchange":if(lle)break;case"keydown":case"keyup":aL(f,r,u)}var E;if(Q4)e:{switch(e){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else iv?pV(e,r)&&(P="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(P="onCompositionStart");P&&(hV&&r.locale!=="ko"&&(iv||P!=="onCompositionStart"?P==="onCompositionEnd"&&iv&&(E=mV()):(Nm=u,Y4="value"in Nm?Nm.value:Nm.textContent,iv=!0)),C=$j(d,P),0<C.length&&(P=new YR(P,e,null,r,u),f.push({event:P,listeners:C}),E?P.data=E:(E=gV(r),E!==null&&(P.data=E)))),(E=Xse?Jse(e,r):Qse(e,r))&&(d=$j(d,"onBeforeInput"),0<d.length&&(u=new YR("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:d}),u.data=E))}AV(f,t)})}function ub(e,t,r){return{instance:e,listener:t,currentTarget:r}}function $j(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=ab(e,r),i!=null&&n.unshift(ub(e,i,a)),i=ab(e,t),i!=null&&n.push(ub(e,i,a))),e=e.return}return n}function Sg(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function sL(e,t,r,n,a){for(var i=t._reactName,s=[];r!==null&&r!==n;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&d!==null&&(l=d,a?(c=ab(r,i),c!=null&&s.unshift(ub(r,c,l))):a||(c=ab(r,i),c!=null&&s.push(ub(r,c,l)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var fle=/\r\n?/g,mle=/\u0000|\uFFFD/g;function lL(e){return(typeof e=="string"?e:""+e).replace(fle,`
`).replace(mle,"")}function Ww(e,t,r){if(t=lL(t),lL(e)!==t&&r)throw Error(Rr(425))}function Fj(){}var YE=null,XE=null;function JE(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var QE=typeof setTimeout=="function"?setTimeout:void 0,hle=typeof clearTimeout=="function"?clearTimeout:void 0,cL=typeof Promise=="function"?Promise:void 0,ple=typeof queueMicrotask=="function"?queueMicrotask:typeof cL<"u"?function(e){return cL.resolve(null).then(e).catch(gle)}:QE;function gle(e){setTimeout(function(){throw e})}function rP(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),sb(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);sb(t)}function Rm(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function dL(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Wx=Math.random().toString(36).slice(2),vu="__reactFiber$"+Wx,fb="__reactProps$"+Wx,Sf="__reactContainer$"+Wx,ZE="__reactEvents$"+Wx,vle="__reactListeners$"+Wx,xle="__reactHandles$"+Wx;function ip(e){var t=e[vu];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Sf]||r[vu]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=dL(e);e!==null;){if(r=e[vu])return r;e=dL(e)}return t}e=r,r=e.parentNode}return null}function M1(e){return e=e[vu]||e[Sf],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function cv(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Rr(33))}function cS(e){return e[fb]||null}var ek=[],dv=-1;function xh(e){return{current:e}}function To(e){0>dv||(e.current=ek[dv],ek[dv]=null,dv--)}function jo(e,t){dv++,ek[dv]=e.current,e.current=t}var oh={},Ws=xh(oh),Il=xh(!1),Lp=oh;function Jv(e,t){var r=e.type.contextTypes;if(!r)return oh;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Tl(e){return e=e.childContextTypes,e!=null}function Bj(){To(Il),To(Ws)}function uL(e,t,r){if(Ws.current!==oh)throw Error(Rr(168));jo(Ws,t),jo(Il,r)}function kV(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(Rr(108,rse(e)||"Unknown",a));return Yo({},r,n)}function qj(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||oh,Lp=Ws.current,jo(Ws,e),jo(Il,Il.current),!0}function fL(e,t,r){var n=e.stateNode;if(!n)throw Error(Rr(169));r?(e=kV(e,t,Lp),n.__reactInternalMemoizedMergedChildContext=e,To(Il),To(Ws),jo(Ws,e)):To(Il),jo(Il,r)}var lf=null,dS=!1,nP=!1;function OV(e){lf===null?lf=[e]:lf.push(e)}function yle(e){dS=!0,OV(e)}function yh(){if(!nP&&lf!==null){nP=!0;var e=0,t=ao;try{var r=lf;for(ao=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}lf=null,dS=!1}catch(a){throw lf!==null&&(lf=lf.slice(e+1)),rV(W4,yh),a}finally{ao=t,nP=!1}}return null}var uv=[],fv=0,zj=null,Uj=0,Wc=[],Hc=0,$p=null,ff=1,mf="";function Vh(e,t){uv[fv++]=Uj,uv[fv++]=zj,zj=e,Uj=t}function IV(e,t,r){Wc[Hc++]=ff,Wc[Hc++]=mf,Wc[Hc++]=$p,$p=e;var n=ff;e=mf;var a=32-zd(n)-1;n&=~(1<<a),r+=1;var i=32-zd(t)+a;if(30<i){var s=a-a%5;i=(n&(1<<s)-1).toString(32),n>>=s,a-=s,ff=1<<32-zd(t)+a|r<<a|n,mf=i+e}else ff=1<<i|r<<a|n,mf=e}function eI(e){e.return!==null&&(Vh(e,1),IV(e,1,0))}function tI(e){for(;e===zj;)zj=uv[--fv],uv[fv]=null,Uj=uv[--fv],uv[fv]=null;for(;e===$p;)$p=Wc[--Hc],Wc[Hc]=null,mf=Wc[--Hc],Wc[Hc]=null,ff=Wc[--Hc],Wc[Hc]=null}var mc=null,cc=null,qo=!1,Dd=null;function TV(e,t){var r=td(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function mL(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,mc=e,cc=Rm(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,mc=e,cc=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=$p!==null?{id:ff,overflow:mf}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=td(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,mc=e,cc=null,!0):!1;default:return!1}}function tk(e){return(e.mode&1)!==0&&(e.flags&128)===0}function rk(e){if(qo){var t=cc;if(t){var r=t;if(!mL(e,t)){if(tk(e))throw Error(Rr(418));t=Rm(r.nextSibling);var n=mc;t&&mL(e,t)?TV(n,r):(e.flags=e.flags&-4097|2,qo=!1,mc=e)}}else{if(tk(e))throw Error(Rr(418));e.flags=e.flags&-4097|2,qo=!1,mc=e}}}function hL(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;mc=e}function Hw(e){if(e!==mc)return!1;if(!qo)return hL(e),qo=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!JE(e.type,e.memoizedProps)),t&&(t=cc)){if(tk(e))throw DV(),Error(Rr(418));for(;t;)TV(e,t),t=Rm(t.nextSibling)}if(hL(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Rr(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){cc=Rm(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}cc=null}}else cc=mc?Rm(e.stateNode.nextSibling):null;return!0}function DV(){for(var e=cc;e;)e=Rm(e.nextSibling)}function Qv(){cc=mc=null,qo=!1}function rI(e){Dd===null?Dd=[e]:Dd.push(e)}var ble=Lf.ReactCurrentBatchConfig;function I0(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Rr(309));var n=r.stateNode}if(!n)throw Error(Rr(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(s){var l=a.refs;s===null?delete l[i]:l[i]=s},t._stringRef=i,t)}if(typeof e!="string")throw Error(Rr(284));if(!r._owner)throw Error(Rr(290,e))}return e}function Gw(e,t){throw e=Object.prototype.toString.call(t),Error(Rr(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function pL(e){var t=e._init;return t(e._payload)}function MV(e){function t(x,b){if(e){var w=x.deletions;w===null?(x.deletions=[b],x.flags|=16):w.push(b)}}function r(x,b){if(!e)return null;for(;b!==null;)t(x,b),b=b.sibling;return null}function n(x,b){for(x=new Map;b!==null;)b.key!==null?x.set(b.key,b):x.set(b.index,b),b=b.sibling;return x}function a(x,b){return x=Bm(x,b),x.index=0,x.sibling=null,x}function i(x,b,w){return x.index=w,e?(w=x.alternate,w!==null?(w=w.index,w<b?(x.flags|=2,b):w):(x.flags|=2,b)):(x.flags|=1048576,b)}function s(x){return e&&x.alternate===null&&(x.flags|=2),x}function l(x,b,w,j){return b===null||b.tag!==6?(b=dP(w,x.mode,j),b.return=x,b):(b=a(b,w),b.return=x,b)}function c(x,b,w,j){var _=w.type;return _===ov?u(x,b,w.props.children,j,w.key):b!==null&&(b.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===fm&&pL(_)===b.type)?(j=a(b,w.props),j.ref=I0(x,b,w),j.return=x,j):(j=cj(w.type,w.key,w.props,null,x.mode,j),j.ref=I0(x,b,w),j.return=x,j)}function d(x,b,w,j){return b===null||b.tag!==4||b.stateNode.containerInfo!==w.containerInfo||b.stateNode.implementation!==w.implementation?(b=uP(w,x.mode,j),b.return=x,b):(b=a(b,w.children||[]),b.return=x,b)}function u(x,b,w,j,_){return b===null||b.tag!==7?(b=_p(w,x.mode,j,_),b.return=x,b):(b=a(b,w),b.return=x,b)}function f(x,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return b=dP(""+b,x.mode,w),b.return=x,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Rw:return w=cj(b.type,b.key,b.props,null,x.mode,w),w.ref=I0(x,null,b),w.return=x,w;case av:return b=uP(b,x.mode,w),b.return=x,b;case fm:var j=b._init;return f(x,j(b._payload),w)}if(sy(b)||P0(b))return b=_p(b,x.mode,w,null),b.return=x,b;Gw(x,b)}return null}function m(x,b,w,j){var _=b!==null?b.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return _!==null?null:l(x,b,""+w,j);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Rw:return w.key===_?c(x,b,w,j):null;case av:return w.key===_?d(x,b,w,j):null;case fm:return _=w._init,m(x,b,_(w._payload),j)}if(sy(w)||P0(w))return _!==null?null:u(x,b,w,j,null);Gw(x,w)}return null}function h(x,b,w,j,_){if(typeof j=="string"&&j!==""||typeof j=="number")return x=x.get(w)||null,l(b,x,""+j,_);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case Rw:return x=x.get(j.key===null?w:j.key)||null,c(b,x,j,_);case av:return x=x.get(j.key===null?w:j.key)||null,d(b,x,j,_);case fm:var C=j._init;return h(x,b,w,C(j._payload),_)}if(sy(j)||P0(j))return x=x.get(w)||null,u(b,x,j,_,null);Gw(b,j)}return null}function v(x,b,w,j){for(var _=null,C=null,E=b,P=b=0,k=null;E!==null&&P<w.length;P++){E.index>P?(k=E,E=null):k=E.sibling;var M=m(x,E,w[P],j);if(M===null){E===null&&(E=k);break}e&&E&&M.alternate===null&&t(x,E),b=i(M,b,P),C===null?_=M:C.sibling=M,C=M,E=k}if(P===w.length)return r(x,E),qo&&Vh(x,P),_;if(E===null){for(;P<w.length;P++)E=f(x,w[P],j),E!==null&&(b=i(E,b,P),C===null?_=E:C.sibling=E,C=E);return qo&&Vh(x,P),_}for(E=n(x,E);P<w.length;P++)k=h(E,x,P,w[P],j),k!==null&&(e&&k.alternate!==null&&E.delete(k.key===null?P:k.key),b=i(k,b,P),C===null?_=k:C.sibling=k,C=k);return e&&E.forEach(function(S){return t(x,S)}),qo&&Vh(x,P),_}function g(x,b,w,j){var _=P0(w);if(typeof _!="function")throw Error(Rr(150));if(w=_.call(w),w==null)throw Error(Rr(151));for(var C=_=null,E=b,P=b=0,k=null,M=w.next();E!==null&&!M.done;P++,M=w.next()){E.index>P?(k=E,E=null):k=E.sibling;var S=m(x,E,M.value,j);if(S===null){E===null&&(E=k);break}e&&E&&S.alternate===null&&t(x,E),b=i(S,b,P),C===null?_=S:C.sibling=S,C=S,E=k}if(M.done)return r(x,E),qo&&Vh(x,P),_;if(E===null){for(;!M.done;P++,M=w.next())M=f(x,M.value,j),M!==null&&(b=i(M,b,P),C===null?_=M:C.sibling=M,C=M);return qo&&Vh(x,P),_}for(E=n(x,E);!M.done;P++,M=w.next())M=h(E,x,P,M.value,j),M!==null&&(e&&M.alternate!==null&&E.delete(M.key===null?P:M.key),b=i(M,b,P),C===null?_=M:C.sibling=M,C=M);return e&&E.forEach(function(I){return t(x,I)}),qo&&Vh(x,P),_}function y(x,b,w,j){if(typeof w=="object"&&w!==null&&w.type===ov&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Rw:e:{for(var _=w.key,C=b;C!==null;){if(C.key===_){if(_=w.type,_===ov){if(C.tag===7){r(x,C.sibling),b=a(C,w.props.children),b.return=x,x=b;break e}}else if(C.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===fm&&pL(_)===C.type){r(x,C.sibling),b=a(C,w.props),b.ref=I0(x,C,w),b.return=x,x=b;break e}r(x,C);break}else t(x,C);C=C.sibling}w.type===ov?(b=_p(w.props.children,x.mode,j,w.key),b.return=x,x=b):(j=cj(w.type,w.key,w.props,null,x.mode,j),j.ref=I0(x,b,w),j.return=x,x=j)}return s(x);case av:e:{for(C=w.key;b!==null;){if(b.key===C)if(b.tag===4&&b.stateNode.containerInfo===w.containerInfo&&b.stateNode.implementation===w.implementation){r(x,b.sibling),b=a(b,w.children||[]),b.return=x,x=b;break e}else{r(x,b);break}else t(x,b);b=b.sibling}b=uP(w,x.mode,j),b.return=x,x=b}return s(x);case fm:return C=w._init,y(x,b,C(w._payload),j)}if(sy(w))return v(x,b,w,j);if(P0(w))return g(x,b,w,j);Gw(x,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,b!==null&&b.tag===6?(r(x,b.sibling),b=a(b,w),b.return=x,x=b):(r(x,b),b=dP(w,x.mode,j),b.return=x,x=b),s(x)):r(x,b)}return y}var Zv=MV(!0),RV=MV(!1),Vj=xh(null),Wj=null,mv=null,nI=null;function aI(){nI=mv=Wj=null}function oI(e){var t=Vj.current;To(Vj),e._currentValue=t}function nk(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ov(e,t){Wj=e,nI=mv=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Al=!0),e.firstContext=null)}function cd(e){var t=e._currentValue;if(nI!==e)if(e={context:e,memoizedValue:t,next:null},mv===null){if(Wj===null)throw Error(Rr(308));mv=e,Wj.dependencies={lanes:0,firstContext:e}}else mv=mv.next=e;return t}var sp=null;function iI(e){sp===null?sp=[e]:sp.push(e)}function LV(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,iI(t)):(r.next=a.next,a.next=r),t.interleaved=r,Cf(e,n)}function Cf(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var mm=!1;function sI(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $V(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function yf(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Lm(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Va&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Cf(e,r)}return a=n.interleaved,a===null?(t.next=t,iI(n)):(t.next=a.next,a.next=t),n.interleaved=t,Cf(e,r)}function nj(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,H4(e,r)}}function gL(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=s:i=i.next=s,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Hj(e,t,r,n){var a=e.updateQueue;mm=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var c=l,d=c.next;c.next=null,s===null?i=d:s.next=d,s=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==s&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(i!==null){var f=a.baseState;s=0,u=d=c=null,l=i;do{var m=l.lane,h=l.eventTime;if((n&m)===m){u!==null&&(u=u.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=e,g=l;switch(m=t,h=r,g.tag){case 1:if(v=g.payload,typeof v=="function"){f=v.call(h,f,m);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=g.payload,m=typeof v=="function"?v.call(h,f,m):v,m==null)break e;f=Yo({},f,m);break e;case 2:mm=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,m=a.effects,m===null?a.effects=[l]:m.push(l))}else h={eventTime:h,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=h,c=f):u=u.next=h,s|=m;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;m=l,l=m.next,m.next=null,a.lastBaseUpdate=m,a.shared.pending=null}}while(1);if(u===null&&(c=f),a.baseState=c,a.firstBaseUpdate=d,a.lastBaseUpdate=u,t=a.shared.interleaved,t!==null){a=t;do s|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);Bp|=s,e.lanes=s,e.memoizedState=f}}function vL(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Rr(191,a));a.call(n)}}}var R1={},Eu=xh(R1),mb=xh(R1),hb=xh(R1);function lp(e){if(e===R1)throw Error(Rr(174));return e}function lI(e,t){switch(jo(hb,t),jo(mb,e),jo(Eu,R1),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:LE(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=LE(t,e)}To(Eu),jo(Eu,t)}function ex(){To(Eu),To(mb),To(hb)}function FV(e){lp(hb.current);var t=lp(Eu.current),r=LE(t,e.type);t!==r&&(jo(mb,e),jo(Eu,r))}function cI(e){mb.current===e&&(To(Eu),To(mb))}var Wo=xh(0);function Gj(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var aP=[];function dI(){for(var e=0;e<aP.length;e++)aP[e]._workInProgressVersionPrimary=null;aP.length=0}var aj=Lf.ReactCurrentDispatcher,oP=Lf.ReactCurrentBatchConfig,Fp=0,Go=null,qi=null,rs=null,Kj=!1,jy=!1,pb=0,wle=0;function Os(){throw Error(Rr(321))}function uI(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Yd(e[r],t[r]))return!1;return!0}function fI(e,t,r,n,a,i){if(Fp=i,Go=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,aj.current=e===null||e.memoizedState===null?Sle:Cle,e=r(n,a),jy){i=0;do{if(jy=!1,pb=0,25<=i)throw Error(Rr(301));i+=1,rs=qi=null,t.updateQueue=null,aj.current=Ple,e=r(n,a)}while(jy)}if(aj.current=Yj,t=qi!==null&&qi.next!==null,Fp=0,rs=qi=Go=null,Kj=!1,t)throw Error(Rr(300));return e}function mI(){var e=pb!==0;return pb=0,e}function hu(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rs===null?Go.memoizedState=rs=e:rs=rs.next=e,rs}function dd(){if(qi===null){var e=Go.alternate;e=e!==null?e.memoizedState:null}else e=qi.next;var t=rs===null?Go.memoizedState:rs.next;if(t!==null)rs=t,qi=e;else{if(e===null)throw Error(Rr(310));qi=e,e={memoizedState:qi.memoizedState,baseState:qi.baseState,baseQueue:qi.baseQueue,queue:qi.queue,next:null},rs===null?Go.memoizedState=rs=e:rs=rs.next=e}return rs}function gb(e,t){return typeof t=="function"?t(e):t}function iP(e){var t=dd(),r=t.queue;if(r===null)throw Error(Rr(311));r.lastRenderedReducer=e;var n=qi,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var s=a.next;a.next=i.next,i.next=s}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var l=s=null,c=null,d=i;do{var u=d.lane;if((Fp&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var f={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=f,s=n):c=c.next=f,Go.lanes|=u,Bp|=u}d=d.next}while(d!==null&&d!==i);c===null?s=n:c.next=l,Yd(n,t.memoizedState)||(Al=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,Go.lanes|=i,Bp|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function sP(e){var t=dd(),r=t.queue;if(r===null)throw Error(Rr(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var s=a=a.next;do i=e(i,s.action),s=s.next;while(s!==a);Yd(i,t.memoizedState)||(Al=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function BV(){}function qV(e,t){var r=Go,n=dd(),a=t(),i=!Yd(n.memoizedState,a);if(i&&(n.memoizedState=a,Al=!0),n=n.queue,hI(VV.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||rs!==null&&rs.memoizedState.tag&1){if(r.flags|=2048,vb(9,UV.bind(null,r,n,a,t),void 0,null),os===null)throw Error(Rr(349));Fp&30||zV(r,t,a)}return a}function zV(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Go.updateQueue,t===null?(t={lastEffect:null,stores:null},Go.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function UV(e,t,r,n){t.value=r,t.getSnapshot=n,WV(t)&&HV(e)}function VV(e,t,r){return r(function(){WV(t)&&HV(e)})}function WV(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Yd(e,r)}catch{return!0}}function HV(e){var t=Cf(e,1);t!==null&&Ud(t,e,1,-1)}function xL(e){var t=hu();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:gb,lastRenderedState:e},t.queue=e,e=e.dispatch=_le.bind(null,Go,e),[t.memoizedState,e]}function vb(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Go.updateQueue,t===null?(t={lastEffect:null,stores:null},Go.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function GV(){return dd().memoizedState}function oj(e,t,r,n){var a=hu();Go.flags|=e,a.memoizedState=vb(1|t,r,void 0,n===void 0?null:n)}function uS(e,t,r,n){var a=dd();n=n===void 0?null:n;var i=void 0;if(qi!==null){var s=qi.memoizedState;if(i=s.destroy,n!==null&&uI(n,s.deps)){a.memoizedState=vb(t,r,i,n);return}}Go.flags|=e,a.memoizedState=vb(1|t,r,i,n)}function yL(e,t){return oj(8390656,8,e,t)}function hI(e,t){return uS(2048,8,e,t)}function KV(e,t){return uS(4,2,e,t)}function YV(e,t){return uS(4,4,e,t)}function XV(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function JV(e,t,r){return r=r!=null?r.concat([e]):null,uS(4,4,XV.bind(null,t,e),r)}function pI(){}function QV(e,t){var r=dd();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&uI(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function ZV(e,t){var r=dd();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&uI(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function eW(e,t,r){return Fp&21?(Yd(r,t)||(r=oV(),Go.lanes|=r,Bp|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Al=!0),e.memoizedState=r)}function jle(e,t){var r=ao;ao=r!==0&&4>r?r:4,e(!0);var n=oP.transition;oP.transition={};try{e(!1),t()}finally{ao=r,oP.transition=n}}function tW(){return dd().memoizedState}function Nle(e,t,r){var n=Fm(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},rW(e))nW(t,r);else if(r=LV(e,t,r,n),r!==null){var a=hl();Ud(r,e,n,a),aW(r,t,n)}}function _le(e,t,r){var n=Fm(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(rW(e))nW(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var s=t.lastRenderedState,l=i(s,r);if(a.hasEagerState=!0,a.eagerState=l,Yd(l,s)){var c=t.interleaved;c===null?(a.next=a,iI(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}r=LV(e,t,a,n),r!==null&&(a=hl(),Ud(r,e,n,a),aW(r,t,n))}}function rW(e){var t=e.alternate;return e===Go||t!==null&&t===Go}function nW(e,t){jy=Kj=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function aW(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,H4(e,r)}}var Yj={readContext:cd,useCallback:Os,useContext:Os,useEffect:Os,useImperativeHandle:Os,useInsertionEffect:Os,useLayoutEffect:Os,useMemo:Os,useReducer:Os,useRef:Os,useState:Os,useDebugValue:Os,useDeferredValue:Os,useTransition:Os,useMutableSource:Os,useSyncExternalStore:Os,useId:Os,unstable_isNewReconciler:!1},Sle={readContext:cd,useCallback:function(e,t){return hu().memoizedState=[e,t===void 0?null:t],e},useContext:cd,useEffect:yL,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,oj(4194308,4,XV.bind(null,t,e),r)},useLayoutEffect:function(e,t){return oj(4194308,4,e,t)},useInsertionEffect:function(e,t){return oj(4,2,e,t)},useMemo:function(e,t){var r=hu();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=hu();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Nle.bind(null,Go,e),[n.memoizedState,e]},useRef:function(e){var t=hu();return e={current:e},t.memoizedState=e},useState:xL,useDebugValue:pI,useDeferredValue:function(e){return hu().memoizedState=e},useTransition:function(){var e=xL(!1),t=e[0];return e=jle.bind(null,e[1]),hu().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Go,a=hu();if(qo){if(r===void 0)throw Error(Rr(407));r=r()}else{if(r=t(),os===null)throw Error(Rr(349));Fp&30||zV(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,yL(VV.bind(null,n,i,e),[e]),n.flags|=2048,vb(9,UV.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=hu(),t=os.identifierPrefix;if(qo){var r=mf,n=ff;r=(n&~(1<<32-zd(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=pb++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=wle++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Cle={readContext:cd,useCallback:QV,useContext:cd,useEffect:hI,useImperativeHandle:JV,useInsertionEffect:KV,useLayoutEffect:YV,useMemo:ZV,useReducer:iP,useRef:GV,useState:function(){return iP(gb)},useDebugValue:pI,useDeferredValue:function(e){var t=dd();return eW(t,qi.memoizedState,e)},useTransition:function(){var e=iP(gb)[0],t=dd().memoizedState;return[e,t]},useMutableSource:BV,useSyncExternalStore:qV,useId:tW,unstable_isNewReconciler:!1},Ple={readContext:cd,useCallback:QV,useContext:cd,useEffect:hI,useImperativeHandle:JV,useInsertionEffect:KV,useLayoutEffect:YV,useMemo:ZV,useReducer:sP,useRef:GV,useState:function(){return sP(gb)},useDebugValue:pI,useDeferredValue:function(e){var t=dd();return qi===null?t.memoizedState=e:eW(t,qi.memoizedState,e)},useTransition:function(){var e=sP(gb)[0],t=dd().memoizedState;return[e,t]},useMutableSource:BV,useSyncExternalStore:qV,useId:tW,unstable_isNewReconciler:!1};function Ed(e,t){if(e&&e.defaultProps){t=Yo({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function ak(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Yo({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var fS={isMounted:function(e){return(e=e._reactInternals)?lg(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=hl(),a=Fm(e),i=yf(n,a);i.payload=t,r!=null&&(i.callback=r),t=Lm(e,i,a),t!==null&&(Ud(t,e,a,n),nj(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=hl(),a=Fm(e),i=yf(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Lm(e,i,a),t!==null&&(Ud(t,e,a,n),nj(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=hl(),n=Fm(e),a=yf(r,n);a.tag=2,t!=null&&(a.callback=t),t=Lm(e,a,n),t!==null&&(Ud(t,e,n,r),nj(t,e,n))}};function bL(e,t,r,n,a,i,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,s):t.prototype&&t.prototype.isPureReactComponent?!cb(r,n)||!cb(a,i):!0}function oW(e,t,r){var n=!1,a=oh,i=t.contextType;return typeof i=="object"&&i!==null?i=cd(i):(a=Tl(t)?Lp:Ws.current,n=t.contextTypes,i=(n=n!=null)?Jv(e,a):oh),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=fS,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function wL(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&fS.enqueueReplaceState(t,t.state,null)}function ok(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},sI(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=cd(i):(i=Tl(t)?Lp:Ws.current,a.context=Jv(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(ak(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&fS.enqueueReplaceState(a,a.state,null),Hj(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function tx(e,t){try{var r="",n=t;do r+=tse(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function lP(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function ik(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Ale=typeof WeakMap=="function"?WeakMap:Map;function iW(e,t,r){r=yf(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Jj||(Jj=!0,gk=n),ik(e,t)},r}function sW(e,t,r){r=yf(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){ik(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){ik(e,t),typeof n!="function"&&($m===null?$m=new Set([this]):$m.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function jL(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Ale;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=zle.bind(null,e,t,r),t.then(e,e))}function NL(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function _L(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=yf(-1,1),t.tag=2,Lm(r,t,1))),r.lanes|=1),e)}var Ele=Lf.ReactCurrentOwner,Al=!1;function ll(e,t,r,n){t.child=e===null?RV(t,null,r,n):Zv(t,e.child,r,n)}function SL(e,t,r,n,a){r=r.render;var i=t.ref;return Ov(t,a),n=fI(e,t,r,n,i,a),r=mI(),e!==null&&!Al?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Pf(e,t,a)):(qo&&r&&eI(t),t.flags|=1,ll(e,t,n,a),t.child)}function CL(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!NI(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,lW(e,t,i,n,a)):(e=cj(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var s=i.memoizedProps;if(r=r.compare,r=r!==null?r:cb,r(s,n)&&e.ref===t.ref)return Pf(e,t,a)}return t.flags|=1,e=Bm(i,n),e.ref=t.ref,e.return=t,t.child=e}function lW(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(cb(i,n)&&e.ref===t.ref)if(Al=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(Al=!0);else return t.lanes=e.lanes,Pf(e,t,a)}return sk(e,t,r,n,a)}function cW(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},jo(pv,nc),nc|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,jo(pv,nc),nc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,jo(pv,nc),nc|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,jo(pv,nc),nc|=n;return ll(e,t,a,r),t.child}function dW(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function sk(e,t,r,n,a){var i=Tl(r)?Lp:Ws.current;return i=Jv(t,i),Ov(t,a),r=fI(e,t,r,n,i,a),n=mI(),e!==null&&!Al?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Pf(e,t,a)):(qo&&n&&eI(t),t.flags|=1,ll(e,t,r,a),t.child)}function PL(e,t,r,n,a){if(Tl(r)){var i=!0;qj(t)}else i=!1;if(Ov(t,a),t.stateNode===null)ij(e,t),oW(t,r,n),ok(t,r,n,a),n=!0;else if(e===null){var s=t.stateNode,l=t.memoizedProps;s.props=l;var c=s.context,d=r.contextType;typeof d=="object"&&d!==null?d=cd(d):(d=Tl(r)?Lp:Ws.current,d=Jv(t,d));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==n||c!==d)&&wL(t,s,n,d),mm=!1;var m=t.memoizedState;s.state=m,Hj(t,n,s,a),c=t.memoizedState,l!==n||m!==c||Il.current||mm?(typeof u=="function"&&(ak(t,r,u,n),c=t.memoizedState),(l=mm||bL(t,r,l,n,m,c,d))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),s.props=n,s.state=c,s.context=d,n=l):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,$V(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:Ed(t.type,l),s.props=d,f=t.pendingProps,m=s.context,c=r.contextType,typeof c=="object"&&c!==null?c=cd(c):(c=Tl(r)?Lp:Ws.current,c=Jv(t,c));var h=r.getDerivedStateFromProps;(u=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==f||m!==c)&&wL(t,s,n,c),mm=!1,m=t.memoizedState,s.state=m,Hj(t,n,s,a);var v=t.memoizedState;l!==f||m!==v||Il.current||mm?(typeof h=="function"&&(ak(t,r,h,n),v=t.memoizedState),(d=mm||bL(t,r,d,n,m,v,c)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,v,c),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,v,c)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),s.props=n,s.state=v,s.context=c,n=d):(typeof s.componentDidUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),n=!1)}return lk(e,t,r,n,i,a)}function lk(e,t,r,n,a,i){dW(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return a&&fL(t,r,!1),Pf(e,t,i);n=t.stateNode,Ele.current=t;var l=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=Zv(t,e.child,null,i),t.child=Zv(t,null,l,i)):ll(e,t,l,i),t.memoizedState=n.state,a&&fL(t,r,!0),t.child}function uW(e){var t=e.stateNode;t.pendingContext?uL(e,t.pendingContext,t.pendingContext!==t.context):t.context&&uL(e,t.context,!1),lI(e,t.containerInfo)}function AL(e,t,r,n,a){return Qv(),rI(a),t.flags|=256,ll(e,t,r,n),t.child}var ck={dehydrated:null,treeContext:null,retryLane:0};function dk(e){return{baseLanes:e,cachePool:null,transitions:null}}function fW(e,t,r){var n=t.pendingProps,a=Wo.current,i=!1,s=(t.flags&128)!==0,l;if((l=s)||(l=e!==null&&e.memoizedState===null?!1:(a&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),jo(Wo,a&1),e===null)return rk(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,i?(n=t.mode,i=t.child,s={mode:"hidden",children:s},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=pS(s,n,0,null),e=_p(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=dk(r),t.memoizedState=ck,e):gI(t,s));if(a=e.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return kle(e,t,s,n,l,a,r);if(i){i=n.fallback,s=t.mode,a=e.child,l=a.sibling;var c={mode:"hidden",children:n.children};return!(s&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Bm(a,c),n.subtreeFlags=a.subtreeFlags&14680064),l!==null?i=Bm(l,i):(i=_p(i,s,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,s=e.child.memoizedState,s=s===null?dk(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},i.memoizedState=s,i.childLanes=e.childLanes&~r,t.memoizedState=ck,n}return i=e.child,e=i.sibling,n=Bm(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function gI(e,t){return t=pS({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Kw(e,t,r,n){return n!==null&&rI(n),Zv(t,e.child,null,r),e=gI(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function kle(e,t,r,n,a,i,s){if(r)return t.flags&256?(t.flags&=-257,n=lP(Error(Rr(422))),Kw(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=pS({mode:"visible",children:n.children},a,0,null),i=_p(i,a,s,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&Zv(t,e.child,null,s),t.child.memoizedState=dk(s),t.memoizedState=ck,i);if(!(t.mode&1))return Kw(e,t,s,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(Rr(419)),n=lP(i,n,void 0),Kw(e,t,s,n)}if(l=(s&e.childLanes)!==0,Al||l){if(n=os,n!==null){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|s)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Cf(e,a),Ud(n,e,a,-1))}return jI(),n=lP(Error(Rr(421))),Kw(e,t,s,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=Ule.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,cc=Rm(a.nextSibling),mc=t,qo=!0,Dd=null,e!==null&&(Wc[Hc++]=ff,Wc[Hc++]=mf,Wc[Hc++]=$p,ff=e.id,mf=e.overflow,$p=t),t=gI(t,n.children),t.flags|=4096,t)}function EL(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),nk(e.return,t,r)}function cP(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function mW(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(ll(e,t,n.children,r),n=Wo.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&EL(e,r,t);else if(e.tag===19)EL(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(jo(Wo,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Gj(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),cP(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Gj(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}cP(t,!0,r,null,i);break;case"together":cP(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ij(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Pf(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Bp|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Rr(153));if(t.child!==null){for(e=t.child,r=Bm(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Bm(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Ole(e,t,r){switch(t.tag){case 3:uW(t),Qv();break;case 5:FV(t);break;case 1:Tl(t.type)&&qj(t);break;case 4:lI(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;jo(Vj,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(jo(Wo,Wo.current&1),t.flags|=128,null):r&t.child.childLanes?fW(e,t,r):(jo(Wo,Wo.current&1),e=Pf(e,t,r),e!==null?e.sibling:null);jo(Wo,Wo.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return mW(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),jo(Wo,Wo.current),n)break;return null;case 22:case 23:return t.lanes=0,cW(e,t,r)}return Pf(e,t,r)}var hW,uk,pW,gW;hW=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};uk=function(){};pW=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,lp(Eu.current);var i=null;switch(r){case"input":a=TE(e,a),n=TE(e,n),i=[];break;case"select":a=Yo({},a,{value:void 0}),n=Yo({},n,{value:void 0}),i=[];break;case"textarea":a=RE(e,a),n=RE(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Fj)}$E(r,n);var s;r=null;for(d in a)if(!n.hasOwnProperty(d)&&a.hasOwnProperty(d)&&a[d]!=null)if(d==="style"){var l=a[d];for(s in l)l.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(rb.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in n){var c=n[d];if(l=a?.[d],n.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(r||(r={}),r[s]=c[s])}else r||(i||(i=[]),i.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(rb.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Eo("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}r&&(i=i||[]).push("style",r);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};gW=function(e,t,r,n){r!==n&&(t.flags|=4)};function T0(e,t){if(!qo)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Is(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Ile(e,t,r){var n=t.pendingProps;switch(tI(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Is(t),null;case 1:return Tl(t.type)&&Bj(),Is(t),null;case 3:return n=t.stateNode,ex(),To(Il),To(Ws),dI(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Hw(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Dd!==null&&(yk(Dd),Dd=null))),uk(e,t),Is(t),null;case 5:cI(t);var a=lp(hb.current);if(r=t.type,e!==null&&t.stateNode!=null)pW(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Rr(166));return Is(t),null}if(e=lp(Eu.current),Hw(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[vu]=t,n[fb]=i,e=(t.mode&1)!==0,r){case"dialog":Eo("cancel",n),Eo("close",n);break;case"iframe":case"object":case"embed":Eo("load",n);break;case"video":case"audio":for(a=0;a<cy.length;a++)Eo(cy[a],n);break;case"source":Eo("error",n);break;case"img":case"image":case"link":Eo("error",n),Eo("load",n);break;case"details":Eo("toggle",n);break;case"input":$R(n,i),Eo("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Eo("invalid",n);break;case"textarea":BR(n,i),Eo("invalid",n)}$E(r,i),a=null;for(var s in i)if(i.hasOwnProperty(s)){var l=i[s];s==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&Ww(n.textContent,l,e),a=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Ww(n.textContent,l,e),a=["children",""+l]):rb.hasOwnProperty(s)&&l!=null&&s==="onScroll"&&Eo("scroll",n)}switch(r){case"input":Lw(n),FR(n,i,!0);break;case"textarea":Lw(n),qR(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Fj)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=VU(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[vu]=t,e[fb]=n,hW(e,t,!1,!1),t.stateNode=e;e:{switch(s=FE(r,n),r){case"dialog":Eo("cancel",e),Eo("close",e),a=n;break;case"iframe":case"object":case"embed":Eo("load",e),a=n;break;case"video":case"audio":for(a=0;a<cy.length;a++)Eo(cy[a],e);a=n;break;case"source":Eo("error",e),a=n;break;case"img":case"image":case"link":Eo("error",e),Eo("load",e),a=n;break;case"details":Eo("toggle",e),a=n;break;case"input":$R(e,n),a=TE(e,n),Eo("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Yo({},n,{value:void 0}),Eo("invalid",e);break;case"textarea":BR(e,n),a=RE(e,n),Eo("invalid",e);break;default:a=n}$E(r,a),l=a;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?GU(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&WU(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&nb(e,c):typeof c=="number"&&nb(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(rb.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Eo("scroll",e):c!=null&&B4(e,i,c,s))}switch(r){case"input":Lw(e),FR(e,n,!1);break;case"textarea":Lw(e),qR(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ah(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Pv(e,!!n.multiple,i,!1):n.defaultValue!=null&&Pv(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Fj)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Is(t),null;case 6:if(e&&t.stateNode!=null)gW(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Rr(166));if(r=lp(hb.current),lp(Eu.current),Hw(t)){if(n=t.stateNode,r=t.memoizedProps,n[vu]=t,(i=n.nodeValue!==r)&&(e=mc,e!==null))switch(e.tag){case 3:Ww(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ww(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[vu]=t,t.stateNode=n}return Is(t),null;case 13:if(To(Wo),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(qo&&cc!==null&&t.mode&1&&!(t.flags&128))DV(),Qv(),t.flags|=98560,i=!1;else if(i=Hw(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(Rr(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Rr(317));i[vu]=t}else Qv(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Is(t),i=!1}else Dd!==null&&(yk(Dd),Dd=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Wo.current&1?Hi===0&&(Hi=3):jI())),t.updateQueue!==null&&(t.flags|=4),Is(t),null);case 4:return ex(),uk(e,t),e===null&&db(t.stateNode.containerInfo),Is(t),null;case 10:return oI(t.type._context),Is(t),null;case 17:return Tl(t.type)&&Bj(),Is(t),null;case 19:if(To(Wo),i=t.memoizedState,i===null)return Is(t),null;if(n=(t.flags&128)!==0,s=i.rendering,s===null)if(n)T0(i,!1);else{if(Hi!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=Gj(e),s!==null){for(t.flags|=128,T0(i,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,s=i.alternate,s===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,e=s.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return jo(Wo,Wo.current&1|2),t.child}e=e.sibling}i.tail!==null&&ui()>rx&&(t.flags|=128,n=!0,T0(i,!1),t.lanes=4194304)}else{if(!n)if(e=Gj(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),T0(i,!0),i.tail===null&&i.tailMode==="hidden"&&!s.alternate&&!qo)return Is(t),null}else 2*ui()-i.renderingStartTime>rx&&r!==1073741824&&(t.flags|=128,n=!0,T0(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(r=i.last,r!==null?r.sibling=s:t.child=s,i.last=s)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=ui(),t.sibling=null,r=Wo.current,jo(Wo,n?r&1|2:r&1),t):(Is(t),null);case 22:case 23:return wI(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?nc&1073741824&&(Is(t),t.subtreeFlags&6&&(t.flags|=8192)):Is(t),null;case 24:return null;case 25:return null}throw Error(Rr(156,t.tag))}function Tle(e,t){switch(tI(t),t.tag){case 1:return Tl(t.type)&&Bj(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ex(),To(Il),To(Ws),dI(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return cI(t),null;case 13:if(To(Wo),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Rr(340));Qv()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return To(Wo),null;case 4:return ex(),null;case 10:return oI(t.type._context),null;case 22:case 23:return wI(),null;case 24:return null;default:return null}}var Yw=!1,qs=!1,Dle=typeof WeakSet=="function"?WeakSet:Set,un=null;function hv(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){ti(e,t,n)}else r.current=null}function fk(e,t,r){try{r()}catch(n){ti(e,t,n)}}var kL=!1;function Mle(e,t){if(YE=Rj,e=wV(),Z4(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var s=0,l=-1,c=-1,d=0,u=0,f=e,m=null;t:for(;;){for(var h;f!==r||a!==0&&f.nodeType!==3||(l=s+a),f!==i||n!==0&&f.nodeType!==3||(c=s+n),f.nodeType===3&&(s+=f.nodeValue.length),(h=f.firstChild)!==null;)m=f,f=h;for(;;){if(f===e)break t;if(m===r&&++d===a&&(l=s),m===i&&++u===n&&(c=s),(h=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(XE={focusedElem:e,selectionRange:r},Rj=!1,un=t;un!==null;)if(t=un,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,un=e;else for(;un!==null;){t=un;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var g=v.memoizedProps,y=v.memoizedState,x=t.stateNode,b=x.getSnapshotBeforeUpdate(t.elementType===t.type?g:Ed(t.type,g),y);x.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Rr(163))}}catch(j){ti(t,t.return,j)}if(e=t.sibling,e!==null){e.return=t.return,un=e;break}un=t.return}return v=kL,kL=!1,v}function Ny(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&fk(t,r,i)}a=a.next}while(a!==n)}}function mS(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function mk(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function vW(e){var t=e.alternate;t!==null&&(e.alternate=null,vW(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[vu],delete t[fb],delete t[ZE],delete t[vle],delete t[xle])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function xW(e){return e.tag===5||e.tag===3||e.tag===4}function OL(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||xW(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function hk(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Fj));else if(n!==4&&(e=e.child,e!==null))for(hk(e,t,r),e=e.sibling;e!==null;)hk(e,t,r),e=e.sibling}function pk(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(pk(e,t,r),e=e.sibling;e!==null;)pk(e,t,r),e=e.sibling}var ws=null,kd=!1;function Zf(e,t,r){for(r=r.child;r!==null;)yW(e,t,r),r=r.sibling}function yW(e,t,r){if(Au&&typeof Au.onCommitFiberUnmount=="function")try{Au.onCommitFiberUnmount(oS,r)}catch{}switch(r.tag){case 5:qs||hv(r,t);case 6:var n=ws,a=kd;ws=null,Zf(e,t,r),ws=n,kd=a,ws!==null&&(kd?(e=ws,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):ws.removeChild(r.stateNode));break;case 18:ws!==null&&(kd?(e=ws,r=r.stateNode,e.nodeType===8?rP(e.parentNode,r):e.nodeType===1&&rP(e,r),sb(e)):rP(ws,r.stateNode));break;case 4:n=ws,a=kd,ws=r.stateNode.containerInfo,kd=!0,Zf(e,t,r),ws=n,kd=a;break;case 0:case 11:case 14:case 15:if(!qs&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,s=i.destroy;i=i.tag,s!==void 0&&(i&2||i&4)&&fk(r,t,s),a=a.next}while(a!==n)}Zf(e,t,r);break;case 1:if(!qs&&(hv(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){ti(r,t,l)}Zf(e,t,r);break;case 21:Zf(e,t,r);break;case 22:r.mode&1?(qs=(n=qs)||r.memoizedState!==null,Zf(e,t,r),qs=n):Zf(e,t,r);break;default:Zf(e,t,r)}}function IL(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Dle),t.forEach(function(n){var a=Vle.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Nd(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,s=t,l=s;e:for(;l!==null;){switch(l.tag){case 5:ws=l.stateNode,kd=!1;break e;case 3:ws=l.stateNode.containerInfo,kd=!0;break e;case 4:ws=l.stateNode.containerInfo,kd=!0;break e}l=l.return}if(ws===null)throw Error(Rr(160));yW(i,s,a),ws=null,kd=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(d){ti(a,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)bW(t,e),t=t.sibling}function bW(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Nd(t,e),lu(e),n&4){try{Ny(3,e,e.return),mS(3,e)}catch(g){ti(e,e.return,g)}try{Ny(5,e,e.return)}catch(g){ti(e,e.return,g)}}break;case 1:Nd(t,e),lu(e),n&512&&r!==null&&hv(r,r.return);break;case 5:if(Nd(t,e),lu(e),n&512&&r!==null&&hv(r,r.return),e.flags&32){var a=e.stateNode;try{nb(a,"")}catch(g){ti(e,e.return,g)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,s=r!==null?r.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&zU(a,i),FE(l,s);var d=FE(l,i);for(s=0;s<c.length;s+=2){var u=c[s],f=c[s+1];u==="style"?GU(a,f):u==="dangerouslySetInnerHTML"?WU(a,f):u==="children"?nb(a,f):B4(a,u,f,d)}switch(l){case"input":DE(a,i);break;case"textarea":UU(a,i);break;case"select":var m=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?Pv(a,!!i.multiple,h,!1):m!==!!i.multiple&&(i.defaultValue!=null?Pv(a,!!i.multiple,i.defaultValue,!0):Pv(a,!!i.multiple,i.multiple?[]:"",!1))}a[fb]=i}catch(g){ti(e,e.return,g)}}break;case 6:if(Nd(t,e),lu(e),n&4){if(e.stateNode===null)throw Error(Rr(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(g){ti(e,e.return,g)}}break;case 3:if(Nd(t,e),lu(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{sb(t.containerInfo)}catch(g){ti(e,e.return,g)}break;case 4:Nd(t,e),lu(e);break;case 13:Nd(t,e),lu(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(yI=ui())),n&4&&IL(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(qs=(d=qs)||u,Nd(t,e),qs=d):Nd(t,e),lu(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(un=e,u=e.child;u!==null;){for(f=un=u;un!==null;){switch(m=un,h=m.child,m.tag){case 0:case 11:case 14:case 15:Ny(4,m,m.return);break;case 1:hv(m,m.return);var v=m.stateNode;if(typeof v.componentWillUnmount=="function"){n=m,r=m.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(g){ti(n,r,g)}}break;case 5:hv(m,m.return);break;case 22:if(m.memoizedState!==null){DL(f);continue}}h!==null?(h.return=m,un=h):DL(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{a=f.stateNode,d?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=f.stateNode,c=f.memoizedProps.style,s=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=HU("display",s))}catch(g){ti(e,e.return,g)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(g){ti(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Nd(t,e),lu(e),n&4&&IL(e);break;case 21:break;default:Nd(t,e),lu(e)}}function lu(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(xW(r)){var n=r;break e}r=r.return}throw Error(Rr(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(nb(a,""),n.flags&=-33);var i=OL(e);pk(e,i,a);break;case 3:case 4:var s=n.stateNode.containerInfo,l=OL(e);hk(e,l,s);break;default:throw Error(Rr(161))}}catch(c){ti(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Rle(e,t,r){un=e,wW(e)}function wW(e,t,r){for(var n=(e.mode&1)!==0;un!==null;){var a=un,i=a.child;if(a.tag===22&&n){var s=a.memoizedState!==null||Yw;if(!s){var l=a.alternate,c=l!==null&&l.memoizedState!==null||qs;l=Yw;var d=qs;if(Yw=s,(qs=c)&&!d)for(un=a;un!==null;)s=un,c=s.child,s.tag===22&&s.memoizedState!==null?ML(a):c!==null?(c.return=s,un=c):ML(a);for(;i!==null;)un=i,wW(i),i=i.sibling;un=a,Yw=l,qs=d}TL(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,un=i):TL(e)}}function TL(e){for(;un!==null;){var t=un;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:qs||mS(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!qs)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Ed(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&vL(t,i,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}vL(t,s,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&sb(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Rr(163))}qs||t.flags&512&&mk(t)}catch(m){ti(t,t.return,m)}}if(t===e){un=null;break}if(r=t.sibling,r!==null){r.return=t.return,un=r;break}un=t.return}}function DL(e){for(;un!==null;){var t=un;if(t===e){un=null;break}var r=t.sibling;if(r!==null){r.return=t.return,un=r;break}un=t.return}}function ML(e){for(;un!==null;){var t=un;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{mS(4,t)}catch(c){ti(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(c){ti(t,a,c)}}var i=t.return;try{mk(t)}catch(c){ti(t,i,c)}break;case 5:var s=t.return;try{mk(t)}catch(c){ti(t,s,c)}}}catch(c){ti(t,t.return,c)}if(t===e){un=null;break}var l=t.sibling;if(l!==null){l.return=t.return,un=l;break}un=t.return}}var Lle=Math.ceil,Xj=Lf.ReactCurrentDispatcher,vI=Lf.ReactCurrentOwner,id=Lf.ReactCurrentBatchConfig,Va=0,os=null,Pi=null,_s=0,nc=0,pv=xh(0),Hi=0,xb=null,Bp=0,hS=0,xI=0,_y=null,Cl=null,yI=0,rx=1/0,af=null,Jj=!1,gk=null,$m=null,Xw=!1,_m=null,Qj=0,Sy=0,vk=null,sj=-1,lj=0;function hl(){return Va&6?ui():sj!==-1?sj:sj=ui()}function Fm(e){return e.mode&1?Va&2&&_s!==0?_s&-_s:ble.transition!==null?(lj===0&&(lj=oV()),lj):(e=ao,e!==0||(e=window.event,e=e===void 0?16:fV(e.type)),e):1}function Ud(e,t,r,n){if(50<Sy)throw Sy=0,vk=null,Error(Rr(185));T1(e,r,n),(!(Va&2)||e!==os)&&(e===os&&(!(Va&2)&&(hS|=r),Hi===4&&xm(e,_s)),Dl(e,n),r===1&&Va===0&&!(t.mode&1)&&(rx=ui()+500,dS&&yh()))}function Dl(e,t){var r=e.callbackNode;bse(e,t);var n=Mj(e,e===os?_s:0);if(n===0)r!==null&&VR(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&VR(r),t===1)e.tag===0?yle(RL.bind(null,e)):OV(RL.bind(null,e)),ple(function(){!(Va&6)&&yh()}),r=null;else{switch(iV(n)){case 1:r=W4;break;case 4:r=nV;break;case 16:r=Dj;break;case 536870912:r=aV;break;default:r=Dj}r=EW(r,jW.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function jW(e,t){if(sj=-1,lj=0,Va&6)throw Error(Rr(327));var r=e.callbackNode;if(Iv()&&e.callbackNode!==r)return null;var n=Mj(e,e===os?_s:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Zj(e,n);else{t=n;var a=Va;Va|=2;var i=_W();(os!==e||_s!==t)&&(af=null,rx=ui()+500,Np(e,t));do try{Ble();break}catch(l){NW(e,l)}while(1);aI(),Xj.current=i,Va=a,Pi!==null?t=0:(os=null,_s=0,t=Hi)}if(t!==0){if(t===2&&(a=VE(e),a!==0&&(n=a,t=xk(e,a))),t===1)throw r=xb,Np(e,0),xm(e,n),Dl(e,ui()),r;if(t===6)xm(e,n);else{if(a=e.current.alternate,!(n&30)&&!$le(a)&&(t=Zj(e,n),t===2&&(i=VE(e),i!==0&&(n=i,t=xk(e,i))),t===1))throw r=xb,Np(e,0),xm(e,n),Dl(e,ui()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(Rr(345));case 2:Wh(e,Cl,af);break;case 3:if(xm(e,n),(n&130023424)===n&&(t=yI+500-ui(),10<t)){if(Mj(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){hl(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=QE(Wh.bind(null,e,Cl,af),t);break}Wh(e,Cl,af);break;case 4:if(xm(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var s=31-zd(n);i=1<<s,s=t[s],s>a&&(a=s),n&=~i}if(n=a,n=ui()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Lle(n/1960))-n,10<n){e.timeoutHandle=QE(Wh.bind(null,e,Cl,af),n);break}Wh(e,Cl,af);break;case 5:Wh(e,Cl,af);break;default:throw Error(Rr(329))}}}return Dl(e,ui()),e.callbackNode===r?jW.bind(null,e):null}function xk(e,t){var r=_y;return e.current.memoizedState.isDehydrated&&(Np(e,t).flags|=256),e=Zj(e,t),e!==2&&(t=Cl,Cl=r,t!==null&&yk(t)),e}function yk(e){Cl===null?Cl=e:Cl.push.apply(Cl,e)}function $le(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!Yd(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function xm(e,t){for(t&=~xI,t&=~hS,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-zd(t),n=1<<r;e[r]=-1,t&=~n}}function RL(e){if(Va&6)throw Error(Rr(327));Iv();var t=Mj(e,0);if(!(t&1))return Dl(e,ui()),null;var r=Zj(e,t);if(e.tag!==0&&r===2){var n=VE(e);n!==0&&(t=n,r=xk(e,n))}if(r===1)throw r=xb,Np(e,0),xm(e,t),Dl(e,ui()),r;if(r===6)throw Error(Rr(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Wh(e,Cl,af),Dl(e,ui()),null}function bI(e,t){var r=Va;Va|=1;try{return e(t)}finally{Va=r,Va===0&&(rx=ui()+500,dS&&yh())}}function qp(e){_m!==null&&_m.tag===0&&!(Va&6)&&Iv();var t=Va;Va|=1;var r=id.transition,n=ao;try{if(id.transition=null,ao=1,e)return e()}finally{ao=n,id.transition=r,Va=t,!(Va&6)&&yh()}}function wI(){nc=pv.current,To(pv)}function Np(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,hle(r)),Pi!==null)for(r=Pi.return;r!==null;){var n=r;switch(tI(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Bj();break;case 3:ex(),To(Il),To(Ws),dI();break;case 5:cI(n);break;case 4:ex();break;case 13:To(Wo);break;case 19:To(Wo);break;case 10:oI(n.type._context);break;case 22:case 23:wI()}r=r.return}if(os=e,Pi=e=Bm(e.current,null),_s=nc=t,Hi=0,xb=null,xI=hS=Bp=0,Cl=_y=null,sp!==null){for(t=0;t<sp.length;t++)if(r=sp[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var s=i.next;i.next=a,n.next=s}r.pending=n}sp=null}return e}function NW(e,t){do{var r=Pi;try{if(aI(),aj.current=Yj,Kj){for(var n=Go.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Kj=!1}if(Fp=0,rs=qi=Go=null,jy=!1,pb=0,vI.current=null,r===null||r.return===null){Hi=1,xb=t,Pi=null;break}e:{var i=e,s=r.return,l=r,c=t;if(t=_s,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=NL(s);if(h!==null){h.flags&=-257,_L(h,s,l,i,t),h.mode&1&&jL(i,d,t),t=h,c=d;var v=t.updateQueue;if(v===null){var g=new Set;g.add(c),t.updateQueue=g}else v.add(c);break e}else{if(!(t&1)){jL(i,d,t),jI();break e}c=Error(Rr(426))}}else if(qo&&l.mode&1){var y=NL(s);if(y!==null){!(y.flags&65536)&&(y.flags|=256),_L(y,s,l,i,t),rI(tx(c,l));break e}}i=c=tx(c,l),Hi!==4&&(Hi=2),_y===null?_y=[i]:_y.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var x=iW(i,c,t);gL(i,x);break e;case 1:l=c;var b=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&($m===null||!$m.has(w)))){i.flags|=65536,t&=-t,i.lanes|=t;var j=sW(i,l,t);gL(i,j);break e}}i=i.return}while(i!==null)}CW(r)}catch(_){t=_,Pi===r&&r!==null&&(Pi=r=r.return);continue}break}while(1)}function _W(){var e=Xj.current;return Xj.current=Yj,e===null?Yj:e}function jI(){(Hi===0||Hi===3||Hi===2)&&(Hi=4),os===null||!(Bp&268435455)&&!(hS&268435455)||xm(os,_s)}function Zj(e,t){var r=Va;Va|=2;var n=_W();(os!==e||_s!==t)&&(af=null,Np(e,t));do try{Fle();break}catch(a){NW(e,a)}while(1);if(aI(),Va=r,Xj.current=n,Pi!==null)throw Error(Rr(261));return os=null,_s=0,Hi}function Fle(){for(;Pi!==null;)SW(Pi)}function Ble(){for(;Pi!==null&&!use();)SW(Pi)}function SW(e){var t=AW(e.alternate,e,nc);e.memoizedProps=e.pendingProps,t===null?CW(e):Pi=t,vI.current=null}function CW(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Tle(r,t),r!==null){r.flags&=32767,Pi=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Hi=6,Pi=null;return}}else if(r=Ile(r,t,nc),r!==null){Pi=r;return}if(t=t.sibling,t!==null){Pi=t;return}Pi=t=e}while(t!==null);Hi===0&&(Hi=5)}function Wh(e,t,r){var n=ao,a=id.transition;try{id.transition=null,ao=1,qle(e,t,r,n)}finally{id.transition=a,ao=n}return null}function qle(e,t,r,n){do Iv();while(_m!==null);if(Va&6)throw Error(Rr(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Rr(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(wse(e,i),e===os&&(Pi=os=null,_s=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Xw||(Xw=!0,EW(Dj,function(){return Iv(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=id.transition,id.transition=null;var s=ao;ao=1;var l=Va;Va|=4,vI.current=null,Mle(e,r),bW(r,e),sle(XE),Rj=!!YE,XE=YE=null,e.current=r,Rle(r),fse(),Va=l,ao=s,id.transition=i}else e.current=r;if(Xw&&(Xw=!1,_m=e,Qj=a),i=e.pendingLanes,i===0&&($m=null),pse(r.stateNode),Dl(e,ui()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Jj)throw Jj=!1,e=gk,gk=null,e;return Qj&1&&e.tag!==0&&Iv(),i=e.pendingLanes,i&1?e===vk?Sy++:(Sy=0,vk=e):Sy=0,yh(),null}function Iv(){if(_m!==null){var e=iV(Qj),t=id.transition,r=ao;try{if(id.transition=null,ao=16>e?16:e,_m===null)var n=!1;else{if(e=_m,_m=null,Qj=0,Va&6)throw Error(Rr(331));var a=Va;for(Va|=4,un=e.current;un!==null;){var i=un,s=i.child;if(un.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(un=d;un!==null;){var u=un;switch(u.tag){case 0:case 11:case 15:Ny(8,u,i)}var f=u.child;if(f!==null)f.return=u,un=f;else for(;un!==null;){u=un;var m=u.sibling,h=u.return;if(vW(u),u===d){un=null;break}if(m!==null){m.return=h,un=m;break}un=h}}}var v=i.alternate;if(v!==null){var g=v.child;if(g!==null){v.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}un=i}}if(i.subtreeFlags&2064&&s!==null)s.return=i,un=s;else e:for(;un!==null;){if(i=un,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ny(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,un=x;break e}un=i.return}}var b=e.current;for(un=b;un!==null;){s=un;var w=s.child;if(s.subtreeFlags&2064&&w!==null)w.return=s,un=w;else e:for(s=b;un!==null;){if(l=un,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:mS(9,l)}}catch(_){ti(l,l.return,_)}if(l===s){un=null;break e}var j=l.sibling;if(j!==null){j.return=l.return,un=j;break e}un=l.return}}if(Va=a,yh(),Au&&typeof Au.onPostCommitFiberRoot=="function")try{Au.onPostCommitFiberRoot(oS,e)}catch{}n=!0}return n}finally{ao=r,id.transition=t}}return!1}function LL(e,t,r){t=tx(r,t),t=iW(e,t,1),e=Lm(e,t,1),t=hl(),e!==null&&(T1(e,1,t),Dl(e,t))}function ti(e,t,r){if(e.tag===3)LL(e,e,r);else for(;t!==null;){if(t.tag===3){LL(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&($m===null||!$m.has(n))){e=tx(r,e),e=sW(t,e,1),t=Lm(t,e,1),e=hl(),t!==null&&(T1(t,1,e),Dl(t,e));break}}t=t.return}}function zle(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=hl(),e.pingedLanes|=e.suspendedLanes&r,os===e&&(_s&r)===r&&(Hi===4||Hi===3&&(_s&130023424)===_s&&500>ui()-yI?Np(e,0):xI|=r),Dl(e,t)}function PW(e,t){t===0&&(e.mode&1?(t=Bw,Bw<<=1,!(Bw&130023424)&&(Bw=4194304)):t=1);var r=hl();e=Cf(e,t),e!==null&&(T1(e,t,r),Dl(e,r))}function Ule(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),PW(e,r)}function Vle(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Rr(314))}n!==null&&n.delete(t),PW(e,r)}var AW;AW=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Il.current)Al=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Al=!1,Ole(e,t,r);Al=!!(e.flags&131072)}else Al=!1,qo&&t.flags&1048576&&IV(t,Uj,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;ij(e,t),e=t.pendingProps;var a=Jv(t,Ws.current);Ov(t,r),a=fI(null,t,n,e,a,r);var i=mI();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Tl(n)?(i=!0,qj(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,sI(t),a.updater=fS,t.stateNode=a,a._reactInternals=t,ok(t,n,e,r),t=lk(null,t,n,!0,i,r)):(t.tag=0,qo&&i&&eI(t),ll(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(ij(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=Hle(n),e=Ed(n,e),a){case 0:t=sk(null,t,n,e,r);break e;case 1:t=PL(null,t,n,e,r);break e;case 11:t=SL(null,t,n,e,r);break e;case 14:t=CL(null,t,n,Ed(n.type,e),r);break e}throw Error(Rr(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ed(n,a),sk(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ed(n,a),PL(e,t,n,a,r);case 3:e:{if(uW(t),e===null)throw Error(Rr(387));n=t.pendingProps,i=t.memoizedState,a=i.element,$V(e,t),Hj(t,n,null,r);var s=t.memoizedState;if(n=s.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=tx(Error(Rr(423)),t),t=AL(e,t,n,r,a);break e}else if(n!==a){a=tx(Error(Rr(424)),t),t=AL(e,t,n,r,a);break e}else for(cc=Rm(t.stateNode.containerInfo.firstChild),mc=t,qo=!0,Dd=null,r=RV(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Qv(),n===a){t=Pf(e,t,r);break e}ll(e,t,n,r)}t=t.child}return t;case 5:return FV(t),e===null&&rk(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,s=a.children,JE(n,a)?s=null:i!==null&&JE(n,i)&&(t.flags|=32),dW(e,t),ll(e,t,s,r),t.child;case 6:return e===null&&rk(t),null;case 13:return fW(e,t,r);case 4:return lI(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Zv(t,null,n,r):ll(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ed(n,a),SL(e,t,n,a,r);case 7:return ll(e,t,t.pendingProps,r),t.child;case 8:return ll(e,t,t.pendingProps.children,r),t.child;case 12:return ll(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,s=a.value,jo(Vj,n._currentValue),n._currentValue=s,i!==null)if(Yd(i.value,s)){if(i.children===a.children&&!Il.current){t=Pf(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){s=i.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=yf(-1,r&-r),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),nk(i.return,r,t),l.lanes|=r;break}c=c.next}}else if(i.tag===10)s=i.type===t.type?null:i.child;else if(i.tag===18){if(s=i.return,s===null)throw Error(Rr(341));s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),nk(s,r,t),s=i.sibling}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===t){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}ll(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Ov(t,r),a=cd(a),n=n(a),t.flags|=1,ll(e,t,n,r),t.child;case 14:return n=t.type,a=Ed(n,t.pendingProps),a=Ed(n.type,a),CL(e,t,n,a,r);case 15:return lW(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ed(n,a),ij(e,t),t.tag=1,Tl(n)?(e=!0,qj(t)):e=!1,Ov(t,r),oW(t,n,a),ok(t,n,a,r),lk(null,t,n,!0,e,r);case 19:return mW(e,t,r);case 22:return cW(e,t,r)}throw Error(Rr(156,t.tag))};function EW(e,t){return rV(e,t)}function Wle(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function td(e,t,r,n){return new Wle(e,t,r,n)}function NI(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Hle(e){if(typeof e=="function")return NI(e)?1:0;if(e!=null){if(e=e.$$typeof,e===z4)return 11;if(e===U4)return 14}return 2}function Bm(e,t){var r=e.alternate;return r===null?(r=td(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function cj(e,t,r,n,a,i){var s=2;if(n=e,typeof e=="function")NI(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case ov:return _p(r.children,a,i,t);case q4:s=8,a|=8;break;case EE:return e=td(12,r,t,a|2),e.elementType=EE,e.lanes=i,e;case kE:return e=td(13,r,t,a),e.elementType=kE,e.lanes=i,e;case OE:return e=td(19,r,t,a),e.elementType=OE,e.lanes=i,e;case FU:return pS(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case LU:s=10;break e;case $U:s=9;break e;case z4:s=11;break e;case U4:s=14;break e;case fm:s=16,n=null;break e}throw Error(Rr(130,e==null?e:typeof e,""))}return t=td(s,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function _p(e,t,r,n){return e=td(7,e,n,t),e.lanes=r,e}function pS(e,t,r,n){return e=td(22,e,n,t),e.elementType=FU,e.lanes=r,e.stateNode={isHidden:!1},e}function dP(e,t,r){return e=td(6,e,null,t),e.lanes=r,e}function uP(e,t,r){return t=td(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Gle(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=W5(0),this.expirationTimes=W5(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=W5(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function _I(e,t,r,n,a,i,s,l,c){return e=new Gle(e,t,r,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=td(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},sI(i),e}function Kle(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:av,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function kW(e){if(!e)return oh;e=e._reactInternals;e:{if(lg(e)!==e||e.tag!==1)throw Error(Rr(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Tl(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Rr(171))}if(e.tag===1){var r=e.type;if(Tl(r))return kV(e,r,t)}return t}function OW(e,t,r,n,a,i,s,l,c){return e=_I(r,n,!0,e,a,i,s,l,c),e.context=kW(null),r=e.current,n=hl(),a=Fm(r),i=yf(n,a),i.callback=t??null,Lm(r,i,a),e.current.lanes=a,T1(e,a,n),Dl(e,n),e}function gS(e,t,r,n){var a=t.current,i=hl(),s=Fm(a);return r=kW(r),t.context===null?t.context=r:t.pendingContext=r,t=yf(i,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Lm(a,t,s),e!==null&&(Ud(e,a,s,i),nj(e,a,s)),s}function eN(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function $L(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function SI(e,t){$L(e,t),(e=e.alternate)&&$L(e,t)}function Yle(){return null}var IW=typeof reportError=="function"?reportError:function(e){console.error(e)};function CI(e){this._internalRoot=e}vS.prototype.render=CI.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Rr(409));gS(e,t,null,null)};vS.prototype.unmount=CI.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;qp(function(){gS(null,e,null,null)}),t[Sf]=null}};function vS(e){this._internalRoot=e}vS.prototype.unstable_scheduleHydration=function(e){if(e){var t=cV();e={blockedOn:null,target:e,priority:t};for(var r=0;r<vm.length&&t!==0&&t<vm[r].priority;r++);vm.splice(r,0,e),r===0&&uV(e)}};function PI(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function xS(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function FL(){}function Xle(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var d=eN(s);i.call(d)}}var s=OW(t,n,e,0,null,!1,!1,"",FL);return e._reactRootContainer=s,e[Sf]=s.current,db(e.nodeType===8?e.parentNode:e),qp(),s}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var l=n;n=function(){var d=eN(c);l.call(d)}}var c=_I(e,0,!1,null,null,!1,!1,"",FL);return e._reactRootContainer=c,e[Sf]=c.current,db(e.nodeType===8?e.parentNode:e),qp(function(){gS(t,c,r,n)}),c}function yS(e,t,r,n,a){var i=r._reactRootContainer;if(i){var s=i;if(typeof a=="function"){var l=a;a=function(){var c=eN(s);l.call(c)}}gS(t,s,e,a)}else s=Xle(r,t,e,a,n);return eN(s)}sV=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ly(t.pendingLanes);r!==0&&(H4(t,r|1),Dl(t,ui()),!(Va&6)&&(rx=ui()+500,yh()))}break;case 13:qp(function(){var n=Cf(e,1);if(n!==null){var a=hl();Ud(n,e,1,a)}}),SI(e,1)}};G4=function(e){if(e.tag===13){var t=Cf(e,134217728);if(t!==null){var r=hl();Ud(t,e,134217728,r)}SI(e,134217728)}};lV=function(e){if(e.tag===13){var t=Fm(e),r=Cf(e,t);if(r!==null){var n=hl();Ud(r,e,t,n)}SI(e,t)}};cV=function(){return ao};dV=function(e,t){var r=ao;try{return ao=e,t()}finally{ao=r}};qE=function(e,t,r){switch(t){case"input":if(DE(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=cS(n);if(!a)throw Error(Rr(90));qU(n),DE(n,a)}}}break;case"textarea":UU(e,r);break;case"select":t=r.value,t!=null&&Pv(e,!!r.multiple,t,!1)}};XU=bI;JU=qp;var Jle={usingClientEntryPoint:!1,Events:[M1,cv,cS,KU,YU,bI]},D0={findFiberByHostInstance:ip,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Qle={bundleType:D0.bundleType,version:D0.version,rendererPackageName:D0.rendererPackageName,rendererConfig:D0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Lf.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=eV(e),e===null?null:e.stateNode},findFiberByHostInstance:D0.findFiberByHostInstance||Yle,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jw.isDisabled&&Jw.supportsFiber)try{oS=Jw.inject(Qle),Au=Jw}catch{}}Sc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Jle;Sc.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!PI(t))throw Error(Rr(200));return Kle(e,t,null,r)};Sc.createRoot=function(e,t){if(!PI(e))throw Error(Rr(299));var r=!1,n="",a=IW;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=_I(e,1,!1,null,null,r,!1,n,a),e[Sf]=t.current,db(e.nodeType===8?e.parentNode:e),new CI(t)};Sc.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Rr(188)):(e=Object.keys(e).join(","),Error(Rr(268,e)));return e=eV(t),e=e===null?null:e.stateNode,e};Sc.flushSync=function(e){return qp(e)};Sc.hydrate=function(e,t,r){if(!xS(t))throw Error(Rr(200));return yS(null,e,t,!0,r)};Sc.hydrateRoot=function(e,t,r){if(!PI(e))throw Error(Rr(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",s=IW;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=OW(t,null,e,1,r??null,a,!1,i,s),e[Sf]=t.current,db(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new vS(t)};Sc.render=function(e,t,r){if(!xS(t))throw Error(Rr(200));return yS(null,e,t,!1,r)};Sc.unmountComponentAtNode=function(e){if(!xS(e))throw Error(Rr(40));return e._reactRootContainer?(qp(function(){yS(null,null,e,!1,function(){e._reactRootContainer=null,e[Sf]=null})}),!0):!1};Sc.unstable_batchedUpdates=bI;Sc.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!xS(r))throw Error(Rr(200));if(e==null||e._reactInternals===void 0)throw Error(Rr(38));return yS(e,t,r,!1,n)};Sc.version="18.3.1-next-f1338f8080-20240426";function TW(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(TW)}catch(e){console.error(e)}}TW(),TU.exports=Sc;var $f=TU.exports;const DW=qa($f);var BL=$f;PE.createRoot=BL.createRoot,PE.hydrateRoot=BL.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yb(){return yb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yb.apply(this,arguments)}var Sm;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Sm||(Sm={}));const qL="popstate";function Zle(e){e===void 0&&(e={});function t(n,a){let{pathname:i,search:s,hash:l}=n.location;return bk("",{pathname:i,search:s,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:tN(a)}return tce(t,r,null,e)}function Ko(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function MW(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function ece(){return Math.random().toString(36).substr(2,8)}function zL(e,t){return{usr:e.state,key:e.key,idx:t}}function bk(e,t,r,n){return r===void 0&&(r=null),yb({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Hx(t):t,{state:r,key:t&&t.key||n||ece()})}function tN(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Hx(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function tce(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:i=!1}=n,s=a.history,l=Sm.Pop,c=null,d=u();d==null&&(d=0,s.replaceState(yb({},s.state,{idx:d}),""));function u(){return(s.state||{idx:null}).idx}function f(){l=Sm.Pop;let y=u(),x=y==null?null:y-d;d=y,c&&c({action:l,location:g.location,delta:x})}function m(y,x){l=Sm.Push;let b=bk(g.location,y,x);r&&r(b,y),d=u()+1;let w=zL(b,d),j=g.createHref(b);try{s.pushState(w,"",j)}catch(_){if(_ instanceof DOMException&&_.name==="DataCloneError")throw _;a.location.assign(j)}i&&c&&c({action:l,location:g.location,delta:1})}function h(y,x){l=Sm.Replace;let b=bk(g.location,y,x);r&&r(b,y),d=u();let w=zL(b,d),j=g.createHref(b);s.replaceState(w,"",j),i&&c&&c({action:l,location:g.location,delta:0})}function v(y){let x=a.location.origin!=="null"?a.location.origin:a.location.href,b=typeof y=="string"?y:tN(y);return b=b.replace(/ $/,"%20"),Ko(x,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,x)}let g={get action(){return l},get location(){return e(a,s)},listen(y){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(qL,f),c=y,()=>{a.removeEventListener(qL,f),c=null}},createHref(y){return t(a,y)},createURL:v,encodeLocation(y){let x=v(y);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:m,replace:h,go(y){return s.go(y)}};return g}var UL;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(UL||(UL={}));function rce(e,t,r){return r===void 0&&(r="/"),nce(e,t,r,!1)}function nce(e,t,r,n){let a=typeof t=="string"?Hx(t):t,i=nx(a.pathname||"/",r);if(i==null)return null;let s=RW(e);ace(s);let l=null;for(let c=0;l==null&&c<s.length;++c){let d=pce(i);l=mce(s[c],d,n)}return l}function RW(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(i,s,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:s,route:i};c.relativePath.startsWith("/")&&(Ko(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let d=qm([n,c.relativePath]),u=r.concat(c);i.children&&i.children.length>0&&(Ko(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),RW(i.children,t,u,d)),!(i.path==null&&!i.index)&&t.push({path:d,score:uce(d,i.index),routesMeta:u})};return e.forEach((i,s)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))a(i,s);else for(let c of LW(i.path))a(i,s,c)}),t}function LW(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let s=LW(n.join("/")),l=[];return l.push(...s.map(c=>c===""?i:[i,c].join("/"))),a&&l.push(...s),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function ace(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:fce(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const oce=/^:[\w-]+$/,ice=3,sce=2,lce=1,cce=10,dce=-2,VL=e=>e==="*";function uce(e,t){let r=e.split("/"),n=r.length;return r.some(VL)&&(n+=dce),t&&(n+=sce),r.filter(a=>!VL(a)).reduce((a,i)=>a+(oce.test(i)?ice:i===""?lce:cce),n)}function fce(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function mce(e,t,r){r===void 0&&(r=!1);let{routesMeta:n}=e,a={},i="/",s=[];for(let l=0;l<n.length;++l){let c=n[l],d=l===n.length-1,u=i==="/"?t:t.slice(i.length)||"/",f=rN({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),m=c.route;if(!f&&d&&r&&!n[n.length-1].route.index&&(f=rN({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!f)return null;Object.assign(a,f.params),s.push({params:a,pathname:qm([i,f.pathname]),pathnameBase:yce(qm([i,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(i=qm([i,f.pathnameBase]))}return s}function rN(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=hce(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],s=i.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((d,u,f)=>{let{paramName:m,isOptional:h}=u;if(m==="*"){let g=l[f]||"";s=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const v=l[f];return h&&!v?d[m]=void 0:d[m]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:s,pattern:e}}function hce(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),MW(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function pce(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return MW(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function nx(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function gce(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Hx(e):e;return{pathname:r?r.startsWith("/")?r:vce(r,t):t,search:bce(n),hash:wce(a)}}function vce(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function fP(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function xce(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function AI(e,t){let r=xce(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function EI(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=Hx(e):(a=yb({},e),Ko(!a.pathname||!a.pathname.includes("?"),fP("?","pathname","search",a)),Ko(!a.pathname||!a.pathname.includes("#"),fP("#","pathname","hash",a)),Ko(!a.search||!a.search.includes("#"),fP("#","search","hash",a)));let i=e===""||a.pathname==="",s=i?"/":a.pathname,l;if(s==null)l=r;else{let f=t.length-1;if(!n&&s.startsWith("..")){let m=s.split("/");for(;m[0]==="..";)m.shift(),f-=1;a.pathname=m.join("/")}l=f>=0?t[f]:"/"}let c=gce(a,l),d=s&&s!=="/"&&s.endsWith("/"),u=(i||s===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}const qm=e=>e.join("/").replace(/\/\/+/g,"/"),yce=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),bce=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,wce=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function jce(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const $W=["post","put","patch","delete"];new Set($W);const Nce=["get",...$W];new Set(Nce);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bb(){return bb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bb.apply(this,arguments)}const bS=p.createContext(null),FW=p.createContext(null),Ff=p.createContext(null),wS=p.createContext(null),Bf=p.createContext({outlet:null,matches:[],isDataRoute:!1}),BW=p.createContext(null);function _ce(e,t){let{relative:r}=t===void 0?{}:t;Gx()||Ko(!1);let{basename:n,navigator:a}=p.useContext(Ff),{hash:i,pathname:s,search:l}=jS(e,{relative:r}),c=s;return n!=="/"&&(c=s==="/"?n:qm([n,s])),a.createHref({pathname:c,search:l,hash:i})}function Gx(){return p.useContext(wS)!=null}function ls(){return Gx()||Ko(!1),p.useContext(wS).location}function qW(e){p.useContext(Ff).static||p.useLayoutEffect(e)}function Pc(){let{isDataRoute:e}=p.useContext(Bf);return e?$ce():Sce()}function Sce(){Gx()||Ko(!1);let e=p.useContext(bS),{basename:t,future:r,navigator:n}=p.useContext(Ff),{matches:a}=p.useContext(Bf),{pathname:i}=ls(),s=JSON.stringify(AI(a,r.v7_relativeSplatPath)),l=p.useRef(!1);return qW(()=>{l.current=!0}),p.useCallback(function(d,u){if(u===void 0&&(u={}),!l.current)return;if(typeof d=="number"){n.go(d);return}let f=EI(d,JSON.parse(s),i,u.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:qm([t,f.pathname])),(u.replace?n.replace:n.push)(f,u.state,u)},[t,n,s,i,e])}function Cce(){let{matches:e}=p.useContext(Bf),t=e[e.length-1];return t?t.params:{}}function jS(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=p.useContext(Ff),{matches:a}=p.useContext(Bf),{pathname:i}=ls(),s=JSON.stringify(AI(a,n.v7_relativeSplatPath));return p.useMemo(()=>EI(e,JSON.parse(s),i,r==="path"),[e,s,i,r])}function Pce(e,t){return Ace(e,t)}function Ace(e,t,r,n){Gx()||Ko(!1);let{navigator:a}=p.useContext(Ff),{matches:i}=p.useContext(Bf),s=i[i.length-1],l=s?s.params:{};s&&s.pathname;let c=s?s.pathnameBase:"/";s&&s.route;let d=ls(),u;if(t){var f;let y=typeof t=="string"?Hx(t):t;c==="/"||(f=y.pathname)!=null&&f.startsWith(c)||Ko(!1),u=y}else u=d;let m=u.pathname||"/",h=m;if(c!=="/"){let y=c.replace(/^\//,"").split("/");h="/"+m.replace(/^\//,"").split("/").slice(y.length).join("/")}let v=rce(e,{pathname:h}),g=Tce(v&&v.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:qm([c,a.encodeLocation?a.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:qm([c,a.encodeLocation?a.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,r,n);return t&&g?p.createElement(wS.Provider,{value:{location:bb({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Sm.Pop}},g):g}function Ece(){let e=Lce(),t=jce(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return p.createElement(p.Fragment,null,p.createElement("h2",null,"Unexpected Application Error!"),p.createElement("h3",{style:{fontStyle:"italic"}},t),r?p.createElement("pre",{style:a},r):null,i)}const kce=p.createElement(Ece,null);class Oce extends p.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?p.createElement(Bf.Provider,{value:this.props.routeContext},p.createElement(BW.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Ice(e){let{routeContext:t,match:r,children:n}=e,a=p.useContext(bS);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),p.createElement(Bf.Provider,{value:t},n)}function Tce(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let s=e,l=(a=r)==null?void 0:a.errors;if(l!=null){let u=s.findIndex(f=>f.route.id&&l?.[f.route.id]!==void 0);u>=0||Ko(!1),s=s.slice(0,Math.min(s.length,u+1))}let c=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<s.length;u++){let f=s[u];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(d=u),f.route.id){let{loaderData:m,errors:h}=r,v=f.route.loader&&m[f.route.id]===void 0&&(!h||h[f.route.id]===void 0);if(f.route.lazy||v){c=!0,d>=0?s=s.slice(0,d+1):s=[s[0]];break}}}return s.reduceRight((u,f,m)=>{let h,v=!1,g=null,y=null;r&&(h=l&&f.route.id?l[f.route.id]:void 0,g=f.route.errorElement||kce,c&&(d<0&&m===0?(Fce("route-fallback",!1),v=!0,y=null):d===m&&(v=!0,y=f.route.hydrateFallbackElement||null)));let x=t.concat(s.slice(0,m+1)),b=()=>{let w;return h?w=g:v?w=y:f.route.Component?w=p.createElement(f.route.Component,null):f.route.element?w=f.route.element:w=u,p.createElement(Ice,{match:f,routeContext:{outlet:u,matches:x,isDataRoute:r!=null},children:w})};return r&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?p.createElement(Oce,{location:r.location,revalidation:r.revalidation,component:g,error:h,children:b(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):b()},null)}var zW=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(zW||{}),nN=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(nN||{});function Dce(e){let t=p.useContext(bS);return t||Ko(!1),t}function Mce(e){let t=p.useContext(FW);return t||Ko(!1),t}function Rce(e){let t=p.useContext(Bf);return t||Ko(!1),t}function UW(e){let t=Rce(),r=t.matches[t.matches.length-1];return r.route.id||Ko(!1),r.route.id}function Lce(){var e;let t=p.useContext(BW),r=Mce(nN.UseRouteError),n=UW(nN.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function $ce(){let{router:e}=Dce(zW.UseNavigateStable),t=UW(nN.UseNavigateStable),r=p.useRef(!1);return qW(()=>{r.current=!0}),p.useCallback(function(a,i){i===void 0&&(i={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,bb({fromRouteId:t},i)))},[e,t])}const WL={};function Fce(e,t,r){!t&&!WL[e]&&(WL[e]=!0)}function Bce(e,t){e?.v7_startTransition,e?.v7_relativeSplatPath===void 0&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}function qce(e){let{to:t,replace:r,state:n,relative:a}=e;Gx()||Ko(!1);let{future:i,static:s}=p.useContext(Ff),{matches:l}=p.useContext(Bf),{pathname:c}=ls(),d=Pc(),u=EI(t,AI(l,i.v7_relativeSplatPath),c,a==="path"),f=JSON.stringify(u);return p.useEffect(()=>d(JSON.parse(f),{replace:r,state:n,relative:a}),[d,f,a,r,n]),null}function Vo(e){Ko(!1)}function zce(e){let{basename:t="/",children:r=null,location:n,navigationType:a=Sm.Pop,navigator:i,static:s=!1,future:l}=e;Gx()&&Ko(!1);let c=t.replace(/^\/*/,"/"),d=p.useMemo(()=>({basename:c,navigator:i,static:s,future:bb({v7_relativeSplatPath:!1},l)}),[c,l,i,s]);typeof n=="string"&&(n=Hx(n));let{pathname:u="/",search:f="",hash:m="",state:h=null,key:v="default"}=n,g=p.useMemo(()=>{let y=nx(u,c);return y==null?null:{location:{pathname:y,search:f,hash:m,state:h,key:v},navigationType:a}},[c,u,f,m,h,v,a]);return g==null?null:p.createElement(Ff.Provider,{value:d},p.createElement(wS.Provider,{children:r,value:g}))}function VW(e){let{children:t,location:r}=e;return Pce(wk(t),r)}new Promise(()=>{});function wk(e,t){t===void 0&&(t=[]);let r=[];return p.Children.forEach(e,(n,a)=>{if(!p.isValidElement(n))return;let i=[...t,a];if(n.type===p.Fragment){r.push.apply(r,wk(n.props.children,i));return}n.type!==Vo&&Ko(!1),!n.props.index||!n.props.children||Ko(!1);let s={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=wk(n.props.children,i)),r.push(s)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function aN(){return aN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},aN.apply(this,arguments)}function WW(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function Uce(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Vce(e,t){return e.button===0&&(!t||t==="_self")&&!Uce(e)}function jk(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(a=>[r,a]):[[r,n]])},[]))}function Wce(e,t){let r=jk(e);return t&&t.forEach((n,a)=>{r.has(a)||t.getAll(a).forEach(i=>{r.append(a,i)})}),r}const Hce=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Gce=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Kce="6";try{window.__reactRouterVersion=Kce}catch{}const Yce=p.createContext({isTransitioning:!1}),Xce="startTransition",HL=L4[Xce];function Jce(e){let{basename:t,children:r,future:n,window:a}=e,i=p.useRef();i.current==null&&(i.current=Zle({window:a,v5Compat:!0}));let s=i.current,[l,c]=p.useState({action:s.action,location:s.location}),{v7_startTransition:d}=n||{},u=p.useCallback(f=>{d&&HL?HL(()=>c(f)):c(f)},[c,d]);return p.useLayoutEffect(()=>s.listen(u),[s,u]),p.useEffect(()=>Bce(n),[n]),p.createElement(zce,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:s,future:n})}const Qce=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Zce=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,kI=p.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:i,replace:s,state:l,target:c,to:d,preventScrollReset:u,viewTransition:f}=t,m=WW(t,Hce),{basename:h}=p.useContext(Ff),v,g=!1;if(typeof d=="string"&&Zce.test(d)&&(v=d,Qce))try{let w=new URL(window.location.href),j=d.startsWith("//")?new URL(w.protocol+d):new URL(d),_=nx(j.pathname,h);j.origin===w.origin&&_!=null?d=_+j.search+j.hash:g=!0}catch{}let y=_ce(d,{relative:a}),x=tde(d,{replace:s,state:l,target:c,preventScrollReset:u,relative:a,viewTransition:f});function b(w){n&&n(w),w.defaultPrevented||x(w)}return p.createElement("a",aN({},m,{href:v||y,onClick:g||i?n:b,ref:r,target:c}))}),fu=p.forwardRef(function(t,r){let{"aria-current":n="page",caseSensitive:a=!1,className:i="",end:s=!1,style:l,to:c,viewTransition:d,children:u}=t,f=WW(t,Gce),m=jS(c,{relative:f.relative}),h=ls(),v=p.useContext(FW),{navigator:g,basename:y}=p.useContext(Ff),x=v!=null&&rde(m)&&d===!0,b=g.encodeLocation?g.encodeLocation(m).pathname:m.pathname,w=h.pathname,j=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;a||(w=w.toLowerCase(),j=j?j.toLowerCase():null,b=b.toLowerCase()),j&&y&&(j=nx(j,y)||j);const _=b!=="/"&&b.endsWith("/")?b.length-1:b.length;let C=w===b||!s&&w.startsWith(b)&&w.charAt(_)==="/",E=j!=null&&(j===b||!s&&j.startsWith(b)&&j.charAt(b.length)==="/"),P={isActive:C,isPending:E,isTransitioning:x},k=C?n:void 0,M;typeof i=="function"?M=i(P):M=[i,C?"active":null,E?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let S=typeof l=="function"?l(P):l;return p.createElement(kI,aN({},f,{"aria-current":k,className:M,ref:r,style:S,to:c,viewTransition:d}),typeof u=="function"?u(P):u)});var Nk;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Nk||(Nk={}));var GL;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(GL||(GL={}));function ede(e){let t=p.useContext(bS);return t||Ko(!1),t}function tde(e,t){let{target:r,replace:n,state:a,preventScrollReset:i,relative:s,viewTransition:l}=t===void 0?{}:t,c=Pc(),d=ls(),u=jS(e,{relative:s});return p.useCallback(f=>{if(Vce(f,r)){f.preventDefault();let m=n!==void 0?n:tN(d)===tN(u);c(e,{replace:m,state:a,preventScrollReset:i,relative:s,viewTransition:l})}},[d,c,u,n,a,r,e,i,s,l])}function NS(e){let t=p.useRef(jk(e)),r=p.useRef(!1),n=ls(),a=p.useMemo(()=>Wce(n.search,r.current?null:t.current),[n.search]),i=Pc(),s=p.useCallback((l,c)=>{const d=jk(typeof l=="function"?l(a):l);r.current=!0,i("?"+d,c)},[i,a]);return[a,s]}function rde(e,t){t===void 0&&(t={});let r=p.useContext(Yce);r==null&&Ko(!1);let{basename:n}=ede(Nk.useViewTransitionState),a=jS(e,{relative:t.relative});if(!r.isTransitioning)return!1;let i=nx(r.currentLocation.pathname,n)||r.currentLocation.pathname,s=nx(r.nextLocation.pathname,n)||r.nextLocation.pathname;return rN(a.pathname,s)!=null||rN(a.pathname,i)!=null}function HW(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=HW(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function ta(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=HW(e))&&(n&&(n+=" "),n+=t);return n}function nde(){for(var e=0,t,r,n="";e<arguments.length;)(t=arguments[e++])&&(r=GW(t))&&(n&&(n+=" "),n+=r);return n}function GW(e){if(typeof e=="string")return e;for(var t,r="",n=0;n<e.length;n++)e[n]&&(t=GW(e[n]))&&(r&&(r+=" "),r+=t);return r}var OI="-";function ade(e){var t=ide(e),r=e.conflictingClassGroups,n=e.conflictingClassGroupModifiers,a=n===void 0?{}:n;function i(l){var c=l.split(OI);return c[0]===""&&c.length!==1&&c.shift(),KW(c,t)||ode(l)}function s(l,c){var d=r[l]||[];return c&&a[l]?[].concat(d,a[l]):d}return{getClassGroupId:i,getConflictingClassGroupIds:s}}function KW(e,t){if(e.length===0)return t.classGroupId;var r=e[0],n=t.nextPart.get(r),a=n?KW(e.slice(1),n):void 0;if(a)return a;if(t.validators.length!==0){var i=e.join(OI);return t.validators.find(function(s){var l=s.validator;return l(i)})?.classGroupId}}var KL=/^\[(.+)\]$/;function ode(e){if(KL.test(e)){var t=KL.exec(e)[1],r=t?.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}}function ide(e){var t=e.theme,r=e.prefix,n={nextPart:new Map,validators:[]},a=lde(Object.entries(e.classGroups),r);return a.forEach(function(i){var s=i[0],l=i[1];_k(l,n,s,t)}),n}function _k(e,t,r,n){e.forEach(function(a){if(typeof a=="string"){var i=a===""?t:YL(t,a);i.classGroupId=r;return}if(typeof a=="function"){if(sde(a)){_k(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(function(s){var l=s[0],c=s[1];_k(c,YL(t,l),r,n)})})}function YL(e,t){var r=e;return t.split(OI).forEach(function(n){r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r}function sde(e){return e.isThemeGetter}function lde(e,t){return t?e.map(function(r){var n=r[0],a=r[1],i=a.map(function(s){return typeof s=="string"?t+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(function(l){var c=l[0],d=l[1];return[t+c,d]})):s});return[n,i]}):e}function cde(e){if(e<1)return{get:function(){},set:function(){}};var t=0,r=new Map,n=new Map;function a(i,s){r.set(i,s),t++,t>e&&(t=0,n=r,r=new Map)}return{get:function(s){var l=r.get(s);if(l!==void 0)return l;if((l=n.get(s))!==void 0)return a(s,l),l},set:function(s,l){r.has(s)?r.set(s,l):a(s,l)}}}var YW="!";function dde(e){var t=e.separator||":",r=t.length===1,n=t[0],a=t.length;return function(s){for(var l=[],c=0,d=0,u,f=0;f<s.length;f++){var m=s[f];if(c===0){if(m===n&&(r||s.slice(f,f+a)===t)){l.push(s.slice(d,f)),d=f+a;continue}if(m==="/"){u=f;continue}}m==="["?c++:m==="]"&&c--}var h=l.length===0?s:s.substring(d),v=h.startsWith(YW),g=v?h.substring(1):h,y=u&&u>d?u-d:void 0;return{modifiers:l,hasImportantModifier:v,baseClassName:g,maybePostfixModifierPosition:y}}}function ude(e){if(e.length<=1)return e;var t=[],r=[];return e.forEach(function(n){var a=n[0]==="[";a?(t.push.apply(t,r.sort().concat([n])),r=[]):r.push(n)}),t.push.apply(t,r.sort()),t}function fde(e){return{cache:cde(e.cacheSize),splitModifiers:dde(e),...ade(e)}}var mde=/\s+/;function hde(e,t){var r=t.splitModifiers,n=t.getClassGroupId,a=t.getConflictingClassGroupIds,i=new Set;return e.trim().split(mde).map(function(s){var l=r(s),c=l.modifiers,d=l.hasImportantModifier,u=l.baseClassName,f=l.maybePostfixModifierPosition,m=n(f?u.substring(0,f):u),h=!!f;if(!m){if(!f)return{isTailwindClass:!1,originalClassName:s};if(m=n(u),!m)return{isTailwindClass:!1,originalClassName:s};h=!1}var v=ude(c).join(":"),g=d?v+YW:v;return{isTailwindClass:!0,modifierId:g,classGroupId:m,originalClassName:s,hasPostfixModifier:h}}).reverse().filter(function(s){if(!s.isTailwindClass)return!0;var l=s.modifierId,c=s.classGroupId,d=s.hasPostfixModifier,u=l+c;return i.has(u)?!1:(i.add(u),a(c,d).forEach(function(f){return i.add(l+f)}),!0)}).reverse().map(function(s){return s.originalClassName}).join(" ")}function pde(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,a,i,s=l;function l(d){var u=t[0],f=t.slice(1),m=f.reduce(function(h,v){return v(h)},u());return n=fde(m),a=n.cache.get,i=n.cache.set,s=c,c(d)}function c(d){var u=a(d);if(u)return u;var f=hde(d,n);return i(d,f),f}return function(){return s(nde.apply(null,arguments))}}function Ao(e){var t=function(n){return n[e]||[]};return t.isThemeGetter=!0,t}var XW=/^\[(?:([a-z-]+):)?(.+)\]$/i,gde=/^\d+\/\d+$/,vde=new Set(["px","full","screen"]),xde=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,yde=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,bde=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function _d(e){return cp(e)||vde.has(e)||gde.test(e)||Sk(e)}function Sk(e){return cg(e,"length",Cde)}function wde(e){return cg(e,"size",JW)}function jde(e){return cg(e,"position",JW)}function Nde(e){return cg(e,"url",Pde)}function Qw(e){return cg(e,"number",cp)}function cp(e){return!Number.isNaN(Number(e))}function _de(e){return e.endsWith("%")&&cp(e.slice(0,-1))}function M0(e){return XL(e)||cg(e,"number",XL)}function Ca(e){return XW.test(e)}function R0(){return!0}function em(e){return xde.test(e)}function Sde(e){return cg(e,"",Ade)}function cg(e,t,r){var n=XW.exec(e);return n?n[1]?n[1]===t:r(n[2]):!1}function Cde(e){return yde.test(e)}function JW(){return!1}function Pde(e){return e.startsWith("url(")}function XL(e){return Number.isInteger(Number(e))}function Ade(e){return bde.test(e)}function Ede(){var e=Ao("colors"),t=Ao("spacing"),r=Ao("blur"),n=Ao("brightness"),a=Ao("borderColor"),i=Ao("borderRadius"),s=Ao("borderSpacing"),l=Ao("borderWidth"),c=Ao("contrast"),d=Ao("grayscale"),u=Ao("hueRotate"),f=Ao("invert"),m=Ao("gap"),h=Ao("gradientColorStops"),v=Ao("gradientColorStopPositions"),g=Ao("inset"),y=Ao("margin"),x=Ao("opacity"),b=Ao("padding"),w=Ao("saturate"),j=Ao("scale"),_=Ao("sepia"),C=Ao("skew"),E=Ao("space"),P=Ao("translate"),k=function(){return["auto","contain","none"]},M=function(){return["auto","hidden","clip","visible","scroll"]},S=function(){return["auto",Ca,t]},I=function(){return[Ca,t]},T=function(){return["",_d]},D=function(){return["auto",cp,Ca]},B=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},U=function(){return["solid","dashed","dotted","double","none"]},z=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},$=function(){return["start","end","center","between","around","evenly","stretch"]},Y=function(){return["","0",Ca]},de=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},xe=function(){return[cp,Qw]},q=function(){return[cp,Ca]};return{cacheSize:500,theme:{colors:[R0],spacing:[_d],blur:["none","",em,Ca],brightness:xe(),borderColor:[e],borderRadius:["none","","full",em,Ca],borderSpacing:I(),borderWidth:T(),contrast:xe(),grayscale:Y(),hueRotate:q(),invert:Y(),gap:I(),gradientColorStops:[e],gradientColorStopPositions:[_de,Sk],inset:S(),margin:S(),opacity:xe(),padding:I(),saturate:xe(),scale:xe(),sepia:Y(),skew:q(),space:I(),translate:I()},classGroups:{aspect:[{aspect:["auto","square","video",Ca]}],container:["container"],columns:[{columns:[em]}],"break-after":[{"break-after":de()}],"break-before":[{"break-before":de()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(B(),[Ca])}],overflow:[{overflow:M()}],"overflow-x":[{"overflow-x":M()}],"overflow-y":[{"overflow-y":M()}],overscroll:[{overscroll:k()}],"overscroll-x":[{"overscroll-x":k()}],"overscroll-y":[{"overscroll-y":k()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",M0]}],basis:[{basis:S()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ca]}],grow:[{grow:Y()}],shrink:[{shrink:Y()}],order:[{order:["first","last","none",M0]}],"grid-cols":[{"grid-cols":[R0]}],"col-start-end":[{col:["auto",{span:["full",M0]},Ca]}],"col-start":[{"col-start":D()}],"col-end":[{"col-end":D()}],"grid-rows":[{"grid-rows":[R0]}],"row-start-end":[{row:["auto",{span:[M0]},Ca]}],"row-start":[{"row-start":D()}],"row-end":[{"row-end":D()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ca]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ca]}],gap:[{gap:[m]}],"gap-x":[{"gap-x":[m]}],"gap-y":[{"gap-y":[m]}],"justify-content":[{justify:["normal"].concat($())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat($(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat($(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[E]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[E]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",Ca,t]}],"min-w":[{"min-w":["min","max","fit",Ca,_d]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[em]},em,Ca]}],h:[{h:[Ca,t,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",Ca,_d]}],"max-h":[{"max-h":[Ca,t,"min","max","fit"]}],"font-size":[{text:["base",em,Sk]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Qw]}],"font-family":[{font:[R0]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ca]}],"line-clamp":[{"line-clamp":["none",cp,Qw]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ca,_d]}],"list-image":[{"list-image":["none",Ca]}],"list-style-type":[{list:["none","disc","decimal",Ca]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(U(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",_d]}],"underline-offset":[{"underline-offset":["auto",Ca,_d]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:I()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ca]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ca]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(B(),[jde])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",wde]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Nde]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[].concat(U(),["hidden"])}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:U()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:[""].concat(U())}],"outline-offset":[{"outline-offset":[Ca,_d]}],"outline-w":[{outline:[_d]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:T()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[_d]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",em,Sde]}],"shadow-color":[{shadow:[R0]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":z()}],"bg-blend":[{"bg-blend":z()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",em,Ca]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[f]}],saturate:[{saturate:[w]}],sepia:[{sepia:[_]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[_]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ca]}],duration:[{duration:q()}],ease:[{ease:["linear","in","out","in-out",Ca]}],delay:[{delay:q()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ca]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[j]}],"scale-x":[{"scale-x":[j]}],"scale-y":[{"scale-y":[j]}],rotate:[{rotate:[M0,Ca]}],"translate-x":[{"translate-x":[P]}],"translate-y":[{"translate-y":[P]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ca]}],accent:[{accent:["auto",e]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ca]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":I()}],"scroll-mx":[{"scroll-mx":I()}],"scroll-my":[{"scroll-my":I()}],"scroll-ms":[{"scroll-ms":I()}],"scroll-me":[{"scroll-me":I()}],"scroll-mt":[{"scroll-mt":I()}],"scroll-mr":[{"scroll-mr":I()}],"scroll-mb":[{"scroll-mb":I()}],"scroll-ml":[{"scroll-ml":I()}],"scroll-p":[{"scroll-p":I()}],"scroll-px":[{"scroll-px":I()}],"scroll-py":[{"scroll-py":I()}],"scroll-ps":[{"scroll-ps":I()}],"scroll-pe":[{"scroll-pe":I()}],"scroll-pt":[{"scroll-pt":I()}],"scroll-pr":[{"scroll-pr":I()}],"scroll-pb":[{"scroll-pb":I()}],"scroll-pl":[{"scroll-pl":I()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ca]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[_d,Qw]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var kde=pde(Ede);function Yt(...e){return kde(ta(e))}const JL=["#3B82F6","#22C55E","#F59E0B","#8B5CF6","#EC4899","#06B6D4","#F43F5E","#10B981","#A855F7","#EAB308"];function Ode(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return Math.abs(t)}function hm(e){if(!e)return"#94A3B8";const t=Ode(String(e))%JL.length;return JL[t]}var Ide={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Tde=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),kr=(e,t)=>{const r=p.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:s,children:l,...c},d)=>p.createElement("svg",{ref:d,...Ide,width:a,height:a,stroke:n,strokeWidth:s?Number(i)*24/Number(a):i,className:`lucide lucide-${Tde(e)}`,...c},[...t.map(([u,f])=>p.createElement(u,f)),...(Array.isArray(l)?l:[l])||[]]));return r.displayName=`${e}`,r},hc=kr("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Af=kr("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Dde=kr("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]),Cy=kr("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),Zw=kr("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),II=kr("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),QW=kr("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]),ZW=kr("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]),mP=kr("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),oN=kr("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),eH=kr("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),Mde=kr("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]),iN=kr("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),Rde=kr("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),TI=kr("CalendarCheck",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]),Lde=kr("CalendarDays",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),DI=kr("CalendarPlus",[["path",{d:"M21 13V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"3spt84"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["line",{x1:"19",x2:"19",y1:"16",y2:"22",key:"1ttwzi"}],["line",{x1:"16",x2:"22",y1:"19",y2:"19",key:"1g9955"}]]),dj=kr("CalendarX",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["line",{x1:"10",x2:"14",y1:"14",y2:"18",key:"1g3qc0"}],["line",{x1:"14",x2:"10",y1:"14",y2:"18",key:"1az83m"}]]),Ei=kr("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),e2=kr("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Ai=kr("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),ih=kr("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),L1=kr("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),tH=kr("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),Kx=kr("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),$de=kr("Chrome",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["line",{x1:"21.17",x2:"12",y1:"8",y2:"8",key:"a0cw5f"}],["line",{x1:"3.95",x2:"8.54",y1:"6.06",y2:"14",key:"1kftof"}],["line",{x1:"10.88",x2:"15.46",y1:"21.94",y2:"14",key:"1ymyh8"}]]),Fde=kr("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Bde=kr("ClipboardCopy",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2",key:"4jdomd"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v4",key:"3hqy98"}],["path",{d:"M21 14H11",key:"1bme5i"}],["path",{d:"m15 10-4 4 4 4",key:"5dvupr"}]]),Vd=kr("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Cm=kr("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),Ui=kr("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),ri=kr("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Sp=kr("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),zp=kr("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Cg=kr("FileDown",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]),ns=kr("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),Ck=kr("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),qde=kr("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]),zde=kr("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]),Ude=kr("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]),Vde=kr("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),Wde=kr("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),Hde=kr("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),Gde=kr("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),rH=kr("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Kde=kr("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",key:"1kog09"}]]),Yde=kr("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]),Xde=kr("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),nH=kr("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]),aH=kr("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]),Pm=kr("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),sh=kr("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),Jde=kr("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),Qde=kr("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),ax=kr("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),QL=kr("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),Zde=kr("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),hP=kr("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),eue=kr("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),ZL=kr("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),gv=kr("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),tue=kr("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),e6=kr("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]),ud=kr("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),El=kr("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),wb=kr("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),oH=kr("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]),Ka=kr("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),iH=kr("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]),Cp=kr("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),t6=kr("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),pi=kr("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),MI=kr("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),zm=kr("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),r6=kr("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]),rue=kr("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Tv=kr("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]),$1=kr("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),n6=kr("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]),pP=kr("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),Pk=kr("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),nue=kr("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),RI=kr("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]),t2=kr("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),Um=kr("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),aue=kr("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),Up=kr("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),$d=kr("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),oue=kr("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]),sH=kr("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),LI=kr("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),iue=kr("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),sue=kr("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]),lue=kr("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),lH=kr("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),ju=kr("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),cl=kr("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),cH=kr("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]),Py=kr("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Ml=kr("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Wd=({size:e="md",variant:t="header",className:r=""})=>{const n={xs:"w-8 h-8",sm:"w-10 h-10",md:"w-14 h-14",lg:"w-20 h-20",xl:"w-24 h-24"},a={header:"/isis-profile.png",message:"/isis-profile-baloon.png"},i=a[t]||a.header,s=e==="lg"?"scale-125":e==="md"?"scale-110":"scale-100";return o.jsx("div",{className:`${n[e]||n.md} rounded-full overflow-hidden flex-shrink-0 ring-2 ring-brand ring-offset-0 ${r}`,children:o.jsx("img",{src:i,alt:"Assistente Virtual",className:`w-full h-full object-cover ${s}`,onError:l=>{l.target.style.display="none",l.target.parentElement.innerHTML=`
            <div class="w-full h-full bg-brand flex items-center justify-center">
              <span class="text-bg font-bold text-lg">A</span>
            </div>
          `}})})},dH=p.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),_S=p.createContext({}),SS=p.createContext(null),CS=typeof document<"u",$I=CS?p.useLayoutEffect:p.useEffect,uH=p.createContext({strict:!1}),FI=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),cue="framerAppearId",fH="data-"+FI(cue);function due(e,t,r,n){const{visualElement:a}=p.useContext(_S),i=p.useContext(uH),s=p.useContext(SS),l=p.useContext(dH).reducedMotion,c=p.useRef();n=n||i.renderer,!c.current&&n&&(c.current=n(e,{visualState:t,parent:a,props:r,presenceContext:s,blockInitialAnimation:s?s.initial===!1:!1,reducedMotionConfig:l}));const d=c.current;p.useInsertionEffect(()=>{d&&d.update(r,s)});const u=p.useRef(!!(r[fH]&&!window.HandoffComplete));return $I(()=>{d&&(d.render(),u.current&&d.animationState&&d.animationState.animateChanges())}),p.useEffect(()=>{d&&(d.updateFeatures(),!u.current&&d.animationState&&d.animationState.animateChanges(),u.current&&(u.current=!1,window.HandoffComplete=!0))}),d}function vv(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function uue(e,t,r){return p.useCallback(n=>{n&&e.mount&&e.mount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):vv(r)&&(r.current=n))},[t])}function jb(e){return typeof e=="string"||Array.isArray(e)}function PS(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const BI=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],qI=["initial",...BI];function AS(e){return PS(e.animate)||qI.some(t=>jb(e[t]))}function mH(e){return!!(AS(e)||e.variants)}function fue(e,t){if(AS(e)){const{initial:r,animate:n}=e;return{initial:r===!1||jb(r)?r:void 0,animate:jb(n)?n:void 0}}return e.inherit!==!1?t:{}}function mue(e){const{initial:t,animate:r}=fue(e,p.useContext(_S));return p.useMemo(()=>({initial:t,animate:r}),[a6(t),a6(r)])}function a6(e){return Array.isArray(e)?e.join(" "):e}const o6={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Nb={};for(const e in o6)Nb[e]={isEnabled:t=>o6[e].some(r=>!!t[r])};function hue(e){for(const t in e)Nb[t]={...Nb[t],...e[t]}}const zI=p.createContext({}),hH=p.createContext({}),pue=Symbol.for("motionComponentSymbol");function gue({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:n,Component:a}){e&&hue(e);function i(l,c){let d;const u={...p.useContext(dH),...l,layoutId:vue(l)},{isStatic:f}=u,m=mue(l),h=n(l,f);if(!f&&CS){m.visualElement=due(a,h,u,t);const v=p.useContext(hH),g=p.useContext(uH).strict;m.visualElement&&(d=m.visualElement.loadFeatures(u,g,e,v))}return p.createElement(_S.Provider,{value:m},d&&m.visualElement?p.createElement(d,{visualElement:m.visualElement,...u}):null,r(a,l,uue(h,m.visualElement,c),h,f,m.visualElement))}const s=p.forwardRef(i);return s[pue]=a,s}function vue({layoutId:e}){const t=p.useContext(zI).id;return t&&e!==void 0?t+"-"+e:e}function xue(e){function t(n,a={}){return gue(e(n,a))}if(typeof Proxy>"u")return t;const r=new Map;return new Proxy(t,{get:(n,a)=>(r.has(a)||r.set(a,t(a)),r.get(a))})}const yue=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function UI(e){return typeof e!="string"||e.includes("-")?!1:!!(yue.indexOf(e)>-1||/[A-Z]/.test(e))}const sN={};function bue(e){Object.assign(sN,e)}const F1=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],dg=new Set(F1);function pH(e,{layout:t,layoutId:r}){return dg.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!sN[e]||e==="opacity")}const $l=e=>!!(e&&e.getVelocity),wue={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},jue=F1.length;function Nue(e,{enableHardwareAcceleration:t=!0,allowTransformNone:r=!0},n,a){let i="";for(let s=0;s<jue;s++){const l=F1[s];if(e[l]!==void 0){const c=wue[l]||l;i+=`${c}(${e[l]}) `}}return t&&!e.z&&(i+="translateZ(0)"),i=i.trim(),a?i=a(e,n?"":i):r&&n&&(i="none"),i}const gH=e=>t=>typeof t=="string"&&t.startsWith(e),vH=gH("--"),Ak=gH("var(--"),_ue=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,Sue=(e,t)=>t&&typeof e=="number"?t.transform(e):e,lh=(e,t,r)=>Math.min(Math.max(r,e),t),ug={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Ay={...ug,transform:e=>lh(0,1,e)},r2={...ug,default:1},Ey=e=>Math.round(e*1e5)/1e5,ES=/(-)?([\d]*\.?[\d])+/g,xH=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,Cue=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function B1(e){return typeof e=="string"}const q1=e=>({test:t=>B1(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),lm=q1("deg"),ku=q1("%"),Kn=q1("px"),Pue=q1("vh"),Aue=q1("vw"),i6={...ku,parse:e=>ku.parse(e)/100,transform:e=>ku.transform(e*100)},s6={...ug,transform:Math.round},yH={borderWidth:Kn,borderTopWidth:Kn,borderRightWidth:Kn,borderBottomWidth:Kn,borderLeftWidth:Kn,borderRadius:Kn,radius:Kn,borderTopLeftRadius:Kn,borderTopRightRadius:Kn,borderBottomRightRadius:Kn,borderBottomLeftRadius:Kn,width:Kn,maxWidth:Kn,height:Kn,maxHeight:Kn,size:Kn,top:Kn,right:Kn,bottom:Kn,left:Kn,padding:Kn,paddingTop:Kn,paddingRight:Kn,paddingBottom:Kn,paddingLeft:Kn,margin:Kn,marginTop:Kn,marginRight:Kn,marginBottom:Kn,marginLeft:Kn,rotate:lm,rotateX:lm,rotateY:lm,rotateZ:lm,scale:r2,scaleX:r2,scaleY:r2,scaleZ:r2,skew:lm,skewX:lm,skewY:lm,distance:Kn,translateX:Kn,translateY:Kn,translateZ:Kn,x:Kn,y:Kn,z:Kn,perspective:Kn,transformPerspective:Kn,opacity:Ay,originX:i6,originY:i6,originZ:Kn,zIndex:s6,fillOpacity:Ay,strokeOpacity:Ay,numOctaves:s6};function VI(e,t,r,n){const{style:a,vars:i,transform:s,transformOrigin:l}=e;let c=!1,d=!1,u=!0;for(const f in t){const m=t[f];if(vH(f)){i[f]=m;continue}const h=yH[f],v=Sue(m,h);if(dg.has(f)){if(c=!0,s[f]=v,!u)continue;m!==(h.default||0)&&(u=!1)}else f.startsWith("origin")?(d=!0,l[f]=v):a[f]=v}if(t.transform||(c||n?a.transform=Nue(e.transform,r,u,n):a.transform&&(a.transform="none")),d){const{originX:f="50%",originY:m="50%",originZ:h=0}=l;a.transformOrigin=`${f} ${m} ${h}`}}const WI=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function bH(e,t,r){for(const n in t)!$l(t[n])&&!pH(n,r)&&(e[n]=t[n])}function Eue({transformTemplate:e},t,r){return p.useMemo(()=>{const n=WI();return VI(n,t,{enableHardwareAcceleration:!r},e),Object.assign({},n.vars,n.style)},[t])}function kue(e,t,r){const n=e.style||{},a={};return bH(a,n,e),Object.assign(a,Eue(e,t,r)),e.transformValues?e.transformValues(a):a}function Oue(e,t,r){const n={},a=kue(e,t,r);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=a,n}const Iue=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function lN(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||Iue.has(e)}let wH=e=>!lN(e);function Tue(e){e&&(wH=t=>t.startsWith("on")?!lN(t):e(t))}try{Tue(require("@emotion/is-prop-valid").default)}catch{}function Due(e,t,r){const n={};for(const a in e)a==="values"&&typeof e.values=="object"||(wH(a)||r===!0&&lN(a)||!t&&!lN(a)||e.draggable&&a.startsWith("onDrag"))&&(n[a]=e[a]);return n}function l6(e,t,r){return typeof e=="string"?e:Kn.transform(t+r*e)}function Mue(e,t,r){const n=l6(t,e.x,e.width),a=l6(r,e.y,e.height);return`${n} ${a}`}const Rue={offset:"stroke-dashoffset",array:"stroke-dasharray"},Lue={offset:"strokeDashoffset",array:"strokeDasharray"};function $ue(e,t,r=1,n=0,a=!0){e.pathLength=1;const i=a?Rue:Lue;e[i.offset]=Kn.transform(-n);const s=Kn.transform(t),l=Kn.transform(r);e[i.array]=`${s} ${l}`}function HI(e,{attrX:t,attrY:r,attrScale:n,originX:a,originY:i,pathLength:s,pathSpacing:l=1,pathOffset:c=0,...d},u,f,m){if(VI(e,d,u,m),f){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:h,style:v,dimensions:g}=e;h.transform&&(g&&(v.transform=h.transform),delete h.transform),g&&(a!==void 0||i!==void 0||v.transform)&&(v.transformOrigin=Mue(g,a!==void 0?a:.5,i!==void 0?i:.5)),t!==void 0&&(h.x=t),r!==void 0&&(h.y=r),n!==void 0&&(h.scale=n),s!==void 0&&$ue(h,s,l,c,!1)}const jH=()=>({...WI(),attrs:{}}),GI=e=>typeof e=="string"&&e.toLowerCase()==="svg";function Fue(e,t,r,n){const a=p.useMemo(()=>{const i=jH();return HI(i,t,{enableHardwareAcceleration:!1},GI(n),e.transformTemplate),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};bH(i,e.style,e),a.style={...i,...a.style}}return a}function Bue(e=!1){return(r,n,a,{latestValues:i},s)=>{const c=(UI(r)?Fue:Oue)(n,i,s,r),u={...Due(n,typeof r=="string",e),...c,ref:a},{children:f}=n,m=p.useMemo(()=>$l(f)?f.get():f,[f]);return p.createElement(r,{...u,children:m})}}function NH(e,{style:t,vars:r},n,a){Object.assign(e.style,t,a&&a.getProjectionStyles(n));for(const i in r)e.style.setProperty(i,r[i])}const _H=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function SH(e,t,r,n){NH(e,t,void 0,n);for(const a in t.attrs)e.setAttribute(_H.has(a)?a:FI(a),t.attrs[a])}function KI(e,t){const{style:r}=e,n={};for(const a in r)($l(r[a])||t.style&&$l(t.style[a])||pH(a,e))&&(n[a]=r[a]);return n}function CH(e,t){const r=KI(e,t);for(const n in e)if($l(e[n])||$l(t[n])){const a=F1.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;r[a]=e[n]}return r}function YI(e,t,r,n={},a={}){return typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,a)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,a)),t}function PH(e){const t=p.useRef(null);return t.current===null&&(t.current=e()),t.current}const cN=e=>Array.isArray(e),que=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),zue=e=>cN(e)?e[e.length-1]||0:e;function uj(e){const t=$l(e)?e.get():e;return que(t)?t.toValue():t}function Uue({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:r},n,a,i){const s={latestValues:Vue(n,a,i,e),renderState:t()};return r&&(s.mount=l=>r(n,l,s)),s}const AH=e=>(t,r)=>{const n=p.useContext(_S),a=p.useContext(SS),i=()=>Uue(e,t,n,a);return r?i():PH(i)};function Vue(e,t,r,n){const a={},i=n(e,{});for(const m in i)a[m]=uj(i[m]);let{initial:s,animate:l}=e;const c=AS(e),d=mH(e);t&&d&&!c&&e.inherit!==!1&&(s===void 0&&(s=t.initial),l===void 0&&(l=t.animate));let u=r?r.initial===!1:!1;u=u||s===!1;const f=u?l:s;return f&&typeof f!="boolean"&&!PS(f)&&(Array.isArray(f)?f:[f]).forEach(h=>{const v=YI(e,h);if(!v)return;const{transitionEnd:g,transition:y,...x}=v;for(const b in x){let w=x[b];if(Array.isArray(w)){const j=u?w.length-1:0;w=w[j]}w!==null&&(a[b]=w)}for(const b in g)a[b]=g[b]}),a}const oi=e=>e;class c6{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const r=this.order.indexOf(t);r!==-1&&(this.order.splice(r,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}function Wue(e){let t=new c6,r=new c6,n=0,a=!1,i=!1;const s=new WeakSet,l={schedule:(c,d=!1,u=!1)=>{const f=u&&a,m=f?t:r;return d&&s.add(c),m.add(c)&&f&&a&&(n=t.order.length),c},cancel:c=>{r.remove(c),s.delete(c)},process:c=>{if(a){i=!0;return}if(a=!0,[t,r]=[r,t],r.clear(),n=t.order.length,n)for(let d=0;d<n;d++){const u=t.order[d];u(c),s.has(u)&&(l.schedule(u),e())}a=!1,i&&(i=!1,l.process(c))}};return l}const n2=["prepare","read","update","preRender","render","postRender"],Hue=40;function Gue(e,t){let r=!1,n=!0;const a={delta:0,timestamp:0,isProcessing:!1},i=n2.reduce((f,m)=>(f[m]=Wue(()=>r=!0),f),{}),s=f=>i[f].process(a),l=()=>{const f=performance.now();r=!1,a.delta=n?1e3/60:Math.max(Math.min(f-a.timestamp,Hue),1),a.timestamp=f,a.isProcessing=!0,n2.forEach(s),a.isProcessing=!1,r&&t&&(n=!1,e(l))},c=()=>{r=!0,n=!0,a.isProcessing||e(l)};return{schedule:n2.reduce((f,m)=>{const h=i[m];return f[m]=(v,g=!1,y=!1)=>(r||c(),h.schedule(v,g,y)),f},{}),cancel:f=>n2.forEach(m=>i[m].cancel(f)),state:a,steps:i}}const{schedule:No,cancel:Ef,state:Fs,steps:gP}=Gue(typeof requestAnimationFrame<"u"?requestAnimationFrame:oi,!0),Kue={useVisualState:AH({scrapeMotionValuesFromProps:CH,createRenderState:jH,onMount:(e,t,{renderState:r,latestValues:n})=>{No.read(()=>{try{r.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{r.dimensions={x:0,y:0,width:0,height:0}}}),No.render(()=>{HI(r,n,{enableHardwareAcceleration:!1},GI(t.tagName),e.transformTemplate),SH(t,r)})}})},Yue={useVisualState:AH({scrapeMotionValuesFromProps:KI,createRenderState:WI})};function Xue(e,{forwardMotionProps:t=!1},r,n){return{...UI(e)?Kue:Yue,preloadedFeatures:r,useRender:Bue(t),createVisualElement:n,Component:e}}function hf(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}const EH=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function kS(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const Jue=e=>t=>EH(t)&&e(t,kS(t));function bf(e,t,r,n){return hf(e,t,Jue(r),n)}const Que=(e,t)=>r=>t(e(r)),Vm=(...e)=>e.reduce(Que);function kH(e){let t=null;return()=>{const r=()=>{t=null};return t===null?(t=e,r):!1}}const d6=kH("dragHorizontal"),u6=kH("dragVertical");function OH(e){let t=!1;if(e==="y")t=u6();else if(e==="x")t=d6();else{const r=d6(),n=u6();r&&n?t=()=>{r(),n()}:(r&&r(),n&&n())}return t}function IH(){const e=OH(!0);return e?(e(),!1):!0}class bh{constructor(t){this.isMounted=!1,this.node=t}update(){}}function f6(e,t){const r="pointer"+(t?"enter":"leave"),n="onHover"+(t?"Start":"End"),a=(i,s)=>{if(i.pointerType==="touch"||IH())return;const l=e.getProps();e.animationState&&l.whileHover&&e.animationState.setActive("whileHover",t),l[n]&&No.update(()=>l[n](i,s))};return bf(e.current,r,a,{passive:!e.getProps()[n]})}class Zue extends bh{mount(){this.unmount=Vm(f6(this.node,!0),f6(this.node,!1))}unmount(){}}class efe extends bh{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Vm(hf(this.node.current,"focus",()=>this.onFocus()),hf(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const TH=(e,t)=>t?e===t?!0:TH(e,t.parentElement):!1;function vP(e,t){if(!t)return;const r=new PointerEvent("pointer"+e);t(r,kS(r))}class tfe extends bh{constructor(){super(...arguments),this.removeStartListeners=oi,this.removeEndListeners=oi,this.removeAccessibleListeners=oi,this.startPointerPress=(t,r)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),i=bf(window,"pointerup",(l,c)=>{if(!this.checkPressEnd())return;const{onTap:d,onTapCancel:u,globalTapTarget:f}=this.node.getProps();No.update(()=>{!f&&!TH(this.node.current,l.target)?u&&u(l,c):d&&d(l,c)})},{passive:!(n.onTap||n.onPointerUp)}),s=bf(window,"pointercancel",(l,c)=>this.cancelPress(l,c),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=Vm(i,s),this.startPress(t,r)},this.startAccessiblePress=()=>{const t=i=>{if(i.key!=="Enter"||this.isPressing)return;const s=l=>{l.key!=="Enter"||!this.checkPressEnd()||vP("up",(c,d)=>{const{onTap:u}=this.node.getProps();u&&No.update(()=>u(c,d))})};this.removeEndListeners(),this.removeEndListeners=hf(this.node.current,"keyup",s),vP("down",(l,c)=>{this.startPress(l,c)})},r=hf(this.node.current,"keydown",t),n=()=>{this.isPressing&&vP("cancel",(i,s)=>this.cancelPress(i,s))},a=hf(this.node.current,"blur",n);this.removeAccessibleListeners=Vm(r,a)}}startPress(t,r){this.isPressing=!0;const{onTapStart:n,whileTap:a}=this.node.getProps();a&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&No.update(()=>n(t,r))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!IH()}cancelPress(t,r){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&No.update(()=>n(t,r))}mount(){const t=this.node.getProps(),r=bf(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),n=hf(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Vm(r,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const Ek=new WeakMap,xP=new WeakMap,rfe=e=>{const t=Ek.get(e.target);t&&t(e)},nfe=e=>{e.forEach(rfe)};function afe({root:e,...t}){const r=e||document;xP.has(r)||xP.set(r,{});const n=xP.get(r),a=JSON.stringify(t);return n[a]||(n[a]=new IntersectionObserver(nfe,{root:e,...t})),n[a]}function ofe(e,t,r){const n=afe(t);return Ek.set(e,r),n.observe(e),()=>{Ek.delete(e),n.unobserve(e)}}const ife={some:0,all:1};class sfe extends bh{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:a="some",once:i}=t,s={root:r?r.current:void 0,rootMargin:n,threshold:typeof a=="number"?a:ife[a]},l=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,i&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:u,onViewportLeave:f}=this.node.getProps(),m=d?u:f;m&&m(c)};return ofe(this.node.current,s,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(lfe(t,r))&&this.startObserver()}unmount(){}}function lfe({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const cfe={inView:{Feature:sfe},tap:{Feature:tfe},focus:{Feature:efe},hover:{Feature:Zue}};function DH(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}function dfe(e){const t={};return e.values.forEach((r,n)=>t[n]=r.get()),t}function ufe(e){const t={};return e.values.forEach((r,n)=>t[n]=r.getVelocity()),t}function OS(e,t,r){const n=e.getProps();return YI(n,t,r!==void 0?r:n.custom,dfe(e),ufe(e))}let ffe=oi,XI=oi;const Wm=e=>e*1e3,wf=e=>e/1e3,mfe={current:!1},MH=e=>Array.isArray(e)&&typeof e[0]=="number";function RH(e){return!!(!e||typeof e=="string"&&LH[e]||MH(e)||Array.isArray(e)&&e.every(RH))}const dy=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,LH={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:dy([0,.65,.55,1]),circOut:dy([.55,0,1,.45]),backIn:dy([.31,.01,.66,-.59]),backOut:dy([.33,1.53,.69,.99])};function $H(e){if(e)return MH(e)?dy(e):Array.isArray(e)?e.map($H):LH[e]}function hfe(e,t,r,{delay:n=0,duration:a,repeat:i=0,repeatType:s="loop",ease:l,times:c}={}){const d={[t]:r};c&&(d.offset=c);const u=$H(l);return Array.isArray(u)&&(d.easing=u),e.animate(d,{delay:n,duration:a,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:i+1,direction:s==="reverse"?"alternate":"normal"})}function pfe(e,{repeat:t,repeatType:r="loop"}){const n=t&&r!=="loop"&&t%2===1?0:e.length-1;return e[n]}const FH=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,gfe=1e-7,vfe=12;function xfe(e,t,r,n,a){let i,s,l=0;do s=t+(r-t)/2,i=FH(s,n,a)-e,i>0?r=s:t=s;while(Math.abs(i)>gfe&&++l<vfe);return s}function z1(e,t,r,n){if(e===t&&r===n)return oi;const a=i=>xfe(i,0,1,e,r);return i=>i===0||i===1?i:FH(a(i),t,n)}const yfe=z1(.42,0,1,1),bfe=z1(0,0,.58,1),BH=z1(.42,0,.58,1),wfe=e=>Array.isArray(e)&&typeof e[0]!="number",qH=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,zH=e=>t=>1-e(1-t),JI=e=>1-Math.sin(Math.acos(e)),UH=zH(JI),jfe=qH(JI),VH=z1(.33,1.53,.69,.99),QI=zH(VH),Nfe=qH(QI),_fe=e=>(e*=2)<1?.5*QI(e):.5*(2-Math.pow(2,-10*(e-1))),Sfe={linear:oi,easeIn:yfe,easeInOut:BH,easeOut:bfe,circIn:JI,circInOut:jfe,circOut:UH,backIn:QI,backInOut:Nfe,backOut:VH,anticipate:_fe},m6=e=>{if(Array.isArray(e)){XI(e.length===4);const[t,r,n,a]=e;return z1(t,r,n,a)}else if(typeof e=="string")return Sfe[e];return e},ZI=(e,t)=>r=>!!(B1(r)&&Cue.test(r)&&r.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(r,t)),WH=(e,t,r)=>n=>{if(!B1(n))return n;const[a,i,s,l]=n.match(ES);return{[e]:parseFloat(a),[t]:parseFloat(i),[r]:parseFloat(s),alpha:l!==void 0?parseFloat(l):1}},Cfe=e=>lh(0,255,e),yP={...ug,transform:e=>Math.round(Cfe(e))},dp={test:ZI("rgb","red"),parse:WH("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+yP.transform(e)+", "+yP.transform(t)+", "+yP.transform(r)+", "+Ey(Ay.transform(n))+")"};function Pfe(e){let t="",r="",n="",a="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),a=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),a=e.substring(4,5),t+=t,r+=r,n+=n,a+=a),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:a?parseInt(a,16)/255:1}}const kk={test:ZI("#"),parse:Pfe,transform:dp.transform},xv={test:ZI("hsl","hue"),parse:WH("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+ku.transform(Ey(t))+", "+ku.transform(Ey(r))+", "+Ey(Ay.transform(n))+")"},ol={test:e=>dp.test(e)||kk.test(e)||xv.test(e),parse:e=>dp.test(e)?dp.parse(e):xv.test(e)?xv.parse(e):kk.parse(e),transform:e=>B1(e)?e:e.hasOwnProperty("red")?dp.transform(e):xv.transform(e)},Ho=(e,t,r)=>-r*e+r*t+e;function bP(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function Afe({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let a=0,i=0,s=0;if(!t)a=i=s=r;else{const l=r<.5?r*(1+t):r+t-r*t,c=2*r-l;a=bP(c,l,e+1/3),i=bP(c,l,e),s=bP(c,l,e-1/3)}return{red:Math.round(a*255),green:Math.round(i*255),blue:Math.round(s*255),alpha:n}}const wP=(e,t,r)=>{const n=e*e;return Math.sqrt(Math.max(0,r*(t*t-n)+n))},Efe=[kk,dp,xv],kfe=e=>Efe.find(t=>t.test(e));function h6(e){const t=kfe(e);let r=t.parse(e);return t===xv&&(r=Afe(r)),r}const HH=(e,t)=>{const r=h6(e),n=h6(t),a={...r};return i=>(a.red=wP(r.red,n.red,i),a.green=wP(r.green,n.green,i),a.blue=wP(r.blue,n.blue,i),a.alpha=Ho(r.alpha,n.alpha,i),dp.transform(a))};function Ofe(e){var t,r;return isNaN(e)&&B1(e)&&(((t=e.match(ES))===null||t===void 0?void 0:t.length)||0)+(((r=e.match(xH))===null||r===void 0?void 0:r.length)||0)>0}const GH={regex:_ue,countKey:"Vars",token:"${v}",parse:oi},KH={regex:xH,countKey:"Colors",token:"${c}",parse:ol.parse},YH={regex:ES,countKey:"Numbers",token:"${n}",parse:ug.parse};function jP(e,{regex:t,countKey:r,token:n,parse:a}){const i=e.tokenised.match(t);i&&(e["num"+r]=i.length,e.tokenised=e.tokenised.replace(t,n),e.values.push(...i.map(a)))}function dN(e){const t=e.toString(),r={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return r.value.includes("var(--")&&jP(r,GH),jP(r,KH),jP(r,YH),r}function XH(e){return dN(e).values}function JH(e){const{values:t,numColors:r,numVars:n,tokenised:a}=dN(e),i=t.length;return s=>{let l=a;for(let c=0;c<i;c++)c<n?l=l.replace(GH.token,s[c]):c<n+r?l=l.replace(KH.token,ol.transform(s[c])):l=l.replace(YH.token,Ey(s[c]));return l}}const Ife=e=>typeof e=="number"?0:e;function Tfe(e){const t=XH(e);return JH(e)(t.map(Ife))}const ch={test:Ofe,parse:XH,createTransformer:JH,getAnimatableNone:Tfe},QH=(e,t)=>r=>`${r>0?t:e}`;function ZH(e,t){return typeof e=="number"?r=>Ho(e,t,r):ol.test(e)?HH(e,t):e.startsWith("var(")?QH(e,t):tG(e,t)}const eG=(e,t)=>{const r=[...e],n=r.length,a=e.map((i,s)=>ZH(i,t[s]));return i=>{for(let s=0;s<n;s++)r[s]=a[s](i);return r}},Dfe=(e,t)=>{const r={...e,...t},n={};for(const a in r)e[a]!==void 0&&t[a]!==void 0&&(n[a]=ZH(e[a],t[a]));return a=>{for(const i in n)r[i]=n[i](a);return r}},tG=(e,t)=>{const r=ch.createTransformer(t),n=dN(e),a=dN(t);return n.numVars===a.numVars&&n.numColors===a.numColors&&n.numNumbers>=a.numNumbers?Vm(eG(n.values,a.values),r):QH(e,t)},_b=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n},p6=(e,t)=>r=>Ho(e,t,r);function Mfe(e){return typeof e=="number"?p6:typeof e=="string"?ol.test(e)?HH:tG:Array.isArray(e)?eG:typeof e=="object"?Dfe:p6}function Rfe(e,t,r){const n=[],a=r||Mfe(e[0]),i=e.length-1;for(let s=0;s<i;s++){let l=a(e[s],e[s+1]);if(t){const c=Array.isArray(t)?t[s]||oi:t;l=Vm(c,l)}n.push(l)}return n}function rG(e,t,{clamp:r=!0,ease:n,mixer:a}={}){const i=e.length;if(XI(i===t.length),i===1)return()=>t[0];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const s=Rfe(t,n,a),l=s.length,c=d=>{let u=0;if(l>1)for(;u<e.length-2&&!(d<e[u+1]);u++);const f=_b(e[u],e[u+1],d);return s[u](f)};return r?d=>c(lh(e[0],e[i-1],d)):c}function Lfe(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const a=_b(0,t,n);e.push(Ho(r,1,a))}}function $fe(e){const t=[0];return Lfe(t,e.length-1),t}function Ffe(e,t){return e.map(r=>r*t)}function Bfe(e,t){return e.map(()=>t||BH).splice(0,e.length-1)}function uN({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const a=wfe(n)?n.map(m6):m6(n),i={done:!1,value:t[0]},s=Ffe(r&&r.length===t.length?r:$fe(t),e),l=rG(s,t,{ease:Array.isArray(a)?a:Bfe(t,a)});return{calculatedDuration:e,next:c=>(i.value=l(c),i.done=c>=e,i)}}function nG(e,t){return t?e*(1e3/t):0}const qfe=5;function aG(e,t,r){const n=Math.max(t-qfe,0);return nG(r-e(n),t-n)}const NP=.001,zfe=.01,g6=10,Ufe=.05,Vfe=1;function Wfe({duration:e=800,bounce:t=.25,velocity:r=0,mass:n=1}){let a,i;ffe(e<=Wm(g6));let s=1-t;s=lh(Ufe,Vfe,s),e=lh(zfe,g6,wf(e)),s<1?(a=d=>{const u=d*s,f=u*e,m=u-r,h=Ok(d,s),v=Math.exp(-f);return NP-m/h*v},i=d=>{const f=d*s*e,m=f*r+r,h=Math.pow(s,2)*Math.pow(d,2)*e,v=Math.exp(-f),g=Ok(Math.pow(d,2),s);return(-a(d)+NP>0?-1:1)*((m-h)*v)/g}):(a=d=>{const u=Math.exp(-d*e),f=(d-r)*e+1;return-NP+u*f},i=d=>{const u=Math.exp(-d*e),f=(r-d)*(e*e);return u*f});const l=5/e,c=Gfe(a,i,l);if(e=Wm(e),isNaN(c))return{stiffness:100,damping:10,duration:e};{const d=Math.pow(c,2)*n;return{stiffness:d,damping:s*2*Math.sqrt(n*d),duration:e}}}const Hfe=12;function Gfe(e,t,r){let n=r;for(let a=1;a<Hfe;a++)n=n-e(n)/t(n);return n}function Ok(e,t){return e*Math.sqrt(1-t*t)}const Kfe=["duration","bounce"],Yfe=["stiffness","damping","mass"];function v6(e,t){return t.some(r=>e[r]!==void 0)}function Xfe(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!v6(e,Yfe)&&v6(e,Kfe)){const r=Wfe(e);t={...t,...r,mass:1},t.isResolvedFromDuration=!0}return t}function oG({keyframes:e,restDelta:t,restSpeed:r,...n}){const a=e[0],i=e[e.length-1],s={done:!1,value:a},{stiffness:l,damping:c,mass:d,duration:u,velocity:f,isResolvedFromDuration:m}=Xfe({...n,velocity:-wf(n.velocity||0)}),h=f||0,v=c/(2*Math.sqrt(l*d)),g=i-a,y=wf(Math.sqrt(l/d)),x=Math.abs(g)<5;r||(r=x?.01:2),t||(t=x?.005:.5);let b;if(v<1){const w=Ok(y,v);b=j=>{const _=Math.exp(-v*y*j);return i-_*((h+v*y*g)/w*Math.sin(w*j)+g*Math.cos(w*j))}}else if(v===1)b=w=>i-Math.exp(-y*w)*(g+(h+y*g)*w);else{const w=y*Math.sqrt(v*v-1);b=j=>{const _=Math.exp(-v*y*j),C=Math.min(w*j,300);return i-_*((h+v*y*g)*Math.sinh(C)+w*g*Math.cosh(C))/w}}return{calculatedDuration:m&&u||null,next:w=>{const j=b(w);if(m)s.done=w>=u;else{let _=h;w!==0&&(v<1?_=aG(b,w,j):_=0);const C=Math.abs(_)<=r,E=Math.abs(i-j)<=t;s.done=C&&E}return s.value=s.done?i:j,s}}}function x6({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:a=10,bounceStiffness:i=500,modifyTarget:s,min:l,max:c,restDelta:d=.5,restSpeed:u}){const f=e[0],m={done:!1,value:f},h=P=>l!==void 0&&P<l||c!==void 0&&P>c,v=P=>l===void 0?c:c===void 0||Math.abs(l-P)<Math.abs(c-P)?l:c;let g=r*t;const y=f+g,x=s===void 0?y:s(y);x!==y&&(g=x-f);const b=P=>-g*Math.exp(-P/n),w=P=>x+b(P),j=P=>{const k=b(P),M=w(P);m.done=Math.abs(k)<=d,m.value=m.done?x:M};let _,C;const E=P=>{h(m.value)&&(_=P,C=oG({keyframes:[m.value,v(m.value)],velocity:aG(w,P,m.value),damping:a,stiffness:i,restDelta:d,restSpeed:u}))};return E(0),{calculatedDuration:null,next:P=>{let k=!1;return!C&&_===void 0&&(k=!0,j(P),E(P)),_!==void 0&&P>_?C.next(P-_):(!k&&j(P),m)}}}const Jfe=e=>{const t=({timestamp:r})=>e(r);return{start:()=>No.update(t,!0),stop:()=>Ef(t),now:()=>Fs.isProcessing?Fs.timestamp:performance.now()}},y6=2e4;function b6(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<y6;)t+=r,n=e.next(t);return t>=y6?1/0:t}const Qfe={decay:x6,inertia:x6,tween:uN,keyframes:uN,spring:oG};function fN({autoplay:e=!0,delay:t=0,driver:r=Jfe,keyframes:n,type:a="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:l="loop",onPlay:c,onStop:d,onComplete:u,onUpdate:f,...m}){let h=1,v=!1,g,y;const x=()=>{y=new Promise(xe=>{g=xe})};x();let b;const w=Qfe[a]||uN;let j;w!==uN&&typeof n[0]!="number"&&(j=rG([0,100],n,{clamp:!1}),n=[0,100]);const _=w({...m,keyframes:n});let C;l==="mirror"&&(C=w({...m,keyframes:[...n].reverse(),velocity:-(m.velocity||0)}));let E="idle",P=null,k=null,M=null;_.calculatedDuration===null&&i&&(_.calculatedDuration=b6(_));const{calculatedDuration:S}=_;let I=1/0,T=1/0;S!==null&&(I=S+s,T=I*(i+1)-s);let D=0;const B=xe=>{if(k===null)return;h>0&&(k=Math.min(k,xe)),h<0&&(k=Math.min(xe-T/h,k)),P!==null?D=P:D=Math.round(xe-k)*h;const q=D-t*(h>=0?1:-1),L=h>=0?q<0:q>T;D=Math.max(q,0),E==="finished"&&P===null&&(D=T);let W=D,ne=_;if(i){const re=Math.min(D,T)/I;let G=Math.floor(re),me=re%1;!me&&re>=1&&(me=1),me===1&&G--,G=Math.min(G,i+1),!!(G%2)&&(l==="reverse"?(me=1-me,s&&(me-=s/I)):l==="mirror"&&(ne=C)),W=lh(0,1,me)*I}const le=L?{done:!1,value:n[0]}:ne.next(W);j&&(le.value=j(le.value));let{done:K}=le;!L&&S!==null&&(K=h>=0?D>=T:D<=0);const Q=P===null&&(E==="finished"||E==="running"&&K);return f&&f(le.value),Q&&$(),le},U=()=>{b&&b.stop(),b=void 0},z=()=>{E="idle",U(),g(),x(),k=M=null},$=()=>{E="finished",u&&u(),U(),g()},Y=()=>{if(v)return;b||(b=r(B));const xe=b.now();c&&c(),P!==null?k=xe-P:(!k||E==="finished")&&(k=xe),E==="finished"&&x(),M=k,P=null,E="running",b.start()};e&&Y();const de={then(xe,q){return y.then(xe,q)},get time(){return wf(D)},set time(xe){xe=Wm(xe),D=xe,P!==null||!b||h===0?P=xe:k=b.now()-xe/h},get duration(){const xe=_.calculatedDuration===null?b6(_):_.calculatedDuration;return wf(xe)},get speed(){return h},set speed(xe){xe===h||!b||(h=xe,de.time=wf(D))},get state(){return E},play:Y,pause:()=>{E="paused",P=D},stop:()=>{v=!0,E!=="idle"&&(E="idle",d&&d(),z())},cancel:()=>{M!==null&&B(M),z()},complete:()=>{E="finished"},sample:xe=>(k=0,B(xe))};return de}function Zfe(e){let t;return()=>(t===void 0&&(t=e()),t)}const eme=Zfe(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),tme=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),a2=10,rme=2e4,nme=(e,t)=>t.type==="spring"||e==="backgroundColor"||!RH(t.ease);function ame(e,t,{onUpdate:r,onComplete:n,...a}){if(!(eme()&&tme.has(t)&&!a.repeatDelay&&a.repeatType!=="mirror"&&a.damping!==0&&a.type!=="inertia"))return!1;let s=!1,l,c,d=!1;const u=()=>{c=new Promise(w=>{l=w})};u();let{keyframes:f,duration:m=300,ease:h,times:v}=a;if(nme(t,a)){const w=fN({...a,repeat:0,delay:0});let j={done:!1,value:f[0]};const _=[];let C=0;for(;!j.done&&C<rme;)j=w.sample(C),_.push(j.value),C+=a2;v=void 0,f=_,m=C-a2,h="linear"}const g=hfe(e.owner.current,t,f,{...a,duration:m,ease:h,times:v}),y=()=>{d=!1,g.cancel()},x=()=>{d=!0,No.update(y),l(),u()};return g.onfinish=()=>{d||(e.set(pfe(f,a)),n&&n(),x())},{then(w,j){return c.then(w,j)},attachTimeline(w){return g.timeline=w,g.onfinish=null,oi},get time(){return wf(g.currentTime||0)},set time(w){g.currentTime=Wm(w)},get speed(){return g.playbackRate},set speed(w){g.playbackRate=w},get duration(){return wf(m)},play:()=>{s||(g.play(),Ef(y))},pause:()=>g.pause(),stop:()=>{if(s=!0,g.playState==="idle")return;const{currentTime:w}=g;if(w){const j=fN({...a,autoplay:!1});e.setWithVelocity(j.sample(w-a2).value,j.sample(w).value,a2)}x()},complete:()=>{d||g.finish()},cancel:x}}function ome({keyframes:e,delay:t,onUpdate:r,onComplete:n}){const a=()=>(r&&r(e[e.length-1]),n&&n(),{time:0,speed:1,duration:0,play:oi,pause:oi,stop:oi,then:i=>(i(),Promise.resolve()),cancel:oi,complete:oi});return t?fN({keyframes:[0,1],duration:0,delay:t,onComplete:a}):a()}const ime={type:"spring",stiffness:500,damping:25,restSpeed:10},sme=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),lme={type:"keyframes",duration:.8},cme={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},dme=(e,{keyframes:t})=>t.length>2?lme:dg.has(e)?e.startsWith("scale")?sme(t[1]):ime:cme,Ik=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(ch.test(t)||t==="0")&&!t.startsWith("url(")),ume=new Set(["brightness","contrast","saturate","opacity"]);function fme(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(ES)||[];if(!n)return e;const a=r.replace(n,"");let i=ume.has(t)?1:0;return n!==r&&(i*=100),t+"("+i+a+")"}const mme=/([a-z-]*)\(.*?\)/g,Tk={...ch,getAnimatableNone:e=>{const t=e.match(mme);return t?t.map(fme).join(" "):e}},hme={...yH,color:ol,backgroundColor:ol,outlineColor:ol,fill:ol,stroke:ol,borderColor:ol,borderTopColor:ol,borderRightColor:ol,borderBottomColor:ol,borderLeftColor:ol,filter:Tk,WebkitFilter:Tk},eT=e=>hme[e];function iG(e,t){let r=eT(e);return r!==Tk&&(r=ch),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const sG=e=>/^0[^.\s]+$/.test(e);function pme(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||sG(e)}function gme(e,t,r,n){const a=Ik(t,r);let i;Array.isArray(r)?i=[...r]:i=[null,r];const s=n.from!==void 0?n.from:e.get();let l;const c=[];for(let d=0;d<i.length;d++)i[d]===null&&(i[d]=d===0?s:i[d-1]),pme(i[d])&&c.push(d),typeof i[d]=="string"&&i[d]!=="none"&&i[d]!=="0"&&(l=i[d]);if(a&&c.length&&l)for(let d=0;d<c.length;d++){const u=c[d];i[u]=iG(t,l)}return i}function vme({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:a,repeat:i,repeatType:s,repeatDelay:l,from:c,elapsed:d,...u}){return!!Object.keys(u).length}function tT(e,t){return e[t]||e.default||e}const xme={skipAnimations:!1},rT=(e,t,r,n={})=>a=>{const i=tT(n,e)||{},s=i.delay||n.delay||0;let{elapsed:l=0}=n;l=l-Wm(s);const c=gme(t,e,r,i),d=c[0],u=c[c.length-1],f=Ik(e,d),m=Ik(e,u);let h={keyframes:c,velocity:t.getVelocity(),ease:"easeOut",...i,delay:-l,onUpdate:v=>{t.set(v),i.onUpdate&&i.onUpdate(v)},onComplete:()=>{a(),i.onComplete&&i.onComplete()}};if(vme(i)||(h={...h,...dme(e,h)}),h.duration&&(h.duration=Wm(h.duration)),h.repeatDelay&&(h.repeatDelay=Wm(h.repeatDelay)),!f||!m||mfe.current||i.type===!1||xme.skipAnimations)return ome(h);if(!n.isHandoff&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const v=ame(t,e,h);if(v)return v}return fN(h)};function mN(e){return!!($l(e)&&e.add)}const lG=e=>/^\-?\d*\.?\d+$/.test(e);function nT(e,t){e.indexOf(t)===-1&&e.push(t)}function aT(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}class oT{constructor(){this.subscriptions=[]}add(t){return nT(this.subscriptions,t),()=>aT(this.subscriptions,t)}notify(t,r,n){const a=this.subscriptions.length;if(a)if(a===1)this.subscriptions[0](t,r,n);else for(let i=0;i<a;i++){const s=this.subscriptions[i];s&&s(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const yme=e=>!isNaN(parseFloat(e));class bme{constructor(t,r={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(n,a=!0)=>{this.prev=this.current,this.current=n;const{delta:i,timestamp:s}=Fs;this.lastUpdated!==s&&(this.timeDelta=i,this.lastUpdated=s,No.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),a&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>No.postRender(this.velocityCheck),this.velocityCheck=({timestamp:n})=>{n!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=yme(this.current),this.owner=r.owner}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new oT);const n=this.events[t].add(r);return t==="change"?()=>{n(),No.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,n){this.set(r),this.prev=t,this.timeDelta=n}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?nG(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function ox(e,t){return new bme(e,t)}const cG=e=>t=>t.test(e),wme={test:e=>e==="auto",parse:e=>e},dG=[ug,Kn,ku,lm,Aue,Pue,wme],L0=e=>dG.find(cG(e)),jme=[...dG,ol,ch],Nme=e=>jme.find(cG(e));function _me(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,ox(r))}function Sme(e,t){const r=OS(e,t);let{transitionEnd:n={},transition:a={},...i}=r?e.makeTargetAnimatable(r,!1):{};i={...i,...n};for(const s in i){const l=zue(i[s]);_me(e,s,l)}}function Cme(e,t,r){var n,a;const i=Object.keys(t).filter(l=>!e.hasValue(l)),s=i.length;if(s)for(let l=0;l<s;l++){const c=i[l],d=t[c];let u=null;Array.isArray(d)&&(u=d[0]),u===null&&(u=(a=(n=r[c])!==null&&n!==void 0?n:e.readValue(c))!==null&&a!==void 0?a:t[c]),u!=null&&(typeof u=="string"&&(lG(u)||sG(u))?u=parseFloat(u):!Nme(u)&&ch.test(d)&&(u=iG(c,d)),e.addValue(c,ox(u,{owner:e})),r[c]===void 0&&(r[c]=u),u!==null&&e.setBaseTarget(c,u))}}function Pme(e,t){return t?(t[e]||t.default||t).from:void 0}function Ame(e,t,r){const n={};for(const a in e){const i=Pme(a,t);if(i!==void 0)n[a]=i;else{const s=r.getValue(a);s&&(n[a]=s.get())}}return n}function Eme({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function kme(e,t){const r=e.get();if(Array.isArray(t)){for(let n=0;n<t.length;n++)if(t[n]!==r)return!0}else return r!==t}function uG(e,t,{delay:r=0,transitionOverride:n,type:a}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:s,...l}=e.makeTargetAnimatable(t);const c=e.getValue("willChange");n&&(i=n);const d=[],u=a&&e.animationState&&e.animationState.getState()[a];for(const f in l){const m=e.getValue(f),h=l[f];if(!m||h===void 0||u&&Eme(u,f))continue;const v={delay:r,elapsed:0,...tT(i||{},f)};if(window.HandoffAppearAnimations){const x=e.getProps()[fH];if(x){const b=window.HandoffAppearAnimations(x,f,m,No);b!==null&&(v.elapsed=b,v.isHandoff=!0)}}let g=!v.isHandoff&&!kme(m,h);if(v.type==="spring"&&(m.getVelocity()||v.velocity)&&(g=!1),m.animation&&(g=!1),g)continue;m.start(rT(f,m,h,e.shouldReduceMotion&&dg.has(f)?{type:!1}:v));const y=m.animation;mN(c)&&(c.add(f),y.then(()=>c.remove(f))),d.push(y)}return s&&Promise.all(d).then(()=>{s&&Sme(e,s)}),d}function Dk(e,t,r={}){const n=OS(e,t,r.custom);let{transition:a=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(a=r.transitionOverride);const i=n?()=>Promise.all(uG(e,n,r)):()=>Promise.resolve(),s=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:d=0,staggerChildren:u,staggerDirection:f}=a;return Ome(e,t,d+c,u,f,r)}:()=>Promise.resolve(),{when:l}=a;if(l){const[c,d]=l==="beforeChildren"?[i,s]:[s,i];return c().then(()=>d())}else return Promise.all([i(),s(r.delay)])}function Ome(e,t,r=0,n=0,a=1,i){const s=[],l=(e.variantChildren.size-1)*n,c=a===1?(d=0)=>d*n:(d=0)=>l-d*n;return Array.from(e.variantChildren).sort(Ime).forEach((d,u)=>{d.notify("AnimationStart",t),s.push(Dk(d,t,{...i,delay:r+c(u)}).then(()=>d.notify("AnimationComplete",t)))}),Promise.all(s)}function Ime(e,t){return e.sortNodePosition(t)}function Tme(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const a=t.map(i=>Dk(e,i,r));n=Promise.all(a)}else if(typeof t=="string")n=Dk(e,t,r);else{const a=typeof t=="function"?OS(e,t,r.custom):t;n=Promise.all(uG(e,a,r))}return n.then(()=>e.notify("AnimationComplete",t))}const Dme=[...BI].reverse(),Mme=BI.length;function Rme(e){return t=>Promise.all(t.map(({animation:r,options:n})=>Tme(e,r,n)))}function Lme(e){let t=Rme(e);const r=Fme();let n=!0;const a=(c,d)=>{const u=OS(e,d);if(u){const{transition:f,transitionEnd:m,...h}=u;c={...c,...h,...m}}return c};function i(c){t=c(e)}function s(c,d){const u=e.getProps(),f=e.getVariantContext(!0)||{},m=[],h=new Set;let v={},g=1/0;for(let x=0;x<Mme;x++){const b=Dme[x],w=r[b],j=u[b]!==void 0?u[b]:f[b],_=jb(j),C=b===d?w.isActive:null;C===!1&&(g=x);let E=j===f[b]&&j!==u[b]&&_;if(E&&n&&e.manuallyAnimateOnMount&&(E=!1),w.protectedKeys={...v},!w.isActive&&C===null||!j&&!w.prevProp||PS(j)||typeof j=="boolean")continue;let k=$me(w.prevProp,j)||b===d&&w.isActive&&!E&&_||x>g&&_,M=!1;const S=Array.isArray(j)?j:[j];let I=S.reduce(a,{});C===!1&&(I={});const{prevResolvedValues:T={}}=w,D={...T,...I},B=U=>{k=!0,h.has(U)&&(M=!0,h.delete(U)),w.needsAnimating[U]=!0};for(const U in D){const z=I[U],$=T[U];if(v.hasOwnProperty(U))continue;let Y=!1;cN(z)&&cN($)?Y=!DH(z,$):Y=z!==$,Y?z!==void 0?B(U):h.add(U):z!==void 0&&h.has(U)?B(U):w.protectedKeys[U]=!0}w.prevProp=j,w.prevResolvedValues=I,w.isActive&&(v={...v,...I}),n&&e.blockInitialAnimation&&(k=!1),k&&(!E||M)&&m.push(...S.map(U=>({animation:U,options:{type:b,...c}})))}if(h.size){const x={};h.forEach(b=>{const w=e.getBaseTarget(b);w!==void 0&&(x[b]=w)}),m.push({animation:x})}let y=!!m.length;return n&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(y=!1),n=!1,y?t(m):Promise.resolve()}function l(c,d,u){var f;if(r[c].isActive===d)return Promise.resolve();(f=e.variantChildren)===null||f===void 0||f.forEach(h=>{var v;return(v=h.animationState)===null||v===void 0?void 0:v.setActive(c,d)}),r[c].isActive=d;const m=s(u,c);for(const h in r)r[h].protectedKeys={};return m}return{animateChanges:s,setActive:l,setAnimateFunction:i,getState:()=>r}}function $me(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!DH(t,e):!1}function Rh(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Fme(){return{animate:Rh(!0),whileInView:Rh(),whileHover:Rh(),whileTap:Rh(),whileDrag:Rh(),whileFocus:Rh(),exit:Rh()}}class Bme extends bh{constructor(t){super(t),t.animationState||(t.animationState=Lme(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),PS(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){}}let qme=0;class zme extends bh{constructor(){super(...arguments),this.id=qme++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r,custom:n}=this.node.presenceContext,{isPresent:a}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===a)return;const i=this.node.animationState.setActive("exit",!t,{custom:n??this.node.getProps().custom});r&&!t&&i.then(()=>r(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const Ume={animation:{Feature:Bme},exit:{Feature:zme}},w6=(e,t)=>Math.abs(e-t);function Vme(e,t){const r=w6(e.x,t.x),n=w6(e.y,t.y);return Math.sqrt(r**2+n**2)}class fG{constructor(t,r,{transformPagePoint:n,contextWindow:a,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=SP(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,h=Vme(f.offset,{x:0,y:0})>=3;if(!m&&!h)return;const{point:v}=f,{timestamp:g}=Fs;this.history.push({...v,timestamp:g});const{onStart:y,onMove:x}=this.handlers;m||(y&&y(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,f)},this.handlePointerMove=(f,m)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=_P(m,this.transformPagePoint),No.update(this.updatePoint,!0)},this.handlePointerUp=(f,m)=>{this.end();const{onEnd:h,onSessionEnd:v,resumeAnimation:g}=this.handlers;if(this.dragSnapToOrigin&&g&&g(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=SP(f.type==="pointercancel"?this.lastMoveEventInfo:_P(m,this.transformPagePoint),this.history);this.startEvent&&h&&h(f,y),v&&v(f,y)},!EH(t))return;this.dragSnapToOrigin=i,this.handlers=r,this.transformPagePoint=n,this.contextWindow=a||window;const s=kS(t),l=_P(s,this.transformPagePoint),{point:c}=l,{timestamp:d}=Fs;this.history=[{...c,timestamp:d}];const{onSessionStart:u}=r;u&&u(t,SP(l,this.history)),this.removeListeners=Vm(bf(this.contextWindow,"pointermove",this.handlePointerMove),bf(this.contextWindow,"pointerup",this.handlePointerUp),bf(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Ef(this.updatePoint)}}function _P(e,t){return t?{point:t(e.point)}:e}function j6(e,t){return{x:e.x-t.x,y:e.y-t.y}}function SP({point:e},t){return{point:e,delta:j6(e,mG(t)),offset:j6(e,Wme(t)),velocity:Hme(t,.1)}}function Wme(e){return e[0]}function mG(e){return e[e.length-1]}function Hme(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const a=mG(e);for(;r>=0&&(n=e[r],!(a.timestamp-n.timestamp>Wm(t)));)r--;if(!n)return{x:0,y:0};const i=wf(a.timestamp-n.timestamp);if(i===0)return{x:0,y:0};const s={x:(a.x-n.x)/i,y:(a.y-n.y)/i};return s.x===1/0&&(s.x=0),s.y===1/0&&(s.y=0),s}function _c(e){return e.max-e.min}function Mk(e,t=0,r=.01){return Math.abs(e-t)<=r}function N6(e,t,r,n=.5){e.origin=n,e.originPoint=Ho(t.min,t.max,e.origin),e.scale=_c(r)/_c(t),(Mk(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=Ho(r.min,r.max,e.origin)-e.originPoint,(Mk(e.translate)||isNaN(e.translate))&&(e.translate=0)}function ky(e,t,r,n){N6(e.x,t.x,r.x,n?n.originX:void 0),N6(e.y,t.y,r.y,n?n.originY:void 0)}function _6(e,t,r){e.min=r.min+t.min,e.max=e.min+_c(t)}function Gme(e,t,r){_6(e.x,t.x,r.x),_6(e.y,t.y,r.y)}function S6(e,t,r){e.min=t.min-r.min,e.max=e.min+_c(t)}function Oy(e,t,r){S6(e.x,t.x,r.x),S6(e.y,t.y,r.y)}function Kme(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?Ho(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?Ho(r,e,n.max):Math.min(e,r)),e}function C6(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function Yme(e,{top:t,left:r,bottom:n,right:a}){return{x:C6(e.x,r,a),y:C6(e.y,t,n)}}function P6(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function Xme(e,t){return{x:P6(e.x,t.x),y:P6(e.y,t.y)}}function Jme(e,t){let r=.5;const n=_c(e),a=_c(t);return a>n?r=_b(t.min,t.max-n,e.min):n>a&&(r=_b(e.min,e.max-a,t.min)),lh(0,1,r)}function Qme(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const Rk=.35;function Zme(e=Rk){return e===!1?e=0:e===!0&&(e=Rk),{x:A6(e,"left","right"),y:A6(e,"top","bottom")}}function A6(e,t,r){return{min:E6(e,t),max:E6(e,r)}}function E6(e,t){return typeof e=="number"?e:e[t]||0}const k6=()=>({translate:0,scale:1,origin:0,originPoint:0}),yv=()=>({x:k6(),y:k6()}),O6=()=>({min:0,max:0}),ji=()=>({x:O6(),y:O6()});function Uc(e){return[e("x"),e("y")]}function hG({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function ehe({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function the(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function CP(e){return e===void 0||e===1}function Lk({scale:e,scaleX:t,scaleY:r}){return!CP(e)||!CP(t)||!CP(r)}function Hh(e){return Lk(e)||pG(e)||e.z||e.rotate||e.rotateX||e.rotateY}function pG(e){return I6(e.x)||I6(e.y)}function I6(e){return e&&e!=="0%"}function hN(e,t,r){const n=e-r,a=t*n;return r+a}function T6(e,t,r,n,a){return a!==void 0&&(e=hN(e,a,n)),hN(e,r,n)+t}function $k(e,t=0,r=1,n,a){e.min=T6(e.min,t,r,n,a),e.max=T6(e.max,t,r,n,a)}function gG(e,{x:t,y:r}){$k(e.x,t.translate,t.scale,t.originPoint),$k(e.y,r.translate,r.scale,r.originPoint)}function rhe(e,t,r,n=!1){const a=r.length;if(!a)return;t.x=t.y=1;let i,s;for(let l=0;l<a;l++){i=r[l],s=i.projectionDelta;const c=i.instance;c&&c.style&&c.style.display==="contents"||(n&&i.options.layoutScroll&&i.scroll&&i!==i.root&&bv(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),s&&(t.x*=s.x.scale,t.y*=s.y.scale,gG(e,s)),n&&Hh(i.latestValues)&&bv(e,i.latestValues))}t.x=D6(t.x),t.y=D6(t.y)}function D6(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function pm(e,t){e.min=e.min+t,e.max=e.max+t}function M6(e,t,[r,n,a]){const i=t[a]!==void 0?t[a]:.5,s=Ho(e.min,e.max,i);$k(e,t[r],t[n],s,t.scale)}const nhe=["x","scaleX","originX"],ahe=["y","scaleY","originY"];function bv(e,t){M6(e.x,t,nhe),M6(e.y,t,ahe)}function vG(e,t){return hG(the(e.getBoundingClientRect(),t))}function ohe(e,t,r){const n=vG(e,r),{scroll:a}=t;return a&&(pm(n.x,a.offset.x),pm(n.y,a.offset.y)),n}const xG=({current:e})=>e?e.ownerDocument.defaultView:null,ihe=new WeakMap;class she{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ji(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const a=u=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(kS(u,"page").point)},i=(u,f)=>{const{drag:m,dragPropagation:h,onDragStart:v}=this.getProps();if(m&&!h&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=OH(m),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Uc(y=>{let x=this.getAxisMotionValue(y).get()||0;if(ku.test(x)){const{projection:b}=this.visualElement;if(b&&b.layout){const w=b.layout.layoutBox[y];w&&(x=_c(w)*(parseFloat(x)/100))}}this.originPoint[y]=x}),v&&No.update(()=>v(u,f),!1,!0);const{animationState:g}=this.visualElement;g&&g.setActive("whileDrag",!0)},s=(u,f)=>{const{dragPropagation:m,dragDirectionLock:h,onDirectionLock:v,onDrag:g}=this.getProps();if(!m&&!this.openGlobalLock)return;const{offset:y}=f;if(h&&this.currentDirection===null){this.currentDirection=lhe(y),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",f.point,y),this.updateAxis("y",f.point,y),this.visualElement.render(),g&&g(u,f)},l=(u,f)=>this.stop(u,f),c=()=>Uc(u=>{var f;return this.getAnimationState(u)==="paused"&&((f=this.getAxisMotionValue(u).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new fG(t,{onSessionStart:a,onStart:i,onMove:s,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,contextWindow:xG(this.visualElement)})}stop(t,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:a}=r;this.startAnimation(a);const{onDragEnd:i}=this.getProps();i&&No.update(()=>i(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:a}=this.getProps();if(!n||!o2(t,a,this.currentDirection))return;const i=this.getAxisMotionValue(t);let s=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(s=Kme(s,this.constraints[t],this.elastic[t])),i.set(s)}resolveConstraints(){var t;const{dragConstraints:r,dragElastic:n}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,i=this.constraints;r&&vv(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&a?this.constraints=Yme(a.layoutBox,r):this.constraints=!1,this.elastic=Zme(n),i!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&Uc(s=>{this.getAxisMotionValue(s)&&(this.constraints[s]=Qme(a.layoutBox[s],this.constraints[s]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!vv(t))return!1;const n=t.current,{projection:a}=this.visualElement;if(!a||!a.layout)return!1;const i=ohe(n,a.root,this.visualElement.getTransformPagePoint());let s=Xme(a.layout.layoutBox,i);if(r){const l=r(ehe(s));this.hasMutatedConstraints=!!l,l&&(s=hG(l))}return s}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:a,dragTransition:i,dragSnapToOrigin:s,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},d=Uc(u=>{if(!o2(u,r,this.currentDirection))return;let f=c&&c[u]||{};s&&(f={min:0,max:0});const m=a?200:1e6,h=a?40:1e7,v={type:"inertia",velocity:n?t[u]:0,bounceStiffness:m,bounceDamping:h,timeConstant:750,restDelta:1,restSpeed:10,...i,...f};return this.startAxisValueAnimation(u,v)});return Promise.all(d).then(l)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return n.start(rT(t,n,0,r))}stopAnimation(){Uc(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Uc(t=>{var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(t){const r="_drag"+t.toUpperCase(),n=this.visualElement.getProps(),a=n[r];return a||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){Uc(r=>{const{drag:n}=this.getProps();if(!o2(r,n,this.currentDirection))return;const{projection:a}=this.visualElement,i=this.getAxisMotionValue(r);if(a&&a.layout){const{min:s,max:l}=a.layout.layoutBox[r];i.set(t[r]-Ho(s,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!vv(r)||!n||!this.constraints)return;this.stopAnimation();const a={x:0,y:0};Uc(s=>{const l=this.getAxisMotionValue(s);if(l){const c=l.get();a[s]=Jme({min:c,max:c},this.constraints[s])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Uc(s=>{if(!o2(s,t,null))return;const l=this.getAxisMotionValue(s),{min:c,max:d}=this.constraints[s];l.set(Ho(c,d,a[s]))})}addListeners(){if(!this.visualElement.current)return;ihe.set(this.visualElement,this);const t=this.visualElement.current,r=bf(t,"pointerdown",c=>{const{drag:d,dragListener:u=!0}=this.getProps();d&&u&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();vv(c)&&(this.constraints=this.resolveRefConstraints())},{projection:a}=this.visualElement,i=a.addEventListener("measure",n);a&&!a.layout&&(a.root&&a.root.updateScroll(),a.updateLayout()),n();const s=hf(window,"resize",()=>this.scalePositionWithinConstraints()),l=a.addEventListener("didUpdate",({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&(Uc(u=>{const f=this.getAxisMotionValue(u);f&&(this.originPoint[u]+=c[u].translate,f.set(f.get()+c[u].translate))}),this.visualElement.render())});return()=>{s(),r(),i(),l&&l()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:a=!1,dragConstraints:i=!1,dragElastic:s=Rk,dragMomentum:l=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:a,dragConstraints:i,dragElastic:s,dragMomentum:l}}}function o2(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function lhe(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class che extends bh{constructor(t){super(t),this.removeGroupControls=oi,this.removeListeners=oi,this.controls=new she(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||oi}unmount(){this.removeGroupControls(),this.removeListeners()}}const R6=e=>(t,r)=>{e&&No.update(()=>e(t,r))};class dhe extends bh{constructor(){super(...arguments),this.removePointerDownListener=oi}onPointerDown(t){this.session=new fG(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:xG(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:a}=this.node.getProps();return{onSessionStart:R6(t),onStart:R6(r),onMove:n,onEnd:(i,s)=>{delete this.session,a&&No.update(()=>a(i,s))}}}mount(){this.removePointerDownListener=bf(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function uhe(){const e=p.useContext(SS);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:n}=e,a=p.useId();return p.useEffect(()=>n(a),[]),!t&&r?[!1,()=>r&&r(a)]:[!0]}const fj={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function L6(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const $0={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Kn.test(e))e=parseFloat(e);else return e;const r=L6(e,t.target.x),n=L6(e,t.target.y);return`${r}% ${n}%`}},fhe={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,a=ch.parse(e);if(a.length>5)return n;const i=ch.createTransformer(e),s=typeof a[0]!="number"?1:0,l=r.x.scale*t.x,c=r.y.scale*t.y;a[0+s]/=l,a[1+s]/=c;const d=Ho(l,c,.5);return typeof a[2+s]=="number"&&(a[2+s]/=d),typeof a[3+s]=="number"&&(a[3+s]/=d),i(a)}};class mhe extends ye.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:a}=this.props,{projection:i}=t;bue(hhe),i&&(r.group&&r.group.add(i),n&&n.register&&a&&n.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),fj.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:a,isPresent:i}=this.props,s=n.projection;return s&&(s.isPresent=i,a||t.layoutDependency!==r||r===void 0?s.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?s.promote():s.relegate()||No.postRender(()=>{const l=s.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:a}=t;a&&(a.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(a),n&&n.deregister&&n.deregister(a))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function yG(e){const[t,r]=uhe(),n=p.useContext(zI);return ye.createElement(mhe,{...e,layoutGroup:n,switchLayoutGroup:p.useContext(hH),isPresent:t,safeToRemove:r})}const hhe={borderRadius:{...$0,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:$0,borderTopRightRadius:$0,borderBottomLeftRadius:$0,borderBottomRightRadius:$0,boxShadow:fhe},bG=["TopLeft","TopRight","BottomLeft","BottomRight"],phe=bG.length,$6=e=>typeof e=="string"?parseFloat(e):e,F6=e=>typeof e=="number"||Kn.test(e);function ghe(e,t,r,n,a,i){a?(e.opacity=Ho(0,r.opacity!==void 0?r.opacity:1,vhe(n)),e.opacityExit=Ho(t.opacity!==void 0?t.opacity:1,0,xhe(n))):i&&(e.opacity=Ho(t.opacity!==void 0?t.opacity:1,r.opacity!==void 0?r.opacity:1,n));for(let s=0;s<phe;s++){const l=`border${bG[s]}Radius`;let c=B6(t,l),d=B6(r,l);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||F6(c)===F6(d)?(e[l]=Math.max(Ho($6(c),$6(d),n),0),(ku.test(d)||ku.test(c))&&(e[l]+="%")):e[l]=d}(t.rotate||r.rotate)&&(e.rotate=Ho(t.rotate||0,r.rotate||0,n))}function B6(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const vhe=wG(0,.5,UH),xhe=wG(.5,.95,oi);function wG(e,t,r){return n=>n<e?0:n>t?1:r(_b(e,t,n))}function q6(e,t){e.min=t.min,e.max=t.max}function $c(e,t){q6(e.x,t.x),q6(e.y,t.y)}function z6(e,t,r,n,a){return e-=t,e=hN(e,1/r,n),a!==void 0&&(e=hN(e,1/a,n)),e}function yhe(e,t=0,r=1,n=.5,a,i=e,s=e){if(ku.test(t)&&(t=parseFloat(t),t=Ho(s.min,s.max,t/100)-s.min),typeof t!="number")return;let l=Ho(i.min,i.max,n);e===i&&(l-=t),e.min=z6(e.min,t,r,l,a),e.max=z6(e.max,t,r,l,a)}function U6(e,t,[r,n,a],i,s){yhe(e,t[r],t[n],t[a],t.scale,i,s)}const bhe=["x","scaleX","originX"],whe=["y","scaleY","originY"];function V6(e,t,r,n){U6(e.x,t,bhe,r?r.x:void 0,n?n.x:void 0),U6(e.y,t,whe,r?r.y:void 0,n?n.y:void 0)}function W6(e){return e.translate===0&&e.scale===1}function jG(e){return W6(e.x)&&W6(e.y)}function jhe(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function NG(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function H6(e){return _c(e.x)/_c(e.y)}class Nhe{constructor(){this.members=[]}add(t){nT(this.members,t),t.scheduleRender()}remove(t){if(aT(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(a=>t===a);if(r===0)return!1;let n;for(let a=r;a>=0;a--){const i=this.members[a];if(i.isPresent!==!1){n=i;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:a}=t.options;a===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function G6(e,t,r){let n="";const a=e.x.translate/t.x,i=e.y.translate/t.y;if((a||i)&&(n=`translate3d(${a}px, ${i}px, 0) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{rotate:c,rotateX:d,rotateY:u}=r;c&&(n+=`rotate(${c}deg) `),d&&(n+=`rotateX(${d}deg) `),u&&(n+=`rotateY(${u}deg) `)}const s=e.x.scale*t.x,l=e.y.scale*t.y;return(s!==1||l!==1)&&(n+=`scale(${s}, ${l})`),n||"none"}const _he=(e,t)=>e.depth-t.depth;class She{constructor(){this.children=[],this.isDirty=!1}add(t){nT(this.children,t),this.isDirty=!0}remove(t){aT(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(_he),this.isDirty=!1,this.children.forEach(t)}}function Che(e,t){const r=performance.now(),n=({timestamp:a})=>{const i=a-r;i>=t&&(Ef(n),e(i-t))};return No.read(n,!0),()=>Ef(n)}function Phe(e){window.MotionDebug&&window.MotionDebug.record(e)}function Ahe(e){return e instanceof SVGElement&&e.tagName!=="svg"}function Ehe(e,t,r){const n=$l(e)?e:ox(e);return n.start(rT("",n,t,r)),n.animation}const K6=["","X","Y","Z"],khe={visibility:"hidden"},Y6=1e3;let Ohe=0;const Gh={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function _G({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:a}){return class{constructor(s={},l=t?.()){this.id=Ohe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Gh.totalNodes=Gh.resolvedTargetDeltas=Gh.recalculatedProjection=0,this.nodes.forEach(Dhe),this.nodes.forEach(Fhe),this.nodes.forEach(Bhe),this.nodes.forEach(Mhe),Phe(Gh)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=s,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new She)}addEventListener(s,l){return this.eventHandlers.has(s)||this.eventHandlers.set(s,new oT),this.eventHandlers.get(s).add(l)}notifyListeners(s,...l){const c=this.eventHandlers.get(s);c&&c.notify(...l)}hasListeners(s){return this.eventHandlers.has(s)}mount(s,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Ahe(s),this.instance=s;const{layoutId:c,layout:d,visualElement:u}=this.options;if(u&&!u.current&&u.mount(s),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(d||c)&&(this.isLayoutDirty=!0),e){let f;const m=()=>this.root.updateBlockedByResize=!1;e(s,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=Che(m,250),fj.hasAnimatedSinceResize&&(fj.hasAnimatedSinceResize=!1,this.nodes.forEach(J6))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&u&&(c||d)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:m,hasRelativeTargetChanged:h,layout:v})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const g=this.options.transition||u.getDefaultTransition()||Whe,{onLayoutAnimationStart:y,onLayoutAnimationComplete:x}=u.getProps(),b=!this.targetLayout||!NG(this.targetLayout,v)||h,w=!m&&h;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||w||m&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,w);const j={...tT(g,"layout"),onPlay:y,onComplete:x};(u.shouldReduceMotion||this.options.layoutRoot)&&(j.delay=0,j.type=!1),this.startAnimation(j)}else m||J6(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=v})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const s=this.getStack();s&&s.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Ef(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(qhe),this.animationId++)}getTransformTemplate(){const{visualElement:s}=this.options;return s&&s.getProps().transformTemplate}willUpdate(s=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const f=this.path[u];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),s&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(X6);return}this.isUpdating||this.nodes.forEach(Lhe),this.isUpdating=!1,this.nodes.forEach($he),this.nodes.forEach(Ihe),this.nodes.forEach(The),this.clearAllSnapshots();const l=performance.now();Fs.delta=lh(0,1e3/60,l-Fs.timestamp),Fs.timestamp=l,Fs.isProcessing=!0,gP.update.process(Fs),gP.preRender.process(Fs),gP.render.process(Fs),Fs.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(Rhe),this.sharedNodes.forEach(zhe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,No.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){No.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const s=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ji(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,s?s.layoutBox:void 0)}updateScroll(s="measure"){let l=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===s&&(l=!1),l&&(this.scroll={animationId:this.root.animationId,phase:s,isRoot:n(this.instance),offset:r(this.instance)})}resetTransform(){if(!a)return;const s=this.isLayoutDirty||this.shouldResetTransform,l=this.projectionDelta&&!jG(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,u=d!==this.prevTransformTemplateValue;s&&(l||Hh(this.latestValues)||u)&&(a(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(s=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return s&&(c=this.removeTransform(c)),Hhe(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:s}=this.options;if(!s)return ji();const l=s.measureViewportBox(),{scroll:c}=this.root;return c&&(pm(l.x,c.offset.x),pm(l.y,c.offset.y)),l}removeElementScroll(s){const l=ji();$c(l,s);for(let c=0;c<this.path.length;c++){const d=this.path[c],{scroll:u,options:f}=d;if(d!==this.root&&u&&f.layoutScroll){if(u.isRoot){$c(l,s);const{scroll:m}=this.root;m&&(pm(l.x,-m.offset.x),pm(l.y,-m.offset.y))}pm(l.x,u.offset.x),pm(l.y,u.offset.y)}}return l}applyTransform(s,l=!1){const c=ji();$c(c,s);for(let d=0;d<this.path.length;d++){const u=this.path[d];!l&&u.options.layoutScroll&&u.scroll&&u!==u.root&&bv(c,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Hh(u.latestValues)&&bv(c,u.latestValues)}return Hh(this.latestValues)&&bv(c,this.latestValues),c}removeTransform(s){const l=ji();$c(l,s);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!Hh(d.latestValues))continue;Lk(d.latestValues)&&d.updateSnapshot();const u=ji(),f=d.measurePageBox();$c(u,f),V6(l,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,u)}return Hh(this.latestValues)&&V6(l,this.latestValues),l}setTargetDelta(s){this.targetDelta=s,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(s){this.options={...this.options,...s,crossfade:s.crossfade!==void 0?s.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Fs.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(s=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==c;if(!(s||d&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:f,layoutId:m}=this.options;if(!(!this.layout||!(f||m))){if(this.resolvedRelativeTargetAt=Fs.timestamp,!this.targetDelta&&!this.relativeTarget){const h=this.getClosestProjectingParent();h&&h.layout&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ji(),this.relativeTargetOrigin=ji(),Oy(this.relativeTargetOrigin,this.layout.layoutBox,h.layout.layoutBox),$c(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=ji(),this.targetWithTransforms=ji()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Gme(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):$c(this.target,this.layout.layoutBox),gG(this.target,this.targetDelta)):$c(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const h=this.getClosestProjectingParent();h&&!!h.resumingFrom==!!this.resumingFrom&&!h.options.layoutScroll&&h.target&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ji(),this.relativeTargetOrigin=ji(),Oy(this.relativeTargetOrigin,this.target,h.target),$c(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Gh.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Lk(this.parent.latestValues)||pG(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var s;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let d=!0;if((this.isProjectionDirty||!((s=this.parent)===null||s===void 0)&&s.isProjectionDirty)&&(d=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===Fs.timestamp&&(d=!1),d)return;const{layout:u,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||f))return;$c(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,h=this.treeScale.y;rhe(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox);const{target:v}=l;if(!v){this.projectionTransform&&(this.projectionDelta=yv(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=yv(),this.projectionDeltaWithTransform=yv());const g=this.projectionTransform;ky(this.projectionDelta,this.layoutCorrected,v,this.latestValues),this.projectionTransform=G6(this.projectionDelta,this.treeScale),(this.projectionTransform!==g||this.treeScale.x!==m||this.treeScale.y!==h)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",v)),Gh.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(s=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),s){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(s,l=!1){const c=this.snapshot,d=c?c.latestValues:{},u={...this.latestValues},f=yv();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const m=ji(),h=c?c.source:void 0,v=this.layout?this.layout.source:void 0,g=h!==v,y=this.getStack(),x=!y||y.members.length<=1,b=!!(g&&!x&&this.options.crossfade===!0&&!this.path.some(Vhe));this.animationProgress=0;let w;this.mixTargetDelta=j=>{const _=j/1e3;Q6(f.x,s.x,_),Q6(f.y,s.y,_),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Oy(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Uhe(this.relativeTarget,this.relativeTargetOrigin,m,_),w&&jhe(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=ji()),$c(w,this.relativeTarget)),g&&(this.animationValues=u,ghe(u,d,this.latestValues,_,b,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=_},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(s){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Ef(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=No.update(()=>{fj.hasAnimatedSinceResize=!0,this.currentAnimation=Ehe(0,Y6,{...s,onUpdate:l=>{this.mixTargetDelta(l),s.onUpdate&&s.onUpdate(l)},onComplete:()=>{s.onComplete&&s.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const s=this.getStack();s&&s.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Y6),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const s=this.getLead();let{targetWithTransforms:l,target:c,layout:d,latestValues:u}=s;if(!(!l||!c||!d)){if(this!==s&&this.layout&&d&&SG(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||ji();const f=_c(this.layout.layoutBox.x);c.x.min=s.target.x.min,c.x.max=c.x.min+f;const m=_c(this.layout.layoutBox.y);c.y.min=s.target.y.min,c.y.max=c.y.min+m}$c(l,c),bv(l,u),ky(this.projectionDeltaWithTransform,this.layoutCorrected,l,u)}}registerSharedNode(s,l){this.sharedNodes.has(s)||this.sharedNodes.set(s,new Nhe),this.sharedNodes.get(s).add(l);const d=l.options.initialPromotionConfig;l.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(l):void 0})}isLead(){const s=this.getStack();return s?s.lead===this:!0}getLead(){var s;const{layoutId:l}=this.options;return l?((s=this.getStack())===null||s===void 0?void 0:s.lead)||this:this}getPrevLead(){var s;const{layoutId:l}=this.options;return l?(s=this.getStack())===null||s===void 0?void 0:s.prevLead:void 0}getStack(){const{layoutId:s}=this.options;if(s)return this.root.sharedNodes.get(s)}promote({needsReset:s,transition:l,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),s&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const s=this.getStack();return s?s.relegate(this):!1}resetRotation(){const{visualElement:s}=this.options;if(!s)return;let l=!1;const{latestValues:c}=s;if((c.rotate||c.rotateX||c.rotateY||c.rotateZ)&&(l=!0),!l)return;const d={};for(let u=0;u<K6.length;u++){const f="rotate"+K6[u];c[f]&&(d[f]=c[f],s.setStaticValue(f,0))}s.render();for(const u in d)s.setStaticValue(u,d[u]);s.scheduleRender()}getProjectionStyles(s){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return khe;const d={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,d.opacity="",d.pointerEvents=uj(s?.pointerEvents)||"",d.transform=u?u(this.latestValues,""):"none",d;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const g={};return this.options.layoutId&&(g.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,g.pointerEvents=uj(s?.pointerEvents)||""),this.hasProjected&&!Hh(this.latestValues)&&(g.transform=u?u({},""):"none",this.hasProjected=!1),g}const m=f.animationValues||f.latestValues;this.applyTransformsToTarget(),d.transform=G6(this.projectionDeltaWithTransform,this.treeScale,m),u&&(d.transform=u(m,d.transform));const{x:h,y:v}=this.projectionDelta;d.transformOrigin=`${h.origin*100}% ${v.origin*100}% 0`,f.animationValues?d.opacity=f===this?(c=(l=m.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:d.opacity=f===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const g in sN){if(m[g]===void 0)continue;const{correct:y,applyTo:x}=sN[g],b=d.transform==="none"?m[g]:y(m[g],f);if(x){const w=x.length;for(let j=0;j<w;j++)d[x[j]]=b}else d[g]=b}return this.options.layoutId&&(d.pointerEvents=f===this?uj(s?.pointerEvents)||"":"none"),d}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(s=>{var l;return(l=s.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(X6),this.root.sharedNodes.clear()}}}function Ihe(e){e.updateLayout()}function The(e){var t;const r=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:a}=e.layout,{animationType:i}=e.options,s=r.source!==e.layout.source;i==="size"?Uc(f=>{const m=s?r.measuredBox[f]:r.layoutBox[f],h=_c(m);m.min=n[f].min,m.max=m.min+h}):SG(i,r.layoutBox,n)&&Uc(f=>{const m=s?r.measuredBox[f]:r.layoutBox[f],h=_c(n[f]);m.max=m.min+h,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[f].max=e.relativeTarget[f].min+h)});const l=yv();ky(l,n,r.layoutBox);const c=yv();s?ky(c,e.applyTransform(a,!0),r.measuredBox):ky(c,n,r.layoutBox);const d=!jG(l);let u=!1;if(!e.resumeFrom){const f=e.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:m,layout:h}=f;if(m&&h){const v=ji();Oy(v,r.layoutBox,m.layoutBox);const g=ji();Oy(g,n,h.layoutBox),NG(v,g)||(u=!0),f.options.layoutRoot&&(e.relativeTarget=g,e.relativeTargetOrigin=v,e.relativeParent=f)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:c,layoutDelta:l,hasLayoutChanged:d,hasRelativeTargetChanged:u})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function Dhe(e){Gh.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Mhe(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Rhe(e){e.clearSnapshot()}function X6(e){e.clearMeasurements()}function Lhe(e){e.isLayoutDirty=!1}function $he(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function J6(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Fhe(e){e.resolveTargetDelta()}function Bhe(e){e.calcProjection()}function qhe(e){e.resetRotation()}function zhe(e){e.removeLeadSnapshot()}function Q6(e,t,r){e.translate=Ho(t.translate,0,r),e.scale=Ho(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function Z6(e,t,r,n){e.min=Ho(t.min,r.min,n),e.max=Ho(t.max,r.max,n)}function Uhe(e,t,r,n){Z6(e.x,t.x,r.x,n),Z6(e.y,t.y,r.y,n)}function Vhe(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Whe={duration:.45,ease:[.4,0,.1,1]},e$=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),t$=e$("applewebkit/")&&!e$("chrome/")?Math.round:oi;function r$(e){e.min=t$(e.min),e.max=t$(e.max)}function Hhe(e){r$(e.x),r$(e.y)}function SG(e,t,r){return e==="position"||e==="preserve-aspect"&&!Mk(H6(t),H6(r),.2)}const Ghe=_G({attachResizeListener:(e,t)=>hf(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),PP={current:void 0},CG=_G({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!PP.current){const e=new Ghe({});e.mount(window),e.setOptions({layoutScroll:!0}),PP.current=e}return PP.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Khe={pan:{Feature:dhe},drag:{Feature:che,ProjectionNode:CG,MeasureLayout:yG}},Yhe=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function Xhe(e){const t=Yhe.exec(e);if(!t)return[,];const[,r,n]=t;return[r,n]}function Fk(e,t,r=1){const[n,a]=Xhe(e);if(!n)return;const i=window.getComputedStyle(t).getPropertyValue(n);if(i){const s=i.trim();return lG(s)?parseFloat(s):s}else return Ak(a)?Fk(a,t,r+1):a}function Jhe(e,{...t},r){const n=e.current;if(!(n instanceof Element))return{target:t,transitionEnd:r};r&&(r={...r}),e.values.forEach(a=>{const i=a.get();if(!Ak(i))return;const s=Fk(i,n);s&&a.set(s)});for(const a in t){const i=t[a];if(!Ak(i))continue;const s=Fk(i,n);s&&(t[a]=s,r||(r={}),r[a]===void 0&&(r[a]=i))}return{target:t,transitionEnd:r}}const Qhe=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),PG=e=>Qhe.has(e),Zhe=e=>Object.keys(e).some(PG),n$=e=>e===ug||e===Kn,a$=(e,t)=>parseFloat(e.split(", ")[t]),o$=(e,t)=>(r,{transform:n})=>{if(n==="none"||!n)return 0;const a=n.match(/^matrix3d\((.+)\)$/);if(a)return a$(a[1],t);{const i=n.match(/^matrix\((.+)\)$/);return i?a$(i[1],e):0}},epe=new Set(["x","y","z"]),tpe=F1.filter(e=>!epe.has(e));function rpe(e){const t=[];return tpe.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t.length&&e.render(),t}const ix={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:o$(4,13),y:o$(5,14)};ix.translateX=ix.x;ix.translateY=ix.y;const npe=(e,t,r)=>{const n=t.measureViewportBox(),a=t.current,i=getComputedStyle(a),{display:s}=i,l={};s==="none"&&t.setStaticValue("display",e.display||"block"),r.forEach(d=>{l[d]=ix[d](n,i)}),t.render();const c=t.measureViewportBox();return r.forEach(d=>{const u=t.getValue(d);u&&u.jump(l[d]),e[d]=ix[d](c,i)}),e},ape=(e,t,r={},n={})=>{t={...t},n={...n};const a=Object.keys(t).filter(PG);let i=[],s=!1;const l=[];if(a.forEach(c=>{const d=e.getValue(c);if(!e.hasValue(c))return;let u=r[c],f=L0(u);const m=t[c];let h;if(cN(m)){const v=m.length,g=m[0]===null?1:0;u=m[g],f=L0(u);for(let y=g;y<v&&m[y]!==null;y++)h?XI(L0(m[y])===h):h=L0(m[y])}else h=L0(m);if(f!==h)if(n$(f)&&n$(h)){const v=d.get();typeof v=="string"&&d.set(parseFloat(v)),typeof m=="string"?t[c]=parseFloat(m):Array.isArray(m)&&h===Kn&&(t[c]=m.map(parseFloat))}else f?.transform&&h?.transform&&(u===0||m===0)?u===0?d.set(h.transform(u)):t[c]=f.transform(m):(s||(i=rpe(e),s=!0),l.push(c),n[c]=n[c]!==void 0?n[c]:t[c],d.jump(m))}),l.length){const c=l.indexOf("height")>=0?window.pageYOffset:null,d=npe(t,e,l);return i.length&&i.forEach(([u,f])=>{e.getValue(u).set(f)}),e.render(),CS&&c!==null&&window.scrollTo({top:c}),{target:d,transitionEnd:n}}else return{target:t,transitionEnd:n}};function ope(e,t,r,n){return Zhe(t)?ape(e,t,r,n):{target:t,transitionEnd:n}}const ipe=(e,t,r,n)=>{const a=Jhe(e,t,n);return t=a.target,n=a.transitionEnd,ope(e,t,r,n)},Bk={current:null},AG={current:!1};function spe(){if(AG.current=!0,!!CS)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>Bk.current=e.matches;e.addListener(t),t()}else Bk.current=!1}function lpe(e,t,r){const{willChange:n}=t;for(const a in t){const i=t[a],s=r[a];if($l(i))e.addValue(a,i),mN(n)&&n.add(a);else if($l(s))e.addValue(a,ox(i,{owner:e})),mN(n)&&n.remove(a);else if(s!==i)if(e.hasValue(a)){const l=e.getValue(a);!l.hasAnimated&&l.set(i)}else{const l=e.getStaticValue(a);e.addValue(a,ox(l!==void 0?l:i,{owner:e}))}}for(const a in r)t[a]===void 0&&e.removeValue(a);return t}const i$=new WeakMap,EG=Object.keys(Nb),cpe=EG.length,s$=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],dpe=qI.length;class upe{constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:a,visualState:i},s={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>No.render(this.render,!1,!0);const{latestValues:l,renderState:c}=i;this.latestValues=l,this.baseTarget={...l},this.initialValues=r.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=a,this.options=s,this.isControllingVariants=AS(r),this.isVariantNode=mH(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:d,...u}=this.scrapeMotionValuesFromProps(r,{});for(const f in u){const m=u[f];l[f]!==void 0&&$l(m)&&(m.set(l[f],!1),mN(d)&&d.add(f))}}scrapeMotionValuesFromProps(t,r){return{}}mount(t){this.current=t,i$.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),AG.current||spe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Bk.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){i$.delete(this.current),this.projection&&this.projection.unmount(),Ef(this.notifyUpdate),Ef(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,r){const n=dg.has(t),a=r.on("change",s=>{this.latestValues[t]=s,this.props.onUpdate&&No.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),i=r.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{a(),i()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...r},n,a,i){let s,l;for(let c=0;c<cpe;c++){const d=EG[c],{isEnabled:u,Feature:f,ProjectionNode:m,MeasureLayout:h}=Nb[d];m&&(s=m),u(r)&&(!this.features[d]&&f&&(this.features[d]=new f(this)),h&&(l=h))}if((this.type==="html"||this.type==="svg")&&!this.projection&&s){this.projection=new s(this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:d,drag:u,dragConstraints:f,layoutScroll:m,layoutRoot:h}=r;this.projection.setOptions({layoutId:c,layout:d,alwaysMeasureLayout:!!u||f&&vv(f),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof d=="string"?d:"both",initialPromotionConfig:i,layoutScroll:m,layoutRoot:h})}return l}updateFeatures(){for(const t in this.features){const r=this.features[t];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ji()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}makeTargetAnimatable(t,r=!0){return this.makeTargetAnimatableFromInstance(t,this.props,r)}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<s$.length;n++){const a=s$[n];this.propEventSubscriptions[a]&&(this.propEventSubscriptions[a](),delete this.propEventSubscriptions[a]);const i=t["on"+a];i&&(this.propEventSubscriptions[a]=this.on(a,i))}this.prevMotionValues=lpe(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const n=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(n.initial=this.props.initial),n}const r={};for(let n=0;n<dpe;n++){const a=qI[n],i=this.props[a];(jb(i)||i===!1)&&(r[a]=i)}return r}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){r!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,r)),this.values.set(t,r),this.latestValues[t]=r.get()}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=ox(r,{owner:this}),this.addValue(t,n)),n}readValue(t){var r;return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(r=this.getBaseTargetFromProps(this.props,t))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var r;const{initial:n}=this.props,a=typeof n=="string"||typeof n=="object"?(r=YI(this.props,n))===null||r===void 0?void 0:r[t]:void 0;if(n&&a!==void 0)return a;const i=this.getBaseTargetFromProps(this.props,t);return i!==void 0&&!$l(i)?i:this.initialValues[t]!==void 0&&a===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new oT),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class kG extends upe{sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:r,...n},{transformValues:a},i){let s=Ame(n,t||{},this);if(a&&(r&&(r=a(r)),n&&(n=a(n)),s&&(s=a(s))),i){Cme(this,n,s);const l=ipe(this,n,s,r);r=l.transitionEnd,n=l.target}return{transition:t,transitionEnd:r,...n}}}function fpe(e){return window.getComputedStyle(e)}class mpe extends kG{constructor(){super(...arguments),this.type="html"}readValueFromInstance(t,r){if(dg.has(r)){const n=eT(r);return n&&n.default||0}else{const n=fpe(t),a=(vH(r)?n.getPropertyValue(r):n[r])||0;return typeof a=="string"?a.trim():a}}measureInstanceViewportBox(t,{transformPagePoint:r}){return vG(t,r)}build(t,r,n,a){VI(t,r,n,a.transformTemplate)}scrapeMotionValuesFromProps(t,r){return KI(t,r)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;$l(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}renderInstance(t,r,n,a){NH(t,r,n,a)}}class hpe extends kG{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(dg.has(r)){const n=eT(r);return n&&n.default||0}return r=_H.has(r)?r:FI(r),t.getAttribute(r)}measureInstanceViewportBox(){return ji()}scrapeMotionValuesFromProps(t,r){return CH(t,r)}build(t,r,n,a){HI(t,r,n,this.isSVGTag,a.transformTemplate)}renderInstance(t,r,n,a){SH(t,r,n,a)}mount(t){this.isSVGTag=GI(t.tagName),super.mount(t)}}const ppe=(e,t)=>UI(e)?new hpe(t,{enableHardwareAcceleration:!1}):new mpe(t,{enableHardwareAcceleration:!0}),gpe={layout:{ProjectionNode:CG,MeasureLayout:yG}},vpe={...Ume,...cfe,...Khe,...gpe},fr=xue((e,t)=>Xue(e,t,vpe,ppe));function OG(){const e=p.useRef(!1);return $I(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function xpe(){const e=OG(),[t,r]=p.useState(0),n=p.useCallback(()=>{e.current&&r(t+1)},[t]);return[p.useCallback(()=>No.postRender(n),[n]),t]}class ype extends p.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=r.offsetHeight||0,n.width=r.offsetWidth||0,n.top=r.offsetTop,n.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function bpe({children:e,isPresent:t}){const r=p.useId(),n=p.useRef(null),a=p.useRef({width:0,height:0,top:0,left:0});return p.useInsertionEffect(()=>{const{width:i,height:s,top:l,left:c}=a.current;if(t||!n.current||!i||!s)return;n.current.dataset.motionPopId=r;const d=document.createElement("style");return document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${s}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[t]),p.createElement(ype,{isPresent:t,childRef:n,sizeRef:a},p.cloneElement(e,{ref:n}))}const AP=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:a,presenceAffectsLayout:i,mode:s})=>{const l=PH(wpe),c=p.useId(),d=p.useMemo(()=>({id:c,initial:t,isPresent:r,custom:a,onExitComplete:u=>{l.set(u,!0);for(const f of l.values())if(!f)return;n&&n()},register:u=>(l.set(u,!1),()=>l.delete(u))}),i?void 0:[r]);return p.useMemo(()=>{l.forEach((u,f)=>l.set(f,!1))},[r]),p.useEffect(()=>{!r&&!l.size&&n&&n()},[r]),s==="popLayout"&&(e=p.createElement(bpe,{isPresent:r},e)),p.createElement(SS.Provider,{value:d},e)};function wpe(){return new Map}function jpe(e){return p.useEffect(()=>()=>e(),[])}const Kh=e=>e.key||"";function Npe(e,t){e.forEach(r=>{const n=Kh(r);t.set(n,r)})}function _pe(e){const t=[];return p.Children.forEach(e,r=>{p.isValidElement(r)&&t.push(r)}),t}const Spe=({children:e,custom:t,initial:r=!0,onExitComplete:n,exitBeforeEnter:a,presenceAffectsLayout:i=!0,mode:s="sync"})=>{const l=p.useContext(zI).forceRender||xpe()[0],c=OG(),d=_pe(e);let u=d;const f=p.useRef(new Map).current,m=p.useRef(u),h=p.useRef(new Map).current,v=p.useRef(!0);if($I(()=>{v.current=!1,Npe(d,h),m.current=u}),jpe(()=>{v.current=!0,h.clear(),f.clear()}),v.current)return p.createElement(p.Fragment,null,u.map(b=>p.createElement(AP,{key:Kh(b),isPresent:!0,initial:r?void 0:!1,presenceAffectsLayout:i,mode:s},b)));u=[...u];const g=m.current.map(Kh),y=d.map(Kh),x=g.length;for(let b=0;b<x;b++){const w=g[b];y.indexOf(w)===-1&&!f.has(w)&&f.set(w,void 0)}return s==="wait"&&f.size&&(u=[]),f.forEach((b,w)=>{if(y.indexOf(w)!==-1)return;const j=h.get(w);if(!j)return;const _=g.indexOf(w);let C=b;if(!C){const E=()=>{f.delete(w);const P=Array.from(h.keys()).filter(k=>!y.includes(k));if(P.forEach(k=>h.delete(k)),m.current=d.filter(k=>{const M=Kh(k);return M===w||P.includes(M)}),!f.size){if(c.current===!1)return;l(),n&&n()}};C=p.createElement(AP,{key:Kh(j),isPresent:!1,onExitComplete:E,custom:t,presenceAffectsLayout:i,mode:s},j),f.set(w,C)}u.splice(_,0,C)}),u=u.map(b=>{const w=b.key;return f.has(w)?b:p.createElement(AP,{key:Kh(b),isPresent:!0,presenceAffectsLayout:i,mode:s},b)}),p.createElement(p.Fragment,null,f.size?u:u.map(b=>p.cloneElement(b)))};function l$(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function IS(...e){return t=>{let r=!1;const n=e.map(a=>{const i=l$(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():l$(e[a],null)}}}}function Da(...e){return p.useCallback(IS(...e),e)}function dh(e){const t=Ppe(e),r=p.forwardRef((n,a)=>{const{children:i,...s}=n,l=p.Children.toArray(i),c=l.find(Epe);if(c){const d=c.props.children,u=l.map(f=>f===c?p.Children.count(d)>1?p.Children.only(null):p.isValidElement(d)?d.props.children:null:f);return o.jsx(t,{...s,ref:a,children:p.isValidElement(d)?p.cloneElement(d,void 0,u):null})}return o.jsx(t,{...s,ref:a,children:i})});return r.displayName=`${e}.Slot`,r}var Cpe=dh("Slot");function Ppe(e){const t=p.forwardRef((r,n)=>{const{children:a,...i}=r;if(p.isValidElement(a)){const s=Ope(a),l=kpe(i,a.props);return a.type!==p.Fragment&&(l.ref=n?IS(n,s):s),p.cloneElement(a,l)}return p.Children.count(a)>1?p.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var IG=Symbol("radix.slottable");function Ape(e){const t=({children:r})=>o.jsx(o.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=IG,t}function Epe(e){return p.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===IG}function kpe(e,t){const r={...t};for(const n in t){const a=e[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...l)=>{const c=i(...l);return a(...l),c}:a&&(r[n]=a):n==="style"?r[n]={...a,...i}:n==="className"&&(r[n]=[a,i].filter(Boolean).join(" "))}return{...e,...r}}function Ope(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}const c$=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,d$=ta,iT=(e,t)=>r=>{var n;if(t?.variants==null)return d$(e,r?.class,r?.className);const{variants:a,defaultVariants:i}=t,s=Object.keys(a).map(d=>{const u=r?.[d],f=i?.[d];if(u===null)return null;const m=c$(u)||c$(f);return a[d][m]}),l=r&&Object.entries(r).reduce((d,u)=>{let[f,m]=u;return m===void 0||(d[f]=m),d},{}),c=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((d,u)=>{let{class:f,className:m,...h}=u;return Object.entries(h).every(v=>{let[g,y]=v;return Array.isArray(y)?y.includes({...i,...l}[g]):{...i,...l}[g]===y})?[...d,f,m]:d},[]);return d$(e,s,c,r?.class,r?.className)},Sb=iT("inline-flex items-center justify-center rounded-sm text-sm font-bold tracking-wide transition-all duration-200 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background active:scale-[0.98] disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-brand text-primary-foreground hover:bg-brand/90 shadow-lg shadow-brand/15",destructive:"bg-danger text-white hover:bg-danger/90 shadow-lg shadow-danger/15",outline:"border border-border bg-transparent hover:bg-accent hover:text-accent-foreground",secondary:"bg-surface-2 text-secondary-foreground hover:bg-surface-2/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-brand underline-offset-4 hover:underline",success:"bg-success text-white hover:bg-success/90 shadow-lg shadow-success/15"},size:{default:"h-10 px-5 py-2 gap-2",sm:"h-9 rounded-sm px-3 gap-1.5",lg:"h-12 rounded-md px-8 gap-2.5 text-base",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),oe=ye.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...a},i)=>{const s=n?Cpe:"button";return o.jsx(s,{className:Yt(Sb({variant:t,size:r,className:e})),ref:i,...a})});oe.displayName="Button";const i2=[{to:"/",icon:Xde,label:"Painel Principal"},{to:"/agenda",icon:Ei,label:"Agenda"},{to:"/vendas",icon:$1,label:"Loja"},{to:"/financeiro",icon:cH,label:"Financeiro"}],mj={hidden:{opacity:0,x:-20},visible:e=>({opacity:1,x:0,transition:{delay:e*.05+.3,duration:.3,ease:"easeOut"}})},Ipe=({to:e,icon:t,label:r,index:n,onNavigate:a})=>{const i="flex items-center h-[52px] px-4 rounded-sm bg-brand text-primary-foreground font-bold shadow-lg shadow-brand/10 border-l-4 border-brand w-full",s="flex items-center h-[52px] px-4 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-all duration-200 border-l-4 border-transparent w-full";return o.jsx(fr.li,{custom:n,variants:mj,initial:"hidden",animate:"visible",whileHover:{x:4},transition:{type:"spring",stiffness:300,damping:15},children:o.jsxs(fu,{to:e,onClick:a,className:({isActive:l})=>e==="/isis"&&l?"flex items-center h-[52px] px-4 rounded-sm font-bold text-white shadow-lg shadow-emerald-500/10 border-l-4 border-transparent bg-gradient-to-r from-fuchsia-600 via-violet-600 to-emerald-600 ring-1 ring-white/10":l?i:s,children:[e==="/isis"?o.jsx("span",{className:"mr-4 flex-shrink-0 inline-flex items-center justify-center rounded-full p-[3px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400 shadow-[0_0_12px_rgba(168,85,247,0.35)]",children:o.jsx("span",{className:"rounded-full overflow-hidden bg-background",children:o.jsx(Wd,{size:"sm"})})}):o.jsx(t,{className:"h-5 w-5 mr-4 flex-shrink-0"}),o.jsx("span",{className:"text-base flex items-center gap-2",children:r})]})})};function Tpe({onNavigate:e,isVisible:t,setIsVisible:r,sidebarPinned:n}){const a=ls(),i=["/produtos","/compras","/clientes","/equipe","/quadras","/empresas","/finalizadoras"],s=p.useMemo(()=>i.includes(a.pathname),[a.pathname]),[l,c]=p.useState(s),d=p.useRef(null);p.useRef(null);const u=p.useRef(0),f=p.useRef(0),m=()=>{window.innerWidth<768&&r(!1)};return p.useEffect(()=>{const h=y=>{window.innerWidth>=768||(u.current=y.touches[0].clientX,f.current=y.touches[0].clientY)},v=y=>{if(window.innerWidth>=768)return;const x=y.touches[0].clientX,b=y.touches[0].clientY,w=x-u.current,j=Math.abs(b-f.current);u.current<50&&w>50&&j<50&&r(!0)},g=()=>{u.current=0,f.current=0};return window.addEventListener("touchstart",h,{passive:!0}),window.addEventListener("touchmove",v,{passive:!0}),window.addEventListener("touchend",g,{passive:!0}),()=>{window.removeEventListener("touchstart",h),window.removeEventListener("touchmove",v),window.removeEventListener("touchend",g)}},[t]),o.jsx(o.Fragment,{children:o.jsxs(fr.aside,{ref:d,initial:!1,animate:{width:n||t?280:0},className:`h-screen bg-surface flex flex-col border-r border-border shadow-xl shadow-black/20 overflow-hidden\r
                   fixed inset-y-0 left-0 z-40 md:static md:flex-shrink-0`,children:[o.jsxs(fr.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.4},className:"flex items-center px-6 pt-8 pb-6 h-[120px] flex-shrink-0",children:[o.jsx("div",{className:"w-14 h-14 bg-brand rounded-xl flex items-center justify-center mr-4",children:o.jsx($d,{className:"w-8 h-8 text-primary-foreground"})}),o.jsxs("div",{className:"flex items-baseline",children:[o.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FF6600"},children:"Fluxo"}),o.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FFAA33"},children:"7"}),o.jsx("span",{className:"font-medium text-2xl",style:{color:"#B0B0B0"},children:" Arena"})]})]}),o.jsx("nav",{className:"flex-1 overflow-y-auto px-6 py-2 scrollbar-thin scrollbar-thumb-border scrollbar-track-transparent hover:scrollbar-thumb-border-hover",children:o.jsxs("ul",{className:"space-y-3",children:[i2.map((h,v)=>o.jsx(Ipe,{...h,index:v,onNavigate:m},h.to)),o.jsxs(fr.li,{custom:i2.length,variants:mj,initial:"hidden",animate:"visible",children:[o.jsxs("button",{type:"button",onClick:()=>c(h=>!h),className:`w-full flex items-center h-[52px] px-4 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-all duration-200 border-l-4 ${s?"bg-brand text-primary-foreground font-bold border-brand":"border-transparent"}`,children:[o.jsx(zde,{className:"h-5 w-5 mr-4 flex-shrink-0"}),o.jsx("span",{className:"text-base flex-1 text-left",children:"Cadastros"}),o.jsx(L1,{className:`h-4 w-4 transition-transform ${l?"rotate-180":""}`})]}),l&&o.jsxs("ul",{className:"mt-2 ml-8 space-y-2",children:[o.jsx("li",{children:o.jsxs(fu,{to:"/clientes",onClick:m,className:({isActive:h})=>h?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[o.jsx(cl,{className:"h-4 w-4 mr-3"})," Clientes & Fornecedores"]})}),o.jsx("li",{children:o.jsxs(fu,{to:"/finalizadoras",onClick:m,className:({isActive:h})=>h?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[o.jsx(Cm,{className:"h-4 w-4 mr-3"})," Finalizadoras"]})}),o.jsx("li",{children:o.jsxs(fu,{to:"/produtos",onClick:m,className:({isActive:h})=>h?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[o.jsx(ud,{className:"h-4 w-4 mr-3"})," Produtos"]})}),o.jsx("li",{children:o.jsxs(fu,{to:"/compras",onClick:m,className:({isActive:h})=>h?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[o.jsx(Tv,{className:"h-4 w-4 mr-3"})," Compras"]})}),o.jsx("li",{children:o.jsxs(fu,{to:"/equipe",onClick:m,className:({isActive:h})=>h?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[o.jsx(sue,{className:"h-4 w-4 mr-3"})," Equipe"]})}),o.jsx("li",{children:o.jsxs(fu,{to:"/quadras",onClick:m,className:({isActive:h})=>h?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[o.jsx(Yde,{className:"h-4 w-4 mr-3"})," Quadras"]})}),o.jsx("li",{children:o.jsxs(fu,{to:"/empresas",onClick:m,className:({isActive:h})=>h?"flex items-center h-[40px] px-3 rounded-sm bg-brand/20 text-text-primary font-medium text-sm":"flex items-center h-[40px] px-3 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-colors text-sm",children:[o.jsx(iN,{className:"h-4 w-4 mr-3"})," Empresa"]})})]})]}),o.jsx(fr.li,{custom:i2.length+1,variants:mj,initial:"hidden",animate:"visible",className:"pt-4 border-t border-border/50 mt-4",children:o.jsxs(fu,{to:"/suporte",onClick:m,className:({isActive:h})=>h?"flex items-center h-[52px] px-4 rounded-sm bg-brand text-primary-foreground font-bold shadow-lg shadow-brand/10 border-l-4 border-brand":"flex items-center h-[52px] px-4 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-all duration-200 border-l-4 border-transparent",children:[o.jsx(nH,{className:"h-5 w-5 mr-4 flex-shrink-0"}),o.jsx("span",{className:"text-base",children:"Suporte"})]})}),o.jsx(fr.li,{custom:i2.length+2,variants:mj,initial:"hidden",animate:"visible",children:o.jsxs(fu,{to:"/isis",onClick:m,className:({isActive:h})=>h?"flex items-center h-[56px] px-4 rounded-sm font-extrabold text-text-primary bg-surface-2/80 border border-white/20 shadow-[inset_0_0_0_1px_rgba(255,255,255,0.06)]":"flex items-center h-[56px] px-4 rounded-sm text-text-secondary hover:bg-surface-2 hover:text-text-primary transition-all duration-200 border border-white/15",children:[o.jsx("span",{className:"mr-4 flex-shrink-0 inline-flex items-center justify-center rounded-full p-[3px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400 shadow-[0_0_12px_rgba(168,85,247,0.35)]",children:o.jsx("span",{className:"rounded-full overflow-hidden bg-background",children:o.jsx(Wd,{size:"sm"})})}),o.jsx("span",{className:"text-lg font-extrabold bg-clip-text text-transparent bg-gradient-to-r from-fuchsia-400 via-violet-300 to-emerald-300",children:"sis"})]})})]})})]})})}function Jr(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e?.(a),r===!1||!a.defaultPrevented)return t?.(a)}}function Dpe(e,t){const r=p.createContext(t),n=i=>{const{children:s,...l}=i,c=p.useMemo(()=>l,Object.values(l));return o.jsx(r.Provider,{value:c,children:s})};n.displayName=e+"Provider";function a(i){const s=p.useContext(r);if(s)return s;if(t!==void 0)return t;throw new Error(`\`${i}\` must be used within \`${e}\``)}return[n,a]}function pd(e,t=[]){let r=[];function n(i,s){const l=p.createContext(s),c=r.length;r=[...r,s];const d=f=>{const{scope:m,children:h,...v}=f,g=m?.[e]?.[c]||l,y=p.useMemo(()=>v,Object.values(v));return o.jsx(g.Provider,{value:y,children:h})};d.displayName=i+"Provider";function u(f,m){const h=m?.[e]?.[c]||l,v=p.useContext(h);if(v)return v;if(s!==void 0)return s;throw new Error(`\`${f}\` must be used within \`${i}\``)}return[d,u]}const a=()=>{const i=r.map(s=>p.createContext(s));return function(l){const c=l?.[e]||i;return p.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return a.scopeName=e,[n,Mpe(a,...t)]}function Mpe(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const s=n.reduce((l,{useScope:c,scopeName:d})=>{const f=c(i)[`__scope${d}`];return{...l,...f}},{});return p.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return r.scopeName=t.scopeName,r}var Cs=globalThis?.document?p.useLayoutEffect:()=>{},Rpe=L4[" useId ".trim().toString()]||(()=>{}),Lpe=0;function Hd(e){const[t,r]=p.useState(Rpe());return Cs(()=>{e||r(n=>n??String(Lpe++))},[e]),e||(t?`radix-${t}`:"")}var $pe=L4[" useInsertionEffect ".trim().toString()]||Cs;function kf({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[a,i,s]=Fpe({defaultProp:t,onChange:r}),l=e!==void 0,c=l?e:a;{const u=p.useRef(e!==void 0);p.useEffect(()=>{const f=u.current;f!==l&&console.warn(`${n} is changing from ${f?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=l},[l,n])}const d=p.useCallback(u=>{if(l){const f=Bpe(u)?u(e):u;f!==e&&s.current?.(f)}else i(u)},[l,e,i,s]);return[c,d]}function Fpe({defaultProp:e,onChange:t}){const[r,n]=p.useState(e),a=p.useRef(r),i=p.useRef(t);return $pe(()=>{i.current=t},[t]),p.useEffect(()=>{a.current!==r&&(i.current?.(r),a.current=r)},[r,a]),[r,n,i]}function Bpe(e){return typeof e=="function"}var qpe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Hn=qpe.reduce((e,t)=>{const r=dh(`Primitive.${t}`),n=p.forwardRef((a,i)=>{const{asChild:s,...l}=a,c=s?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),o.jsx(c,{...l,ref:i})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function sT(e,t){e&&$f.flushSync(()=>e.dispatchEvent(t))}function Fl(e){const t=p.useRef(e);return p.useEffect(()=>{t.current=e}),p.useMemo(()=>(...r)=>t.current?.(...r),[])}function zpe(e,t=globalThis?.document){const r=Fl(e);p.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var Upe="DismissableLayer",qk="dismissableLayer.update",Vpe="dismissableLayer.pointerDownOutside",Wpe="dismissableLayer.focusOutside",u$,TG=p.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Yx=p.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:s,onDismiss:l,...c}=e,d=p.useContext(TG),[u,f]=p.useState(null),m=u?.ownerDocument??globalThis?.document,[,h]=p.useState({}),v=Da(t,E=>f(E)),g=Array.from(d.layers),[y]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),x=g.indexOf(y),b=u?g.indexOf(u):-1,w=d.layersWithOutsidePointerEventsDisabled.size>0,j=b>=x,_=Gpe(E=>{const P=E.target,k=[...d.branches].some(M=>M.contains(P));!j||k||(a?.(E),s?.(E),E.defaultPrevented||l?.())},m),C=Kpe(E=>{const P=E.target;[...d.branches].some(M=>M.contains(P))||(i?.(E),s?.(E),E.defaultPrevented||l?.())},m);return zpe(E=>{b===d.layers.size-1&&(n?.(E),!E.defaultPrevented&&l&&(E.preventDefault(),l()))},m),p.useEffect(()=>{if(u)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(u$=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(u)),d.layers.add(u),f$(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=u$)}},[u,m,r,d]),p.useEffect(()=>()=>{u&&(d.layers.delete(u),d.layersWithOutsidePointerEventsDisabled.delete(u),f$())},[u,d]),p.useEffect(()=>{const E=()=>h({});return document.addEventListener(qk,E),()=>document.removeEventListener(qk,E)},[]),o.jsx(Hn.div,{...c,ref:v,style:{pointerEvents:w?j?"auto":"none":void 0,...e.style},onFocusCapture:Jr(e.onFocusCapture,C.onFocusCapture),onBlurCapture:Jr(e.onBlurCapture,C.onBlurCapture),onPointerDownCapture:Jr(e.onPointerDownCapture,_.onPointerDownCapture)})});Yx.displayName=Upe;var Hpe="DismissableLayerBranch",DG=p.forwardRef((e,t)=>{const r=p.useContext(TG),n=p.useRef(null),a=Da(t,n);return p.useEffect(()=>{const i=n.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),o.jsx(Hn.div,{...e,ref:a})});DG.displayName=Hpe;function Gpe(e,t=globalThis?.document){const r=Fl(e),n=p.useRef(!1),a=p.useRef(()=>{});return p.useEffect(()=>{const i=l=>{if(l.target&&!n.current){let c=function(){MG(Vpe,r,d,{discrete:!0})};const d={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=c,t.addEventListener("click",a.current,{once:!0})):c()}else t.removeEventListener("click",a.current);n.current=!1},s=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(s),t.removeEventListener("pointerdown",i),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function Kpe(e,t=globalThis?.document){const r=Fl(e),n=p.useRef(!1);return p.useEffect(()=>{const a=i=>{i.target&&!n.current&&MG(Wpe,r,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function f$(){const e=new CustomEvent(qk);document.dispatchEvent(e)}function MG(e,t,r,{discrete:n}){const a=r.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?sT(a,i):a.dispatchEvent(i)}var Ype=Yx,Xpe=DG,EP="focusScope.autoFocusOnMount",kP="focusScope.autoFocusOnUnmount",m$={bubbles:!1,cancelable:!0},Jpe="FocusScope",U1=p.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:i,...s}=e,[l,c]=p.useState(null),d=Fl(a),u=Fl(i),f=p.useRef(null),m=Da(t,g=>c(g)),h=p.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;p.useEffect(()=>{if(n){let g=function(w){if(h.paused||!l)return;const j=w.target;l.contains(j)?f.current=j:cm(f.current,{select:!0})},y=function(w){if(h.paused||!l)return;const j=w.relatedTarget;j!==null&&(l.contains(j)||cm(f.current,{select:!0}))},x=function(w){if(document.activeElement===document.body)for(const _ of w)_.removedNodes.length>0&&cm(l)};document.addEventListener("focusin",g),document.addEventListener("focusout",y);const b=new MutationObserver(x);return l&&b.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",y),b.disconnect()}}},[n,l,h.paused]),p.useEffect(()=>{if(l){p$.add(h);const g=document.activeElement;if(!l.contains(g)){const x=new CustomEvent(EP,m$);l.addEventListener(EP,d),l.dispatchEvent(x),x.defaultPrevented||(Qpe(nge(RG(l)),{select:!0}),document.activeElement===g&&cm(l))}return()=>{l.removeEventListener(EP,d),setTimeout(()=>{const x=new CustomEvent(kP,m$);l.addEventListener(kP,u),l.dispatchEvent(x),x.defaultPrevented||cm(g??document.body,{select:!0}),l.removeEventListener(kP,u),p$.remove(h)},0)}}},[l,d,u,h]);const v=p.useCallback(g=>{if(!r&&!n||h.paused)return;const y=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,x=document.activeElement;if(y&&x){const b=g.currentTarget,[w,j]=Zpe(b);w&&j?!g.shiftKey&&x===j?(g.preventDefault(),r&&cm(w,{select:!0})):g.shiftKey&&x===w&&(g.preventDefault(),r&&cm(j,{select:!0})):x===b&&g.preventDefault()}},[r,n,h.paused]);return o.jsx(Hn.div,{tabIndex:-1,...s,ref:m,onKeyDown:v})});U1.displayName=Jpe;function Qpe(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(cm(n,{select:t}),document.activeElement!==r)return}function Zpe(e){const t=RG(e),r=h$(t,e),n=h$(t.reverse(),e);return[r,n]}function RG(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function h$(e,t){for(const r of e)if(!ege(r,{upTo:t}))return r}function ege(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function tge(e){return e instanceof HTMLInputElement&&"select"in e}function cm(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&tge(e)&&t&&e.select()}}var p$=rge();function rge(){let e=[];return{add(t){const r=e[0];t!==r&&r?.pause(),e=g$(e,t),e.unshift(t)},remove(t){e=g$(e,t),e[0]?.resume()}}}function g$(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function nge(e){return e.filter(t=>t.tagName!=="A")}var age="Portal",Xx=p.forwardRef((e,t)=>{const{container:r,...n}=e,[a,i]=p.useState(!1);Cs(()=>i(!0),[]);const s=r||a&&globalThis?.document?.body;return s?DW.createPortal(o.jsx(Hn.div,{...n,ref:t}),s):null});Xx.displayName=age;function oge(e,t){return p.useReducer((r,n)=>t[r][n]??r,e)}var Ac=e=>{const{present:t,children:r}=e,n=ige(t),a=typeof r=="function"?r({present:n.isPresent}):p.Children.only(r),i=Da(n.ref,sge(a));return typeof r=="function"||n.isPresent?p.cloneElement(a,{ref:i}):null};Ac.displayName="Presence";function ige(e){const[t,r]=p.useState(),n=p.useRef(null),a=p.useRef(e),i=p.useRef("none"),s=e?"mounted":"unmounted",[l,c]=oge(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return p.useEffect(()=>{const d=s2(n.current);i.current=l==="mounted"?d:"none"},[l]),Cs(()=>{const d=n.current,u=a.current;if(u!==e){const m=i.current,h=s2(d);e?c("MOUNT"):h==="none"||d?.display==="none"?c("UNMOUNT"):c(u&&m!==h?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,c]),Cs(()=>{if(t){let d;const u=t.ownerDocument.defaultView??window,f=h=>{const g=s2(n.current).includes(CSS.escape(h.animationName));if(h.target===t&&g&&(c("ANIMATION_END"),!a.current)){const y=t.style.animationFillMode;t.style.animationFillMode="forwards",d=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=y)})}},m=h=>{h.target===t&&(i.current=s2(n.current))};return t.addEventListener("animationstart",m),t.addEventListener("animationcancel",f),t.addEventListener("animationend",f),()=>{u.clearTimeout(d),t.removeEventListener("animationstart",m),t.removeEventListener("animationcancel",f),t.removeEventListener("animationend",f)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:p.useCallback(d=>{n.current=d?getComputedStyle(d):null,r(d)},[])}}function s2(e){return e?.animationName||"none"}function sge(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var OP=0;function TS(){p.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??v$()),document.body.insertAdjacentElement("beforeend",e[1]??v$()),OP++,()=>{OP===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),OP--}},[])}function v$(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var xu=function(){return xu=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},xu.apply(this,arguments)};function LG(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function lge(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,i;n<a;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}var hj="right-scroll-bar-position",pj="width-before-scroll-bar",cge="with-scroll-bars-hidden",dge="--removed-body-scroll-bar-size";function IP(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function uge(e,t){var r=p.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var a=r.value;a!==n&&(r.value=n,r.callback(n,a))}}}})[0];return r.callback=t,r.facade}var fge=typeof window<"u"?p.useLayoutEffect:p.useEffect,x$=new WeakMap;function mge(e,t){var r=uge(t||null,function(n){return e.forEach(function(a){return IP(a,n)})});return fge(function(){var n=x$.get(r);if(n){var a=new Set(n),i=new Set(e),s=r.current;a.forEach(function(l){i.has(l)||IP(l,null)}),i.forEach(function(l){a.has(l)||IP(l,s)})}x$.set(r,e)},[e]),r}function hge(e){return e}function pge(e,t){t===void 0&&(t=hge);var r=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(i){var s=t(i,n);return r.push(s),function(){r=r.filter(function(l){return l!==s})}},assignSyncMedium:function(i){for(n=!0;r.length;){var s=r;r=[],s.forEach(i)}r={push:function(l){return i(l)},filter:function(){return r}}},assignMedium:function(i){n=!0;var s=[];if(r.length){var l=r;r=[],l.forEach(i),s=r}var c=function(){var u=s;s=[],u.forEach(i)},d=function(){return Promise.resolve().then(c)};d(),r={push:function(u){s.push(u),d()},filter:function(u){return s=s.filter(u),r}}}};return a}function gge(e){e===void 0&&(e={});var t=pge(null);return t.options=xu({async:!0,ssr:!1},e),t}var $G=function(e){var t=e.sideCar,r=LG(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return p.createElement(n,xu({},r))};$G.isSideCarExport=!0;function vge(e,t){return e.useMedium(t),$G}var FG=gge(),TP=function(){},DS=p.forwardRef(function(e,t){var r=p.useRef(null),n=p.useState({onScrollCapture:TP,onWheelCapture:TP,onTouchMoveCapture:TP}),a=n[0],i=n[1],s=e.forwardProps,l=e.children,c=e.className,d=e.removeScrollBar,u=e.enabled,f=e.shards,m=e.sideCar,h=e.noRelative,v=e.noIsolation,g=e.inert,y=e.allowPinchZoom,x=e.as,b=x===void 0?"div":x,w=e.gapMode,j=LG(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),_=m,C=mge([r,t]),E=xu(xu({},j),a);return p.createElement(p.Fragment,null,u&&p.createElement(_,{sideCar:FG,removeScrollBar:d,shards:f,noRelative:h,noIsolation:v,inert:g,setCallbacks:i,allowPinchZoom:!!y,lockRef:r,gapMode:w}),s?p.cloneElement(p.Children.only(l),xu(xu({},E),{ref:C})):p.createElement(b,xu({},E,{className:c,ref:C}),l))});DS.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};DS.classNames={fullWidth:pj,zeroRight:hj};var y$,xge=function(){if(y$)return y$;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function yge(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=xge();return t&&e.setAttribute("nonce",t),e}function bge(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function wge(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var jge=function(){var e=0,t=null;return{add:function(r){e==0&&(t=yge())&&(bge(t,r),wge(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Nge=function(){var e=jge();return function(t,r){p.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},BG=function(){var e=Nge(),t=function(r){var n=r.styles,a=r.dynamic;return e(n,a),null};return t},_ge={left:0,top:0,right:0,gap:0},DP=function(e){return parseInt(e||"",10)||0},Sge=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[DP(r),DP(n),DP(a)]},Cge=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return _ge;var t=Sge(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},Pge=BG(),Dv="data-scroll-locked",Age=function(e,t,r,n){var a=e.left,i=e.top,s=e.right,l=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(cge,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(l,"px ").concat(n,`;
  }
  body[`).concat(Dv,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(s,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(l,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(hj,` {
    right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(pj,` {
    margin-right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(hj," .").concat(hj,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(pj," .").concat(pj,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Dv,`] {
    `).concat(dge,": ").concat(l,`px;
  }
`)},b$=function(){var e=parseInt(document.body.getAttribute(Dv)||"0",10);return isFinite(e)?e:0},Ege=function(){p.useEffect(function(){return document.body.setAttribute(Dv,(b$()+1).toString()),function(){var e=b$()-1;e<=0?document.body.removeAttribute(Dv):document.body.setAttribute(Dv,e.toString())}},[])},kge=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,a=n===void 0?"margin":n;Ege();var i=p.useMemo(function(){return Cge(a)},[a]);return p.createElement(Pge,{styles:Age(i,!t,a,r?"":"!important")})},zk=!1;if(typeof window<"u")try{var l2=Object.defineProperty({},"passive",{get:function(){return zk=!0,!0}});window.addEventListener("test",l2,l2),window.removeEventListener("test",l2,l2)}catch{zk=!1}var Pg=zk?{passive:!1}:!1,Oge=function(e){return e.tagName==="TEXTAREA"},qG=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!Oge(e)&&r[t]==="visible")},Ige=function(e){return qG(e,"overflowY")},Tge=function(e){return qG(e,"overflowX")},w$=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var a=zG(e,n);if(a){var i=UG(e,n),s=i[1],l=i[2];if(s>l)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Dge=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},Mge=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},zG=function(e,t){return e==="v"?Ige(t):Tge(t)},UG=function(e,t){return e==="v"?Dge(t):Mge(t)},Rge=function(e,t){return e==="h"&&t==="rtl"?-1:1},Lge=function(e,t,r,n,a){var i=Rge(e,window.getComputedStyle(t).direction),s=i*n,l=r.target,c=t.contains(l),d=!1,u=s>0,f=0,m=0;do{if(!l)break;var h=UG(e,l),v=h[0],g=h[1],y=h[2],x=g-y-i*v;(v||x)&&zG(e,l)&&(f+=x,m+=v);var b=l.parentNode;l=b&&b.nodeType===Node.DOCUMENT_FRAGMENT_NODE?b.host:b}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return(u&&(a&&Math.abs(f)<1||!a&&s>f)||!u&&(a&&Math.abs(m)<1||!a&&-s>m))&&(d=!0),d},c2=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},j$=function(e){return[e.deltaX,e.deltaY]},N$=function(e){return e&&"current"in e?e.current:e},$ge=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Fge=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Bge=0,Ag=[];function qge(e){var t=p.useRef([]),r=p.useRef([0,0]),n=p.useRef(),a=p.useState(Bge++)[0],i=p.useState(BG)[0],s=p.useRef(e);p.useEffect(function(){s.current=e},[e]),p.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var g=lge([e.lockRef.current],(e.shards||[]).map(N$),!0).filter(Boolean);return g.forEach(function(y){return y.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),g.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var l=p.useCallback(function(g,y){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!s.current.allowPinchZoom;var x=c2(g),b=r.current,w="deltaX"in g?g.deltaX:b[0]-x[0],j="deltaY"in g?g.deltaY:b[1]-x[1],_,C=g.target,E=Math.abs(w)>Math.abs(j)?"h":"v";if("touches"in g&&E==="h"&&C.type==="range")return!1;var P=w$(E,C);if(!P)return!0;if(P?_=E:(_=E==="v"?"h":"v",P=w$(E,C)),!P)return!1;if(!n.current&&"changedTouches"in g&&(w||j)&&(n.current=_),!_)return!0;var k=n.current||_;return Lge(k,y,g,k==="h"?w:j,!0)},[]),c=p.useCallback(function(g){var y=g;if(!(!Ag.length||Ag[Ag.length-1]!==i)){var x="deltaY"in y?j$(y):c2(y),b=t.current.filter(function(_){return _.name===y.type&&(_.target===y.target||y.target===_.shadowParent)&&$ge(_.delta,x)})[0];if(b&&b.should){y.cancelable&&y.preventDefault();return}if(!b){var w=(s.current.shards||[]).map(N$).filter(Boolean).filter(function(_){return _.contains(y.target)}),j=w.length>0?l(y,w[0]):!s.current.noIsolation;j&&y.cancelable&&y.preventDefault()}}},[]),d=p.useCallback(function(g,y,x,b){var w={name:g,delta:y,target:x,should:b,shadowParent:zge(x)};t.current.push(w),setTimeout(function(){t.current=t.current.filter(function(j){return j!==w})},1)},[]),u=p.useCallback(function(g){r.current=c2(g),n.current=void 0},[]),f=p.useCallback(function(g){d(g.type,j$(g),g.target,l(g,e.lockRef.current))},[]),m=p.useCallback(function(g){d(g.type,c2(g),g.target,l(g,e.lockRef.current))},[]);p.useEffect(function(){return Ag.push(i),e.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:m}),document.addEventListener("wheel",c,Pg),document.addEventListener("touchmove",c,Pg),document.addEventListener("touchstart",u,Pg),function(){Ag=Ag.filter(function(g){return g!==i}),document.removeEventListener("wheel",c,Pg),document.removeEventListener("touchmove",c,Pg),document.removeEventListener("touchstart",u,Pg)}},[]);var h=e.removeScrollBar,v=e.inert;return p.createElement(p.Fragment,null,v?p.createElement(i,{styles:Fge(a)}):null,h?p.createElement(kge,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function zge(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const Uge=vge(FG,qge);var VG=p.forwardRef(function(e,t){return p.createElement(DS,xu({},e,{ref:t,sideCar:Uge}))});VG.classNames=DS.classNames;const MS=VG;var Vge=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Eg=new WeakMap,d2=new WeakMap,u2={},MP=0,WG=function(e){return e&&(e.host||WG(e.parentNode))},Wge=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=WG(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},Hge=function(e,t,r,n){var a=Wge(t,Array.isArray(e)?e:[e]);u2[r]||(u2[r]=new WeakMap);var i=u2[r],s=[],l=new Set,c=new Set(a),d=function(f){!f||l.has(f)||(l.add(f),d(f.parentNode))};a.forEach(d);var u=function(f){!f||c.has(f)||Array.prototype.forEach.call(f.children,function(m){if(l.has(m))u(m);else try{var h=m.getAttribute(n),v=h!==null&&h!=="false",g=(Eg.get(m)||0)+1,y=(i.get(m)||0)+1;Eg.set(m,g),i.set(m,y),s.push(m),g===1&&v&&d2.set(m,!0),y===1&&m.setAttribute(r,"true"),v||m.setAttribute(n,"true")}catch(x){console.error("aria-hidden: cannot operate on ",m,x)}})};return u(t),l.clear(),MP++,function(){s.forEach(function(f){var m=Eg.get(f)-1,h=i.get(f)-1;Eg.set(f,m),i.set(f,h),m||(d2.has(f)||f.removeAttribute(n),d2.delete(f)),h||f.removeAttribute(r)}),MP--,MP||(Eg=new WeakMap,Eg=new WeakMap,d2=new WeakMap,u2={})}},RS=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),a=t||Vge(e);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live], script"))),Hge(n,a,r,"aria-hidden")):function(){return null}},LS="Dialog",[HG,GG]=pd(LS),[Gge,tu]=HG(LS),KG=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:a,onOpenChange:i,modal:s=!0}=e,l=p.useRef(null),c=p.useRef(null),[d,u]=kf({prop:n,defaultProp:a??!1,onChange:i,caller:LS});return o.jsx(Gge,{scope:t,triggerRef:l,contentRef:c,contentId:Hd(),titleId:Hd(),descriptionId:Hd(),open:d,onOpenChange:u,onOpenToggle:p.useCallback(()=>u(f=>!f),[u]),modal:s,children:r})};KG.displayName=LS;var YG="DialogTrigger",XG=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=tu(YG,r),i=Da(t,a.triggerRef);return o.jsx(Hn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":dT(a.open),...n,ref:i,onClick:Jr(e.onClick,a.onOpenToggle)})});XG.displayName=YG;var lT="DialogPortal",[Kge,JG]=HG(lT,{forceMount:void 0}),QG=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:a}=e,i=tu(lT,t);return o.jsx(Kge,{scope:t,forceMount:r,children:p.Children.map(n,s=>o.jsx(Ac,{present:r||i.open,children:o.jsx(Xx,{asChild:!0,container:a,children:s})}))})};QG.displayName=lT;var pN="DialogOverlay",ZG=p.forwardRef((e,t)=>{const r=JG(pN,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,i=tu(pN,e.__scopeDialog);return i.modal?o.jsx(Ac,{present:n||i.open,children:o.jsx(Xge,{...a,ref:t})}):null});ZG.displayName=pN;var Yge=dh("DialogOverlay.RemoveScroll"),Xge=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=tu(pN,r);return o.jsx(MS,{as:Yge,allowPinchZoom:!0,shards:[a.contentRef],children:o.jsx(Hn.div,{"data-state":dT(a.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),Vp="DialogContent",eK=p.forwardRef((e,t)=>{const r=JG(Vp,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,i=tu(Vp,e.__scopeDialog);return o.jsx(Ac,{present:n||i.open,children:i.modal?o.jsx(Jge,{...a,ref:t}):o.jsx(Qge,{...a,ref:t})})});eK.displayName=Vp;var Jge=p.forwardRef((e,t)=>{const r=tu(Vp,e.__scopeDialog),n=p.useRef(null),a=Da(t,r.contentRef,n);return p.useEffect(()=>{const i=n.current;if(i)return RS(i)},[]),o.jsx(tK,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Jr(e.onCloseAutoFocus,i=>{i.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:Jr(e.onPointerDownOutside,i=>{const s=i.detail.originalEvent,l=s.button===0&&s.ctrlKey===!0;(s.button===2||l)&&i.preventDefault()}),onFocusOutside:Jr(e.onFocusOutside,i=>i.preventDefault())})}),Qge=p.forwardRef((e,t)=>{const r=tu(Vp,e.__scopeDialog),n=p.useRef(!1),a=p.useRef(!1);return o.jsx(tK,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{e.onCloseAutoFocus?.(i),i.defaultPrevented||(n.current||r.triggerRef.current?.focus(),i.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:i=>{e.onInteractOutside?.(i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const s=i.target;r.triggerRef.current?.contains(s)&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),tK=p.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:i,...s}=e,l=tu(Vp,r),c=p.useRef(null),d=Da(t,c);return TS(),o.jsxs(o.Fragment,{children:[o.jsx(U1,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:i,children:o.jsx(Yx,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":dT(l.open),...s,ref:d,onDismiss:()=>l.onOpenChange(!1)})}),o.jsxs(o.Fragment,{children:[o.jsx(eve,{titleId:l.titleId}),o.jsx(rve,{contentRef:c,descriptionId:l.descriptionId})]})]})}),cT="DialogTitle",rK=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=tu(cT,r);return o.jsx(Hn.h2,{id:a.titleId,...n,ref:t})});rK.displayName=cT;var nK="DialogDescription",aK=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=tu(nK,r);return o.jsx(Hn.p,{id:a.descriptionId,...n,ref:t})});aK.displayName=nK;var oK="DialogClose",iK=p.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=tu(oK,r);return o.jsx(Hn.button,{type:"button",...n,ref:t,onClick:Jr(e.onClick,()=>a.onOpenChange(!1))})});iK.displayName=oK;function dT(e){return e?"open":"closed"}var sK="DialogTitleWarning",[Zge,lK]=Dpe(sK,{contentName:Vp,titleName:cT,docsSlug:"dialog"}),eve=({titleId:e})=>{const t=lK(sK),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return p.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},tve="DialogDescriptionWarning",rve=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${lK(tve).contentName}}.`;return p.useEffect(()=>{const a=e.current?.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},cK=KG,nve=XG,dK=QG,uT=ZG,fT=eK,mT=rK,hT=aK,$S=iK;const ln=cK,ave=dK,Hm=$S,uK=ye.forwardRef(({className:e,disableAnimations:t,...r},n)=>{const a=typeof window<"u"&&(window.matchMedia?.("(pointer: coarse)")?.matches||window.innerWidth<768),i=typeof window<"u"&&window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches,s=(t??!1)||a||i;return o.jsx(uT,{ref:n,className:Yt("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm",s?"data-[state=open]:animate-none data-[state=closed]:animate-none":"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...r})});uK.displayName=uT.displayName;const on=ye.forwardRef(({className:e,children:t,overlayClassName:r,disableAnimations:n,alignTop:a,...i},s)=>{const l=typeof window<"u"&&(window.matchMedia?.("(pointer: coarse)")?.matches||window.innerWidth<768),c=typeof window<"u"&&window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches,d=(n??!1)||l||c;return o.jsxs(ave,{children:[o.jsx(uK,{disableAnimations:d,className:r}),o.jsxs(fT,{ref:s,className:Yt("fixed z-50 grid w-full max-w-lg gap-4 border border-border bg-surface p-6 shadow-lg duration-200 sm:rounded-lg",a?"left-1/2 top-[10%] -translate-x-1/2":"left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",d?"data-[state=open]:animate-none data-[state=closed]:animate-none":"data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...i,children:[t,o.jsxs($S,{className:"absolute right-3 top-3 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground p-1",children:[o.jsx(Ml,{className:"h-5 w-5"}),o.jsx("span",{className:"sr-only",children:"Close"})]})]})]})});on.displayName=fT.displayName;const nn=({className:e,...t})=>o.jsx("div",{className:Yt("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});nn.displayName="DialogHeader";const Un=({className:e,...t})=>o.jsx("div",{className:Yt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Un.displayName="DialogFooter";const rn=ye.forwardRef(({className:e,...t},r)=>o.jsx(mT,{ref:r,className:Yt("text-lg font-semibold leading-none tracking-tight",e),...t}));rn.displayName=mT.displayName;const _n=ye.forwardRef(({className:e,...t},r)=>o.jsx(hT,{ref:r,className:Yt("text-sm text-text-secondary",e),...t}));_n.displayName=hT.displayName;const ove=1;let RP=0;function ive(){return RP=(RP+1)%Number.MAX_VALUE,RP.toString()}const il={state:{toasts:[]},listeners:[],getState:()=>il.state,setState:e=>{typeof e=="function"?il.state=e(il.state):il.state={...il.state,...e},il.listeners.forEach(t=>t(il.state))},subscribe:e=>(il.listeners.push(e),()=>{il.listeners=il.listeners.filter(t=>t!==e)})},gj=({...e})=>{const t=ive(),r=a=>il.setState(i=>({...i,toasts:i.toasts.map(s=>s.id===t?{...s,...a}:s)})),n=()=>il.setState(a=>({...a,toasts:a.toasts.filter(i=>i.id!==t)}));return il.setState(a=>({...a,toasts:[{...e,id:t,dismiss:n},...a.toasts].slice(0,ove)})),{id:t,dismiss:n,update:r}};function oo(){const[e,t]=p.useState(il.getState());return p.useEffect(()=>il.subscribe(n=>{t(n)}),[]),p.useEffect(()=>{const r=[];return e.toasts.forEach(n=>{if(n.duration===1/0)return;const a=setTimeout(()=>{n.dismiss()},n.duration||5e3);r.push(a)}),()=>{r.forEach(n=>clearTimeout(n))}},[e.toasts]),{toast:gj,toasts:e.toasts}}const sve="modulepreload",lve=function(e){return"/"+e},_$={},Ou=function(t,r,n){if(!r||r.length===0)return t();const a=document.getElementsByTagName("link");return Promise.all(r.map(i=>{if(i=lve(i),i in _$)return;_$[i]=!0;const s=i.endsWith(".css"),l=s?'[rel="stylesheet"]':"";if(!!n)for(let u=a.length-1;u>=0;u--){const f=a[u];if(f.href===i&&(!s||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${l}`))return;const d=document.createElement("link");if(d.rel=s?"stylesheet":sve,s||(d.as="script",d.crossOrigin=""),d.href=i,document.head.appendChild(d),s)return new Promise((u,f)=>{d.addEventListener("load",u),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>t()).catch(i=>{const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=i,window.dispatchEvent(s),!s.defaultPrevented)throw i})},cve=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ou(()=>Promise.resolve().then(()=>Jx),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class pT extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class S$ extends pT{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class C$ extends pT{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class P$ extends pT{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Uk;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Uk||(Uk={}));var dve=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(u){try{d(n.next(u))}catch(f){s(f)}}function c(u){try{d(n.throw(u))}catch(f){s(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class uve{constructor(t,{headers:r={},customFetch:n,region:a=Uk.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=cve(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return dve(this,arguments,void 0,function*(r,n={}){var a;try{const{headers:i,method:s,body:l,signal:c}=n;let d={},{region:u}=n;u||(u=this.region);const f=new URL(`${this.url}/${r}`);u&&u!=="any"&&(d["x-region"]=u,f.searchParams.set("forceFunctionRegion",u));let m;l&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",m=l):typeof l=="string"?(d["Content-Type"]="text/plain",m=l):typeof FormData<"u"&&l instanceof FormData?m=l:(d["Content-Type"]="application/json",m=JSON.stringify(l)));const h=yield this.fetch(f.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),i),body:m,signal:c}).catch(x=>{throw x.name==="AbortError"?x:new S$(x)}),v=h.headers.get("x-relay-error");if(v&&v==="true")throw new C$(h);if(!h.ok)throw new P$(h);let g=((a=h.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),y;return g==="application/json"?y=yield h.json():g==="application/octet-stream"?y=yield h.blob():g==="text/event-stream"?y=h:g==="multipart/form-data"?y=yield h.formData():y=yield h.text(),{data:y,error:null,response:h}}catch(i){return i instanceof Error&&i.name==="AbortError"?{data:null,error:new S$(i)}:{data:null,error:i,response:i instanceof P$||i instanceof C$?i.context:void 0}}})}}var Pl={},gT={},FS={},V1={},BS={},qS={},fve=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},sx=fve();const mve=sx.fetch,fK=sx.fetch.bind(sx),mK=sx.Headers,hve=sx.Request,pve=sx.Response,Jx=Object.freeze(Object.defineProperty({__proto__:null,Headers:mK,Request:hve,Response:pve,default:fK,fetch:mve},Symbol.toStringTag,{value:"Module"})),gve=Pie(Jx);var zS={};Object.defineProperty(zS,"__esModule",{value:!0});let vve=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};zS.default=vve;var hK=Us&&Us.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(qS,"__esModule",{value:!0});const xve=hK(gve),yve=hK(zS);let bve=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=xve.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var s,l,c,d;let u=null,f=null,m=null,h=i.status,v=i.statusText;if(i.ok){if(this.method!=="HEAD"){const b=await i.text();b===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((s=this.headers.get("Accept"))===null||s===void 0)&&s.includes("application/vnd.pgrst.plan+text"))?f=b:f=JSON.parse(b))}const y=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),x=(c=i.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");y&&x&&x.length>1&&(m=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(u={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,m=null,h=406,v="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const y=await i.text();try{u=JSON.parse(y),Array.isArray(u)&&i.status===404&&(f=[],u=null,h=200,v="OK")}catch{i.status===404&&y===""?(h=204,v="No Content"):u={message:y}}if(u&&this.isMaybeSingle&&(!((d=u?.details)===null||d===void 0)&&d.includes("0 rows"))&&(u=null,h=200,v="OK"),u&&this.shouldThrowOnError)throw new yve.default(u)}return{error:u,data:f,count:m,status:h,statusText:v}});return this.shouldThrowOnError||(a=a.catch(i=>{var s,l,c;return{error:{message:`${(s=i?.name)!==null&&s!==void 0?s:"FetchError"}: ${i?.message}`,details:`${(l=i?.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=i?.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};qS.default=bve;var wve=Us&&Us.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(BS,"__esModule",{value:!0});const jve=wve(qS);let Nve=class extends jve.default{select(t){let r=!1;const n=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:i=a}={}){const s=i?`${i}.order`:"order",l=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${l?`${l},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const i=typeof a>"u"?"offset":`${a}.offset`,s=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(s,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:i=!1,format:s="text"}={}){var l;const c=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${s}; for="${d}"; options=${c};`),s==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};BS.default=Nve;var _ve=Us&&Us.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(V1,"__esModule",{value:!0});const Sve=_ve(BS);let Cve=class extends Sve.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const s=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${i}fts${s}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};V1.default=Cve;var Pve=Us&&Us.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(FS,"__esModule",{value:!0});const F0=Pve(V1);let Ave=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=a}select(t,r){const{head:n=!1,count:a}=r??{},i=n?"HEAD":"GET";let s=!1;const l=(t??"*").split("").map(c=>/\s/.test(c)&&!s?"":(c==='"'&&(s=!s),c)).join("");return this.url.searchParams.set("select",l),a&&this.headers.append("Prefer",`count=${a}`),new F0.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var a;const i="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const s=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(s.length>0){const l=[...new Set(s)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new F0.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:i=!0}={}){var s;const l="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),a&&this.headers.append("Prefer",`count=${a}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const c=t.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new F0.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}update(t,{count:r}={}){var n;const a="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new F0.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new F0.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};FS.default=Ave;var pK=Us&&Us.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(gT,"__esModule",{value:!0});const Eve=pK(FS),kve=pK(V1);let Ove=class gK{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new Eve.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new gK(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:i}={}){var s;let l;const c=new URL(`${this.url}/rpc/${t}`);let d;n||a?(l=n?"HEAD":"GET",Object.entries(r).filter(([f,m])=>m!==void 0).map(([f,m])=>[f,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([f,m])=>{c.searchParams.append(f,m)})):(l="POST",d=r);const u=new Headers(this.headers);return i&&u.set("Prefer",`count=${i}`),new kve.default({method:l,url:c,headers:u,schema:this.schemaName,body:d,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}};gT.default=Ove;var Qx=Us&&Us.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Pl,"__esModule",{value:!0});Pl.PostgrestError=Pl.PostgrestBuilder=Pl.PostgrestTransformBuilder=Pl.PostgrestFilterBuilder=Pl.PostgrestQueryBuilder=Pl.PostgrestClient=void 0;const vK=Qx(gT);Pl.PostgrestClient=vK.default;const xK=Qx(FS);Pl.PostgrestQueryBuilder=xK.default;const yK=Qx(V1);Pl.PostgrestFilterBuilder=yK.default;const bK=Qx(BS);Pl.PostgrestTransformBuilder=bK.default;const wK=Qx(qS);Pl.PostgrestBuilder=wK.default;const jK=Qx(zS);Pl.PostgrestError=jK.default;var Ive=Pl.default={PostgrestClient:vK.default,PostgrestQueryBuilder:xK.default,PostgrestFilterBuilder:yK.default,PostgrestTransformBuilder:bK.default,PostgrestBuilder:wK.default,PostgrestError:jK.default};const{PostgrestClient:Tve,PostgrestQueryBuilder:Bst,PostgrestFilterBuilder:qst,PostgrestTransformBuilder:zst,PostgrestBuilder:Ust,PostgrestError:Vst}=Ive;class Dve{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,a=parseInt(n.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const Mve="2.75.0",Rve=`realtime-js/${Mve}`,Lve="1.0.0",Vk=1e4,$ve=1e3,Fve=100;var Iy;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Iy||(Iy={}));var Bi;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Bi||(Bi={}));var Od;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Od||(Od={}));var Wk;(function(e){e.websocket="websocket"})(Wk||(Wk={}));var np;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(np||(np={}));class Bve{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),i=r.getUint8(2);let s=this.HEADER_LENGTH+2;const l=n.decode(t.slice(s,s+a));s=s+a;const c=n.decode(t.slice(s,s+i));s=s+i;const d=JSON.parse(n.decode(t.slice(s,t.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class NK{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var yo;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(yo||(yo={}));const A$=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((i,s)=>(i[s]=qve(s,e,t,a),i),{}):{}},qve=(e,t,r,n)=>{const a=t.find(l=>l.name===e),i=a?.type,s=r[e];return i&&!n.includes(i)?_K(i,s):Hk(s)},_K=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return Wve(t,r)}switch(e){case yo.bool:return zve(t);case yo.float4:case yo.float8:case yo.int2:case yo.int4:case yo.int8:case yo.numeric:case yo.oid:return Uve(t);case yo.json:case yo.jsonb:return Vve(t);case yo.timestamp:return Hve(t);case yo.abstime:case yo.date:case yo.daterange:case yo.int4range:case yo.int8range:case yo.money:case yo.reltime:case yo.text:case yo.time:case yo.timestamptz:case yo.timetz:case yo.tsrange:case yo.tstzrange:return Hk(t);default:return Hk(t)}},Hk=e=>e,zve=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Uve=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Vve=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Wve=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const s=e.slice(1,r);try{i=JSON.parse("["+s+"]")}catch{i=s?s.split(","):[]}return i.map(l=>_K(t,l))}return e},Hve=e=>typeof e=="string"?e.replace(" ","T"):e,SK=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class LP{constructor(t,r,n={},a=Vk){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var E$;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(E$||(E$={}));class Ty{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:i,onLeave:s,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ty.syncState(this.state,a,i,s),this.pendingDiffs.forEach(c=>{this.state=Ty.syncDiff(this.state,c,i,s)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},a=>{const{onJoin:i,onLeave:s,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Ty.syncDiff(this.state,a,i,s),l())}),this.onJoin((a,i,s)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:s})}),this.onLeave((a,i,s)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const i=this.cloneDeep(t),s=this.transformState(r),l={},c={};return this.map(i,(d,u)=>{s[d]||(c[d]=u)}),this.map(s,(d,u)=>{const f=i[d];if(f){const m=u.map(y=>y.presence_ref),h=f.map(y=>y.presence_ref),v=u.filter(y=>h.indexOf(y.presence_ref)<0),g=f.filter(y=>m.indexOf(y.presence_ref)<0);v.length>0&&(l[d]=v),g.length>0&&(c[d]=g)}else l[d]=u}),this.syncDiff(i,{joins:l,leaves:c},n,a)}static syncDiff(t,r,n,a){const{joins:i,leaves:s}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(i,(l,c)=>{var d;const u=(d=t[l])!==null&&d!==void 0?d:[];if(t[l]=this.cloneDeep(c),u.length>0){const f=t[l].map(h=>h.presence_ref),m=u.filter(h=>f.indexOf(h.presence_ref)<0);t[l].unshift(...m)}n(l,u,c)}),this.map(s,(l,c)=>{let d=t[l];if(!d)return;const u=c.map(f=>f.presence_ref);d=d.filter(f=>u.indexOf(f.presence_ref)<0),t[l]=d,a(l,d,c),d.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var k$;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(k$||(k$={}));var Dy;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Dy||(Dy={}));var of;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(of||(of={}));class vT{constructor(t,r={config:{}},n){var a,i;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Bi.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new LP(this,Od.join,this.params,this.timeout),this.rejoinTimer=new NK(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Bi.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Bi.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Bi.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Bi.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Bi.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Od.reply,{},(s,l)=>{this._trigger(this._replyEventName(l),s)}),this.presence=new Ty(this),this.broadcastEndpointURL=SK(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Bi.closed){const{config:{broadcast:s,presence:l,private:c}}=this.params,d=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(h=>h.filter))!==null&&a!==void 0?a:[],u=!!this.bindings[Dy.PRESENCE]&&this.bindings[Dy.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,f={},m={broadcast:s,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(h=>t?.(of.CHANNEL_ERROR,h)),this._onClose(()=>t?.(of.CLOSED)),this.updateJoinPayload(Object.assign({config:m},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:h})=>{var v;if(this.socket.setAuth(),h===void 0){t?.(of.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,y=(v=g?.length)!==null&&v!==void 0?v:0,x=[];for(let b=0;b<y;b++){const w=g[b],{filter:{event:j,schema:_,table:C,filter:E}}=w,P=h&&h[b];if(P&&P.event===j&&P.schema===_&&P.table===C&&P.filter===E)x.push(Object.assign(Object.assign({},w),{id:P.id}));else{this.unsubscribe(),this.state=Bi.errored,t?.(of.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,t&&t(of.SUBSCRIBED);return}}).receive("error",h=>{this.state=Bi.errored,t?.(of.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{t?.(of.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Bi.joined&&t===Dy.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:s}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:s,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=d.body)===null||a===void 0?void 0:a.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var s,l,c;const d=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(s=this.params)===null||s===void 0?void 0:s.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Bi.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Od.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new LP(this,Od.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Bi.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,i=setTimeout(()=>a.abort(),n),s=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(i),s}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new LP(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>Fve){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,i;const s=t.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=Od;if(n&&[l,c,d,u].indexOf(s)>=0&&n!==this._joinRef())return;let m=this._onMessage(s,r,n);if(r&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(h=>{var v,g,y;return((v=h.filter)===null||v===void 0?void 0:v.event)==="*"||((y=(g=h.filter)===null||g===void 0?void 0:g.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===s}).map(h=>h.callback(m,n)):(i=this.bindings[s])===null||i===void 0||i.filter(h=>{var v,g,y,x,b,w;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in h){const j=h.id,_=(v=h.filter)===null||v===void 0?void 0:v.event;return j&&((g=r.ids)===null||g===void 0?void 0:g.includes(j))&&(_==="*"||_?.toLocaleLowerCase()===((y=r.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const j=(b=(x=h?.filter)===null||x===void 0?void 0:x.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return j==="*"||j===((w=r?.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===s}).map(h=>{if(typeof m=="object"&&"ids"in m){const v=m.data,{schema:g,table:y,commit_timestamp:x,type:b,errors:w}=v;m=Object.assign(Object.assign({},{schema:g,table:y,commit_timestamp:x,eventType:b,new:{},old:{},errors:w}),this._getPayloadRecords(v))}h.callback(m,n)})}_isClosed(){return this.state===Bi.closed}_isJoined(){return this.state===Bi.joined}_isJoining(){return this.state===Bi.joining}_isLeaving(){return this.state===Bi.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),i={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&vT.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Od.close,{},t)}_onError(t){this._on(Od.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Bi.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=A$(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=A$(t.columns,t.old_record)),r}}const $P=()=>{},f2={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Gve=[1e3,2e3,5e3,1e4],Kve=1e4,Yve=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Xve{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Vk,this.transport=null,this.heartbeatIntervalMs=f2.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=$P,this.ref=0,this.reconnectTimer=null,this.logger=$P,this.conn=null,this.sendBuffer=[],this.serializer=new Bve,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let i;return a?i=a:typeof fetch>"u"?i=(...s)=>Ou(()=>Promise.resolve().then(()=>Jx),void 0).then(({default:l})=>l(...s)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...s)=>i(...s)},!(!((n=r?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Wk.websocket}`,this.httpEndpoint=SK(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Dve.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Lve}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Iy.connecting:return np.Connecting;case Iy.open:return np.Open;case Iy.closing:return np.Closing;default:return np.Closed}}isConnected(){return this.connectionState()===np.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(i=>i.topic===n);if(a)return a;{const i=new vT(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:n,payload:a,ref:i}=t,s=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${i})`,a),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close($ve,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},f2.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:i,ref:s}=r,l=s?`(${s})`:"",c=i.status||"";this.log("receive",`${c} ${n} ${a} ${l}`.trim(),i),this.channels.filter(d=>d._isMember(n)).forEach(d=>d._trigger(a,i,s)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Od.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([Yve],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:Rve};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(Od.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new NK(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},f2.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,i,s,l,c,d,u;if(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t?.timeout)!==null&&n!==void 0?n:Vk,this.heartbeatIntervalMs=(a=t?.heartbeatIntervalMs)!==null&&a!==void 0?a:f2.HEARTBEAT_INTERVAL,this.worker=(i=t?.worker)!==null&&i!==void 0?i:!1,this.accessToken=(s=t?.accessToken)!==null&&s!==void 0?s:null,this.heartbeatCallback=(l=t?.heartbeatCallback)!==null&&l!==void 0?l:$P,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t?.reconnectAfterMs)!==null&&c!==void 0?c:f=>Gve[f-1]||Kve,this.encode=(d=t?.encode)!==null&&d!==void 0?d:(f,m)=>m(JSON.stringify(f)),this.decode=(u=t?.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}class xT extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Si(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class Jve extends xT{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Gk extends xT{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var Qve=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(u){try{d(n.next(u))}catch(f){s(f)}}function c(u){try{d(n.throw(u))}catch(f){s(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const CK=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ou(()=>Promise.resolve().then(()=>Jx),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},Zve=()=>Qve(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ou(()=>Promise.resolve().then(()=>Jx),void 0)).Response:Response}),Kk=e=>{if(Array.isArray(e))return e.map(r=>Kk(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[a]=Kk(n)}),t},exe=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var fg=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(u){try{d(n.next(u))}catch(f){s(f)}}function c(u){try{d(n.throw(u))}catch(f){s(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const FP=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),txe=(e,t,r)=>fg(void 0,void 0,void 0,function*(){const n=yield Zve();e instanceof n&&!r?.noResolveJson?e.json().then(a=>{const i=e.status||500,s=a?.statusCode||i+"";t(new Jve(FP(a),i,s))}).catch(a=>{t(new Gk(FP(a),a))}):t(new Gk(FP(e),e))}),rxe=(e,t,r,n)=>{const a={method:e,headers:t?.headers||{}};return e==="GET"||!n?a:(exe(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t?.headers),a.body=JSON.stringify(n)):a.body=n,t?.duplex&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r))};function W1(e,t,r,n,a,i){return fg(this,void 0,void 0,function*(){return new Promise((s,l)=>{e(r,rxe(t,n,a,i)).then(c=>{if(!c.ok)throw c;return n?.noResolveJson?c:c.json()}).then(c=>s(c)).catch(c=>txe(c,l,n))})})}function gN(e,t,r,n){return fg(this,void 0,void 0,function*(){return W1(e,"GET",t,r,n)})}function pu(e,t,r,n,a){return fg(this,void 0,void 0,function*(){return W1(e,"POST",t,n,a,r)})}function Yk(e,t,r,n,a){return fg(this,void 0,void 0,function*(){return W1(e,"PUT",t,n,a,r)})}function nxe(e,t,r,n){return fg(this,void 0,void 0,function*(){return W1(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function PK(e,t,r,n,a){return fg(this,void 0,void 0,function*(){return W1(e,"DELETE",t,n,a,r)})}var axe=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(u){try{d(n.next(u))}catch(f){s(f)}}function c(u){try{d(n.throw(u))}catch(f){s(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class oxe{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return axe(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Si(t))return{data:null,error:t};throw t}})}}var ixe=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(u){try{d(n.next(u))}catch(f){s(f)}}function c(u){try{d(n.throw(u))}catch(f){s(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class sxe{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}asStream(){return new oxe(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.execute().then(t,r)}execute(){return ixe(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Si(t))return{data:null,error:t};throw t}})}}var Nl=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(u){try{d(n.next(u))}catch(f){s(f)}}function c(u){try{d(n.throw(u))}catch(f){s(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const lxe={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},O$={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class cxe{constructor(t,r={},n,a){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=CK(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,a){return Nl(this,void 0,void 0,function*(){try{let i;const s=Object.assign(Object.assign({},O$),a);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(s.upsert)});const c=s.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",s.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",s.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=n,l["cache-control"]=`max-age=${s.cacheControl}`,l["content-type"]=s.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),a?.headers&&(l=Object.assign(Object.assign({},l),a.headers));const d=this._removeEmptyFolders(r),u=this._getFinalPath(d),f=yield(t=="PUT"?Yk:pu)(this.fetch,`${this.url}/object/${u}`,i,Object.assign({headers:l},s?.duplex?{duplex:s.duplex}:{}));return{data:{path:d,id:f.Id,fullPath:f.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Si(i))return{data:null,error:i};throw i}})}upload(t,r,n){return Nl(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return Nl(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),s=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${s}`);l.searchParams.set("token",r);try{let c;const d=Object.assign({upsert:O$.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",d.cacheControl)):(c=n,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const f=yield Yk(this.fetch,l.toString(),c,{headers:u});return{data:{path:i,fullPath:f.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Si(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return Nl(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r?.upsert&&(a["x-upsert"]="true");const i=yield pu(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),s=new URL(this.url+i.url),l=s.searchParams.get("token");if(!l)throw new xT("No token returned by API");return{data:{signedUrl:s.toString(),path:t,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Si(n))return{data:null,error:n};throw n}})}update(t,r,n){return Nl(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Nl(this,void 0,void 0,function*(){try{return{data:yield pu(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Si(a))return{data:null,error:a};throw a}})}copy(t,r,n){return Nl(this,void 0,void 0,function*(){try{return{data:{path:(yield pu(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Si(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return Nl(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),i=yield pu(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const s=n?.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${s}`)},{data:i,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Si(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return Nl(this,void 0,void 0,function*(){try{const a=yield pu(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(s=>Object.assign(Object.assign({},s),{signedUrl:s.signedURL?encodeURI(`${this.url}${s.signedURL}${i}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Si(a))return{data:null,error:a};throw a}})}download(t,r){const a=typeof r?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(r?.transform||{}),s=i?`?${i}`:"",l=this._getFinalPath(t),c=()=>gN(this.fetch,`${this.url}/${a}/${l}${s}`,{headers:this.headers,noResolveJson:!0});return new sxe(c,this.shouldThrowOnError)}info(t){return Nl(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield gN(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Kk(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Si(n))return{data:null,error:n};throw n}})}exists(t){return Nl(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield nxe(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Si(n)&&n instanceof Gk){const a=n.originalError;if([400,404].includes(a?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],i=r?.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&a.push(i);const l=typeof r?.transform<"u"?"render/image":"object",c=this.transformOptsToQueryString(r?.transform||{});c!==""&&a.push(c);let d=a.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${d}`)}}}remove(t){return Nl(this,void 0,void 0,function*(){try{return{data:yield PK(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Si(r))return{data:null,error:r};throw r}})}list(t,r,n){return Nl(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},lxe),r),{prefix:t||""});return{data:yield pu(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Si(a))return{data:null,error:a};throw a}})}listV2(t,r){return Nl(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield pu(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Si(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const dxe="2.75.0",uxe={"X-Client-Info":`storage-js/${dxe}`};var kg=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(u){try{d(n.next(u))}catch(f){s(f)}}function c(u){try{d(n.throw(u))}catch(f){s(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class fxe{constructor(t,r={},n,a){this.shouldThrowOnError=!1;const i=new URL(t);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},uxe),r),this.fetch=CK(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return kg(this,void 0,void 0,function*(){try{return{data:yield gN(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Si(t))return{data:null,error:t};throw t}})}getBucket(t){return kg(this,void 0,void 0,function*(){try{return{data:yield gN(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Si(r))return{data:null,error:r};throw r}})}createBucket(t){return kg(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield pu(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Si(a))return{data:null,error:a};throw a}})}updateBucket(t,r){return kg(this,void 0,void 0,function*(){try{return{data:yield Yk(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Si(n))return{data:null,error:n};throw n}})}emptyBucket(t){return kg(this,void 0,void 0,function*(){try{return{data:yield pu(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Si(r))return{data:null,error:r};throw r}})}deleteBucket(t){return kg(this,void 0,void 0,function*(){try{return{data:yield PK(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Si(r))return{data:null,error:r};throw r}})}}class mxe extends fxe{constructor(t,r={},n,a){super(t,r,n,a)}from(t){return new cxe(this.url,this.headers,t,this.fetch)}}const hxe="2.75.0";let uy="";typeof Deno<"u"?uy="deno":typeof document<"u"?uy="web":typeof navigator<"u"&&navigator.product==="ReactNative"?uy="react-native":uy="node";const pxe={"X-Client-Info":`supabase-js-${uy}/${hxe}`},gxe={headers:pxe},vxe={schema:"public"},xxe={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},yxe={};var bxe=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(u){try{d(n.next(u))}catch(f){s(f)}}function c(u){try{d(n.throw(u))}catch(f){s(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const wxe=e=>{let t;return e?t=e:typeof fetch>"u"?t=fK:t=fetch,(...r)=>t(...r)},jxe=()=>typeof Headers>"u"?mK:Headers,Nxe=(e,t,r)=>{const n=wxe(r),a=jxe();return(i,s)=>bxe(void 0,void 0,void 0,function*(){var l;const c=(l=yield t())!==null&&l!==void 0?l:e;let d=new a(s?.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),n(i,Object.assign(Object.assign({},s),{headers:d}))})};var _xe=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(u){try{d(n.next(u))}catch(f){s(f)}}function c(u){try{d(n.throw(u))}catch(f){s(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};function Sxe(e){return e.endsWith("/")?e:e+"/"}function Cxe(e,t){var r,n;const{db:a,auth:i,realtime:s,global:l}=e,{db:c,auth:d,realtime:u,global:f}=t,m={db:Object.assign(Object.assign({},c),a),auth:Object.assign(Object.assign({},d),i),realtime:Object.assign(Object.assign({},u),s),storage:{},global:Object.assign(Object.assign(Object.assign({},f),l),{headers:Object.assign(Object.assign({},(r=f?.headers)!==null&&r!==void 0?r:{}),(n=l?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>_xe(this,void 0,void 0,function*(){return""})};return e.accessToken?m.accessToken=e.accessToken:delete m.accessToken,m}function Pxe(e){const t=e?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Sxe(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const AK="2.75.0",ev=30*1e3,Xk=3,BP=Xk*ev,Axe="http://localhost:9999",Exe="supabase.auth.token",kxe={"X-Client-Info":`gotrue-js/${AK}`},Jk="X-Supabase-Api-Version",EK={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Oxe=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Ixe=10*60*1e3;class Cb extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Fn(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Txe extends Cb{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function Dxe(e){return Fn(e)&&e.name==="AuthApiError"}class ap extends Cb{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class wh extends Cb{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class dm extends wh{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Mxe(e){return Fn(e)&&e.name==="AuthSessionMissingError"}class Og extends wh{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class m2 extends wh{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class h2 extends wh{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Rxe(e){return Fn(e)&&e.name==="AuthImplicitGrantRedirectError"}class I$ extends wh{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Qk extends wh{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function qP(e){return Fn(e)&&e.name==="AuthRetryableFetchError"}class T$ extends wh{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Zk extends wh{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const vN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),D$=` 	
\r=`.split(""),Lxe=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<D$.length;t+=1)e[D$[t].charCodeAt(0)]=-2;for(let t=0;t<vN.length;t+=1)e[vN[t].charCodeAt(0)]=t;return e})();function M$(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(vN[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(vN[n]),t.queuedBits-=6}}function kK(e,t,r){const n=Lxe[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function R$(e){const t=[],r=s=>{t.push(String.fromCodePoint(s))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=s=>{Bxe(s,n,r)};for(let s=0;s<e.length;s+=1)kK(e.charCodeAt(s),a,i);return t.join("")}function $xe(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Fxe(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}$xe(n,t)}}function Bxe(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Mv(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)kK(e.charCodeAt(a),r,n);return new Uint8Array(t)}function qxe(e){const t=[];return Fxe(e,r=>t.push(r)),new Uint8Array(t)}function up(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>M$(a,r,n)),M$(null,r,n),t.join("")}function zxe(e){return Math.round(Date.now()/1e3)+e}function Uxe(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Zl=()=>typeof window<"u"&&typeof document<"u",Lh={tested:!1,writable:!1},OK=()=>{if(!Zl())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Lh.tested)return Lh.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Lh.tested=!0,Lh.writable=!0}catch{Lh.tested=!0,Lh.writable=!1}return Lh.writable};function Vxe(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,i)=>{t[i]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const IK=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ou(()=>Promise.resolve().then(()=>Jx),void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},Wxe=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",tv=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},$h=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},tm=async(e,t)=>{await e.removeItem(t)};class US{constructor(){this.promise=new US.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}US.promiseConstructor=Promise;function zP(e){const t=e.split(".");if(t.length!==3)throw new Zk("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!Oxe.test(t[n]))throw new Zk("JWT not in base64url format");return{header:JSON.parse(R$(t[0])),payload:JSON.parse(R$(t[1])),signature:Mv(t[2]),raw:{header:t[0],payload:t[1]}}}async function Hxe(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function Gxe(e,t){return new Promise((n,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const s=await e(i);if(!t(i,null,s)){n(s);return}}catch(s){if(!t(i,s)){a(s);return}}})()})}function Kxe(e){return("0"+e.toString(16)).substr(-2)}function Yxe(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let i=0;i<56;i++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,Kxe).join("")}async function Xxe(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function Jxe(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await Xxe(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ig(e,t,r=!1){const n=Yxe();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await tv(e,`${t}-code-verifier`,a);const i=await Jxe(n);return[i,n===i?"plain":"s256"]}const Qxe=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Zxe(e){const t=e.headers.get(Jk);if(!t||!t.match(Qxe))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function e0e(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function t0e(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const r0e=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Tg(e){if(!r0e.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function UP(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function L$(e){return JSON.parse(JSON.stringify(e))}var n0e=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const Yh=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),a0e=[502,503,504];async function $$(e){var t;if(!Wxe(e))throw new Qk(Yh(e),0);if(a0e.includes(e.status))throw new Qk(Yh(e),e.status);let r;try{r=await e.json()}catch(i){throw new ap(Yh(i),i)}let n;const a=Zxe(e);if(a&&a.getTime()>=EK["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new T$(Yh(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new dm}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,s)=>i&&typeof s=="string",!0))throw new T$(Yh(r),e.status,r.weak_password.reasons);throw new Txe(Yh(r),e.status||500,n)}const o0e=(e,t,r,n)=>{const a={method:e,headers:t?.headers||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function na(e,t,r,n){var a;const i=Object.assign({},n?.headers);i[Jk]||(i[Jk]=EK["2024-01-01"].name),n?.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const s=(a=n?.query)!==null&&a!==void 0?a:{};n?.redirectTo&&(s.redirect_to=n.redirectTo);const l=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",c=await i0e(e,t,r+l,{headers:i,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(c):{data:Object.assign({},c),error:null}}async function i0e(e,t,r,n,a,i){const s=o0e(t,n,a,i);let l;try{l=await e(r,Object.assign({},s))}catch(c){throw console.error(c),new Qk(Yh(c),0)}if(l.ok||await $$(l),n?.noResolveJson)return l;try{return await l.json()}catch(c){await $$(c)}}function Pd(e){var t;let r=null;c0e(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=zxe(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function F$(e){const t=Pd(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function ym(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function s0e(e){return{data:e,error:null}}function l0e(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i}=e,s=n0e(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i},c=Object.assign({},s);return{data:{properties:l,user:c},error:null}}function B$(e){return e}function c0e(e){return e.access_token&&e.refresh_token&&e.expires_in}const VP=["global","local","others"];var d0e=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class u0e{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=IK(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=VP[0]){if(VP.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${VP.join(", ")}`);try{return await na(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Fn(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await na(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:ym})}catch(n){if(Fn(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=d0e(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n?.newEmail,delete a.newEmail),await na(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:l0e,redirectTo:r?.redirectTo})}catch(r){if(Fn(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await na(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:ym})}catch(r){if(Fn(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,i,s,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await na(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t?.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:B$});if(u.error)throw u.error;const f=await u.json(),m=(s=u.headers.get("x-total-count"))!==null&&s!==void 0?s:0,h=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return h.length>0&&(h.forEach(v=>{const g=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(v.split(";")[1].split("=")[1]);d[`${y}Page`]=g}),d.total=parseInt(m)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(Fn(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){Tg(t);try{return await na(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:ym})}catch(r){if(Fn(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Tg(t);try{return await na(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:ym})}catch(n){if(Fn(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Tg(t);try{return await na(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:ym})}catch(n){if(Fn(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Tg(t.userId);try{const{data:r,error:n}=await na(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Fn(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Tg(t.userId),Tg(t.id);try{return{data:await na(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Fn(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,a,i,s,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await na(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t?.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:B$});if(u.error)throw u.error;const f=await u.json(),m=(s=u.headers.get("x-total-count"))!==null&&s!==void 0?s:0,h=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return h.length>0&&(h.forEach(v=>{const g=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(v.split(";")[1].split("=")[1]);d[`${y}Page`]=g}),d.total=parseInt(m)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(Fn(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(t){try{return await na(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Fn(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await na(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Fn(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(t){try{return await na(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Fn(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await na(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Fn(r))return{data:null,error:r};throw r}}}function q$(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Dg={debug:!!(globalThis&&OK()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class TK extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class f0e extends TK{}async function m0e(e,t,r){Dg.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Dg.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){Dg.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{Dg.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw Dg.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new f0e(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Dg.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function h0e(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function DK(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function p0e(e){return parseInt(e,16)}function g0e(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function v0e(e){var t;const{chainId:r,domain:n,expirationTime:a,issuedAt:i=new Date,nonce:s,notBefore:l,requestId:c,resources:d,scheme:u,uri:f,version:m}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(s&&s.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${s}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(m!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${m}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const h=DK(e.address),v=u?`${u}://${n}`:n,g=e.statement?`${e.statement}
`:"",y=`${v} wants you to sign in with your Ethereum account:
${h}

${g}`;let x=`URI: ${f}
Version: ${m}
Chain ID: ${r}${s?`
Nonce: ${s}`:""}
Issued At: ${i.toISOString()}`;if(a&&(x+=`
Expiration Time: ${a.toISOString()}`),l&&(x+=`
Not Before: ${l.toISOString()}`),c&&(x+=`
Request ID: ${c}`),d){let b=`
Resources:`;for(const w of d){if(!w||typeof w!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${w}`);b+=`
- ${w}`}x+=b}return`${y}
${x}`}class _i extends Error{constructor({message:t,code:r,cause:n,name:a}){var i;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(i=a??(n instanceof Error?n.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class xN extends _i{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function x0e({error:e,options:t}){var r,n,a;const{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new _i({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new _i({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new _i({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((a=i.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new _i({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new _i({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new _i({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return i.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new _i({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new _i({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const s=window.location.hostname;if(RK(s)){if(i.rp.id!==s)return new _i({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new _i({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new _i({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new _i({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new _i({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function y0e({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new _i({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new _i({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(RK(n)){if(r.rpId!==n)return new _i({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new _i({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new _i({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new _i({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}var MK=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class b0e{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const w0e=new b0e;function j0e(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,a=MK(e,["challenge","user","excludeCredentials"]),i=Mv(t).buffer,s=Object.assign(Object.assign({},r),{id:Mv(r.id).buffer}),l=Object.assign(Object.assign({},a),{challenge:i,user:s});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const d=n[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:Mv(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function N0e(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=MK(e,["challenge","allowCredentials"]),a=Mv(t).buffer,i=Object.assign(Object.assign({},n),{challenge:a});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let s=0;s<r.length;s++){const l=r[s];i.allowCredentials[s]=Object.assign(Object.assign({},l),{id:Mv(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return i}function _0e(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:up(new Uint8Array(e.response.attestationObject)),clientDataJSON:up(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function S0e(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:up(new Uint8Array(a.authenticatorData)),clientDataJSON:up(new Uint8Array(a.clientDataJSON)),signature:up(new Uint8Array(a.signature)),userHandle:a.userHandle?up(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function RK(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function z$(){var e,t;return!!(Zl()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function C0e(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new xN("Browser returned unexpected credential type",t)}:{data:null,error:new xN("Empty credential response",t)}}catch(t){return{data:null,error:x0e({error:t,options:e})}}}async function P0e(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new xN("Browser returned unexpected credential type",t)}:{data:null,error:new xN("Empty credential response",t)}}catch(t){return{data:null,error:y0e({error:t,options:e})}}}const A0e={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},E0e={userVerification:"preferred",hints:["security-key"]};function yN(...e){const t=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),r=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),n={};for(const a of e)if(a)for(const i in a){const s=a[i];if(s!==void 0)if(Array.isArray(s))n[i]=s;else if(r(s))n[i]=s;else if(t(s)){const l=n[i];t(l)?n[i]=yN(l,s):n[i]=yN(s)}else n[i]=s}return n}function k0e(e,t){return yN(A0e,e,t||{})}function O0e(e,t){return yN(E0e,e,t||{})}class I0e{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:a},i){try{const{data:s,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!s)return{data:null,error:l};const c=a??w0e.createNewAbortSignal();if(s.webauthn.type==="create"){const{user:d}=s.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${n}`),d.displayName||(d.displayName=d.name)}switch(s.webauthn.type){case"create":{const d=k0e(s.webauthn.credential_options.publicKey,i?.create),{data:u,error:f}=await C0e({publicKey:d,signal:c});return u?{data:{factorId:t,challengeId:s.id,webauthn:{type:s.webauthn.type,credential_response:u}},error:null}:{data:null,error:f}}case"request":{const d=O0e(s.webauthn.credential_options.publicKey,i?.request),{data:u,error:f}=await P0e(Object.assign(Object.assign({},s.webauthn.credential_options),{publicKey:d,signal:c}));return u?{data:{factorId:t,challengeId:s.id,webauthn:{type:s.webauthn.type,credential_response:u}},error:null}:{data:null,error:f}}}}catch(s){return Fn(s)?{data:null,error:s}:{data:null,error:new ap("Unexpected error in challenge",s)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}},i){if(!r)return{data:null,error:new Cb("rpId is required for WebAuthn authentication")};try{if(!z$())return{data:null,error:new ap("Browser does not support WebAuthn",null)};const{data:s,error:l}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:a},{request:i});if(!s)return{data:null,error:l};const{webauthn:c}=s;return this._verify({factorId:t,challengeId:s.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:n,credential_response:c.credential_response}})}catch(s){return Fn(s)?{data:null,error:s}:{data:null,error:new ap("Unexpected error in authenticate",s)}}}async _register({friendlyName:t,rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a},i){if(!r)return{data:null,error:new Cb("rpId is required for WebAuthn registration")};try{if(!z$())return{data:null,error:new ap("Browser does not support WebAuthn",null)};const{data:s,error:l}=await this._enroll({friendlyName:t});if(!s)return await this.client.mfa.listFactors().then(u=>{var f;return(f=u.data)===null||f===void 0?void 0:f.all.find(m=>m.factor_type==="webauthn"&&m.friendly_name===t&&m.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u?.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:s.id,friendlyName:s.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:a},{create:i});return c?this._verify({factorId:s.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(s){return Fn(s)?{data:null,error:s}:{data:null,error:new ap("Unexpected error in register",s)}}}}h0e();const T0e={url:Axe,storageKey:Exe,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:kxe,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function U$(e,t,r){return await r()}const Mg={};class Pb{get jwks(){var t,r;return(r=(t=Mg[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Mg[this.storageKey]=Object.assign(Object.assign({},Mg[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Mg[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Mg[this.storageKey]=Object.assign(Object.assign({},Mg[this.storageKey]),{cachedAt:t})}constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Pb.nextInstanceID,Pb.nextInstanceID+=1,this.instanceID>0&&Zl()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},T0e),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new u0e({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=IK(a.fetch),this.lock=a.lock||U$,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:Zl()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=m0e:this.lock=U$,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new I0e(this)},this.persistSession?(a.storage?this.storage=a.storage:OK()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=q$(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=q$(this.memoryStorage)),Zl()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${AK}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=Vxe(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Zl()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),Rxe(i)){const c=(t=i.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:s,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",s,"redirect type",l),await this._saveSession(s),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Fn(r)?{error:r}:{error:new ap("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const i=await na(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t?.options)===null||a===void 0?void 0:a.captchaToken}},xform:Pd}),{data:s,error:l}=i;if(l||!s)return{data:{user:null,session:null},error:l};const c=s.session,d=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(Fn(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,n,a;try{let i;if("email"in t){const{email:u,password:f,options:m}=t;let h=null,v=null;this.flowType==="pkce"&&([h,v]=await Ig(this.storage,this.storageKey)),i=await na(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m?.emailRedirectTo,body:{email:u,password:f,data:(r=m?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:m?.captchaToken},code_challenge:h,code_challenge_method:v},xform:Pd})}else if("phone"in t){const{phone:u,password:f,options:m}=t;i=await na(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=m?.data)!==null&&n!==void 0?n:{},channel:(a=m?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:m?.captchaToken}},xform:Pd})}else throw new m2("You must provide either an email or phone number and a password");const{data:s,error:l}=i;if(l||!s)return{data:{user:null,session:null},error:l};const c=s.session,d=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(Fn(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:s,options:l}=t;r=await na(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:s,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:F$})}else if("phone"in t){const{phone:i,password:s,options:l}=t;r=await na(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:s,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:F$})}else throw new m2("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Og}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Fn(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,a,i,s,l,c,d,u,f,m;let h,v;if("message"in t)h=t.message,v=t.signature;else{const{chain:g,wallet:y,statement:x,options:b}=t;let w;if(Zl())if(typeof y=="object")w=y;else{const k=window;if("ethereum"in k&&typeof k.ethereum=="object"&&"request"in k.ethereum&&typeof k.ethereum.request=="function")w=k.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!b?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=y}const j=new URL((r=b?.url)!==null&&r!==void 0?r:window.location.href),_=await w.request({method:"eth_requestAccounts"}).then(k=>k).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!_||_.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const C=DK(_[0]);let E=(n=b?.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!E){const k=await w.request({method:"eth_chainId"});E=p0e(k)}const P={domain:j.host,address:C,statement:x,uri:j.href,version:"1",chainId:E,nonce:(a=b?.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(s=(i=b?.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&s!==void 0?s:new Date,expirationTime:(l=b?.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=b?.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=b?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(u=b?.signInWithEthereum)===null||u===void 0?void 0:u.resources};h=v0e(P),v=await w.request({method:"personal_sign",params:[g0e(h),C]})}try{const{data:g,error:y}=await na(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:h,signature:v},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(m=t.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Pd});if(y)throw y;return!g||!g.session||!g.user?{data:{user:null,session:null},error:new Og}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:Object.assign({},g),error:y})}catch(g){if(Fn(g))return{data:{user:null,session:null},error:g};throw g}}async signInWithSolana(t){var r,n,a,i,s,l,c,d,u,f,m,h;let v,g;if("message"in t)v=t.message,g=t.signature;else{const{chain:y,wallet:x,statement:b,options:w}=t;let j;if(Zl())if(typeof x=="object")j=x;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))j=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!w?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");j=x}const _=new URL((r=w?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in j&&j.signIn){const C=await j.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w?.signInWithSolana),{version:"1",domain:_.host,uri:_.href}),b?{statement:b}:null));let E;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")E=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)E=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in E&&"signature"in E&&(typeof E.signedMessage=="string"||E.signedMessage instanceof Uint8Array)&&E.signature instanceof Uint8Array)v=typeof E.signedMessage=="string"?E.signedMessage:new TextDecoder().decode(E.signedMessage),g=E.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in j)||typeof j.signMessage!="function"||!("publicKey"in j)||typeof j!="object"||!j.publicKey||!("toBase58"in j.publicKey)||typeof j.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${_.host} wants you to sign in with your Solana account:`,j.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${_.href}`,`Issued At: ${(a=(n=w?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=w?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((s=w?.signInWithSolana)===null||s===void 0)&&s.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((l=w?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((c=w?.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((d=w?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((f=(u=w?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",...w.signInWithSolana.resources.map(E=>`- ${E}`)]:[]].join(`
`);const C=await j.signMessage(new TextEncoder().encode(v),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=C}}try{const{data:y,error:x}=await na(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:up(g)},!((m=t.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Pd});if(x)throw x;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new Og}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:x})}catch(y){if(Fn(y))return{data:{user:null,session:null},error:y};throw y}}async _exchangeCodeForSession(t){const r=await $h(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:i,error:s}=await na(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Pd});if(await tm(this.storage,`${this.storageKey}-code-verifier`),s)throw s;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Og}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:s})}catch(i){if(Fn(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:i,nonce:s}=t,l=await na(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:i,nonce:s,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Pd}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Og}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(r){if(Fn(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,i,s;try{if("email"in t){const{email:l,options:c}=t;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await Ig(this.storage,this.storageKey));const{error:f}=await na(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c?.data)!==null&&r!==void 0?r:{},create_user:(n=c?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c?.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:l,options:c}=t,{data:d,error:u}=await na(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=c?.data)!==null&&a!==void 0?a:{},create_user:(i=c?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(s=c?.channel)!==null&&s!==void 0?s:"sms"}});return{data:{user:null,session:null,messageId:d?.message_id},error:u}}throw new m2("You must provide either an email or phone number.")}catch(l){if(Fn(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(t){var r,n;try{let a,i;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:s,error:l}=await na(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:Pd});if(l)throw l;if(!s)throw new Error("An error occurred on token verification.");const c=s.session,d=s.user;return c?.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(a){if(Fn(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let i=null,s=null;return this.flowType==="pkce"&&([i,s]=await Ig(this.storage,this.storageKey)),await na(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:s}),headers:this.headers,xform:s0e})}catch(i){if(Fn(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new dm;const{error:a}=await na(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(Fn(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:i}=t,{error:s}=await na(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return{data:{user:null,session:null},error:s}}else if("phone"in t){const{phone:n,type:a,options:i}=t,{data:s,error:l}=await na(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return{data:{user:null,session:null,messageId:s?.message_id},error:l}}throw new m2("You must provide either an email or phone number and a type")}catch(r){if(Fn(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await $h(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<BP:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const s=await $h(this.userStorage,this.storageKey+"-user");s?.user?t.user=s.user:t.user=UP()}if(this.storage.isServer&&t.user){let s=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,d,u)=>(!s&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),s=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,u))})}return{data:{session:t},error:null}}const{data:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await na(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:ym}):await this._useSession(async r=>{var n,a,i;const{data:s,error:l}=r;if(l)throw l;return!(!((n=s.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new dm}:await na(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=s.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:ym})})}catch(r){if(Fn(r))return Mxe(r)&&(await this._removeSession(),await tm(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:i}=n;if(i)throw i;if(!a.session)throw new dm;const s=a.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await Ig(this.storage,this.storageKey));const{data:d,error:u}=await na(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:s.access_token,xform:ym});if(u)throw u;return s.user=d.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}})}catch(n){if(Fn(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new dm;const r=Date.now()/1e3;let n=r,a=!0,i=null;const{payload:s}=zP(t.access_token);if(s.exp&&(n=s.exp,a=n<=r),a){const{data:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;i={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(Fn(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:s,error:l}=r;if(l)throw l;t=(n=s.session)!==null&&n!==void 0?n:void 0}if(!t?.refresh_token)throw new dm;const{data:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Fn(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Zl())throw new h2("No browser detected.");if(t.error||t.error_description||t.error_code)throw new h2(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new I$("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new h2("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new I$("No code detected.");const{data:b,error:w}=await this._exchangeCodeForSession(t.code);if(w)throw w;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:i,refresh_token:s,expires_in:l,expires_at:c,token_type:d}=t;if(!i||!l||!s||!d)throw new h2("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(l);let m=u+f;c&&(m=parseInt(c));const h=m-u;h*1e3<=ev&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${f}s`);const v=m-f;u-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,m,u):u-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,m,u);const{data:g,error:y}=await this._getUser(i);if(y)throw y;const x={provider_token:n,provider_refresh_token:a,access_token:i,expires_in:f,expires_at:m,refresh_token:s,token_type:d,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:t.type},error:null}}catch(n){if(Fn(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await $h(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{error:i};const s=(n=a.session)===null||n===void 0?void 0:n.access_token;if(s){const{error:l}=await this.admin.signOut(s,t);if(l&&!(Dxe(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(await this._removeSession(),await tm(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=Uxe(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:i},error:s}=r;if(s)throw s;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Ig(this.storage,this.storageKey,!0));try{return await na(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(Fn(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Fn(r))return{data:null,error:r};throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:a}=await this._useSession(async i=>{var s,l,c,d,u;const{data:f,error:m}=i;if(m)throw m;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(s=t.options)===null||s===void 0?void 0:s.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await na(this.fetch,"GET",h,{headers:this.headers,jwt:(u=(d=f.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return Zl()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:t.provider,url:n?.url},error:null}}catch(n){if(Fn(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:a,data:{session:i}}=r;if(a)throw a;const{options:s,provider:l,token:c,access_token:d,nonce:u}=t,f=await na(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=i?.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:c,access_token:d,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:s?.captchaToken}},xform:Pd}),{data:m,error:h}=f;return h?{data:{user:null,session:null},error:h}:!m||!m.session||!m.user?{data:{user:null,session:null},error:new Og}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("USER_UPDATED",m.session)),{data:m,error:h})}catch(a){if(Fn(a))return{data:{user:null,session:null},error:a};throw a}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:s}=r;if(s)throw s;return await na(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Fn(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await Gxe(async a=>(a>0&&await Hxe(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await na(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Pd})),(a,i)=>{const s=200*Math.pow(2,a);return i&&qP(i)&&Date.now()+s-n<ev})}catch(n){if(this._debug(r,"error",n),Fn(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Zl()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await $h(this.storage,this.storageKey);if(a&&this.userStorage){let s=await $h(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!s&&(s={user:a.user},await tv(this.userStorage,this.storageKey+"-user",s)),a.user=(t=s?.user)!==null&&t!==void 0?t:UP()}else if(a&&!a.user&&!a.user){const s=await $h(this.storage,this.storageKey+"-user");s&&s?.user?(a.user=s.user,await tm(this.storage,this.storageKey+"-user"),await tv(this.storage,this.storageKey,a)):a.user=UP()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const i=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<BP;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${BP}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:s}=await this._callRefreshToken(a.refresh_token);s&&(console.error(s),qP(s)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:s,error:l}=await this._getUser(a.access_token);!l&&s?.user?(a.user=s.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(s){console.error("Error getting user data:",s),this._debug(n,"error getting user data, skipping SIGNED_IN notification",s)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new dm;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new US;const{data:i,error:s}=await this._refreshAccessToken(t);if(s)throw s;if(!i.session)throw new dm;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={data:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(a,"error",i),Fn(i)){const s={data:null,error:i};return qP(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(s),s}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],s=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){i.push(c)}});if(await Promise.all(s),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await tv(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const i=L$(a);await tv(this.storage,this.storageKey,i)}else{const a=L$(r);await tv(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await tm(this.storage,this.storageKey),await tm(this.storage,this.storageKey+"-code-verifier"),await tm(this.storage,this.storageKey+"-user"),this.userStorage&&await tm(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Zl()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),ev);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/ev);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${ev}ms, refresh threshold is ${Xk} ticks`),a<=Xk&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof TK)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Zl()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,s]=await Ig(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(s)}`});a.push(l.toString())}if(n?.queryParams){const i=new URLSearchParams(n.queryParams);a.push(i.toString())}return n?.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?{data:null,error:i}:await na(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Fn(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:s}=r;if(s)return{data:null,error:s};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:d}=await na(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(t.factorType==="totp"&&c.type==="totp"&&(!((a=c?.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(Fn(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{data:null,error:i};const s=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?_0e(t.webauthn.credential_response):S0e(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:c}=await na(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:s,headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:c})})}catch(r){if(Fn(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{data:null,error:i};const s=await na(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});if(s.error)return s;const{data:l}=s;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:j0e(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:N0e(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Fn(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const a={all:[],phone:[],totp:[],webauthn:[]};for(const i of(t=r?.factors)!==null&&t!==void 0?t:[])a.all.push(i),i.status==="verified"&&a[i.factor_type].push(i);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:i}=t;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=zP(a.access_token);let l=null;s.aal&&(l=s.aal);let c=l;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const u=s.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+Ixe>a)return n;const{data:i,error:s}=await na(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,n=i.keys.find(l=>l.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:h,error:v}=await this.getSession();if(v||!h.session)return{data:null,error:v};n=h.session.access_token}const{header:a,payload:i,signature:s,raw:{header:l,payload:c}}=zP(n);r?.allowExpired||e0e(i.exp);const d=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!d){const{error:h}=await this.getUser(n);if(h)throw h;return{data:{claims:i,header:a,signature:s},error:null}}const u=t0e(a.alg),f=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,s,qxe(`${l}.${c}`)))throw new Zk("Invalid JWT signature");return{data:{claims:i,header:a,signature:s},error:null}}catch(n){if(Fn(n))return{data:null,error:n};throw n}}}Pb.nextInstanceID=0;const D0e=Pb;class M0e extends D0e{constructor(t){super(t)}}var R0e=globalThis&&globalThis.__awaiter||function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function l(u){try{d(n.next(u))}catch(f){s(f)}}function c(u){try{d(n.throw(u))}catch(f){s(f)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class L0e{constructor(t,r,n){var a,i,s;this.supabaseUrl=t,this.supabaseKey=r;const l=Pxe(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:vxe,realtime:yxe,auth:Object.assign(Object.assign({},xxe),{storageKey:c}),global:gxe},u=Cxe(n??{},d);this.storageKey=(a=u.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(f,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((s=u.auth)!==null&&s!==void 0?s:{},this.headers,u.global.fetch),this.fetch=Nxe(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new Tve(new URL("rest/v1",l).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new mxe(this.storageUrl.href,this.headers,this.fetch,n?.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new uve(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){return R0e(this,void 0,void 0,function*(){var t,r;if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:i,storageKey:s,flowType:l,lock:c,debug:d},u,f){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new M0e({url:this.authUrl.href,headers:Object.assign(Object.assign({},m),u),storageKey:s,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:i,flowType:l,lock:c,debug:d,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(h=>h.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new Xve(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n?.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const $0e=(e,t,r)=>new L0e(e,t,r);function F0e(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}F0e()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const yT="https://dlfryxtyxqoacuunswuc.supabase.co",eO="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsZnJ5eHR5eHFvYWN1dW5zd3VjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4ODg0MzcsImV4cCI6MjA3MTQ2NDQzN30.AizQBbCE1p_xfAQ9T0Eha1anGzcFETcc__8AV4iaQTY";function B0e(){try{return(new URL(yT).host||"").split(".")[0]||""}catch{return""}}function q0e(){const e=B0e();return e?`sb-${e}-auth-token`:"sb-auth-token"}async function z0e(){try{if(typeof Gm<"u"&&Gm?.auth?.getSession){const e=new Promise((a,i)=>setTimeout(()=>i(new Error("getSession timeout")),1e3)),t=Gm.auth.getSession(),{data:r}=await Promise.race([t,e]),n=r?.session?.access_token;if(n)return console.debug("[Supabase Wrapper] Token obtido via getSession"),n}}catch(e){console.debug("[Supabase Wrapper] getSession falhou ou timeout:",e.message)}try{const e=q0e(),t=localStorage.getItem(e);if(t){const r=JSON.parse(t);if(r?.access_token)return console.debug("[Supabase Wrapper] Token obtido via localStorage"),r.access_token;if(r?.currentSession?.access_token)return console.debug("[Supabase Wrapper] Token obtido via localStorage (currentSession)"),r.currentSession.access_token}}catch(e){console.warn("[Supabase Wrapper] Erro ao ler localStorage:",e)}return console.warn("[Supabase Wrapper]  Nenhum token encontrado - usando anon key"),null}const U0e=e=>{const t=new URLSearchParams;return Object.entries(e).forEach(([r,n])=>{n!=null&&(Array.isArray(n)?n.forEach(a=>t.append(r,String(a))):t.append(r,String(n)))}),t.toString()},LK=async(e,t={})=>{const{method:r="GET",body:n,headers:a={},params:i={},signal:s,timeoutMs:l=2e4}=t,c=U0e(i),d=`${yT}/rest/v1/${e}${c?`?${c}`:""}`,u={apikey:eO,Authorization:`Bearer ${eO}`,"Content-Type":"application/json",Prefer:"return=representation",...a};try{const w=await z0e();w&&(u.Authorization=`Bearer ${w}`)}catch(w){console.warn("[Supabase Wrapper] Erro ao obter token de sesso:",w)}const f={method:r,headers:u};n&&(f.body=JSON.stringify(n)),s&&(f.signal=s);const m=new AbortController,h=setTimeout(()=>{console.warn(`[Supabase Wrapper]  Timeout (${l}ms) para ${e}`);try{m.abort("timeout")}catch{}},Math.max(5e3,l)),v=(()=>{if(!s)return m.signal;try{s.addEventListener("abort",()=>{try{m.abort("upstream-abort")}catch{}})}catch{}return m.signal})();f.signal=v;const g=Date.now();let y;try{y=await fetch(d,f)}finally{clearTimeout(h)}if(!y.ok){let w="";try{w=await y.text()}catch{}const j=Date.now()-g;throw new Error(`[Supabase Wrapper] HTTP ${y.status} (${j}ms) - ${w||"unknown error"}`)}const x=Date.now()-g;let b;try{b=await y.json()}catch(w){throw console.error(`[Supabase Wrapper] Erro ao parsear JSON de ${e}:`,w),new Error(`[Supabase Wrapper] JSON parse error: ${w.message}`)}return x>3e3?console.warn(`[Supabase Wrapper]  fetch ${e} LENTO (${x}ms)`):console.debug(`[Supabase Wrapper] fetch ${e} OK (${x}ms)`),{data:b,error:null}};class V0e{constructor(t){this.table=t,this.params={},this.multiFilters={},this.selectColumns="*",this.signal=null}select(t="*"){return this.selectColumns=t,this.params.select=t,this}eq(t,r){return this._addFilter(t,`eq.${r}`),this}neq(t,r){return this.params[t]=`neq.${r}`,this}gt(t,r){return this.params[t]=`gt.${r}`,this}gte(t,r){return this._addFilter(t,`gte.${r}`),this}lt(t,r){return this.params[t]=`lt.${r}`,this}lte(t,r){return this._addFilter(t,`lte.${r}`),this}like(t,r){return this.params[t]=`like.${r}`,this}ilike(t,r){return this.params[t]=`ilike.${r}`,this}is(t,r){return this.params[t]=`is.${r}`,this}in(t,r){return this.params[t]=`in.(${r.join(",")})`,this}not(t,r,n){return this.params[t]=`not.${r}.${n}`,this}or(t){return this.params.or=`(${t})`,this}contains(t,r){return this.params[t]=`cs.{${r}}`,this}containedBy(t,r){return this.params[t]=`cd.{${r}}`,this}filter(t,r,n){return this._addFilter(t,`${r}.${n}`),this}order(t,r={}){const n=r.ascending===!1?"desc":"asc";return this.params.order=`${t}.${n}`,this}limit(t){return this.params.limit=t,this}range(t,r){return this.params.offset=t,this.params.limit=r-t+1,this}single(){return this.params.limit=1,this.isSingle=!0,this}maybeSingle(){return this.params.limit=1,this.isMaybeSingle=!0,this}abortSignal(t){return this.signal=t,this}_addFilter(t,r){this.multiFilters[t]||(this.multiFilters[t]=[]),this.multiFilters[t].push(r)}async then(t,r){try{const n={...this.params};Object.entries(this.multiFilters).forEach(([i,s])=>{s.length===1?n[i]=s[0]:s.length>1&&(n[i]=s)});const a=await LK(this.table,{method:"GET",params:n,signal:this.signal});this.isSingle&&a.data&&(a.data=a.data[0]||null),this.isMaybeSingle&&a.data&&(a.data=a.data[0]||null),t(a)}catch(n){r(n)}}}class W0e extends V0e{insert(t){return this.method="POST",this.body=Array.isArray(t)?t:[t],this}update(t){return this.method="PATCH",this.body=t,this}upsert(t,r={}){this.method="POST",this.body=Array.isArray(t)?t:[t];const n=r.ignoreDuplicates?"resolution=ignore-duplicates":"resolution=merge-duplicates",a=r.returning==="minimal"?"return=minimal":"return=representation";return this.headers={...this.headers||{},Prefer:`${n},${a}`},r.onConflict&&(this.params.on_conflict=r.onConflict),this}delete(){return this.method="DELETE",this}async then(t,r){try{const n={...this.params};Object.entries(this.multiFilters).forEach(([i,s])=>{s.length===1?n[i]=s[0]:s.length>1&&(n[i]=s)});const a=await LK(this.table,{method:this.method||"GET",body:this.body,params:n,signal:this.signal,headers:this.headers||{}});this.isSingle&&a.data&&(a.data=a.data[0]||null),this.isMaybeSingle&&a.data&&(a.data=a.data[0]||null),t(a)}catch(n){r(n)}}}const Gm={from(e){return new W0e(e)},auth:null,supabaseUrl:yT,supabaseKey:eO};typeof window<"u"&&Gm.from("empresas").select("id").limit(1).then(({data:e,error:t})=>{t&&console.error("[Supabase Wrapper]  ERRO:",t)}).catch(e=>{console.error("[Supabase Wrapper]  EXCEPTION:",e)});const $K="https://dlfryxtyxqoacuunswuc.supabase.co",FK="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsZnJ5eHR5eHFvYWN1dW5zd3VjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4ODg0MzcsImV4cCI6MjA3MTQ2NDQzN30.AizQBbCE1p_xfAQ9T0Eha1anGzcFETcc__8AV4iaQTY",gu=$0e($K,FK,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storage:typeof window<"u"?window.localStorage:void 0},global:{headers:{"X-Client-Info":"fluxo7arena-web"}}});try{typeof window<"u"&&Gm&&(Gm.auth=gu.auth)}catch{}const ve={from:e=>Gm.from(e),auth:gu.auth,storage:gu.storage,functions:gu.functions,realtime:gu.realtime,channel:(...e)=>gu.channel(...e),removeChannel:(...e)=>gu.removeChannel(...e),removeAllChannels:()=>gu.removeAllChannels(),getChannels:()=>gu.getChannels(),supabaseUrl:$K,supabaseKey:FK};typeof window<"u"&&(window.__supabase=ve,window.__supabase_original=gu,window.__supabase_wrapper=Gm);const BK=p.createContext({}),Do=()=>{const e=p.useContext(BK);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},H0e=({children:e})=>{const[t,r]=p.useState(null),[n,a]=p.useState(null),[i,s]=p.useState(null),[l,c]=p.useState(!0),[d,u]=p.useState(!1),f=p.useRef(null),m=p.useRef(!1);p.useEffect(()=>{if((()=>{try{return sessionStorage.getItem("auth:forceLogout")==="1"}catch{return!1}})()){try{localStorage.removeItem("auth:userProfile"),localStorage.removeItem("auth:company")}catch{}r(null),a(null),s(null),u(!0),c(!1);try{sessionStorage.removeItem("auth:forceLogout")}catch{}try{ve.auth.signOut({scope:"global"}).catch(()=>{})}catch{}return}try{const E=localStorage.getItem("auth:userProfile"),P=localStorage.getItem("auth:company");E&&a(JSON.parse(E)),P&&s(JSON.parse(P)),(E||P)&&u(!0)}catch(E){console.warn("AuthContext: falha ao hidratar cache local:",E)}(async()=>{try{const{data:{session:E},error:P}=await ve.auth.getSession();P&&console.error("supabase.auth.getSession error:",P),E?.user?(r(E.user),u(!0),await h(E.user.id),f.current=E.user.id):u(!0)}catch(E){console.error("getSession exception:",E)}finally{c(!1)}})();const{data:_}=ve.auth.onAuthStateChange(async(E,P)=>{console.log("[AuthContext] onAuthStateChange",{event:E,userId:P?.user?.id||null});try{if(E==="SIGNED_OUT"){try{localStorage.removeItem("auth:userProfile"),localStorage.removeItem("auth:company")}catch{}r(null),a(null),s(null),f.current=null,m.current=!1,c(!1),u(!0);return}const k=P?.user||null;r(k),u(!0),k?.id&&(await h(k.id),f.current=k.id,c(!1))}catch(k){console.error("onAuthStateChange handler error:",k),c(!1),u(!0)}}),C=setTimeout(()=>{c(E=>E&&!1),u(E=>E||!0)},12e3);return()=>{clearTimeout(C),_.subscription.unsubscribe()}},[]),p.useEffect(()=>{(async()=>{try{if(!d||!t)return;const j=!n,_=!!n&&!i&&!!n.codigo_empresa;(j||_)&&(await h(t.id),f.current=t.id)}catch{}})()},[d,t?.id,!!n,n?.codigo_empresa,!!i]),p.useEffect(()=>{const w=()=>{try{const C=localStorage.getItem("auth:userProfile"),E=localStorage.getItem("auth:company");if(C){const P=JSON.parse(C);(!n||!n.codigo_empresa)&&a(P)}if(E){const P=JSON.parse(E);(!i||!i.codigo_empresa)&&s(P)}}catch{}},j=()=>{w(),t?.id&&h(t.id).catch(()=>{})},_=()=>{document.visibilityState==="visible"&&j()};return window.addEventListener("focus",j),document.addEventListener("visibilitychange",_),()=>{window.removeEventListener("focus",j),document.removeEventListener("visibilitychange",_)}},[t?.id]);const h=async w=>{if(m.current){console.log("[AuthDebug] loadUserProfile:skip (already running)");return}m.current=!0;try{const j=[300,800,1600,3e3],_=P=>new Promise(k=>setTimeout(k,P)),C=async(P,k)=>{let M;try{const S=new Promise(T=>{M=setTimeout(()=>T({__timeout:!0}),k)});return await Promise.race([P,S])}finally{clearTimeout(M)}},E=1200;for(let P=0;P<=j.length;P++){console.log("[AuthDebug] loadUserProfile:start",{userId:w,attempt:P});try{console.log("[AuthDebug] querying colaboradores",{userId:w});const k=ve.from("colaboradores").select("*").eq("id",w).single(),M=await C(k,E);if(M&&M.__timeout){console.warn("[AuthDebug] colaboradores:timeout, using usuarios fallback (inline)");try{console.log("[AuthDebug] fallback-inline: querying usuarios by id");const{data:T,error:D}=await ve.from("usuarios").select("*").eq("id",w).maybeSingle();if(!D&&T){let B=null;if(T.codigo_empresa){console.log("[AuthDebug] fallback-inline: querying empresas by codigo",{codigo_empresa:T.codigo_empresa});const{data:z,error:$}=await ve.from("empresas").select("*").eq("codigo_empresa",T.codigo_empresa).single();$?console.warn("[AuthDebug] fallback-inline: empresa error",{status:$.status,code:$.code,message:$.message}):(B=z,console.log("[AuthDebug] fallback-inline: empresa loaded"))}const U={id:w,nome:T.nome||null,cargo:T.papel||"user",codigo_empresa:T.codigo_empresa||null,_source:"usuarios"};a(U);try{localStorage.setItem("auth:userProfile",JSON.stringify(U))}catch{}if(B){s(B);try{localStorage.setItem("auth:company",JSON.stringify(B))}catch{}console.log("[AuthDebug] fallback-inline: set company from usuarios path")}else console.warn("[AuthDebug] fallback-inline: no company resolved; preserving previous company");return}D&&console.warn("[AuthDebug] fallback-inline: usuarios error",{status:D.status,code:D.code,message:D.message})}catch(T){console.warn("[AuthDebug] fallback-inline: unexpected error",T?.message||T)}if(P<j.length){await _(j[P]);continue}return}const{data:S,error:I}=M||{};if(console.log("[AuthDebug] colaboradores:success",{hasProfile:!!S,codigo_empresa:S?.codigo_empresa||null}),I){if(console.warn("[AuthDebug] colaboradores:error",{code:I.code,status:I.status,message:I.message}),I.code==="42P17"){if(P<j.length){await _(j[P]);continue}console.warn("RLS recursion (42P17) persistente ao carregar perfil. Prosseguindo sem alterar cache.");return}if([401,403].includes(Number(I.status))&&(console.warn("[AuthDebug] Erro de autorizao detectado, tentando fallback"),P<j.length)){await _(j[P]);continue}if(I.code==="PGRST116"){try{console.log("[AuthDebug] fallback: querying usuarios by id");const{data:D,error:B}=await ve.from("usuarios").select("*").eq("id",w).maybeSingle();if(!B&&D){let U=null;if(D.codigo_empresa){console.log("[AuthDebug] fallback: querying empresas by codigo",{codigo_empresa:D.codigo_empresa});const{data:$,error:Y}=await ve.from("empresas").select("*").eq("codigo_empresa",D.codigo_empresa).single();Y?console.warn("[AuthDebug] fallback: empresa error",{status:Y.status,code:Y.code,message:Y.message}):(U=$,console.log("[AuthDebug] fallback: empresa loaded"))}const z={id:w,nome:D.nome||null,cargo:D.papel||"user",codigo_empresa:D.codigo_empresa||null,_source:"usuarios"};a(z);try{localStorage.setItem("auth:userProfile",JSON.stringify(z))}catch{}if(U){s(U);try{localStorage.setItem("auth:company",JSON.stringify(U))}catch{}console.log("[AuthDebug] fallback: set company from usuarios path")}else console.warn("[AuthDebug] fallback: no company resolved; preserving previous company");return}B&&console.warn("[AuthDebug] fallback: usuarios error",{status:B.status,code:B.code,message:B.message})}catch{}console.warn("AuthContext: perfil no encontrado (PGRST116) e fallback falhou; mantendo cache atual.");return}if([401,403,406].includes(Number(I.status))&&P<j.length){await _(j[P]);continue}throw I}if(!S){if(P<j.length){await _(j[P]);continue}return}a(S);try{localStorage.setItem("auth:userProfile",JSON.stringify(S))}catch{}if(S?.codigo_empresa){console.log("[AuthDebug] company: querying empresas by codigo from colaboradores",{codigo_empresa:S.codigo_empresa});const{data:T,error:D}=await ve.from("empresas").select("*").eq("codigo_empresa",S.codigo_empresa).single();if(D){if([401,403,406].includes(Number(D.status))&&P<j.length){await _(j[P]);continue}console.warn("[AuthDebug] company: load error; preserving previous company",{status:D.status,code:D.code,message:D.message});return}else{s(T);try{localStorage.setItem("auth:company",JSON.stringify(T))}catch{}console.log("[AuthDebug] company: set from colaboradores path")}}else console.warn("[AuthDebug] company: no codigo_empresa available on profile; preserving previous company");return}catch(k){if(console.error("[AuthDebug] loadUserProfile:unexpected error",{message:k?.message,code:k?.code,status:k?.status}),P<j.length){await _(j[P]);continue}console.error("Error loading user profile:",k);return}}}finally{m.current=!1}},b={user:t,userProfile:n,company:i,loading:l,authReady:d,signUp:async(w,j,_,C=null)=>{try{const{data:E,error:P}=await ve.auth.signUp({email:w,password:j});if(P)throw P;if(E?.user&&C){const{data:k,error:M}=await ve.from("empresas").select("id, codigo_empresa").eq("codigo_empresa",C).single();if(M)throw new Error("Cdigo de empresa invlido. Verifique o cdigo informado.");const{error:S}=await ve.from("colaboradores").insert({id:E.user.id,codigo_empresa:k.codigo_empresa,nome:_,cargo:"user",ativo:!0});if(S)throw S}return{data:E,error:null}}catch(E){let P="No foi possvel cadastrar. Verifique os dados e tente novamente.";const k=(E?.message||"").toLowerCase();return k.includes("user already registered")||k.includes("already registered")||k.includes("user already exists")?P="Email j cadastrado. Tente entrar ou redefinir a senha.":k.includes("password")&&k.includes("length")&&(P="Senha muito curta. Use ao menos 6 caracteres."),{data:null,error:new Error(P)}}},signIn:async(w,j)=>{try{const{data:_,error:C}=await ve.auth.signInWithPassword({email:w,password:j});if(C){let E="No foi possvel entrar. Tente novamente.";const P=(C.message||"").toLowerCase(),k=C.status;return P.includes("invalid login")||P.includes("invalid credentials")||k===400?E="Email ou senha invlidos.":P.includes("email not confirmed")||P.includes("not confirmed")?E="Email no confirmado. Verifique sua caixa de entrada.":k===429?E="Muitas tentativas. Aguarde alguns minutos e tente novamente.":k>=500&&(E="Servio indisponvel no momento. Tente novamente mais tarde."),{data:null,error:new Error(E)}}return _.user&&await ve.from("colaboradores").select("id").eq("id",_.user.id).single(),{data:_,error:null}}catch(_){return{data:null,error:_}}},signOut:async()=>{try{const w=ve.auth.signOut({scope:"global"}),j=new Promise(_=>setTimeout(_,700));await Promise.race([w,j])}catch(w){console.warn("[AuthContext] signOut(): error during signOut",w?.message||w)}f.current=null,r(null),a(null),s(null),c(!1),u(!0);try{localStorage.removeItem("auth:userProfile"),localStorage.removeItem("auth:company"),localStorage.removeItem("clientes:list"),localStorage.removeItem("quadras:list"),localStorage.removeItem("agenda:courts"),localStorage.removeItem("agenda:selectedCourts"),localStorage.removeItem("agenda:viewFilter"),Object.keys(localStorage).filter(w=>w.startsWith("agenda:bookings:")).forEach(w=>localStorage.removeItem(w)),Object.keys(localStorage).filter(w=>w.startsWith("sb-")).forEach(w=>localStorage.removeItem(w)),Object.keys(sessionStorage).filter(w=>w.startsWith("sb-")).forEach(w=>sessionStorage.removeItem(w))}catch{}try{sessionStorage.setItem("auth:forceLogout","1")}catch{}try{window.location.replace("/")}catch{}return{error:null}},reloadCompany:async()=>{try{const w=n&&n.codigo_empresa?n.codigo_empresa:null;if(!w)return;const{data:j,error:_}=await ve.from("empresas").select("*").eq("codigo_empresa",w).single();if(!_&&j){s(j);try{localStorage.setItem("auth:company",JSON.stringify(j))}catch{}}}catch{}}};return o.jsx(BK.Provider,{value:b,children:e})};function Pa(e){"@babel/helpers - typeof";return Pa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pa(e)}function ii(e){if(e===null||e===!0||e===!1)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function Pn(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function Zn(e){Pn(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||Pa(e)==="object"&&t==="[object Date]"?new Date(e.getTime()):typeof e=="number"||t==="[object Number]"?new Date(e):((typeof e=="string"||t==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function Ia(e,t){Pn(2,arguments);var r=Zn(e),n=ii(t);return isNaN(n)?new Date(NaN):(n&&r.setDate(r.getDate()+n),r)}function Xd(e,t){Pn(2,arguments);var r=Zn(e),n=ii(t);if(isNaN(n))return new Date(NaN);if(!n)return r;var a=r.getDate(),i=new Date(r.getTime());i.setMonth(r.getMonth()+n+1,0);var s=i.getDate();return a>=s?i:(r.setFullYear(i.getFullYear(),i.getMonth(),a),r)}function qK(e,t){Pn(2,arguments);var r=Zn(e).getTime(),n=ii(t);return new Date(r+n)}var G0e={};function jh(){return G0e}function fd(e,t){var r,n,a,i,s,l,c,d;Pn(1,arguments);var u=jh(),f=ii((r=(n=(a=(i=t?.weekStartsOn)!==null&&i!==void 0?i:t==null||(s=t.locale)===null||s===void 0||(l=s.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&a!==void 0?a:u.weekStartsOn)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&r!==void 0?r:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var m=Zn(e),h=m.getDay(),v=(h<f?7:0)+h-f;return m.setDate(m.getDate()-v),m.setHours(0,0,0,0),m}function Wp(e){return Pn(1,arguments),fd(e,{weekStartsOn:1})}function K0e(e){Pn(1,arguments);var t=Zn(e),r=t.getFullYear(),n=new Date(0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);var a=Wp(n),i=new Date(0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);var s=Wp(i);return t.getTime()>=a.getTime()?r+1:t.getTime()>=s.getTime()?r:r-1}function Y0e(e){Pn(1,arguments);var t=K0e(e),r=new Date(0);r.setFullYear(t,0,4),r.setHours(0,0,0,0);var n=Wp(r);return n}function Ab(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}function ni(e){Pn(1,arguments);var t=Zn(e);return t.setHours(0,0,0,0),t}var X0e=864e5;function Nu(e,t){Pn(2,arguments);var r=ni(e),n=ni(t),a=r.getTime()-Ab(r),i=n.getTime()-Ab(n);return Math.round((a-i)/X0e)}var J0e=6e4;function Q0e(e,t){Pn(2,arguments);var r=ii(t);return qK(e,r*J0e)}function tO(e,t){Pn(2,arguments);var r=ii(t),n=r*7;return Ia(e,n)}function Z0e(e,t){Pn(2,arguments);var r=ii(t);return Xd(e,r*12)}function eye(e){Pn(1,arguments);var t;if(e&&typeof e.forEach=="function")t=e;else if(Pa(e)==="object"&&e!==null)t=Array.prototype.slice.call(e);else return new Date(NaN);var r;return t.forEach(function(n){var a=Zn(n);(r===void 0||r<a||isNaN(Number(a)))&&(r=a)}),r||new Date(NaN)}function tye(e){Pn(1,arguments);var t;if(e&&typeof e.forEach=="function")t=e;else if(Pa(e)==="object"&&e!==null)t=Array.prototype.slice.call(e);else return new Date(NaN);var r;return t.forEach(function(n){var a=Zn(n);(r===void 0||r>a||isNaN(a.getDate()))&&(r=a)}),r||new Date(NaN)}var zK=6e4,UK=36e5;function Vs(e,t){Pn(2,arguments);var r=ni(e),n=ni(t);return r.getTime()===n.getTime()}function bT(e){return Pn(1,arguments),e instanceof Date||Pa(e)==="object"&&Object.prototype.toString.call(e)==="[object Date]"}function rye(e){if(Pn(1,arguments),!bT(e)&&typeof e!="number")return!1;var t=Zn(e);return!isNaN(Number(t))}function Eb(e,t){Pn(2,arguments);var r=Zn(e),n=Zn(t),a=r.getFullYear()-n.getFullYear(),i=r.getMonth()-n.getMonth();return a*12+i}var nye=6048e5;function aye(e,t,r){Pn(2,arguments);var n=fd(e,r),a=fd(t,r),i=n.getTime()-Ab(n),s=a.getTime()-Ab(a);return Math.round((i-s)/nye)}function V$(e,t){var r=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return r<0?-1:r>0?1:r}function oye(e,t){Pn(2,arguments);var r=Zn(e),n=Zn(t),a=V$(r,n),i=Math.abs(Nu(r,n));r.setDate(r.getDate()-a*i);var s=+(V$(r,n)===-a),l=a*(i-s);return l===0?0:l}function vj(e){Pn(1,arguments);var t=Zn(e);return t.setHours(23,59,59,999),t}function VS(e){Pn(1,arguments);var t=Zn(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function pl(e){Pn(1,arguments);var t=Zn(e);return t.setDate(1),t.setHours(0,0,0,0),t}function iye(e){Pn(1,arguments);var t=Zn(e),r=new Date(0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function wT(e,t){var r,n,a,i,s,l,c,d;Pn(1,arguments);var u=jh(),f=ii((r=(n=(a=(i=t?.weekStartsOn)!==null&&i!==void 0?i:t==null||(s=t.locale)===null||s===void 0||(l=s.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&a!==void 0?a:u.weekStartsOn)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&r!==void 0?r:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var m=Zn(e),h=m.getDay(),v=(h<f?-7:0)+6-(h-f);return m.setDate(m.getDate()+v),m.setHours(23,59,59,999),m}function VK(e){return Pn(1,arguments),wT(e,{weekStartsOn:1})}function sye(e,t){Pn(2,arguments);var r=ii(t);return qK(e,-r)}var lye=864e5;function cye(e){Pn(1,arguments);var t=Zn(e),r=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var n=t.getTime(),a=r-n;return Math.floor(a/lye)+1}function bN(e){Pn(1,arguments);var t=1,r=Zn(e),n=r.getUTCDay(),a=(n<t?7:0)+n-t;return r.setUTCDate(r.getUTCDate()-a),r.setUTCHours(0,0,0,0),r}function WK(e){Pn(1,arguments);var t=Zn(e),r=t.getUTCFullYear(),n=new Date(0);n.setUTCFullYear(r+1,0,4),n.setUTCHours(0,0,0,0);var a=bN(n),i=new Date(0);i.setUTCFullYear(r,0,4),i.setUTCHours(0,0,0,0);var s=bN(i);return t.getTime()>=a.getTime()?r+1:t.getTime()>=s.getTime()?r:r-1}function dye(e){Pn(1,arguments);var t=WK(e),r=new Date(0);r.setUTCFullYear(t,0,4),r.setUTCHours(0,0,0,0);var n=bN(r);return n}var uye=6048e5;function fye(e){Pn(1,arguments);var t=Zn(e),r=bN(t).getTime()-dye(t).getTime();return Math.round(r/uye)+1}function wN(e,t){var r,n,a,i,s,l,c,d;Pn(1,arguments);var u=jh(),f=ii((r=(n=(a=(i=t?.weekStartsOn)!==null&&i!==void 0?i:t==null||(s=t.locale)===null||s===void 0||(l=s.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&a!==void 0?a:u.weekStartsOn)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&r!==void 0?r:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var m=Zn(e),h=m.getUTCDay(),v=(h<f?7:0)+h-f;return m.setUTCDate(m.getUTCDate()-v),m.setUTCHours(0,0,0,0),m}function HK(e,t){var r,n,a,i,s,l,c,d;Pn(1,arguments);var u=Zn(e),f=u.getUTCFullYear(),m=jh(),h=ii((r=(n=(a=(i=t?.firstWeekContainsDate)!==null&&i!==void 0?i:t==null||(s=t.locale)===null||s===void 0||(l=s.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&a!==void 0?a:m.firstWeekContainsDate)!==null&&n!==void 0?n:(c=m.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1);if(!(h>=1&&h<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var v=new Date(0);v.setUTCFullYear(f+1,0,h),v.setUTCHours(0,0,0,0);var g=wN(v,t),y=new Date(0);y.setUTCFullYear(f,0,h),y.setUTCHours(0,0,0,0);var x=wN(y,t);return u.getTime()>=g.getTime()?f+1:u.getTime()>=x.getTime()?f:f-1}function mye(e,t){var r,n,a,i,s,l,c,d;Pn(1,arguments);var u=jh(),f=ii((r=(n=(a=(i=t?.firstWeekContainsDate)!==null&&i!==void 0?i:t==null||(s=t.locale)===null||s===void 0||(l=s.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&a!==void 0?a:u.firstWeekContainsDate)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1),m=HK(e,t),h=new Date(0);h.setUTCFullYear(m,0,f),h.setUTCHours(0,0,0,0);var v=wN(h,t);return v}var hye=6048e5;function pye(e,t){Pn(1,arguments);var r=Zn(e),n=wN(r,t).getTime()-mye(r,t).getTime();return Math.round(n/hye)+1}function no(e,t){for(var r=e<0?"-":"",n=Math.abs(e).toString();n.length<t;)n="0"+n;return r+n}var gye={y:function(t,r){var n=t.getUTCFullYear(),a=n>0?n:1-n;return no(r==="yy"?a%100:a,r.length)},M:function(t,r){var n=t.getUTCMonth();return r==="M"?String(n+1):no(n+1,2)},d:function(t,r){return no(t.getUTCDate(),r.length)},a:function(t,r){var n=t.getUTCHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h:function(t,r){return no(t.getUTCHours()%12||12,r.length)},H:function(t,r){return no(t.getUTCHours(),r.length)},m:function(t,r){return no(t.getUTCMinutes(),r.length)},s:function(t,r){return no(t.getUTCSeconds(),r.length)},S:function(t,r){var n=r.length,a=t.getUTCMilliseconds(),i=Math.floor(a*Math.pow(10,n-3));return no(i,r.length)}};const rm=gye;var Rg={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},vye={G:function(t,r,n){var a=t.getUTCFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return n.era(a,{width:"abbreviated"});case"GGGGG":return n.era(a,{width:"narrow"});case"GGGG":default:return n.era(a,{width:"wide"})}},y:function(t,r,n){if(r==="yo"){var a=t.getUTCFullYear(),i=a>0?a:1-a;return n.ordinalNumber(i,{unit:"year"})}return rm.y(t,r)},Y:function(t,r,n,a){var i=HK(t,a),s=i>0?i:1-i;if(r==="YY"){var l=s%100;return no(l,2)}return r==="Yo"?n.ordinalNumber(s,{unit:"year"}):no(s,r.length)},R:function(t,r){var n=WK(t);return no(n,r.length)},u:function(t,r){var n=t.getUTCFullYear();return no(n,r.length)},Q:function(t,r,n){var a=Math.ceil((t.getUTCMonth()+1)/3);switch(r){case"Q":return String(a);case"QQ":return no(a,2);case"Qo":return n.ordinalNumber(a,{unit:"quarter"});case"QQQ":return n.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(a,{width:"wide",context:"formatting"})}},q:function(t,r,n){var a=Math.ceil((t.getUTCMonth()+1)/3);switch(r){case"q":return String(a);case"qq":return no(a,2);case"qo":return n.ordinalNumber(a,{unit:"quarter"});case"qqq":return n.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(a,{width:"wide",context:"standalone"})}},M:function(t,r,n){var a=t.getUTCMonth();switch(r){case"M":case"MM":return rm.M(t,r);case"Mo":return n.ordinalNumber(a+1,{unit:"month"});case"MMM":return n.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(a,{width:"wide",context:"formatting"})}},L:function(t,r,n){var a=t.getUTCMonth();switch(r){case"L":return String(a+1);case"LL":return no(a+1,2);case"Lo":return n.ordinalNumber(a+1,{unit:"month"});case"LLL":return n.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(a,{width:"wide",context:"standalone"})}},w:function(t,r,n,a){var i=pye(t,a);return r==="wo"?n.ordinalNumber(i,{unit:"week"}):no(i,r.length)},I:function(t,r,n){var a=fye(t);return r==="Io"?n.ordinalNumber(a,{unit:"week"}):no(a,r.length)},d:function(t,r,n){return r==="do"?n.ordinalNumber(t.getUTCDate(),{unit:"date"}):rm.d(t,r)},D:function(t,r,n){var a=cye(t);return r==="Do"?n.ordinalNumber(a,{unit:"dayOfYear"}):no(a,r.length)},E:function(t,r,n){var a=t.getUTCDay();switch(r){case"E":case"EE":case"EEE":return n.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(a,{width:"short",context:"formatting"});case"EEEE":default:return n.day(a,{width:"wide",context:"formatting"})}},e:function(t,r,n,a){var i=t.getUTCDay(),s=(i-a.weekStartsOn+8)%7||7;switch(r){case"e":return String(s);case"ee":return no(s,2);case"eo":return n.ordinalNumber(s,{unit:"day"});case"eee":return n.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(i,{width:"short",context:"formatting"});case"eeee":default:return n.day(i,{width:"wide",context:"formatting"})}},c:function(t,r,n,a){var i=t.getUTCDay(),s=(i-a.weekStartsOn+8)%7||7;switch(r){case"c":return String(s);case"cc":return no(s,r.length);case"co":return n.ordinalNumber(s,{unit:"day"});case"ccc":return n.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(i,{width:"narrow",context:"standalone"});case"cccccc":return n.day(i,{width:"short",context:"standalone"});case"cccc":default:return n.day(i,{width:"wide",context:"standalone"})}},i:function(t,r,n){var a=t.getUTCDay(),i=a===0?7:a;switch(r){case"i":return String(i);case"ii":return no(i,r.length);case"io":return n.ordinalNumber(i,{unit:"day"});case"iii":return n.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(a,{width:"short",context:"formatting"});case"iiii":default:return n.day(a,{width:"wide",context:"formatting"})}},a:function(t,r,n){var a=t.getUTCHours(),i=a/12>=1?"pm":"am";switch(r){case"a":case"aa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(t,r,n){var a=t.getUTCHours(),i;switch(a===12?i=Rg.noon:a===0?i=Rg.midnight:i=a/12>=1?"pm":"am",r){case"b":case"bb":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(t,r,n){var a=t.getUTCHours(),i;switch(a>=17?i=Rg.evening:a>=12?i=Rg.afternoon:a>=4?i=Rg.morning:i=Rg.night,r){case"B":case"BB":case"BBB":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(t,r,n){if(r==="ho"){var a=t.getUTCHours()%12;return a===0&&(a=12),n.ordinalNumber(a,{unit:"hour"})}return rm.h(t,r)},H:function(t,r,n){return r==="Ho"?n.ordinalNumber(t.getUTCHours(),{unit:"hour"}):rm.H(t,r)},K:function(t,r,n){var a=t.getUTCHours()%12;return r==="Ko"?n.ordinalNumber(a,{unit:"hour"}):no(a,r.length)},k:function(t,r,n){var a=t.getUTCHours();return a===0&&(a=24),r==="ko"?n.ordinalNumber(a,{unit:"hour"}):no(a,r.length)},m:function(t,r,n){return r==="mo"?n.ordinalNumber(t.getUTCMinutes(),{unit:"minute"}):rm.m(t,r)},s:function(t,r,n){return r==="so"?n.ordinalNumber(t.getUTCSeconds(),{unit:"second"}):rm.s(t,r)},S:function(t,r){return rm.S(t,r)},X:function(t,r,n,a){var i=a._originalDate||t,s=i.getTimezoneOffset();if(s===0)return"Z";switch(r){case"X":return H$(s);case"XXXX":case"XX":return Xh(s);case"XXXXX":case"XXX":default:return Xh(s,":")}},x:function(t,r,n,a){var i=a._originalDate||t,s=i.getTimezoneOffset();switch(r){case"x":return H$(s);case"xxxx":case"xx":return Xh(s);case"xxxxx":case"xxx":default:return Xh(s,":")}},O:function(t,r,n,a){var i=a._originalDate||t,s=i.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+W$(s,":");case"OOOO":default:return"GMT"+Xh(s,":")}},z:function(t,r,n,a){var i=a._originalDate||t,s=i.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+W$(s,":");case"zzzz":default:return"GMT"+Xh(s,":")}},t:function(t,r,n,a){var i=a._originalDate||t,s=Math.floor(i.getTime()/1e3);return no(s,r.length)},T:function(t,r,n,a){var i=a._originalDate||t,s=i.getTime();return no(s,r.length)}};function W$(e,t){var r=e>0?"-":"+",n=Math.abs(e),a=Math.floor(n/60),i=n%60;if(i===0)return r+String(a);var s=t||"";return r+String(a)+s+no(i,2)}function H$(e,t){if(e%60===0){var r=e>0?"-":"+";return r+no(Math.abs(e)/60,2)}return Xh(e,t)}function Xh(e,t){var r=t||"",n=e>0?"-":"+",a=Math.abs(e),i=no(Math.floor(a/60),2),s=no(a%60,2);return n+i+r+s}const xye=vye;var G$=function(t,r){switch(t){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},GK=function(t,r){switch(t){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},yye=function(t,r){var n=t.match(/(P+)(p+)?/)||[],a=n[1],i=n[2];if(!i)return G$(t,r);var s;switch(a){case"P":s=r.dateTime({width:"short"});break;case"PP":s=r.dateTime({width:"medium"});break;case"PPP":s=r.dateTime({width:"long"});break;case"PPPP":default:s=r.dateTime({width:"full"});break}return s.replace("{{date}}",G$(a,r)).replace("{{time}}",GK(i,r))},bye={p:GK,P:yye};const wye=bye;var jye=["D","DD"],Nye=["YY","YYYY"];function _ye(e){return jye.indexOf(e)!==-1}function Sye(e){return Nye.indexOf(e)!==-1}function K$(e,t,r){if(e==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(e==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var Cye={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Pye=function(t,r,n){var a,i=Cye[t];return typeof i=="string"?a=i:r===1?a=i.one:a=i.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+a:a+" ago":a};const Aye=Pye;function Rv(e){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.width?String(t.width):e.defaultWidth,n=e.formats[r]||e.formats[e.defaultWidth];return n}}var Eye={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},kye={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Oye={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Iye={date:Rv({formats:Eye,defaultWidth:"full"}),time:Rv({formats:kye,defaultWidth:"full"}),dateTime:Rv({formats:Oye,defaultWidth:"full"})};const Tye=Iye;var Dye={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Mye=function(t,r,n,a){return Dye[t]};const Rye=Mye;function yu(e){return function(t,r){var n=r!=null&&r.context?String(r.context):"standalone",a;if(n==="formatting"&&e.formattingValues){var i=e.defaultFormattingWidth||e.defaultWidth,s=r!=null&&r.width?String(r.width):i;a=e.formattingValues[s]||e.formattingValues[i]}else{var l=e.defaultWidth,c=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[c]||e.values[l]}var d=e.argumentCallback?e.argumentCallback(t):t;return a[d]}}var Lye={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},$ye={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Fye={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Bye={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},qye={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},zye={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Uye=function(t,r){var n=Number(t),a=n%100;if(a>20||a<10)switch(a%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},Vye={ordinalNumber:Uye,era:yu({values:Lye,defaultWidth:"wide"}),quarter:yu({values:$ye,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:yu({values:Fye,defaultWidth:"wide"}),day:yu({values:Bye,defaultWidth:"wide"}),dayPeriod:yu({values:qye,defaultWidth:"wide",formattingValues:zye,defaultFormattingWidth:"wide"})};const Wye=Vye;function bu(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;var s=i[0],l=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?Gye(l,function(f){return f.test(s)}):Hye(l,function(f){return f.test(s)}),d;d=e.valueCallback?e.valueCallback(c):c,d=r.valueCallback?r.valueCallback(d):d;var u=t.slice(s.length);return{value:d,rest:u}}}function Hye(e,t){for(var r in e)if(e.hasOwnProperty(r)&&t(e[r]))return r}function Gye(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return r}function KK(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.match(e.matchPattern);if(!n)return null;var a=n[0],i=t.match(e.parsePattern);if(!i)return null;var s=e.valueCallback?e.valueCallback(i[0]):i[0];s=r.valueCallback?r.valueCallback(s):s;var l=t.slice(a.length);return{value:s,rest:l}}}var Kye=/^(\d+)(th|st|nd|rd)?/i,Yye=/\d+/i,Xye={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Jye={any:[/^b/i,/^(a|c)/i]},Qye={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Zye={any:[/1/i,/2/i,/3/i,/4/i]},ebe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},tbe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},rbe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},nbe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},abe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},obe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},ibe={ordinalNumber:KK({matchPattern:Kye,parsePattern:Yye,valueCallback:function(t){return parseInt(t,10)}}),era:bu({matchPatterns:Xye,defaultMatchWidth:"wide",parsePatterns:Jye,defaultParseWidth:"any"}),quarter:bu({matchPatterns:Qye,defaultMatchWidth:"wide",parsePatterns:Zye,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:bu({matchPatterns:ebe,defaultMatchWidth:"wide",parsePatterns:tbe,defaultParseWidth:"any"}),day:bu({matchPatterns:rbe,defaultMatchWidth:"wide",parsePatterns:nbe,defaultParseWidth:"any"}),dayPeriod:bu({matchPatterns:abe,defaultMatchWidth:"any",parsePatterns:obe,defaultParseWidth:"any"})};const sbe=ibe;var lbe={code:"en-US",formatDistance:Aye,formatLong:Tye,formatRelative:Rye,localize:Wye,match:sbe,options:{weekStartsOn:0,firstWeekContainsDate:1}};const YK=lbe;var cbe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,dbe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ube=/^'([^]*?)'?$/,fbe=/''/g,mbe=/[a-zA-Z]/;function Jt(e,t,r){var n,a,i,s,l,c,d,u,f,m,h,v,g,y,x,b,w,j;Pn(2,arguments);var _=String(t),C=jh(),E=(n=(a=r?.locale)!==null&&a!==void 0?a:C.locale)!==null&&n!==void 0?n:YK,P=ii((i=(s=(l=(c=r?.firstWeekContainsDate)!==null&&c!==void 0?c:r==null||(d=r.locale)===null||d===void 0||(u=d.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&l!==void 0?l:C.firstWeekContainsDate)!==null&&s!==void 0?s:(f=C.locale)===null||f===void 0||(m=f.options)===null||m===void 0?void 0:m.firstWeekContainsDate)!==null&&i!==void 0?i:1);if(!(P>=1&&P<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var k=ii((h=(v=(g=(y=r?.weekStartsOn)!==null&&y!==void 0?y:r==null||(x=r.locale)===null||x===void 0||(b=x.options)===null||b===void 0?void 0:b.weekStartsOn)!==null&&g!==void 0?g:C.weekStartsOn)!==null&&v!==void 0?v:(w=C.locale)===null||w===void 0||(j=w.options)===null||j===void 0?void 0:j.weekStartsOn)!==null&&h!==void 0?h:0);if(!(k>=0&&k<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!E.localize)throw new RangeError("locale must contain localize property");if(!E.formatLong)throw new RangeError("locale must contain formatLong property");var M=Zn(e);if(!rye(M))throw new RangeError("Invalid time value");var S=Ab(M),I=sye(M,S),T={firstWeekContainsDate:P,weekStartsOn:k,locale:E,_originalDate:M},D=_.match(dbe).map(function(B){var U=B[0];if(U==="p"||U==="P"){var z=wye[U];return z(B,E.formatLong)}return B}).join("").match(cbe).map(function(B){if(B==="''")return"'";var U=B[0];if(U==="'")return hbe(B);var z=xye[U];if(z)return!(r!=null&&r.useAdditionalWeekYearTokens)&&Sye(B)&&K$(B,t,String(e)),!(r!=null&&r.useAdditionalDayOfYearTokens)&&_ye(B)&&K$(B,t,String(e)),z(I,B,E.localize,T);if(U.match(mbe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+U+"`");return B}).join("");return D}function hbe(e){var t=e.match(ube);return t?t[1].replace(fbe,"'"):e}function pbe(e){Pn(1,arguments);var t=Zn(e),r=t.getFullYear(),n=t.getMonth(),a=new Date(0);return a.setFullYear(r,n+1,0),a.setHours(0,0,0,0),a.getDate()}function cu(e){Pn(1,arguments);var t=Zn(e),r=t.getHours();return r}var gbe=6048e5;function vbe(e){Pn(1,arguments);var t=Zn(e),r=Wp(t).getTime()-Y0e(t).getTime();return Math.round(r/gbe)+1}function du(e){Pn(1,arguments);var t=Zn(e),r=t.getMinutes();return r}function xbe(e){Pn(1,arguments);var t=Zn(e),r=t.getTime();return r}function ybe(e){return Pn(1,arguments),Math.floor(xbe(e)/1e3)}function bbe(e,t){var r,n,a,i,s,l,c,d;Pn(1,arguments);var u=Zn(e),f=u.getFullYear(),m=jh(),h=ii((r=(n=(a=(i=t?.firstWeekContainsDate)!==null&&i!==void 0?i:t==null||(s=t.locale)===null||s===void 0||(l=s.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&a!==void 0?a:m.firstWeekContainsDate)!==null&&n!==void 0?n:(c=m.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1);if(!(h>=1&&h<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var v=new Date(0);v.setFullYear(f+1,0,h),v.setHours(0,0,0,0);var g=fd(v,t),y=new Date(0);y.setFullYear(f,0,h),y.setHours(0,0,0,0);var x=fd(y,t);return u.getTime()>=g.getTime()?f+1:u.getTime()>=x.getTime()?f:f-1}function wbe(e,t){var r,n,a,i,s,l,c,d;Pn(1,arguments);var u=jh(),f=ii((r=(n=(a=(i=t?.firstWeekContainsDate)!==null&&i!==void 0?i:t==null||(s=t.locale)===null||s===void 0||(l=s.options)===null||l===void 0?void 0:l.firstWeekContainsDate)!==null&&a!==void 0?a:u.firstWeekContainsDate)!==null&&n!==void 0?n:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&r!==void 0?r:1),m=bbe(e,t),h=new Date(0);h.setFullYear(m,0,f),h.setHours(0,0,0,0);var v=fd(h,t);return v}var jbe=6048e5;function Nbe(e,t){Pn(1,arguments);var r=Zn(e),n=fd(r,t).getTime()-wbe(r,t).getTime();return Math.round(n/jbe)+1}function _be(e){Pn(1,arguments);var t=Zn(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function Sbe(e,t){return Pn(1,arguments),aye(_be(e),pl(e),t)+1}function rO(e,t){Pn(2,arguments);var r=Zn(e),n=Zn(t);return r.getTime()>n.getTime()}function XK(e,t){Pn(2,arguments);var r=Zn(e),n=Zn(t);return r.getTime()<n.getTime()}function Y$(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Cbe(e,t){if(e){if(typeof e=="string")return Y$(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Y$(e,t):void 0}}function nO(e,t){return nO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},nO(e,t)}function Pbe(e,t){if(Pa(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Pa(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Abe(e){var t=Pbe(e,"string");return Pa(t)=="symbol"?t:t+""}function Ebe(e,t,r){return(t=Abe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jT(e,t){Pn(2,arguments);var r=Zn(e),n=Zn(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function kbe(e,t){Pn(2,arguments);var r=Zn(e),n=Zn(t);return r.getFullYear()===n.getFullYear()}function My(e,t){Pn(2,arguments);var r=ii(t);return Ia(e,-r)}function X$(e,t){var r;Pn(1,arguments);var n=ii((r=t?.additionalDigits)!==null&&r!==void 0?r:2);if(n!==2&&n!==1&&n!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(!(typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"))return new Date(NaN);var a=Dbe(e),i;if(a.date){var s=Mbe(a.date,n);i=Rbe(s.restDateString,s.year)}if(!i||isNaN(i.getTime()))return new Date(NaN);var l=i.getTime(),c=0,d;if(a.time&&(c=Lbe(a.time),isNaN(c)))return new Date(NaN);if(a.timezone){if(d=$be(a.timezone),isNaN(d))return new Date(NaN)}else{var u=new Date(l+c),f=new Date(0);return f.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),f.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),f}return new Date(l+c+d)}var p2={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Obe=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Ibe=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Tbe=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Dbe(e){var t={},r=e.split(p2.dateTimeDelimiter),n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],p2.timeZoneDelimiter.test(t.date)&&(t.date=e.split(p2.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){var a=p2.timezone.exec(n);a?(t.time=n.replace(a[1],""),t.timezone=a[1]):t.time=n}return t}function Mbe(e,t){var r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};var a=n[1]?parseInt(n[1]):null,i=n[2]?parseInt(n[2]):null;return{year:i===null?a:i*100,restDateString:e.slice((n[1]||n[2]).length)}}function Rbe(e,t){if(t===null)return new Date(NaN);var r=e.match(Obe);if(!r)return new Date(NaN);var n=!!r[4],a=B0(r[1]),i=B0(r[2])-1,s=B0(r[3]),l=B0(r[4]),c=B0(r[5])-1;if(n)return Ube(t,l,c)?Fbe(t,l,c):new Date(NaN);var d=new Date(0);return!qbe(t,i,s)||!zbe(t,a)?new Date(NaN):(d.setUTCFullYear(t,i,Math.max(a,s)),d)}function B0(e){return e?parseInt(e):1}function Lbe(e){var t=e.match(Ibe);if(!t)return NaN;var r=WP(t[1]),n=WP(t[2]),a=WP(t[3]);return Vbe(r,n,a)?r*UK+n*zK+a*1e3:NaN}function WP(e){return e&&parseFloat(e.replace(",","."))||0}function $be(e){if(e==="Z")return 0;var t=e.match(Tbe);if(!t)return 0;var r=t[1]==="+"?-1:1,n=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return Wbe(n,a)?r*(n*UK+a*zK):NaN}function Fbe(e,t,r){var n=new Date(0);n.setUTCFullYear(e,0,4);var a=n.getUTCDay()||7,i=(t-1)*7+r+1-a;return n.setUTCDate(n.getUTCDate()+i),n}var Bbe=[31,null,31,30,31,30,31,31,30,31,30,31];function JK(e){return e%400===0||e%4===0&&e%100!==0}function qbe(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(Bbe[t]||(JK(e)?29:28))}function zbe(e,t){return t>=1&&t<=(JK(e)?366:365)}function Ube(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function Vbe(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function Wbe(e,t){return t>=0&&t<=59}function HP(e,t){Pn(2,arguments);var r=Zn(e),n=ii(t),a=r.getFullYear(),i=r.getDate(),s=new Date(0);s.setFullYear(a,n,15),s.setHours(0,0,0,0);var l=pbe(s);return r.setMonth(n,Math.min(i,l)),r}function g2(e,t){Pn(2,arguments);var r=Zn(e),n=ii(t);return r.setHours(n),r}function v2(e,t){Pn(2,arguments);var r=Zn(e),n=ii(t);return r.setMinutes(n),r}function J$(e,t){Pn(2,arguments);var r=Zn(e),n=ii(t);return isNaN(r.getTime())?new Date(NaN):(r.setFullYear(n),r)}const QK=p.createContext(),Hbe=({children:e})=>{const{userProfile:t}=Do(),r=ls(),[n,a]=p.useState([]),[i,s]=p.useState(!1),[l,c]=p.useState(!1),[d,u]=p.useState(!1),f=p.useRef(r.pathname),m=p.useCallback(()=>document.querySelectorAll('[role="dialog"]').length>0,[]),h=p.useCallback(async()=>{if(t?.codigo_empresa)try{u(!0);const v=t.codigo_empresa,g=new Date,y=ni(g).toISOString(),x=vj(g).toISOString(),b=[],{data:w}=await ve.from("produtos").select("nome, estoque, estoque_minimo, status").eq("codigo_empresa",v).not("estoque_minimo","is",null),j=(w||[]).filter(U=>{const z=Number(U.estoque||0),$=Number(U.estoque_minimo||0);return z<=$&&$>0});j.length>0&&b.push({tipo:"estoque",icone:"Package",cor:"danger",mensagem:`${j.length} produto${j.length>1?"s":""} com estoque baixo`,link:"/produtos"});const{data:_}=await ve.from("agendamento_participantes").select("id, agendamento_id").eq("codigo_empresa",v).eq("status_pagamento","Pendente");if(_&&_.length>0){const U=[...new Set(_.map(de=>de.agendamento_id))],{data:z}=await ve.from("agendamentos").select("id, inicio, status").in("id",U).not("status","in","(canceled,absent)").order("inicio",{ascending:!0}),$=new Set((z||[]).map(de=>de.id)),Y=_.filter(de=>$.has(de.agendamento_id));if(Y.length>0){const de=z?.[0],xe=Jt(de?new Date(de.inicio):g,"yyyy-MM-dd");b.push({tipo:"pagamento",icone:"DollarSign",cor:"warning",mensagem:`${Y.length} pagamento${Y.length>1?"s":""} pendente${Y.length>1?"s":""} em agendamentos`,link:`/agenda?date=${xe}`})}}const C=new Date;C.setHours(C.getHours()-3);const{data:E}=await ve.from("comandas").select("id, aberto_em, status").eq("codigo_empresa",v).eq("status","open").is("fechado_em",null).lte("aberto_em",C.toISOString());E&&E.length>0&&b.push({tipo:"comanda",icone:"Clock",cor:"warning",mensagem:`${E.length} comanda${E.length>1?"s":""} aberta${E.length>1?"s":""} h mais de 3 horas`,link:"/vendas"});const P=new Date;P.setHours(P.getHours()-12);const{data:k}=await ve.from("caixa_sessoes").select("id, aberto_em").eq("codigo_empresa",v).eq("status","open").lte("aberto_em",P.toISOString()).limit(1);k&&k.length>0&&b.push({tipo:"caixa",icone:"ShoppingCart",cor:"danger",mensagem:"Caixa aberto h mais de 12 horas",link:"/vendas"});const{data:M}=await ve.from("mesas").select("id, nome, numero").eq("codigo_empresa",v).eq("status","awaiting-payment");if(M&&M.length>0){const U=M.map($=>$.id),{data:z}=await ve.from("comandas").select("id, mesa_id").eq("codigo_empresa",v).in("mesa_id",U).eq("status","open");if(z&&z.length>0){const $=z.map(q=>q.id),{data:Y}=await ve.from("comanda_itens").select("comanda_id, quantidade, preco_unitario, desconto").in("comanda_id",$),de={};(Y||[]).forEach(q=>{const L=(Number(q.quantidade)||0)*(Number(q.preco_unitario)||0),W=Number(q.desconto)||0,ne=L-W;de[q.comanda_id]=(de[q.comanda_id]||0)+ne});const xe=Object.values(de).filter(q=>q>100).length;xe>0&&b.push({tipo:"mesa",icone:"Store",cor:"info",mensagem:`${xe} mesa${xe>1?"s":""} com saldo alto aguardando pagamento`,link:"/vendas"})}}const{data:S}=await ve.from("clientes").select("id, nome, aniversario").eq("codigo_empresa",v).eq("status","Ativo").not("aniversario","is",null),I=Jt(g,"MM-dd"),T=(S||[]).filter(U=>U.aniversario?Jt(new Date(U.aniversario),"MM-dd")===I:!1);T.length>0&&b.push({tipo:"aniversario",icone:"Users",cor:"success",mensagem:` ${T.length} aniversariante${T.length>1?"s":""} hoje!`,link:"/clientes"});const D=[];for(let U=1;U<=7;U++){const z=new Date(g);z.setDate(z.getDate()+U),D.push(Jt(z,"MM-dd"))}const B=(S||[]).filter(U=>{if(!U.aniversario)return!1;const z=Jt(new Date(U.aniversario),"MM-dd");return D.includes(z)});B.length>0&&b.push({tipo:"aniversario-semana",icone:"CalendarPlus",cor:"purple",mensagem:` ${B.length} aniversariante${B.length>1?"s":""} esta semana`,link:"/clientes"}),a(b)}catch(v){console.error("[AlertsContext] Erro ao carregar alertas:",v)}finally{u(!1)}},[t?.codigo_empresa]);return p.useEffect(()=>{if(t?.codigo_empresa){h();const v=setInterval(()=>{h()},5*60*1e3);return()=>clearInterval(v)}},[t?.codigo_empresa,h]),p.useEffect(()=>{if(!t?.codigo_empresa)return;const v=()=>{if(document.visibilityState==="visible"){if(m())return;h()}},g=()=>{m()||h()};return document.addEventListener("visibilitychange",v),window.addEventListener("focus",g),()=>{document.removeEventListener("visibilitychange",v),window.removeEventListener("focus",g)}},[t?.codigo_empresa,h,m]),p.useEffect(()=>{if(t?.codigo_empresa){if(f.current===r.pathname)return;if(f.current=r.pathname,m()){console.log("[AlertsContext] Mudana de rota detectada, mas h modais abertos - ignorando recarga");return}console.log("[AlertsContext] Mudana de rota detectada - recarregando alertas"),h()}},[r.pathname,t?.codigo_empresa,h,m]),o.jsx(QK.Provider,{value:{alerts:n,setAlerts:a,showModal:i,setShowModal:s,showBalloon:l,setShowBalloon:c,loading:d,loadAlerts:h},children:e})},WS=()=>{const e=p.useContext(QK);if(!e)throw new Error("useAlerts must be used within AlertsProvider");return e};function Gbe({onToggleSidebar:e,sidebarVisible:t,sidebarPinned:r}){const{toast:n}=oo(),{signOut:a,userProfile:i,company:s,user:l}=Do(),{alerts:c,showModal:d,setShowModal:u}=WS(),f=Pc(),m=i?.nome||"Usurio",h=ye.useMemo(()=>{const S=m.trim().split(/\s+/);return S.length>=2?`${S[0]} ${S[1]}`:m},[m]),v=i?.cargo||i?.papel||"";let g="";try{const S=localStorage.getItem("auth:company");if(S){const I=JSON.parse(S);g=I?.nome_fantasia||I?.razao_social||I?.nome||I?.codigoEmpresa||"";var y=I?.logo_url||""}}catch{}const x=s?.nome_fantasia||s?.razao_social||s?.nome||s?.codigoEmpresa||g||"Empresa no vinculada",b=s?.logo_url||(typeof y<"u"?y:""),w=ye.useMemo(()=>s?.logo_url?`${s.logo_url}?v=${Date.now()}`:b||"",[s?.logo_url]),j=S=>({Package:ud,DollarSign:Ui,CalendarCheck:TI,Clock:Vd,ShoppingCart:$1,Store:RI,Users:cl,CalendarPlus:DI,AlertTriangle:Af,Info:rH})[S]||Af,_=S=>({danger:"text-danger",warning:"text-warning",info:"text-info",success:"text-success",purple:"text-purple"})[S]||"text-warning",C=({alert:S,onClick:I})=>{const T=j(S.icone),D=_(S.cor);return o.jsxs("li",{className:"flex items-center gap-2 p-2 rounded-md hover:bg-white/5 transition-colors cursor-pointer group",onClick:I,children:[o.jsx(T,{className:`w-4 h-4 flex-shrink-0 ${D}`}),o.jsx("span",{className:"text-text-secondary group-hover:text-text-primary transition-colors flex-1",children:S.mensagem}),S.link&&o.jsx(II,{className:"w-3 h-3 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]})},E=async()=>{console.log("[Header] Logout button clicked",{at:new Date().toISOString(),userBefore:!!l});const{error:S}=await a();console.log("[Header] Logout completed",{error:S,userAfter:!!l}),n(S?{title:"Erro ao sair",description:"Ocorreu um erro ao fazer logout. Tente novamente.",variant:"destructive"}:{title:"Logout realizado",description:"Voc foi desconectado com sucesso.",variant:"default"})};new Date().toLocaleDateString("pt-BR",{day:"2-digit",month:"long",year:"numeric"});const P=ls(),k=ye.useMemo(()=>{try{const S=String(P?.pathname||"");if(S==="/"||S.startsWith("/dashboard"))return"";const T=[{key:"/agenda",label:"Agenda"},{key:"/isis",label:"sis"},{key:"/clientes",label:"Clientes & Fornecedores"},{key:"/produtos",label:"Produtos"},{key:"/vendas",label:"Vendas"},{key:"/financeiro",label:"Financeiro"},{key:"/balcao",label:"Balco"},{key:"/cadastros",label:"Cadastros"},{key:"/quadras",label:"Quadras"},{key:"/equipe",label:"Equipe"},{key:"/finalizadoras",label:"Finalizadoras"},{key:"/empresas",label:"Empresas"},{key:"/configuracoes",label:"Configuraes"},{key:"/login",label:"Login"}].find(D=>S.startsWith(D.key));if(T)return T.label;if(typeof document<"u"){const D=String(document.title||"");return(D.includes(" - ")?D.split(" - ")[0]:D)||""}}catch{}return""},[P?.pathname]),M=ye.useMemo(()=>String(P?.pathname||"").startsWith("/isis"),[P?.pathname]);return o.jsxs(fr.header,{animate:{opacity:1,y:0},transition:{duration:.6,ease:[.22,1,.36,1]},className:"relative bg-surface/80 backdrop-blur-sm text-text-primary h-[72px] flex-shrink-0 flex items-center justify-between px-8 border-b border-border shadow-[0_1px_0_RGBA(255,255,255,0.04)]",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx(oe,{variant:"ghost",size:"icon",onClick:e,"aria-label":t?"Ocultar barra lateral":"Mostrar barra lateral",className:"h-12 w-12 hover:bg-surface-2/60 transition-colors",children:o.jsx(Zde,{className:`w-7 h-7 transition-colors ${t?"text-brand":"text-text-primary"}`})}),o.jsxs("div",{className:"group pl-3 pr-5 py-1.5 border border-white/10 bg-gradient-to-b from-surface-2/60 to-surface/60 text-text-primary flex items-center gap-4 shadow-sm hover:border-white/20 transition-colors",title:x,children:[o.jsx("div",{className:"relative w-11 h-11 shrink-0 overflow-hidden border border-white/10 bg-surface-2/60 grid place-items-center shadow-[0_0_0_3px_RGBA(0,0,0,0.2)]",children:w?o.jsx("img",{src:w,alt:"Logo",className:"w-full h-full object-cover"}):o.jsx(Rde,{className:"w-6 h-6 opacity-80"})}),o.jsx("span",{className:"tracking-tight max-w-[240px] md:max-w-[320px] truncate leading-[44px] text-base text-text-primary font-semibold",children:x})]})]}),M?o.jsx("div",{className:"pointer-events-none absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 hidden md:block",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"rounded-full p-[2px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400 shadow-[0_0_12px_rgba(168,85,247,0.35)] w-8 h-8",children:o.jsx("div",{className:"rounded-full overflow-hidden bg-background w-full h-full",children:o.jsx(Wd,{size:"xs",className:"w-8 h-8"})})}),o.jsx("h1",{className:"text-lg md:text-xl font-bold tracking-tight text-text-primary",children:"sis"})]})}):k?o.jsx("div",{className:"pointer-events-none absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 hidden md:block",children:o.jsx("h1",{className:"text-lg md:text-xl font-bold tracking-tight text-text-primary",children:k})}):null,o.jsxs("div",{className:"flex items-center gap-1 md:gap-2",children:[!M&&o.jsxs(oe,{variant:"ghost",onClick:()=>f("/isis"),className:"hidden md:inline-flex items-center gap-2 px-2.5 py-1.5 rounded-full border border-white/10 bg-surface/60 hover:bg-surface-2/70 hover:border-white/20 transition-all duration-200 hover:-translate-y-px hover:shadow-[0_4px_16px_rgba(0,0,0,0.25)]",children:[o.jsx("span",{className:"inline-flex items-center justify-center rounded-full p-[2px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400",children:o.jsx("span",{className:"rounded-full overflow-hidden bg-background",children:o.jsx(Wd,{size:"xs"})})}),o.jsx("span",{className:"text-sm font-semibold text-text-primary",children:"sis"})]}),o.jsxs(oe,{variant:"ghost",size:"icon",onClick:()=>u(!0),className:"relative text-text-secondary hover:text-text-primary transition-colors duration-200",children:[o.jsx(oN,{className:"h-5 w-5"}),c.length>0&&o.jsx("span",{className:"absolute -top-1 -right-1 bg-danger text-white text-[10px] font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse",children:c.length})]}),o.jsx(oe,{variant:"ghost",size:"icon",onClick:E,className:"text-text-secondary hover:text-brand hover:bg-brand/10 transition-colors duration-200 shrink-0",children:o.jsx(Qde,{className:"h-5 w-5"})}),o.jsx("div",{className:"w-px h-8 bg-border mx-1 md:mx-2"}),o.jsxs("div",{className:"group pl-2 pr-3 md:pl-4 md:pr-4 py-1.5 rounded-full border border-white/10 bg-gradient-to-b from-surface-2/60 to-surface/60 text-text-primary flex items-center gap-2 md:gap-3 shadow-sm hover:border-white/20 transition-colors",title:`${h}  ${v}`,children:[o.jsx("span",{className:"text-xs md:text-sm font-semibold truncate max-w-[120px] md:max-w-[180px]",children:h}),o.jsx("span",{className:"text-[10px] md:text-[11px] px-1.5 md:px-2 py-0.5 rounded-full bg-brand/15 text-brand font-medium tracking-wide",children:v})]})]}),o.jsx(ln,{open:d,onOpenChange:u,children:o.jsxs(on,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[o.jsx(nn,{children:o.jsxs(rn,{className:"flex items-center gap-2",children:[o.jsx(oN,{className:"h-5 w-5 text-brand"}),"Todos os Alertas (",c.length,")"]})}),o.jsx("div",{className:"mt-4",children:c.length===0?o.jsx("p",{className:"text-sm text-text-muted text-center py-8",children:"Nenhum alerta no momento! "}):o.jsx("ul",{className:"space-y-2 text-sm",children:c.map((S,I)=>o.jsx(C,{alert:S,onClick:()=>{S.link&&(f(S.link),u(!1))}},I))})})]})})]})}const or=ye.forwardRef(({className:e,type:t,...r},n)=>o.jsx("input",{type:t,className:Yt("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...r}));or.displayName="Input";var Kbe="Label",ZK=p.forwardRef((e,t)=>o.jsx(Hn.label,{...e,ref:t,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(e.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));ZK.displayName=Kbe;var eY=ZK;const Ybe=iT("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Wt=ye.forwardRef(({className:e,...t},r)=>o.jsx(eY,{ref:r,className:Yt(Ybe(),e),...t}));Wt.displayName=eY.displayName;const Xbe=e=>{const t={"Invalid login credentials":"Email ou senha incorretos","Email not confirmed":"Email no confirmado","User not found":"Usurio no encontrado","Invalid email":"Email invlido","Password should be at least 6 characters":"A senha deve ter pelo menos 6 caracteres","Unable to validate email address: invalid format":"Formato de email invlido","Email rate limit exceeded":"Muitas tentativas. Aguarde alguns minutos","Network request failed":"Erro de conexo. Verifique sua internet","Failed to fetch":"Erro de conexo. Verifique sua internet"};if(t[e])return t[e];for(const[r,n]of Object.entries(t))if(e.includes(r))return n;return"Erro ao fazer login. Verifique suas credenciais e tente novamente."},Jbe=()=>{const[e,t]=p.useState(!1),[r,n]=p.useState(!1),[a,i]=p.useState(""),[s,l]=p.useState({email:"",password:""}),{signIn:c,user:d,authReady:u}=Do(),{toast:f}=oo();p.useEffect(()=>{if(u&&d)try{const g=sessionStorage.getItem("auth:returnUrl");sessionStorage.removeItem("auth:returnUrl");const y=g||"/";console.log("[LoginPage] Redirecionando para:",y),window.location.replace(y)}catch{}},[u,!!d]);const m=g=>{l({...s,[g.target.name]:g.target.value}),a&&i("")},h=async g=>{g.preventDefault(),n(!0),i("");try{const y=await c(s.email,s.password);if(y.error)throw y.error;f({title:"Login realizado!",description:"Bem-vindo de volta!",variant:"default"});try{const x=sessionStorage.getItem("auth:returnUrl");sessionStorage.removeItem("auth:returnUrl");const b=x||"/";console.log("[LoginPage] Redirecionando aps login para:",b),window.location.replace(b)}catch{}}catch(y){const x=y.message||"Ocorreu um erro. Tente novamente.",b=Xbe(x);i(b),f({title:"Erro",description:b,variant:"destructive"})}finally{n(!1)}},v={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.6,ease:[.22,1,.36,1]}}};return o.jsx(o.Fragment,{children:o.jsxs("div",{className:"min-h-screen bg-background flex items-center justify-center p-4 sm:p-6",children:[o.jsx("div",{className:"absolute inset-0 bg-court-pattern opacity-[0.02] mix-blend-overlay"}),o.jsxs(fr.div,{variants:v,initial:"hidden",animate:"visible",className:"relative z-10 w-full max-w-md pb-20 sm:pb-0",children:[o.jsxs("div",{className:"fx-card",children:[o.jsx("div",{className:"text-center mb-6",children:o.jsxs("div",{className:"flex items-center justify-center mb-4",children:[o.jsx("div",{className:"w-16 h-16 bg-brand rounded-xl flex items-center justify-center mr-4",children:o.jsx($d,{className:"w-8 h-8 text-primary-foreground"})}),o.jsxs("div",{children:[o.jsxs("h1",{className:"text-5xl font-extrabold",children:[o.jsx("span",{style:{color:"#FF6600"},children:"Fluxo"}),o.jsx("span",{style:{color:"#FFAA33"},children:"7"})]}),o.jsx("p",{className:"text-2xl font-semibold",style:{color:"#B0B0B0"},children:"Arena"})]})]})}),o.jsxs("form",{onSubmit:h,className:"space-y-5 sm:space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs(Wt,{htmlFor:"email",className:"text-text-primary flex items-center gap-2 text-sm sm:text-base",children:[o.jsx(ax,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Email"]}),o.jsx(or,{id:"email",name:"email",type:"email",placeholder:"seu@email.com",value:s.email,onChange:m,required:!0,className:"placeholder:text-[#B0B0B0] h-12 sm:h-10 text-base sm:text-sm"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs(Wt,{htmlFor:"password",className:"text-text-primary flex items-center gap-2 text-sm sm:text-base",children:[o.jsx(sh,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Senha"]}),o.jsxs("div",{className:"relative",children:[o.jsx(or,{id:"password",name:"password",type:e?"text":"password",placeholder:"Sua senha",value:s.password,onChange:m,required:!0,className:"pr-10 placeholder:text-[#B0B0B0] h-12 sm:h-10 text-base sm:text-sm"}),o.jsx("button",{type:"button",onClick:()=>t(!e),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-muted hover:text-text-primary transition-colors",children:e?o.jsx(Sp,{className:"w-5 h-5 sm:w-4 sm:h-4"}):o.jsx(zp,{className:"w-5 h-5 sm:w-4 sm:h-4"})})]})]}),a&&o.jsx(fr.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"p-3 rounded-lg bg-destructive/10 border border-destructive/30 text-destructive text-sm",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"text-base",children:""}),o.jsx("span",{className:"flex-1",children:a})]})}),o.jsx(oe,{type:"submit",className:"w-full h-12 sm:h-10 text-base sm:text-sm",disabled:r,children:r?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-4 h-4 border-2 border-primary-foreground border-t-transparent rounded-full animate-spin"}),"Entrando..."]}):o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Jde,{className:"w-4 h-4"}),"Entrar"]})})]})]}),o.jsx("p",{className:"mt-4 text-center text-xs text-text-muted opacity-70",children:" 2025 Fluxo7 Arena  Todos os direitos reservados."})]})]})})},Q$=({children:e})=>{const{user:t,authReady:r}=Do(),n=ls();return p.useEffect(()=>{if(r&&!t&&n.pathname!=="/login")try{sessionStorage.setItem("auth:returnUrl",n.pathname+n.search),console.log("[ProtectedRoute] Salvando rota de retorno:",n.pathname+n.search)}catch(a){console.warn("[ProtectedRoute] Erro ao salvar rota de retorno:",a)}},[r,t,n.pathname,n.search]),r?t?e:o.jsx(Jbe,{}):o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-8 h-8 border-4 border-brand border-t-transparent rounded-full animate-spin"}),o.jsx("span",{className:"text-text-primary font-medium",children:"Carregando..."})]})})},Qbe=p.createContext(),Zbe=({children:e})=>{const[t,r]=p.useState({payment:{open:!1,data:null},editParticipant:{open:!1,data:null}}),[n,a]=p.useState(new Set),i=p.useCallback((f,m=null)=>{console.log(" [MODALS] Abrindo modal:",f,m),r(h=>({...h,[f]:{open:!0,data:m}}))},[]),s=p.useCallback(f=>{if(n.has(f)){console.log(` [ModalsContext] Modal "${f}" est protegido, ignorando fechamento`);return}r(m=>({...m,[f]:{open:!1,data:{}}}))},[n]),l=p.useCallback(f=>t[f]?.open||!1,[t]),c=p.useCallback(f=>t[f]?.data||{},[t]),d=p.useCallback(f=>{console.log(` [ModalsContext] Protegendo modal "${f}"`),a(m=>new Set([...m,f]))},[]),u=p.useCallback(f=>{console.log(` [ModalsContext] Desprotegendo modal "${f}"`),a(m=>{const h=new Set(m);return h.delete(f),h})},[]);return o.jsx(Qbe.Provider,{value:{openModal:i,closeModal:s,isModalOpen:l,getModalData:c,protectModal:d,unprotectModal:u},children:e})},tY=p.createContext(),jN=()=>{const e=p.useContext(tY);if(!e)throw new Error("useAgenda must be used within AgendaProvider");return e},e1e=({children:e})=>{const[t,r]=p.useState(!1),[n,a]=p.useState(!1),[i,s]=p.useState(!1),[l,c]=p.useState({participantId:null,participantName:""}),[d,u]=p.useState(null),[f,m]=p.useState([]),[h,v]=p.useState(""),[g,y]=p.useState([]),[x,b]=p.useState(null),[w,j]=p.useState([]),_=p.useRef({isProtected:!1,protectedUntil:0}),C=p.useRef(Date.now()),E=p.useRef(null),P=ls(),k=p.useCallback((B=2e3)=>{const U=Date.now()+B;if(U>_.current.protectedUntil)_.current.isProtected=!0,_.current.protectedUntil=U;else return;setTimeout(()=>{Date.now()>=_.current.protectedUntil&&(_.current.isProtected=!1)},B)},[]),M=p.useCallback(()=>{r(!0)},[]),S=p.useCallback(()=>{const B=Date.now();if(_.current.isProtected&&B<_.current.protectedUntil){const z=_.current.protectedUntil-B;try{localStorage.getItem("debug:agenda")==="1"&&console.log(` [PaymentModal] Fechamento bloqueado por proteo (${z}ms restantes)`)}catch{}return!1}if(Date.now()-C.current<500){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Fechamento bloqueado por mudana de visibilidade recente")}catch{}return!1}try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Fechando modal (no protegido)")}catch{}return r(!1),!0},[]),I=p.useCallback((B,U)=>{c({participantId:B,participantName:U}),a(!0),k(3e3)},[k]),T=p.useCallback(()=>{a(!1),c({participantId:null,participantName:""})},[]);p.useEffect(()=>{if(!(P?.pathname||"").startsWith("/agenda"))return()=>{};const z=()=>{const Y=Date.now(),de=document.hidden;try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [AgendaContext] visibilitychange:",{hidden:de,timestamp:new Date().toISOString(),isPaymentModalOpen:t})}catch{}if(C.current=Y,!de&&t){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [AgendaContext] Aba restaurada com modal aberto - protegendo por 3s")}catch{}const xe=Date.now()+3e3;_.current.isProtected=!0,_.current.protectedUntil=xe}},$=()=>{const Y=Date.now();try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [AgendaContext] window focus:",{timestamp:new Date().toISOString(),isPaymentModalOpen:t})}catch{}if(C.current=Y,t){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [AgendaContext] Janela ganhou foco com modal aberto - protegendo por 3s")}catch{}const de=Date.now()+3e3;_.current.isProtected=!0,_.current.protectedUntil=de}};return document.addEventListener("visibilitychange",z),window.addEventListener("focus",$),()=>{document.removeEventListener("visibilitychange",z),window.removeEventListener("focus",$)}},[t,P?.pathname]);const D={isPaymentModalOpen:t,isEditParticipantModalOpen:n,isAddBookingModalOpen:i,openPaymentModal:M,closePaymentModal:S,openEditParticipantModal:I,closeEditParticipantModal:T,setIsAddBookingModalOpen:s,editParticipantData:l,editingBooking:d,setEditingBooking:u,participantsForm:f,setParticipantsForm:m,paymentTotal:h,setPaymentTotal:v,payMethods:g,setPayMethods:y,bookingForm:x,setBookingForm:b,localCustomers:w,setLocalCustomers:j,protectPaymentModal:k,onParticipantReplacedRef:E,get lastVisibilityChangeTime(){return C.current},get isModalProtected(){const B=Date.now();return _.current.isProtected&&B<_.current.protectedUntil}};return o.jsx(tY.Provider,{value:D,children:e})};var t1e=Array.isArray,Bl=t1e,r1e=typeof Us=="object"&&Us&&Us.Object===Object&&Us,rY=r1e,n1e=rY,a1e=typeof self=="object"&&self&&self.Object===Object&&self,o1e=n1e||a1e||Function("return this")(),zu=o1e,i1e=zu,s1e=i1e.Symbol,H1=s1e,Z$=H1,nY=Object.prototype,l1e=nY.hasOwnProperty,c1e=nY.toString,q0=Z$?Z$.toStringTag:void 0;function d1e(e){var t=l1e.call(e,q0),r=e[q0];try{e[q0]=void 0;var n=!0}catch{}var a=c1e.call(e);return n&&(t?e[q0]=r:delete e[q0]),a}var u1e=d1e,f1e=Object.prototype,m1e=f1e.toString;function h1e(e){return m1e.call(e)}var p1e=h1e,eF=H1,g1e=u1e,v1e=p1e,x1e="[object Null]",y1e="[object Undefined]",tF=eF?eF.toStringTag:void 0;function b1e(e){return e==null?e===void 0?y1e:x1e:tF&&tF in Object(e)?g1e(e):v1e(e)}var qf=b1e;function w1e(e){return e!=null&&typeof e=="object"}var zf=w1e,j1e=qf,N1e=zf,_1e="[object Symbol]";function S1e(e){return typeof e=="symbol"||N1e(e)&&j1e(e)==_1e}var Zx=S1e,C1e=Bl,P1e=Zx,A1e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,E1e=/^\w*$/;function k1e(e,t){if(C1e(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||P1e(e)?!0:E1e.test(e)||!A1e.test(e)||t!=null&&e in Object(t)}var NT=k1e;function O1e(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Nh=O1e;const e0=qa(Nh);var I1e=qf,T1e=Nh,D1e="[object AsyncFunction]",M1e="[object Function]",R1e="[object GeneratorFunction]",L1e="[object Proxy]";function $1e(e){if(!T1e(e))return!1;var t=I1e(e);return t==M1e||t==R1e||t==D1e||t==L1e}var _T=$1e;const Vn=qa(_T);var F1e=zu,B1e=F1e["__core-js_shared__"],q1e=B1e,GP=q1e,rF=function(){var e=/[^.]+$/.exec(GP&&GP.keys&&GP.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function z1e(e){return!!rF&&rF in e}var U1e=z1e,V1e=Function.prototype,W1e=V1e.toString;function H1e(e){if(e!=null){try{return W1e.call(e)}catch{}try{return e+""}catch{}}return""}var aY=H1e,G1e=_T,K1e=U1e,Y1e=Nh,X1e=aY,J1e=/[\\^$.*+?()[\]{}|]/g,Q1e=/^\[object .+?Constructor\]$/,Z1e=Function.prototype,ewe=Object.prototype,twe=Z1e.toString,rwe=ewe.hasOwnProperty,nwe=RegExp("^"+twe.call(rwe).replace(J1e,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function awe(e){if(!Y1e(e)||K1e(e))return!1;var t=G1e(e)?nwe:Q1e;return t.test(X1e(e))}var owe=awe;function iwe(e,t){return e?.[t]}var swe=iwe,lwe=owe,cwe=swe;function dwe(e,t){var r=cwe(e,t);return lwe(r)?r:void 0}var mg=dwe,uwe=mg,fwe=uwe(Object,"create"),HS=fwe,nF=HS;function mwe(){this.__data__=nF?nF(null):{},this.size=0}var hwe=mwe;function pwe(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var gwe=pwe,vwe=HS,xwe="__lodash_hash_undefined__",ywe=Object.prototype,bwe=ywe.hasOwnProperty;function wwe(e){var t=this.__data__;if(vwe){var r=t[e];return r===xwe?void 0:r}return bwe.call(t,e)?t[e]:void 0}var jwe=wwe,Nwe=HS,_we=Object.prototype,Swe=_we.hasOwnProperty;function Cwe(e){var t=this.__data__;return Nwe?t[e]!==void 0:Swe.call(t,e)}var Pwe=Cwe,Awe=HS,Ewe="__lodash_hash_undefined__";function kwe(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Awe&&t===void 0?Ewe:t,this}var Owe=kwe,Iwe=hwe,Twe=gwe,Dwe=jwe,Mwe=Pwe,Rwe=Owe;function t0(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}t0.prototype.clear=Iwe;t0.prototype.delete=Twe;t0.prototype.get=Dwe;t0.prototype.has=Mwe;t0.prototype.set=Rwe;var Lwe=t0;function $we(){this.__data__=[],this.size=0}var Fwe=$we;function Bwe(e,t){return e===t||e!==e&&t!==t}var ST=Bwe,qwe=ST;function zwe(e,t){for(var r=e.length;r--;)if(qwe(e[r][0],t))return r;return-1}var GS=zwe,Uwe=GS,Vwe=Array.prototype,Wwe=Vwe.splice;function Hwe(e){var t=this.__data__,r=Uwe(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():Wwe.call(t,r,1),--this.size,!0}var Gwe=Hwe,Kwe=GS;function Ywe(e){var t=this.__data__,r=Kwe(t,e);return r<0?void 0:t[r][1]}var Xwe=Ywe,Jwe=GS;function Qwe(e){return Jwe(this.__data__,e)>-1}var Zwe=Qwe,e2e=GS;function t2e(e,t){var r=this.__data__,n=e2e(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var r2e=t2e,n2e=Fwe,a2e=Gwe,o2e=Xwe,i2e=Zwe,s2e=r2e;function r0(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}r0.prototype.clear=n2e;r0.prototype.delete=a2e;r0.prototype.get=o2e;r0.prototype.has=i2e;r0.prototype.set=s2e;var KS=r0,l2e=mg,c2e=zu,d2e=l2e(c2e,"Map"),CT=d2e,aF=Lwe,u2e=KS,f2e=CT;function m2e(){this.size=0,this.__data__={hash:new aF,map:new(f2e||u2e),string:new aF}}var h2e=m2e;function p2e(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var g2e=p2e,v2e=g2e;function x2e(e,t){var r=e.__data__;return v2e(t)?r[typeof t=="string"?"string":"hash"]:r.map}var YS=x2e,y2e=YS;function b2e(e){var t=y2e(this,e).delete(e);return this.size-=t?1:0,t}var w2e=b2e,j2e=YS;function N2e(e){return j2e(this,e).get(e)}var _2e=N2e,S2e=YS;function C2e(e){return S2e(this,e).has(e)}var P2e=C2e,A2e=YS;function E2e(e,t){var r=A2e(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var k2e=E2e,O2e=h2e,I2e=w2e,T2e=_2e,D2e=P2e,M2e=k2e;function n0(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}n0.prototype.clear=O2e;n0.prototype.delete=I2e;n0.prototype.get=T2e;n0.prototype.has=D2e;n0.prototype.set=M2e;var PT=n0,oY=PT,R2e="Expected a function";function AT(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(R2e);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],i=r.cache;if(i.has(a))return i.get(a);var s=e.apply(this,n);return r.cache=i.set(a,s)||i,s};return r.cache=new(AT.Cache||oY),r}AT.Cache=oY;var iY=AT;const L2e=qa(iY);var $2e=iY,F2e=500;function B2e(e){var t=$2e(e,function(n){return r.size===F2e&&r.clear(),n}),r=t.cache;return t}var q2e=B2e,z2e=q2e,U2e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,V2e=/\\(\\)?/g,W2e=z2e(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(U2e,function(r,n,a,i){t.push(a?i.replace(V2e,"$1"):n||r)}),t}),H2e=W2e;function G2e(e,t){for(var r=-1,n=e==null?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var ET=G2e,oF=H1,K2e=ET,Y2e=Bl,X2e=Zx,J2e=1/0,iF=oF?oF.prototype:void 0,sF=iF?iF.toString:void 0;function sY(e){if(typeof e=="string")return e;if(Y2e(e))return K2e(e,sY)+"";if(X2e(e))return sF?sF.call(e):"";var t=e+"";return t=="0"&&1/e==-J2e?"-0":t}var Q2e=sY,Z2e=Q2e;function eje(e){return e==null?"":Z2e(e)}var lY=eje,tje=Bl,rje=NT,nje=H2e,aje=lY;function oje(e,t){return tje(e)?e:rje(e,t)?[e]:nje(aje(e))}var cY=oje,ije=Zx,sje=1/0;function lje(e){if(typeof e=="string"||ije(e))return e;var t=e+"";return t=="0"&&1/e==-sje?"-0":t}var XS=lje,cje=cY,dje=XS;function uje(e,t){t=cje(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[dje(t[r++])];return r&&r==n?e:void 0}var kT=uje,fje=kT;function mje(e,t,r){var n=e==null?void 0:fje(e,t);return n===void 0?r:n}var dY=mje;const pc=qa(dY);function hje(e){return e==null}var pje=hje;const Qn=qa(pje);var gje=qf,vje=Bl,xje=zf,yje="[object String]";function bje(e){return typeof e=="string"||!vje(e)&&xje(e)&&gje(e)==yje}var wje=bje;const Hp=qa(wje);var uY={exports:{}},io={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OT=Symbol.for("react.element"),IT=Symbol.for("react.portal"),JS=Symbol.for("react.fragment"),QS=Symbol.for("react.strict_mode"),ZS=Symbol.for("react.profiler"),eC=Symbol.for("react.provider"),tC=Symbol.for("react.context"),jje=Symbol.for("react.server_context"),rC=Symbol.for("react.forward_ref"),nC=Symbol.for("react.suspense"),aC=Symbol.for("react.suspense_list"),oC=Symbol.for("react.memo"),iC=Symbol.for("react.lazy"),Nje=Symbol.for("react.offscreen"),fY;fY=Symbol.for("react.module.reference");function gd(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case OT:switch(e=e.type,e){case JS:case ZS:case QS:case nC:case aC:return e;default:switch(e=e&&e.$$typeof,e){case jje:case tC:case rC:case iC:case oC:case eC:return e;default:return t}}case IT:return t}}}io.ContextConsumer=tC;io.ContextProvider=eC;io.Element=OT;io.ForwardRef=rC;io.Fragment=JS;io.Lazy=iC;io.Memo=oC;io.Portal=IT;io.Profiler=ZS;io.StrictMode=QS;io.Suspense=nC;io.SuspenseList=aC;io.isAsyncMode=function(){return!1};io.isConcurrentMode=function(){return!1};io.isContextConsumer=function(e){return gd(e)===tC};io.isContextProvider=function(e){return gd(e)===eC};io.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===OT};io.isForwardRef=function(e){return gd(e)===rC};io.isFragment=function(e){return gd(e)===JS};io.isLazy=function(e){return gd(e)===iC};io.isMemo=function(e){return gd(e)===oC};io.isPortal=function(e){return gd(e)===IT};io.isProfiler=function(e){return gd(e)===ZS};io.isStrictMode=function(e){return gd(e)===QS};io.isSuspense=function(e){return gd(e)===nC};io.isSuspenseList=function(e){return gd(e)===aC};io.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===JS||e===ZS||e===QS||e===nC||e===aC||e===Nje||typeof e=="object"&&e!==null&&(e.$$typeof===iC||e.$$typeof===oC||e.$$typeof===eC||e.$$typeof===tC||e.$$typeof===rC||e.$$typeof===fY||e.getModuleId!==void 0)};io.typeOf=gd;uY.exports=io;var _je=uY.exports,Sje=qf,Cje=zf,Pje="[object Number]";function Aje(e){return typeof e=="number"||Cje(e)&&Sje(e)==Pje}var mY=Aje;const Eje=qa(mY);var kje=mY;function Oje(e){return kje(e)&&e!=+e}var Ije=Oje;const a0=qa(Ije);var dl=function(t){return t===0?0:t>0?1:-1},fp=function(t){return Hp(t)&&t.indexOf("%")===t.length-1},Mr=function(t){return Eje(t)&&!a0(t)},Tje=function(t){return Qn(t)},Gi=function(t){return Mr(t)||Hp(t)},Dje=0,hg=function(t){var r=++Dje;return"".concat(t||"").concat(r)},ul=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Mr(t)&&!Hp(t))return n;var i;if(fp(t)){var s=t.indexOf("%");i=r*parseFloat(t.slice(0,s))/100}else i=+t;return a0(i)&&(i=n),a&&i>r&&(i=r),i},bm=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},Mje=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},a=0;a<r;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1},Vi=function(t,r){return Mr(t)&&Mr(r)?function(n){return t+n*(r-t)}:function(){return r}};function NN(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):pc(n,t))===r})}var Rje=function(t,r){return Mr(t)&&Mr(r)?t-r:Hp(t)&&Hp(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function Lv(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function aO(e){"@babel/helpers - typeof";return aO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aO(e)}var Lje=["viewBox","children"],$je=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],lF=["points","pathLength"],KP={svg:Lje,polygon:lF,polyline:lF},TT=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],_N=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(p.isValidElement(t)&&(n=t.props),!e0(n))return null;var a={};return Object.keys(n).forEach(function(i){TT.includes(i)&&(a[i]=r||function(s){return n[i](n,s)})}),a},Fje=function(t,r,n){return function(a){return t(r,n,a),null}},Gp=function(t,r,n){if(!e0(t)||aO(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(i){var s=t[i];TT.includes(i)&&typeof s=="function"&&(a||(a={}),a[i]=Fje(s,r,n))}),a},Bje=["children"],qje=["children"];function cF(e,t){if(e==null)return{};var r=zje(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function zje(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function oO(e){"@babel/helpers - typeof";return oO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oO(e)}var dF={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},jf=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},uF=null,YP=null,DT=function e(t){if(t===uF&&Array.isArray(YP))return YP;var r=[];return p.Children.forEach(t,function(n){Qn(n)||(_je.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),YP=r,uF=t,r};function gc(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(a){return jf(a)}):n=[jf(t)],DT(e).forEach(function(a){var i=pc(a,"type.displayName")||pc(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}function ac(e,t){var r=gc(e,t);return r&&r[0]}var fF=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,a=r.height;return!(!Mr(n)||n<=0||!Mr(a)||a<=0)},Uje=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Vje=function(t){return t&&t.type&&Hp(t.type)&&Uje.indexOf(t.type)>=0},hY=function(t){return t&&oO(t)==="object"&&"clipDot"in t},Wje=function(t,r,n,a){var i,s=(i=KP?.[a])!==null&&i!==void 0?i:[];return r.startsWith("data-")||!Vn(t)&&(a&&s.includes(r)||$je.includes(r))||n&&TT.includes(r)},On=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(p.isValidElement(t)&&(a=t.props),!e0(a))return null;var i={};return Object.keys(a).forEach(function(s){var l;Wje((l=a)===null||l===void 0?void 0:l[s],s,r,n)&&(i[s]=a[s])}),i},iO=function e(t,r){if(t===r)return!0;var n=p.Children.count(t);if(n!==p.Children.count(r))return!1;if(n===0)return!0;if(n===1)return mF(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var i=t[a],s=r[a];if(Array.isArray(i)||Array.isArray(s)){if(!e(i,s))return!1}else if(!mF(i,s))return!1}return!0},mF=function(t,r){if(Qn(t)&&Qn(r))return!0;if(!Qn(t)&&!Qn(r)){var n=t.props||{},a=n.children,i=cF(n,Bje),s=r.props||{},l=s.children,c=cF(s,qje);return a&&l?Lv(i,c)&&iO(a,l):!a&&!l?Lv(i,c):!1}return!1},hF=function(t,r){var n=[],a={};return DT(t).forEach(function(i,s){if(Vje(i))n.push(i);else if(i){var l=jf(i.type),c=r[l]||{},d=c.handler,u=c.once;if(d&&(!u||!a[l])){var f=d(i,l,s);n.push(f),a[l]=!0}}}),n},Hje=function(t){var r=t&&t.type;return r&&dF[r]?dF[r]:null},Gje=function(t,r){return DT(r).indexOf(t)},Kje=["children","width","height","viewBox","className","style","title","desc"];function sO(){return sO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sO.apply(this,arguments)}function Yje(e,t){if(e==null)return{};var r=Xje(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Xje(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function lO(e){var t=e.children,r=e.width,n=e.height,a=e.viewBox,i=e.className,s=e.style,l=e.title,c=e.desc,d=Yje(e,Kje),u=a||{width:r,height:n,x:0,y:0},f=ta("recharts-surface",i);return ye.createElement("svg",sO({},On(d,!0,"svg"),{className:f,width:r,height:n,style:s,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),ye.createElement("title",null,l),ye.createElement("desc",null,c),t)}var Jje=["children","className"];function cO(){return cO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cO.apply(this,arguments)}function Qje(e,t){if(e==null)return{};var r=Zje(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Zje(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var Na=ye.forwardRef(function(e,t){var r=e.children,n=e.className,a=Qje(e,Jje),i=ta("recharts-layer",n);return ye.createElement("g",cO({className:i},On(a,!0),{ref:t}),r)}),Gd=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function eNe(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(a);++n<a;)i[n]=e[n+t];return i}var tNe=eNe,rNe=tNe;function nNe(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:rNe(e,t,r)}var aNe=nNe,oNe="\\ud800-\\udfff",iNe="\\u0300-\\u036f",sNe="\\ufe20-\\ufe2f",lNe="\\u20d0-\\u20ff",cNe=iNe+sNe+lNe,dNe="\\ufe0e\\ufe0f",uNe="\\u200d",fNe=RegExp("["+uNe+oNe+cNe+dNe+"]");function mNe(e){return fNe.test(e)}var pY=mNe;function hNe(e){return e.split("")}var pNe=hNe,gY="\\ud800-\\udfff",gNe="\\u0300-\\u036f",vNe="\\ufe20-\\ufe2f",xNe="\\u20d0-\\u20ff",yNe=gNe+vNe+xNe,bNe="\\ufe0e\\ufe0f",wNe="["+gY+"]",dO="["+yNe+"]",uO="\\ud83c[\\udffb-\\udfff]",jNe="(?:"+dO+"|"+uO+")",vY="[^"+gY+"]",xY="(?:\\ud83c[\\udde6-\\uddff]){2}",yY="[\\ud800-\\udbff][\\udc00-\\udfff]",NNe="\\u200d",bY=jNe+"?",wY="["+bNe+"]?",_Ne="(?:"+NNe+"(?:"+[vY,xY,yY].join("|")+")"+wY+bY+")*",SNe=wY+bY+_Ne,CNe="(?:"+[vY+dO+"?",dO,xY,yY,wNe].join("|")+")",PNe=RegExp(uO+"(?="+uO+")|"+CNe+SNe,"g");function ANe(e){return e.match(PNe)||[]}var ENe=ANe,kNe=pNe,ONe=pY,INe=ENe;function TNe(e){return ONe(e)?INe(e):kNe(e)}var DNe=TNe,MNe=aNe,RNe=pY,LNe=DNe,$Ne=lY;function FNe(e){return function(t){t=$Ne(t);var r=RNe(t)?LNe(t):void 0,n=r?r[0]:t.charAt(0),a=r?MNe(r,1).join(""):t.slice(1);return n[e]()+a}}var BNe=FNe,qNe=BNe,zNe=qNe("toUpperCase"),UNe=zNe;const sC=qa(UNe);function wo(e){return function(){return e}}const jY=Math.cos,SN=Math.sin,ru=Math.sqrt,CN=Math.PI,lC=2*CN,fO=Math.PI,mO=2*fO,Jh=1e-6,VNe=mO-Jh;function NY(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function WNe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return NY;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class HNe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?NY:WNe(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,s){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,l=this._y1,c=n-t,d=a-r,u=s-t,f=l-r,m=u*u+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(m>Jh)if(!(Math.abs(f*c-d*u)>Jh)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let h=n-s,v=a-l,g=c*c+d*d,y=h*h+v*v,x=Math.sqrt(g),b=Math.sqrt(m),w=i*Math.tan((fO-Math.acos((g+m-y)/(2*x*b)))/2),j=w/b,_=w/x;Math.abs(j-1)>Jh&&this._append`L${t+j*u},${r+j*f}`,this._append`A${i},${i},0,0,${+(f*h>u*v)},${this._x1=t+_*c},${this._y1=r+_*d}`}}arc(t,r,n,a,i,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),c=n*Math.sin(a),d=t+l,u=r+c,f=1^s,m=s?a-i:i-a;this._x1===null?this._append`M${d},${u}`:(Math.abs(this._x1-d)>Jh||Math.abs(this._y1-u)>Jh)&&this._append`L${d},${u}`,n&&(m<0&&(m=m%mO+mO),m>VNe?this._append`A${n},${n},0,1,${f},${t-l},${r-c}A${n},${n},0,1,${f},${this._x1=d},${this._y1=u}`:m>Jh&&this._append`A${n},${n},0,${+(m>=fO)},${f},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function MT(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new HNe(t)}function RT(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function _Y(e){this._context=e}_Y.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function cC(e){return new _Y(e)}function SY(e){return e[0]}function CY(e){return e[1]}function PY(e,t){var r=wo(!0),n=null,a=cC,i=null,s=MT(l);e=typeof e=="function"?e:e===void 0?SY:wo(e),t=typeof t=="function"?t:t===void 0?CY:wo(t);function l(c){var d,u=(c=RT(c)).length,f,m=!1,h;for(n==null&&(i=a(h=s())),d=0;d<=u;++d)!(d<u&&r(f=c[d],d,c))===m&&((m=!m)?i.lineStart():i.lineEnd()),m&&i.point(+e(f,d,c),+t(f,d,c));if(h)return i=null,h+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:wo(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:wo(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:wo(!!c),l):r},l.curve=function(c){return arguments.length?(a=c,n!=null&&(i=a(n)),l):a},l.context=function(c){return arguments.length?(c==null?n=i=null:i=a(n=c),l):n},l}function x2(e,t,r){var n=null,a=wo(!0),i=null,s=cC,l=null,c=MT(d);e=typeof e=="function"?e:e===void 0?SY:wo(+e),t=typeof t=="function"?t:wo(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?CY:wo(+r);function d(f){var m,h,v,g=(f=RT(f)).length,y,x=!1,b,w=new Array(g),j=new Array(g);for(i==null&&(l=s(b=c())),m=0;m<=g;++m){if(!(m<g&&a(y=f[m],m,f))===x)if(x=!x)h=m,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),v=m-1;v>=h;--v)l.point(w[v],j[v]);l.lineEnd(),l.areaEnd()}x&&(w[m]=+e(y,m,f),j[m]=+t(y,m,f),l.point(n?+n(y,m,f):w[m],r?+r(y,m,f):j[m]))}if(b)return l=null,b+""||null}function u(){return PY().defined(a).curve(s).context(i)}return d.x=function(f){return arguments.length?(e=typeof f=="function"?f:wo(+f),n=null,d):e},d.x0=function(f){return arguments.length?(e=typeof f=="function"?f:wo(+f),d):e},d.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:wo(+f),d):n},d.y=function(f){return arguments.length?(t=typeof f=="function"?f:wo(+f),r=null,d):t},d.y0=function(f){return arguments.length?(t=typeof f=="function"?f:wo(+f),d):t},d.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:wo(+f),d):r},d.lineX0=d.lineY0=function(){return u().x(e).y(t)},d.lineY1=function(){return u().x(e).y(r)},d.lineX1=function(){return u().x(n).y(t)},d.defined=function(f){return arguments.length?(a=typeof f=="function"?f:wo(!!f),d):a},d.curve=function(f){return arguments.length?(s=f,i!=null&&(l=s(i)),d):s},d.context=function(f){return arguments.length?(f==null?i=l=null:l=s(i=f),d):i},d}class AY{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function GNe(e){return new AY(e,!0)}function KNe(e){return new AY(e,!1)}const LT={draw(e,t){const r=ru(t/CN);e.moveTo(r,0),e.arc(0,0,r,0,lC)}},YNe={draw(e,t){const r=ru(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},EY=ru(1/3),XNe=EY*2,JNe={draw(e,t){const r=ru(t/XNe),n=r*EY;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},QNe={draw(e,t){const r=ru(t),n=-r/2;e.rect(n,n,r,r)}},ZNe=.8908130915292852,kY=SN(CN/10)/SN(7*CN/10),e_e=SN(lC/10)*kY,t_e=-jY(lC/10)*kY,r_e={draw(e,t){const r=ru(t*ZNe),n=e_e*r,a=t_e*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const s=lC*i/5,l=jY(s),c=SN(s);e.lineTo(c*r,-l*r),e.lineTo(l*n-c*a,c*n+l*a)}e.closePath()}},XP=ru(3),n_e={draw(e,t){const r=-ru(t/(XP*3));e.moveTo(0,r*2),e.lineTo(-XP*r,-r),e.lineTo(XP*r,-r),e.closePath()}},Fc=-.5,Bc=ru(3)/2,hO=1/ru(12),a_e=(hO/2+1)*3,o_e={draw(e,t){const r=ru(t/a_e),n=r/2,a=r*hO,i=n,s=r*hO+r,l=-i,c=s;e.moveTo(n,a),e.lineTo(i,s),e.lineTo(l,c),e.lineTo(Fc*n-Bc*a,Bc*n+Fc*a),e.lineTo(Fc*i-Bc*s,Bc*i+Fc*s),e.lineTo(Fc*l-Bc*c,Bc*l+Fc*c),e.lineTo(Fc*n+Bc*a,Fc*a-Bc*n),e.lineTo(Fc*i+Bc*s,Fc*s-Bc*i),e.lineTo(Fc*l+Bc*c,Fc*c-Bc*l),e.closePath()}};function i_e(e,t){let r=null,n=MT(a);e=typeof e=="function"?e:wo(e||LT),t=typeof t=="function"?t:wo(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:wo(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:wo(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function PN(){}function AN(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function OY(e){this._context=e}OY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:AN(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:AN(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function s_e(e){return new OY(e)}function IY(e){this._context=e}IY.prototype={areaStart:PN,areaEnd:PN,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:AN(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function l_e(e){return new IY(e)}function TY(e){this._context=e}TY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:AN(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function c_e(e){return new TY(e)}function DY(e){this._context=e}DY.prototype={areaStart:PN,areaEnd:PN,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function d_e(e){return new DY(e)}function pF(e){return e<0?-1:1}function gF(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),s=(r-e._y1)/(a||n<0&&-0),l=(i*a+s*n)/(n+a);return(pF(i)+pF(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(l))||0}function vF(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function JP(e,t,r){var n=e._x0,a=e._y0,i=e._x1,s=e._y1,l=(i-n)/3;e._context.bezierCurveTo(n+l,a+l*t,i-l,s-l*r,i,s)}function EN(e){this._context=e}EN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:JP(this,this._t0,vF(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,JP(this,vF(this,r=gF(this,e,t)),r);break;default:JP(this,this._t0,r=gF(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function MY(e){this._context=new RY(e)}(MY.prototype=Object.create(EN.prototype)).point=function(e,t){EN.prototype.point.call(this,t,e)};function RY(e){this._context=e}RY.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function u_e(e){return new EN(e)}function f_e(e){return new MY(e)}function LY(e){this._context=e}LY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=xF(e),a=xF(t),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function xF(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,s[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,s[t]-=n*s[t-1];for(a[r-1]=s[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(s[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function m_e(e){return new LY(e)}function dC(e,t){this._context=e,this._t=t}dC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function h_e(e){return new dC(e,.5)}function p_e(e){return new dC(e,0)}function g_e(e){return new dC(e,1)}function lx(e,t){if((s=e.length)>1)for(var r=1,n,a,i=e[t[0]],s,l=i.length;r<s;++r)for(a=i,i=e[t[r]],n=0;n<l;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function pO(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function v_e(e,t){return e[t]}function x_e(e){const t=[];return t.key=e,t}function y_e(){var e=wo([]),t=pO,r=lx,n=v_e;function a(i){var s=Array.from(e.apply(this,arguments),x_e),l,c=s.length,d=-1,u;for(const f of i)for(l=0,++d;l<c;++l)(s[l][d]=[0,+n(f,s[l].key,d,i)]).data=f;for(l=0,u=RT(t(s));l<c;++l)s[u[l]].index=l;return r(s,u),s}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:wo(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:wo(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?pO:typeof i=="function"?i:wo(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??lx,a):r},a}function b_e(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=e[r][a][1]||0;if(s)for(r=0;r<n;++r)e[r][a][1]/=s}lx(e,t)}}function w_e(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var s=0,l=0;s<a;++s)l+=e[s][r][1]||0;n[r][1]+=n[r][0]=-l/2}lx(e,t)}}function j_e(e,t){if(!(!((s=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var l=0,c=0,d=0;l<s;++l){for(var u=e[t[l]],f=u[n][1]||0,m=u[n-1][1]||0,h=(f-m)/2,v=0;v<l;++v){var g=e[t[v]],y=g[n][1]||0,x=g[n-1][1]||0;h+=y-x}c+=f,d+=h*f}a[n-1][1]+=a[n-1][0]=r,c&&(r-=d/c)}a[n-1][1]+=a[n-1][0]=r,lx(e,t)}}function kb(e){"@babel/helpers - typeof";return kb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kb(e)}var N_e=["type","size","sizeType"];function gO(){return gO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gO.apply(this,arguments)}function yF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yF(Object(r),!0).forEach(function(n){__e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function __e(e,t,r){return t=S_e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S_e(e){var t=C_e(e,"string");return kb(t)=="symbol"?t:t+""}function C_e(e,t){if(kb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function P_e(e,t){if(e==null)return{};var r=A_e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function A_e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var $Y={symbolCircle:LT,symbolCross:YNe,symbolDiamond:JNe,symbolSquare:QNe,symbolStar:r_e,symbolTriangle:n_e,symbolWye:o_e},E_e=Math.PI/180,k_e=function(t){var r="symbol".concat(sC(t));return $Y[r]||LT},O_e=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*E_e;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},I_e=function(t,r){$Y["symbol".concat(sC(t))]=r},$T=function(t){var r=t.type,n=r===void 0?"circle":r,a=t.size,i=a===void 0?64:a,s=t.sizeType,l=s===void 0?"area":s,c=P_e(t,N_e),d=bF(bF({},c),{},{type:n,size:i,sizeType:l}),u=function(){var y=k_e(n),x=i_e().type(y).size(O_e(i,l,n));return x()},f=d.className,m=d.cx,h=d.cy,v=On(d,!0);return m===+m&&h===+h&&i===+i?ye.createElement("path",gO({},v,{className:ta("recharts-symbols",f),transform:"translate(".concat(m,", ").concat(h,")"),d:u()})):null};$T.registerSymbol=I_e;function cx(e){"@babel/helpers - typeof";return cx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cx(e)}function vO(){return vO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vO.apply(this,arguments)}function wF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function T_e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wF(Object(r),!0).forEach(function(n){Ob(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function D_e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BY(n.key),n)}}function M_e(e,t,r){return t&&jF(e.prototype,t),r&&jF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function R_e(e,t,r){return t=kN(t),L_e(e,FY()?Reflect.construct(t,r||[],kN(e).constructor):t.apply(e,r))}function L_e(e,t){if(t&&(cx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $_e(e)}function $_e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(FY=function(){return!!e})()}function kN(e){return kN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kN(e)}function F_e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xO(e,t)}function xO(e,t){return xO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},xO(e,t)}function Ob(e,t,r){return t=BY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BY(e){var t=B_e(e,"string");return cx(t)=="symbol"?t:t+""}function B_e(e,t){if(cx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(cx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qc=32,FT=function(e){function t(){return D_e(this,t),R_e(this,t,arguments)}return F_e(t,e),M_e(t,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,i=qc/2,s=qc/6,l=qc/3,c=n.inactive?a:n.color;if(n.type==="plainline")return ye.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:i,x2:qc,y2:i,className:"recharts-legend-icon"});if(n.type==="line")return ye.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(i,"h").concat(l,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*l,",").concat(i,`
            H`).concat(qc,"M").concat(2*l,",").concat(i,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(l,",").concat(i),className:"recharts-legend-icon"});if(n.type==="rect")return ye.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(qc/8,"h").concat(qc,"v").concat(qc*3/4,"h").concat(-qc,"z"),className:"recharts-legend-icon"});if(ye.isValidElement(n.legendIcon)){var d=T_e({},n);return delete d.legendIcon,ye.cloneElement(n.legendIcon,d)}return ye.createElement($T,{fill:c,cx:i,cy:i,size:qc,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,i=a.payload,s=a.iconSize,l=a.layout,c=a.formatter,d=a.inactiveColor,u={x:0,y:0,width:qc,height:qc},f={display:l==="horizontal"?"inline-block":"block",marginRight:10},m={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(h,v){var g=h.formatter||c,y=ta(Ob(Ob({"recharts-legend-item":!0},"legend-item-".concat(v),!0),"inactive",h.inactive));if(h.type==="none")return null;var x=Vn(h.value)?null:h.value;Gd(!Vn(h.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var b=h.inactive?d:h.color;return ye.createElement("li",vO({className:y,style:f,key:"legend-item-".concat(v)},Gp(n.props,h,v)),ye.createElement(lO,{width:s,height:s,viewBox:u,style:m},n.renderIcon(h)),ye.createElement("span",{className:"recharts-legend-item-text",style:{color:b}},g?g(x,h,v):x))})}},{key:"render",value:function(){var n=this.props,a=n.payload,i=n.layout,s=n.align;if(!a||!a.length)return null;var l={padding:0,margin:0,textAlign:i==="horizontal"?s:"left"};return ye.createElement("ul",{className:"recharts-default-legend",style:l},this.renderItems())}}])}(p.PureComponent);Ob(FT,"displayName","Legend");Ob(FT,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var q_e=KS;function z_e(){this.__data__=new q_e,this.size=0}var U_e=z_e;function V_e(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var W_e=V_e;function H_e(e){return this.__data__.get(e)}var G_e=H_e;function K_e(e){return this.__data__.has(e)}var Y_e=K_e,X_e=KS,J_e=CT,Q_e=PT,Z_e=200;function eSe(e,t){var r=this.__data__;if(r instanceof X_e){var n=r.__data__;if(!J_e||n.length<Z_e-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Q_e(n)}return r.set(e,t),this.size=r.size,this}var tSe=eSe,rSe=KS,nSe=U_e,aSe=W_e,oSe=G_e,iSe=Y_e,sSe=tSe;function o0(e){var t=this.__data__=new rSe(e);this.size=t.size}o0.prototype.clear=nSe;o0.prototype.delete=aSe;o0.prototype.get=oSe;o0.prototype.has=iSe;o0.prototype.set=sSe;var qY=o0,lSe="__lodash_hash_undefined__";function cSe(e){return this.__data__.set(e,lSe),this}var dSe=cSe;function uSe(e){return this.__data__.has(e)}var fSe=uSe,mSe=PT,hSe=dSe,pSe=fSe;function ON(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new mSe;++t<r;)this.add(e[t])}ON.prototype.add=ON.prototype.push=hSe;ON.prototype.has=pSe;var zY=ON;function gSe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var UY=gSe;function vSe(e,t){return e.has(t)}var VY=vSe,xSe=zY,ySe=UY,bSe=VY,wSe=1,jSe=2;function NSe(e,t,r,n,a,i){var s=r&wSe,l=e.length,c=t.length;if(l!=c&&!(s&&c>l))return!1;var d=i.get(e),u=i.get(t);if(d&&u)return d==t&&u==e;var f=-1,m=!0,h=r&jSe?new xSe:void 0;for(i.set(e,t),i.set(t,e);++f<l;){var v=e[f],g=t[f];if(n)var y=s?n(g,v,f,t,e,i):n(v,g,f,e,t,i);if(y!==void 0){if(y)continue;m=!1;break}if(h){if(!ySe(t,function(x,b){if(!bSe(h,b)&&(v===x||a(v,x,r,n,i)))return h.push(b)})){m=!1;break}}else if(!(v===g||a(v,g,r,n,i))){m=!1;break}}return i.delete(e),i.delete(t),m}var WY=NSe,_Se=zu,SSe=_Se.Uint8Array,CSe=SSe;function PSe(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r}var ASe=PSe;function ESe(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var BT=ESe,NF=H1,_F=CSe,kSe=ST,OSe=WY,ISe=ASe,TSe=BT,DSe=1,MSe=2,RSe="[object Boolean]",LSe="[object Date]",$Se="[object Error]",FSe="[object Map]",BSe="[object Number]",qSe="[object RegExp]",zSe="[object Set]",USe="[object String]",VSe="[object Symbol]",WSe="[object ArrayBuffer]",HSe="[object DataView]",SF=NF?NF.prototype:void 0,QP=SF?SF.valueOf:void 0;function GSe(e,t,r,n,a,i,s){switch(r){case HSe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case WSe:return!(e.byteLength!=t.byteLength||!i(new _F(e),new _F(t)));case RSe:case LSe:case BSe:return kSe(+e,+t);case $Se:return e.name==t.name&&e.message==t.message;case qSe:case USe:return e==t+"";case FSe:var l=ISe;case zSe:var c=n&DSe;if(l||(l=TSe),e.size!=t.size&&!c)return!1;var d=s.get(e);if(d)return d==t;n|=MSe,s.set(e,t);var u=OSe(l(e),l(t),n,a,i,s);return s.delete(e),u;case VSe:if(QP)return QP.call(e)==QP.call(t)}return!1}var KSe=GSe;function YSe(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var HY=YSe,XSe=HY,JSe=Bl;function QSe(e,t,r){var n=t(e);return JSe(e)?n:XSe(n,r(e))}var ZSe=QSe;function eCe(e,t){for(var r=-1,n=e==null?0:e.length,a=0,i=[];++r<n;){var s=e[r];t(s,r,e)&&(i[a++]=s)}return i}var tCe=eCe;function rCe(){return[]}var nCe=rCe,aCe=tCe,oCe=nCe,iCe=Object.prototype,sCe=iCe.propertyIsEnumerable,CF=Object.getOwnPropertySymbols,lCe=CF?function(e){return e==null?[]:(e=Object(e),aCe(CF(e),function(t){return sCe.call(e,t)}))}:oCe,cCe=lCe;function dCe(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var uCe=dCe,fCe=qf,mCe=zf,hCe="[object Arguments]";function pCe(e){return mCe(e)&&fCe(e)==hCe}var gCe=pCe,PF=gCe,vCe=zf,GY=Object.prototype,xCe=GY.hasOwnProperty,yCe=GY.propertyIsEnumerable,bCe=PF(function(){return arguments}())?PF:function(e){return vCe(e)&&xCe.call(e,"callee")&&!yCe.call(e,"callee")},qT=bCe,IN={exports:{}};function wCe(){return!1}var jCe=wCe;IN.exports;(function(e,t){var r=zu,n=jCe,a=t&&!t.nodeType&&t,i=a&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===a,l=s?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||n;e.exports=d})(IN,IN.exports);var KY=IN.exports,NCe=9007199254740991,_Ce=/^(?:0|[1-9]\d*)$/;function SCe(e,t){var r=typeof e;return t=t??NCe,!!t&&(r=="number"||r!="symbol"&&_Ce.test(e))&&e>-1&&e%1==0&&e<t}var zT=SCe,CCe=9007199254740991;function PCe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=CCe}var UT=PCe,ACe=qf,ECe=UT,kCe=zf,OCe="[object Arguments]",ICe="[object Array]",TCe="[object Boolean]",DCe="[object Date]",MCe="[object Error]",RCe="[object Function]",LCe="[object Map]",$Ce="[object Number]",FCe="[object Object]",BCe="[object RegExp]",qCe="[object Set]",zCe="[object String]",UCe="[object WeakMap]",VCe="[object ArrayBuffer]",WCe="[object DataView]",HCe="[object Float32Array]",GCe="[object Float64Array]",KCe="[object Int8Array]",YCe="[object Int16Array]",XCe="[object Int32Array]",JCe="[object Uint8Array]",QCe="[object Uint8ClampedArray]",ZCe="[object Uint16Array]",e5e="[object Uint32Array]",ko={};ko[HCe]=ko[GCe]=ko[KCe]=ko[YCe]=ko[XCe]=ko[JCe]=ko[QCe]=ko[ZCe]=ko[e5e]=!0;ko[OCe]=ko[ICe]=ko[VCe]=ko[TCe]=ko[WCe]=ko[DCe]=ko[MCe]=ko[RCe]=ko[LCe]=ko[$Ce]=ko[FCe]=ko[BCe]=ko[qCe]=ko[zCe]=ko[UCe]=!1;function t5e(e){return kCe(e)&&ECe(e.length)&&!!ko[ACe(e)]}var r5e=t5e;function n5e(e){return function(t){return e(t)}}var YY=n5e,TN={exports:{}};TN.exports;(function(e,t){var r=rY,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,s=i&&r.process,l=function(){try{var c=a&&a.require&&a.require("util").types;return c||s&&s.binding&&s.binding("util")}catch{}}();e.exports=l})(TN,TN.exports);var a5e=TN.exports,o5e=r5e,i5e=YY,AF=a5e,EF=AF&&AF.isTypedArray,s5e=EF?i5e(EF):o5e,XY=s5e,l5e=uCe,c5e=qT,d5e=Bl,u5e=KY,f5e=zT,m5e=XY,h5e=Object.prototype,p5e=h5e.hasOwnProperty;function g5e(e,t){var r=d5e(e),n=!r&&c5e(e),a=!r&&!n&&u5e(e),i=!r&&!n&&!a&&m5e(e),s=r||n||a||i,l=s?l5e(e.length,String):[],c=l.length;for(var d in e)(t||p5e.call(e,d))&&!(s&&(d=="length"||a&&(d=="offset"||d=="parent")||i&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||f5e(d,c)))&&l.push(d);return l}var v5e=g5e,x5e=Object.prototype;function y5e(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||x5e;return e===r}var b5e=y5e;function w5e(e,t){return function(r){return e(t(r))}}var JY=w5e,j5e=JY,N5e=j5e(Object.keys,Object),_5e=N5e,S5e=b5e,C5e=_5e,P5e=Object.prototype,A5e=P5e.hasOwnProperty;function E5e(e){if(!S5e(e))return C5e(e);var t=[];for(var r in Object(e))A5e.call(e,r)&&r!="constructor"&&t.push(r);return t}var k5e=E5e,O5e=_T,I5e=UT;function T5e(e){return e!=null&&I5e(e.length)&&!O5e(e)}var G1=T5e,D5e=v5e,M5e=k5e,R5e=G1;function L5e(e){return R5e(e)?D5e(e):M5e(e)}var uC=L5e,$5e=ZSe,F5e=cCe,B5e=uC;function q5e(e){return $5e(e,B5e,F5e)}var z5e=q5e,kF=z5e,U5e=1,V5e=Object.prototype,W5e=V5e.hasOwnProperty;function H5e(e,t,r,n,a,i){var s=r&U5e,l=kF(e),c=l.length,d=kF(t),u=d.length;if(c!=u&&!s)return!1;for(var f=c;f--;){var m=l[f];if(!(s?m in t:W5e.call(t,m)))return!1}var h=i.get(e),v=i.get(t);if(h&&v)return h==t&&v==e;var g=!0;i.set(e,t),i.set(t,e);for(var y=s;++f<c;){m=l[f];var x=e[m],b=t[m];if(n)var w=s?n(b,x,m,t,e,i):n(x,b,m,e,t,i);if(!(w===void 0?x===b||a(x,b,r,n,i):w)){g=!1;break}y||(y=m=="constructor")}if(g&&!y){var j=e.constructor,_=t.constructor;j!=_&&"constructor"in e&&"constructor"in t&&!(typeof j=="function"&&j instanceof j&&typeof _=="function"&&_ instanceof _)&&(g=!1)}return i.delete(e),i.delete(t),g}var G5e=H5e,K5e=mg,Y5e=zu,X5e=K5e(Y5e,"DataView"),J5e=X5e,Q5e=mg,Z5e=zu,ePe=Q5e(Z5e,"Promise"),tPe=ePe,rPe=mg,nPe=zu,aPe=rPe(nPe,"Set"),QY=aPe,oPe=mg,iPe=zu,sPe=oPe(iPe,"WeakMap"),lPe=sPe,yO=J5e,bO=CT,wO=tPe,jO=QY,NO=lPe,ZY=qf,i0=aY,OF="[object Map]",cPe="[object Object]",IF="[object Promise]",TF="[object Set]",DF="[object WeakMap]",MF="[object DataView]",dPe=i0(yO),uPe=i0(bO),fPe=i0(wO),mPe=i0(jO),hPe=i0(NO),Qh=ZY;(yO&&Qh(new yO(new ArrayBuffer(1)))!=MF||bO&&Qh(new bO)!=OF||wO&&Qh(wO.resolve())!=IF||jO&&Qh(new jO)!=TF||NO&&Qh(new NO)!=DF)&&(Qh=function(e){var t=ZY(e),r=t==cPe?e.constructor:void 0,n=r?i0(r):"";if(n)switch(n){case dPe:return MF;case uPe:return OF;case fPe:return IF;case mPe:return TF;case hPe:return DF}return t});var pPe=Qh,ZP=qY,gPe=WY,vPe=KSe,xPe=G5e,RF=pPe,LF=Bl,$F=KY,yPe=XY,bPe=1,FF="[object Arguments]",BF="[object Array]",y2="[object Object]",wPe=Object.prototype,qF=wPe.hasOwnProperty;function jPe(e,t,r,n,a,i){var s=LF(e),l=LF(t),c=s?BF:RF(e),d=l?BF:RF(t);c=c==FF?y2:c,d=d==FF?y2:d;var u=c==y2,f=d==y2,m=c==d;if(m&&$F(e)){if(!$F(t))return!1;s=!0,u=!1}if(m&&!u)return i||(i=new ZP),s||yPe(e)?gPe(e,t,r,n,a,i):vPe(e,t,c,r,n,a,i);if(!(r&bPe)){var h=u&&qF.call(e,"__wrapped__"),v=f&&qF.call(t,"__wrapped__");if(h||v){var g=h?e.value():e,y=v?t.value():t;return i||(i=new ZP),a(g,y,r,n,i)}}return m?(i||(i=new ZP),xPe(e,t,r,n,a,i)):!1}var NPe=jPe,_Pe=NPe,zF=zf;function eX(e,t,r,n,a){return e===t?!0:e==null||t==null||!zF(e)&&!zF(t)?e!==e&&t!==t:_Pe(e,t,r,n,eX,a)}var VT=eX,SPe=qY,CPe=VT,PPe=1,APe=2;function EPe(e,t,r,n){var a=r.length,i=a,s=!n;if(e==null)return!i;for(e=Object(e);a--;){var l=r[a];if(s&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++a<i;){l=r[a];var c=l[0],d=e[c],u=l[1];if(s&&l[2]){if(d===void 0&&!(c in e))return!1}else{var f=new SPe;if(n)var m=n(d,u,c,e,t,f);if(!(m===void 0?CPe(u,d,PPe|APe,n,f):m))return!1}}return!0}var kPe=EPe,OPe=Nh;function IPe(e){return e===e&&!OPe(e)}var tX=IPe,TPe=tX,DPe=uC;function MPe(e){for(var t=DPe(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,TPe(a)]}return t}var RPe=MPe;function LPe(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var rX=LPe,$Pe=kPe,FPe=RPe,BPe=rX;function qPe(e){var t=FPe(e);return t.length==1&&t[0][2]?BPe(t[0][0],t[0][1]):function(r){return r===e||$Pe(r,e,t)}}var zPe=qPe;function UPe(e,t){return e!=null&&t in Object(e)}var VPe=UPe,WPe=cY,HPe=qT,GPe=Bl,KPe=zT,YPe=UT,XPe=XS;function JPe(e,t,r){t=WPe(t,e);for(var n=-1,a=t.length,i=!1;++n<a;){var s=XPe(t[n]);if(!(i=e!=null&&r(e,s)))break;e=e[s]}return i||++n!=a?i:(a=e==null?0:e.length,!!a&&YPe(a)&&KPe(s,a)&&(GPe(e)||HPe(e)))}var QPe=JPe,ZPe=VPe,eAe=QPe;function tAe(e,t){return e!=null&&eAe(e,t,ZPe)}var rAe=tAe,nAe=VT,aAe=dY,oAe=rAe,iAe=NT,sAe=tX,lAe=rX,cAe=XS,dAe=1,uAe=2;function fAe(e,t){return iAe(e)&&sAe(t)?lAe(cAe(e),t):function(r){var n=aAe(r,e);return n===void 0&&n===t?oAe(r,e):nAe(t,n,dAe|uAe)}}var mAe=fAe;function hAe(e){return e}var s0=hAe;function pAe(e){return function(t){return t?.[e]}}var gAe=pAe,vAe=kT;function xAe(e){return function(t){return vAe(t,e)}}var yAe=xAe,bAe=gAe,wAe=yAe,jAe=NT,NAe=XS;function _Ae(e){return jAe(e)?bAe(NAe(e)):wAe(e)}var SAe=_Ae,CAe=zPe,PAe=mAe,AAe=s0,EAe=Bl,kAe=SAe;function OAe(e){return typeof e=="function"?e:e==null?AAe:typeof e=="object"?EAe(e)?PAe(e[0],e[1]):CAe(e):kAe(e)}var Uu=OAe;function IAe(e,t,r,n){for(var a=e.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(e[i],i,e))return i;return-1}var nX=IAe;function TAe(e){return e!==e}var DAe=TAe;function MAe(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}var RAe=MAe,LAe=nX,$Ae=DAe,FAe=RAe;function BAe(e,t,r){return t===t?FAe(e,t,r):LAe(e,$Ae,r)}var qAe=BAe,zAe=qAe;function UAe(e,t){var r=e==null?0:e.length;return!!r&&zAe(e,t,0)>-1}var VAe=UAe;function WAe(e,t,r){for(var n=-1,a=e==null?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}var HAe=WAe;function GAe(){}var KAe=GAe,eA=QY,YAe=KAe,XAe=BT,JAe=1/0,QAe=eA&&1/XAe(new eA([,-0]))[1]==JAe?function(e){return new eA(e)}:YAe,ZAe=QAe,eEe=zY,tEe=VAe,rEe=HAe,nEe=VY,aEe=ZAe,oEe=BT,iEe=200;function sEe(e,t,r){var n=-1,a=tEe,i=e.length,s=!0,l=[],c=l;if(r)s=!1,a=rEe;else if(i>=iEe){var d=t?null:aEe(e);if(d)return oEe(d);s=!1,a=nEe,c=new eEe}else c=t?[]:l;e:for(;++n<i;){var u=e[n],f=t?t(u):u;if(u=r||u!==0?u:0,s&&f===f){for(var m=c.length;m--;)if(c[m]===f)continue e;t&&c.push(f),l.push(u)}else a(c,f,r)||(c!==l&&c.push(f),l.push(u))}return l}var lEe=sEe,cEe=Uu,dEe=lEe;function uEe(e,t){return e&&e.length?dEe(e,cEe(t)):[]}var fEe=uEe;const UF=qa(fEe);function aX(e,t,r){return t===!0?UF(e,r):Vn(t)?UF(e,t):e}function dx(e){"@babel/helpers - typeof";return dx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dx(e)}var mEe=["ref"];function VF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VF(Object(r),!0).forEach(function(n){fC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function WF(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iX(n.key),n)}}function pEe(e,t,r){return t&&WF(e.prototype,t),r&&WF(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gEe(e,t,r){return t=DN(t),vEe(e,oX()?Reflect.construct(t,r||[],DN(e).constructor):t.apply(e,r))}function vEe(e,t){if(t&&(dx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xEe(e)}function xEe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oX=function(){return!!e})()}function DN(e){return DN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},DN(e)}function yEe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_O(e,t)}function _O(e,t){return _O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},_O(e,t)}function fC(e,t,r){return t=iX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iX(e){var t=bEe(e,"string");return dx(t)=="symbol"?t:t+""}function bEe(e,t){if(dx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(dx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wEe(e,t){if(e==null)return{};var r=jEe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function jEe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function NEe(e){return e.value}function _Ee(e,t){if(ye.isValidElement(e))return ye.cloneElement(e,t);if(typeof e=="function")return ye.createElement(e,t);t.ref;var r=wEe(t,mEe);return ye.createElement(FT,r)}var HF=1,Pp=function(e){function t(){var r;hEe(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=gEe(this,t,[].concat(a)),fC(r,"lastBoundingBox",{width:-1,height:-1}),r}return yEe(t,e),pEe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>HF||Math.abs(a.height-this.lastBoundingBox.height)>HF)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Qu({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,i=a.layout,s=a.align,l=a.verticalAlign,c=a.margin,d=a.chartWidth,u=a.chartHeight,f,m;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(s==="center"&&i==="vertical"){var h=this.getBBoxSnapshot();f={left:((d||0)-h.width)/2}}else f=s==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(l==="middle"){var v=this.getBBoxSnapshot();m={top:((u||0)-v.height)/2}}else m=l==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return Qu(Qu({},f),m)}},{key:"render",value:function(){var n=this,a=this.props,i=a.content,s=a.width,l=a.height,c=a.wrapperStyle,d=a.payloadUniqBy,u=a.payload,f=Qu(Qu({position:"absolute",width:s||"auto",height:l||"auto"},this.getDefaultPosition(c)),c);return ye.createElement("div",{className:"recharts-legend-wrapper",style:f,ref:function(h){n.wrapperNode=h}},_Ee(i,Qu(Qu({},this.props),{},{payload:aX(u,d,NEe)})))}}],[{key:"getWithHeight",value:function(n,a){var i=Qu(Qu({},this.defaultProps),n.props),s=i.layout;return s==="vertical"&&Mr(n.props.height)?{height:n.props.height}:s==="horizontal"?{width:n.props.width||a}:null}}])}(p.PureComponent);fC(Pp,"displayName","Legend");fC(Pp,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var GF=H1,SEe=qT,CEe=Bl,KF=GF?GF.isConcatSpreadable:void 0;function PEe(e){return CEe(e)||SEe(e)||!!(KF&&e&&e[KF])}var AEe=PEe,EEe=HY,kEe=AEe;function sX(e,t,r,n,a){var i=-1,s=e.length;for(r||(r=kEe),a||(a=[]);++i<s;){var l=e[i];t>0&&r(l)?t>1?sX(l,t-1,r,n,a):EEe(a,l):n||(a[a.length]=l)}return a}var lX=sX;function OEe(e){return function(t,r,n){for(var a=-1,i=Object(t),s=n(t),l=s.length;l--;){var c=s[e?l:++a];if(r(i[c],c,i)===!1)break}return t}}var IEe=OEe,TEe=IEe,DEe=TEe(),MEe=DEe,REe=MEe,LEe=uC;function $Ee(e,t){return e&&REe(e,t,LEe)}var cX=$Ee,FEe=G1;function BEe(e,t){return function(r,n){if(r==null)return r;if(!FEe(r))return e(r,n);for(var a=r.length,i=t?a:-1,s=Object(r);(t?i--:++i<a)&&n(s[i],i,s)!==!1;);return r}}var qEe=BEe,zEe=cX,UEe=qEe,VEe=UEe(zEe),WT=VEe,WEe=WT,HEe=G1;function GEe(e,t){var r=-1,n=HEe(e)?Array(e.length):[];return WEe(e,function(a,i,s){n[++r]=t(a,i,s)}),n}var dX=GEe;function KEe(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var YEe=KEe,YF=Zx;function XEe(e,t){if(e!==t){var r=e!==void 0,n=e===null,a=e===e,i=YF(e),s=t!==void 0,l=t===null,c=t===t,d=YF(t);if(!l&&!d&&!i&&e>t||i&&s&&c&&!l&&!d||n&&s&&c||!r&&c||!a)return 1;if(!n&&!i&&!d&&e<t||d&&r&&a&&!n&&!i||l&&r&&a||!s&&a||!c)return-1}return 0}var JEe=XEe,QEe=JEe;function ZEe(e,t,r){for(var n=-1,a=e.criteria,i=t.criteria,s=a.length,l=r.length;++n<s;){var c=QEe(a[n],i[n]);if(c){if(n>=l)return c;var d=r[n];return c*(d=="desc"?-1:1)}}return e.index-t.index}var eke=ZEe,tA=ET,tke=kT,rke=Uu,nke=dX,ake=YEe,oke=YY,ike=eke,ske=s0,lke=Bl;function cke(e,t,r){t.length?t=tA(t,function(i){return lke(i)?function(s){return tke(s,i.length===1?i[0]:i)}:i}):t=[ske];var n=-1;t=tA(t,oke(rke));var a=nke(e,function(i,s,l){var c=tA(t,function(d){return d(i)});return{criteria:c,index:++n,value:i}});return ake(a,function(i,s){return ike(i,s,r)})}var dke=cke;function uke(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var fke=uke,mke=fke,XF=Math.max;function hke(e,t,r){return t=XF(t===void 0?e.length-1:t,0),function(){for(var n=arguments,a=-1,i=XF(n.length-t,0),s=Array(i);++a<i;)s[a]=n[t+a];a=-1;for(var l=Array(t+1);++a<t;)l[a]=n[a];return l[t]=r(s),mke(e,this,l)}}var pke=hke;function gke(e){return function(){return e}}var vke=gke,xke=mg,yke=function(){try{var e=xke(Object,"defineProperty");return e({},"",{}),e}catch{}}(),uX=yke,bke=vke,JF=uX,wke=s0,jke=JF?function(e,t){return JF(e,"toString",{configurable:!0,enumerable:!1,value:bke(t),writable:!0})}:wke,Nke=jke,_ke=800,Ske=16,Cke=Date.now;function Pke(e){var t=0,r=0;return function(){var n=Cke(),a=Ske-(n-r);if(r=n,a>0){if(++t>=_ke)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var Ake=Pke,Eke=Nke,kke=Ake,Oke=kke(Eke),Ike=Oke,Tke=s0,Dke=pke,Mke=Ike;function Rke(e,t){return Mke(Dke(e,t,Tke),e+"")}var Lke=Rke,$ke=ST,Fke=G1,Bke=zT,qke=Nh;function zke(e,t,r){if(!qke(r))return!1;var n=typeof t;return(n=="number"?Fke(r)&&Bke(t,r.length):n=="string"&&t in r)?$ke(r[t],e):!1}var mC=zke,Uke=lX,Vke=dke,Wke=Lke,QF=mC,Hke=Wke(function(e,t){if(e==null)return[];var r=t.length;return r>1&&QF(e,t[0],t[1])?t=[]:r>2&&QF(t[0],t[1],t[2])&&(t=[t[0]]),Vke(e,Uke(t,1),[])}),Gke=Hke;const HT=qa(Gke);function Ib(e){"@babel/helpers - typeof";return Ib=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ib(e)}function SO(){return SO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},SO.apply(this,arguments)}function Kke(e,t){return Qke(e)||Jke(e,t)||Xke(e,t)||Yke()}function Yke(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xke(e,t){if(e){if(typeof e=="string")return ZF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZF(e,t)}}function ZF(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Jke(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function Qke(e){if(Array.isArray(e))return e}function e8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function rA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?e8(Object(r),!0).forEach(function(n){Zke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):e8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Zke(e,t,r){return t=eOe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eOe(e){var t=tOe(e,"string");return Ib(t)=="symbol"?t:t+""}function tOe(e,t){if(Ib(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ib(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rOe(e){return Array.isArray(e)&&Gi(e[0])&&Gi(e[1])?e.join(" ~ "):e}var nOe=function(t){var r=t.separator,n=r===void 0?" : ":r,a=t.contentStyle,i=a===void 0?{}:a,s=t.itemStyle,l=s===void 0?{}:s,c=t.labelStyle,d=c===void 0?{}:c,u=t.payload,f=t.formatter,m=t.itemSorter,h=t.wrapperClassName,v=t.labelClassName,g=t.label,y=t.labelFormatter,x=t.accessibilityLayer,b=x===void 0?!1:x,w=function(){if(u&&u.length){var I={padding:0,margin:0},T=(m?HT(u,m):u).map(function(D,B){if(D.type==="none")return null;var U=rA({display:"block",paddingTop:4,paddingBottom:4,color:D.color||"#000"},l),z=D.formatter||f||rOe,$=D.value,Y=D.name,de=$,xe=Y;if(z&&de!=null&&xe!=null){var q=z($,Y,D,B,u);if(Array.isArray(q)){var L=Kke(q,2);de=L[0],xe=L[1]}else de=q}return ye.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(B),style:U},Gi(xe)?ye.createElement("span",{className:"recharts-tooltip-item-name"},xe):null,Gi(xe)?ye.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,ye.createElement("span",{className:"recharts-tooltip-item-value"},de),ye.createElement("span",{className:"recharts-tooltip-item-unit"},D.unit||""))});return ye.createElement("ul",{className:"recharts-tooltip-item-list",style:I},T)}return null},j=rA({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),_=rA({margin:0},d),C=!Qn(g),E=C?g:"",P=ta("recharts-default-tooltip",h),k=ta("recharts-tooltip-label",v);C&&y&&u!==void 0&&u!==null&&(E=y(g,u));var M=b?{role:"status","aria-live":"assertive"}:{};return ye.createElement("div",SO({className:P,style:j},M),ye.createElement("p",{className:k,style:_},ye.isValidElement(E)?E:"".concat(E)),w())};function Tb(e){"@babel/helpers - typeof";return Tb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tb(e)}function b2(e,t,r){return t=aOe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aOe(e){var t=oOe(e,"string");return Tb(t)=="symbol"?t:t+""}function oOe(e,t){if(Tb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Tb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var z0="recharts-tooltip-wrapper",iOe={visibility:"hidden"};function sOe(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return ta(z0,b2(b2(b2(b2({},"".concat(z0,"-right"),Mr(r)&&t&&Mr(t.x)&&r>=t.x),"".concat(z0,"-left"),Mr(r)&&t&&Mr(t.x)&&r<t.x),"".concat(z0,"-bottom"),Mr(n)&&t&&Mr(t.y)&&n>=t.y),"".concat(z0,"-top"),Mr(n)&&t&&Mr(t.y)&&n<t.y))}function t8(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,a=e.offsetTopLeft,i=e.position,s=e.reverseDirection,l=e.tooltipDimension,c=e.viewBox,d=e.viewBoxDimension;if(i&&Mr(i[n]))return i[n];var u=r[n]-l-a,f=r[n]+a;if(t[n])return s[n]?u:f;if(s[n]){var m=u,h=c[n];return m<h?Math.max(f,c[n]):Math.max(u,c[n])}var v=f+l,g=c[n]+d;return v>g?Math.max(u,c[n]):Math.max(f,c[n])}function lOe(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function cOe(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,a=e.position,i=e.reverseDirection,s=e.tooltipBox,l=e.useTranslate3d,c=e.viewBox,d,u,f;return s.height>0&&s.width>0&&r?(u=t8({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.width,viewBox:c,viewBoxDimension:c.width}),f=t8({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.height,viewBox:c,viewBoxDimension:c.height}),d=lOe({translateX:u,translateY:f,useTranslate3d:l})):d=iOe,{cssProperties:d,cssClasses:sOe({translateX:u,translateY:f,coordinate:r})}}function ux(e){"@babel/helpers - typeof";return ux=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ux(e)}function r8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function n8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?r8(Object(r),!0).forEach(function(n){PO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):r8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mX(n.key),n)}}function uOe(e,t,r){return t&&a8(e.prototype,t),r&&a8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fOe(e,t,r){return t=MN(t),mOe(e,fX()?Reflect.construct(t,r||[],MN(e).constructor):t.apply(e,r))}function mOe(e,t){if(t&&(ux(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hOe(e)}function hOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fX=function(){return!!e})()}function MN(e){return MN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},MN(e)}function pOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CO(e,t)}function CO(e,t){return CO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},CO(e,t)}function PO(e,t,r){return t=mX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mX(e){var t=gOe(e,"string");return ux(t)=="symbol"?t:t+""}function gOe(e,t){if(ux(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(ux(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var o8=1,vOe=function(e){function t(){var r;dOe(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=fOe(this,t,[].concat(a)),PO(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),PO(r,"handleKeyDown",function(s){if(s.key==="Escape"){var l,c,d,u;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(l=(c=r.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&l!==void 0?l:0,y:(d=(u=r.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&d!==void 0?d:0}})}}),r}return pOe(t,e),uOe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>o8||Math.abs(n.height-this.state.lastBoundingBox.height)>o8)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,i=a.active,s=a.allowEscapeViewBox,l=a.animationDuration,c=a.animationEasing,d=a.children,u=a.coordinate,f=a.hasPayload,m=a.isAnimationActive,h=a.offset,v=a.position,g=a.reverseDirection,y=a.useTranslate3d,x=a.viewBox,b=a.wrapperStyle,w=cOe({allowEscapeViewBox:s,coordinate:u,offsetTopLeft:h,position:v,reverseDirection:g,tooltipBox:this.state.lastBoundingBox,useTranslate3d:y,viewBox:x}),j=w.cssClasses,_=w.cssProperties,C=n8(n8({transition:m&&i?"transform ".concat(l,"ms ").concat(c):void 0},_),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&f?"visible":"hidden",position:"absolute",top:0,left:0},b);return ye.createElement("div",{tabIndex:-1,className:j,style:C,ref:function(P){n.wrapperNode=P}},d)}}])}(p.PureComponent),xOe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Kd={isSsr:xOe(),get:function(t){return Kd[t]},set:function(t,r){if(typeof t=="string")Kd[t]=r;else{var n=Object.keys(t);n&&n.length&&n.forEach(function(a){Kd[a]=t[a]})}}};function fx(e){"@babel/helpers - typeof";return fx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fx(e)}function i8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function s8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i8(Object(r),!0).forEach(function(n){GT(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pX(n.key),n)}}function bOe(e,t,r){return t&&l8(e.prototype,t),r&&l8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wOe(e,t,r){return t=RN(t),jOe(e,hX()?Reflect.construct(t,r||[],RN(e).constructor):t.apply(e,r))}function jOe(e,t){if(t&&(fx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return NOe(e)}function NOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hX(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hX=function(){return!!e})()}function RN(e){return RN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},RN(e)}function _Oe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AO(e,t)}function AO(e,t){return AO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},AO(e,t)}function GT(e,t,r){return t=pX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pX(e){var t=SOe(e,"string");return fx(t)=="symbol"?t:t+""}function SOe(e,t){if(fx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(fx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function COe(e){return e.dataKey}function POe(e,t){return ye.isValidElement(e)?ye.cloneElement(e,t):typeof e=="function"?ye.createElement(e,t):ye.createElement(nOe,t)}var oc=function(e){function t(){return yOe(this,t),wOe(this,t,arguments)}return _Oe(t,e),bOe(t,[{key:"render",value:function(){var n=this,a=this.props,i=a.active,s=a.allowEscapeViewBox,l=a.animationDuration,c=a.animationEasing,d=a.content,u=a.coordinate,f=a.filterNull,m=a.isAnimationActive,h=a.offset,v=a.payload,g=a.payloadUniqBy,y=a.position,x=a.reverseDirection,b=a.useTranslate3d,w=a.viewBox,j=a.wrapperStyle,_=v??[];f&&_.length&&(_=aX(v.filter(function(E){return E.value!=null&&(E.hide!==!0||n.props.includeHidden)}),g,COe));var C=_.length>0;return ye.createElement(vOe,{allowEscapeViewBox:s,animationDuration:l,animationEasing:c,isAnimationActive:m,active:i,coordinate:u,hasPayload:C,offset:h,position:y,reverseDirection:x,useTranslate3d:b,viewBox:w,wrapperStyle:j},POe(d,s8(s8({},this.props),{},{payload:_})))}}])}(p.PureComponent);GT(oc,"displayName","Tooltip");GT(oc,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Kd.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var AOe=zu,EOe=function(){return AOe.Date.now()},kOe=EOe,OOe=/\s/;function IOe(e){for(var t=e.length;t--&&OOe.test(e.charAt(t)););return t}var TOe=IOe,DOe=TOe,MOe=/^\s+/;function ROe(e){return e&&e.slice(0,DOe(e)+1).replace(MOe,"")}var LOe=ROe,$Oe=LOe,c8=Nh,FOe=Zx,d8=0/0,BOe=/^[-+]0x[0-9a-f]+$/i,qOe=/^0b[01]+$/i,zOe=/^0o[0-7]+$/i,UOe=parseInt;function VOe(e){if(typeof e=="number")return e;if(FOe(e))return d8;if(c8(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=c8(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=$Oe(e);var r=qOe.test(e);return r||zOe.test(e)?UOe(e.slice(2),r?2:8):BOe.test(e)?d8:+e}var gX=VOe,WOe=Nh,nA=kOe,u8=gX,HOe="Expected a function",GOe=Math.max,KOe=Math.min;function YOe(e,t,r){var n,a,i,s,l,c,d=0,u=!1,f=!1,m=!0;if(typeof e!="function")throw new TypeError(HOe);t=u8(t)||0,WOe(r)&&(u=!!r.leading,f="maxWait"in r,i=f?GOe(u8(r.maxWait)||0,t):i,m="trailing"in r?!!r.trailing:m);function h(C){var E=n,P=a;return n=a=void 0,d=C,s=e.apply(P,E),s}function v(C){return d=C,l=setTimeout(x,t),u?h(C):s}function g(C){var E=C-c,P=C-d,k=t-E;return f?KOe(k,i-P):k}function y(C){var E=C-c,P=C-d;return c===void 0||E>=t||E<0||f&&P>=i}function x(){var C=nA();if(y(C))return b(C);l=setTimeout(x,g(C))}function b(C){return l=void 0,m&&n?h(C):(n=a=void 0,s)}function w(){l!==void 0&&clearTimeout(l),d=0,n=c=a=l=void 0}function j(){return l===void 0?s:b(nA())}function _(){var C=nA(),E=y(C);if(n=arguments,a=this,c=C,E){if(l===void 0)return v(c);if(f)return clearTimeout(l),l=setTimeout(x,t),h(c)}return l===void 0&&(l=setTimeout(x,t)),s}return _.cancel=w,_.flush=j,_}var XOe=YOe,JOe=XOe,QOe=Nh,ZOe="Expected a function";function e3e(e,t,r){var n=!0,a=!0;if(typeof e!="function")throw new TypeError(ZOe);return QOe(r)&&(n="leading"in r?!!r.leading:n,a="trailing"in r?!!r.trailing:a),JOe(e,t,{leading:n,maxWait:t,trailing:a})}var t3e=e3e;const vX=qa(t3e);function Db(e){"@babel/helpers - typeof";return Db=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Db(e)}function f8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function w2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?f8(Object(r),!0).forEach(function(n){r3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function r3e(e,t,r){return t=n3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n3e(e){var t=a3e(e,"string");return Db(t)=="symbol"?t:t+""}function a3e(e,t){if(Db(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Db(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function o3e(e,t){return c3e(e)||l3e(e,t)||s3e(e,t)||i3e()}function i3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function s3e(e,t){if(e){if(typeof e=="string")return m8(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m8(e,t)}}function m8(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l3e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function c3e(e){if(Array.isArray(e))return e}var xj=p.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,a=n===void 0?{width:-1,height:-1}:n,i=e.width,s=i===void 0?"100%":i,l=e.height,c=l===void 0?"100%":l,d=e.minWidth,u=d===void 0?0:d,f=e.minHeight,m=e.maxHeight,h=e.children,v=e.debounce,g=v===void 0?0:v,y=e.id,x=e.className,b=e.onResize,w=e.style,j=w===void 0?{}:w,_=p.useRef(null),C=p.useRef();C.current=b,p.useImperativeHandle(t,function(){return Object.defineProperty(_.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),_.current},configurable:!0})});var E=p.useState({containerWidth:a.width,containerHeight:a.height}),P=o3e(E,2),k=P[0],M=P[1],S=p.useCallback(function(T,D){M(function(B){var U=Math.round(T),z=Math.round(D);return B.containerWidth===U&&B.containerHeight===z?B:{containerWidth:U,containerHeight:z}})},[]);p.useEffect(function(){var T=function(Y){var de,xe=Y[0].contentRect,q=xe.width,L=xe.height;S(q,L),(de=C.current)===null||de===void 0||de.call(C,q,L)};g>0&&(T=vX(T,g,{trailing:!0,leading:!1}));var D=new ResizeObserver(T),B=_.current.getBoundingClientRect(),U=B.width,z=B.height;return S(U,z),D.observe(_.current),function(){D.disconnect()}},[S,g]);var I=p.useMemo(function(){var T=k.containerWidth,D=k.containerHeight;if(T<0||D<0)return null;Gd(fp(s)||fp(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,s,c),Gd(!r||r>0,"The aspect(%s) must be greater than zero.",r);var B=fp(s)?T:s,U=fp(c)?D:c;r&&r>0&&(B?U=B/r:U&&(B=U*r),m&&U>m&&(U=m)),Gd(B>0||U>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,B,U,s,c,u,f,r);var z=!Array.isArray(h)&&jf(h.type).endsWith("Chart");return ye.Children.map(h,function($){return ye.isValidElement($)?p.cloneElement($,w2({width:B,height:U},z?{style:w2({height:"100%",width:"100%",maxHeight:U,maxWidth:B},$.props.style)}:{})):$})},[r,h,c,m,f,u,k,s]);return ye.createElement("div",{id:y?"".concat(y):void 0,className:ta("recharts-responsive-container",x),style:w2(w2({},j),{},{width:s,height:c,minWidth:u,minHeight:f,maxHeight:m}),ref:_},I)}),Mb=function(t){return null};Mb.displayName="Cell";function Rb(e){"@babel/helpers - typeof";return Rb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rb(e)}function h8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function EO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h8(Object(r),!0).forEach(function(n){d3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function d3e(e,t,r){return t=u3e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u3e(e){var t=f3e(e,"string");return Rb(t)=="symbol"?t:t+""}function f3e(e,t){if(Rb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Rb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lg={widthCache:{},cacheCount:0},m3e=2e3,h3e={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},p8="recharts_measurement_span";function p3e(e){var t=EO({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var Ry=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Kd.isSsr)return{width:0,height:0};var n=p3e(r),a=JSON.stringify({text:t,copyStyle:n});if(Lg.widthCache[a])return Lg.widthCache[a];try{var i=document.getElementById(p8);i||(i=document.createElement("span"),i.setAttribute("id",p8),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var s=EO(EO({},h3e),n);Object.assign(i.style,s),i.textContent="".concat(t);var l=i.getBoundingClientRect(),c={width:l.width,height:l.height};return Lg.widthCache[a]=c,++Lg.cacheCount>m3e&&(Lg.cacheCount=0,Lg.widthCache={}),c}catch{return{width:0,height:0}}},g3e=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function Lb(e){"@babel/helpers - typeof";return Lb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lb(e)}function LN(e,t){return b3e(e)||y3e(e,t)||x3e(e,t)||v3e()}function v3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function x3e(e,t){if(e){if(typeof e=="string")return g8(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g8(e,t)}}function g8(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y3e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function b3e(e){if(Array.isArray(e))return e}function w3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v8(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,N3e(n.key),n)}}function j3e(e,t,r){return t&&v8(e.prototype,t),r&&v8(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function N3e(e){var t=_3e(e,"string");return Lb(t)=="symbol"?t:t+""}function _3e(e,t){if(Lb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Lb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var x8=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,y8=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,S3e=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,C3e=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,xX={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},P3e=Object.keys(xX),wv="NaN";function A3e(e,t){return e*xX[t]}var j2=function(){function e(t,r){w3e(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!S3e.test(r)&&(this.num=NaN,this.unit=""),P3e.includes(r)&&(this.num=A3e(t,r),this.unit="px")}return j3e(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,a=(n=C3e.exec(r))!==null&&n!==void 0?n:[],i=LN(a,3),s=i[1],l=i[2];return new e(parseFloat(s),l??"")}}])}();function yX(e){if(e.includes(wv))return wv;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=x8.exec(t))!==null&&r!==void 0?r:[],a=LN(n,4),i=a[1],s=a[2],l=a[3],c=j2.parse(i??""),d=j2.parse(l??""),u=s==="*"?c.multiply(d):c.divide(d);if(u.isNaN())return wv;t=t.replace(x8,u.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,m=(f=y8.exec(t))!==null&&f!==void 0?f:[],h=LN(m,4),v=h[1],g=h[2],y=h[3],x=j2.parse(v??""),b=j2.parse(y??""),w=g==="+"?x.add(b):x.subtract(b);if(w.isNaN())return wv;t=t.replace(y8,w.toString())}return t}var b8=/\(([^()]*)\)/;function E3e(e){for(var t=e;t.includes("(");){var r=b8.exec(t),n=LN(r,2),a=n[1];t=t.replace(b8,yX(a))}return t}function k3e(e){var t=e.replace(/\s+/g,"");return t=E3e(t),t=yX(t),t}function O3e(e){try{return k3e(e)}catch{return wv}}function aA(e){var t=O3e(e.slice(5,-1));return t===wv?"":t}var I3e=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],T3e=["dx","dy","angle","className","breakAll"];function kO(){return kO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kO.apply(this,arguments)}function w8(e,t){if(e==null)return{};var r=D3e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function D3e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function j8(e,t){return $3e(e)||L3e(e,t)||R3e(e,t)||M3e()}function M3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function R3e(e,t){if(e){if(typeof e=="string")return N8(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return N8(e,t)}}function N8(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function L3e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function $3e(e){if(Array.isArray(e))return e}var bX=/[ \f\n\r\t\v\u2028\u2029]+/,wX=function(t){var r=t.children,n=t.breakAll,a=t.style;try{var i=[];Qn(r)||(n?i=r.toString().split(""):i=r.toString().split(bX));var s=i.map(function(c){return{word:c,width:Ry(c,a).width}}),l=n?0:Ry("",a).width;return{wordsWithComputedWidth:s,spaceWidth:l}}catch{return null}},F3e=function(t,r,n,a,i){var s=t.maxLines,l=t.children,c=t.style,d=t.breakAll,u=Mr(s),f=l,m=function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return B.reduce(function(U,z){var $=z.word,Y=z.width,de=U[U.length-1];if(de&&(a==null||i||de.width+Y+n<Number(a)))de.words.push($),de.width+=Y+n;else{var xe={words:[$],width:Y};U.push(xe)}return U},[])},h=m(r),v=function(B){return B.reduce(function(U,z){return U.width>z.width?U:z})};if(!u)return h;for(var g="",y=function(B){var U=f.slice(0,B),z=wX({breakAll:d,style:c,children:U+g}).wordsWithComputedWidth,$=m(z),Y=$.length>s||v($).width>Number(a);return[Y,$]},x=0,b=f.length-1,w=0,j;x<=b&&w<=f.length-1;){var _=Math.floor((x+b)/2),C=_-1,E=y(C),P=j8(E,2),k=P[0],M=P[1],S=y(_),I=j8(S,1),T=I[0];if(!k&&!T&&(x=_+1),k&&T&&(b=_-1),!k&&T){j=M;break}w++}return j||h},_8=function(t){var r=Qn(t)?[]:t.toString().split(bX);return[{words:r}]},B3e=function(t){var r=t.width,n=t.scaleToFit,a=t.children,i=t.style,s=t.breakAll,l=t.maxLines;if((r||n)&&!Kd.isSsr){var c,d,u=wX({breakAll:s,children:a,style:i});if(u){var f=u.wordsWithComputedWidth,m=u.spaceWidth;c=f,d=m}else return _8(a);return F3e({breakAll:s,children:a,maxLines:l,style:i},c,d,r,n)}return _8(a)},S8="#808080",Kp=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,s=t.lineHeight,l=s===void 0?"1em":s,c=t.capHeight,d=c===void 0?"0.71em":c,u=t.scaleToFit,f=u===void 0?!1:u,m=t.textAnchor,h=m===void 0?"start":m,v=t.verticalAnchor,g=v===void 0?"end":v,y=t.fill,x=y===void 0?S8:y,b=w8(t,I3e),w=p.useMemo(function(){return B3e({breakAll:b.breakAll,children:b.children,maxLines:b.maxLines,scaleToFit:f,style:b.style,width:b.width})},[b.breakAll,b.children,b.maxLines,f,b.style,b.width]),j=b.dx,_=b.dy,C=b.angle,E=b.className,P=b.breakAll,k=w8(b,T3e);if(!Gi(n)||!Gi(i))return null;var M=n+(Mr(j)?j:0),S=i+(Mr(_)?_:0),I;switch(g){case"start":I=aA("calc(".concat(d,")"));break;case"middle":I=aA("calc(".concat((w.length-1)/2," * -").concat(l," + (").concat(d," / 2))"));break;default:I=aA("calc(".concat(w.length-1," * -").concat(l,")"));break}var T=[];if(f){var D=w[0].width,B=b.width;T.push("scale(".concat((Mr(B)?B/D:1)/D,")"))}return C&&T.push("rotate(".concat(C,", ").concat(M,", ").concat(S,")")),T.length&&(k.transform=T.join(" ")),ye.createElement("text",kO({},On(k,!0),{x:M,y:S,className:ta("recharts-text",E),textAnchor:h,fill:x.includes("url")?S8:x}),w.map(function(U,z){var $=U.words.join(P?"":" ");return ye.createElement("tspan",{x:M,dy:z===0?I:l,key:"".concat($,"-").concat(z)},$)}))};function Km(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function q3e(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function KT(e){let t,r,n;e.length!==2?(t=Km,r=(l,c)=>Km(e(l),c),n=(l,c)=>e(l)-c):(t=e===Km||e===q3e?e:z3e,r=e,n=e);function a(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<0?d=f+1:u=f}while(d<u)}return d}function i(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<=0?d=f+1:u=f}while(d<u)}return d}function s(l,c,d=0,u=l.length){const f=a(l,c,d,u-1);return f>d&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:a,center:s,right:i}}function z3e(){return 0}function jX(e){return e===null?NaN:+e}function*U3e(e,t){if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(yield r);else{let r=-1;for(let n of e)(n=t(n,++r,e))!=null&&(n=+n)>=n&&(yield n)}}const V3e=KT(Km),W3e=V3e.right;KT(jX).center;const K1=W3e;class C8 extends Map{constructor(t,r=K3e){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(P8(this,t))}has(t){return super.has(P8(this,t))}set(t,r){return super.set(H3e(this,t),r)}delete(t){return super.delete(G3e(this,t))}}function P8({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function H3e({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function G3e({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function K3e(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Y3e(e=Km){if(e===Km)return NX;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function NX(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const X3e=Math.sqrt(50),J3e=Math.sqrt(10),Q3e=Math.sqrt(2);function $N(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=X3e?10:i>=J3e?5:i>=Q3e?2:1;let l,c,d;return a<0?(d=Math.pow(10,-a)/s,l=Math.round(e*d),c=Math.round(t*d),l/d<e&&++l,c/d>t&&--c,d=-d):(d=Math.pow(10,a)*s,l=Math.round(e/d),c=Math.round(t/d),l*d<e&&++l,c*d>t&&--c),c<l&&.5<=r&&r<2?$N(e,t,r*2):[l,c,d]}function OO(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,s]=n?$N(t,e,r):$N(e,t,r);if(!(i>=a))return[];const l=i-a+1,c=new Array(l);if(n)if(s<0)for(let d=0;d<l;++d)c[d]=(i-d)/-s;else for(let d=0;d<l;++d)c[d]=(i-d)*s;else if(s<0)for(let d=0;d<l;++d)c[d]=(a+d)/-s;else for(let d=0;d<l;++d)c[d]=(a+d)*s;return c}function IO(e,t,r){return t=+t,e=+e,r=+r,$N(e,t,r)[2]}function TO(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?IO(t,e,r):IO(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function A8(e,t){let r;if(t===void 0)for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let a of e)(a=t(a,++n,e))!=null&&(r<a||r===void 0&&a>=a)&&(r=a)}return r}function E8(e,t){let r;if(t===void 0)for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let a of e)(a=t(a,++n,e))!=null&&(r>a||r===void 0&&a>=a)&&(r=a)}return r}function _X(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?NX:Y3e(a);n>r;){if(n-r>600){const c=n-r+1,d=t-r+1,u=Math.log(c),f=.5*Math.exp(2*u/3),m=.5*Math.sqrt(u*f*(c-f)/c)*(d-c/2<0?-1:1),h=Math.max(r,Math.floor(t-d*f/c+m)),v=Math.min(n,Math.floor(t+(c-d)*f/c+m));_X(e,t,h,v,a)}const i=e[t];let s=r,l=n;for(U0(e,r,t),a(e[n],i)>0&&U0(e,r,n);s<l;){for(U0(e,s,l),++s,--l;a(e[s],i)<0;)++s;for(;a(e[l],i)>0;)--l}a(e[r],i)===0?U0(e,r,l):(++l,U0(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function U0(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function Z3e(e,t,r){if(e=Float64Array.from(U3e(e,r)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return E8(e);if(t>=1)return A8(e);var n,a=(n-1)*t,i=Math.floor(a),s=A8(_X(e,i).subarray(0,i+1)),l=E8(e.subarray(i+1));return s+(l-s)*(a-i)}}function e4e(e,t,r=jX){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),s=+r(e[i],i,e),l=+r(e[i+1],i+1,e);return s+(l-s)*(a-i)}}function t4e(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function vd(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Uf(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const DO=Symbol("implicit");function YT(){var e=new C8,t=[],r=[],n=DO;function a(i){let s=e.get(i);if(s===void 0){if(n!==DO)return n;e.set(i,s=t.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new C8;for(const s of i)e.has(s)||e.set(s,t.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return YT(t,r).unknown(n)},vd.apply(a,arguments),a}function $b(){var e=YT().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,s,l=!1,c=0,d=0,u=.5;delete e.unknown;function f(){var m=t().length,h=a<n,v=h?a:n,g=h?n:a;i=(g-v)/Math.max(1,m-c+d*2),l&&(i=Math.floor(i)),v+=(g-v-i*(m-c))*u,s=i*(1-c),l&&(v=Math.round(v),s=Math.round(s));var y=t4e(m).map(function(x){return v+i*x});return r(h?y.reverse():y)}return e.domain=function(m){return arguments.length?(t(m),f()):t()},e.range=function(m){return arguments.length?([n,a]=m,n=+n,a=+a,f()):[n,a]},e.rangeRound=function(m){return[n,a]=m,n=+n,a=+a,l=!0,f()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(m){return arguments.length?(l=!!m,f()):l},e.padding=function(m){return arguments.length?(c=Math.min(1,d=+m),f()):c},e.paddingInner=function(m){return arguments.length?(c=Math.min(1,m),f()):c},e.paddingOuter=function(m){return arguments.length?(d=+m,f()):d},e.align=function(m){return arguments.length?(u=Math.max(0,Math.min(1,m)),f()):u},e.copy=function(){return $b(t(),[n,a]).round(l).paddingInner(c).paddingOuter(d).align(u)},vd.apply(f(),arguments)}function SX(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return SX(t())},e}function Ly(){return SX($b.apply(null,arguments).paddingInner(1))}function XT(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function CX(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Y1(){}var Fb=.7,FN=1/Fb,$v="\\s*([+-]?\\d+)\\s*",Bb="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Iu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",r4e=/^#([0-9a-f]{3,8})$/,n4e=new RegExp(`^rgb\\(${$v},${$v},${$v}\\)$`),a4e=new RegExp(`^rgb\\(${Iu},${Iu},${Iu}\\)$`),o4e=new RegExp(`^rgba\\(${$v},${$v},${$v},${Bb}\\)$`),i4e=new RegExp(`^rgba\\(${Iu},${Iu},${Iu},${Bb}\\)$`),s4e=new RegExp(`^hsl\\(${Bb},${Iu},${Iu}\\)$`),l4e=new RegExp(`^hsla\\(${Bb},${Iu},${Iu},${Bb}\\)$`),k8={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};XT(Y1,qb,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:O8,formatHex:O8,formatHex8:c4e,formatHsl:d4e,formatRgb:I8,toString:I8});function O8(){return this.rgb().formatHex()}function c4e(){return this.rgb().formatHex8()}function d4e(){return PX(this).formatHsl()}function I8(){return this.rgb().formatRgb()}function qb(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=r4e.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?T8(t):r===3?new kl(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?N2(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?N2(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=n4e.exec(e))?new kl(t[1],t[2],t[3],1):(t=a4e.exec(e))?new kl(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=o4e.exec(e))?N2(t[1],t[2],t[3],t[4]):(t=i4e.exec(e))?N2(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=s4e.exec(e))?R8(t[1],t[2]/100,t[3]/100,1):(t=l4e.exec(e))?R8(t[1],t[2]/100,t[3]/100,t[4]):k8.hasOwnProperty(e)?T8(k8[e]):e==="transparent"?new kl(NaN,NaN,NaN,0):null}function T8(e){return new kl(e>>16&255,e>>8&255,e&255,1)}function N2(e,t,r,n){return n<=0&&(e=t=r=NaN),new kl(e,t,r,n)}function u4e(e){return e instanceof Y1||(e=qb(e)),e?(e=e.rgb(),new kl(e.r,e.g,e.b,e.opacity)):new kl}function MO(e,t,r,n){return arguments.length===1?u4e(e):new kl(e,t,r,n??1)}function kl(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}XT(kl,MO,CX(Y1,{brighter(e){return e=e==null?FN:Math.pow(FN,e),new kl(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Fb:Math.pow(Fb,e),new kl(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new kl(Ap(this.r),Ap(this.g),Ap(this.b),BN(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:D8,formatHex:D8,formatHex8:f4e,formatRgb:M8,toString:M8}));function D8(){return`#${mp(this.r)}${mp(this.g)}${mp(this.b)}`}function f4e(){return`#${mp(this.r)}${mp(this.g)}${mp(this.b)}${mp((isNaN(this.opacity)?1:this.opacity)*255)}`}function M8(){const e=BN(this.opacity);return`${e===1?"rgb(":"rgba("}${Ap(this.r)}, ${Ap(this.g)}, ${Ap(this.b)}${e===1?")":`, ${e})`}`}function BN(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ap(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function mp(e){return e=Ap(e),(e<16?"0":"")+e.toString(16)}function R8(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Ld(e,t,r,n)}function PX(e){if(e instanceof Ld)return new Ld(e.h,e.s,e.l,e.opacity);if(e instanceof Y1||(e=qb(e)),!e)return new Ld;if(e instanceof Ld)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,l=i-a,c=(i+a)/2;return l?(t===i?s=(r-n)/l+(r<n)*6:r===i?s=(n-t)/l+2:s=(t-r)/l+4,l/=c<.5?i+a:2-i-a,s*=60):l=c>0&&c<1?0:s,new Ld(s,l,c,e.opacity)}function m4e(e,t,r,n){return arguments.length===1?PX(e):new Ld(e,t,r,n??1)}function Ld(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}XT(Ld,m4e,CX(Y1,{brighter(e){return e=e==null?FN:Math.pow(FN,e),new Ld(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Fb:Math.pow(Fb,e),new Ld(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new kl(oA(e>=240?e-240:e+120,a,n),oA(e,a,n),oA(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Ld(L8(this.h),_2(this.s),_2(this.l),BN(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=BN(this.opacity);return`${e===1?"hsl(":"hsla("}${L8(this.h)}, ${_2(this.s)*100}%, ${_2(this.l)*100}%${e===1?")":`, ${e})`}`}}));function L8(e){return e=(e||0)%360,e<0?e+360:e}function _2(e){return Math.max(0,Math.min(1,e||0))}function oA(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const JT=e=>()=>e;function h4e(e,t){return function(r){return e+r*t}}function p4e(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function g4e(e){return(e=+e)==1?AX:function(t,r){return r-t?p4e(t,r,e):JT(isNaN(t)?r:t)}}function AX(e,t){var r=t-e;return r?h4e(e,r):JT(isNaN(e)?t:e)}const $8=function e(t){var r=g4e(t);function n(a,i){var s=r((a=MO(a)).r,(i=MO(i)).r),l=r(a.g,i.g),c=r(a.b,i.b),d=AX(a.opacity,i.opacity);return function(u){return a.r=s(u),a.g=l(u),a.b=c(u),a.opacity=d(u),a+""}}return n.gamma=e,n}(1);function v4e(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function x4e(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function y4e(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=l0(e[s],t[s]);for(;s<r;++s)i[s]=t[s];return function(l){for(s=0;s<n;++s)i[s]=a[s](l);return i}}function b4e(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function qN(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function w4e(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=l0(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var RO=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,iA=new RegExp(RO.source,"g");function j4e(e){return function(){return e}}function N4e(e){return function(t){return e(t)+""}}function _4e(e,t){var r=RO.lastIndex=iA.lastIndex=0,n,a,i,s=-1,l=[],c=[];for(e=e+"",t=t+"";(n=RO.exec(e))&&(a=iA.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),l[s]?l[s]+=i:l[++s]=i),(n=n[0])===(a=a[0])?l[s]?l[s]+=a:l[++s]=a:(l[++s]=null,c.push({i:s,x:qN(n,a)})),r=iA.lastIndex;return r<t.length&&(i=t.slice(r),l[s]?l[s]+=i:l[++s]=i),l.length<2?c[0]?N4e(c[0].x):j4e(t):(t=c.length,function(d){for(var u=0,f;u<t;++u)l[(f=c[u]).i]=f.x(d);return l.join("")})}function l0(e,t){var r=typeof t,n;return t==null||r==="boolean"?JT(t):(r==="number"?qN:r==="string"?(n=qb(t))?(t=n,$8):_4e:t instanceof qb?$8:t instanceof Date?b4e:x4e(t)?v4e:Array.isArray(t)?y4e:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?w4e:qN)(e,t)}function QT(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function S4e(e,t){t===void 0&&(t=e,e=l0);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(s){var l=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[l](s-l)}}function C4e(e){return function(){return e}}function zN(e){return+e}var F8=[0,1];function fl(e){return e}function LO(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:C4e(isNaN(t)?NaN:.5)}function P4e(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function A4e(e,t,r){var n=e[0],a=e[1],i=t[0],s=t[1];return a<n?(n=LO(a,n),i=r(s,i)):(n=LO(n,a),i=r(i,s)),function(l){return i(n(l))}}function E4e(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)a[s]=LO(e[s],e[s+1]),i[s]=r(t[s],t[s+1]);return function(l){var c=K1(e,l,1,n)-1;return i[c](a[c](l))}}function X1(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function hC(){var e=F8,t=F8,r=l0,n,a,i,s=fl,l,c,d;function u(){var m=Math.min(e.length,t.length);return s!==fl&&(s=P4e(e[0],e[m-1])),l=m>2?E4e:A4e,c=d=null,f}function f(m){return m==null||isNaN(m=+m)?i:(c||(c=l(e.map(n),t,r)))(n(s(m)))}return f.invert=function(m){return s(a((d||(d=l(t,e.map(n),qN)))(m)))},f.domain=function(m){return arguments.length?(e=Array.from(m,zN),u()):e.slice()},f.range=function(m){return arguments.length?(t=Array.from(m),u()):t.slice()},f.rangeRound=function(m){return t=Array.from(m),r=QT,u()},f.clamp=function(m){return arguments.length?(s=m?!0:fl,u()):s!==fl},f.interpolate=function(m){return arguments.length?(r=m,u()):r},f.unknown=function(m){return arguments.length?(i=m,f):i},function(m,h){return n=m,a=h,u()}}function ZT(){return hC()(fl,fl)}function k4e(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function UN(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function mx(e){return e=UN(Math.abs(e)),e?e[1]:NaN}function O4e(e,t){return function(r,n){for(var a=r.length,i=[],s=0,l=e[0],c=0;a>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),i.push(r.substring(a-=l,a+l)),!((c+=l+1)>n));)l=e[s=(s+1)%e.length];return i.reverse().join(t)}}function I4e(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var T4e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function zb(e){if(!(t=T4e.exec(e)))throw new Error("invalid format: "+e);var t;return new eD({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}zb.prototype=eD.prototype;function eD(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}eD.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function D4e(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var EX;function M4e(e,t){var r=UN(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(EX=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+UN(e,Math.max(0,t+i-1))[0]}function B8(e,t){var r=UN(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const q8={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:k4e,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>B8(e*100,t),r:B8,s:M4e,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function z8(e){return e}var U8=Array.prototype.map,V8=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function R4e(e){var t=e.grouping===void 0||e.thousands===void 0?z8:O4e(U8.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?z8:I4e(U8.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function d(f){f=zb(f);var m=f.fill,h=f.align,v=f.sign,g=f.symbol,y=f.zero,x=f.width,b=f.comma,w=f.precision,j=f.trim,_=f.type;_==="n"?(b=!0,_="g"):q8[_]||(w===void 0&&(w=12),j=!0,_="g"),(y||m==="0"&&h==="=")&&(y=!0,m="0",h="=");var C=g==="$"?r:g==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",E=g==="$"?n:/[%p]/.test(_)?s:"",P=q8[_],k=/[defgprs%]/.test(_);w=w===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function M(S){var I=C,T=E,D,B,U;if(_==="c")T=P(S)+T,S="";else{S=+S;var z=S<0||1/S<0;if(S=isNaN(S)?c:P(Math.abs(S),w),j&&(S=D4e(S)),z&&+S==0&&v!=="+"&&(z=!1),I=(z?v==="("?v:l:v==="-"||v==="("?"":v)+I,T=(_==="s"?V8[8+EX/3]:"")+T+(z&&v==="("?")":""),k){for(D=-1,B=S.length;++D<B;)if(U=S.charCodeAt(D),48>U||U>57){T=(U===46?a+S.slice(D+1):S.slice(D))+T,S=S.slice(0,D);break}}}b&&!y&&(S=t(S,1/0));var $=I.length+S.length+T.length,Y=$<x?new Array(x-$+1).join(m):"";switch(b&&y&&(S=t(Y+S,Y.length?x-T.length:1/0),Y=""),h){case"<":S=I+S+T+Y;break;case"=":S=I+Y+S+T;break;case"^":S=Y.slice(0,$=Y.length>>1)+I+S+T+Y.slice($);break;default:S=Y+I+S+T;break}return i(S)}return M.toString=function(){return f+""},M}function u(f,m){var h=d((f=zb(f),f.type="f",f)),v=Math.max(-8,Math.min(8,Math.floor(mx(m)/3)))*3,g=Math.pow(10,-v),y=V8[8+v/3];return function(x){return h(g*x)+y}}return{format:d,formatPrefix:u}}var S2,tD,kX;L4e({thousands:",",grouping:[3],currency:["$",""]});function L4e(e){return S2=R4e(e),tD=S2.format,kX=S2.formatPrefix,S2}function $4e(e){return Math.max(0,-mx(Math.abs(e)))}function F4e(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(mx(t)/3)))*3-mx(Math.abs(e)))}function B4e(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,mx(t)-mx(e))+1}function OX(e,t,r,n){var a=TO(e,t,r),i;switch(n=zb(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=F4e(a,s))&&(n.precision=i),kX(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=B4e(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=$4e(a))&&(n.precision=i-(n.type==="%")*2);break}}return tD(n)}function _h(e){var t=e.domain;return e.ticks=function(r){var n=t();return OO(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return OX(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,s=n[a],l=n[i],c,d,u=10;for(l<s&&(d=s,s=l,l=d,d=a,a=i,i=d);u-- >0;){if(d=IO(s,l,r),d===c)return n[a]=s,n[i]=l,t(n);if(d>0)s=Math.floor(s/d)*d,l=Math.ceil(l/d)*d;else if(d<0)s=Math.ceil(s*d)/d,l=Math.floor(l*d)/d;else break;c=d}return e},e}function VN(){var e=ZT();return e.copy=function(){return X1(e,VN())},vd.apply(e,arguments),_h(e)}function IX(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,zN),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return IX(e).unknown(t)},e=arguments.length?Array.from(e,zN):[0,1],_h(r)}function TX(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),e[r]=t.floor(a),e[n]=t.ceil(i),e}function W8(e){return Math.log(e)}function H8(e){return Math.exp(e)}function q4e(e){return-Math.log(-e)}function z4e(e){return-Math.exp(-e)}function U4e(e){return isFinite(e)?+("1e"+e):e<0?0:e}function V4e(e){return e===10?U4e:e===Math.E?Math.exp:t=>Math.pow(e,t)}function W4e(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function G8(e){return(t,r)=>-e(-t,r)}function rD(e){const t=e(W8,H8),r=t.domain;let n=10,a,i;function s(){return a=W4e(n),i=V4e(n),r()[0]<0?(a=G8(a),i=G8(i),e(q4e,z4e)):e(W8,H8),t}return t.base=function(l){return arguments.length?(n=+l,s()):n},t.domain=function(l){return arguments.length?(r(l),s()):r()},t.ticks=l=>{const c=r();let d=c[0],u=c[c.length-1];const f=u<d;f&&([d,u]=[u,d]);let m=a(d),h=a(u),v,g;const y=l==null?10:+l;let x=[];if(!(n%1)&&h-m<y){if(m=Math.floor(m),h=Math.ceil(h),d>0){for(;m<=h;++m)for(v=1;v<n;++v)if(g=m<0?v/i(-m):v*i(m),!(g<d)){if(g>u)break;x.push(g)}}else for(;m<=h;++m)for(v=n-1;v>=1;--v)if(g=m>0?v/i(-m):v*i(m),!(g<d)){if(g>u)break;x.push(g)}x.length*2<y&&(x=OO(d,u,y))}else x=OO(m,h,Math.min(h-m,y)).map(i);return f?x.reverse():x},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=zb(c)).precision==null&&(c.trim=!0),c=tD(c)),l===1/0)return c;const d=Math.max(1,n*l/t.ticks().length);return u=>{let f=u/i(Math.round(a(u)));return f*n<n-.5&&(f*=n),f<=d?c(u):""}},t.nice=()=>r(TX(r(),{floor:l=>i(Math.floor(a(l))),ceil:l=>i(Math.ceil(a(l)))})),t}function DX(){const e=rD(hC()).domain([1,10]);return e.copy=()=>X1(e,DX()).base(e.base()),vd.apply(e,arguments),e}function K8(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Y8(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function nD(e){var t=1,r=e(K8(t),Y8(t));return r.constant=function(n){return arguments.length?e(K8(t=+n),Y8(t)):t},_h(r)}function MX(){var e=nD(hC());return e.copy=function(){return X1(e,MX()).constant(e.constant())},vd.apply(e,arguments)}function X8(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function H4e(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function G4e(e){return e<0?-e*e:e*e}function aD(e){var t=e(fl,fl),r=1;function n(){return r===1?e(fl,fl):r===.5?e(H4e,G4e):e(X8(r),X8(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},_h(t)}function oD(){var e=aD(hC());return e.copy=function(){return X1(e,oD()).exponent(e.exponent())},vd.apply(e,arguments),e}function K4e(){return oD.apply(null,arguments).exponent(.5)}function J8(e){return Math.sign(e)*e*e}function Y4e(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function RX(){var e=ZT(),t=[0,1],r=!1,n;function a(i){var s=Y4e(e(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return e.invert(J8(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,zN)).map(J8)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return RX(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},vd.apply(a,arguments),_h(a)}function LX(){var e=[],t=[],r=[],n;function a(){var s=0,l=Math.max(1,t.length);for(r=new Array(l-1);++s<l;)r[s-1]=e4e(e,s/l);return i}function i(s){return s==null||isNaN(s=+s)?n:t[K1(r,s)]}return i.invertExtent=function(s){var l=t.indexOf(s);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let l of s)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Km),a()},i.range=function(s){return arguments.length?(t=Array.from(s),a()):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return LX().domain(e).range(t).unknown(n)},vd.apply(i,arguments)}function $X(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function s(c){return c!=null&&c<=c?a[K1(n,c,0,r)]:i}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return s}return s.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},s.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,l()):a.slice()},s.invertExtent=function(c){var d=a.indexOf(c);return d<0?[NaN,NaN]:d<1?[e,n[0]]:d>=r?[n[r-1],t]:[n[d-1],n[d]]},s.unknown=function(c){return arguments.length&&(i=c),s},s.thresholds=function(){return n.slice()},s.copy=function(){return $X().domain([e,t]).range(a).unknown(i)},vd.apply(_h(s),arguments)}function FX(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[K1(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var s=t.indexOf(i);return[e[s-1],e[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return FX().domain(e).range(t).unknown(r)},vd.apply(a,arguments)}const sA=new Date,lA=new Date;function Yi(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const s=a(i),l=a.ceil(i);return i-s<l-i?s:l},a.offset=(i,s)=>(t(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,l)=>{const c=[];if(i=a.ceil(i),l=l==null?1:Math.floor(l),!(i<s)||!(l>0))return c;let d;do c.push(d=new Date(+i)),t(i,l),e(i);while(d<i&&i<s);return c},a.filter=i=>Yi(s=>{if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},(s,l)=>{if(s>=s)if(l<0)for(;++l<=0;)for(;t(s,-1),!i(s););else for(;--l>=0;)for(;t(s,1),!i(s););}),r&&(a.count=(i,s)=>(sA.setTime(+i),lA.setTime(+s),e(sA),e(lA),Math.floor(r(sA,lA))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const WN=Yi(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);WN.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Yi(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):WN);WN.range;const pf=1e3,rd=pf*60,gf=rd*60,Of=gf*24,iD=Of*7,Q8=Of*30,cA=Of*365,hp=Yi(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*pf)},(e,t)=>(t-e)/pf,e=>e.getUTCSeconds());hp.range;const sD=Yi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*pf)},(e,t)=>{e.setTime(+e+t*rd)},(e,t)=>(t-e)/rd,e=>e.getMinutes());sD.range;const lD=Yi(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*rd)},(e,t)=>(t-e)/rd,e=>e.getUTCMinutes());lD.range;const cD=Yi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*pf-e.getMinutes()*rd)},(e,t)=>{e.setTime(+e+t*gf)},(e,t)=>(t-e)/gf,e=>e.getHours());cD.range;const dD=Yi(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*gf)},(e,t)=>(t-e)/gf,e=>e.getUTCHours());dD.range;const J1=Yi(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*rd)/Of,e=>e.getDate()-1);J1.range;const pC=Yi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Of,e=>e.getUTCDate()-1);pC.range;const BX=Yi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Of,e=>Math.floor(e/Of));BX.range;function pg(e){return Yi(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*rd)/iD)}const gC=pg(0),HN=pg(1),X4e=pg(2),J4e=pg(3),hx=pg(4),Q4e=pg(5),Z4e=pg(6);gC.range;HN.range;X4e.range;J4e.range;hx.range;Q4e.range;Z4e.range;function gg(e){return Yi(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/iD)}const vC=gg(0),GN=gg(1),eIe=gg(2),tIe=gg(3),px=gg(4),rIe=gg(5),nIe=gg(6);vC.range;GN.range;eIe.range;tIe.range;px.range;rIe.range;nIe.range;const uD=Yi(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());uD.range;const fD=Yi(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());fD.range;const If=Yi(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());If.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Yi(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});If.range;const Tf=Yi(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Tf.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Yi(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Tf.range;function qX(e,t,r,n,a,i){const s=[[hp,1,pf],[hp,5,5*pf],[hp,15,15*pf],[hp,30,30*pf],[i,1,rd],[i,5,5*rd],[i,15,15*rd],[i,30,30*rd],[a,1,gf],[a,3,3*gf],[a,6,6*gf],[a,12,12*gf],[n,1,Of],[n,2,2*Of],[r,1,iD],[t,1,Q8],[t,3,3*Q8],[e,1,cA]];function l(d,u,f){const m=u<d;m&&([d,u]=[u,d]);const h=f&&typeof f.range=="function"?f:c(d,u,f),v=h?h.range(d,+u+1):[];return m?v.reverse():v}function c(d,u,f){const m=Math.abs(u-d)/f,h=KT(([,,y])=>y).right(s,m);if(h===s.length)return e.every(TO(d/cA,u/cA,f));if(h===0)return WN.every(Math.max(TO(d,u,f),1));const[v,g]=s[m/s[h-1][2]<s[h][2]/m?h-1:h];return v.every(g)}return[l,c]}const[aIe,oIe]=qX(Tf,fD,vC,BX,dD,lD),[iIe,sIe]=qX(If,uD,gC,J1,cD,sD);function dA(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function uA(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function V0(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function lIe(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,l=e.months,c=e.shortMonths,d=W0(a),u=H0(a),f=W0(i),m=H0(i),h=W0(s),v=H0(s),g=W0(l),y=H0(l),x=W0(c),b=H0(c),w={a:z,A:$,b:Y,B:de,c:null,d:aB,e:aB,f:OIe,g:qIe,G:UIe,H:AIe,I:EIe,j:kIe,L:zX,m:IIe,M:TIe,p:xe,q,Q:sB,s:lB,S:DIe,u:MIe,U:RIe,V:LIe,w:$Ie,W:FIe,x:null,X:null,y:BIe,Y:zIe,Z:VIe,"%":iB},j={a:L,A:W,b:ne,B:le,c:null,d:oB,e:oB,f:KIe,g:aTe,G:iTe,H:WIe,I:HIe,j:GIe,L:VX,m:YIe,M:XIe,p:K,q:Q,Q:sB,s:lB,S:JIe,u:QIe,U:ZIe,V:eTe,w:tTe,W:rTe,x:null,X:null,y:nTe,Y:oTe,Z:sTe,"%":iB},_={a:M,A:S,b:I,B:T,c:D,d:rB,e:rB,f:_Ie,g:tB,G:eB,H:nB,I:nB,j:bIe,L:NIe,m:yIe,M:wIe,p:k,q:xIe,Q:CIe,s:PIe,S:jIe,u:mIe,U:hIe,V:pIe,w:fIe,W:gIe,x:B,X:U,y:tB,Y:eB,Z:vIe,"%":SIe};w.x=C(r,w),w.X=C(n,w),w.c=C(t,w),j.x=C(r,j),j.X=C(n,j),j.c=C(t,j);function C(re,G){return function(me){var pe=[],Be=-1,Z=0,ee=re.length,kt,Nt,De;for(me instanceof Date||(me=new Date(+me));++Be<ee;)re.charCodeAt(Be)===37&&(pe.push(re.slice(Z,Be)),(Nt=Z8[kt=re.charAt(++Be)])!=null?kt=re.charAt(++Be):Nt=kt==="e"?" ":"0",(De=G[kt])&&(kt=De(me,Nt)),pe.push(kt),Z=Be+1);return pe.push(re.slice(Z,Be)),pe.join("")}}function E(re,G){return function(me){var pe=V0(1900,void 0,1),Be=P(pe,re,me+="",0),Z,ee;if(Be!=me.length)return null;if("Q"in pe)return new Date(pe.Q);if("s"in pe)return new Date(pe.s*1e3+("L"in pe?pe.L:0));if(G&&!("Z"in pe)&&(pe.Z=0),"p"in pe&&(pe.H=pe.H%12+pe.p*12),pe.m===void 0&&(pe.m="q"in pe?pe.q:0),"V"in pe){if(pe.V<1||pe.V>53)return null;"w"in pe||(pe.w=1),"Z"in pe?(Z=uA(V0(pe.y,0,1)),ee=Z.getUTCDay(),Z=ee>4||ee===0?GN.ceil(Z):GN(Z),Z=pC.offset(Z,(pe.V-1)*7),pe.y=Z.getUTCFullYear(),pe.m=Z.getUTCMonth(),pe.d=Z.getUTCDate()+(pe.w+6)%7):(Z=dA(V0(pe.y,0,1)),ee=Z.getDay(),Z=ee>4||ee===0?HN.ceil(Z):HN(Z),Z=J1.offset(Z,(pe.V-1)*7),pe.y=Z.getFullYear(),pe.m=Z.getMonth(),pe.d=Z.getDate()+(pe.w+6)%7)}else("W"in pe||"U"in pe)&&("w"in pe||(pe.w="u"in pe?pe.u%7:"W"in pe?1:0),ee="Z"in pe?uA(V0(pe.y,0,1)).getUTCDay():dA(V0(pe.y,0,1)).getDay(),pe.m=0,pe.d="W"in pe?(pe.w+6)%7+pe.W*7-(ee+5)%7:pe.w+pe.U*7-(ee+6)%7);return"Z"in pe?(pe.H+=pe.Z/100|0,pe.M+=pe.Z%100,uA(pe)):dA(pe)}}function P(re,G,me,pe){for(var Be=0,Z=G.length,ee=me.length,kt,Nt;Be<Z;){if(pe>=ee)return-1;if(kt=G.charCodeAt(Be++),kt===37){if(kt=G.charAt(Be++),Nt=_[kt in Z8?G.charAt(Be++):kt],!Nt||(pe=Nt(re,me,pe))<0)return-1}else if(kt!=me.charCodeAt(pe++))return-1}return pe}function k(re,G,me){var pe=d.exec(G.slice(me));return pe?(re.p=u.get(pe[0].toLowerCase()),me+pe[0].length):-1}function M(re,G,me){var pe=h.exec(G.slice(me));return pe?(re.w=v.get(pe[0].toLowerCase()),me+pe[0].length):-1}function S(re,G,me){var pe=f.exec(G.slice(me));return pe?(re.w=m.get(pe[0].toLowerCase()),me+pe[0].length):-1}function I(re,G,me){var pe=x.exec(G.slice(me));return pe?(re.m=b.get(pe[0].toLowerCase()),me+pe[0].length):-1}function T(re,G,me){var pe=g.exec(G.slice(me));return pe?(re.m=y.get(pe[0].toLowerCase()),me+pe[0].length):-1}function D(re,G,me){return P(re,t,G,me)}function B(re,G,me){return P(re,r,G,me)}function U(re,G,me){return P(re,n,G,me)}function z(re){return s[re.getDay()]}function $(re){return i[re.getDay()]}function Y(re){return c[re.getMonth()]}function de(re){return l[re.getMonth()]}function xe(re){return a[+(re.getHours()>=12)]}function q(re){return 1+~~(re.getMonth()/3)}function L(re){return s[re.getUTCDay()]}function W(re){return i[re.getUTCDay()]}function ne(re){return c[re.getUTCMonth()]}function le(re){return l[re.getUTCMonth()]}function K(re){return a[+(re.getUTCHours()>=12)]}function Q(re){return 1+~~(re.getUTCMonth()/3)}return{format:function(re){var G=C(re+="",w);return G.toString=function(){return re},G},parse:function(re){var G=E(re+="",!1);return G.toString=function(){return re},G},utcFormat:function(re){var G=C(re+="",j);return G.toString=function(){return re},G},utcParse:function(re){var G=E(re+="",!0);return G.toString=function(){return re},G}}}var Z8={"-":"",_:" ",0:"0"},cs=/^\s*\d+/,cIe=/^%/,dIe=/[\\^$*+?|[\]().{}]/g;function Wa(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function uIe(e){return e.replace(dIe,"\\$&")}function W0(e){return new RegExp("^(?:"+e.map(uIe).join("|")+")","i")}function H0(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function fIe(e,t,r){var n=cs.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function mIe(e,t,r){var n=cs.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function hIe(e,t,r){var n=cs.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function pIe(e,t,r){var n=cs.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function gIe(e,t,r){var n=cs.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function eB(e,t,r){var n=cs.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function tB(e,t,r){var n=cs.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function vIe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function xIe(e,t,r){var n=cs.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function yIe(e,t,r){var n=cs.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function rB(e,t,r){var n=cs.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function bIe(e,t,r){var n=cs.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function nB(e,t,r){var n=cs.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function wIe(e,t,r){var n=cs.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function jIe(e,t,r){var n=cs.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function NIe(e,t,r){var n=cs.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function _Ie(e,t,r){var n=cs.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function SIe(e,t,r){var n=cIe.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function CIe(e,t,r){var n=cs.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function PIe(e,t,r){var n=cs.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function aB(e,t){return Wa(e.getDate(),t,2)}function AIe(e,t){return Wa(e.getHours(),t,2)}function EIe(e,t){return Wa(e.getHours()%12||12,t,2)}function kIe(e,t){return Wa(1+J1.count(If(e),e),t,3)}function zX(e,t){return Wa(e.getMilliseconds(),t,3)}function OIe(e,t){return zX(e,t)+"000"}function IIe(e,t){return Wa(e.getMonth()+1,t,2)}function TIe(e,t){return Wa(e.getMinutes(),t,2)}function DIe(e,t){return Wa(e.getSeconds(),t,2)}function MIe(e){var t=e.getDay();return t===0?7:t}function RIe(e,t){return Wa(gC.count(If(e)-1,e),t,2)}function UX(e){var t=e.getDay();return t>=4||t===0?hx(e):hx.ceil(e)}function LIe(e,t){return e=UX(e),Wa(hx.count(If(e),e)+(If(e).getDay()===4),t,2)}function $Ie(e){return e.getDay()}function FIe(e,t){return Wa(HN.count(If(e)-1,e),t,2)}function BIe(e,t){return Wa(e.getFullYear()%100,t,2)}function qIe(e,t){return e=UX(e),Wa(e.getFullYear()%100,t,2)}function zIe(e,t){return Wa(e.getFullYear()%1e4,t,4)}function UIe(e,t){var r=e.getDay();return e=r>=4||r===0?hx(e):hx.ceil(e),Wa(e.getFullYear()%1e4,t,4)}function VIe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Wa(t/60|0,"0",2)+Wa(t%60,"0",2)}function oB(e,t){return Wa(e.getUTCDate(),t,2)}function WIe(e,t){return Wa(e.getUTCHours(),t,2)}function HIe(e,t){return Wa(e.getUTCHours()%12||12,t,2)}function GIe(e,t){return Wa(1+pC.count(Tf(e),e),t,3)}function VX(e,t){return Wa(e.getUTCMilliseconds(),t,3)}function KIe(e,t){return VX(e,t)+"000"}function YIe(e,t){return Wa(e.getUTCMonth()+1,t,2)}function XIe(e,t){return Wa(e.getUTCMinutes(),t,2)}function JIe(e,t){return Wa(e.getUTCSeconds(),t,2)}function QIe(e){var t=e.getUTCDay();return t===0?7:t}function ZIe(e,t){return Wa(vC.count(Tf(e)-1,e),t,2)}function WX(e){var t=e.getUTCDay();return t>=4||t===0?px(e):px.ceil(e)}function eTe(e,t){return e=WX(e),Wa(px.count(Tf(e),e)+(Tf(e).getUTCDay()===4),t,2)}function tTe(e){return e.getUTCDay()}function rTe(e,t){return Wa(GN.count(Tf(e)-1,e),t,2)}function nTe(e,t){return Wa(e.getUTCFullYear()%100,t,2)}function aTe(e,t){return e=WX(e),Wa(e.getUTCFullYear()%100,t,2)}function oTe(e,t){return Wa(e.getUTCFullYear()%1e4,t,4)}function iTe(e,t){var r=e.getUTCDay();return e=r>=4||r===0?px(e):px.ceil(e),Wa(e.getUTCFullYear()%1e4,t,4)}function sTe(){return"+0000"}function iB(){return"%"}function sB(e){return+e}function lB(e){return Math.floor(+e/1e3)}var $g,HX,GX;lTe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function lTe(e){return $g=lIe(e),HX=$g.format,$g.parse,GX=$g.utcFormat,$g.utcParse,$g}function cTe(e){return new Date(e)}function dTe(e){return e instanceof Date?+e:+new Date(+e)}function mD(e,t,r,n,a,i,s,l,c,d){var u=ZT(),f=u.invert,m=u.domain,h=d(".%L"),v=d(":%S"),g=d("%I:%M"),y=d("%I %p"),x=d("%a %d"),b=d("%b %d"),w=d("%B"),j=d("%Y");function _(C){return(c(C)<C?h:l(C)<C?v:s(C)<C?g:i(C)<C?y:n(C)<C?a(C)<C?x:b:r(C)<C?w:j)(C)}return u.invert=function(C){return new Date(f(C))},u.domain=function(C){return arguments.length?m(Array.from(C,dTe)):m().map(cTe)},u.ticks=function(C){var E=m();return e(E[0],E[E.length-1],C??10)},u.tickFormat=function(C,E){return E==null?_:d(E)},u.nice=function(C){var E=m();return(!C||typeof C.range!="function")&&(C=t(E[0],E[E.length-1],C??10)),C?m(TX(E,C)):u},u.copy=function(){return X1(u,mD(e,t,r,n,a,i,s,l,c,d))},u}function uTe(){return vd.apply(mD(iIe,sIe,If,uD,gC,J1,cD,sD,hp,HX).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function fTe(){return vd.apply(mD(aIe,oIe,Tf,fD,vC,pC,dD,lD,hp,GX).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function xC(){var e=0,t=1,r,n,a,i,s=fl,l=!1,c;function d(f){return f==null||isNaN(f=+f)?c:s(a===0?.5:(f=(i(f)-r)*a,l?Math.max(0,Math.min(1,f)):f))}d.domain=function(f){return arguments.length?([e,t]=f,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),d):[e,t]},d.clamp=function(f){return arguments.length?(l=!!f,d):l},d.interpolator=function(f){return arguments.length?(s=f,d):s};function u(f){return function(m){var h,v;return arguments.length?([h,v]=m,s=f(h,v),d):[s(0),s(1)]}}return d.range=u(l0),d.rangeRound=u(QT),d.unknown=function(f){return arguments.length?(c=f,d):c},function(f){return i=f,r=f(e),n=f(t),a=r===n?0:1/(n-r),d}}function Sh(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function KX(){var e=_h(xC()(fl));return e.copy=function(){return Sh(e,KX())},Uf.apply(e,arguments)}function YX(){var e=rD(xC()).domain([1,10]);return e.copy=function(){return Sh(e,YX()).base(e.base())},Uf.apply(e,arguments)}function XX(){var e=nD(xC());return e.copy=function(){return Sh(e,XX()).constant(e.constant())},Uf.apply(e,arguments)}function hD(){var e=aD(xC());return e.copy=function(){return Sh(e,hD()).exponent(e.exponent())},Uf.apply(e,arguments)}function mTe(){return hD.apply(null,arguments).exponent(.5)}function JX(){var e=[],t=fl;function r(n){if(n!=null&&!isNaN(n=+n))return t((K1(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Km),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>Z3e(e,i/n))},r.copy=function(){return JX(t).domain(e)},Uf.apply(r,arguments)}function yC(){var e=0,t=.5,r=1,n=1,a,i,s,l,c,d=fl,u,f=!1,m;function h(g){return isNaN(g=+g)?m:(g=.5+((g=+u(g))-i)*(n*g<n*i?l:c),d(f?Math.max(0,Math.min(1,g)):g))}h.domain=function(g){return arguments.length?([e,t,r]=g,a=u(e=+e),i=u(t=+t),s=u(r=+r),l=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,h):[e,t,r]},h.clamp=function(g){return arguments.length?(f=!!g,h):f},h.interpolator=function(g){return arguments.length?(d=g,h):d};function v(g){return function(y){var x,b,w;return arguments.length?([x,b,w]=y,d=S4e(g,[x,b,w]),h):[d(0),d(.5),d(1)]}}return h.range=v(l0),h.rangeRound=v(QT),h.unknown=function(g){return arguments.length?(m=g,h):m},function(g){return u=g,a=g(e),i=g(t),s=g(r),l=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,h}}function QX(){var e=_h(yC()(fl));return e.copy=function(){return Sh(e,QX())},Uf.apply(e,arguments)}function ZX(){var e=rD(yC()).domain([.1,1,10]);return e.copy=function(){return Sh(e,ZX()).base(e.base())},Uf.apply(e,arguments)}function eJ(){var e=nD(yC());return e.copy=function(){return Sh(e,eJ()).constant(e.constant())},Uf.apply(e,arguments)}function pD(){var e=aD(yC());return e.copy=function(){return Sh(e,pD()).exponent(e.exponent())},Uf.apply(e,arguments)}function hTe(){return pD.apply(null,arguments).exponent(.5)}const cB=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:$b,scaleDiverging:QX,scaleDivergingLog:ZX,scaleDivergingPow:pD,scaleDivergingSqrt:hTe,scaleDivergingSymlog:eJ,scaleIdentity:IX,scaleImplicit:DO,scaleLinear:VN,scaleLog:DX,scaleOrdinal:YT,scalePoint:Ly,scalePow:oD,scaleQuantile:LX,scaleQuantize:$X,scaleRadial:RX,scaleSequential:KX,scaleSequentialLog:YX,scaleSequentialPow:hD,scaleSequentialQuantile:JX,scaleSequentialSqrt:mTe,scaleSequentialSymlog:XX,scaleSqrt:K4e,scaleSymlog:MX,scaleThreshold:FX,scaleTime:uTe,scaleUtc:fTe,tickFormat:OX},Symbol.toStringTag,{value:"Module"}));var pTe=Zx;function gTe(e,t,r){for(var n=-1,a=e.length;++n<a;){var i=e[n],s=t(i);if(s!=null&&(l===void 0?s===s&&!pTe(s):r(s,l)))var l=s,c=i}return c}var bC=gTe;function vTe(e,t){return e>t}var tJ=vTe,xTe=bC,yTe=tJ,bTe=s0;function wTe(e){return e&&e.length?xTe(e,bTe,yTe):void 0}var jTe=wTe;const Am=qa(jTe);function NTe(e,t){return e<t}var rJ=NTe,_Te=bC,STe=rJ,CTe=s0;function PTe(e){return e&&e.length?_Te(e,CTe,STe):void 0}var ATe=PTe;const wC=qa(ATe);var ETe=ET,kTe=Uu,OTe=dX,ITe=Bl;function TTe(e,t){var r=ITe(e)?ETe:OTe;return r(e,kTe(t))}var DTe=TTe,MTe=lX,RTe=DTe;function LTe(e,t){return MTe(RTe(e,t),1)}var $Te=LTe;const FTe=qa($Te);var BTe=VT;function qTe(e,t){return BTe(e,t)}var zTe=qTe;const Yp=qa(zTe);var c0=1e9,UTe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},vD,zo=!0,md="[DecimalError] ",Ep=md+"Invalid argument: ",gD=md+"Exponent out of range: ",d0=Math.floor,Zh=Math.pow,VTe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,lc,ts=1e7,Oo=7,nJ=9007199254740991,KN=d0(nJ/Oo),fn={};fn.absoluteValue=fn.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};fn.comparedTo=fn.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};fn.decimalPlaces=fn.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Oo;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};fn.dividedBy=fn.div=function(e){return Nf(this,new this.constructor(e))};fn.dividedToIntegerBy=fn.idiv=function(e){var t=this,r=t.constructor;return po(Nf(t,new r(e),0,1),r.precision)};fn.equals=fn.eq=function(e){return!this.cmp(e)};fn.exponent=function(){return ki(this)};fn.greaterThan=fn.gt=function(e){return this.cmp(e)>0};fn.greaterThanOrEqualTo=fn.gte=function(e){return this.cmp(e)>=0};fn.isInteger=fn.isint=function(){return this.e>this.d.length-2};fn.isNegative=fn.isneg=function(){return this.s<0};fn.isPositive=fn.ispos=function(){return this.s>0};fn.isZero=function(){return this.s===0};fn.lessThan=fn.lt=function(e){return this.cmp(e)<0};fn.lessThanOrEqualTo=fn.lte=function(e){return this.cmp(e)<1};fn.logarithm=fn.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(lc))throw Error(md+"NaN");if(r.s<1)throw Error(md+(r.s?"NaN":"-Infinity"));return r.eq(lc)?new n(0):(zo=!1,t=Nf(Ub(r,i),Ub(e,i),i),zo=!0,po(t,a))};fn.minus=fn.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?iJ(t,e):aJ(t,(e.s=-e.s,e))};fn.modulo=fn.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(md+"NaN");return r.s?(zo=!1,t=Nf(r,e,0,1).times(e),zo=!0,r.minus(t)):po(new n(r),a)};fn.naturalExponential=fn.exp=function(){return oJ(this)};fn.naturalLogarithm=fn.ln=function(){return Ub(this)};fn.negated=fn.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};fn.plus=fn.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?aJ(t,e):iJ(t,(e.s=-e.s,e))};fn.precision=fn.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Ep+e);if(t=ki(a)+1,n=a.d.length-1,r=n*Oo+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};fn.squareRoot=fn.sqrt=function(){var e,t,r,n,a,i,s,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(md+"NaN")}for(e=ki(l),zo=!1,a=Math.sqrt(+l),a==0||a==1/0?(t=_u(l.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=d0((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(a.toString()),r=c.precision,a=s=r+3;;)if(i=n,n=i.plus(Nf(l,i,s+2)).times(.5),_u(i.d).slice(0,s)===(t=_u(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),a==s&&t=="4999"){if(po(i,r+1,0),i.times(i).eq(l)){n=i;break}}else if(t!="9999")break;s+=4}return zo=!0,po(n,r)};fn.times=fn.mul=function(e){var t,r,n,a,i,s,l,c,d,u=this,f=u.constructor,m=u.d,h=(e=new f(e)).d;if(!u.s||!e.s)return new f(0);for(e.s*=u.s,r=u.e+e.e,c=m.length,d=h.length,c<d&&(i=m,m=h,h=i,s=c,c=d,d=s),i=[],s=c+d,n=s;n--;)i.push(0);for(n=d;--n>=0;){for(t=0,a=c+n;a>n;)l=i[a]+h[n]*m[a-n-1]+t,i[a--]=l%ts|0,t=l/ts|0;i[a]=(i[a]+t)%ts|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,zo?po(e,f.precision):e};fn.toDecimalPlaces=fn.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:($u(e,0,c0),t===void 0?t=n.rounding:$u(t,0,8),po(r,e+ki(r)+1,t))};fn.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=Xp(n,!0):($u(e,0,c0),t===void 0?t=a.rounding:$u(t,0,8),n=po(new a(n),e+1,t),r=Xp(n,!0,e+1)),r};fn.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?Xp(a):($u(e,0,c0),t===void 0?t=i.rounding:$u(t,0,8),n=po(new i(a),e+ki(a)+1,t),r=Xp(n.abs(),!1,e+ki(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};fn.toInteger=fn.toint=function(){var e=this,t=e.constructor;return po(new t(e),ki(e)+1,t.rounding)};fn.toNumber=function(){return+this};fn.toPower=fn.pow=function(e){var t,r,n,a,i,s,l=this,c=l.constructor,d=12,u=+(e=new c(e));if(!e.s)return new c(lc);if(l=new c(l),!l.s){if(e.s<1)throw Error(md+"Infinity");return l}if(l.eq(lc))return l;if(n=c.precision,e.eq(lc))return po(l,n);if(t=e.e,r=e.d.length-1,s=t>=r,i=l.s,s){if((r=u<0?-u:u)<=nJ){for(a=new c(lc),t=Math.ceil(n/Oo+4),zo=!1;r%2&&(a=a.times(l),uB(a.d,t)),r=d0(r/2),r!==0;)l=l.times(l),uB(l.d,t);return zo=!0,e.s<0?new c(lc).div(a):po(a,n)}}else if(i<0)throw Error(md+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,zo=!1,a=e.times(Ub(l,n+d)),zo=!0,a=oJ(a),a.s=i,a};fn.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=ki(a),n=Xp(a,r<=i.toExpNeg||r>=i.toExpPos)):($u(e,1,c0),t===void 0?t=i.rounding:$u(t,0,8),a=po(new i(a),e,t),r=ki(a),n=Xp(a,e<=r||r<=i.toExpNeg,e)),n};fn.toSignificantDigits=fn.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):($u(e,1,c0),t===void 0?t=n.rounding:$u(t,0,8)),po(new n(r),e,t)};fn.toString=fn.valueOf=fn.val=fn.toJSON=fn[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=ki(e),r=e.constructor;return Xp(e,t<=r.toExpNeg||t>=r.toExpPos)};function aJ(e,t){var r,n,a,i,s,l,c,d,u=e.constructor,f=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),zo?po(t,f):t;if(c=e.d,d=t.d,s=e.e,a=t.e,c=c.slice(),i=s-a,i){for(i<0?(n=c,i=-i,l=d.length):(n=d,a=s,l=c.length),s=Math.ceil(f/Oo),l=s>l?s+1:l+1,i>l&&(i=l,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(l=c.length,i=d.length,l-i<0&&(i=l,n=d,d=c,c=n),r=0;i;)r=(c[--i]=c[i]+d[i]+r)/ts|0,c[i]%=ts;for(r&&(c.unshift(r),++a),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=a,zo?po(t,f):t}function $u(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Ep+e)}function _u(e){var t,r,n,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,t=1;t<a;t++)n=e[t]+"",r=Oo-n.length,r&&(i+=gm(r)),i+=n;s=e[t],n=s+"",r=Oo-n.length,r&&(i+=gm(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var Nf=function(){function e(n,a){var i,s=0,l=n.length;for(n=n.slice();l--;)i=n[l]*a+s,n[l]=i%ts|0,s=i/ts|0;return s&&n.unshift(s),n}function t(n,a,i,s){var l,c;if(i!=s)c=i>s?1:-1;else for(l=c=0;l<i;l++)if(n[l]!=a[l]){c=n[l]>a[l]?1:-1;break}return c}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*ts+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var l,c,d,u,f,m,h,v,g,y,x,b,w,j,_,C,E,P,k=n.constructor,M=n.s==a.s?1:-1,S=n.d,I=a.d;if(!n.s)return new k(n);if(!a.s)throw Error(md+"Division by zero");for(c=n.e-a.e,E=I.length,_=S.length,h=new k(M),v=h.d=[],d=0;I[d]==(S[d]||0);)++d;if(I[d]>(S[d]||0)&&--c,i==null?b=i=k.precision:s?b=i+(ki(n)-ki(a))+1:b=i,b<0)return new k(0);if(b=b/Oo+2|0,d=0,E==1)for(u=0,I=I[0],b++;(d<_||u)&&b--;d++)w=u*ts+(S[d]||0),v[d]=w/I|0,u=w%I|0;else{for(u=ts/(I[0]+1)|0,u>1&&(I=e(I,u),S=e(S,u),E=I.length,_=S.length),j=E,g=S.slice(0,E),y=g.length;y<E;)g[y++]=0;P=I.slice(),P.unshift(0),C=I[0],I[1]>=ts/2&&++C;do u=0,l=t(I,g,E,y),l<0?(x=g[0],E!=y&&(x=x*ts+(g[1]||0)),u=x/C|0,u>1?(u>=ts&&(u=ts-1),f=e(I,u),m=f.length,y=g.length,l=t(f,g,m,y),l==1&&(u--,r(f,E<m?P:I,m))):(u==0&&(l=u=1),f=I.slice()),m=f.length,m<y&&f.unshift(0),r(g,f,y),l==-1&&(y=g.length,l=t(I,g,E,y),l<1&&(u++,r(g,E<y?P:I,y))),y=g.length):l===0&&(u++,g=[0]),v[d++]=u,l&&g[0]?g[y++]=S[j]||0:(g=[S[j]],y=1);while((j++<_||g[0]!==void 0)&&b--)}return v[0]||v.shift(),h.e=c,po(h,s?i+ki(h)+1:i)}}();function oJ(e,t){var r,n,a,i,s,l,c=0,d=0,u=e.constructor,f=u.precision;if(ki(e)>16)throw Error(gD+ki(e));if(!e.s)return new u(lc);for(t==null?(zo=!1,l=f):l=t,s=new u(.03125);e.abs().gte(.1);)e=e.times(s),d+=5;for(n=Math.log(Zh(2,d))/Math.LN10*2+5|0,l+=n,r=a=i=new u(lc),u.precision=l;;){if(a=po(a.times(e),l),r=r.times(++c),s=i.plus(Nf(a,r,l)),_u(s.d).slice(0,l)===_u(i.d).slice(0,l)){for(;d--;)i=po(i.times(i),l);return u.precision=f,t==null?(zo=!0,po(i,f)):i}i=s}}function ki(e){for(var t=e.e*Oo,r=e.d[0];r>=10;r/=10)t++;return t}function fA(e,t,r){if(t>e.LN10.sd())throw zo=!0,r&&(e.precision=r),Error(md+"LN10 precision limit exceeded");return po(new e(e.LN10),t)}function gm(e){for(var t="";e--;)t+="0";return t}function Ub(e,t){var r,n,a,i,s,l,c,d,u,f=1,m=10,h=e,v=h.d,g=h.constructor,y=g.precision;if(h.s<1)throw Error(md+(h.s?"NaN":"-Infinity"));if(h.eq(lc))return new g(0);if(t==null?(zo=!1,d=y):d=t,h.eq(10))return t==null&&(zo=!0),fA(g,d);if(d+=m,g.precision=d,r=_u(v),n=r.charAt(0),i=ki(h),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)h=h.times(e),r=_u(h.d),n=r.charAt(0),f++;i=ki(h),n>1?(h=new g("0."+r),i++):h=new g(n+"."+r.slice(1))}else return c=fA(g,d+2,y).times(i+""),h=Ub(new g(n+"."+r.slice(1)),d-m).plus(c),g.precision=y,t==null?(zo=!0,po(h,y)):h;for(l=s=h=Nf(h.minus(lc),h.plus(lc),d),u=po(h.times(h),d),a=3;;){if(s=po(s.times(u),d),c=l.plus(Nf(s,new g(a),d)),_u(c.d).slice(0,d)===_u(l.d).slice(0,d))return l=l.times(2),i!==0&&(l=l.plus(fA(g,d+2,y).times(i+""))),l=Nf(l,new g(f),d),g.precision=y,t==null?(zo=!0,po(l,y)):l;l=c,a+=2}}function dB(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=d0(r/Oo),e.d=[],n=(r+1)%Oo,r<0&&(n+=Oo),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=Oo;n<a;)e.d.push(+t.slice(n,n+=Oo));t=t.slice(n),n=Oo-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),zo&&(e.e>KN||e.e<-KN))throw Error(gD+r)}else e.s=0,e.e=0,e.d=[0];return e}function po(e,t,r){var n,a,i,s,l,c,d,u,f=e.d;for(s=1,i=f[0];i>=10;i/=10)s++;if(n=t-s,n<0)n+=Oo,a=t,d=f[u=0];else{if(u=Math.ceil((n+1)/Oo),i=f.length,u>=i)return e;for(d=i=f[u],s=1;i>=10;i/=10)s++;n%=Oo,a=n-Oo+s}if(r!==void 0&&(i=Zh(10,s-a-1),l=d/i%10|0,c=t<0||f[u+1]!==void 0||d%i,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?a>0?d/Zh(10,s-a):0:f[u-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(i=ki(e),f.length=1,t=t-i-1,f[0]=Zh(10,(Oo-t%Oo)%Oo),e.e=d0(-t/Oo)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=u,i=1,u--):(f.length=u+1,i=Zh(10,Oo-n),f[u]=a>0?(d/Zh(10,s-a)%Zh(10,a)|0)*i:0),c)for(;;)if(u==0){(f[0]+=i)==ts&&(f[0]=1,++e.e);break}else{if(f[u]+=i,f[u]!=ts)break;f[u--]=0,i=1}for(n=f.length;f[--n]===0;)f.pop();if(zo&&(e.e>KN||e.e<-KN))throw Error(gD+ki(e));return e}function iJ(e,t){var r,n,a,i,s,l,c,d,u,f,m=e.constructor,h=m.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new m(e),zo?po(t,h):t;if(c=e.d,f=t.d,n=t.e,d=e.e,c=c.slice(),s=d-n,s){for(u=s<0,u?(r=c,s=-s,l=f.length):(r=f,n=d,l=c.length),a=Math.max(Math.ceil(h/Oo),l)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=c.length,l=f.length,u=a<l,u&&(l=a),a=0;a<l;a++)if(c[a]!=f[a]){u=c[a]<f[a];break}s=0}for(u&&(r=c,c=f,f=r,t.s=-t.s),l=c.length,a=f.length-l;a>0;--a)c[l++]=0;for(a=f.length;a>s;){if(c[--a]<f[a]){for(i=a;i&&c[--i]===0;)c[i]=ts-1;--c[i],c[a]+=ts}c[a]-=f[a]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,zo?po(t,h):t):new m(0)}function Xp(e,t,r){var n,a=ki(e),i=_u(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+gm(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+gm(-a-1)+i,r&&(n=r-s)>0&&(i+=gm(n))):a>=s?(i+=gm(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+gm(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=gm(n))),e.s<0?"-"+i:i}function uB(e,t){if(e.length>t)return e.length=t,!0}function sJ(e){var t,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Ep+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return dB(s,i.toString())}else if(typeof i!="string")throw Error(Ep+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,VTe.test(i))dB(s,i);else throw Error(Ep+i)}if(a.prototype=fn,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=sJ,a.config=a.set=WTe,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function WTe(e){if(!e||typeof e!="object")throw Error(md+"Object expected");var t,r,n,a=["precision",1,c0,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(d0(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Ep+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Ep+r+": "+n);return this}var vD=sJ(UTe);lc=new vD(1);const uo=vD;function HTe(e){return XTe(e)||YTe(e)||KTe(e)||GTe()}function GTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KTe(e,t){if(e){if(typeof e=="string")return $O(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $O(e,t)}}function YTe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function XTe(e){if(Array.isArray(e))return $O(e)}function $O(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var JTe=function(t){return t},lJ={"@@functional/placeholder":!0},cJ=function(t){return t===lJ},fB=function(t){return function r(){return arguments.length===0||arguments.length===1&&cJ(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},QTe=function e(t,r){return t===1?r:fB(function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var s=a.filter(function(l){return l!==lJ}).length;return s>=t?r.apply(void 0,a):e(t-s,fB(function(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];var u=a.map(function(f){return cJ(f)?c.shift():f});return r.apply(void 0,HTe(u).concat(c))}))})},jC=function(t){return QTe(t.length,t)},FO=function(t,r){for(var n=[],a=t;a<r;++a)n[a-t]=a;return n},ZTe=jC(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),eDe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return JTe;var a=r.reverse(),i=a[0],s=a.slice(1);return function(){return s.reduce(function(l,c){return c(l)},i.apply(void 0,arguments))}},BO=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},dJ=function(t){var r=null,n=null;return function(){for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return r&&i.every(function(l,c){return l===r[c]})||(r=i,n=t.apply(void 0,i)),n}};function tDe(e){var t;return e===0?t=1:t=Math.floor(new uo(e).abs().log(10).toNumber())+1,t}function rDe(e,t,r){for(var n=new uo(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}var nDe=jC(function(e,t,r){var n=+e,a=+t;return n+r*(a-n)}),aDe=jC(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),oDe=jC(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const NC={rangeStep:rDe,getDigitCount:tDe,interpolateNumber:nDe,uninterpolateNumber:aDe,uninterpolateTruncation:oDe};function qO(e){return lDe(e)||sDe(e)||uJ(e)||iDe()}function iDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sDe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function lDe(e){if(Array.isArray(e))return zO(e)}function Vb(e,t){return uDe(e)||dDe(e,t)||uJ(e,t)||cDe()}function cDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uJ(e,t){if(e){if(typeof e=="string")return zO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zO(e,t)}}function zO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function dDe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,a=!1,i=void 0;try{for(var s=e[Symbol.iterator](),l;!(n=(l=s.next()).done)&&(r.push(l.value),!(t&&r.length===t));n=!0);}catch(c){a=!0,i=c}finally{try{!n&&s.return!=null&&s.return()}finally{if(a)throw i}}return r}}function uDe(e){if(Array.isArray(e))return e}function fJ(e){var t=Vb(e,2),r=t[0],n=t[1],a=r,i=n;return r>n&&(a=n,i=r),[a,i]}function mJ(e,t,r){if(e.lte(0))return new uo(0);var n=NC.getDigitCount(e.toNumber()),a=new uo(10).pow(n),i=e.div(a),s=n!==1?.05:.1,l=new uo(Math.ceil(i.div(s).toNumber())).add(r).mul(s),c=l.mul(a);return t?c:new uo(Math.ceil(c))}function fDe(e,t,r){var n=1,a=new uo(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new uo(10).pow(NC.getDigitCount(e)-1),a=new uo(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new uo(Math.floor(e)))}else e===0?a=new uo(Math.floor((t-1)/2)):r||(a=new uo(Math.floor(e)));var s=Math.floor((t-1)/2),l=eDe(ZTe(function(c){return a.add(new uo(c-s).mul(n)).toNumber()}),FO);return l(0,t)}function hJ(e,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new uo(0),tickMin:new uo(0),tickMax:new uo(0)};var i=mJ(new uo(t).sub(e).div(r-1),n,a),s;e<=0&&t>=0?s=new uo(0):(s=new uo(e).add(t).div(2),s=s.sub(new uo(s).mod(i)));var l=Math.ceil(s.sub(e).div(i).toNumber()),c=Math.ceil(new uo(t).sub(s).div(i).toNumber()),d=l+c+1;return d>r?hJ(e,t,r,n,a+1):(d<r&&(c=t>0?c+(r-d):c,l=t>0?l:l+(r-d)),{step:i,tickMin:s.sub(new uo(l).mul(i)),tickMax:s.add(new uo(c).mul(i))})}function mDe(e){var t=Vb(e,2),r=t[0],n=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=Math.max(a,2),l=fJ([r,n]),c=Vb(l,2),d=c[0],u=c[1];if(d===-1/0||u===1/0){var f=u===1/0?[d].concat(qO(FO(0,a-1).map(function(){return 1/0}))):[].concat(qO(FO(0,a-1).map(function(){return-1/0})),[u]);return r>n?BO(f):f}if(d===u)return fDe(d,a,i);var m=hJ(d,u,s,i),h=m.step,v=m.tickMin,g=m.tickMax,y=NC.rangeStep(v,g.add(new uo(.1).mul(h)),h);return r>n?BO(y):y}function hDe(e,t){var r=Vb(e,2),n=r[0],a=r[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=fJ([n,a]),l=Vb(s,2),c=l[0],d=l[1];if(c===-1/0||d===1/0)return[n,a];if(c===d)return[c];var u=Math.max(t,2),f=mJ(new uo(d).sub(c).div(u-1),i,0),m=[].concat(qO(NC.rangeStep(new uo(c),new uo(d).sub(new uo(.99).mul(f)),f)),[d]);return n>a?BO(m):m}var pDe=dJ(mDe),gDe=dJ(hDe),vDe=!0,mA="Invariant failed";function uh(e,t){if(!e){if(vDe)throw new Error(mA);var r=typeof t=="function"?t():t,n=r?"".concat(mA,": ").concat(r):mA;throw new Error(n)}}var xDe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function gx(e){"@babel/helpers - typeof";return gx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gx(e)}function YN(){return YN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},YN.apply(this,arguments)}function yDe(e,t){return NDe(e)||jDe(e,t)||wDe(e,t)||bDe()}function bDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wDe(e,t){if(e){if(typeof e=="string")return mB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mB(e,t)}}function mB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function NDe(e){if(Array.isArray(e))return e}function _De(e,t){if(e==null)return{};var r=SDe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function SDe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function CDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vJ(n.key),n)}}function PDe(e,t,r){return t&&hB(e.prototype,t),r&&hB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ADe(e,t,r){return t=XN(t),EDe(e,pJ()?Reflect.construct(t,r||[],XN(e).constructor):t.apply(e,r))}function EDe(e,t){if(t&&(gx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kDe(e)}function kDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pJ=function(){return!!e})()}function XN(e){return XN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},XN(e)}function ODe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UO(e,t)}function UO(e,t){return UO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},UO(e,t)}function gJ(e,t,r){return t=vJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vJ(e){var t=IDe(e,"string");return gx(t)=="symbol"?t:t+""}function IDe(e,t){if(gx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(gx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Q1=function(e){function t(){return CDe(this,t),ADe(this,t,arguments)}return ODe(t,e),PDe(t,[{key:"render",value:function(){var n=this.props,a=n.offset,i=n.layout,s=n.width,l=n.dataKey,c=n.data,d=n.dataPointFormatter,u=n.xAxis,f=n.yAxis,m=_De(n,xDe),h=On(m,!1);this.props.direction==="x"&&u.type!=="number"&&uh(!1);var v=c.map(function(g){var y=d(g,l),x=y.x,b=y.y,w=y.value,j=y.errorVal;if(!j)return null;var _=[],C,E;if(Array.isArray(j)){var P=yDe(j,2);C=P[0],E=P[1]}else C=E=j;if(i==="vertical"){var k=u.scale,M=b+a,S=M+s,I=M-s,T=k(w-C),D=k(w+E);_.push({x1:D,y1:S,x2:D,y2:I}),_.push({x1:T,y1:M,x2:D,y2:M}),_.push({x1:T,y1:S,x2:T,y2:I})}else if(i==="horizontal"){var B=f.scale,U=x+a,z=U-s,$=U+s,Y=B(w-C),de=B(w+E);_.push({x1:z,y1:de,x2:$,y2:de}),_.push({x1:U,y1:Y,x2:U,y2:de}),_.push({x1:z,y1:Y,x2:$,y2:Y})}return ye.createElement(Na,YN({className:"recharts-errorBar",key:"bar-".concat(_.map(function(xe){return"".concat(xe.x1,"-").concat(xe.x2,"-").concat(xe.y1,"-").concat(xe.y2)}))},h),_.map(function(xe){return ye.createElement("line",YN({},xe,{key:"line-".concat(xe.x1,"-").concat(xe.x2,"-").concat(xe.y1,"-").concat(xe.y2)}))}))});return ye.createElement(Na,{className:"recharts-errorBars"},v)}}])}(ye.Component);gJ(Q1,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});gJ(Q1,"displayName","ErrorBar");function Wb(e){"@babel/helpers - typeof";return Wb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wb(e)}function pB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Fh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pB(Object(r),!0).forEach(function(n){TDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function TDe(e,t,r){return t=DDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DDe(e){var t=MDe(e,"string");return Wb(t)=="symbol"?t:t+""}function MDe(e,t){if(Wb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Wb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xJ=function(t){var r=t.children,n=t.formattedGraphicalItems,a=t.legendWidth,i=t.legendContent,s=ac(r,Pp);if(!s)return null;var l=Pp.defaultProps,c=l!==void 0?Fh(Fh({},l),s.props):{},d;return s.props&&s.props.payload?d=s.props&&s.props.payload:i==="children"?d=(n||[]).reduce(function(u,f){var m=f.item,h=f.props,v=h.sectors||h.data||[];return u.concat(v.map(function(g){return{type:s.props.iconType||m.props.legendType,value:g.name,color:g.fill,payload:g}}))},[]):d=(n||[]).map(function(u){var f=u.item,m=f.type.defaultProps,h=m!==void 0?Fh(Fh({},m),f.props):{},v=h.dataKey,g=h.name,y=h.legendType,x=h.hide;return{inactive:x,dataKey:v,type:c.iconType||y||"square",color:xD(f),value:g||v,payload:h}}),Fh(Fh(Fh({},c),Pp.getWithHeight(s,a)),{},{payload:d,item:s})};function Hb(e){"@babel/helpers - typeof";return Hb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hb(e)}function gB(e){return FDe(e)||$De(e)||LDe(e)||RDe()}function RDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LDe(e,t){if(e){if(typeof e=="string")return VO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VO(e,t)}}function $De(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function FDe(e){if(Array.isArray(e))return VO(e)}function VO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ai(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vB(Object(r),!0).forEach(function(n){Fv(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Fv(e,t,r){return t=BDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BDe(e){var t=qDe(e,"string");return Hb(t)=="symbol"?t:t+""}function qDe(e,t){if(Hb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Hb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gi(e,t,r){return Qn(e)||Qn(t)?r:Gi(t)?pc(e,t,r):Vn(t)?t(e):r}function $y(e,t,r,n){var a=FTe(e,function(l){return gi(l,t)});if(r==="number"){var i=a.filter(function(l){return Mr(l)||parseFloat(l)});return i.length?[wC(i),Am(i)]:[1/0,-1/0]}var s=n?a.filter(function(l){return!Qn(l)}):a;return s.map(function(l){return Gi(l)||l instanceof Date?l:""})}var zDe=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,s=-1,l=(r=n?.length)!==null&&r!==void 0?r:0;if(l<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var c=i.range,d=0;d<l;d++){var u=d>0?a[d-1].coordinate:a[l-1].coordinate,f=a[d].coordinate,m=d>=l-1?a[0].coordinate:a[d+1].coordinate,h=void 0;if(dl(f-u)!==dl(m-f)){var v=[];if(dl(m-f)===dl(c[1]-c[0])){h=m;var g=f+c[1]-c[0];v[0]=Math.min(g,(g+u)/2),v[1]=Math.max(g,(g+u)/2)}else{h=u;var y=m+c[1]-c[0];v[0]=Math.min(f,(y+f)/2),v[1]=Math.max(f,(y+f)/2)}var x=[Math.min(f,(h+f)/2),Math.max(f,(h+f)/2)];if(t>x[0]&&t<=x[1]||t>=v[0]&&t<=v[1]){s=a[d].index;break}}else{var b=Math.min(u,m),w=Math.max(u,m);if(t>(b+f)/2&&t<=(w+f)/2){s=a[d].index;break}}}else for(var j=0;j<l;j++)if(j===0&&t<=(n[j].coordinate+n[j+1].coordinate)/2||j>0&&j<l-1&&t>(n[j].coordinate+n[j-1].coordinate)/2&&t<=(n[j].coordinate+n[j+1].coordinate)/2||j===l-1&&t>(n[j].coordinate+n[j-1].coordinate)/2){s=n[j].index;break}return s},xD=function(t){var r,n=t,a=n.type.displayName,i=(r=t.type)!==null&&r!==void 0&&r.defaultProps?ai(ai({},t.type.defaultProps),t.props):t.props,s=i.stroke,l=i.fill,c;switch(a){case"Line":c=s;break;case"Area":case"Radar":c=s&&s!=="none"?s:l;break;default:c=l;break}return c},UDe=function(t){var r=t.barSize,n=t.totalSize,a=t.stackGroups,i=a===void 0?{}:a;if(!i)return{};for(var s={},l=Object.keys(i),c=0,d=l.length;c<d;c++)for(var u=i[l[c]].stackGroups,f=Object.keys(u),m=0,h=f.length;m<h;m++){var v=u[f[m]],g=v.items,y=v.cateAxisId,x=g.filter(function(E){return jf(E.type).indexOf("Bar")>=0});if(x&&x.length){var b=x[0].type.defaultProps,w=b!==void 0?ai(ai({},b),x[0].props):x[0].props,j=w.barSize,_=w[y];s[_]||(s[_]=[]);var C=Qn(j)?r:j;s[_].push({item:x[0],stackList:x.slice(1),barSize:Qn(C)?void 0:ul(C,n,0)})}}return s},VDe=function(t){var r=t.barGap,n=t.barCategoryGap,a=t.bandSize,i=t.sizeList,s=i===void 0?[]:i,l=t.maxBarSize,c=s.length;if(c<1)return null;var d=ul(r,a,0,!0),u,f=[];if(s[0].barSize===+s[0].barSize){var m=!1,h=a/c,v=s.reduce(function(j,_){return j+_.barSize||0},0);v+=(c-1)*d,v>=a&&(v-=(c-1)*d,d=0),v>=a&&h>0&&(m=!0,h*=.9,v=c*h);var g=(a-v)/2>>0,y={offset:g-d,size:0};u=s.reduce(function(j,_){var C={item:_.item,position:{offset:y.offset+y.size+d,size:m?h:_.barSize}},E=[].concat(gB(j),[C]);return y=E[E.length-1].position,_.stackList&&_.stackList.length&&_.stackList.forEach(function(P){E.push({item:P,position:y})}),E},f)}else{var x=ul(n,a,0,!0);a-2*x-(c-1)*d<=0&&(d=0);var b=(a-2*x-(c-1)*d)/c;b>1&&(b>>=0);var w=l===+l?Math.min(b,l):b;u=s.reduce(function(j,_,C){var E=[].concat(gB(j),[{item:_.item,position:{offset:x+(b+d)*C+(b-w)/2,size:w}}]);return _.stackList&&_.stackList.length&&_.stackList.forEach(function(P){E.push({item:P,position:E[E.length-1].position})}),E},f)}return u},WDe=function(t,r,n,a){var i=n.children,s=n.width,l=n.margin,c=s-(l.left||0)-(l.right||0),d=xJ({children:i,legendWidth:c});if(d){var u=a||{},f=u.width,m=u.height,h=d.align,v=d.verticalAlign,g=d.layout;if((g==="vertical"||g==="horizontal"&&v==="middle")&&h!=="center"&&Mr(t[h]))return ai(ai({},t),{},Fv({},h,t[h]+(f||0)));if((g==="horizontal"||g==="vertical"&&h==="center")&&v!=="middle"&&Mr(t[v]))return ai(ai({},t),{},Fv({},v,t[v]+(m||0)))}return t},HDe=function(t,r,n){return Qn(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},yJ=function(t,r,n,a,i){var s=r.props.children,l=gc(s,Q1).filter(function(d){return HDe(a,i,d.props.direction)});if(l&&l.length){var c=l.map(function(d){return d.props.dataKey});return t.reduce(function(d,u){var f=gi(u,n);if(Qn(f))return d;var m=Array.isArray(f)?[wC(f),Am(f)]:[f,f],h=c.reduce(function(v,g){var y=gi(u,g,0),x=m[0]-Math.abs(Array.isArray(y)?y[0]:y),b=m[1]+Math.abs(Array.isArray(y)?y[1]:y);return[Math.min(x,v[0]),Math.max(b,v[1])]},[1/0,-1/0]);return[Math.min(h[0],d[0]),Math.max(h[1],d[1])]},[1/0,-1/0])}return null},GDe=function(t,r,n,a,i){var s=r.map(function(l){return yJ(t,l,n,i,a)}).filter(function(l){return!Qn(l)});return s&&s.length?s.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]):null},bJ=function(t,r,n,a,i){var s=r.map(function(c){var d=c.props.dataKey;return n==="number"&&d&&yJ(t,c,d,a)||$y(t,d,n,i)});if(n==="number")return s.reduce(function(c,d){return[Math.min(c[0],d[0]),Math.max(c[1],d[1])]},[1/0,-1/0]);var l={};return s.reduce(function(c,d){for(var u=0,f=d.length;u<f;u++)l[d[u]]||(l[d[u]]=!0,c.push(d[u]));return c},[])},wJ=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},jJ=function(t,r,n,a){if(a)return t.map(function(c){return c.coordinate});var i,s,l=t.map(function(c){return c.coordinate===r&&(i=!0),c.coordinate===n&&(s=!0),c.coordinate});return i||l.push(r),s||l.push(n),l},vf=function(t,r,n){if(!t)return null;var a=t.scale,i=t.duplicateDomain,s=t.type,l=t.range,c=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,d=(r||n)&&s==="category"&&a.bandwidth?a.bandwidth()/c:0;if(d=t.axisType==="angleAxis"&&l?.length>=2?dl(l[0]-l[1])*2*d:d,r&&(t.ticks||t.niceTicks)){var u=(t.ticks||t.niceTicks).map(function(f){var m=i?i.indexOf(f):f;return{coordinate:a(m)+d,value:f,offset:d}});return u.filter(function(f){return!a0(f.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(f,m){return{coordinate:a(f)+d,value:f,index:m,offset:d}}):a.ticks&&!n?a.ticks(t.tickCount).map(function(f){return{coordinate:a(f)+d,value:f,offset:d}}):a.domain().map(function(f,m){return{coordinate:a(f)+d,value:i?i[f]:f,index:m,offset:d}})},hA=new WeakMap,C2=function(t,r){if(typeof r!="function")return t;hA.has(t)||hA.set(t,new WeakMap);var n=hA.get(t);if(n.has(r))return n.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,a),a},NJ=function(t,r,n){var a=t.scale,i=t.type,s=t.layout,l=t.axisType;if(a==="auto")return s==="radial"&&l==="radiusAxis"?{scale:$b(),realScaleType:"band"}:s==="radial"&&l==="angleAxis"?{scale:VN(),realScaleType:"linear"}:i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:Ly(),realScaleType:"point"}:i==="category"?{scale:$b(),realScaleType:"band"}:{scale:VN(),realScaleType:"linear"};if(Hp(a)){var c="scale".concat(sC(a));return{scale:(cB[c]||Ly)(),realScaleType:cB[c]?c:"point"}}return Vn(a)?{scale:a}:{scale:Ly(),realScaleType:"point"}},xB=1e-4,_J=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,a=t.range(),i=Math.min(a[0],a[1])-xB,s=Math.max(a[0],a[1])+xB,l=t(r[0]),c=t(r[n-1]);(l<i||l>s||c<i||c>s)&&t.domain([r[0],r[n-1]])}},KDe=function(t,r){if(!t)return null;for(var n=0,a=t.length;n<a;n++)if(t[n].item===r)return t[n].position;return null},YDe=function(t,r){if(!r||r.length!==2||!Mr(r[0])||!Mr(r[1]))return t;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),i=[t[0],t[1]];return(!Mr(t[0])||t[0]<n)&&(i[0]=n),(!Mr(t[1])||t[1]>a)&&(i[1]=a),i[0]>a&&(i[0]=a),i[1]<n&&(i[1]=n),i},XDe=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,s=0,l=0;l<r;++l){var c=a0(t[l][n][1])?t[l][n][0]:t[l][n][1];c>=0?(t[l][n][0]=i,t[l][n][1]=i+c,i=t[l][n][1]):(t[l][n][0]=s,t[l][n][1]=s+c,s=t[l][n][1])}},JDe=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,s=0;s<r;++s){var l=a0(t[s][n][1])?t[s][n][0]:t[s][n][1];l>=0?(t[s][n][0]=i,t[s][n][1]=i+l,i=t[s][n][1]):(t[s][n][0]=0,t[s][n][1]=0)}},QDe={sign:XDe,expand:b_e,none:lx,silhouette:w_e,wiggle:j_e,positive:JDe},ZDe=function(t,r,n){var a=r.map(function(l){return l.props.dataKey}),i=QDe[n],s=y_e().keys(a).value(function(l,c){return+gi(l,c,0)}).order(pO).offset(i);return s(t)},eMe=function(t,r,n,a,i,s){if(!t)return null;var l=s?r.reverse():r,c={},d=l.reduce(function(f,m){var h,v=(h=m.type)!==null&&h!==void 0&&h.defaultProps?ai(ai({},m.type.defaultProps),m.props):m.props,g=v.stackId,y=v.hide;if(y)return f;var x=v[n],b=f[x]||{hasStack:!1,stackGroups:{}};if(Gi(g)){var w=b.stackGroups[g]||{numericAxisId:n,cateAxisId:a,items:[]};w.items.push(m),b.hasStack=!0,b.stackGroups[g]=w}else b.stackGroups[hg("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[m]};return ai(ai({},f),{},Fv({},x,b))},c),u={};return Object.keys(d).reduce(function(f,m){var h=d[m];if(h.hasStack){var v={};h.stackGroups=Object.keys(h.stackGroups).reduce(function(g,y){var x=h.stackGroups[y];return ai(ai({},g),{},Fv({},y,{numericAxisId:n,cateAxisId:a,items:x.items,stackedData:ZDe(t,x.items,i)}))},v)}return ai(ai({},f),{},Fv({},m,h))},u)},SJ=function(t,r){var n=r.realScaleType,a=r.type,i=r.tickCount,s=r.originalDomain,l=r.allowDecimals,c=n||r.scale;if(c!=="auto"&&c!=="linear")return null;if(i&&a==="number"&&s&&(s[0]==="auto"||s[1]==="auto")){var d=t.domain();if(!d.length)return null;var u=pDe(d,i,l);return t.domain([wC(u),Am(u)]),{niceTicks:u}}if(i&&a==="number"){var f=t.domain(),m=gDe(f,i,l);return{niceTicks:m}}return null};function JN(e){var t=e.axis,r=e.ticks,n=e.bandSize,a=e.entry,i=e.index,s=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Qn(a[t.dataKey])){var l=NN(r,"value",a[t.dataKey]);if(l)return l.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var c=gi(a,Qn(s)?t.dataKey:s);return Qn(c)?null:t.scale(c)}var yB=function(t){var r=t.axis,n=t.ticks,a=t.offset,i=t.bandSize,s=t.entry,l=t.index;if(r.type==="category")return n[l]?n[l].coordinate+a:null;var c=gi(s,r.dataKey,r.domain[l]);return Qn(c)?null:r.scale(c)-i/2+a},tMe=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]);return a<=0&&i>=0?0:i<0?i:a}return n[0]},rMe=function(t,r){var n,a=(n=t.type)!==null&&n!==void 0&&n.defaultProps?ai(ai({},t.type.defaultProps),t.props):t.props,i=a.stackId;if(Gi(i)){var s=r[i];if(s){var l=s.items.indexOf(t);return l>=0?s.stackedData[l]:null}}return null},nMe=function(t){return t.reduce(function(r,n){return[wC(n.concat([r[0]]).filter(Mr)),Am(n.concat([r[1]]).filter(Mr))]},[1/0,-1/0])},CJ=function(t,r,n){return Object.keys(t).reduce(function(a,i){var s=t[i],l=s.stackedData,c=l.reduce(function(d,u){var f=nMe(u.slice(r,n+1));return[Math.min(d[0],f[0]),Math.max(d[1],f[1])]},[1/0,-1/0]);return[Math.min(c[0],a[0]),Math.max(c[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},bB=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,wB=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,WO=function(t,r,n){if(Vn(t))return t(r,n);if(!Array.isArray(t))return r;var a=[];if(Mr(t[0]))a[0]=n?t[0]:Math.min(t[0],r[0]);else if(bB.test(t[0])){var i=+bB.exec(t[0])[1];a[0]=r[0]-i}else Vn(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(Mr(t[1]))a[1]=n?t[1]:Math.max(t[1],r[1]);else if(wB.test(t[1])){var s=+wB.exec(t[1])[1];a[1]=r[1]+s}else Vn(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},QN=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&r&&r.length>=2){for(var i=HT(r,function(f){return f.coordinate}),s=1/0,l=1,c=i.length;l<c;l++){var d=i[l],u=i[l-1];s=Math.min((d.coordinate||0)-(u.coordinate||0),s)}return s===1/0?0:s}return n?void 0:0},jB=function(t,r,n){return!t||!t.length||Yp(t,pc(n,"type.defaultProps.domain"))?r:t},PJ=function(t,r){var n=t.type.defaultProps?ai(ai({},t.type.defaultProps),t.props):t.props,a=n.dataKey,i=n.name,s=n.unit,l=n.formatter,c=n.tooltipType,d=n.chartType,u=n.hide;return ai(ai({},On(t,!1)),{},{dataKey:a,unit:s,formatter:l,name:i||a,color:xD(t),value:gi(r,a),type:c,payload:r,chartType:d,hide:u})};function Gb(e){"@babel/helpers - typeof";return Gb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gb(e)}function NB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function sf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NB(Object(r),!0).forEach(function(n){AJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function AJ(e,t,r){return t=aMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aMe(e){var t=oMe(e,"string");return Gb(t)=="symbol"?t:t+""}function oMe(e,t){if(Gb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Gb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function iMe(e,t){return dMe(e)||cMe(e,t)||lMe(e,t)||sMe()}function sMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lMe(e,t){if(e){if(typeof e=="string")return _B(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _B(e,t)}}function _B(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cMe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function dMe(e){if(Array.isArray(e))return e}var ZN=Math.PI/180,uMe=function(t){return t*180/Math.PI},_o=function(t,r,n,a){return{x:t+Math.cos(-ZN*a)*n,y:r+Math.sin(-ZN*a)*n}},EJ=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},fMe=function(t,r,n,a,i){var s=t.width,l=t.height,c=t.startAngle,d=t.endAngle,u=ul(t.cx,s,s/2),f=ul(t.cy,l,l/2),m=EJ(s,l,n),h=ul(t.innerRadius,m,0),v=ul(t.outerRadius,m,m*.8),g=Object.keys(r);return g.reduce(function(y,x){var b=r[x],w=b.domain,j=b.reversed,_;if(Qn(b.range))a==="angleAxis"?_=[c,d]:a==="radiusAxis"&&(_=[h,v]),j&&(_=[_[1],_[0]]);else{_=b.range;var C=_,E=iMe(C,2);c=E[0],d=E[1]}var P=NJ(b,i),k=P.realScaleType,M=P.scale;M.domain(w).range(_),_J(M);var S=SJ(M,sf(sf({},b),{},{realScaleType:k})),I=sf(sf(sf({},b),S),{},{range:_,radius:v,realScaleType:k,scale:M,cx:u,cy:f,innerRadius:h,outerRadius:v,startAngle:c,endAngle:d});return sf(sf({},y),{},AJ({},x,I))},{})},mMe=function(t,r){var n=t.x,a=t.y,i=r.x,s=r.y;return Math.sqrt(Math.pow(n-i,2)+Math.pow(a-s,2))},hMe=function(t,r){var n=t.x,a=t.y,i=r.cx,s=r.cy,l=mMe({x:n,y:a},{x:i,y:s});if(l<=0)return{radius:l};var c=(n-i)/l,d=Math.acos(c);return a>s&&(d=2*Math.PI-d),{radius:l,angle:uMe(d),angleInRadian:d}},pMe=function(t){var r=t.startAngle,n=t.endAngle,a=Math.floor(r/360),i=Math.floor(n/360),s=Math.min(a,i);return{startAngle:r-s*360,endAngle:n-s*360}},gMe=function(t,r){var n=r.startAngle,a=r.endAngle,i=Math.floor(n/360),s=Math.floor(a/360),l=Math.min(i,s);return t+l*360},SB=function(t,r){var n=t.x,a=t.y,i=hMe({x:n,y:a},r),s=i.radius,l=i.angle,c=r.innerRadius,d=r.outerRadius;if(s<c||s>d)return!1;if(s===0)return!0;var u=pMe(r),f=u.startAngle,m=u.endAngle,h=l,v;if(f<=m){for(;h>m;)h-=360;for(;h<f;)h+=360;v=h>=f&&h<=m}else{for(;h>f;)h-=360;for(;h<m;)h+=360;v=h>=m&&h<=f}return v?sf(sf({},r),{},{radius:s,angle:gMe(h,r)}):null},kJ=function(t){return!p.isValidElement(t)&&!Vn(t)&&typeof t!="boolean"?t.className:""};function Kb(e){"@babel/helpers - typeof";return Kb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kb(e)}var vMe=["offset"];function xMe(e){return jMe(e)||wMe(e)||bMe(e)||yMe()}function yMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bMe(e,t){if(e){if(typeof e=="string")return HO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HO(e,t)}}function wMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function jMe(e){if(Array.isArray(e))return HO(e)}function HO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NMe(e,t){if(e==null)return{};var r=_Me(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _Me(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function CB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Fi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CB(Object(r),!0).forEach(function(n){SMe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SMe(e,t,r){return t=CMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CMe(e){var t=PMe(e,"string");return Kb(t)=="symbol"?t:t+""}function PMe(e,t){if(Kb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Kb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yb(){return Yb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yb.apply(this,arguments)}var AMe=function(t){var r=t.value,n=t.formatter,a=Qn(t.children)?r:t.children;return Vn(n)?n(a):a},EMe=function(t,r){var n=dl(r-t),a=Math.min(Math.abs(r-t),360);return n*a},kMe=function(t,r,n){var a=t.position,i=t.viewBox,s=t.offset,l=t.className,c=i,d=c.cx,u=c.cy,f=c.innerRadius,m=c.outerRadius,h=c.startAngle,v=c.endAngle,g=c.clockWise,y=(f+m)/2,x=EMe(h,v),b=x>=0?1:-1,w,j;a==="insideStart"?(w=h+b*s,j=g):a==="insideEnd"?(w=v-b*s,j=!g):a==="end"&&(w=v+b*s,j=g),j=x<=0?j:!j;var _=_o(d,u,y,w),C=_o(d,u,y,w+(j?1:-1)*359),E="M".concat(_.x,",").concat(_.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(j?0:1,`,
    `).concat(C.x,",").concat(C.y),P=Qn(t.id)?hg("recharts-radial-line-"):t.id;return ye.createElement("text",Yb({},n,{dominantBaseline:"central",className:ta("recharts-radial-bar-label",l)}),ye.createElement("defs",null,ye.createElement("path",{id:P,d:E})),ye.createElement("textPath",{xlinkHref:"#".concat(P)},r))},OMe=function(t){var r=t.viewBox,n=t.offset,a=t.position,i=r,s=i.cx,l=i.cy,c=i.innerRadius,d=i.outerRadius,u=i.startAngle,f=i.endAngle,m=(u+f)/2;if(a==="outside"){var h=_o(s,l,d+n,m),v=h.x,g=h.y;return{x:v,y:g,textAnchor:v>=s?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:s,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:s,y:l,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:s,y:l,textAnchor:"middle",verticalAnchor:"end"};var y=(c+d)/2,x=_o(s,l,y,m),b=x.x,w=x.y;return{x:b,y:w,textAnchor:"middle",verticalAnchor:"middle"}},IMe=function(t){var r=t.viewBox,n=t.parentViewBox,a=t.offset,i=t.position,s=r,l=s.x,c=s.y,d=s.width,u=s.height,f=u>=0?1:-1,m=f*a,h=f>0?"end":"start",v=f>0?"start":"end",g=d>=0?1:-1,y=g*a,x=g>0?"end":"start",b=g>0?"start":"end";if(i==="top"){var w={x:l+d/2,y:c-f*a,textAnchor:"middle",verticalAnchor:h};return Fi(Fi({},w),n?{height:Math.max(c-n.y,0),width:d}:{})}if(i==="bottom"){var j={x:l+d/2,y:c+u+m,textAnchor:"middle",verticalAnchor:v};return Fi(Fi({},j),n?{height:Math.max(n.y+n.height-(c+u),0),width:d}:{})}if(i==="left"){var _={x:l-y,y:c+u/2,textAnchor:x,verticalAnchor:"middle"};return Fi(Fi({},_),n?{width:Math.max(_.x-n.x,0),height:u}:{})}if(i==="right"){var C={x:l+d+y,y:c+u/2,textAnchor:b,verticalAnchor:"middle"};return Fi(Fi({},C),n?{width:Math.max(n.x+n.width-C.x,0),height:u}:{})}var E=n?{width:d,height:u}:{};return i==="insideLeft"?Fi({x:l+y,y:c+u/2,textAnchor:b,verticalAnchor:"middle"},E):i==="insideRight"?Fi({x:l+d-y,y:c+u/2,textAnchor:x,verticalAnchor:"middle"},E):i==="insideTop"?Fi({x:l+d/2,y:c+m,textAnchor:"middle",verticalAnchor:v},E):i==="insideBottom"?Fi({x:l+d/2,y:c+u-m,textAnchor:"middle",verticalAnchor:h},E):i==="insideTopLeft"?Fi({x:l+y,y:c+m,textAnchor:b,verticalAnchor:v},E):i==="insideTopRight"?Fi({x:l+d-y,y:c+m,textAnchor:x,verticalAnchor:v},E):i==="insideBottomLeft"?Fi({x:l+y,y:c+u-m,textAnchor:b,verticalAnchor:h},E):i==="insideBottomRight"?Fi({x:l+d-y,y:c+u-m,textAnchor:x,verticalAnchor:h},E):e0(i)&&(Mr(i.x)||fp(i.x))&&(Mr(i.y)||fp(i.y))?Fi({x:l+ul(i.x,d),y:c+ul(i.y,u),textAnchor:"end",verticalAnchor:"end"},E):Fi({x:l+d/2,y:c+u/2,textAnchor:"middle",verticalAnchor:"middle"},E)},TMe=function(t){return"cx"in t&&Mr(t.cx)};function as(e){var t=e.offset,r=t===void 0?5:t,n=NMe(e,vMe),a=Fi({offset:r},n),i=a.viewBox,s=a.position,l=a.value,c=a.children,d=a.content,u=a.className,f=u===void 0?"":u,m=a.textBreakAll;if(!i||Qn(l)&&Qn(c)&&!p.isValidElement(d)&&!Vn(d))return null;if(p.isValidElement(d))return p.cloneElement(d,a);var h;if(Vn(d)){if(h=p.createElement(d,a),p.isValidElement(h))return h}else h=AMe(a);var v=TMe(i),g=On(a,!0);if(v&&(s==="insideStart"||s==="insideEnd"||s==="end"))return kMe(a,h,g);var y=v?OMe(a):IMe(a);return ye.createElement(Kp,Yb({className:ta("recharts-label",f)},g,y,{breakAll:m}),h)}as.displayName="Label";var OJ=function(t){var r=t.cx,n=t.cy,a=t.angle,i=t.startAngle,s=t.endAngle,l=t.r,c=t.radius,d=t.innerRadius,u=t.outerRadius,f=t.x,m=t.y,h=t.top,v=t.left,g=t.width,y=t.height,x=t.clockWise,b=t.labelViewBox;if(b)return b;if(Mr(g)&&Mr(y)){if(Mr(f)&&Mr(m))return{x:f,y:m,width:g,height:y};if(Mr(h)&&Mr(v))return{x:h,y:v,width:g,height:y}}return Mr(f)&&Mr(m)?{x:f,y:m,width:0,height:0}:Mr(r)&&Mr(n)?{cx:r,cy:n,startAngle:i||a||0,endAngle:s||a||0,innerRadius:d||0,outerRadius:u||c||l||0,clockWise:x}:t.viewBox?t.viewBox:{}},DMe=function(t,r){return t?t===!0?ye.createElement(as,{key:"label-implicit",viewBox:r}):Gi(t)?ye.createElement(as,{key:"label-implicit",viewBox:r,value:t}):p.isValidElement(t)?t.type===as?p.cloneElement(t,{key:"label-implicit",viewBox:r}):ye.createElement(as,{key:"label-implicit",content:t,viewBox:r}):Vn(t)?ye.createElement(as,{key:"label-implicit",content:t,viewBox:r}):e0(t)?ye.createElement(as,Yb({viewBox:r},t,{key:"label-implicit"})):null:null},MMe=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var a=t.children,i=OJ(t),s=gc(a,as).map(function(c,d){return p.cloneElement(c,{viewBox:r||i,key:"label-".concat(d)})});if(!n)return s;var l=DMe(t.label,r||i);return[l].concat(xMe(s))};as.parseViewBox=OJ;as.renderCallByParent=MMe;function RMe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var LMe=RMe;const $Me=qa(LMe);function Xb(e){"@babel/helpers - typeof";return Xb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xb(e)}var FMe=["valueAccessor"],BMe=["data","dataKey","clockWise","id","textBreakAll"];function qMe(e){return WMe(e)||VMe(e)||UMe(e)||zMe()}function zMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UMe(e,t){if(e){if(typeof e=="string")return GO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GO(e,t)}}function VMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function WMe(e){if(Array.isArray(e))return GO(e)}function GO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function e_(){return e_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e_.apply(this,arguments)}function PB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function AB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PB(Object(r),!0).forEach(function(n){HMe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HMe(e,t,r){return t=GMe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GMe(e){var t=KMe(e,"string");return Xb(t)=="symbol"?t:t+""}function KMe(e,t){if(Xb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Xb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function EB(e,t){if(e==null)return{};var r=YMe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function YMe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var XMe=function(t){return Array.isArray(t.value)?$Me(t.value):t.value};function Tu(e){var t=e.valueAccessor,r=t===void 0?XMe:t,n=EB(e,FMe),a=n.data,i=n.dataKey,s=n.clockWise,l=n.id,c=n.textBreakAll,d=EB(n,BMe);return!a||!a.length?null:ye.createElement(Na,{className:"recharts-label-list"},a.map(function(u,f){var m=Qn(i)?r(u,f):gi(u&&u.payload,i),h=Qn(l)?{}:{id:"".concat(l,"-").concat(f)};return ye.createElement(as,e_({},On(u,!0),d,h,{parentViewBox:u.parentViewBox,value:m,textBreakAll:c,viewBox:as.parseViewBox(Qn(s)?u:AB(AB({},u),{},{clockWise:s})),key:"label-".concat(f),index:f}))}))}Tu.displayName="LabelList";function JMe(e,t){return e?e===!0?ye.createElement(Tu,{key:"labelList-implicit",data:t}):ye.isValidElement(e)||Vn(e)?ye.createElement(Tu,{key:"labelList-implicit",data:t,content:e}):e0(e)?ye.createElement(Tu,e_({data:t},e,{key:"labelList-implicit"})):null:null}function QMe(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,a=gc(n,Tu).map(function(s,l){return p.cloneElement(s,{data:t,key:"labelList-".concat(l)})});if(!r)return a;var i=JMe(e.label,t);return[i].concat(qMe(a))}Tu.renderCallByParent=QMe;function Jb(e){"@babel/helpers - typeof";return Jb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jb(e)}function KO(){return KO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},KO.apply(this,arguments)}function kB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function OB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kB(Object(r),!0).forEach(function(n){ZMe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZMe(e,t,r){return t=eRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eRe(e){var t=tRe(e,"string");return Jb(t)=="symbol"?t:t+""}function tRe(e,t){if(Jb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rRe=function(t,r){var n=dl(r-t),a=Math.min(Math.abs(r-t),359.999);return n*a},P2=function(t){var r=t.cx,n=t.cy,a=t.radius,i=t.angle,s=t.sign,l=t.isExternal,c=t.cornerRadius,d=t.cornerIsExternal,u=c*(l?1:-1)+a,f=Math.asin(c/u)/ZN,m=d?i:i+s*f,h=_o(r,n,u,m),v=_o(r,n,a,m),g=d?i-s*f:i,y=_o(r,n,u*Math.cos(f*ZN),g);return{center:h,circleTangency:v,lineTangency:y,theta:f}},IJ=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,s=t.startAngle,l=t.endAngle,c=rRe(s,l),d=s+c,u=_o(r,n,i,s),f=_o(r,n,i,d),m="M ".concat(u.x,",").concat(u.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(s>d),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(a>0){var h=_o(r,n,a,s),v=_o(r,n,a,d);m+="L ".concat(v.x,",").concat(v.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(s<=d),`,
            `).concat(h.x,",").concat(h.y," Z")}else m+="L ".concat(r,",").concat(n," Z");return m},nRe=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,s=t.cornerRadius,l=t.forceCornerRadius,c=t.cornerIsExternal,d=t.startAngle,u=t.endAngle,f=dl(u-d),m=P2({cx:r,cy:n,radius:i,angle:d,sign:f,cornerRadius:s,cornerIsExternal:c}),h=m.circleTangency,v=m.lineTangency,g=m.theta,y=P2({cx:r,cy:n,radius:i,angle:u,sign:-f,cornerRadius:s,cornerIsExternal:c}),x=y.circleTangency,b=y.lineTangency,w=y.theta,j=c?Math.abs(d-u):Math.abs(d-u)-g-w;if(j<0)return l?"M ".concat(v.x,",").concat(v.y,`
        a`).concat(s,",").concat(s,",0,0,1,").concat(s*2,`,0
        a`).concat(s,",").concat(s,",0,0,1,").concat(-s*2,`,0
      `):IJ({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:d,endAngle:u});var _="M ".concat(v.x,",").concat(v.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(f<0),",").concat(h.x,",").concat(h.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(j>180),",").concat(+(f<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(f<0),",").concat(b.x,",").concat(b.y,`
  `);if(a>0){var C=P2({cx:r,cy:n,radius:a,angle:d,sign:f,isExternal:!0,cornerRadius:s,cornerIsExternal:c}),E=C.circleTangency,P=C.lineTangency,k=C.theta,M=P2({cx:r,cy:n,radius:a,angle:u,sign:-f,isExternal:!0,cornerRadius:s,cornerIsExternal:c}),S=M.circleTangency,I=M.lineTangency,T=M.theta,D=c?Math.abs(d-u):Math.abs(d-u)-k-T;if(D<0&&s===0)return"".concat(_,"L").concat(r,",").concat(n,"Z");_+="L".concat(I.x,",").concat(I.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(f<0),",").concat(S.x,",").concat(S.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(D>180),",").concat(+(f>0),",").concat(E.x,",").concat(E.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(f<0),",").concat(P.x,",").concat(P.y,"Z")}else _+="L".concat(r,",").concat(n,"Z");return _},aRe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},yD=function(t){var r=OB(OB({},aRe),t),n=r.cx,a=r.cy,i=r.innerRadius,s=r.outerRadius,l=r.cornerRadius,c=r.forceCornerRadius,d=r.cornerIsExternal,u=r.startAngle,f=r.endAngle,m=r.className;if(s<i||u===f)return null;var h=ta("recharts-sector",m),v=s-i,g=ul(l,v,0,!0),y;return g>0&&Math.abs(u-f)<360?y=nRe({cx:n,cy:a,innerRadius:i,outerRadius:s,cornerRadius:Math.min(g,v/2),forceCornerRadius:c,cornerIsExternal:d,startAngle:u,endAngle:f}):y=IJ({cx:n,cy:a,innerRadius:i,outerRadius:s,startAngle:u,endAngle:f}),ye.createElement("path",KO({},On(r,!0),{className:h,d:y,role:"img"}))};function Qb(e){"@babel/helpers - typeof";return Qb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qb(e)}function YO(){return YO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},YO.apply(this,arguments)}function IB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function TB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IB(Object(r),!0).forEach(function(n){oRe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oRe(e,t,r){return t=iRe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iRe(e){var t=sRe(e,"string");return Qb(t)=="symbol"?t:t+""}function sRe(e,t){if(Qb(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Qb(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DB={curveBasisClosed:l_e,curveBasisOpen:c_e,curveBasis:s_e,curveBumpX:GNe,curveBumpY:KNe,curveLinearClosed:d_e,curveLinear:cC,curveMonotoneX:u_e,curveMonotoneY:f_e,curveNatural:m_e,curveStep:h_e,curveStepAfter:g_e,curveStepBefore:p_e},A2=function(t){return t.x===+t.x&&t.y===+t.y},G0=function(t){return t.x},K0=function(t){return t.y},lRe=function(t,r){if(Vn(t))return t;var n="curve".concat(sC(t));return(n==="curveMonotone"||n==="curveBump")&&r?DB["".concat(n).concat(r==="vertical"?"Y":"X")]:DB[n]||cC},cRe=function(t){var r=t.type,n=r===void 0?"linear":r,a=t.points,i=a===void 0?[]:a,s=t.baseLine,l=t.layout,c=t.connectNulls,d=c===void 0?!1:c,u=lRe(n,l),f=d?i.filter(function(g){return A2(g)}):i,m;if(Array.isArray(s)){var h=d?s.filter(function(g){return A2(g)}):s,v=f.map(function(g,y){return TB(TB({},g),{},{base:h[y]})});return l==="vertical"?m=x2().y(K0).x1(G0).x0(function(g){return g.base.x}):m=x2().x(G0).y1(K0).y0(function(g){return g.base.y}),m.defined(A2).curve(u),m(v)}return l==="vertical"&&Mr(s)?m=x2().y(K0).x1(G0).x0(s):Mr(s)?m=x2().x(G0).y1(K0).y0(s):m=PY().x(G0).y(K0),m.defined(A2).curve(u),m(f)},kp=function(t){var r=t.className,n=t.points,a=t.path,i=t.pathRef;if((!n||!n.length)&&!a)return null;var s=n&&n.length?cRe(t):a;return p.createElement("path",YO({},On(t,!1),_N(t),{className:ta("recharts-curve",r),d:s,ref:i}))},TJ={exports:{}},dRe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",uRe=dRe,fRe=uRe;function DJ(){}function MJ(){}MJ.resetWarningCache=DJ;var mRe=function(){function e(n,a,i,s,l,c){if(c!==fRe){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:MJ,resetWarningCache:DJ};return r.PropTypes=r,r};TJ.exports=mRe();var hRe=TJ.exports;const Mn=qa(hRe);var pRe=Object.getOwnPropertyNames,gRe=Object.getOwnPropertySymbols,vRe=Object.prototype.hasOwnProperty;function MB(e,t){return function(n,a,i){return e(n,a,i)&&t(n,a,i)}}function E2(e){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,a);var i=a.cache,s=i.get(r),l=i.get(n);if(s&&l)return s===n&&l===r;i.set(r,n),i.set(n,r);var c=e(r,n,a);return i.delete(r),i.delete(n),c}}function RB(e){return pRe(e).concat(gRe(e))}var xRe=Object.hasOwn||function(e,t){return vRe.call(e,t)};function vg(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var yRe="__v",bRe="__o",wRe="_owner",LB=Object.getOwnPropertyDescriptor,$B=Object.keys;function jRe(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function NRe(e,t){return vg(e.getTime(),t.getTime())}function _Re(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function SRe(e,t){return e===t}function FB(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),i=e.entries(),s,l,c=0;(s=i.next())&&!s.done;){for(var d=t.entries(),u=!1,f=0;(l=d.next())&&!l.done;){if(a[f]){f++;continue}var m=s.value,h=l.value;if(r.equals(m[0],h[0],c,f,e,t,r)&&r.equals(m[1],h[1],m[0],h[0],e,t,r)){u=a[f]=!0;break}f++}if(!u)return!1;c++}return!0}var CRe=vg;function PRe(e,t,r){var n=$B(e),a=n.length;if($B(t).length!==a)return!1;for(;a-- >0;)if(!RJ(e,t,r,n[a]))return!1;return!0}function Y0(e,t,r){var n=RB(e),a=n.length;if(RB(t).length!==a)return!1;for(var i,s,l;a-- >0;)if(i=n[a],!RJ(e,t,r,i)||(s=LB(e,i),l=LB(t,i),(s||l)&&(!s||!l||s.configurable!==l.configurable||s.enumerable!==l.enumerable||s.writable!==l.writable)))return!1;return!0}function ARe(e,t){return vg(e.valueOf(),t.valueOf())}function ERe(e,t){return e.source===t.source&&e.flags===t.flags}function BB(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),i=e.values(),s,l;(s=i.next())&&!s.done;){for(var c=t.values(),d=!1,u=0;(l=c.next())&&!l.done;){if(!a[u]&&r.equals(s.value,l.value,s.value,l.value,e,t,r)){d=a[u]=!0;break}u++}if(!d)return!1}return!0}function kRe(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function ORe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function RJ(e,t,r,n){return(n===wRe||n===bRe||n===yRe)&&(e.$$typeof||t.$$typeof)?!0:xRe(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var IRe="[object Arguments]",TRe="[object Boolean]",DRe="[object Date]",MRe="[object Error]",RRe="[object Map]",LRe="[object Number]",$Re="[object Object]",FRe="[object RegExp]",BRe="[object Set]",qRe="[object String]",zRe="[object URL]",URe=Array.isArray,qB=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,zB=Object.assign,VRe=Object.prototype.toString.call.bind(Object.prototype.toString);function WRe(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,a=e.areFunctionsEqual,i=e.areMapsEqual,s=e.areNumbersEqual,l=e.areObjectsEqual,c=e.arePrimitiveWrappersEqual,d=e.areRegExpsEqual,u=e.areSetsEqual,f=e.areTypedArraysEqual,m=e.areUrlsEqual;return function(v,g,y){if(v===g)return!0;if(v==null||g==null)return!1;var x=typeof v;if(x!==typeof g)return!1;if(x!=="object")return x==="number"?s(v,g,y):x==="function"?a(v,g,y):!1;var b=v.constructor;if(b!==g.constructor)return!1;if(b===Object)return l(v,g,y);if(URe(v))return t(v,g,y);if(qB!=null&&qB(v))return f(v,g,y);if(b===Date)return r(v,g,y);if(b===RegExp)return d(v,g,y);if(b===Map)return i(v,g,y);if(b===Set)return u(v,g,y);var w=VRe(v);return w===DRe?r(v,g,y):w===FRe?d(v,g,y):w===RRe?i(v,g,y):w===BRe?u(v,g,y):w===$Re?typeof v.then!="function"&&typeof g.then!="function"&&l(v,g,y):w===zRe?m(v,g,y):w===MRe?n(v,g,y):w===IRe?l(v,g,y):w===TRe||w===LRe||w===qRe?c(v,g,y):!1}}function HRe(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,a={areArraysEqual:n?Y0:jRe,areDatesEqual:NRe,areErrorsEqual:_Re,areFunctionsEqual:SRe,areMapsEqual:n?MB(FB,Y0):FB,areNumbersEqual:CRe,areObjectsEqual:n?Y0:PRe,arePrimitiveWrappersEqual:ARe,areRegExpsEqual:ERe,areSetsEqual:n?MB(BB,Y0):BB,areTypedArraysEqual:n?Y0:kRe,areUrlsEqual:ORe};if(r&&(a=zB({},a,r(a))),t){var i=E2(a.areArraysEqual),s=E2(a.areMapsEqual),l=E2(a.areObjectsEqual),c=E2(a.areSetsEqual);a=zB({},a,{areArraysEqual:i,areMapsEqual:s,areObjectsEqual:l,areSetsEqual:c})}return a}function GRe(e){return function(t,r,n,a,i,s,l){return e(t,r,l)}}function KRe(e){var t=e.circular,r=e.comparator,n=e.createState,a=e.equals,i=e.strict;if(n)return function(c,d){var u=n(),f=u.cache,m=f===void 0?t?new WeakMap:void 0:f,h=u.meta;return r(c,d,{cache:m,equals:a,meta:h,strict:i})};if(t)return function(c,d){return r(c,d,{cache:new WeakMap,equals:a,meta:void 0,strict:i})};var s={cache:void 0,equals:a,meta:void 0,strict:i};return function(c,d){return r(c,d,s)}}var YRe=Ch();Ch({strict:!0});Ch({circular:!0});Ch({circular:!0,strict:!0});Ch({createInternalComparator:function(){return vg}});Ch({strict:!0,createInternalComparator:function(){return vg}});Ch({circular:!0,createInternalComparator:function(){return vg}});Ch({circular:!0,createInternalComparator:function(){return vg},strict:!0});function Ch(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,a=e.createState,i=e.strict,s=i===void 0?!1:i,l=HRe(e),c=WRe(l),d=n?n(c):GRe(c);return KRe({circular:r,comparator:c,createState:a,equals:d,strict:s})}function XRe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function UB(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function a(i){r<0&&(r=i),i-r>t?(e(i),r=-1):XRe(a)};requestAnimationFrame(n)}function XO(e){"@babel/helpers - typeof";return XO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},XO(e)}function JRe(e){return tLe(e)||eLe(e)||ZRe(e)||QRe()}function QRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZRe(e,t){if(e){if(typeof e=="string")return VB(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VB(e,t)}}function VB(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function eLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tLe(e){if(Array.isArray(e))return e}function rLe(){var e={},t=function(){return null},r=!1,n=function a(i){if(!r){if(Array.isArray(i)){if(!i.length)return;var s=i,l=JRe(s),c=l[0],d=l.slice(1);if(typeof c=="number"){UB(a.bind(null,d),c);return}a(c),UB(a.bind(null,d));return}XO(i)==="object"&&(e=i,t(e)),typeof i=="function"&&i()}};return{stop:function(){r=!0},start:function(i){r=!1,n(i)},subscribe:function(i){return t=i,function(){t=function(){return null}}}}}function Zb(e){"@babel/helpers - typeof";return Zb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zb(e)}function WB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function HB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WB(Object(r),!0).forEach(function(n){LJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LJ(e,t,r){return t=nLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nLe(e){var t=aLe(e,"string");return Zb(t)==="symbol"?t:String(t)}function aLe(e,t){if(Zb(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Zb(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oLe=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,a){return n.filter(function(i){return a.includes(i)})})},iLe=function(t){return t},sLe=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},Fy=function(t,r){return Object.keys(r).reduce(function(n,a){return HB(HB({},n),{},LJ({},a,t(a,r[a])))},{})},GB=function(t,r,n){return t.map(function(a){return"".concat(sLe(a)," ").concat(r,"ms ").concat(n)}).join(",")};function lLe(e,t){return uLe(e)||dLe(e,t)||$J(e,t)||cLe()}function cLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function uLe(e){if(Array.isArray(e))return e}function fLe(e){return pLe(e)||hLe(e)||$J(e)||mLe()}function mLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $J(e,t){if(e){if(typeof e=="string")return JO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JO(e,t)}}function hLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pLe(e){if(Array.isArray(e))return JO(e)}function JO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var t_=1e-4,FJ=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},BJ=function(t,r){return t.map(function(n,a){return n*Math.pow(r,a)}).reduce(function(n,a){return n+a})},KB=function(t,r){return function(n){var a=FJ(t,r);return BJ(a,n)}},gLe=function(t,r){return function(n){var a=FJ(t,r),i=[].concat(fLe(a.map(function(s,l){return s*l}).slice(1)),[0]);return BJ(i,n)}},YB=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],i=r[1],s=r[2],l=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,i=0,s=1,l=1;break;case"ease":a=.25,i=.1,s=.25,l=1;break;case"ease-in":a=.42,i=0,s=1,l=1;break;case"ease-out":a=.42,i=0,s=.58,l=1;break;case"ease-in-out":a=0,i=0,s=.58,l=1;break;default:{var c=r[0].split("(");if(c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4){var d=c[1].split(")")[0].split(",").map(function(y){return parseFloat(y)}),u=lLe(d,4);a=u[0],i=u[1],s=u[2],l=u[3]}}}var f=KB(a,s),m=KB(i,l),h=gLe(a,s),v=function(x){return x>1?1:x<0?0:x},g=function(x){for(var b=x>1?1:x,w=b,j=0;j<8;++j){var _=f(w)-b,C=h(w);if(Math.abs(_-b)<t_||C<t_)return m(w);w=v(w-_/C)}return m(w)};return g.isStepper=!1,g},vLe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,a=t.damping,i=a===void 0?8:a,s=t.dt,l=s===void 0?17:s,c=function(u,f,m){var h=-(u-f)*n,v=m*i,g=m+(h-v)*l/1e3,y=m*l/1e3+u;return Math.abs(y-f)<t_&&Math.abs(g)<t_?[f,0]:[y,g]};return c.isStepper=!0,c.dt=l,c},xLe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return YB(a);case"spring":return vLe();default:if(a.split("(")[0]==="cubic-bezier")return YB(a)}return typeof a=="function"?a:null};function e1(e){"@babel/helpers - typeof";return e1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e1(e)}function XB(e){return wLe(e)||bLe(e)||qJ(e)||yLe()}function yLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function wLe(e){if(Array.isArray(e))return ZO(e)}function JB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JB(Object(r),!0).forEach(function(n){QO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QO(e,t,r){return t=jLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jLe(e){var t=NLe(e,"string");return e1(t)==="symbol"?t:String(t)}function NLe(e,t){if(e1(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(e1(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _Le(e,t){return PLe(e)||CLe(e,t)||qJ(e,t)||SLe()}function SLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qJ(e,t){if(e){if(typeof e=="string")return ZO(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ZO(e,t)}}function ZO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function CLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function PLe(e){if(Array.isArray(e))return e}var r_=function(t,r,n){return t+(r-t)*n},e3=function(t){var r=t.from,n=t.to;return r!==n},ALe=function e(t,r,n){var a=Fy(function(i,s){if(e3(s)){var l=t(s.from,s.to,s.velocity),c=_Le(l,2),d=c[0],u=c[1];return bs(bs({},s),{},{from:d,velocity:u})}return s},r);return n<1?Fy(function(i,s){return e3(s)?bs(bs({},s),{},{velocity:r_(s.velocity,a[i].velocity,n),from:r_(s.from,a[i].from,n)}):s},r):e(t,a,n-1)};const ELe=function(e,t,r,n,a){var i=oLe(e,t),s=i.reduce(function(y,x){return bs(bs({},y),{},QO({},x,[e[x],t[x]]))},{}),l=i.reduce(function(y,x){return bs(bs({},y),{},QO({},x,{from:e[x],velocity:0,to:t[x]}))},{}),c=-1,d,u,f=function(){return null},m=function(){return Fy(function(x,b){return b.from},l)},h=function(){return!Object.values(l).filter(e3).length},v=function(x){d||(d=x);var b=x-d,w=b/r.dt;l=ALe(r,l,w),a(bs(bs(bs({},e),t),m())),d=x,h()||(c=requestAnimationFrame(f))},g=function(x){u||(u=x);var b=(x-u)/n,w=Fy(function(_,C){return r_.apply(void 0,XB(C).concat([r(b)]))},s);if(a(bs(bs(bs({},e),t),w)),b<1)c=requestAnimationFrame(f);else{var j=Fy(function(_,C){return r_.apply(void 0,XB(C).concat([r(1)]))},s);a(bs(bs(bs({},e),t),j))}};return f=r.isStepper?v:g,function(){return requestAnimationFrame(f),function(){cancelAnimationFrame(c)}}};function vx(e){"@babel/helpers - typeof";return vx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vx(e)}var kLe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function OLe(e,t){if(e==null)return{};var r=ILe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function ILe(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function pA(e){return RLe(e)||MLe(e)||DLe(e)||TLe()}function TLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DLe(e,t){if(e){if(typeof e=="string")return t3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t3(e,t)}}function MLe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function RLe(e){if(Array.isArray(e))return t3(e)}function t3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function QB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Sd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QB(Object(r),!0).forEach(function(n){fy(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fy(e,t,r){return t=zJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ZB(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zJ(n.key),n)}}function $Le(e,t,r){return t&&ZB(e.prototype,t),r&&ZB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function zJ(e){var t=FLe(e,"string");return vx(t)==="symbol"?t:String(t)}function FLe(e,t){if(vx(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(vx(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r3(e,t)}function r3(e,t){return r3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},r3(e,t)}function qLe(e){var t=zLe();return function(){var n=n_(e),a;if(t){var i=n_(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return n3(this,a)}}function n3(e,t){if(t&&(vx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return a3(e)}function a3(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function n_(e){return n_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},n_(e)}var _C=function(e){BLe(r,e);var t=qLe(r);function r(n,a){var i;LLe(this,r),i=t.call(this,n,a);var s=i.props,l=s.isActive,c=s.attributeName,d=s.from,u=s.to,f=s.steps,m=s.children,h=s.duration;if(i.handleStyleChange=i.handleStyleChange.bind(a3(i)),i.changeStyle=i.changeStyle.bind(a3(i)),!l||h<=0)return i.state={style:{}},typeof m=="function"&&(i.state={style:u}),n3(i);if(f&&f.length)i.state={style:f[0].style};else if(d){if(typeof m=="function")return i.state={style:d},n3(i);i.state={style:c?fy({},c,d):d}}else i.state={style:{}};return i}return $Le(r,[{key:"componentDidMount",value:function(){var a=this.props,i=a.isActive,s=a.canBegin;this.mounted=!0,!(!i||!s)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var i=this.props,s=i.isActive,l=i.canBegin,c=i.attributeName,d=i.shouldReAnimate,u=i.to,f=i.from,m=this.state.style;if(l){if(!s){var h={style:c?fy({},c,u):u};this.state&&m&&(c&&m[c]!==u||!c&&m!==u)&&this.setState(h);return}if(!(YRe(a.to,u)&&a.canBegin&&a.isActive)){var v=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var g=v||d?f:a.to;if(this.state&&m){var y={style:c?fy({},c,g):g};(c&&m[c]!==g||!c&&m!==g)&&this.setState(y)}this.runAnimation(Sd(Sd({},this.props),{},{from:g,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var i=this,s=a.from,l=a.to,c=a.duration,d=a.easing,u=a.begin,f=a.onAnimationEnd,m=a.onAnimationStart,h=ELe(s,l,xLe(d),c,this.changeStyle),v=function(){i.stopJSAnimation=h()};this.manager.start([m,u,v,c,f])}},{key:"runStepAnimation",value:function(a){var i=this,s=a.steps,l=a.begin,c=a.onAnimationStart,d=s[0],u=d.style,f=d.duration,m=f===void 0?0:f,h=function(g,y,x){if(x===0)return g;var b=y.duration,w=y.easing,j=w===void 0?"ease":w,_=y.style,C=y.properties,E=y.onAnimationEnd,P=x>0?s[x-1]:y,k=C||Object.keys(_);if(typeof j=="function"||j==="spring")return[].concat(pA(g),[i.runJSAnimation.bind(i,{from:P.style,to:_,duration:b,easing:j}),b]);var M=GB(k,b,j),S=Sd(Sd(Sd({},P.style),_),{},{transition:M});return[].concat(pA(g),[S,b,E]).filter(iLe)};return this.manager.start([c].concat(pA(s.reduce(h,[u,Math.max(m,l)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=rLe());var i=a.begin,s=a.duration,l=a.attributeName,c=a.to,d=a.easing,u=a.onAnimationStart,f=a.onAnimationEnd,m=a.steps,h=a.children,v=this.manager;if(this.unSubscribe=v.subscribe(this.handleStyleChange),typeof d=="function"||typeof h=="function"||d==="spring"){this.runJSAnimation(a);return}if(m.length>1){this.runStepAnimation(a);return}var g=l?fy({},l,c):c,y=GB(Object.keys(g),s,d);v.start([u,i,Sd(Sd({},g),{},{transition:y}),s,f])}},{key:"render",value:function(){var a=this.props,i=a.children;a.begin;var s=a.duration;a.attributeName,a.easing;var l=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var c=OLe(a,kLe),d=p.Children.count(i),u=this.state.style;if(typeof i=="function")return i(u);if(!l||d===0||s<=0)return i;var f=function(h){var v=h.props,g=v.style,y=g===void 0?{}:g,x=v.className,b=p.cloneElement(h,Sd(Sd({},c),{},{style:Sd(Sd({},y),u),className:x}));return b};return d===1?f(p.Children.only(i)):ye.createElement("div",null,p.Children.map(i,function(m){return f(m)}))}}]),r}(p.PureComponent);_C.displayName="Animate";_C.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};_C.propTypes={from:Mn.oneOfType([Mn.object,Mn.string]),to:Mn.oneOfType([Mn.object,Mn.string]),attributeName:Mn.string,duration:Mn.number,begin:Mn.number,easing:Mn.oneOfType([Mn.string,Mn.func]),steps:Mn.arrayOf(Mn.shape({duration:Mn.number.isRequired,style:Mn.object.isRequired,easing:Mn.oneOfType([Mn.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Mn.func]),properties:Mn.arrayOf("string"),onAnimationEnd:Mn.func})),children:Mn.oneOfType([Mn.node,Mn.func]),isActive:Mn.bool,canBegin:Mn.bool,onAnimationEnd:Mn.func,shouldReAnimate:Mn.bool,onAnimationStart:Mn.func,onAnimationReStart:Mn.func};const fh=_C;function qn(){return qn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qn.apply(null,arguments)}function a_(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function UJ(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,nO(e,t)}function t1(e){"@babel/helpers - typeof";return t1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t1(e)}function o_(){return o_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o_.apply(this,arguments)}function ULe(e,t){return GLe(e)||HLe(e,t)||WLe(e,t)||VLe()}function VLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WLe(e,t){if(e){if(typeof e=="string")return e7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e7(e,t)}}function e7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function HLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function GLe(e){if(Array.isArray(e))return e}function t7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function r7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t7(Object(r),!0).forEach(function(n){KLe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KLe(e,t,r){return t=YLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YLe(e){var t=XLe(e,"string");return t1(t)=="symbol"?t:t+""}function XLe(e,t){if(t1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(t1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var n7=function(t,r,n,a,i){var s=Math.min(Math.abs(n)/2,Math.abs(a)/2),l=a>=0?1:-1,c=n>=0?1:-1,d=a>=0&&n>=0||a<0&&n<0?1:0,u;if(s>0&&i instanceof Array){for(var f=[0,0,0,0],m=0,h=4;m<h;m++)f[m]=i[m]>s?s:i[m];u="M".concat(t,",").concat(r+l*f[0]),f[0]>0&&(u+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(d,",").concat(t+c*f[0],",").concat(r)),u+="L ".concat(t+n-c*f[1],",").concat(r),f[1]>0&&(u+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(d,`,
        `).concat(t+n,",").concat(r+l*f[1])),u+="L ".concat(t+n,",").concat(r+a-l*f[2]),f[2]>0&&(u+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(d,`,
        `).concat(t+n-c*f[2],",").concat(r+a)),u+="L ".concat(t+c*f[3],",").concat(r+a),f[3]>0&&(u+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(d,`,
        `).concat(t,",").concat(r+a-l*f[3])),u+="Z"}else if(s>0&&i===+i&&i>0){var v=Math.min(s,i);u="M ".concat(t,",").concat(r+l*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(t+c*v,",").concat(r,`
            L `).concat(t+n-c*v,",").concat(r,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(t+n,",").concat(r+l*v,`
            L `).concat(t+n,",").concat(r+a-l*v,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(t+n-c*v,",").concat(r+a,`
            L `).concat(t+c*v,",").concat(r+a,`
            A `).concat(v,",").concat(v,",0,0,").concat(d,",").concat(t,",").concat(r+a-l*v," Z")}else u="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return u},JLe=function(t,r){if(!t||!r)return!1;var n=t.x,a=t.y,i=r.x,s=r.y,l=r.width,c=r.height;if(Math.abs(l)>0&&Math.abs(c)>0){var d=Math.min(i,i+l),u=Math.max(i,i+l),f=Math.min(s,s+c),m=Math.max(s,s+c);return n>=d&&n<=u&&a>=f&&a<=m}return!1},QLe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},bD=function(t){var r=r7(r7({},QLe),t),n=p.useRef(),a=p.useState(-1),i=ULe(a,2),s=i[0],l=i[1];p.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var j=n.current.getTotalLength();j&&l(j)}catch{}},[]);var c=r.x,d=r.y,u=r.width,f=r.height,m=r.radius,h=r.className,v=r.animationEasing,g=r.animationDuration,y=r.animationBegin,x=r.isAnimationActive,b=r.isUpdateAnimationActive;if(c!==+c||d!==+d||u!==+u||f!==+f||u===0||f===0)return null;var w=ta("recharts-rectangle",h);return b?ye.createElement(fh,{canBegin:s>0,from:{width:u,height:f,x:c,y:d},to:{width:u,height:f,x:c,y:d},duration:g,animationEasing:v,isActive:b},function(j){var _=j.width,C=j.height,E=j.x,P=j.y;return ye.createElement(fh,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:g,isActive:x,easing:v},ye.createElement("path",o_({},On(r,!0),{className:w,d:n7(E,P,_,C,m),ref:n})))}):ye.createElement("path",o_({},On(r,!0),{className:w,d:n7(c,d,u,f,m)}))},ZLe=["points","className","baseLinePoints","connectNulls"];function jv(){return jv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jv.apply(this,arguments)}function e6e(e,t){if(e==null)return{};var r=t6e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function t6e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function a7(e){return o6e(e)||a6e(e)||n6e(e)||r6e()}function r6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n6e(e,t){if(e){if(typeof e=="string")return o3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o3(e,t)}}function a6e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function o6e(e){if(Array.isArray(e))return o3(e)}function o3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var o7=function(t){return t&&t.x===+t.x&&t.y===+t.y},i6e=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(function(n){o7(n)?r[r.length-1].push(n):r[r.length-1].length>0&&r.push([])}),o7(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},By=function(t,r){var n=i6e(t);r&&(n=[n.reduce(function(i,s){return[].concat(a7(i),a7(s))},[])]);var a=n.map(function(i){return i.reduce(function(s,l,c){return"".concat(s).concat(c===0?"M":"L").concat(l.x,",").concat(l.y)},"")}).join("");return n.length===1?"".concat(a,"Z"):a},s6e=function(t,r,n){var a=By(t,n);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat(By(r.reverse(),n).slice(1))},l6e=function(t){var r=t.points,n=t.className,a=t.baseLinePoints,i=t.connectNulls,s=e6e(t,ZLe);if(!r||!r.length)return null;var l=ta("recharts-polygon",n);if(a&&a.length){var c=s.stroke&&s.stroke!=="none",d=s6e(r,a,i);return ye.createElement("g",{className:l},ye.createElement("path",jv({},On(s,!0),{fill:d.slice(-1)==="Z"?s.fill:"none",stroke:"none",d})),c?ye.createElement("path",jv({},On(s,!0),{fill:"none",d:By(r,i)})):null,c?ye.createElement("path",jv({},On(s,!0),{fill:"none",d:By(a,i)})):null)}var u=By(r,i);return ye.createElement("path",jv({},On(s,!0),{fill:u.slice(-1)==="Z"?s.fill:"none",className:l,d:u}))};function i3(){return i3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i3.apply(this,arguments)}var Z1=function(t){var r=t.cx,n=t.cy,a=t.r,i=t.className,s=ta("recharts-dot",i);return r===+r&&n===+n&&a===+a?p.createElement("circle",i3({},On(t,!1),_N(t),{className:s,cx:r,cy:n,r:a})):null};function r1(e){"@babel/helpers - typeof";return r1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r1(e)}var c6e=["x","y","top","left","width","height","className"];function s3(){return s3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s3.apply(this,arguments)}function i7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function d6e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i7(Object(r),!0).forEach(function(n){u6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function u6e(e,t,r){return t=f6e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f6e(e){var t=m6e(e,"string");return r1(t)=="symbol"?t:t+""}function m6e(e,t){if(r1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(r1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function h6e(e,t){if(e==null)return{};var r=p6e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function p6e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var g6e=function(t,r,n,a,i,s){return"M".concat(t,",").concat(i,"v").concat(a,"M").concat(s,",").concat(r,"h").concat(n)},v6e=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,s=t.top,l=s===void 0?0:s,c=t.left,d=c===void 0?0:c,u=t.width,f=u===void 0?0:u,m=t.height,h=m===void 0?0:m,v=t.className,g=h6e(t,c6e),y=d6e({x:n,y:i,top:l,left:d,width:f,height:h},g);return!Mr(n)||!Mr(i)||!Mr(f)||!Mr(h)||!Mr(l)||!Mr(d)?null:ye.createElement("path",s3({},On(y,!0),{className:ta("recharts-cross",v),d:g6e(n,i,f,h,l,d)}))},x6e=bC,y6e=tJ,b6e=Uu;function w6e(e,t){return e&&e.length?x6e(e,b6e(t),y6e):void 0}var j6e=w6e;const N6e=qa(j6e);var _6e=bC,S6e=Uu,C6e=rJ;function P6e(e,t){return e&&e.length?_6e(e,S6e(t),C6e):void 0}var A6e=P6e;const E6e=qa(A6e);var k6e=["cx","cy","angle","ticks","axisLine"],O6e=["ticks","tick","angle","tickFormatter","stroke"];function xx(e){"@babel/helpers - typeof";return xx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xx(e)}function qy(){return qy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qy.apply(this,arguments)}function s7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Bh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s7(Object(r),!0).forEach(function(n){SC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function l7(e,t){if(e==null)return{};var r=I6e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function I6e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function T6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,WJ(n.key),n)}}function D6e(e,t,r){return t&&c7(e.prototype,t),r&&c7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function M6e(e,t,r){return t=i_(t),R6e(e,VJ()?Reflect.construct(t,r||[],i_(e).constructor):t.apply(e,r))}function R6e(e,t){if(t&&(xx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return L6e(e)}function L6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(VJ=function(){return!!e})()}function i_(e){return i_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},i_(e)}function $6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l3(e,t)}function l3(e,t){return l3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},l3(e,t)}function SC(e,t,r){return t=WJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WJ(e){var t=F6e(e,"string");return xx(t)=="symbol"?t:t+""}function F6e(e,t){if(xx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(xx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CC=function(e){function t(){return T6e(this,t),M6e(this,t,arguments)}return $6e(t,e),D6e(t,[{key:"getTickValueCoord",value:function(n){var a=n.coordinate,i=this.props,s=i.angle,l=i.cx,c=i.cy;return _o(l,c,a,s)}},{key:"getTickTextAnchor",value:function(){var n=this.props.orientation,a;switch(n){case"left":a="end";break;case"right":a="start";break;default:a="middle";break}return a}},{key:"getViewBox",value:function(){var n=this.props,a=n.cx,i=n.cy,s=n.angle,l=n.ticks,c=N6e(l,function(u){return u.coordinate||0}),d=E6e(l,function(u){return u.coordinate||0});return{cx:a,cy:i,startAngle:s,endAngle:s,innerRadius:d.coordinate||0,outerRadius:c.coordinate||0}}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,i=n.cy,s=n.angle,l=n.ticks,c=n.axisLine,d=l7(n,k6e),u=l.reduce(function(v,g){return[Math.min(v[0],g.coordinate),Math.max(v[1],g.coordinate)]},[1/0,-1/0]),f=_o(a,i,u[0],s),m=_o(a,i,u[1],s),h=Bh(Bh(Bh({},On(d,!1)),{},{fill:"none"},On(c,!1)),{},{x1:f.x,y1:f.y,x2:m.x,y2:m.y});return ye.createElement("line",qy({className:"recharts-polar-radius-axis-line"},h))}},{key:"renderTicks",value:function(){var n=this,a=this.props,i=a.ticks,s=a.tick,l=a.angle,c=a.tickFormatter,d=a.stroke,u=l7(a,O6e),f=this.getTickTextAnchor(),m=On(u,!1),h=On(s,!1),v=i.map(function(g,y){var x=n.getTickValueCoord(g),b=Bh(Bh(Bh(Bh({textAnchor:f,transform:"rotate(".concat(90-l,", ").concat(x.x,", ").concat(x.y,")")},m),{},{stroke:"none",fill:d},h),{},{index:y},x),{},{payload:g});return ye.createElement(Na,qy({className:ta("recharts-polar-radius-axis-tick",kJ(s)),key:"tick-".concat(g.coordinate)},Gp(n.props,g,y)),t.renderTickItem(s,b,c?c(g.value,y):g.value))});return ye.createElement(Na,{className:"recharts-polar-radius-axis-ticks"},v)}},{key:"render",value:function(){var n=this.props,a=n.ticks,i=n.axisLine,s=n.tick;return!a||!a.length?null:ye.createElement(Na,{className:ta("recharts-polar-radius-axis",this.props.className)},i&&this.renderAxisLine(),s&&this.renderTicks(),as.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(n,a,i){var s;return ye.isValidElement(n)?s=ye.cloneElement(n,a):Vn(n)?s=n(a):s=ye.createElement(Kp,qy({},a,{className:"recharts-polar-radius-axis-tick-value"}),i),s}}])}(p.PureComponent);SC(CC,"displayName","PolarRadiusAxis");SC(CC,"axisType","radiusAxis");SC(CC,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function yx(e){"@babel/helpers - typeof";return yx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yx(e)}function op(){return op=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},op.apply(this,arguments)}function d7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d7(Object(r),!0).forEach(function(n){PC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function B6e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,GJ(n.key),n)}}function q6e(e,t,r){return t&&u7(e.prototype,t),r&&u7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function z6e(e,t,r){return t=s_(t),U6e(e,HJ()?Reflect.construct(t,r||[],s_(e).constructor):t.apply(e,r))}function U6e(e,t){if(t&&(yx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return V6e(e)}function V6e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(HJ=function(){return!!e})()}function s_(e){return s_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},s_(e)}function W6e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c3(e,t)}function c3(e,t){return c3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},c3(e,t)}function PC(e,t,r){return t=GJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GJ(e){var t=H6e(e,"string");return yx(t)=="symbol"?t:t+""}function H6e(e,t){if(yx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(yx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var G6e=Math.PI/180,f7=1e-5,AC=function(e){function t(){return B6e(this,t),z6e(this,t,arguments)}return W6e(t,e),q6e(t,[{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.cx,s=a.cy,l=a.radius,c=a.orientation,d=a.tickSize,u=d||8,f=_o(i,s,l,n.coordinate),m=_o(i,s,l+(c==="inner"?-1:1)*u,n.coordinate);return{x1:f.x,y1:f.y,x2:m.x,y2:m.y}}},{key:"getTickTextAnchor",value:function(n){var a=this.props.orientation,i=Math.cos(-n.coordinate*G6e),s;return i>f7?s=a==="outer"?"start":"end":i<-f7?s=a==="outer"?"end":"start":s="middle",s}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,i=n.cy,s=n.radius,l=n.axisLine,c=n.axisLineType,d=qh(qh({},On(this.props,!1)),{},{fill:"none"},On(l,!1));if(c==="circle")return ye.createElement(Z1,op({className:"recharts-polar-angle-axis-line"},d,{cx:a,cy:i,r:s}));var u=this.props.ticks,f=u.map(function(m){return _o(a,i,s,m.coordinate)});return ye.createElement(l6e,op({className:"recharts-polar-angle-axis-line"},d,{points:f}))}},{key:"renderTicks",value:function(){var n=this,a=this.props,i=a.ticks,s=a.tick,l=a.tickLine,c=a.tickFormatter,d=a.stroke,u=On(this.props,!1),f=On(s,!1),m=qh(qh({},u),{},{fill:"none"},On(l,!1)),h=i.map(function(v,g){var y=n.getTickLineCoord(v),x=n.getTickTextAnchor(v),b=qh(qh(qh({textAnchor:x},u),{},{stroke:"none",fill:d},f),{},{index:g,payload:v,x:y.x2,y:y.y2});return ye.createElement(Na,op({className:ta("recharts-polar-angle-axis-tick",kJ(s)),key:"tick-".concat(v.coordinate)},Gp(n.props,v,g)),l&&ye.createElement("line",op({className:"recharts-polar-angle-axis-tick-line"},m,y)),s&&t.renderTickItem(s,b,c?c(v.value,g):v.value))});return ye.createElement(Na,{className:"recharts-polar-angle-axis-ticks"},h)}},{key:"render",value:function(){var n=this.props,a=n.ticks,i=n.radius,s=n.axisLine;return i<=0||!a||!a.length?null:ye.createElement(Na,{className:ta("recharts-polar-angle-axis",this.props.className)},s&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(n,a,i){var s;return ye.isValidElement(n)?s=ye.cloneElement(n,a):Vn(n)?s=n(a):s=ye.createElement(Kp,op({},a,{className:"recharts-polar-angle-axis-tick-value"}),i),s}}])}(p.PureComponent);PC(AC,"displayName","PolarAngleAxis");PC(AC,"axisType","angleAxis");PC(AC,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var K6e=JY,Y6e=K6e(Object.getPrototypeOf,Object),X6e=Y6e,J6e=qf,Q6e=X6e,Z6e=zf,e$e="[object Object]",t$e=Function.prototype,r$e=Object.prototype,KJ=t$e.toString,n$e=r$e.hasOwnProperty,a$e=KJ.call(Object);function o$e(e){if(!Z6e(e)||J6e(e)!=e$e)return!1;var t=Q6e(e);if(t===null)return!0;var r=n$e.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&KJ.call(r)==a$e}var i$e=o$e;const s$e=qa(i$e);var l$e=qf,c$e=zf,d$e="[object Boolean]";function u$e(e){return e===!0||e===!1||c$e(e)&&l$e(e)==d$e}var f$e=u$e;const m$e=qa(f$e);function n1(e){"@babel/helpers - typeof";return n1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n1(e)}function l_(){return l_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l_.apply(this,arguments)}function h$e(e,t){return x$e(e)||v$e(e,t)||g$e(e,t)||p$e()}function p$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function g$e(e,t){if(e){if(typeof e=="string")return m7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m7(e,t)}}function m7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function v$e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function x$e(e){if(Array.isArray(e))return e}function h7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function p7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h7(Object(r),!0).forEach(function(n){y$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function y$e(e,t,r){return t=b$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b$e(e){var t=w$e(e,"string");return n1(t)=="symbol"?t:t+""}function w$e(e,t){if(n1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(n1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var g7=function(t,r,n,a,i){var s=n-a,l;return l="M ".concat(t,",").concat(r),l+="L ".concat(t+n,",").concat(r),l+="L ".concat(t+n-s/2,",").concat(r+i),l+="L ".concat(t+n-s/2-a,",").concat(r+i),l+="L ".concat(t,",").concat(r," Z"),l},j$e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},N$e=function(t){var r=p7(p7({},j$e),t),n=p.useRef(),a=p.useState(-1),i=h$e(a,2),s=i[0],l=i[1];p.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var w=n.current.getTotalLength();w&&l(w)}catch{}},[]);var c=r.x,d=r.y,u=r.upperWidth,f=r.lowerWidth,m=r.height,h=r.className,v=r.animationEasing,g=r.animationDuration,y=r.animationBegin,x=r.isUpdateAnimationActive;if(c!==+c||d!==+d||u!==+u||f!==+f||m!==+m||u===0&&f===0||m===0)return null;var b=ta("recharts-trapezoid",h);return x?ye.createElement(fh,{canBegin:s>0,from:{upperWidth:0,lowerWidth:0,height:m,x:c,y:d},to:{upperWidth:u,lowerWidth:f,height:m,x:c,y:d},duration:g,animationEasing:v,isActive:x},function(w){var j=w.upperWidth,_=w.lowerWidth,C=w.height,E=w.x,P=w.y;return ye.createElement(fh,{canBegin:s>0,from:"0px ".concat(s===-1?1:s,"px"),to:"".concat(s,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:g,easing:v},ye.createElement("path",l_({},On(r,!0),{className:b,d:g7(E,P,j,_,C),ref:n})))}):ye.createElement("g",null,ye.createElement("path",l_({},On(r,!0),{className:b,d:g7(c,d,u,f,m)})))},_$e=["option","shapeType","propTransformer","activeClassName","isActive"];function a1(e){"@babel/helpers - typeof";return a1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a1(e)}function S$e(e,t){if(e==null)return{};var r=C$e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function C$e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function v7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function c_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?v7(Object(r),!0).forEach(function(n){P$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function P$e(e,t,r){return t=A$e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A$e(e){var t=E$e(e,"string");return a1(t)=="symbol"?t:t+""}function E$e(e,t){if(a1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(a1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function k$e(e,t){return c_(c_({},t),e)}function O$e(e,t){return e==="symbols"}function x7(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return ye.createElement(bD,r);case"trapezoid":return ye.createElement(N$e,r);case"sector":return ye.createElement(yD,r);case"symbols":if(O$e(t))return ye.createElement($T,r);break;default:return null}}function I$e(e){return p.isValidElement(e)?e.props:e}function YJ(e){var t=e.option,r=e.shapeType,n=e.propTransformer,a=n===void 0?k$e:n,i=e.activeClassName,s=i===void 0?"recharts-active-shape":i,l=e.isActive,c=S$e(e,_$e),d;if(p.isValidElement(t))d=p.cloneElement(t,c_(c_({},c),I$e(t)));else if(Vn(t))d=t(c);else if(s$e(t)&&!m$e(t)){var u=a(t,c);d=ye.createElement(x7,{shapeType:r,elementProps:u})}else{var f=c;d=ye.createElement(x7,{shapeType:r,elementProps:f})}return l?ye.createElement(Na,{className:s},d):d}function EC(e,t){return t!=null&&"trapezoids"in e.props}function kC(e,t){return t!=null&&"sectors"in e.props}function o1(e,t){return t!=null&&"points"in e.props}function T$e(e,t){var r,n,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,i=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return a&&i}function D$e(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function M$e(e,t){var r=e.x===t.x,n=e.y===t.y,a=e.z===t.z;return r&&n&&a}function R$e(e,t){var r;return EC(e,t)?r=T$e:kC(e,t)?r=D$e:o1(e,t)&&(r=M$e),r}function L$e(e,t){var r;return EC(e,t)?r="trapezoids":kC(e,t)?r="sectors":o1(e,t)&&(r="points"),r}function $$e(e,t){if(EC(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(kC(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return o1(e,t)?t.payload:{}}function F$e(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,a=L$e(r,t),i=$$e(r,t),s=n.filter(function(c,d){var u=Yp(i,c),f=r.props[a].filter(function(v){var g=R$e(r,t);return g(v,t)}),m=r.props[a].indexOf(f[f.length-1]),h=d===m;return u&&h}),l=n.indexOf(s[s.length-1]);return l}var yj;function bx(e){"@babel/helpers - typeof";return bx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bx(e)}function Nv(){return Nv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nv.apply(this,arguments)}function y7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function bo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y7(Object(r),!0).forEach(function(n){Zc(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function B$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JJ(n.key),n)}}function q$e(e,t,r){return t&&b7(e.prototype,t),r&&b7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function z$e(e,t,r){return t=d_(t),U$e(e,XJ()?Reflect.construct(t,r||[],d_(e).constructor):t.apply(e,r))}function U$e(e,t){if(t&&(bx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return V$e(e)}function V$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(XJ=function(){return!!e})()}function d_(e){return d_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},d_(e)}function W$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d3(e,t)}function d3(e,t){return d3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},d3(e,t)}function Zc(e,t,r){return t=JJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JJ(e){var t=H$e(e,"string");return bx(t)=="symbol"?t:t+""}function H$e(e,t){if(bx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(bx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fu=function(e){function t(r){var n;return B$e(this,t),n=z$e(this,t,[r]),Zc(n,"pieRef",null),Zc(n,"sectorRefs",[]),Zc(n,"id",hg("recharts-pie-")),Zc(n,"handleAnimationEnd",function(){var a=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),Vn(a)&&a()}),Zc(n,"handleAnimationStart",function(){var a=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),Vn(a)&&a()}),n.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},n}return W$e(t,e),q$e(t,[{key:"isActiveIndex",value:function(n){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(n)!==-1:n===a}},{key:"hasActiveIndex",value:function(){var n=this.props.activeIndex;return Array.isArray(n)?n.length!==0:n||n===0}},{key:"renderLabels",value:function(n){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var i=this.props,s=i.label,l=i.labelLine,c=i.dataKey,d=i.valueKey,u=On(this.props,!1),f=On(s,!1),m=On(l,!1),h=s&&s.offsetRadius||20,v=n.map(function(g,y){var x=(g.startAngle+g.endAngle)/2,b=_o(g.cx,g.cy,g.outerRadius+h,x),w=bo(bo(bo(bo({},u),g),{},{stroke:"none"},f),{},{index:y,textAnchor:t.getTextAnchor(b.x,g.cx)},b),j=bo(bo(bo(bo({},u),g),{},{fill:"none",stroke:g.fill},m),{},{index:y,points:[_o(g.cx,g.cy,g.outerRadius,x),b]}),_=c;return Qn(c)&&Qn(d)?_="value":Qn(c)&&(_=d),ye.createElement(Na,{key:"label-".concat(g.startAngle,"-").concat(g.endAngle,"-").concat(g.midAngle,"-").concat(y)},l&&t.renderLabelLineItem(l,j,"line"),t.renderLabelItem(s,w,gi(g,_)))});return ye.createElement(Na,{className:"recharts-pie-labels"},v)}},{key:"renderSectorsStatically",value:function(n){var a=this,i=this.props,s=i.activeShape,l=i.blendStroke,c=i.inactiveShape;return n.map(function(d,u){if(d?.startAngle===0&&d?.endAngle===0&&n.length!==1)return null;var f=a.isActiveIndex(u),m=c&&a.hasActiveIndex()?c:null,h=f?s:m,v=bo(bo({},d),{},{stroke:l?d.fill:d.stroke,tabIndex:-1});return ye.createElement(Na,Nv({ref:function(y){y&&!a.sectorRefs.includes(y)&&a.sectorRefs.push(y)},tabIndex:-1,className:"recharts-pie-sector"},Gp(a.props,d,u),{key:"sector-".concat(d?.startAngle,"-").concat(d?.endAngle,"-").concat(d.midAngle,"-").concat(u)}),ye.createElement(YJ,Nv({option:h,isActive:f,shapeType:"sector"},v)))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,a=this.props,i=a.sectors,s=a.isAnimationActive,l=a.animationBegin,c=a.animationDuration,d=a.animationEasing,u=a.animationId,f=this.state,m=f.prevSectors,h=f.prevIsAnimationActive;return ye.createElement(fh,{begin:l,duration:c,isActive:s,easing:d,from:{t:0},to:{t:1},key:"pie-".concat(u,"-").concat(h),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(v){var g=v.t,y=[],x=i&&i[0],b=x.startAngle;return i.forEach(function(w,j){var _=m&&m[j],C=j>0?pc(w,"paddingAngle",0):0;if(_){var E=Vi(_.endAngle-_.startAngle,w.endAngle-w.startAngle),P=bo(bo({},w),{},{startAngle:b+C,endAngle:b+E(g)+C});y.push(P),b=P.endAngle}else{var k=w.endAngle,M=w.startAngle,S=Vi(0,k-M),I=S(g),T=bo(bo({},w),{},{startAngle:b+C,endAngle:b+I+C});y.push(T),b=T.endAngle}}),ye.createElement(Na,null,n.renderSectorsStatically(y))})}},{key:"attachKeyboardHandlers",value:function(n){var a=this;n.onkeydown=function(i){if(!i.altKey)switch(i.key){case"ArrowLeft":{var s=++a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[s].focus(),a.setState({sectorToFocus:s});break}case"ArrowRight":{var l=--a.state.sectorToFocus<0?a.sectorRefs.length-1:a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[l].focus(),a.setState({sectorToFocus:l});break}case"Escape":{a.sectorRefs[a.state.sectorToFocus].blur(),a.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var n=this.props,a=n.sectors,i=n.isAnimationActive,s=this.state.prevSectors;return i&&a&&a.length&&(!s||!Yp(s,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var n=this,a=this.props,i=a.hide,s=a.sectors,l=a.className,c=a.label,d=a.cx,u=a.cy,f=a.innerRadius,m=a.outerRadius,h=a.isAnimationActive,v=this.state.isAnimationFinished;if(i||!s||!s.length||!Mr(d)||!Mr(u)||!Mr(f)||!Mr(m))return null;var g=ta("recharts-pie",l);return ye.createElement(Na,{tabIndex:this.props.rootTabIndex,className:g,ref:function(x){n.pieRef=x}},this.renderSectors(),c&&this.renderLabels(s),as.renderCallByParent(this.props,null,!1),(!h||v)&&Tu.renderCallByParent(this.props,s,!1))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return a.prevIsAnimationActive!==n.isAnimationActive?{prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:[],isAnimationFinished:!0}:n.isAnimationActive&&n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:a.curSectors,isAnimationFinished:!0}:n.sectors!==a.curSectors?{curSectors:n.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(n,a){return n>a?"start":n<a?"end":"middle"}},{key:"renderLabelLineItem",value:function(n,a,i){if(ye.isValidElement(n))return ye.cloneElement(n,a);if(Vn(n))return n(a);var s=ta("recharts-pie-label-line",typeof n!="boolean"?n.className:"");return ye.createElement(kp,Nv({},a,{key:i,type:"linear",className:s}))}},{key:"renderLabelItem",value:function(n,a,i){if(ye.isValidElement(n))return ye.cloneElement(n,a);var s=i;if(Vn(n)&&(s=n(a),ye.isValidElement(s)))return s;var l=ta("recharts-pie-label-text",typeof n!="boolean"&&!Vn(n)?n.className:"");return ye.createElement(Kp,Nv({},a,{alignmentBaseline:"middle",className:l}),s)}}])}(p.PureComponent);yj=Fu;Zc(Fu,"displayName","Pie");Zc(Fu,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!Kd.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Zc(Fu,"parseDeltaAngle",function(e,t){var r=dl(t-e),n=Math.min(Math.abs(t-e),360);return r*n});Zc(Fu,"getRealPieData",function(e){var t=e.data,r=e.children,n=On(e,!1),a=gc(r,Mb);return t&&t.length?t.map(function(i,s){return bo(bo(bo({payload:i},n),i),a&&a[s]&&a[s].props)}):a&&a.length?a.map(function(i){return bo(bo({},n),i.props)}):[]});Zc(Fu,"parseCoordinateOfPie",function(e,t){var r=t.top,n=t.left,a=t.width,i=t.height,s=EJ(a,i),l=n+ul(e.cx,a,a/2),c=r+ul(e.cy,i,i/2),d=ul(e.innerRadius,s,0),u=ul(e.outerRadius,s,s*.8),f=e.maxRadius||Math.sqrt(a*a+i*i)/2;return{cx:l,cy:c,innerRadius:d,outerRadius:u,maxRadius:f}});Zc(Fu,"getComposedData",function(e){var t=e.item,r=e.offset,n=t.type.defaultProps!==void 0?bo(bo({},t.type.defaultProps),t.props):t.props,a=yj.getRealPieData(n);if(!a||!a.length)return null;var i=n.cornerRadius,s=n.startAngle,l=n.endAngle,c=n.paddingAngle,d=n.dataKey,u=n.nameKey,f=n.valueKey,m=n.tooltipType,h=Math.abs(n.minAngle),v=yj.parseCoordinateOfPie(n,r),g=yj.parseDeltaAngle(s,l),y=Math.abs(g),x=d;Qn(d)&&Qn(f)?(Gd(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),x="value"):Qn(d)&&(Gd(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),x=f);var b=a.filter(function(P){return gi(P,x,0)!==0}).length,w=(y>=360?b:b-1)*c,j=y-b*h-w,_=a.reduce(function(P,k){var M=gi(k,x,0);return P+(Mr(M)?M:0)},0),C;if(_>0){var E;C=a.map(function(P,k){var M=gi(P,x,0),S=gi(P,u,k),I=(Mr(M)?M:0)/_,T;k?T=E.endAngle+dl(g)*c*(M!==0?1:0):T=s;var D=T+dl(g)*((M!==0?h:0)+I*j),B=(T+D)/2,U=(v.innerRadius+v.outerRadius)/2,z=[{name:S,value:M,payload:P,dataKey:x,type:m}],$=_o(v.cx,v.cy,U,B);return E=bo(bo(bo({percent:I,cornerRadius:i,name:S,tooltipPayload:z,midAngle:B,middleRadius:U,tooltipPosition:$},P),v),{},{value:gi(P,x),startAngle:T,endAngle:D,payload:P,paddingAngle:dl(g)*c}),E})}return bo(bo({},v),{},{sectors:C,data:a})});var G$e=Math.ceil,K$e=Math.max;function Y$e(e,t,r,n){for(var a=-1,i=K$e(G$e((t-e)/(r||1)),0),s=Array(i);i--;)s[n?i:++a]=e,e+=r;return s}var X$e=Y$e,J$e=gX,w7=1/0,Q$e=17976931348623157e292;function Z$e(e){if(!e)return e===0?e:0;if(e=J$e(e),e===w7||e===-w7){var t=e<0?-1:1;return t*Q$e}return e===e?e:0}var QJ=Z$e,eFe=X$e,tFe=mC,gA=QJ;function rFe(e){return function(t,r,n){return n&&typeof n!="number"&&tFe(t,r,n)&&(r=n=void 0),t=gA(t),r===void 0?(r=t,t=0):r=gA(r),n=n===void 0?t<r?1:-1:gA(n),eFe(t,r,n,e)}}var nFe=rFe,aFe=nFe,oFe=aFe(),iFe=oFe;const u_=qa(iFe);function i1(e){"@babel/helpers - typeof";return i1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i1(e)}function j7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function N7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j7(Object(r),!0).forEach(function(n){ZJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZJ(e,t,r){return t=sFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sFe(e){var t=lFe(e,"string");return i1(t)=="symbol"?t:t+""}function lFe(e,t){if(i1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(i1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cFe=["Webkit","Moz","O","ms"],dFe=function(t,r){if(!t)return null;var n=t.replace(/(\w)/,function(i){return i.toUpperCase()}),a=cFe.reduce(function(i,s){return N7(N7({},i),{},ZJ({},s+n,r))},{});return a[t]=r,a};function wx(e){"@babel/helpers - typeof";return wx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wx(e)}function f_(){return f_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},f_.apply(this,arguments)}function _7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function vA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_7(Object(r),!0).forEach(function(n){ec(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tQ(n.key),n)}}function fFe(e,t,r){return t&&S7(e.prototype,t),r&&S7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mFe(e,t,r){return t=m_(t),hFe(e,eQ()?Reflect.construct(t,r||[],m_(e).constructor):t.apply(e,r))}function hFe(e,t){if(t&&(wx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pFe(e)}function pFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(eQ=function(){return!!e})()}function m_(e){return m_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},m_(e)}function gFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u3(e,t)}function u3(e,t){return u3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},u3(e,t)}function ec(e,t,r){return t=tQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tQ(e){var t=vFe(e,"string");return wx(t)=="symbol"?t:t+""}function vFe(e,t){if(wx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(wx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xFe=function(t){var r=t.data,n=t.startIndex,a=t.endIndex,i=t.x,s=t.width,l=t.travellerWidth;if(!r||!r.length)return{};var c=r.length,d=Ly().domain(u_(0,c)).range([i,i+s-l]),u=d.domain().map(function(f){return d(f)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:d(n),endX:d(a),scale:d,scaleValues:u}},C7=function(t){return t.changedTouches&&!!t.changedTouches.length},jx=function(e){function t(r){var n;return uFe(this,t),n=mFe(this,t,[r]),ec(n,"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),ec(n,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),ec(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,i=a.endIndex,s=a.onDragEnd,l=a.startIndex;s?.({endIndex:i,startIndex:l})}),n.detachDragEndListener()}),ec(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),ec(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),ec(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),ec(n,"handleSlideDragStart",function(a){var i=C7(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return gFe(t,e),fFe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,i=n.endX,s=this.state.scaleValues,l=this.props,c=l.gap,d=l.data,u=d.length-1,f=Math.min(a,i),m=Math.max(a,i),h=t.getIndexInRange(s,f),v=t.getIndexInRange(s,m);return{startIndex:h-h%c,endIndex:v===u?u:v-v%c}}},{key:"getTextOfTick",value:function(n){var a=this.props,i=a.data,s=a.tickFormatter,l=a.dataKey,c=gi(i[n],l,n);return Vn(s)?s(c,n):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,i=a.slideMoveStartX,s=a.startX,l=a.endX,c=this.props,d=c.x,u=c.width,f=c.travellerWidth,m=c.startIndex,h=c.endIndex,v=c.onChange,g=n.pageX-i;g>0?g=Math.min(g,d+u-f-l,d+u-f-s):g<0&&(g=Math.max(g,d-s,d-l));var y=this.getIndex({startX:s+g,endX:l+g});(y.startIndex!==m||y.endIndex!==h)&&v&&v(y),this.setState({startX:s+g,endX:l+g,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var i=C7(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,i=a.brushMoveStartX,s=a.movingTravellerId,l=a.endX,c=a.startX,d=this.state[s],u=this.props,f=u.x,m=u.width,h=u.travellerWidth,v=u.onChange,g=u.gap,y=u.data,x={startX:this.state.startX,endX:this.state.endX},b=n.pageX-i;b>0?b=Math.min(b,f+m-h-d):b<0&&(b=Math.max(b,f-d)),x[s]=d+b;var w=this.getIndex(x),j=w.startIndex,_=w.endIndex,C=function(){var P=y.length-1;return s==="startX"&&(l>c?j%g===0:_%g===0)||l<c&&_===P||s==="endX"&&(l>c?_%g===0:j%g===0)||l>c&&_===P};this.setState(ec(ec({},s,d+b),"brushMoveStartX",n.pageX),function(){v&&C()&&v(w)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var i=this,s=this.state,l=s.scaleValues,c=s.startX,d=s.endX,u=this.state[a],f=l.indexOf(u);if(f!==-1){var m=f+n;if(!(m===-1||m>=l.length)){var h=l[m];a==="startX"&&h>=d||a==="endX"&&h<=c||this.setState(ec({},a,h),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,i=n.y,s=n.width,l=n.height,c=n.fill,d=n.stroke;return ye.createElement("rect",{stroke:d,fill:c,x:a,y:i,width:s,height:l})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,i=n.y,s=n.width,l=n.height,c=n.data,d=n.children,u=n.padding,f=p.Children.only(d);return f?ye.cloneElement(f,{x:a,y:i,width:s,height:l,margin:u,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(n,a){var i,s,l=this,c=this.props,d=c.y,u=c.travellerWidth,f=c.height,m=c.traveller,h=c.ariaLabel,v=c.data,g=c.startIndex,y=c.endIndex,x=Math.max(n,this.props.x),b=vA(vA({},On(this.props,!1)),{},{x,y:d,width:u,height:f}),w=h||"Min value: ".concat((i=v[g])===null||i===void 0?void 0:i.name,", Max value: ").concat((s=v[y])===null||s===void 0?void 0:s.name);return ye.createElement(Na,{tabIndex:0,role:"slider","aria-label":w,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(_){["ArrowLeft","ArrowRight"].includes(_.key)&&(_.preventDefault(),_.stopPropagation(),l.handleTravellerMoveKeyboard(_.key==="ArrowRight"?1:-1,a))},onFocus:function(){l.setState({isTravellerFocused:!0})},onBlur:function(){l.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(m,b))}},{key:"renderSlide",value:function(n,a){var i=this.props,s=i.y,l=i.height,c=i.stroke,d=i.travellerWidth,u=Math.min(n,a)+d,f=Math.max(Math.abs(a-n)-d,0);return ye.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:u,y:s,width:f,height:l})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,i=n.endIndex,s=n.y,l=n.height,c=n.travellerWidth,d=n.stroke,u=this.state,f=u.startX,m=u.endX,h=5,v={pointerEvents:"none",fill:d};return ye.createElement(Na,{className:"recharts-brush-texts"},ye.createElement(Kp,f_({textAnchor:"end",verticalAnchor:"middle",x:Math.min(f,m)-h,y:s+l/2},v),this.getTextOfTick(a)),ye.createElement(Kp,f_({textAnchor:"start",verticalAnchor:"middle",x:Math.max(f,m)+c+h,y:s+l/2},v),this.getTextOfTick(i)))}},{key:"render",value:function(){var n=this.props,a=n.data,i=n.className,s=n.children,l=n.x,c=n.y,d=n.width,u=n.height,f=n.alwaysShowText,m=this.state,h=m.startX,v=m.endX,g=m.isTextActive,y=m.isSlideMoving,x=m.isTravellerMoving,b=m.isTravellerFocused;if(!a||!a.length||!Mr(l)||!Mr(c)||!Mr(d)||!Mr(u)||d<=0||u<=0)return null;var w=ta("recharts-brush",i),j=ye.Children.count(s)===1,_=dFe("userSelect","none");return ye.createElement(Na,{className:w,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:_},this.renderBackground(),j&&this.renderPanorama(),this.renderSlide(h,v),this.renderTravellerLayer(h,"startX"),this.renderTravellerLayer(v,"endX"),(g||y||x||b||f)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,i=n.y,s=n.width,l=n.height,c=n.stroke,d=Math.floor(i+l/2)-1;return ye.createElement(ye.Fragment,null,ye.createElement("rect",{x:a,y:i,width:s,height:l,fill:c,stroke:"none"}),ye.createElement("line",{x1:a+1,y1:d,x2:a+s-1,y2:d,fill:"none",stroke:"#fff"}),ye.createElement("line",{x1:a+1,y1:d+2,x2:a+s-1,y2:d+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var i;return ye.isValidElement(n)?i=ye.cloneElement(n,a):Vn(n)?i=n(a):i=t.renderDefaultTraveller(a),i}},{key:"getDerivedStateFromProps",value:function(n,a){var i=n.data,s=n.width,l=n.x,c=n.travellerWidth,d=n.updateId,u=n.startIndex,f=n.endIndex;if(i!==a.prevData||d!==a.prevUpdateId)return vA({prevData:i,prevTravellerWidth:c,prevUpdateId:d,prevX:l,prevWidth:s},i&&i.length?xFe({data:i,width:s,x:l,travellerWidth:c,startIndex:u,endIndex:f}):{scale:null,scaleValues:null});if(a.scale&&(s!==a.prevWidth||l!==a.prevX||c!==a.prevTravellerWidth)){a.scale.range([l,l+s-c]);var m=a.scale.domain().map(function(h){return a.scale(h)});return{prevData:i,prevTravellerWidth:c,prevUpdateId:d,prevX:l,prevWidth:s,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:m}}return null}},{key:"getIndexInRange",value:function(n,a){for(var i=n.length,s=0,l=i-1;l-s>1;){var c=Math.floor((s+l)/2);n[c]>a?l=c:s=c}return a>=n[l]?l:s}}])}(p.PureComponent);ec(jx,"displayName","Brush");ec(jx,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var yFe=WT;function bFe(e,t){var r;return yFe(e,function(n,a,i){return r=t(n,a,i),!r}),!!r}var wFe=bFe,jFe=UY,NFe=Uu,_Fe=wFe,SFe=Bl,CFe=mC;function PFe(e,t,r){var n=SFe(e)?jFe:_Fe;return r&&CFe(e,t,r)&&(t=void 0),n(e,NFe(t))}var AFe=PFe;const EFe=qa(AFe);var Du=function(t,r){var n=t.alwaysShow,a=t.ifOverflow;return n&&(a="extendDomain"),a===r},P7=uX;function kFe(e,t,r){t=="__proto__"&&P7?P7(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var OFe=kFe,IFe=OFe,TFe=cX,DFe=Uu;function MFe(e,t){var r={};return t=DFe(t),TFe(e,function(n,a,i){IFe(r,a,t(n,a,i))}),r}var RFe=MFe;const LFe=qa(RFe);function $Fe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var FFe=$Fe,BFe=WT;function qFe(e,t){var r=!0;return BFe(e,function(n,a,i){return r=!!t(n,a,i),r}),r}var zFe=qFe,UFe=FFe,VFe=zFe,WFe=Uu,HFe=Bl,GFe=mC;function KFe(e,t,r){var n=HFe(e)?UFe:VFe;return r&&GFe(e,t,r)&&(t=void 0),n(e,WFe(t))}var YFe=KFe;const rQ=qa(YFe);var XFe=["x","y"];function s1(e){"@babel/helpers - typeof";return s1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s1(e)}function f3(){return f3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},f3.apply(this,arguments)}function A7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function X0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?A7(Object(r),!0).forEach(function(n){JFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function JFe(e,t,r){return t=QFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QFe(e){var t=ZFe(e,"string");return s1(t)=="symbol"?t:t+""}function ZFe(e,t){if(s1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(s1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function e8e(e,t){if(e==null)return{};var r=t8e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function t8e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function r8e(e,t){var r=e.x,n=e.y,a=e8e(e,XFe),i="".concat(r),s=parseInt(i,10),l="".concat(n),c=parseInt(l,10),d="".concat(t.height||a.height),u=parseInt(d,10),f="".concat(t.width||a.width),m=parseInt(f,10);return X0(X0(X0(X0(X0({},t),a),s?{x:s}:{}),c?{y:c}:{}),{},{height:u,width:m,name:t.name,radius:t.radius})}function E7(e){return ye.createElement(YJ,f3({shapeType:"rectangle",propTransformer:r8e,activeClassName:"recharts-active-bar"},e))}var n8e=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,a){if(typeof t=="number")return t;var i=Mr(n)||Tje(n);return i?t(n,a):(i||uh(!1),r)}},a8e=["value","background"],nQ;function Nx(e){"@babel/helpers - typeof";return Nx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nx(e)}function o8e(e,t){if(e==null)return{};var r=i8e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function i8e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function h_(){return h_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},h_.apply(this,arguments)}function k7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ni(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k7(Object(r),!0).forEach(function(n){Em(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function s8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oQ(n.key),n)}}function l8e(e,t,r){return t&&O7(e.prototype,t),r&&O7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function c8e(e,t,r){return t=p_(t),d8e(e,aQ()?Reflect.construct(t,r||[],p_(e).constructor):t.apply(e,r))}function d8e(e,t){if(t&&(Nx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return u8e(e)}function u8e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aQ=function(){return!!e})()}function p_(e){return p_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},p_(e)}function f8e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m3(e,t)}function m3(e,t){return m3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},m3(e,t)}function Em(e,t,r){return t=oQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oQ(e){var t=m8e(e,"string");return Nx(t)=="symbol"?t:t+""}function m8e(e,t){if(Nx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xg=function(e){function t(){var r;s8e(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=c8e(this,t,[].concat(a)),Em(r,"state",{isAnimationFinished:!1}),Em(r,"id",hg("recharts-bar-")),Em(r,"handleAnimationEnd",function(){var s=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),s&&s()}),Em(r,"handleAnimationStart",function(){var s=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),s&&s()}),r}return f8e(t,e),l8e(t,[{key:"renderRectanglesStatically",value:function(n){var a=this,i=this.props,s=i.shape,l=i.dataKey,c=i.activeIndex,d=i.activeBar,u=On(this.props,!1);return n&&n.map(function(f,m){var h=m===c,v=h?d:s,g=Ni(Ni(Ni({},u),f),{},{isActive:h,option:v,index:m,dataKey:l,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return ye.createElement(Na,h_({className:"recharts-bar-rectangle"},Gp(a.props,f,m),{key:"rectangle-".concat(f?.x,"-").concat(f?.y,"-").concat(f?.value,"-").concat(m)}),ye.createElement(E7,g))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,a=this.props,i=a.data,s=a.layout,l=a.isAnimationActive,c=a.animationBegin,d=a.animationDuration,u=a.animationEasing,f=a.animationId,m=this.state.prevData;return ye.createElement(fh,{begin:c,duration:d,isActive:l,easing:u,from:{t:0},to:{t:1},key:"bar-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(h){var v=h.t,g=i.map(function(y,x){var b=m&&m[x];if(b){var w=Vi(b.x,y.x),j=Vi(b.y,y.y),_=Vi(b.width,y.width),C=Vi(b.height,y.height);return Ni(Ni({},y),{},{x:w(v),y:j(v),width:_(v),height:C(v)})}if(s==="horizontal"){var E=Vi(0,y.height),P=E(v);return Ni(Ni({},y),{},{y:y.y+y.height-P,height:P})}var k=Vi(0,y.width),M=k(v);return Ni(Ni({},y),{},{width:M})});return ye.createElement(Na,null,n.renderRectanglesStatically(g))})}},{key:"renderRectangles",value:function(){var n=this.props,a=n.data,i=n.isAnimationActive,s=this.state.prevData;return i&&a&&a.length&&(!s||!Yp(s,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var n=this,a=this.props,i=a.data,s=a.dataKey,l=a.activeIndex,c=On(this.props.background,!1);return i.map(function(d,u){d.value;var f=d.background,m=o8e(d,a8e);if(!f)return null;var h=Ni(Ni(Ni(Ni(Ni({},m),{},{fill:"#eee"},f),c),Gp(n.props,d,u)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:s,index:u,className:"recharts-bar-background-rectangle"});return ye.createElement(E7,h_({key:"background-bar-".concat(u),option:n.props.background,isActive:u===l},h))})}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,s=i.data,l=i.xAxis,c=i.yAxis,d=i.layout,u=i.children,f=gc(u,Q1);if(!f)return null;var m=d==="vertical"?s[0].height/2:s[0].width/2,h=function(y,x){var b=Array.isArray(y.value)?y.value[1]:y.value;return{x:y.x,y:y.y,value:b,errorVal:gi(y,x)}},v={clipPath:n?"url(#clipPath-".concat(a,")"):null};return ye.createElement(Na,v,f.map(function(g){return ye.cloneElement(g,{key:"error-bar-".concat(a,"-").concat(g.props.dataKey),data:s,xAxis:l,yAxis:c,layout:d,offset:m,dataPointFormatter:h})}))}},{key:"render",value:function(){var n=this.props,a=n.hide,i=n.data,s=n.className,l=n.xAxis,c=n.yAxis,d=n.left,u=n.top,f=n.width,m=n.height,h=n.isAnimationActive,v=n.background,g=n.id;if(a||!i||!i.length)return null;var y=this.state.isAnimationFinished,x=ta("recharts-bar",s),b=l&&l.allowDataOverflow,w=c&&c.allowDataOverflow,j=b||w,_=Qn(g)?this.id:g;return ye.createElement(Na,{className:x},b||w?ye.createElement("defs",null,ye.createElement("clipPath",{id:"clipPath-".concat(_)},ye.createElement("rect",{x:b?d:d-f/2,y:w?u:u-m/2,width:b?f:f*2,height:w?m:m*2}))):null,ye.createElement(Na,{className:"recharts-bar-rectangles",clipPath:j?"url(#clipPath-".concat(_,")"):null},v?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(j,_),(!h||y)&&Tu.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(p.PureComponent);nQ=xg;Em(xg,"displayName","Bar");Em(xg,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Kd.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Em(xg,"getComposedData",function(e){var t=e.props,r=e.item,n=e.barPosition,a=e.bandSize,i=e.xAxis,s=e.yAxis,l=e.xAxisTicks,c=e.yAxisTicks,d=e.stackedData,u=e.dataStartIndex,f=e.displayedData,m=e.offset,h=KDe(n,r);if(!h)return null;var v=t.layout,g=r.type.defaultProps,y=g!==void 0?Ni(Ni({},g),r.props):r.props,x=y.dataKey,b=y.children,w=y.minPointSize,j=v==="horizontal"?s:i,_=d?j.scale.domain():null,C=tMe({numericAxis:j}),E=gc(b,Mb),P=f.map(function(k,M){var S,I,T,D,B,U;d?S=YDe(d[u+M],_):(S=gi(k,x),Array.isArray(S)||(S=[C,S]));var z=n8e(w,nQ.defaultProps.minPointSize)(S[1],M);if(v==="horizontal"){var $,Y=[s.scale(S[0]),s.scale(S[1])],de=Y[0],xe=Y[1];I=yB({axis:i,ticks:l,bandSize:a,offset:h.offset,entry:k,index:M}),T=($=xe??de)!==null&&$!==void 0?$:void 0,D=h.size;var q=de-xe;if(B=Number.isNaN(q)?0:q,U={x:I,y:s.y,width:D,height:s.height},Math.abs(z)>0&&Math.abs(B)<Math.abs(z)){var L=dl(B||z)*(Math.abs(z)-Math.abs(B));T-=L,B+=L}}else{var W=[i.scale(S[0]),i.scale(S[1])],ne=W[0],le=W[1];if(I=ne,T=yB({axis:s,ticks:c,bandSize:a,offset:h.offset,entry:k,index:M}),D=le-ne,B=h.size,U={x:i.x,y:T,width:i.width,height:B},Math.abs(z)>0&&Math.abs(D)<Math.abs(z)){var K=dl(D||z)*(Math.abs(z)-Math.abs(D));D+=K}}return Ni(Ni(Ni({},k),{},{x:I,y:T,width:D,height:B,value:d?S:S[1],payload:k,background:U},E&&E[M]&&E[M].props),{},{tooltipPayload:[PJ(r,k)],tooltipPosition:{x:I+D/2,y:T+B/2}})});return Ni({data:P,layout:v},m)});function l1(e){"@babel/helpers - typeof";return l1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l1(e)}function h8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iQ(n.key),n)}}function p8e(e,t,r){return t&&I7(e.prototype,t),r&&I7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function T7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Id(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?T7(Object(r),!0).forEach(function(n){OC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OC(e,t,r){return t=iQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iQ(e){var t=g8e(e,"string");return l1(t)=="symbol"?t:t+""}function g8e(e,t){if(l1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(l1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wD=function(t,r,n,a,i){var s=t.width,l=t.height,c=t.layout,d=t.children,u=Object.keys(r),f={left:n.left,leftMirror:n.left,right:s-n.right,rightMirror:s-n.right,top:n.top,topMirror:n.top,bottom:l-n.bottom,bottomMirror:l-n.bottom},m=!!ac(d,xg);return u.reduce(function(h,v){var g=r[v],y=g.orientation,x=g.domain,b=g.padding,w=b===void 0?{}:b,j=g.mirror,_=g.reversed,C="".concat(y).concat(j?"Mirror":""),E,P,k,M,S;if(g.type==="number"&&(g.padding==="gap"||g.padding==="no-gap")){var I=x[1]-x[0],T=1/0,D=g.categoricalDomain.sort(Rje);if(D.forEach(function(W,ne){ne>0&&(T=Math.min((W||0)-(D[ne-1]||0),T))}),Number.isFinite(T)){var B=T/I,U=g.layout==="vertical"?n.height:n.width;if(g.padding==="gap"&&(E=B*U/2),g.padding==="no-gap"){var z=ul(t.barCategoryGap,B*U),$=B*U/2;E=$-z-($-z)/U*z}}}a==="xAxis"?P=[n.left+(w.left||0)+(E||0),n.left+n.width-(w.right||0)-(E||0)]:a==="yAxis"?P=c==="horizontal"?[n.top+n.height-(w.bottom||0),n.top+(w.top||0)]:[n.top+(w.top||0)+(E||0),n.top+n.height-(w.bottom||0)-(E||0)]:P=g.range,_&&(P=[P[1],P[0]]);var Y=NJ(g,i,m),de=Y.scale,xe=Y.realScaleType;de.domain(x).range(P),_J(de);var q=SJ(de,Id(Id({},g),{},{realScaleType:xe}));a==="xAxis"?(S=y==="top"&&!j||y==="bottom"&&j,k=n.left,M=f[C]-S*g.height):a==="yAxis"&&(S=y==="left"&&!j||y==="right"&&j,k=f[C]-S*g.width,M=n.top);var L=Id(Id(Id({},g),q),{},{realScaleType:xe,x:k,y:M,scale:de,width:a==="xAxis"?n.width:g.width,height:a==="yAxis"?n.height:g.height});return L.bandSize=QN(L,q),!g.hide&&a==="xAxis"?f[C]+=(S?-1:1)*L.height:g.hide||(f[C]+=(S?-1:1)*L.width),Id(Id({},h),{},OC({},v,L))},{})},sQ=function(t,r){var n=t.x,a=t.y,i=r.x,s=r.y;return{x:Math.min(n,i),y:Math.min(a,s),width:Math.abs(i-n),height:Math.abs(s-a)}},v8e=function(t){var r=t.x1,n=t.y1,a=t.x2,i=t.y2;return sQ({x:r,y:n},{x:a,y:i})},lQ=function(){function e(t){h8e(this,e),this.scale=t}return p8e(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,i=n.position;if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+s}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(r)+l}default:return this.scale(r)}if(a){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+c}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),a=n[0],i=n[n.length-1];return a<=i?r>=a&&r<=i:r>=i&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}])}();OC(lQ,"EPS",1e-4);var jD=function(t){var r=Object.keys(t).reduce(function(n,a){return Id(Id({},n),{},OC({},a,lQ.create(t[a])))},{});return Id(Id({},r),{},{apply:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.bandAware,l=i.position;return LFe(a,function(c,d){return r[d].apply(c,{bandAware:s,position:l})})},isInRange:function(a){return rQ(a,function(i,s){return r[s].isInRange(i)})}})};function x8e(e){return(e%180+180)%180}var y8e=function(t){var r=t.width,n=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=x8e(a),s=i*Math.PI/180,l=Math.atan(n/r),c=s>l&&s<Math.PI-l?n/Math.sin(s):r/Math.cos(s);return Math.abs(c)},b8e=Uu,w8e=G1,j8e=uC;function N8e(e){return function(t,r,n){var a=Object(t);if(!w8e(t)){var i=b8e(r);t=j8e(t),r=function(l){return i(a[l],l,a)}}var s=e(t,r,n);return s>-1?a[i?t[s]:s]:void 0}}var _8e=N8e,S8e=QJ;function C8e(e){var t=S8e(e),r=t%1;return t===t?r?t-r:t:0}var P8e=C8e,A8e=nX,E8e=Uu,k8e=P8e,O8e=Math.max;function I8e(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=r==null?0:k8e(r);return a<0&&(a=O8e(n+a,0)),A8e(e,E8e(t),a)}var T8e=I8e,D8e=_8e,M8e=T8e,R8e=D8e(M8e),L8e=R8e;const $8e=qa(L8e);var F8e=L2e(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),ND=p.createContext(void 0),_D=p.createContext(void 0),cQ=p.createContext(void 0),dQ=p.createContext({}),uQ=p.createContext(void 0),fQ=p.createContext(0),mQ=p.createContext(0),D7=function(t){var r=t.state,n=r.xAxisMap,a=r.yAxisMap,i=r.offset,s=t.clipPathId,l=t.children,c=t.width,d=t.height,u=F8e(i);return ye.createElement(ND.Provider,{value:n},ye.createElement(_D.Provider,{value:a},ye.createElement(dQ.Provider,{value:i},ye.createElement(cQ.Provider,{value:u},ye.createElement(uQ.Provider,{value:s},ye.createElement(fQ.Provider,{value:d},ye.createElement(mQ.Provider,{value:c},l)))))))},B8e=function(){return p.useContext(uQ)},hQ=function(t){var r=p.useContext(ND);r==null&&uh(!1);var n=r[t];return n==null&&uh(!1),n},q8e=function(){var t=p.useContext(ND);return bm(t)},z8e=function(){var t=p.useContext(_D),r=$8e(t,function(n){return rQ(n.domain,Number.isFinite)});return r||bm(t)},pQ=function(t){var r=p.useContext(_D);r==null&&uh(!1);var n=r[t];return n==null&&uh(!1),n},U8e=function(){var t=p.useContext(cQ);return t},V8e=function(){return p.useContext(dQ)},SD=function(){return p.useContext(mQ)},CD=function(){return p.useContext(fQ)};function _x(e){"@babel/helpers - typeof";return _x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_x(e)}function W8e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vQ(n.key),n)}}function H8e(e,t,r){return t&&M7(e.prototype,t),r&&M7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function G8e(e,t,r){return t=g_(t),K8e(e,gQ()?Reflect.construct(t,r||[],g_(e).constructor):t.apply(e,r))}function K8e(e,t){if(t&&(_x(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Y8e(e)}function Y8e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gQ=function(){return!!e})()}function g_(e){return g_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},g_(e)}function X8e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h3(e,t)}function h3(e,t){return h3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},h3(e,t)}function R7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function L7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?R7(Object(r),!0).forEach(function(n){PD(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function PD(e,t,r){return t=vQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vQ(e){var t=J8e(e,"string");return _x(t)=="symbol"?t:t+""}function J8e(e,t){if(_x(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(_x(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Q8e(e,t){return rBe(e)||tBe(e,t)||eBe(e,t)||Z8e()}function Z8e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eBe(e,t){if(e){if(typeof e=="string")return $7(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $7(e,t)}}function $7(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function tBe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function rBe(e){if(Array.isArray(e))return e}function p3(){return p3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},p3.apply(this,arguments)}var nBe=function(t,r){var n;return ye.isValidElement(t)?n=ye.cloneElement(t,r):Vn(t)?n=t(r):n=ye.createElement("line",p3({},r,{className:"recharts-reference-line-line"})),n},aBe=function(t,r,n,a,i,s,l,c,d){var u=i.x,f=i.y,m=i.width,h=i.height;if(n){var v=d.y,g=t.y.apply(v,{position:s});if(Du(d,"discard")&&!t.y.isInRange(g))return null;var y=[{x:u+m,y:g},{x:u,y:g}];return c==="left"?y.reverse():y}if(r){var x=d.x,b=t.x.apply(x,{position:s});if(Du(d,"discard")&&!t.x.isInRange(b))return null;var w=[{x:b,y:f+h},{x:b,y:f}];return l==="top"?w.reverse():w}if(a){var j=d.segment,_=j.map(function(C){return t.apply(C,{position:s})});return Du(d,"discard")&&EFe(_,function(C){return!t.isInRange(C)})?null:_}return null};function oBe(e){var t=e.x,r=e.y,n=e.segment,a=e.xAxisId,i=e.yAxisId,s=e.shape,l=e.className,c=e.alwaysShow,d=B8e(),u=hQ(a),f=pQ(i),m=U8e();if(!d||!m)return null;Gd(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var h=jD({x:u.scale,y:f.scale}),v=Gi(t),g=Gi(r),y=n&&n.length===2,x=aBe(h,v,g,y,m,e.position,u.orientation,f.orientation,e);if(!x)return null;var b=Q8e(x,2),w=b[0],j=w.x,_=w.y,C=b[1],E=C.x,P=C.y,k=Du(e,"hidden")?"url(#".concat(d,")"):void 0,M=L7(L7({clipPath:k},On(e,!0)),{},{x1:j,y1:_,x2:E,y2:P});return ye.createElement(Na,{className:ta("recharts-reference-line",l)},nBe(s,M),as.renderCallByParent(e,v8e({x1:j,y1:_,x2:E,y2:P})))}var AD=function(e){function t(){return W8e(this,t),G8e(this,t,arguments)}return X8e(t,e),H8e(t,[{key:"render",value:function(){return ye.createElement(oBe,this.props)}}])}(ye.Component);PD(AD,"displayName","ReferenceLine");PD(AD,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function g3(){return g3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},g3.apply(this,arguments)}function Sx(e){"@babel/helpers - typeof";return Sx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sx(e)}function F7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function B7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?F7(Object(r),!0).forEach(function(n){IC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yQ(n.key),n)}}function sBe(e,t,r){return t&&q7(e.prototype,t),r&&q7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lBe(e,t,r){return t=v_(t),cBe(e,xQ()?Reflect.construct(t,r||[],v_(e).constructor):t.apply(e,r))}function cBe(e,t){if(t&&(Sx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dBe(e)}function dBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(xQ=function(){return!!e})()}function v_(e){return v_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},v_(e)}function uBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v3(e,t)}function v3(e,t){return v3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},v3(e,t)}function IC(e,t,r){return t=yQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yQ(e){var t=fBe(e,"string");return Sx(t)=="symbol"?t:t+""}function fBe(e,t){if(Sx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Sx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mBe=function(t){var r=t.x,n=t.y,a=t.xAxis,i=t.yAxis,s=jD({x:a.scale,y:i.scale}),l=s.apply({x:r,y:n},{bandAware:!0});return Du(t,"discard")&&!s.isInRange(l)?null:l},TC=function(e){function t(){return iBe(this,t),lBe(this,t,arguments)}return uBe(t,e),sBe(t,[{key:"render",value:function(){var n=this.props,a=n.x,i=n.y,s=n.r,l=n.alwaysShow,c=n.clipPathId,d=Gi(a),u=Gi(i);if(Gd(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!d||!u)return null;var f=mBe(this.props);if(!f)return null;var m=f.x,h=f.y,v=this.props,g=v.shape,y=v.className,x=Du(this.props,"hidden")?"url(#".concat(c,")"):void 0,b=B7(B7({clipPath:x},On(this.props,!0)),{},{cx:m,cy:h});return ye.createElement(Na,{className:ta("recharts-reference-dot",y)},t.renderDot(g,b),as.renderCallByParent(this.props,{x:m-s,y:h-s,width:2*s,height:2*s}))}}])}(ye.Component);IC(TC,"displayName","ReferenceDot");IC(TC,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});IC(TC,"renderDot",function(e,t){var r;return ye.isValidElement(e)?r=ye.cloneElement(e,t):Vn(e)?r=e(t):r=ye.createElement(Z1,g3({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function x3(){return x3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},x3.apply(this,arguments)}function Cx(e){"@babel/helpers - typeof";return Cx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cx(e)}function z7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function U7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?z7(Object(r),!0).forEach(function(n){DC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wQ(n.key),n)}}function pBe(e,t,r){return t&&V7(e.prototype,t),r&&V7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function gBe(e,t,r){return t=x_(t),vBe(e,bQ()?Reflect.construct(t,r||[],x_(e).constructor):t.apply(e,r))}function vBe(e,t){if(t&&(Cx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xBe(e)}function xBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bQ=function(){return!!e})()}function x_(e){return x_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},x_(e)}function yBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y3(e,t)}function y3(e,t){return y3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},y3(e,t)}function DC(e,t,r){return t=wQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wQ(e){var t=bBe(e,"string");return Cx(t)=="symbol"?t:t+""}function bBe(e,t){if(Cx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Cx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wBe=function(t,r,n,a,i){var s=i.x1,l=i.x2,c=i.y1,d=i.y2,u=i.xAxis,f=i.yAxis;if(!u||!f)return null;var m=jD({x:u.scale,y:f.scale}),h={x:t?m.x.apply(s,{position:"start"}):m.x.rangeMin,y:n?m.y.apply(c,{position:"start"}):m.y.rangeMin},v={x:r?m.x.apply(l,{position:"end"}):m.x.rangeMax,y:a?m.y.apply(d,{position:"end"}):m.y.rangeMax};return Du(i,"discard")&&(!m.isInRange(h)||!m.isInRange(v))?null:sQ(h,v)},MC=function(e){function t(){return hBe(this,t),gBe(this,t,arguments)}return yBe(t,e),pBe(t,[{key:"render",value:function(){var n=this.props,a=n.x1,i=n.x2,s=n.y1,l=n.y2,c=n.className,d=n.alwaysShow,u=n.clipPathId;Gd(d===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=Gi(a),m=Gi(i),h=Gi(s),v=Gi(l),g=this.props.shape;if(!f&&!m&&!h&&!v&&!g)return null;var y=wBe(f,m,h,v,this.props);if(!y&&!g)return null;var x=Du(this.props,"hidden")?"url(#".concat(u,")"):void 0;return ye.createElement(Na,{className:ta("recharts-reference-area",c)},t.renderRect(g,U7(U7({clipPath:x},On(this.props,!0)),y)),as.renderCallByParent(this.props,y))}}])}(ye.Component);DC(MC,"displayName","ReferenceArea");DC(MC,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});DC(MC,"renderRect",function(e,t){var r;return ye.isValidElement(e)?r=ye.cloneElement(e,t):Vn(e)?r=e(t):r=ye.createElement(bD,x3({},t,{className:"recharts-reference-area-rect"})),r});function jQ(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],a=0;a<e.length;a+=t)if(r===void 0||r(e[a])===!0)n.push(e[a]);else return;return n}function jBe(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return y8e(n,r)}function NBe(e,t,r){var n=r==="width",a=e.x,i=e.y,s=e.width,l=e.height;return t===1?{start:n?a:i,end:n?a+s:i+l}:{start:n?a+s:i+l,end:n?a:i}}function y_(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function _Be(e,t){return jQ(e,t+1)}function SBe(e,t,r,n,a){for(var i=(n||[]).slice(),s=t.start,l=t.end,c=0,d=1,u=s,f=function(){var v=n?.[c];if(v===void 0)return{v:jQ(n,d)};var g=c,y,x=function(){return y===void 0&&(y=r(v,g)),y},b=v.coordinate,w=c===0||y_(e,b,x,u,l);w||(c=0,u=s,d+=1),w&&(u=b+e*(x()/2+a),c+=d)},m;d<=i.length;)if(m=f(),m)return m.v;return[]}function c1(e){"@babel/helpers - typeof";return c1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c1(e)}function W7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Bs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?W7(Object(r),!0).forEach(function(n){CBe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CBe(e,t,r){return t=PBe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PBe(e){var t=ABe(e,"string");return c1(t)=="symbol"?t:t+""}function ABe(e,t){if(c1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(c1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function EBe(e,t,r,n,a){for(var i=(n||[]).slice(),s=i.length,l=t.start,c=t.end,d=function(m){var h=i[m],v,g=function(){return v===void 0&&(v=r(h,m)),v};if(m===s-1){var y=e*(h.coordinate+e*g()/2-c);i[m]=h=Bs(Bs({},h),{},{tickCoord:y>0?h.coordinate-y*e:h.coordinate})}else i[m]=h=Bs(Bs({},h),{},{tickCoord:h.coordinate});var x=y_(e,h.tickCoord,g,l,c);x&&(c=h.tickCoord-e*(g()/2+a),i[m]=Bs(Bs({},h),{},{isShow:!0}))},u=s-1;u>=0;u--)d(u);return i}function kBe(e,t,r,n,a,i){var s=(n||[]).slice(),l=s.length,c=t.start,d=t.end;if(i){var u=n[l-1],f=r(u,l-1),m=e*(u.coordinate+e*f/2-d);s[l-1]=u=Bs(Bs({},u),{},{tickCoord:m>0?u.coordinate-m*e:u.coordinate});var h=y_(e,u.tickCoord,function(){return f},c,d);h&&(d=u.tickCoord-e*(f/2+a),s[l-1]=Bs(Bs({},u),{},{isShow:!0}))}for(var v=i?l-1:l,g=function(b){var w=s[b],j,_=function(){return j===void 0&&(j=r(w,b)),j};if(b===0){var C=e*(w.coordinate-e*_()/2-c);s[b]=w=Bs(Bs({},w),{},{tickCoord:C<0?w.coordinate-C*e:w.coordinate})}else s[b]=w=Bs(Bs({},w),{},{tickCoord:w.coordinate});var E=y_(e,w.tickCoord,_,c,d);E&&(c=w.tickCoord+e*(_()/2+a),s[b]=Bs(Bs({},w),{},{isShow:!0}))},y=0;y<v;y++)g(y);return s}function ED(e,t,r){var n=e.tick,a=e.ticks,i=e.viewBox,s=e.minTickGap,l=e.orientation,c=e.interval,d=e.tickFormatter,u=e.unit,f=e.angle;if(!a||!a.length||!n)return[];if(Mr(c)||Kd.isSsr)return _Be(a,typeof c=="number"&&Mr(c)?c:0);var m=[],h=l==="top"||l==="bottom"?"width":"height",v=u&&h==="width"?Ry(u,{fontSize:t,letterSpacing:r}):{width:0,height:0},g=function(w,j){var _=Vn(d)?d(w.value,j):w.value;return h==="width"?jBe(Ry(_,{fontSize:t,letterSpacing:r}),v,f):Ry(_,{fontSize:t,letterSpacing:r})[h]},y=a.length>=2?dl(a[1].coordinate-a[0].coordinate):1,x=NBe(i,y,h);return c==="equidistantPreserveStart"?SBe(y,x,g,a,s):(c==="preserveStart"||c==="preserveStartEnd"?m=kBe(y,x,g,a,s,c==="preserveStartEnd"):m=EBe(y,x,g,a,s),m.filter(function(b){return b.isShow}))}var OBe=["viewBox"],IBe=["viewBox"],TBe=["ticks"];function Px(e){"@babel/helpers - typeof";return Px=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Px(e)}function _v(){return _v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_v.apply(this,arguments)}function H7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $i(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?H7(Object(r),!0).forEach(function(n){kD(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xA(e,t){if(e==null)return{};var r=DBe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function DBe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function MBe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function G7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_Q(n.key),n)}}function RBe(e,t,r){return t&&G7(e.prototype,t),r&&G7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LBe(e,t,r){return t=b_(t),$Be(e,NQ()?Reflect.construct(t,r||[],b_(e).constructor):t.apply(e,r))}function $Be(e,t){if(t&&(Px(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FBe(e)}function FBe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(NQ=function(){return!!e})()}function b_(e){return b_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},b_(e)}function BBe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b3(e,t)}function b3(e,t){return b3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},b3(e,t)}function kD(e,t,r){return t=_Q(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _Q(e){var t=qBe(e,"string");return Px(t)=="symbol"?t:t+""}function qBe(e,t){if(Px(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Px(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var u0=function(e){function t(r){var n;return MBe(this,t),n=LBe(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return BBe(t,e),RBe(t,[{key:"shouldComponentUpdate",value:function(n,a){var i=n.viewBox,s=xA(n,OBe),l=this.props,c=l.viewBox,d=xA(l,IBe);return!Lv(i,c)||!Lv(s,d)||!Lv(a,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var a=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.x,s=a.y,l=a.width,c=a.height,d=a.orientation,u=a.tickSize,f=a.mirror,m=a.tickMargin,h,v,g,y,x,b,w=f?-1:1,j=n.tickSize||u,_=Mr(n.tickCoord)?n.tickCoord:n.coordinate;switch(d){case"top":h=v=n.coordinate,y=s+ +!f*c,g=y-w*j,b=g-w*m,x=_;break;case"left":g=y=n.coordinate,v=i+ +!f*l,h=v-w*j,x=h-w*m,b=_;break;case"right":g=y=n.coordinate,v=i+ +f*l,h=v+w*j,x=h+w*m,b=_;break;default:h=v=n.coordinate,y=s+ +f*c,g=y+w*j,b=g+w*m,x=_;break}return{line:{x1:h,y1:g,x2:v,y2:y},tick:{x,y:b}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,s;switch(a){case"left":s=i?"start":"end";break;case"right":s=i?"end":"start";break;default:s="middle";break}return s}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,s="end";switch(a){case"left":case"right":s="middle";break;case"top":s=i?"start":"end";break;default:s=i?"end":"start";break}return s}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.x,i=n.y,s=n.width,l=n.height,c=n.orientation,d=n.mirror,u=n.axisLine,f=$i($i($i({},On(this.props,!1)),On(u,!1)),{},{fill:"none"});if(c==="top"||c==="bottom"){var m=+(c==="top"&&!d||c==="bottom"&&d);f=$i($i({},f),{},{x1:a,y1:i+m*l,x2:a+s,y2:i+m*l})}else{var h=+(c==="left"&&!d||c==="right"&&d);f=$i($i({},f),{},{x1:a+h*s,y1:i,x2:a+h*s,y2:i+l})}return ye.createElement("line",_v({},f,{className:ta("recharts-cartesian-axis-line",pc(u,"className"))}))}},{key:"renderTicks",value:function(n,a,i){var s=this,l=this.props,c=l.tickLine,d=l.stroke,u=l.tick,f=l.tickFormatter,m=l.unit,h=ED($i($i({},this.props),{},{ticks:n}),a,i),v=this.getTickTextAnchor(),g=this.getTickVerticalAnchor(),y=On(this.props,!1),x=On(u,!1),b=$i($i({},y),{},{fill:"none"},On(c,!1)),w=h.map(function(j,_){var C=s.getTickLineCoord(j),E=C.line,P=C.tick,k=$i($i($i($i({textAnchor:v,verticalAnchor:g},y),{},{stroke:"none",fill:d},x),P),{},{index:_,payload:j,visibleTicksCount:h.length,tickFormatter:f});return ye.createElement(Na,_v({className:"recharts-cartesian-axis-tick",key:"tick-".concat(j.value,"-").concat(j.coordinate,"-").concat(j.tickCoord)},Gp(s.props,j,_)),c&&ye.createElement("line",_v({},b,E,{className:ta("recharts-cartesian-axis-tick-line",pc(c,"className"))})),u&&t.renderTickItem(u,k,"".concat(Vn(f)?f(j.value,_):j.value).concat(m||"")))});return ye.createElement("g",{className:"recharts-cartesian-axis-ticks"},w)}},{key:"render",value:function(){var n=this,a=this.props,i=a.axisLine,s=a.width,l=a.height,c=a.ticksGenerator,d=a.className,u=a.hide;if(u)return null;var f=this.props,m=f.ticks,h=xA(f,TBe),v=m;return Vn(c)&&(v=m&&m.length>0?c(this.props):c(h)),s<=0||l<=0||!v||!v.length?null:ye.createElement(Na,{className:ta("recharts-cartesian-axis",d),ref:function(y){n.layerReference=y}},i&&this.renderAxisLine(),this.renderTicks(v,this.state.fontSize,this.state.letterSpacing),as.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,a,i){var s,l=ta(a.className,"recharts-cartesian-axis-tick-value");return ye.isValidElement(n)?s=ye.cloneElement(n,$i($i({},a),{},{className:l})):Vn(n)?s=n($i($i({},a),{},{className:l})):s=ye.createElement(Kp,_v({},a,{className:"recharts-cartesian-axis-tick-value"}),i),s}}])}(p.Component);kD(u0,"displayName","CartesianAxis");kD(u0,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var zBe=["x1","y1","x2","y2","key"],UBe=["offset"];function Jp(e){"@babel/helpers - typeof";return Jp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jp(e)}function K7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function zs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?K7(Object(r),!0).forEach(function(n){VBe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VBe(e,t,r){return t=WBe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WBe(e){var t=HBe(e,"string");return Jp(t)=="symbol"?t:t+""}function HBe(e,t){if(Jp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Jp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pp(){return pp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pp.apply(this,arguments)}function Y7(e,t){if(e==null)return{};var r=GBe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function GBe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var KBe=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,a=t.x,i=t.y,s=t.width,l=t.height,c=t.ry;return ye.createElement("rect",{x:a,y:i,ry:c,width:s,height:l,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function SQ(e,t){var r;if(ye.isValidElement(e))r=ye.cloneElement(e,t);else if(Vn(e))r=e(t);else{var n=t.x1,a=t.y1,i=t.x2,s=t.y2,l=t.key,c=Y7(t,zBe),d=On(c,!1);d.offset;var u=Y7(d,UBe);r=ye.createElement("line",pp({},u,{x1:n,y1:a,x2:i,y2:s,fill:"none",key:l}))}return r}function YBe(e){var t=e.x,r=e.width,n=e.horizontal,a=n===void 0?!0:n,i=e.horizontalPoints;if(!a||!i||!i.length)return null;var s=i.map(function(l,c){var d=zs(zs({},e),{},{x1:t,y1:l,x2:t+r,y2:l,key:"line-".concat(c),index:c});return SQ(a,d)});return ye.createElement("g",{className:"recharts-cartesian-grid-horizontal"},s)}function XBe(e){var t=e.y,r=e.height,n=e.vertical,a=n===void 0?!0:n,i=e.verticalPoints;if(!a||!i||!i.length)return null;var s=i.map(function(l,c){var d=zs(zs({},e),{},{x1:l,y1:t,x2:l,y2:t+r,key:"line-".concat(c),index:c});return SQ(a,d)});return ye.createElement("g",{className:"recharts-cartesian-grid-vertical"},s)}function JBe(e){var t=e.horizontalFill,r=e.fillOpacity,n=e.x,a=e.y,i=e.width,s=e.height,l=e.horizontalPoints,c=e.horizontal,d=c===void 0?!0:c;if(!d||!t||!t.length)return null;var u=l.map(function(m){return Math.round(m+a-a)}).sort(function(m,h){return m-h});a!==u[0]&&u.unshift(0);var f=u.map(function(m,h){var v=!u[h+1],g=v?a+s-m:u[h+1]-m;if(g<=0)return null;var y=h%t.length;return ye.createElement("rect",{key:"react-".concat(h),y:m,x:n,height:g,width:i,stroke:"none",fill:t[y],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return ye.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},f)}function QBe(e){var t=e.vertical,r=t===void 0?!0:t,n=e.verticalFill,a=e.fillOpacity,i=e.x,s=e.y,l=e.width,c=e.height,d=e.verticalPoints;if(!r||!n||!n.length)return null;var u=d.map(function(m){return Math.round(m+i-i)}).sort(function(m,h){return m-h});i!==u[0]&&u.unshift(0);var f=u.map(function(m,h){var v=!u[h+1],g=v?i+l-m:u[h+1]-m;if(g<=0)return null;var y=h%n.length;return ye.createElement("rect",{key:"react-".concat(h),x:m,y:s,width:g,height:c,stroke:"none",fill:n[y],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return ye.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},f)}var ZBe=function(t,r){var n=t.xAxis,a=t.width,i=t.height,s=t.offset;return jJ(ED(zs(zs(zs({},u0.defaultProps),n),{},{ticks:vf(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),s.left,s.left+s.width,r)},e7e=function(t,r){var n=t.yAxis,a=t.width,i=t.height,s=t.offset;return jJ(ED(zs(zs(zs({},u0.defaultProps),n),{},{ticks:vf(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),s.top,s.top+s.height,r)},Fg={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function w3(e){var t,r,n,a,i,s,l=SD(),c=CD(),d=V8e(),u=zs(zs({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Fg.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:Fg.fill,horizontal:(n=e.horizontal)!==null&&n!==void 0?n:Fg.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:Fg.horizontalFill,vertical:(i=e.vertical)!==null&&i!==void 0?i:Fg.vertical,verticalFill:(s=e.verticalFill)!==null&&s!==void 0?s:Fg.verticalFill,x:Mr(e.x)?e.x:d.left,y:Mr(e.y)?e.y:d.top,width:Mr(e.width)?e.width:d.width,height:Mr(e.height)?e.height:d.height}),f=u.x,m=u.y,h=u.width,v=u.height,g=u.syncWithTicks,y=u.horizontalValues,x=u.verticalValues,b=q8e(),w=z8e();if(!Mr(h)||h<=0||!Mr(v)||v<=0||!Mr(f)||f!==+f||!Mr(m)||m!==+m)return null;var j=u.verticalCoordinatesGenerator||ZBe,_=u.horizontalCoordinatesGenerator||e7e,C=u.horizontalPoints,E=u.verticalPoints;if((!C||!C.length)&&Vn(_)){var P=y&&y.length,k=_({yAxis:w?zs(zs({},w),{},{ticks:P?y:w.ticks}):void 0,width:l,height:c,offset:d},P?!0:g);Gd(Array.isArray(k),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Jp(k),"]")),Array.isArray(k)&&(C=k)}if((!E||!E.length)&&Vn(j)){var M=x&&x.length,S=j({xAxis:b?zs(zs({},b),{},{ticks:M?x:b.ticks}):void 0,width:l,height:c,offset:d},M?!0:g);Gd(Array.isArray(S),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Jp(S),"]")),Array.isArray(S)&&(E=S)}return ye.createElement("g",{className:"recharts-cartesian-grid"},ye.createElement(KBe,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),ye.createElement(YBe,pp({},u,{offset:d,horizontalPoints:C,xAxis:b,yAxis:w})),ye.createElement(XBe,pp({},u,{offset:d,verticalPoints:E,xAxis:b,yAxis:w})),ye.createElement(JBe,pp({},u,{horizontalPoints:C})),ye.createElement(QBe,pp({},u,{verticalPoints:E})))}w3.displayName="CartesianGrid";var t7e=["type","layout","connectNulls","ref"],r7e=["key"];function Ax(e){"@babel/helpers - typeof";return Ax=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ax(e)}function X7(e,t){if(e==null)return{};var r=n7e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function n7e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function zy(){return zy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zy.apply(this,arguments)}function J7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ql(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?J7(Object(r),!0).forEach(function(n){Td(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Bg(e){return s7e(e)||i7e(e)||o7e(e)||a7e()}function a7e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o7e(e,t){if(e){if(typeof e=="string")return j3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return j3(e,t)}}function i7e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function s7e(e){if(Array.isArray(e))return j3(e)}function j3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Q7(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,PQ(n.key),n)}}function c7e(e,t,r){return t&&Q7(e.prototype,t),r&&Q7(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function d7e(e,t,r){return t=w_(t),u7e(e,CQ()?Reflect.construct(t,r||[],w_(e).constructor):t.apply(e,r))}function u7e(e,t){if(t&&(Ax(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return f7e(e)}function f7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(CQ=function(){return!!e})()}function w_(e){return w_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},w_(e)}function m7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N3(e,t)}function N3(e,t){return N3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},N3(e,t)}function Td(e,t,r){return t=PQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PQ(e){var t=h7e(e,"string");return Ax(t)=="symbol"?t:t+""}function h7e(e,t){if(Ax(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ax(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ew=function(e){function t(){var r;l7e(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=d7e(this,t,[].concat(a)),Td(r,"state",{isAnimationFinished:!0,totalLength:0}),Td(r,"generateSimpleStrokeDasharray",function(s,l){return"".concat(l,"px ").concat(s-l,"px")}),Td(r,"getStrokeDasharray",function(s,l,c){var d=c.reduce(function(x,b){return x+b});if(!d)return r.generateSimpleStrokeDasharray(l,s);for(var u=Math.floor(s/d),f=s%d,m=l-s,h=[],v=0,g=0;v<c.length;g+=c[v],++v)if(g+c[v]>f){h=[].concat(Bg(c.slice(0,v)),[f-g]);break}var y=h.length%2===0?[0,m]:[m];return[].concat(Bg(t.repeat(c,u)),Bg(h),y).map(function(x){return"".concat(x,"px")}).join(", ")}),Td(r,"id",hg("recharts-line-")),Td(r,"pathRef",function(s){r.mainCurve=s}),Td(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),Td(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return m7e(t,e),c7e(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,s=i.points,l=i.xAxis,c=i.yAxis,d=i.layout,u=i.children,f=gc(u,Q1);if(!f)return null;var m=function(g,y){return{x:g.x,y:g.y,value:g.value,errorVal:gi(g.payload,y)}},h={clipPath:n?"url(#clipPath-".concat(a,")"):null};return ye.createElement(Na,h,f.map(function(v){return ye.cloneElement(v,{key:"bar-".concat(v.props.dataKey),data:s,xAxis:l,yAxis:c,layout:d,dataPointFormatter:m})}))}},{key:"renderDots",value:function(n,a,i){var s=this.props.isAnimationActive;if(s&&!this.state.isAnimationFinished)return null;var l=this.props,c=l.dot,d=l.points,u=l.dataKey,f=On(this.props,!1),m=On(c,!0),h=d.map(function(g,y){var x=Ql(Ql(Ql({key:"dot-".concat(y),r:3},f),m),{},{index:y,cx:g.x,cy:g.y,value:g.value,dataKey:u,payload:g.payload,points:d});return t.renderDotItem(c,x)}),v={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return ye.createElement(Na,zy({className:"recharts-line-dots",key:"dots"},v),h)}},{key:"renderCurveStatically",value:function(n,a,i,s){var l=this.props,c=l.type,d=l.layout,u=l.connectNulls;l.ref;var f=X7(l,t7e),m=Ql(Ql(Ql({},On(f,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(i,")"):null,points:n},s),{},{type:c,layout:d,connectNulls:u});return ye.createElement(kp,zy({},m,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,a){var i=this,s=this.props,l=s.points,c=s.strokeDasharray,d=s.isAnimationActive,u=s.animationBegin,f=s.animationDuration,m=s.animationEasing,h=s.animationId,v=s.animateNewValues,g=s.width,y=s.height,x=this.state,b=x.prevPoints,w=x.totalLength;return ye.createElement(fh,{begin:u,duration:f,isActive:d,easing:m,from:{t:0},to:{t:1},key:"line-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(j){var _=j.t;if(b){var C=b.length/l.length,E=l.map(function(I,T){var D=Math.floor(T*C);if(b[D]){var B=b[D],U=Vi(B.x,I.x),z=Vi(B.y,I.y);return Ql(Ql({},I),{},{x:U(_),y:z(_)})}if(v){var $=Vi(g*2,I.x),Y=Vi(y/2,I.y);return Ql(Ql({},I),{},{x:$(_),y:Y(_)})}return Ql(Ql({},I),{},{x:I.x,y:I.y})});return i.renderCurveStatically(E,n,a)}var P=Vi(0,w),k=P(_),M;if(c){var S="".concat(c).split(/[,\s]+/gim).map(function(I){return parseFloat(I)});M=i.getStrokeDasharray(k,w,S)}else M=i.generateSimpleStrokeDasharray(w,k);return i.renderCurveStatically(l,n,a,{strokeDasharray:M})})}},{key:"renderCurve",value:function(n,a){var i=this.props,s=i.points,l=i.isAnimationActive,c=this.state,d=c.prevPoints,u=c.totalLength;return l&&s&&s.length&&(!d&&u>0||!Yp(d,s))?this.renderCurveWithAnimation(n,a):this.renderCurveStatically(s,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,s=a.dot,l=a.points,c=a.className,d=a.xAxis,u=a.yAxis,f=a.top,m=a.left,h=a.width,v=a.height,g=a.isAnimationActive,y=a.id;if(i||!l||!l.length)return null;var x=this.state.isAnimationFinished,b=l.length===1,w=ta("recharts-line",c),j=d&&d.allowDataOverflow,_=u&&u.allowDataOverflow,C=j||_,E=Qn(y)?this.id:y,P=(n=On(s,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},k=P.r,M=k===void 0?3:k,S=P.strokeWidth,I=S===void 0?2:S,T=hY(s)?s:{},D=T.clipDot,B=D===void 0?!0:D,U=M*2+I;return ye.createElement(Na,{className:w},j||_?ye.createElement("defs",null,ye.createElement("clipPath",{id:"clipPath-".concat(E)},ye.createElement("rect",{x:j?m:m-h/2,y:_?f:f-v/2,width:j?h:h*2,height:_?v:v*2})),!B&&ye.createElement("clipPath",{id:"clipPath-dots-".concat(E)},ye.createElement("rect",{x:m-U/2,y:f-U/2,width:h+U,height:v+U}))):null,!b&&this.renderCurve(C,E),this.renderErrorBar(C,E),(b||s)&&this.renderDots(C,B,E),(!g||x)&&Tu.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,a){for(var i=n.length%2!==0?[].concat(Bg(n),[0]):n,s=[],l=0;l<a;++l)s=[].concat(Bg(s),Bg(i));return s}},{key:"renderDotItem",value:function(n,a){var i;if(ye.isValidElement(n))i=ye.cloneElement(n,a);else if(Vn(n))i=n(a);else{var s=a.key,l=X7(a,r7e),c=ta("recharts-line-dot",typeof n!="boolean"?n.className:"");i=ye.createElement(Z1,zy({key:s},l,{className:c}))}return i}}])}(p.PureComponent);Td(ew,"displayName","Line");Td(ew,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!Kd.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Td(ew,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,a=e.xAxisTicks,i=e.yAxisTicks,s=e.dataKey,l=e.bandSize,c=e.displayedData,d=e.offset,u=t.layout,f=c.map(function(m,h){var v=gi(m,s);return u==="horizontal"?{x:JN({axis:r,ticks:a,bandSize:l,entry:m,index:h}),y:Qn(v)?null:n.scale(v),value:v,payload:m}:{x:Qn(v)?null:r.scale(v),y:JN({axis:n,ticks:i,bandSize:l,entry:m,index:h}),value:v,payload:m}});return Ql({points:f,layout:u},d)});var p7e=["layout","type","stroke","connectNulls","isRange","ref"],g7e=["key"],AQ;function Ex(e){"@babel/helpers - typeof";return Ex=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ex(e)}function EQ(e,t){if(e==null)return{};var r=v7e(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function v7e(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function gp(){return gp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},gp.apply(this,arguments)}function Z7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function um(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z7(Object(r),!0).forEach(function(n){Su(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function x7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,OQ(n.key),n)}}function y7e(e,t,r){return t&&eq(e.prototype,t),r&&eq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function b7e(e,t,r){return t=j_(t),w7e(e,kQ()?Reflect.construct(t,r||[],j_(e).constructor):t.apply(e,r))}function w7e(e,t){if(t&&(Ex(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return j7e(e)}function j7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kQ=function(){return!!e})()}function j_(e){return j_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},j_(e)}function N7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_3(e,t)}function _3(e,t){return _3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},_3(e,t)}function Su(e,t,r){return t=OQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OQ(e){var t=_7e(e,"string");return Ex(t)=="symbol"?t:t+""}function _7e(e,t){if(Ex(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ex(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ph=function(e){function t(){var r;x7e(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=b7e(this,t,[].concat(a)),Su(r,"state",{isAnimationFinished:!0}),Su(r,"id",hg("recharts-area-")),Su(r,"handleAnimationEnd",function(){var s=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),Vn(s)&&s()}),Su(r,"handleAnimationStart",function(){var s=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),Vn(s)&&s()}),r}return N7e(t,e),y7e(t,[{key:"renderDots",value:function(n,a,i){var s=this.props.isAnimationActive,l=this.state.isAnimationFinished;if(s&&!l)return null;var c=this.props,d=c.dot,u=c.points,f=c.dataKey,m=On(this.props,!1),h=On(d,!0),v=u.map(function(y,x){var b=um(um(um({key:"dot-".concat(x),r:3},m),h),{},{index:x,cx:y.x,cy:y.y,dataKey:f,value:y.value,payload:y.payload,points:u});return t.renderDotItem(d,b)}),g={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return ye.createElement(Na,gp({className:"recharts-area-dots"},g),v)}},{key:"renderHorizontalRect",value:function(n){var a=this.props,i=a.baseLine,s=a.points,l=a.strokeWidth,c=s[0].x,d=s[s.length-1].x,u=n*Math.abs(c-d),f=Am(s.map(function(m){return m.y||0}));return Mr(i)&&typeof i=="number"?f=Math.max(i,f):i&&Array.isArray(i)&&i.length&&(f=Math.max(Am(i.map(function(m){return m.y||0})),f)),Mr(f)?ye.createElement("rect",{x:c<d?c:c-u,y:0,width:u,height:Math.floor(f+(l?parseInt("".concat(l),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var a=this.props,i=a.baseLine,s=a.points,l=a.strokeWidth,c=s[0].y,d=s[s.length-1].y,u=n*Math.abs(c-d),f=Am(s.map(function(m){return m.x||0}));return Mr(i)&&typeof i=="number"?f=Math.max(i,f):i&&Array.isArray(i)&&i.length&&(f=Math.max(Am(i.map(function(m){return m.x||0})),f)),Mr(f)?ye.createElement("rect",{x:0,y:c<d?c:c-u,width:f+(l?parseInt("".concat(l),10):1),height:Math.floor(u)}):null}},{key:"renderClipRect",value:function(n){var a=this.props.layout;return a==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,a,i,s){var l=this.props,c=l.layout,d=l.type,u=l.stroke,f=l.connectNulls,m=l.isRange;l.ref;var h=EQ(l,p7e);return ye.createElement(Na,{clipPath:i?"url(#clipPath-".concat(s,")"):null},ye.createElement(kp,gp({},On(h,!0),{points:n,connectNulls:f,type:d,baseLine:a,layout:c,stroke:"none",className:"recharts-area-area"})),u!=="none"&&ye.createElement(kp,gp({},On(this.props,!1),{className:"recharts-area-curve",layout:c,type:d,connectNulls:f,fill:"none",points:n})),u!=="none"&&m&&ye.createElement(kp,gp({},On(this.props,!1),{className:"recharts-area-curve",layout:c,type:d,connectNulls:f,fill:"none",points:a})))}},{key:"renderAreaWithAnimation",value:function(n,a){var i=this,s=this.props,l=s.points,c=s.baseLine,d=s.isAnimationActive,u=s.animationBegin,f=s.animationDuration,m=s.animationEasing,h=s.animationId,v=this.state,g=v.prevPoints,y=v.prevBaseLine;return ye.createElement(fh,{begin:u,duration:f,isActive:d,easing:m,from:{t:0},to:{t:1},key:"area-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(x){var b=x.t;if(g){var w=g.length/l.length,j=l.map(function(P,k){var M=Math.floor(k*w);if(g[M]){var S=g[M],I=Vi(S.x,P.x),T=Vi(S.y,P.y);return um(um({},P),{},{x:I(b),y:T(b)})}return P}),_;if(Mr(c)&&typeof c=="number"){var C=Vi(y,c);_=C(b)}else if(Qn(c)||a0(c)){var E=Vi(y,0);_=E(b)}else _=c.map(function(P,k){var M=Math.floor(k*w);if(y[M]){var S=y[M],I=Vi(S.x,P.x),T=Vi(S.y,P.y);return um(um({},P),{},{x:I(b),y:T(b)})}return P});return i.renderAreaStatically(j,_,n,a)}return ye.createElement(Na,null,ye.createElement("defs",null,ye.createElement("clipPath",{id:"animationClipPath-".concat(a)},i.renderClipRect(b))),ye.createElement(Na,{clipPath:"url(#animationClipPath-".concat(a,")")},i.renderAreaStatically(l,c,n,a)))})}},{key:"renderArea",value:function(n,a){var i=this.props,s=i.points,l=i.baseLine,c=i.isAnimationActive,d=this.state,u=d.prevPoints,f=d.prevBaseLine,m=d.totalLength;return c&&s&&s.length&&(!u&&m>0||!Yp(u,s)||!Yp(f,l))?this.renderAreaWithAnimation(n,a):this.renderAreaStatically(s,l,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,s=a.dot,l=a.points,c=a.className,d=a.top,u=a.left,f=a.xAxis,m=a.yAxis,h=a.width,v=a.height,g=a.isAnimationActive,y=a.id;if(i||!l||!l.length)return null;var x=this.state.isAnimationFinished,b=l.length===1,w=ta("recharts-area",c),j=f&&f.allowDataOverflow,_=m&&m.allowDataOverflow,C=j||_,E=Qn(y)?this.id:y,P=(n=On(s,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},k=P.r,M=k===void 0?3:k,S=P.strokeWidth,I=S===void 0?2:S,T=hY(s)?s:{},D=T.clipDot,B=D===void 0?!0:D,U=M*2+I;return ye.createElement(Na,{className:w},j||_?ye.createElement("defs",null,ye.createElement("clipPath",{id:"clipPath-".concat(E)},ye.createElement("rect",{x:j?u:u-h/2,y:_?d:d-v/2,width:j?h:h*2,height:_?v:v*2})),!B&&ye.createElement("clipPath",{id:"clipPath-dots-".concat(E)},ye.createElement("rect",{x:u-U/2,y:d-U/2,width:h+U,height:v+U}))):null,b?null:this.renderArea(C,E),(s||b)&&this.renderDots(C,B,E),(!g||x)&&Tu.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:a.curPoints,prevBaseLine:a.curBaseLine}:n.points!==a.curPoints||n.baseLine!==a.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(p.PureComponent);AQ=Ph;Su(Ph,"displayName","Area");Su(Ph,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!Kd.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Su(Ph,"getBaseValue",function(e,t,r,n){var a=e.layout,i=e.baseValue,s=t.props.baseValue,l=s??i;if(Mr(l)&&typeof l=="number")return l;var c=a==="horizontal"?n:r,d=c.scale.domain();if(c.type==="number"){var u=Math.max(d[0],d[1]),f=Math.min(d[0],d[1]);return l==="dataMin"?f:l==="dataMax"||u<0?u:Math.max(Math.min(d[0],d[1]),0)}return l==="dataMin"?d[0]:l==="dataMax"?d[1]:d[0]});Su(Ph,"getComposedData",function(e){var t=e.props,r=e.item,n=e.xAxis,a=e.yAxis,i=e.xAxisTicks,s=e.yAxisTicks,l=e.bandSize,c=e.dataKey,d=e.stackedData,u=e.dataStartIndex,f=e.displayedData,m=e.offset,h=t.layout,v=d&&d.length,g=AQ.getBaseValue(t,r,n,a),y=h==="horizontal",x=!1,b=f.map(function(j,_){var C;v?C=d[u+_]:(C=gi(j,c),Array.isArray(C)?x=!0:C=[g,C]);var E=C[1]==null||v&&gi(j,c)==null;return y?{x:JN({axis:n,ticks:i,bandSize:l,entry:j,index:_}),y:E?null:a.scale(C[1]),value:C,payload:j}:{x:E?null:n.scale(C[1]),y:JN({axis:a,ticks:s,bandSize:l,entry:j,index:_}),value:C,payload:j}}),w;return v||x?w=b.map(function(j){var _=Array.isArray(j.value)?j.value[0]:null;return y?{x:j.x,y:_!=null&&j.y!=null?a.scale(_):null}:{x:_!=null?n.scale(_):null,y:j.y}}):w=y?a.scale(g):n.scale(g),um({points:b,baseLine:w,layout:h,isRange:x},m)});Su(Ph,"renderDotItem",function(e,t){var r;if(ye.isValidElement(e))r=ye.cloneElement(e,t);else if(Vn(e))r=e(t);else{var n=ta("recharts-area-dot",typeof e!="boolean"?e.className:""),a=t.key,i=EQ(t,g7e);r=ye.createElement(Z1,gp({},i,{key:a,className:n}))}return r});function kx(e){"@babel/helpers - typeof";return kx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kx(e)}function S7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,DQ(n.key),n)}}function C7e(e,t,r){return t&&tq(e.prototype,t),r&&tq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function P7e(e,t,r){return t=N_(t),A7e(e,IQ()?Reflect.construct(t,r||[],N_(e).constructor):t.apply(e,r))}function A7e(e,t){if(t&&(kx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return E7e(e)}function E7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(IQ=function(){return!!e})()}function N_(e){return N_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},N_(e)}function k7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S3(e,t)}function S3(e,t){return S3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},S3(e,t)}function TQ(e,t,r){return t=DQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DQ(e){var t=O7e(e,"string");return kx(t)=="symbol"?t:t+""}function O7e(e,t){if(kx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(kx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function C3(){return C3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},C3.apply(this,arguments)}function I7e(e){var t=e.xAxisId,r=SD(),n=CD(),a=hQ(t);return a==null?null:p.createElement(u0,C3({},a,{className:ta("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(s){return vf(s,!0)}}))}var Qp=function(e){function t(){return S7e(this,t),P7e(this,t,arguments)}return k7e(t,e),C7e(t,[{key:"render",value:function(){return p.createElement(I7e,this.props)}}])}(p.Component);TQ(Qp,"displayName","XAxis");TQ(Qp,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Ox(e){"@babel/helpers - typeof";return Ox=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ox(e)}function T7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,LQ(n.key),n)}}function D7e(e,t,r){return t&&rq(e.prototype,t),r&&rq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function M7e(e,t,r){return t=__(t),R7e(e,MQ()?Reflect.construct(t,r||[],__(e).constructor):t.apply(e,r))}function R7e(e,t){if(t&&(Ox(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return L7e(e)}function L7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(MQ=function(){return!!e})()}function __(e){return __=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},__(e)}function $7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P3(e,t)}function P3(e,t){return P3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},P3(e,t)}function RQ(e,t,r){return t=LQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LQ(e){var t=F7e(e,"string");return Ox(t)=="symbol"?t:t+""}function F7e(e,t){if(Ox(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ox(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function A3(){return A3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},A3.apply(this,arguments)}var B7e=function(t){var r=t.yAxisId,n=SD(),a=CD(),i=pQ(r);return i==null?null:p.createElement(u0,A3({},i,{className:ta("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(l){return vf(l,!0)}}))},Zp=function(e){function t(){return T7e(this,t),M7e(this,t,arguments)}return $7e(t,e),D7e(t,[{key:"render",value:function(){return p.createElement(B7e,this.props)}}])}(p.Component);RQ(Zp,"displayName","YAxis");RQ(Zp,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function nq(e){return V7e(e)||U7e(e)||z7e(e)||q7e()}function q7e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function z7e(e,t){if(e){if(typeof e=="string")return E3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return E3(e,t)}}function U7e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function V7e(e){if(Array.isArray(e))return E3(e)}function E3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var k3=function(t,r,n,a,i){var s=gc(t,AD),l=gc(t,TC),c=[].concat(nq(s),nq(l)),d=gc(t,MC),u="".concat(a,"Id"),f=a[0],m=r;if(c.length&&(m=c.reduce(function(g,y){if(y.props[u]===n&&Du(y.props,"extendDomain")&&Mr(y.props[f])){var x=y.props[f];return[Math.min(g[0],x),Math.max(g[1],x)]}return g},m)),d.length){var h="".concat(f,"1"),v="".concat(f,"2");m=d.reduce(function(g,y){if(y.props[u]===n&&Du(y.props,"extendDomain")&&Mr(y.props[h])&&Mr(y.props[v])){var x=y.props[h],b=y.props[v];return[Math.min(g[0],x,b),Math.max(g[1],x,b)]}return g},m)}return i&&i.length&&(m=i.reduce(function(g,y){return Mr(y)?[Math.min(g[0],y),Math.max(g[1],y)]:g},m)),m},$Q={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,d,u){this.fn=c,this.context=d,this.once=u||!1}function i(c,d,u,f,m){if(typeof u!="function")throw new TypeError("The listener must be a function");var h=new a(u,f||c,m),v=r?r+d:d;return c._events[v]?c._events[v].fn?c._events[v]=[c._events[v],h]:c._events[v].push(h):(c._events[v]=h,c._eventsCount++),c}function s(c,d){--c._eventsCount===0?c._events=new n:delete c._events[d]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],u,f;if(this._eventsCount===0)return d;for(f in u=this._events)t.call(u,f)&&d.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(u)):d},l.prototype.listeners=function(d){var u=r?r+d:d,f=this._events[u];if(!f)return[];if(f.fn)return[f.fn];for(var m=0,h=f.length,v=new Array(h);m<h;m++)v[m]=f[m].fn;return v},l.prototype.listenerCount=function(d){var u=r?r+d:d,f=this._events[u];return f?f.fn?1:f.length:0},l.prototype.emit=function(d,u,f,m,h,v){var g=r?r+d:d;if(!this._events[g])return!1;var y=this._events[g],x=arguments.length,b,w;if(y.fn){switch(y.once&&this.removeListener(d,y.fn,void 0,!0),x){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,u),!0;case 3:return y.fn.call(y.context,u,f),!0;case 4:return y.fn.call(y.context,u,f,m),!0;case 5:return y.fn.call(y.context,u,f,m,h),!0;case 6:return y.fn.call(y.context,u,f,m,h,v),!0}for(w=1,b=new Array(x-1);w<x;w++)b[w-1]=arguments[w];y.fn.apply(y.context,b)}else{var j=y.length,_;for(w=0;w<j;w++)switch(y[w].once&&this.removeListener(d,y[w].fn,void 0,!0),x){case 1:y[w].fn.call(y[w].context);break;case 2:y[w].fn.call(y[w].context,u);break;case 3:y[w].fn.call(y[w].context,u,f);break;case 4:y[w].fn.call(y[w].context,u,f,m);break;default:if(!b)for(_=1,b=new Array(x-1);_<x;_++)b[_-1]=arguments[_];y[w].fn.apply(y[w].context,b)}}return!0},l.prototype.on=function(d,u,f){return i(this,d,u,f,!1)},l.prototype.once=function(d,u,f){return i(this,d,u,f,!0)},l.prototype.removeListener=function(d,u,f,m){var h=r?r+d:d;if(!this._events[h])return this;if(!u)return s(this,h),this;var v=this._events[h];if(v.fn)v.fn===u&&(!m||v.once)&&(!f||v.context===f)&&s(this,h);else{for(var g=0,y=[],x=v.length;g<x;g++)(v[g].fn!==u||m&&!v[g].once||f&&v[g].context!==f)&&y.push(v[g]);y.length?this._events[h]=y.length===1?y[0]:y:s(this,h)}return this},l.prototype.removeAllListeners=function(d){var u;return d?(u=r?r+d:d,this._events[u]&&s(this,u)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})($Q);var W7e=$Q.exports;const H7e=qa(W7e);var yA=new H7e,bA="recharts.syncMouseEvents";function d1(e){"@babel/helpers - typeof";return d1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d1(e)}function G7e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,FQ(n.key),n)}}function K7e(e,t,r){return t&&aq(e.prototype,t),r&&aq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wA(e,t,r){return t=FQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FQ(e){var t=Y7e(e,"string");return d1(t)=="symbol"?t:t+""}function Y7e(e,t){if(d1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(d1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var X7e=function(){function e(){G7e(this,e),wA(this,"activeIndex",0),wA(this,"coordinateList",[]),wA(this,"layout","horizontal")}return K7e(e,[{key:"setDetails",value:function(r){var n,a=r.coordinateList,i=a===void 0?null:a,s=r.container,l=s===void 0?null:s,c=r.layout,d=c===void 0?null:c,u=r.offset,f=u===void 0?null:u,m=r.mouseHandlerCallback,h=m===void 0?null:m;this.coordinateList=(n=i??this.coordinateList)!==null&&n!==void 0?n:[],this.container=l??this.container,this.layout=d??this.layout,this.offset=f??this.offset,this.mouseHandlerCallback=h??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),i=a.x,s=a.y,l=a.height,c=this.coordinateList[this.activeIndex].coordinate,d=((r=window)===null||r===void 0?void 0:r.scrollX)||0,u=((n=window)===null||n===void 0?void 0:n.scrollY)||0,f=i+c+d,m=s+this.offset.top+l/2+u;this.mouseHandlerCallback({pageX:f,pageY:m})}}}])}();function J7e(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e?.[0],a=e?.[1];if(n&&a&&Mr(n)&&Mr(a))return!0}return!1}function Q7e(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function BQ(e){var t=e.cx,r=e.cy,n=e.radius,a=e.startAngle,i=e.endAngle,s=_o(t,r,n,a),l=_o(t,r,n,i);return{points:[s,l],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function Z7e(e,t,r){var n,a,i,s;if(e==="horizontal")n=t.x,i=n,a=r.top,s=r.top+r.height;else if(e==="vertical")a=t.y,s=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var l=t.cx,c=t.cy,d=t.innerRadius,u=t.outerRadius,f=t.angle,m=_o(l,c,d,f),h=_o(l,c,u,f);n=m.x,a=m.y,i=h.x,s=h.y}else return BQ(t);return[{x:n,y:a},{x:i,y:s}]}function u1(e){"@babel/helpers - typeof";return u1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u1(e)}function oq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function k2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oq(Object(r),!0).forEach(function(n){eqe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eqe(e,t,r){return t=tqe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tqe(e){var t=rqe(e,"string");return u1(t)=="symbol"?t:t+""}function rqe(e,t){if(u1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(u1(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nqe(e){var t,r,n=e.element,a=e.tooltipEventType,i=e.isActive,s=e.activeCoordinate,l=e.activePayload,c=e.offset,d=e.activeTooltipIndex,u=e.tooltipAxisBandSize,f=e.layout,m=e.chartName,h=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!h||!i||!s||m!=="ScatterChart"&&a!=="axis")return null;var v,g=kp;if(m==="ScatterChart")v=s,g=v6e;else if(m==="BarChart")v=Q7e(f,s,c,u),g=bD;else if(f==="radial"){var y=BQ(s),x=y.cx,b=y.cy,w=y.radius,j=y.startAngle,_=y.endAngle;v={cx:x,cy:b,startAngle:j,endAngle:_,innerRadius:w,outerRadius:w},g=yD}else v={points:Z7e(f,s,c)},g=kp;var C=k2(k2(k2(k2({stroke:"#ccc",pointerEvents:"none"},c),v),On(h,!1)),{},{payload:l,payloadIndex:d,className:ta("recharts-tooltip-cursor",h.className)});return p.isValidElement(h)?p.cloneElement(h,C):p.createElement(g,C)}var aqe=["item"],oqe=["children","className","width","height","style","compact","title","desc"];function Ix(e){"@babel/helpers - typeof";return Ix=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ix(e)}function Sv(){return Sv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sv.apply(this,arguments)}function iq(e,t){return lqe(e)||sqe(e,t)||zQ(e,t)||iqe()}function iqe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sqe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function lqe(e){if(Array.isArray(e))return e}function sq(e,t){if(e==null)return{};var r=cqe(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function cqe(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function dqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lq(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UQ(n.key),n)}}function uqe(e,t,r){return t&&lq(e.prototype,t),r&&lq(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function fqe(e,t,r){return t=S_(t),mqe(e,qQ()?Reflect.construct(t,r||[],S_(e).constructor):t.apply(e,r))}function mqe(e,t){if(t&&(Ix(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hqe(e)}function hqe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qQ=function(){return!!e})()}function S_(e){return S_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},S_(e)}function pqe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O3(e,t)}function O3(e,t){return O3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},O3(e,t)}function Tx(e){return xqe(e)||vqe(e)||zQ(e)||gqe()}function gqe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zQ(e,t){if(e){if(typeof e=="string")return I3(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return I3(e,t)}}function vqe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xqe(e){if(Array.isArray(e))return I3(e)}function I3(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cq(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cq(Object(r),!0).forEach(function(n){zn(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cq(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zn(e,t,r){return t=UQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UQ(e){var t=yqe(e,"string");return Ix(t)=="symbol"?t:t+""}function yqe(e,t){if(Ix(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Ix(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bqe={xAxis:["bottom","top"],yAxis:["left","right"]},wqe={width:"100%",height:"100%"},VQ={x:0,y:0};function O2(e){return e}var jqe=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},Nqe=function(t,r,n,a){var i=r.find(function(u){return u&&u.index===n});if(i){if(t==="horizontal")return{x:i.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:i.coordinate};if(t==="centric"){var s=i.coordinate,l=a.radius;return mr(mr(mr({},a),_o(a.cx,a.cy,l,s)),{},{angle:s,radius:l})}var c=i.coordinate,d=a.angle;return mr(mr(mr({},a),_o(a.cx,a.cy,c,d)),{},{angle:d,radius:c})}return VQ},RC=function(t,r){var n=r.graphicalItems,a=r.dataStartIndex,i=r.dataEndIndex,s=(n??[]).reduce(function(l,c){var d=c.props.data;return d&&d.length?[].concat(Tx(l),Tx(d)):l},[]);return s.length>0?s:t&&t.length&&Mr(a)&&Mr(i)?t.slice(a,i+1):[]};function WQ(e){return e==="number"?[0,"auto"]:void 0}var T3=function(t,r,n,a){var i=t.graphicalItems,s=t.tooltipAxis,l=RC(r,t);return n<0||!i||!i.length||n>=l.length?null:i.reduce(function(c,d){var u,f=(u=d.props.data)!==null&&u!==void 0?u:r;f&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(f=f.slice(t.dataStartIndex,t.dataEndIndex+1));var m;if(s.dataKey&&!s.allowDuplicatedCategory){var h=f===void 0?l:f;m=NN(h,s.dataKey,a)}else m=f&&f[n]||l[n];return m?[].concat(Tx(c),[PJ(d,m)]):c},[])},dq=function(t,r,n,a){var i=a||{x:t.chartX,y:t.chartY},s=jqe(i,n),l=t.orderedTooltipTicks,c=t.tooltipAxis,d=t.tooltipTicks,u=zDe(s,l,d,c);if(u>=0&&d){var f=d[u]&&d[u].value,m=T3(t,r,u,f),h=Nqe(n,l,u,i);return{activeTooltipIndex:u,activeLabel:f,activePayload:m,activeCoordinate:h}}return null},_qe=function(t,r){var n=r.axes,a=r.graphicalItems,i=r.axisType,s=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.layout,f=t.children,m=t.stackOffset,h=wJ(u,i);return n.reduce(function(v,g){var y,x=g.type.defaultProps!==void 0?mr(mr({},g.type.defaultProps),g.props):g.props,b=x.type,w=x.dataKey,j=x.allowDataOverflow,_=x.allowDuplicatedCategory,C=x.scale,E=x.ticks,P=x.includeHidden,k=x[s];if(v[k])return v;var M=RC(t.data,{graphicalItems:a.filter(function(q){var L,W=s in q.props?q.props[s]:(L=q.type.defaultProps)===null||L===void 0?void 0:L[s];return W===k}),dataStartIndex:c,dataEndIndex:d}),S=M.length,I,T,D;J7e(x.domain,j,b)&&(I=WO(x.domain,null,j),h&&(b==="number"||C!=="auto")&&(D=$y(M,w,"category")));var B=WQ(b);if(!I||I.length===0){var U,z=(U=x.domain)!==null&&U!==void 0?U:B;if(w){if(I=$y(M,w,b),b==="category"&&h){var $=Mje(I);_&&$?(T=I,I=u_(0,S)):_||(I=jB(z,I,g).reduce(function(q,L){return q.indexOf(L)>=0?q:[].concat(Tx(q),[L])},[]))}else if(b==="category")_?I=I.filter(function(q){return q!==""&&!Qn(q)}):I=jB(z,I,g).reduce(function(q,L){return q.indexOf(L)>=0||L===""||Qn(L)?q:[].concat(Tx(q),[L])},[]);else if(b==="number"){var Y=GDe(M,a.filter(function(q){var L,W,ne=s in q.props?q.props[s]:(L=q.type.defaultProps)===null||L===void 0?void 0:L[s],le="hide"in q.props?q.props.hide:(W=q.type.defaultProps)===null||W===void 0?void 0:W.hide;return ne===k&&(P||!le)}),w,i,u);Y&&(I=Y)}h&&(b==="number"||C!=="auto")&&(D=$y(M,w,"category"))}else h?I=u_(0,S):l&&l[k]&&l[k].hasStack&&b==="number"?I=m==="expand"?[0,1]:CJ(l[k].stackGroups,c,d):I=bJ(M,a.filter(function(q){var L=s in q.props?q.props[s]:q.type.defaultProps[s],W="hide"in q.props?q.props.hide:q.type.defaultProps.hide;return L===k&&(P||!W)}),b,u,!0);if(b==="number")I=k3(f,I,k,i,E),z&&(I=WO(z,I,j));else if(b==="category"&&z){var de=z,xe=I.every(function(q){return de.indexOf(q)>=0});xe&&(I=de)}}return mr(mr({},v),{},zn({},k,mr(mr({},x),{},{axisType:i,domain:I,categoricalDomain:D,duplicateDomain:T,originalDomain:(y=x.domain)!==null&&y!==void 0?y:B,isCategorical:h,layout:u})))},{})},Sqe=function(t,r){var n=r.graphicalItems,a=r.Axis,i=r.axisType,s=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.layout,f=t.children,m=RC(t.data,{graphicalItems:n,dataStartIndex:c,dataEndIndex:d}),h=m.length,v=wJ(u,i),g=-1;return n.reduce(function(y,x){var b=x.type.defaultProps!==void 0?mr(mr({},x.type.defaultProps),x.props):x.props,w=b[s],j=WQ("number");if(!y[w]){g++;var _;return v?_=u_(0,h):l&&l[w]&&l[w].hasStack?(_=CJ(l[w].stackGroups,c,d),_=k3(f,_,w,i)):(_=WO(j,bJ(m,n.filter(function(C){var E,P,k=s in C.props?C.props[s]:(E=C.type.defaultProps)===null||E===void 0?void 0:E[s],M="hide"in C.props?C.props.hide:(P=C.type.defaultProps)===null||P===void 0?void 0:P.hide;return k===w&&!M}),"number",u),a.defaultProps.allowDataOverflow),_=k3(f,_,w,i)),mr(mr({},y),{},zn({},w,mr(mr({axisType:i},a.defaultProps),{},{hide:!0,orientation:pc(bqe,"".concat(i,".").concat(g%2),null),domain:_,originalDomain:j,isCategorical:v,layout:u})))}return y},{})},Cqe=function(t,r){var n=r.axisType,a=n===void 0?"xAxis":n,i=r.AxisComp,s=r.graphicalItems,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.children,f="".concat(a,"Id"),m=gc(u,i),h={};return m&&m.length?h=_qe(t,{axes:m,graphicalItems:s,axisType:a,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:d}):s&&s.length&&(h=Sqe(t,{Axis:i,graphicalItems:s,axisType:a,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:d})),h},Pqe=function(t){var r=bm(t),n=vf(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:HT(n,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:QN(r,n)}},uq=function(t){var r=t.children,n=t.defaultShowTooltip,a=ac(r,jx),i=0,s=0;return t.data&&t.data.length!==0&&(s=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(i=a.props.startIndex),a.props.endIndex>=0&&(s=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:s,activeTooltipIndex:-1,isTooltipActive:!!n}},Aqe=function(t){return!t||!t.length?!1:t.some(function(r){var n=jf(r&&r.type);return n&&n.indexOf("Bar")>=0})},fq=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},Eqe=function(t,r){var n=t.props,a=t.graphicalItems,i=t.xAxisMap,s=i===void 0?{}:i,l=t.yAxisMap,c=l===void 0?{}:l,d=n.width,u=n.height,f=n.children,m=n.margin||{},h=ac(f,jx),v=ac(f,Pp),g=Object.keys(c).reduce(function(_,C){var E=c[C],P=E.orientation;return!E.mirror&&!E.hide?mr(mr({},_),{},zn({},P,_[P]+E.width)):_},{left:m.left||0,right:m.right||0}),y=Object.keys(s).reduce(function(_,C){var E=s[C],P=E.orientation;return!E.mirror&&!E.hide?mr(mr({},_),{},zn({},P,pc(_,"".concat(P))+E.height)):_},{top:m.top||0,bottom:m.bottom||0}),x=mr(mr({},y),g),b=x.bottom;h&&(x.bottom+=h.props.height||jx.defaultProps.height),v&&r&&(x=WDe(x,a,n,r));var w=d-x.left-x.right,j=u-x.top-x.bottom;return mr(mr({brushBottom:b},x),{},{width:Math.max(w,0),height:Math.max(j,0)})},kqe=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},LC=function(t){var r=t.chartName,n=t.GraphicalChild,a=t.defaultTooltipEventType,i=a===void 0?"axis":a,s=t.validateTooltipEventTypes,l=s===void 0?["axis"]:s,c=t.axisComponents,d=t.legendContent,u=t.formatAxisMap,f=t.defaultProps,m=function(x,b){var w=b.graphicalItems,j=b.stackGroups,_=b.offset,C=b.updateId,E=b.dataStartIndex,P=b.dataEndIndex,k=x.barSize,M=x.layout,S=x.barGap,I=x.barCategoryGap,T=x.maxBarSize,D=fq(M),B=D.numericAxisName,U=D.cateAxisName,z=Aqe(w),$=[];return w.forEach(function(Y,de){var xe=RC(x.data,{graphicalItems:[Y],dataStartIndex:E,dataEndIndex:P}),q=Y.type.defaultProps!==void 0?mr(mr({},Y.type.defaultProps),Y.props):Y.props,L=q.dataKey,W=q.maxBarSize,ne=q["".concat(B,"Id")],le=q["".concat(U,"Id")],K={},Q=c.reduce(function(yt,Nr){var se=b["".concat(Nr.axisType,"Map")],rt=q["".concat(Nr.axisType,"Id")];se&&se[rt]||Nr.axisType==="zAxis"||uh(!1);var mt=se[rt];return mr(mr({},yt),{},zn(zn({},Nr.axisType,mt),"".concat(Nr.axisType,"Ticks"),vf(mt)))},K),re=Q[U],G=Q["".concat(U,"Ticks")],me=j&&j[ne]&&j[ne].hasStack&&rMe(Y,j[ne].stackGroups),pe=jf(Y.type).indexOf("Bar")>=0,Be=QN(re,G),Z=[],ee=z&&UDe({barSize:k,stackGroups:j,totalSize:kqe(Q,U)});if(pe){var kt,Nt,De=Qn(W)?T:W,st=(kt=(Nt=QN(re,G,!0))!==null&&Nt!==void 0?Nt:De)!==null&&kt!==void 0?kt:0;Z=VDe({barGap:S,barCategoryGap:I,bandSize:st!==Be?st:Be,sizeList:ee[le],maxBarSize:De}),st!==Be&&(Z=Z.map(function(yt){return mr(mr({},yt),{},{position:mr(mr({},yt.position),{},{offset:yt.position.offset-st/2})})}))}var ft=Y&&Y.type&&Y.type.getComposedData;ft&&$.push({props:mr(mr({},ft(mr(mr({},Q),{},{displayedData:xe,props:x,dataKey:L,item:Y,bandSize:Be,barPosition:Z,offset:_,stackedData:me,layout:M,dataStartIndex:E,dataEndIndex:P}))),{},zn(zn(zn({key:Y.key||"item-".concat(de)},B,Q[B]),U,Q[U]),"animationId",C)),childIndex:Gje(Y,x.children),item:Y})}),$},h=function(x,b){var w=x.props,j=x.dataStartIndex,_=x.dataEndIndex,C=x.updateId;if(!fF({props:w}))return null;var E=w.children,P=w.layout,k=w.stackOffset,M=w.data,S=w.reverseStackOrder,I=fq(P),T=I.numericAxisName,D=I.cateAxisName,B=gc(E,n),U=eMe(M,B,"".concat(T,"Id"),"".concat(D,"Id"),k,S),z=c.reduce(function(q,L){var W="".concat(L.axisType,"Map");return mr(mr({},q),{},zn({},W,Cqe(w,mr(mr({},L),{},{graphicalItems:B,stackGroups:L.axisType===T&&U,dataStartIndex:j,dataEndIndex:_}))))},{}),$=Eqe(mr(mr({},z),{},{props:w,graphicalItems:B}),b?.legendBBox);Object.keys(z).forEach(function(q){z[q]=u(w,z[q],$,q.replace("Map",""),r)});var Y=z["".concat(D,"Map")],de=Pqe(Y),xe=m(w,mr(mr({},z),{},{dataStartIndex:j,dataEndIndex:_,updateId:C,graphicalItems:B,stackGroups:U,offset:$}));return mr(mr({formattedGraphicalItems:xe,graphicalItems:B,offset:$,stackGroups:U},de),z)},v=function(y){function x(b){var w,j,_;return dqe(this,x),_=fqe(this,x,[b]),zn(_,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),zn(_,"accessibilityManager",new X7e),zn(_,"handleLegendBBoxUpdate",function(C){if(C){var E=_.state,P=E.dataStartIndex,k=E.dataEndIndex,M=E.updateId;_.setState(mr({legendBBox:C},h({props:_.props,dataStartIndex:P,dataEndIndex:k,updateId:M},mr(mr({},_.state),{},{legendBBox:C}))))}}),zn(_,"handleReceiveSyncEvent",function(C,E,P){if(_.props.syncId===C){if(P===_.eventEmitterSymbol&&typeof _.props.syncMethod!="function")return;_.applySyncEvent(E)}}),zn(_,"handleBrushChange",function(C){var E=C.startIndex,P=C.endIndex;if(E!==_.state.dataStartIndex||P!==_.state.dataEndIndex){var k=_.state.updateId;_.setState(function(){return mr({dataStartIndex:E,dataEndIndex:P},h({props:_.props,dataStartIndex:E,dataEndIndex:P,updateId:k},_.state))}),_.triggerSyncEvent({dataStartIndex:E,dataEndIndex:P})}}),zn(_,"handleMouseEnter",function(C){var E=_.getMouseInfo(C);if(E){var P=mr(mr({},E),{},{isTooltipActive:!0});_.setState(P),_.triggerSyncEvent(P);var k=_.props.onMouseEnter;Vn(k)&&k(P,C)}}),zn(_,"triggeredAfterMouseMove",function(C){var E=_.getMouseInfo(C),P=E?mr(mr({},E),{},{isTooltipActive:!0}):{isTooltipActive:!1};_.setState(P),_.triggerSyncEvent(P);var k=_.props.onMouseMove;Vn(k)&&k(P,C)}),zn(_,"handleItemMouseEnter",function(C){_.setState(function(){return{isTooltipActive:!0,activeItem:C,activePayload:C.tooltipPayload,activeCoordinate:C.tooltipPosition||{x:C.cx,y:C.cy}}})}),zn(_,"handleItemMouseLeave",function(){_.setState(function(){return{isTooltipActive:!1}})}),zn(_,"handleMouseMove",function(C){C.persist(),_.throttleTriggeredAfterMouseMove(C)}),zn(_,"handleMouseLeave",function(C){_.throttleTriggeredAfterMouseMove.cancel();var E={isTooltipActive:!1};_.setState(E),_.triggerSyncEvent(E);var P=_.props.onMouseLeave;Vn(P)&&P(E,C)}),zn(_,"handleOuterEvent",function(C){var E=Hje(C),P=pc(_.props,"".concat(E));if(E&&Vn(P)){var k,M;/.*touch.*/i.test(E)?M=_.getMouseInfo(C.changedTouches[0]):M=_.getMouseInfo(C),P((k=M)!==null&&k!==void 0?k:{},C)}}),zn(_,"handleClick",function(C){var E=_.getMouseInfo(C);if(E){var P=mr(mr({},E),{},{isTooltipActive:!0});_.setState(P),_.triggerSyncEvent(P);var k=_.props.onClick;Vn(k)&&k(P,C)}}),zn(_,"handleMouseDown",function(C){var E=_.props.onMouseDown;if(Vn(E)){var P=_.getMouseInfo(C);E(P,C)}}),zn(_,"handleMouseUp",function(C){var E=_.props.onMouseUp;if(Vn(E)){var P=_.getMouseInfo(C);E(P,C)}}),zn(_,"handleTouchMove",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&_.throttleTriggeredAfterMouseMove(C.changedTouches[0])}),zn(_,"handleTouchStart",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&_.handleMouseDown(C.changedTouches[0])}),zn(_,"handleTouchEnd",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&_.handleMouseUp(C.changedTouches[0])}),zn(_,"handleDoubleClick",function(C){var E=_.props.onDoubleClick;if(Vn(E)){var P=_.getMouseInfo(C);E(P,C)}}),zn(_,"handleContextMenu",function(C){var E=_.props.onContextMenu;if(Vn(E)){var P=_.getMouseInfo(C);E(P,C)}}),zn(_,"triggerSyncEvent",function(C){_.props.syncId!==void 0&&yA.emit(bA,_.props.syncId,C,_.eventEmitterSymbol)}),zn(_,"applySyncEvent",function(C){var E=_.props,P=E.layout,k=E.syncMethod,M=_.state.updateId,S=C.dataStartIndex,I=C.dataEndIndex;if(C.dataStartIndex!==void 0||C.dataEndIndex!==void 0)_.setState(mr({dataStartIndex:S,dataEndIndex:I},h({props:_.props,dataStartIndex:S,dataEndIndex:I,updateId:M},_.state)));else if(C.activeTooltipIndex!==void 0){var T=C.chartX,D=C.chartY,B=C.activeTooltipIndex,U=_.state,z=U.offset,$=U.tooltipTicks;if(!z)return;if(typeof k=="function")B=k($,C);else if(k==="value"){B=-1;for(var Y=0;Y<$.length;Y++)if($[Y].value===C.activeLabel){B=Y;break}}var de=mr(mr({},z),{},{x:z.left,y:z.top}),xe=Math.min(T,de.x+de.width),q=Math.min(D,de.y+de.height),L=$[B]&&$[B].value,W=T3(_.state,_.props.data,B),ne=$[B]?{x:P==="horizontal"?$[B].coordinate:xe,y:P==="horizontal"?q:$[B].coordinate}:VQ;_.setState(mr(mr({},C),{},{activeLabel:L,activeCoordinate:ne,activePayload:W,activeTooltipIndex:B}))}else _.setState(C)}),zn(_,"renderCursor",function(C){var E,P=_.state,k=P.isTooltipActive,M=P.activeCoordinate,S=P.activePayload,I=P.offset,T=P.activeTooltipIndex,D=P.tooltipAxisBandSize,B=_.getTooltipEventType(),U=(E=C.props.active)!==null&&E!==void 0?E:k,z=_.props.layout,$=C.key||"_recharts-cursor";return ye.createElement(nqe,{key:$,activeCoordinate:M,activePayload:S,activeTooltipIndex:T,chartName:r,element:C,isActive:U,layout:z,offset:I,tooltipAxisBandSize:D,tooltipEventType:B})}),zn(_,"renderPolarAxis",function(C,E,P){var k=pc(C,"type.axisType"),M=pc(_.state,"".concat(k,"Map")),S=C.type.defaultProps,I=S!==void 0?mr(mr({},S),C.props):C.props,T=M&&M[I["".concat(k,"Id")]];return p.cloneElement(C,mr(mr({},T),{},{className:ta(k,T.className),key:C.key||"".concat(E,"-").concat(P),ticks:vf(T,!0)}))}),zn(_,"renderPolarGrid",function(C){var E=C.props,P=E.radialLines,k=E.polarAngles,M=E.polarRadius,S=_.state,I=S.radiusAxisMap,T=S.angleAxisMap,D=bm(I),B=bm(T),U=B.cx,z=B.cy,$=B.innerRadius,Y=B.outerRadius;return p.cloneElement(C,{polarAngles:Array.isArray(k)?k:vf(B,!0).map(function(de){return de.coordinate}),polarRadius:Array.isArray(M)?M:vf(D,!0).map(function(de){return de.coordinate}),cx:U,cy:z,innerRadius:$,outerRadius:Y,key:C.key||"polar-grid",radialLines:P})}),zn(_,"renderLegend",function(){var C=_.state.formattedGraphicalItems,E=_.props,P=E.children,k=E.width,M=E.height,S=_.props.margin||{},I=k-(S.left||0)-(S.right||0),T=xJ({children:P,formattedGraphicalItems:C,legendWidth:I,legendContent:d});if(!T)return null;var D=T.item,B=sq(T,aqe);return p.cloneElement(D,mr(mr({},B),{},{chartWidth:k,chartHeight:M,margin:S,onBBoxUpdate:_.handleLegendBBoxUpdate}))}),zn(_,"renderTooltip",function(){var C,E=_.props,P=E.children,k=E.accessibilityLayer,M=ac(P,oc);if(!M)return null;var S=_.state,I=S.isTooltipActive,T=S.activeCoordinate,D=S.activePayload,B=S.activeLabel,U=S.offset,z=(C=M.props.active)!==null&&C!==void 0?C:I;return p.cloneElement(M,{viewBox:mr(mr({},U),{},{x:U.left,y:U.top}),active:z,label:B,payload:z?D:[],coordinate:T,accessibilityLayer:k})}),zn(_,"renderBrush",function(C){var E=_.props,P=E.margin,k=E.data,M=_.state,S=M.offset,I=M.dataStartIndex,T=M.dataEndIndex,D=M.updateId;return p.cloneElement(C,{key:C.key||"_recharts-brush",onChange:C2(_.handleBrushChange,C.props.onChange),data:k,x:Mr(C.props.x)?C.props.x:S.left,y:Mr(C.props.y)?C.props.y:S.top+S.height+S.brushBottom-(P.bottom||0),width:Mr(C.props.width)?C.props.width:S.width,startIndex:I,endIndex:T,updateId:"brush-".concat(D)})}),zn(_,"renderReferenceElement",function(C,E,P){if(!C)return null;var k=_,M=k.clipPathId,S=_.state,I=S.xAxisMap,T=S.yAxisMap,D=S.offset,B=C.type.defaultProps||{},U=C.props,z=U.xAxisId,$=z===void 0?B.xAxisId:z,Y=U.yAxisId,de=Y===void 0?B.yAxisId:Y;return p.cloneElement(C,{key:C.key||"".concat(E,"-").concat(P),xAxis:I[$],yAxis:T[de],viewBox:{x:D.left,y:D.top,width:D.width,height:D.height},clipPathId:M})}),zn(_,"renderActivePoints",function(C){var E=C.item,P=C.activePoint,k=C.basePoint,M=C.childIndex,S=C.isRange,I=[],T=E.props.key,D=E.item.type.defaultProps!==void 0?mr(mr({},E.item.type.defaultProps),E.item.props):E.item.props,B=D.activeDot,U=D.dataKey,z=mr(mr({index:M,dataKey:U,cx:P.x,cy:P.y,r:4,fill:xD(E.item),strokeWidth:2,stroke:"#fff",payload:P.payload,value:P.value},On(B,!1)),_N(B));return I.push(x.renderActiveDot(B,z,"".concat(T,"-activePoint-").concat(M))),k?I.push(x.renderActiveDot(B,mr(mr({},z),{},{cx:k.x,cy:k.y}),"".concat(T,"-basePoint-").concat(M))):S&&I.push(null),I}),zn(_,"renderGraphicChild",function(C,E,P){var k=_.filterFormatItem(C,E,P);if(!k)return null;var M=_.getTooltipEventType(),S=_.state,I=S.isTooltipActive,T=S.tooltipAxis,D=S.activeTooltipIndex,B=S.activeLabel,U=_.props.children,z=ac(U,oc),$=k.props,Y=$.points,de=$.isRange,xe=$.baseLine,q=k.item.type.defaultProps!==void 0?mr(mr({},k.item.type.defaultProps),k.item.props):k.item.props,L=q.activeDot,W=q.hide,ne=q.activeBar,le=q.activeShape,K=!!(!W&&I&&z&&(L||ne||le)),Q={};M!=="axis"&&z&&z.props.trigger==="click"?Q={onClick:C2(_.handleItemMouseEnter,C.props.onClick)}:M!=="axis"&&(Q={onMouseLeave:C2(_.handleItemMouseLeave,C.props.onMouseLeave),onMouseEnter:C2(_.handleItemMouseEnter,C.props.onMouseEnter)});var re=p.cloneElement(C,mr(mr({},k.props),Q));function G(Nr){return typeof T.dataKey=="function"?T.dataKey(Nr.payload):null}if(K)if(D>=0){var me,pe;if(T.dataKey&&!T.allowDuplicatedCategory){var Be=typeof T.dataKey=="function"?G:"payload.".concat(T.dataKey.toString());me=NN(Y,Be,B),pe=de&&xe&&NN(xe,Be,B)}else me=Y?.[D],pe=de&&xe&&xe[D];if(le||ne){var Z=C.props.activeIndex!==void 0?C.props.activeIndex:D;return[p.cloneElement(C,mr(mr(mr({},k.props),Q),{},{activeIndex:Z})),null,null]}if(!Qn(me))return[re].concat(Tx(_.renderActivePoints({item:k,activePoint:me,basePoint:pe,childIndex:D,isRange:de})))}else{var ee,kt=(ee=_.getItemByXY(_.state.activeCoordinate))!==null&&ee!==void 0?ee:{graphicalItem:re},Nt=kt.graphicalItem,De=Nt.item,st=De===void 0?C:De,ft=Nt.childIndex,yt=mr(mr(mr({},k.props),Q),{},{activeIndex:ft});return[p.cloneElement(st,yt),null,null]}return de?[re,null,null]:[re,null]}),zn(_,"renderCustomized",function(C,E,P){return p.cloneElement(C,mr(mr({key:"recharts-customized-".concat(P)},_.props),_.state))}),zn(_,"renderMap",{CartesianGrid:{handler:O2,once:!0},ReferenceArea:{handler:_.renderReferenceElement},ReferenceLine:{handler:O2},ReferenceDot:{handler:_.renderReferenceElement},XAxis:{handler:O2},YAxis:{handler:O2},Brush:{handler:_.renderBrush,once:!0},Bar:{handler:_.renderGraphicChild},Line:{handler:_.renderGraphicChild},Area:{handler:_.renderGraphicChild},Radar:{handler:_.renderGraphicChild},RadialBar:{handler:_.renderGraphicChild},Scatter:{handler:_.renderGraphicChild},Pie:{handler:_.renderGraphicChild},Funnel:{handler:_.renderGraphicChild},Tooltip:{handler:_.renderCursor,once:!0},PolarGrid:{handler:_.renderPolarGrid,once:!0},PolarAngleAxis:{handler:_.renderPolarAxis},PolarRadiusAxis:{handler:_.renderPolarAxis},Customized:{handler:_.renderCustomized}}),_.clipPathId="".concat((w=b.id)!==null&&w!==void 0?w:hg("recharts"),"-clip"),_.throttleTriggeredAfterMouseMove=vX(_.triggeredAfterMouseMove,(j=b.throttleDelay)!==null&&j!==void 0?j:1e3/60),_.state={},_}return pqe(x,y),uqe(x,[{key:"componentDidMount",value:function(){var w,j;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(w=this.props.margin.left)!==null&&w!==void 0?w:0,top:(j=this.props.margin.top)!==null&&j!==void 0?j:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var w=this.props,j=w.children,_=w.data,C=w.height,E=w.layout,P=ac(j,oc);if(P){var k=P.props.defaultIndex;if(!(typeof k!="number"||k<0||k>this.state.tooltipTicks.length-1)){var M=this.state.tooltipTicks[k]&&this.state.tooltipTicks[k].value,S=T3(this.state,_,k,M),I=this.state.tooltipTicks[k].coordinate,T=(this.state.offset.top+C)/2,D=E==="horizontal",B=D?{x:I,y:T}:{y:I,x:T},U=this.state.formattedGraphicalItems.find(function($){var Y=$.item;return Y.type.name==="Scatter"});U&&(B=mr(mr({},B),U.props.points[k].tooltipPosition),S=U.props.points[k].tooltipPayload);var z={activeTooltipIndex:k,isTooltipActive:!0,activeLabel:M,activePayload:S,activeCoordinate:B};this.setState(z),this.renderCursor(P),this.accessibilityManager.setIndex(k)}}}},{key:"getSnapshotBeforeUpdate",value:function(w,j){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==j.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==w.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==w.margin){var _,C;this.accessibilityManager.setDetails({offset:{left:(_=this.props.margin.left)!==null&&_!==void 0?_:0,top:(C=this.props.margin.top)!==null&&C!==void 0?C:0}})}return null}},{key:"componentDidUpdate",value:function(w){iO([ac(w.children,oc)],[ac(this.props.children,oc)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var w=ac(this.props.children,oc);if(w&&typeof w.props.shared=="boolean"){var j=w.props.shared?"axis":"item";return l.indexOf(j)>=0?j:i}return i}},{key:"getMouseInfo",value:function(w){if(!this.container)return null;var j=this.container,_=j.getBoundingClientRect(),C=g3e(_),E={chartX:Math.round(w.pageX-C.left),chartY:Math.round(w.pageY-C.top)},P=_.width/j.offsetWidth||1,k=this.inRange(E.chartX,E.chartY,P);if(!k)return null;var M=this.state,S=M.xAxisMap,I=M.yAxisMap,T=this.getTooltipEventType(),D=dq(this.state,this.props.data,this.props.layout,k);if(T!=="axis"&&S&&I){var B=bm(S).scale,U=bm(I).scale,z=B&&B.invert?B.invert(E.chartX):null,$=U&&U.invert?U.invert(E.chartY):null;return mr(mr({},E),{},{xValue:z,yValue:$},D)}return D?mr(mr({},E),D):null}},{key:"inRange",value:function(w,j){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,C=this.props.layout,E=w/_,P=j/_;if(C==="horizontal"||C==="vertical"){var k=this.state.offset,M=E>=k.left&&E<=k.left+k.width&&P>=k.top&&P<=k.top+k.height;return M?{x:E,y:P}:null}var S=this.state,I=S.angleAxisMap,T=S.radiusAxisMap;if(I&&T){var D=bm(I);return SB({x:E,y:P},D)}return null}},{key:"parseEventsOfWrapper",value:function(){var w=this.props.children,j=this.getTooltipEventType(),_=ac(w,oc),C={};_&&j==="axis"&&(_.props.trigger==="click"?C={onClick:this.handleClick}:C={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var E=_N(this.props,this.handleOuterEvent);return mr(mr({},E),C)}},{key:"addListener",value:function(){yA.on(bA,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){yA.removeListener(bA,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(w,j,_){for(var C=this.state.formattedGraphicalItems,E=0,P=C.length;E<P;E++){var k=C[E];if(k.item===w||k.props.key===w.key||j===jf(k.item.type)&&_===k.childIndex)return k}return null}},{key:"renderClipPath",value:function(){var w=this.clipPathId,j=this.state.offset,_=j.left,C=j.top,E=j.height,P=j.width;return ye.createElement("defs",null,ye.createElement("clipPath",{id:w},ye.createElement("rect",{x:_,y:C,height:E,width:P})))}},{key:"getXScales",value:function(){var w=this.state.xAxisMap;return w?Object.entries(w).reduce(function(j,_){var C=iq(_,2),E=C[0],P=C[1];return mr(mr({},j),{},zn({},E,P.scale))},{}):null}},{key:"getYScales",value:function(){var w=this.state.yAxisMap;return w?Object.entries(w).reduce(function(j,_){var C=iq(_,2),E=C[0],P=C[1];return mr(mr({},j),{},zn({},E,P.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(w){var j;return(j=this.state.xAxisMap)===null||j===void 0||(j=j[w])===null||j===void 0?void 0:j.scale}},{key:"getYScaleByAxisId",value:function(w){var j;return(j=this.state.yAxisMap)===null||j===void 0||(j=j[w])===null||j===void 0?void 0:j.scale}},{key:"getItemByXY",value:function(w){var j=this.state,_=j.formattedGraphicalItems,C=j.activeItem;if(_&&_.length)for(var E=0,P=_.length;E<P;E++){var k=_[E],M=k.props,S=k.item,I=S.type.defaultProps!==void 0?mr(mr({},S.type.defaultProps),S.props):S.props,T=jf(S.type);if(T==="Bar"){var D=(M.data||[]).find(function($){return JLe(w,$)});if(D)return{graphicalItem:k,payload:D}}else if(T==="RadialBar"){var B=(M.data||[]).find(function($){return SB(w,$)});if(B)return{graphicalItem:k,payload:B}}else if(EC(k,C)||kC(k,C)||o1(k,C)){var U=F$e({graphicalItem:k,activeTooltipItem:C,itemData:I.data}),z=I.activeIndex===void 0?U:I.activeIndex;return{graphicalItem:mr(mr({},k),{},{childIndex:z}),payload:o1(k,C)?I.data[U]:k.props.data[U]}}}return null}},{key:"render",value:function(){var w=this;if(!fF(this))return null;var j=this.props,_=j.children,C=j.className,E=j.width,P=j.height,k=j.style,M=j.compact,S=j.title,I=j.desc,T=sq(j,oqe),D=On(T,!1);if(M)return ye.createElement(D7,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},ye.createElement(lO,Sv({},D,{width:E,height:P,title:S,desc:I}),this.renderClipPath(),hF(_,this.renderMap)));if(this.props.accessibilityLayer){var B,U;D.tabIndex=(B=this.props.tabIndex)!==null&&B!==void 0?B:0,D.role=(U=this.props.role)!==null&&U!==void 0?U:"application",D.onKeyDown=function($){w.accessibilityManager.keyboardEvent($)},D.onFocus=function(){w.accessibilityManager.focus()}}var z=this.parseEventsOfWrapper();return ye.createElement(D7,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},ye.createElement("div",Sv({className:ta("recharts-wrapper",C),style:mr({position:"relative",cursor:"default",width:E,height:P},k)},z,{ref:function(Y){w.container=Y}}),ye.createElement(lO,Sv({},D,{width:E,height:P,title:S,desc:I,style:wqe}),this.renderClipPath(),hF(_,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(p.Component);zn(v,"displayName",r),zn(v,"defaultProps",mr({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},f)),zn(v,"getDerivedStateFromProps",function(y,x){var b=y.dataKey,w=y.data,j=y.children,_=y.width,C=y.height,E=y.layout,P=y.stackOffset,k=y.margin,M=x.dataStartIndex,S=x.dataEndIndex;if(x.updateId===void 0){var I=uq(y);return mr(mr(mr({},I),{},{updateId:0},h(mr(mr({props:y},I),{},{updateId:0}),x)),{},{prevDataKey:b,prevData:w,prevWidth:_,prevHeight:C,prevLayout:E,prevStackOffset:P,prevMargin:k,prevChildren:j})}if(b!==x.prevDataKey||w!==x.prevData||_!==x.prevWidth||C!==x.prevHeight||E!==x.prevLayout||P!==x.prevStackOffset||!Lv(k,x.prevMargin)){var T=uq(y),D={chartX:x.chartX,chartY:x.chartY,isTooltipActive:x.isTooltipActive},B=mr(mr({},dq(x,w,E)),{},{updateId:x.updateId+1}),U=mr(mr(mr({},T),D),B);return mr(mr(mr({},U),h(mr({props:y},U),x)),{},{prevDataKey:b,prevData:w,prevWidth:_,prevHeight:C,prevLayout:E,prevStackOffset:P,prevMargin:k,prevChildren:j})}if(!iO(j,x.prevChildren)){var z,$,Y,de,xe=ac(j,jx),q=xe&&(z=($=xe.props)===null||$===void 0?void 0:$.startIndex)!==null&&z!==void 0?z:M,L=xe&&(Y=(de=xe.props)===null||de===void 0?void 0:de.endIndex)!==null&&Y!==void 0?Y:S,W=q!==M||L!==S,ne=!Qn(w),le=ne&&!W?x.updateId:x.updateId+1;return mr(mr({updateId:le},h(mr(mr({props:y},x),{},{updateId:le,dataStartIndex:q,dataEndIndex:L}),x)),{},{prevChildren:j,dataStartIndex:q,dataEndIndex:L})}return null}),zn(v,"renderActiveDot",function(y,x,b){var w;return p.isValidElement(y)?w=p.cloneElement(y,x):Vn(y)?w=y(x):w=ye.createElement(Z1,x),ye.createElement(Na,{className:"recharts-active-dot",key:b},w)});var g=p.forwardRef(function(x,b){return ye.createElement(v,Sv({},x,{ref:b}))});return g.displayName=v.displayName,g},Oqe=LC({chartName:"LineChart",GraphicalChild:ew,axisComponents:[{axisType:"xAxis",AxisComp:Qp},{axisType:"yAxis",AxisComp:Zp}],formatAxisMap:wD}),Iqe=LC({chartName:"BarChart",GraphicalChild:xg,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:Qp},{axisType:"yAxis",AxisComp:Zp}],formatAxisMap:wD}),Tqe=LC({chartName:"PieChart",GraphicalChild:Fu,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:AC},{axisType:"radiusAxis",AxisComp:CC}],formatAxisMap:fMe,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),Dqe=LC({chartName:"AreaChart",GraphicalChild:Ph,axisComponents:[{axisType:"xAxis",AxisComp:Qp},{axisType:"yAxis",AxisComp:Zp}],formatAxisMap:wD});const mq=({icon:e,title:t,value:r,trend:n,trendValue:a,color:i,className:s,loading:l})=>{const c=n==="up"?II:Dde,d=n==="up"?"text-success":"text-danger";return o.jsx(fr.div,{variants:{hidden:{opacity:0,y:30,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{duration:.5,ease:[.22,1,.36,1]}}},className:`fx-card group flex flex-col justify-between ${s}`,children:o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("div",{className:"flex items-center justify-center h-10 w-10 rounded-md border border-white/10 bg-white/5 transition-colors duration-300 group-hover:border-brand/50 group-hover:bg-brand/10",style:{color:`var(--${i})`},children:o.jsx(e,{className:"h-5 w-5"})}),!l&&n&&a&&o.jsxs("div",{className:`flex items-center text-xs font-bold ${d}`,children:[o.jsx(c,{className:"w-3.5 h-3.5 mr-1"}),o.jsx("span",{children:a})]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs font-semibold text-text-secondary uppercase tracking-wider mb-2",children:t}),l?o.jsx("div",{className:"h-9 bg-white/5 rounded animate-pulse"}):o.jsx("p",{className:"text-3xl font-bold text-text-primary tabular-nums tracking-tight",children:r})]})]})})},Mqe=({alerts:e,className:t})=>{const r=Pc(),[n,a]=p.useState(!1),i=u=>({Package:ud,DollarSign:Ui,CalendarCheck:TI,Clock:Vd,ShoppingCart:$1,Store:RI,Users:cl,CalendarPlus:DI,AlertTriangle:Af,Info:rH})[u]||Af,s=u=>({danger:"text-danger",warning:"text-warning",info:"text-info",success:"text-success",purple:"text-purple"})[u]||"text-warning",l=e.length>2?e.slice(0,2):e,c=e.length>2,d=({alert:u,onClick:f})=>{const m=i(u.icone),h=s(u.cor);return o.jsxs("li",{className:"flex items-center gap-2 p-2 rounded-md hover:bg-white/5 transition-colors cursor-pointer group",onClick:f,children:[o.jsx(m,{className:`w-4 h-4 flex-shrink-0 ${h}`}),o.jsx("span",{className:"text-text-secondary group-hover:text-text-primary transition-colors flex-1",children:u.mensagem}),u.link&&o.jsx(II,{className:"w-3 h-3 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]})};return o.jsxs(o.Fragment,{children:[o.jsxs(fr.div,{variants:{hidden:{opacity:0,y:30,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{duration:.5,ease:[.22,1,.36,1]}}},className:`fx-card ${t||""}`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("h2",{className:"text-lg font-bold text-text-primary flex items-center",children:[o.jsx(oN,{className:"mr-2 h-5 w-5 text-brand"})," Alertas do Dia"]}),c&&o.jsx(oe,{variant:"ghost",size:"sm",className:"text-xs text-brand hover:text-brand/80",onClick:()=>a(!0),children:"Ver todos"})]}),e.length===0?o.jsx("p",{className:"text-sm text-text-muted",children:"Nenhum alerta no momento! "}):o.jsx("ul",{className:"space-y-2 text-sm",children:l.map((u,f)=>o.jsx(d,{alert:u,onClick:()=>u.link&&r(u.link)},f))})]}),o.jsx(ln,{open:n,onOpenChange:a,children:o.jsxs(on,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[o.jsx(nn,{children:o.jsxs(rn,{className:"flex items-center gap-2",children:[o.jsx(oN,{className:"h-5 w-5 text-brand"}),"Todos os Alertas (",e.length,")"]})}),o.jsx("div",{className:"mt-4",children:e.length===0?o.jsx("p",{className:"text-sm text-text-muted text-center py-8",children:"Nenhum alerta no momento! "}):o.jsx("ul",{className:"space-y-2 text-sm",children:e.map((u,f)=>o.jsx(d,{alert:u,onClick:()=>{u.link&&(r(u.link),a(!1))}},f))})})]})})]})},Rqe=({title:e,icon:t,data:r,color:n,className:a,loading:i})=>{const s=r.reduce((d,u)=>d+(u.receita||0),0),l=r.reduce((d,u)=>d+(u.despesa||0),0),c=s-l;return o.jsxs(fr.div,{variants:{hidden:{opacity:0,y:30,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{duration:.5,ease:[.22,1,.36,1]}}},className:`fx-card group ${a||""}`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("div",{className:"flex items-center justify-center h-10 w-10 rounded-md border border-white/10 bg-white/5 transition-colors duration-300 group-hover:border-brand/50 group-hover:bg-brand/10 mr-3",style:{color:`var(--${n})`},children:o.jsx(t,{className:"h-5 w-5"})}),o.jsx("h3",{className:"text-base font-bold text-text-primary flex-1",children:e}),o.jsx("div",{className:"text-xs font-semibold text-text-muted",children:"ltimos 14 dias"})]}),o.jsx("div",{className:"mb-2",children:o.jsx(xj,{width:"100%",height:90,children:o.jsxs(Dqe,{data:r,margin:{top:4,right:0,left:0,bottom:0},children:[o.jsx(oc,{cursor:{stroke:"var(--border)",strokeDasharray:"3 3"},contentStyle:{background:"rgba(10, 10, 10, 0.85)",borderColor:"var(--border)",color:"var(--text-primary)",borderRadius:"var(--radius-sm)"},formatter:(d,u)=>u==="saldo"?[`R$ ${d.toLocaleString("pt-BR")}`,"Saldo"]:d,labelFormatter:d=>d}),o.jsx(Ph,{type:"monotone",dataKey:"saldo",stroke:"var(--brand)",strokeWidth:2,fill:"var(--brand)",fillOpacity:.15})]})})}),o.jsxs("div",{className:"grid grid-cols-3 gap-3 text-xs",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-text-secondary",children:"Receita"}),i?o.jsx("div",{className:"h-5 w-20 bg-white/5 rounded animate-pulse mt-1"}):o.jsxs("p",{className:"font-bold text-success tabular-nums",children:["R$ ",s.toLocaleString("pt-BR")]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-text-secondary",children:"Despesa"}),i?o.jsx("div",{className:"h-5 w-20 bg-white/5 rounded animate-pulse mt-1"}):o.jsxs("p",{className:"font-bold text-danger tabular-nums",children:["R$ ",l.toLocaleString("pt-BR")]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-text-secondary",children:"Saldo"}),i?o.jsx("div",{className:"h-5 w-20 bg-white/5 rounded animate-pulse mt-1"}):o.jsxs("p",{className:"font-bold text-text-primary tabular-nums",children:["R$ ",c.toLocaleString("pt-BR")]})]})]})]})},Lqe=({title:e,icon:t,data:r,color:n,className:a,loading:i})=>o.jsxs(fr.div,{variants:{hidden:{opacity:0,y:30,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{duration:.5,ease:[.22,1,.36,1]}}},className:`fx-card group flex flex-col ${a||""}`,children:[o.jsxs("div",{className:"flex items-center mb-4",children:[o.jsx("div",{className:"flex items-center justify-center h-10 w-10 rounded-md border border-white/10 bg-white/5 transition-colors duration-300 group-hover:border-brand/50 group-hover:bg-brand/10 mr-3",style:{color:`var(--${n})`},children:o.jsx(t,{className:"h-5 w-5"})}),o.jsx("h3",{className:"text-base font-bold text-text-primary",children:e})]}),o.jsx("div",{className:"space-y-3 mt-auto",children:i?Array.from({length:3}).map((s,l)=>o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsx("div",{className:"h-4 w-24 bg-white/5 rounded animate-pulse"}),o.jsx("div",{className:"h-4 w-12 bg-white/5 rounded animate-pulse"})]},l)):r.map((s,l)=>o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsx("span",{className:"text-text-secondary",children:s.name}),o.jsx("span",{className:"font-bold text-text-primary tabular-nums",children:s.value})]},l))})]}),$qe={hidden:{opacity:0},visible:{opacity:1,transition:{when:"beforeChildren",staggerChildren:.1,delayChildren:.2}}},jA={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.6,ease:[.22,1,.36,1]}}};function Fqe(){const{toast:e}=oo(),{userProfile:t}=Do(),n=WS()?.alerts||[],a=Pc(),[i,s]=p.useState(!0),[l,c]=p.useState(0),[d,u]=p.useState({finalizados:0,total:0}),[f,m]=p.useState(0),[h,v]=p.useState(0),[g,y]=p.useState(0),[x,b]=p.useState(0),[w,j]=p.useState(0),[_,C]=p.useState(0),[E,P]=p.useState([]);p.useEffect(()=>{(async()=>{if(!t?.codigo_empresa){console.log("[DashboardPage] Aguardando autenticao..."),s(!1);return}console.log("[DashboardPage] Iniciando carregamento de dados...");try{s(!0);const I=t.codigo_empresa,T=new Date,D=ni(T).toISOString(),B=vj(T).toISOString();console.log("[Dashboard] 1. Buscando pagamentos...");const{data:U}=await ve.from("pagamentos").select("valor, status").eq("codigo_empresa",I).gte("recebido_em",D).lte("recebido_em",B);console.log("[Dashboard]  Pagamentos carregados:",U?.length||0);const z=(U||[]).filter(se=>!["Cancelado","Estornado"].includes(se.status)).reduce((se,rt)=>se+Number(rt.valor||0),0);console.log("[Dashboard] 2. Buscando agendamentos de hoje...");const{data:$}=await ve.from("agendamentos").select("id").eq("codigo_empresa",I).gte("inicio",D).lte("inicio",B);console.log("[Dashboard]  Agendamentos de hoje:",$?.length||0);let Y=0;if($&&$.length>0){console.log("[Dashboard] 3. Buscando participantes pagos...");const se=$.map(mt=>mt.id),{data:rt}=await ve.from("agendamento_participantes").select("valor_cota, status_pagamento, aplicar_taxa, finalizadora_id, finalizadoras!agp_finalizadora_id_fkey(taxa_percentual)").eq("codigo_empresa",I).in("agendamento_id",se).eq("status_pagamento","Pago");console.log("[Dashboard]  Participantes pagos:",rt?.length||0),Y=(rt||[]).reduce((mt,tr)=>{let Ce=Number(tr.valor_cota||0);if(tr.aplicar_taxa===!0){const je=Number(tr.finalizadoras?.taxa_percentual||0);je>0&&(Ce=Ce/(1+je/100))}return mt+Ce},0)}const de=z+Y;c(de),console.log("[Dashboard] 4. Buscando agendamentos completos...");const{data:xe}=await ve.from("agendamentos").select("id, status, inicio, fim").eq("codigo_empresa",I).gte("inicio",D).lte("inicio",B);console.log("[Dashboard]  Agendamentos completos:",xe?.length||0);const q=(xe||[]).filter(se=>se.status==="finished").length;u({finalizados:q,total:xe?.length||0});const L=new Date().toISOString(),W=(xe||[]).filter(se=>se.inicio>L&&!["canceled","finished"].includes(se.status)).length;m(W);const ne=(xe||[]).filter(se=>se.status==="in_progress").length;v(ne),console.log("[Dashboard] 5. Buscando quadras...");const{data:le}=await ve.from("quadras").select("id").eq("codigo_empresa",I);console.log("[Dashboard]  Quadras:",le?.length||0);const re=(le?.length||0)*17;let G=0;for(const se of xe||[])if(!["canceled","no_show"].includes(se.status))if(se.inicio&&se.fim){const rt=new Date(se.inicio),Ce=(new Date(se.fim)-rt)/(1e3*60*60);G+=Ce}else G+=1;const me=re>0?Math.round(G/re*100):0;y(me),console.log("[Dashboard] 6. Buscando comandas abertas...");const{data:pe}=await ve.from("comandas").select("id").eq("codigo_empresa",I).eq("status","open");console.log("[Dashboard]  Comandas abertas:",pe?.length||0),b(pe?.length||0),console.log("[Dashboard] 7. Buscando mesas...");const{data:Be}=await ve.from("mesas").select("id, status").eq("codigo_empresa",I);console.log("[Dashboard]  Mesas:",Be?.length||0);const Z=(Be||[]).filter(se=>["in-use","awaiting-payment"].includes(se.status)).length;j(Z),console.log("[Dashboard] 8. Buscando vendas da loja...");const{data:ee}=await ve.from("comandas").select("id").eq("codigo_empresa",I).eq("status","closed").gte("fechado_em",D).lte("fechado_em",B);console.log("[Dashboard]  Vendas da loja:",ee?.length||0),C(ee?.length||0),console.log("[Dashboard] 9. Buscando dados dos ltimos 14 dias...");const kt=new Date;kt.setDate(kt.getDate()-13);const Nt=ni(kt).toISOString(),De=vj(T).toISOString(),{data:st}=await ve.from("pagamentos").select("valor, status, recebido_em").eq("codigo_empresa",I).gte("recebido_em",Nt).lte("recebido_em",De);console.log("[Dashboard]  Pagamentos 14 dias:",st?.length||0);const{data:ft}=await ve.from("agendamentos").select("id, inicio").eq("codigo_empresa",I).gte("inicio",Nt).lte("inicio",De);console.log("[Dashboard]  Agendamentos 14 dias:",ft?.length||0);let yt=[];if(ft&&ft.length>0){const se=ft.map(mt=>mt.id),{data:rt}=await ve.from("agendamento_participantes").select("valor_cota, agendamento_id").eq("codigo_empresa",I).in("agendamento_id",se).eq("status_pagamento","Pago");yt=rt||[],console.log("[Dashboard]  Participantes pagos 14 dias:",yt.length)}const Nr=[];for(let se=13;se>=0;se--){const rt=new Date;rt.setDate(rt.getDate()-se);const mt=ni(rt),tr=vj(rt),Ce=(st||[]).filter(Ae=>{const Tt=new Date(Ae.recebido_em);return Tt>=mt&&Tt<=tr&&!["Cancelado","Estornado"].includes(Ae.status)}).reduce((Ae,Tt)=>Ae+Number(Tt.valor||0),0),je=(ft||[]).filter(Ae=>{const Tt=new Date(Ae.inicio);return Tt>=mt&&Tt<=tr}).map(Ae=>Ae.id),ae=yt.filter(Ae=>je.includes(Ae.agendamento_id)).reduce((Ae,Tt)=>Ae+Number(Tt.valor_cota||0),0),$e=Ce+ae;Nr.push({name:se===0?"Hoje":`${se}d`,saldo:Math.round($e),receita:Math.round($e),despesa:0})}console.log("[Dashboard]  Dados de 14 dias carregados"),P(Nr)}catch(I){console.error("[DashboardPage]  Erro ao carregar dashboard:",I),e({title:"Erro ao carregar dashboard",description:I?.message||"Tente recarregar a pgina",variant:"destructive"})}finally{console.log("[DashboardPage]  Carregamento concludo"),s(!1)}})()},[t?.codigo_empresa]);const k=S=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(S||0)),M=[{name:"Comandas Abertas",value:x},{name:"Mesas Ocupadas",value:w},{name:"Vendas Hoje",value:_}];return o.jsx(o.Fragment,{children:o.jsxs(fr.div,{variants:$qe,initial:"hidden",animate:"visible",className:"space-y-4",children:[o.jsxs(fr.div,{variants:jA,className:"relative grid grid-cols-1 xl:grid-cols-12 gap-4 items-start",children:[o.jsx("div",{className:"xl:col-span-8",children:o.jsxs("div",{className:"bg-surface/70 backdrop-blur-sm relative p-4 rounded-xl border border-white/10 overflow-hidden shadow-1",children:[o.jsx("div",{className:"absolute inset-0 bg-court-pattern opacity-[0.03] mix-blend-overlay"}),o.jsxs("div",{className:"relative z-10 max-w-[720px]",children:[o.jsxs("h1",{className:"text-3xl font-black mb-2 text-text-primary tracking-tighter",children:["Bem-vindo de volta, ",o.jsxs("span",{className:"text-brand",children:[(t?.nome_exibicao||t?.nome||t?.email?.split("@")[0]||"Admin").split(" ")[0],"!"]})]}),o.jsx("p",{className:"text-text-secondary mb-3 max-w-[60ch] text-sm md:text-base font-normal",children:"Sua central de comando para uma gesto de sucesso. Monitore agendamentos, faturamento e clientes em um s lugar."}),o.jsxs("div",{className:"flex flex-wrap gap-2.5",children:[o.jsxs(oe,{onClick:()=>a("/agenda",{state:{openModal:!0}}),size:"default",children:[o.jsx(DI,{className:"mr-2 h-4 w-4"}),"+ Agendamento"]}),o.jsxs(oe,{onClick:()=>a("/clientes",{state:{openModal:!0}}),variant:"outline",size:"default",children:[o.jsx(cl,{className:"mr-2 h-4 w-4"}),"Adicionar Cliente"]})]})]})]})}),o.jsx("div",{className:"xl:col-span-4",children:o.jsxs("div",{className:"fx-card",children:[o.jsxs("h2",{className:"text-lg font-bold text-text-primary mb-3 flex items-center",children:[o.jsx(Vd,{className:"mr-2 h-5 w-5 text-brand"})," Resumo do Dia"]}),o.jsxs("ul",{className:"space-y-2 text-sm",children:[o.jsxs("li",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-text-secondary",children:"Prximas Reservas"}),i?o.jsx("div",{className:"h-6 w-12 bg-white/5 rounded animate-pulse"}):o.jsx("span",{className:"font-bold text-text-primary tabular-nums",children:f})]}),o.jsxs("li",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-text-secondary",children:"Quadras em Uso"}),i?o.jsx("div",{className:"h-6 w-12 bg-white/5 rounded animate-pulse"}):o.jsx("span",{className:"font-bold text-success tabular-nums",children:h})]}),o.jsxs("li",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-text-secondary",children:"Taxa de Ocupao"}),i?o.jsx("div",{className:"h-6 w-16 bg-white/5 rounded animate-pulse"}):o.jsxs("span",{className:`font-bold tabular-nums ${g>=70?"text-success":g>=40?"text-warning":"text-danger"}`,children:[g,"%"]})]})]})]})})]}),o.jsxs(fr.div,{variants:jA,className:"relative grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-12 gap-4 items-stretch",children:[o.jsx("div",{className:"xl:col-span-3",children:o.jsx(mq,{icon:Ui,title:"Faturamento do Dia",value:k(l),color:"success",className:"h-full",loading:i})}),o.jsx("div",{className:"xl:col-span-3",children:o.jsx(mq,{icon:TI,title:"Agend. Finalizados",value:`${d.finalizados} de ${d.total}`,color:"info",className:"h-full",loading:i})}),o.jsx("div",{className:"xl:col-span-3",children:o.jsx(Mqe,{className:"h-full",alerts:n})}),o.jsx("div",{className:"xl:col-span-3",children:o.jsx(Lqe,{icon:RI,title:"Informaes da Loja",data:M,color:"purple",className:"h-full",loading:i})})]}),o.jsx(fr.div,{variants:jA,className:"grid grid-cols-1 gap-4",children:o.jsx(Rqe,{icon:Up,title:"Resumo Financeiro",data:E,color:"brand",loading:i})})]})})}var Bqe={lessThanXSeconds:{one:"menos de um segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"meio minuto",lessThanXMinutes:{one:"menos de um minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"cerca de 1 hora",other:"cerca de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 dia",other:"{{count}} dias"},aboutXWeeks:{one:"cerca de 1 semana",other:"cerca de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"cerca de 1 ms",other:"cerca de {{count}} meses"},xMonths:{one:"1 ms",other:"{{count}} meses"},aboutXYears:{one:"cerca de 1 ano",other:"cerca de {{count}} anos"},xYears:{one:"1 ano",other:"{{count}} anos"},overXYears:{one:"mais de 1 ano",other:"mais de {{count}} anos"},almostXYears:{one:"quase 1 ano",other:"quase {{count}} anos"}},qqe=function(t,r,n){var a,i=Bqe[t];return typeof i=="string"?a=i:r===1?a=i.one:a=i.other.replace("{{count}}",String(r)),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"em "+a:"h "+a:a};const zqe=qqe;var Uqe={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/yyyy"},Vqe={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},Wqe={full:"{{date}} 's' {{time}}",long:"{{date}} 's' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Hqe={date:Rv({formats:Uqe,defaultWidth:"full"}),time:Rv({formats:Vqe,defaultWidth:"full"}),dateTime:Rv({formats:Wqe,defaultWidth:"full"})};const Gqe=Hqe;var Kqe={lastWeek:function(t){var r=t.getUTCDay(),n=r===0||r===6?"ltimo":"ltima";return"'"+n+"' eeee 's' p"},yesterday:"'ontem s' p",today:"'hoje s' p",tomorrow:"'amanh s' p",nextWeek:"eeee 's' p",other:"P"},Yqe=function(t,r,n,a){var i=Kqe[t];return typeof i=="function"?i(r):i};const Xqe=Yqe;var Jqe={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","depois de cristo"]},Qqe={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1 trimestre","2 trimestre","3 trimestre","4 trimestre"]},Zqe={narrow:["j","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],wide:["janeiro","fevereiro","maro","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]},eze={narrow:["D","S","T","Q","Q","S","S"],short:["dom","seg","ter","qua","qui","sex","sab"],abbreviated:["domingo","segunda","tera","quarta","quinta","sexta","sbado"],wide:["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"]},tze={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"}},rze={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"}},nze=function(t,r){var n=Number(t);return r?.unit==="week"?n+"":n+""},aze={ordinalNumber:nze,era:yu({values:Jqe,defaultWidth:"wide"}),quarter:yu({values:Qqe,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:yu({values:Zqe,defaultWidth:"wide"}),day:yu({values:eze,defaultWidth:"wide"}),dayPeriod:yu({values:tze,defaultWidth:"wide",formattingValues:rze,defaultFormattingWidth:"wide"})};const oze=aze;var ize=/^(\d+)[o]?/i,sze=/\d+/i,lze={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|d\.?\s?c\.?)/i,wide:/^(antes de cristo|depois de cristo)/i},cze={any:[/^ac/i,/^dc/i],wide:[/^antes de cristo/i,/^depois de cristo/i]},dze={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234]()? trimestre/i},uze={any:[/1/i,/2/i,/3/i,/4/i]},fze={narrow:/^[jfmajsond]/i,abbreviated:/^(jan|fev|mar|abr|mai|jun|jul|ago|set|out|nov|dez)/i,wide:/^(janeiro|fevereiro|maro|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)/i},mze={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^fev/i,/^mar/i,/^abr/i,/^mai/i,/^jun/i,/^jul/i,/^ago/i,/^set/i,/^out/i,/^nov/i,/^dez/i]},hze={narrow:/^(dom|[23456]?|s[a]b)/i,short:/^(dom|[23456]?|s[a]b)/i,abbreviated:/^(dom|seg|ter|qua|qui|sex|s[a]b)/i,wide:/^(domingo|(segunda|ter[c]a|quarta|quinta|sexta)([- ]feira)?|s[a]bado)/i},pze={short:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],narrow:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],any:[/^d/i,/^seg/i,/^t/i,/^qua/i,/^qui/i,/^sex/i,/^s[a]b/i]},gze={narrow:/^(a|p|mn|md|(da) (manh|tarde|noite))/i,any:/^([ap]\.?\s?m\.?|meia[-\s]noite|meio[-\s]dia|(da) (manh|tarde|noite))/i},vze={any:{am:/^a/i,pm:/^p/i,midnight:/^mn|^meia[-\s]noite/i,noon:/^md|^meio[-\s]dia/i,morning:/manh/i,afternoon:/tarde/i,evening:/tarde/i,night:/noite/i}},xze={ordinalNumber:KK({matchPattern:ize,parsePattern:sze,valueCallback:function(t){return parseInt(t,10)}}),era:bu({matchPatterns:lze,defaultMatchWidth:"wide",parsePatterns:cze,defaultParseWidth:"any"}),quarter:bu({matchPatterns:dze,defaultMatchWidth:"wide",parsePatterns:uze,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:bu({matchPatterns:fze,defaultMatchWidth:"wide",parsePatterns:mze,defaultParseWidth:"any"}),day:bu({matchPatterns:hze,defaultMatchWidth:"wide",parsePatterns:pze,defaultParseWidth:"any"}),dayPeriod:bu({matchPatterns:gze,defaultMatchWidth:"any",parsePatterns:vze,defaultParseWidth:"any"})};const yze=xze;var bze={code:"pt-BR",formatDistance:zqe,formatLong:Gqe,formatRelative:Xqe,localize:oze,match:yze,options:{weekStartsOn:0,firstWeekContainsDate:1}};const ia=bze,wze=["top","right","bottom","left"],mh=Math.min,ic=Math.max,C_=Math.round,I2=Math.floor,Mu=e=>({x:e,y:e}),jze={left:"right",right:"left",bottom:"top",top:"bottom"},Nze={start:"end",end:"start"};function D3(e,t,r){return ic(e,mh(t,r))}function Df(e,t){return typeof e=="function"?e(t):e}function Mf(e){return e.split("-")[0]}function f0(e){return e.split("-")[1]}function OD(e){return e==="x"?"y":"x"}function ID(e){return e==="y"?"height":"width"}const _ze=new Set(["top","bottom"]);function Cu(e){return _ze.has(Mf(e))?"y":"x"}function TD(e){return OD(Cu(e))}function Sze(e,t,r){r===void 0&&(r=!1);const n=f0(e),a=TD(e),i=ID(a);let s=a==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(s=P_(s)),[s,P_(s)]}function Cze(e){const t=P_(e);return[M3(e),t,M3(t)]}function M3(e){return e.replace(/start|end/g,t=>Nze[t])}const hq=["left","right"],pq=["right","left"],Pze=["top","bottom"],Aze=["bottom","top"];function Eze(e,t,r){switch(e){case"top":case"bottom":return r?t?pq:hq:t?hq:pq;case"left":case"right":return t?Pze:Aze;default:return[]}}function kze(e,t,r,n){const a=f0(e);let i=Eze(Mf(e),r==="start",n);return a&&(i=i.map(s=>s+"-"+a),t&&(i=i.concat(i.map(M3)))),i}function P_(e){return e.replace(/left|right|bottom|top/g,t=>jze[t])}function Oze(e){return{top:0,right:0,bottom:0,left:0,...e}}function HQ(e){return typeof e!="number"?Oze(e):{top:e,right:e,bottom:e,left:e}}function A_(e){const{x:t,y:r,width:n,height:a}=e;return{width:n,height:a,top:r,left:t,right:t+n,bottom:r+a,x:t,y:r}}function gq(e,t,r){let{reference:n,floating:a}=e;const i=Cu(t),s=TD(t),l=ID(s),c=Mf(t),d=i==="y",u=n.x+n.width/2-a.width/2,f=n.y+n.height/2-a.height/2,m=n[l]/2-a[l]/2;let h;switch(c){case"top":h={x:u,y:n.y-a.height};break;case"bottom":h={x:u,y:n.y+n.height};break;case"right":h={x:n.x+n.width,y:f};break;case"left":h={x:n.x-a.width,y:f};break;default:h={x:n.x,y:n.y}}switch(f0(t)){case"start":h[s]-=m*(r&&d?-1:1);break;case"end":h[s]+=m*(r&&d?-1:1);break}return h}const Ize=async(e,t,r)=>{const{placement:n="bottom",strategy:a="absolute",middleware:i=[],platform:s}=r,l=i.filter(Boolean),c=await(s.isRTL==null?void 0:s.isRTL(t));let d=await s.getElementRects({reference:e,floating:t,strategy:a}),{x:u,y:f}=gq(d,n,c),m=n,h={},v=0;for(let g=0;g<l.length;g++){const{name:y,fn:x}=l[g],{x:b,y:w,data:j,reset:_}=await x({x:u,y:f,initialPlacement:n,placement:m,strategy:a,middlewareData:h,rects:d,platform:s,elements:{reference:e,floating:t}});u=b??u,f=w??f,h={...h,[y]:{...h[y],...j}},_&&v<=50&&(v++,typeof _=="object"&&(_.placement&&(m=_.placement),_.rects&&(d=_.rects===!0?await s.getElementRects({reference:e,floating:t,strategy:a}):_.rects),{x:u,y:f}=gq(d,m,c)),g=-1)}return{x:u,y:f,placement:m,strategy:a,middlewareData:h}};async function f1(e,t){var r;t===void 0&&(t={});const{x:n,y:a,platform:i,rects:s,elements:l,strategy:c}=e,{boundary:d="clippingAncestors",rootBoundary:u="viewport",elementContext:f="floating",altBoundary:m=!1,padding:h=0}=Df(t,e),v=HQ(h),y=l[m?f==="floating"?"reference":"floating":f],x=A_(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(y)))==null||r?y:y.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:d,rootBoundary:u,strategy:c})),b=f==="floating"?{x:n,y:a,width:s.floating.width,height:s.floating.height}:s.reference,w=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),j=await(i.isElement==null?void 0:i.isElement(w))?await(i.getScale==null?void 0:i.getScale(w))||{x:1,y:1}:{x:1,y:1},_=A_(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:b,offsetParent:w,strategy:c}):b);return{top:(x.top-_.top+v.top)/j.y,bottom:(_.bottom-x.bottom+v.bottom)/j.y,left:(x.left-_.left+v.left)/j.x,right:(_.right-x.right+v.right)/j.x}}const Tze=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:a,rects:i,platform:s,elements:l,middlewareData:c}=t,{element:d,padding:u=0}=Df(e,t)||{};if(d==null)return{};const f=HQ(u),m={x:r,y:n},h=TD(a),v=ID(h),g=await s.getDimensions(d),y=h==="y",x=y?"top":"left",b=y?"bottom":"right",w=y?"clientHeight":"clientWidth",j=i.reference[v]+i.reference[h]-m[h]-i.floating[v],_=m[h]-i.reference[h],C=await(s.getOffsetParent==null?void 0:s.getOffsetParent(d));let E=C?C[w]:0;(!E||!await(s.isElement==null?void 0:s.isElement(C)))&&(E=l.floating[w]||i.floating[v]);const P=j/2-_/2,k=E/2-g[v]/2-1,M=mh(f[x],k),S=mh(f[b],k),I=M,T=E-g[v]-S,D=E/2-g[v]/2+P,B=D3(I,D,T),U=!c.arrow&&f0(a)!=null&&D!==B&&i.reference[v]/2-(D<I?M:S)-g[v]/2<0,z=U?D<I?D-I:D-T:0;return{[h]:m[h]+z,data:{[h]:B,centerOffset:D-B-z,...U&&{alignmentOffset:z}},reset:U}}}),Dze=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:a,middlewareData:i,rects:s,initialPlacement:l,platform:c,elements:d}=t,{mainAxis:u=!0,crossAxis:f=!0,fallbackPlacements:m,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:g=!0,...y}=Df(e,t);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const x=Mf(a),b=Cu(l),w=Mf(l)===l,j=await(c.isRTL==null?void 0:c.isRTL(d.floating)),_=m||(w||!g?[P_(l)]:Cze(l)),C=v!=="none";!m&&C&&_.push(...kze(l,g,v,j));const E=[l,..._],P=await f1(t,y),k=[];let M=((n=i.flip)==null?void 0:n.overflows)||[];if(u&&k.push(P[x]),f){const D=Sze(a,s,j);k.push(P[D[0]],P[D[1]])}if(M=[...M,{placement:a,overflows:k}],!k.every(D=>D<=0)){var S,I;const D=(((S=i.flip)==null?void 0:S.index)||0)+1,B=E[D];if(B&&(!(f==="alignment"?b!==Cu(B):!1)||M.every($=>Cu($.placement)===b?$.overflows[0]>0:!0)))return{data:{index:D,overflows:M},reset:{placement:B}};let U=(I=M.filter(z=>z.overflows[0]<=0).sort((z,$)=>z.overflows[1]-$.overflows[1])[0])==null?void 0:I.placement;if(!U)switch(h){case"bestFit":{var T;const z=(T=M.filter($=>{if(C){const Y=Cu($.placement);return Y===b||Y==="y"}return!0}).map($=>[$.placement,$.overflows.filter(Y=>Y>0).reduce((Y,de)=>Y+de,0)]).sort(($,Y)=>$[1]-Y[1])[0])==null?void 0:T[0];z&&(U=z);break}case"initialPlacement":U=l;break}if(a!==U)return{reset:{placement:U}}}return{}}}};function vq(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function xq(e){return wze.some(t=>e[t]>=0)}const Mze=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...a}=Df(e,t);switch(n){case"referenceHidden":{const i=await f1(t,{...a,elementContext:"reference"}),s=vq(i,r.reference);return{data:{referenceHiddenOffsets:s,referenceHidden:xq(s)}}}case"escaped":{const i=await f1(t,{...a,altBoundary:!0}),s=vq(i,r.floating);return{data:{escapedOffsets:s,escaped:xq(s)}}}default:return{}}}}},GQ=new Set(["left","top"]);async function Rze(e,t){const{placement:r,platform:n,elements:a}=e,i=await(n.isRTL==null?void 0:n.isRTL(a.floating)),s=Mf(r),l=f0(r),c=Cu(r)==="y",d=GQ.has(s)?-1:1,u=i&&c?-1:1,f=Df(t,e);let{mainAxis:m,crossAxis:h,alignmentAxis:v}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return l&&typeof v=="number"&&(h=l==="end"?v*-1:v),c?{x:h*u,y:m*d}:{x:m*d,y:h*u}}const Lze=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:a,y:i,placement:s,middlewareData:l}=t,c=await Rze(t,e);return s===((r=l.offset)==null?void 0:r.placement)&&(n=l.arrow)!=null&&n.alignmentOffset?{}:{x:a+c.x,y:i+c.y,data:{...c,placement:s}}}}},$ze=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:a}=t,{mainAxis:i=!0,crossAxis:s=!1,limiter:l={fn:y=>{let{x,y:b}=y;return{x,y:b}}},...c}=Df(e,t),d={x:r,y:n},u=await f1(t,c),f=Cu(Mf(a)),m=OD(f);let h=d[m],v=d[f];if(i){const y=m==="y"?"top":"left",x=m==="y"?"bottom":"right",b=h+u[y],w=h-u[x];h=D3(b,h,w)}if(s){const y=f==="y"?"top":"left",x=f==="y"?"bottom":"right",b=v+u[y],w=v-u[x];v=D3(b,v,w)}const g=l.fn({...t,[m]:h,[f]:v});return{...g,data:{x:g.x-r,y:g.y-n,enabled:{[m]:i,[f]:s}}}}}},Fze=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:a,rects:i,middlewareData:s}=t,{offset:l=0,mainAxis:c=!0,crossAxis:d=!0}=Df(e,t),u={x:r,y:n},f=Cu(a),m=OD(f);let h=u[m],v=u[f];const g=Df(l,t),y=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(c){const w=m==="y"?"height":"width",j=i.reference[m]-i.floating[w]+y.mainAxis,_=i.reference[m]+i.reference[w]-y.mainAxis;h<j?h=j:h>_&&(h=_)}if(d){var x,b;const w=m==="y"?"width":"height",j=GQ.has(Mf(a)),_=i.reference[f]-i.floating[w]+(j&&((x=s.offset)==null?void 0:x[f])||0)+(j?0:y.crossAxis),C=i.reference[f]+i.reference[w]+(j?0:((b=s.offset)==null?void 0:b[f])||0)-(j?y.crossAxis:0);v<_?v=_:v>C&&(v=C)}return{[m]:h,[f]:v}}}},Bze=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:a,rects:i,platform:s,elements:l}=t,{apply:c=()=>{},...d}=Df(e,t),u=await f1(t,d),f=Mf(a),m=f0(a),h=Cu(a)==="y",{width:v,height:g}=i.floating;let y,x;f==="top"||f==="bottom"?(y=f,x=m===(await(s.isRTL==null?void 0:s.isRTL(l.floating))?"start":"end")?"left":"right"):(x=f,y=m==="end"?"top":"bottom");const b=g-u.top-u.bottom,w=v-u.left-u.right,j=mh(g-u[y],b),_=mh(v-u[x],w),C=!t.middlewareData.shift;let E=j,P=_;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(P=w),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(E=b),C&&!m){const M=ic(u.left,0),S=ic(u.right,0),I=ic(u.top,0),T=ic(u.bottom,0);h?P=v-2*(M!==0||S!==0?M+S:ic(u.left,u.right)):E=g-2*(I!==0||T!==0?I+T:ic(u.top,u.bottom))}await c({...t,availableWidth:P,availableHeight:E});const k=await s.getDimensions(l.floating);return v!==k.width||g!==k.height?{reset:{rects:!0}}:{}}}};function $C(){return typeof window<"u"}function m0(e){return KQ(e)?(e.nodeName||"").toLowerCase():"#document"}function vc(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Vu(e){var t;return(t=(KQ(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function KQ(e){return $C()?e instanceof Node||e instanceof vc(e).Node:!1}function Jd(e){return $C()?e instanceof Element||e instanceof vc(e).Element:!1}function Bu(e){return $C()?e instanceof HTMLElement||e instanceof vc(e).HTMLElement:!1}function yq(e){return!$C()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof vc(e).ShadowRoot}const qze=new Set(["inline","contents"]);function tw(e){const{overflow:t,overflowX:r,overflowY:n,display:a}=Qd(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!qze.has(a)}const zze=new Set(["table","td","th"]);function Uze(e){return zze.has(m0(e))}const Vze=[":popover-open",":modal"];function FC(e){return Vze.some(t=>{try{return e.matches(t)}catch{return!1}})}const Wze=["transform","translate","scale","rotate","perspective"],Hze=["transform","translate","scale","rotate","perspective","filter"],Gze=["paint","layout","strict","content"];function DD(e){const t=MD(),r=Jd(e)?Qd(e):e;return Wze.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||Hze.some(n=>(r.willChange||"").includes(n))||Gze.some(n=>(r.contain||"").includes(n))}function Kze(e){let t=hh(e);for(;Bu(t)&&!Dx(t);){if(DD(t))return t;if(FC(t))return null;t=hh(t)}return null}function MD(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Yze=new Set(["html","body","#document"]);function Dx(e){return Yze.has(m0(e))}function Qd(e){return vc(e).getComputedStyle(e)}function BC(e){return Jd(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function hh(e){if(m0(e)==="html")return e;const t=e.assignedSlot||e.parentNode||yq(e)&&e.host||Vu(e);return yq(t)?t.host:t}function YQ(e){const t=hh(e);return Dx(t)?e.ownerDocument?e.ownerDocument.body:e.body:Bu(t)&&tw(t)?t:YQ(t)}function m1(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const a=YQ(e),i=a===((n=e.ownerDocument)==null?void 0:n.body),s=vc(a);if(i){const l=R3(s);return t.concat(s,s.visualViewport||[],tw(a)?a:[],l&&r?m1(l):[])}return t.concat(a,m1(a,[],r))}function R3(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function XQ(e){const t=Qd(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const a=Bu(e),i=a?e.offsetWidth:r,s=a?e.offsetHeight:n,l=C_(r)!==i||C_(n)!==s;return l&&(r=i,n=s),{width:r,height:n,$:l}}function RD(e){return Jd(e)?e:e.contextElement}function Bv(e){const t=RD(e);if(!Bu(t))return Mu(1);const r=t.getBoundingClientRect(),{width:n,height:a,$:i}=XQ(t);let s=(i?C_(r.width):r.width)/n,l=(i?C_(r.height):r.height)/a;return(!s||!Number.isFinite(s))&&(s=1),(!l||!Number.isFinite(l))&&(l=1),{x:s,y:l}}const Xze=Mu(0);function JQ(e){const t=vc(e);return!MD()||!t.visualViewport?Xze:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Jze(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==vc(e)?!1:t}function eg(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const a=e.getBoundingClientRect(),i=RD(e);let s=Mu(1);t&&(n?Jd(n)&&(s=Bv(n)):s=Bv(e));const l=Jze(i,r,n)?JQ(i):Mu(0);let c=(a.left+l.x)/s.x,d=(a.top+l.y)/s.y,u=a.width/s.x,f=a.height/s.y;if(i){const m=vc(i),h=n&&Jd(n)?vc(n):n;let v=m,g=R3(v);for(;g&&n&&h!==v;){const y=Bv(g),x=g.getBoundingClientRect(),b=Qd(g),w=x.left+(g.clientLeft+parseFloat(b.paddingLeft))*y.x,j=x.top+(g.clientTop+parseFloat(b.paddingTop))*y.y;c*=y.x,d*=y.y,u*=y.x,f*=y.y,c+=w,d+=j,v=vc(g),g=R3(v)}}return A_({width:u,height:f,x:c,y:d})}function LD(e,t){const r=BC(e).scrollLeft;return t?t.left+r:eg(Vu(e)).left+r}function QQ(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),a=n.left+t.scrollLeft-(r?0:LD(e,n)),i=n.top+t.scrollTop;return{x:a,y:i}}function Qze(e){let{elements:t,rect:r,offsetParent:n,strategy:a}=e;const i=a==="fixed",s=Vu(n),l=t?FC(t.floating):!1;if(n===s||l&&i)return r;let c={scrollLeft:0,scrollTop:0},d=Mu(1);const u=Mu(0),f=Bu(n);if((f||!f&&!i)&&((m0(n)!=="body"||tw(s))&&(c=BC(n)),Bu(n))){const h=eg(n);d=Bv(n),u.x=h.x+n.clientLeft,u.y=h.y+n.clientTop}const m=s&&!f&&!i?QQ(s,c,!0):Mu(0);return{width:r.width*d.x,height:r.height*d.y,x:r.x*d.x-c.scrollLeft*d.x+u.x+m.x,y:r.y*d.y-c.scrollTop*d.y+u.y+m.y}}function Zze(e){return Array.from(e.getClientRects())}function e9e(e){const t=Vu(e),r=BC(e),n=e.ownerDocument.body,a=ic(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),i=ic(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let s=-r.scrollLeft+LD(e);const l=-r.scrollTop;return Qd(n).direction==="rtl"&&(s+=ic(t.clientWidth,n.clientWidth)-a),{width:a,height:i,x:s,y:l}}function t9e(e,t){const r=vc(e),n=Vu(e),a=r.visualViewport;let i=n.clientWidth,s=n.clientHeight,l=0,c=0;if(a){i=a.width,s=a.height;const d=MD();(!d||d&&t==="fixed")&&(l=a.offsetLeft,c=a.offsetTop)}return{width:i,height:s,x:l,y:c}}const r9e=new Set(["absolute","fixed"]);function n9e(e,t){const r=eg(e,!0,t==="fixed"),n=r.top+e.clientTop,a=r.left+e.clientLeft,i=Bu(e)?Bv(e):Mu(1),s=e.clientWidth*i.x,l=e.clientHeight*i.y,c=a*i.x,d=n*i.y;return{width:s,height:l,x:c,y:d}}function bq(e,t,r){let n;if(t==="viewport")n=t9e(e,r);else if(t==="document")n=e9e(Vu(e));else if(Jd(t))n=n9e(t,r);else{const a=JQ(e);n={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return A_(n)}function ZQ(e,t){const r=hh(e);return r===t||!Jd(r)||Dx(r)?!1:Qd(r).position==="fixed"||ZQ(r,t)}function a9e(e,t){const r=t.get(e);if(r)return r;let n=m1(e,[],!1).filter(l=>Jd(l)&&m0(l)!=="body"),a=null;const i=Qd(e).position==="fixed";let s=i?hh(e):e;for(;Jd(s)&&!Dx(s);){const l=Qd(s),c=DD(s);!c&&l.position==="fixed"&&(a=null),(i?!c&&!a:!c&&l.position==="static"&&!!a&&r9e.has(a.position)||tw(s)&&!c&&ZQ(e,s))?n=n.filter(u=>u!==s):a=l,s=hh(s)}return t.set(e,n),n}function o9e(e){let{element:t,boundary:r,rootBoundary:n,strategy:a}=e;const s=[...r==="clippingAncestors"?FC(t)?[]:a9e(t,this._c):[].concat(r),n],l=s[0],c=s.reduce((d,u)=>{const f=bq(t,u,a);return d.top=ic(f.top,d.top),d.right=mh(f.right,d.right),d.bottom=mh(f.bottom,d.bottom),d.left=ic(f.left,d.left),d},bq(t,l,a));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function i9e(e){const{width:t,height:r}=XQ(e);return{width:t,height:r}}function s9e(e,t,r){const n=Bu(t),a=Vu(t),i=r==="fixed",s=eg(e,!0,i,t);let l={scrollLeft:0,scrollTop:0};const c=Mu(0);function d(){c.x=LD(a)}if(n||!n&&!i)if((m0(t)!=="body"||tw(a))&&(l=BC(t)),n){const h=eg(t,!0,i,t);c.x=h.x+t.clientLeft,c.y=h.y+t.clientTop}else a&&d();i&&!n&&a&&d();const u=a&&!n&&!i?QQ(a,l):Mu(0),f=s.left+l.scrollLeft-c.x-u.x,m=s.top+l.scrollTop-c.y-u.y;return{x:f,y:m,width:s.width,height:s.height}}function NA(e){return Qd(e).position==="static"}function wq(e,t){if(!Bu(e)||Qd(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Vu(e)===r&&(r=r.ownerDocument.body),r}function eZ(e,t){const r=vc(e);if(FC(e))return r;if(!Bu(e)){let a=hh(e);for(;a&&!Dx(a);){if(Jd(a)&&!NA(a))return a;a=hh(a)}return r}let n=wq(e,t);for(;n&&Uze(n)&&NA(n);)n=wq(n,t);return n&&Dx(n)&&NA(n)&&!DD(n)?r:n||Kze(e)||r}const l9e=async function(e){const t=this.getOffsetParent||eZ,r=this.getDimensions,n=await r(e.floating);return{reference:s9e(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function c9e(e){return Qd(e).direction==="rtl"}const d9e={convertOffsetParentRelativeRectToViewportRelativeRect:Qze,getDocumentElement:Vu,getClippingRect:o9e,getOffsetParent:eZ,getElementRects:l9e,getClientRects:Zze,getDimensions:i9e,getScale:Bv,isElement:Jd,isRTL:c9e};function tZ(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function u9e(e,t){let r=null,n;const a=Vu(e);function i(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function s(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),i();const d=e.getBoundingClientRect(),{left:u,top:f,width:m,height:h}=d;if(l||t(),!m||!h)return;const v=I2(f),g=I2(a.clientWidth-(u+m)),y=I2(a.clientHeight-(f+h)),x=I2(u),w={rootMargin:-v+"px "+-g+"px "+-y+"px "+-x+"px",threshold:ic(0,mh(1,c))||1};let j=!0;function _(C){const E=C[0].intersectionRatio;if(E!==c){if(!j)return s();E?s(!1,E):n=setTimeout(()=>{s(!1,1e-7)},1e3)}E===1&&!tZ(d,e.getBoundingClientRect())&&s(),j=!1}try{r=new IntersectionObserver(_,{...w,root:a.ownerDocument})}catch{r=new IntersectionObserver(_,w)}r.observe(e)}return s(!0),i}function f9e(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:i=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,d=RD(e),u=a||i?[...d?m1(d):[],...m1(t)]:[];u.forEach(x=>{a&&x.addEventListener("scroll",r,{passive:!0}),i&&x.addEventListener("resize",r)});const f=d&&l?u9e(d,r):null;let m=-1,h=null;s&&(h=new ResizeObserver(x=>{let[b]=x;b&&b.target===d&&h&&(h.unobserve(t),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var w;(w=h)==null||w.observe(t)})),r()}),d&&!c&&h.observe(d),h.observe(t));let v,g=c?eg(e):null;c&&y();function y(){const x=eg(e);g&&!tZ(g,x)&&r(),g=x,v=requestAnimationFrame(y)}return r(),()=>{var x;u.forEach(b=>{a&&b.removeEventListener("scroll",r),i&&b.removeEventListener("resize",r)}),f?.(),(x=h)==null||x.disconnect(),h=null,c&&cancelAnimationFrame(v)}}const m9e=Lze,h9e=$ze,p9e=Dze,g9e=Bze,v9e=Mze,jq=Tze,x9e=Fze,y9e=(e,t,r)=>{const n=new Map,a={platform:d9e,...r},i={...a.platform,_c:n};return Ize(e,t,{...a,platform:i})};var b9e=typeof document<"u",w9e=function(){},bj=b9e?p.useLayoutEffect:w9e;function E_(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!E_(e[n],t[n]))return!1;return!0}if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,a[n]))return!1;for(n=r;n--!==0;){const i=a[n];if(!(i==="_owner"&&e.$$typeof)&&!E_(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function rZ(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Nq(e,t){const r=rZ(e);return Math.round(t*r)/r}function _A(e){const t=p.useRef(e);return bj(()=>{t.current=e}),t}function j9e(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:a,elements:{reference:i,floating:s}={},transform:l=!0,whileElementsMounted:c,open:d}=e,[u,f]=p.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[m,h]=p.useState(n);E_(m,n)||h(n);const[v,g]=p.useState(null),[y,x]=p.useState(null),b=p.useCallback($=>{$!==C.current&&(C.current=$,g($))},[]),w=p.useCallback($=>{$!==E.current&&(E.current=$,x($))},[]),j=i||v,_=s||y,C=p.useRef(null),E=p.useRef(null),P=p.useRef(u),k=c!=null,M=_A(c),S=_A(a),I=_A(d),T=p.useCallback(()=>{if(!C.current||!E.current)return;const $={placement:t,strategy:r,middleware:m};S.current&&($.platform=S.current),y9e(C.current,E.current,$).then(Y=>{const de={...Y,isPositioned:I.current!==!1};D.current&&!E_(P.current,de)&&(P.current=de,$f.flushSync(()=>{f(de)}))})},[m,t,r,S,I]);bj(()=>{d===!1&&P.current.isPositioned&&(P.current.isPositioned=!1,f($=>({...$,isPositioned:!1})))},[d]);const D=p.useRef(!1);bj(()=>(D.current=!0,()=>{D.current=!1}),[]),bj(()=>{if(j&&(C.current=j),_&&(E.current=_),j&&_){if(M.current)return M.current(j,_,T);T()}},[j,_,T,M,k]);const B=p.useMemo(()=>({reference:C,floating:E,setReference:b,setFloating:w}),[b,w]),U=p.useMemo(()=>({reference:j,floating:_}),[j,_]),z=p.useMemo(()=>{const $={position:r,left:0,top:0};if(!U.floating)return $;const Y=Nq(U.floating,u.x),de=Nq(U.floating,u.y);return l?{...$,transform:"translate("+Y+"px, "+de+"px)",...rZ(U.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:Y,top:de}},[r,l,U.floating,u.x,u.y]);return p.useMemo(()=>({...u,update:T,refs:B,elements:U,floatingStyles:z}),[u,T,B,U,z])}const N9e=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:a}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?jq({element:n.current,padding:a}).fn(r):{}:n?jq({element:n,padding:a}).fn(r):{}}}},_9e=(e,t)=>({...m9e(e),options:[e,t]}),S9e=(e,t)=>({...h9e(e),options:[e,t]}),C9e=(e,t)=>({...x9e(e),options:[e,t]}),P9e=(e,t)=>({...p9e(e),options:[e,t]}),A9e=(e,t)=>({...g9e(e),options:[e,t]}),E9e=(e,t)=>({...v9e(e),options:[e,t]}),k9e=(e,t)=>({...N9e(e),options:[e,t]});var O9e="Arrow",nZ=p.forwardRef((e,t)=>{const{children:r,width:n=10,height:a=5,...i}=e;return o.jsx(Hn.svg,{...i,ref:t,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:o.jsx("polygon",{points:"0,0 30,0 15,10"})})});nZ.displayName=O9e;var I9e=nZ;function aZ(e){const[t,r]=p.useState(void 0);return Cs(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const i=a[0];let s,l;if("borderBoxSize"in i){const c=i.borderBoxSize,d=Array.isArray(c)?c[0]:c;s=d.inlineSize,l=d.blockSize}else s=e.offsetWidth,l=e.offsetHeight;r({width:s,height:l})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var $D="Popper",[oZ,h0]=pd($D),[T9e,iZ]=oZ($D),sZ=e=>{const{__scopePopper:t,children:r}=e,[n,a]=p.useState(null);return o.jsx(T9e,{scope:t,anchor:n,onAnchorChange:a,children:r})};sZ.displayName=$D;var lZ="PopperAnchor",cZ=p.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...a}=e,i=iZ(lZ,r),s=p.useRef(null),l=Da(t,s),c=p.useRef(null);return p.useEffect(()=>{const d=c.current;c.current=n?.current||s.current,d!==c.current&&i.onAnchorChange(c.current)}),n?null:o.jsx(Hn.div,{...a,ref:l})});cZ.displayName=lZ;var FD="PopperContent",[D9e,M9e]=oZ(FD),dZ=p.forwardRef((e,t)=>{const{__scopePopper:r,side:n="bottom",sideOffset:a=0,align:i="center",alignOffset:s=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:d=[],collisionPadding:u=0,sticky:f="partial",hideWhenDetached:m=!1,updatePositionStrategy:h="optimized",onPlaced:v,...g}=e,y=iZ(FD,r),[x,b]=p.useState(null),w=Da(t,K=>b(K)),[j,_]=p.useState(null),C=aZ(j),E=C?.width??0,P=C?.height??0,k=n+(i!=="center"?"-"+i:""),M=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},S=Array.isArray(d)?d:[d],I=S.length>0,T={padding:M,boundary:S.filter(L9e),altBoundary:I},{refs:D,floatingStyles:B,placement:U,isPositioned:z,middlewareData:$}=j9e({strategy:"fixed",placement:k,whileElementsMounted:(...K)=>f9e(...K,{animationFrame:h==="always"}),elements:{reference:y.anchor},middleware:[_9e({mainAxis:a+P,alignmentAxis:s}),c&&S9e({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?C9e():void 0,...T}),c&&P9e({...T}),A9e({...T,apply:({elements:K,rects:Q,availableWidth:re,availableHeight:G})=>{const{width:me,height:pe}=Q.reference,Be=K.floating.style;Be.setProperty("--radix-popper-available-width",`${re}px`),Be.setProperty("--radix-popper-available-height",`${G}px`),Be.setProperty("--radix-popper-anchor-width",`${me}px`),Be.setProperty("--radix-popper-anchor-height",`${pe}px`)}}),j&&k9e({element:j,padding:l}),$9e({arrowWidth:E,arrowHeight:P}),m&&E9e({strategy:"referenceHidden",...T})]}),[Y,de]=mZ(U),xe=Fl(v);Cs(()=>{z&&xe?.()},[z,xe]);const q=$.arrow?.x,L=$.arrow?.y,W=$.arrow?.centerOffset!==0,[ne,le]=p.useState();return Cs(()=>{x&&le(window.getComputedStyle(x).zIndex)},[x]),o.jsx("div",{ref:D.setFloating,"data-radix-popper-content-wrapper":"",style:{...B,transform:z?B.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ne,"--radix-popper-transform-origin":[$.transformOrigin?.x,$.transformOrigin?.y].join(" "),...$.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:o.jsx(D9e,{scope:r,placedSide:Y,onArrowChange:_,arrowX:q,arrowY:L,shouldHideArrow:W,children:o.jsx(Hn.div,{"data-side":Y,"data-align":de,...g,ref:w,style:{...g.style,animation:z?void 0:"none"}})})})});dZ.displayName=FD;var uZ="PopperArrow",R9e={top:"bottom",right:"left",bottom:"top",left:"right"},fZ=p.forwardRef(function(t,r){const{__scopePopper:n,...a}=t,i=M9e(uZ,n),s=R9e[i.placedSide];return o.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[s]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:o.jsx(I9e,{...a,ref:r,style:{...a.style,display:"block"}})})});fZ.displayName=uZ;function L9e(e){return e!==null}var $9e=e=>({name:"transformOrigin",options:e,fn(t){const{placement:r,rects:n,middlewareData:a}=t,s=a.arrow?.centerOffset!==0,l=s?0:e.arrowWidth,c=s?0:e.arrowHeight,[d,u]=mZ(r),f={start:"0%",center:"50%",end:"100%"}[u],m=(a.arrow?.x??0)+l/2,h=(a.arrow?.y??0)+c/2;let v="",g="";return d==="bottom"?(v=s?f:`${m}px`,g=`${-c}px`):d==="top"?(v=s?f:`${m}px`,g=`${n.floating.height+c}px`):d==="right"?(v=`${-c}px`,g=s?f:`${h}px`):d==="left"&&(v=`${n.floating.width+c}px`,g=s?f:`${h}px`),{data:{x:v,y:g}}}});function mZ(e){const[t,r="center"]=e.split("-");return[t,r]}var BD=sZ,qC=cZ,qD=dZ,zD=fZ,zC="Popover",[hZ,Wst]=pd(zC,[h0]),rw=h0(),[F9e,Ah]=hZ(zC),pZ=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:a,onOpenChange:i,modal:s=!1}=e,l=rw(t),c=p.useRef(null),[d,u]=p.useState(!1),[f,m]=kf({prop:n,defaultProp:a??!1,onChange:i,caller:zC});return o.jsx(BD,{...l,children:o.jsx(F9e,{scope:t,contentId:Hd(),triggerRef:c,open:f,onOpenChange:m,onOpenToggle:p.useCallback(()=>m(h=>!h),[m]),hasCustomAnchor:d,onCustomAnchorAdd:p.useCallback(()=>u(!0),[]),onCustomAnchorRemove:p.useCallback(()=>u(!1),[]),modal:s,children:r})})};pZ.displayName=zC;var gZ="PopoverAnchor",B9e=p.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=Ah(gZ,r),i=rw(r),{onCustomAnchorAdd:s,onCustomAnchorRemove:l}=a;return p.useEffect(()=>(s(),()=>l()),[s,l]),o.jsx(qC,{...i,...n,ref:t})});B9e.displayName=gZ;var vZ="PopoverTrigger",xZ=p.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=Ah(vZ,r),i=rw(r),s=Da(t,a.triggerRef),l=o.jsx(Hn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":NZ(a.open),...n,ref:s,onClick:Jr(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?l:o.jsx(qC,{asChild:!0,...i,children:l})});xZ.displayName=vZ;var UD="PopoverPortal",[q9e,z9e]=hZ(UD,{forceMount:void 0}),yZ=e=>{const{__scopePopover:t,forceMount:r,children:n,container:a}=e,i=Ah(UD,t);return o.jsx(q9e,{scope:t,forceMount:r,children:o.jsx(Ac,{present:r||i.open,children:o.jsx(Xx,{asChild:!0,container:a,children:n})})})};yZ.displayName=UD;var Mx="PopoverContent",bZ=p.forwardRef((e,t)=>{const r=z9e(Mx,e.__scopePopover),{forceMount:n=r.forceMount,...a}=e,i=Ah(Mx,e.__scopePopover);return o.jsx(Ac,{present:n||i.open,children:i.modal?o.jsx(V9e,{...a,ref:t}):o.jsx(W9e,{...a,ref:t})})});bZ.displayName=Mx;var U9e=dh("PopoverContent.RemoveScroll"),V9e=p.forwardRef((e,t)=>{const r=Ah(Mx,e.__scopePopover),n=p.useRef(null),a=Da(t,n),i=p.useRef(!1);return p.useEffect(()=>{const s=n.current;if(s)return RS(s)},[]),o.jsx(MS,{as:U9e,allowPinchZoom:!0,children:o.jsx(wZ,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Jr(e.onCloseAutoFocus,s=>{s.preventDefault(),i.current||r.triggerRef.current?.focus()}),onPointerDownOutside:Jr(e.onPointerDownOutside,s=>{const l=s.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,d=l.button===2||c;i.current=d},{checkForDefaultPrevented:!1}),onFocusOutside:Jr(e.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1})})})}),W9e=p.forwardRef((e,t)=>{const r=Ah(Mx,e.__scopePopover),n=p.useRef(!1),a=p.useRef(!1);return o.jsx(wZ,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{e.onCloseAutoFocus?.(i),i.defaultPrevented||(n.current||r.triggerRef.current?.focus(),i.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:i=>{e.onInteractOutside?.(i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const s=i.target;r.triggerRef.current?.contains(s)&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),wZ=p.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:s,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:u,...f}=e,m=Ah(Mx,r),h=rw(r);return TS(),o.jsx(U1,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:i,children:o.jsx(Yx,{asChild:!0,disableOutsidePointerEvents:s,onInteractOutside:u,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onDismiss:()=>m.onOpenChange(!1),children:o.jsx(qD,{"data-state":NZ(m.open),role:"dialog",id:m.contentId,...h,...f,ref:t,style:{...f.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),jZ="PopoverClose",H9e=p.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=Ah(jZ,r);return o.jsx(Hn.button,{type:"button",...n,ref:t,onClick:Jr(e.onClick,()=>a.onOpenChange(!1))})});H9e.displayName=jZ;var G9e="PopoverArrow",K9e=p.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=rw(r);return o.jsx(zD,{...a,...n,ref:t})});K9e.displayName=G9e;function NZ(e){return e?"open":"closed"}var Y9e=pZ,X9e=xZ,J9e=yZ,_Z=bZ;const xc=Y9e,yc=X9e,Rl=ye.forwardRef(({className:e,align:t="center",sideOffset:r=4,...n},a)=>o.jsx(J9e,{container:document.body,children:o.jsx(_Z,{ref:a,align:t,sideOffset:r,className:Yt("z-[9999] w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));Rl.displayName=_Z.displayName;var Yn=function(){return Yn=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Yn.apply(this,arguments)};function Q9e(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function SZ(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,i;n<a;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}function nw(e){return e.mode==="multiple"}function aw(e){return e.mode==="range"}function UC(e){return e.mode==="single"}var Z9e={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function eUe(e,t){return Jt(e,"LLLL y",t)}function tUe(e,t){return Jt(e,"d",t)}function rUe(e,t){return Jt(e,"LLLL",t)}function nUe(e){return"".concat(e)}function aUe(e,t){return Jt(e,"cccccc",t)}function oUe(e,t){return Jt(e,"yyyy",t)}var iUe=Object.freeze({__proto__:null,formatCaption:eUe,formatDay:tUe,formatMonthCaption:rUe,formatWeekNumber:nUe,formatWeekdayName:aUe,formatYearCaption:oUe}),sUe=function(e,t,r){return Jt(e,"do MMMM (EEEE)",r)},lUe=function(){return"Month: "},cUe=function(){return"Go to next month"},dUe=function(){return"Go to previous month"},uUe=function(e,t){return Jt(e,"cccc",t)},fUe=function(e){return"Week n. ".concat(e)},mUe=function(){return"Year: "},hUe=Object.freeze({__proto__:null,labelDay:sUe,labelMonthDropdown:lUe,labelNext:cUe,labelPrevious:dUe,labelWeekNumber:fUe,labelWeekday:uUe,labelYearDropdown:mUe});function pUe(){var e="buttons",t=Z9e,r=YK,n={},a={},i=1,s={},l=new Date;return{captionLayout:e,classNames:t,formatters:iUe,labels:hUe,locale:r,modifiersClassNames:n,modifiers:a,numberOfMonths:i,styles:s,today:l,mode:"default"}}function gUe(e){var t=e.fromYear,r=e.toYear,n=e.fromMonth,a=e.toMonth,i=e.fromDate,s=e.toDate;return n?i=pl(n):t&&(i=new Date(t,0,1)),a?s=VS(a):r&&(s=new Date(r,11,31)),{fromDate:i?ni(i):void 0,toDate:s?ni(s):void 0}}var CZ=p.createContext(void 0);function vUe(e){var t,r=e.initialProps,n=pUe(),a=gUe(r),i=a.fromDate,s=a.toDate,l=(t=r.captionLayout)!==null&&t!==void 0?t:n.captionLayout;l!=="buttons"&&(!i||!s)&&(l="buttons");var c;(UC(r)||nw(r)||aw(r))&&(c=r.onSelect);var d=Yn(Yn(Yn({},n),r),{captionLayout:l,classNames:Yn(Yn({},n.classNames),r.classNames),components:Yn({},r.components),formatters:Yn(Yn({},n.formatters),r.formatters),fromDate:i,labels:Yn(Yn({},n.labels),r.labels),mode:r.mode||n.mode,modifiers:Yn(Yn({},n.modifiers),r.modifiers),modifiersClassNames:Yn(Yn({},n.modifiersClassNames),r.modifiersClassNames),onSelect:c,styles:Yn(Yn({},n.styles),r.styles),toDate:s});return o.jsx(CZ.Provider,{value:d,children:e.children})}function So(){var e=p.useContext(CZ);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function PZ(e){var t=So(),r=t.locale,n=t.classNames,a=t.styles,i=t.formatters.formatCaption;return o.jsx("div",{className:n.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:i(e.displayMonth,{locale:r})})}function xUe(e){return o.jsx("svg",Yn({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:o.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function AZ(e){var t,r,n=e.onChange,a=e.value,i=e.children,s=e.caption,l=e.className,c=e.style,d=So(),u=(r=(t=d.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:xUe;return o.jsxs("div",{className:l,style:c,children:[o.jsx("span",{className:d.classNames.vhidden,children:e["aria-label"]}),o.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:d.classNames.dropdown,style:d.styles.dropdown,value:a,onChange:n,children:i}),o.jsxs("div",{className:d.classNames.caption_label,style:d.styles.caption_label,"aria-hidden":"true",children:[s,o.jsx(u,{className:d.classNames.dropdown_icon,style:d.styles.dropdown_icon})]})]})}function yUe(e){var t,r=So(),n=r.fromDate,a=r.toDate,i=r.styles,s=r.locale,l=r.formatters.formatMonthCaption,c=r.classNames,d=r.components,u=r.labels.labelMonthDropdown;if(!n)return o.jsx(o.Fragment,{});if(!a)return o.jsx(o.Fragment,{});var f=[];if(kbe(n,a))for(var m=pl(n),h=n.getMonth();h<=a.getMonth();h++)f.push(HP(m,h));else for(var m=pl(new Date),h=0;h<=11;h++)f.push(HP(m,h));var v=function(y){var x=Number(y.target.value),b=HP(pl(e.displayMonth),x);e.onChange(b)},g=(t=d?.Dropdown)!==null&&t!==void 0?t:AZ;return o.jsx(g,{name:"months","aria-label":u(),className:c.dropdown_month,style:i.dropdown_month,onChange:v,value:e.displayMonth.getMonth(),caption:l(e.displayMonth,{locale:s}),children:f.map(function(y){return o.jsx("option",{value:y.getMonth(),children:l(y,{locale:s})},y.getMonth())})})}function bUe(e){var t,r=e.displayMonth,n=So(),a=n.fromDate,i=n.toDate,s=n.locale,l=n.styles,c=n.classNames,d=n.components,u=n.formatters.formatYearCaption,f=n.labels.labelYearDropdown,m=[];if(!a)return o.jsx(o.Fragment,{});if(!i)return o.jsx(o.Fragment,{});for(var h=a.getFullYear(),v=i.getFullYear(),g=h;g<=v;g++)m.push(J$(iye(new Date),g));var y=function(b){var w=J$(pl(r),Number(b.target.value));e.onChange(w)},x=(t=d?.Dropdown)!==null&&t!==void 0?t:AZ;return o.jsx(x,{name:"years","aria-label":f(),className:c.dropdown_year,style:l.dropdown_year,onChange:y,value:r.getFullYear(),caption:u(r,{locale:s}),children:m.map(function(b){return o.jsx("option",{value:b.getFullYear(),children:u(b,{locale:s})},b.getFullYear())})})}function wUe(e,t){var r=p.useState(e),n=r[0],a=r[1],i=t===void 0?n:t;return[i,a]}function jUe(e){var t=e.month,r=e.defaultMonth,n=e.today,a=t||r||n||new Date,i=e.toDate,s=e.fromDate,l=e.numberOfMonths,c=l===void 0?1:l;if(i&&Eb(i,a)<0){var d=-1*(c-1);a=Xd(i,d)}return s&&Eb(a,s)<0&&(a=s),pl(a)}function NUe(){var e=So(),t=jUe(e),r=wUe(t,e.month),n=r[0],a=r[1],i=function(s){var l;if(!e.disableNavigation){var c=pl(s);a(c),(l=e.onMonthChange)===null||l===void 0||l.call(e,c)}};return[n,i]}function _Ue(e,t){for(var r=t.reverseMonths,n=t.numberOfMonths,a=pl(e),i=pl(Xd(a,n)),s=Eb(i,a),l=[],c=0;c<s;c++){var d=Xd(a,c);l.push(d)}return r&&(l=l.reverse()),l}function SUe(e,t){if(!t.disableNavigation){var r=t.toDate,n=t.pagedNavigation,a=t.numberOfMonths,i=a===void 0?1:a,s=n?i:1,l=pl(e);if(!r)return Xd(l,s);var c=Eb(r,e);if(!(c<i))return Xd(l,s)}}function CUe(e,t){if(!t.disableNavigation){var r=t.fromDate,n=t.pagedNavigation,a=t.numberOfMonths,i=a===void 0?1:a,s=n?i:1,l=pl(e);if(!r)return Xd(l,-s);var c=Eb(l,r);if(!(c<=0))return Xd(l,-s)}}var EZ=p.createContext(void 0);function PUe(e){var t=So(),r=NUe(),n=r[0],a=r[1],i=_Ue(n,t),s=SUe(n,t),l=CUe(n,t),c=function(f){return i.some(function(m){return jT(f,m)})},d=function(f,m){c(f)||(m&&XK(f,m)?a(Xd(f,1+t.numberOfMonths*-1)):a(f))},u={currentMonth:n,displayMonths:i,goToMonth:a,goToDate:d,previousMonth:l,nextMonth:s,isDateDisplayed:c};return o.jsx(EZ.Provider,{value:u,children:e.children})}function ow(){var e=p.useContext(EZ);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function _q(e){var t,r=So(),n=r.classNames,a=r.styles,i=r.components,s=ow().goToMonth,l=function(u){s(Xd(u,e.displayIndex?-e.displayIndex:0))},c=(t=i?.CaptionLabel)!==null&&t!==void 0?t:PZ,d=o.jsx(c,{id:e.id,displayMonth:e.displayMonth});return o.jsxs("div",{className:n.caption_dropdowns,style:a.caption_dropdowns,children:[o.jsx("div",{className:n.vhidden,children:d}),o.jsx(yUe,{onChange:l,displayMonth:e.displayMonth}),o.jsx(bUe,{onChange:l,displayMonth:e.displayMonth})]})}function AUe(e){return o.jsx("svg",Yn({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:o.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function EUe(e){return o.jsx("svg",Yn({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:o.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var k_=p.forwardRef(function(e,t){var r=So(),n=r.classNames,a=r.styles,i=[n.button_reset,n.button];e.className&&i.push(e.className);var s=i.join(" "),l=Yn(Yn({},a.button_reset),a.button);return e.style&&Object.assign(l,e.style),o.jsx("button",Yn({},e,{ref:t,type:"button",className:s,style:l}))});function kUe(e){var t,r,n=So(),a=n.dir,i=n.locale,s=n.classNames,l=n.styles,c=n.labels,d=c.labelPrevious,u=c.labelNext,f=n.components;if(!e.nextMonth&&!e.previousMonth)return o.jsx(o.Fragment,{});var m=d(e.previousMonth,{locale:i}),h=[s.nav_button,s.nav_button_previous].join(" "),v=u(e.nextMonth,{locale:i}),g=[s.nav_button,s.nav_button_next].join(" "),y=(t=f?.IconRight)!==null&&t!==void 0?t:EUe,x=(r=f?.IconLeft)!==null&&r!==void 0?r:AUe;return o.jsxs("div",{className:s.nav,style:l.nav,children:[!e.hidePrevious&&o.jsx(k_,{name:"previous-month","aria-label":m,className:h,style:l.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:a==="rtl"?o.jsx(y,{className:s.nav_icon,style:l.nav_icon}):o.jsx(x,{className:s.nav_icon,style:l.nav_icon})}),!e.hideNext&&o.jsx(k_,{name:"next-month","aria-label":v,className:g,style:l.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:a==="rtl"?o.jsx(x,{className:s.nav_icon,style:l.nav_icon}):o.jsx(y,{className:s.nav_icon,style:l.nav_icon})})]})}function Sq(e){var t=So().numberOfMonths,r=ow(),n=r.previousMonth,a=r.nextMonth,i=r.goToMonth,s=r.displayMonths,l=s.findIndex(function(v){return jT(e.displayMonth,v)}),c=l===0,d=l===s.length-1,u=t>1&&(c||!d),f=t>1&&(d||!c),m=function(){n&&i(n)},h=function(){a&&i(a)};return o.jsx(kUe,{displayMonth:e.displayMonth,hideNext:u,hidePrevious:f,nextMonth:a,previousMonth:n,onPreviousClick:m,onNextClick:h})}function OUe(e){var t,r=So(),n=r.classNames,a=r.disableNavigation,i=r.styles,s=r.captionLayout,l=r.components,c=(t=l?.CaptionLabel)!==null&&t!==void 0?t:PZ,d;return a?d=o.jsx(c,{id:e.id,displayMonth:e.displayMonth}):s==="dropdown"?d=o.jsx(_q,{displayMonth:e.displayMonth,id:e.id}):s==="dropdown-buttons"?d=o.jsxs(o.Fragment,{children:[o.jsx(_q,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),o.jsx(Sq,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):d=o.jsxs(o.Fragment,{children:[o.jsx(c,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),o.jsx(Sq,{displayMonth:e.displayMonth,id:e.id})]}),o.jsx("div",{className:n.caption,style:i.caption,children:d})}function IUe(e){var t=So(),r=t.footer,n=t.styles,a=t.classNames.tfoot;return r?o.jsx("tfoot",{className:a,style:n.tfoot,children:o.jsx("tr",{children:o.jsx("td",{colSpan:8,children:r})})}):o.jsx(o.Fragment,{})}function TUe(e,t,r){for(var n=r?Wp(new Date):fd(new Date,{locale:e,weekStartsOn:t}),a=[],i=0;i<7;i++){var s=Ia(n,i);a.push(s)}return a}function DUe(){var e=So(),t=e.classNames,r=e.styles,n=e.showWeekNumber,a=e.locale,i=e.weekStartsOn,s=e.ISOWeek,l=e.formatters.formatWeekdayName,c=e.labels.labelWeekday,d=TUe(a,i,s);return o.jsxs("tr",{style:r.head_row,className:t.head_row,children:[n&&o.jsx("td",{style:r.head_cell,className:t.head_cell}),d.map(function(u,f){return o.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":c(u,{locale:a}),children:l(u,{locale:a})},f)})]})}function MUe(){var e,t=So(),r=t.classNames,n=t.styles,a=t.components,i=(e=a?.HeadRow)!==null&&e!==void 0?e:DUe;return o.jsx("thead",{style:n.head,className:r.head,children:o.jsx(i,{})})}function RUe(e){var t=So(),r=t.locale,n=t.formatters.formatDay;return o.jsx(o.Fragment,{children:n(e.date,{locale:r})})}var VD=p.createContext(void 0);function LUe(e){if(!nw(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return o.jsx(VD.Provider,{value:t,children:e.children})}return o.jsx($Ue,{initialProps:e.initialProps,children:e.children})}function $Ue(e){var t=e.initialProps,r=e.children,n=t.selected,a=t.min,i=t.max,s=function(d,u,f){var m,h;(m=t.onDayClick)===null||m===void 0||m.call(t,d,u,f);var v=!!(u.selected&&a&&n?.length===a);if(!v){var g=!!(!u.selected&&i&&n?.length===i);if(!g){var y=n?SZ([],n,!0):[];if(u.selected){var x=y.findIndex(function(b){return Vs(d,b)});y.splice(x,1)}else y.push(d);(h=t.onSelect)===null||h===void 0||h.call(t,y,d,u,f)}}},l={disabled:[]};n&&l.disabled.push(function(d){var u=i&&n.length>i-1,f=n.some(function(m){return Vs(m,d)});return!!(u&&!f)});var c={selected:n,onDayClick:s,modifiers:l};return o.jsx(VD.Provider,{value:c,children:r})}function WD(){var e=p.useContext(VD);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function FUe(e,t){var r=t||{},n=r.from,a=r.to;return n&&a?Vs(a,e)&&Vs(n,e)?void 0:Vs(a,e)?{from:a,to:void 0}:Vs(n,e)?void 0:rO(n,e)?{from:e,to:a}:{from:n,to:e}:a?rO(e,a)?{from:a,to:e}:{from:e,to:a}:n?XK(e,n)?{from:e,to:n}:{from:n,to:e}:{from:e,to:void 0}}var HD=p.createContext(void 0);function BUe(e){if(!aw(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return o.jsx(HD.Provider,{value:t,children:e.children})}return o.jsx(qUe,{initialProps:e.initialProps,children:e.children})}function qUe(e){var t=e.initialProps,r=e.children,n=t.selected,a=n||{},i=a.from,s=a.to,l=t.min,c=t.max,d=function(h,v,g){var y,x;(y=t.onDayClick)===null||y===void 0||y.call(t,h,v,g);var b=FUe(h,n);(x=t.onSelect)===null||x===void 0||x.call(t,b,h,v,g)},u={range_start:[],range_end:[],range_middle:[],disabled:[]};if(i?(u.range_start=[i],s?(u.range_end=[s],Vs(i,s)||(u.range_middle=[{after:i,before:s}])):u.range_end=[i]):s&&(u.range_start=[s],u.range_end=[s]),l&&(i&&!s&&u.disabled.push({after:My(i,l-1),before:Ia(i,l-1)}),i&&s&&u.disabled.push({after:i,before:Ia(i,l-1)}),!i&&s&&u.disabled.push({after:My(s,l-1),before:Ia(s,l-1)})),c){if(i&&!s&&(u.disabled.push({before:Ia(i,-c+1)}),u.disabled.push({after:Ia(i,c-1)})),i&&s){var f=Nu(s,i)+1,m=c-f;u.disabled.push({before:My(i,m)}),u.disabled.push({after:Ia(s,m)})}!i&&s&&(u.disabled.push({before:Ia(s,-c+1)}),u.disabled.push({after:Ia(s,c-1)}))}return o.jsx(HD.Provider,{value:{selected:n,onDayClick:d,modifiers:u},children:r})}function GD(){var e=p.useContext(HD);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function wj(e){return Array.isArray(e)?SZ([],e,!0):e!==void 0?[e]:[]}function zUe(e){var t={};return Object.entries(e).forEach(function(r){var n=r[0],a=r[1];t[n]=wj(a)}),t}var Zd;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(Zd||(Zd={}));var UUe=Zd.Selected,Zu=Zd.Disabled,VUe=Zd.Hidden,WUe=Zd.Today,SA=Zd.RangeEnd,CA=Zd.RangeMiddle,PA=Zd.RangeStart,HUe=Zd.Outside;function GUe(e,t,r){var n,a=(n={},n[UUe]=wj(e.selected),n[Zu]=wj(e.disabled),n[VUe]=wj(e.hidden),n[WUe]=[e.today],n[SA]=[],n[CA]=[],n[PA]=[],n[HUe]=[],n);return e.fromDate&&a[Zu].push({before:e.fromDate}),e.toDate&&a[Zu].push({after:e.toDate}),nw(e)?a[Zu]=a[Zu].concat(t.modifiers[Zu]):aw(e)&&(a[Zu]=a[Zu].concat(r.modifiers[Zu]),a[PA]=r.modifiers[PA],a[CA]=r.modifiers[CA],a[SA]=r.modifiers[SA]),a}var kZ=p.createContext(void 0);function KUe(e){var t=So(),r=WD(),n=GD(),a=GUe(t,r,n),i=zUe(t.modifiers),s=Yn(Yn({},a),i);return o.jsx(kZ.Provider,{value:s,children:e.children})}function OZ(){var e=p.useContext(kZ);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function YUe(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function XUe(e){return!!(e&&typeof e=="object"&&"from"in e)}function JUe(e){return!!(e&&typeof e=="object"&&"after"in e)}function QUe(e){return!!(e&&typeof e=="object"&&"before"in e)}function ZUe(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function eVe(e,t){var r,n=t.from,a=t.to;if(n&&a){var i=Nu(a,n)<0;i&&(r=[a,n],n=r[0],a=r[1]);var s=Nu(e,n)>=0&&Nu(a,e)>=0;return s}return a?Vs(a,e):n?Vs(n,e):!1}function tVe(e){return bT(e)}function rVe(e){return Array.isArray(e)&&e.every(bT)}function nVe(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if(tVe(r))return Vs(e,r);if(rVe(r))return r.includes(e);if(XUe(r))return eVe(e,r);if(ZUe(r))return r.dayOfWeek.includes(e.getDay());if(YUe(r)){var n=Nu(r.before,e),a=Nu(r.after,e),i=n>0,s=a<0,l=rO(r.before,r.after);return l?s&&i:i||s}return JUe(r)?Nu(e,r.after)>0:QUe(r)?Nu(r.before,e)>0:typeof r=="function"?r(e):!1})}function KD(e,t,r){var n=Object.keys(t).reduce(function(i,s){var l=t[s];return nVe(e,l)&&i.push(s),i},[]),a={};return n.forEach(function(i){return a[i]=!0}),r&&!jT(e,r)&&(a.outside=!0),a}function aVe(e,t){for(var r=pl(e[0]),n=VS(e[e.length-1]),a,i,s=r;s<=n;){var l=KD(s,t),c=!l.disabled&&!l.hidden;if(!c){s=Ia(s,1);continue}if(l.selected)return s;l.today&&!i&&(i=s),a||(a=s),s=Ia(s,1)}return i||a}var oVe=365;function IZ(e,t){var r=t.moveBy,n=t.direction,a=t.context,i=t.modifiers,s=t.retry,l=s===void 0?{count:0,lastFocused:e}:s,c=a.weekStartsOn,d=a.fromDate,u=a.toDate,f=a.locale,m={day:Ia,week:tO,month:Xd,year:Z0e,startOfWeek:function(y){return a.ISOWeek?Wp(y):fd(y,{locale:f,weekStartsOn:c})},endOfWeek:function(y){return a.ISOWeek?VK(y):wT(y,{locale:f,weekStartsOn:c})}},h=m[r](e,n==="after"?1:-1);n==="before"&&d?h=eye([d,h]):n==="after"&&u&&(h=tye([u,h]));var v=!0;if(i){var g=KD(h,i);v=!g.disabled&&!g.hidden}return v?h:l.count>oVe?l.lastFocused:IZ(h,{moveBy:r,direction:n,context:a,modifiers:i,retry:Yn(Yn({},l),{count:l.count+1})})}var TZ=p.createContext(void 0);function iVe(e){var t=ow(),r=OZ(),n=p.useState(),a=n[0],i=n[1],s=p.useState(),l=s[0],c=s[1],d=aVe(t.displayMonths,r),u=a??(l&&t.isDateDisplayed(l))?l:d,f=function(){c(a),i(void 0)},m=function(y){i(y)},h=So(),v=function(y,x){if(a){var b=IZ(a,{moveBy:y,direction:x,context:h,modifiers:r});Vs(a,b)||(t.goToDate(b,a),m(b))}},g={focusedDay:a,focusTarget:u,blur:f,focus:m,focusDayAfter:function(){return v("day","after")},focusDayBefore:function(){return v("day","before")},focusWeekAfter:function(){return v("week","after")},focusWeekBefore:function(){return v("week","before")},focusMonthBefore:function(){return v("month","before")},focusMonthAfter:function(){return v("month","after")},focusYearBefore:function(){return v("year","before")},focusYearAfter:function(){return v("year","after")},focusStartOfWeek:function(){return v("startOfWeek","before")},focusEndOfWeek:function(){return v("endOfWeek","after")}};return o.jsx(TZ.Provider,{value:g,children:e.children})}function YD(){var e=p.useContext(TZ);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function sVe(e,t){var r=OZ(),n=KD(e,r,t);return n}var XD=p.createContext(void 0);function lVe(e){if(!UC(e.initialProps)){var t={selected:void 0};return o.jsx(XD.Provider,{value:t,children:e.children})}return o.jsx(cVe,{initialProps:e.initialProps,children:e.children})}function cVe(e){var t=e.initialProps,r=e.children,n=function(i,s,l){var c,d,u;if((c=t.onDayClick)===null||c===void 0||c.call(t,i,s,l),s.selected&&!t.required){(d=t.onSelect)===null||d===void 0||d.call(t,void 0,i,s,l);return}(u=t.onSelect)===null||u===void 0||u.call(t,i,i,s,l)},a={selected:t.selected,onDayClick:n};return o.jsx(XD.Provider,{value:a,children:r})}function DZ(){var e=p.useContext(XD);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function dVe(e,t){var r=So(),n=DZ(),a=WD(),i=GD(),s=YD(),l=s.focusDayAfter,c=s.focusDayBefore,d=s.focusWeekAfter,u=s.focusWeekBefore,f=s.blur,m=s.focus,h=s.focusMonthBefore,v=s.focusMonthAfter,g=s.focusYearBefore,y=s.focusYearAfter,x=s.focusStartOfWeek,b=s.focusEndOfWeek,w=function(z){var $,Y,de,xe;UC(r)?($=n.onDayClick)===null||$===void 0||$.call(n,e,t,z):nw(r)?(Y=a.onDayClick)===null||Y===void 0||Y.call(a,e,t,z):aw(r)?(de=i.onDayClick)===null||de===void 0||de.call(i,e,t,z):(xe=r.onDayClick)===null||xe===void 0||xe.call(r,e,t,z)},j=function(z){var $;m(e),($=r.onDayFocus)===null||$===void 0||$.call(r,e,t,z)},_=function(z){var $;f(),($=r.onDayBlur)===null||$===void 0||$.call(r,e,t,z)},C=function(z){var $;($=r.onDayMouseEnter)===null||$===void 0||$.call(r,e,t,z)},E=function(z){var $;($=r.onDayMouseLeave)===null||$===void 0||$.call(r,e,t,z)},P=function(z){var $;($=r.onDayPointerEnter)===null||$===void 0||$.call(r,e,t,z)},k=function(z){var $;($=r.onDayPointerLeave)===null||$===void 0||$.call(r,e,t,z)},M=function(z){var $;($=r.onDayTouchCancel)===null||$===void 0||$.call(r,e,t,z)},S=function(z){var $;($=r.onDayTouchEnd)===null||$===void 0||$.call(r,e,t,z)},I=function(z){var $;($=r.onDayTouchMove)===null||$===void 0||$.call(r,e,t,z)},T=function(z){var $;($=r.onDayTouchStart)===null||$===void 0||$.call(r,e,t,z)},D=function(z){var $;($=r.onDayKeyUp)===null||$===void 0||$.call(r,e,t,z)},B=function(z){var $;switch(z.key){case"ArrowLeft":z.preventDefault(),z.stopPropagation(),r.dir==="rtl"?l():c();break;case"ArrowRight":z.preventDefault(),z.stopPropagation(),r.dir==="rtl"?c():l();break;case"ArrowDown":z.preventDefault(),z.stopPropagation(),d();break;case"ArrowUp":z.preventDefault(),z.stopPropagation(),u();break;case"PageUp":z.preventDefault(),z.stopPropagation(),z.shiftKey?g():h();break;case"PageDown":z.preventDefault(),z.stopPropagation(),z.shiftKey?y():v();break;case"Home":z.preventDefault(),z.stopPropagation(),x();break;case"End":z.preventDefault(),z.stopPropagation(),b();break}($=r.onDayKeyDown)===null||$===void 0||$.call(r,e,t,z)},U={onClick:w,onFocus:j,onBlur:_,onKeyDown:B,onKeyUp:D,onMouseEnter:C,onMouseLeave:E,onPointerEnter:P,onPointerLeave:k,onTouchCancel:M,onTouchEnd:S,onTouchMove:I,onTouchStart:T};return U}function uVe(){var e=So(),t=DZ(),r=WD(),n=GD(),a=UC(e)?t.selected:nw(e)?r.selected:aw(e)?n.selected:void 0;return a}function fVe(e){return Object.values(Zd).includes(e)}function mVe(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(n){var a=e.modifiersClassNames[n];if(a)r.push(a);else if(fVe(n)){var i=e.classNames["day_".concat(n)];i&&r.push(i)}}),r}function hVe(e,t){var r=Yn({},e.styles.day);return Object.keys(t).forEach(function(n){var a;r=Yn(Yn({},r),(a=e.modifiersStyles)===null||a===void 0?void 0:a[n])}),r}function pVe(e,t,r){var n,a,i,s=So(),l=YD(),c=sVe(e,t),d=dVe(e,c),u=uVe(),f=!!(s.onDayClick||s.mode!=="default");p.useEffect(function(){var C;c.outside||l.focusedDay&&f&&Vs(l.focusedDay,e)&&((C=r.current)===null||C===void 0||C.focus())},[l.focusedDay,e,r,f,c.outside]);var m=mVe(s,c).join(" "),h=hVe(s,c),v=!!(c.outside&&!s.showOutsideDays||c.hidden),g=(i=(a=s.components)===null||a===void 0?void 0:a.DayContent)!==null&&i!==void 0?i:RUe,y=o.jsx(g,{date:e,displayMonth:t,activeModifiers:c}),x={style:h,className:m,children:y,role:"gridcell"},b=l.focusTarget&&Vs(l.focusTarget,e)&&!c.outside,w=l.focusedDay&&Vs(l.focusedDay,e),j=Yn(Yn(Yn({},x),(n={disabled:c.disabled,role:"gridcell"},n["aria-selected"]=c.selected,n.tabIndex=w||b?0:-1,n)),d),_={isButton:f,isHidden:v,activeModifiers:c,selectedDays:u,buttonProps:j,divProps:x};return _}function gVe(e){var t=p.useRef(null),r=pVe(e.date,e.displayMonth,t);return r.isHidden?o.jsx("div",{role:"gridcell"}):r.isButton?o.jsx(k_,Yn({name:"day",ref:t},r.buttonProps)):o.jsx("div",Yn({},r.divProps))}function vVe(e){var t=e.number,r=e.dates,n=So(),a=n.onWeekNumberClick,i=n.styles,s=n.classNames,l=n.locale,c=n.labels.labelWeekNumber,d=n.formatters.formatWeekNumber,u=d(Number(t),{locale:l});if(!a)return o.jsx("span",{className:s.weeknumber,style:i.weeknumber,children:u});var f=c(Number(t),{locale:l}),m=function(h){a(t,r,h)};return o.jsx(k_,{name:"week-number","aria-label":f,className:s.weeknumber,style:i.weeknumber,onClick:m,children:u})}function xVe(e){var t,r,n=So(),a=n.styles,i=n.classNames,s=n.showWeekNumber,l=n.components,c=(t=l?.Day)!==null&&t!==void 0?t:gVe,d=(r=l?.WeekNumber)!==null&&r!==void 0?r:vVe,u;return s&&(u=o.jsx("td",{className:i.cell,style:a.cell,children:o.jsx(d,{number:e.weekNumber,dates:e.dates})})),o.jsxs("tr",{className:i.row,style:a.row,children:[u,e.dates.map(function(f){return o.jsx("td",{className:i.cell,style:a.cell,role:"presentation",children:o.jsx(c,{displayMonth:e.displayMonth,date:f})},ybe(f))})]})}function Cq(e,t,r){for(var n=r?.ISOWeek?VK(t):wT(t,r),a=r?.ISOWeek?Wp(e):fd(e,r),i=Nu(n,a),s=[],l=0;l<=i;l++)s.push(Ia(a,l));var c=s.reduce(function(d,u){var f=r?.ISOWeek?vbe(u):Nbe(u,r),m=d.find(function(h){return h.weekNumber===f});return m?(m.dates.push(u),d):(d.push({weekNumber:f,dates:[u]}),d)},[]);return c}function yVe(e,t){var r=Cq(pl(e),VS(e),t);if(t?.useFixedWeeks){var n=Sbe(e,t);if(n<6){var a=r[r.length-1],i=a.dates[a.dates.length-1],s=tO(i,6-n),l=Cq(tO(i,1),s,t);r.push.apply(r,l)}}return r}function bVe(e){var t,r,n,a=So(),i=a.locale,s=a.classNames,l=a.styles,c=a.hideHead,d=a.fixedWeeks,u=a.components,f=a.weekStartsOn,m=a.firstWeekContainsDate,h=a.ISOWeek,v=yVe(e.displayMonth,{useFixedWeeks:!!d,ISOWeek:h,locale:i,weekStartsOn:f,firstWeekContainsDate:m}),g=(t=u?.Head)!==null&&t!==void 0?t:MUe,y=(r=u?.Row)!==null&&r!==void 0?r:xVe,x=(n=u?.Footer)!==null&&n!==void 0?n:IUe;return o.jsxs("table",{id:e.id,className:s.table,style:l.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!c&&o.jsx(g,{}),o.jsx("tbody",{className:s.tbody,style:l.tbody,children:v.map(function(b){return o.jsx(y,{displayMonth:e.displayMonth,dates:b.dates,weekNumber:b.weekNumber},b.weekNumber)})}),o.jsx(x,{displayMonth:e.displayMonth})]})}function wVe(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var jVe=wVe()?p.useLayoutEffect:p.useEffect,AA=!1,NVe=0;function Pq(){return"react-day-picker-".concat(++NVe)}function _Ve(e){var t,r=e??(AA?Pq():null),n=p.useState(r),a=n[0],i=n[1];return jVe(function(){a===null&&i(Pq())},[]),p.useEffect(function(){AA===!1&&(AA=!0)},[]),(t=e??a)!==null&&t!==void 0?t:void 0}function SVe(e){var t,r,n=So(),a=n.dir,i=n.classNames,s=n.styles,l=n.components,c=ow().displayMonths,d=_Ve(n.id?"".concat(n.id,"-").concat(e.displayIndex):void 0),u=n.id?"".concat(n.id,"-grid-").concat(e.displayIndex):void 0,f=[i.month],m=s.month,h=e.displayIndex===0,v=e.displayIndex===c.length-1,g=!h&&!v;a==="rtl"&&(t=[h,v],v=t[0],h=t[1]),h&&(f.push(i.caption_start),m=Yn(Yn({},m),s.caption_start)),v&&(f.push(i.caption_end),m=Yn(Yn({},m),s.caption_end)),g&&(f.push(i.caption_between),m=Yn(Yn({},m),s.caption_between));var y=(r=l?.Caption)!==null&&r!==void 0?r:OUe;return o.jsxs("div",{className:f.join(" "),style:m,children:[o.jsx(y,{id:d,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),o.jsx(bVe,{id:u,"aria-labelledby":d,displayMonth:e.displayMonth})]},e.displayIndex)}function CVe(e){var t=So(),r=t.classNames,n=t.styles;return o.jsx("div",{className:r.months,style:n.months,children:e.children})}function PVe(e){var t,r,n=e.initialProps,a=So(),i=YD(),s=ow(),l=p.useState(!1),c=l[0],d=l[1];p.useEffect(function(){a.initialFocus&&i.focusTarget&&(c||(i.focus(i.focusTarget),d(!0)))},[a.initialFocus,c,i.focus,i.focusTarget,i]);var u=[a.classNames.root,a.className];a.numberOfMonths>1&&u.push(a.classNames.multiple_months),a.showWeekNumber&&u.push(a.classNames.with_weeknumber);var f=Yn(Yn({},a.styles.root),a.style),m=Object.keys(n).filter(function(v){return v.startsWith("data-")}).reduce(function(v,g){var y;return Yn(Yn({},v),(y={},y[g]=n[g],y))},{}),h=(r=(t=n.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:CVe;return o.jsx("div",Yn({className:u.join(" "),style:f,dir:a.dir,id:a.id,nonce:n.nonce,title:n.title,lang:n.lang},m,{children:o.jsx(h,{children:s.displayMonths.map(function(v,g){return o.jsx(SVe,{displayIndex:g,displayMonth:v},g)})})}))}function AVe(e){var t=e.children,r=Q9e(e,["children"]);return o.jsx(vUe,{initialProps:r,children:o.jsx(PUe,{children:o.jsx(lVe,{initialProps:r,children:o.jsx(LUe,{initialProps:r,children:o.jsx(BUe,{initialProps:r,children:o.jsx(KUe,{children:o.jsx(iVe,{children:t})})})})})})})}function L3(e){return o.jsx(AVe,Yn({},e,{children:o.jsx(PVe,{initialProps:e})}))}function bc({className:e,classNames:t,showOutsideDays:r=!0,weekStartsOn:n=1,locale:a=ia,...i}){const s=["dom","seg","ter","qua","qui","sex","sb"];return o.jsx(L3,{showOutsideDays:r,weekStartsOn:n,locale:a,className:Yt("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Yt(Sb({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:Yt(Sb({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"text-muted-foreground opacity-50",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},formatters:{formatWeekdayName:(l,c)=>s[l.getDay()]},components:{IconLeft:({...l})=>o.jsx(tH,{className:"h-4 w-4"}),IconRight:({...l})=>o.jsx(Kx,{className:"h-4 w-4"})},...i})}bc.displayName="Calendar";var MZ="AlertDialog",[EVe,Hst]=pd(MZ,[GG]),Vf=GG(),RZ=e=>{const{__scopeAlertDialog:t,...r}=e,n=Vf(t);return o.jsx(cK,{...n,...r,modal:!0})};RZ.displayName=MZ;var kVe="AlertDialogTrigger",LZ=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Vf(r);return o.jsx(nve,{...a,...n,ref:t})});LZ.displayName=kVe;var OVe="AlertDialogPortal",$Z=e=>{const{__scopeAlertDialog:t,...r}=e,n=Vf(t);return o.jsx(dK,{...n,...r})};$Z.displayName=OVe;var IVe="AlertDialogOverlay",FZ=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Vf(r);return o.jsx(uT,{...a,...n,ref:t})});FZ.displayName=IVe;var qv="AlertDialogContent",[TVe,DVe]=EVe(qv),MVe=Ape("AlertDialogContent"),BZ=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,children:n,...a}=e,i=Vf(r),s=p.useRef(null),l=Da(t,s),c=p.useRef(null);return o.jsx(Zge,{contentName:qv,titleName:qZ,docsSlug:"alert-dialog",children:o.jsx(TVe,{scope:r,cancelRef:c,children:o.jsxs(fT,{role:"alertdialog",...i,...a,ref:l,onOpenAutoFocus:Jr(a.onOpenAutoFocus,d=>{d.preventDefault(),c.current?.focus({preventScroll:!0})}),onPointerDownOutside:d=>d.preventDefault(),onInteractOutside:d=>d.preventDefault(),children:[o.jsx(MVe,{children:n}),o.jsx(LVe,{contentRef:s})]})})})});BZ.displayName=qv;var qZ="AlertDialogTitle",zZ=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Vf(r);return o.jsx(mT,{...a,...n,ref:t})});zZ.displayName=qZ;var UZ="AlertDialogDescription",VZ=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Vf(r);return o.jsx(hT,{...a,...n,ref:t})});VZ.displayName=UZ;var RVe="AlertDialogAction",WZ=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=Vf(r);return o.jsx($S,{...a,...n,ref:t})});WZ.displayName=RVe;var HZ="AlertDialogCancel",GZ=p.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,{cancelRef:a}=DVe(HZ,r),i=Vf(r),s=Da(t,a);return o.jsx($S,{...i,...n,ref:s})});GZ.displayName=HZ;var LVe=({contentRef:e})=>{const t=`\`${qv}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${qv}\` by passing a \`${UZ}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${qv}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return p.useEffect(()=>{document.getElementById(e.current?.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},$Ve=RZ,FVe=LZ,BVe=$Z,KZ=FZ,YZ=BZ,XZ=WZ,JZ=GZ,QZ=zZ,ZZ=VZ;const Md=$Ve,vp=FVe,qVe=BVe,eee=ye.forwardRef(({className:e,...t},r)=>o.jsx(KZ,{className:Yt("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));eee.displayName=KZ.displayName;const Gc=ye.forwardRef(({className:e,...t},r)=>o.jsxs(qVe,{children:[o.jsx(eee,{}),o.jsx(YZ,{ref:r,className:Yt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));Gc.displayName=YZ.displayName;const Kc=({className:e,...t})=>o.jsx("div",{className:Yt("flex flex-col space-y-2 text-center sm:text-left",e),...t});Kc.displayName="AlertDialogHeader";const Yc=({className:e,...t})=>o.jsx("div",{className:Yt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Yc.displayName="AlertDialogFooter";const Xc=ye.forwardRef(({className:e,...t},r)=>o.jsx(QZ,{ref:r,className:Yt("text-lg font-semibold",e),...t}));Xc.displayName=QZ.displayName;const Jc=ye.forwardRef(({className:e,...t},r)=>o.jsx(ZZ,{ref:r,className:Yt("text-sm text-muted-foreground",e),...t}));Jc.displayName=ZZ.displayName;const Rd=ye.forwardRef(({className:e,...t},r)=>o.jsx(XZ,{ref:r,className:Yt(Sb(),e),...t}));Rd.displayName=XZ.displayName;const Qc=ye.forwardRef(({className:e,...t},r)=>o.jsx(JZ,{ref:r,className:Yt(Sb({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));Qc.displayName=JZ.displayName;function Aq(e,[t,r]){return Math.min(r,Math.max(t,e))}function VC(e){const t=e+"CollectionProvider",[r,n]=pd(t),[a,i]=r(t,{collectionRef:{current:null},itemMap:new Map}),s=g=>{const{scope:y,children:x}=g,b=ye.useRef(null),w=ye.useRef(new Map).current;return o.jsx(a,{scope:y,itemMap:w,collectionRef:b,children:x})};s.displayName=t;const l=e+"CollectionSlot",c=dh(l),d=ye.forwardRef((g,y)=>{const{scope:x,children:b}=g,w=i(l,x),j=Da(y,w.collectionRef);return o.jsx(c,{ref:j,children:b})});d.displayName=l;const u=e+"CollectionItemSlot",f="data-radix-collection-item",m=dh(u),h=ye.forwardRef((g,y)=>{const{scope:x,children:b,...w}=g,j=ye.useRef(null),_=Da(y,j),C=i(u,x);return ye.useEffect(()=>(C.itemMap.set(j,{ref:j,...w}),()=>void C.itemMap.delete(j))),o.jsx(m,{[f]:"",ref:_,children:b})});h.displayName=u;function v(g){const y=i(e+"CollectionConsumer",g);return ye.useCallback(()=>{const b=y.collectionRef.current;if(!b)return[];const w=Array.from(b.querySelectorAll(`[${f}]`));return Array.from(y.itemMap.values()).sort((C,E)=>w.indexOf(C.ref.current)-w.indexOf(E.ref.current))},[y.collectionRef,y.itemMap])}return[{Provider:s,Slot:d,ItemSlot:h},v,n]}var zVe=p.createContext(void 0);function WC(e){const t=p.useContext(zVe);return e||t||"ltr"}function tee(e){const t=p.useRef({value:e,previous:e});return p.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var ree=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),UVe="VisuallyHidden",JD=p.forwardRef((e,t)=>o.jsx(Hn.span,{...e,ref:t,style:{...ree,...e.style}}));JD.displayName=UVe;var VVe=[" ","Enter","ArrowUp","ArrowDown"],WVe=[" ","Enter"],tg="Select",[HC,GC,HVe]=VC(tg),[p0,Gst]=pd(tg,[HVe,h0]),KC=h0(),[GVe,Eh]=p0(tg),[KVe,YVe]=p0(tg),nee=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:a,onOpenChange:i,value:s,defaultValue:l,onValueChange:c,dir:d,name:u,autoComplete:f,disabled:m,required:h,form:v}=e,g=KC(t),[y,x]=p.useState(null),[b,w]=p.useState(null),[j,_]=p.useState(!1),C=WC(d),[E,P]=kf({prop:n,defaultProp:a??!1,onChange:i,caller:tg}),[k,M]=kf({prop:s,defaultProp:l,onChange:c,caller:tg}),S=p.useRef(null),I=y?v||!!y.closest("form"):!0,[T,D]=p.useState(new Set),B=Array.from(T).map(U=>U.props.value).join(";");return o.jsx(BD,{...g,children:o.jsxs(GVe,{required:h,scope:t,trigger:y,onTriggerChange:x,valueNode:b,onValueNodeChange:w,valueNodeHasChildren:j,onValueNodeHasChildrenChange:_,contentId:Hd(),value:k,onValueChange:M,open:E,onOpenChange:P,dir:C,triggerPointerDownPosRef:S,disabled:m,children:[o.jsx(HC.Provider,{scope:t,children:o.jsx(KVe,{scope:e.__scopeSelect,onNativeOptionAdd:p.useCallback(U=>{D(z=>new Set(z).add(U))},[]),onNativeOptionRemove:p.useCallback(U=>{D(z=>{const $=new Set(z);return $.delete(U),$})},[]),children:r})}),I?o.jsxs(See,{"aria-hidden":!0,required:h,tabIndex:-1,name:u,autoComplete:f,value:k,onChange:U=>M(U.target.value),disabled:m,form:v,children:[k===void 0?o.jsx("option",{value:""}):null,Array.from(T)]},B):null]})})};nee.displayName=tg;var aee="SelectTrigger",oee=p.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...a}=e,i=KC(r),s=Eh(aee,r),l=s.disabled||n,c=Da(t,s.onTriggerChange),d=GC(r),u=p.useRef("touch"),[f,m,h]=Pee(g=>{const y=d().filter(w=>!w.disabled),x=y.find(w=>w.value===s.value),b=Aee(y,g,x);b!==void 0&&s.onValueChange(b.value)}),v=g=>{l||(s.onOpenChange(!0),h()),g&&(s.triggerPointerDownPosRef.current={x:Math.round(g.pageX),y:Math.round(g.pageY)})};return o.jsx(qC,{asChild:!0,...i,children:o.jsx(Hn.button,{type:"button",role:"combobox","aria-controls":s.contentId,"aria-expanded":s.open,"aria-required":s.required,"aria-autocomplete":"none",dir:s.dir,"data-state":s.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":Cee(s.value)?"":void 0,...a,ref:c,onClick:Jr(a.onClick,g=>{g.currentTarget.focus(),u.current!=="mouse"&&v(g)}),onPointerDown:Jr(a.onPointerDown,g=>{u.current=g.pointerType;const y=g.target;y.hasPointerCapture(g.pointerId)&&y.releasePointerCapture(g.pointerId),g.button===0&&g.ctrlKey===!1&&g.pointerType==="mouse"&&(v(g),g.preventDefault())}),onKeyDown:Jr(a.onKeyDown,g=>{const y=f.current!=="";!(g.ctrlKey||g.altKey||g.metaKey)&&g.key.length===1&&m(g.key),!(y&&g.key===" ")&&VVe.includes(g.key)&&(v(),g.preventDefault())})})})});oee.displayName=aee;var iee="SelectValue",see=p.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,children:i,placeholder:s="",...l}=e,c=Eh(iee,r),{onValueNodeHasChildrenChange:d}=c,u=i!==void 0,f=Da(t,c.onValueNodeChange);return Cs(()=>{d(u)},[d,u]),o.jsx(Hn.span,{...l,ref:f,style:{pointerEvents:"none"},children:Cee(c.value)?o.jsx(o.Fragment,{children:s}):i})});see.displayName=iee;var XVe="SelectIcon",lee=p.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...a}=e;return o.jsx(Hn.span,{"aria-hidden":!0,...a,ref:t,children:n||""})});lee.displayName=XVe;var JVe="SelectPortal",cee=e=>o.jsx(Xx,{asChild:!0,...e});cee.displayName=JVe;var rg="SelectContent",dee=p.forwardRef((e,t)=>{const r=Eh(rg,e.__scopeSelect),[n,a]=p.useState();if(Cs(()=>{a(new DocumentFragment)},[]),!r.open){const i=n;return i?$f.createPortal(o.jsx(uee,{scope:e.__scopeSelect,children:o.jsx(HC.Slot,{scope:e.__scopeSelect,children:o.jsx("div",{children:e.children})})}),i):null}return o.jsx(fee,{...e,ref:t})});dee.displayName=rg;var Ad=10,[uee,kh]=p0(rg),QVe="SelectContentImpl",ZVe=dh("SelectContent.RemoveScroll"),fee=p.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:i,onPointerDownOutside:s,side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:f,collisionBoundary:m,collisionPadding:h,sticky:v,hideWhenDetached:g,avoidCollisions:y,...x}=e,b=Eh(rg,r),[w,j]=p.useState(null),[_,C]=p.useState(null),E=Da(t,K=>j(K)),[P,k]=p.useState(null),[M,S]=p.useState(null),I=GC(r),[T,D]=p.useState(!1),B=p.useRef(!1);p.useEffect(()=>{if(w)return RS(w)},[w]),TS();const U=p.useCallback(K=>{const[Q,...re]=I().map(pe=>pe.ref.current),[G]=re.slice(-1),me=document.activeElement;for(const pe of K)if(pe===me||(pe?.scrollIntoView({block:"nearest"}),pe===Q&&_&&(_.scrollTop=0),pe===G&&_&&(_.scrollTop=_.scrollHeight),pe?.focus(),document.activeElement!==me))return},[I,_]),z=p.useCallback(()=>U([P,w]),[U,P,w]);p.useEffect(()=>{T&&z()},[T,z]);const{onOpenChange:$,triggerPointerDownPosRef:Y}=b;p.useEffect(()=>{if(w){let K={x:0,y:0};const Q=G=>{K={x:Math.abs(Math.round(G.pageX)-(Y.current?.x??0)),y:Math.abs(Math.round(G.pageY)-(Y.current?.y??0))}},re=G=>{K.x<=10&&K.y<=10?G.preventDefault():w.contains(G.target)||$(!1),document.removeEventListener("pointermove",Q),Y.current=null};return Y.current!==null&&(document.addEventListener("pointermove",Q),document.addEventListener("pointerup",re,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Q),document.removeEventListener("pointerup",re,{capture:!0})}}},[w,$,Y]),p.useEffect(()=>{const K=()=>$(!1);return window.addEventListener("blur",K),window.addEventListener("resize",K),()=>{window.removeEventListener("blur",K),window.removeEventListener("resize",K)}},[$]);const[de,xe]=Pee(K=>{const Q=I().filter(me=>!me.disabled),re=Q.find(me=>me.ref.current===document.activeElement),G=Aee(Q,K,re);G&&setTimeout(()=>G.ref.current.focus())}),q=p.useCallback((K,Q,re)=>{const G=!B.current&&!re;(b.value!==void 0&&b.value===Q||G)&&(k(K),G&&(B.current=!0))},[b.value]),L=p.useCallback(()=>w?.focus(),[w]),W=p.useCallback((K,Q,re)=>{const G=!B.current&&!re;(b.value!==void 0&&b.value===Q||G)&&S(K)},[b.value]),ne=n==="popper"?$3:mee,le=ne===$3?{side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:f,collisionBoundary:m,collisionPadding:h,sticky:v,hideWhenDetached:g,avoidCollisions:y}:{};return o.jsx(uee,{scope:r,content:w,viewport:_,onViewportChange:C,itemRefCallback:q,selectedItem:P,onItemLeave:L,itemTextRefCallback:W,focusSelectedItem:z,selectedItemText:M,position:n,isPositioned:T,searchRef:de,children:o.jsx(MS,{as:ZVe,allowPinchZoom:!0,children:o.jsx(U1,{asChild:!0,trapped:b.open,onMountAutoFocus:K=>{K.preventDefault()},onUnmountAutoFocus:Jr(a,K=>{b.trigger?.focus({preventScroll:!0}),K.preventDefault()}),children:o.jsx(Yx,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:s,onFocusOutside:K=>K.preventDefault(),onDismiss:()=>b.onOpenChange(!1),children:o.jsx(ne,{role:"listbox",id:b.contentId,"data-state":b.open?"open":"closed",dir:b.dir,onContextMenu:K=>K.preventDefault(),...x,...le,onPlaced:()=>D(!0),ref:E,style:{display:"flex",flexDirection:"column",outline:"none",...x.style},onKeyDown:Jr(x.onKeyDown,K=>{const Q=K.ctrlKey||K.altKey||K.metaKey;if(K.key==="Tab"&&K.preventDefault(),!Q&&K.key.length===1&&xe(K.key),["ArrowUp","ArrowDown","Home","End"].includes(K.key)){let G=I().filter(me=>!me.disabled).map(me=>me.ref.current);if(["ArrowUp","End"].includes(K.key)&&(G=G.slice().reverse()),["ArrowUp","ArrowDown"].includes(K.key)){const me=K.target,pe=G.indexOf(me);G=G.slice(pe+1)}setTimeout(()=>U(G)),K.preventDefault()}})})})})})})});fee.displayName=QVe;var eWe="SelectItemAlignedPosition",mee=p.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...a}=e,i=Eh(rg,r),s=kh(rg,r),[l,c]=p.useState(null),[d,u]=p.useState(null),f=Da(t,E=>u(E)),m=GC(r),h=p.useRef(!1),v=p.useRef(!0),{viewport:g,selectedItem:y,selectedItemText:x,focusSelectedItem:b}=s,w=p.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&d&&g&&y&&x){const E=i.trigger.getBoundingClientRect(),P=d.getBoundingClientRect(),k=i.valueNode.getBoundingClientRect(),M=x.getBoundingClientRect();if(i.dir!=="rtl"){const me=M.left-P.left,pe=k.left-me,Be=E.left-pe,Z=E.width+Be,ee=Math.max(Z,P.width),kt=window.innerWidth-Ad,Nt=Aq(pe,[Ad,Math.max(Ad,kt-ee)]);l.style.minWidth=Z+"px",l.style.left=Nt+"px"}else{const me=P.right-M.right,pe=window.innerWidth-k.right-me,Be=window.innerWidth-E.right-pe,Z=E.width+Be,ee=Math.max(Z,P.width),kt=window.innerWidth-Ad,Nt=Aq(pe,[Ad,Math.max(Ad,kt-ee)]);l.style.minWidth=Z+"px",l.style.right=Nt+"px"}const S=m(),I=window.innerHeight-Ad*2,T=g.scrollHeight,D=window.getComputedStyle(d),B=parseInt(D.borderTopWidth,10),U=parseInt(D.paddingTop,10),z=parseInt(D.borderBottomWidth,10),$=parseInt(D.paddingBottom,10),Y=B+U+T+$+z,de=Math.min(y.offsetHeight*5,Y),xe=window.getComputedStyle(g),q=parseInt(xe.paddingTop,10),L=parseInt(xe.paddingBottom,10),W=E.top+E.height/2-Ad,ne=I-W,le=y.offsetHeight/2,K=y.offsetTop+le,Q=B+U+K,re=Y-Q;if(Q<=W){const me=S.length>0&&y===S[S.length-1].ref.current;l.style.bottom="0px";const pe=d.clientHeight-g.offsetTop-g.offsetHeight,Be=Math.max(ne,le+(me?L:0)+pe+z),Z=Q+Be;l.style.height=Z+"px"}else{const me=S.length>0&&y===S[0].ref.current;l.style.top="0px";const Be=Math.max(W,B+g.offsetTop+(me?q:0)+le)+re;l.style.height=Be+"px",g.scrollTop=Q-W+g.offsetTop}l.style.margin=`${Ad}px 0`,l.style.minHeight=de+"px",l.style.maxHeight=I+"px",n?.(),requestAnimationFrame(()=>h.current=!0)}},[m,i.trigger,i.valueNode,l,d,g,y,x,i.dir,n]);Cs(()=>w(),[w]);const[j,_]=p.useState();Cs(()=>{d&&_(window.getComputedStyle(d).zIndex)},[d]);const C=p.useCallback(E=>{E&&v.current===!0&&(w(),b?.(),v.current=!1)},[w,b]);return o.jsx(rWe,{scope:r,contentWrapper:l,shouldExpandOnScrollRef:h,onScrollButtonChange:C,children:o.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:j},children:o.jsx(Hn.div,{...a,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});mee.displayName=eWe;var tWe="SelectPopperPosition",$3=p.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:a=Ad,...i}=e,s=KC(r);return o.jsx(qD,{...s,...i,ref:t,align:n,collisionPadding:a,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});$3.displayName=tWe;var[rWe,QD]=p0(rg,{}),F3="SelectViewport",hee=p.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...a}=e,i=kh(F3,r),s=QD(F3,r),l=Da(t,i.onViewportChange),c=p.useRef(0);return o.jsxs(o.Fragment,{children:[o.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),o.jsx(HC.Slot,{scope:r,children:o.jsx(Hn.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:Jr(a.onScroll,d=>{const u=d.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:m}=s;if(m?.current&&f){const h=Math.abs(c.current-u.scrollTop);if(h>0){const v=window.innerHeight-Ad*2,g=parseFloat(f.style.minHeight),y=parseFloat(f.style.height),x=Math.max(g,y);if(x<v){const b=x+h,w=Math.min(v,b),j=b-w;f.style.height=w+"px",f.style.bottom==="0px"&&(u.scrollTop=j>0?j:0,f.style.justifyContent="flex-end")}}}c.current=u.scrollTop})})})]})});hee.displayName=F3;var pee="SelectGroup",[nWe,aWe]=p0(pee),oWe=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=Hd();return o.jsx(nWe,{scope:r,id:a,children:o.jsx(Hn.div,{role:"group","aria-labelledby":a,...n,ref:t})})});oWe.displayName=pee;var gee="SelectLabel",vee=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=aWe(gee,r);return o.jsx(Hn.div,{id:a.id,...n,ref:t})});vee.displayName=gee;var O_="SelectItem",[iWe,xee]=p0(O_),yee=p.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:a=!1,textValue:i,...s}=e,l=Eh(O_,r),c=kh(O_,r),d=l.value===n,[u,f]=p.useState(i??""),[m,h]=p.useState(!1),v=Da(t,b=>c.itemRefCallback?.(b,n,a)),g=Hd(),y=p.useRef("touch"),x=()=>{a||(l.onValueChange(n),l.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return o.jsx(iWe,{scope:r,value:n,disabled:a,textId:g,isSelected:d,onItemTextChange:p.useCallback(b=>{f(w=>w||(b?.textContent??"").trim())},[]),children:o.jsx(HC.ItemSlot,{scope:r,value:n,disabled:a,textValue:u,children:o.jsx(Hn.div,{role:"option","aria-labelledby":g,"data-highlighted":m?"":void 0,"aria-selected":d&&m,"data-state":d?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...s,ref:v,onFocus:Jr(s.onFocus,()=>h(!0)),onBlur:Jr(s.onBlur,()=>h(!1)),onClick:Jr(s.onClick,()=>{y.current!=="mouse"&&x()}),onPointerUp:Jr(s.onPointerUp,()=>{y.current==="mouse"&&x()}),onPointerDown:Jr(s.onPointerDown,b=>{y.current=b.pointerType}),onPointerMove:Jr(s.onPointerMove,b=>{y.current=b.pointerType,a?c.onItemLeave?.():y.current==="mouse"&&b.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Jr(s.onPointerLeave,b=>{b.currentTarget===document.activeElement&&c.onItemLeave?.()}),onKeyDown:Jr(s.onKeyDown,b=>{c.searchRef?.current!==""&&b.key===" "||(WVe.includes(b.key)&&x(),b.key===" "&&b.preventDefault())})})})})});yee.displayName=O_;var my="SelectItemText",bee=p.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,...i}=e,s=Eh(my,r),l=kh(my,r),c=xee(my,r),d=YVe(my,r),[u,f]=p.useState(null),m=Da(t,x=>f(x),c.onItemTextChange,x=>l.itemTextRefCallback?.(x,c.value,c.disabled)),h=u?.textContent,v=p.useMemo(()=>o.jsx("option",{value:c.value,disabled:c.disabled,children:h},c.value),[c.disabled,c.value,h]),{onNativeOptionAdd:g,onNativeOptionRemove:y}=d;return Cs(()=>(g(v),()=>y(v)),[g,y,v]),o.jsxs(o.Fragment,{children:[o.jsx(Hn.span,{id:c.textId,...i,ref:m}),c.isSelected&&s.valueNode&&!s.valueNodeHasChildren?$f.createPortal(i.children,s.valueNode):null]})});bee.displayName=my;var wee="SelectItemIndicator",jee=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return xee(wee,r).isSelected?o.jsx(Hn.span,{"aria-hidden":!0,...n,ref:t}):null});jee.displayName=wee;var B3="SelectScrollUpButton",sWe=p.forwardRef((e,t)=>{const r=kh(B3,e.__scopeSelect),n=QD(B3,e.__scopeSelect),[a,i]=p.useState(!1),s=Da(t,n.onScrollButtonChange);return Cs(()=>{if(r.viewport&&r.isPositioned){let l=function(){const d=c.scrollTop>0;i(d)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),a?o.jsx(Nee,{...e,ref:s,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}}):null});sWe.displayName=B3;var q3="SelectScrollDownButton",lWe=p.forwardRef((e,t)=>{const r=kh(q3,e.__scopeSelect),n=QD(q3,e.__scopeSelect),[a,i]=p.useState(!1),s=Da(t,n.onScrollButtonChange);return Cs(()=>{if(r.viewport&&r.isPositioned){let l=function(){const d=c.scrollHeight-c.clientHeight,u=Math.ceil(c.scrollTop)<d;i(u)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),a?o.jsx(Nee,{...e,ref:s,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}}):null});lWe.displayName=q3;var Nee=p.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...a}=e,i=kh("SelectScrollButton",r),s=p.useRef(null),l=GC(r),c=p.useCallback(()=>{s.current!==null&&(window.clearInterval(s.current),s.current=null)},[]);return p.useEffect(()=>()=>c(),[c]),Cs(()=>{l().find(u=>u.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[l]),o.jsx(Hn.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:Jr(a.onPointerDown,()=>{s.current===null&&(s.current=window.setInterval(n,50))}),onPointerMove:Jr(a.onPointerMove,()=>{i.onItemLeave?.(),s.current===null&&(s.current=window.setInterval(n,50))}),onPointerLeave:Jr(a.onPointerLeave,()=>{c()})})}),cWe="SelectSeparator",_ee=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return o.jsx(Hn.div,{"aria-hidden":!0,...n,ref:t})});_ee.displayName=cWe;var z3="SelectArrow",dWe=p.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=KC(r),i=Eh(z3,r),s=kh(z3,r);return i.open&&s.position==="popper"?o.jsx(zD,{...a,...n,ref:t}):null});dWe.displayName=z3;var uWe="SelectBubbleInput",See=p.forwardRef(({__scopeSelect:e,value:t,...r},n)=>{const a=p.useRef(null),i=Da(n,a),s=tee(t);return p.useEffect(()=>{const l=a.current;if(!l)return;const c=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(c,"value").set;if(s!==t&&u){const f=new Event("change",{bubbles:!0});u.call(l,t),l.dispatchEvent(f)}},[s,t]),o.jsx(Hn.select,{...r,style:{...ree,...r.style},ref:i,defaultValue:t})});See.displayName=uWe;function Cee(e){return e===""||e===void 0}function Pee(e){const t=Fl(e),r=p.useRef(""),n=p.useRef(0),a=p.useCallback(s=>{const l=r.current+s;t(l),function c(d){r.current=d,window.clearTimeout(n.current),d!==""&&(n.current=window.setTimeout(()=>c(""),1e3))}(l)},[t]),i=p.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return p.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,a,i]}function Aee(e,t,r){const a=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let s=fWe(e,Math.max(i,0));a.length===1&&(s=s.filter(d=>d!==r));const c=s.find(d=>d.textValue.toLowerCase().startsWith(a.toLowerCase()));return c!==r?c:void 0}function fWe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var mWe=nee,Eee=oee,hWe=see,pWe=lee,gWe=cee,kee=dee,vWe=hee,Oee=vee,Iee=yee,xWe=bee,yWe=jee,Tee=_ee;const En=mWe,kn=hWe,Sn=ye.forwardRef(({className:e,children:t,...r},n)=>o.jsxs(Eee,{ref:n,className:Yt("flex h-10 w-full items-center justify-between rounded-md border border-input bg-transparent px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground hover:bg-surface-2/30 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-colors duration-150",e),...r,children:[t,o.jsx(pWe,{asChild:!0,children:o.jsx(L1,{className:"h-4 w-4 opacity-50"})})]}));Sn.displayName=Eee.displayName;const Cn=ye.forwardRef(({className:e,children:t,position:r="popper",...n},a)=>o.jsx(gWe,{children:o.jsx(kee,{ref:a,className:Yt("relative z-50 min-w-[8rem] max-h-[340px] overflow-auto fx-scroll rounded-md border bg-popover text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:o.jsx(vWe,{className:Yt("p-1",r==="popper"&&"w-full min-w-[var(--radix-select-trigger-width)]"),children:t})})}));Cn.displayName=kee.displayName;const bWe=ye.forwardRef(({className:e,...t},r)=>o.jsx(Oee,{ref:r,className:Yt("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));bWe.displayName=Oee.displayName;const wt=ye.forwardRef(({className:e,children:t,...r},n)=>o.jsxs(Iee,{ref:n,className:Yt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none hover:bg-surface-2/50 focus:bg-surface-2/50 data-[state=checked]:bg-surface-2/50 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 transition-colors",e),...r,children:[o.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:o.jsx(yWe,{children:o.jsx(ih,{className:"h-4 w-4"})})}),o.jsx(xWe,{children:t})]}));wt.displayName=Iee.displayName;const wWe=ye.forwardRef(({className:e,...t},r)=>o.jsx(Tee,{ref:r,className:Yt("-mx-1 my-1 h-px bg-muted",e),...t}));wWe.displayName=Tee.displayName;var YC="Checkbox",[jWe,Kst]=pd(YC),[NWe,ZD]=jWe(YC);function _We(e){const{__scopeCheckbox:t,checked:r,children:n,defaultChecked:a,disabled:i,form:s,name:l,onCheckedChange:c,required:d,value:u="on",internal_do_not_use_render:f}=e,[m,h]=kf({prop:r,defaultProp:a??!1,onChange:c,caller:YC}),[v,g]=p.useState(null),[y,x]=p.useState(null),b=p.useRef(!1),w=v?!!s||!!v.closest("form"):!0,j={checked:m,disabled:i,setChecked:h,control:v,setControl:g,name:l,form:s,value:u,hasConsumerStoppedPropagationRef:b,required:d,defaultChecked:Ym(a)?!1:a,isFormControl:w,bubbleInput:y,setBubbleInput:x};return o.jsx(NWe,{scope:t,...j,children:SWe(f)?f(j):n})}var Dee="CheckboxTrigger",Mee=p.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:r,...n},a)=>{const{control:i,value:s,disabled:l,checked:c,required:d,setControl:u,setChecked:f,hasConsumerStoppedPropagationRef:m,isFormControl:h,bubbleInput:v}=ZD(Dee,e),g=Da(a,u),y=p.useRef(c);return p.useEffect(()=>{const x=i?.form;if(x){const b=()=>f(y.current);return x.addEventListener("reset",b),()=>x.removeEventListener("reset",b)}},[i,f]),o.jsx(Hn.button,{type:"button",role:"checkbox","aria-checked":Ym(c)?"mixed":c,"aria-required":d,"data-state":Bee(c),"data-disabled":l?"":void 0,disabled:l,value:s,...n,ref:g,onKeyDown:Jr(t,x=>{x.key==="Enter"&&x.preventDefault()}),onClick:Jr(r,x=>{f(b=>Ym(b)?!0:!b),v&&h&&(m.current=x.isPropagationStopped(),m.current||x.stopPropagation())})})});Mee.displayName=Dee;var eM=p.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:n,checked:a,defaultChecked:i,required:s,disabled:l,value:c,onCheckedChange:d,form:u,...f}=e;return o.jsx(_We,{__scopeCheckbox:r,checked:a,defaultChecked:i,disabled:l,required:s,onCheckedChange:d,name:n,form:u,value:c,internal_do_not_use_render:({isFormControl:m})=>o.jsxs(o.Fragment,{children:[o.jsx(Mee,{...f,ref:t,__scopeCheckbox:r}),m&&o.jsx(Fee,{__scopeCheckbox:r})]})})});eM.displayName=YC;var Ree="CheckboxIndicator",Lee=p.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:n,...a}=e,i=ZD(Ree,r);return o.jsx(Ac,{present:n||Ym(i.checked)||i.checked===!0,children:o.jsx(Hn.span,{"data-state":Bee(i.checked),"data-disabled":i.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});Lee.displayName=Ree;var $ee="CheckboxBubbleInput",Fee=p.forwardRef(({__scopeCheckbox:e,...t},r)=>{const{control:n,hasConsumerStoppedPropagationRef:a,checked:i,defaultChecked:s,required:l,disabled:c,name:d,value:u,form:f,bubbleInput:m,setBubbleInput:h}=ZD($ee,e),v=Da(r,h),g=tee(i),y=aZ(n);p.useEffect(()=>{const b=m;if(!b)return;const w=window.HTMLInputElement.prototype,_=Object.getOwnPropertyDescriptor(w,"checked").set,C=!a.current;if(g!==i&&_){const E=new Event("click",{bubbles:C});b.indeterminate=Ym(i),_.call(b,Ym(i)?!1:i),b.dispatchEvent(E)}},[m,g,i,a]);const x=p.useRef(Ym(i)?!1:i);return o.jsx(Hn.input,{type:"checkbox","aria-hidden":!0,defaultChecked:s??x.current,required:l,disabled:c,name:d,value:u,form:f,...t,tabIndex:-1,ref:v,style:{...t.style,...y,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});Fee.displayName=$ee;function SWe(e){return typeof e=="function"}function Ym(e){return e==="indeterminate"}function Bee(e){return Ym(e)?"indeterminate":e?"checked":"unchecked"}const Bo=ye.forwardRef(({className:e,...t},r)=>o.jsx(eM,{ref:r,className:Yt("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:o.jsx(Lee,{className:Yt("flex items-center justify-center text-current"),children:o.jsx(ih,{className:"h-4 w-4"})})}));Bo.displayName=eM.displayName;var EA="rovingFocusGroup.onEntryFocus",CWe={bubbles:!1,cancelable:!0},iw="RovingFocusGroup",[U3,qee,PWe]=VC(iw),[AWe,XC]=pd(iw,[PWe]),[EWe,kWe]=AWe(iw),zee=p.forwardRef((e,t)=>o.jsx(U3.Provider,{scope:e.__scopeRovingFocusGroup,children:o.jsx(U3.Slot,{scope:e.__scopeRovingFocusGroup,children:o.jsx(OWe,{...e,ref:t})})}));zee.displayName=iw;var OWe=p.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:a=!1,dir:i,currentTabStopId:s,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:d,preventScrollOnEntryFocus:u=!1,...f}=e,m=p.useRef(null),h=Da(t,m),v=WC(i),[g,y]=kf({prop:s,defaultProp:l??null,onChange:c,caller:iw}),[x,b]=p.useState(!1),w=Fl(d),j=qee(r),_=p.useRef(!1),[C,E]=p.useState(0);return p.useEffect(()=>{const P=m.current;if(P)return P.addEventListener(EA,w),()=>P.removeEventListener(EA,w)},[w]),o.jsx(EWe,{scope:r,orientation:n,dir:v,loop:a,currentTabStopId:g,onItemFocus:p.useCallback(P=>y(P),[y]),onItemShiftTab:p.useCallback(()=>b(!0),[]),onFocusableItemAdd:p.useCallback(()=>E(P=>P+1),[]),onFocusableItemRemove:p.useCallback(()=>E(P=>P-1),[]),children:o.jsx(Hn.div,{tabIndex:x||C===0?-1:0,"data-orientation":n,...f,ref:h,style:{outline:"none",...e.style},onMouseDown:Jr(e.onMouseDown,()=>{_.current=!0}),onFocus:Jr(e.onFocus,P=>{const k=!_.current;if(P.target===P.currentTarget&&k&&!x){const M=new CustomEvent(EA,CWe);if(P.currentTarget.dispatchEvent(M),!M.defaultPrevented){const S=j().filter(U=>U.focusable),I=S.find(U=>U.active),T=S.find(U=>U.id===g),B=[I,T,...S].filter(Boolean).map(U=>U.ref.current);Wee(B,u)}}_.current=!1}),onBlur:Jr(e.onBlur,()=>b(!1))})})}),Uee="RovingFocusGroupItem",Vee=p.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:a=!1,tabStopId:i,children:s,...l}=e,c=Hd(),d=i||c,u=kWe(Uee,r),f=u.currentTabStopId===d,m=qee(r),{onFocusableItemAdd:h,onFocusableItemRemove:v,currentTabStopId:g}=u;return p.useEffect(()=>{if(n)return h(),()=>v()},[n,h,v]),o.jsx(U3.ItemSlot,{scope:r,id:d,focusable:n,active:a,children:o.jsx(Hn.span,{tabIndex:f?0:-1,"data-orientation":u.orientation,...l,ref:t,onMouseDown:Jr(e.onMouseDown,y=>{n?u.onItemFocus(d):y.preventDefault()}),onFocus:Jr(e.onFocus,()=>u.onItemFocus(d)),onKeyDown:Jr(e.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){u.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const x=DWe(y,u.orientation,u.dir);if(x!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let w=m().filter(j=>j.focusable).map(j=>j.ref.current);if(x==="last")w.reverse();else if(x==="prev"||x==="next"){x==="prev"&&w.reverse();const j=w.indexOf(y.currentTarget);w=u.loop?MWe(w,j+1):w.slice(j+1)}setTimeout(()=>Wee(w))}}),children:typeof s=="function"?s({isCurrentTabStop:f,hasTabStop:g!=null}):s})})});Vee.displayName=Uee;var IWe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function TWe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function DWe(e,t,r){const n=TWe(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return IWe[n]}function Wee(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function MWe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var Hee=zee,Gee=Vee,V3=["Enter"," "],RWe=["ArrowDown","PageUp","Home"],Kee=["ArrowUp","PageDown","End"],LWe=[...RWe,...Kee],$We={ltr:[...V3,"ArrowRight"],rtl:[...V3,"ArrowLeft"]},FWe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},sw="Menu",[h1,BWe,qWe]=VC(sw),[yg,Yee]=pd(sw,[qWe,h0,XC]),JC=h0(),Xee=XC(),[zWe,bg]=yg(sw),[UWe,lw]=yg(sw),Jee=e=>{const{__scopeMenu:t,open:r=!1,children:n,dir:a,onOpenChange:i,modal:s=!0}=e,l=JC(t),[c,d]=p.useState(null),u=p.useRef(!1),f=Fl(i),m=WC(a);return p.useEffect(()=>{const h=()=>{u.current=!0,document.addEventListener("pointerdown",v,{capture:!0,once:!0}),document.addEventListener("pointermove",v,{capture:!0,once:!0})},v=()=>u.current=!1;return document.addEventListener("keydown",h,{capture:!0}),()=>{document.removeEventListener("keydown",h,{capture:!0}),document.removeEventListener("pointerdown",v,{capture:!0}),document.removeEventListener("pointermove",v,{capture:!0})}},[]),o.jsx(BD,{...l,children:o.jsx(zWe,{scope:t,open:r,onOpenChange:f,content:c,onContentChange:d,children:o.jsx(UWe,{scope:t,onClose:p.useCallback(()=>f(!1),[f]),isUsingKeyboardRef:u,dir:m,modal:s,children:n})})})};Jee.displayName=sw;var VWe="MenuAnchor",tM=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,a=JC(r);return o.jsx(qC,{...a,...n,ref:t})});tM.displayName=VWe;var rM="MenuPortal",[WWe,Qee]=yg(rM,{forceMount:void 0}),Zee=e=>{const{__scopeMenu:t,forceMount:r,children:n,container:a}=e,i=bg(rM,t);return o.jsx(WWe,{scope:t,forceMount:r,children:o.jsx(Ac,{present:r||i.open,children:o.jsx(Xx,{asChild:!0,container:a,children:n})})})};Zee.displayName=rM;var sd="MenuContent",[HWe,nM]=yg(sd),ete=p.forwardRef((e,t)=>{const r=Qee(sd,e.__scopeMenu),{forceMount:n=r.forceMount,...a}=e,i=bg(sd,e.__scopeMenu),s=lw(sd,e.__scopeMenu);return o.jsx(h1.Provider,{scope:e.__scopeMenu,children:o.jsx(Ac,{present:n||i.open,children:o.jsx(h1.Slot,{scope:e.__scopeMenu,children:s.modal?o.jsx(GWe,{...a,ref:t}):o.jsx(KWe,{...a,ref:t})})})})}),GWe=p.forwardRef((e,t)=>{const r=bg(sd,e.__scopeMenu),n=p.useRef(null),a=Da(t,n);return p.useEffect(()=>{const i=n.current;if(i)return RS(i)},[]),o.jsx(aM,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:Jr(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),KWe=p.forwardRef((e,t)=>{const r=bg(sd,e.__scopeMenu);return o.jsx(aM,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),YWe=dh("MenuContent.ScrollLock"),aM=p.forwardRef((e,t)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:a,onOpenAutoFocus:i,onCloseAutoFocus:s,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:m,onDismiss:h,disableOutsideScroll:v,...g}=e,y=bg(sd,r),x=lw(sd,r),b=JC(r),w=Xee(r),j=BWe(r),[_,C]=p.useState(null),E=p.useRef(null),P=Da(t,E,y.onContentChange),k=p.useRef(0),M=p.useRef(""),S=p.useRef(0),I=p.useRef(null),T=p.useRef("right"),D=p.useRef(0),B=v?MS:p.Fragment,U=v?{as:YWe,allowPinchZoom:!0}:void 0,z=Y=>{const de=M.current+Y,xe=j().filter(K=>!K.disabled),q=document.activeElement,L=xe.find(K=>K.ref.current===q)?.textValue,W=xe.map(K=>K.textValue),ne=sHe(W,de,L),le=xe.find(K=>K.textValue===ne)?.ref.current;(function K(Q){M.current=Q,window.clearTimeout(k.current),Q!==""&&(k.current=window.setTimeout(()=>K(""),1e3))})(de),le&&setTimeout(()=>le.focus())};p.useEffect(()=>()=>window.clearTimeout(k.current),[]),TS();const $=p.useCallback(Y=>T.current===I.current?.side&&cHe(Y,I.current?.area),[]);return o.jsx(HWe,{scope:r,searchRef:M,onItemEnter:p.useCallback(Y=>{$(Y)&&Y.preventDefault()},[$]),onItemLeave:p.useCallback(Y=>{$(Y)||(E.current?.focus(),C(null))},[$]),onTriggerLeave:p.useCallback(Y=>{$(Y)&&Y.preventDefault()},[$]),pointerGraceTimerRef:S,onPointerGraceIntentChange:p.useCallback(Y=>{I.current=Y},[]),children:o.jsx(B,{...U,children:o.jsx(U1,{asChild:!0,trapped:a,onMountAutoFocus:Jr(i,Y=>{Y.preventDefault(),E.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:s,children:o.jsx(Yx,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:m,onDismiss:h,children:o.jsx(Hee,{asChild:!0,...w,dir:x.dir,orientation:"vertical",loop:n,currentTabStopId:_,onCurrentTabStopIdChange:C,onEntryFocus:Jr(c,Y=>{x.isUsingKeyboardRef.current||Y.preventDefault()}),preventScrollOnEntryFocus:!0,children:o.jsx(qD,{role:"menu","aria-orientation":"vertical","data-state":gte(y.open),"data-radix-menu-content":"",dir:x.dir,...b,...g,ref:P,style:{outline:"none",...g.style},onKeyDown:Jr(g.onKeyDown,Y=>{const xe=Y.target.closest("[data-radix-menu-content]")===Y.currentTarget,q=Y.ctrlKey||Y.altKey||Y.metaKey,L=Y.key.length===1;xe&&(Y.key==="Tab"&&Y.preventDefault(),!q&&L&&z(Y.key));const W=E.current;if(Y.target!==W||!LWe.includes(Y.key))return;Y.preventDefault();const le=j().filter(K=>!K.disabled).map(K=>K.ref.current);Kee.includes(Y.key)&&le.reverse(),oHe(le)}),onBlur:Jr(e.onBlur,Y=>{Y.currentTarget.contains(Y.target)||(window.clearTimeout(k.current),M.current="")}),onPointerMove:Jr(e.onPointerMove,p1(Y=>{const de=Y.target,xe=D.current!==Y.clientX;if(Y.currentTarget.contains(de)&&xe){const q=Y.clientX>D.current?"right":"left";T.current=q,D.current=Y.clientX}}))})})})})})})});ete.displayName=sd;var XWe="MenuGroup",oM=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return o.jsx(Hn.div,{role:"group",...n,ref:t})});oM.displayName=XWe;var JWe="MenuLabel",tte=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return o.jsx(Hn.div,{...n,ref:t})});tte.displayName=JWe;var I_="MenuItem",Eq="menu.itemSelect",QC=p.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:n,...a}=e,i=p.useRef(null),s=lw(I_,e.__scopeMenu),l=nM(I_,e.__scopeMenu),c=Da(t,i),d=p.useRef(!1),u=()=>{const f=i.current;if(!r&&f){const m=new CustomEvent(Eq,{bubbles:!0,cancelable:!0});f.addEventListener(Eq,h=>n?.(h),{once:!0}),sT(f,m),m.defaultPrevented?d.current=!1:s.onClose()}};return o.jsx(rte,{...a,ref:c,disabled:r,onClick:Jr(e.onClick,u),onPointerDown:f=>{e.onPointerDown?.(f),d.current=!0},onPointerUp:Jr(e.onPointerUp,f=>{d.current||f.currentTarget?.click()}),onKeyDown:Jr(e.onKeyDown,f=>{const m=l.searchRef.current!=="";r||m&&f.key===" "||V3.includes(f.key)&&(f.currentTarget.click(),f.preventDefault())})})});QC.displayName=I_;var rte=p.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:n=!1,textValue:a,...i}=e,s=nM(I_,r),l=Xee(r),c=p.useRef(null),d=Da(t,c),[u,f]=p.useState(!1),[m,h]=p.useState("");return p.useEffect(()=>{const v=c.current;v&&h((v.textContent??"").trim())},[i.children]),o.jsx(h1.ItemSlot,{scope:r,disabled:n,textValue:a??m,children:o.jsx(Gee,{asChild:!0,...l,focusable:!n,children:o.jsx(Hn.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...i,ref:d,onPointerMove:Jr(e.onPointerMove,p1(v=>{n?s.onItemLeave(v):(s.onItemEnter(v),v.defaultPrevented||v.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Jr(e.onPointerLeave,p1(v=>s.onItemLeave(v))),onFocus:Jr(e.onFocus,()=>f(!0)),onBlur:Jr(e.onBlur,()=>f(!1))})})})}),QWe="MenuCheckboxItem",nte=p.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:n,...a}=e;return o.jsx(lte,{scope:e.__scopeMenu,checked:r,children:o.jsx(QC,{role:"menuitemcheckbox","aria-checked":T_(r)?"mixed":r,...a,ref:t,"data-state":sM(r),onSelect:Jr(a.onSelect,()=>n?.(T_(r)?!0:!r),{checkForDefaultPrevented:!1})})})});nte.displayName=QWe;var ate="MenuRadioGroup",[ZWe,eHe]=yg(ate,{value:void 0,onValueChange:()=>{}}),ote=p.forwardRef((e,t)=>{const{value:r,onValueChange:n,...a}=e,i=Fl(n);return o.jsx(ZWe,{scope:e.__scopeMenu,value:r,onValueChange:i,children:o.jsx(oM,{...a,ref:t})})});ote.displayName=ate;var ite="MenuRadioItem",ste=p.forwardRef((e,t)=>{const{value:r,...n}=e,a=eHe(ite,e.__scopeMenu),i=r===a.value;return o.jsx(lte,{scope:e.__scopeMenu,checked:i,children:o.jsx(QC,{role:"menuitemradio","aria-checked":i,...n,ref:t,"data-state":sM(i),onSelect:Jr(n.onSelect,()=>a.onValueChange?.(r),{checkForDefaultPrevented:!1})})})});ste.displayName=ite;var iM="MenuItemIndicator",[lte,tHe]=yg(iM,{checked:!1}),cte=p.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:n,...a}=e,i=tHe(iM,r);return o.jsx(Ac,{present:n||T_(i.checked)||i.checked===!0,children:o.jsx(Hn.span,{...a,ref:t,"data-state":sM(i.checked)})})});cte.displayName=iM;var rHe="MenuSeparator",dte=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return o.jsx(Hn.div,{role:"separator","aria-orientation":"horizontal",...n,ref:t})});dte.displayName=rHe;var nHe="MenuArrow",ute=p.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,a=JC(r);return o.jsx(zD,{...a,...n,ref:t})});ute.displayName=nHe;var aHe="MenuSub",[Yst,fte]=yg(aHe),hy="MenuSubTrigger",mte=p.forwardRef((e,t)=>{const r=bg(hy,e.__scopeMenu),n=lw(hy,e.__scopeMenu),a=fte(hy,e.__scopeMenu),i=nM(hy,e.__scopeMenu),s=p.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=i,d={__scopeMenu:e.__scopeMenu},u=p.useCallback(()=>{s.current&&window.clearTimeout(s.current),s.current=null},[]);return p.useEffect(()=>u,[u]),p.useEffect(()=>{const f=l.current;return()=>{window.clearTimeout(f),c(null)}},[l,c]),o.jsx(tM,{asChild:!0,...d,children:o.jsx(rte,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":a.contentId,"data-state":gte(r.open),...e,ref:IS(t,a.onTriggerChange),onClick:f=>{e.onClick?.(f),!(e.disabled||f.defaultPrevented)&&(f.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:Jr(e.onPointerMove,p1(f=>{i.onItemEnter(f),!f.defaultPrevented&&!e.disabled&&!r.open&&!s.current&&(i.onPointerGraceIntentChange(null),s.current=window.setTimeout(()=>{r.onOpenChange(!0),u()},100))})),onPointerLeave:Jr(e.onPointerLeave,p1(f=>{u();const m=r.content?.getBoundingClientRect();if(m){const h=r.content?.dataset.side,v=h==="right",g=v?-5:5,y=m[v?"left":"right"],x=m[v?"right":"left"];i.onPointerGraceIntentChange({area:[{x:f.clientX+g,y:f.clientY},{x:y,y:m.top},{x,y:m.top},{x,y:m.bottom},{x:y,y:m.bottom}],side:h}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(f),f.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Jr(e.onKeyDown,f=>{const m=i.searchRef.current!=="";e.disabled||m&&f.key===" "||$We[n.dir].includes(f.key)&&(r.onOpenChange(!0),r.content?.focus(),f.preventDefault())})})})});mte.displayName=hy;var hte="MenuSubContent",pte=p.forwardRef((e,t)=>{const r=Qee(sd,e.__scopeMenu),{forceMount:n=r.forceMount,...a}=e,i=bg(sd,e.__scopeMenu),s=lw(sd,e.__scopeMenu),l=fte(hte,e.__scopeMenu),c=p.useRef(null),d=Da(t,c);return o.jsx(h1.Provider,{scope:e.__scopeMenu,children:o.jsx(Ac,{present:n||i.open,children:o.jsx(h1.Slot,{scope:e.__scopeMenu,children:o.jsx(aM,{id:l.contentId,"aria-labelledby":l.triggerId,...a,ref:d,align:"start",side:s.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{s.isUsingKeyboardRef.current&&c.current?.focus(),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:Jr(e.onFocusOutside,u=>{u.target!==l.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Jr(e.onEscapeKeyDown,u=>{s.onClose(),u.preventDefault()}),onKeyDown:Jr(e.onKeyDown,u=>{const f=u.currentTarget.contains(u.target),m=FWe[s.dir].includes(u.key);f&&m&&(i.onOpenChange(!1),l.trigger?.focus(),u.preventDefault())})})})})})});pte.displayName=hte;function gte(e){return e?"open":"closed"}function T_(e){return e==="indeterminate"}function sM(e){return T_(e)?"indeterminate":e?"checked":"unchecked"}function oHe(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function iHe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function sHe(e,t,r){const a=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let s=iHe(e,Math.max(i,0));a.length===1&&(s=s.filter(d=>d!==r));const c=s.find(d=>d.toLowerCase().startsWith(a.toLowerCase()));return c!==r?c:void 0}function lHe(e,t){const{x:r,y:n}=e;let a=!1;for(let i=0,s=t.length-1;i<t.length;s=i++){const l=t[i],c=t[s],d=l.x,u=l.y,f=c.x,m=c.y;u>n!=m>n&&r<(f-d)*(n-u)/(m-u)+d&&(a=!a)}return a}function cHe(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return lHe(r,t)}function p1(e){return t=>t.pointerType==="mouse"?e(t):void 0}var dHe=Jee,uHe=tM,fHe=Zee,mHe=ete,hHe=oM,pHe=tte,gHe=QC,vHe=nte,xHe=ote,yHe=ste,bHe=cte,wHe=dte,jHe=ute,NHe=mte,_He=pte,ZC="DropdownMenu",[SHe,Xst]=pd(ZC,[Yee]),xl=Yee(),[CHe,vte]=SHe(ZC),xte=e=>{const{__scopeDropdownMenu:t,children:r,dir:n,open:a,defaultOpen:i,onOpenChange:s,modal:l=!0}=e,c=xl(t),d=p.useRef(null),[u,f]=kf({prop:a,defaultProp:i??!1,onChange:s,caller:ZC});return o.jsx(CHe,{scope:t,triggerId:Hd(),triggerRef:d,contentId:Hd(),open:u,onOpenChange:f,onOpenToggle:p.useCallback(()=>f(m=>!m),[f]),modal:l,children:o.jsx(dHe,{...c,open:u,onOpenChange:f,dir:n,modal:l,children:r})})};xte.displayName=ZC;var yte="DropdownMenuTrigger",bte=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...a}=e,i=vte(yte,r),s=xl(r);return o.jsx(uHe,{asChild:!0,...s,children:o.jsx(Hn.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...a,ref:IS(t,i.triggerRef),onPointerDown:Jr(e.onPointerDown,l=>{!n&&l.button===0&&l.ctrlKey===!1&&(i.onOpenToggle(),i.open||l.preventDefault())}),onKeyDown:Jr(e.onKeyDown,l=>{n||(["Enter"," "].includes(l.key)&&i.onOpenToggle(),l.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});bte.displayName=yte;var PHe="DropdownMenuPortal",wte=e=>{const{__scopeDropdownMenu:t,...r}=e,n=xl(t);return o.jsx(fHe,{...n,...r})};wte.displayName=PHe;var jte="DropdownMenuContent",Nte=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=vte(jte,r),i=xl(r),s=p.useRef(!1);return o.jsx(mHe,{id:a.contentId,"aria-labelledby":a.triggerId,...i,...n,ref:t,onCloseAutoFocus:Jr(e.onCloseAutoFocus,l=>{s.current||a.triggerRef.current?.focus(),s.current=!1,l.preventDefault()}),onInteractOutside:Jr(e.onInteractOutside,l=>{const c=l.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0,u=c.button===2||d;(!a.modal||u)&&(s.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Nte.displayName=jte;var AHe="DropdownMenuGroup",EHe=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=xl(r);return o.jsx(hHe,{...a,...n,ref:t})});EHe.displayName=AHe;var kHe="DropdownMenuLabel",_te=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=xl(r);return o.jsx(pHe,{...a,...n,ref:t})});_te.displayName=kHe;var OHe="DropdownMenuItem",Ste=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=xl(r);return o.jsx(gHe,{...a,...n,ref:t})});Ste.displayName=OHe;var IHe="DropdownMenuCheckboxItem",Cte=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=xl(r);return o.jsx(vHe,{...a,...n,ref:t})});Cte.displayName=IHe;var THe="DropdownMenuRadioGroup",DHe=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=xl(r);return o.jsx(xHe,{...a,...n,ref:t})});DHe.displayName=THe;var MHe="DropdownMenuRadioItem",Pte=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=xl(r);return o.jsx(yHe,{...a,...n,ref:t})});Pte.displayName=MHe;var RHe="DropdownMenuItemIndicator",Ate=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=xl(r);return o.jsx(bHe,{...a,...n,ref:t})});Ate.displayName=RHe;var LHe="DropdownMenuSeparator",Ete=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=xl(r);return o.jsx(wHe,{...a,...n,ref:t})});Ete.displayName=LHe;var $He="DropdownMenuArrow",FHe=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=xl(r);return o.jsx(jHe,{...a,...n,ref:t})});FHe.displayName=$He;var BHe="DropdownMenuSubTrigger",kte=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=xl(r);return o.jsx(NHe,{...a,...n,ref:t})});kte.displayName=BHe;var qHe="DropdownMenuSubContent",Ote=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=xl(r);return o.jsx(_He,{...a,...n,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Ote.displayName=qHe;var zHe=xte,UHe=bte,VHe=wte,Ite=Nte,Tte=_te,Dte=Ste,Mte=Cte,Rte=Pte,Lte=Ate,$te=Ete,Fte=kte,Bte=Ote;const Uy=zHe,Vy=UHe,WHe=ye.forwardRef(({className:e,inset:t,children:r,...n},a)=>o.jsxs(Fte,{ref:a,className:Yt("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...n,children:[r,o.jsx(Kx,{className:"ml-auto h-4 w-4"})]}));WHe.displayName=Fte.displayName;const HHe=ye.forwardRef(({className:e,...t},r)=>o.jsx(Bte,{ref:r,className:Yt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));HHe.displayName=Bte.displayName;const zv=ye.forwardRef(({className:e,sideOffset:t=4,...r},n)=>o.jsx(VHe,{children:o.jsx(Ite,{ref:n,sideOffset:t,className:Yt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));zv.displayName=Ite.displayName;const sl=ye.forwardRef(({className:e,inset:t,...r},n)=>o.jsx(Dte,{ref:n,className:Yt("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...r}));sl.displayName=Dte.displayName;const GHe=ye.forwardRef(({className:e,children:t,checked:r,...n},a)=>o.jsxs(Mte,{ref:a,className:Yt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r,...n,children:[o.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:o.jsx(Lte,{children:o.jsx(ih,{className:"h-4 w-4"})})}),t]}));GHe.displayName=Mte.displayName;const KHe=ye.forwardRef(({className:e,children:t,...r},n)=>o.jsxs(Rte,{ref:n,className:Yt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[o.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:o.jsx(Lte,{children:o.jsx(Fde,{className:"h-2 w-2 fill-current"})})}),t]}));KHe.displayName=Rte.displayName;const W3=ye.forwardRef(({className:e,inset:t,...r},n)=>o.jsx(Tte,{ref:n,className:Yt("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));W3.displayName=Tte.displayName;const jj=ye.forwardRef(({className:e,...t},r)=>o.jsx($te,{ref:r,className:Yt("-mx-1 my-1 h-px bg-muted",e),...t}));jj.displayName=$te.displayName;function Wn(){try{const e=localStorage.getItem("auth:userProfile");if(e){const r=JSON.parse(e);if(r?.codigo_empresa)return r.codigo_empresa}const t=localStorage.getItem("auth:company");if(t){const r=JSON.parse(t);if(r?.codigo_empresa)return r.codigo_empresa;if(r?.codigo)return r.codigo}return typeof window<"u"&&window.__authProfile&&window.__authProfile.codigo_empresa?window.__authProfile.codigo_empresa:null}catch{return null}}async function Uv({somenteAtivas:e=!0,codigoEmpresa:t}={}){const r=t||Wn();let n=ve.from("finalizadoras").select("*").order("codigo_interno",{ascending:!0,nullsFirst:!1}).order("nome",{ascending:!0});r&&(n=n.eq("codigo_empresa",r)),e&&(n=n.eq("ativo",!0));const{data:a,error:i}=await n;if(i)throw i;const s=a||[];return s.sort((l,c)=>{const d=parseInt(l?.codigo_interno)||0,u=parseInt(c?.codigo_interno)||0;if(d!==u)return d-u;const f=(l?.nome||"").toLowerCase(),m=(c?.nome||"").toLowerCase();return f.localeCompare(m)}),s}async function YHe(e,t){const r=t||Wn(),n={codigo_interno:e?.codigo_interno||null,codigo_sefaz:e?.codigo_sefaz||null,nome:(e?.nome||"").trim(),tipo:e?.tipo||"outros",ativo:e?.ativo??!0,taxa_percentual:e?.taxa_percentual==null?null:Number(e.taxa_percentual)};if(!n.nome)throw new Error("Nome  obrigatrio");r&&(n.codigo_empresa=r);const{data:a,error:i}=await ve.from("finalizadoras").insert(n).select("*").single();if(i)throw i;return a}async function D_({caixaSessaoId:e,codigoEmpresa:t}={}){if(!e)throw new Error("caixaSessaoId  obrigatrio");const r=t||Wn();let n=ve.from("caixa_sessoes").select("id, aberto_em, fechado_em, saldo_inicial, saldo_final").eq("id",e).limit(1);r&&(n=n.eq("codigo_empresa",r));const{data:a,error:i}=await n;if(i)throw i;const s=Array.isArray(a)?a[0]:a;if(!s)throw new Error("Sesso no encontrada");const l=s.aberto_em,c=s.fechado_em||new Date().toISOString(),d=await nd({from:l,to:c,codigoEmpresa:r});let u=0,f=0,m=0,h=0;try{let g=ve.from("caixa_movimentacoes").select("tipo, valor").eq("caixa_sessao_id",e);r&&(g=g.eq("codigo_empresa",r));const{data:y}=await g;for(const x of y||[]){const b=Number(x?.valor||0),w=String(x?.tipo||"").toLowerCase();w==="suprimento"?u+=b:w==="sangria"?f+=b:w==="ajuste"?m+=b:w==="troco"&&(h+=b)}}catch{}const v=u+m-f-h;return{...d,saldoInicial:Number(s.saldo_inicial||0),saldoFinal:s.saldo_final!=null?Number(s.saldo_final):null,movimentos:{suprimentos:u,sangrias:f,ajustes:m,troco:h,totalMovimentos:v}}}async function XHe(e,t,r){if(!e)throw new Error("ID invlido");const n=r||Wn(),a={codigo_interno:t?.codigo_interno||null,codigo_sefaz:t?.codigo_sefaz||null,nome:(t?.nome||"").trim(),tipo:t?.tipo||"outros",ativo:t?.ativo??!0,taxa_percentual:t?.taxa_percentual==null?null:Number(t.taxa_percentual)};if(!a.nome)throw new Error("Nome  obrigatrio");let i=ve.from("finalizadoras").update(a).eq("id",e);n&&(i=i.eq("codigo_empresa",n));const{data:s,error:l}=await i.select("*").single();if(l)throw l;return s}async function JHe(e,t,r){if(!e)throw new Error("ID invlido");const n=r||Wn();let a=ve.from("finalizadoras").update({ativo:!!t}).eq("id",e);n&&(a=a.eq("codigo_empresa",n));const{data:i,error:s}=await a.select("*").single();if(s)throw s;return i}async function lM({codigoEmpresa:e}={}){const t=e||Wn();let r=ve.from("caixa_sessoes").select("id").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);t&&(r=r.eq("codigo_empresa",t));const{data:n,error:a}=await r;if(a)throw a;if(!(Array.isArray(n)&&n.length>0)){const s=new Error(" necessrio abrir o caixa antes de criar comandas.");throw s.code="NO_OPEN_CASH_SESSION",s}return!0}async function kq(e=[],t){if(!Array.isArray(e)||e.length===0)return{};const r=t||Wn(),n=async s=>{let l=ve.from("comanda_clientes").select(`comanda_id, cliente_id, nome_livre, clientes:clientes${s}(id, nome)`).in("comanda_id",e);return r&&(l=l.eq("codigo_empresa",r)),l};let a=[];try{const{data:s,error:l}=await n("!comanda_clientes_cliente_id_fkey");if(l)throw l;a=s||[]}catch{try{const{data:s,error:l}=await n("!fk_comanda_clientes_cliente");if(l)throw l;a=s||[]}catch{let s=ve.from("comanda_clientes").select("comanda_id, cliente_id, nome_livre").in("comanda_id",e);r&&(s=s.eq("codigo_empresa",r));const{data:l}=await s;a=l||[]}}const i={};for(const s of a){const l=s.comanda_id,c=s.clientes?.nome||s.nome_livre||"";i[l]||(i[l]=[]),c&&i[l].push(c)}for(const s of Object.keys(i))i[s]=Array.from(new Set(i[s])).join(", ");return i}async function Oq(e=[],t){if(!Array.isArray(e)||e.length===0)return{};const r=t||Wn();let n=ve.from("pagamentos").select("comanda_id, metodo, status, finalizadoras!pagamentos_finalizadora_id_fkey(nome)").in("comanda_id",e);r&&(n=n.eq("codigo_empresa",r));const{data:a,error:i}=await n;if(i)throw i;const s={};for(const c of a||[]){if(!((c.status||"Pago")!=="Cancelado"&&(c.status||"Pago")!=="Estornado"))continue;const u=c.comanda_id,f=c?.finalizadoras?.nome||c.metodo||"Outros";s[u]||(s[u]=[]),s[u].push(f)}const l={};for(const[c,d]of Object.entries(s))d.length===0?l[c]="":d.length===1?l[c]=d[0]:l[c]=`${d[0]} +${d.length-1}`;return l}async function QHe({comandaId:e,codigoEmpresa:t}={}){if(!e)throw new Error("comandaId  obrigatrio");const r=t||Wn();let n=ve.from("comanda_itens").select("produto_id, quantidade").eq("comanda_id",e);r&&(n=n.eq("codigo_empresa",r));const{data:a,error:i}=await n;if(i)throw i;const s=new Map;for(const h of a||[]){const v=h.produto_id,g=Number(h.quantidade||0);s.set(v,(s.get(v)||0)+g)}if(s.size===0)return!0;const l=Array.from(s.keys());let c=ve.from("produtos").select("id, nome, estoque");c=c.in("id",l),r&&(c=c.eq("codigo_empresa",r));const{data:d,error:u}=await c;if(u)throw u;const f=new Map((d||[]).map(h=>[h.id,{nome:h.nome,estoque:Number(h.estoque||0)}])),m=[];for(const[h,v]of s.entries()){const g=f.get(h)||{nome:`Produto ${h}`,estoque:0};v>g.estoque&&m.push({id:h,name:g.nome,solicitado:v,estoque:g.estoque})}if(m.length>0){const h=m.map(g=>`${g.name}: solicitado ${g.solicitado}, estoque ${g.estoque}`).join("; "),v=new Error(`Estoque insuficiente para finalizar: ${h}`);throw v.code="INSUFFICIENT_STOCK_COMANDA",v.items=m,v}return!0}async function cM({codigoEmpresa:e}={}){const t=e||Wn();let r=ve.from("comandas").select("id,status,aberto_em").is("mesa_id",null).in("status",["open","awaiting-payment"]).order("aberto_em",{ascending:!1}).limit(1);t&&(r=r.eq("codigo_empresa",t));const{data:n,error:a}=await r;if(a)throw a;return n?.[0]||null}async function Nj({codigoEmpresa:e}={}){const t=e||Wn();console.log("[getOrCreateComandaBalcao] Iniciando com codigo_empresa:",t),await lM({codigoEmpresa:t});const r=await cM({codigoEmpresa:t});if(r)return console.log("[getOrCreateComandaBalcao] Comanda existente encontrada:",r),r;const n={status:"open",mesa_id:null,aberto_em:new Date().toISOString()};console.log("[getOrCreateComandaBalcao] Criando nova comanda (codigo_empresa via DEFAULT):",n);const{data:a,error:i}=await ve.from("comandas").insert(n).select("id,status,aberto_em,tipo,codigo_empresa").single();if(i)throw console.error("[getOrCreateComandaBalcao] ERRO ao criar comanda:",i),i;return console.log("[getOrCreateComandaBalcao] Comanda criada com sucesso:",a),console.log("[getOrCreateComandaBalcao] Codigo da comanda criada:",a?.codigo_empresa,"vs esperado:",t),await new Promise(s=>setTimeout(s,100)),a}async function Iq({status:e,from:t,to:r,search:n="",limit:a=50,offset:i=0,codigoEmpresa:s}={}){const l=s||Wn();let c=ve.from("comandas").select("id, mesa_id, status, aberto_em, fechado_em, diferenca_pagamento").order("fechado_em",{ascending:!1,nullsFirst:!1}).order("aberto_em",{ascending:!1}).range(i,i+a-1);l&&(c=c.eq("codigo_empresa",l)),e&&Array.isArray(e)&&e.length?c=c.in("status",e):typeof e=="string"&&e!=="all"&&(e==="closed"?c=c.or("status.eq.closed,fechado_em.not.is.null").neq("status","cancelled"):c=c.eq("status",e));const d=y=>{if(!y)return null;if(typeof y=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(y)){const[x,b,w]=y.split("-").map(Number);return new Date(x,b-1,w,0,0,0,0)}return new Date(y)},u=y=>{if(!y)return null;if(typeof y=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(y)){const[x,b,w]=y.split("-").map(Number);return new Date(x,b-1,w,23,59,59,999)}return new Date(y)},f=d(t),m=u(r);f&&(c=c.gte("aberto_em",f.toISOString())),m&&(c=c.lte("aberto_em",m.toISOString()));const h=(n||"").trim();if(h){const y=/^\d+$/.test(h);if(/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(h)){const b=ve.from("comandas").select("id, mesa_id, status, aberto_em, fechado_em, diferenca_pagamento").eq("id",h).eq("codigo_empresa",l),w=ve.from("comandas").select("id, mesa_id, status, aberto_em, fechado_em, diferenca_pagamento").eq("mesa_id",h).eq("codigo_empresa",l),[j,_]=await Promise.all([b,w]),C=j.data||[],E=_.data||[],P=[...C,...E];return Array.from(new Map(P.map(M=>[M.id,M])).values()).sort((M,S)=>new Date(S.fechado_em||S.aberto_em)-new Date(M.fechado_em||M.aberto_em))}else y?c=c.or(`id.eq.${h},status.ilike.%${h}%`):c=c.or(`status.ilike.%${h}%`)}const{data:v,error:g}=await c;if(g)throw g;return v||[]}async function nd({from:e,to:t,codigoEmpresa:r}={}){const n="[listarResumoPeriodo]",a=r||Wn();console.log(`${n} Iniciando consulta`),console.log(`${n} Perodo: ${e||"SEM from"} at ${t||"SEM to"}`),console.log(`${n} codigo_empresa: ${a}`);let i=[];try{let m=ve.from("comandas").select("id, fechado_em").eq("status","closed");a&&(m=m.eq("codigo_empresa",a)),e&&(m=m.gte("fechado_em",new Date(e).toISOString())),t&&(m=m.lte("fechado_em",new Date(t).toISOString()));const{data:h,error:v}=await m;if(v)throw v;i=h||[]}catch{i=[]}const s=(i||[]).map(m=>m.id);let l=0,c=0;if(s.length>0)try{let m=ve.from("comanda_itens").select("comanda_id, quantidade, preco_unitario, desconto").in("comanda_id",s);a&&(m=m.eq("codigo_empresa",a));const{data:h,error:v}=await m;if(v)throw v;for(const g of h||[]){const y=Number(g.quantidade||0)*Number(g.preco_unitario||0),x=Number(g.desconto||0);l+=y,c+=x}}catch{}const d=Math.max(0,l-c),u={};let f=0;try{let m=ve.from("pagamentos").select("metodo, valor, recebido_em, status, finalizadoras!pagamentos_finalizadora_id_fkey(nome)");a&&(m=m.eq("codigo_empresa",a)),e&&(m=m.gte("recebido_em",new Date(e).toISOString())),t&&(m=m.lte("recebido_em",new Date(t).toISOString())),console.log(`${n} Consultando pagamentos de comandas...`);const{data:h,error:v}=await m;if(v)throw console.error(`${n}  Erro ao buscar pagamentos:`,v),v;console.log(`${n} Total de pagamentos de comandas encontrados: ${(h||[]).length}`);for(const g of h||[]){if(!((g.status||"Pago")!=="Cancelado"&&(g.status||"Pago")!=="Estornado"))continue;const x=g.finalizadoras?.nome||g.metodo||"outros",b=Number(g.valor||0);u[x]=(u[x]||0)+b,f+=b}console.log(`${n}  Resumo comandas por finalizadora:`,u)}catch(m){console.error(`${n}  Exception ao processar pagamentos de comandas:`,m)}try{let m=ve.from("agendamentos").select("id, inicio");a&&(m=m.eq("codigo_empresa",a)),e&&(m=m.gte("inicio",new Date(e).toISOString())),t&&(m=m.lte("inicio",new Date(t).toISOString())),console.log(`${n} Consultando agendamentos no perodo...`);const{data:h,error:v}=await m;if(v)throw console.error(`${n}  Erro ao buscar agendamentos:`,v),v;if(console.log(`${n} Total de agendamentos encontrados: ${(h||[]).length}`),h&&h.length>0){const g=h.map(w=>w.id);let y=ve.from("agendamento_participantes").select("valor_cota, status_pagamento, finalizadora_id, aplicar_taxa, finalizadoras!agp_finalizadora_id_fkey(nome, taxa_percentual)").in("agendamento_id",g).eq("status_pagamento","Pago");a&&(y=y.eq("codigo_empresa",a)),console.log(`${n} Consultando participantes pagos...`);const{data:x,error:b}=await y;if(b)throw console.error(`${n}  Erro ao buscar participantes:`,b),b;console.log(`${n} Total de participantes pagos encontrados: ${(x||[]).length}`);for(const w of x||[]){const j=w.finalizadoras?.nome||"Outros";let _=Number(w.valor_cota||0);if(w.aplicar_taxa===!0){const C=Number(w.finalizadoras?.taxa_percentual||0);C>0&&(_=_/(1+C/100),console.log(`${n}  Participante com taxa: valor_cota=${w.valor_cota}, taxa=${C}%, valor_real=${_.toFixed(2)}`))}u[j]=(u[j]||0)+_,f+=_}console.log(`${n}  Resumo agendamentos por finalizadora:`,u)}}catch(m){console.error(`${n}  Exception ao processar pagamentos de agendamentos:`,m)}return console.log(`${n}  RESUMO FINAL por finalizadora:`,u),console.log(`${n} Total de entradas: R$ ${f.toFixed(2)}`),{from:e?new Date(e).toISOString():null,to:t?new Date(t).toISOString():null,totalPorFinalizadora:u,totalEntradas:f,totalVendasBrutas:l,totalDescontos:c,totalVendasLiquidas:d}}async function g1({codigoEmpresa:e}={}){const t=e||Wn();let r=null;try{let a=ve.from("caixa_sessoes").select("aberto_em").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);t&&(a=a.eq("codigo_empresa",t));const{data:i,error:s}=await a;if(s)throw s;r=i?.[0]?.aberto_em||null}catch{}if(!r)return null;const n=new Date().toISOString();return nd({from:r,to:n,codigoEmpresa:t})}async function qte({comandaId:e,codigoEmpresa:t}={}){const r=t||Wn();let n=ve.from("pagamentos").select("*, finalizadoras!pagamentos_finalizadora_id_fkey(id, nome, codigo_sefaz, codigo_interno)").order("recebido_em",{ascending:!0});e&&(n=n.eq("comanda_id",e)),r&&(n=n.eq("codigo_empresa",r));const{data:a,error:i}=await n;if(i)throw i;return a||[]}async function _j({searchTerm:e="",limit:t=20,codigoEmpresa:r}={}){const n=r||Wn();let a=ve.from("clientes").select("*").eq("status","active").eq("flag_cliente",!0).order("nome",{ascending:!0}).limit(t);n&&(a=a.eq("codigo_empresa",n));const i=(e||"").trim();i&&(/^\d+$/.test(i)?a=a.or(`codigo.eq.${i},nome.ilike.%${i}%,email.ilike.%${i}%,telefone.ilike.%${i}%`):a=a.or(`nome.ilike.%${i}%,email.ilike.%${i}%,telefone.ilike.%${i}%`));const{data:s,error:l}=await a;if(l)throw l;return s||[]}async function sc({codigoEmpresa:e}={}){const t="[listarComandasAbertas]",r=e||Wn(),n=async()=>{const a=new Promise((c,d)=>setTimeout(()=>d(new Error("listarComandasAbertas timeout aps 30s")),3e4));let i=ve.from("comandas").select("id, mesa_id, status, aberto_em, fechado_em, observacoes, observacoes_atualizadas_em").is("fechado_em",null).neq("status","cancelled").order("aberto_em",{ascending:!1}).limit(500);r&&(i=i.eq("codigo_empresa",r));const{data:s,error:l}=await Promise.race([i,a]);if(l)throw l;return s||[]};try{try{return await n()}catch(a){if(String(a?.message||"").includes("timeout"))return console.warn(`${t} timeout na primeira tentativa, retornando array vazio`),[];throw a}}catch(a){return console.error(`${t}  EXCEPTION:`,a?.message||a),[]}}async function H3(e=[],t){if(!e||e.length===0)return{};const r=t||Wn();let n=ve.from("comanda_itens").select("comanda_id, quantidade, preco_unitario").in("comanda_id",e);r&&(n=n.eq("codigo_empresa",r));const{data:a,error:i}=await n;if(i)throw i;const s={};for(const l of a||[]){const c=l.comanda_id,d=Number(l.quantidade||0)*Number(l.preco_unitario||0);s[c]=(s[c]||0)+d}return s}async function xp(e){const t="[listMesas]",r=e||Wn(),n=async()=>{const a=new Promise((c,d)=>setTimeout(()=>d(new Error("listMesas timeout aps 30s")),3e4));let i=ve.from("mesas").select("id, numero, nome, status").order("numero",{ascending:!0}).limit(200);r&&(i=i.eq("codigo_empresa",r));const{data:s,error:l}=await Promise.race([i,a]);if(l)throw l;return s||[]};try{try{return await n()}catch(a){if(String(a?.message||"").includes("timeout"))return console.warn(`${t} timeout na primeira tentativa, retornando array vazio`),[];throw a}}catch(a){return console.error(`${t}  EXCEPTION:`,a?.message||a),[]}}async function ZHe({comandaId:e,status:t,codigoEmpresa:r}={}){if(!e)throw new Error("comandaId  obrigatrio");let n=ve.from("pagamentos").select("*").eq("comanda_id",e);t&&(n=n.eq("status",t)),n=n.order("created_at",{ascending:!0});const{data:a,error:i}=await n;if(i)throw i;return a||[]}async function Tq({comandaId:e,linhas:t,codigoEmpresa:r}={}){if(!e)throw new Error("comandaId  obrigatrio");const n=r||Wn();if(Array.isArray(t)){await ve.from("pagamentos").delete().eq("comanda_id",e).eq("status","Pendente");for(const a of t){const i=Number(a?.valor||0);if(i<=0)continue;const s=a?.metodo||a?.metodoNome||"outros";await dM({comandaId:e,finalizadoraId:a?.finalizadoraId||a?.methodId||null,metodo:s,valor:i,status:"Pendente",codigoEmpresa:n,clienteId:a?.clienteId||a?.clientId||null})}}}async function eGe({comandaId:e,codigoEmpresa:t}={}){if(!e)throw new Error("comandaId  obrigatrio");const r=t||Wn();let n=ve.from("pagamentos").update({status:"Pago",recebido_em:new Date().toISOString()}).eq("comanda_id",e).eq("status","Pendente");r&&(n=n.eq("codigo_empresa",r));const{error:a}=await n;if(a)throw a;return!0}async function tGe({numero:e,nome:t,codigoEmpresa:r}={}){const n=r||Wn();let a=e;if(!a){let s=ve.from("mesas").select("numero").order("numero",{ascending:!1}).limit(1);n&&(s=s.eq("codigo_empresa",n));const{data:l,error:c}=await s;if(c)throw c;a=(l?.[0]?.numero||0)+1}const i={numero:a,status:"available"};t&&typeof t=="string"&&t.trim()&&(i.nome=t.trim()),n&&(i.codigo_empresa=n);try{const{data:s,error:l}=await ve.from("mesas").insert(i).select("*").single();if(l)throw l;return s}catch(s){const l=String(s?.message||s||"");if(/column\s+\"?nome\"?\s+of\s+relation/i.test(l)||/column\s+\"?nome\"?\s+does not exist/i.test(l)){const c={numero:a,status:"available"};n&&(c.codigo_empresa=n);const{data:d,error:u}=await ve.from("mesas").insert(c).select("*").single();if(u)throw u;return d}throw s}}async function uf({saldoInicial:e=0,codigoEmpresa:t}={}){const r=t||Wn();let n=ve.from("caixa_sessoes").select("id,status,aberto_em,saldo_inicial").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);r&&(n=n.eq("codigo_empresa",r));const{data:a,error:i}=await n;if(i)throw i;if(a&&a.length>0){const d=a[0];try{const u=new Date(d.aberto_em),f=new Date;if(u.toDateString()!==f.toDateString()){try{const b=await sc({codigoEmpresa:r});if(Array.isArray(b)&&b.length>0)return console.warn("[ensureCaixaAberto] Sesso de dia anterior detectada, mas h comandas abertas. No fechar automaticamente."),d}catch{}const h=f.toISOString();let v=0,g=0;try{const b=await nd({from:d.aberto_em,to:h,codigoEmpresa:r});v=Number(b?.totalEntradas||0)}catch{}try{let b=ve.from("caixa_movimentacoes").select("tipo,valor").eq("caixa_sessao_id",d.id);r&&(b=b.eq("codigo_empresa",r));const{data:w}=await b;for(const j of w||[]){const _=Number(j?.valor||0),C=String(j?.tipo||"").toLowerCase();C==="suprimento"||C==="ajuste"?g+=_:(C==="sangria"||C==="troco")&&(g-=_)}}catch{}const y=Number(d?.saldo_inicial||0)+v+g;let x=ve.from("caixa_sessoes").update({status:"closed",saldo_final:y,fechado_em:h}).eq("id",d.id).eq("status","open");r&&(x=x.eq("codigo_empresa",r)),await x;try{const b=await D_({caixaSessaoId:d.id,codigoEmpresa:r}).catch(async()=>await nd({from:d.aberto_em,to:h,codigoEmpresa:r})),w={codigo_empresa:r||Wn(),caixa_sessao_id:d.id,periodo_de:b?.from||d.aberto_em,periodo_ate:b?.to||h,total_bruto:Number(b?.totalVendasBrutas||0),total_descontos:Number(b?.totalDescontos||0),total_liquido:Number(b?.totalVendasLiquidas||0),total_entradas:Number(b?.totalEntradas||0),por_finalizadora:b?.totalPorFinalizadora||{}},j=w.por_finalizadora;await ve.from("caixa_resumos").insert({...w,por_finalizadora:j&&typeof j!="string"?JSON.stringify(j):j})}catch{}}else{try{if(d?.saldo_inicial==null&&e!=null){let h=ve.from("caixa_sessoes").update({saldo_inicial:Number(e)||0}).eq("id",d.id);return r&&(h=h.eq("codigo_empresa",r)),await h,{...d,saldo_inicial:Number(e)||0}}}catch{}return d}}catch{}return d}const s={status:"open",saldo_inicial:e};r&&(s.codigo_empresa=r);const{data:l,error:c}=await ve.from("caixa_sessoes").insert(s).select("id,status,aberto_em").single();if(c)throw c;return l}async function km({codigoEmpresa:e}={}){const t=e||Wn();let r=ve.from("caixa_sessoes").select("id,status,aberto_em,saldo_inicial").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);t&&(r=r.eq("codigo_empresa",t));const{data:n,error:a}=await r;if(a)throw a;return n?.[0]||null}async function zte({saldoFinal:e=null,valorFinalDinheiro:t=null,codigoEmpresa:r}={}){console.log("[fecharCaixa] Iniciando fechamento:",{valorFinalDinheiro:t,saldoFinal:e,codigoEmpresa:r});const n=r||Wn();try{console.log("[fecharCaixa]  Limpeza preventiva: corrigindo comandas inconsistentes...");const{data:x}=await ve.from("comandas").select("id, status, fechado_em").eq("codigo_empresa",n).is("fechado_em",null).neq("status","open").neq("status","awaiting-payment");if(x&&x.length>0){console.log(`[fecharCaixa]  Encontradas ${x.length} comandas inconsistentes, corrigindo...`);const b=new Date().toISOString();for(const w of x)try{await ve.from("comandas").update({fechado_em:b}).eq("id",w.id).eq("codigo_empresa",n),console.log(`[fecharCaixa]  Comanda ${w.id} (status: ${w.status}) corrigida`)}catch{}}else console.log("[fecharCaixa]  Nenhuma comanda inconsistente encontrada")}catch(x){console.warn("[fecharCaixa]  Erro na limpeza preventiva:",x?.message)}try{let x=await sc({codigoEmpresa:n});if(x=x||[],console.log(`[fecharCaixa]  Comandas abertas encontradas: ${x.length}`,x.map(w=>({id:w.id,status:w.status,mesa:w.mesa_id}))),x&&x.length>0){const w=x.map(j=>`${j.id}${j.mesa_id?`@mesa:${j.mesa_id}`:"@balcao"}`).join(", ");throw new Error(`Existem ${x.length} comanda(s) aberta(s). Feche todas as comandas antes de encerrar o caixa.`)}let b=0;for(;b<12&&(x=await sc({codigoEmpresa:n}),!(!x||x.length===0));)await new Promise(w=>setTimeout(w,250)),b++;if(x&&x.length>0){const w=x.map(E=>E.id);let j=new Map,_=new Map;try{if(w.length>0){let E=ve.from("comanda_itens").select("comanda_id, quantidade").in("comanda_id",w);n&&(E=E.eq("codigo_empresa",n));const{data:P}=await E;j=new Map;for(const k of P||[]){const M=k.comanda_id,S=Number(k.quantidade||0);j.set(M,(j.get(M)||0)+S)}}}catch{}try{if(w.length>0){let E=ve.from("pagamentos").select("comanda_id, status").in("comanda_id",w);n&&(E=E.eq("codigo_empresa",n));const{data:P}=await E;_=new Map;for(const k of P||[]){const M=String(k?.status||"Pago");if(M==="Cancelado"||M==="Estornado")continue;const S=k.comanda_id;_.set(S,(_.get(S)||0)+1)}}}catch{}for(const E of x){const P=Number(j.get(E.id)||0)>0,k=Number(_.get(E.id)||0)>0;if(!P&&!k)try{await Rx({comandaId:E.id,codigoEmpresa:n})}catch{}}let C=await sc({codigoEmpresa:n});if(C=C||[],C.length>0){const E=C.map(S=>S.id);let P=new Map,k=new Map;try{if(E.length>0){let S=ve.from("comanda_itens").select("comanda_id, quantidade").in("comanda_id",E);n&&(S=S.eq("codigo_empresa",n));const{data:I}=await S;P=new Map;for(const T of I||[]){const D=T.comanda_id,B=Number(T.quantidade||0);P.set(D,(P.get(D)||0)+B)}}}catch{}try{if(E.length>0){let S=ve.from("pagamentos").select("comanda_id, status").in("comanda_id",E);n&&(S=S.eq("codigo_empresa",n));const{data:I}=await S;k=new Map;for(const T of I||[]){const D=String(T?.status||"Pago");if(D==="Cancelado"||D==="Estornado")continue;const B=T.comanda_id;k.set(B,(k.get(B)||0)+1)}}}catch{}const M=C.filter(S=>Number(P.get(S.id)||0)>0||Number(k.get(S.id)||0)>0);if(M.length>0){const S=M.map(I=>`${I.id}${I.mesa_id?`@mesa:${I.mesa_id}`:"@balcao"}`).join(", ");throw new Error(`Existem ${M.length} comandas abertas. IDs: ${S}. Feche todas antes de encerrar o caixa.`)}}}}catch(x){if(x&&/Existem \d+ comandas/.test(x.message||""))throw x;const b=new Error("Falha ao validar comandas abertas. Tente novamente e verifique sua conexo.");throw b.code="CASH_CLOSE_VALIDATION_FAILED",b}let a=ve.from("caixa_sessoes").select("id,aberto_em,saldo_inicial").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);n&&(a=a.eq("codigo_empresa",n));const{data:i,error:s}=await a;if(s)throw s;const l=i?.[0]?.id||null,c=i?.[0]?.aberto_em||null,d=Number(i?.[0]?.saldo_inicial||0);if(!l)throw new Error("Nenhuma sesso de caixa aberta encontrada.");const u=new Date().toISOString();let f=0,m=0;try{const x=await nd({from:c,to:u,codigoEmpresa:n});f=Number(x?.totalEntradas||0)}catch{}try{let x=ve.from("caixa_movimentacoes").select("tipo, valor").eq("caixa_sessao_id",l);n&&(x=x.eq("codigo_empresa",n));const{data:b}=await x;for(const w of b||[]){const j=Number(w?.valor||0),_=String(w?.tipo||"").toLowerCase();_==="suprimento"||_==="ajuste"?m+=j:(_==="sangria"||_==="troco")&&(m-=j)}}catch{}const h=e!=null?Number(e):d+f+m;try{let x=await sc({codigoEmpresa:n});if(x=x||[],x.length>0){const b=x.map(C=>C.id);let w=new Map,j=new Map;try{if(b.length>0){let C=ve.from("comanda_itens").select("comanda_id, quantidade").in("comanda_id",b);n&&(C=C.eq("codigo_empresa",n));const{data:E}=await C;w=new Map;for(const P of E||[]){const k=P.comanda_id,M=Number(P.quantidade||0);w.set(k,(w.get(k)||0)+M)}}}catch{}try{if(b.length>0){let C=ve.from("pagamentos").select("comanda_id, status").in("comanda_id",b);n&&(C=C.eq("codigo_empresa",n));const{data:E}=await C;j=new Map;for(const P of E||[]){const k=String(P?.status||"Pago");if(k==="Cancelado"||k==="Estornado")continue;const M=P.comanda_id;j.set(M,(j.get(M)||0)+1)}}}catch{}for(const C of x){const E=Number(w.get(C.id)||0)>0,P=Number(j.get(C.id)||0)>0;if(!E&&!P)try{await Rx({comandaId:C.id,codigoEmpresa:n})}catch{}}let _=await sc({codigoEmpresa:n});if(_=_||[],_.length>0){const C=_.map(E=>`${E.id}${E.mesa_id?`@mesa:${E.mesa_id}`:"@balcao"}`).join(", ");throw new Error(`Existem ${_.length} comandas abertas. IDs: ${C}. Feche todas antes de encerrar o caixa.`)}}}catch(x){if(!(x&&x.message)){const b=new Error("Falha ao validar comandas abertas no momento do fechamento. Tente novamente.");throw b.code="CASH_CLOSE_FINAL_CHECK_FAILED",b}throw x}let v=ve.from("caixa_sessoes").update({status:"closed",saldo_final:h,fechado_em:u}).eq("id",l).eq("status","open");n&&(v=v.eq("codigo_empresa",n));const{data:g,error:y}=await v.select("id,status,fechado_em,saldo_final").single();if(y){const x=String(y.message||"");if(x.toLowerCase().includes("row")||x.toLowerCase().includes("single")){let b=ve.from("caixa_sessoes").select("id,status,fechado_em,saldo_final").eq("id",l).limit(1);n&&(b=b.eq("codigo_empresa",n));const{data:w}=await b;if(w&&w[0])return w[0]}throw y}try{if(c&&u&&g?.status==="closed"){let x;try{x=await D_({caixaSessaoId:l,codigoEmpresa:n})}catch{x=await nd({from:c,to:u,codigoEmpresa:n})}const b={codigo_empresa:n||Wn(),caixa_sessao_id:l,periodo_de:x?.from||c,periodo_ate:x?.to||u,total_bruto:Number(x?.totalVendasBrutas||0),total_descontos:Number(x?.totalDescontos||0),total_liquido:Number(x?.totalVendasLiquidas||0),total_entradas:Number(x?.totalEntradas||0),por_finalizadora:x?.totalPorFinalizadora||{}},w=t!=null?Number(t):null,j=w!=null?w-Number(h||0):null;console.log("[fecharCaixa] Valores para snapshot:",{contado:w,diferenca:j,efetivoSaldoFinal:h,valorFinalDinheiroOriginal:t});const C=await(async E=>{const P={...E},k=P.por_finalizadora;k&&typeof k!="string"&&(P.por_finalizadora=JSON.stringify(k));let M=!0,S=!0;try{const z=localStorage.getItem("schema:caixa_resumos:valor_final_dinheiro"),$=localStorage.getItem("schema:caixa_resumos:diferenca_dinheiro");z==="no"&&(M=!1),$==="no"&&(S=!1)}catch{}if(!M||!S)try{let z=ve.from("caixa_resumos").select("valor_final_dinheiro, diferenca_dinheiro").limit(1);const{error:$}=await z;if(!$){M=!0,S=!0;try{localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","yes"),localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","yes")}catch{}}}catch{}if(!M&&!S)return await ve.from("caixa_resumos").insert(P);let I={...P};M&&w!=null&&(I.valor_final_dinheiro=w),S&&j!=null&&(I.diferenca_dinheiro=j),console.log("[fecharCaixa] Tentando inserir snapshot com:",{supportValor:M,supportDif:S,contado:w,diferenca:j,hasValorFinalDinheiro:"valor_final_dinheiro"in I});const T=await ve.from("caixa_resumos").insert(I);if(!T.error)return T;const D=`${T.error?.message||""} ${T.error?.details||""}`.toLowerCase(),B=T.error?.code;if(B==="42703"||B==="PGRST204"||D.includes("column")||D.includes("schema cache")){try{I.valor_final_dinheiro!==void 0&&localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","no"),I.diferenca_dinheiro!==void 0&&localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","no")}catch{}return await ve.from("caixa_resumos").insert(P)}return T})(b);if(C.error)throw console.error("[fecharCaixa] Erro ao inserir snapshot:",C.error),C.error;console.log("[fecharCaixa]  Snapshot inserido com sucesso");try{const{data:E}=await ve.from("caixa_resumos").select("valor_final_dinheiro, diferenca_dinheiro").eq("caixa_sessao_id",l).order("criado_em",{ascending:!1}).limit(1).single();console.log("[fecharCaixa] Verificao ps-insert:",E)}catch(E){console.warn("[fecharCaixa] Falha ao verificar snapshot:",E?.message)}}}catch(x){console.warn("[fecharCaixa] Falha ao gravar snapshot de fechamento:",x)}try{let x=ve.from("caixa_sessoes").select("id,aberto_em,saldo_inicial").eq("status","open");n&&(x=x.eq("codigo_empresa",n));const{data:b}=await x;if(Array.isArray(b)&&b.length>0)for(const w of b)try{const j=w?.aberto_em,_=Number(w?.saldo_inicial||0),C=new Date().toISOString();let E=0,P=0;try{const M=await nd({from:j,to:C,codigoEmpresa:n});E=Number(M?.totalEntradas||0)}catch{}try{let M=ve.from("caixa_movimentacoes").select("tipo,valor").eq("caixa_sessao_id",w.id);n&&(M=M.eq("codigo_empresa",n));const{data:S}=await M;for(const I of S||[]){const T=Number(I?.valor||0),D=String(I?.tipo||"").toLowerCase();D==="suprimento"||D==="ajuste"?P+=T:(D==="sangria"||D==="troco")&&(P-=T)}}catch{}const k=_+E+P;await ve.from("caixa_sessoes").update({status:"closed",saldo_final:k,fechado_em:C}).eq("id",w.id).eq("status","open").eq(n?"codigo_empresa":"id",n||w.id);try{const M=await D_({caixaSessaoId:w.id,codigoEmpresa:n}).catch(async()=>await nd({from:j,to:C,codigoEmpresa:n})),S={codigo_empresa:n||Wn(),caixa_sessao_id:w.id,periodo_de:M?.from||j,periodo_ate:M?.to||C,total_bruto:Number(M?.totalVendasBrutas||0),total_descontos:Number(M?.totalDescontos||0),total_liquido:Number(M?.totalVendasLiquidas||0),total_entradas:Number(M?.totalEntradas||0),por_finalizadora:M?.totalPorFinalizadora||{}},I=S.por_finalizadora;await ve.from("caixa_resumos").insert({...S,por_finalizadora:I&&typeof I!="string"?JSON.stringify(I):I})}catch{}}catch(j){try{console.warn("[fecharCaixa] Saneamento: falhou ao fechar sesso remanescente",w?.id,j?.message||j)}catch{}}}catch{}return g}async function Ute({from:e,to:t,limit:r=50,codigoEmpresa:n}={}){console.log("[listarFechamentosCaixa] Iniciando busca de fechamentos",{from:e,to:t,limit:r});const a=n||Wn();let i=ve.from("caixa_sessoes").select("id, aberto_em, fechado_em, saldo_inicial, saldo_final, status").eq("status","closed").order("fechado_em",{ascending:!1}).limit(r);a&&(i=i.eq("codigo_empresa",a)),e&&(i=i.gte("fechado_em",`${e}T00:00:00`)),t&&(i=i.lte("fechado_em",`${t}T23:59:59`));const{data:s,error:l}=await i;if(l)throw l;const c=Array.isArray(s)?s:[];if(console.log("[listarFechamentosCaixa] Sesses fechadas encontradas:",c.length),c.length===0)return[];const d=c.map(h=>h.id);let u=[];try{let h=!0,v=!0;try{const j=localStorage.getItem("schema:caixa_resumos:valor_final_dinheiro"),_=localStorage.getItem("schema:caixa_resumos:diferenca_dinheiro");j==="no"&&(h=!1),_==="no"&&(v=!1)}catch{}if(!h||!v)try{let j=ve.from("caixa_resumos").select("valor_final_dinheiro, diferenca_dinheiro").limit(1);const{error:_}=await j;if(!_){h=!0,v=!0;try{localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","yes"),localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","yes")}catch{}}}catch{}const g=["caixa_sessao_id"];h&&g.push("valor_final_dinheiro"),v&&g.push("diferenca_dinheiro");const y=g.join(", ");let x=ve.from("caixa_resumos").select(y).in("caixa_sessao_id",d).order("criado_em",{ascending:!1});a&&(x=x.eq("codigo_empresa",a));let{data:b,error:w}=await x;if(w){const j=w?.code,_=`${w?.message||""} ${w?.details||""}`.toLowerCase();if(j==="42703"||j==="PGRST204"||_.includes("column")||_.includes("schema cache")){try{h&&localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","no"),v&&localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","no")}catch{}let E=ve.from("caixa_resumos").select("caixa_sessao_id").in("caixa_sessao_id",d).order("criado_em",{ascending:!1});a&&(E=E.eq("codigo_empresa",a));const{data:P}=await E;u=P||[]}else throw w}else u=b||[]}catch(h){console.warn("[listarFechamentosCaixa] Erro ao buscar snapshots:",h?.message),u=[]}console.log("[listarFechamentosCaixa] Snapshots encontrados:",u.length,u);const f=new Map(u.map(h=>[h.caixa_sessao_id,h])),m=c.map(h=>{const v=f.get(h.id),g={...h,valor_final_dinheiro:v?.valor_final_dinheiro??null,diferenca_dinheiro:v?.diferenca_dinheiro??null};return v&&console.log(`[listarFechamentosCaixa] Sesso ${h.id} enriquecida com snapshot:`,{valor_final_dinheiro:v.valor_final_dinheiro,diferenca_dinheiro:v.diferenca_dinheiro}),g});return console.log("[listarFechamentosCaixa] Resultado final:",m.length,"sesses com dados enriquecidos"),m}async function M_({caixaSessaoId:e,codigoEmpresa:t}={}){if(!e)throw new Error("caixaSessaoId  obrigatrio");const r=t||Wn();let n=null;try{let a=!0,i=!0;try{const f=localStorage.getItem("schema:caixa_resumos:valor_final_dinheiro"),m=localStorage.getItem("schema:caixa_resumos:diferenca_dinheiro");f==="no"&&(a=!1),m==="no"&&(i=!1)}catch{}if(!a||!i)try{let f=ve.from("caixa_resumos").select("valor_final_dinheiro, diferenca_dinheiro").limit(1);const{error:m}=await f;if(!m){a=!0,i=!0;try{localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","yes"),localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","yes")}catch{}}}catch{}const s=["caixa_sessao_id","periodo_de","periodo_ate","total_bruto","total_descontos","total_liquido","total_entradas","por_finalizadora"];a&&s.push("valor_final_dinheiro"),i&&s.push("diferenca_dinheiro");const l=s.join(", ");let c=ve.from("caixa_resumos").select(l).eq("caixa_sessao_id",e).order("criado_em",{ascending:!1}).limit(1);r&&(c=c.eq("codigo_empresa",r));let{data:d,error:u}=await c;if(u){const f=u?.code,m=`${u?.message||""} ${u?.details||""}`.toLowerCase();if(f==="42703"||f==="PGRST204"||m.includes("column")||m.includes("schema cache")){try{a&&localStorage.setItem("schema:caixa_resumos:valor_final_dinheiro","no"),i&&localStorage.setItem("schema:caixa_resumos:diferenca_dinheiro","no")}catch{}let v=ve.from("caixa_resumos").select("caixa_sessao_id, periodo_de, periodo_ate, total_bruto, total_descontos, total_liquido, total_entradas, por_finalizadora").eq("caixa_sessao_id",e).order("criado_em",{ascending:!1}).limit(1);r&&(v=v.eq("codigo_empresa",r));const{data:g}=await v;n=g?.[0]||null}else throw u}else n=d?.[0]||null}catch(a){try{console.warn("[getCaixaResumo] Snapshot select falhou, usando fallback dinmico:",a?.message||a)}catch{}}if(!n||typeof n.saldo_inicial>"u"||typeof n.saldo_final>"u"){const a=await D_({caixaSessaoId:e,codigoEmpresa:r});let i=null;try{let s=ve.from("caixa_sessoes").select("saldo_inicial, saldo_final").eq("id",e).limit(1);r&&(s=s.eq("codigo_empresa",r));const{data:l}=await s;i=l?.[0]||null}catch{}n={codigo_empresa:r,caixa_sessao_id:e,periodo_de:a?.from||null,periodo_ate:a?.to||null,total_bruto:Number(a?.totalVendasBrutas||0),total_descontos:Number(a?.totalDescontos||0),total_liquido:Number(a?.totalVendasLiquidas||0),total_entradas:Number(a?.totalEntradas||0),por_finalizadora:a?.totalPorFinalizadora||{},saldo_inicial:Number(i?.saldo_inicial??a?.saldoInicial??0),saldo_final:i?.saldo_final!=null?Number(i.saldo_final):null,movimentos:a?.movimentos||{suprimentos:0,sangrias:0,ajustes:0,troco:0,totalMovimentos:0}}}else if(typeof n.por_finalizadora=="string")try{n.por_finalizadora=JSON.parse(n.por_finalizadora)}catch{n.por_finalizadora={}}return n}async function G3({tipo:e,valor:t,observacao:r="",caixaSessaoId:n,codigoEmpresa:a}={}){const i=a||Wn();if(!e||!["sangria","suprimento","troco","ajuste"].includes(e))throw new Error("Tipo invlido de movimentao");let s=n;if(!s){let u=ve.from("caixa_sessoes").select("id").eq("status","open").order("aberto_em",{ascending:!1}).limit(1);i&&(u=u.eq("codigo_empresa",i));const{data:f,error:m}=await u;if(m)throw m;s=f?.[0]?.id||null}if(!s)throw new Error("Sesso de caixa no encontrada para registrar movimentao");const l={codigo_empresa:i,caixa_sessao_id:s,tipo:e,valor:Math.max(0,Number(t)||0),observacao:(r||"").trim()||null},{data:c,error:d}=await ve.from("caixa_movimentacoes").insert(l).select("*").single();if(d)throw d;return c}async function Op({caixaSessaoId:e,codigoEmpresa:t}={}){const r=t||Wn();if(!e)throw new Error("caixaSessaoId  obrigatrio");let n=ve.from("caixa_movimentacoes").select("*").eq("caixa_sessao_id",e).order("criado_em",{ascending:!0});r&&(n=n.eq("codigo_empresa",r));const{data:a,error:i}=await n;if(i)throw i;return a||[]}async function rGe({mesaId:e,codigoEmpresa:t}={}){const r=t||Wn();await lM({codigoEmpresa:r}),console.log(`[abrirComandaParaMesa] Iniciando para mesaId: ${e}, codigo_empresa: ${r}`);try{const n={status:"open",aberto_em:new Date().toISOString()};e&&(n.mesa_id=e),console.log("[abrirComandaParaMesa] Payload (codigo_empresa via DEFAULT):",n);const{data:a,error:i}=await ve.from("comandas").insert(n).select("*").single();if(i)throw console.error("[abrirComandaParaMesa] ERRO ao criar comanda:",i),i;return console.log("[abrirComandaParaMesa]  Comanda criada:",a),await new Promise(s=>setTimeout(s,100)),a}catch(n){throw console.error("[abrirComandaParaMesa] ERRO:",n),n}}async function nGe({mesaId:e,codigoEmpresa:t}){const r=t||Wn();let n=ve.from("comandas").select("id,status,aberto_em,fechado_em").eq("mesa_id",e).is("fechado_em",null).in("status",["open","awaiting-payment"]).order("aberto_em",{ascending:!1}).limit(1);r&&(n=n.eq("codigo_empresa",r));const{data:a,error:i}=await n;if(i)throw i;return a?.[0]||null}async function Ci({comandaId:e,codigoEmpresa:t}){const r=t||Wn();let n=ve.from("comanda_itens").select("*").eq("comanda_id",e).order("created_at",{ascending:!0});r&&(n=n.eq("codigo_empresa",r));const{data:a,error:i}=await n;if(i)throw i;return a||[]}async function Vv({codigoEmpresa:e}){const t=e||Wn();let r=ve.from("comandas").select("id").is("fechado_em",null);t&&(r=r.eq("codigo_empresa",t));const{data:n,error:a}=await r;if(a)throw a;if(console.log("[listarItensDeTodasComandasAbertas] Comandas abertas:",n?.length||0,"IDs:",n?.map(d=>d.id)),!n||n.length===0)return console.log("[listarItensDeTodasComandasAbertas] Nenhuma comanda aberta encontrada"),[];const i=n.map(d=>d.id);let s=ve.from("comanda_itens").select("produto_id, quantidade").in("comanda_id",i);t&&(s=s.eq("codigo_empresa",t));const{data:l,error:c}=await s;if(c)throw c;return console.log("[listarItensDeTodasComandasAbertas] Itens encontrados:",l?.length||0),l&&l.length>0&&console.log("[listarItensDeTodasComandasAbertas] Detalhes dos itens:",l),l||[]}const T2=new Map;async function aGe({mesaId:e,codigoEmpresa:t}={}){const r=`${e}:${t||Wn()}`;if(T2.has(r))return console.log(`[getOrCreateComandaForMesa]  Operao j em andamento para mesa ${e}, aguardando...`),T2.get(r);const n=t||Wn(),a=(async()=>{try{await lM({codigoEmpresa:n}),console.log(`[getOrCreateComandaForMesa]  Criando nova comanda para mesa ${e}`);const i=await nGe({mesaId:e,codigoEmpresa:n});if(i){console.log(`[getOrCreateComandaForMesa]  Comanda existente ${i.id} encontrada, verificando se est vazia...`);let l=!1,c=!1;try{l=(await Ci({comandaId:i.id,codigoEmpresa:n})||[]).length>0}catch{}try{const{data:d}=await ve.from("pagamentos").select("id, status").eq("comanda_id",i.id).eq("codigo_empresa",n);c=(d||[]).filter(f=>{const m=String(f?.status||"Pago");return m!=="Cancelado"&&m!=="Estornado"}).length>0}catch{}if(!l&&!c){console.log(`[getOrCreateComandaForMesa]  Comanda ${i.id} est vazia, fechando automaticamente...`);try{await Rx({comandaId:i.id,codigoEmpresa:n}),console.log(`[getOrCreateComandaForMesa]  Comanda ${i.id} fechada com sucesso`)}catch(d){console.warn(`[getOrCreateComandaForMesa]  Erro ao fechar comanda ${i.id}:`,d?.message)}}else console.log(`[getOrCreateComandaForMesa]  Comanda ${i.id} tem dados (itens: ${l}, pagamentos: ${c}), no ser fechada automaticamente`)}console.log(`[getOrCreateComandaForMesa]  Criando comanda zerada para mesa ${e}`);const s=await rGe({mesaId:e,codigoEmpresa:n});return console.log(`[getOrCreateComandaForMesa]  Comanda ${s.id} criada com sucesso`),s}finally{T2.delete(r),console.log(`[getOrCreateComandaForMesa]  Lock liberado para mesa ${e}`)}})();return T2.set(r,a),a}async function Wv({comandaId:e,clienteIds:t=[],nomesLivres:r=[],codigoEmpresa:n,replace:a=!1}={}){const i=n||Wn();if(!e)throw new Error("comandaId  obrigatrio");let s=[],l=[];try{s=Array.isArray(t)?t:t?[t]:[]}catch(h){console.warn("[adicionarClientesAComanda] Erro ao processar clienteIds:",h),s=[]}try{l=Array.isArray(r)?r:r?[r]:[]}catch(h){console.warn("[adicionarClientesAComanda] Erro ao processar nomesLivres:",h),l=[]}const c=s.map(h=>h&&typeof h=="object"?h.id||h.cliente_id||h.value:h).filter(Boolean),d=l.map(h=>h&&typeof h=="object"?h.nome||h.name||h.label:h).map(h=>String(h||"").trim()).filter(Boolean);if(console.log(`[adicionarClientesAComanda] Adicionando clientes  comanda ${e}:`,{clienteIds:c,nomesLivres:d,codigo:i,replace:a}),a){const{error:h}=await ve.from("comanda_clientes").delete().eq("comanda_id",e);h&&console.warn("[adicionarClientesAComanda] Erro ao limpar clientes existentes:",h)}const u=[];if(Array.isArray(c)){let h=[];if(!a)try{const{data:g}=await ve.from("comanda_clientes").select("cliente_id, nome_livre").eq("comanda_id",e);h=Array.isArray(g)?g:[]}catch{}const v=new Set((h||[]).map(g=>g.cliente_id).filter(Boolean));for(let g=0;g<c.length;g++){const y=c[g];y&&(!a&&v.has(y)||u.push({comanda_id:e,cliente_id:y}))}}if(Array.isArray(d))for(let h=0;h<d.length;h++){const g=(d[h]||"").trim();g&&u.push({comanda_id:e,nome_livre:g})}if(u.length===0)return console.log("[adicionarClientesAComanda] Nenhum cliente para adicionar"),!0;let f=[];Array.isArray(u)&&(f=u.map(h=>i?{...h,codigo_empresa:i}:h)),console.log("[adicionarClientesAComanda] Payload para insero:",f);const{error:m}=await ve.from("comanda_clientes").insert(f);if(m)throw console.error("[adicionarClientesAComanda] ERRO ao inserir clientes:",m),m;return console.log("[adicionarClientesAComanda] Clientes adicionados com sucesso"),!0}async function Zi({comandaId:e,codigoEmpresa:t}={}){if(t||Wn(),!e)throw new Error("comandaId  obrigatrio");try{const{data:r,error:n}=await ve.from("comanda_clientes").select("id, cliente_id, nome_livre, clientes:clientes!comanda_clientes_cliente_id_fkey(id, codigo, nome, email, telefone)").eq("comanda_id",e).order("created_at",{ascending:!0});if(n)throw n;return(r||[]).map(a=>({id:a.id,tipo:a.cliente_id?"cadastrado":"livre",nome:a.clientes?.nome||a.nome_livre,cliente_id:a.cliente_id}))}catch{try{const{data:n,error:a}=await ve.from("comanda_clientes").select("id, cliente_id, nome_livre, clientes:clientes!fk_comanda_clientes_cliente(id, nome, email, telefone)").eq("comanda_id",e).order("created_at",{ascending:!0});if(a)throw a;return(n||[]).map(i=>({id:i.id,tipo:i.cliente_id?"cadastrado":"livre",nome:i.clientes?.nome||i.nome_livre,cliente_id:i.cliente_id}))}catch{const{data:a,error:i}=await ve.from("comanda_clientes").select("id, cliente_id, nome_livre").eq("comanda_id",e).order("created_at",{ascending:!0});if(i)throw i;return(a||[]).map(s=>({id:s.id,tipo:s.cliente_id?"cadastrado":"livre",nome:s.nome_livre||"",cliente_id:s.cliente_id}))}}}async function K3({comandaId:e,produtoId:t,descricao:r,quantidade:n,precoUnitario:a,desconto:i=0,codigoEmpresa:s}){const l=s||Wn();console.log(`[adicionarItem] Adicionando item  comanda ${e}:`,{produtoId:t,descricao:r,quantidade:n,precoUnitario:a,codigo:l});try{let f=ve.from("produtos").select("id, estoque, estoque_minimo, nome").eq("id",t).limit(1);l&&(f=f.eq("codigo_empresa",l));const{data:m,error:h}=await f;if(h)throw h;const v=Array.isArray(m)?m[0]:m;if(v){const g=Number(v.estoque??0),y=Number(v.estoque_minimo??0),x=Number(n??1);if(g<=0){const E=new Error(`Produto sem estoque: ${v.nome||""}`.trim());throw E.code="OUT_OF_STOCK",E}let b=ve.from("comanda_itens").select("quantidade").eq("comanda_id",e).eq("produto_id",t);l&&(b=b.eq("codigo_empresa",l));const{data:w,error:j}=await b;if(j)throw j;const _=Array.isArray(w)&&w.length?w.reduce((E,P)=>E+Number(P?.quantidade||0),0):0;if(_+x>g){const E=new Error(`Estoque insuficiente. Em comanda: ${_}, solicitado: +${x}, disponvel: ${g}`);throw E.code="INSUFFICIENT_STOCK",E}if(g<=y&&g>0)try{console.warn(`[adicionarItem] Aviso: estoque baixo para produto '${v.nome}' (estoque=${g}, minimo=${y})`)}catch{}}}catch(f){throw f}const c={comanda_id:e,produto_id:t,descricao:r,quantidade:n,preco_unitario:a,desconto:i};l&&(c.codigo_empresa=l);const{data:d,error:u}=await ve.from("comanda_itens").insert(c).select("*").single();if(u)throw u;return d}async function Vc({itemId:e,quantidade:t,codigoEmpresa:r}){const n=r||Wn();let a=ve.from("comanda_itens").select("id, quantidade, produto_id, comanda_id").eq("id",e).limit(1);n&&(a=a.eq("codigo_empresa",n));const{data:i,error:s}=await a;if(s)throw s;const l=Array.isArray(i)?i[0]:i,c=Number(t||0);if(!l)throw new Error("Item no encontrado");const d=Number(l.quantidade||0);if(c-d>0){let v=ve.from("produtos").select("id, estoque, nome, estoque_minimo").eq("id",l.produto_id).limit(1);n&&(v=v.eq("codigo_empresa",n));const{data:g,error:y}=await v;if(y)throw y;const x=Array.isArray(g)?g[0]:g;if(x){const b=Number(x.estoque??0);let w=ve.from("comanda_itens").select("quantidade").eq("comanda_id",l.comanda_id).eq("produto_id",l.produto_id).neq("id",l.id);n&&(w=w.eq("codigo_empresa",n));const{data:j,error:_}=await w;if(_)throw _;const C=Array.isArray(j)&&j.length?j.reduce((M,S)=>M+Number(S?.quantidade||0),0):0;if(C+c>b){const M=new Error(`Estoque insuficiente. Em comanda (outros itens): ${C}, novo para este item: ${c}, disponvel: ${b}`);throw M.code="INSUFFICIENT_STOCK",M}const P=Number(x.estoque_minimo??0),k=b-(C+c);if(k<=P&&k>=0)try{console.warn(`[atualizarQuantidadeItem] Aviso: produto '${x.nome}' atingiu nvel de estoque baixo (restante=${k}, minimo=${P})`)}catch{}}}let f=ve.from("comanda_itens").update({quantidade:c}).eq("id",e);n&&(f=f.eq("codigo_empresa",n));const{data:m,error:h}=await f.select("*").single();if(h)throw h;return m}async function Cv({itemId:e,codigoEmpresa:t}){const r=t||Wn();let n=ve.from("comanda_itens").delete().eq("id",e);r&&(n=n.eq("codigo_empresa",r));const{data:a,error:i}=await n.select("id");if(i&&i.code!=="PGRST116")throw i;return Array.isArray(a)&&a.length>0}function oGe(e){if(!e)return!1;const t=e.code?String(e.code):"",r=[e.message,e.details,e.hint].filter(Boolean).join(" ").toLowerCase();return t==="22P02"||r.includes("invalid input value for enum")}async function dM({comandaId:e,finalizadoraId:t,metodo:r,valor:n,status:a="Pago",codigoEmpresa:i,clienteId:s=null}){const l=i||Wn();if(!l)throw new Error("Empresa no identificada (codigo_empresa ausente).");const c=a&&["Pendente","Pago","Estornado","Cancelado"].includes(a)?a:"Pago",d=["dinheiro","credito","debito","pix","voucher","outros"],f=(h=>{if(!h)return"outros";const v=String(h).toLowerCase().trim(),y={"cartao credito":"credito","carto credito":"credito","cartao debito":"debito","carto debito":"debito","carto de credito":"credito","carto de dbito":"debito","cartao de credito":"credito","cartao de debito":"debito"}[v]||v;return d.includes(y)?y:"outros"})(r),m={comanda_id:e,finalizadora_id:t||null,metodo:f,valor:Math.max(0,Number(n)||0),status:c,recebido_em:new Date().toISOString(),codigo_empresa:l};s&&(m.cliente_id=s),console.log("[registrarPagamento] Iniciando registro de pagamento:",{comandaId:e,finalizadoraId:t,metodo:f,valor:m.valor,status:m.status,codigoEmpresa:l,payload:m});try{const{data:h,error:v}=await ve.from("pagamentos").insert(m).select().single();if(v){console.warn("[registrarPagamento] Primeira tentativa falhou:",{code:v.code,message:v.message});const g=`${v?.message||""} ${v?.details||""}`.toLowerCase();if(v?.code==="42703"||g.includes("column")&&g.includes("cliente_id")){const{cliente_id:x,...b}=m;try{localStorage.setItem("schema:pagamentos:cliente_id","no")}catch{}const{data:w,error:j}=await ve.from("pagamentos").insert(b).select().single();if(j)throw j;return console.log("[registrarPagamento] Pagamento registrado sem cliente_id:",w),w}if(oGe(v)){console.log("[registrarPagamento] Tentando abordagem alternativa sem status...");try{const x={...m};delete x.status;const{data:b,error:w}=await ve.from("pagamentos").insert(x).select().single();if(w)throw w;return console.log("[registrarPagamento] Pagamento registrado com sucesso (abordagem alternativa):",b),b}catch(x){throw console.error("[registrarPagamento] Falha na abordagem alternativa:",x),new Error(`Falha ao processar pagamento: ${x.message}`)}}throw v}return console.log("[registrarPagamento] Pagamento registrado com sucesso:",h),h}catch(h){throw console.error("[registrarPagamento] Erro ao registrar pagamento:",{error:{message:h.message,code:h.code,details:h.details,hint:h.hint},comandaId:e,finalizadoraId:t,valor:m.valor,status:m.status,codigoEmpresa:l}),h}}async function Rx({comandaId:e,codigoEmpresa:t,diferencaPagamento:r}){const n=t||Wn(),a="[fecharComandaEMesa]";try{console.group(a)}catch{}try{console.time?.(a)}catch{}try{console.log(`${a} Iniciando fechamento da comanda ${e}`),console.log(`${a} Obtendo dados da comanda...`);const{data:i,error:s}=await ve.from("comandas").select("id, mesa_id, status, fechado_em").eq("id",e).single();if(s||!i)throw console.error(`${a} Erro ao buscar comanda:`,s?.message||"Comanda no encontrada"),s||new Error("Comanda no encontrada");if(i.fechado_em)return console.log(`${a} Comanda ${e} j est fechada em ${i.fechado_em}`),!0;const l=new Date().toISOString();console.log(`${a} Atualizando comanda...`);const c={status:"closed",fechado_em:l};typeof r=="number"&&Number.isFinite(r)&&(c.diferenca_pagamento=r),console.log(`${a} Fechando comanda com status closed + fechado_em${c.diferenca_pagamento!=null?" + diferenca_pagamento":""}...`);let{error:d}=await ve.from("comandas").update(c).eq("id",e).eq("codigo_empresa",n);if(d&&d.code==="42703"){console.warn(`${a} Coluna diferenca_pagamento ausente no schema, tentando novamente sem ela...`);const u={status:"closed",fechado_em:l};({error:d}=await ve.from("comandas").update(u).eq("id",e).eq("codigo_empresa",n))}if(d)throw console.error(`${a} Erro ao fechar comanda:`,d),d;if(console.log(`${a} Comanda ${e} fechada com sucesso`),i.mesa_id){console.log(`${a} Atualizando status da mesa ${i.mesa_id} para disponvel...`);try{const{error:u}=await ve.from("mesas").update({status:"available"}).eq("id",i.mesa_id).select("id").single();u?console.error(`${a} Erro ao atualizar status da mesa:`,u):console.log(`${a} Mesa ${i.mesa_id} marcada como disponvel`)}catch(u){console.error(`${a} Exceo ao atualizar mesa:`,u)}}else console.log(`${a} Nenhuma mesa associada para liberar`);return console.log(`${a} Fechamento da comanda ${e} concludo com sucesso`),!0}catch(i){throw console.error(`${a} Erro fatal ao fechar comanda:`,i),i}finally{try{console.timeEnd?.(a)}catch{}try{console.groupEnd()}catch{}}}async function Dq({comandaId:e,codigoEmpresa:t}){const r=t||Wn(),n="[cancelarComandaEMesa]";try{console.group(n)}catch{}try{console.time?.(n)}catch{}try{if(!e)throw new Error("comandaId obrigatrio");if(!r)throw new Error("codigo_empresa obrigatrio");console.log(`${n} Cancelando comanda ${e}`);const{data:a}=await ve.from("comandas").select("id, mesa_id").eq("id",e).single();try{await ve.from("comanda_itens").delete().eq("comanda_id",e).eq("codigo_empresa",r)}catch{}try{await ve.from("comanda_clientes").delete().eq("comanda_id",e).eq("codigo_empresa",r)}catch{}const i=new Date().toISOString(),{data:s,error:l}=await ve.from("comandas").update({status:"cancelled",fechado_em:i}).eq("id",e).eq("codigo_empresa",r).select();if(l)throw console.error(`${n} Erro ao atualizar comanda:`,l),l;if(!s||s.length===0)throw console.error(`${n}  UPDATE no afetou nenhuma linha! Comanda ${e} no foi encontrada ou RLS bloqueou`),new Error("Comanda no encontrada ou sem permisso para cancelar");if(console.log(`${n}  Comanda atualizada:`,s[0]),a?.mesa_id){console.log(`${n} Liberando mesa ${a.mesa_id}`);try{await ve.from("mesas").update({status:"available"}).eq("id",a.mesa_id)}catch(c){console.error(`${n} Erro ao liberar mesa:`,c)}}return console.log(`${n} Comanda ${e} cancelada com sucesso`),!0}catch(a){throw console.error(`${n} Falha:`,a),a}finally{try{console.timeEnd?.(n)}catch{}try{console.groupEnd?.(n)}catch{}}}async function iGe({itemId:e,desconto_tipo:t,desconto_valor:r,desconto_motivo:n,codigoEmpresa:a}={}){const i=a||Wn();if(!e)throw new Error("itemId  obrigatrio");if(!["percentual","fixo"].includes(t))throw new Error('Tipo de desconto deve ser "percentual" ou "fixo"');if(r<0)throw new Error("Desconto no pode ser negativo");if(t==="percentual"&&r>100)throw new Error("Desconto percentual no pode ser maior que 100%");let s=ve.from("comanda_itens").update({desconto_tipo:t,desconto_valor:Number(r),desconto_motivo:n||null}).eq("id",e);i&&(s=s.eq("codigo_empresa",i));const{data:l,error:c}=await s.select("*").single();if(c)throw c;return l}async function sGe({comandaId:e,desconto_tipo:t,desconto_valor:r,desconto_motivo:n,codigoEmpresa:a}={}){const i=a||Wn();if(!e)throw new Error("comandaId  obrigatrio");if(!["percentual","fixo"].includes(t))throw new Error('Tipo de desconto deve ser "percentual" ou "fixo"');if(r<0)throw new Error("Desconto no pode ser negativo");if(t==="percentual"&&r>100)throw new Error("Desconto percentual no pode ser maior que 100%");let s=ve.from("comandas").update({desconto_tipo:t,desconto_valor:Number(r),desconto_motivo:n||null}).eq("id",e);i&&(s=s.eq("codigo_empresa",i));const{data:l,error:c}=await s.select("*").single();if(c)throw c;return l}async function lGe({itemId:e,codigoEmpresa:t}={}){const r=t||Wn();if(!e)throw new Error("itemId  obrigatrio");let n=ve.from("comanda_itens").update({desconto_tipo:null,desconto_valor:0,desconto_motivo:null}).eq("id",e);r&&(n=n.eq("codigo_empresa",r));const{data:a,error:i}=await n.select("*").single();if(i)throw i;return a}async function cGe({comandaId:e,codigoEmpresa:t}={}){const r=t||Wn();if(!e)throw new Error("comandaId  obrigatrio");let n=ve.from("comandas").update({desconto_tipo:null,desconto_valor:0,desconto_motivo:null}).eq("id",e);r&&(n=n.eq("codigo_empresa",r));const{data:a,error:i}=await n.select("*").single();if(i)throw i;return a}async function dGe({comandaId:e,observacoes:t,codigoEmpresa:r}={}){if(!e)throw new Error("comandaId  obrigatrio");const{error:n}=await ve.from("comandas").update({observacoes:(t||"").trim()||null,observacoes_atualizadas_em:new Date().toISOString()}).eq("id",e);if(n)throw n;return{id:e}}var e5="Tabs",[uGe,Jst]=pd(e5,[XC]),Vte=XC(),[fGe,uM]=uGe(e5),Wte=p.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,onValueChange:a,defaultValue:i,orientation:s="horizontal",dir:l,activationMode:c="automatic",...d}=e,u=WC(l),[f,m]=kf({prop:n,onChange:a,defaultProp:i??"",caller:e5});return o.jsx(fGe,{scope:r,baseId:Hd(),value:f,onValueChange:m,orientation:s,dir:u,activationMode:c,children:o.jsx(Hn.div,{dir:u,"data-orientation":s,...d,ref:t})})});Wte.displayName=e5;var Hte="TabsList",Gte=p.forwardRef((e,t)=>{const{__scopeTabs:r,loop:n=!0,...a}=e,i=uM(Hte,r),s=Vte(r);return o.jsx(Hee,{asChild:!0,...s,orientation:i.orientation,dir:i.dir,loop:n,children:o.jsx(Hn.div,{role:"tablist","aria-orientation":i.orientation,...a,ref:t})})});Gte.displayName=Hte;var Kte="TabsTrigger",Yte=p.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,disabled:a=!1,...i}=e,s=uM(Kte,r),l=Vte(r),c=Qte(s.baseId,n),d=Zte(s.baseId,n),u=n===s.value;return o.jsx(Gee,{asChild:!0,...l,focusable:!a,active:u,children:o.jsx(Hn.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":d,"data-state":u?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:c,...i,ref:t,onMouseDown:Jr(e.onMouseDown,f=>{!a&&f.button===0&&f.ctrlKey===!1?s.onValueChange(n):f.preventDefault()}),onKeyDown:Jr(e.onKeyDown,f=>{[" ","Enter"].includes(f.key)&&s.onValueChange(n)}),onFocus:Jr(e.onFocus,()=>{const f=s.activationMode!=="manual";!u&&!a&&f&&s.onValueChange(n)})})})});Yte.displayName=Kte;var Xte="TabsContent",Jte=p.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,forceMount:a,children:i,...s}=e,l=uM(Xte,r),c=Qte(l.baseId,n),d=Zte(l.baseId,n),u=n===l.value,f=p.useRef(u);return p.useEffect(()=>{const m=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(m)},[]),o.jsx(Ac,{present:a||u,children:({present:m})=>o.jsx(Hn.div,{"data-state":u?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!m,id:d,tabIndex:0,...s,ref:t,style:{...e.style,animationDuration:f.current?"0s":void 0},children:m&&i})})});Jte.displayName=Xte;function Qte(e,t){return`${e}-trigger-${t}`}function Zte(e,t){return`${e}-content-${t}`}var mGe=Wte,ere=Gte,tre=Yte,rre=Jte;const Fd=mGe,ad=ye.forwardRef(({className:e,...t},r)=>o.jsx(ere,{ref:r,className:Yt("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));ad.displayName=ere.displayName;const wa=ye.forwardRef(({className:e,...t},r)=>o.jsx(tre,{ref:r,className:Yt("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));wa.displayName=tre.displayName;const Wi=ye.forwardRef(({className:e,...t},r)=>o.jsx(rre,{ref:r,className:Yt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));Wi.displayName=rre.displayName;function nre({open:e,onOpenChange:t,client:r,onSaved:n}){const{toast:a}=oo(),{userProfile:i}=Do(),s=S=>({tipo_pessoa:S?.tipo_pessoa||"PF",tipo_cadastro:S?.tipo_cadastro||"cliente",nome:S?.nome||"",apelido:S?.apelido||"",cpf:S?.cpf||"",cnpj:S?.cnpj||"",rg:S?.rg||"",ie:S?.ie||"",email:S?.email||"",telefone:S?.telefone||"",fone2:S?.fone2||"",celular1:S?.celular1||"",celular2:S?.celular2||"",whatsapp:S?.whatsapp||"",cep:S?.cep||"",endereco:S?.endereco||"",numero:S?.numero||"",complemento:S?.complemento||"",bairro:S?.bairro||"",cidade:S?.cidade||"",uf:S?.uf||"",cidade_ibge:S?.cidade_ibge||"",limite_credito:S?.limite_credito??"",tipo_recebimento:S?.tipo_recebimento||"",regime_tributario:S?.regime_tributario||"",tipo_contribuinte:S?.tipo_contribuinte||"",aniversario:S?.aniversario?String(S.aniversario).slice(0,10):"",sexo:S?.sexo||"",estado_civil:S?.estado_civil||"",nome_mae:S?.nome_mae||"",nome_pai:S?.nome_pai||"",observacoes:S?.observacoes||"",status:S?.status||"active"}),[l,c]=p.useState(s(r)),[d,u]=p.useState("basicos"),[f,m]=p.useState(!1);p.useEffect(()=>{let S="cliente";r?.flag_cliente&&r?.flag_fornecedor?S="ambos":r?.flag_fornecedor&&(S="fornecedor"),c({tipo_pessoa:r?.tipo_pessoa||"PF",tipo_cadastro:S,nome:r?.nome||"",apelido:r?.apelido||"",cpf:r?.cpf||"",cnpj:r?.cnpj||"",rg:r?.rg||"",ie:r?.ie||"",email:r?.email||"",telefone:r?.telefone||"",fone2:r?.fone2||"",celular1:r?.celular1||"",celular2:r?.celular2||"",whatsapp:r?.whatsapp||"",cep:r?.cep||"",endereco:r?.endereco||"",numero:r?.numero||"",complemento:r?.complemento||"",bairro:r?.bairro||"",cidade:r?.cidade||"",uf:r?.uf||"",cidade_ibge:r?.cidade_ibge||"",limite_credito:r?.limite_credito??"",tipo_recebimento:r?.tipo_recebimento||"",regime_tributario:r?.regime_tributario||"",tipo_contribuinte:r?.tipo_contribuinte||"",aniversario:r?.aniversario?String(r.aniversario).slice(0,10):"",sexo:r?.sexo||"",estado_civil:r?.estado_civil||"",nome_mae:r?.nome_mae||"",nome_pai:r?.nome_pai||"",observacoes:r?.observacoes||"",status:r?.status||"active"})},[r]),p.useEffect(()=>{e?c(s(r||null)):r||c(s(null))},[e,!!r]);const h=S=>{const{id:I,value:T}=S.target;c(D=>({...D,[I]:T}))},v=S=>S===""?null:S,g=S=>{if(S==null)return null;if(typeof S=="number")return S;const I=String(S).trim();if(!I)return null;const T=I.replace(/\s+/g,"").replace(/\.(?=\d{3}(?:\D|$))/g,"").replace(/,/g,"."),D=Number(T);return Number.isFinite(D)?D:null},y=p.useMemo(()=>({digits:S=>(S||"").replace(/\D+/g,"")}),[]),x=S=>y.digits(S).slice(0,11).replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})$/,"$1-$2"),b=S=>y.digits(S).slice(0,14).replace(/(\d{2})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1/$2").replace(/(\d{4})(\d{1,2})$/,"$1-$2"),w=S=>y.digits(S).slice(0,8).replace(/(\d{5})(\d)/,"$1-$2"),j=S=>{const I=y.digits(S).slice(0,11);return I.length<=10?I.replace(/(\d{2})(\d{4})(\d{0,4})/,"($1) $2-$3").trim():I.replace(/(\d{2})(\d{5})(\d{0,4})/,"($1) $2-$3").trim()},_=S=>String(S||"").replace(/[^a-z]/gi,"").toUpperCase().slice(0,2),C=(S,I=6)=>y.digits(S).slice(0,I),E=S=>{const I=y.digits(S);return I?(Number(I)/100).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""},P=(S,I)=>{let T=I;S==="cpf"&&(T=x(I)),S==="cnpj"&&(T=b(I)),S==="cep"&&(T=w(I)),["telefone","fone2","celular1","celular2","whatsapp"].includes(S)&&(T=j(I)),S==="uf"&&(T=_(I)),S==="numero"&&(T=C(I,8)),S==="cidade_ibge"&&(T=C(I,7)),S==="limite_credito"&&(T=E(I)),c(D=>({...D,[S]:T}))},k=async()=>{const S=y.digits(l.cep);if(!S||S.length!==8){a({title:"CEP invlido",description:"Informe 8 dgitos.",variant:"destructive"});return}try{m(!0),c(D=>({...D,endereco:"Buscando...",bairro:"Buscando...",cidade:"Buscando...",uf:""}));const T=await(await fetch(`https://viacep.com.br/ws/${S}/json/`)).json();if(T.erro)throw new Error("CEP no encontrado");c(D=>({...D,endereco:T.logradouro||"",bairro:T.bairro||"",cidade:T.localidade||"",uf:T.uf||"",cidade_ibge:T.ibge||""})),a({title:"CEP encontrado!",description:"Endereo preenchido automaticamente.",variant:"success"})}catch(I){c(T=>({...T,endereco:"",bairro:"",cidade:"",uf:""})),a({title:"Falha ao buscar CEP",description:I.message||"Tente novamente.",variant:"destructive"})}finally{m(!1)}},M=async S=>{S?.preventDefault?.(),window.__protectPaymentModal&&window.__protectPaymentModal(5e3);try{if(!l.nome||l.nome.trim().length<2)throw new Error("Informe o nome/razo social do cliente.");const I={tipo_pessoa:v(l.tipo_pessoa),nome:l.nome,apelido:v(l.apelido),cpf:v(l.cpf),cnpj:v(l.cnpj),rg:v(l.rg),ie:v(l.ie),email:v(l.email),telefone:v(l.telefone),fone2:v(l.fone2),celular1:v(l.celular1),celular2:v(l.celular2),whatsapp:v(l.whatsapp),cep:v(l.cep),endereco:v(l.endereco),numero:v(l.numero),complemento:v(l.complemento),bairro:v(l.bairro),cidade:v(l.cidade),uf:v(l.uf),cidade_ibge:v(l.cidade_ibge),limite_credito:g(l.limite_credito),tipo_recebimento:v(l.tipo_recebimento),regime_tributario:v(l.regime_tributario),tipo_contribuinte:v(l.tipo_contribuinte),aniversario:v(l.aniversario),sexo:v(l.sexo),estado_civil:v(l.estado_civil),nome_mae:v(l.nome_mae),nome_pai:v(l.nome_pai),observacoes:v(l.observacoes),flag_cliente:l.tipo_cadastro==="cliente"||l.tipo_cadastro==="ambos",flag_fornecedor:l.tipo_cadastro==="fornecedor"||l.tipo_cadastro==="ambos",flag_funcionario:!1,flag_administradora:!1,flag_parceiro:!1,flag_ccf_spc:!1,status:l.status};let T,D=null;if(r?.id){const{data:B,error:U}=await ve.from("clientes").update(I).eq("id",r.id).select().single();T=U,D=B??null}else{const B=i?.codigo_empresa||null;if(!B)throw new Error("No foi possvel identificar a empresa do usurio (codigo_empresa). Tente recarregar a pgina ou entrar novamente.");const U={...I,codigo_empresa:B},{data:z,error:$}=await ve.from("clientes").insert(U).select().single();T=$,D=z??null}if(T)throw T;a({title:"Cliente salvo!",description:"As informaes do cliente foram atualizadas.",variant:"success"}),n?.(D),setTimeout(()=>{t?.(!1)},50)}catch(I){const T=(I?.message||"").toLowerCase(),D=I?.code||"";let B="Erro ao salvar cliente",U=I.message;D==="23505"||T.includes("duplicate key")&&T.includes("uq_clientes_empresa_codigo")?(B="Cdigo j cadastrado",U="J existe um cliente com este cdigo na sua empresa. Deixe o campo cdigo em branco para gerar automaticamente ou escolha outro nmero."):T.includes("column")&&T.includes("does not exist")&&(U="Seu banco pode no estar migrado para os novos campos. Atualize o schema conforme estrutura_bd."),a({title:B,description:U,variant:"destructive"})}};return o.jsx(ln,{open:e,onOpenChange:t,children:o.jsxs(on,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto w-full",children:[o.jsxs(nn,{children:[o.jsx(rn,{children:r?"Editar Cliente":"Novo Cliente"}),o.jsx(_n,{children:"Preencha os dados cadastrais do cliente."})]}),o.jsx("form",{onSubmit:M,className:"grid gap-4 sm:gap-6 py-2",children:o.jsxs(Fd,{value:d,onValueChange:u,className:"w-full",children:[o.jsx("div",{className:"sm:hidden mb-4",children:o.jsxs(En,{value:d,onValueChange:u,children:[o.jsx(Sn,{className:"w-full",children:o.jsx(kn,{})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"basicos",children:"Dados Bsicos"}),o.jsx(wt,{value:"endereco",children:"Endereo"}),o.jsx(wt,{value:"financeiro",children:"Financeiro"}),o.jsx(wt,{value:"adicionais",children:"Adicionais"})]})]})}),o.jsxs(ad,{className:"hidden sm:grid grid-cols-4 gap-2",children:[o.jsx(wa,{value:"basicos",children:"Dados Bsicos"}),o.jsx(wa,{value:"endereco",children:"Endereo"}),o.jsx(wa,{value:"financeiro",children:"Financeiro"}),o.jsx(wa,{value:"adicionais",children:"Adicionais"})]}),o.jsx(Wi,{value:"basicos",className:"space-y-3 sm:space-y-4 mt-2",children:o.jsxs("div",{className:"grid grid-cols-12 gap-3 sm:gap-4",children:[o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Wt,{children:"Tipo de Pessoa"}),o.jsxs(En,{value:l.tipo_pessoa,onValueChange:S=>c(I=>({...I,tipo_pessoa:S})),children:[o.jsx(Sn,{children:o.jsx(kn,{placeholder:"Pessoa"})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"PF",children:"Fsica"}),o.jsx(wt,{value:"PJ",children:"Jurdica"})]})]})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Wt,{children:"Tipo de Cadastro *"}),o.jsxs(En,{value:l.tipo_cadastro,onValueChange:S=>c(I=>({...I,tipo_cadastro:S})),required:!0,children:[o.jsx(Sn,{children:o.jsx(kn,{placeholder:"Selecione"})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"cliente",children:"Cliente"}),o.jsx(wt,{value:"fornecedor",children:"Fornecedor"}),o.jsx(wt,{value:"ambos",children:"Cliente e Fornecedor"})]})]})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[o.jsx(Wt,{htmlFor:"nome",children:l.tipo_pessoa==="PJ"?"Razo Social":"Nome"}),o.jsx(or,{id:"nome",value:l.nome,onChange:h,required:!0})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[o.jsx(Wt,{htmlFor:"apelido",children:l.tipo_pessoa==="PJ"?"Nome Fantasia":"Apelido"}),o.jsx(or,{id:"apelido",value:l.apelido,onChange:h})]}),l.tipo_pessoa==="PF"?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Wt,{htmlFor:"cpf",children:"CPF"}),o.jsx(or,{id:"cpf",value:l.cpf,onChange:S=>P("cpf",S.target.value),placeholder:"000.000.000-00"})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Wt,{htmlFor:"rg",children:"RG"}),o.jsx(or,{id:"rg",value:l.rg,onChange:h})]})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Wt,{htmlFor:"cnpj",children:"CNPJ"}),o.jsx(or,{id:"cnpj",value:l.cnpj,onChange:S=>P("cnpj",S.target.value),placeholder:"00.000.000/0000-00"})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Wt,{htmlFor:"ie",children:"Inscrio Estadual (IE)"}),o.jsx(or,{id:"ie",value:l.ie,onChange:h})]})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[o.jsx(Wt,{htmlFor:"email",children:"Email"}),o.jsx(or,{id:"email",type:"email",value:l.email,onChange:h})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Wt,{htmlFor:"telefone",children:"Telefone"}),o.jsx(or,{id:"telefone",value:l.telefone,onChange:S=>P("telefone",S.target.value)})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Wt,{htmlFor:"celular1",children:"Celular"}),o.jsx(or,{id:"celular1",value:l.celular1,onChange:S=>P("celular1",S.target.value)})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Wt,{htmlFor:"whatsapp",children:"WhatsApp"}),o.jsx(or,{id:"whatsapp",value:l.whatsapp,onChange:S=>P("whatsapp",S.target.value),placeholder:"(DDD) 9...."})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Wt,{htmlFor:"fone2",children:"Fone 2"}),o.jsx(or,{id:"fone2",value:l.fone2,onChange:S=>P("fone2",S.target.value)})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Wt,{htmlFor:"celular2",children:"Celular 2"}),o.jsx(or,{id:"celular2",value:l.celular2,onChange:S=>P("celular2",S.target.value)})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Wt,{htmlFor:"aniversario",children:"Nascimento"}),o.jsx(or,{id:"aniversario",type:"date",value:l.aniversario||"",onChange:h})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Wt,{children:"Status"}),o.jsxs(En,{value:l.status,onValueChange:S=>c(I=>({...I,status:S})),children:[o.jsx(Sn,{children:o.jsx(kn,{placeholder:"Status"})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"active",children:"Ativo"}),o.jsx(wt,{value:"inactive",children:"Inativo"})]})]})]})]})}),o.jsx(Wi,{value:"endereco",className:"space-y-3 sm:space-y-4 mt-2",children:o.jsxs("div",{className:"grid grid-cols-12 gap-3 sm:gap-4",children:[o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Wt,{htmlFor:"cep",children:"CEP"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(or,{id:"cep",value:l.cep,onChange:S=>P("cep",S.target.value),placeholder:"00000-000"}),o.jsx(oe,{type:"button",variant:"outline",onClick:k,disabled:f,children:f?"Buscando...":"Buscar"})]})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-6",children:[o.jsx(Wt,{htmlFor:"endereco",children:"Endereo"}),o.jsx(or,{id:"endereco",value:l.endereco,onChange:h})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Wt,{htmlFor:"numero",children:"Nmero"}),o.jsx(or,{id:"numero",value:l.numero,onChange:S=>P("numero",S.target.value)})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[o.jsx(Wt,{htmlFor:"complemento",children:"Complemento"}),o.jsx(or,{id:"complemento",value:l.complemento,onChange:h})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[o.jsx(Wt,{htmlFor:"bairro",children:"Bairro"}),o.jsx(or,{id:"bairro",value:l.bairro,onChange:h})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Wt,{htmlFor:"cidade",children:"Cidade"}),o.jsx(or,{id:"cidade",value:l.cidade,onChange:h})]}),o.jsxs("div",{className:"col-span-6 sm:col-span-1",children:[o.jsx(Wt,{htmlFor:"uf",children:"UF"}),o.jsx(or,{id:"uf",value:l.uf,onChange:S=>P("uf",S.target.value),placeholder:"UF"})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Wt,{htmlFor:"cidade_ibge",children:"Cd. IBGE"}),o.jsx(or,{id:"cidade_ibge",value:l.cidade_ibge,onChange:S=>P("cidade_ibge",S.target.value)})]})]})}),o.jsx(Wi,{value:"financeiro",className:"space-y-3 sm:space-y-4 mt-2",children:o.jsxs("div",{className:"grid grid-cols-12 gap-3 sm:gap-4",children:[o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Wt,{htmlFor:"limite_credito",children:"Limite de Crdito"}),o.jsxs("div",{className:"relative",children:[o.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-secondary text-sm",children:"R$"}),o.jsx(or,{id:"limite_credito",value:l.limite_credito,onChange:S=>P("limite_credito",S.target.value),placeholder:"0,00",className:"pl-10"})]})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Wt,{children:"Tipo de Recebimento"}),o.jsxs(En,{value:l.tipo_recebimento||"",onValueChange:S=>c(I=>({...I,tipo_recebimento:S})),children:[o.jsx(Sn,{children:o.jsx(kn,{placeholder:"Selecione"})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"avista",children:" vista"}),o.jsx(wt,{value:"aprazo",children:"A prazo"}),o.jsx(wt,{value:"misto",children:"Misto"})]})]})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Wt,{children:"Regime Tributrio"}),o.jsxs(En,{value:l.regime_tributario||"",onValueChange:S=>c(I=>({...I,regime_tributario:S})),children:[o.jsx(Sn,{children:o.jsx(kn,{placeholder:"Selecione"})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"simples",children:"Simples"}),o.jsx(wt,{value:"lucro_presumido",children:"Lucro Presumido"}),o.jsx(wt,{value:"lucro_real",children:"Lucro Real"})]})]})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-3",children:[o.jsx(Wt,{children:"Tipo de Contribuinte"}),o.jsxs(En,{value:l.tipo_contribuinte||"",onValueChange:S=>c(I=>({...I,tipo_contribuinte:S})),children:[o.jsx(Sn,{children:o.jsx(kn,{placeholder:"Selecione"})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"nao_contribuinte",children:"No Contribuinte"}),o.jsx(wt,{value:"contribuinte",children:"Contribuinte"}),o.jsx(wt,{value:"isento",children:"Isento"})]})]})]})]})}),o.jsx(Wi,{value:"adicionais",className:"space-y-3 sm:space-y-4 mt-2",children:o.jsxs("div",{className:"grid grid-cols-12 gap-3 sm:gap-4",children:[o.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[o.jsx(Wt,{htmlFor:"sexo",children:"Sexo"}),o.jsxs(En,{value:l.sexo||"",onValueChange:S=>c(I=>({...I,sexo:S})),children:[o.jsx(Sn,{children:o.jsx(kn,{placeholder:"Selecione"})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"m",children:"Masculino"}),o.jsx(wt,{value:"f",children:"Feminino"}),o.jsx(wt,{value:"o",children:"Outro"})]})]})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[o.jsx(Wt,{htmlFor:"estado_civil",children:"Estado Civil"}),o.jsxs(En,{value:l.estado_civil||"",onValueChange:S=>c(I=>({...I,estado_civil:S})),children:[o.jsx(Sn,{children:o.jsx(kn,{placeholder:"Selecione"})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"solteiro",children:"Solteiro(a)"}),o.jsx(wt,{value:"casado",children:"Casado(a)"}),o.jsx(wt,{value:"divorciado",children:"Divorciado(a)"}),o.jsx(wt,{value:"viuvo",children:"Vivo(a)"})]})]})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[o.jsx(Wt,{htmlFor:"nome_mae",children:"Nome da Me"}),o.jsx(or,{id:"nome_mae",value:l.nome_mae,onChange:h})]}),o.jsxs("div",{className:"col-span-12 sm:col-span-4",children:[o.jsx(Wt,{htmlFor:"nome_pai",children:"Nome do Pai"}),o.jsx(or,{id:"nome_pai",value:l.nome_pai,onChange:h})]}),o.jsxs("div",{className:"col-span-12",children:[o.jsx(Wt,{htmlFor:"observacoes",children:"Observaes"}),o.jsx("textarea",{id:"observacoes",value:l.observacoes,onChange:h,rows:4,className:"w-full rounded-md border border-border bg-background p-2 text-sm"})]})]})})]})}),o.jsxs(Un,{className:"flex flex-col sm:flex-row gap-2 sm:gap-0",children:[o.jsx(Hm,{asChild:!0,children:o.jsx(oe,{type:"button",variant:"secondary",className:"w-full sm:w-auto",children:"Cancelar"})}),o.jsx(oe,{type:"submit",onClick:M,className:"w-full sm:w-auto",children:"Salvar Cliente"})]})]})})}function hGe(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const r=document.implementation.createHTMLDocument(),n=r.createElement("base"),a=r.createElement("a");return r.head.appendChild(n),r.body.appendChild(a),t&&(n.href=t),a.href=e,a.href}const pGe=(()=>{let e=0;const t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function Xm(e){const t=[];for(let r=0,n=e.length;r<n;r++)t.push(e[r]);return t}let qg=null;function are(e={}){return qg||(e.includeStyleProperties?(qg=e.includeStyleProperties,qg):(qg=Xm(window.getComputedStyle(document.documentElement)),qg))}function R_(e,t){const n=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t);return n?parseFloat(n.replace("px","")):0}function gGe(e){const t=R_(e,"border-left-width"),r=R_(e,"border-right-width");return e.clientWidth+t+r}function vGe(e){const t=R_(e,"border-top-width"),r=R_(e,"border-bottom-width");return e.clientHeight+t+r}function ore(e,t={}){const r=t.width||gGe(e),n=t.height||vGe(e);return{width:r,height:n}}function xGe(){let e,t;try{t=process}catch{}const r=t&&t.env?t.env.devicePixelRatio:null;return r&&(e=parseInt(r,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const Xl=16384;function yGe(e){(e.width>Xl||e.height>Xl)&&(e.width>Xl&&e.height>Xl?e.width>e.height?(e.height*=Xl/e.width,e.width=Xl):(e.width*=Xl/e.height,e.height=Xl):e.width>Xl?(e.height*=Xl/e.width,e.width=Xl):(e.width*=Xl/e.height,e.height=Xl))}function L_(e){return new Promise((t,r)=>{const n=new Image;n.onload=()=>{n.decode().then(()=>{requestAnimationFrame(()=>t(n))})},n.onerror=r,n.crossOrigin="anonymous",n.decoding="async",n.src=e})}async function bGe(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(t=>`data:image/svg+xml;charset=utf-8,${t}`)}async function wGe(e,t,r){const n="http://www.w3.org/2000/svg",a=document.createElementNS(n,"svg"),i=document.createElementNS(n,"foreignObject");return a.setAttribute("width",`${t}`),a.setAttribute("height",`${r}`),a.setAttribute("viewBox",`0 0 ${t} ${r}`),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("x","0"),i.setAttribute("y","0"),i.setAttribute("externalResourcesRequired","true"),a.appendChild(i),i.appendChild(e),bGe(a)}const Ll=(e,t)=>{if(e instanceof t)return!0;const r=Object.getPrototypeOf(e);return r===null?!1:r.constructor.name===t.name||Ll(r,t)};function jGe(e){const t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}function NGe(e,t){return are(t).map(r=>{const n=e.getPropertyValue(r),a=e.getPropertyPriority(r);return`${r}: ${n}${a?" !important":""};`}).join(" ")}function _Ge(e,t,r,n){const a=`.${e}:${t}`,i=r.cssText?jGe(r):NGe(r,n);return document.createTextNode(`${a}{${i}}`)}function Mq(e,t,r,n){const a=window.getComputedStyle(e,r),i=a.getPropertyValue("content");if(i===""||i==="none")return;const s=pGe();try{t.className=`${t.className} ${s}`}catch{return}const l=document.createElement("style");l.appendChild(_Ge(s,r,a,n)),t.appendChild(l)}function SGe(e,t,r){Mq(e,t,":before",r),Mq(e,t,":after",r)}const Rq="application/font-woff",Lq="image/jpeg",CGe={woff:Rq,woff2:Rq,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Lq,jpeg:Lq,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function PGe(e){const t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}function fM(e){const t=PGe(e).toLowerCase();return CGe[t]||""}function AGe(e){return e.split(/,/)[1]}function Y3(e){return e.search(/^(data:)/)!==-1}function ire(e,t){return`data:${t};base64,${e}`}async function sre(e,t,r){const n=await fetch(e,t);if(n.status===404)throw new Error(`Resource "${n.url}" not found`);const a=await n.blob();return new Promise((i,s)=>{const l=new FileReader;l.onerror=s,l.onloadend=()=>{try{i(r({res:n,result:l.result}))}catch(c){s(c)}},l.readAsDataURL(a)})}const kA={};function EGe(e,t,r){let n=e.replace(/\?.*/,"");return r&&(n=e),/ttf|otf|eot|woff2?/i.test(n)&&(n=n.replace(/.*\//,"")),t?`[${t}]${n}`:n}async function mM(e,t,r){const n=EGe(e,t,r.includeQueryParams);if(kA[n]!=null)return kA[n];r.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let a;try{const i=await sre(e,r.fetchRequestInit,({res:s,result:l})=>(t||(t=s.headers.get("Content-Type")||""),AGe(l)));a=ire(i,t)}catch(i){a=r.imagePlaceholder||"";let s=`Failed to fetch resource: ${e}`;i&&(s=typeof i=="string"?i:i.message),s&&console.warn(s)}return kA[n]=a,a}async function kGe(e){const t=e.toDataURL();return t==="data:,"?e.cloneNode(!1):L_(t)}async function OGe(e,t){if(e.currentSrc){const i=document.createElement("canvas"),s=i.getContext("2d");i.width=e.clientWidth,i.height=e.clientHeight,s?.drawImage(e,0,0,i.width,i.height);const l=i.toDataURL();return L_(l)}const r=e.poster,n=fM(r),a=await mM(r,n,t);return L_(a)}async function IGe(e,t){var r;try{if(!((r=e?.contentDocument)===null||r===void 0)&&r.body)return await t5(e.contentDocument.body,t,!0)}catch{}return e.cloneNode(!1)}async function TGe(e,t){return Ll(e,HTMLCanvasElement)?kGe(e):Ll(e,HTMLVideoElement)?OGe(e,t):Ll(e,HTMLIFrameElement)?IGe(e,t):e.cloneNode(lre(e))}const DGe=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT",lre=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SVG";async function MGe(e,t,r){var n,a;if(lre(t))return t;let i=[];return DGe(e)&&e.assignedNodes?i=Xm(e.assignedNodes()):Ll(e,HTMLIFrameElement)&&(!((n=e.contentDocument)===null||n===void 0)&&n.body)?i=Xm(e.contentDocument.body.childNodes):i=Xm(((a=e.shadowRoot)!==null&&a!==void 0?a:e).childNodes),i.length===0||Ll(e,HTMLVideoElement)||await i.reduce((s,l)=>s.then(()=>t5(l,r)).then(c=>{c&&t.appendChild(c)}),Promise.resolve()),t}function RGe(e,t,r){const n=t.style;if(!n)return;const a=window.getComputedStyle(e);a.cssText?(n.cssText=a.cssText,n.transformOrigin=a.transformOrigin):are(r).forEach(i=>{let s=a.getPropertyValue(i);i==="font-size"&&s.endsWith("px")&&(s=`${Math.floor(parseFloat(s.substring(0,s.length-2)))-.1}px`),Ll(e,HTMLIFrameElement)&&i==="display"&&s==="inline"&&(s="block"),i==="d"&&t.getAttribute("d")&&(s=`path(${t.getAttribute("d")})`),n.setProperty(i,s,a.getPropertyPriority(i))})}function LGe(e,t){Ll(e,HTMLTextAreaElement)&&(t.innerHTML=e.value),Ll(e,HTMLInputElement)&&t.setAttribute("value",e.value)}function $Ge(e,t){if(Ll(e,HTMLSelectElement)){const r=t,n=Array.from(r.children).find(a=>e.value===a.getAttribute("value"));n&&n.setAttribute("selected","")}}function FGe(e,t,r){return Ll(t,Element)&&(RGe(e,t,r),SGe(e,t,r),LGe(e,t),$Ge(e,t)),t}async function BGe(e,t){const r=e.querySelectorAll?e.querySelectorAll("use"):[];if(r.length===0)return e;const n={};for(let i=0;i<r.length;i++){const l=r[i].getAttribute("xlink:href");if(l){const c=e.querySelector(l),d=document.querySelector(l);!c&&d&&!n[l]&&(n[l]=await t5(d,t,!0))}}const a=Object.values(n);if(a.length){const i="http://www.w3.org/1999/xhtml",s=document.createElementNS(i,"svg");s.setAttribute("xmlns",i),s.style.position="absolute",s.style.width="0",s.style.height="0",s.style.overflow="hidden",s.style.display="none";const l=document.createElementNS(i,"defs");s.appendChild(l);for(let c=0;c<a.length;c++)l.appendChild(a[c]);e.appendChild(s)}return e}async function t5(e,t,r){return!r&&t.filter&&!t.filter(e)?null:Promise.resolve(e).then(n=>TGe(n,t)).then(n=>MGe(e,n,t)).then(n=>FGe(e,n,t)).then(n=>BGe(n,t))}const cre=/url\((['"]?)([^'"]+?)\1\)/g,qGe=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,zGe=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function UGe(e){const t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}function VGe(e){const t=[];return e.replace(cre,(r,n,a)=>(t.push(a),r)),t.filter(r=>!Y3(r))}async function WGe(e,t,r,n,a){try{const i=r?hGe(t,r):t,s=fM(t);let l;if(a){const c=await a(i);l=ire(c,s)}else l=await mM(i,s,n);return e.replace(UGe(t),`$1${l}$3`)}catch{}return e}function HGe(e,{preferredFontFormat:t}){return t?e.replace(zGe,r=>{for(;;){const[n,,a]=qGe.exec(r)||[];if(!a)return"";if(a===t)return`src: ${n};`}}):e}function dre(e){return e.search(cre)!==-1}async function ure(e,t,r){if(!dre(e))return e;const n=HGe(e,r);return VGe(n).reduce((i,s)=>i.then(l=>WGe(l,s,t,r)),Promise.resolve(n))}async function zg(e,t,r){var n;const a=(n=t.style)===null||n===void 0?void 0:n.getPropertyValue(e);if(a){const i=await ure(a,null,r);return t.style.setProperty(e,i,t.style.getPropertyPriority(e)),!0}return!1}async function GGe(e,t){await zg("background",e,t)||await zg("background-image",e,t),await zg("mask",e,t)||await zg("-webkit-mask",e,t)||await zg("mask-image",e,t)||await zg("-webkit-mask-image",e,t)}async function KGe(e,t){const r=Ll(e,HTMLImageElement);if(!(r&&!Y3(e.src))&&!(Ll(e,SVGImageElement)&&!Y3(e.href.baseVal)))return;const n=r?e.src:e.href.baseVal,a=await mM(n,fM(n),t);await new Promise((i,s)=>{e.onload=i,e.onerror=t.onImageErrorHandler?(...c)=>{try{i(t.onImageErrorHandler(...c))}catch(d){s(d)}}:s;const l=e;l.decode&&(l.decode=i),l.loading==="lazy"&&(l.loading="eager"),r?(e.srcset="",e.src=a):e.href.baseVal=a})}async function YGe(e,t){const n=Xm(e.childNodes).map(a=>fre(a,t));await Promise.all(n).then(()=>e)}async function fre(e,t){Ll(e,Element)&&(await GGe(e,t),await KGe(e,t),await YGe(e,t))}function XGe(e,t){const{style:r}=e;t.backgroundColor&&(r.backgroundColor=t.backgroundColor),t.width&&(r.width=`${t.width}px`),t.height&&(r.height=`${t.height}px`);const n=t.style;return n!=null&&Object.keys(n).forEach(a=>{r[a]=n[a]}),e}const $q={};async function Fq(e){let t=$q[e];if(t!=null)return t;const n=await(await fetch(e)).text();return t={url:e,cssText:n},$q[e]=t,t}async function Bq(e,t){let r=e.cssText;const n=/url\(["']?([^"')]+)["']?\)/g,i=(r.match(/url\([^)]+\)/g)||[]).map(async s=>{let l=s.replace(n,"$1");return l.startsWith("https://")||(l=new URL(l,e.url).href),sre(l,t.fetchRequestInit,({result:c})=>(r=r.replace(s,`url(${c})`),[s,c]))});return Promise.all(i).then(()=>r)}function qq(e){if(e==null)return[];const t=[],r=/(\/\*[\s\S]*?\*\/)/gi;let n=e.replace(r,"");const a=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const c=a.exec(n);if(c===null)break;t.push(c[0])}n=n.replace(a,"");const i=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,s="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",l=new RegExp(s,"gi");for(;;){let c=i.exec(n);if(c===null){if(c=l.exec(n),c===null)break;i.lastIndex=l.lastIndex}else l.lastIndex=i.lastIndex;t.push(c[0])}return t}async function JGe(e,t){const r=[],n=[];return e.forEach(a=>{if("cssRules"in a)try{Xm(a.cssRules||[]).forEach((i,s)=>{if(i.type===CSSRule.IMPORT_RULE){let l=s+1;const c=i.href,d=Fq(c).then(u=>Bq(u,t)).then(u=>qq(u).forEach(f=>{try{a.insertRule(f,f.startsWith("@import")?l+=1:a.cssRules.length)}catch(m){console.error("Error inserting rule from remote css",{rule:f,error:m})}})).catch(u=>{console.error("Error loading remote css",u.toString())});n.push(d)}})}catch(i){const s=e.find(l=>l.href==null)||document.styleSheets[0];a.href!=null&&n.push(Fq(a.href).then(l=>Bq(l,t)).then(l=>qq(l).forEach(c=>{s.insertRule(c,s.cssRules.length)})).catch(l=>{console.error("Error loading remote stylesheet",l)})),console.error("Error inlining remote css file",i)}}),Promise.all(n).then(()=>(e.forEach(a=>{if("cssRules"in a)try{Xm(a.cssRules||[]).forEach(i=>{r.push(i)})}catch(i){console.error(`Error while reading CSS rules from ${a.href}`,i)}}),r))}function QGe(e){return e.filter(t=>t.type===CSSRule.FONT_FACE_RULE).filter(t=>dre(t.style.getPropertyValue("src")))}async function ZGe(e,t){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const r=Xm(e.ownerDocument.styleSheets),n=await JGe(r,t);return QGe(n)}function mre(e){return e.trim().replace(/["']/g,"")}function eKe(e){const t=new Set;function r(n){(n.style.fontFamily||getComputedStyle(n).fontFamily).split(",").forEach(i=>{t.add(mre(i))}),Array.from(n.children).forEach(i=>{i instanceof HTMLElement&&r(i)})}return r(e),t}async function tKe(e,t){const r=await ZGe(e,t),n=eKe(e);return(await Promise.all(r.filter(i=>n.has(mre(i.style.fontFamily))).map(i=>{const s=i.parentStyleSheet?i.parentStyleSheet.href:null;return ure(i.cssText,s,t)}))).join(`
`)}async function rKe(e,t){const r=t.fontEmbedCSS!=null?t.fontEmbedCSS:t.skipFonts?null:await tKe(e,t);if(r){const n=document.createElement("style"),a=document.createTextNode(r);n.appendChild(a),e.firstChild?e.insertBefore(n,e.firstChild):e.appendChild(n)}}async function nKe(e,t={}){const{width:r,height:n}=ore(e,t),a=await t5(e,t,!0);return await rKe(a,t),await fre(a,t),XGe(a,t),await wGe(a,r,n)}async function aKe(e,t={}){const{width:r,height:n}=ore(e,t),a=await nKe(e,t),i=await L_(a),s=document.createElement("canvas"),l=s.getContext("2d"),c=t.pixelRatio||xGe(),d=t.canvasWidth||r,u=t.canvasHeight||n;return s.width=d*c,s.height=u*c,t.skipAutoScale||yGe(s),s.style.width=`${d}`,s.style.height=`${u}`,t.backgroundColor&&(l.fillStyle=t.backgroundColor,l.fillRect(0,0,s.width,s.height)),l.drawImage(i,0,0,s.width,s.height),s}async function oKe(e,t={}){return(await aKe(e,t)).toDataURL()}var eu=Uint8Array,dc=Uint16Array,hM=Int32Array,pM=new eu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),gM=new eu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),zq=new eu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),hre=function(e,t){for(var r=new dc(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var a=new hM(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)a[i]=i-r[n]<<5|n;return{b:r,r:a}},pre=hre(pM,2),iKe=pre.b,X3=pre.r;iKe[28]=258,X3[258]=28;var sKe=hre(gM,0),Uq=sKe.r,J3=new dc(32768);for(var Io=0;Io<32768;++Io){var nm=(Io&43690)>>1|(Io&21845)<<1;nm=(nm&52428)>>2|(nm&13107)<<2,nm=(nm&61680)>>4|(nm&3855)<<4,J3[Io]=((nm&65280)>>8|(nm&255)<<8)>>1}var Wy=function(e,t,r){for(var n=e.length,a=0,i=new dc(t);a<n;++a)e[a]&&++i[e[a]-1];var s=new dc(t);for(a=1;a<t;++a)s[a]=s[a-1]+i[a-1]<<1;var l;if(r){l=new dc(1<<t);var c=15-t;for(a=0;a<n;++a)if(e[a])for(var d=a<<4|e[a],u=t-e[a],f=s[e[a]-1]++<<u,m=f|(1<<u)-1;f<=m;++f)l[J3[f]>>c]=d}else for(l=new dc(n),a=0;a<n;++a)e[a]&&(l[a]=J3[s[e[a]-1]++]>>15-e[a]);return l},ng=new eu(288);for(var Io=0;Io<144;++Io)ng[Io]=8;for(var Io=144;Io<256;++Io)ng[Io]=9;for(var Io=256;Io<280;++Io)ng[Io]=7;for(var Io=280;Io<288;++Io)ng[Io]=8;var $_=new eu(32);for(var Io=0;Io<32;++Io)$_[Io]=5;var lKe=Wy(ng,9,0),cKe=Wy($_,5,0),gre=function(e){return(e+7)/8|0},dKe=function(e,t,r){return(t==null||t<0)&&(t=0),(r==null||r>e.length)&&(r=e.length),new eu(e.subarray(t,r))},ef=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},J0=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},OA=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var a=r.length,i=r.slice();if(!a)return{t:xre,l:0};if(a==1){var s=new eu(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(_,C){return _.f-C.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],d=0,u=1,f=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};u!=a-1;)l=r[r[d].f<r[f].f?d++:f++],c=r[d!=u&&r[d].f<r[f].f?d++:f++],r[u++]={s:-1,f:l.f+c.f,l,r:c};for(var m=i[0].s,n=1;n<a;++n)i[n].s>m&&(m=i[n].s);var h=new dc(m+1),v=Q3(r[u-1],h,0);if(v>t){var n=0,g=0,y=v-t,x=1<<y;for(i.sort(function(C,E){return h[E.s]-h[C.s]||C.f-E.f});n<a;++n){var b=i[n].s;if(h[b]>t)g+=x-(1<<v-h[b]),h[b]=t;else break}for(g>>=y;g>0;){var w=i[n].s;h[w]<t?g-=1<<t-h[w]++-1:++n}for(;n>=0&&g;--n){var j=i[n].s;h[j]==t&&(--h[j],++g)}v=t}return{t:new eu(h),l:v}},Q3=function(e,t,r){return e.s==-1?Math.max(Q3(e.l,t,r+1),Q3(e.r,t,r+1)):t[e.s]=r},Vq=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new dc(++t),n=0,a=e[0],i=1,s=function(c){r[n++]=c},l=1;l<=t;++l)if(e[l]==a&&l!=t)++i;else{if(!a&&i>2){for(;i>138;i-=138)s(32754);i>2&&(s(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(s(a),--i;i>6;i-=6)s(8304);i>2&&(s(i-3<<5|8208),i=0)}for(;i--;)s(a);i=1,a=e[l]}return{c:r.subarray(0,n),n:t}},Q0=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},vre=function(e,t,r){var n=r.length,a=gre(t+2);e[a]=n&255,e[a+1]=n>>8,e[a+2]=e[a]^255,e[a+3]=e[a+1]^255;for(var i=0;i<n;++i)e[a+i+4]=r[i];return(a+4+n)*8},Wq=function(e,t,r,n,a,i,s,l,c,d,u){ef(t,u++,r),++a[256];for(var f=OA(a,15),m=f.t,h=f.l,v=OA(i,15),g=v.t,y=v.l,x=Vq(m),b=x.c,w=x.n,j=Vq(g),_=j.c,C=j.n,E=new dc(19),P=0;P<b.length;++P)++E[b[P]&31];for(var P=0;P<_.length;++P)++E[_[P]&31];for(var k=OA(E,7),M=k.t,S=k.l,I=19;I>4&&!M[zq[I-1]];--I);var T=d+5<<3,D=Q0(a,ng)+Q0(i,$_)+s,B=Q0(a,m)+Q0(i,g)+s+14+3*I+Q0(E,M)+2*E[16]+3*E[17]+7*E[18];if(c>=0&&T<=D&&T<=B)return vre(t,u,e.subarray(c,c+d));var U,z,$,Y;if(ef(t,u,1+(B<D)),u+=2,B<D){U=Wy(m,h,0),z=m,$=Wy(g,y,0),Y=g;var de=Wy(M,S,0);ef(t,u,w-257),ef(t,u+5,C-1),ef(t,u+10,I-4),u+=14;for(var P=0;P<I;++P)ef(t,u+3*P,M[zq[P]]);u+=3*I;for(var xe=[b,_],q=0;q<2;++q)for(var L=xe[q],P=0;P<L.length;++P){var W=L[P]&31;ef(t,u,de[W]),u+=M[W],W>15&&(ef(t,u,L[P]>>5&127),u+=L[P]>>12)}}else U=lKe,z=ng,$=cKe,Y=$_;for(var P=0;P<l;++P){var ne=n[P];if(ne>255){var W=ne>>18&31;J0(t,u,U[W+257]),u+=z[W+257],W>7&&(ef(t,u,ne>>23&31),u+=pM[W]);var le=ne&31;J0(t,u,$[le]),u+=Y[le],le>3&&(J0(t,u,ne>>5&8191),u+=gM[le])}else J0(t,u,U[ne]),u+=z[ne]}return J0(t,u,U[256]),u+z[256]},uKe=new hM([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),xre=new eu(0),fKe=function(e,t,r,n,a,i){var s=i.z||e.length,l=new eu(n+s+5*(1+Math.ceil(s/7e3))+a),c=l.subarray(n,l.length-a),d=i.l,u=(i.r||0)&7;if(t){u&&(c[0]=i.r>>3);for(var f=uKe[t-1],m=f>>13,h=f&8191,v=(1<<r)-1,g=i.p||new dc(32768),y=i.h||new dc(v+1),x=Math.ceil(r/3),b=2*x,w=function(Z){return(e[Z]^e[Z+1]<<x^e[Z+2]<<b)&v},j=new hM(25e3),_=new dc(288),C=new dc(32),E=0,P=0,k=i.i||0,M=0,S=i.w||0,I=0;k+2<s;++k){var T=w(k),D=k&32767,B=y[T];if(g[D]=B,y[T]=D,S<=k){var U=s-k;if((E>7e3||M>24576)&&(U>423||!d)){u=Wq(e,c,0,j,_,C,P,M,I,k-I,u),M=E=P=0,I=k;for(var z=0;z<286;++z)_[z]=0;for(var z=0;z<30;++z)C[z]=0}var $=2,Y=0,de=h,xe=D-B&32767;if(U>2&&T==w(k-xe))for(var q=Math.min(m,U)-1,L=Math.min(32767,k),W=Math.min(258,U);xe<=L&&--de&&D!=B;){if(e[k+$]==e[k+$-xe]){for(var ne=0;ne<W&&e[k+ne]==e[k+ne-xe];++ne);if(ne>$){if($=ne,Y=xe,ne>q)break;for(var le=Math.min(xe,ne-2),K=0,z=0;z<le;++z){var Q=k-xe+z&32767,re=g[Q],G=Q-re&32767;G>K&&(K=G,B=Q)}}}D=B,B=g[D],xe+=D-B&32767}if(Y){j[M++]=268435456|X3[$]<<18|Uq[Y];var me=X3[$]&31,pe=Uq[Y]&31;P+=pM[me]+gM[pe],++_[257+me],++C[pe],S=k+$,++E}else j[M++]=e[k],++_[e[k]]}}for(k=Math.max(k,S);k<s;++k)j[M++]=e[k],++_[e[k]];u=Wq(e,c,d,j,_,C,P,M,I,k-I,u),d||(i.r=u&7|c[u/8|0]<<3,u-=7,i.h=y,i.p=g,i.i=k,i.w=S)}else{for(var k=i.w||0;k<s+d;k+=65535){var Be=k+65535;Be>=s&&(c[u/8|0]=d,Be=s),u=vre(c,u+1,e.subarray(k,Be))}i.i=s}return dKe(l,0,n+gre(u)+a)},yre=function(){var e=1,t=0;return{p:function(r){for(var n=e,a=t,i=r.length|0,s=0;s!=i;){for(var l=Math.min(s+2655,i);s<l;++s)a+=n+=r[s];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}e=n,t=a},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},mKe=function(e,t,r,n,a){if(!a&&(a={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),s=new eu(i.length+e.length);s.set(i),s.set(e,i.length),e=s,a.w=i.length}return fKe(e,t.level==null?6:t.level,t.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,a)},bre=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},hKe=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var a=yre();a.p(t.dictionary),bre(e,2,a.d())}};function Z3(e,t){t||(t={});var r=yre();r.p(e);var n=mKe(e,t,t.dictionary?6:2,4);return hKe(n,t),bre(n,n.length-4,r.d()),n}var pKe=typeof TextDecoder<"u"&&new TextDecoder,gKe=0;try{pKe.decode(xre,{stream:!0}),gKe=1}catch{}function vKe(e){if(Array.isArray(e))return e}function xKe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw a}}return l}}function yKe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hq(e,t){return vKe(e)||xKe(e,t)||Cbe(e,t)||yKe()}function Gq(e,t="utf8"){return new TextDecoder(t).decode(e)}const bKe=new TextEncoder;function wKe(e){return bKe.encode(e)}const jKe=1024*8,NKe=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),IA={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class vM{constructor(t=jKe,r={}){ro(this,"buffer");ro(this,"byteLength");ro(this,"byteOffset");ro(this,"length");ro(this,"offset");ro(this,"lastWrittenByte");ro(this,"littleEndian");ro(this,"_data");ro(this,"_mark");ro(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const a=r.offset?r.offset>>>0:0,i=t.byteLength-a;let s=a;(ArrayBuffer.isView(t)||t instanceof vM)&&(t.byteLength!==t.buffer.byteLength&&(s=t.byteOffset+a),t=t.buffer),n?this.lastWrittenByte=i:this.lastWrittenByte=0,this.buffer=t,this.length=i,this.byteLength=i,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,i),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,a=new Uint8Array(n);a.set(new Uint8Array(this.buffer)),this.buffer=a.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=IA[r].BYTES_PER_ELEMENT*t,a=this.byteOffset+this.offset,i=this.buffer.slice(a,a+n);if(this.littleEndian===NKe&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(a,a+n));l.reverse();const c=new IA[r](l.buffer);return this.offset+=n,c.reverse(),c}const s=new IA[r](i);return this.offset+=n,s}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return Gq(this.readBytes(t))}decodeText(t=1,r="utf8"){return Gq(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(wKe(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const _Ke=4,Kq=0,Yq=1,SKe=2;function g0(e){let t=e.length;for(;--t>=0;)e[t]=0}const CKe=0,wre=1,PKe=2,AKe=3,EKe=258,xM=29,cw=256,v1=cw+1+xM,Hv=30,yM=19,jre=2*v1+1,yp=15,TA=16,kKe=7,bM=256,Nre=16,_re=17,Sre=18,e4=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Sj=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),OKe=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Cre=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),IKe=512,cf=new Array((v1+2)*2);g0(cf);const Hy=new Array(Hv*2);g0(Hy);const x1=new Array(IKe);g0(x1);const y1=new Array(EKe-AKe+1);g0(y1);const wM=new Array(xM);g0(wM);const F_=new Array(Hv);g0(F_);function DA(e,t,r,n,a){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=a,this.has_stree=e&&e.length}let Pre,Are,Ere;function MA(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const kre=e=>e<256?x1[e]:x1[256+(e>>>7)],b1=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},Ol=(e,t,r)=>{e.bi_valid>TA-r?(e.bi_buf|=t<<e.bi_valid&65535,b1(e,e.bi_buf),e.bi_buf=t>>TA-e.bi_valid,e.bi_valid+=r-TA):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},wu=(e,t,r)=>{Ol(e,r[t*2],r[t*2+1])},Ore=(e,t)=>{let r=0;do r|=e&1,e>>>=1,r<<=1;while(--t>0);return r>>>1},TKe=e=>{e.bi_valid===16?(b1(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},DKe=(e,t)=>{const r=t.dyn_tree,n=t.max_code,a=t.stat_desc.static_tree,i=t.stat_desc.has_stree,s=t.stat_desc.extra_bits,l=t.stat_desc.extra_base,c=t.stat_desc.max_length;let d,u,f,m,h,v,g=0;for(m=0;m<=yp;m++)e.bl_count[m]=0;for(r[e.heap[e.heap_max]*2+1]=0,d=e.heap_max+1;d<jre;d++)u=e.heap[d],m=r[r[u*2+1]*2+1]+1,m>c&&(m=c,g++),r[u*2+1]=m,!(u>n)&&(e.bl_count[m]++,h=0,u>=l&&(h=s[u-l]),v=r[u*2],e.opt_len+=v*(m+h),i&&(e.static_len+=v*(a[u*2+1]+h)));if(g!==0){do{for(m=c-1;e.bl_count[m]===0;)m--;e.bl_count[m]--,e.bl_count[m+1]+=2,e.bl_count[c]--,g-=2}while(g>0);for(m=c;m!==0;m--)for(u=e.bl_count[m];u!==0;)f=e.heap[--d],!(f>n)&&(r[f*2+1]!==m&&(e.opt_len+=(m-r[f*2+1])*r[f*2],r[f*2+1]=m),u--)}},Ire=(e,t,r)=>{const n=new Array(yp+1);let a=0,i,s;for(i=1;i<=yp;i++)a=a+r[i-1]<<1,n[i]=a;for(s=0;s<=t;s++){let l=e[s*2+1];l!==0&&(e[s*2]=Ore(n[l]++,l))}},MKe=()=>{let e,t,r,n,a;const i=new Array(yp+1);for(r=0,n=0;n<xM-1;n++)for(wM[n]=r,e=0;e<1<<e4[n];e++)y1[r++]=n;for(y1[r-1]=n,a=0,n=0;n<16;n++)for(F_[n]=a,e=0;e<1<<Sj[n];e++)x1[a++]=n;for(a>>=7;n<Hv;n++)for(F_[n]=a<<7,e=0;e<1<<Sj[n]-7;e++)x1[256+a++]=n;for(t=0;t<=yp;t++)i[t]=0;for(e=0;e<=143;)cf[e*2+1]=8,e++,i[8]++;for(;e<=255;)cf[e*2+1]=9,e++,i[9]++;for(;e<=279;)cf[e*2+1]=7,e++,i[7]++;for(;e<=287;)cf[e*2+1]=8,e++,i[8]++;for(Ire(cf,v1+1,i),e=0;e<Hv;e++)Hy[e*2+1]=5,Hy[e*2]=Ore(e,5);Pre=new DA(cf,e4,cw+1,v1,yp),Are=new DA(Hy,Sj,0,Hv,yp),Ere=new DA(new Array(0),OKe,0,yM,kKe)},Tre=e=>{let t;for(t=0;t<v1;t++)e.dyn_ltree[t*2]=0;for(t=0;t<Hv;t++)e.dyn_dtree[t*2]=0;for(t=0;t<yM;t++)e.bl_tree[t*2]=0;e.dyn_ltree[bM*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Dre=e=>{e.bi_valid>8?b1(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Xq=(e,t,r,n)=>{const a=t*2,i=r*2;return e[a]<e[i]||e[a]===e[i]&&n[t]<=n[r]},RA=(e,t,r)=>{const n=e.heap[r];let a=r<<1;for(;a<=e.heap_len&&(a<e.heap_len&&Xq(t,e.heap[a+1],e.heap[a],e.depth)&&a++,!Xq(t,n,e.heap[a],e.depth));)e.heap[r]=e.heap[a],r=a,a<<=1;e.heap[r]=n},Jq=(e,t,r)=>{let n,a,i=0,s,l;if(e.sym_next!==0)do n=e.pending_buf[e.sym_buf+i++]&255,n+=(e.pending_buf[e.sym_buf+i++]&255)<<8,a=e.pending_buf[e.sym_buf+i++],n===0?wu(e,a,t):(s=y1[a],wu(e,s+cw+1,t),l=e4[s],l!==0&&(a-=wM[s],Ol(e,a,l)),n--,s=kre(n),wu(e,s,r),l=Sj[s],l!==0&&(n-=F_[s],Ol(e,n,l)));while(i<e.sym_next);wu(e,bM,t)},t4=(e,t)=>{const r=t.dyn_tree,n=t.stat_desc.static_tree,a=t.stat_desc.has_stree,i=t.stat_desc.elems;let s,l,c=-1,d;for(e.heap_len=0,e.heap_max=jre,s=0;s<i;s++)r[s*2]!==0?(e.heap[++e.heap_len]=c=s,e.depth[s]=0):r[s*2+1]=0;for(;e.heap_len<2;)d=e.heap[++e.heap_len]=c<2?++c:0,r[d*2]=1,e.depth[d]=0,e.opt_len--,a&&(e.static_len-=n[d*2+1]);for(t.max_code=c,s=e.heap_len>>1;s>=1;s--)RA(e,r,s);d=i;do s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],RA(e,r,1),l=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=l,r[d*2]=r[s*2]+r[l*2],e.depth[d]=(e.depth[s]>=e.depth[l]?e.depth[s]:e.depth[l])+1,r[s*2+1]=r[l*2+1]=d,e.heap[1]=d++,RA(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],DKe(e,t),Ire(r,c,e.bl_count)},Qq=(e,t,r)=>{let n,a=-1,i,s=t[0*2+1],l=0,c=7,d=4;for(s===0&&(c=138,d=3),t[(r+1)*2+1]=65535,n=0;n<=r;n++)i=s,s=t[(n+1)*2+1],!(++l<c&&i===s)&&(l<d?e.bl_tree[i*2]+=l:i!==0?(i!==a&&e.bl_tree[i*2]++,e.bl_tree[Nre*2]++):l<=10?e.bl_tree[_re*2]++:e.bl_tree[Sre*2]++,l=0,a=i,s===0?(c=138,d=3):i===s?(c=6,d=3):(c=7,d=4))},Zq=(e,t,r)=>{let n,a=-1,i,s=t[0*2+1],l=0,c=7,d=4;for(s===0&&(c=138,d=3),n=0;n<=r;n++)if(i=s,s=t[(n+1)*2+1],!(++l<c&&i===s)){if(l<d)do wu(e,i,e.bl_tree);while(--l!==0);else i!==0?(i!==a&&(wu(e,i,e.bl_tree),l--),wu(e,Nre,e.bl_tree),Ol(e,l-3,2)):l<=10?(wu(e,_re,e.bl_tree),Ol(e,l-3,3)):(wu(e,Sre,e.bl_tree),Ol(e,l-11,7));l=0,a=i,s===0?(c=138,d=3):i===s?(c=6,d=3):(c=7,d=4)}},RKe=e=>{let t;for(Qq(e,e.dyn_ltree,e.l_desc.max_code),Qq(e,e.dyn_dtree,e.d_desc.max_code),t4(e,e.bl_desc),t=yM-1;t>=3&&e.bl_tree[Cre[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},LKe=(e,t,r,n)=>{let a;for(Ol(e,t-257,5),Ol(e,r-1,5),Ol(e,n-4,4),a=0;a<n;a++)Ol(e,e.bl_tree[Cre[a]*2+1],3);Zq(e,e.dyn_ltree,t-1),Zq(e,e.dyn_dtree,r-1)},$Ke=e=>{let t=4093624447,r;for(r=0;r<=31;r++,t>>>=1)if(t&1&&e.dyn_ltree[r*2]!==0)return Kq;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Yq;for(r=32;r<cw;r++)if(e.dyn_ltree[r*2]!==0)return Yq;return Kq};let ez=!1;const FKe=e=>{ez||(MKe(),ez=!0),e.l_desc=new MA(e.dyn_ltree,Pre),e.d_desc=new MA(e.dyn_dtree,Are),e.bl_desc=new MA(e.bl_tree,Ere),e.bi_buf=0,e.bi_valid=0,Tre(e)},Mre=(e,t,r,n)=>{Ol(e,(CKe<<1)+(n?1:0),3),Dre(e),b1(e,r),b1(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r},BKe=e=>{Ol(e,wre<<1,3),wu(e,bM,cf),TKe(e)},qKe=(e,t,r,n)=>{let a,i,s=0;e.level>0?(e.strm.data_type===SKe&&(e.strm.data_type=$Ke(e)),t4(e,e.l_desc),t4(e,e.d_desc),s=RKe(e),a=e.opt_len+3+7>>>3,i=e.static_len+3+7>>>3,i<=a&&(a=i)):a=i=r+5,r+4<=a&&t!==-1?Mre(e,t,r,n):e.strategy===_Ke||i===a?(Ol(e,(wre<<1)+(n?1:0),3),Jq(e,cf,Hy)):(Ol(e,(PKe<<1)+(n?1:0),3),LKe(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),Jq(e,e.dyn_ltree,e.dyn_dtree)),Tre(e),n&&Dre(e)},zKe=(e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,t===0?e.dyn_ltree[r*2]++:(e.matches++,t--,e.dyn_ltree[(y1[r]+cw+1)*2]++,e.dyn_dtree[kre(t)*2]++),e.sym_next===e.sym_end);var UKe=FKe,VKe=Mre,WKe=qKe,HKe=zKe,GKe=BKe,KKe={_tr_init:UKe,_tr_stored_block:VKe,_tr_flush_block:WKe,_tr_tally:HKe,_tr_align:GKe};const YKe=(e,t,r,n)=>{let a=e&65535|0,i=e>>>16&65535|0,s=0;for(;r!==0;){s=r>2e3?2e3:r,r-=s;do a=a+t[n++]|0,i=i+a|0;while(--s);a%=65521,i%=65521}return a|i<<16|0};var w1=YKe;const XKe=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},JKe=new Uint32Array(XKe()),QKe=(e,t,r,n)=>{const a=JKe,i=n+r;e^=-1;for(let s=n;s<i;s++)e=e>>>8^a[(e^t[s])&255];return e^-1};var es=QKe,Lx={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},dw={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:ZKe,_tr_stored_block:r4,_tr_flush_block:eYe,_tr_tally:Jm,_tr_align:tYe}=KKe,{Z_NO_FLUSH:Qm,Z_PARTIAL_FLUSH:rYe,Z_FULL_FLUSH:nYe,Z_FINISH:ed,Z_BLOCK:tz,Z_OK:js,Z_STREAM_END:rz,Z_STREAM_ERROR:Ru,Z_DATA_ERROR:aYe,Z_BUF_ERROR:LA,Z_DEFAULT_COMPRESSION:oYe,Z_FILTERED:iYe,Z_HUFFMAN_ONLY:D2,Z_RLE:sYe,Z_FIXED:lYe,Z_DEFAULT_STRATEGY:cYe,Z_UNKNOWN:dYe,Z_DEFLATED:r5}=dw,uYe=9,fYe=15,mYe=8,hYe=29,pYe=256,n4=pYe+1+hYe,gYe=30,vYe=19,xYe=2*n4+1,yYe=15,Ta=3,Om=258,Lu=Om+Ta+1,bYe=32,$x=42,jM=57,a4=69,o4=73,i4=91,s4=103,bp=113,py=666,ml=1,v0=2,ag=3,x0=4,wYe=3,wp=(e,t)=>(e.msg=Lx[t],t),nz=e=>e*2-(e>4?9:0),wm=e=>{let t=e.length;for(;--t>=0;)e[t]=0},jYe=e=>{let t,r,n,a=e.w_size;t=e.hash_size,n=t;do r=e.head[--n],e.head[n]=r>=a?r-a:0;while(--t);t=a,n=t;do r=e.prev[--n],e.prev[n]=r>=a?r-a:0;while(--t)};let NYe=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask,Zm=NYe;const tc=e=>{const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),r!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,t.pending===0&&(t.pending_out=0))},uc=(e,t)=>{eYe(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,tc(e.strm)},Ga=(e,t)=>{e.pending_buf[e.pending++]=t},Z0=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},l4=(e,t,r,n)=>{let a=e.avail_in;return a>n&&(a=n),a===0?0:(e.avail_in-=a,t.set(e.input.subarray(e.next_in,e.next_in+a),r),e.state.wrap===1?e.adler=w1(e.adler,t,a,r):e.state.wrap===2&&(e.adler=es(e.adler,t,a,r)),e.next_in+=a,e.total_in+=a,a)},Rre=(e,t)=>{let r=e.max_chain_length,n=e.strstart,a,i,s=e.prev_length,l=e.nice_match;const c=e.strstart>e.w_size-Lu?e.strstart-(e.w_size-Lu):0,d=e.window,u=e.w_mask,f=e.prev,m=e.strstart+Om;let h=d[n+s-1],v=d[n+s];e.prev_length>=e.good_match&&(r>>=2),l>e.lookahead&&(l=e.lookahead);do if(a=t,!(d[a+s]!==v||d[a+s-1]!==h||d[a]!==d[n]||d[++a]!==d[n+1])){n+=2,a++;do;while(d[++n]===d[++a]&&d[++n]===d[++a]&&d[++n]===d[++a]&&d[++n]===d[++a]&&d[++n]===d[++a]&&d[++n]===d[++a]&&d[++n]===d[++a]&&d[++n]===d[++a]&&n<m);if(i=Om-(m-n),n=m-Om,i>s){if(e.match_start=t,s=i,i>=l)break;h=d[n+s-1],v=d[n+s]}}while((t=f[t&u])>c&&--r!==0);return s<=e.lookahead?s:e.lookahead},Fx=e=>{const t=e.w_size;let r,n,a;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Lu)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),jYe(e),n+=t),e.strm.avail_in===0)break;if(r=l4(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=r,e.lookahead+e.insert>=Ta)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=Zm(e,e.ins_h,e.window[a+1]);e.insert&&(e.ins_h=Zm(e,e.ins_h,e.window[a+Ta-1]),e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<Ta)););}while(e.lookahead<Lu&&e.strm.avail_in!==0)},Lre=(e,t)=>{let r=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,n,a,i,s=0,l=e.strm.avail_in;do{if(n=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i||(i=e.strm.avail_out-i,a=e.strstart-e.block_start,n>a+e.strm.avail_in&&(n=a+e.strm.avail_in),n>i&&(n=i),n<r&&(n===0&&t!==ed||t===Qm||n!==a+e.strm.avail_in)))break;s=t===ed&&n===a+e.strm.avail_in?1:0,r4(e,0,0,s),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,tc(e.strm),a&&(a>n&&(a=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+a),e.strm.next_out),e.strm.next_out+=a,e.strm.avail_out-=a,e.strm.total_out+=a,e.block_start+=a,n-=a),n&&(l4(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(s===0);return l-=e.strm.avail_in,l&&(l>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=l&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-l,e.strm.next_in),e.strstart),e.strstart+=l,e.insert+=l>e.w_size-e.insert?e.w_size-e.insert:l),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),s?x0:t!==Qm&&t!==ed&&e.strm.avail_in===0&&e.strstart===e.block_start?v0:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(l4(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,r=i>e.w_size?e.w_size:i,a=e.strstart-e.block_start,(a>=r||(a||t===ed)&&t!==Qm&&e.strm.avail_in===0&&a<=i)&&(n=a>i?i:a,s=t===ed&&e.strm.avail_in===0&&n===a?1:0,r4(e,e.block_start,n,s),e.block_start+=n,tc(e.strm)),s?ag:ml)},$A=(e,t)=>{let r,n;for(;;){if(e.lookahead<Lu){if(Fx(e),e.lookahead<Lu&&t===Qm)return ml;if(e.lookahead===0)break}if(r=0,e.lookahead>=Ta&&(e.ins_h=Zm(e,e.ins_h,e.window[e.strstart+Ta-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),r!==0&&e.strstart-r<=e.w_size-Lu&&(e.match_length=Rre(e,r)),e.match_length>=Ta)if(n=Jm(e,e.strstart-e.match_start,e.match_length-Ta),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=Ta){e.match_length--;do e.strstart++,e.ins_h=Zm(e,e.ins_h,e.window[e.strstart+Ta-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Zm(e,e.ins_h,e.window[e.strstart+1]);else n=Jm(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(uc(e,!1),e.strm.avail_out===0))return ml}return e.insert=e.strstart<Ta-1?e.strstart:Ta-1,t===ed?(uc(e,!0),e.strm.avail_out===0?ag:x0):e.sym_next&&(uc(e,!1),e.strm.avail_out===0)?ml:v0},Ug=(e,t)=>{let r,n,a;for(;;){if(e.lookahead<Lu){if(Fx(e),e.lookahead<Lu&&t===Qm)return ml;if(e.lookahead===0)break}if(r=0,e.lookahead>=Ta&&(e.ins_h=Zm(e,e.ins_h,e.window[e.strstart+Ta-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=Ta-1,r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-Lu&&(e.match_length=Rre(e,r),e.match_length<=5&&(e.strategy===iYe||e.match_length===Ta&&e.strstart-e.match_start>4096)&&(e.match_length=Ta-1)),e.prev_length>=Ta&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-Ta,n=Jm(e,e.strstart-1-e.prev_match,e.prev_length-Ta),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=a&&(e.ins_h=Zm(e,e.ins_h,e.window[e.strstart+Ta-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=Ta-1,e.strstart++,n&&(uc(e,!1),e.strm.avail_out===0))return ml}else if(e.match_available){if(n=Jm(e,0,e.window[e.strstart-1]),n&&uc(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return ml}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=Jm(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<Ta-1?e.strstart:Ta-1,t===ed?(uc(e,!0),e.strm.avail_out===0?ag:x0):e.sym_next&&(uc(e,!1),e.strm.avail_out===0)?ml:v0},_Ye=(e,t)=>{let r,n,a,i;const s=e.window;for(;;){if(e.lookahead<=Om){if(Fx(e),e.lookahead<=Om&&t===Qm)return ml;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=Ta&&e.strstart>0&&(a=e.strstart-1,n=s[a],n===s[++a]&&n===s[++a]&&n===s[++a])){i=e.strstart+Om;do;while(n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&a<i);e.match_length=Om-(i-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=Ta?(r=Jm(e,1,e.match_length-Ta),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=Jm(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(uc(e,!1),e.strm.avail_out===0))return ml}return e.insert=0,t===ed?(uc(e,!0),e.strm.avail_out===0?ag:x0):e.sym_next&&(uc(e,!1),e.strm.avail_out===0)?ml:v0},SYe=(e,t)=>{let r;for(;;){if(e.lookahead===0&&(Fx(e),e.lookahead===0)){if(t===Qm)return ml;break}if(e.match_length=0,r=Jm(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(uc(e,!1),e.strm.avail_out===0))return ml}return e.insert=0,t===ed?(uc(e,!0),e.strm.avail_out===0?ag:x0):e.sym_next&&(uc(e,!1),e.strm.avail_out===0)?ml:v0};function uu(e,t,r,n,a){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=a}const gy=[new uu(0,0,0,0,Lre),new uu(4,4,8,4,$A),new uu(4,5,16,8,$A),new uu(4,6,32,32,$A),new uu(4,4,16,16,Ug),new uu(8,16,32,32,Ug),new uu(8,16,128,128,Ug),new uu(8,32,128,256,Ug),new uu(32,128,258,1024,Ug),new uu(32,258,258,4096,Ug)],CYe=e=>{e.window_size=2*e.w_size,wm(e.head),e.max_lazy_match=gy[e.level].max_lazy,e.good_match=gy[e.level].good_length,e.nice_match=gy[e.level].nice_length,e.max_chain_length=gy[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=Ta-1,e.match_available=0,e.ins_h=0};function PYe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=r5,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(xYe*2),this.dyn_dtree=new Uint16Array((2*gYe+1)*2),this.bl_tree=new Uint16Array((2*vYe+1)*2),wm(this.dyn_ltree),wm(this.dyn_dtree),wm(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(yYe+1),this.heap=new Uint16Array(2*n4+1),wm(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*n4+1),wm(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const uw=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==$x&&t.status!==jM&&t.status!==a4&&t.status!==o4&&t.status!==i4&&t.status!==s4&&t.status!==bp&&t.status!==py?1:0},$re=e=>{if(uw(e))return wp(e,Ru);e.total_in=e.total_out=0,e.data_type=dYe;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?jM:t.wrap?$x:bp,e.adler=t.wrap===2?0:1,t.last_flush=-2,ZKe(t),js},Fre=e=>{const t=$re(e);return t===js&&CYe(e.state),t},AYe=(e,t)=>uw(e)||e.state.wrap!==2?Ru:(e.state.gzhead=t,js),Bre=(e,t,r,n,a,i)=>{if(!e)return Ru;let s=1;if(t===oYe&&(t=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),a<1||a>uYe||r!==r5||n<8||n>15||t<0||t>9||i<0||i>lYe||n===8&&s!==1)return wp(e,Ru);n===8&&(n=9);const l=new PYe;return e.state=l,l.strm=e,l.status=$x,l.wrap=s,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=a+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+Ta-1)/Ta),l.window=new Uint8Array(l.w_size*2),l.head=new Uint16Array(l.hash_size),l.prev=new Uint16Array(l.w_size),l.lit_bufsize=1<<a+6,l.pending_buf_size=l.lit_bufsize*4,l.pending_buf=new Uint8Array(l.pending_buf_size),l.sym_buf=l.lit_bufsize,l.sym_end=(l.lit_bufsize-1)*3,l.level=t,l.strategy=i,l.method=r,Fre(e)},EYe=(e,t)=>Bre(e,t,r5,fYe,mYe,cYe),kYe=(e,t)=>{if(uw(e)||t>tz||t<0)return e?wp(e,Ru):Ru;const r=e.state;if(!e.output||e.avail_in!==0&&!e.input||r.status===py&&t!==ed)return wp(e,e.avail_out===0?LA:Ru);const n=r.last_flush;if(r.last_flush=t,r.pending!==0){if(tc(e),e.avail_out===0)return r.last_flush=-1,js}else if(e.avail_in===0&&nz(t)<=nz(n)&&t!==ed)return wp(e,LA);if(r.status===py&&e.avail_in!==0)return wp(e,LA);if(r.status===$x&&r.wrap===0&&(r.status=bp),r.status===$x){let a=r5+(r.w_bits-8<<4)<<8,i=-1;if(r.strategy>=D2||r.level<2?i=0:r.level<6?i=1:r.level===6?i=2:i=3,a|=i<<6,r.strstart!==0&&(a|=bYe),a+=31-a%31,Z0(r,a),r.strstart!==0&&(Z0(r,e.adler>>>16),Z0(r,e.adler&65535)),e.adler=1,r.status=bp,tc(e),r.pending!==0)return r.last_flush=-1,js}if(r.status===jM){if(e.adler=0,Ga(r,31),Ga(r,139),Ga(r,8),r.gzhead)Ga(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Ga(r,r.gzhead.time&255),Ga(r,r.gzhead.time>>8&255),Ga(r,r.gzhead.time>>16&255),Ga(r,r.gzhead.time>>24&255),Ga(r,r.level===9?2:r.strategy>=D2||r.level<2?4:0),Ga(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(Ga(r,r.gzhead.extra.length&255),Ga(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=es(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=a4;else if(Ga(r,0),Ga(r,0),Ga(r,0),Ga(r,0),Ga(r,0),Ga(r,r.level===9?2:r.strategy>=D2||r.level<2?4:0),Ga(r,wYe),r.status=bp,tc(e),r.pending!==0)return r.last_flush=-1,js}if(r.status===a4){if(r.gzhead.extra){let a=r.pending,i=(r.gzhead.extra.length&65535)-r.gzindex;for(;r.pending+i>r.pending_buf_size;){let l=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+l),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>a&&(e.adler=es(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex+=l,tc(e),r.pending!==0)return r.last_flush=-1,js;a=0,i-=l}let s=new Uint8Array(r.gzhead.extra);r.pending_buf.set(s.subarray(r.gzindex,r.gzindex+i),r.pending),r.pending+=i,r.gzhead.hcrc&&r.pending>a&&(e.adler=es(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex=0}r.status=o4}if(r.status===o4){if(r.gzhead.name){let a=r.pending,i;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>a&&(e.adler=es(e.adler,r.pending_buf,r.pending-a,a)),tc(e),r.pending!==0)return r.last_flush=-1,js;a=0}r.gzindex<r.gzhead.name.length?i=r.gzhead.name.charCodeAt(r.gzindex++)&255:i=0,Ga(r,i)}while(i!==0);r.gzhead.hcrc&&r.pending>a&&(e.adler=es(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex=0}r.status=i4}if(r.status===i4){if(r.gzhead.comment){let a=r.pending,i;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>a&&(e.adler=es(e.adler,r.pending_buf,r.pending-a,a)),tc(e),r.pending!==0)return r.last_flush=-1,js;a=0}r.gzindex<r.gzhead.comment.length?i=r.gzhead.comment.charCodeAt(r.gzindex++)&255:i=0,Ga(r,i)}while(i!==0);r.gzhead.hcrc&&r.pending>a&&(e.adler=es(e.adler,r.pending_buf,r.pending-a,a))}r.status=s4}if(r.status===s4){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(tc(e),r.pending!==0))return r.last_flush=-1,js;Ga(r,e.adler&255),Ga(r,e.adler>>8&255),e.adler=0}if(r.status=bp,tc(e),r.pending!==0)return r.last_flush=-1,js}if(e.avail_in!==0||r.lookahead!==0||t!==Qm&&r.status!==py){let a=r.level===0?Lre(r,t):r.strategy===D2?SYe(r,t):r.strategy===sYe?_Ye(r,t):gy[r.level].func(r,t);if((a===ag||a===x0)&&(r.status=py),a===ml||a===ag)return e.avail_out===0&&(r.last_flush=-1),js;if(a===v0&&(t===rYe?tYe(r):t!==tz&&(r4(r,0,0,!1),t===nYe&&(wm(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),tc(e),e.avail_out===0))return r.last_flush=-1,js}return t!==ed?js:r.wrap<=0?rz:(r.wrap===2?(Ga(r,e.adler&255),Ga(r,e.adler>>8&255),Ga(r,e.adler>>16&255),Ga(r,e.adler>>24&255),Ga(r,e.total_in&255),Ga(r,e.total_in>>8&255),Ga(r,e.total_in>>16&255),Ga(r,e.total_in>>24&255)):(Z0(r,e.adler>>>16),Z0(r,e.adler&65535)),tc(e),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?js:rz)},OYe=e=>{if(uw(e))return Ru;const t=e.state.status;return e.state=null,t===bp?wp(e,aYe):js},IYe=(e,t)=>{let r=t.length;if(uw(e))return Ru;const n=e.state,a=n.wrap;if(a===2||a===1&&n.status!==$x||n.lookahead)return Ru;if(a===1&&(e.adler=w1(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){a===0&&(wm(n.head),n.strstart=0,n.block_start=0,n.insert=0);let c=new Uint8Array(n.w_size);c.set(t.subarray(r-n.w_size,r),0),t=c,r=n.w_size}const i=e.avail_in,s=e.next_in,l=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,Fx(n);n.lookahead>=Ta;){let c=n.strstart,d=n.lookahead-(Ta-1);do n.ins_h=Zm(n,n.ins_h,n.window[c+Ta-1]),n.prev[c&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=c,c++;while(--d);n.strstart=c,n.lookahead=Ta-1,Fx(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=Ta-1,n.match_available=0,e.next_in=s,e.input=l,e.avail_in=i,n.wrap=a,js};var TYe=EYe,DYe=Bre,MYe=Fre,RYe=$re,LYe=AYe,$Ye=kYe,FYe=OYe,BYe=IYe,qYe="pako deflate (from Nodeca project)",Gy={deflateInit:TYe,deflateInit2:DYe,deflateReset:MYe,deflateResetKeep:RYe,deflateSetHeader:LYe,deflate:$Ye,deflateEnd:FYe,deflateSetDictionary:BYe,deflateInfo:qYe};const zYe=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var UYe=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)zYe(r,n)&&(e[n]=r[n])}}return e},VYe=e=>{let t=0;for(let n=0,a=e.length;n<a;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,a=0,i=e.length;n<i;n++){let s=e[n];r.set(s,a),a+=s.length}return r},n5={assign:UYe,flattenChunks:VYe};let qre=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{qre=!1}const j1=new Uint8Array(256);for(let e=0;e<256;e++)j1[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;j1[254]=j1[254]=1;var WYe=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,a,i,s=e.length,l=0;for(a=0;a<s;a++)r=e.charCodeAt(a),(r&64512)===55296&&a+1<s&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(l),i=0,a=0;i<l;a++)r=e.charCodeAt(a),(r&64512)===55296&&a+1<s&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),r<128?t[i++]=r:r<2048?(t[i++]=192|r>>>6,t[i++]=128|r&63):r<65536?(t[i++]=224|r>>>12,t[i++]=128|r>>>6&63,t[i++]=128|r&63):(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63,t[i++]=128|r>>>6&63,t[i++]=128|r&63);return t};const HYe=(e,t)=>{if(t<65534&&e.subarray&&qre)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var GYe=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,a;const i=new Array(r*2);for(a=0,n=0;n<r;){let s=e[n++];if(s<128){i[a++]=s;continue}let l=j1[s];if(l>4){i[a++]=65533,n+=l-1;continue}for(s&=l===2?31:l===3?15:7;l>1&&n<r;)s=s<<6|e[n++]&63,l--;if(l>1){i[a++]=65533;continue}s<65536?i[a++]=s:(s-=65536,i[a++]=55296|s>>10&1023,i[a++]=56320|s&1023)}return HYe(i,a)},KYe=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+j1[e[r]]>t?r:t},N1={string2buf:WYe,buf2string:GYe,utf8border:KYe};function YYe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zre=YYe;const Ure=Object.prototype.toString,{Z_NO_FLUSH:XYe,Z_SYNC_FLUSH:JYe,Z_FULL_FLUSH:QYe,Z_FINISH:ZYe,Z_OK:B_,Z_STREAM_END:eXe,Z_DEFAULT_COMPRESSION:tXe,Z_DEFAULT_STRATEGY:rXe,Z_DEFLATED:nXe}=dw;function NM(e){this.options=n5.assign({level:tXe,method:nXe,chunkSize:16384,windowBits:15,memLevel:8,strategy:rXe},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zre,this.strm.avail_out=0;let r=Gy.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==B_)throw new Error(Lx[r]);if(t.header&&Gy.deflateSetHeader(this.strm,t.header),t.dictionary){let n;if(typeof t.dictionary=="string"?n=N1.string2buf(t.dictionary):Ure.call(t.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(t.dictionary):n=t.dictionary,r=Gy.deflateSetDictionary(this.strm,n),r!==B_)throw new Error(Lx[r]);this._dict_set=!0}}NM.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize;let a,i;if(this.ended)return!1;for(t===~~t?i=t:i=t===!0?ZYe:XYe,typeof e=="string"?r.input=N1.string2buf(e):Ure.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(i===JYe||i===QYe)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(a=Gy.deflate(r,i),a===eXe)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),a=Gy.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===B_;if(r.avail_out===0){this.onData(r.output);continue}if(i>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0};NM.prototype.onData=function(e){this.chunks.push(e)};NM.prototype.onEnd=function(e){e===B_&&(this.result=n5.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};const M2=16209,aXe=16191;var oXe=function(t,r){let n,a,i,s,l,c,d,u,f,m,h,v,g,y,x,b,w,j,_,C,E,P,k,M;const S=t.state;n=t.next_in,k=t.input,a=n+(t.avail_in-5),i=t.next_out,M=t.output,s=i-(r-t.avail_out),l=i+(t.avail_out-257),c=S.dmax,d=S.wsize,u=S.whave,f=S.wnext,m=S.window,h=S.hold,v=S.bits,g=S.lencode,y=S.distcode,x=(1<<S.lenbits)-1,b=(1<<S.distbits)-1;e:do{v<15&&(h+=k[n++]<<v,v+=8,h+=k[n++]<<v,v+=8),w=g[h&x];t:for(;;){if(j=w>>>24,h>>>=j,v-=j,j=w>>>16&255,j===0)M[i++]=w&65535;else if(j&16){_=w&65535,j&=15,j&&(v<j&&(h+=k[n++]<<v,v+=8),_+=h&(1<<j)-1,h>>>=j,v-=j),v<15&&(h+=k[n++]<<v,v+=8,h+=k[n++]<<v,v+=8),w=y[h&b];r:for(;;){if(j=w>>>24,h>>>=j,v-=j,j=w>>>16&255,j&16){if(C=w&65535,j&=15,v<j&&(h+=k[n++]<<v,v+=8,v<j&&(h+=k[n++]<<v,v+=8)),C+=h&(1<<j)-1,C>c){t.msg="invalid distance too far back",S.mode=M2;break e}if(h>>>=j,v-=j,j=i-s,C>j){if(j=C-j,j>u&&S.sane){t.msg="invalid distance too far back",S.mode=M2;break e}if(E=0,P=m,f===0){if(E+=d-j,j<_){_-=j;do M[i++]=m[E++];while(--j);E=i-C,P=M}}else if(f<j){if(E+=d+f-j,j-=f,j<_){_-=j;do M[i++]=m[E++];while(--j);if(E=0,f<_){j=f,_-=j;do M[i++]=m[E++];while(--j);E=i-C,P=M}}}else if(E+=f-j,j<_){_-=j;do M[i++]=m[E++];while(--j);E=i-C,P=M}for(;_>2;)M[i++]=P[E++],M[i++]=P[E++],M[i++]=P[E++],_-=3;_&&(M[i++]=P[E++],_>1&&(M[i++]=P[E++]))}else{E=i-C;do M[i++]=M[E++],M[i++]=M[E++],M[i++]=M[E++],_-=3;while(_>2);_&&(M[i++]=M[E++],_>1&&(M[i++]=M[E++]))}}else if(j&64){t.msg="invalid distance code",S.mode=M2;break e}else{w=y[(w&65535)+(h&(1<<j)-1)];continue r}break}}else if(j&64)if(j&32){S.mode=aXe;break e}else{t.msg="invalid literal/length code",S.mode=M2;break e}else{w=g[(w&65535)+(h&(1<<j)-1)];continue t}break}}while(n<a&&i<l);_=v>>3,n-=_,v-=_<<3,h&=(1<<v)-1,t.next_in=n,t.next_out=i,t.avail_in=n<a?5+(a-n):5-(n-a),t.avail_out=i<l?257+(l-i):257-(i-l),S.hold=h,S.bits=v};const Vg=15,az=852,oz=592,iz=0,FA=1,sz=2,iXe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),sXe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),lXe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),cXe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),dXe=(e,t,r,n,a,i,s,l)=>{const c=l.bits;let d=0,u=0,f=0,m=0,h=0,v=0,g=0,y=0,x=0,b=0,w,j,_,C,E,P=null,k;const M=new Uint16Array(Vg+1),S=new Uint16Array(Vg+1);let I=null,T,D,B;for(d=0;d<=Vg;d++)M[d]=0;for(u=0;u<n;u++)M[t[r+u]]++;for(h=c,m=Vg;m>=1&&M[m]===0;m--);if(h>m&&(h=m),m===0)return a[i++]=1<<24|64<<16|0,a[i++]=1<<24|64<<16|0,l.bits=1,0;for(f=1;f<m&&M[f]===0;f++);for(h<f&&(h=f),y=1,d=1;d<=Vg;d++)if(y<<=1,y-=M[d],y<0)return-1;if(y>0&&(e===iz||m!==1))return-1;for(S[1]=0,d=1;d<Vg;d++)S[d+1]=S[d]+M[d];for(u=0;u<n;u++)t[r+u]!==0&&(s[S[t[r+u]]++]=u);if(e===iz?(P=I=s,k=20):e===FA?(P=iXe,I=sXe,k=257):(P=lXe,I=cXe,k=0),b=0,u=0,d=f,E=i,v=h,g=0,_=-1,x=1<<h,C=x-1,e===FA&&x>az||e===sz&&x>oz)return 1;for(;;){T=d-g,s[u]+1<k?(D=0,B=s[u]):s[u]>=k?(D=I[s[u]-k],B=P[s[u]-k]):(D=32+64,B=0),w=1<<d-g,j=1<<v,f=j;do j-=w,a[E+(b>>g)+j]=T<<24|D<<16|B|0;while(j!==0);for(w=1<<d-1;b&w;)w>>=1;if(w!==0?(b&=w-1,b+=w):b=0,u++,--M[d]===0){if(d===m)break;d=t[r+s[u]]}if(d>h&&(b&C)!==_){for(g===0&&(g=h),E+=f,v=d-g,y=1<<v;v+g<m&&(y-=M[v+g],!(y<=0));)v++,y<<=1;if(x+=1<<v,e===FA&&x>az||e===sz&&x>oz)return 1;_=b&C,a[_]=h<<24|v<<16|E-i|0}}return b!==0&&(a[E+b]=d-g<<24|64<<16|0),l.bits=h,0};var Ky=dXe;const uXe=0,Vre=1,Wre=2,{Z_FINISH:lz,Z_BLOCK:fXe,Z_TREES:R2,Z_OK:og,Z_STREAM_END:mXe,Z_NEED_DICT:hXe,Z_STREAM_ERROR:hd,Z_DATA_ERROR:Hre,Z_MEM_ERROR:Gre,Z_BUF_ERROR:pXe,Z_DEFLATED:cz}=dw,a5=16180,dz=16181,uz=16182,fz=16183,mz=16184,hz=16185,pz=16186,gz=16187,vz=16188,xz=16189,q_=16190,tf=16191,BA=16192,yz=16193,qA=16194,bz=16195,wz=16196,jz=16197,Nz=16198,L2=16199,$2=16200,_z=16201,Sz=16202,Cz=16203,Pz=16204,Az=16205,zA=16206,Ez=16207,kz=16208,$o=16209,Kre=16210,Yre=16211,gXe=852,vXe=592,xXe=15,yXe=xXe,Oz=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function bXe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const wg=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<a5||t.mode>Yre?1:0},Xre=e=>{if(wg(e))return hd;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=a5,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(gXe),t.distcode=t.distdyn=new Int32Array(vXe),t.sane=1,t.back=-1,og},Jre=e=>{if(wg(e))return hd;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Xre(e)},Qre=(e,t)=>{let r;if(wg(e))return hd;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?hd:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,Jre(e))},Zre=(e,t)=>{if(!e)return hd;const r=new bXe;e.state=r,r.strm=e,r.window=null,r.mode=a5;const n=Qre(e,t);return n!==og&&(e.state=null),n},wXe=e=>Zre(e,yXe);let Iz=!0,UA,VA;const jXe=e=>{if(Iz){UA=new Int32Array(512),VA=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Ky(Vre,e.lens,0,288,UA,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Ky(Wre,e.lens,0,32,VA,0,e.work,{bits:5}),Iz=!1}e.lencode=UA,e.lenbits=9,e.distcode=VA,e.distbits=5},ene=(e,t,r,n)=>{let a;const i=e.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),n>=i.wsize?(i.window.set(t.subarray(r-i.wsize,r),0),i.wnext=0,i.whave=i.wsize):(a=i.wsize-i.wnext,a>n&&(a=n),i.window.set(t.subarray(r-n,r-n+a),i.wnext),n-=a,n?(i.window.set(t.subarray(r-n,r),0),i.wnext=n,i.whave=i.wsize):(i.wnext+=a,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=a))),0},NXe=(e,t)=>{let r,n,a,i,s,l,c,d,u,f,m,h,v,g,y=0,x,b,w,j,_,C,E,P;const k=new Uint8Array(4);let M,S;const I=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(wg(e)||!e.output||!e.input&&e.avail_in!==0)return hd;r=e.state,r.mode===tf&&(r.mode=BA),s=e.next_out,a=e.output,c=e.avail_out,i=e.next_in,n=e.input,l=e.avail_in,d=r.hold,u=r.bits,f=l,m=c,P=og;e:for(;;)switch(r.mode){case a5:if(r.wrap===0){r.mode=BA;break}for(;u<16;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(r.wrap&2&&d===35615){r.wbits===0&&(r.wbits=15),r.check=0,k[0]=d&255,k[1]=d>>>8&255,r.check=es(r.check,k,2,0),d=0,u=0,r.mode=dz;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((d&255)<<8)+(d>>8))%31){e.msg="incorrect header check",r.mode=$o;break}if((d&15)!==cz){e.msg="unknown compression method",r.mode=$o;break}if(d>>>=4,u-=4,E=(d&15)+8,r.wbits===0&&(r.wbits=E),E>15||E>r.wbits){e.msg="invalid window size",r.mode=$o;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=d&512?xz:tf,d=0,u=0;break;case dz:for(;u<16;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(r.flags=d,(r.flags&255)!==cz){e.msg="unknown compression method",r.mode=$o;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=$o;break}r.head&&(r.head.text=d>>8&1),r.flags&512&&r.wrap&4&&(k[0]=d&255,k[1]=d>>>8&255,r.check=es(r.check,k,2,0)),d=0,u=0,r.mode=uz;case uz:for(;u<32;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}r.head&&(r.head.time=d),r.flags&512&&r.wrap&4&&(k[0]=d&255,k[1]=d>>>8&255,k[2]=d>>>16&255,k[3]=d>>>24&255,r.check=es(r.check,k,4,0)),d=0,u=0,r.mode=fz;case fz:for(;u<16;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}r.head&&(r.head.xflags=d&255,r.head.os=d>>8),r.flags&512&&r.wrap&4&&(k[0]=d&255,k[1]=d>>>8&255,r.check=es(r.check,k,2,0)),d=0,u=0,r.mode=mz;case mz:if(r.flags&1024){for(;u<16;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}r.length=d,r.head&&(r.head.extra_len=d),r.flags&512&&r.wrap&4&&(k[0]=d&255,k[1]=d>>>8&255,r.check=es(r.check,k,2,0)),d=0,u=0}else r.head&&(r.head.extra=null);r.mode=hz;case hz:if(r.flags&1024&&(h=r.length,h>l&&(h=l),h&&(r.head&&(E=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(i,i+h),E)),r.flags&512&&r.wrap&4&&(r.check=es(r.check,n,h,i)),l-=h,i+=h,r.length-=h),r.length))break e;r.length=0,r.mode=pz;case pz:if(r.flags&2048){if(l===0)break e;h=0;do E=n[i+h++],r.head&&E&&r.length<65536&&(r.head.name+=String.fromCharCode(E));while(E&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=es(r.check,n,h,i)),l-=h,i+=h,E)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=gz;case gz:if(r.flags&4096){if(l===0)break e;h=0;do E=n[i+h++],r.head&&E&&r.length<65536&&(r.head.comment+=String.fromCharCode(E));while(E&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=es(r.check,n,h,i)),l-=h,i+=h,E)break e}else r.head&&(r.head.comment=null);r.mode=vz;case vz:if(r.flags&512){for(;u<16;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(r.wrap&4&&d!==(r.check&65535)){e.msg="header crc mismatch",r.mode=$o;break}d=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=tf;break;case xz:for(;u<32;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}e.adler=r.check=Oz(d),d=0,u=0,r.mode=q_;case q_:if(r.havedict===0)return e.next_out=s,e.avail_out=c,e.next_in=i,e.avail_in=l,r.hold=d,r.bits=u,hXe;e.adler=r.check=1,r.mode=tf;case tf:if(t===fXe||t===R2)break e;case BA:if(r.last){d>>>=u&7,u-=u&7,r.mode=zA;break}for(;u<3;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}switch(r.last=d&1,d>>>=1,u-=1,d&3){case 0:r.mode=yz;break;case 1:if(jXe(r),r.mode=L2,t===R2){d>>>=2,u-=2;break e}break;case 2:r.mode=wz;break;case 3:e.msg="invalid block type",r.mode=$o}d>>>=2,u-=2;break;case yz:for(d>>>=u&7,u-=u&7;u<32;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if((d&65535)!==(d>>>16^65535)){e.msg="invalid stored block lengths",r.mode=$o;break}if(r.length=d&65535,d=0,u=0,r.mode=qA,t===R2)break e;case qA:r.mode=bz;case bz:if(h=r.length,h){if(h>l&&(h=l),h>c&&(h=c),h===0)break e;a.set(n.subarray(i,i+h),s),l-=h,i+=h,c-=h,s+=h,r.length-=h;break}r.mode=tf;break;case wz:for(;u<14;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(r.nlen=(d&31)+257,d>>>=5,u-=5,r.ndist=(d&31)+1,d>>>=5,u-=5,r.ncode=(d&15)+4,d>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=$o;break}r.have=0,r.mode=jz;case jz:for(;r.have<r.ncode;){for(;u<3;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}r.lens[I[r.have++]]=d&7,d>>>=3,u-=3}for(;r.have<19;)r.lens[I[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,M={bits:r.lenbits},P=Ky(uXe,r.lens,0,19,r.lencode,0,r.work,M),r.lenbits=M.bits,P){e.msg="invalid code lengths set",r.mode=$o;break}r.have=0,r.mode=Nz;case Nz:for(;r.have<r.nlen+r.ndist;){for(;y=r.lencode[d&(1<<r.lenbits)-1],x=y>>>24,b=y>>>16&255,w=y&65535,!(x<=u);){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(w<16)d>>>=x,u-=x,r.lens[r.have++]=w;else{if(w===16){for(S=x+2;u<S;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(d>>>=x,u-=x,r.have===0){e.msg="invalid bit length repeat",r.mode=$o;break}E=r.lens[r.have-1],h=3+(d&3),d>>>=2,u-=2}else if(w===17){for(S=x+3;u<S;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}d>>>=x,u-=x,E=0,h=3+(d&7),d>>>=3,u-=3}else{for(S=x+7;u<S;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}d>>>=x,u-=x,E=0,h=11+(d&127),d>>>=7,u-=7}if(r.have+h>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=$o;break}for(;h--;)r.lens[r.have++]=E}}if(r.mode===$o)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=$o;break}if(r.lenbits=9,M={bits:r.lenbits},P=Ky(Vre,r.lens,0,r.nlen,r.lencode,0,r.work,M),r.lenbits=M.bits,P){e.msg="invalid literal/lengths set",r.mode=$o;break}if(r.distbits=6,r.distcode=r.distdyn,M={bits:r.distbits},P=Ky(Wre,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,M),r.distbits=M.bits,P){e.msg="invalid distances set",r.mode=$o;break}if(r.mode=L2,t===R2)break e;case L2:r.mode=$2;case $2:if(l>=6&&c>=258){e.next_out=s,e.avail_out=c,e.next_in=i,e.avail_in=l,r.hold=d,r.bits=u,oXe(e,m),s=e.next_out,a=e.output,c=e.avail_out,i=e.next_in,n=e.input,l=e.avail_in,d=r.hold,u=r.bits,r.mode===tf&&(r.back=-1);break}for(r.back=0;y=r.lencode[d&(1<<r.lenbits)-1],x=y>>>24,b=y>>>16&255,w=y&65535,!(x<=u);){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(b&&!(b&240)){for(j=x,_=b,C=w;y=r.lencode[C+((d&(1<<j+_)-1)>>j)],x=y>>>24,b=y>>>16&255,w=y&65535,!(j+x<=u);){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}d>>>=j,u-=j,r.back+=j}if(d>>>=x,u-=x,r.back+=x,r.length=w,b===0){r.mode=Az;break}if(b&32){r.back=-1,r.mode=tf;break}if(b&64){e.msg="invalid literal/length code",r.mode=$o;break}r.extra=b&15,r.mode=_z;case _z:if(r.extra){for(S=r.extra;u<S;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}r.length+=d&(1<<r.extra)-1,d>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=Sz;case Sz:for(;y=r.distcode[d&(1<<r.distbits)-1],x=y>>>24,b=y>>>16&255,w=y&65535,!(x<=u);){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(!(b&240)){for(j=x,_=b,C=w;y=r.distcode[C+((d&(1<<j+_)-1)>>j)],x=y>>>24,b=y>>>16&255,w=y&65535,!(j+x<=u);){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}d>>>=j,u-=j,r.back+=j}if(d>>>=x,u-=x,r.back+=x,b&64){e.msg="invalid distance code",r.mode=$o;break}r.offset=w,r.extra=b&15,r.mode=Cz;case Cz:if(r.extra){for(S=r.extra;u<S;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}r.offset+=d&(1<<r.extra)-1,d>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=$o;break}r.mode=Pz;case Pz:if(c===0)break e;if(h=m-c,r.offset>h){if(h=r.offset-h,h>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=$o;break}h>r.wnext?(h-=r.wnext,v=r.wsize-h):v=r.wnext-h,h>r.length&&(h=r.length),g=r.window}else g=a,v=s-r.offset,h=r.length;h>c&&(h=c),c-=h,r.length-=h;do a[s++]=g[v++];while(--h);r.length===0&&(r.mode=$2);break;case Az:if(c===0)break e;a[s++]=r.length,c--,r.mode=$2;break;case zA:if(r.wrap){for(;u<32;){if(l===0)break e;l--,d|=n[i++]<<u,u+=8}if(m-=c,e.total_out+=m,r.total+=m,r.wrap&4&&m&&(e.adler=r.check=r.flags?es(r.check,a,m,s-m):w1(r.check,a,m,s-m)),m=c,r.wrap&4&&(r.flags?d:Oz(d))!==r.check){e.msg="incorrect data check",r.mode=$o;break}d=0,u=0}r.mode=Ez;case Ez:if(r.wrap&&r.flags){for(;u<32;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(r.wrap&4&&d!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=$o;break}d=0,u=0}r.mode=kz;case kz:P=mXe;break e;case $o:P=Hre;break e;case Kre:return Gre;case Yre:default:return hd}return e.next_out=s,e.avail_out=c,e.next_in=i,e.avail_in=l,r.hold=d,r.bits=u,(r.wsize||m!==e.avail_out&&r.mode<$o&&(r.mode<zA||t!==lz))&&ene(e,e.output,e.next_out,m-e.avail_out),f-=e.avail_in,m-=e.avail_out,e.total_in+=f,e.total_out+=m,r.total+=m,r.wrap&4&&m&&(e.adler=r.check=r.flags?es(r.check,a,m,e.next_out-m):w1(r.check,a,m,e.next_out-m)),e.data_type=r.bits+(r.last?64:0)+(r.mode===tf?128:0)+(r.mode===L2||r.mode===qA?256:0),(f===0&&m===0||t===lz)&&P===og&&(P=pXe),P},_Xe=e=>{if(wg(e))return hd;let t=e.state;return t.window&&(t.window=null),e.state=null,og},SXe=(e,t)=>{if(wg(e))return hd;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,og):hd},CXe=(e,t)=>{const r=t.length;let n,a,i;return wg(e)||(n=e.state,n.wrap!==0&&n.mode!==q_)?hd:n.mode===q_&&(a=1,a=w1(a,t,r,0),a!==n.check)?Hre:(i=ene(e,t,r,r),i?(n.mode=Kre,Gre):(n.havedict=1,og))};var PXe=Jre,AXe=Qre,EXe=Xre,kXe=wXe,OXe=Zre,IXe=NXe,TXe=_Xe,DXe=SXe,MXe=CXe,RXe="pako inflate (from Nodeca project)",df={inflateReset:PXe,inflateReset2:AXe,inflateResetKeep:EXe,inflateInit:kXe,inflateInit2:OXe,inflate:IXe,inflateEnd:TXe,inflateGetHeader:DXe,inflateSetDictionary:MXe,inflateInfo:RXe};function LXe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var $Xe=LXe;const tne=Object.prototype.toString,{Z_NO_FLUSH:FXe,Z_FINISH:BXe,Z_OK:_1,Z_STREAM_END:WA,Z_NEED_DICT:HA,Z_STREAM_ERROR:qXe,Z_DATA_ERROR:Tz,Z_MEM_ERROR:zXe}=dw;function fw(e){this.options=n5.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zre,this.strm.avail_out=0;let r=df.inflateInit2(this.strm,t.windowBits);if(r!==_1)throw new Error(Lx[r]);if(this.header=new $Xe,df.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=N1.string2buf(t.dictionary):tne.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=df.inflateSetDictionary(this.strm,t.dictionary),r!==_1)))throw new Error(Lx[r])}fw.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,a=this.options.dictionary;let i,s,l;if(this.ended)return!1;for(t===~~t?s=t:s=t===!0?BXe:FXe,tne.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),i=df.inflate(r,s),i===HA&&a&&(i=df.inflateSetDictionary(r,a),i===_1?i=df.inflate(r,s):i===Tz&&(i=HA));r.avail_in>0&&i===WA&&r.state.wrap>0&&e[r.next_in]!==0;)df.inflateReset(r),i=df.inflate(r,s);switch(i){case qXe:case Tz:case HA:case zXe:return this.onEnd(i),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||i===WA))if(this.options.to==="string"){let c=N1.utf8border(r.output,r.next_out),d=r.next_out-c,u=N1.buf2string(r.output,c);r.next_out=d,r.avail_out=n-d,d&&r.output.set(r.output.subarray(c,c+d),0),this.onData(u)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(i===_1&&l===0)){if(i===WA)return i=df.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};fw.prototype.onData=function(e){this.chunks.push(e)};fw.prototype.onEnd=function(e){e===_1&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n5.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function _M(e,t){const r=new fw(t);if(r.push(e),r.err)throw r.msg||Lx[r.err];return r.result}function UXe(e,t){return t=t||{},t.raw=!0,_M(e,t)}var VXe=fw,WXe=_M,HXe=UXe,GXe=_M,KXe=dw,YXe={Inflate:VXe,inflate:WXe,inflateRaw:HXe,ungzip:GXe,constants:KXe};const{Inflate:XXe,inflate:JXe,inflateRaw:Qst,ungzip:Zst}=YXe;var Dz=XXe,QXe=JXe;const rne=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;rne[e]=t}const Mz=4294967295;function ZXe(e,t,r){let n=e;for(let a=0;a<r;a++)n=rne[(n^t[a])&255]^n>>>8;return n}function eJe(e,t){return(ZXe(Mz,e,t)^Mz)>>>0}function Rz(e,t,r){const n=e.readUint32(),a=eJe(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(a!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${a}`)}function nne(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function ane(e,t,r,n){let a=0;for(;a<n;a++)t[a]=e[a];for(;a<r;a++)t[a]=e[a]+t[a-n]&255}function one(e,t,r,n){let a=0;if(r.length===0)for(;a<n;a++)t[a]=e[a];else for(;a<n;a++)t[a]=e[a]+r[a]&255}function ine(e,t,r,n,a){let i=0;if(r.length===0){for(;i<a;i++)t[i]=e[i];for(;i<n;i++)t[i]=e[i]+(t[i-a]>>1)&255}else{for(;i<a;i++)t[i]=e[i]+(r[i]>>1)&255;for(;i<n;i++)t[i]=e[i]+(t[i-a]+r[i]>>1)&255}}function sne(e,t,r,n,a){let i=0;if(r.length===0){for(;i<a;i++)t[i]=e[i];for(;i<n;i++)t[i]=e[i]+t[i-a]&255}else{for(;i<a;i++)t[i]=e[i]+r[i]&255;for(;i<n;i++)t[i]=e[i]+tJe(t[i-a],r[i],r[i-a])&255}}function tJe(e,t,r){const n=e+t-r,a=Math.abs(n-e),i=Math.abs(n-t),s=Math.abs(n-r);return a<=i&&a<=s?e:i<=s?t:r}function rJe(e,t,r,n,a,i){switch(e){case 0:nne(t,r,a);break;case 1:ane(t,r,a,i);break;case 2:one(t,r,n,a);break;case 3:ine(t,r,n,a,i);break;case 4:sne(t,r,n,a,i);break;default:throw new Error(`Unsupported filter: ${e}`)}}const nJe=new Uint16Array([255]),aJe=new Uint8Array(nJe.buffer),oJe=aJe[0]===255;function iJe(e){const{data:t,width:r,height:n,channels:a,depth:i}=e,s=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(i/8)*a,c=new Uint8Array(n*r*l);let d=0;for(let u=0;u<7;u++){const f=s[u],m=Math.ceil((r-f.x)/f.xStep),h=Math.ceil((n-f.y)/f.yStep);if(m<=0||h<=0)continue;const v=m*l,g=new Uint8Array(v);for(let y=0;y<h;y++){const x=t[d++],b=t.subarray(d,d+v);d+=v;const w=new Uint8Array(v);rJe(x,b,w,g,v,l),g.set(w);for(let j=0;j<m;j++){const _=f.x+j*f.xStep,C=f.y+y*f.yStep;if(!(_>=r||C>=n))for(let E=0;E<l;E++)c[(C*r+_)*l+E]=w[j*l+E]}}}if(i===16){const u=new Uint16Array(c.buffer);if(oJe)for(let f=0;f<u.length;f++)u[f]=sJe(u[f]);return u}else return c}function sJe(e){return(e&255)<<8|e>>8&255}const lJe=new Uint16Array([255]),cJe=new Uint8Array(lJe.buffer),dJe=cJe[0]===255,uJe=new Uint8Array(0);function Lz(e){const{data:t,width:r,height:n,channels:a,depth:i}=e,s=Math.ceil(i/8)*a,l=Math.ceil(i/8*a*r),c=new Uint8Array(n*l);let d=uJe,u=0,f,m;for(let h=0;h<n;h++){switch(f=t.subarray(u+1,u+1+l),m=c.subarray(h*l,(h+1)*l),t[u]){case 0:nne(f,m,l);break;case 1:ane(f,m,l,s);break;case 2:one(f,m,d,l);break;case 3:ine(f,m,d,l,s);break;case 4:sne(f,m,d,l,s);break;default:throw new Error(`Unsupported filter: ${t[u]}`)}d=m,u+=l+1}if(i===16){const h=new Uint16Array(c.buffer);if(dJe)for(let v=0;v<h.length;v++)h[v]=fJe(h[v]);return h}else return c}function fJe(e){return(e&255)<<8|e>>8&255}const Cj=Uint8Array.of(137,80,78,71,13,10,26,10);function $z(e){if(!mJe(e.readBytes(Cj.length)))throw new Error("wrong PNG signature")}function mJe(e){if(e.length<Cj.length)return!1;for(let t=0;t<Cj.length;t++)if(e[t]!==Cj[t])return!1;return!0}const hJe="tEXt",pJe=0,lne=new TextDecoder("latin1");function gJe(e){if(xJe(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const vJe=/^[\u0000-\u00FF]*$/;function xJe(e){if(!vJe.test(e))throw new Error("invalid latin1 text")}function yJe(e,t,r){const n=cne(t);e[n]=bJe(t,r-n.length-1)}function cne(e){for(e.mark();e.readByte()!==pJe;);const t=e.offset;e.reset();const r=lne.decode(e.readBytes(t-e.offset-1));return e.skip(1),gJe(r),r}function bJe(e,t){return lne.decode(e.readBytes(t))}const Jl={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},GA={UNKNOWN:-1,DEFLATE:0},Fz={UNKNOWN:-1,ADAPTIVE:0},KA={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},F2={NONE:0,BACKGROUND:1,PREVIOUS:2},YA={SOURCE:0,OVER:1};class wJe extends vM{constructor(r,n={}){super(r);ro(this,"_checkCrc");ro(this,"_inflator");ro(this,"_png");ro(this,"_apng");ro(this,"_end");ro(this,"_hasPalette");ro(this,"_palette");ro(this,"_hasTransparency");ro(this,"_transparency");ro(this,"_compressionMethod");ro(this,"_filterMethod");ro(this,"_interlaceMethod");ro(this,"_colorType");ro(this,"_isAnimated");ro(this,"_numberOfFrames");ro(this,"_numberOfPlays");ro(this,"_frames");ro(this,"_writingDataChunks");const{checkCrc:a=!1}=n;this._checkCrc=a,this._inflator=new Dz,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=GA.UNKNOWN,this._filterMethod=Fz.UNKNOWN,this._interlaceMethod=KA.UNKNOWN,this._colorType=Jl.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for($z(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for($z(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const a=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case hJe:yJe(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?Rz(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const a=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=a+r;break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?Rz(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=jJe(this.readUint8());const n=this.readUint8();this._colorType=n;let a;switch(n){case Jl.GREYSCALE:a=1;break;case Jl.TRUECOLOUR:a=3;break;case Jl.INDEXED_COLOUR:a=1;break;case Jl.GREYSCALE_ALPHA:a=2;break;case Jl.TRUECOLOUR_ALPHA:a=4;break;case Jl.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==GA.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const a=[];this._palette=a;for(let i=0;i<n;i++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,a=this.offset+this.byteOffset;if(a+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case Jl.GREYSCALE:case Jl.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case Jl.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const a=this.readByte();this._palette[n].push(a)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case Jl.UNKNOWN:case Jl.GREYSCALE_ALPHA:case Jl.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=cne(this),a=this.readUint8();if(a!==GA.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const i=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:QXe(i)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),a=this.readByte();this._png.resolution={x:r,y:n,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(r);if(a){if(a.data=Lz({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)n.data=a.data;else{const i=this._apng.frames.at(r-1);this.disposeFrame(a,i,n),this.addFrameDataToCanvas(n,a)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,a){switch(r.disposeOp){case F2.NONE:break;case F2.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let s=0;s<this._png.width;s++){const l=(i*r.width+s)*this._png.channels;for(let c=0;c<this._png.channels;c++)a.data[l+c]=0}break;case F2.PREVIOUS:a.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const a=1<<this._png.depth,i=(s,l)=>{const c=((s+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,d=(s*n.width+l)*this._png.channels;return{index:c,frameIndex:d}};switch(n.blendOp){case YA.SOURCE:for(let s=0;s<n.height;s++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:d}=i(s,l);for(let u=0;u<this._png.channels;u++)r.data[c+u]=n.data[d+u]}break;case YA.OVER:for(let s=0;s<n.height;s++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:d}=i(s,l);for(let u=0;u<this._png.channels;u++){const f=n.data[d+this._png.channels-1]/a,m=u%(this._png.channels-1)===0?1:n.data[d+u],h=Math.floor(f*m+(1-f)*r.data[c+u]);r.data[c+u]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==Fz.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===KA.NO_INTERLACE)this._png.data=Lz({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===KA.ADAM7)this._png.data=iJe({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:F2.NONE,blendOp:YA.SOURCE,data:r}),this._inflator=new Dz,this._writingDataChunks=!1}}function jJe(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var Bz;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(Bz||(Bz={}));function NJe(e,t){return new wJe(e,t).decode()}var Jn=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function XA(){Jn.console&&typeof Jn.console.log=="function"&&Jn.console.log.apply(Jn.console,arguments)}var ho={log:XA,warn:function(e){Jn.console&&(typeof Jn.console.warn=="function"?Jn.console.warn.apply(Jn.console,arguments):XA.call(null,arguments))},error:function(e){Jn.console&&(typeof Jn.console.error=="function"?Jn.console.error.apply(Jn.console,arguments):XA(e))}};function JA(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){ep(n.response,t,r)},n.onerror=function(){ho.error("could not download file")},n.send()}function qz(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function B2(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var ep=Jn.saveAs||((typeof window>"u"?"undefined":Pa(window))!=="object"||window!==Jn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=Jn.URL||Jn.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener",typeof e=="string"?(a.href=e,a.origin!==location.origin?qz(a.href)?JA(e,t,r):B2(a,a.target="_blank"):B2(a)):(a.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){B2(a)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(qz(e))JA(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){B2(n)})}else navigator.msSaveOrOpenBlob(function(a,i){return i===void 0?i={autoBom:!1}:Pa(i)!=="object"&&(ho.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob([String.fromCharCode(65279),a],{type:a.type}):a}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return JA(e,t,r);var a=e.type==="application/octet-stream",i=/constructor/i.test(Jn.HTMLElement)||Jn.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||a&&i)&&(typeof FileReader>"u"?"undefined":Pa(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var u=l.result;u=s?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},l.readAsDataURL(e)}else{var c=Jn.URL||Jn.webkitURL,d=c.createObjectURL(e);n?n.location=d:location.href=d,n=null,setTimeout(function(){c.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function dne(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var a=r[n].re,i=r[n].process,s=a.exec(e);s&&(t=i(s),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),d=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),"#"+l+c+d}}var Pj=Jn.atob.bind(Jn),zz=Jn.btoa.bind(Jn);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function QA(e,t){var r=e[0],n=e[1],a=e[2],i=e[3];r=Ts(r,n,a,i,t[0],7,-680876936),i=Ts(i,r,n,a,t[1],12,-389564586),a=Ts(a,i,r,n,t[2],17,606105819),n=Ts(n,a,i,r,t[3],22,-1044525330),r=Ts(r,n,a,i,t[4],7,-176418897),i=Ts(i,r,n,a,t[5],12,1200080426),a=Ts(a,i,r,n,t[6],17,-1473231341),n=Ts(n,a,i,r,t[7],22,-45705983),r=Ts(r,n,a,i,t[8],7,1770035416),i=Ts(i,r,n,a,t[9],12,-1958414417),a=Ts(a,i,r,n,t[10],17,-42063),n=Ts(n,a,i,r,t[11],22,-1990404162),r=Ts(r,n,a,i,t[12],7,1804603682),i=Ts(i,r,n,a,t[13],12,-40341101),a=Ts(a,i,r,n,t[14],17,-1502002290),r=Ds(r,n=Ts(n,a,i,r,t[15],22,1236535329),a,i,t[1],5,-165796510),i=Ds(i,r,n,a,t[6],9,-1069501632),a=Ds(a,i,r,n,t[11],14,643717713),n=Ds(n,a,i,r,t[0],20,-373897302),r=Ds(r,n,a,i,t[5],5,-701558691),i=Ds(i,r,n,a,t[10],9,38016083),a=Ds(a,i,r,n,t[15],14,-660478335),n=Ds(n,a,i,r,t[4],20,-405537848),r=Ds(r,n,a,i,t[9],5,568446438),i=Ds(i,r,n,a,t[14],9,-1019803690),a=Ds(a,i,r,n,t[3],14,-187363961),n=Ds(n,a,i,r,t[8],20,1163531501),r=Ds(r,n,a,i,t[13],5,-1444681467),i=Ds(i,r,n,a,t[2],9,-51403784),a=Ds(a,i,r,n,t[7],14,1735328473),r=Ms(r,n=Ds(n,a,i,r,t[12],20,-1926607734),a,i,t[5],4,-378558),i=Ms(i,r,n,a,t[8],11,-2022574463),a=Ms(a,i,r,n,t[11],16,1839030562),n=Ms(n,a,i,r,t[14],23,-35309556),r=Ms(r,n,a,i,t[1],4,-1530992060),i=Ms(i,r,n,a,t[4],11,1272893353),a=Ms(a,i,r,n,t[7],16,-155497632),n=Ms(n,a,i,r,t[10],23,-1094730640),r=Ms(r,n,a,i,t[13],4,681279174),i=Ms(i,r,n,a,t[0],11,-358537222),a=Ms(a,i,r,n,t[3],16,-722521979),n=Ms(n,a,i,r,t[6],23,76029189),r=Ms(r,n,a,i,t[9],4,-640364487),i=Ms(i,r,n,a,t[12],11,-421815835),a=Ms(a,i,r,n,t[15],16,530742520),r=Rs(r,n=Ms(n,a,i,r,t[2],23,-995338651),a,i,t[0],6,-198630844),i=Rs(i,r,n,a,t[7],10,1126891415),a=Rs(a,i,r,n,t[14],15,-1416354905),n=Rs(n,a,i,r,t[5],21,-57434055),r=Rs(r,n,a,i,t[12],6,1700485571),i=Rs(i,r,n,a,t[3],10,-1894986606),a=Rs(a,i,r,n,t[10],15,-1051523),n=Rs(n,a,i,r,t[1],21,-2054922799),r=Rs(r,n,a,i,t[8],6,1873313359),i=Rs(i,r,n,a,t[15],10,-30611744),a=Rs(a,i,r,n,t[6],15,-1560198380),n=Rs(n,a,i,r,t[13],21,1309151649),r=Rs(r,n,a,i,t[4],6,-145523070),i=Rs(i,r,n,a,t[11],10,-1120210379),a=Rs(a,i,r,n,t[2],15,718787259),n=Rs(n,a,i,r,t[9],21,-343485551),e[0]=Im(r,e[0]),e[1]=Im(n,e[1]),e[2]=Im(a,e[2]),e[3]=Im(i,e[3])}function o5(e,t,r,n,a,i){return t=Im(Im(t,e),Im(n,i)),Im(t<<a|t>>>32-a,r)}function Ts(e,t,r,n,a,i,s){return o5(t&r|~t&n,e,t,a,i,s)}function Ds(e,t,r,n,a,i,s){return o5(t&n|r&~n,e,t,a,i,s)}function Ms(e,t,r,n,a,i,s){return o5(t^r^n,e,t,a,i,s)}function Rs(e,t,r,n,a,i,s){return o5(r^(t|~n),e,t,a,i,s)}function une(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)QA(n,_Je(e.substring(t-64,t)));e=e.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(QA(n,a),t=0;t<16;t++)a[t]=0;return a[14]=8*r,QA(n,a),n}function _Je(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var Uz="0123456789abcdef".split("");function SJe(e){for(var t="",r=0;r<4;r++)t+=Uz[e>>8*r+4&15]+Uz[e>>8*r&15];return t}function CJe(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function c4(e){return une(e).map(CJe).join("")}var PJe=function(e){for(var t=0;t<e.length;t++)e[t]=SJe(e[t]);return e.join("")}(une("hello"))!="5d41402abc4b2a76b9719d911017c592";function Im(e,t){if(PJe){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function d4(e,t){var r,n,a,i;if(e!==r){for(var s=(a=e,i=1+(256/e.length|0),new Array(i+1).join(a)),l=[],c=0;c<256;c++)l[c]=c;var d=0;for(c=0;c<256;c++){var u=l[c];d=(d+u+s.charCodeAt(c))%256,l[c]=l[d],l[d]=u}r=e,n=l}else l=n;var f=t.length,m=0,h=0,v="";for(c=0;c<f;c++)h=(h+(u=l[m=(m+1)%256]))%256,l[m]=l[h],l[h]=u,s=l[(l[m]+l[h])%256],v+=String.fromCharCode(t.charCodeAt(c)^s);return v}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Vz={print:4,modify:8,copy:16,"annot-forms":32};function rv(e,t,r,n){this.v=1,this.r=2;var a=192;e.forEach(function(l){if(Vz.perm!==void 0)throw new Error("Invalid permission: "+l);a+=Vz[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(t+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,s),this.P=-(1+(255^a)),this.encryptionKey=c4(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=d4(this.encryptionKey,this.padding)}function nv(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var a=e.charCodeAt(n);t+=a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?"#"+("0"+a.toString(16)).slice(-2):e[n]}return t}function Wz(e){if(Pa(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,a){if(a=a||!1,typeof r!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var i=Math.random().toString(35);return t[r][i]=[n,!!a],i},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var i in t[r]){var s=t[r][i];try{s[0].apply(e,n)}catch(l){Jn.console&&ho.error("jsPDF PubSub Error",l.message,l)}s[1]&&a.push(i)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function S1(e){if(!(this instanceof S1))return new S1(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function fne(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function jm(e,t,r,n,a){if(!(this instanceof jm))return new jm(e,t,r,n,a);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,fne.call(this,n,a)}function jp(e,t,r,n,a){if(!(this instanceof jp))return new jp(e,t,r,n,a);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,fne.call(this,n,a)}function Nn(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],i=arguments[3],s=[],l=1,c=16,d="S",u=null;Pa(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,a=e.format||a,i=e.compress||e.compressPdf||i,(u=e.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),l=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),d=e.defaultPathOperation||"S"),s=e.filters||(i===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=e.putOnlyUsedFonts||!1,m={},h={internal:{},__private__:{}};h.__private__.PubSub=Wz;var v="1.3",g=h.__private__.getPdfVersion=function(){return v};h.__private__.setPdfVersion=function(O){v=O};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return y};var x=h.__private__.getPageFormat=function(O){return y[O]};a=a||"a4";var b="compat",w="advanced",j=b;function _(){this.saveGraphicsState(),ee(new Qt($e,0,0,-$e,0,ir()*$e).toString()+" cm"),this.setFontSize(this.getFontSize()/$e),d="n",j=w}function C(){this.restoreGraphicsState(),d="S",j=b}var E=h.__private__.combineFontStyleAndFontWeight=function(O,F){if(O=="bold"&&F=="normal"||O=="bold"&&F==400||O=="normal"&&F=="italic"||O=="bold"&&F=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return F&&(O=F==400||F==="normal"?O==="italic"?"italic":"normal":F!=700&&F!=="bold"||O!=="normal"?(F==700?"bold":F)+""+O:"bold"),O};h.advancedAPI=function(O){var F=j===b;return F&&_.call(this),typeof O!="function"||(O(this),F&&C.call(this)),this},h.compatAPI=function(O){var F=j===w;return F&&C.call(this),typeof O!="function"||(O(this),F&&_.call(this)),this},h.isAdvancedAPI=function(){return j===w};var P,k=function(O){if(j!==w)throw new Error(O+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},M=h.roundToPrecision=h.__private__.roundToPrecision=function(O,F){var fe=t||F;if(isNaN(O)||isNaN(fe))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return O.toFixed(fe).replace(/0+$/,"")};P=h.hpf=h.__private__.hpf=typeof c=="number"?function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.hpf");return M(O,c)}:c==="smart"?function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.hpf");return M(O,O>-1&&O<1?16:5)}:function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.hpf");return M(O,16)};var S=h.f2=h.__private__.f2=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.f2");return M(O,2)},I=h.__private__.f3=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.f3");return M(O,3)},T=h.scale=h.__private__.scale=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.scale");return j===b?O*$e:j===w?O:void 0},D=function(O){return T(function(F){return j===b?ir()-F:j===w?F:void 0}(O))};h.__private__.setPrecision=h.setPrecision=function(O){typeof parseInt(O,10)=="number"&&(t=parseInt(O,10))};var B,U="00000000000000000000000000000000",z=h.__private__.getFileId=function(){return U},$=h.__private__.setFileId=function(O){return U=O!==void 0&&/^[a-fA-F0-9]{32}$/.test(O)?O.toUpperCase():U.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(ze=new rv(u.userPermissions,u.userPassword,u.ownerPassword,U)),U};h.setFileId=function(O){return $(O),this},h.getFileId=function(){return z()};var Y=h.__private__.convertDateToPDFDate=function(O){var F=O.getTimezoneOffset(),fe=F<0?"+":"-",we=Math.floor(Math.abs(F/60)),Re=Math.abs(F%60),Je=[fe,W(we),"'",W(Re),"'"].join("");return["D:",O.getFullYear(),W(O.getMonth()+1),W(O.getDate()),W(O.getHours()),W(O.getMinutes()),W(O.getSeconds()),Je].join("")},de=h.__private__.convertPDFDateToDate=function(O){var F=parseInt(O.substr(2,4),10),fe=parseInt(O.substr(6,2),10)-1,we=parseInt(O.substr(8,2),10),Re=parseInt(O.substr(10,2),10),Je=parseInt(O.substr(12,2),10),He=parseInt(O.substr(14,2),10);return new Date(F,fe,we,Re,Je,He,0)},xe=h.__private__.setCreationDate=function(O){var F;if(O===void 0&&(O=new Date),O instanceof Date)F=Y(O);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(O))throw new Error("Invalid argument passed to jsPDF.setCreationDate");F=O}return B=F},q=h.__private__.getCreationDate=function(O){var F=B;return O==="jsDate"&&(F=de(B)),F};h.setCreationDate=function(O){return xe(O),this},h.getCreationDate=function(O){return q(O)};var L,W=h.__private__.padd2=function(O){return("0"+parseInt(O)).slice(-2)},ne=h.__private__.padd2Hex=function(O){return("00"+(O=O.toString())).substr(O.length)},le=0,K=[],Q=[],re=0,G=[],me=[],pe=!1,Be=Q;h.__private__.setCustomOutputDestination=function(O){pe=!0,Be=O};var Z=function(O){pe||(Be=O)};h.__private__.resetCustomOutputDestination=function(){pe=!1,Be=Q};var ee=h.__private__.out=function(O){return O=O.toString(),re+=O.length+1,Be.push(O),Be},kt=h.__private__.write=function(O){return ee(arguments.length===1?O.toString():Array.prototype.join.call(arguments," "))},Nt=h.__private__.getArrayBuffer=function(O){for(var F=O.length,fe=new ArrayBuffer(F),we=new Uint8Array(fe);F--;)we[F]=O.charCodeAt(F);return fe},De=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return De};var st=e.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(O){return st=j===w?O/$e:O,this};var ft,yt=h.__private__.getFontSize=h.getFontSize=function(){return j===b?st:st*$e},Nr=e.R2L||!1;h.__private__.setR2L=h.setR2L=function(O){return Nr=O,this},h.__private__.getR2L=h.getR2L=function(){return Nr};var se,rt=h.__private__.setZoomMode=function(O){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(O))ft=O;else if(isNaN(O)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(O)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+O+'" is not recognized.');ft=O}else ft=parseInt(O,10)};h.__private__.getZoomMode=function(){return ft};var mt,tr=h.__private__.setPageMode=function(O){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(O)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+O+'" is not recognized.');se=O};h.__private__.getPageMode=function(){return se};var Ce=h.__private__.setLayoutMode=function(O){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(O)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+O+'" is not recognized.');mt=O};h.__private__.getLayoutMode=function(){return mt},h.__private__.setDisplayMode=h.setDisplayMode=function(O,F,fe){return rt(O),Ce(F),tr(fe),this};var je={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(O){if(Object.keys(je).indexOf(O)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return je[O]},h.__private__.getDocumentProperties=function(){return je},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(O){for(var F in je)je.hasOwnProperty(F)&&O[F]&&(je[F]=O[F]);return this},h.__private__.setDocumentProperty=function(O,F){if(Object.keys(je).indexOf(O)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return je[O]=F};var ae,$e,Ae,Tt,Se,Ne={},Ue={},Qe=[],et={},pt={},Ke={},qt={},lt=null,rr=0,nt=[],$t=new Wz(h),Qr=e.hotfixes||[],Xr={},In={},sn=[],Qt=function O(F,fe,we,Re,Je,He){if(!(this instanceof O))return new O(F,fe,we,Re,Je,He);isNaN(F)&&(F=1),isNaN(fe)&&(fe=0),isNaN(we)&&(we=0),isNaN(Re)&&(Re=1),isNaN(Je)&&(Je=0),isNaN(He)&&(He=0),this._matrix=[F,fe,we,Re,Je,He]};Object.defineProperty(Qt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(O){this._matrix[0]=O}}),Object.defineProperty(Qt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(O){this._matrix[1]=O}}),Object.defineProperty(Qt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(O){this._matrix[2]=O}}),Object.defineProperty(Qt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(O){this._matrix[3]=O}}),Object.defineProperty(Qt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(O){this._matrix[4]=O}}),Object.defineProperty(Qt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(O){this._matrix[5]=O}}),Object.defineProperty(Qt.prototype,"a",{get:function(){return this._matrix[0]},set:function(O){this._matrix[0]=O}}),Object.defineProperty(Qt.prototype,"b",{get:function(){return this._matrix[1]},set:function(O){this._matrix[1]=O}}),Object.defineProperty(Qt.prototype,"c",{get:function(){return this._matrix[2]},set:function(O){this._matrix[2]=O}}),Object.defineProperty(Qt.prototype,"d",{get:function(){return this._matrix[3]},set:function(O){this._matrix[3]=O}}),Object.defineProperty(Qt.prototype,"e",{get:function(){return this._matrix[4]},set:function(O){this._matrix[4]=O}}),Object.defineProperty(Qt.prototype,"f",{get:function(){return this._matrix[5]},set:function(O){this._matrix[5]=O}}),Object.defineProperty(Qt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Qt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Qt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Qt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Qt.prototype.join=function(O){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(P).join(O)},Qt.prototype.multiply=function(O){var F=O.sx*this.sx+O.shy*this.shx,fe=O.sx*this.shy+O.shy*this.sy,we=O.shx*this.sx+O.sy*this.shx,Re=O.shx*this.shy+O.sy*this.sy,Je=O.tx*this.sx+O.ty*this.shx+this.tx,He=O.tx*this.shy+O.ty*this.sy+this.ty;return new Qt(F,fe,we,Re,Je,He)},Qt.prototype.decompose=function(){var O=this.sx,F=this.shy,fe=this.shx,we=this.sy,Re=this.tx,Je=this.ty,He=Math.sqrt(O*O+F*F),Et=(O/=He)*fe+(F/=He)*we;fe-=O*Et,we-=F*Et;var Xt=Math.sqrt(fe*fe+we*we);return Et/=Xt,O*(we/=Xt)<F*(fe/=Xt)&&(O=-O,F=-F,Et=-Et,He=-He),{scale:new Qt(He,0,0,Xt,0,0),translate:new Qt(1,0,0,1,Re,Je),rotate:new Qt(O,F,-F,O,0,0),skew:new Qt(1,0,Et,1,0,0)}},Qt.prototype.toString=function(O){return this.join(" ")},Qt.prototype.inversed=function(){var O=this.sx,F=this.shy,fe=this.shx,we=this.sy,Re=this.tx,Je=this.ty,He=1/(O*we-F*fe),Et=we*He,Xt=-F*He,jt=-fe*He,Rt=O*He;return new Qt(Et,Xt,jt,Rt,-Et*Re-jt*Je,-Xt*Re-Rt*Je)},Qt.prototype.applyToPoint=function(O){var F=O.x*this.sx+O.y*this.shx+this.tx,fe=O.x*this.shy+O.y*this.sy+this.ty;return new It(F,fe)},Qt.prototype.applyToRectangle=function(O){var F=this.applyToPoint(O),fe=this.applyToPoint(new It(O.x+O.w,O.y+O.h));return new Ir(F.x,F.y,fe.x-F.x,fe.y-F.y)},Qt.prototype.clone=function(){var O=this.sx,F=this.shy,fe=this.shx,we=this.sy,Re=this.tx,Je=this.ty;return new Qt(O,F,fe,we,Re,Je)},h.Matrix=Qt;var qr=h.matrixMult=function(O,F){return F.multiply(O)},Tr=new Qt(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=Tr;var sr=function(O,F){if(!pt[O]){var fe=(F instanceof jm?"Sh":"P")+(Object.keys(et).length+1).toString(10);F.id=fe,pt[O]=fe,et[fe]=F,$t.publish("addPattern",F)}};h.ShadingPattern=jm,h.TilingPattern=jp,h.addShadingPattern=function(O,F){return k("addShadingPattern()"),sr(O,F),this},h.beginTilingPattern=function(O){k("beginTilingPattern()"),be(O.boundingBox[0],O.boundingBox[1],O.boundingBox[2]-O.boundingBox[0],O.boundingBox[3]-O.boundingBox[1],O.matrix)},h.endTilingPattern=function(O,F){k("endTilingPattern()"),F.stream=me[L].join(`
`),sr(O,F),$t.publish("endTilingPattern",F),sn.pop().restore()};var $r,Gr=h.__private__.newObject=function(){var O=ke();return Mt(O,!0),O},ke=h.__private__.newObjectDeferred=function(){return le++,K[le]=function(){return re},le},Mt=function(O,F){return F=typeof F=="boolean"&&F,K[O]=re,F&&ee(O+" 0 obj"),O},wr=h.__private__.newAdditionalObject=function(){var O={objId:ke(),content:""};return G.push(O),O},Fr=ke(),Ur=ke(),Kr=h.__private__.decodeColorString=function(O){var F=O.split(" ");if(F.length!==2||F[1]!=="g"&&F[1]!=="G")F.length!==5||F[4]!=="k"&&F[4]!=="K"||(F=[(1-F[0])*(1-F[3]),(1-F[1])*(1-F[3]),(1-F[2])*(1-F[3]),"r"]);else{var fe=parseFloat(F[0]);F=[fe,fe,fe,"r"]}for(var we="#",Re=0;Re<3;Re++)we+=("0"+Math.floor(255*parseFloat(F[Re])).toString(16)).slice(-2);return we},dn=h.__private__.encodeColorString=function(O){var F;typeof O=="string"&&(O={ch1:O});var fe=O.ch1,we=O.ch2,Re=O.ch3,Je=O.ch4,He=O.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof fe=="string"&&fe.charAt(0)!=="#"){var Et=new dne(fe);if(Et.ok)fe=Et.toHex();else if(!/^\d*\.?\d*$/.test(fe))throw new Error('Invalid color "'+fe+'" passed to jsPDF.encodeColorString.')}if(typeof fe=="string"&&/^#[0-9A-Fa-f]{3}$/.test(fe)&&(fe="#"+fe[1]+fe[1]+fe[2]+fe[2]+fe[3]+fe[3]),typeof fe=="string"&&/^#[0-9A-Fa-f]{6}$/.test(fe)){var Xt=parseInt(fe.substr(1),16);fe=Xt>>16&255,we=Xt>>8&255,Re=255&Xt}if(we===void 0||Je===void 0&&fe===we&&we===Re)F=typeof fe=="string"?fe+" "+He[0]:O.precision===2?S(fe/255)+" "+He[0]:I(fe/255)+" "+He[0];else if(Je===void 0||Pa(Je)==="object"){if(Je&&!isNaN(Je.a)&&Je.a===0)return["1.","1.","1.",He[1]].join(" ");F=typeof fe=="string"?[fe,we,Re,He[1]].join(" "):O.precision===2?[S(fe/255),S(we/255),S(Re/255),He[1]].join(" "):[I(fe/255),I(we/255),I(Re/255),He[1]].join(" ")}else F=typeof fe=="string"?[fe,we,Re,Je,He[2]].join(" "):O.precision===2?[S(fe),S(we),S(Re),S(Je),He[2]].join(" "):[I(fe),I(we),I(Re),I(Je),He[2]].join(" ");return F},wn=h.__private__.getFilters=function(){return s},va=h.__private__.putStream=function(O){var F=(O=O||{}).data||"",fe=O.filters||wn(),we=O.alreadyAppliedFilters||[],Re=O.addLength1||!1,Je=F.length,He=O.objectId,Et=function(Vr){return Vr};if(u!==null&&He===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(Et=ze.encryptor(He,0));var Xt={};fe===!0&&(fe=["FlateEncode"]);var jt=O.additionalKeyValues||[],Rt=(Xt=Nn.API.processDataByFilters!==void 0?Nn.API.processDataByFilters(F,fe):{data:F,reverseChain:[]}).reverseChain+(Array.isArray(we)?we.join(" "):we.toString());if(Xt.data.length!==0&&(jt.push({key:"Length",value:Xt.data.length}),Re===!0&&jt.push({key:"Length1",value:Je})),Rt.length!=0)if(Rt.split("/").length-1==1)jt.push({key:"Filter",value:Rt});else{jt.push({key:"Filter",value:"["+Rt+"]"});for(var ar=0;ar<jt.length;ar+=1)if(jt[ar].key==="DecodeParms"){for(var pr=[],Wr=0;Wr<Xt.reverseChain.split("/").length-1;Wr+=1)pr.push("null");pr.push(jt[ar].value),jt[ar].value="["+pr.join(" ")+"]"}}ee("<<");for(var Pr=0;Pr<jt.length;Pr++)ee("/"+jt[Pr].key+" "+jt[Pr].value);ee(">>"),Xt.data.length!==0&&(ee("stream"),ee(Et(Xt.data)),ee("endstream"))},xa=h.__private__.putPage=function(O){var F=O.number,fe=O.data,we=O.objId,Re=O.contentsObjId;Mt(we,!0),ee("<</Type /Page"),ee("/Parent "+O.rootDictionaryObjId+" 0 R"),ee("/Resources "+O.resourceDictionaryObjId+" 0 R"),ee("/MediaBox ["+parseFloat(P(O.mediaBox.bottomLeftX))+" "+parseFloat(P(O.mediaBox.bottomLeftY))+" "+P(O.mediaBox.topRightX)+" "+P(O.mediaBox.topRightY)+"]"),O.cropBox!==null&&ee("/CropBox ["+P(O.cropBox.bottomLeftX)+" "+P(O.cropBox.bottomLeftY)+" "+P(O.cropBox.topRightX)+" "+P(O.cropBox.topRightY)+"]"),O.bleedBox!==null&&ee("/BleedBox ["+P(O.bleedBox.bottomLeftX)+" "+P(O.bleedBox.bottomLeftY)+" "+P(O.bleedBox.topRightX)+" "+P(O.bleedBox.topRightY)+"]"),O.trimBox!==null&&ee("/TrimBox ["+P(O.trimBox.bottomLeftX)+" "+P(O.trimBox.bottomLeftY)+" "+P(O.trimBox.topRightX)+" "+P(O.trimBox.topRightY)+"]"),O.artBox!==null&&ee("/ArtBox ["+P(O.artBox.bottomLeftX)+" "+P(O.artBox.bottomLeftY)+" "+P(O.artBox.topRightX)+" "+P(O.artBox.topRightY)+"]"),typeof O.userUnit=="number"&&O.userUnit!==1&&ee("/UserUnit "+O.userUnit),$t.publish("putPage",{objId:we,pageContext:nt[F],pageNumber:F,page:fe}),ee("/Contents "+Re+" 0 R"),ee(">>"),ee("endobj");var Je=fe.join(`
`);return j===w&&(Je+=`
Q`),Mt(Re,!0),va({data:Je,filters:wn(),objectId:Re}),ee("endobj"),we},Aa=h.__private__.putPages=function(){var O,F,fe=[];for(O=1;O<=rr;O++)nt[O].objId=ke(),nt[O].contentsObjId=ke();for(O=1;O<=rr;O++)fe.push(xa({number:O,data:me[O],objId:nt[O].objId,contentsObjId:nt[O].contentsObjId,mediaBox:nt[O].mediaBox,cropBox:nt[O].cropBox,bleedBox:nt[O].bleedBox,trimBox:nt[O].trimBox,artBox:nt[O].artBox,userUnit:nt[O].userUnit,rootDictionaryObjId:Fr,resourceDictionaryObjId:Ur}));Mt(Fr,!0),ee("<</Type /Pages");var we="/Kids [";for(F=0;F<rr;F++)we+=fe[F]+" 0 R ";ee(we+"]"),ee("/Count "+rr),ee(">>"),ee("endobj"),$t.publish("postPutPages")},ut=function(O){$t.publish("putFont",{font:O,out:ee,newObject:Gr,putStream:va}),O.isAlreadyPutted!==!0&&(O.objectNumber=Gr(),ee("<<"),ee("/Type /Font"),ee("/BaseFont /"+nv(O.postScriptName)),ee("/Subtype /Type1"),typeof O.encoding=="string"&&ee("/Encoding /"+O.encoding),ee("/FirstChar 32"),ee("/LastChar 255"),ee(">>"),ee("endobj"))},Ht=function(O){O.objectNumber=Gr();var F=[];F.push({key:"Type",value:"/XObject"}),F.push({key:"Subtype",value:"/Form"}),F.push({key:"BBox",value:"["+[P(O.x),P(O.y),P(O.x+O.width),P(O.y+O.height)].join(" ")+"]"}),F.push({key:"Matrix",value:"["+O.matrix.toString()+"]"});var fe=O.pages[1].join(`
`);va({data:fe,additionalKeyValues:F,objectId:O.objectNumber}),ee("endobj")},dr=function(O,F){F||(F=21);var fe=Gr(),we=function(He,Et){var Xt,jt=[],Rt=1/(Et-1);for(Xt=0;Xt<1;Xt+=Rt)jt.push(Xt);if(jt.push(1),He[0].offset!=0){var ar={offset:0,color:He[0].color};He.unshift(ar)}if(He[He.length-1].offset!=1){var pr={offset:1,color:He[He.length-1].color};He.push(pr)}for(var Wr="",Pr=0,Vr=0;Vr<jt.length;Vr++){for(Xt=jt[Vr];Xt>He[Pr+1].offset;)Pr++;var Lt=He[Pr].offset,xn=(Xt-Lt)/(He[Pr+1].offset-Lt),Rn=He[Pr].color,Ma=He[Pr+1].color;Wr+=ne(Math.round((1-xn)*Rn[0]+xn*Ma[0]).toString(16))+ne(Math.round((1-xn)*Rn[1]+xn*Ma[1]).toString(16))+ne(Math.round((1-xn)*Rn[2]+xn*Ma[2]).toString(16))}return Wr.trim()}(O.colors,F),Re=[];Re.push({key:"FunctionType",value:"0"}),Re.push({key:"Domain",value:"[0.0 1.0]"}),Re.push({key:"Size",value:"["+F+"]"}),Re.push({key:"BitsPerSample",value:"8"}),Re.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Re.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),va({data:we,additionalKeyValues:Re,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:fe}),ee("endobj"),O.objectNumber=Gr(),ee("<< /ShadingType "+O.type),ee("/ColorSpace /DeviceRGB");var Je="/Coords ["+P(parseFloat(O.coords[0]))+" "+P(parseFloat(O.coords[1]))+" ";O.type===2?Je+=P(parseFloat(O.coords[2]))+" "+P(parseFloat(O.coords[3])):Je+=P(parseFloat(O.coords[2]))+" "+P(parseFloat(O.coords[3]))+" "+P(parseFloat(O.coords[4]))+" "+P(parseFloat(O.coords[5])),ee(Je+="]"),O.matrix&&ee("/Matrix ["+O.matrix.toString()+"]"),ee("/Function "+fe+" 0 R"),ee("/Extend [true true]"),ee(">>"),ee("endobj")},Ft=function(O,F){var fe=ke(),we=Gr();F.push({resourcesOid:fe,objectOid:we}),O.objectNumber=we;var Re=[];Re.push({key:"Type",value:"/Pattern"}),Re.push({key:"PatternType",value:"1"}),Re.push({key:"PaintType",value:"1"}),Re.push({key:"TilingType",value:"1"}),Re.push({key:"BBox",value:"["+O.boundingBox.map(P).join(" ")+"]"}),Re.push({key:"XStep",value:P(O.xStep)}),Re.push({key:"YStep",value:P(O.yStep)}),Re.push({key:"Resources",value:fe+" 0 R"}),O.matrix&&Re.push({key:"Matrix",value:"["+O.matrix.toString()+"]"}),va({data:O.stream,additionalKeyValues:Re,objectId:O.objectNumber}),ee("endobj")},Ot=function(O){for(var F in O.objectNumber=Gr(),ee("<<"),O)switch(F){case"opacity":ee("/ca "+S(O[F]));break;case"stroke-opacity":ee("/CA "+S(O[F]))}ee(">>"),ee("endobj")},Br=function(O){Mt(O.resourcesOid,!0),ee("<<"),ee("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var F in ee("/Font <<"),Ne)Ne.hasOwnProperty(F)&&(f===!1||f===!0&&m.hasOwnProperty(F))&&ee("/"+F+" "+Ne[F].objectNumber+" 0 R");ee(">>")}(),function(){if(Object.keys(et).length>0){for(var F in ee("/Shading <<"),et)et.hasOwnProperty(F)&&et[F]instanceof jm&&et[F].objectNumber>=0&&ee("/"+F+" "+et[F].objectNumber+" 0 R");$t.publish("putShadingPatternDict"),ee(">>")}}(),function(F){if(Object.keys(et).length>0){for(var fe in ee("/Pattern <<"),et)et.hasOwnProperty(fe)&&et[fe]instanceof h.TilingPattern&&et[fe].objectNumber>=0&&et[fe].objectNumber<F&&ee("/"+fe+" "+et[fe].objectNumber+" 0 R");$t.publish("putTilingPatternDict"),ee(">>")}}(O.objectOid),function(){if(Object.keys(Ke).length>0){var F;for(F in ee("/ExtGState <<"),Ke)Ke.hasOwnProperty(F)&&Ke[F].objectNumber>=0&&ee("/"+F+" "+Ke[F].objectNumber+" 0 R");$t.publish("putGStateDict"),ee(">>")}}(),function(){for(var F in ee("/XObject <<"),Xr)Xr.hasOwnProperty(F)&&Xr[F].objectNumber>=0&&ee("/"+F+" "+Xr[F].objectNumber+" 0 R");$t.publish("putXobjectDict"),ee(">>")}(),ee(">>"),ee("endobj")},Vt=function(O){Ue[O.fontName]=Ue[O.fontName]||{},Ue[O.fontName][O.fontStyle]=O.id},Cr=function(O,F,fe,we,Re){var Je={id:"F"+(Object.keys(Ne).length+1).toString(10),postScriptName:O,fontName:F,fontStyle:fe,encoding:we,isStandardFont:Re||!1,metadata:{}};return $t.publish("addFont",{font:Je,instance:this}),Ne[Je.id]=Je,Vt(Je),Je.id},ct=h.__private__.pdfEscape=h.pdfEscape=function(O,F){return function(fe,we){var Re,Je,He,Et,Xt,jt,Rt,ar,pr;if(He=(we=we||{}).sourceEncoding||"Unicode",Xt=we.outputEncoding,(we.autoencode||Xt)&&Ne[ae].metadata&&Ne[ae].metadata[He]&&Ne[ae].metadata[He].encoding&&(Et=Ne[ae].metadata[He].encoding,!Xt&&Ne[ae].encoding&&(Xt=Ne[ae].encoding),!Xt&&Et.codePages&&(Xt=Et.codePages[0]),typeof Xt=="string"&&(Xt=Et[Xt]),Xt)){for(Rt=!1,jt=[],Re=0,Je=fe.length;Re<Je;Re++)(ar=Xt[fe.charCodeAt(Re)])?jt.push(String.fromCharCode(ar)):jt.push(fe[Re]),jt[Re].charCodeAt(0)>>8&&(Rt=!0);fe=jt.join("")}for(Re=fe.length;Rt===void 0&&Re!==0;)fe.charCodeAt(Re-1)>>8&&(Rt=!0),Re--;if(!Rt)return fe;for(jt=we.noBOM?[]:[254,255],Re=0,Je=fe.length;Re<Je;Re++){if((pr=(ar=fe.charCodeAt(Re))>>8)>>8)throw new Error("Character at position "+Re+" of string '"+fe+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");jt.push(pr),jt.push(ar-(pr<<8))}return String.fromCharCode.apply(void 0,jt)}(O,F).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Gt=h.__private__.beginPage=function(O){me[++rr]=[],nt[rr]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(O[0]),topRightY:Number(O[1])}},Ye(rr),Z(me[L])},gr=function(O,F){var fe,we,Re;switch(r=F||r,typeof O=="string"&&(fe=x(O.toLowerCase()),Array.isArray(fe)&&(we=fe[0],Re=fe[1])),Array.isArray(O)&&(we=O[0]*$e,Re=O[1]*$e),isNaN(we)&&(we=a[0],Re=a[1]),(we>14400||Re>14400)&&(ho.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),we=Math.min(14400,we),Re=Math.min(14400,Re)),a=[we,Re],r.substr(0,1)){case"l":Re>we&&(a=[Re,we]);break;case"p":we>Re&&(a=[Re,we])}Gt(a),Ea(ya),ee(ue),er!==0&&ee(er+" J"),jr!==0&&ee(jr+" j"),$t.publish("addPage",{pageNumber:rr})},J=function(O){O>0&&O<=rr&&(me.splice(O,1),nt.splice(O,1),rr--,L>rr&&(L=rr),this.setPage(L))},Ye=function(O){O>0&&O<=rr&&(L=O)},Xe=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return me.length-1},it=function(O,F,fe){var we,Re=void 0;return fe=fe||{},O=O!==void 0?O:Ne[ae].fontName,F=F!==void 0?F:Ne[ae].fontStyle,we=O.toLowerCase(),Ue[we]!==void 0&&Ue[we][F]!==void 0?Re=Ue[we][F]:Ue[O]!==void 0&&Ue[O][F]!==void 0?Re=Ue[O][F]:fe.disableWarning===!1&&ho.warn("Unable to look up font label for font '"+O+"', '"+F+"'. Refer to getFontList() for available fonts."),Re||fe.noFallback||(Re=Ue.times[F])==null&&(Re=Ue.times.normal),Re},Ze=h.__private__.putInfo=function(){var O=Gr(),F=function(we){return we};for(var fe in u!==null&&(F=ze.encryptor(O,0)),ee("<<"),ee("/Producer ("+ct(F("jsPDF "+Nn.version))+")"),je)je.hasOwnProperty(fe)&&je[fe]&&ee("/"+fe.substr(0,1).toUpperCase()+fe.substr(1)+" ("+ct(F(je[fe]))+")");ee("/CreationDate ("+ct(F(B))+")"),ee(">>"),ee("endobj")},dt=h.__private__.putCatalog=function(O){var F=(O=O||{}).rootDictionaryObjId||Fr;switch(Gr(),ee("<<"),ee("/Type /Catalog"),ee("/Pages "+F+" 0 R"),ft||(ft="fullwidth"),ft){case"fullwidth":ee("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ee("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ee("/OpenAction [3 0 R /Fit]");break;case"original":ee("/OpenAction [3 0 R /XYZ null null 1]");break;default:var fe=""+ft;fe.substr(fe.length-1)==="%"&&(ft=parseInt(ft)/100),typeof ft=="number"&&ee("/OpenAction [3 0 R /XYZ null null "+S(ft)+"]")}switch(mt||(mt="continuous"),mt){case"continuous":ee("/PageLayout /OneColumn");break;case"single":ee("/PageLayout /SinglePage");break;case"two":case"twoleft":ee("/PageLayout /TwoColumnLeft");break;case"tworight":ee("/PageLayout /TwoColumnRight")}se&&ee("/PageMode /"+se),$t.publish("putCatalog"),ee(">>"),ee("endobj")},Pt=h.__private__.putTrailer=function(){ee("trailer"),ee("<<"),ee("/Size "+(le+1)),ee("/Root "+le+" 0 R"),ee("/Info "+(le-1)+" 0 R"),u!==null&&ee("/Encrypt "+ze.oid+" 0 R"),ee("/ID [ <"+U+"> <"+U+"> ]"),ee(">>")},zt=h.__private__.putHeader=function(){ee("%PDF-"+v),ee("%")},Er=h.__private__.putXRef=function(){var O="0000000000";ee("xref"),ee("0 "+(le+1)),ee("0000000000 65535 f ");for(var F=1;F<=le;F++)typeof K[F]=="function"?ee((O+K[F]()).slice(-10)+" 00000 n "):K[F]!==void 0?ee((O+K[F]).slice(-10)+" 00000 n "):ee("0000000000 00000 n ")},H=h.__private__.buildDocument=function(){var O;le=0,re=0,Q=[],K=[],G=[],Fr=ke(),Ur=ke(),Z(Q),$t.publish("buildDocument"),zt(),Aa(),function(){$t.publish("putAdditionalObjects");for(var fe=0;fe<G.length;fe++){var we=G[fe];Mt(we.objId,!0),ee(we.content),ee("endobj")}$t.publish("postPutAdditionalObjects")}(),O=[],function(){for(var fe in Ne)Ne.hasOwnProperty(fe)&&(f===!1||f===!0&&m.hasOwnProperty(fe))&&ut(Ne[fe])}(),function(){var fe;for(fe in Ke)Ke.hasOwnProperty(fe)&&Ot(Ke[fe])}(),function(){for(var fe in Xr)Xr.hasOwnProperty(fe)&&Ht(Xr[fe])}(),function(fe){var we;for(we in et)et.hasOwnProperty(we)&&(et[we]instanceof jm?dr(et[we]):et[we]instanceof jp&&Ft(et[we],fe))}(O),$t.publish("putResources"),O.forEach(Br),Br({resourcesOid:Ur,objectOid:Number.MAX_SAFE_INTEGER}),$t.publish("postPutResources"),u!==null&&(ze.oid=Gr(),ee("<<"),ee("/Filter /Standard"),ee("/V "+ze.v),ee("/R "+ze.r),ee("/U <"+ze.toHexString(ze.U)+">"),ee("/O <"+ze.toHexString(ze.O)+">"),ee("/P "+ze.P),ee(">>"),ee("endobj")),Ze(),dt();var F=re;return Er(),Pt(),ee("startxref"),ee(""+F),ee("%%EOF"),Z(me[L]),Q.join(`
`)},Ee=h.__private__.getBlob=function(O){return new Blob([Nt(O)],{type:"application/pdf"})},Te=h.output=h.__private__.output=($r=function(O,F){switch(typeof(F=F||{})=="string"?F={filename:F}:F.filename=F.filename||"generated.pdf",O){case void 0:return H();case"save":h.save(F.filename);break;case"arraybuffer":return Nt(H());case"blob":return Ee(H());case"bloburi":case"bloburl":if(Jn.URL!==void 0&&typeof Jn.URL.createObjectURL=="function")return Jn.URL&&Jn.URL.createObjectURL(Ee(H()))||void 0;ho.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var fe="",we=H();try{fe=zz(we)}catch{fe=zz(unescape(encodeURIComponent(we)))}return"data:application/pdf;filename="+F.filename+";base64,"+fe;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Jn)==="[object Window]"){var Re="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Je=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';F.pdfObjectUrl&&(Re=F.pdfObjectUrl,Je="");var He='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Re+'"'+Je+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(F)+");<\/script></body></html>",Et=Jn.open();return Et!==null&&Et.document.write(He),Et}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Jn)==="[object Window]"){var Xt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(F.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+F.filename+'" width="500px" height="400px" /></body></html>',jt=Jn.open();if(jt!==null){jt.document.write(Xt);var Rt=this;jt.document.documentElement.querySelector("#pdfViewer").onload=function(){jt.document.title=F.filename,jt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Rt.output("bloburl"))}}return jt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Jn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var ar='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",F)+'"></iframe></body></html>',pr=Jn.open();if(pr!==null&&(pr.document.write(ar),pr.document.title=F.filename),pr||typeof safari>"u")return pr;break;case"datauri":case"dataurl":return Jn.document.location.href=this.output("datauristring",F);default:return null}},$r.foo=function(){try{return $r.apply(this,arguments)}catch(fe){var O=fe.stack||"";~O.indexOf(" at ")&&(O=O.split(" at ")[1]);var F="Error in function "+O.split(`
`)[0].split("<")[0]+": "+fe.message;if(!Jn.console)throw new Error(F);Jn.console.error(F,fe),Jn.alert&&alert(F)}},$r.foo.bar=$r,$r.foo),vt=function(O){return Array.isArray(Qr)===!0&&Qr.indexOf(O)>-1};switch(n){case"pt":$e=1;break;case"mm":$e=72/25.4;break;case"cm":$e=72/2.54;break;case"in":$e=72;break;case"px":$e=vt("px_scaling")==1?.75:96/72;break;case"pc":case"em":$e=12;break;case"ex":$e=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);$e=n}var ze=null;xe(),$();var at=h.__private__.getPageInfo=h.getPageInfo=function(O){if(isNaN(O)||O%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:nt[O].objId,pageNumber:O,pageContext:nt[O]}},Zt=h.__private__.getPageInfoByObjId=function(O){if(isNaN(O)||O%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var F in nt)if(nt[F].objId===O)break;return at(F)},zr=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:nt[L].objId,pageNumber:L,pageContext:nt[L]}};h.addPage=function(){return gr.apply(this,arguments),this},h.setPage=function(){return Ye.apply(this,arguments),Z.call(this,me[L]),this},h.insertPage=function(O){return this.addPage(),this.movePage(L,O),this},h.movePage=function(O,F){var fe,we;if(O>F){fe=me[O],we=nt[O];for(var Re=O;Re>F;Re--)me[Re]=me[Re-1],nt[Re]=nt[Re-1];me[F]=fe,nt[F]=we,this.setPage(F)}else if(O<F){fe=me[O],we=nt[O];for(var Je=O;Je<F;Je++)me[Je]=me[Je+1],nt[Je]=nt[Je+1];me[F]=fe,nt[F]=we,this.setPage(F)}return this},h.deletePage=function(){return J.apply(this,arguments),this},h.__private__.text=h.text=function(O,F,fe,we,Re){var Je,He,Et,Xt,jt,Rt,ar,pr,Wr,Pr=(we=we||{}).scope||this;if(typeof O=="number"&&typeof F=="number"&&(typeof fe=="string"||Array.isArray(fe))){var Vr=fe;fe=F,F=O,O=Vr}if(arguments[3]instanceof Qt==0?(Et=arguments[4],Xt=arguments[5],Pa(ar=arguments[3])==="object"&&ar!==null||(typeof Et=="string"&&(Xt=Et,Et=null),typeof ar=="string"&&(Xt=ar,ar=null),typeof ar=="number"&&(Et=ar,ar=null),we={flags:ar,angle:Et,align:Xt})):(k("The transform parameter of text() with a Matrix value"),Wr=Re),isNaN(F)||isNaN(fe)||O==null)throw new Error("Invalid arguments passed to jsPDF.text");if(O.length===0)return Pr;var Lt,xn="",Rn=typeof we.lineHeightFactor=="number"?we.lineHeightFactor:Bn,Ma=Pr.internal.scaleFactor;function xi(ca){return ca=ca.split("	").join(Array(we.TabLen||9).join(" ")),ct(ca,ar)}function Xn(ca){for(var Ja,Uo=ca.concat(),si=[],xd=Uo.length;xd--;)typeof(Ja=Uo.shift())=="string"?si.push(Ja):Array.isArray(ca)&&(Ja.length===1||Ja[1]===void 0&&Ja[2]===void 0)?si.push(Ja[0]):si.push([Ja[0],Ja[1],Ja[2]]);return si}function ka(ca,Ja){var Uo;if(typeof ca=="string")Uo=Ja(ca)[0];else if(Array.isArray(ca)){for(var si,xd,Th=ca.concat(),Ku=[],Dh=Th.length;Dh--;)typeof(si=Th.shift())=="string"?Ku.push(Ja(si)[0]):Array.isArray(si)&&typeof si[0]=="string"&&(xd=Ja(si[0],si[1],si[2]),Ku.push([xd[0],xd[1],xd[2]]));Uo=Ku}return Uo}var ma=!1,Ya=!0;if(typeof O=="string")ma=!0;else if(Array.isArray(O)){var Oi=O.concat();He=[];for(var us,Xa=Oi.length;Xa--;)(typeof(us=Oi.shift())!="string"||Array.isArray(us)&&typeof us[0]!="string")&&(Ya=!1);ma=Ya}if(ma===!1)throw new Error('Type of text must be string or Array. "'+O+'" is not recognized.');typeof O=="string"&&(O=O.match(/[\r?\n]/)?O.split(/\r\n|\r|\n/g):[O]);var Ro=st/Pr.internal.scaleFactor,Xi=Ro*(Rn-1);switch(we.baseline){case"bottom":fe-=Xi;break;case"top":fe+=Ro-Xi;break;case"hanging":fe+=Ro-2*Xi;break;case"middle":fe+=Ro/2-Xi}if((Rt=we.maxWidth||0)>0&&(typeof O=="string"?O=Pr.splitTextToSize(O,Rt):Object.prototype.toString.call(O)==="[object Array]"&&(O=O.reduce(function(ca,Ja){return ca.concat(Pr.splitTextToSize(Ja,Rt))},[]))),Je={text:O,x:F,y:fe,options:we,mutex:{pdfEscape:ct,activeFontKey:ae,fonts:Ne,activeFontSize:st}},$t.publish("preProcessText",Je),O=Je.text,Et=(we=Je.options).angle,Wr instanceof Qt==0&&Et&&typeof Et=="number"){Et*=Math.PI/180,we.rotationDirection===0&&(Et=-Et),j===w&&(Et=-Et);var fo=Math.cos(Et),fs=Math.sin(Et);Wr=new Qt(fo,fs,-fs,fo,0,0)}else Et&&Et instanceof Qt&&(Wr=Et);j!==w||Wr||(Wr=Tr),(jt=we.charSpace||St)!==void 0&&(xn+=P(T(jt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(pr=we.horizontalScale)!==void 0&&(xn+=P(100*pr)+` Tz
`),we.lang;var ga=-1,Ji=we.renderingMode!==void 0?we.renderingMode:we.stroke,Hs=Pr.internal.getCurrentPageInfo().pageContext;switch(Ji){case 0:case!1:case"fill":ga=0;break;case 1:case!0:case"stroke":ga=1;break;case 2:case"fillThenStroke":ga=2;break;case 3:case"invisible":ga=3;break;case 4:case"fillAndAddForClipping":ga=4;break;case 5:case"strokeAndAddPathForClipping":ga=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ga=6;break;case 7:case"addToPathForClipping":ga=7}var Hu=Hs.usedRenderingMode!==void 0?Hs.usedRenderingMode:-1;ga!==-1?xn+=ga+` Tr
`:Hu!==-1&&(xn+=`0 Tr
`),ga!==-1&&(Hs.usedRenderingMode=ga),Xt=we.align||"left";var Ra,Gs=st*Rn,Ul=Pr.internal.pageSize.getWidth(),Ps=Ne[ae];jt=we.charSpace||St,Rt=we.maxWidth||0,ar=Object.assign({autoencode:!0,noBOM:!0},we.flags);var Ii=[],iu=function(ca){return Pr.getStringUnitWidth(ca,{font:Ps,charSpace:jt,fontSize:st,doKerning:!1})*st/Ma};if(Object.prototype.toString.call(O)==="[object Array]"){var bl;He=Xn(O),Xt!=="left"&&(Ra=He.map(iu));var Ks,yi=0;if(Xt==="right"){F-=Ra[0],O=[],Xa=He.length;for(var Xo=0;Xo<Xa;Xo++)Xo===0?(Ks=vi(F),bl=lo(fe)):(Ks=T(yi-Ra[Xo]),bl=-Gs),O.push([He[Xo],Ks,bl]),yi=Ra[Xo]}else if(Xt==="center"){F-=Ra[0]/2,O=[],Xa=He.length;for(var su=0;su<Xa;su++)su===0?(Ks=vi(F),bl=lo(fe)):(Ks=T((yi-Ra[su])/2),bl=-Gs),O.push([He[su],Ks,bl]),yi=Ra[su]}else if(Xt==="left"){O=[],Xa=He.length;for(var kc=0;kc<Xa;kc++)O.push(He[kc])}else if(Xt==="justify"&&Ps.encoding==="Identity-H"){O=[],Xa=He.length,Rt=Rt!==0?Rt:Ul;for(var Oc=0,co=0;co<Xa;co++)if(bl=co===0?lo(fe):-Gs,Ks=co===0?vi(F):Oc,co<Xa-1){var Vl=T((Rt-Ra[co])/(He[co].split(" ").length-1)),vo=He[co].split(" ");O.push([vo[0]+" ",Ks,bl]),Oc=0;for(var As=1;As<vo.length;As++){var Gu=(iu(vo[As-1]+" "+vo[As])-iu(vo[As]))*Ma+Vl;As==vo.length-1?O.push([vo[As],Gu,0]):O.push([vo[As]+" ",Gu,0]),Oc-=Gu}}else O.push([He[co],Ks,bl]);O.push(["",Oc,0])}else{if(Xt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(O=[],Xa=He.length,Rt=Rt!==0?Rt:Ul,co=0;co<Xa;co++){bl=co===0?lo(fe):-Gs,Ks=co===0?vi(F):0;var Ic=He[co].split(" ").length-1,Ih=Ic>0?(Rt-Ra[co])/Ic:0;co<Xa-1?Ii.push(P(T(Ih))):Ii.push(0),O.push([He[co],Ks,bl])}}}(typeof we.R2L=="boolean"?we.R2L:Nr)===!0&&(O=ka(O,function(ca,Ja,Uo){return[ca.split("").reverse().join(""),Ja,Uo]})),Je={text:O,x:F,y:fe,options:we,mutex:{pdfEscape:ct,activeFontKey:ae,fonts:Ne,activeFontSize:st}},$t.publish("postProcessText",Je),O=Je.text,Lt=Je.mutex.isHex||!1;var Wf=Ne[ae].encoding;Wf!=="WinAnsiEncoding"&&Wf!=="StandardEncoding"||(O=ka(O,function(ca,Ja,Uo){return[xi(ca),Ja,Uo]})),He=Xn(O),O=[];for(var Tc,Dc,Mc,Ys=Array.isArray(He[0])?1:0,Jo="",bi=function(ca,Ja,Uo){var si="";return Uo instanceof Qt?(Uo=typeof we.angle=="number"?qr(Uo,new Qt(1,0,0,1,ca,Ja)):qr(new Qt(1,0,0,1,ca,Ja),Uo),j===w&&(Uo=qr(new Qt(1,0,0,-1,0,0),Uo)),si=Uo.join(" ")+` Tm
`):si=P(ca)+" "+P(Ja)+` Td
`,si},ms=0;ms<He.length;ms++){switch(Jo="",Ys){case 1:Mc=(Lt?"<":"(")+He[ms][0]+(Lt?">":")"),Tc=parseFloat(He[ms][1]),Dc=parseFloat(He[ms][2]);break;case 0:Mc=(Lt?"<":"(")+He[ms]+(Lt?">":")"),Tc=vi(F),Dc=lo(fe)}Ii!==void 0&&Ii[ms]!==void 0&&(Jo=Ii[ms]+` Tw
`),ms===0?O.push(Jo+bi(Tc,Dc,Wr)+Mc):Ys===0?O.push(Jo+Mc):Ys===1&&O.push(Jo+bi(Tc,Dc,Wr)+Mc)}O=Ys===0?O.join(` Tj
T* `):O.join(` Tj
`),O+=` Tj
`;var Rc=`BT
/`;return Rc+=ae+" "+st+` Tf
`,Rc+=P(st*Rn)+` TL
`,Rc+=ht+`
`,Rc+=xn,Rc+=O,ee(Rc+="ET"),m[ae]=!0,Pr};var Ar=h.__private__.clip=h.clip=function(O){return ee(O==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return Ar("evenodd")},h.__private__.discardPath=h.discardPath=function(){return ee("n"),this};var br=h.__private__.isValidStyle=function(O){var F=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(O)!==-1&&(F=!0),F};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(O){return br(O)&&(d=O),this};var yr=h.__private__.getStyle=h.getStyle=function(O){var F=d;switch(O){case"D":case"S":F="S";break;case"F":F="f";break;case"FD":case"DF":F="B";break;case"f":case"f*":case"B":case"B*":F=O}return F},nr=h.close=function(){return ee("h"),this};h.stroke=function(){return ee("S"),this},h.fill=function(O){return Zr("f",O),this},h.fillEvenOdd=function(O){return Zr("f*",O),this},h.fillStroke=function(O){return Zr("B",O),this},h.fillStrokeEvenOdd=function(O){return Zr("B*",O),this};var Zr=function(O,F){Pa(F)==="object"?cn(F,O):ee(O)},tt=function(O){O===null||j===w&&O===void 0||(O=yr(O),ee(O))};function Lr(O,F,fe,we,Re){var Je=new jp(F||this.boundingBox,fe||this.xStep,we||this.yStep,this.gState,Re||this.matrix);Je.stream=this.stream;var He=O+"$$"+this.cloneIndex+++"$$";return sr(He,Je),Je}var cn=function(O,F){var fe=pt[O.key],we=et[fe];if(we instanceof jm)ee("q"),ee(pn(F)),we.gState&&h.setGState(we.gState),ee(O.matrix.toString()+" cm"),ee("/"+fe+" sh"),ee("Q");else if(we instanceof jp){var Re=new Qt(1,0,0,-1,0,ir());O.matrix&&(Re=Re.multiply(O.matrix||Tr),fe=Lr.call(we,O.key,O.boundingBox,O.xStep,O.yStep,Re).id),ee("q"),ee("/Pattern cs"),ee("/"+fe+" scn"),we.gState&&h.setGState(we.gState),ee(F),ee("Q")}},pn=function(O){switch(O){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},jn=h.moveTo=function(O,F){return ee(P(T(O))+" "+P(D(F))+" m"),this},Gn=h.lineTo=function(O,F){return ee(P(T(O))+" "+P(D(F))+" l"),this},Ln=h.curveTo=function(O,F,fe,we,Re,Je){return ee([P(T(O)),P(D(F)),P(T(fe)),P(D(we)),P(T(Re)),P(D(Je)),"c"].join(" ")),this};h.__private__.line=h.line=function(O,F,fe,we,Re){if(isNaN(O)||isNaN(F)||isNaN(fe)||isNaN(we)||!br(Re))throw new Error("Invalid arguments passed to jsPDF.line");return j===b?this.lines([[fe-O,we-F]],O,F,[1,1],Re||"S"):this.lines([[fe-O,we-F]],O,F,[1,1]).stroke()},h.__private__.lines=h.lines=function(O,F,fe,we,Re,Je){var He,Et,Xt,jt,Rt,ar,pr,Wr,Pr,Vr,Lt,xn;if(typeof O=="number"&&(xn=fe,fe=F,F=O,O=xn),we=we||[1,1],Je=Je||!1,isNaN(F)||isNaN(fe)||!Array.isArray(O)||!Array.isArray(we)||!br(Re)||typeof Je!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(jn(F,fe),He=we[0],Et=we[1],jt=O.length,Vr=F,Lt=fe,Xt=0;Xt<jt;Xt++)(Rt=O[Xt]).length===2?(Vr=Rt[0]*He+Vr,Lt=Rt[1]*Et+Lt,Gn(Vr,Lt)):(ar=Rt[0]*He+Vr,pr=Rt[1]*Et+Lt,Wr=Rt[2]*He+Vr,Pr=Rt[3]*Et+Lt,Vr=Rt[4]*He+Vr,Lt=Rt[5]*Et+Lt,Ln(ar,pr,Wr,Pr,Vr,Lt));return Je&&nr(),tt(Re),this},h.path=function(O){for(var F=0;F<O.length;F++){var fe=O[F],we=fe.c;switch(fe.op){case"m":jn(we[0],we[1]);break;case"l":Gn(we[0],we[1]);break;case"c":Ln.apply(this,we);break;case"h":nr()}}return this},h.__private__.rect=h.rect=function(O,F,fe,we,Re){if(isNaN(O)||isNaN(F)||isNaN(fe)||isNaN(we)||!br(Re))throw new Error("Invalid arguments passed to jsPDF.rect");return j===b&&(we=-we),ee([P(T(O)),P(D(F)),P(T(fe)),P(T(we)),"re"].join(" ")),tt(Re),this},h.__private__.triangle=h.triangle=function(O,F,fe,we,Re,Je,He){if(isNaN(O)||isNaN(F)||isNaN(fe)||isNaN(we)||isNaN(Re)||isNaN(Je)||!br(He))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[fe-O,we-F],[Re-fe,Je-we],[O-Re,F-Je]],O,F,[1,1],He,!0),this},h.__private__.roundedRect=h.roundedRect=function(O,F,fe,we,Re,Je,He){if(isNaN(O)||isNaN(F)||isNaN(fe)||isNaN(we)||isNaN(Re)||isNaN(Je)||!br(He))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Et=4/3*(Math.SQRT2-1);return Re=Math.min(Re,.5*fe),Je=Math.min(Je,.5*we),this.lines([[fe-2*Re,0],[Re*Et,0,Re,Je-Je*Et,Re,Je],[0,we-2*Je],[0,Je*Et,-Re*Et,Je,-Re,Je],[2*Re-fe,0],[-Re*Et,0,-Re,-Je*Et,-Re,-Je],[0,2*Je-we],[0,-Je*Et,Re*Et,-Je,Re,-Je]],O+Re,F,[1,1],He,!0),this},h.__private__.ellipse=h.ellipse=function(O,F,fe,we,Re){if(isNaN(O)||isNaN(F)||isNaN(fe)||isNaN(we)||!br(Re))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Je=4/3*(Math.SQRT2-1)*fe,He=4/3*(Math.SQRT2-1)*we;return jn(O+fe,F),Ln(O+fe,F-He,O+Je,F-we,O,F-we),Ln(O-Je,F-we,O-fe,F-He,O-fe,F),Ln(O-fe,F+He,O-Je,F+we,O,F+we),Ln(O+Je,F+we,O+fe,F+He,O+fe,F),tt(Re),this},h.__private__.circle=h.circle=function(O,F,fe,we){if(isNaN(O)||isNaN(F)||isNaN(fe)||!br(we))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(O,F,fe,fe,we)},h.setFont=function(O,F,fe){return fe&&(F=E(F,fe)),ae=it(O,F,{disableWarning:!1}),this};var aa=h.__private__.getFont=h.getFont=function(){return Ne[it.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var O,F,fe={};for(O in Ue)if(Ue.hasOwnProperty(O))for(F in fe[O]=[],Ue[O])Ue[O].hasOwnProperty(F)&&fe[O].push(F);return fe},h.addFont=function(O,F,fe,we,Re){var Je=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Je.indexOf(arguments[3])!==-1?Re=arguments[3]:arguments[3]&&Je.indexOf(arguments[3])==-1&&(fe=E(fe,we)),Cr.call(this,O,F,fe,Re=Re||"Identity-H")};var Bn,ya=e.lineWidth||.200025,an=h.__private__.getLineWidth=h.getLineWidth=function(){return ya},Ea=h.__private__.setLineWidth=h.setLineWidth=function(O){return ya=O,ee(P(T(O))+" w"),this};h.__private__.setLineDash=Nn.API.setLineDash=Nn.API.setLineDashPattern=function(O,F){if(O=O||[],F=F||0,isNaN(F)||!Array.isArray(O))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return O=O.map(function(fe){return P(T(fe))}).join(" "),F=P(T(F)),ee("["+O+"] "+F+" d"),this};var Sa=h.__private__.getLineHeight=h.getLineHeight=function(){return st*Bn};h.__private__.getLineHeight=h.getLineHeight=function(){return st*Bn};var ba=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(O){return typeof(O=O||1.15)=="number"&&(Bn=O),this},Mo=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return Bn};ba(e.lineHeight);var vi=h.__private__.getHorizontalCoordinate=function(O){return T(O)},lo=h.__private__.getVerticalCoordinate=function(O){return j===w?O:nt[L].mediaBox.topRightY-nt[L].mediaBox.bottomLeftY-T(O)},zl=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(O){return P(vi(O))},yl=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(O){return P(lo(O))},ue=e.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return Kr(ue)},h.__private__.setStrokeColor=h.setDrawColor=function(O,F,fe,we){return ue=dn({ch1:O,ch2:F,ch3:fe,ch4:we,pdfColorType:"draw",precision:2}),ee(ue),this};var Fe=e.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return Kr(Fe)},h.__private__.setFillColor=h.setFillColor=function(O,F,fe,we){return Fe=dn({ch1:O,ch2:F,ch3:fe,ch4:we,pdfColorType:"fill",precision:2}),ee(Fe),this};var ht=e.textColor||"0 g",At=h.__private__.getTextColor=h.getTextColor=function(){return Kr(ht)};h.__private__.setTextColor=h.setTextColor=function(O,F,fe,we){return ht=dn({ch1:O,ch2:F,ch3:fe,ch4:we,pdfColorType:"text",precision:3}),this};var St=e.charSpace,xr=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(St||0)};h.__private__.setCharSpace=h.setCharSpace=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return St=O,this};var er=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(O){var F=h.CapJoinStyles[O];if(F===void 0)throw new Error("Line cap style of '"+O+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return er=F,ee(F+" J"),this};var jr=0;h.__private__.setLineJoin=h.setLineJoin=function(O){var F=h.CapJoinStyles[O];if(F===void 0)throw new Error("Line join style of '"+O+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return jr=F,ee(F+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(O){if(O=O||0,isNaN(O))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ee(P(T(O))+" M"),this},h.GState=S1,h.setGState=function(O){(O=typeof O=="string"?Ke[qt[O]]:cr(null,O)).equals(lt)||(ee("/"+O.id+" gs"),lt=O)};var cr=function(O,F){if(!O||!qt[O]){var fe=!1;for(var we in Ke)if(Ke.hasOwnProperty(we)&&Ke[we].equals(F)){fe=!0;break}if(fe)F=Ke[we];else{var Re="GS"+(Object.keys(Ke).length+1).toString(10);Ke[Re]=F,F.id=Re}return O&&(qt[O]=F.id),$t.publish("addGState",F),F}};h.addGState=function(O,F){return cr(O,F),this},h.saveGraphicsState=function(){return ee("q"),Qe.push({key:ae,size:st,color:ht}),this},h.restoreGraphicsState=function(){ee("Q");var O=Qe.pop();return ae=O.key,st=O.size,ht=O.color,lt=null,this},h.setCurrentTransformationMatrix=function(O){return ee(O.toString()+" cm"),this},h.comment=function(O){return ee("#"+O),this};var It=function(O,F){var fe=O||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return fe},set:function(Je){isNaN(Je)||(fe=parseFloat(Je))}});var we=F||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return we},set:function(Je){isNaN(Je)||(we=parseFloat(Je))}});var Re="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Re},set:function(Je){Re=Je.toString()}}),this},Ir=function(O,F,fe,we){It.call(this,O,F),this.type="rect";var Re=fe||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Re},set:function(He){isNaN(He)||(Re=parseFloat(He))}});var Je=we||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Je},set:function(He){isNaN(He)||(Je=parseFloat(He))}}),this},ie=function(){this.page=rr,this.currentPage=L,this.pages=me.slice(0),this.pagesContext=nt.slice(0),this.x=Ae,this.y=Tt,this.matrix=Se,this.width=We(L),this.height=qe(L),this.outputDestination=Be,this.id="",this.objectNumber=-1};ie.prototype.restore=function(){rr=this.page,L=this.currentPage,nt=this.pagesContext,me=this.pages,Ae=this.x,Tt=this.y,Se=this.matrix,_t(L,this.width),X(L,this.height),Be=this.outputDestination};var be=function(O,F,fe,we,Re){sn.push(new ie),rr=L=0,me=[],Ae=O,Tt=F,Se=Re,Gt([fe,we])};for(var Ge in h.beginFormObject=function(O,F,fe,we,Re){return be(O,F,fe,we,Re),this},h.endFormObject=function(O){return function(F){if(In[F])sn.pop().restore();else{var fe=new ie,we="Xo"+(Object.keys(Xr).length+1).toString(10);fe.id=we,In[F]=we,Xr[we]=fe,$t.publish("addFormObject",fe),sn.pop().restore()}}(O),this},h.doFormObject=function(O,F){var fe=Xr[In[O]];return ee("q"),ee(F.toString()+" cm"),ee("/"+fe.id+" Do"),ee("Q"),this},h.getFormObject=function(O){var F=Xr[In[O]];return{x:F.x,y:F.y,width:F.width,height:F.height,matrix:F.matrix}},h.save=function(O,F){return O=O||"generated.pdf",(F=F||{}).returnPromise=F.returnPromise||!1,F.returnPromise===!1?(ep(Ee(H()),O),typeof ep.unload=="function"&&Jn.setTimeout&&setTimeout(ep.unload,911),this):new Promise(function(fe,we){try{var Re=ep(Ee(H()),O);typeof ep.unload=="function"&&Jn.setTimeout&&setTimeout(ep.unload,911),fe(Re)}catch(Je){we(Je.message)}})},Nn.API)Nn.API.hasOwnProperty(Ge)&&(Ge==="events"&&Nn.API.events.length?function(O,F){var fe,we,Re;for(Re=F.length-1;Re!==-1;Re--)fe=F[Re][0],we=F[Re][1],O.subscribe.apply(O,[fe].concat(typeof we=="function"?[we]:we))}($t,Nn.API.events):h[Ge]=Nn.API[Ge]);function We(O){return nt[O].mediaBox.topRightX-nt[O].mediaBox.bottomLeftX}function _t(O,F){nt[O].mediaBox.topRightX=F+nt[O].mediaBox.bottomLeftX}function qe(O){return nt[O].mediaBox.topRightY-nt[O].mediaBox.bottomLeftY}function X(O,F){nt[O].mediaBox.topRightY=F+nt[O].mediaBox.bottomLeftY}var Me=h.getPageWidth=function(O){return We(O=O||L)/$e},gt=h.setPageWidth=function(O,F){_t(O,F*$e)},ir=h.getPageHeight=function(O){return qe(O=O||L)/$e},Dr=h.setPageHeight=function(O,F){X(O,F*$e)};return h.internal={pdfEscape:ct,getStyle:yr,getFont:aa,getFontSize:yt,getCharSpace:xr,getTextColor:At,getLineHeight:Sa,getLineHeightFactor:Mo,getLineWidth:an,write:kt,getHorizontalCoordinate:vi,getVerticalCoordinate:lo,getCoordinateString:zl,getVerticalCoordinateString:yl,collections:{},newObject:Gr,newAdditionalObject:wr,newObjectDeferred:ke,newObjectDeferredBegin:Mt,getFilters:wn,putStream:va,events:$t,scaleFactor:$e,pageSize:{getWidth:function(){return Me(L)},setWidth:function(O){gt(L,O)},getHeight:function(){return ir(L)},setHeight:function(O){Dr(L,O)}},encryptionOptions:u,encryption:ze,getEncryptor:function(O){return u!==null?ze.encryptor(O,0):function(F){return F}},output:Te,getNumberOfPages:Xe,pages:me,out:ee,f2:S,f3:I,getPageInfo:at,getPageInfoByObjId:Zt,getCurrentPageInfo:zr,getPDFVersion:g,Point:It,Rectangle:Ir,Matrix:Qt,hasHotfix:vt},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return Me(L)},set:function(O){gt(L,O)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return ir(L)},set:function(O){Dr(L,O)},enumerable:!0,configurable:!0}),function(O){for(var F=0,fe=De.length;F<fe;F++){var we=Cr.call(this,O[F][0],O[F][1],O[F][2],De[F][3],!0);f===!1&&(m[we]=!0);var Re=O[F][0].split("-");Vt({id:we,fontName:Re[0],fontStyle:Re[1]||""})}$t.publish("addFonts",{fonts:Ne,dictionary:Ue})}.call(h,De),ae="F1",gr(a,r),$t.publish("initialized"),h}rv.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},rv.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},rv.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},rv.prototype.processOwnerPassword=function(e,t){return d4(c4(t).substr(0,5),e)},rv.prototype.encryptor=function(e,t){var r=c4(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return d4(r,n)}},S1.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||Pa(e)!==Pa(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},Nn.API={events:[]},Nn.version="3.0.3";var ei=Nn.API,SM=1,jg=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Wg=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},ra=function(e){return e.toFixed(2)},am=function(e){return e.toFixed(5)};ei.__acroform__={};var ql=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},Hz=function(e){return e*SM},mu=function(e){var t=new hne,r=hn.internal.getHeight(e)||0,n=hn.internal.getWidth(e)||0;return t.BBox=[0,0,Number(ra(n)),Number(ra(r))],t},AJe=ei.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},EJe=ei.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},kJe=ei.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},fi=ei.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return kJe(e,t-1)},mi=ei.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return AJe(e,t-1)},hi=ei.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return EJe(e,t-1)},OJe=ei.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,a=e[0],i=e[1],s=e[2],l=e[3],c={};return c.lowerLeft_X=r(a)||0,c.lowerLeft_Y=n(i+l)||0,c.upperRight_X=r(a+s)||0,c.upperRight_Y=n(i)||0,[Number(ra(c.lowerLeft_X)),Number(ra(c.lowerLeft_Y)),Number(ra(c.upperRight_X)),Number(ra(c.upperRight_Y))]},IJe=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=u4(e,r),a=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+a+" "+ra(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=mu(e);return i.scope=e.scope,i.stream=t.join(`
`),i}},u4=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},a=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");a=e.multiline?a.map(function(S){return S.split(`
`)}):a.map(function(S){return[S]});var i=r,s=hn.internal.getHeight(e)||0;s=s<0?-s:s;var l=hn.internal.getWidth(e)||0;l=l<0?-l:l;var c=function(S,I,T){if(S+1<a.length){var D=I+" "+a[S+1][0];return q2(D,e,T).width<=l-4}return!1};i++;e:for(;i>0;){t="",i--;var d,u,f=q2("3",e,i).height,m=e.multiline?s-i:(s-f)/2,h=m+=2,v=0,g=0,y=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+q2(t,e,i=12).width+", FieldWidth:"+l+`
`;break}for(var x="",b=0,w=0;w<a.length;w++)if(a.hasOwnProperty(w)){var j=!1;if(a[w].length!==1&&y!==a[w].length-1){if((f+2)*(b+2)+2>s)continue e;x+=a[w][y],j=!0,g=w,w--}else{x=(x+=a[w][y]+" ").substr(x.length-1)==" "?x.substr(0,x.length-1):x;var _=parseInt(w),C=c(_,x,i),E=w>=a.length-1;if(C&&!E){x+=" ",y=0;continue}if(C||E){if(E)g=_;else if(e.multiline&&(f+2)*(b+2)+2>s)continue e}else{if(!e.multiline||(f+2)*(b+2)+2>s)continue e;g=_}}for(var P="",k=v;k<=g;k++){var M=a[k];if(e.multiline){if(k===g){P+=M[y]+" ",y=(y+1)%M.length;continue}if(k===v){P+=M[M.length-1]+" ";continue}}P+=M[0]+" "}switch(P=P.substr(P.length-1)==" "?P.substr(0,P.length-1):P,u=q2(P,e,i).width,e.textAlign){case"right":d=l-u-2;break;case"center":d=(l-u)/2;break;default:d=2}t+=ra(d)+" "+ra(h)+` Td
`,t+="("+jg(P)+`) Tj
`,t+=-ra(d)+` 0 Td
`,h=-(i+2),u=0,v=j?g:g+1,b++,x=""}break}return n.text=t,n.fontSize=i,n},q2=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),a=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:a}},TJe={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},DJe=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},MJe=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(nu.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(TJe)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");SM=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new pne,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var i=n[a];i.objId=void 0,i.hasAnnotation&&DJe(i,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,a){var i=!n;for(var s in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var l=n[s],c=[],d=l.Rect;if(l.Rect&&(l.Rect=OJe(l.Rect,a)),a.internal.newObjectDeferredBegin(l.objId,!0),l.DA=hn.createDefaultAppearanceStream(l),Pa(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=d,l.hasAppearanceStream&&!l.appearanceStreamContent){var u=IJe(l);c.push({key:"AP",value:"<</N "+u+">>"}),a.internal.acroformPlugin.xForms.push(u)}if(l.appearanceStreamContent){var f="";for(var m in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(m)){var h=l.appearanceStreamContent[m];if(f+="/"+m+" ",f+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var s in h)if(h.hasOwnProperty(s)){var v=h[s];typeof v=="function"&&(v=v.call(a,l)),f+="/"+s+" "+v+" ",a.internal.acroformPlugin.xForms.indexOf(v)>=0||a.internal.acroformPlugin.xForms.push(v)}}else typeof(v=h)=="function"&&(v=v.call(a,l)),f+="/"+s+" "+v,a.internal.acroformPlugin.xForms.indexOf(v)>=0||a.internal.acroformPlugin.xForms.push(v);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}a.internal.putStream({additionalKeyValues:c,objectId:l.objId}),a.internal.out("endobj")}i&&function(g,y){for(var x in g)if(g.hasOwnProperty(x)){var b=x,w=g[x];y.internal.newObjectDeferredBegin(w.objId,!0),Pa(w)==="object"&&typeof w.putStream=="function"&&w.putStream(),delete g[b]}}(a.internal.acroformPlugin.xForms,a)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},mne=ei.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(s){return s};if(Array.isArray(e)){for(var a="[",i=0;i<e.length;i++)switch(i!==0&&(a+=" "),Pa(e[i])){case"boolean":case"number":case"object":a+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),a+="("+jg(n(e[i].toString()))+")"):a+=e[i].toString()}return a+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},ZA=function(e,t,r){var n=function(a){return a};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+jg(n(e))+")"},Pu=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Pu.prototype.toString=function(){return this.objId+" 0 R"},Pu.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Pu.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],a=this[n];a&&(Array.isArray(a)?e.push({key:n,value:mne(a,this.objId,this.scope)}):a instanceof Pu?(a.scope=this.scope,e.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&e.push({key:n,value:a}))}return e};var hne=function(){Pu.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};ql(hne,Pu);var pne=function(){Pu.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+jg(r(e))+")"}},set:function(r){e=r}})};ql(pne,Pu);var nu=function e(){Pu.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute F supplied.');t=x}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!fi(t,3)},set:function(x){x?this.F=mi(t,3):this.F=hi(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute Ff supplied.');r=x}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(x){n=x!==void 0?x:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(x){n[0]=x}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(x){n[1]=x}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(x){n[2]=x}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(x){n[3]=x}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(x){switch(x){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=x;break;default:throw new Error('Invalid value "'+x+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof z_)return;i="FieldObject"+e.FieldNum++}var x=function(b){return b};return this.scope&&(x=this.scope.internal.getEncryptor(this.objId)),"("+jg(x(i))+")"},set:function(x){i=x.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(x){i=x}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(x){s=x}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(x){l=x}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(x){c=x}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/SM:d},set:function(x){d=x}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(x){u=x}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof z_||this instanceof eh))return ZA(f,this.objId,this.scope)},set:function(x){x=x.toString(),f=x}});var m=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof zi==0?ZA(m,this.objId,this.scope):m},set:function(x){x=x.toString(),m=this instanceof zi==0?x.substr(0,1)==="("?Wg(x.substr(1,x.length-2)):Wg(x):x}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof zi==1?Wg(m.substr(1,m.length-1)):m},set:function(x){x=x.toString(),m=this instanceof zi==1?"/"+x:x}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(x){this.V=x}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof zi==0?ZA(h,this.objId,this.scope):h},set:function(x){x=x.toString(),h=this instanceof zi==0?x.substr(0,1)==="("?Wg(x.substr(1,x.length-2)):Wg(x):x}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof zi==1?Wg(h.substr(1,h.length-1)):h},set:function(x){x=x.toString(),h=this instanceof zi==1?"/"+x:x}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var v,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(x){x=!!x,g=x}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(v)return v},set:function(x){v=x}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!fi(this.Ff,1)},set:function(x){x?this.Ff=mi(this.Ff,1):this.Ff=hi(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!fi(this.Ff,2)},set:function(x){x?this.Ff=mi(this.Ff,2):this.Ff=hi(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!fi(this.Ff,3)},set:function(x){x?this.Ff=mi(this.Ff,3):this.Ff=hi(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(x){if([0,1,2].indexOf(x)===-1)throw new Error('Invalid value "'+x+'" for attribute Q supplied.');y=x}}),Object.defineProperty(this,"textAlign",{get:function(){var x;switch(y){case 0:default:x="left";break;case 1:x="center";break;case 2:x="right"}return x},configurable:!0,enumerable:!0,set:function(x){switch(x){case"right":case 2:y=2;break;case"center":case 1:y=1;break;default:y=0}}})};ql(nu,Pu);var Ip=function(){nu.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return mne(t,this.objId,this.scope)},set:function(r){var n,a;a=[],typeof(n=r)=="string"&&(a=function(i,s,l){l||(l=1);for(var c,d=[];c=s.exec(i);)d.push(c[l]);return d}(n,/\((.*?)\)/g)),t=a}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!fi(this.Ff,18)},set:function(r){r?this.Ff=mi(this.Ff,18):this.Ff=hi(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!fi(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=mi(this.Ff,19):this.Ff=hi(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!fi(this.Ff,20)},set:function(r){r?(this.Ff=mi(this.Ff,20),t.sort()):this.Ff=hi(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!fi(this.Ff,22)},set:function(r){r?this.Ff=mi(this.Ff,22):this.Ff=hi(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!fi(this.Ff,23)},set:function(r){r?this.Ff=mi(this.Ff,23):this.Ff=hi(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!fi(this.Ff,27)},set:function(r){r?this.Ff=mi(this.Ff,27):this.Ff=hi(this.Ff,27)}}),this.hasAppearanceStream=!1};ql(Ip,nu);var Tp=function(){Ip.call(this),this.fontName="helvetica",this.combo=!1};ql(Tp,Ip);var Dp=function(){Tp.call(this),this.combo=!0};ql(Dp,Tp);var Yy=function(){Dp.call(this),this.edit=!0};ql(Yy,Dp);var zi=function(){nu.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!fi(this.Ff,15)},set:function(r){r?this.Ff=mi(this.Ff,15):this.Ff=hi(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!fi(this.Ff,16)},set:function(r){r?this.Ff=mi(this.Ff,16):this.Ff=hi(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!fi(this.Ff,17)},set:function(r){r?this.Ff=mi(this.Ff,17):this.Ff=hi(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!fi(this.Ff,26)},set:function(r){r?this.Ff=mi(this.Ff,26):this.Ff=hi(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,a=[];for(n in a.push("<<"),t)a.push("/"+n+" ("+jg(r(t[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(r){Pa(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};ql(zi,nu);var Xy=function(){zi.call(this),this.pushButton=!0};ql(Xy,zi);var Mp=function(){zi.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};ql(Mp,zi);var z_=function(){var e,t;nu.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(a){e=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(a){t=a}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(l){return l};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var i,s=[];for(i in s.push("<<"),n)s.push("/"+i+" ("+jg(a(n[i]))+")");return s.push(">>"),s.join(`
`)},set:function(a){Pa(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(a){r="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=hn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ql(z_,nu),Mp.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},Mp.prototype.createOption=function(e){var t=new z_;return t.Parent=this,t.optionName=e,this.Kids.push(t),RJe.call(this.scope,t),t};var Jy=function(){zi.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=hn.CheckBox.createAppearanceStream()};ql(Jy,zi);var eh=function(){nu.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!fi(this.Ff,13)},set:function(t){t?this.Ff=mi(this.Ff,13):this.Ff=hi(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!fi(this.Ff,21)},set:function(t){t?this.Ff=mi(this.Ff,21):this.Ff=hi(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!fi(this.Ff,23)},set:function(t){t?this.Ff=mi(this.Ff,23):this.Ff=hi(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!fi(this.Ff,24)},set:function(t){t?this.Ff=mi(this.Ff,24):this.Ff=hi(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!fi(this.Ff,25)},set:function(t){t?this.Ff=mi(this.Ff,25):this.Ff=hi(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!fi(this.Ff,26)},set:function(t){t?this.Ff=mi(this.Ff,26):this.Ff=hi(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ql(eh,nu);var Qy=function(){eh.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!fi(this.Ff,14)},set:function(e){e?this.Ff=mi(this.Ff,14):this.Ff=hi(this.Ff,14)}}),this.password=!0};ql(Qy,eh);var hn={CheckBox:{createAppearanceStream:function(){return{N:{On:hn.CheckBox.YesNormal},D:{On:hn.CheckBox.YesPushDown,Off:hn.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=mu(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),i=u4(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+ra(hn.internal.getWidth(e))+" "+ra(hn.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+ra(i.fontSize)+" Tf "+a),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=mu(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),a=[],i=hn.internal.getHeight(e),s=hn.internal.getWidth(e),l=u4(e,e.caption);return a.push("1 g"),a.push("0 0 "+ra(s)+" "+ra(i)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+ra(s-1)+" "+ra(i-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+r+" "+ra(l.fontSize)+" Tf "+n),a.push(l.text),a.push("ET"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=mu(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ra(hn.internal.getWidth(e))+" "+ra(hn.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:hn.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=hn.RadioButton.Circle.YesNormal,t.D[e]=hn.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=mu(e);t.scope=e.scope;var r=[],n=hn.internal.getWidth(e)<=hn.internal.getHeight(e)?hn.internal.getWidth(e)/4:hn.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=hn.internal.Bezier_C,i=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+am(hn.internal.getWidth(e)/2)+" "+am(hn.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=mu(e);t.scope=e.scope;var r=[],n=hn.internal.getWidth(e)<=hn.internal.getHeight(e)?hn.internal.getWidth(e)/4:hn.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*hn.internal.Bezier_C).toFixed(5)),s=Number((n*hn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+am(hn.internal.getWidth(e)/2)+" "+am(hn.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+am(hn.internal.getWidth(e)/2)+" "+am(hn.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=mu(e);t.scope=e.scope;var r=[],n=hn.internal.getWidth(e)<=hn.internal.getHeight(e)?hn.internal.getWidth(e)/4:hn.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*hn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+am(hn.internal.getWidth(e)/2)+" "+am(hn.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:hn.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=hn.RadioButton.Cross.YesNormal,t.D[e]=hn.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=mu(e);t.scope=e.scope;var r=[],n=hn.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+ra(hn.internal.getWidth(e)-2)+" "+ra(hn.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(ra(n.x1.x)+" "+ra(n.x1.y)+" m"),r.push(ra(n.x2.x)+" "+ra(n.x2.y)+" l"),r.push(ra(n.x4.x)+" "+ra(n.x4.y)+" m"),r.push(ra(n.x3.x)+" "+ra(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=mu(e);t.scope=e.scope;var r=hn.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+ra(hn.internal.getWidth(e))+" "+ra(hn.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+ra(hn.internal.getWidth(e)-2)+" "+ra(hn.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(ra(r.x1.x)+" "+ra(r.x1.y)+" m"),n.push(ra(r.x2.x)+" "+ra(r.x2.y)+" l"),n.push(ra(r.x4.x)+" "+ra(r.x4.y)+" m"),n.push(ra(r.x3.x)+" "+ra(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=mu(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+ra(hn.internal.getWidth(e))+" "+ra(hn.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};hn.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=hn.internal.getWidth(e),r=hn.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},hn.internal.getWidth=function(e){var t=0;return Pa(e)==="object"&&(t=Hz(e.Rect[2])),t},hn.internal.getHeight=function(e){var t=0;return Pa(e)==="object"&&(t=Hz(e.Rect[3])),t};var RJe=ei.addField=function(e){if(MJe(this,e),!(e instanceof nu))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};ei.AcroFormChoiceField=Ip,ei.AcroFormListBox=Tp,ei.AcroFormComboBox=Dp,ei.AcroFormEditBox=Yy,ei.AcroFormButton=zi,ei.AcroFormPushButton=Xy,ei.AcroFormRadioButton=Mp,ei.AcroFormCheckBox=Jy,ei.AcroFormTextField=eh,ei.AcroFormPasswordField=Qy,ei.AcroFormAppearance=hn,ei.AcroForm={ChoiceField:Ip,ListBox:Tp,ComboBox:Dp,EditBox:Yy,Button:zi,PushButton:Xy,RadioButton:Mp,CheckBox:Jy,TextField:eh,PasswordField:Qy,Appearance:hn},Nn.AcroForm={ChoiceField:Ip,ListBox:Tp,ComboBox:Dp,EditBox:Yy,Button:zi,PushButton:Xy,RadioButton:Mp,CheckBox:Jy,TextField:eh,PasswordField:Qy,Appearance:hn};var LJe=Nn.AcroForm;function gne(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=e.__addimage__.getImageFileTypeByImageData=function(S,I){var T,D,B,U,z,$=r;if((I=I||r)==="RGBA"||S.data!==void 0&&S.data instanceof Uint8ClampedArray&&"height"in S&&"width"in S)return"RGBA";if(C(S))for(z in n)for(B=n[z],T=0;T<B.length;T+=1){for(U=!0,D=0;D<B[T].length;D+=1)if(B[T][D]!==void 0&&B[T][D]!==S[D]){U=!1;break}if(U===!0){$=z;break}}else for(z in n)for(B=n[z],T=0;T<B.length;T+=1){for(U=!0,D=0;D<B[T].length;D+=1)if(B[T][D]!==void 0&&B[T][D]!==S.charCodeAt(D)){U=!1;break}if(U===!0){$=z;break}}return $===r&&I!==r&&($=I),$},i=function S(I){for(var T=this.internal.write,D=this.internal.putStream,B=(0,this.internal.getFilters)();B.indexOf("FlateEncode")!==-1;)B.splice(B.indexOf("FlateEncode"),1);I.objectId=this.internal.newObject();var U=[];if(U.push({key:"Type",value:"/XObject"}),U.push({key:"Subtype",value:"/Image"}),U.push({key:"Width",value:I.width}),U.push({key:"Height",value:I.height}),I.colorSpace===x.INDEXED?U.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(I.palette.length/3-1)+" "+("sMask"in I&&I.sMask!==void 0?I.objectId+2:I.objectId+1)+" 0 R]"}):(U.push({key:"ColorSpace",value:"/"+I.colorSpace}),I.colorSpace===x.DEVICE_CMYK&&U.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),U.push({key:"BitsPerComponent",value:I.bitsPerComponent}),"decodeParameters"in I&&I.decodeParameters!==void 0&&U.push({key:"DecodeParms",value:"<<"+I.decodeParameters+">>"}),"transparency"in I&&Array.isArray(I.transparency)&&I.transparency.length>0){for(var z="",$=0,Y=I.transparency.length;$<Y;$++)z+=I.transparency[$]+" "+I.transparency[$]+" ";U.push({key:"Mask",value:"["+z+"]"})}I.sMask!==void 0&&U.push({key:"SMask",value:I.objectId+1+" 0 R"});var de=I.filter!==void 0?["/"+I.filter]:void 0;if(D({data:I.data,additionalKeyValues:U,alreadyAppliedFilters:de,objectId:I.objectId}),T("endobj"),"sMask"in I&&I.sMask!==void 0){var xe,q=(xe=I.sMaskBitsPerComponent)!==null&&xe!==void 0?xe:I.bitsPerComponent,L={width:I.width,height:I.height,colorSpace:"DeviceGray",bitsPerComponent:q,data:I.sMask};"filter"in I&&(L.decodeParameters="/Predictor ".concat(I.predictor," /Colors 1 /BitsPerComponent ").concat(q," /Columns ").concat(I.width),L.filter=I.filter),S.call(this,L)}if(I.colorSpace===x.INDEXED){var W=this.internal.newObject();D({data:P(new Uint8Array(I.palette)),objectId:W}),T("endobj")}},s=function(){var S=this.internal.collections[t+"images"];for(var I in S)i.call(this,S[I])},l=function(){var S,I=this.internal.collections[t+"images"],T=this.internal.write;for(var D in I)T("/I"+(S=I[D]).index,S.objectId,"0","R")},c=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",l))},d=function(){var S=this.internal.collections[t+"images"];return c.call(this),S},u=function(){return Object.keys(this.internal.collections[t+"images"]).length},f=function(S){return typeof e["process"+S.toUpperCase()]=="function"},m=function(S){return Pa(S)==="object"&&S.nodeType===1},h=function(S,I){if(S.nodeName==="IMG"&&S.hasAttribute("src")){var T=""+S.getAttribute("src");if(T.indexOf("data:image/")===0)return Pj(unescape(T).split("base64,").pop());var D=e.loadFile(T,!0);if(D!==void 0)return D}if(S.nodeName==="CANVAS"){if(S.width===0||S.height===0)throw new Error("Given canvas must have data. Canvas width: "+S.width+", height: "+S.height);var B;switch(I){case"PNG":B="image/png";break;case"WEBP":B="image/webp";break;default:B="image/jpeg"}return Pj(S.toDataURL(B,1).split("base64,").pop())}},v=function(S){var I=this.internal.collections[t+"images"];if(I){for(var T in I)if(S===I[T].alias)return I[T]}},g=function(S,I,T){return S||I||(S=-96,I=-96),S<0&&(S=-1*T.width*72/S/this.internal.scaleFactor),I<0&&(I=-1*T.height*72/I/this.internal.scaleFactor),S===0&&(S=I*T.width/T.height),I===0&&(I=S*T.height/T.width),[S,I]},y=function(S,I,T,D,B,U){var z=g.call(this,T,D,B),$=this.internal.getCoordinateString,Y=this.internal.getVerticalCoordinateString,de=d.call(this);if(T=z[0],D=z[1],de[B.index]=B,U){U*=Math.PI/180;var xe=Math.cos(U),q=Math.sin(U),L=function(ne){return ne.toFixed(4)},W=[L(xe),L(q),L(-1*q),L(xe),0,0,"cm"]}this.internal.write("q"),U?(this.internal.write([1,"0","0",1,$(S),Y(I+D),"cm"].join(" ")),this.internal.write(W.join(" ")),this.internal.write([$(T),"0","0",$(D),"0","0","cm"].join(" "))):this.internal.write([$(T),"0","0",$(D),$(S),Y(I+D),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+B.index+" Do"),this.internal.write("Q")},x=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var b=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=e.__addimage__.sHashCode=function(S){var I,T,D=0;if(typeof S=="string")for(T=S.length,I=0;I<T;I++)D=(D<<5)-D+S.charCodeAt(I),D|=0;else if(C(S))for(T=S.byteLength/2,I=0;I<T;I++)D=(D<<5)-D+S[I],D|=0;return D},j=e.__addimage__.validateStringAsBase64=function(S){(S=S||"").toString().trim();var I=!0;return S.length===0&&(I=!1),S.length%4!=0&&(I=!1),/^[A-Za-z0-9+/]+$/.test(S.substr(0,S.length-2))===!1&&(I=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(S.substr(-2))===!1&&(I=!1),I},_=e.__addimage__.extractImageFromDataUrl=function(S){if(S==null||!(S=S.trim()).startsWith("data:"))return null;var I=S.indexOf(",");return I<0?null:S.substring(0,I).trim().endsWith("base64")?S.substring(I+1):null};e.__addimage__.isArrayBuffer=function(S){return S instanceof ArrayBuffer};var C=e.__addimage__.isArrayBufferView=function(S){return S instanceof Int8Array||S instanceof Uint8Array||S instanceof Uint8ClampedArray||S instanceof Int16Array||S instanceof Uint16Array||S instanceof Int32Array||S instanceof Uint32Array||S instanceof Float32Array||S instanceof Float64Array},E=e.__addimage__.binaryStringToUint8Array=function(S){for(var I=S.length,T=new Uint8Array(I),D=0;D<I;D++)T[D]=S.charCodeAt(D);return T},P=e.__addimage__.arrayBufferToBinaryString=function(S){for(var I="",T=C(S)?S:new Uint8Array(S),D=0;D<T.length;D+=8192)I+=String.fromCharCode.apply(null,T.subarray(D,D+8192));return I};e.addImage=function(){var S,I,T,D,B,U,z,$,Y;if(typeof arguments[1]=="number"?(I=r,T=arguments[1],D=arguments[2],B=arguments[3],U=arguments[4],z=arguments[5],$=arguments[6],Y=arguments[7]):(I=arguments[1],T=arguments[2],D=arguments[3],B=arguments[4],U=arguments[5],z=arguments[6],$=arguments[7],Y=arguments[8]),Pa(S=arguments[0])==="object"&&!m(S)&&"imageData"in S){var de=S;S=de.imageData,I=de.format||I||r,T=de.x||T||0,D=de.y||D||0,B=de.w||de.width||B,U=de.h||de.height||U,z=de.alias||z,$=de.compression||$,Y=de.rotation||de.angle||Y}var xe=this.internal.getFilters();if($===void 0&&xe.indexOf("FlateEncode")!==-1&&($="SLOW"),isNaN(T)||isNaN(D))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var q=k.call(this,S,I,z,$);return y.call(this,T,D,B,U,q,Y),this};var k=function(S,I,T,D){var B,U,z;if(typeof S=="string"&&a(S)===r){S=unescape(S);var $=M(S,!1);($!==""||($=e.loadFile(S,!0))!==void 0)&&(S=$)}if(m(S)&&(S=h(S,I)),I=a(S,I),!f(I))throw new Error("addImage does not support files of type '"+I+"', please ensure that a plugin for '"+I+"' support is added.");if(((z=T)==null||z.length===0)&&(T=function(Y){return typeof Y=="string"||C(Y)?w(Y):C(Y.data)?w(Y.data):null}(S)),(B=v.call(this,T))||(S instanceof Uint8Array||I==="RGBA"||(U=S,S=E(S)),B=this["process"+I.toUpperCase()](S,u.call(this),T,function(Y){return Y&&typeof Y=="string"&&(Y=Y.toUpperCase()),Y in e.image_compression?Y:b.NONE}(D),U)),!B)throw new Error("An unknown error occurred whilst processing the image.");return B},M=e.__addimage__.convertBase64ToBinaryString=function(S,I){I=typeof I!="boolean"||I;var T,D="";if(typeof S=="string"){var B;T=(B=_(S))!==null&&B!==void 0?B:S;try{D=Pj(T)}catch(U){if(I)throw j(T)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+U.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return D};e.getImageProperties=function(S){var I,T,D="";if(m(S)&&(S=h(S)),typeof S=="string"&&a(S)===r&&((D=M(S,!1))===""&&(D=e.loadFile(S)||""),S=D),T=a(S),!f(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(S instanceof Uint8Array||(S=E(S)),!(I=this["process"+T.toUpperCase()](S)))throw new Error("An unknown error occurred whilst processing the image");return I.fileType=T,I}})(Nn.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Nn.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,a,i,s=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),d=r.pageContext.annotations,u=!1,f=0;f<d.length&&!u;f++)switch((n=d[f]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var m=0;m<d.length;m++){n=d[m];var h=this.internal.pdfEscape,v=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(g.objId),b=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(a="/Rect ["+s(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+h(x(n.contents))+")",i+=" /Popup "+y.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+h(x(b))+") >>",g.content=i;var w=g.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+s(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+w,n.open&&(i+=" /Open true"),i+=" >>",y.content=i,this.internal.write(g.objId,"0 R",y.objId,"0 R");break;case"freetext":a="/Rect ["+s(n.bounds.x)+" "+l(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var j=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+h(v(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+j+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var _=this.annotations._nameMap[n.options.name];n.options.pageNumber=_.page,n.options.top=_.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+h(v(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;default:var C=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+C+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,a,i,s){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:d(n),w:c(r+a),h:d(n+i)},options:s,type:"link"})},e.textWithLink=function(r,n,a,i){var s,l,c=this.getTextWidth(r),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){l=i.maxWidth;var u=this.splitTextToSize(r,l).length;s=Math.ceil(d*u)}else l=c,s=d;return this.text(r,n,a,i),a+=.2*d,i.align==="center"&&(n-=c/2),i.align==="right"&&(n-=c),this.link(n,a-d,l,s,i),c},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(Nn.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},s=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},l=e.__arabicParser__.isArabicEndLetter=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(g){return s(g)&&a.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length>=1};var d=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length>=3};var u=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length==4},f=e.__arabicParser__.resolveLigatures=function(g){var y=0,x=r,b="",w=0;for(y=0;y<g.length;y+=1)x[g.charCodeAt(y)]!==void 0?(w++,typeof(x=x[g.charCodeAt(y)])=="number"&&(b+=String.fromCharCode(x),x=r,w=0),y===g.length-1&&(x=r,b+=g.charAt(y-(w-1)),y-=w-1,w=0)):(x=r,b+=g.charAt(y-w),y-=w,w=0);return b};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var m=e.__arabicParser__.getCorrectForm=function(g,y,x){return s(g)?i(g)===!1?-1:!d(g)||!s(y)&&!s(x)||!s(x)&&l(y)||l(g)&&!s(y)||l(g)&&c(y)||l(g)&&l(y)?0:u(g)&&s(y)&&!l(y)&&s(x)&&d(x)?3:l(g)||!s(x)?1:2:-1},h=function(g){var y=0,x=0,b=0,w="",j="",_="",C=(g=g||"").split("\\s+"),E=[];for(y=0;y<C.length;y+=1){for(E.push(""),x=0;x<C[y].length;x+=1)w=C[y][x],j=C[y][x-1],_=C[y][x+1],s(w)?(b=m(w,j,_),E[y]+=b!==-1?String.fromCharCode(t[w.charCodeAt(0)][b]):w):E[y]+=w;E[y]=f(E[y])}return E.join(" ")},v=e.__arabicParser__.processArabic=e.processArabic=function(){var g,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,x=[];if(Array.isArray(y)){var b=0;for(x=[],b=0;b<y.length;b+=1)Array.isArray(y[b])?x.push([h(y[b][0]),y[b][1],y[b][2]]):x.push([h(y[b])]);g=x}else g=h(y);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",v])}(Nn.API),Nn.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(l){a=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(l){i=l}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(l){s=l}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var a;if((r=r||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Nn.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(g){c=g}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var m=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return m},set:function(g){m=g}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var v=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return v},set:function(g){v=g}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,d){n.call(this);var u=(d=d||{}).fontSize||this.getFontSize(),f=d.font||this.getFont(),m=d.scaleFactor||this.internal.scaleFactor,h=0,v=0,g=0,y=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var x=d.maxWidth;x>0?typeof c=="string"?c=this.splitTextToSize(c,x):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(w,j){return w.concat(y.splitTextToSize(j,x))},[])):c=Array.isArray(c)?c:[c];for(var b=0;b<c.length;b++)h<(g=this.getStringUnitWidth(c[b],{font:f})*u)&&(h=g);return h!==0&&(v=c.length),{w:h/=m,h:Math.max((v*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/m,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=e.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var d=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,f=this.internal.__cell__.margins||t,m=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===c.lineNumber?(c.x=(d.x||0)+(d.width||0),c.y=d.y||0):d.y+d.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,h&&m&&(this.printHeaderRow(c.lineNumber,!0),c.y+=m[0].height)):c.y=d.y+d.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-u,c.y+u,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+u,{align:"center",baseline:"top",maxWidth:c.width-u-u}):this.text(c.text,c.x+u,c.y+u,{align:"left",baseline:"top",maxWidth:c.width-u-u})),this.internal.__cell__.lastCell=c,this};e.table=function(c,d,u,f,m){if(n.call(this),!u)throw new Error("No data for PDF table.");var h,v,g,y,x=[],b=[],w=[],j={},_={},C=[],E=[],P=(m=m||{}).autoSize||!1,k=m.printHeaders!==!1,M=m.css&&m.css["font-size"]!==void 0?16*m.css["font-size"]:m.fontSize||12,S=m.margins||Object.assign({width:this.getPageWidth()},t),I=typeof m.padding=="number"?m.padding:3,T=m.headerBackgroundColor||"#c8c8c8",D=m.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=k,this.internal.__cell__.margins=S,this.internal.__cell__.table_font_size=M,this.internal.__cell__.padding=I,this.internal.__cell__.headerBackgroundColor=T,this.internal.__cell__.headerTextColor=D,this.setFontSize(M),f==null)b=x=Object.keys(u[0]),w=x.map(function(){return"left"});else if(Array.isArray(f)&&Pa(f[0])==="object")for(x=f.map(function(de){return de.name}),b=f.map(function(de){return de.prompt||de.name||""}),w=f.map(function(de){return de.align||"left"}),h=0;h<f.length;h+=1)_[f[h].name]=.7499990551181103*f[h].width;else Array.isArray(f)&&typeof f[0]=="string"&&(b=x=f,w=x.map(function(){return"left"}));if(P||Array.isArray(f)&&typeof f[0]=="string")for(h=0;h<x.length;h+=1){for(j[y=x[h]]=u.map(function(de){return de[y]}),this.setFont(void 0,"bold"),C.push(this.getTextDimensions(b[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),v=j[y],this.setFont(void 0,"normal"),g=0;g<v.length;g+=1)C.push(this.getTextDimensions(v[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);_[y]=Math.max.apply(null,C)+I+I,C=[]}if(k){var B={};for(h=0;h<x.length;h+=1)B[x[h]]={},B[x[h]].text=b[h],B[x[h]].align=w[h];var U=l.call(this,B,_);E=x.map(function(de){return new i(c,d,_[de],U,B[de].text,void 0,B[de].align)}),this.setTableHeaderRow(E),this.printHeaderRow(1,!1)}var z=f.reduce(function(de,xe){return de[xe.name]=xe.align,de},{});for(h=0;h<u.length;h+=1){"rowStart"in m&&m.rowStart instanceof Function&&m.rowStart({row:h,data:u[h]},this);var $=l.call(this,u[h],_);for(g=0;g<x.length;g+=1){var Y=u[h][x[g]];"cellStart"in m&&m.cellStart instanceof Function&&m.cellStart({row:h,col:g,data:Y},this),s.call(this,new i(c,d,_[x[g]],$,Y,h+2,z[x[g]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=d,this};var l=function(c,d){var u=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,m=this.internal.scaleFactor;return Object.keys(c).map(function(h){var v=c[h];return this.splitTextToSize(v.hasOwnProperty("text")?v.text:v,d[h]-u-u)},this).map(function(h){return this.getLineHeightFactor()*h.length*f/m+u+u},this).reduce(function(h,v){return Math.max(h,v)},0)};e.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,d){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var m=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){u=this.internal.__cell__.tableHeaderRow[h].clone(),d&&(u.y=this.internal.__cell__.margins.top||0,m.push(u)),u.lineNumber=c;var v=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,u),this.setTextColor(v)}m.length>0&&this.setTableHeaderRow(m),this.setFont(void 0,"normal"),r=!1}}(Nn.API);var vne={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},xne=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],f4=gne(xne),yne=[100,200,300,400,500,600,700,800,900],$Je=gne(yne);function eE(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(i){return vne[i=i||"normal"]?i:"normal"}(e.style),n=function(i){return i?typeof i=="number"?i>=100&&i<=900&&i%100==0?i:400:/^\d00$/.test(i)?parseInt(i):i==="bold"?700:400:400}(e.weight),a=function(i){return typeof f4[i=i||"normal"]=="number"?i:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:a,src:e.src||[],ref:e.ref||{name:t,style:[a,r,n].join(" ")}}}function Gz(e,t,r,n){var a;for(a=r;a>=0&&a<t.length;a+=n)if(e[t[a]])return e[t[a]];for(a=r;a>=0&&a<t.length;a-=n)if(e[t[a]])return e[t[a]]}var FJe={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Kz={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Yz(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function Xz(e){return e.trimLeft()}function BJe(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function qJe(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var z2,Jz,Qz,Hg,U2,Zz,e9,t9,tE=["times"];function r9(e,t,r,n,a){var i=4,s=a9;switch(a){case Nn.API.image_compression.FAST:i=1,s=n9;break;case Nn.API.image_compression.MEDIUM:i=6,s=o9;break;case Nn.API.image_compression.SLOW:i=9,s=i9}e=function(c,d,u,f){for(var m,h=c.length/d,v=new Uint8Array(c.length+h),g=[zJe,n9,a9,o9,i9],y=0;y<h;y+=1){var x=y*d,b=c.subarray(x,x+d);if(f)v.set(f(b,u,m),x+y);else{for(var w=g.length,j=[],_=0;_<w;_+=1)j[_]=g[_](b,u,m);var C=VJe(j.concat());v.set(j[C],x+y)}m=b}return v}(e,t,Math.ceil(r*n/8),s);var l=Z3(e,{level:i});return Nn.API.__addimage__.arrayBufferToBinaryString(l)}function zJe(e){var t=Array.apply([],e);return t.unshift(0),t}function n9(e,t){var r=e.length,n=[];n[0]=1;for(var a=0;a<r;a+=1){var i=e[a-t]||0;n[a+1]=e[a]-i+256&255}return n}function a9(e,t,r){var n=e.length,a=[];a[0]=2;for(var i=0;i<n;i+=1){var s=r&&r[i]||0;a[i+1]=e[i]-s+256&255}return a}function o9(e,t,r){var n=e.length,a=[];a[0]=3;for(var i=0;i<n;i+=1){var s=e[i-t]||0,l=r&&r[i]||0;a[i+1]=e[i]+256-(s+l>>>1)&255}return a}function i9(e,t,r){var n=e.length,a=[];a[0]=4;for(var i=0;i<n;i+=1){var s=UJe(e[i-t]||0,r&&r[i]||0,r&&r[i-t]||0);a[i+1]=e[i]-s+256&255}return a}function UJe(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),a=Math.abs(e-r),i=Math.abs(e+t-r-r);return n<=a&&n<=i?e:a<=i?t:r}function VJe(e){var t=e.map(function(r){return r.reduce(function(n,a){return n+Math.abs(a)},0)});return t.indexOf(Math.min.apply(null,t))}function rE(e,t,r){var n=t*r,a=Math.floor(n/8),i=16-(n-8*a+r),s=(1<<r)-1;return bne(e,a)>>i&s}function s9(e,t,r,n){var a=r*n,i=Math.floor(a/8),s=16-(a-8*i+n),l=(1<<n)-1,c=(t&l)<<s;(function(d,u,f){if(u+1<d.byteLength)d.setUint16(u,f,!1);else{var m=f>>8&255;d.setUint8(u,m)}})(e,i,bne(e,i)&~(l<<s)&65535|c)}function bne(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function WJe(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,a=e[t++],i=a>>7,s=1<<1+(7&a);e[t++],e[t++];var l=null,c=null;i&&(l=t,c=s,t+=3*s);var d=!0,u=[],f=0,m=null,h=0,v=null;for(this.width=r,this.height=n;d&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,v=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((S=e[t++])>=0))throw Error("Invalid block size");if(S===0)break;t+=S}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[t++];f=e[t++]|e[t++]<<8,m=e[t++],1&g||(m=null),h=g>>2&7,t++;break;case 254:for(;;){if(!((S=e[t++])>=0))throw Error("Invalid block size");if(S===0)break;t+=S}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var y=e[t++]|e[t++]<<8,x=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,j=e[t++],_=j>>6&1,C=1<<1+(7&j),E=l,P=c,k=!1;j>>7&&(k=!0,E=t,P=C,t+=3*C);var M=t;for(t++;;){var S;if(!((S=e[t++])>=0))throw Error("Invalid block size");if(S===0)break;t+=S}u.push({x:y,y:x,width:b,height:w,has_local_palette:k,palette_offset:E,palette_size:P,data_offset:M,data_length:t-M,transparent_index:m,interlaced:!!_,delay:f,disposal:h});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return v},this.frameInfo=function(I){if(I<0||I>=u.length)throw new Error("Frame index out of range.");return u[I]},this.decodeAndBlitFrameBGRA=function(I,T){var D=this.frameInfo(I),B=D.width*D.height,U=new Uint8Array(B);l9(e,D.data_offset,U,B);var z=D.palette_offset,$=D.transparent_index;$===null&&($=256);var Y=D.width,de=r-Y,xe=Y,q=4*(D.y*r+D.x),L=4*((D.y+D.height)*r+D.x),W=q,ne=4*de;D.interlaced===!0&&(ne+=4*r*7);for(var le=8,K=0,Q=U.length;K<Q;++K){var re=U[K];if(xe===0&&(xe=Y,(W+=ne)>=L&&(ne=4*de+4*r*(le-1),W=q+(Y+de)*(le<<1),le>>=1)),re===$)W+=4;else{var G=e[z+3*re],me=e[z+3*re+1],pe=e[z+3*re+2];T[W++]=pe,T[W++]=me,T[W++]=G,T[W++]=255}--xe}},this.decodeAndBlitFrameRGBA=function(I,T){var D=this.frameInfo(I),B=D.width*D.height,U=new Uint8Array(B);l9(e,D.data_offset,U,B);var z=D.palette_offset,$=D.transparent_index;$===null&&($=256);var Y=D.width,de=r-Y,xe=Y,q=4*(D.y*r+D.x),L=4*((D.y+D.height)*r+D.x),W=q,ne=4*de;D.interlaced===!0&&(ne+=4*r*7);for(var le=8,K=0,Q=U.length;K<Q;++K){var re=U[K];if(xe===0&&(xe=Y,(W+=ne)>=L&&(ne=4*de+4*r*(le-1),W=q+(Y+de)*(le<<1),le>>=1)),re===$)W+=4;else{var G=e[z+3*re],me=e[z+3*re+1],pe=e[z+3*re+2];T[W++]=G,T[W++]=me,T[W++]=pe,T[W++]=255}--xe}}}function l9(e,t,r,n){for(var a=e[t++],i=1<<a,s=i+1,l=s+1,c=a+1,d=(1<<c)-1,u=0,f=0,m=0,h=e[t++],v=new Int32Array(4096),g=null;;){for(;u<16&&h!==0;)f|=e[t++]<<u,u+=8,h===1?h=e[t++]:--h;if(u<c)break;var y=f&d;if(f>>=c,u-=c,y!==i){if(y===s)break;for(var x=y<l?y:g,b=0,w=x;w>i;)w=v[w]>>8,++b;var j=w;if(m+b+(x!==y?1:0)>n)return void ho.log("Warning, gif stream longer than expected.");r[m++]=j;var _=m+=b;for(x!==y&&(r[m++]=j),w=x;b--;)w=v[w],r[--_]=255&w,w>>=8;g!==null&&l<4096&&(v[l++]=g<<8|j,l>=d+1&&c<12&&(++c,d=d<<1|1)),g=y}else l=s+1,d=(1<<(c=a+1))-1,g=null}return m!==n&&ho.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function nE(e){var t,r,n,a,i,s=Math.floor,l=new Array(64),c=new Array(64),d=new Array(64),u=new Array(64),f=new Array(65535),m=new Array(65535),h=new Array(64),v=new Array(64),g=[],y=0,x=7,b=new Array(64),w=new Array(64),j=new Array(64),_=new Array(256),C=new Array(2048),E=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],P=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],k=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],S=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],I=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],T=[0,1,2,3,4,5,6,7,8,9,10,11],D=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],B=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function U(q,L){for(var W=0,ne=0,le=new Array,K=1;K<=16;K++){for(var Q=1;Q<=q[K];Q++)le[L[ne]]=[],le[L[ne]][0]=W,le[L[ne]][1]=K,ne++,W++;W*=2}return le}function z(q){for(var L=q[0],W=q[1]-1;W>=0;)L&1<<W&&(y|=1<<x),W--,--x<0&&(y==255?($(255),$(0)):$(y),x=7,y=0)}function $(q){g.push(q)}function Y(q){$(q>>8&255),$(255&q)}function de(q,L,W,ne,le){for(var K,Q=le[0],re=le[240],G=function(st,ft){var yt,Nr,se,rt,mt,tr,Ce,je,ae,$e,Ae=0;for(ae=0;ae<8;++ae){yt=st[Ae],Nr=st[Ae+1],se=st[Ae+2],rt=st[Ae+3],mt=st[Ae+4],tr=st[Ae+5],Ce=st[Ae+6];var Tt=yt+(je=st[Ae+7]),Se=yt-je,Ne=Nr+Ce,Ue=Nr-Ce,Qe=se+tr,et=se-tr,pt=rt+mt,Ke=rt-mt,qt=Tt+pt,lt=Tt-pt,rr=Ne+Qe,nt=Ne-Qe;st[Ae]=qt+rr,st[Ae+4]=qt-rr;var $t=.707106781*(nt+lt);st[Ae+2]=lt+$t,st[Ae+6]=lt-$t;var Qr=.382683433*((qt=Ke+et)-(nt=Ue+Se)),Xr=.5411961*qt+Qr,In=1.306562965*nt+Qr,sn=.707106781*(rr=et+Ue),Qt=Se+sn,qr=Se-sn;st[Ae+5]=qr+Xr,st[Ae+3]=qr-Xr,st[Ae+1]=Qt+In,st[Ae+7]=Qt-In,Ae+=8}for(Ae=0,ae=0;ae<8;++ae){yt=st[Ae],Nr=st[Ae+8],se=st[Ae+16],rt=st[Ae+24],mt=st[Ae+32],tr=st[Ae+40],Ce=st[Ae+48];var Tr=yt+(je=st[Ae+56]),sr=yt-je,$r=Nr+Ce,Gr=Nr-Ce,ke=se+tr,Mt=se-tr,wr=rt+mt,Fr=rt-mt,Ur=Tr+wr,Kr=Tr-wr,dn=$r+ke,wn=$r-ke;st[Ae]=Ur+dn,st[Ae+32]=Ur-dn;var va=.707106781*(wn+Kr);st[Ae+16]=Kr+va,st[Ae+48]=Kr-va;var xa=.382683433*((Ur=Fr+Mt)-(wn=Gr+sr)),Aa=.5411961*Ur+xa,ut=1.306562965*wn+xa,Ht=.707106781*(dn=Mt+Gr),dr=sr+Ht,Ft=sr-Ht;st[Ae+40]=Ft+Aa,st[Ae+24]=Ft-Aa,st[Ae+8]=dr+ut,st[Ae+56]=dr-ut,Ae++}for(ae=0;ae<64;++ae)$e=st[ae]*ft[ae],h[ae]=$e>0?$e+.5|0:$e-.5|0;return h}(q,L),me=0;me<64;++me)v[E[me]]=G[me];var pe=v[0]-W;W=v[0],pe==0?z(ne[0]):(z(ne[m[K=32767+pe]]),z(f[K]));for(var Be=63;Be>0&&v[Be]==0;)Be--;if(Be==0)return z(Q),W;for(var Z,ee=1;ee<=Be;){for(var kt=ee;v[ee]==0&&ee<=Be;)++ee;var Nt=ee-kt;if(Nt>=16){Z=Nt>>4;for(var De=1;De<=Z;++De)z(re);Nt&=15}K=32767+v[ee],z(le[(Nt<<4)+m[K]]),z(f[K]),ee++}return Be!=63&&z(Q),W}function xe(q){q=Math.min(Math.max(q,1),100),i!=q&&(function(L){for(var W=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],ne=0;ne<64;ne++){var le=s((W[ne]*L+50)/100);le=Math.min(Math.max(le,1),255),l[E[ne]]=le}for(var K=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Q=0;Q<64;Q++){var re=s((K[Q]*L+50)/100);re=Math.min(Math.max(re,1),255),c[E[Q]]=re}for(var G=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],me=0,pe=0;pe<8;pe++)for(var Be=0;Be<8;Be++)d[me]=1/(l[E[me]]*G[pe]*G[Be]*8),u[me]=1/(c[E[me]]*G[pe]*G[Be]*8),me++}(q<50?Math.floor(5e3/q):Math.floor(200-2*q)),i=q)}this.encode=function(q,L){L&&xe(L),g=new Array,y=0,x=7,Y(65496),Y(65504),Y(16),$(74),$(70),$(73),$(70),$(0),$(1),$(1),$(0),Y(1),Y(1),$(0),$(0),function(){Y(65499),Y(132),$(0);for(var Nr=0;Nr<64;Nr++)$(l[Nr]);$(1);for(var se=0;se<64;se++)$(c[se])}(),function(Nr,se){Y(65472),Y(17),$(8),Y(se),Y(Nr),$(3),$(1),$(17),$(0),$(2),$(17),$(1),$(3),$(17),$(1)}(q.width,q.height),function(){Y(65476),Y(418),$(0);for(var Nr=0;Nr<16;Nr++)$(P[Nr+1]);for(var se=0;se<=11;se++)$(k[se]);$(16);for(var rt=0;rt<16;rt++)$(M[rt+1]);for(var mt=0;mt<=161;mt++)$(S[mt]);$(1);for(var tr=0;tr<16;tr++)$(I[tr+1]);for(var Ce=0;Ce<=11;Ce++)$(T[Ce]);$(17);for(var je=0;je<16;je++)$(D[je+1]);for(var ae=0;ae<=161;ae++)$(B[ae])}(),Y(65498),Y(12),$(3),$(1),$(0),$(2),$(17),$(3),$(17),$(0),$(63),$(0);var W=0,ne=0,le=0;y=0,x=7,this.encode.displayName="_encode_";for(var K,Q,re,G,me,pe,Be,Z,ee,kt=q.data,Nt=q.width,De=q.height,st=4*Nt,ft=0;ft<De;){for(K=0;K<st;){for(me=st*ft+K,Be=-1,Z=0,ee=0;ee<64;ee++)pe=me+(Z=ee>>3)*st+(Be=4*(7&ee)),ft+Z>=De&&(pe-=st*(ft+1+Z-De)),K+Be>=st&&(pe-=K+Be-st+4),Q=kt[pe++],re=kt[pe++],G=kt[pe++],b[ee]=(C[Q]+C[re+256|0]+C[G+512|0]>>16)-128,w[ee]=(C[Q+768|0]+C[re+1024|0]+C[G+1280|0]>>16)-128,j[ee]=(C[Q+1280|0]+C[re+1536|0]+C[G+1792|0]>>16)-128;W=de(b,d,W,t,n),ne=de(w,u,ne,r,a),le=de(j,u,le,r,a),K+=32}ft+=8}if(x>=0){var yt=[];yt[1]=x+1,yt[0]=(1<<x+1)-1,z(yt)}return Y(65497),new Uint8Array(g)},e=e||50,function(){for(var q=String.fromCharCode,L=0;L<256;L++)_[L]=q(L)}(),t=U(P,k),r=U(I,T),n=U(M,S),a=U(D,B),function(){for(var q=1,L=2,W=1;W<=15;W++){for(var ne=q;ne<L;ne++)m[32767+ne]=W,f[32767+ne]=[],f[32767+ne][1]=W,f[32767+ne][0]=ne;for(var le=-(L-1);le<=-q;le++)m[32767+le]=W,f[32767+le]=[],f[32767+le][1]=W,f[32767+le][0]=L-1+le;q<<=1,L<<=1}}(),function(){for(var q=0;q<256;q++)C[q]=19595*q,C[q+256|0]=38470*q,C[q+512|0]=7471*q+32768,C[q+768|0]=-11059*q,C[q+1024|0]=-21709*q,C[q+1280|0]=32768*q+8421375,C[q+1536|0]=-27439*q,C[q+1792|0]=-5329*q}(),xe(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Cd(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function c9(e){function t(k){if(!k)throw Error("assert :P")}function r(k,M,S){for(var I=0;4>I;I++)if(k[M+I]!=S.charCodeAt(I))return!0;return!1}function n(k,M,S,I,T){for(var D=0;D<T;D++)k[M+D]=S[I+D]}function a(k,M,S,I){for(var T=0;T<I;T++)k[M+T]=S}function i(k){return new Int32Array(k)}function s(k,M){for(var S=[],I=0;I<k;I++)S.push(new M);return S}function l(k,M){var S=[];return function I(T,D,B){for(var U=B[D],z=0;z<U&&(T.push(B.length>D+1?[]:new M),!(B.length<D+1));z++)I(T[z],D+1,B)}(S,0,k),S}var c=function(){var k=this;function M(N,A){for(var R=1<<A-1>>>0;N&R;)R>>>=1;return R?(N&R-1)+R:N}function S(N,A,R,V,te){t(!(V%R));do N[A+(V-=R)]=te;while(0<V)}function I(N,A,R,V,te){if(t(2328>=te),512>=te)var ce=i(512);else if((ce=i(te))==null)return 0;return function(he,_e,Pe,Oe,ot,Ut){var Ie,bt,Dt=_e,ur=1<<Pe,Bt=i(16),hr=i(16);for(t(ot!=0),t(Oe!=null),t(he!=null),t(0<Pe),bt=0;bt<ot;++bt){if(15<Oe[bt])return 0;++Bt[Oe[bt]]}if(Bt[0]==ot)return 0;for(hr[1]=0,Ie=1;15>Ie;++Ie){if(Bt[Ie]>1<<Ie)return 0;hr[Ie+1]=hr[Ie]+Bt[Ie]}for(bt=0;bt<ot;++bt)Ie=Oe[bt],0<Oe[bt]&&(Ut[hr[Ie]++]=bt);if(hr[15]==1)return(Oe=new T).g=0,Oe.value=Ut[0],S(he,Dt,1,ur,Oe),ur;var vr,Or=-1,Sr=ur-1,An=0,mn=1,ua=1,yn=1<<Pe;for(bt=0,Ie=1,ot=2;Ie<=Pe;++Ie,ot<<=1){if(mn+=ua<<=1,0>(ua-=Bt[Ie]))return 0;for(;0<Bt[Ie];--Bt[Ie])(Oe=new T).g=Ie,Oe.value=Ut[bt++],S(he,Dt+An,ot,yn,Oe),An=M(An,Ie)}for(Ie=Pe+1,ot=2;15>=Ie;++Ie,ot<<=1){if(mn+=ua<<=1,0>(ua-=Bt[Ie]))return 0;for(;0<Bt[Ie];--Bt[Ie]){if(Oe=new T,(An&Sr)!=Or){for(Dt+=yn,vr=1<<(Or=Ie)-Pe;15>Or&&!(0>=(vr-=Bt[Or]));)++Or,vr<<=1;ur+=yn=1<<(vr=Or-Pe),he[_e+(Or=An&Sr)].g=vr+Pe,he[_e+Or].value=Dt-_e-Or}Oe.g=Ie-Pe,Oe.value=Ut[bt++],S(he,Dt+(An>>Pe),ot,yn,Oe),An=M(An,Ie)}}return mn!=2*hr[15]-1?0:ur}(N,A,R,V,te,ce)}function T(){this.value=this.g=0}function D(){this.value=this.g=0}function B(){this.G=s(5,T),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(iu,D)}function U(N,A,R,V){t(N!=null),t(A!=null),t(2147483648>V),N.Ca=254,N.I=0,N.b=-8,N.Ka=0,N.oa=A,N.pa=R,N.Jd=A,N.Yc=R+V,N.Zc=4<=V?R+V-4+1:R,Q(N)}function z(N,A){for(var R=0;0<A--;)R|=G(N,128)<<A;return R}function $(N,A){var R=z(N,A);return re(N)?-R:R}function Y(N,A,R,V){var te,ce=0;for(t(N!=null),t(A!=null),t(4294967288>V),N.Sb=V,N.Ra=0,N.u=0,N.h=0,4<V&&(V=4),te=0;te<V;++te)ce+=A[R+te]<<8*te;N.Ra=ce,N.bb=V,N.oa=A,N.pa=R}function de(N){for(;8<=N.u&&N.bb<N.Sb;)N.Ra>>>=8,N.Ra+=N.oa[N.pa+N.bb]<<yi-8>>>0,++N.bb,N.u-=8;ne(N)&&(N.h=1,N.u=0)}function xe(N,A){if(t(0<=A),!N.h&&A<=Ks){var R=W(N)&bl[A];return N.u+=A,de(N),R}return N.h=1,N.u=0}function q(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function L(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function W(N){return N.Ra>>>(N.u&yi-1)>>>0}function ne(N){return t(N.bb<=N.Sb),N.h||N.bb==N.Sb&&N.u>yi}function le(N,A){N.u=A,N.h=ne(N)}function K(N){N.u>=Xo&&(t(N.u>=Xo),de(N))}function Q(N){t(N!=null&&N.oa!=null),N.pa<N.Zc?(N.I=(N.oa[N.pa++]|N.I<<8)>>>0,N.b+=8):(t(N!=null&&N.oa!=null),N.pa<N.Yc?(N.b+=8,N.I=N.oa[N.pa++]|N.I<<8):N.Ka?N.b=0:(N.I<<=8,N.b+=8,N.Ka=1))}function re(N){return z(N,1)}function G(N,A){var R=N.Ca;0>N.b&&Q(N);var V=N.b,te=R*A>>>8,ce=(N.I>>>V>te)+0;for(ce?(R-=te,N.I-=te+1<<V>>>0):R=te+1,V=R,te=0;256<=V;)te+=8,V>>=8;return V=7^te+su[V],N.b-=V,N.Ca=(R<<V)-1,ce}function me(N,A,R){N[A+0]=R>>24&255,N[A+1]=R>>16&255,N[A+2]=R>>8&255,N[A+3]=255&R}function pe(N,A){return N[A+0]|N[A+1]<<8}function Be(N,A){return pe(N,A)|N[A+2]<<16}function Z(N,A){return pe(N,A)|pe(N,A+2)<<16}function ee(N,A){var R=1<<A;return t(N!=null),t(0<A),N.X=i(R),N.X==null?0:(N.Mb=32-A,N.Xa=A,1)}function kt(N,A){t(N!=null),t(A!=null),t(N.Xa==A.Xa),n(A.X,0,N.X,0,1<<A.Xa)}function Nt(){this.X=[],this.Xa=this.Mb=0}function De(N,A,R,V){t(R!=null),t(V!=null);var te=R[0],ce=V[0];return te==0&&(te=(N*ce+A/2)/A),ce==0&&(ce=(A*te+N/2)/N),0>=te||0>=ce?0:(R[0]=te,V[0]=ce,1)}function st(N,A){return N+(1<<A)-1>>>A}function ft(N,A){return((4278255360&N)+(4278255360&A)>>>0&4278255360)+((16711935&N)+(16711935&A)>>>0&16711935)>>>0}function yt(N,A){k[A]=function(R,V,te,ce,he,_e,Pe){var Oe;for(Oe=0;Oe<he;++Oe){var ot=k[N](_e[Pe+Oe-1],te,ce+Oe);_e[Pe+Oe]=ft(R[V+Oe],ot)}}}function Nr(){this.ud=this.hd=this.jd=0}function se(N,A){return((4278124286&(N^A))>>>1)+(N&A)>>>0}function rt(N){return 0<=N&&256>N?N:0>N?0:255<N?255:void 0}function mt(N,A){return rt(N+(N-A+.5>>1))}function tr(N,A,R){return Math.abs(A-R)-Math.abs(N-R)}function Ce(N,A,R,V,te,ce,he){for(V=ce[he-1],R=0;R<te;++R)ce[he+R]=V=ft(N[A+R],V)}function je(N,A,R,V,te){var ce;for(ce=0;ce<R;++ce){var he=N[A+ce],_e=he>>8&255,Pe=16711935&(Pe=(Pe=16711935&he)+((_e<<16)+_e));V[te+ce]=(4278255360&he)+Pe>>>0}}function ae(N,A){A.jd=255&N,A.hd=N>>8&255,A.ud=N>>16&255}function $e(N,A,R,V,te,ce){var he;for(he=0;he<V;++he){var _e=A[R+he],Pe=_e>>>8,Oe=_e,ot=255&(ot=(ot=_e>>>16)+((N.jd<<24>>24)*(Pe<<24>>24)>>>5));Oe=255&(Oe=(Oe+=(N.hd<<24>>24)*(Pe<<24>>24)>>>5)+((N.ud<<24>>24)*(ot<<24>>24)>>>5)),te[ce+he]=(4278255360&_e)+(ot<<16)+Oe}}function Ae(N,A,R,V,te){k[A]=function(ce,he,_e,Pe,Oe,ot,Ut,Ie,bt){for(Pe=Ut;Pe<Ie;++Pe)for(Ut=0;Ut<bt;++Ut)Oe[ot++]=te(_e[V(ce[he++])])},k[N]=function(ce,he,_e,Pe,Oe,ot,Ut){var Ie=8>>ce.b,bt=ce.Ea,Dt=ce.K[0],ur=ce.w;if(8>Ie)for(ce=(1<<ce.b)-1,ur=(1<<Ie)-1;he<_e;++he){var Bt,hr=0;for(Bt=0;Bt<bt;++Bt)Bt&ce||(hr=V(Pe[Oe++])),ot[Ut++]=te(Dt[hr&ur]),hr>>=Ie}else k["VP8LMapColor"+R](Pe,Oe,Dt,ur,ot,Ut,he,_e,bt)}}function Tt(N,A,R,V,te){for(R=A+R;A<R;){var ce=N[A++];V[te++]=ce>>16&255,V[te++]=ce>>8&255,V[te++]=255&ce}}function Se(N,A,R,V,te){for(R=A+R;A<R;){var ce=N[A++];V[te++]=ce>>16&255,V[te++]=ce>>8&255,V[te++]=255&ce,V[te++]=ce>>24&255}}function Ne(N,A,R,V,te){for(R=A+R;A<R;){var ce=(he=N[A++])>>16&240|he>>12&15,he=240&he|he>>28&15;V[te++]=ce,V[te++]=he}}function Ue(N,A,R,V,te){for(R=A+R;A<R;){var ce=(he=N[A++])>>16&248|he>>13&7,he=he>>5&224|he>>3&31;V[te++]=ce,V[te++]=he}}function Qe(N,A,R,V,te){for(R=A+R;A<R;){var ce=N[A++];V[te++]=255&ce,V[te++]=ce>>8&255,V[te++]=ce>>16&255}}function et(N,A,R,V,te,ce){if(ce==0)for(R=A+R;A<R;)me(V,((ce=N[A++])[0]>>24|ce[1]>>8&65280|ce[2]<<8&16711680|ce[3]<<24)>>>0),te+=32;else n(V,te,N,A,R)}function pt(N,A){k[A][0]=k[N+"0"],k[A][1]=k[N+"1"],k[A][2]=k[N+"2"],k[A][3]=k[N+"3"],k[A][4]=k[N+"4"],k[A][5]=k[N+"5"],k[A][6]=k[N+"6"],k[A][7]=k[N+"7"],k[A][8]=k[N+"8"],k[A][9]=k[N+"9"],k[A][10]=k[N+"10"],k[A][11]=k[N+"11"],k[A][12]=k[N+"12"],k[A][13]=k[N+"13"],k[A][14]=k[N+"0"],k[A][15]=k[N+"0"]}function Ke(N){return N==Di||N==da||N==li||N==Co}function qt(){this.eb=[],this.size=this.A=this.fb=0}function lt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function rr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new qt,this.f.kb=new lt,this.sd=null}function nt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function $t(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Qr(N){return alert("todo:WebPSamplerProcessPlane"),N.T}function Xr(N,A){var R=N.T,V=A.ba.f.RGBA,te=V.eb,ce=V.fb+N.ka*V.A,he=Lc[A.ba.S],_e=N.y,Pe=N.O,Oe=N.f,ot=N.N,Ut=N.ea,Ie=N.W,bt=A.cc,Dt=A.dc,ur=A.Mc,Bt=A.Nc,hr=N.ka,vr=N.ka+N.T,Or=N.U,Sr=Or+1>>1;for(hr==0?he(_e,Pe,null,null,Oe,ot,Ut,Ie,Oe,ot,Ut,Ie,te,ce,null,null,Or):(he(A.ec,A.fc,_e,Pe,bt,Dt,ur,Bt,Oe,ot,Ut,Ie,te,ce-V.A,te,ce,Or),++R);hr+2<vr;hr+=2)bt=Oe,Dt=ot,ur=Ut,Bt=Ie,ot+=N.Rc,Ie+=N.Rc,ce+=2*V.A,he(_e,(Pe+=2*N.fa)-N.fa,_e,Pe,bt,Dt,ur,Bt,Oe,ot,Ut,Ie,te,ce-V.A,te,ce,Or);return Pe+=N.fa,N.j+vr<N.o?(n(A.ec,A.fc,_e,Pe,Or),n(A.cc,A.dc,Oe,ot,Sr),n(A.Mc,A.Nc,Ut,Ie,Sr),R--):1&vr||he(_e,Pe,null,null,Oe,ot,Ut,Ie,Oe,ot,Ut,Ie,te,ce+V.A,null,null,Or),R}function In(N,A,R){var V=N.F,te=[N.J];if(V!=null){var ce=N.U,he=A.ba.S,_e=he==Za||he==li;A=A.ba.f.RGBA;var Pe=[0],Oe=N.ka;Pe[0]=N.T,N.Kb&&(Oe==0?--Pe[0]:(--Oe,te[0]-=N.width),N.j+N.ka+N.T==N.o&&(Pe[0]=N.o-N.j-Oe));var ot=A.eb;Oe=A.fb+Oe*A.A,N=Kt(V,te[0],N.width,ce,Pe,ot,Oe+(_e?0:3),A.A),t(R==Pe),N&&Ke(he)&&Ct(ot,Oe,_e,ce,Pe,A.A)}return 0}function sn(N){var A=N.ma,R=A.ba.S,V=11>R,te=R==Es||R==Ti||R==Za||R==Lo||R==12||Ke(R);if(A.memory=null,A.Ib=null,A.Jb=null,A.Nd=null,!Ul(A.Oa,N,te?11:12))return 0;if(te&&Ke(R)&&xi(),N.da)alert("todo:use_scaling");else{if(V){if(A.Ib=Qr,N.Kb){if(R=N.U+1>>1,A.memory=i(N.U+2*R),A.memory==null)return 0;A.ec=A.memory,A.fc=0,A.cc=A.ec,A.dc=A.fc+N.U,A.Mc=A.cc,A.Nc=A.dc+R,A.Ib=Xr,xi()}}else alert("todo:EmitYUV");te&&(A.Jb=In,V&&Rn())}if(V&&!xR){for(N=0;256>N;++N)oie[N]=89858*(N-128)+Cw>>Sw,lie[N]=-22014*(N-128)+Cw,sie[N]=-45773*(N-128),iie[N]=113618*(N-128)+Cw>>Sw;for(N=N0;N<O5;++N)A=76283*(N-16)+Cw>>Sw,cie[N-N0]=ga(A,255),die[N-N0]=ga(A+8>>4,15);xR=1}return 1}function Qt(N){var A=N.ma,R=N.U,V=N.T;return t(!(1&N.ka)),0>=R||0>=V?0:(R=A.Ib(N,A),A.Jb!=null&&A.Jb(N,A,R),A.Dc+=R,1)}function qr(N){N.ma.memory=null}function Tr(N,A,R,V){return xe(N,8)!=47?0:(A[0]=xe(N,14)+1,R[0]=xe(N,14)+1,V[0]=xe(N,1),xe(N,3)!=0?0:!N.h)}function sr(N,A){if(4>N)return N+1;var R=N-2>>1;return(2+(1&N)<<R)+xe(A,R)+1}function $r(N,A){return 120<A?A-120:1<=(R=((R=Woe[A-1])>>4)*N+(8-(15&R)))?R:1;var R}function Gr(N,A,R){var V=W(R),te=N[A+=255&V].g-8;return 0<te&&(le(R,R.u+8),V=W(R),A+=N[A].value,A+=V&(1<<te)-1),le(R,R.u+N[A].g),N[A].value}function ke(N,A,R){return R.g+=N.g,R.value+=N.value<<A>>>0,t(8>=R.g),N.g}function Mt(N,A,R){var V=N.xc;return t((A=V==0?0:N.vc[N.md*(R>>V)+(A>>V)])<N.Wb),N.Ya[A]}function wr(N,A,R,V){var te=N.ab,ce=N.c*A,he=N.C;A=he+A;var _e=R,Pe=V;for(V=N.Ta,R=N.Ua;0<te--;){var Oe=N.gc[te],ot=he,Ut=A,Ie=_e,bt=Pe,Dt=(Pe=V,_e=R,Oe.Ea);switch(t(ot<Ut),t(Ut<=Oe.nc),Oe.hc){case 2:co(Ie,bt,(Ut-ot)*Dt,Pe,_e);break;case 0:var ur=ot,Bt=Ut,hr=Pe,vr=_e,Or=(yn=Oe).Ea;ur==0&&(kc(Ie,bt,null,null,1,hr,vr),Ce(Ie,bt+1,0,0,Or-1,hr,vr+1),bt+=Or,vr+=Or,++ur);for(var Sr=1<<yn.b,An=Sr-1,mn=st(Or,yn.b),ua=yn.K,yn=yn.w+(ur>>yn.b)*mn;ur<Bt;){var Oa=ua,Mi=yn,fa=1;for(Oc(Ie,bt,hr,vr-Or,1,hr,vr);fa<Or;){var bn=(fa&~An)+Sr;bn>Or&&(bn=Or),(0,Ic[Oa[Mi++]>>8&15])(Ie,bt+ +fa,hr,vr+fa-Or,bn-fa,hr,vr+fa),fa=bn}bt+=Or,vr+=Or,++ur&An||(yn+=mn)}Ut!=Oe.nc&&n(Pe,_e-Dt,Pe,_e+(Ut-ot-1)*Dt,Dt);break;case 1:for(Dt=Ie,Bt=bt,Or=(Ie=Oe.Ea)-(vr=Ie&~(hr=(bt=1<<Oe.b)-1)),ur=st(Ie,Oe.b),Sr=Oe.K,Oe=Oe.w+(ot>>Oe.b)*ur;ot<Ut;){for(An=Sr,mn=Oe,ua=new Nr,yn=Bt+vr,Oa=Bt+Ie;Bt<yn;)ae(An[mn++],ua),Ih(ua,Dt,Bt,bt,Pe,_e),Bt+=bt,_e+=bt;Bt<Oa&&(ae(An[mn++],ua),Ih(ua,Dt,Bt,Or,Pe,_e),Bt+=Or,_e+=Or),++ot&hr||(Oe+=ur)}break;case 3:if(Ie==Pe&&bt==_e&&0<Oe.b){for(Bt=Pe,Ie=Dt=_e+(Ut-ot)*Dt-(vr=(Ut-ot)*st(Oe.Ea,Oe.b)),bt=Pe,hr=_e,ur=[],vr=(Or=vr)-1;0<=vr;--vr)ur[vr]=bt[hr+vr];for(vr=Or-1;0<=vr;--vr)Bt[Ie+vr]=ur[vr];Vl(Oe,ot,Ut,Pe,Dt,Pe,_e)}else Vl(Oe,ot,Ut,Ie,bt,Pe,_e)}_e=V,Pe=R}Pe!=R&&n(V,R,_e,Pe,ce)}function Fr(N,A){var R=N.V,V=N.Ba+N.c*N.C,te=A-N.C;if(t(A<=N.l.o),t(16>=te),0<te){var ce=N.l,he=N.Ta,_e=N.Ua,Pe=ce.width;if(wr(N,te,R,V),te=_e=[_e],t((R=N.C)<(V=A)),t(ce.v<ce.va),V>ce.o&&(V=ce.o),R<ce.j){var Oe=ce.j-R;R=ce.j,te[0]+=Oe*Pe}if(R>=V?R=0:(te[0]+=4*ce.v,ce.ka=R-ce.j,ce.U=ce.va-ce.v,ce.T=V-R,R=1),R){if(_e=_e[0],11>(R=N.ca).S){var ot=R.f.RGBA,Ut=(V=R.S,te=ce.U,ce=ce.T,Oe=ot.eb,ot.A),Ie=ce;for(ot=ot.fb+N.Ma*ot.A;0<Ie--;){var bt=he,Dt=_e,ur=te,Bt=Oe,hr=ot;switch(V){case pa:Wf(bt,Dt,ur,Bt,hr);break;case Es:Tc(bt,Dt,ur,Bt,hr);break;case Di:Tc(bt,Dt,ur,Bt,hr),Ct(Bt,hr,0,ur,1,0);break;case Qa:Ys(bt,Dt,ur,Bt,hr);break;case Ti:et(bt,Dt,ur,Bt,hr,1);break;case da:et(bt,Dt,ur,Bt,hr,1),Ct(Bt,hr,0,ur,1,0);break;case Za:et(bt,Dt,ur,Bt,hr,0);break;case li:et(bt,Dt,ur,Bt,hr,0),Ct(Bt,hr,1,ur,1,0);break;case Lo:Dc(bt,Dt,ur,Bt,hr);break;case Co:Dc(bt,Dt,ur,Bt,hr),_r(Bt,hr,ur,1,0);break;case hs:Mc(bt,Dt,ur,Bt,hr);break;default:t(0)}_e+=Pe,ot+=Ut}N.Ma+=ce}else alert("todo:EmitRescaledRowsYUVA");t(N.Ma<=R.height)}}N.C=A,t(N.C<=N.i)}function Ur(N){var A;if(0<N.ua)return 0;for(A=0;A<N.Wb;++A){var R=N.Ya[A].G,V=N.Ya[A].H;if(0<R[1][V[1]+0].g||0<R[2][V[2]+0].g||0<R[3][V[3]+0].g)return 0}return 1}function Kr(N,A,R,V,te,ce){if(N.Z!=0){var he=N.qd,_e=N.rd;for(t(Kf[N.Z]!=null);A<R;++A)Kf[N.Z](he,_e,V,te,V,te,ce),he=V,_e=te,te+=ce;N.qd=he,N.rd=_e}}function dn(N,A){var R=N.l.ma,V=R.Z==0||R.Z==1?N.l.j:N.C;if(V=N.C<V?V:N.C,t(A<=N.l.o),A>V){var te=N.l.width,ce=R.ca,he=R.tb+te*V,_e=N.V,Pe=N.Ba+N.c*V,Oe=N.gc;t(N.ab==1),t(Oe[0].hc==3),As(Oe[0],V,A,_e,Pe,ce,he),Kr(R,V,A,ce,he,te)}N.C=N.Ma=A}function wn(N,A,R,V,te,ce,he){var _e=N.$/V,Pe=N.$%V,Oe=N.m,ot=N.s,Ut=R+N.$,Ie=Ut;te=R+V*te;var bt=R+V*ce,Dt=280+ot.ua,ur=N.Pb?_e:16777216,Bt=0<ot.ua?ot.Wa:null,hr=ot.wc,vr=Ut<bt?Mt(ot,Pe,_e):null;t(N.C<ce),t(bt<=te);var Or=!1;e:for(;;){for(;Or||Ut<bt;){var Sr=0;if(_e>=ur){var An=Ut-R;t((ur=N).Pb),ur.wd=ur.m,ur.xd=An,0<ur.s.ua&&kt(ur.s.Wa,ur.s.vb),ur=_e+Goe}if(Pe&hr||(vr=Mt(ot,Pe,_e)),t(vr!=null),vr.Qb&&(A[Ut]=vr.qb,Or=!0),!Or)if(K(Oe),vr.jc){Sr=Oe,An=A;var mn=Ut,ua=vr.pd[W(Sr)&iu-1];t(vr.jc),256>ua.g?(le(Sr,Sr.u+ua.g),An[mn]=ua.value,Sr=0):(le(Sr,Sr.u+ua.g-256),t(256<=ua.value),Sr=ua.value),Sr==0&&(Or=!0)}else Sr=Gr(vr.G[0],vr.H[0],Oe);if(Oe.h)break;if(Or||256>Sr){if(!Or)if(vr.nd)A[Ut]=(vr.qb|Sr<<8)>>>0;else{if(K(Oe),Or=Gr(vr.G[1],vr.H[1],Oe),K(Oe),An=Gr(vr.G[2],vr.H[2],Oe),mn=Gr(vr.G[3],vr.H[3],Oe),Oe.h)break;A[Ut]=(mn<<24|Or<<16|Sr<<8|An)>>>0}if(Or=!1,++Ut,++Pe>=V&&(Pe=0,++_e,he!=null&&_e<=ce&&!(_e%16)&&he(N,_e),Bt!=null))for(;Ie<Ut;)Sr=A[Ie++],Bt.X[(506832829*Sr&4294967295)>>>Bt.Mb]=Sr}else if(280>Sr){if(Sr=sr(Sr-256,Oe),An=Gr(vr.G[4],vr.H[4],Oe),K(Oe),An=$r(V,An=sr(An,Oe)),Oe.h)break;if(Ut-R<An||te-Ut<Sr)break e;for(mn=0;mn<Sr;++mn)A[Ut+mn]=A[Ut+mn-An];for(Ut+=Sr,Pe+=Sr;Pe>=V;)Pe-=V,++_e,he!=null&&_e<=ce&&!(_e%16)&&he(N,_e);if(t(Ut<=te),Pe&hr&&(vr=Mt(ot,Pe,_e)),Bt!=null)for(;Ie<Ut;)Sr=A[Ie++],Bt.X[(506832829*Sr&4294967295)>>>Bt.Mb]=Sr}else{if(!(Sr<Dt))break e;for(Or=Sr-280,t(Bt!=null);Ie<Ut;)Sr=A[Ie++],Bt.X[(506832829*Sr&4294967295)>>>Bt.Mb]=Sr;Sr=Ut,t(!(Or>>>(An=Bt).Xa)),A[Sr]=An.X[Or],Or=!0}Or||t(Oe.h==ne(Oe))}if(N.Pb&&Oe.h&&Ut<te)t(N.m.h),N.a=5,N.m=N.wd,N.$=N.xd,0<N.s.ua&&kt(N.s.vb,N.s.Wa);else{if(Oe.h)break e;he?.(N,_e>ce?ce:_e),N.a=0,N.$=Ut-R}return 1}return N.a=3,0}function va(N){t(N!=null),N.vc=null,N.yc=null,N.Ya=null;var A=N.Wa;A!=null&&(A.X=null),N.vb=null,t(N!=null)}function xa(){var N=new Xt;return N==null?null:(N.a=0,N.xb=fR,pt("Predictor","VP8LPredictors"),pt("Predictor","VP8LPredictors_C"),pt("PredictorAdd","VP8LPredictorsAdd"),pt("PredictorAdd","VP8LPredictorsAdd_C"),co=je,Ih=$e,Wf=Tt,Tc=Se,Dc=Ne,Mc=Ue,Ys=Qe,k.VP8LMapColor32b=vo,k.VP8LMapColor8b=Gu,N)}function Aa(N,A,R,V,te){var ce=1,he=[N],_e=[A],Pe=V.m,Oe=V.s,ot=null,Ut=0;e:for(;;){if(R)for(;ce&&xe(Pe,1);){var Ie=he,bt=_e,Dt=V,ur=1,Bt=Dt.m,hr=Dt.gc[Dt.ab],vr=xe(Bt,2);if(Dt.Oc&1<<vr)ce=0;else{switch(Dt.Oc|=1<<vr,hr.hc=vr,hr.Ea=Ie[0],hr.nc=bt[0],hr.K=[null],++Dt.ab,t(4>=Dt.ab),vr){case 0:case 1:hr.b=xe(Bt,3)+2,ur=Aa(st(hr.Ea,hr.b),st(hr.nc,hr.b),0,Dt,hr.K),hr.K=hr.K[0];break;case 3:var Or,Sr=xe(Bt,8)+1,An=16<Sr?0:4<Sr?1:2<Sr?2:3;if(Ie[0]=st(hr.Ea,An),hr.b=An,Or=ur=Aa(Sr,1,0,Dt,hr.K)){var mn,ua=Sr,yn=hr,Oa=1<<(8>>yn.b),Mi=i(Oa);if(Mi==null)Or=0;else{var fa=yn.K[0],bn=yn.w;for(Mi[0]=yn.K[0][0],mn=1;mn<1*ua;++mn)Mi[mn]=ft(fa[bn+mn],Mi[mn-1]);for(;mn<4*Oa;++mn)Mi[mn]=0;yn.K[0]=null,yn.K[0]=Mi,Or=1}}ur=Or;break;case 2:break;default:t(0)}ce=ur}}if(he=he[0],_e=_e[0],ce&&xe(Pe,1)&&!(ce=1<=(Ut=xe(Pe,4))&&11>=Ut)){V.a=3;break e}var Yr;if(Yr=ce)t:{var ci,oa,Fa,Po=V,ps=he,Js=_e,Qo=Ut,ks=R,Qs=Po.m,Ri=Po.s,za=[null],eo=1,Zo=0,to=Hoe[Qo];r:for(;;){if(ks&&xe(Qs,1)){var gs=xe(Qs,3)+2,wd=st(ps,gs),di=st(Js,gs),wl=wd*di;if(!Aa(wd,di,0,Po,za))break r;for(za=za[0],Ri.xc=gs,ci=0;ci<wl;++ci){var mo=za[ci]>>8&65535;za[ci]=mo,mo>=eo&&(eo=mo+1)}}if(Qs.h)break r;for(oa=0;5>oa;++oa){var Li=yd[oa];!oa&&0<Qo&&(Li+=1<<Qo),Zo<Li&&(Zo=Li)}var Wl=s(eo*to,T),Zs=eo,Hl=s(Zs,B);if(Hl==null)var Gl=null;else t(65536>=Zs),Gl=Hl;var jl=i(Zo);if(Gl==null||jl==null||Wl==null){Po.a=1;break r}var Kl=Wl;for(ci=Fa=0;ci<eo;++ci){var xo=Gl[ci],Yl=xo.G,jd=xo.H,Mh=0,Xu=1,vs=0;for(oa=0;5>oa;++oa){Li=yd[oa],Yl[oa]=Kl,jd[oa]=Fa,!oa&&0<Qo&&(Li+=1<<Qo);a:{var Aw,I5=Li,Ew=Po,_0=jl,mie=Kl,hie=Fa,T5=0,Yf=Ew.m,pie=xe(Yf,1);if(a(_0,0,0,I5),pie){var gie=xe(Yf,1)+1,vie=xe(Yf,1),wR=xe(Yf,vie==0?1:8);_0[wR]=1,gie==2&&(_0[wR=xe(Yf,8)]=1);var kw=1}else{var jR=i(19),NR=xe(Yf,4)+4;if(19<NR){Ew.a=3;var Ow=0;break a}for(Aw=0;Aw<NR;++Aw)jR[Voe[Aw]]=xe(Yf,3);var D5=void 0,S0=void 0,_R=Ew,xie=jR,Iw=I5,SR=_0,M5=0,Xf=_R.m,CR=8,PR=s(128,T);n:for(;I(PR,0,7,xie,19);){if(xe(Xf,1)){var yie=2+2*xe(Xf,3);if((D5=2+xe(Xf,yie))>Iw)break n}else D5=Iw;for(S0=0;S0<Iw&&D5--;){K(Xf);var AR=PR[0+(127&W(Xf))];le(Xf,Xf.u+AR.g);var _g=AR.value;if(16>_g)SR[S0++]=_g,_g!=0&&(CR=_g);else{var bie=_g==16,ER=_g-16,wie=Xs[ER],kR=xe(Xf,Qi[ER])+wie;if(S0+kR>Iw)break n;for(var jie=bie?CR:0;0<kR--;)SR[S0++]=jie}}M5=1;break n}M5||(_R.a=3),kw=M5}(kw=kw&&!Yf.h)&&(T5=I(mie,hie,8,_0,I5)),kw&&T5!=0?Ow=T5:(Ew.a=3,Ow=0)}if(Ow==0)break r;if(Xu&&Uoe[oa]==1&&(Xu=Kl[Fa].g==0),Mh+=Kl[Fa].g,Fa+=Ow,3>=oa){var C0,R5=jl[0];for(C0=1;C0<Li;++C0)jl[C0]>R5&&(R5=jl[C0]);vs+=R5}}if(xo.nd=Xu,xo.Qb=0,Xu&&(xo.qb=(Yl[3][jd[3]+0].value<<24|Yl[1][jd[1]+0].value<<16|Yl[2][jd[2]+0].value)>>>0,Mh==0&&256>Yl[0][jd[0]+0].value&&(xo.Qb=1,xo.qb+=Yl[0][jd[0]+0].value<<8)),xo.jc=!xo.Qb&&6>vs,xo.jc){var Tw,Ju=xo;for(Tw=0;Tw<iu;++Tw){var Jf=Tw,Qf=Ju.pd[Jf],Dw=Ju.G[0][Ju.H[0]+Jf];256<=Dw.value?(Qf.g=Dw.g+256,Qf.value=Dw.value):(Qf.g=0,Qf.value=0,Jf>>=ke(Dw,8,Qf),Jf>>=ke(Ju.G[1][Ju.H[1]+Jf],16,Qf),Jf>>=ke(Ju.G[2][Ju.H[2]+Jf],0,Qf),ke(Ju.G[3][Ju.H[3]+Jf],24,Qf))}}}Ri.vc=za,Ri.Wb=eo,Ri.Ya=Gl,Ri.yc=Wl,Yr=1;break t}Yr=0}if(!(ce=Yr)){V.a=3;break e}if(0<Ut){if(Oe.ua=1<<Ut,!ee(Oe.Wa,Ut)){V.a=1,ce=0;break e}}else Oe.ua=0;var L5=V,OR=he,Nie=_e,$5=L5.s,F5=$5.xc;if(L5.c=OR,L5.i=Nie,$5.md=st(OR,F5),$5.wc=F5==0?-1:(1<<F5)-1,R){V.xb=eie;break e}if((ot=i(he*_e))==null){V.a=1,ce=0;break e}ce=(ce=wn(V,ot,0,he,_e,_e,null))&&!Pe.h;break e}return ce?(te!=null?te[0]=ot:(t(ot==null),t(R)),V.$=0,R||va(Oe)):va(Oe),ce}function ut(N,A){var R=N.c*N.i,V=R+A+16*A;return t(N.c<=A),N.V=i(V),N.V==null?(N.Ta=null,N.Ua=0,N.a=1,0):(N.Ta=N.V,N.Ua=N.Ba+R+A,1)}function Ht(N,A){var R=N.C,V=A-R,te=N.V,ce=N.Ba+N.c*R;for(t(A<=N.l.o);0<V;){var he=16<V?16:V,_e=N.l.ma,Pe=N.l.width,Oe=Pe*he,ot=_e.ca,Ut=_e.tb+Pe*R,Ie=N.Ta,bt=N.Ua;wr(N,he,te,ce),lr(Ie,bt,ot,Ut,Oe),Kr(_e,R,R+he,ot,Ut,Pe),V-=he,te+=he*N.c,R+=he}t(R==A),N.C=N.Ma=A}function dr(){this.ub=this.yd=this.td=this.Rb=0}function Ft(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ot(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function Br(){this.Yb=function(){var N=[];return function A(R,V,te){for(var ce=te[V],he=0;he<ce&&(R.push(te.length>V+1?[]:0),!(te.length<V+1));he++)A(R[he],V+1,te)}(N,0,[3,11]),N}()}function Vt(){this.jb=i(3),this.Wc=l([4,8],Br),this.Xc=l([4,17],Br)}function Cr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function ct(){this.ld=this.La=this.dd=this.tc=0}function Gt(){this.Na=this.la=0}function gr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function J(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ye(){this.uc=this.M=this.Nb=0,this.wa=Array(new ct),this.Y=0,this.ya=Array(new J),this.aa=0,this.l=new Ze}function Xe(){this.y=i(16),this.f=i(8),this.ea=i(8)}function it(){this.cb=this.a=0,this.sc="",this.m=new q,this.Od=new dr,this.Kc=new Ft,this.ed=new Cr,this.Qa=new Ot,this.Ic=this.$c=this.Aa=0,this.D=new Ye,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,q),this.ia=0,this.pb=s(4,gr),this.Pa=new Vt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Xe),this.Hd=0,this.rb=Array(new Gt),this.sb=0,this.wa=Array(new ct),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new J),this.L=this.aa=0,this.gd=l([4,2],ct),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Ze(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function dt(){var N=new it;return N!=null&&(N.a=0,N.sc="OK",N.cb=0,N.Xb=0,j0||(j0=H)),N}function Pt(N,A,R){return N.a==0&&(N.a=A,N.sc=R,N.cb=0),0}function zt(N,A,R){return 3<=R&&N[A+0]==157&&N[A+1]==1&&N[A+2]==42}function Er(N,A){if(N==null)return 0;if(N.a=0,N.sc="OK",A==null)return Pt(N,2,"null VP8Io passed to VP8GetHeaders()");var R=A.data,V=A.w,te=A.ha;if(4>te)return Pt(N,7,"Truncated header.");var ce=R[V+0]|R[V+1]<<8|R[V+2]<<16,he=N.Od;if(he.Rb=!(1&ce),he.td=ce>>1&7,he.yd=ce>>4&1,he.ub=ce>>5,3<he.td)return Pt(N,3,"Incorrect keyframe parameters.");if(!he.yd)return Pt(N,4,"Frame not displayable.");V+=3,te-=3;var _e=N.Kc;if(he.Rb){if(7>te)return Pt(N,7,"cannot parse picture header");if(!zt(R,V,te))return Pt(N,3,"Bad code word");_e.c=16383&(R[V+4]<<8|R[V+3]),_e.Td=R[V+4]>>6,_e.i=16383&(R[V+6]<<8|R[V+5]),_e.Ud=R[V+6]>>6,V+=7,te-=7,N.za=_e.c+15>>4,N.Ub=_e.i+15>>4,A.width=_e.c,A.height=_e.i,A.Da=0,A.j=0,A.v=0,A.va=A.width,A.o=A.height,A.da=0,A.ib=A.width,A.hb=A.height,A.U=A.width,A.T=A.height,a((ce=N.Pa).jb,0,255,ce.jb.length),t((ce=N.Qa)!=null),ce.Cb=0,ce.Bb=0,ce.Fb=1,a(ce.Zb,0,0,ce.Zb.length),a(ce.Lb,0,0,ce.Lb)}if(he.ub>te)return Pt(N,7,"bad partition length");U(ce=N.m,R,V,he.ub),V+=he.ub,te-=he.ub,he.Rb&&(_e.Ld=re(ce),_e.Kd=re(ce)),_e=N.Qa;var Pe,Oe=N.Pa;if(t(ce!=null),t(_e!=null),_e.Cb=re(ce),_e.Cb){if(_e.Bb=re(ce),re(ce)){for(_e.Fb=re(ce),Pe=0;4>Pe;++Pe)_e.Zb[Pe]=re(ce)?$(ce,7):0;for(Pe=0;4>Pe;++Pe)_e.Lb[Pe]=re(ce)?$(ce,6):0}if(_e.Bb)for(Pe=0;3>Pe;++Pe)Oe.jb[Pe]=re(ce)?z(ce,8):255}else _e.Bb=0;if(ce.Ka)return Pt(N,3,"cannot parse segment header");if((_e=N.ed).zd=re(ce),_e.Tb=z(ce,6),_e.wb=z(ce,3),_e.Pc=re(ce),_e.Pc&&re(ce)){for(Oe=0;4>Oe;++Oe)re(ce)&&(_e.vd[Oe]=$(ce,6));for(Oe=0;4>Oe;++Oe)re(ce)&&(_e.od[Oe]=$(ce,6))}if(N.L=_e.Tb==0?0:_e.zd?1:2,ce.Ka)return Pt(N,3,"cannot parse filter header");var ot=te;if(te=Pe=V,V=Pe+ot,_e=ot,N.Xb=(1<<z(N.m,2))-1,ot<3*(Oe=N.Xb))R=7;else{for(Pe+=3*Oe,_e-=3*Oe,ot=0;ot<Oe;++ot){var Ut=R[te+0]|R[te+1]<<8|R[te+2]<<16;Ut>_e&&(Ut=_e),U(N.Jc[+ot],R,Pe,Ut),Pe+=Ut,_e-=Ut,te+=3}U(N.Jc[+Oe],R,Pe,_e),R=Pe<V?0:5}if(R!=0)return Pt(N,R,"cannot parse partitions");for(R=z(Pe=N.m,7),te=re(Pe)?$(Pe,4):0,V=re(Pe)?$(Pe,4):0,_e=re(Pe)?$(Pe,4):0,Oe=re(Pe)?$(Pe,4):0,Pe=re(Pe)?$(Pe,4):0,ot=N.Qa,Ut=0;4>Ut;++Ut){if(ot.Cb){var Ie=ot.Zb[Ut];ot.Fb||(Ie+=R)}else{if(0<Ut){N.pb[Ut]=N.pb[0];continue}Ie=R}var bt=N.pb[Ut];bt.Sc[0]=E5[ga(Ie+te,127)],bt.Sc[1]=k5[ga(Ie+0,127)],bt.Eb[0]=2*E5[ga(Ie+V,127)],bt.Eb[1]=101581*k5[ga(Ie+_e,127)]>>16,8>bt.Eb[1]&&(bt.Eb[1]=8),bt.Qc[0]=E5[ga(Ie+Oe,117)],bt.Qc[1]=k5[ga(Ie+Pe,127)],bt.lc=Ie+Pe}if(!he.Rb)return Pt(N,4,"Not a key frame.");for(re(ce),he=N.Pa,R=0;4>R;++R){for(te=0;8>te;++te)for(V=0;3>V;++V)for(_e=0;11>_e;++_e)Oe=G(ce,Qoe[R][te][V][_e])?z(ce,8):Xoe[R][te][V][_e],he.Wc[R][te].Yb[V][_e]=Oe;for(te=0;17>te;++te)he.Xc[R][te]=he.Wc[R][Zoe[te]]}return N.kc=re(ce),N.kc&&(N.Bd=z(ce,8)),N.cb=1}function H(N,A,R,V,te,ce,he){var _e=A[te].Yb[R];for(R=0;16>te;++te){if(!G(N,_e[R+0]))return te;for(;!G(N,_e[R+1]);)if(_e=A[++te].Yb[0],R=0,te==16)return 16;var Pe=A[te+1].Yb;if(G(N,_e[R+2])){var Oe=N,ot=0;if(G(Oe,(Ie=_e)[(Ut=R)+3]))if(G(Oe,Ie[Ut+6])){for(_e=0,Ut=2*(ot=G(Oe,Ie[Ut+8]))+(Ie=G(Oe,Ie[Ut+9+ot])),ot=0,Ie=Koe[Ut];Ie[_e];++_e)ot+=ot+G(Oe,Ie[_e]);ot+=3+(8<<Ut)}else G(Oe,Ie[Ut+7])?(ot=7+2*G(Oe,165),ot+=G(Oe,145)):ot=5+G(Oe,159);else ot=G(Oe,Ie[Ut+4])?3+G(Oe,Ie[Ut+5]):2;_e=Pe[2]}else ot=1,_e=Pe[1];Pe=he+Yoe[te],0>(Oe=N).b&&Q(Oe);var Ut,Ie=Oe.b,bt=(Ut=Oe.Ca>>1)-(Oe.I>>Ie)>>31;--Oe.b,Oe.Ca+=bt,Oe.Ca|=1,Oe.I-=(Ut+1&bt)<<Ie,ce[Pe]=((ot^bt)-bt)*V[(0<te)+0]}return 16}function Ee(N){var A=N.rb[N.sb-1];A.la=0,A.Na=0,a(N.zc,0,0,N.zc.length),N.ja=0}function Te(N,A,R,V,te){te=N[A+R+32*V]+(te>>3),N[A+R+32*V]=-256&te?0>te?0:255:te}function vt(N,A,R,V,te,ce){Te(N,A,0,R,V+te),Te(N,A,1,R,V+ce),Te(N,A,2,R,V-ce),Te(N,A,3,R,V-te)}function ze(N){return(20091*N>>16)+N}function at(N,A,R,V){var te,ce=0,he=i(16);for(te=0;4>te;++te){var _e=N[A+0]+N[A+8],Pe=N[A+0]-N[A+8],Oe=(35468*N[A+4]>>16)-ze(N[A+12]),ot=ze(N[A+4])+(35468*N[A+12]>>16);he[ce+0]=_e+ot,he[ce+1]=Pe+Oe,he[ce+2]=Pe-Oe,he[ce+3]=_e-ot,ce+=4,A++}for(te=ce=0;4>te;++te)_e=(N=he[ce+0]+4)+he[ce+8],Pe=N-he[ce+8],Oe=(35468*he[ce+4]>>16)-ze(he[ce+12]),Te(R,V,0,0,_e+(ot=ze(he[ce+4])+(35468*he[ce+12]>>16))),Te(R,V,1,0,Pe+Oe),Te(R,V,2,0,Pe-Oe),Te(R,V,3,0,_e-ot),ce++,V+=32}function Zt(N,A,R,V){var te=N[A+0]+4,ce=35468*N[A+4]>>16,he=ze(N[A+4]),_e=35468*N[A+1]>>16;vt(R,V,0,te+he,N=ze(N[A+1]),_e),vt(R,V,1,te+ce,N,_e),vt(R,V,2,te-ce,N,_e),vt(R,V,3,te-he,N,_e)}function zr(N,A,R,V,te){at(N,A,R,V),te&&at(N,A+16,R,V+4)}function Ar(N,A,R,V){bi(N,A+0,R,V,1),bi(N,A+32,R,V+128,1)}function br(N,A,R,V){var te;for(N=N[A+0]+4,te=0;4>te;++te)for(A=0;4>A;++A)Te(R,V,A,te,N)}function yr(N,A,R,V){N[A+0]&&ca(N,A+0,R,V),N[A+16]&&ca(N,A+16,R,V+4),N[A+32]&&ca(N,A+32,R,V+128),N[A+48]&&ca(N,A+48,R,V+128+4)}function nr(N,A,R,V){var te,ce=i(16);for(te=0;4>te;++te){var he=N[A+0+te]+N[A+12+te],_e=N[A+4+te]+N[A+8+te],Pe=N[A+4+te]-N[A+8+te],Oe=N[A+0+te]-N[A+12+te];ce[0+te]=he+_e,ce[8+te]=he-_e,ce[4+te]=Oe+Pe,ce[12+te]=Oe-Pe}for(te=0;4>te;++te)he=(N=ce[0+4*te]+3)+ce[3+4*te],_e=ce[1+4*te]+ce[2+4*te],Pe=ce[1+4*te]-ce[2+4*te],Oe=N-ce[3+4*te],R[V+0]=he+_e>>3,R[V+16]=Oe+Pe>>3,R[V+32]=he-_e>>3,R[V+48]=Oe-Pe>>3,V+=64}function Zr(N,A,R){var V,te=A-32,ce=$a,he=255-N[te-1];for(V=0;V<R;++V){var _e,Pe=ce,Oe=he+N[A-1];for(_e=0;_e<R;++_e)N[A+_e]=Pe[Oe+N[te+_e]];A+=32}}function tt(N,A){Zr(N,A,4)}function Lr(N,A){Zr(N,A,8)}function cn(N,A){Zr(N,A,16)}function pn(N,A){var R;for(R=0;16>R;++R)n(N,A+32*R,N,A-32,16)}function jn(N,A){var R;for(R=16;0<R;--R)a(N,A,N[A-1],16),A+=32}function Gn(N,A,R){var V;for(V=0;16>V;++V)a(A,R+32*V,N,16)}function Ln(N,A){var R,V=16;for(R=0;16>R;++R)V+=N[A-1+32*R]+N[A+R-32];Gn(V>>5,N,A)}function aa(N,A){var R,V=8;for(R=0;16>R;++R)V+=N[A-1+32*R];Gn(V>>4,N,A)}function Bn(N,A){var R,V=8;for(R=0;16>R;++R)V+=N[A+R-32];Gn(V>>4,N,A)}function ya(N,A){Gn(128,N,A)}function an(N,A,R){return N+2*A+R+2>>2}function Ea(N,A){var R,V=A-32;for(V=new Uint8Array([an(N[V-1],N[V+0],N[V+1]),an(N[V+0],N[V+1],N[V+2]),an(N[V+1],N[V+2],N[V+3]),an(N[V+2],N[V+3],N[V+4])]),R=0;4>R;++R)n(N,A+32*R,V,0,V.length)}function Sa(N,A){var R=N[A-1],V=N[A-1+32],te=N[A-1+64],ce=N[A-1+96];me(N,A+0,16843009*an(N[A-1-32],R,V)),me(N,A+32,16843009*an(R,V,te)),me(N,A+64,16843009*an(V,te,ce)),me(N,A+96,16843009*an(te,ce,ce))}function ba(N,A){var R,V=4;for(R=0;4>R;++R)V+=N[A+R-32]+N[A-1+32*R];for(V>>=3,R=0;4>R;++R)a(N,A+32*R,V,4)}function Mo(N,A){var R=N[A-1+0],V=N[A-1+32],te=N[A-1+64],ce=N[A-1-32],he=N[A+0-32],_e=N[A+1-32],Pe=N[A+2-32],Oe=N[A+3-32];N[A+0+96]=an(V,te,N[A-1+96]),N[A+1+96]=N[A+0+64]=an(R,V,te),N[A+2+96]=N[A+1+64]=N[A+0+32]=an(ce,R,V),N[A+3+96]=N[A+2+64]=N[A+1+32]=N[A+0+0]=an(he,ce,R),N[A+3+64]=N[A+2+32]=N[A+1+0]=an(_e,he,ce),N[A+3+32]=N[A+2+0]=an(Pe,_e,he),N[A+3+0]=an(Oe,Pe,_e)}function vi(N,A){var R=N[A+1-32],V=N[A+2-32],te=N[A+3-32],ce=N[A+4-32],he=N[A+5-32],_e=N[A+6-32],Pe=N[A+7-32];N[A+0+0]=an(N[A+0-32],R,V),N[A+1+0]=N[A+0+32]=an(R,V,te),N[A+2+0]=N[A+1+32]=N[A+0+64]=an(V,te,ce),N[A+3+0]=N[A+2+32]=N[A+1+64]=N[A+0+96]=an(te,ce,he),N[A+3+32]=N[A+2+64]=N[A+1+96]=an(ce,he,_e),N[A+3+64]=N[A+2+96]=an(he,_e,Pe),N[A+3+96]=an(_e,Pe,Pe)}function lo(N,A){var R=N[A-1+0],V=N[A-1+32],te=N[A-1+64],ce=N[A-1-32],he=N[A+0-32],_e=N[A+1-32],Pe=N[A+2-32],Oe=N[A+3-32];N[A+0+0]=N[A+1+64]=ce+he+1>>1,N[A+1+0]=N[A+2+64]=he+_e+1>>1,N[A+2+0]=N[A+3+64]=_e+Pe+1>>1,N[A+3+0]=Pe+Oe+1>>1,N[A+0+96]=an(te,V,R),N[A+0+64]=an(V,R,ce),N[A+0+32]=N[A+1+96]=an(R,ce,he),N[A+1+32]=N[A+2+96]=an(ce,he,_e),N[A+2+32]=N[A+3+96]=an(he,_e,Pe),N[A+3+32]=an(_e,Pe,Oe)}function zl(N,A){var R=N[A+0-32],V=N[A+1-32],te=N[A+2-32],ce=N[A+3-32],he=N[A+4-32],_e=N[A+5-32],Pe=N[A+6-32],Oe=N[A+7-32];N[A+0+0]=R+V+1>>1,N[A+1+0]=N[A+0+64]=V+te+1>>1,N[A+2+0]=N[A+1+64]=te+ce+1>>1,N[A+3+0]=N[A+2+64]=ce+he+1>>1,N[A+0+32]=an(R,V,te),N[A+1+32]=N[A+0+96]=an(V,te,ce),N[A+2+32]=N[A+1+96]=an(te,ce,he),N[A+3+32]=N[A+2+96]=an(ce,he,_e),N[A+3+64]=an(he,_e,Pe),N[A+3+96]=an(_e,Pe,Oe)}function yl(N,A){var R=N[A-1+0],V=N[A-1+32],te=N[A-1+64],ce=N[A-1+96];N[A+0+0]=R+V+1>>1,N[A+2+0]=N[A+0+32]=V+te+1>>1,N[A+2+32]=N[A+0+64]=te+ce+1>>1,N[A+1+0]=an(R,V,te),N[A+3+0]=N[A+1+32]=an(V,te,ce),N[A+3+32]=N[A+1+64]=an(te,ce,ce),N[A+3+64]=N[A+2+64]=N[A+0+96]=N[A+1+96]=N[A+2+96]=N[A+3+96]=ce}function ue(N,A){var R=N[A-1+0],V=N[A-1+32],te=N[A-1+64],ce=N[A-1+96],he=N[A-1-32],_e=N[A+0-32],Pe=N[A+1-32],Oe=N[A+2-32];N[A+0+0]=N[A+2+32]=R+he+1>>1,N[A+0+32]=N[A+2+64]=V+R+1>>1,N[A+0+64]=N[A+2+96]=te+V+1>>1,N[A+0+96]=ce+te+1>>1,N[A+3+0]=an(_e,Pe,Oe),N[A+2+0]=an(he,_e,Pe),N[A+1+0]=N[A+3+32]=an(R,he,_e),N[A+1+32]=N[A+3+64]=an(V,R,he),N[A+1+64]=N[A+3+96]=an(te,V,R),N[A+1+96]=an(ce,te,V)}function Fe(N,A){var R;for(R=0;8>R;++R)n(N,A+32*R,N,A-32,8)}function ht(N,A){var R;for(R=0;8>R;++R)a(N,A,N[A-1],8),A+=32}function At(N,A,R){var V;for(V=0;8>V;++V)a(A,R+32*V,N,8)}function St(N,A){var R,V=8;for(R=0;8>R;++R)V+=N[A+R-32]+N[A-1+32*R];At(V>>4,N,A)}function xr(N,A){var R,V=4;for(R=0;8>R;++R)V+=N[A+R-32];At(V>>3,N,A)}function er(N,A){var R,V=4;for(R=0;8>R;++R)V+=N[A-1+32*R];At(V>>3,N,A)}function jr(N,A){At(128,N,A)}function cr(N,A,R){var V=N[A-R],te=N[A+0],ce=3*(te-V)+La[1020+N[A-2*R]-N[A+R]],he=ha[112+(ce+4>>3)];N[A-R]=$a[255+V+ha[112+(ce+3>>3)]],N[A+0]=$a[255+te-he]}function It(N,A,R,V){var te=N[A+0],ce=N[A+R];return Dn[255+N[A-2*R]-N[A-R]]>V||Dn[255+ce-te]>V}function Ir(N,A,R,V){return 4*Dn[255+N[A-R]-N[A+0]]+Dn[255+N[A-2*R]-N[A+R]]<=V}function ie(N,A,R,V,te){var ce=N[A-3*R],he=N[A-2*R],_e=N[A-R],Pe=N[A+0],Oe=N[A+R],ot=N[A+2*R],Ut=N[A+3*R];return 4*Dn[255+_e-Pe]+Dn[255+he-Oe]>V?0:Dn[255+N[A-4*R]-ce]<=te&&Dn[255+ce-he]<=te&&Dn[255+he-_e]<=te&&Dn[255+Ut-ot]<=te&&Dn[255+ot-Oe]<=te&&Dn[255+Oe-Pe]<=te}function be(N,A,R,V){var te=2*V+1;for(V=0;16>V;++V)Ir(N,A+V,R,te)&&cr(N,A+V,R)}function Ge(N,A,R,V){var te=2*V+1;for(V=0;16>V;++V)Ir(N,A+V*R,1,te)&&cr(N,A+V*R,1)}function We(N,A,R,V){var te;for(te=3;0<te;--te)be(N,A+=4*R,R,V)}function _t(N,A,R,V){var te;for(te=3;0<te;--te)Ge(N,A+=4,R,V)}function qe(N,A,R,V,te,ce,he,_e){for(ce=2*ce+1;0<te--;){if(ie(N,A,R,ce,he))if(It(N,A,R,_e))cr(N,A,R);else{var Pe=N,Oe=A,ot=R,Ut=Pe[Oe-2*ot],Ie=Pe[Oe-ot],bt=Pe[Oe+0],Dt=Pe[Oe+ot],ur=Pe[Oe+2*ot],Bt=27*(vr=La[1020+3*(bt-Ie)+La[1020+Ut-Dt]])+63>>7,hr=18*vr+63>>7,vr=9*vr+63>>7;Pe[Oe-3*ot]=$a[255+Pe[Oe-3*ot]+vr],Pe[Oe-2*ot]=$a[255+Ut+hr],Pe[Oe-ot]=$a[255+Ie+Bt],Pe[Oe+0]=$a[255+bt-Bt],Pe[Oe+ot]=$a[255+Dt-hr],Pe[Oe+2*ot]=$a[255+ur-vr]}A+=V}}function X(N,A,R,V,te,ce,he,_e){for(ce=2*ce+1;0<te--;){if(ie(N,A,R,ce,he))if(It(N,A,R,_e))cr(N,A,R);else{var Pe=N,Oe=A,ot=R,Ut=Pe[Oe-ot],Ie=Pe[Oe+0],bt=Pe[Oe+ot],Dt=ha[112+(4+(ur=3*(Ie-Ut))>>3)],ur=ha[112+(ur+3>>3)],Bt=Dt+1>>1;Pe[Oe-2*ot]=$a[255+Pe[Oe-2*ot]+Bt],Pe[Oe-ot]=$a[255+Ut+ur],Pe[Oe+0]=$a[255+Ie-Dt],Pe[Oe+ot]=$a[255+bt-Bt]}A+=V}}function Me(N,A,R,V,te,ce){qe(N,A,R,1,16,V,te,ce)}function gt(N,A,R,V,te,ce){qe(N,A,1,R,16,V,te,ce)}function ir(N,A,R,V,te,ce){var he;for(he=3;0<he;--he)X(N,A+=4*R,R,1,16,V,te,ce)}function Dr(N,A,R,V,te,ce){var he;for(he=3;0<he;--he)X(N,A+=4,1,R,16,V,te,ce)}function O(N,A,R,V,te,ce,he,_e){qe(N,A,te,1,8,ce,he,_e),qe(R,V,te,1,8,ce,he,_e)}function F(N,A,R,V,te,ce,he,_e){qe(N,A,1,te,8,ce,he,_e),qe(R,V,1,te,8,ce,he,_e)}function fe(N,A,R,V,te,ce,he,_e){X(N,A+4*te,te,1,8,ce,he,_e),X(R,V+4*te,te,1,8,ce,he,_e)}function we(N,A,R,V,te,ce,he,_e){X(N,A+4,1,te,8,ce,he,_e),X(R,V+4,1,te,8,ce,he,_e)}function Re(){this.ba=new rr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new $t,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Je(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function He(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Et(){this.ua=0,this.Wa=new Nt,this.vb=new Nt,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new B,this.yc=new T}function Xt(){this.xb=this.a=0,this.l=new Ze,this.ca=new rr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new L,this.Pb=0,this.wd=new L,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Et,this.ab=0,this.gc=s(4,He),this.Oc=0}function jt(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Ze,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Rt(N,A,R,V,te,ce,he){for(N=N==null?0:N[A+0],A=0;A<he;++A)te[ce+A]=N+R[V+A]&255,N=te[ce+A]}function ar(N,A,R,V,te,ce,he){var _e;if(N==null)Rt(null,null,R,V,te,ce,he);else for(_e=0;_e<he;++_e)te[ce+_e]=N[A+_e]+R[V+_e]&255}function pr(N,A,R,V,te,ce,he){if(N==null)Rt(null,null,R,V,te,ce,he);else{var _e,Pe=N[A+0],Oe=Pe,ot=Pe;for(_e=0;_e<he;++_e)Oe=ot+(Pe=N[A+_e])-Oe,ot=R[V+_e]+(-256&Oe?0>Oe?0:255:Oe)&255,Oe=Pe,te[ce+_e]=ot}}function Wr(N,A,R,V){var te=A.width,ce=A.o;if(t(N!=null&&A!=null),0>R||0>=V||R+V>ce)return null;if(!N.Cc){if(N.ga==null){var he;if(N.ga=new jt,(he=N.ga==null)||(he=A.width*A.o,t(N.Gb.length==0),N.Gb=i(he),N.Uc=0,N.Gb==null?he=0:(N.mb=N.Gb,N.nb=N.Uc,N.rc=null,he=1),he=!he),!he){he=N.ga;var _e=N.Fa,Pe=N.P,Oe=N.qc,ot=N.mb,Ut=N.nb,Ie=Pe+1,bt=Oe-1,Dt=he.l;if(t(_e!=null&&ot!=null&&A!=null),Kf[0]=null,Kf[1]=Rt,Kf[2]=ar,Kf[3]=pr,he.ca=ot,he.tb=Ut,he.c=A.width,he.i=A.height,t(0<he.c&&0<he.i),1>=Oe)A=0;else if(he.$a=3&_e[Pe+0],he.Z=_e[Pe+0]>>2&3,he.Lc=_e[Pe+0]>>4&3,Pe=_e[Pe+0]>>6&3,0>he.$a||1<he.$a||4<=he.Z||1<he.Lc||Pe)A=0;else if(Dt.put=Qt,Dt.ac=sn,Dt.bc=qr,Dt.ma=he,Dt.width=A.width,Dt.height=A.height,Dt.Da=A.Da,Dt.v=A.v,Dt.va=A.va,Dt.j=A.j,Dt.o=A.o,he.$a)e:{t(he.$a==1),A=xa();t:for(;;){if(A==null){A=0;break e}if(t(he!=null),he.mc=A,A.c=he.c,A.i=he.i,A.l=he.l,A.l.ma=he,A.l.width=he.c,A.l.height=he.i,A.a=0,Y(A.m,_e,Ie,bt),!Aa(he.c,he.i,1,A,null)||(A.ab==1&&A.gc[0].hc==3&&Ur(A.s)?(he.ic=1,_e=A.c*A.i,A.Ta=null,A.Ua=0,A.V=i(_e),A.Ba=0,A.V==null?(A.a=1,A=0):A=1):(he.ic=0,A=ut(A,he.c)),!A))break t;A=1;break e}he.mc=null,A=0}else A=bt>=he.c*he.i;he=!A}if(he)return null;N.ga.Lc!=1?N.Ga=0:V=ce-R}t(N.ga!=null),t(R+V<=ce);e:{if(A=(_e=N.ga).c,ce=_e.l.o,_e.$a==0){if(Ie=N.rc,bt=N.Vc,Dt=N.Fa,Pe=N.P+1+R*A,Oe=N.mb,ot=N.nb+R*A,t(Pe<=N.P+N.qc),_e.Z!=0)for(t(Kf[_e.Z]!=null),he=0;he<V;++he)Kf[_e.Z](Ie,bt,Dt,Pe,Oe,ot,A),Ie=Oe,bt=ot,ot+=A,Pe+=A;else for(he=0;he<V;++he)n(Oe,ot,Dt,Pe,A),Ie=Oe,bt=ot,ot+=A,Pe+=A;N.rc=Ie,N.Vc=bt}else{if(t(_e.mc!=null),A=R+V,t((he=_e.mc)!=null),t(A<=he.i),he.C>=A)A=1;else if(_e.ic||Rn(),_e.ic){_e=he.V,Ie=he.Ba,bt=he.c;var ur=he.i,Bt=(Dt=1,Pe=he.$/bt,Oe=he.$%bt,ot=he.m,Ut=he.s,he.$),hr=bt*ur,vr=bt*A,Or=Ut.wc,Sr=Bt<vr?Mt(Ut,Oe,Pe):null;t(Bt<=hr),t(A<=ur),t(Ur(Ut));t:for(;;){for(;!ot.h&&Bt<vr;){if(Oe&Or||(Sr=Mt(Ut,Oe,Pe)),t(Sr!=null),K(ot),256>(ur=Gr(Sr.G[0],Sr.H[0],ot)))_e[Ie+Bt]=ur,++Bt,++Oe>=bt&&(Oe=0,++Pe<=A&&!(Pe%16)&&dn(he,Pe));else{if(!(280>ur)){Dt=0;break t}ur=sr(ur-256,ot);var An,mn=Gr(Sr.G[4],Sr.H[4],ot);if(K(ot),!(Bt>=(mn=$r(bt,mn=sr(mn,ot)))&&hr-Bt>=ur)){Dt=0;break t}for(An=0;An<ur;++An)_e[Ie+Bt+An]=_e[Ie+Bt+An-mn];for(Bt+=ur,Oe+=ur;Oe>=bt;)Oe-=bt,++Pe<=A&&!(Pe%16)&&dn(he,Pe);Bt<vr&&Oe&Or&&(Sr=Mt(Ut,Oe,Pe))}t(ot.h==ne(ot))}dn(he,Pe>A?A:Pe);break t}!Dt||ot.h&&Bt<hr?(Dt=0,he.a=ot.h?5:3):he.$=Bt,A=Dt}else A=wn(he,he.V,he.Ba,he.c,he.i,A,Ht);if(!A){V=0;break e}}R+V>=ce&&(N.Cc=1),V=1}if(!V)return null;if(N.Cc&&((V=N.ga)!=null&&(V.mc=null),N.ga=null,0<N.Ga))return alert("todo:WebPDequantizeLevels"),null}return N.nb+R*te}function Pr(N,A,R,V,te,ce){for(;0<te--;){var he,_e=N,Pe=A+(R?1:0),Oe=N,ot=A+(R?0:3);for(he=0;he<V;++he){var Ut=Oe[ot+4*he];Ut!=255&&(Ut*=32897,_e[Pe+4*he+0]=_e[Pe+4*he+0]*Ut>>23,_e[Pe+4*he+1]=_e[Pe+4*he+1]*Ut>>23,_e[Pe+4*he+2]=_e[Pe+4*he+2]*Ut>>23)}A+=ce}}function Vr(N,A,R,V,te){for(;0<V--;){var ce;for(ce=0;ce<R;++ce){var he=N[A+2*ce+0],_e=15&(Oe=N[A+2*ce+1]),Pe=4369*_e,Oe=(240&Oe|Oe>>4)*Pe>>16;N[A+2*ce+0]=(240&he|he>>4)*Pe>>16&240|(15&he|he<<4)*Pe>>16>>4&15,N[A+2*ce+1]=240&Oe|_e}A+=te}}function Lt(N,A,R,V,te,ce,he,_e){var Pe,Oe,ot=255;for(Oe=0;Oe<te;++Oe){for(Pe=0;Pe<V;++Pe){var Ut=N[A+Pe];ce[he+4*Pe]=Ut,ot&=Ut}A+=R,he+=_e}return ot!=255}function xn(N,A,R,V,te){var ce;for(ce=0;ce<te;++ce)R[V+ce]=N[A+ce]>>8}function Rn(){Ct=Pr,_r=Vr,Kt=Lt,lr=xn}function Ma(N,A,R){k[N]=function(V,te,ce,he,_e,Pe,Oe,ot,Ut,Ie,bt,Dt,ur,Bt,hr,vr,Or){var Sr,An=Or-1>>1,mn=_e[Pe+0]|Oe[ot+0]<<16,ua=Ut[Ie+0]|bt[Dt+0]<<16;t(V!=null);var yn=3*mn+ua+131074>>2;for(A(V[te+0],255&yn,yn>>16,ur,Bt),ce!=null&&(yn=3*ua+mn+131074>>2,A(ce[he+0],255&yn,yn>>16,hr,vr)),Sr=1;Sr<=An;++Sr){var Oa=_e[Pe+Sr]|Oe[ot+Sr]<<16,Mi=Ut[Ie+Sr]|bt[Dt+Sr]<<16,fa=mn+Oa+ua+Mi+524296,bn=fa+2*(Oa+ua)>>3;yn=bn+mn>>1,mn=(fa=fa+2*(mn+Mi)>>3)+Oa>>1,A(V[te+2*Sr-1],255&yn,yn>>16,ur,Bt+(2*Sr-1)*R),A(V[te+2*Sr-0],255&mn,mn>>16,ur,Bt+(2*Sr-0)*R),ce!=null&&(yn=fa+ua>>1,mn=bn+Mi>>1,A(ce[he+2*Sr-1],255&yn,yn>>16,hr,vr+(2*Sr-1)*R),A(ce[he+2*Sr+0],255&mn,mn>>16,hr,vr+(2*Sr+0)*R)),mn=Oa,ua=Mi}1&Or||(yn=3*mn+ua+131074>>2,A(V[te+Or-1],255&yn,yn>>16,ur,Bt+(Or-1)*R),ce!=null&&(yn=3*ua+mn+131074>>2,A(ce[he+Or-1],255&yn,yn>>16,hr,vr+(Or-1)*R)))}}function xi(){Lc[pa]=tie,Lc[Es]=mR,Lc[Qa]=rie,Lc[Ti]=hR,Lc[Za]=pR,Lc[Lo]=gR,Lc[hs]=nie,Lc[Di]=mR,Lc[da]=hR,Lc[li]=pR,Lc[Co]=gR}function Xn(N){return N&~aie?0>N?0:255:N>>vR}function ka(N,A){return Xn((19077*N>>8)+(26149*A>>8)-14234)}function ma(N,A,R){return Xn((19077*N>>8)-(6419*A>>8)-(13320*R>>8)+8708)}function Ya(N,A){return Xn((19077*N>>8)+(33050*A>>8)-17685)}function Oi(N,A,R,V,te){V[te+0]=ka(N,R),V[te+1]=ma(N,A,R),V[te+2]=Ya(N,A)}function us(N,A,R,V,te){V[te+0]=Ya(N,A),V[te+1]=ma(N,A,R),V[te+2]=ka(N,R)}function Xa(N,A,R,V,te){var ce=ma(N,A,R);A=ce<<3&224|Ya(N,A)>>3,V[te+0]=248&ka(N,R)|ce>>5,V[te+1]=A}function Ro(N,A,R,V,te){var ce=240&Ya(N,A)|15;V[te+0]=240&ka(N,R)|ma(N,A,R)>>4,V[te+1]=ce}function Xi(N,A,R,V,te){V[te+0]=255,Oi(N,A,R,V,te+1)}function fo(N,A,R,V,te){us(N,A,R,V,te),V[te+3]=255}function fs(N,A,R,V,te){Oi(N,A,R,V,te),V[te+3]=255}function ga(N,A){return 0>N?0:N>A?A:N}function Ji(N,A,R){k[N]=function(V,te,ce,he,_e,Pe,Oe,ot,Ut){for(var Ie=ot+(-2&Ut)*R;ot!=Ie;)A(V[te+0],ce[he+0],_e[Pe+0],Oe,ot),A(V[te+1],ce[he+0],_e[Pe+0],Oe,ot+R),te+=2,++he,++Pe,ot+=2*R;1&Ut&&A(V[te+0],ce[he+0],_e[Pe+0],Oe,ot)}}function Hs(N,A,R){return R==0?N==0?A==0?6:5:A==0?4:0:R}function Hu(N,A,R,V,te){switch(N>>>30){case 3:bi(A,R,V,te,0);break;case 2:ms(A,R,V,te);break;case 1:ca(A,R,V,te)}}function Ra(N,A){var R,V,te=A.M,ce=A.Nb,he=N.oc,_e=N.pc+40,Pe=N.oc,Oe=N.pc+584,ot=N.oc,Ut=N.pc+600;for(R=0;16>R;++R)he[_e+32*R-1]=129;for(R=0;8>R;++R)Pe[Oe+32*R-1]=129,ot[Ut+32*R-1]=129;for(0<te?he[_e-1-32]=Pe[Oe-1-32]=ot[Ut-1-32]=129:(a(he,_e-32-1,127,21),a(Pe,Oe-32-1,127,9),a(ot,Ut-32-1,127,9)),V=0;V<N.za;++V){var Ie=A.ya[A.aa+V];if(0<V){for(R=-1;16>R;++R)n(he,_e+32*R-4,he,_e+32*R+12,4);for(R=-1;8>R;++R)n(Pe,Oe+32*R-4,Pe,Oe+32*R+4,4),n(ot,Ut+32*R-4,ot,Ut+32*R+4,4)}var bt=N.Gd,Dt=N.Hd+V,ur=Ie.ad,Bt=Ie.Hc;if(0<te&&(n(he,_e-32,bt[Dt].y,0,16),n(Pe,Oe-32,bt[Dt].f,0,8),n(ot,Ut-32,bt[Dt].ea,0,8)),Ie.Za){var hr=he,vr=_e-32+16;for(0<te&&(V>=N.za-1?a(hr,vr,bt[Dt].y[15],4):n(hr,vr,bt[Dt+1].y,0,4)),R=0;4>R;R++)hr[vr+128+R]=hr[vr+256+R]=hr[vr+384+R]=hr[vr+0+R];for(R=0;16>R;++R,Bt<<=2)hr=he,vr=_e+yR[R],bd[Ie.Ob[R]](hr,vr),Hu(Bt,ur,16*+R,hr,vr)}else if(hr=Hs(V,te,Ie.Ob[0]),Gf[hr](he,_e),Bt!=0)for(R=0;16>R;++R,Bt<<=2)Hu(Bt,ur,16*+R,he,_e+yR[R]);for(R=Ie.Gc,hr=Hs(V,te,Ie.Dd),Yu[hr](Pe,Oe),Yu[hr](ot,Ut),Bt=ur,hr=Pe,vr=Oe,255&(Ie=0|R)&&(170&Ie?Rc(Bt,256,hr,vr):Ja(Bt,256,hr,vr)),Ie=ot,Bt=Ut,255&(R>>=8)&&(170&R?Rc(ur,320,Ie,Bt):Ja(ur,320,Ie,Bt)),te<N.Ub-1&&(n(bt[Dt].y,0,he,_e+480,16),n(bt[Dt].f,0,Pe,Oe+224,8),n(bt[Dt].ea,0,ot,Ut+224,8)),R=8*ce*N.B,bt=N.sa,Dt=N.ta+16*V+16*ce*N.R,ur=N.qa,Ie=N.ra+8*V+R,Bt=N.Ha,hr=N.Ia+8*V+R,R=0;16>R;++R)n(bt,Dt+R*N.R,he,_e+32*R,16);for(R=0;8>R;++R)n(ur,Ie+R*N.B,Pe,Oe+32*R,8),n(Bt,hr+R*N.B,ot,Ut+32*R,8)}}function Gs(N,A,R,V,te,ce,he,_e,Pe){var Oe=[0],ot=[0],Ut=0,Ie=Pe!=null?Pe.kd:0,bt=Pe??new Je;if(N==null||12>R)return 7;bt.data=N,bt.w=A,bt.ha=R,A=[A],R=[R],bt.gb=[bt.gb];e:{var Dt=A,ur=R,Bt=bt.gb;if(t(N!=null),t(ur!=null),t(Bt!=null),Bt[0]=0,12<=ur[0]&&!r(N,Dt[0],"RIFF")){if(r(N,Dt[0]+8,"WEBP")){Bt=3;break e}var hr=Z(N,Dt[0]+4);if(12>hr||4294967286<hr){Bt=3;break e}if(Ie&&hr>ur[0]-8){Bt=7;break e}Bt[0]=hr,Dt[0]+=12,ur[0]-=12}Bt=0}if(Bt!=0)return Bt;for(hr=0<bt.gb[0],R=R[0];;){e:{var vr=N;ur=A,Bt=R;var Or=Oe,Sr=ot,An=Dt=[0];if((yn=Ut=[Ut])[0]=0,8>Bt[0])Bt=7;else{if(!r(vr,ur[0],"VP8X")){if(Z(vr,ur[0]+4)!=10){Bt=3;break e}if(18>Bt[0]){Bt=7;break e}var mn=Z(vr,ur[0]+8),ua=1+Be(vr,ur[0]+12);if(2147483648<=ua*(vr=1+Be(vr,ur[0]+15))){Bt=3;break e}An!=null&&(An[0]=mn),Or!=null&&(Or[0]=ua),Sr!=null&&(Sr[0]=vr),ur[0]+=18,Bt[0]-=18,yn[0]=1}Bt=0}}if(Ut=Ut[0],Dt=Dt[0],Bt!=0)return Bt;if(ur=!!(2&Dt),!hr&&Ut)return 3;if(ce!=null&&(ce[0]=!!(16&Dt)),he!=null&&(he[0]=ur),_e!=null&&(_e[0]=0),he=Oe[0],Dt=ot[0],Ut&&ur&&Pe==null){Bt=0;break}if(4>R){Bt=7;break}if(hr&&Ut||!hr&&!Ut&&!r(N,A[0],"ALPH")){R=[R],bt.na=[bt.na],bt.P=[bt.P],bt.Sa=[bt.Sa];e:{mn=N,Bt=A,hr=R;var yn=bt.gb;Or=bt.na,Sr=bt.P,An=bt.Sa,ua=22,t(mn!=null),t(hr!=null),vr=Bt[0];var Oa=hr[0];for(t(Or!=null),t(An!=null),Or[0]=null,Sr[0]=null,An[0]=0;;){if(Bt[0]=vr,hr[0]=Oa,8>Oa){Bt=7;break e}var Mi=Z(mn,vr+4);if(4294967286<Mi){Bt=3;break e}var fa=8+Mi+1&-2;if(ua+=fa,0<yn&&ua>yn){Bt=3;break e}if(!r(mn,vr,"VP8 ")||!r(mn,vr,"VP8L")){Bt=0;break e}if(Oa[0]<fa){Bt=7;break e}r(mn,vr,"ALPH")||(Or[0]=mn,Sr[0]=vr+8,An[0]=Mi),vr+=fa,Oa-=fa}}if(R=R[0],bt.na=bt.na[0],bt.P=bt.P[0],bt.Sa=bt.Sa[0],Bt!=0)break}R=[R],bt.Ja=[bt.Ja],bt.xa=[bt.xa];e:if(yn=N,Bt=A,hr=R,Or=bt.gb[0],Sr=bt.Ja,An=bt.xa,mn=Bt[0],vr=!r(yn,mn,"VP8 "),ua=!r(yn,mn,"VP8L"),t(yn!=null),t(hr!=null),t(Sr!=null),t(An!=null),8>hr[0])Bt=7;else{if(vr||ua){if(yn=Z(yn,mn+4),12<=Or&&yn>Or-12){Bt=3;break e}if(Ie&&yn>hr[0]-8){Bt=7;break e}Sr[0]=yn,Bt[0]+=8,hr[0]-=8,An[0]=ua}else An[0]=5<=hr[0]&&yn[mn+0]==47&&!(yn[mn+4]>>5),Sr[0]=hr[0];Bt=0}if(R=R[0],bt.Ja=bt.Ja[0],bt.xa=bt.xa[0],A=A[0],Bt!=0)break;if(4294967286<bt.Ja)return 3;if(_e==null||ur||(_e[0]=bt.xa?2:1),he=[he],Dt=[Dt],bt.xa){if(5>R){Bt=7;break}_e=he,Ie=Dt,ur=ce,N==null||5>R?N=0:5<=R&&N[A+0]==47&&!(N[A+4]>>5)?(hr=[0],yn=[0],Or=[0],Y(Sr=new L,N,A,R),Tr(Sr,hr,yn,Or)?(_e!=null&&(_e[0]=hr[0]),Ie!=null&&(Ie[0]=yn[0]),ur!=null&&(ur[0]=Or[0]),N=1):N=0):N=0}else{if(10>R){Bt=7;break}_e=Dt,N==null||10>R||!zt(N,A+3,R-3)?N=0:(Ie=N[A+0]|N[A+1]<<8|N[A+2]<<16,ur=16383&(N[A+7]<<8|N[A+6]),N=16383&(N[A+9]<<8|N[A+8]),1&Ie||3<(Ie>>1&7)||!(Ie>>4&1)||Ie>>5>=bt.Ja||!ur||!N?N=0:(he&&(he[0]=ur),_e&&(_e[0]=N),N=1))}if(!N||(he=he[0],Dt=Dt[0],Ut&&(Oe[0]!=he||ot[0]!=Dt)))return 3;Pe!=null&&(Pe[0]=bt,Pe.offset=A-Pe.w,t(4294967286>A-Pe.w),t(Pe.offset==Pe.ha-R));break}return Bt==0||Bt==7&&Ut&&Pe==null?(ce!=null&&(ce[0]|=bt.na!=null&&0<bt.na.length),V!=null&&(V[0]=he),te!=null&&(te[0]=Dt),0):Bt}function Ul(N,A,R){var V=A.width,te=A.height,ce=0,he=0,_e=V,Pe=te;if(A.Da=N!=null&&0<N.Da,A.Da&&(_e=N.cd,Pe=N.bd,ce=N.v,he=N.j,11>R||(ce&=-2,he&=-2),0>ce||0>he||0>=_e||0>=Pe||ce+_e>V||he+Pe>te))return 0;if(A.v=ce,A.j=he,A.va=ce+_e,A.o=he+Pe,A.U=_e,A.T=Pe,A.da=N!=null&&0<N.da,A.da){if(!De(_e,Pe,R=[N.ib],ce=[N.hb]))return 0;A.ib=R[0],A.hb=ce[0]}return A.ob=N!=null&&N.ob,A.Kb=N==null||!N.Sd,A.da&&(A.ob=A.ib<3*V/4&&A.hb<3*te/4,A.Kb=0),1}function Ps(N){if(N==null)return 2;if(11>N.S){var A=N.f.RGBA;A.fb+=(N.height-1)*A.A,A.A=-A.A}else A=N.f.kb,N=N.height,A.O+=(N-1)*A.fa,A.fa=-A.fa,A.N+=(N-1>>1)*A.Ab,A.Ab=-A.Ab,A.W+=(N-1>>1)*A.Db,A.Db=-A.Db,A.F!=null&&(A.J+=(N-1)*A.lb,A.lb=-A.lb);return 0}function Ii(N,A,R,V){if(V==null||0>=N||0>=A)return 2;if(R!=null){if(R.Da){var te=R.cd,ce=R.bd,he=-2&R.v,_e=-2&R.j;if(0>he||0>_e||0>=te||0>=ce||he+te>N||_e+ce>A)return 2;N=te,A=ce}if(R.da){if(!De(N,A,te=[R.ib],ce=[R.hb]))return 2;N=te[0],A=ce[0]}}V.width=N,V.height=A;e:{var Pe=V.width,Oe=V.height;if(N=V.S,0>=Pe||0>=Oe||!(N>=pa&&13>N))N=2;else{if(0>=V.Rd&&V.sd==null){he=ce=te=A=0;var ot=(_e=Pe*bR[N])*Oe;if(11>N||(ce=(Oe+1)/2*(A=(Pe+1)/2),N==12&&(he=(te=Pe)*Oe)),(Oe=i(ot+2*ce+he))==null){N=1;break e}V.sd=Oe,11>N?((Pe=V.f.RGBA).eb=Oe,Pe.fb=0,Pe.A=_e,Pe.size=ot):((Pe=V.f.kb).y=Oe,Pe.O=0,Pe.fa=_e,Pe.Fd=ot,Pe.f=Oe,Pe.N=0+ot,Pe.Ab=A,Pe.Cd=ce,Pe.ea=Oe,Pe.W=0+ot+ce,Pe.Db=A,Pe.Ed=ce,N==12&&(Pe.F=Oe,Pe.J=0+ot+2*ce),Pe.Tc=he,Pe.lb=te)}if(A=1,te=V.S,ce=V.width,he=V.height,te>=pa&&13>te)if(11>te)N=V.f.RGBA,A&=(_e=Math.abs(N.A))*(he-1)+ce<=N.size,A&=_e>=ce*bR[te],A&=N.eb!=null;else{N=V.f.kb,_e=(ce+1)/2,ot=(he+1)/2,Pe=Math.abs(N.fa),Oe=Math.abs(N.Ab);var Ut=Math.abs(N.Db),Ie=Math.abs(N.lb),bt=Ie*(he-1)+ce;A&=Pe*(he-1)+ce<=N.Fd,A&=Oe*(ot-1)+_e<=N.Cd,A=(A&=Ut*(ot-1)+_e<=N.Ed)&Pe>=ce&Oe>=_e&Ut>=_e,A&=N.y!=null,A&=N.f!=null,A&=N.ea!=null,te==12&&(A&=Ie>=ce,A&=bt<=N.Tc,A&=N.F!=null)}else A=0;N=A?0:2}}return N!=0||R!=null&&R.fd&&(N=Ps(V)),N}var iu=64,bl=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ks=24,yi=32,Xo=8,su=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];yt("Predictor0","PredictorAdd0"),k.Predictor0=function(){return 4278190080},k.Predictor1=function(N){return N},k.Predictor2=function(N,A,R){return A[R+0]},k.Predictor3=function(N,A,R){return A[R+1]},k.Predictor4=function(N,A,R){return A[R-1]},k.Predictor5=function(N,A,R){return se(se(N,A[R+1]),A[R+0])},k.Predictor6=function(N,A,R){return se(N,A[R-1])},k.Predictor7=function(N,A,R){return se(N,A[R+0])},k.Predictor8=function(N,A,R){return se(A[R-1],A[R+0])},k.Predictor9=function(N,A,R){return se(A[R+0],A[R+1])},k.Predictor10=function(N,A,R){return se(se(N,A[R-1]),se(A[R+0],A[R+1]))},k.Predictor11=function(N,A,R){var V=A[R+0];return 0>=tr(V>>24&255,N>>24&255,(A=A[R-1])>>24&255)+tr(V>>16&255,N>>16&255,A>>16&255)+tr(V>>8&255,N>>8&255,A>>8&255)+tr(255&V,255&N,255&A)?V:N},k.Predictor12=function(N,A,R){var V=A[R+0];return(rt((N>>24&255)+(V>>24&255)-((A=A[R-1])>>24&255))<<24|rt((N>>16&255)+(V>>16&255)-(A>>16&255))<<16|rt((N>>8&255)+(V>>8&255)-(A>>8&255))<<8|rt((255&N)+(255&V)-(255&A)))>>>0},k.Predictor13=function(N,A,R){var V=A[R-1];return(mt((N=se(N,A[R+0]))>>24&255,V>>24&255)<<24|mt(N>>16&255,V>>16&255)<<16|mt(N>>8&255,V>>8&255)<<8|mt(255&N,255&V))>>>0};var kc=k.PredictorAdd0;k.PredictorAdd1=Ce,yt("Predictor2","PredictorAdd2"),yt("Predictor3","PredictorAdd3"),yt("Predictor4","PredictorAdd4"),yt("Predictor5","PredictorAdd5"),yt("Predictor6","PredictorAdd6"),yt("Predictor7","PredictorAdd7"),yt("Predictor8","PredictorAdd8"),yt("Predictor9","PredictorAdd9"),yt("Predictor10","PredictorAdd10"),yt("Predictor11","PredictorAdd11"),yt("Predictor12","PredictorAdd12"),yt("Predictor13","PredictorAdd13");var Oc=k.PredictorAdd2;Ae("ColorIndexInverseTransform","MapARGB","32b",function(N){return N>>8&255},function(N){return N}),Ae("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(N){return N},function(N){return N>>8&255});var co,Vl=k.ColorIndexInverseTransform,vo=k.MapARGB,As=k.VP8LColorIndexInverseTransformAlpha,Gu=k.MapAlpha,Ic=k.VP8LPredictorsAdd=[];Ic.length=16,(k.VP8LPredictors=[]).length=16,(k.VP8LPredictorsAdd_C=[]).length=16,(k.VP8LPredictors_C=[]).length=16;var Ih,Wf,Tc,Dc,Mc,Ys,Jo,bi,ms,Rc,ca,Ja,Uo,si,xd,Th,Ku,Dh,Ng,Hf,ge,Le,Ve,xt,Ct,_r,Kt,lr,gn=i(511),ea=i(2041),$n=i(225),tn=i(767),Ha=0,La=ea,ha=$n,$a=tn,Dn=gn,pa=0,Es=1,Qa=2,Ti=3,Za=4,Lo=5,hs=6,Di=7,da=8,li=9,Co=10,Qi=[2,3,7],Xs=[3,3,11],yd=[280,256,256,256,40],Uoe=[0,1,1,1,0],Voe=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Woe=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Hoe=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Goe=8,E5=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],k5=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],j0=null,Koe=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Yoe=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],uR=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Xoe=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Joe=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Qoe=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Zoe=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Gf=[],bd=[],Yu=[],eie=1,fR=2,Kf=[],Lc=[];Ma("UpsampleRgbLinePair",Oi,3),Ma("UpsampleBgrLinePair",us,3),Ma("UpsampleRgbaLinePair",fs,4),Ma("UpsampleBgraLinePair",fo,4),Ma("UpsampleArgbLinePair",Xi,4),Ma("UpsampleRgba4444LinePair",Ro,2),Ma("UpsampleRgb565LinePair",Xa,2);var tie=k.UpsampleRgbLinePair,rie=k.UpsampleBgrLinePair,mR=k.UpsampleRgbaLinePair,hR=k.UpsampleBgraLinePair,pR=k.UpsampleArgbLinePair,gR=k.UpsampleRgba4444LinePair,nie=k.UpsampleRgb565LinePair,Sw=16,Cw=1<<Sw-1,N0=-227,O5=482,vR=6,aie=(256<<vR)-1,xR=0,oie=i(256),iie=i(256),sie=i(256),lie=i(256),cie=i(O5-N0),die=i(O5-N0);Ji("YuvToRgbRow",Oi,3),Ji("YuvToBgrRow",us,3),Ji("YuvToRgbaRow",fs,4),Ji("YuvToBgraRow",fo,4),Ji("YuvToArgbRow",Xi,4),Ji("YuvToRgba4444Row",Ro,2),Ji("YuvToRgb565Row",Xa,2);var yR=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Pw=[0,2,8],uie=[8,7,6,4,4,2,2,2,1,1,1,1],fie=1;this.WebPDecodeRGBA=function(N,A,R,V,te){var ce=Es,he=new Re,_e=new rr;he.ba=_e,_e.S=ce,_e.width=[_e.width],_e.height=[_e.height];var Pe=_e.width,Oe=_e.height,ot=new nt;if(ot==null||N==null)var Ut=2;else t(ot!=null),Ut=Gs(N,A,R,ot.width,ot.height,ot.Pd,ot.Qd,ot.format,null);if(Ut!=0?Pe=0:(Pe!=null&&(Pe[0]=ot.width[0]),Oe!=null&&(Oe[0]=ot.height[0]),Pe=1),Pe){_e.width=_e.width[0],_e.height=_e.height[0],V!=null&&(V[0]=_e.width),te!=null&&(te[0]=_e.height);e:{if(V=new Ze,(te=new Je).data=N,te.w=A,te.ha=R,te.kd=1,A=[0],t(te!=null),((N=Gs(te.data,te.w,te.ha,null,null,null,A,null,te))==0||N==7)&&A[0]&&(N=4),(A=N)==0){if(t(he!=null),V.data=te.data,V.w=te.w+te.offset,V.ha=te.ha-te.offset,V.put=Qt,V.ac=sn,V.bc=qr,V.ma=he,te.xa){if((N=xa())==null){he=1;break e}if(function(Ie,bt){var Dt=[0],ur=[0],Bt=[0];t:for(;;){if(Ie==null)return 0;if(bt==null)return Ie.a=2,0;if(Ie.l=bt,Ie.a=0,Y(Ie.m,bt.data,bt.w,bt.ha),!Tr(Ie.m,Dt,ur,Bt)){Ie.a=3;break t}if(Ie.xb=fR,bt.width=Dt[0],bt.height=ur[0],!Aa(Dt[0],ur[0],1,Ie,null))break t;return 1}return t(Ie.a!=0),0}(N,V)){if(V=(A=Ii(V.width,V.height,he.Oa,he.ba))==0){t:{V=N;r:for(;;){if(V==null){V=0;break t}if(t(V.s.yc!=null),t(V.s.Ya!=null),t(0<V.s.Wb),t((R=V.l)!=null),t((te=R.ma)!=null),V.xb!=0){if(V.ca=te.ba,V.tb=te.tb,t(V.ca!=null),!Ul(te.Oa,R,Ti)){V.a=2;break r}if(!ut(V,R.width)||R.da)break r;if((R.da||Ke(V.ca.S))&&Rn(),11>V.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),V.ca.f.kb.F!=null&&Rn()),V.Pb&&0<V.s.ua&&V.s.vb.X==null&&!ee(V.s.vb,V.s.Wa.Xa)){V.a=1;break r}V.xb=0}if(!wn(V,V.V,V.Ba,V.c,V.i,R.o,Fr))break r;te.Dc=V.Ma,V=1;break t}t(V.a!=0),V=0}V=!V}V&&(A=N.a)}else A=N.a}else{if((N=new dt)==null){he=1;break e}if(N.Fa=te.na,N.P=te.P,N.qc=te.Sa,Er(N,V)){if((A=Ii(V.width,V.height,he.Oa,he.ba))==0){if(N.Aa=0,R=he.Oa,t((te=N)!=null),R!=null){if(0<(Pe=0>(Pe=R.Md)?0:100<Pe?255:255*Pe/100)){for(Oe=ot=0;4>Oe;++Oe)12>(Ut=te.pb[Oe]).lc&&(Ut.ia=Pe*uie[0>Ut.lc?0:Ut.lc]>>3),ot|=Ut.ia;ot&&(alert("todo:VP8InitRandom"),te.ia=1)}te.Ga=R.Id,100<te.Ga?te.Ga=100:0>te.Ga&&(te.Ga=0)}(function(Ie,bt){if(Ie==null)return 0;if(bt==null)return Pt(Ie,2,"NULL VP8Io parameter in VP8Decode().");if(!Ie.cb&&!Er(Ie,bt))return 0;if(t(Ie.cb),bt.ac==null||bt.ac(bt)){bt.ob&&(Ie.L=0);var Dt=Pw[Ie.L];if(Ie.L==2?(Ie.yb=0,Ie.zb=0):(Ie.yb=bt.v-Dt>>4,Ie.zb=bt.j-Dt>>4,0>Ie.yb&&(Ie.yb=0),0>Ie.zb&&(Ie.zb=0)),Ie.Va=bt.o+15+Dt>>4,Ie.Hb=bt.va+15+Dt>>4,Ie.Hb>Ie.za&&(Ie.Hb=Ie.za),Ie.Va>Ie.Ub&&(Ie.Va=Ie.Ub),0<Ie.L){var ur=Ie.ed;for(Dt=0;4>Dt;++Dt){var Bt;if(Ie.Qa.Cb){var hr=Ie.Qa.Lb[Dt];Ie.Qa.Fb||(hr+=ur.Tb)}else hr=ur.Tb;for(Bt=0;1>=Bt;++Bt){var vr=Ie.gd[Dt][Bt],Or=hr;if(ur.Pc&&(Or+=ur.vd[0],Bt&&(Or+=ur.od[0])),0<(Or=0>Or?0:63<Or?63:Or)){var Sr=Or;0<ur.wb&&(Sr=4<ur.wb?Sr>>2:Sr>>1)>9-ur.wb&&(Sr=9-ur.wb),1>Sr&&(Sr=1),vr.dd=Sr,vr.tc=2*Or+Sr,vr.ld=40<=Or?2:15<=Or?1:0}else vr.tc=0;vr.La=Bt}}}Dt=0}else Pt(Ie,6,"Frame setup failed"),Dt=Ie.a;if(Dt=Dt==0){if(Dt){Ie.$c=0,0<Ie.Aa||(Ie.Ic=fie);t:{Dt=Ie.Ic,ur=4*(Sr=Ie.za);var An=32*Sr,mn=Sr+1,ua=0<Ie.L?Sr*(0<Ie.Aa?2:1):0,yn=(Ie.Aa==2?2:1)*Sr;if((vr=ur+832+(Bt=3*(16*Dt+Pw[Ie.L])/2*An)+(hr=Ie.Fa!=null&&0<Ie.Fa.length?Ie.Kc.c*Ie.Kc.i:0))!=vr)Dt=0;else{if(vr>Ie.Vb){if(Ie.Vb=0,Ie.Ec=i(vr),Ie.Fc=0,Ie.Ec==null){Dt=Pt(Ie,1,"no memory during frame initialization.");break t}Ie.Vb=vr}vr=Ie.Ec,Or=Ie.Fc,Ie.Ac=vr,Ie.Bc=Or,Or+=ur,Ie.Gd=s(An,Xe),Ie.Hd=0,Ie.rb=s(mn+1,Gt),Ie.sb=1,Ie.wa=ua?s(ua,ct):null,Ie.Y=0,Ie.D.Nb=0,Ie.D.wa=Ie.wa,Ie.D.Y=Ie.Y,0<Ie.Aa&&(Ie.D.Y+=Sr),t(!0),Ie.oc=vr,Ie.pc=Or,Or+=832,Ie.ya=s(yn,J),Ie.aa=0,Ie.D.ya=Ie.ya,Ie.D.aa=Ie.aa,Ie.Aa==2&&(Ie.D.aa+=Sr),Ie.R=16*Sr,Ie.B=8*Sr,Sr=(An=Pw[Ie.L])*Ie.R,An=An/2*Ie.B,Ie.sa=vr,Ie.ta=Or+Sr,Ie.qa=Ie.sa,Ie.ra=Ie.ta+16*Dt*Ie.R+An,Ie.Ha=Ie.qa,Ie.Ia=Ie.ra+8*Dt*Ie.B+An,Ie.$c=0,Or+=Bt,Ie.mb=hr?vr:null,Ie.nb=hr?Or:null,t(Or+hr<=Ie.Fc+Ie.Vb),Ee(Ie),a(Ie.Ac,Ie.Bc,0,ur),Dt=1}}if(Dt){if(bt.ka=0,bt.y=Ie.sa,bt.O=Ie.ta,bt.f=Ie.qa,bt.N=Ie.ra,bt.ea=Ie.Ha,bt.Vd=Ie.Ia,bt.fa=Ie.R,bt.Rc=Ie.B,bt.F=null,bt.J=0,!Ha){for(Dt=-255;255>=Dt;++Dt)gn[255+Dt]=0>Dt?-Dt:Dt;for(Dt=-1020;1020>=Dt;++Dt)ea[1020+Dt]=-128>Dt?-128:127<Dt?127:Dt;for(Dt=-112;112>=Dt;++Dt)$n[112+Dt]=-16>Dt?-16:15<Dt?15:Dt;for(Dt=-255;510>=Dt;++Dt)tn[255+Dt]=0>Dt?0:255<Dt?255:Dt;Ha=1}Jo=nr,bi=zr,Rc=Ar,ca=br,Ja=yr,ms=Zt,Uo=Me,si=gt,xd=O,Th=F,Ku=ir,Dh=Dr,Ng=fe,Hf=we,ge=be,Le=Ge,Ve=We,xt=_t,bd[0]=ba,bd[1]=tt,bd[2]=Ea,bd[3]=Sa,bd[4]=Mo,bd[5]=lo,bd[6]=vi,bd[7]=zl,bd[8]=ue,bd[9]=yl,Gf[0]=Ln,Gf[1]=cn,Gf[2]=pn,Gf[3]=jn,Gf[4]=aa,Gf[5]=Bn,Gf[6]=ya,Yu[0]=St,Yu[1]=Lr,Yu[2]=Fe,Yu[3]=ht,Yu[4]=er,Yu[5]=xr,Yu[6]=jr,Dt=1}else Dt=0}Dt&&(Dt=function(Oa,Mi){for(Oa.M=0;Oa.M<Oa.Va;++Oa.M){var fa,bn=Oa.Jc[Oa.M&Oa.Xb],Yr=Oa.m,ci=Oa;for(fa=0;fa<ci.za;++fa){var oa=Yr,Fa=ci,Po=Fa.Ac,ps=Fa.Bc+4*fa,Js=Fa.zc,Qo=Fa.ya[Fa.aa+fa];if(Fa.Qa.Bb?Qo.$b=G(oa,Fa.Pa.jb[0])?2+G(oa,Fa.Pa.jb[2]):G(oa,Fa.Pa.jb[1]):Qo.$b=0,Fa.kc&&(Qo.Ad=G(oa,Fa.Bd)),Qo.Za=!G(oa,145)+0,Qo.Za){var ks=Qo.Ob,Qs=0;for(Fa=0;4>Fa;++Fa){var Ri,za=Js[0+Fa];for(Ri=0;4>Ri;++Ri){za=Joe[Po[ps+Ri]][za];for(var eo=uR[G(oa,za[0])];0<eo;)eo=uR[2*eo+G(oa,za[eo])];za=-eo,Po[ps+Ri]=za}n(ks,Qs,Po,ps,4),Qs+=4,Js[0+Fa]=za}}else za=G(oa,156)?G(oa,128)?1:3:G(oa,163)?2:0,Qo.Ob[0]=za,a(Po,ps,za,4),a(Js,0,za,4);Qo.Dd=G(oa,142)?G(oa,114)?G(oa,183)?1:3:2:0}if(ci.m.Ka)return Pt(Oa,7,"Premature end-of-partition0 encountered.");for(;Oa.ja<Oa.za;++Oa.ja){if(ci=bn,oa=(Yr=Oa).rb[Yr.sb-1],Po=Yr.rb[Yr.sb+Yr.ja],fa=Yr.ya[Yr.aa+Yr.ja],ps=Yr.kc?fa.Ad:0)oa.la=Po.la=0,fa.Za||(oa.Na=Po.Na=0),fa.Hc=0,fa.Gc=0,fa.ia=0;else{var Zo,to;if(oa=Po,Po=ci,ps=Yr.Pa.Xc,Js=Yr.ya[Yr.aa+Yr.ja],Qo=Yr.pb[Js.$b],Fa=Js.ad,ks=0,Qs=Yr.rb[Yr.sb-1],za=Ri=0,a(Fa,ks,0,384),Js.Za)var gs=0,wd=ps[3];else{eo=i(16);var di=oa.Na+Qs.Na;if(di=j0(Po,ps[1],di,Qo.Eb,0,eo,0),oa.Na=Qs.Na=(0<di)+0,1<di)Jo(eo,0,Fa,ks);else{var wl=eo[0]+3>>3;for(eo=0;256>eo;eo+=16)Fa[ks+eo]=wl}gs=1,wd=ps[0]}var mo=15&oa.la,Li=15&Qs.la;for(eo=0;4>eo;++eo){var Wl=1&Li;for(wl=to=0;4>wl;++wl)mo=mo>>1|(Wl=(di=j0(Po,wd,di=Wl+(1&mo),Qo.Sc,gs,Fa,ks))>gs)<<7,to=to<<2|(3<di?3:1<di?2:Fa[ks+0]!=0),ks+=16;mo>>=4,Li=Li>>1|Wl<<7,Ri=(Ri<<8|to)>>>0}for(wd=mo,gs=Li>>4,Zo=0;4>Zo;Zo+=2){for(to=0,mo=oa.la>>4+Zo,Li=Qs.la>>4+Zo,eo=0;2>eo;++eo){for(Wl=1&Li,wl=0;2>wl;++wl)di=Wl+(1&mo),mo=mo>>1|(Wl=0<(di=j0(Po,ps[2],di,Qo.Qc,0,Fa,ks)))<<3,to=to<<2|(3<di?3:1<di?2:Fa[ks+0]!=0),ks+=16;mo>>=2,Li=Li>>1|Wl<<5}za|=to<<4*Zo,wd|=mo<<4<<Zo,gs|=(240&Li)<<Zo}oa.la=wd,Qs.la=gs,Js.Hc=Ri,Js.Gc=za,Js.ia=43690&za?0:Qo.ia,ps=!(Ri|za)}if(0<Yr.L&&(Yr.wa[Yr.Y+Yr.ja]=Yr.gd[fa.$b][fa.Za],Yr.wa[Yr.Y+Yr.ja].La|=!ps),ci.Ka)return Pt(Oa,7,"Premature end-of-file encountered.")}if(Ee(Oa),Yr=Mi,ci=1,fa=(bn=Oa).D,oa=0<bn.L&&bn.M>=bn.zb&&bn.M<=bn.Va,bn.Aa==0)t:{if(fa.M=bn.M,fa.uc=oa,Ra(bn,fa),ci=1,fa=(to=bn.D).Nb,oa=(za=Pw[bn.L])*bn.R,Po=za/2*bn.B,eo=16*fa*bn.R,wl=8*fa*bn.B,ps=bn.sa,Js=bn.ta-oa+eo,Qo=bn.qa,Fa=bn.ra-Po+wl,ks=bn.Ha,Qs=bn.Ia-Po+wl,Li=(mo=to.M)==0,Ri=mo>=bn.Va-1,bn.Aa==2&&Ra(bn,to),to.uc)for(Wl=(di=bn).D.M,t(di.D.uc),to=di.yb;to<di.Hb;++to){gs=to,wd=Wl;var Zs=(Hl=(vs=di).D).Nb;Zo=vs.R;var Hl=Hl.wa[Hl.Y+gs],Gl=vs.sa,jl=vs.ta+16*Zs*Zo+16*gs,Kl=Hl.dd,xo=Hl.tc;if(xo!=0)if(t(3<=xo),vs.L==1)0<gs&&Le(Gl,jl,Zo,xo+4),Hl.La&&xt(Gl,jl,Zo,xo),0<wd&&ge(Gl,jl,Zo,xo+4),Hl.La&&Ve(Gl,jl,Zo,xo);else{var Yl=vs.B,jd=vs.qa,Mh=vs.ra+8*Zs*Yl+8*gs,Xu=vs.Ha,vs=vs.Ia+8*Zs*Yl+8*gs;Zs=Hl.ld,0<gs&&(si(Gl,jl,Zo,xo+4,Kl,Zs),Th(jd,Mh,Xu,vs,Yl,xo+4,Kl,Zs)),Hl.La&&(Dh(Gl,jl,Zo,xo,Kl,Zs),Hf(jd,Mh,Xu,vs,Yl,xo,Kl,Zs)),0<wd&&(Uo(Gl,jl,Zo,xo+4,Kl,Zs),xd(jd,Mh,Xu,vs,Yl,xo+4,Kl,Zs)),Hl.La&&(Ku(Gl,jl,Zo,xo,Kl,Zs),Ng(jd,Mh,Xu,vs,Yl,xo,Kl,Zs))}}if(bn.ia&&alert("todo:DitherRow"),Yr.put!=null){if(to=16*mo,mo=16*(mo+1),Li?(Yr.y=bn.sa,Yr.O=bn.ta+eo,Yr.f=bn.qa,Yr.N=bn.ra+wl,Yr.ea=bn.Ha,Yr.W=bn.Ia+wl):(to-=za,Yr.y=ps,Yr.O=Js,Yr.f=Qo,Yr.N=Fa,Yr.ea=ks,Yr.W=Qs),Ri||(mo-=za),mo>Yr.o&&(mo=Yr.o),Yr.F=null,Yr.J=null,bn.Fa!=null&&0<bn.Fa.length&&to<mo&&(Yr.J=Wr(bn,Yr,to,mo-to),Yr.F=bn.mb,Yr.F==null&&Yr.F.length==0)){ci=Pt(bn,3,"Could not decode alpha data.");break t}to<Yr.j&&(za=Yr.j-to,to=Yr.j,t(!(1&za)),Yr.O+=bn.R*za,Yr.N+=bn.B*(za>>1),Yr.W+=bn.B*(za>>1),Yr.F!=null&&(Yr.J+=Yr.width*za)),to<mo&&(Yr.O+=Yr.v,Yr.N+=Yr.v>>1,Yr.W+=Yr.v>>1,Yr.F!=null&&(Yr.J+=Yr.v),Yr.ka=to-Yr.j,Yr.U=Yr.va-Yr.v,Yr.T=mo-to,ci=Yr.put(Yr))}fa+1!=bn.Ic||Ri||(n(bn.sa,bn.ta-oa,ps,Js+16*bn.R,oa),n(bn.qa,bn.ra-Po,Qo,Fa+8*bn.B,Po),n(bn.Ha,bn.Ia-Po,ks,Qs+8*bn.B,Po))}if(!ci)return Pt(Oa,6,"Output aborted.")}return 1}(Ie,bt)),bt.bc!=null&&bt.bc(bt),Dt&=1}return Dt?(Ie.cb=0,Dt):0})(N,V)||(A=N.a)}}else A=N.a}A==0&&he.Oa!=null&&he.Oa.fd&&(A=Ps(he.ba))}he=A}ce=he!=0?null:11>ce?_e.f.RGBA.eb:_e.f.kb.y}else ce=null;return ce};var bR=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(k,M){for(var S="",I=0;I<4;I++)S+=String.fromCharCode(k[M++]);return S}function u(k,M){return k[M+0]|k[M+1]<<8}function f(k,M){return(k[M+0]|k[M+1]<<8|k[M+2]<<16)>>>0}function m(k,M){return(k[M+0]|k[M+1]<<8|k[M+2]<<16|k[M+3]<<24)>>>0}new c;var h=[0],v=[0],g=[],y=new c,x=e,b=function(k,M){var S={},I=0,T=!1,D=0,B=0;if(S.frames=[],!function(q,L){for(var W=0;W<4;W++)if(q[L+W]!="RIFF".charCodeAt(W))return!0;return!1}(k,M)){for(m(k,M+=4),M+=8;M<k.length;){var U=d(k,M),z=m(k,M+=4);M+=4;var $=z+(1&z);switch(U){case"VP8 ":case"VP8L":S.frames[I]===void 0&&(S.frames[I]={}),(xe=S.frames[I]).src_off=T?B:M-8,xe.src_size=D+z+8,I++,T&&(T=!1,D=0,B=0);break;case"VP8X":(xe=S.header={}).feature_flags=k[M];var Y=M+4;xe.canvas_width=1+f(k,Y),Y+=3,xe.canvas_height=1+f(k,Y),Y+=3;break;case"ALPH":T=!0,D=$+8,B=M-8;break;case"ANIM":(xe=S.header).bgcolor=m(k,M),Y=M+4,xe.loop_count=u(k,Y),Y+=2;break;case"ANMF":var de,xe;(xe=S.frames[I]={}).offset_x=2*f(k,M),M+=3,xe.offset_y=2*f(k,M),M+=3,xe.width=1+f(k,M),M+=3,xe.height=1+f(k,M),M+=3,xe.duration=f(k,M),M+=3,de=k[M++],xe.dispose=1&de,xe.blend=de>>1&1}U!="ANMF"&&(M+=$)}return S}}(x,0);b.response=x,b.rgbaoutput=!0,b.dataurl=!1;var w=b.header?b.header:null,j=b.frames?b.frames:null;if(w){w.loop_counter=w.loop_count,h=[w.canvas_height],v=[w.canvas_width];for(var _=0;_<j.length&&j[_].blend!=0;_++);}var C=j[0],E=y.WebPDecodeRGBA(x,C.src_off,C.src_size,v,h);C.rgba=E,C.imgwidth=v[0],C.imgheight=h[0];for(var P=0;P<v[0]*h[0]*4;P++)g[P]=E[P];return this.width=v,this.height=h,this.data=g,this}(function(e){var t,r,n,a,i,s,l,c,d,u=function(q){return q=q||{},this.isStrokeTransparent=q.isStrokeTransparent||!1,this.strokeOpacity=q.strokeOpacity||1,this.strokeStyle=q.strokeStyle||"#000000",this.fillStyle=q.fillStyle||"#000000",this.isFillTransparent=q.isFillTransparent||!1,this.fillOpacity=q.fillOpacity||1,this.font=q.font||"10px sans-serif",this.textBaseline=q.textBaseline||"alphabetic",this.textAlign=q.textAlign||"left",this.lineWidth=q.lineWidth||1,this.lineJoin=q.lineJoin||"miter",this.lineCap=q.lineCap||"butt",this.path=q.path||[],this.transform=q.transform!==void 0?q.transform.clone():new c,this.globalCompositeOperation=q.globalCompositeOperation||"normal",this.globalAlpha=q.globalAlpha||1,this.clip_path=q.clip_path||[],this.currentPoint=q.currentPoint||new s,this.miterLimit=q.miterLimit||10,this.lastPoint=q.lastPoint||new s,this.lineDashOffset=q.lineDashOffset||0,this.lineDash=q.lineDash||[],this.margin=q.margin||[0,0,0,0],this.prevPageLastElemOffset=q.prevPageLastElemOffset||0,this.ignoreClearRect=typeof q.ignoreClearRect!="boolean"||q.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new f(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,s=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,d=new u}]);var f=function(q){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var L=q;Object.defineProperty(this,"pdf",{get:function(){return L}});var W=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return W},set:function(Z){W=!!Z}});var ne=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return ne},set:function(Z){ne=!!Z}});var le=0;Object.defineProperty(this,"posX",{get:function(){return le},set:function(Z){isNaN(Z)||(le=Z)}});var K=0;Object.defineProperty(this,"posY",{get:function(){return K},set:function(Z){isNaN(Z)||(K=Z)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(Z){var ee;typeof Z=="number"?ee=[Z,Z,Z,Z]:((ee=new Array(4))[0]=Z[0],ee[1]=Z.length>=2?Z[1]:ee[0],ee[2]=Z.length>=3?Z[2]:ee[0],ee[3]=Z.length>=4?Z[3]:ee[1]),d.margin=ee}});var Q=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Q},set:function(Z){Q=Z}});var re=0;Object.defineProperty(this,"lastBreak",{get:function(){return re},set:function(Z){re=Z}});var G=[];Object.defineProperty(this,"pageBreaks",{get:function(){return G},set:function(Z){G=Z}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(Z){Z instanceof u&&(d=Z)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(Z){d.path=Z}});var me=[];Object.defineProperty(this,"ctxStack",{get:function(){return me},set:function(Z){me=Z}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Z){var ee;ee=m(Z),this.ctx.fillStyle=ee.style,this.ctx.isFillTransparent=ee.a===0,this.ctx.fillOpacity=ee.a,this.pdf.setFillColor(ee.r,ee.g,ee.b,{a:ee.a}),this.pdf.setTextColor(ee.r,ee.g,ee.b,{a:ee.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Z){var ee=m(Z);this.ctx.strokeStyle=ee.style,this.ctx.isStrokeTransparent=ee.a===0,this.ctx.strokeOpacity=ee.a,ee.a===0?this.pdf.setDrawColor(255,255,255):(ee.a,this.pdf.setDrawColor(ee.r,ee.g,ee.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Z){["butt","round","square"].indexOf(Z)!==-1&&(this.ctx.lineCap=Z,this.pdf.setLineCap(Z))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Z){isNaN(Z)||(this.ctx.lineWidth=Z,this.pdf.setLineWidth(Z))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Z){["bevel","round","miter"].indexOf(Z)!==-1&&(this.ctx.lineJoin=Z,this.pdf.setLineJoin(Z))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Z){isNaN(Z)||(this.ctx.miterLimit=Z,this.pdf.setMiterLimit(Z))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Z){this.ctx.textBaseline=Z}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Z){["right","end","center","left","start"].indexOf(Z)!==-1&&(this.ctx.textAlign=Z)}});var pe=null,Be=null;Object.defineProperty(this,"fontFaces",{get:function(){return Be},set:function(Z){pe=null,Be=Z}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Z){var ee;if(this.ctx.font=Z,(ee=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Z))!==null){var kt=ee[1];ee[2];var Nt=ee[3],De=ee[4];ee[5];var st=ee[6],ft=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(De)[2];De=Math.floor(ft==="px"?parseFloat(De)*this.pdf.internal.scaleFactor:ft==="em"?parseFloat(De)*this.pdf.getFontSize():parseFloat(De)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(De);var yt=function($e){var Ae,Tt,Se=[],Ne=$e.trim();if(Ne==="")return tE;if(Ne in Kz)return[Kz[Ne]];for(;Ne!=="";){switch(Tt=null,Ae=(Ne=Xz(Ne)).charAt(0)){case'"':case"'":Tt=BJe(Ne.substring(1),Ae);break;default:Tt=qJe(Ne)}if(Tt===null||(Se.push(Tt[0]),(Ne=Xz(Tt[1]))!==""&&Ne.charAt(0)!==","))return tE;Ne=Ne.replace(/^,/,"")}return Se}(st);if(this.fontFaces){var Nr=function($e,Ae){if(pe===null){var Tt=function(Se){var Ne=[];return Object.keys(Se).forEach(function(Ue){Se[Ue].forEach(function(Qe){var et=null;switch(Qe){case"bold":et={family:Ue,weight:"bold"};break;case"italic":et={family:Ue,style:"italic"};break;case"bolditalic":et={family:Ue,weight:"bold",style:"italic"};break;case"":case"normal":et={family:Ue}}et!==null&&(et.ref={name:Ue,style:Qe},Ne.push(et))})}),Ne}($e.getFontList());pe=function(Se){for(var Ne={},Ue=0;Ue<Se.length;++Ue){var Qe=eE(Se[Ue]),et=Qe.family,pt=Qe.stretch,Ke=Qe.style,qt=Qe.weight;Ne[et]=Ne[et]||{},Ne[et][pt]=Ne[et][pt]||{},Ne[et][pt][Ke]=Ne[et][pt][Ke]||{},Ne[et][pt][Ke][qt]=Qe}return Ne}(Tt.concat(Ae))}return pe}(this.pdf,this.fontFaces),se=yt.map(function($e){return{family:$e,stretch:"normal",weight:Nt,style:kt}}),rt=function($e,Ae,Tt){for(var Se=(Tt=Tt||{}).defaultFontFamily||"times",Ne=Object.assign({},FJe,Tt.genericFontFamilies||{}),Ue=null,Qe=null,et=0;et<Ae.length;++et)if(Ne[(Ue=eE(Ae[et])).family]&&(Ue.family=Ne[Ue.family]),$e.hasOwnProperty(Ue.family)){Qe=$e[Ue.family];break}if(!(Qe=Qe||$e[Se]))throw new Error("Could not find a font-family for the rule '"+Yz(Ue)+"' and default family '"+Se+"'.");if(Qe=function(pt,Ke){if(Ke[pt])return Ke[pt];var qt=f4[pt],lt=qt<=f4.normal?-1:1,rr=Gz(Ke,xne,qt,lt);if(!rr)throw new Error("Could not find a matching font-stretch value for "+pt);return rr}(Ue.stretch,Qe),Qe=function(pt,Ke){if(Ke[pt])return Ke[pt];for(var qt=vne[pt],lt=0;lt<qt.length;++lt)if(Ke[qt[lt]])return Ke[qt[lt]];throw new Error("Could not find a matching font-style for "+pt)}(Ue.style,Qe),!(Qe=function(pt,Ke){if(Ke[pt])return Ke[pt];if(pt===400&&Ke[500])return Ke[500];if(pt===500&&Ke[400])return Ke[400];var qt=$Je[pt],lt=Gz(Ke,yne,qt,pt<400?-1:1);if(!lt)throw new Error("Could not find a matching font-weight for value "+pt);return lt}(Ue.weight,Qe)))throw new Error("Failed to resolve a font for the rule '"+Yz(Ue)+"'.");return Qe}(Nr,se);this.pdf.setFont(rt.ref.name,rt.ref.style)}else{var mt="";(Nt==="bold"||parseInt(Nt,10)>=700||kt==="bold")&&(mt="bold"),kt==="italic"&&(mt+="italic"),mt.length===0&&(mt="normal");for(var tr="",Ce={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},je=0;je<yt.length;je++){if(this.pdf.internal.getFont(yt[je],mt,{noFallback:!0,disableWarning:!0})!==void 0){tr=yt[je];break}if(mt==="bolditalic"&&this.pdf.internal.getFont(yt[je],"bold",{noFallback:!0,disableWarning:!0})!==void 0)tr=yt[je],mt="bold";else if(this.pdf.internal.getFont(yt[je],"normal",{noFallback:!0,disableWarning:!0})!==void 0){tr=yt[je],mt="normal";break}}if(tr===""){for(var ae=0;ae<yt.length;ae++)if(Ce[yt[ae]]){tr=Ce[yt[ae]];break}}tr=tr===""?"Times":tr,this.pdf.setFont(tr,mt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Z){this.ctx.globalCompositeOperation=Z}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Z){this.ctx.globalAlpha=Z}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Z){this.ctx.lineDashOffset=Z,xe.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Z){this.ctx.lineDash=Z,xe.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Z){this.ctx.ignoreClearRect=!!Z}})};f.prototype.setLineDash=function(q){this.lineDash=q},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){j.call(this,"fill",!1)},f.prototype.stroke=function(){j.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(q,L){if(isNaN(q)||isNaN(L))throw ho.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var W=this.ctx.transform.applyToPoint(new s(q,L));this.path.push({type:"mt",x:W.x,y:W.y}),this.ctx.lastPoint=new s(q,L)},f.prototype.closePath=function(){var q=new s(0,0),L=0;for(L=this.path.length-1;L!==-1;L--)if(this.path[L].type==="begin"&&Pa(this.path[L+1])==="object"&&typeof this.path[L+1].x=="number"){q=new s(this.path[L+1].x,this.path[L+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(q.x,q.y)},f.prototype.lineTo=function(q,L){if(isNaN(q)||isNaN(L))throw ho.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var W=this.ctx.transform.applyToPoint(new s(q,L));this.path.push({type:"lt",x:W.x,y:W.y}),this.ctx.lastPoint=new s(W.x,W.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),j.call(this,null,!0)},f.prototype.quadraticCurveTo=function(q,L,W,ne){if(isNaN(W)||isNaN(ne)||isNaN(q)||isNaN(L))throw ho.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var le=this.ctx.transform.applyToPoint(new s(W,ne)),K=this.ctx.transform.applyToPoint(new s(q,L));this.path.push({type:"qct",x1:K.x,y1:K.y,x:le.x,y:le.y}),this.ctx.lastPoint=new s(le.x,le.y)},f.prototype.bezierCurveTo=function(q,L,W,ne,le,K){if(isNaN(le)||isNaN(K)||isNaN(q)||isNaN(L)||isNaN(W)||isNaN(ne))throw ho.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Q=this.ctx.transform.applyToPoint(new s(le,K)),re=this.ctx.transform.applyToPoint(new s(q,L)),G=this.ctx.transform.applyToPoint(new s(W,ne));this.path.push({type:"bct",x1:re.x,y1:re.y,x2:G.x,y2:G.y,x:Q.x,y:Q.y}),this.ctx.lastPoint=new s(Q.x,Q.y)},f.prototype.arc=function(q,L,W,ne,le,K){if(isNaN(q)||isNaN(L)||isNaN(W)||isNaN(ne)||isNaN(le))throw ho.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(K=!!K,!this.ctx.transform.isIdentity){var Q=this.ctx.transform.applyToPoint(new s(q,L));q=Q.x,L=Q.y;var re=this.ctx.transform.applyToPoint(new s(0,W)),G=this.ctx.transform.applyToPoint(new s(0,0));W=Math.sqrt(Math.pow(re.x-G.x,2)+Math.pow(re.y-G.y,2))}Math.abs(le-ne)>=2*Math.PI&&(ne=0,le=2*Math.PI),this.path.push({type:"arc",x:q,y:L,radius:W,startAngle:ne,endAngle:le,counterclockwise:K})},f.prototype.arcTo=function(q,L,W,ne,le){throw new Error("arcTo not implemented.")},f.prototype.rect=function(q,L,W,ne){if(isNaN(q)||isNaN(L)||isNaN(W)||isNaN(ne))throw ho.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(q,L),this.lineTo(q+W,L),this.lineTo(q+W,L+ne),this.lineTo(q,L+ne),this.lineTo(q,L),this.lineTo(q+W,L),this.lineTo(q,L)},f.prototype.fillRect=function(q,L,W,ne){if(isNaN(q)||isNaN(L)||isNaN(W)||isNaN(ne))throw ho.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var le={};this.lineCap!=="butt"&&(le.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(le.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(q,L,W,ne),this.fill(),le.hasOwnProperty("lineCap")&&(this.lineCap=le.lineCap),le.hasOwnProperty("lineJoin")&&(this.lineJoin=le.lineJoin)}},f.prototype.strokeRect=function(q,L,W,ne){if(isNaN(q)||isNaN(L)||isNaN(W)||isNaN(ne))throw ho.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");v.call(this)||(this.beginPath(),this.rect(q,L,W,ne),this.stroke())},f.prototype.clearRect=function(q,L,W,ne){if(isNaN(q)||isNaN(L)||isNaN(W)||isNaN(ne))throw ho.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(q,L,W,ne))},f.prototype.save=function(q){q=typeof q!="boolean"||q;for(var L=this.pdf.internal.getCurrentPageInfo().pageNumber,W=0;W<this.pdf.internal.getNumberOfPages();W++)this.pdf.setPage(W+1),this.pdf.internal.out("q");if(this.pdf.setPage(L),q){this.ctx.fontSize=this.pdf.internal.getFontSize();var ne=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=ne}},f.prototype.restore=function(q){q=typeof q!="boolean"||q;for(var L=this.pdf.internal.getCurrentPageInfo().pageNumber,W=0;W<this.pdf.internal.getNumberOfPages();W++)this.pdf.setPage(W+1),this.pdf.internal.out("Q");this.pdf.setPage(L),q&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var m=function(q){var L,W,ne,le;if(q.isCanvasGradient===!0&&(q=q.getColor()),!q)return{r:0,g:0,b:0,a:0,style:q};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(q))L=0,W=0,ne=0,le=0;else{var K=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(q);if(K!==null)L=parseInt(K[1]),W=parseInt(K[2]),ne=parseInt(K[3]),le=1;else if((K=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(q))!==null)L=parseInt(K[1]),W=parseInt(K[2]),ne=parseInt(K[3]),le=parseFloat(K[4]);else{if(le=1,typeof q=="string"&&q.charAt(0)!=="#"){var Q=new dne(q);q=Q.ok?Q.toHex():"#000000"}q.length===4?(L=q.substring(1,2),L+=L,W=q.substring(2,3),W+=W,ne=q.substring(3,4),ne+=ne):(L=q.substring(1,3),W=q.substring(3,5),ne=q.substring(5,7)),L=parseInt(L,16),W=parseInt(W,16),ne=parseInt(ne,16)}}return{r:L,g:W,b:ne,a:le,style:q}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},v=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(q,L,W,ne){if(isNaN(L)||isNaN(W)||typeof q!="string")throw ho.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(ne=isNaN(ne)?void 0:ne,!h.call(this)){var le=$(this.ctx.transform.rotation),K=this.ctx.transform.scaleX;I.call(this,{text:q,x:L,y:W,scale:K,angle:le,align:this.textAlign,maxWidth:ne})}},f.prototype.strokeText=function(q,L,W,ne){if(isNaN(L)||isNaN(W)||typeof q!="string")throw ho.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!v.call(this)){ne=isNaN(ne)?void 0:ne;var le=$(this.ctx.transform.rotation),K=this.ctx.transform.scaleX;I.call(this,{text:q,x:L,y:W,scale:K,renderingMode:"stroke",angle:le,align:this.textAlign,maxWidth:ne})}},f.prototype.measureText=function(q){if(typeof q!="string")throw ho.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var L=this.pdf,W=this.pdf.internal.scaleFactor,ne=L.internal.getFontSize(),le=L.getStringUnitWidth(q)*ne/L.internal.scaleFactor;return new function(K){var Q=(K=K||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Q}}),this}({width:le*=Math.round(96*W/72*1e4)/1e4})},f.prototype.scale=function(q,L){if(isNaN(q)||isNaN(L))throw ho.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var W=new c(q,0,0,L,0,0);this.ctx.transform=this.ctx.transform.multiply(W)},f.prototype.rotate=function(q){if(isNaN(q))throw ho.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var L=new c(Math.cos(q),Math.sin(q),-Math.sin(q),Math.cos(q),0,0);this.ctx.transform=this.ctx.transform.multiply(L)},f.prototype.translate=function(q,L){if(isNaN(q)||isNaN(L))throw ho.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var W=new c(1,0,0,1,q,L);this.ctx.transform=this.ctx.transform.multiply(W)},f.prototype.transform=function(q,L,W,ne,le,K){if(isNaN(q)||isNaN(L)||isNaN(W)||isNaN(ne)||isNaN(le)||isNaN(K))throw ho.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Q=new c(q,L,W,ne,le,K);this.ctx.transform=this.ctx.transform.multiply(Q)},f.prototype.setTransform=function(q,L,W,ne,le,K){q=isNaN(q)?1:q,L=isNaN(L)?0:L,W=isNaN(W)?0:W,ne=isNaN(ne)?1:ne,le=isNaN(le)?0:le,K=isNaN(K)?0:K,this.ctx.transform=new c(q,L,W,ne,le,K)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(q,L,W,ne,le,K,Q,re,G){var me=this.pdf.getImageProperties(q),pe=1,Be=1,Z=1,ee=1;ne!==void 0&&re!==void 0&&(Z=re/ne,ee=G/le,pe=me.width/ne*re/ne,Be=me.height/le*G/le),K===void 0&&(K=L,Q=W,L=0,W=0),ne!==void 0&&re===void 0&&(re=ne,G=le),ne===void 0&&re===void 0&&(re=me.width,G=me.height);for(var kt,Nt=this.ctx.transform.decompose(),De=$(Nt.rotate.shx),st=new c,ft=(st=(st=(st=st.multiply(Nt.translate)).multiply(Nt.skew)).multiply(Nt.scale)).applyToRectangle(new l(K-L*Z,Q-W*ee,ne*pe,le*Be)),yt=y.call(this,ft),Nr=[],se=0;se<yt.length;se+=1)Nr.indexOf(yt[se])===-1&&Nr.push(yt[se]);if(w(Nr),this.autoPaging)for(var rt=Nr[0],mt=Nr[Nr.length-1],tr=rt;tr<mt+1;tr++){this.pdf.setPage(tr);var Ce=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],je=tr===1?this.posY+this.margin[0]:this.margin[0],ae=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],$e=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ae=tr===1?0:ae+(tr-2)*$e;if(this.ctx.clip_path.length!==0){var Tt=this.path;kt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(kt,this.posX+this.margin[3],-Ae+je+this.ctx.prevPageLastElemOffset),_.call(this,"fill",!0),this.path=Tt}var Se=JSON.parse(JSON.stringify(ft));Se=b([Se],this.posX+this.margin[3],-Ae+je+this.ctx.prevPageLastElemOffset)[0];var Ne=(tr>rt||tr<mt)&&g.call(this);Ne&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ce,$e,null).clip().discardPath()),this.pdf.addImage(q,"JPEG",Se.x,Se.y,Se.w,Se.h,null,null,De),Ne&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(q,"JPEG",ft.x,ft.y,ft.w,ft.h,null,null,De)};var y=function(q,L,W){var ne=[];L=L||this.pdf.internal.pageSize.width,W=W||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var le=this.posY+this.ctx.prevPageLastElemOffset;switch(q.type){default:case"mt":case"lt":ne.push(Math.floor((q.y+le)/W)+1);break;case"arc":ne.push(Math.floor((q.y+le-q.radius)/W)+1),ne.push(Math.floor((q.y+le+q.radius)/W)+1);break;case"qct":var K=Y(this.ctx.lastPoint.x,this.ctx.lastPoint.y,q.x1,q.y1,q.x,q.y);ne.push(Math.floor((K.y+le)/W)+1),ne.push(Math.floor((K.y+K.h+le)/W)+1);break;case"bct":var Q=de(this.ctx.lastPoint.x,this.ctx.lastPoint.y,q.x1,q.y1,q.x2,q.y2,q.x,q.y);ne.push(Math.floor((Q.y+le)/W)+1),ne.push(Math.floor((Q.y+Q.h+le)/W)+1);break;case"rect":ne.push(Math.floor((q.y+le)/W)+1),ne.push(Math.floor((q.y+q.h+le)/W)+1)}for(var re=0;re<ne.length;re+=1)for(;this.pdf.internal.getNumberOfPages()<ne[re];)x.call(this);return ne},x=function(){var q=this.fillStyle,L=this.strokeStyle,W=this.font,ne=this.lineCap,le=this.lineWidth,K=this.lineJoin;this.pdf.addPage(),this.fillStyle=q,this.strokeStyle=L,this.font=W,this.lineCap=ne,this.lineWidth=le,this.lineJoin=K},b=function(q,L,W){for(var ne=0;ne<q.length;ne++)switch(q[ne].type){case"bct":q[ne].x2+=L,q[ne].y2+=W;case"qct":q[ne].x1+=L,q[ne].y1+=W;default:q[ne].x+=L,q[ne].y+=W}return q},w=function(q){return q.sort(function(L,W){return L-W})},j=function(q,L){for(var W,ne,le=this.fillStyle,K=this.strokeStyle,Q=this.lineCap,re=this.lineWidth,G=Math.abs(re*this.ctx.transform.scaleX),me=this.lineJoin,pe=JSON.parse(JSON.stringify(this.path)),Be=JSON.parse(JSON.stringify(this.path)),Z=[],ee=0;ee<Be.length;ee++)if(Be[ee].x!==void 0)for(var kt=y.call(this,Be[ee]),Nt=0;Nt<kt.length;Nt+=1)Z.indexOf(kt[Nt])===-1&&Z.push(kt[Nt]);for(var De=0;De<Z.length;De++)for(;this.pdf.internal.getNumberOfPages()<Z[De];)x.call(this);if(w(Z),this.autoPaging)for(var st=Z[0],ft=Z[Z.length-1],yt=st;yt<ft+1;yt++){this.pdf.setPage(yt),this.fillStyle=le,this.strokeStyle=K,this.lineCap=Q,this.lineWidth=G,this.lineJoin=me;var Nr=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],se=yt===1?this.posY+this.margin[0]:this.margin[0],rt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],mt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],tr=yt===1?0:rt+(yt-2)*mt;if(this.ctx.clip_path.length!==0){var Ce=this.path;W=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(W,this.posX+this.margin[3],-tr+se+this.ctx.prevPageLastElemOffset),_.call(this,q,!0),this.path=Ce}if(ne=JSON.parse(JSON.stringify(pe)),this.path=b(ne,this.posX+this.margin[3],-tr+se+this.ctx.prevPageLastElemOffset),L===!1||yt===0){var je=(yt>st||yt<ft)&&g.call(this);je&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Nr,mt,null).clip().discardPath()),_.call(this,q,L),je&&this.pdf.restoreGraphicsState()}this.lineWidth=re}else this.lineWidth=G,_.call(this,q,L),this.lineWidth=re;this.path=pe},_=function(q,L){if((q!=="stroke"||L||!v.call(this))&&(q==="stroke"||L||!h.call(this))){for(var W,ne,le=[],K=this.path,Q=0;Q<K.length;Q++){var re=K[Q];switch(re.type){case"begin":le.push({begin:!0});break;case"close":le.push({close:!0});break;case"mt":le.push({start:re,deltas:[],abs:[]});break;case"lt":var G=le.length;if(K[Q-1]&&!isNaN(K[Q-1].x)&&(W=[re.x-K[Q-1].x,re.y-K[Q-1].y],G>0)){for(;G>=0;G--)if(le[G-1].close!==!0&&le[G-1].begin!==!0){le[G-1].deltas.push(W),le[G-1].abs.push(re);break}}break;case"bct":W=[re.x1-K[Q-1].x,re.y1-K[Q-1].y,re.x2-K[Q-1].x,re.y2-K[Q-1].y,re.x-K[Q-1].x,re.y-K[Q-1].y],le[le.length-1].deltas.push(W);break;case"qct":var me=K[Q-1].x+2/3*(re.x1-K[Q-1].x),pe=K[Q-1].y+2/3*(re.y1-K[Q-1].y),Be=re.x+2/3*(re.x1-re.x),Z=re.y+2/3*(re.y1-re.y),ee=re.x,kt=re.y;W=[me-K[Q-1].x,pe-K[Q-1].y,Be-K[Q-1].x,Z-K[Q-1].y,ee-K[Q-1].x,kt-K[Q-1].y],le[le.length-1].deltas.push(W);break;case"arc":le.push({deltas:[],abs:[],arc:!0}),Array.isArray(le[le.length-1].abs)&&le[le.length-1].abs.push(re)}}ne=L?null:q==="stroke"?"stroke":"fill";for(var Nt=!1,De=0;De<le.length;De++)if(le[De].arc)for(var st=le[De].abs,ft=0;ft<st.length;ft++){var yt=st[ft];yt.type==="arc"?P.call(this,yt.x,yt.y,yt.radius,yt.startAngle,yt.endAngle,yt.counterclockwise,void 0,L,!Nt):T.call(this,yt.x,yt.y),Nt=!0}else if(le[De].close===!0)this.pdf.internal.out("h"),Nt=!1;else if(le[De].begin!==!0){var Nr=le[De].start.x,se=le[De].start.y;D.call(this,le[De].deltas,Nr,se),Nt=!0}ne&&k.call(this,ne),L&&M.call(this)}},C=function(q){var L=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,W=L*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return q-W;case"top":return q+L-W;case"hanging":return q+L-2*W;case"middle":return q+L/2-W;default:return q}},E=function(q){return q+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var q=function(){};return q.colorStops=[],q.addColorStop=function(L,W){this.colorStops.push([L,W])},q.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},q.isCanvasGradient=!0,q},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var P=function(q,L,W,ne,le,K,Q,re,G){for(var me=U.call(this,W,ne,le,K),pe=0;pe<me.length;pe++){var Be=me[pe];pe===0&&(G?S.call(this,Be.x1+q,Be.y1+L):T.call(this,Be.x1+q,Be.y1+L)),B.call(this,q,L,Be.x2,Be.y2,Be.x3,Be.y3,Be.x4,Be.y4)}re?M.call(this):k.call(this,Q)},k=function(q){switch(q){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},M=function(){this.pdf.clip(),this.pdf.discardPath()},S=function(q,L){this.pdf.internal.out(r(q)+" "+n(L)+" m")},I=function(q){var L;switch(q.align){case"right":case"end":L="right";break;case"center":L="center";break;default:L="left"}var W=this.pdf.getTextDimensions(q.text),ne=C.call(this,q.y),le=E.call(this,ne)-W.h,K=this.ctx.transform.applyToPoint(new s(q.x,ne)),Q=this.ctx.transform.decompose(),re=new c;re=(re=(re=re.multiply(Q.translate)).multiply(Q.skew)).multiply(Q.scale);for(var G,me,pe,Be=this.ctx.transform.applyToRectangle(new l(q.x,ne,W.w,W.h)),Z=re.applyToRectangle(new l(q.x,le,W.w,W.h)),ee=y.call(this,Z),kt=[],Nt=0;Nt<ee.length;Nt+=1)kt.indexOf(ee[Nt])===-1&&kt.push(ee[Nt]);if(w(kt),this.autoPaging)for(var De=kt[0],st=kt[kt.length-1],ft=De;ft<st+1;ft++){this.pdf.setPage(ft);var yt=ft===1?this.posY+this.margin[0]:this.margin[0],Nr=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],se=this.pdf.internal.pageSize.height-this.margin[2],rt=se-this.margin[0],mt=this.pdf.internal.pageSize.width-this.margin[1],tr=mt-this.margin[3],Ce=ft===1?0:Nr+(ft-2)*rt;if(this.ctx.clip_path.length!==0){var je=this.path;G=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(G,this.posX+this.margin[3],-1*Ce+yt),_.call(this,"fill",!0),this.path=je}var ae=b([JSON.parse(JSON.stringify(Z))],this.posX+this.margin[3],-Ce+yt+this.ctx.prevPageLastElemOffset)[0];q.scale>=.01&&(me=this.pdf.internal.getFontSize(),this.pdf.setFontSize(me*q.scale),pe=this.lineWidth,this.lineWidth=pe*q.scale);var $e=this.autoPaging!=="text";if($e||ae.y+ae.h<=se){if($e||ae.y>=yt&&ae.x<=mt){var Ae=$e?q.text:this.pdf.splitTextToSize(q.text,q.maxWidth||mt-ae.x)[0],Tt=b([JSON.parse(JSON.stringify(Be))],this.posX+this.margin[3],-Ce+yt+this.ctx.prevPageLastElemOffset)[0],Se=$e&&(ft>De||ft<st)&&g.call(this);Se&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],tr,rt,null).clip().discardPath()),this.pdf.text(Ae,Tt.x,Tt.y,{angle:q.angle,align:L,renderingMode:q.renderingMode}),Se&&this.pdf.restoreGraphicsState()}}else ae.y<se&&(this.ctx.prevPageLastElemOffset+=se-ae.y);q.scale>=.01&&(this.pdf.setFontSize(me),this.lineWidth=pe)}else q.scale>=.01&&(me=this.pdf.internal.getFontSize(),this.pdf.setFontSize(me*q.scale),pe=this.lineWidth,this.lineWidth=pe*q.scale),this.pdf.text(q.text,K.x+this.posX,K.y+this.posY,{angle:q.angle,align:L,renderingMode:q.renderingMode,maxWidth:q.maxWidth}),q.scale>=.01&&(this.pdf.setFontSize(me),this.lineWidth=pe)},T=function(q,L,W,ne){W=W||0,ne=ne||0,this.pdf.internal.out(r(q+W)+" "+n(L+ne)+" l")},D=function(q,L,W){return this.pdf.lines(q,L,W,null,null)},B=function(q,L,W,ne,le,K,Q,re){this.pdf.internal.out([t(a(W+q)),t(i(ne+L)),t(a(le+q)),t(i(K+L)),t(a(Q+q)),t(i(re+L)),"c"].join(" "))},U=function(q,L,W,ne){for(var le=2*Math.PI,K=Math.PI/2;L>W;)L-=le;var Q=Math.abs(W-L);Q<le&&ne&&(Q=le-Q);for(var re=[],G=ne?-1:1,me=L;Q>1e-5;){var pe=me+G*Math.min(Q,K);re.push(z.call(this,q,me,pe)),Q-=Math.abs(pe-me),me=pe}return re},z=function(q,L,W){var ne=(W-L)/2,le=q*Math.cos(ne),K=q*Math.sin(ne),Q=le,re=-K,G=Q*Q+re*re,me=G+Q*le+re*K,pe=4/3*(Math.sqrt(2*G*me)-me)/(Q*K-re*le),Be=Q-pe*re,Z=re+pe*Q,ee=Be,kt=-Z,Nt=ne+L,De=Math.cos(Nt),st=Math.sin(Nt);return{x1:q*Math.cos(L),y1:q*Math.sin(L),x2:Be*De-Z*st,y2:Be*st+Z*De,x3:ee*De-kt*st,y3:ee*st+kt*De,x4:q*Math.cos(W),y4:q*Math.sin(W)}},$=function(q){return 180*q/Math.PI},Y=function(q,L,W,ne,le,K){var Q=q+.5*(W-q),re=L+.5*(ne-L),G=le+.5*(W-le),me=K+.5*(ne-K),pe=Math.min(q,le,Q,G),Be=Math.max(q,le,Q,G),Z=Math.min(L,K,re,me),ee=Math.max(L,K,re,me);return new l(pe,Z,Be-pe,ee-Z)},de=function(q,L,W,ne,le,K,Q,re){var G,me,pe,Be,Z,ee,kt,Nt,De,st,ft,yt,Nr,se,rt=W-q,mt=ne-L,tr=le-W,Ce=K-ne,je=Q-le,ae=re-K;for(me=0;me<41;me++)De=(kt=(pe=q+(G=me/40)*rt)+G*((Z=W+G*tr)-pe))+G*(Z+G*(le+G*je-Z)-kt),st=(Nt=(Be=L+G*mt)+G*((ee=ne+G*Ce)-Be))+G*(ee+G*(K+G*ae-ee)-Nt),me==0?(ft=De,yt=st,Nr=De,se=st):(ft=Math.min(ft,De),yt=Math.min(yt,st),Nr=Math.max(Nr,De),se=Math.max(se,st));return new l(Math.round(ft),Math.round(yt),Math.round(Nr-ft),Math.round(se-yt))},xe=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var q,L,W=(q=this.ctx.lineDash,L=this.ctx.lineDashOffset,JSON.stringify({lineDash:q,lineDashOffset:L}));this.prevLineDash!==W&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=W)}}})(Nn.API),function(e){var t=function(s){var l,c,d,u,f,m,h,v,g,y;for(c=[],d=0,u=(s+=l="\0\0\0\0".slice(s.length%4||4)).length;u>d;d+=4)(f=(s.charCodeAt(d)<<24)+(s.charCodeAt(d+1)<<16)+(s.charCodeAt(d+2)<<8)+s.charCodeAt(d+3))!==0?(m=(f=((f=((f=((f=(f-(y=f%85))/85)-(g=f%85))/85)-(v=f%85))/85)-(h=f%85))/85)%85,c.push(m+33,h+33,v+33,g+33,y+33)):c.push(122);return function(x,b){for(var w=b;w>0;w--)x.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(s){var l,c,d,u,f,m=String,h="length",v=255,g="charCodeAt",y="slice",x="replace";for(s[y](-2),s=s[y](0,-2)[x](/\s/g,"")[x]("z","!!!!!"),d=[],u=0,f=(s+=l="uuuuu"[y](s[h]%5||5))[h];f>u;u+=5)c=52200625*(s[g](u)-33)+614125*(s[g](u+1)-33)+7225*(s[g](u+2)-33)+85*(s[g](u+3)-33)+(s[g](u+4)-33),d.push(v&c>>24,v&c>>16,v&c>>8,v&c);return function(b,w){for(var j=w;j>0;j--)b.pop()}(d,l[h]),m.fromCharCode.apply(m,d)},n=function(s){return s.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},a=function(s){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),l.test(s)===!1)return"";for(var c="",d=0;d<s.length;d+=2)c+=String.fromCharCode("0x"+(s[d]+s[d+1]));return c},i=function(s){for(var l=new Uint8Array(s.length),c=s.length;c--;)l[c]=s.charCodeAt(c);return(l=Z3(l)).reduce(function(d,u){return d+String.fromCharCode(u)},"")};e.processDataByFilters=function(s,l){var c=0,d=s||"",u=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":d=r(d),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":d=t(d),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":d=a(d),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":d=n(d),u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":d=i(d),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:d,reverseChain:u.reverse().join(" ")}}}(Nn.API),function(e){e.loadFile=function(t,r,n){return function(a,i,s){i=i!==!1,s=typeof s=="function"?s:function(){};var l=void 0;try{l=function(c,d,u){var f=new XMLHttpRequest,m=0,h=function(v){var g=v.length,y=[],x=String.fromCharCode;for(m=0;m<g;m+=1)y.push(x(255&v.charCodeAt(m)));return y.join("")};if(f.open("GET",c,!d),f.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(f.onload=function(){f.status===200?u(h(this.responseText)):u(void 0)}),f.send(null),d&&f.status===200)return h(f.responseText)}(a,i,s)}catch{}return l}(t,r,n)},e.loadImageFile=e.loadFile}(Nn.API),function(e){function t(){return(Jn.html2canvas?Promise.resolve(Jn.html2canvas):Ou(()=>import("./html2canvas.esm-f16e60ff.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(Jn.DOMPurify?Promise.resolve(Jn.DOMPurify):Ou(()=>import("./purify.es-fd086bfc.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=Pa(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},a=function(l,c){var d=document.createElement(l);for(var u in c.className&&(d.className=c.className),c.innerHTML&&c.dompurify&&(d.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)d.style[u]=c.style[u];return d},i=function l(c,d){for(var u=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),f=c.firstChild;f;f=f.nextSibling)d!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||u.appendChild(l(f,d));return c.nodeType===1&&(c.nodeName==="CANVAS"?(u.width=c.width,u.height=c.height,u.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(u.value=c.value),u.addEventListener("load",function(){u.scrollTop=c.scrollTop,u.scrollLeft=c.scrollLeft},!0)),u},s=function l(c){var d=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),u=l.convert(Promise.resolve(),d);return(u=u.setProgress(1,l,1,[l])).set(c)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(l,c){return l.__proto__=c||s.prototype,l},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(d){switch(n(d)){case"string":return"string";case"element":return d.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(d){return this.set({src:a("div",{innerHTML:l,dompurify:d})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},s.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var d=Object.assign({},this.opt.html2canvas);return delete d.onrendered,c(this.prop.container,d)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var d=this.opt.jsPDF,u=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,m=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete m.onrendered,d.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,d.context2d.posX=this.opt.x,d.context2d.posY=this.opt.y,d.context2d.margin=this.opt.margin,d.context2d.fontFaces=u,u)for(var h=0;h<u.length;++h){var v=u[h],g=v.src.find(function(y){return y.format==="truetype"});g&&d.addFont(g.url,v.ref.name,v.ref.style)}return m.windowHeight=m.windowHeight||0,m.windowHeight=m.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):m.windowHeight,d.context2d.save(!0),c(this.prop.container,m)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(l,c,d){return(d=d||"pdf").toLowerCase()==="img"||d.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},s.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},s.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},s.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(d){if(d in s.template.prop)return function(){this.prop[d]=l[d]};switch(d){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[d]=l[d]}}},this);return this.then(function(){return this.thenList(c)})},s.prototype.get=function(l,c){return this.then(function(){var d=l in s.template.prop?this.prop[l]:this.opt[l];return c?c(d):d})},s.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},s.prototype.setPageSize=function(l){function c(d,u){return Math.floor(d*u/72*96)}return this.then(function(){(l=l||Nn.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},s.prototype.setProgress=function(l,c,d,u){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),d!=null&&(this.progress.n=d),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(l,c,d,u){return this.setProgress(l?this.progress.val+l:null,c||null,d?this.progress.n+d:null,u?this.progress.stack.concat(u):null)},s.prototype.then=function(l,c){var d=this;return this.thenCore(l,c,function(u,f){return d.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(m){return d.updateProgress(null,u),m}).then(u,f).then(function(m){return d.updateProgress(1),m})})},s.prototype.thenCore=function(l,c,d){d=d||Promise.prototype.then;var u=this;l&&(l=l.bind(u)),c&&(c=c.bind(u));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?u:s.convert(Object.assign({},u),Promise.prototype),m=d.call(f,l,c);return s.convert(m,u.__proto__)},s.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},s.prototype.thenList=function(l){var c=this;return l.forEach(function(d){c=c.thenCore(d)}),c},s.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return s.convert(c,this)},s.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},s.prototype.error=function(l){return this.then(function(){throw new Error(l)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,Nn.getPageSize=function(l,c,d){if(Pa(l)==="object"){var u=l;l=u.orientation,c=u.unit||c,d=u.format||d}c=c||"mm",d=d||"a4",l=(""+(l||"P")).toLowerCase();var f,m=(""+d).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+c}var v,g=0,y=0;if(h.hasOwnProperty(m))g=h[m][1]/f,y=h[m][0]/f;else try{g=d[1],y=d[0]}catch{throw new Error("Invalid format: "+d)}if(l==="p"||l==="portrait")l="p",y>g&&(v=y,y=g,g=v);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",g>y&&(v=y,y=g,g=v)}return{width:y,height:g,unit:c,k:f,orientation:l}},e.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(eE):null;var d=new s(c);return c.worker?d:d.from(l).doCallback()}}(Nn.API),Nn.API.addJS=function(e){return Qz=e,this.internal.events.subscribe("postPutResources",function(){z2=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(z2+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Jz=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Qz+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){z2!==void 0&&Jz!==void 0&&this.internal.out("/Names <</JavaScript "+z2+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=r.outline.render().split(/\r\n/),i=0;i<a.length;i++){var s=a[i],l=n.exec(s);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,u=[];for(i=0;i<d;i++){var f=r.internal.newObject();u.push(f);var m=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+m.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<u.length;i++)r.internal.write("(page_"+(i+1)+")"+u[i]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,a,i){var s={title:a,options:i,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var s=n.children[i];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var l=this.count=this.count_r({count:0},s);if(l>0&&this.line("/Count "+l),s.options&&s.options.pageNumber){var c=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var d=0;d<n.children.length;d++)this.renderItems(n.children[d])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,a){for(var i=0;i<a.children.length;i++)n.count++,this.count_r(n,a.children[i]);return n.count}}])}(Nn.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,a,i,s,l){var c,d=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(f){for(var m,h=256*f.charCodeAt(4)+f.charCodeAt(5),v=f.length,g={width:0,height:0,numcomponents:1},y=4;y<v;y+=2){if(y+=h,t.indexOf(f.charCodeAt(y+1))!==-1){m=256*f.charCodeAt(y+5)+f.charCodeAt(y+6),g={width:256*f.charCodeAt(y+7)+f.charCodeAt(y+8),height:m,numcomponents:f.charCodeAt(y+9)};break}h=256*f.charCodeAt(y+2)+f.charCodeAt(y+3)}return g}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}u={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:d,index:n,alias:a}}return u}}(Nn.API),Nn.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var a,i=NJe(e,{checkCrc:!0}),s=i.width,l=i.height,c=i.channels,d=i.palette,u=i.depth;a=d&&c===1?function(P){for(var k=P.width,M=P.height,S=P.data,I=P.palette,T=P.depth,D=!1,B=[],U=[],z=void 0,$=!1,Y=0,de=0;de<I.length;de++){var xe=Hq(I[de],4),q=xe[0],L=xe[1],W=xe[2],ne=xe[3];B.push(q,L,W),ne!=null&&(ne===0?(Y++,U.length<1&&U.push(de)):ne<255&&($=!0))}if($||Y>1){D=!0,U=void 0;var le=k*M;z=new Uint8Array(le);for(var K=new DataView(S.buffer),Q=0;Q<le;Q++){var re=rE(K,Q,T),G=Hq(I[re],4)[3];z[Q]=G}}else Y===0&&(U=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:D?8:void 0,colorBytes:S,alphaBytes:z,needSMask:D,palette:B,mask:U}}(i):c===2||c===4?function(P){for(var k=P.data,M=P.width,S=P.height,I=P.channels,T=P.depth,D=I===2?"DeviceGray":"DeviceRGB",B=I-1,U=M*S,z=B,$=U*z,Y=1*U,de=Math.ceil($*T/8),xe=Math.ceil(Y*T/8),q=new Uint8Array(de),L=new Uint8Array(xe),W=new DataView(k.buffer),ne=new DataView(q.buffer),le=new DataView(L.buffer),K=!1,Q=0;Q<U;Q++){for(var re=Q*I,G=0;G<z;G++)s9(ne,rE(W,re+G,T),Q*z+G,T);var me=rE(W,re+z,T);me<(1<<T)-1&&(K=!0),s9(le,me,1*Q,T)}return{colorSpace:D,colorsPerPixel:B,sMaskBitsPerComponent:K?T:void 0,colorBytes:q,alphaBytes:L,needSMask:K}}(i):function(P){var k=P.data,M=P.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:M,colorsPerPixel:M==="DeviceGray"?1:3,colorBytes:k instanceof Uint16Array?function(S){for(var I=S.length,T=new Uint8Array(2*I),D=new DataView(T.buffer,T.byteOffset,T.byteLength),B=0;B<I;B++)D.setUint16(2*B,S[B],!1);return T}(k):k,needSMask:!1}}(i);var f,m,h,v=a,g=v.colorSpace,y=v.colorsPerPixel,x=v.sMaskBitsPerComponent,b=v.colorBytes,w=v.alphaBytes,j=v.needSMask,_=v.palette,C=v.mask,E=null;return n!==Nn.API.image_compression.NONE&&typeof Z3=="function"?(E=function(P){var k;switch(P){case Nn.API.image_compression.FAST:k=11;break;case Nn.API.image_compression.MEDIUM:k=13;break;case Nn.API.image_compression.SLOW:k=14;break;default:k=12}return k}(n),f=this.decode.FLATE_DECODE,m="/Predictor ".concat(E," /Colors ").concat(y," /BitsPerComponent ").concat(u," /Columns ").concat(s),e=r9(b,Math.ceil(s*y*u/8),y,u,n),j&&(h=r9(w,Math.ceil(s*x/8),1,x,n))):(f=void 0,m=void 0,e=b,j&&(h=w)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:r,data:e,index:t,filter:f,decodeParameters:m,transparency:C,palette:_,sMask:h,predictor:E,width:s,height:l,bitsPerComponent:u,sMaskBitsPerComponent:x,colorSpace:g}}},function(e){e.processGIF89A=function(t,r,n,a){var i=new WJe(t),s=i.width,l=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var d={data:c,width:s,height:l},u=new nE(100).encode(d,100);return e.processJPEG.call(this,u,r,n,a)},e.processGIF87A=e.processGIF89A}(Nn.API),Cd.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:a,green:n,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Cd.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){ho.log("bit decode error:"+r)}},Cd.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,a=0;a<t;a++)for(var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*a*4,l=0;l<8&&8*a+l<this.width;l++){var c=this.palette[i>>7-l&1];this.data[s+4*l]=c.blue,this.data[s+4*l+1]=c.green,this.data[s+4*l+2]=c.red,this.data[s+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Cd.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<e;a++){var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*a*4,l=i>>4,c=15&i,d=this.palette[l];if(this.data[s]=d.blue,this.data[s+1]=d.green,this.data[s+2]=d.red,this.data[s+3]=255,2*a+1>=this.width)break;d=this.palette[c],this.data[s+4]=d.blue,this.data[s+4+1]=d.green,this.data[s+4+2]=d.red,this.data[s+4+3]=255}t!==0&&(this.pos+=4-t)}},Cd.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*n;if(a<this.palette.length){var s=this.palette[a];this.data[i]=s.red,this.data[i+1]=s.green,this.data[i+2]=s.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},Cd.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(i&t)/t*255|0,l=(i>>5&t)/t*255|0,c=(i>>10&t)/t*255|0,d=i>>15?255:0,u=n*this.width*4+4*a;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=s,this.data[u+3]=d}this.pos+=e}},Cd.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(s&t)/t*255|0,c=(s>>5&r)/r*255|0,d=(s>>11)/t*255|0,u=a*this.width*4+4*i;this.data[u]=d,this.data[u+1]=c,this.data[u+2]=l,this.data[u+3]=255}this.pos+=e}},Cd.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*r;this.data[s]=i,this.data[s+1]=a,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},Cd.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=i,this.data[l+1]=a,this.data[l+2]=n,this.data[l+3]=s}},Cd.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,a){var i=new Cd(t,!1),s=i.width,l=i.height,c={data:i.getData(),width:s,height:l},d=new nE(100).encode(c,100);return e.processJPEG.call(this,d,r,n,a)}}(Nn.API),c9.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,a){var i=new c9(t),s=i.width,l=i.height,c={data:i.getData(),width:s,height:l},d=new nE(100).encode(c,100);return e.processJPEG.call(this,d,r,n,a)}}(Nn.API),Nn.API.processRGBA=function(e,t,r){for(var n=e.data,a=n.length,i=new Uint8Array(a/4*3),s=new Uint8Array(a/4),l=0,c=0,d=0;d<a;d+=4){var u=n[d],f=n[d+1],m=n[d+2],h=n[d+3];i[l++]=u,i[l++]=f,i[l++]=m,s[c++]=h}var v=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:v,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Nn.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Hg=Nn.API,U2=Hg.getCharWidthsArray=function(e,t){var r,n,a=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),s=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:a.metadata.Unicode.widths,c=l.fof?l.fof:1,d=t.kerning?t.kerning:a.metadata.Unicode.kerning,u=d.fof?d.fof:1,f=t.doKerning!==!1,m=0,h=e.length,v=0,g=l[0]||c,y=[];for(r=0;r<h;r++)n=e.charCodeAt(r),typeof a.metadata.widthOfString=="function"?y.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+s*(1e3/i)||0)/1e3):(m=f&&Pa(d[n])==="object"&&!isNaN(parseInt(d[n][v],10))?d[n][v]/u:0,y.push((l[n]||g)/c+m)),v=n;return y},Zz=Hg.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),a=t.charSpace||this.internal.getCharSpace();return Hg.processArabic&&(e=Hg.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,a)/r:U2.apply(this,arguments).reduce(function(i,s){return i+s},0)},e9=function(e,t,r,n){for(var a=[],i=0,s=e.length,l=0;i!==s&&l+t[i]<r;)l+=t[i],i++;a.push(e.slice(0,i));var c=i;for(l=0;i!==s;)l+t[i]>n&&(a.push(e.slice(c,i)),l=0,c=i),l+=t[i],i++;return c!==i&&a.push(e.slice(c,i)),a},t9=function(e,t,r){r||(r={});var n,a,i,s,l,c,d,u=[],f=[u],m=r.textIndent||0,h=0,v=0,g=e.split(" "),y=U2.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var x=Array(c).join(" "),b=[];g.map(function(j){(j=j.split(/\s*\n/)).length>1?b=b.concat(j.map(function(_,C){return(C&&_.length?`
`:"")+_})):b.push(j[0])}),g=b,c=Zz.apply(this,[x,r])}for(i=0,s=g.length;i<s;i++){var w=0;if(n=g[i],c&&n[0]==`
`&&(n=n.substr(1),w=1),m+h+(v=(a=U2.apply(this,[n,r])).reduce(function(j,_){return j+_},0))>t||w){if(v>t){for(l=e9.apply(this,[n,a,t-(m+h),t]),u.push(l.shift()),u=[l.pop()];l.length;)f.push([l.shift()]);v=a.slice(n.length-(u[0]?u[0].length:0)).reduce(function(j,_){return j+_},0)}else u=[n];f.push(u),m=v+c,h=y}else u.push(n),m+=h+v,h=y}return d=c?function(j,_){return(_?x:"")+j.join(" ")}:function(j){return j.join(" ")},f.map(d)},Hg.splitTextToSize=function(e,t,r){var n,a=(r=r||{}).fontSize||this.internal.getFontSize(),i=function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var f=this.internal.getFont(u.fontName,u.fontStyle),m="Unicode";return f.metadata[m]?{widths:f.metadata[m].widths||{0:1},kerning:f.metadata[m].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var s=1*this.internal.scaleFactor*t/a;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,i.lineIndent=r.lineIndent;var l,c,d=[];for(l=0,c=n.length;l<c;l++)d=d.concat(t9.apply(this,[n[l],s,i]));return d},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},a={},i=0;i<16;i++)n[r[i]]=t[i],a[t[i]]=r[i];var s=function(m){return"0x"+parseInt(m,10).toString(16)},l=e.__fontmetrics__.compress=function(m){var h,v,g,y,x=["{"];for(var b in m){if(h=m[b],isNaN(parseInt(b,10))?v="'"+b+"'":(b=parseInt(b,10),v=(v=s(b).slice(2)).slice(0,-1)+a[v.slice(-1)]),typeof h=="number")h<0?(g=s(h).slice(3),y="-"):(g=s(h).slice(2),y=""),g=y+g.slice(0,-1)+a[g.slice(-1)];else{if(Pa(h)!=="object")throw new Error("Don't know what to do with value type "+Pa(h)+".");g=l(h)}x.push(v+g)}return x.push("}"),x.join("")},c=e.__fontmetrics__.uncompress=function(m){if(typeof m!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,v,g,y,x={},b=1,w=x,j=[],_="",C="",E=m.length-1,P=1;P<E;P+=1)(y=m[P])=="'"?h?(g=h.join(""),h=void 0):h=[]:h?h.push(y):y=="{"?(j.push([w,g]),w={},g=void 0):y=="}"?((v=j.pop())[0][v[1]]=w,g=void 0,w=v[0]):y=="-"?b=-1:g===void 0?n.hasOwnProperty(y)?(_+=n[y],g=parseInt(_,16)*b,b=1,_=""):_+=y:n.hasOwnProperty(y)?(C+=n[y],w[g]=parseInt(C,16)*b,b=1,g=void 0,C=""):C+=y;return x},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},f={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(m){var h=m.font,v=f.Unicode[h.postScriptName];v&&(h.metadata.Unicode={},h.metadata.Unicode.widths=v.widths,h.metadata.Unicode.kerning=v.kerning);var g=u.Unicode[h.postScriptName];g&&(h.metadata.Unicode.encoding=g,h.encoding=g.codePages[0])}])}(Nn.API),function(e){var t=function(r){for(var n=r.length,a=new Uint8Array(n),i=0;i<n;i++)a[i]=r.charCodeAt(i);return a};e.API.events.push(["addFont",function(r){var n=void 0,a=r.font,i=r.instance;if(!a.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=i.existsFileInVFS(a.postScriptName)===!1?i.loadFile(a.postScriptName):i.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(s,l){l=/^\x00\x01\x00\x00/.test(l)?t(l):t(Pj(l)),s.metadata=e.API.TTFFont.open(l),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(a,n)}}])}(Nn),Nn.API.addSvgAsImage=function(e,t,r,n,a,i,s,l){if(isNaN(t)||isNaN(r))throw ho.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(a))throw ho.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=a;var d=c.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,c.width,c.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(Jn.canvg?Promise.resolve(Jn.canvg):Ou(()=>import("./index.es-315564d5.js"),[])).catch(function(m){return Promise.reject(new Error("Could not load canvg: "+m))}).then(function(m){return m.default?m.default:m}).then(function(m){return m.fromString(d,e,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(m){return m.render(u)}).then(function(){f.addImage(c.toDataURL("image/jpeg",1),t,r,n,a,s,l)})},Nn.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(t,r);return this},Nn.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,a,i,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(s),c=[],d=0,u=0,f=0;function m(v,g){var y,x=!1;for(y=0;y<v.length;y+=1)v[y]===g&&(x=!0);return x}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var h=l.length;for(f=0;f<h;f+=1)r[l[f]].value=r[l[f]].defaultValue,r[l[f]].explicitSet=!1}if(Pa(e)==="object"){for(a in e)if(i=e[a],m(l,a)&&i!==void 0){if(r[a].type==="boolean"&&typeof i=="boolean")r[a].value=i;else if(r[a].type==="name"&&m(r[a].valueSet,i))r[a].value=i;else if(r[a].type==="integer"&&Number.isInteger(i))r[a].value=i;else if(r[a].type==="array"){for(d=0;d<i.length;d+=1)if(n=!0,i[d].length===1&&typeof i[d][0]=="number")c.push(String(i[d]-1));else if(i[d].length>1){for(u=0;u<i[d].length;u+=1)typeof i[d][u]!="number"&&(n=!1);n===!0&&c.push([i[d][0]-1,i[d][1]-1].join(" "))}r[a].value="["+c.join(" ")+"]"}else r[a].value=r[a].defaultValue;r[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var v,g=[];for(v in r)r[v].explicitSet===!0&&(r[v].type==="name"?g.push("/"+v+" /"+r[v].value):g.push("/"+v+" "+r[v].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),d=i.length+s.length+l.length+a.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(a+i+s+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(Nn.API),function(e){var t=e.API,r=t.pdfEscape16=function(i,s){for(var l,c=s.metadata.Unicode.widths,d=["","0","00","000","0000"],u=[""],f=0,m=i.length;f<m;++f){if(l=s.metadata.characterToGlyph(i.charCodeAt(f)),s.metadata.glyIdsUsed.push(l),s.metadata.toUnicode[l]=i.charCodeAt(f),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(s.metadata.widthOfGlyph(l),10)])),l=="0")return u.join("");l=l.toString(16),u.push(d[4-l.length],l)}return u.join("")},n=function(i){var s,l,c,d,u,f,m;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,m=(l=Object.keys(i).sort(function(h,v){return h-v})).length;f<m;f++)s=l[f],c.length>=100&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[s]!==void 0&&i[s]!==null&&typeof i[s].toString=="function"&&(d=("0000"+i[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),c.push("<"+s+"><"+d+">"));return c.length&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),u+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(s){var l=s.font,c=s.out,d=s.newObject,u=s.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="Identity-H"){for(var f=l.metadata.Unicode.widths,m=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),h="",v=0;v<m.length;v++)h+=String.fromCharCode(m[v]);var g=d();u({data:h,addLength1:!0,objectId:g}),c("endobj");var y=d();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:y}),c("endobj");var x=d();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+nv(l.fontName)),c("/FontFile2 "+g+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var b=d();c("<<"),c("/Type /Font"),c("/BaseFont /"+nv(l.fontName)),c("/FontDescriptor "+x+" 0 R"),c("/W "+e.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=d(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+y+" 0 R"),c("/BaseFont /"+nv(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+b+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(s){var l=s.font,c=s.out,d=s.newObject,u=s.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var f=l.metadata.rawData,m="",h=0;h<f.length;h++)m+=String.fromCharCode(f[h]);var v=d();u({data:m,addLength1:!0,objectId:v}),c("endobj");var g=d();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:g}),c("endobj");var y=d();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+v+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+nv(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=d();for(var x=0;x<l.metadata.hmtx.widths.length;x++)l.metadata.hmtx.widths[x]=parseInt(l.metadata.hmtx.widths[x]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+nv(l.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]);var a=function(i){var s,l=i.text||"",c=i.x,d=i.y,u=i.options||{},f=i.mutex||{},m=f.pdfEscape,h=f.activeFontKey,v=f.fonts,g=h,y="",x=0,b="",w=v[g].encoding;if(v[g].encoding!=="Identity-H")return{text:l,x:c,y:d,options:u,mutex:f};for(b=l,g=h,Array.isArray(l)&&(b=l[0]),x=0;x<b.length;x+=1)v[g].metadata.hasOwnProperty("cmap")&&(s=v[g].metadata.cmap.unicode.codeMap[b[x].charCodeAt(0)]),s||b[x].charCodeAt(0)<256&&v[g].metadata.hasOwnProperty("Unicode")?y+=b[x]:y+="";var j="";return parseInt(g.slice(1))<14||w==="WinAnsiEncoding"?j=m(y,g).split("").map(function(_){return _.charCodeAt(0).toString(16)}).join(""):w==="Identity-H"&&(j=r(y,v[g])),f.isHex=!0,{text:j,x:c,y:d,options:u,mutex:f}};t.events.push(["postProcessText",function(i){var s=i.text||"",l=[],c={text:s,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(s)){var d=0;for(d=0;d<s.length;d+=1)Array.isArray(s[d])&&s[d].length===3?l.push([a(Object.assign({},c,{text:s[d][0]})).text,s[d][1],s[d][2]]):l.push(a(Object.assign({},c,{text:s[d]})).text);i.text=l}else i.text=a(Object.assign({},c,{text:s})).text}])}(Nn),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Nn.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var a,i,s,l,c,d,u,f=t,m=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],v={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],x=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),b=!1,w=0;this.__bidiEngine__={};var j=function(S){var I=S.charCodeAt(),T=I>>8,D=g[T];return D!==void 0?f[256*D+(255&I)]:T===252||T===253?"AL":x.test(T)?"L":T===8?"R":"N"},_=function(S){for(var I,T=0;T<S.length;T++){if((I=j(S.charAt(T)))==="L")return!1;if(I==="R")return!0}return!1},C=function(S,I,T,D){var B,U,z,$,Y=I[D];switch(Y){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":b=!1;break;case"N":case"AN":break;case"EN":b&&(Y="AN");break;case"AL":b=!0,Y="R";break;case"WS":case"BN":Y="N";break;case"CS":D<1||D+1>=I.length||(B=T[D-1])!=="EN"&&B!=="AN"||(U=I[D+1])!=="EN"&&U!=="AN"?Y="N":b&&(U="AN"),Y=U===B?U:"N";break;case"ES":Y=(B=D>0?T[D-1]:"B")==="EN"&&D+1<I.length&&I[D+1]==="EN"?"EN":"N";break;case"ET":if(D>0&&T[D-1]==="EN"){Y="EN";break}if(b){Y="N";break}for(z=D+1,$=I.length;z<$&&I[z]==="ET";)z++;Y=z<$&&I[z]==="EN"?"EN":"N";break;case"NSM":if(s&&!l){for($=I.length,z=D+1;z<$&&I[z]==="NSM";)z++;if(z<$){var de=S[D],xe=de>=1425&&de<=2303||de===64286;if(B=I[z],xe&&(B==="R"||B==="AL")){Y="R";break}}}Y=D<1||(B=I[D-1])==="B"?"N":T[D-1];break;case"B":b=!1,a=!0,Y=w;break;case"S":i=!0,Y="N"}return Y},E=function(S,I,T){var D=S.split("");return T&&P(D,T,{hiLevel:w}),D.reverse(),I&&I.reverse(),D.join("")},P=function(S,I,T){var D,B,U,z,$,Y=-1,de=S.length,xe=0,q=[],L=w?h:m,W=[];for(b=!1,a=!1,i=!1,B=0;B<de;B++)W[B]=j(S[B]);for(U=0;U<de;U++){if($=xe,q[U]=C(S,W,q,U),D=240&(xe=L[$][v[q[U]]]),xe&=15,I[U]=z=L[xe][5],D>0)if(D===16){for(B=Y;B<U;B++)I[B]=1;Y=-1}else Y=-1;if(L[xe][6])Y===-1&&(Y=U);else if(Y>-1){for(B=Y;B<U;B++)I[B]=z;Y=-1}W[U]==="B"&&(I[U]=0),T.hiLevel|=z}i&&function(ne,le,K){for(var Q=0;Q<K;Q++)if(ne[Q]==="S"){le[Q]=w;for(var re=Q-1;re>=0&&ne[re]==="WS";re--)le[re]=w}}(W,I,de)},k=function(S,I,T,D,B){if(!(B.hiLevel<S)){if(S===1&&w===1&&!a)return I.reverse(),void(T&&T.reverse());for(var U,z,$,Y,de=I.length,xe=0;xe<de;){if(D[xe]>=S){for($=xe+1;$<de&&D[$]>=S;)$++;for(Y=xe,z=$-1;Y<z;Y++,z--)U=I[Y],I[Y]=I[z],I[z]=U,T&&(U=T[Y],T[Y]=T[z],T[z]=U);xe=$}xe++}}},M=function(S,I,T){var D=S.split(""),B={hiLevel:w};return T||(T=[]),P(D,T,B),function(U,z,$){if($.hiLevel!==0&&u)for(var Y,de=0;de<U.length;de++)z[de]===1&&(Y=y.indexOf(U[de]))>=0&&(U[de]=y[Y+1])}(D,T,B),k(2,D,I,T,B),k(1,D,I,T,B),D.join("")};return this.__bidiEngine__.doBidiReorder=function(S,I,T){if(function(B,U){if(U)for(var z=0;z<B.length;z++)U[z]=z;l===void 0&&(l=_(B)),d===void 0&&(d=_(B))}(S,I),s||!c||d)if(s&&c&&l^d)w=l?1:0,S=E(S,I,T);else if(!s&&c&&d)w=l?1:0,S=M(S,I,T),S=E(S,I);else if(!s||l||c||d){if(s&&!c&&l^d)S=E(S,I),l?(w=0,S=M(S,I,T)):(w=1,S=M(S,I,T),S=E(S,I));else if(s&&l&&!c&&d)w=1,S=M(S,I,T),S=E(S,I);else if(!s&&!c&&l^d){var D=u;l?(w=1,S=M(S,I,T),w=0,u=!1,S=M(S,I,T),u=D):(w=0,S=M(S,I,T),S=E(S,I),w=1,u=!1,S=M(S,I,T),u=D,S=E(S,I))}}else w=0,S=M(S,I,T);else w=l?1:0,S=M(S,I,T);return S},this.__bidiEngine__.setOptions=function(S){S&&(s=S.isInputVisual,c=S.isOutputVisual,l=S.isInputRtl,d=S.isOutputRtl,u=S.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var a=n.text;n.x,n.y;var i=n.options||{};n.mutex,i.lang;var s=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(a)==="[object Array]"){var l=0;for(s=[],l=0;l<a.length;l+=1)Object.prototype.toString.call(a[l])==="[object Array]"?s.push([r.doBidiReorder(a[l][0]),a[l][1],a[l][2]]):s.push([r.doBidiReorder(a[l])]);n.text=s}else n.text=r.doBidiReorder(a);r.setOptions({isInputVisual:!0})}])}(Nn),Nn.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new ph(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new iQe(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new HJe(this.contents),this.head=new KJe(this),this.name=new ZJe(this),this.cmap=new wne(this),this.toUnicode={},this.hhea=new YJe(this),this.maxp=new eQe(this),this.hmtx=new tQe(this),this.post=new JJe(this),this.os2=new XJe(this),this.loca=new oQe(this),this.glyf=new rQe(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,a,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var s,l,c,d;for(d=[],s=0,l=(c=this.bbox).length;s<l;s++)t=c[s],d.push(Math.round(t*this.scaleFactor));return d}.call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(r=a>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var a,i,s,l;for(s=0,i=0,l=(t=""+t).length;0<=l?i<l:i>l;i=0<=l?++i:--i)a=t.charCodeAt(i),s+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/r)||0;return s*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var au,ph=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,a;for(a=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)a.push(this.writeByte(t.charCodeAt(r)));return a},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,a,i,s,l,c;return t=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),i=this.readByte(),s=this.readByte(),l=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^i)+65536*(255^s)+256*(255^l)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*a+16777216*i+65536*s+256*l+c},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,a,i;for(i=[],n=0,a=t.length;n<a;n++)r=t[n],i.push(this.writeByte(r));return i},e}(),HJe=function(){var e;function t(r){var n,a,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},a=0,i=this.tableCount;0<=i?a<i:a>i;a=0<=i?++a:--a)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,a,i,s,l,c,d,u,f,m,h,v,g;for(g in h=Object.keys(r).length,c=Math.log(2),f=16*Math.floor(Math.log(h)/c),s=Math.floor(f/c),u=16*h-f,(a=new ph).writeInt(this.scalarType),a.writeShort(h),a.writeShort(f),a.writeShort(s),a.writeShort(u),i=16*h,d=a.pos+i,l=null,v=[],r)for(m=r[g],a.writeString(g),a.writeInt(e(m)),a.writeInt(d),a.writeInt(m.length),v=v.concat(m),g==="head"&&(l=d),d+=m.length;d%4;)v.push(0),d++;return a.write(v),n=2981146554-e(a.data),a.pos=l+8,a.writeUInt32(n),a.data},e=function(r){var n,a,i,s;for(r=jne.call(r);r.length%4;)r.push(0);for(i=new ph(r),a=0,n=0,s=r.length;n<s;n=n+=4)a+=i.readUInt32();return 4294967295&a},t}(),GJe={}.hasOwnProperty,Wu=function(e,t){for(var r in t)GJe.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};au=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var KJe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Wu(e,au),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new ph).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),d9=function(){function e(t,r){var n,a,i,s,l,c,d,u,f,m,h,v,g,y,x,b,w;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),f=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(h=t.readUInt16(),m=h/2,t.pos+=6,i=function(){var j,_;for(_=[],c=j=0;0<=m?j<m:j>m;c=0<=m?++j:--j)_.push(t.readUInt16());return _}(),t.pos+=2,g=function(){var j,_;for(_=[],c=j=0;0<=m?j<m:j>m;c=0<=m?++j:--j)_.push(t.readUInt16());return _}(),d=function(){var j,_;for(_=[],c=j=0;0<=m?j<m:j>m;c=0<=m?++j:--j)_.push(t.readUInt16());return _}(),u=function(){var j,_;for(_=[],c=j=0;0<=m?j<m:j>m;c=0<=m?++j:--j)_.push(t.readUInt16());return _}(),a=(this.length-t.pos+this.offset)/2,l=function(){var j,_;for(_=[],c=j=0;0<=a?j<a:j>a;c=0<=a?++j:--j)_.push(t.readUInt16());return _}(),c=x=0,w=i.length;x<w;c=++x)for(y=i[c],n=b=v=g[c];v<=y?b<=y:b>=y;n=v<=y?++b:--b)u[c]===0?s=n+d[c]:(s=l[u[c]/2+(n-v)-(m-c)]||0)!==0&&(s+=d[c]),this.codeMap[n]=65535&s}t.pos=f}return e.encode=function(t,r){var n,a,i,s,l,c,d,u,f,m,h,v,g,y,x,b,w,j,_,C,E,P,k,M,S,I,T,D,B,U,z,$,Y,de,xe,q,L,W,ne,le,K,Q,re,G,me,pe;switch(D=new ph,s=Object.keys(t).sort(function(Be,Z){return Be-Z}),r){case"macroman":for(g=0,y=function(){var Be=[];for(v=0;v<256;++v)Be.push(0);return Be}(),b={0:0},i={},B=0,Y=s.length;B<Y;B++)b[re=t[a=s[B]]]==null&&(b[re]=++g),i[a]={old:t[a],new:b[t[a]]},y[a]=b[t[a]];return D.writeUInt16(1),D.writeUInt16(0),D.writeUInt32(12),D.writeUInt16(0),D.writeUInt16(262),D.writeUInt16(0),D.write(y),{charMap:i,subtable:D.data,maxGlyphID:g+1};case"unicode":for(I=[],f=[],w=0,b={},n={},x=d=null,U=0,de=s.length;U<de;U++)b[_=t[a=s[U]]]==null&&(b[_]=++w),n[a]={old:_,new:b[_]},l=b[_]-a,x!=null&&l===d||(x&&f.push(x),I.push(a),d=l),x=a;for(x&&f.push(x),f.push(65535),I.push(65535),M=2*(k=I.length),P=2*Math.pow(Math.log(k)/Math.LN2,2),m=Math.log(P/2)/Math.LN2,E=2*k-P,c=[],C=[],h=[],v=z=0,xe=I.length;z<xe;v=++z){if(S=I[v],u=f[v],S===65535){c.push(0),C.push(0);break}if(S-(T=n[S].new)>=32768)for(c.push(0),C.push(2*(h.length+k-v)),a=$=S;S<=u?$<=u:$>=u;a=S<=u?++$:--$)h.push(n[a].new);else c.push(T-S),C.push(0)}for(D.writeUInt16(3),D.writeUInt16(1),D.writeUInt32(12),D.writeUInt16(4),D.writeUInt16(16+8*k+2*h.length),D.writeUInt16(0),D.writeUInt16(M),D.writeUInt16(P),D.writeUInt16(m),D.writeUInt16(E),K=0,q=f.length;K<q;K++)a=f[K],D.writeUInt16(a);for(D.writeUInt16(0),Q=0,L=I.length;Q<L;Q++)a=I[Q],D.writeUInt16(a);for(G=0,W=c.length;G<W;G++)l=c[G],D.writeUInt16(l);for(me=0,ne=C.length;me<ne;me++)j=C[me],D.writeUInt16(j);for(pe=0,le=h.length;pe<le;pe++)g=h[pe],D.writeUInt16(g);return{charMap:n,subtable:D.data,maxGlyphID:w+1}}},e}(),wne=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Wu(e,au),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,a;for(t.pos=this.offset,this.version=t.readUInt16(),a=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=a?n<a:n>a;n=0<=a?++n:--n)r=new d9(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,a;return r==null&&(r="macroman"),n=d9.encode(t,r),(a=new ph).writeUInt16(0),a.writeUInt16(1),n.table=a.data.concat(n.subtable),n},e}(),YJe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Wu(e,au),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),XJe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Wu(e,au),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),JJe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Wu(e,au),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,a;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var i;for(n=t.readUInt16(),this.glyphNameIndex=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],a=[];t.pos<this.offset+this.length;)r=t.readByte(),a.push(this.names.push(t.readString(r)));return a;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=function(){var s,l,c;for(c=[],i=s=0,l=this.file.maxp.numGlyphs;0<=l?s<l:s>l;i=0<=l?++s:--s)c.push(t.readUInt32());return c}.call(this)}},e}(),QJe=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},ZJe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Wu(e,au),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,a,i,s,l,c,d,u,f,m;for(t.pos=this.offset,t.readShort(),r=t.readShort(),l=t.readShort(),n=[],i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+l+t.readShort()});for(c={},i=u=0,f=n.length;u<f;i=++u)a=n[i],t.pos=a.offset,d=t.readString(a.length),s=new QJe(d,a),c[m=a.nameID]==null&&(c[m]=[]),c[a.nameID].push(s);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),eQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Wu(e,au),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),tQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Wu(e,au),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,a,i,s,l,c;for(t.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,u;for(u=[],r=d=0;0<=a?d<a:d>a;r=0<=a?++d:--d)u.push(t.readInt16());return u}(),this.widths=function(){var d,u,f,m;for(m=[],d=0,u=(f=this.metrics).length;d<u;d++)i=f[d],m.push(i.advance);return m}.call(this),n=this.widths[this.widths.length-1],c=[],r=s=0;0<=a?s<a:s>a;r=0<=a?++s:--s)c.push(this.widths.push(n));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),jne=[].slice,rQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Wu(e,au),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,a,i,s,l,c,d,u,f;return t in this.cache?this.cache[t]:(i=this.file.loca,r=this.file.contents,n=i.indexOf(t),(a=i.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,s=(l=new ph(r.read(a))).readShort(),d=l.readShort(),f=l.readShort(),c=l.readShort(),u=l.readShort(),this.cache[t]=s===-1?new aQe(l,d,f,c,u):new nQe(l,s,d,f,c,u),this.cache[t]))},e.prototype.encode=function(t,r,n){var a,i,s,l,c;for(s=[],i=[],l=0,c=r.length;l<c;l++)a=t[r[l]],i.push(s.length),a&&(s=s.concat(a.encode(n)));return i.push(s.length),{table:s,offsets:i}},e}(),nQe=function(){function e(t,r,n,a,i,s){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=a,this.xMax=i,this.yMax=s,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),aQe=function(){function e(t,r,n,a,i){var s,l;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;l=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&l;)s.pos+=1&l?4:2,128&l?s.pos+=8:64&l?s.pos+=4:8&l&&(s.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new ph(jne.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),oQe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Wu(e,au),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?function(){var a,i;for(i=[],n=0,a=this.length;n<a;n+=2)i.push(2*t.readUInt16());return i}.call(this):function(){var a,i;for(i=[],n=0,a=this.length;n<a;n+=4)i.push(t.readUInt32());return i}.call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),a=0,i=0,s=0;s<n.length;++s)if(n[s]=a,i<r.length&&r[i]==s){++i,n[s]=a;var l=this.offsets[s],c=this.offsets[s+1]-l;c>0&&(a+=c)}for(var d=new Array(4*n.length),u=0;u<n.length;++u)d[4*u+3]=255&n[u],d[4*u+2]=(65280&n[u])>>8,d[4*u+1]=(16711680&n[u])>>16,d[4*u]=(4278190080&n[u])>>24;return d},e}(),iQe=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,a,i;for(r in a=this.font.cmap.tables[0].codeMap,t={},i=this.subset)n=i[r],t[r]=a[n];return t},e.prototype.glyphsFor=function(t){var r,n,a,i,s,l,c;for(a={},s=0,l=t.length;s<l;s++)a[i=t[s]]=this.font.glyf.glyphFor(i);for(i in r=[],a)(n=a[i])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(i in c=this.glyphsFor(r))n=c[i],a[i]=n;return a},e.prototype.encode=function(t,r){var n,a,i,s,l,c,d,u,f,m,h,v,g,y,x;for(a in n=wne.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(t),h={0:0},x=n.charMap)h[(c=x[a]).old]=c.new;for(v in m=n.maxGlyphID,s)v in h||(h[v]=m++);return u=function(b){var w,j;for(w in j={},b)j[b[w]]=w;return j}(h),f=Object.keys(u).sort(function(b,w){return b-w}),g=function(){var b,w,j;for(j=[],b=0,w=f.length;b<w;b++)l=f[b],j.push(u[l]);return j}(),i=this.font.glyf.encode(s,g,h),d=this.font.loca.encode(i.offsets,g),y={cmap:this.font.cmap.raw(),glyf:i.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},e}();Nn.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,a,i,s;if(Array.isArray(r))return"["+function(){var l,c,d;for(d=[],l=0,c=r.length;l<c;l++)n=r[l],d.push(t.convert(n));return d}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(a in i=["<<"],r)s=r[a],i.push("/"+a+" "+t.convert(s));return i.push(">>"),i.join(`
`)}return""+r},t}();const sQe=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:LJe,AcroFormAppearance:hn,AcroFormButton:zi,AcroFormCheckBox:Jy,AcroFormChoiceField:Ip,AcroFormComboBox:Dp,AcroFormEditBox:Yy,AcroFormListBox:Tp,AcroFormPasswordField:Qy,AcroFormPushButton:Xy,AcroFormRadioButton:Mp,AcroFormTextField:eh,GState:S1,ShadingPattern:jm,TilingPattern:jp,default:Nn,jsPDF:Nn},Symbol.toStringTag,{value:"Module"})),wi=e=>{const t=String(e??"").replace(/\D/g,"");if(!t)return"";const r=(Number(t)/100).toFixed(2),[n,a]=r.split(".");return`${n.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${a}`},Ls=e=>{if(e==null||e==="")return NaN;const t=String(e).replace(/\./g,"").replace(",","."),r=parseFloat(t);return Number.isFinite(r)?r:NaN};function lQe({setIsModalOpen:e,setBookings:t,form:r,setForm:n,localCustomers:a,onOpenClientModal:i,onClientModalSuccess:s}){const{toast:l}=oo(),{userProfile:c}=Do(),{loadAlerts:d}=WS(),{isPaymentModalOpen:u,closePaymentModal:f,editingBooking:m,paymentTotal:h,setPaymentTotal:v,participantsForm:g,setParticipantsForm:y,payMethods:x,openEditParticipantModal:b,protectPaymentModal:w,onParticipantReplacedRef:j,lastVisibilityChangeTime:_,isModalProtected:C}=jN();window.__protectPaymentModal=w,p.useEffect(()=>(u&&(document.body.style.overflow="auto",document.body.style.pointerEvents="auto"),()=>{document.body.style.overflow="",document.body.style.pointerEvents=""}),[u]);const[E,P]=p.useState(""),[k,M]=p.useState([]);p.useState(null);const[S,I]=p.useState(null),[T,D]=p.useState(!1),[B,U]=p.useState(""),[z,$]=p.useState(!1),[Y,de]=p.useState([]);p.useState(null);const[xe,q]=p.useState(0),[L,W]=p.useState(!1),[ne,le]=p.useState(""),[K,Q]=p.useState([]),[re,G]=p.useState([]),me=p.useRef({}),pe=p.useRef({}),Be=p.useRef({}),[Z,ee]=p.useState(null),[kt,Nt]=p.useState(null),[De,st]=p.useState(!1),[ft,yt]=p.useState("downloading"),[Nr,se]=p.useState(0),[rt,mt]=p.useState(null),[tr,Ce]=p.useState(""),[je,ae]=p.useState(null),$e=p.useRef(null),Ae=p.useRef(null),Tt=p.useRef(null),Se=p.useRef(null),Ne=p.useRef([]),Ue=p.useRef(null),Qe=p.useRef(null),et=p.useRef(null),pt=p.useRef(!1),[Ke,qt]=p.useState(!1),[lt,rr]=p.useState({isOpen:!1,participantIndex:null,currentStatus:null}),nt=p.useRef(!1),$t=p.useCallback((ut,Ht)=>{G(dr=>{const Ft=[...dr];return ut>=0&&ut<Ft.length&&(Ht===""&&Ft[ut].nome?Be.current[ut]=Ft[ut].nome:Ht!==""&&delete Be.current[ut],Ft[ut]={...Ft[ut],nome:Ht}),y(Ft),Ft})},[y]),Qr=p.useCallback(ut=>{const Ht=Be.current[ut];Ht&&(G(dr=>{const Ft=[...dr];return ut>=0&&ut<Ft.length&&(Ft[ut]={...Ft[ut],nome:Ht}),delete Be.current[ut],y(Ft),Ft}),setTimeout(()=>{me.current[ut]?.focus()},0))},[y]),Xr=p.useCallback((ut,Ht,dr)=>{if(Ht==="Pago"){const Ft=Ls(dr);if(Number.isFinite(Ft)&&Ft>0)return}nt.current=!0,console.log(" [StatusConfirmation] Modal protegido por 3 segundos"),setTimeout(()=>{nt.current=!1,console.log(" [StatusConfirmation] Proteo removida")},3e3),rr({isOpen:!0,participantIndex:ut,currentStatus:Ht})},[]),In=p.useCallback(ut=>{const{participantIndex:Ht}=lt;Ht!==null&&(G(dr=>{const Ft=[...dr];return Ht>=0&&Ht<Ft.length&&(Ft[Ht]={...Ft[Ht],status_pagamento:ut}),y(Ft),Ft}),pt.current=!0,Qe.current&&clearTimeout(Qe.current),Qe.current=setTimeout(()=>{console.log(" [StatusChange] Salvando mudana de status...")},100),setTimeout(()=>{console.log(" [StatusChange] Recarregando alertas..."),d().catch(dr=>{console.error(" [StatusChange] Erro ao recarregar alertas:",dr)})},500)),rr({isOpen:!1,participantIndex:null,currentStatus:null})},[lt,y,d]),sn=p.useCallback(ut=>!a||!Array.isArray(a)?!1:a.find(dr=>dr.id===ut)?.is_consumidor_final===!0,[a]),Qt=p.useCallback(()=>{const ut=k||[],Ht=(re||[]).map((Ot,Br)=>({...Ot,_originalIndex:Br})).filter(Ot=>!ut.includes(Ot._originalIndex)),dr=Ht.find(Ot=>sn(Ot.cliente_id)&&Ot.nome&&Ot.nome.toLowerCase().includes("cliente consumidor"));return dr?dr._originalIndex:Ht.find(Ot=>sn(Ot.cliente_id)&&Ot.nome)?._originalIndex??null},[re,k,sn]),qr=p.useCallback(ut=>{const Ht=k||[],Ft=(re||[]).map((Br,Vt)=>({...Br,_originalIndex:Vt})).filter(Br=>!Ht.includes(Br._originalIndex)).filter(Br=>sn(Br.cliente_id));if(Ft.length===0)return null;const Ot=Ft.findIndex(Br=>Br._originalIndex===ut);return Ot!==-1?Ot<Ft.length-1?Ft[Ot+1]._originalIndex:Ft[0]._originalIndex:null},[re,k,sn]),Tr=p.useCallback(ut=>{const Ht=k||[],Ft=(re||[]).map((Br,Vt)=>({...Br,_originalIndex:Vt})).filter(Br=>!Ht.includes(Br._originalIndex)).filter(Br=>sn(Br.cliente_id)),Ot=Ft.findIndex(Br=>Br._originalIndex===ut);return Ot>0?Ft[Ot-1]._originalIndex:null},[re,k,sn]),sr=p.useCallback(()=>{if(!x||x.length===0)return null;const ut=x.find(Ht=>Ht.codigo_interno==="01");return ut||x[0]},[x]),$r=p.useMemo(()=>{const ut=re||[],Ht=k||[];return ut.filter((dr,Ft)=>!Ht.includes(Ft)).length},[re,k]),Gr=p.useMemo(()=>{const ut=re||[],Ht=k||[],dr=ut.filter((Gt,gr)=>!Ht.includes(gr)),Ft=Ls(h);let Ot=0,Br=0,Vt=0,Cr=!1;dr.forEach(Gt=>{let gr=Ls(Gt?.valor_cota);if(Gt?.aplicar_taxa===!0&&Number.isFinite(gr)){const Ye=x.find(it=>String(it.id)===String(Gt.finalizadora_id)),Xe=Number(Ye?.taxa_percentual||0);Xe>0&&(gr=gr/(1+Xe/100),Cr=!0)}Number.isFinite(gr)&&(Ot+=gr),(Gt?.status_pagamento||"Pendente")==="Pago"?Br++:Vt++});const ct=Number.isFinite(Ft)?Ot-Ft:0;return{totalTarget:Ft,totalAssigned:Ot,diff:ct,paid:Br,pending:Vt,temTaxaAplicada:Cr}},[re,k,h,x]),ke=()=>{const ut=Ls(h);if(!Number.isFinite(ut)||$r===0)return;const Ht=ut/$r,dr=wi(String(Ht.toFixed(2)));G(Ft=>{const Ot=[...Ft];return Ot.forEach((Br,Vt)=>{Ot[Vt]={...Ot[Vt],valor_cota:dr,status_pagamento:"Pago",aplicar_taxa:!1}}),Ot})},Mt=()=>{G(ut=>{const Ht=[...ut];return Ht.forEach((dr,Ft)=>{Ht[Ft]={...Ht[Ft],valor_cota:"",status_pagamento:"Pendente",aplicar_taxa:!1}}),Ht})},wr=()=>{G(ut=>{const Ht=[...ut];return Ht.forEach((dr,Ft)=>{const Ot=Ls(dr.valor_cota);if(Ot>0){const Vt=x.find(ct=>String(ct.id)===String(dr.finalizadora_id)),Cr=Number(Vt?.taxa_percentual||0);if(Cr>0&&!dr.aplicar_taxa){const ct=Ot*(1+Cr/100);Ht[Ft]={...Ht[Ft],aplicar_taxa:!0,valor_cota:wi(ct.toFixed(2))}}}}),Ht})},Fr=(ut,Ht)=>{b(ut,Ht)},Ur=()=>{le(h||""),W(!0)},Kr=()=>{v(ne),W(!1)},dn=()=>{le(""),W(!1)},wn=async(ut={})=>{const{autoSave:Ht=!1}=ut;try{if(T)return;D(!0);const dr=m?.id,Ft=c?.codigo_empresa;try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [SAVE-PAYMENTS] Iniciando salvamento",{autoSave:Ht,agendamentoId:dr,timestamp:new Date().toISOString()})}catch{}if(!dr||!Ft){l({title:"Erro ao salvar pagamentos",description:"Agendamento ou empresa indisponvel.",variant:"destructive"});return}const Ot=re||[],Br=Ot.reduce((Ye,Xe)=>{const it=Xe.status_pagamento||"Pendente";return Ye+(it!=="Pago"?1:0)},0);try{localStorage.getItem("debug:agenda")==="1"&&(console.log(" [SAVE-PAYMENTS] Dados a salvar:",{totalParticipantes:Ot.length,pendentes:Br}),console.log("[ORDER-SAVE] savingIds:",Ot.map(Ye=>Ye.cliente_id)))}catch{}const Vt=new Date().toISOString();try{localStorage.getItem("debug:agenda")==="1"&&console.log(`

========== SALVAMENTO INICIADO ${Vt} ==========`)}catch{}const{data:Cr,error:ct}=await ve.from("agendamento_participantes").select("*").eq("codigo_empresa",Ft).eq("agendamento_id",dr).order("ordem",{ascending:!0}).order("id",{ascending:!0});if(ct)throw console.error(" Erro ao buscar participantes originais:",ct),ct;try{localStorage.getItem("debug:agenda")==="1"&&(console.log(` Participantes originais no banco: ${Cr?.length||0}`),console.log("[ORDER-SAVE] originalIds:",(Cr||[]).map(Ye=>Ye.cliente_id)))}catch{}Ot.forEach((Ye,Xe)=>{console.log(`  #${Xe+1} (novo): ${Ye.nome}`)}),console.log(" Fazendo substituio inteligente por posio");for(let Ye=0;Ye<Cr.length;Ye++){const Xe=Cr[Ye],it=Ot[Ye];if(!it){console.log(` Posio #${Ye+1}: Sem participante novo, pulando`);continue}const Ze=Ls(it.valor_cota),dt=sr(),Pt=it.finalizadora_id||(dt?.id?String(dt.id):null);console.log(` Atualizando posio #${Ye+1}: ${Xe.nome}  ${it.nome}`);const{error:zt}=await ve.from("agendamento_participantes").update({cliente_id:it.cliente_id,nome:it.nome,valor_cota:Number.isFinite(Ze)?Ze:0,status_pagamento:it.status_pagamento||"Pendente",finalizadora_id:Pt,aplicar_taxa:it.aplicar_taxa||!1,ordem:Ye+1}).eq("id",Xe.id);if(zt)throw console.error(` Erro ao atualizar posio #${Ye+1}:`,zt),zt}console.log(" Substituio inteligente concluda"),console.log(`========== SALVAMENTO CONCLUDO ==========

`);const Gt=Ot.map(Ye=>({id:Ye.cliente_id,nome:Ye.nome,codigo:Ye.codigo!==null&&Ye.codigo!==void 0?Ye.codigo:null})),gr=Gt[0]||null,J=Gt.map(Ye=>Ye?.nome).filter(Boolean);await ve.from("agendamentos").update({cliente_id:gr?.id??null,clientes:J}).eq("codigo_empresa",Ft).eq("id",dr),n(Ye=>({...Ye,selectedClients:Gt})),t(Ye=>Ye.map(Xe=>Xe.id===dr?{...Xe,customer:gr?.nome||Xe.customer,cliente_id:gr?.id??null,clientes:J}:Xe)),M([]),Ht||(Br>0?l({title:"Pagamentos salvos",description:`${Br} ${Br===1?"pendente":"pendentes"}`,variant:"warning"}):l({title:"Pagamentos salvos",variant:"success"})),I(null),y(Ot);try{window.dispatchEvent(new CustomEvent("payments:saved",{detail:{agendamentoId:dr,participants:Ot}}))}catch{}d().catch(Ye=>{console.error("[PaymentModal] Erro ao recarregar alertas:",Ye)});try{localStorage.getItem("debug:agenda")==="1"&&(console.log(" [SAVE-PAYMENTS] Salvamento concludo com sucesso"),console.log(" [SAVE-PAYMENTS] Contagem final de pendentes:",Br))}catch{}console.log(" [LOG 2 - FECHAR PAYMENT MODAL] Dados salvos no banco:"),console.log("   Total:",Ot.length),console.log("   Pendentes:",Br),Ot.forEach((Ye,Xe)=>{console.log(`   #${Xe+1}: ${Ye.nome} | Status: ${Ye.status_pagamento} | Valor: ${Ye.valor_cota}`)}),Ht?console.log(" [SAVE-PAYMENTS] Auto-save concludo - modal permanece aberto"):(console.log(" [SAVE-PAYMENTS] Fechando modal de pagamentos (no  auto-save)"),f(),e(!1))}catch(dr){console.error(" [SAVE-PAYMENTS] Erro ao salvar:",dr),l({title:"Erro ao salvar pagamentos",description:"Tente novamente.",variant:"destructive"})}finally{D(!1)}};p.useEffect(()=>{const ut=Ht=>{if(u&&!z&&!De&&(Ht.key==="Escape"&&(Ht.preventDefault(),console.log(" [Auto-save Payments] Salvando ao fechar modal (ESC)..."),Qe.current&&clearTimeout(Qe.current),wn({autoSave:!0}).then(()=>{console.log(" [Auto-save Payments] Salvo ao fechar (ESC)!"),f()}).catch(dr=>{console.error(" [Auto-save Payments] Erro ao salvar ao fechar (ESC):",dr),f()})),Ht.key==="F8"&&(Ht.preventDefault(),h&&$r>0&&ke()),Ht.key==="F9"&&(Ht.preventDefault(),$r>0&&wr()),Ht.key==="F10"&&(Ht.preventDefault(),$r>0&&Mt()),Ht.key==="Delete")){const dr=document.activeElement;if(!(dr&&dr.tagName==="INPUT")){Ht.preventDefault();const Ot=Qt();Ot!==null&&($t(Ot,""),setTimeout(()=>{me.current[Ot]?.focus()},0))}}};return window.addEventListener("keydown",ut),()=>window.removeEventListener("keydown",ut)},[u,z,De,h,$r,ke,wr,Mt,T,wn,f,re,k,sn,$t,Qt]),p.useEffect(()=>{if(u){const ut=Qt();ee(ut)}},[u,re,k,Qt]),p.useEffect(()=>{if(u){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Modal aberto - payMethods:",x?.length||0,"initializedRef:",Ae.current)}catch{}Tt.current=setTimeout(()=>{try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Timeout de 3s acionado - initializedRef:",Ae.current,"payMethods:",x?.length||0)}catch{}if(!Ae.current&&(!x||x.length===0)){try{localStorage.getItem("debug:agenda")==="1"&&console.log(" [PaymentModal] Inicializando com timeout (sem finalizadoras)")}catch{}const ut=(r?.selectedClients||[]).map(Ht=>{let dr=Ht.codigo;if(dr==null&&a&&Array.isArray(a)){const Ft=a.find(Ot=>Ot.id===Ht.id);dr=Ft?.codigo!==null&&Ft?.codigo!==void 0?Ft.codigo:null}return{cliente_id:Ht.id,nome:Ht.nome,codigo:dr,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:null,aplicar_taxa:!1}});G(ut),Ae.current=Date.now()}},3e3),!Ae.current&&x&&x.length>0&&(Tt.current&&(clearTimeout(Tt.current),Tt.current=null),(async()=>{const{defaultMethod:Ht,defaultFinalizadoraId:dr,defaultAplicarTaxa:Ft}=(()=>{const Cr=sr(),ct=Cr?.id?String(Cr.id):null,Gt=Number(Cr?.taxa_percentual||0)>0;return{defaultMethod:Cr,defaultFinalizadoraId:ct,defaultAplicarTaxa:Gt}})();let Ot=[],Br="nenhuma";if(m?.id)try{const{data:Cr,error:ct}=await ve.from("agendamento_participantes").select("*").eq("agendamento_id",m.id).eq("codigo_empresa",c?.codigo_empresa).order("ordem",{ascending:!0}).order("id",{ascending:!0});ct?console.error(" Erro ao buscar participantes:",ct):Cr&&Cr.length>0?(Ot=Cr.map(Gt=>({cliente_id:Gt.cliente_id,nome:Gt.nome,codigo:null,valor_cota:Gt.valor_cota?wi(String(Number(Gt.valor_cota).toFixed(2))):"0,00",status_pagamento:Gt.status_pagamento||"Pendente",finalizadora_id:Gt.finalizadora_id?String(Gt.finalizadora_id):dr,aplicar_taxa:Gt.aplicar_taxa||!1})),Br="banco de dados"):Br="banco vazio"}catch(Cr){console.error(" Erro ao buscar participantes:",Cr)}Ot.length===0&&g&&g.length>0?(Ot=g,Br="participantsForm (contexto)"):Ot.length===0&&r?.selectedClients&&r.selectedClients.length>0&&(Ot=(r?.selectedClients||[]).map(Cr=>{let ct=Cr.codigo;if(ct==null&&a&&Array.isArray(a)){const Gt=a.find(gr=>gr.id===Cr.id);ct=Gt?.codigo!==null&&Gt?.codigo!==void 0?Gt.codigo:null}return{cliente_id:Cr.id,nome:Cr.nome,codigo:ct,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:dr,aplicar_taxa:Ft}}),Br="form.selectedClients");let Vt=Ot.map(Cr=>{let ct=Cr.codigo;if(ct==null&&a&&Array.isArray(a)){const gr=a.find(J=>J.id===Cr.cliente_id);ct=gr?.codigo!==null&&gr?.codigo!==void 0?gr.codigo:null}let Gt=Cr.finalizadora_id;if(!Gt){const gr=sr();Gt=gr?.id?String(gr.id):null}return{...Cr,codigo:ct??Cr.codigo,finalizadora_id:Gt}});try{const Cr=(r?.selectedClients||[]).slice();if(Cr.length>0&&Vt.length>0){const ct=new Map;Vt.forEach(Xe=>{const it=ct.get(Xe.cliente_id)||[];it.push(Xe),ct.set(Xe.cliente_id,it)});const Gt=new Map,gr=[];for(const Xe of Cr){const it=Gt.get(Xe.id)||0,dt=(ct.get(Xe.id)||[])[it];if(dt)gr.push(dt),Gt.set(Xe.id,it+1);else{const Pt=sr(),zt=Pt?.id?String(Pt.id):null;gr.push({cliente_id:Xe.id,nome:Xe.nome,codigo:Xe.codigo??null,valor_cota:"0,00",status_pagamento:"Pendente",finalizadora_id:zt,aplicar_taxa:Number(Pt?.taxa_percentual||0)>0})}}const J=new Map(Gt),Ye=[];ct.forEach((Xe,it)=>{const Ze=J.get(it)||0;for(let dt=Ze;dt<Xe.length;dt++)Ye.push(Xe[dt])}),Ot=gr.concat(Ye);try{const Xe=Ot.findIndex(it=>String(it?.nome||"").toLowerCase()!=="cliente consumidor");if(Xe>0){const it=Ot.splice(Xe,1)[0];Ot.unshift(it),localStorage.getItem("debug:agenda")==="1"&&console.log("[REP] Promovido a representante:",it?.nome)}}catch{}Br=Br+" (reordenado pelos chips)"}}catch(Cr){console.error("[PaymentModal] Falha ao reordenar por chips:",Cr)}if(Vt=Ot.map(Cr=>{let ct=Cr.codigo;if(ct==null&&a&&Array.isArray(a)){const Gt=a.find(gr=>gr.id===Cr.cliente_id);ct=Gt?.codigo!==null&&Gt?.codigo!==void 0?Gt.codigo:null}return{...Cr,codigo:ct??Cr.codigo,finalizadora_id:Cr.finalizadora_id||(()=>{const Gt=sr();return Gt?.id?String(Gt.id):null})()}}),Vt.length===0&&m?.id){console.error(" ALERTA CRTICO: Nenhum participante encontrado em NENHUMA fonte!"),console.error(" Agendamento ID:",m.id),console.error(" Empresa:",c?.codigo_empresa),console.error(" Isso pode indicar perda de dados!");try{const{data:Cr,error:ct}=await ve.from("agendamento_participantes").select("*").eq("agendamento_id",m.id);console.error(" Busca sem filtro de empresa:",{encontrados:Cr?.length||0,dados:Cr,erro:ct})}catch(Cr){console.error(" Erro na busca de debug:",Cr)}}if(Vt.length>0||!m?.id){G(Vt),Ae.current=Date.now();try{if(localStorage.getItem("debug:agenda")==="1"){console.log(" [LOG 1 - ABRIR PAYMENT MODAL] Participantes carregados:"),console.log("   Total:",Vt.length),console.log("   Fonte:",Br),Vt.forEach((Gt,gr)=>{console.log(`   #${gr+1}: ${Gt.nome} | Status: ${Gt.status_pagamento} | Valor: ${Gt.valor_cota}`)});const Cr=(r?.selectedClients||[]).map(Gt=>Gt.id),ct=Vt.map(Gt=>Gt.cliente_id);console.log("[ORDER] chipsIds:",Cr),console.log("[ORDER] finalIds:",ct)}}catch{}}else console.error(" BLOQUEADO: No vou sobrescrever com array vazio!"),console.error(" Mantendo dados anteriores para evitar perda.")})())}else Tt.current&&(clearTimeout(Tt.current),Tt.current=null),P(""),I(null),M([]),G([]);return()=>{Tt.current&&clearTimeout(Tt.current)}},[u,x,sr,g,r?.selectedClients,a]),p.useEffect(()=>{Ae.current=null},[m?.id]),p.useEffect(()=>(j.current=ut=>{Q([ut]),setTimeout(()=>{Q([])},1e3)},()=>{j.current=null}),[j]);const va=p.useCallback(ut=>{G(ut)},[]);p.useEffect(()=>(u&&(y.updateLocal=va,y.getLocal=()=>re),()=>{y.updateLocal&&(delete y.updateLocal,delete y.getLocal)}),[u,va,re]),p.useLayoutEffect(()=>{if(!u)return;const ut=(r?.selectedClients||[]).slice();if(ut.length!==0&&!(!re||re.length===0))try{const Ht=new Map;re.forEach(ct=>{const Gt=Ht.get(ct.cliente_id)||[];Gt.push(ct),Ht.set(ct.cliente_id,Gt)});const dr=new Map,Ft=[];for(const ct of ut){const Gt=dr.get(ct.id)||0,J=(Ht.get(ct.id)||[])[Gt];J?(Ft.push(J),dr.set(ct.id,Gt+1)):Ft.push({cliente_id:ct.id,nome:ct.nome,codigo:ct.codigo??null,valor_cota:"0,00",status_pagamento:"Pendente",finalizadora_id:sr()?.id?String(sr().id):null,aplicar_taxa:Number(sr()?.taxa_percentual||0)>0})}const Ot=new Map(dr),Br=[];Ht.forEach((ct,Gt)=>{const gr=Ot.get(Gt)||0;for(let J=gr;J<ct.length;J++)Br.push(ct[J])});const Vt=Ft.concat(Br);if(Vt.length!==re.length||Vt.some((ct,Gt)=>ct.cliente_id!==re[Gt]?.cliente_id||ct.nome!==re[Gt]?.nome)){try{if(localStorage.getItem("debug:agenda")==="1"){const ct=ut.map(gr=>gr.nome),Gt=Vt.map(gr=>gr.nome);console.log("[ORDER] chipsNames:",ct),console.log("[ORDER] finalNames (next):",Gt)}}catch{}G(Vt)}}catch(Ht){console.error("[PaymentModal] Falha ao reordenar aps mudana de chips:",Ht)}},[u,r?.selectedClients]),p.useEffect(()=>{z||(de([]),U("")),q(0)},[z]),p.useEffect(()=>{z&&Ne.current[xe]&&Ne.current[xe]?.scrollIntoView({behavior:"smooth",block:"nearest"})},[xe,z]),p.useEffect(()=>{const ut=Ht=>{if(z&&(Ht.key==="Escape"&&(Ht.preventDefault(),$(!1),U(""),de([])),Ht.key==="Enter"&&Ht.target.tagName!=="INPUT"&&Y.length>0)){Ht.preventDefault();const dr=Y.map(Ft=>({cliente_id:Ft.id,nome:Ft.nome,codigo:Ft.codigo,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:(()=>{const Ot=sr();return Ot?.id?String(Ot.id):null})(),aplicar_taxa:(()=>{const Ot=sr();return Number(Ot?.taxa_percentual||0)>0})()}));G(Ft=>{const Ot=Ft.length,Br=dr.map((Vt,Cr)=>Ot+Cr);return Q(Br),setTimeout(()=>{Q([])},1e3),[...Ft,...dr]}),$(!1),de([]),U("")}};return window.addEventListener("keydown",ut),()=>window.removeEventListener("keydown",ut)},[z,Y,sr,G,l,U,$,de]),p.useEffect(()=>{const ut=async()=>{try{if(!u)return;Qe.current&&(clearTimeout(Qe.current),Qe.current=null),T||await wn({autoSave:!0})}catch(Ht){console.error("[PaymentModal] save-and-close erro:",Ht)}finally{f();try{window.dispatchEvent(new Event("paymentmodal:closed"))}catch{}}};return window.addEventListener("paymentmodal:save-and-close",ut),()=>window.removeEventListener("paymentmodal:save-and-close",ut)},[u,wn,f]),p.useEffect(()=>{if(!u){console.log(" [AUTO-SAVE] Modal de pagamentos fechado - desabilitando auto-save"),console.log(" [AUTO-SAVE] Estado final ao fechar:",{localParticipantsForm:re.map(Ht=>({nome:Ht.nome,status:Ht.status_pagamento,valor:Ht.valor_cota})),timestamp:new Date().toISOString()}),pt.current=!1,et.current=null;return}if(!pt.current){console.log(" [AUTO-SAVE] Inicializando auto-save (aguardando 500ms)");const Ht=setTimeout(()=>{pt.current=!0,et.current=JSON.stringify(re),console.log(" [AUTO-SAVE] Auto-save habilitado")},500);return()=>clearTimeout(Ht)}const ut=JSON.stringify(re);if(ut!==et.current)return console.log(" [AUTO-SAVE] Mudana detectada - agendando salvamento em 1.5s"),Qe.current&&(console.log(" [AUTO-SAVE] Cancelando auto-save anterior"),clearTimeout(Qe.current)),Qe.current=setTimeout(async()=>{console.log(" [AUTO-SAVE] Iniciando auto-save AGORA"),console.log(" [AUTO-SAVE] Participantes a salvar:",re.length),qt(!0);try{await wn({autoSave:!0}),et.current=ut,console.log(" [AUTO-SAVE] Salvo com sucesso!")}catch(Ht){console.error(" [AUTO-SAVE] Erro ao salvar:",Ht)}finally{qt(!1)}},1500),()=>{Qe.current&&clearTimeout(Qe.current)}},[u,re,wn]),p.useEffect(()=>{!De&&je&&(console.log(" [PDF] Revogando URL do blob ao fechar modal"),URL.revokeObjectURL(je),ae(null))},[De,je]);const xa=p.useRef(null),Aa=async()=>{try{if(console.log(" [PDF] Iniciando gerao do PDF"),!xa.current)throw new Error("Elemento do relatrio no encontrado");console.log(" [PDF] Abrindo modal de download"),je&&URL.revokeObjectURL(je),st(!0),yt("downloading"),se(0),mt(null),ae(null),Ce("");const ut=(re||[]).filter((zt,Er)=>!(k||[]).includes(Er)),Ht=20,dr=Math.ceil(ut.length/Ht);se(5);const Ft=new Nn({orientation:"landscape",unit:"mm",format:"a4",compress:!0}),Ot=297,Br=210;for(let zt=0;zt<dr;zt++){const Er=zt*Ht,H=Math.min(Er+Ht,ut.length),Ee=ut.slice(Er,H),Te=10+Math.floor(zt/dr*80);se(Te);const vt=xa.current;if(!vt)throw new Error("Elemento do relatrio no encontrado durante a gerao");console.log(` [PDF] Capturando pgina ${zt+1}/${dr} (participantes ${Er+1}-${H})`);const ze={visibility:vt.style.visibility,opacity:vt.style.opacity};vt.style.visibility="visible",vt.style.opacity="1",console.log(` [PDF] Elemento innerHTML length: ${vt.innerHTML.length}`),console.log(` [PDF] Elemento scrollHeight: ${vt.scrollHeight}`),console.log(` [PDF] Elemento scrollWidth: ${vt.scrollWidth}`);const at=vt.querySelector('div[style*="borderBottom"]'),Zt=vt.querySelectorAll('div[style*="borderBottom"]')[1];zt>0?(at&&(at.style.display="none"),Zt&&(Zt.style.display="none")):(at&&(at.style.display="block"),Zt&&(Zt.style.display="flex"));const zr=vt.querySelectorAll("tbody tr");console.log(` [PDF] Total de linhas na tabela: ${zr.length}`),zr.forEach((tt,Lr)=>{tt.style.display=Lr>=Er&&Lr<H?"table-row":"none"});const Ar=vt.querySelector("#page-indicator");Ar&&(Ar.textContent=`Pgina ${zt+1} de ${dr}`),console.log(" [PDF] Forando reflow..."),vt.offsetHeight,vt.getBoundingClientRect(),vt.scrollHeight,vt.offsetWidth,vt.clientHeight,console.log(" [PDF] Aguardando renderizao..."),await new Promise(tt=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{setTimeout(tt,2e3)})})})}),console.log(" [PDF] Renderizao completa, iniciando captura...");const br=vt.querySelectorAll("tbody tr");if(console.log(` [PDF] Linhas da tabela encontradas: ${br.length}`),br.forEach((tt,Lr)=>{const cn=tt.querySelectorAll("td"),pn=Array.from(cn).map(jn=>jn.textContent.trim()).join(" | ");console.log(` [PDF] Linha ${Lr+1}: ${pn}`)}),br.length===0){console.warn(" [PDF] AVISO: Nenhuma linha de tabela encontrada! Verificando estrutura...");const tt=vt.querySelector("tbody");console.log(" [PDF] tbody existe:",!!tt),tt&&console.log(" [PDF] innerHTML do tbody:",tt.innerHTML.substring(0,500))}let yr;try{const tt=vt.scrollHeight,Lr=vt.scrollWidth;if(console.log(` [PDF] Dimenses reais: width=${Lr}px, height=${tt}px`),yr=await oKe(vt,{pixelRatio:2,backgroundColor:"#ffffff",cacheBust:!0,skipFonts:!1}),!yr||yr.length===0)throw new Error("Canvas vazio retornado pela captura");console.log(` [PDF] Pgina ${zt+1} capturada (${yr.length} bytes, ${tt}px altura, ${br.length} linhas)`)}catch(tt){throw console.error(` [PDF] Erro ao capturar pgina ${zt+1}:`,tt),vt.style.visibility=ze.visibility,vt.style.opacity=ze.opacity,new Error(`Falha ao capturar pgina ${zt+1}: ${tt.message}`)}vt.style.visibility=ze.visibility,vt.style.opacity=ze.opacity,zt>0&&Ft.addPage();const nr=Ot,Zr=vt.scrollHeight/vt.scrollWidth*Ot;Ft.addImage(yr,"PNG",0,0,nr,Zr,"","MEDIUM"),console.log(` [PDF] Pgina ${zt+1} adicionada ao PDF (${nr}mm x ${Zr}mm)`)}if(xa.current){xa.current.querySelectorAll("tbody tr").forEach(H=>{H.style.display="table-row"});const Er=xa.current.querySelector("#page-indicator");Er&&(Er.textContent="")}se(95);const Vt=dr>1?` (${dr} pginas)`:"",Cr=(re||[]).filter((zt,Er)=>!(k||[]).includes(Er));let ct=Cr.find(zt=>!a?.find(H=>H.id===zt.cliente_id)?.is_consumidor_final);!ct&&Cr.length>0&&(ct=Cr[0]);const gr=(ct?.nome||"sem-nome").trim().split(/\s+/),J=gr[0]||"sem",Ye=gr.length>1?gr[gr.length-1]:"nome",it=`rel-${`${J}-${Ye}`.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9-]+/g,"-").replace(/^-+|-+$/g,"")}-${m?.code||"0"}${Vt}.pdf`,Ze=Ft.output("blob"),dt=URL.createObjectURL(Ze);mt(Ze),ae(dt),Ce(it),se(100);const Pt=document.createElement("a");Pt.href=dt,Pt.download=it,Pt.click(),await new Promise(zt=>setTimeout(zt,500)),console.log(" [PDF] PDF gerado com sucesso! Modal de download deve permanecer aberto."),console.log(" [PDF] isPaymentModalOpen deve continuar true"),yt("success"),console.log(" [PDF] Status atualizado para success")}catch(ut){console.error(" [PDF] Erro ao gerar PDF:",ut),st(!1),l({title:"Erro ao gerar PDF",description:ut?.message||"No foi possvel gerar o PDF.",variant:"destructive"})}};return o.jsxs(o.Fragment,{children:[o.jsx(ln,{open:u,onOpenChange:ut=>{if(console.log(" [PaymentModal] onOpenChange chamado:",{open:ut,isDownloadModalOpen:De}),!ut){if(console.log(" [PaymentModal] Tentando fechar modal de pagamentos"),De){console.log(" [PaymentModal] BLOQUEADO: Modal de download est aberto");return}console.log(" [PaymentModal] Fechando modal de pagamentos"),f()}},children:o.jsx(on,{forceMount:!0,className:"w-full max-w-[95vw] sm:max-w-[1100px] max-h-[90vh] overflow-y-auto overflow-x-hidden",onOpenAutoFocus:ut=>ut.preventDefault(),onInteractOutside:async ut=>{const Ht=Date.now(),dr=Ae.current?Ht-Ae.current:0,Ft=Ht-_;if(console.log(" [PaymentModal] onInteractOutside disparado:",{target:ut.target?.tagName,className:ut.target?.className?.substring?.(0,50),timeSinceInit:`${dr}ms`,timeSinceVisibility:`${Ft}ms`,isAddParticipantOpen:z,isDownloadModalOpen:De,statusConfirmationOpen:lt.isOpen,isModalProtected:C,timestamp:new Date().toISOString()}),lt.isOpen){console.log(" [PaymentModal] Bloqueado: modal de confirmao de status est aberto"),ut.preventDefault();return}if(De){console.log(" [PaymentModal] Bloqueado: modal de download est aberto"),ut.preventDefault();return}if(C){console.log(" [PaymentModal] Bloqueado: modal protegido (protectPaymentModal ativo)"),ut.preventDefault();return}if(z){console.log(" [PaymentModal] Bloqueado: modal de adicionar participante aberto"),ut.preventDefault();return}if(Ae.current&&dr<500){console.log(" [PaymentModal] Bloqueado: modal abriu recentemente"),ut.preventDefault();return}if(Ft<3e3){console.log(` [PaymentModal] Bloqueado: mudana de visibilidade recente (${Ft}ms atrs)`),ut.preventDefault();return}ut.preventDefault(),console.log(" [Auto-save Payments] Salvando ao clicar fora do modal...");try{if(Qe.current&&(console.log(" [Auto-save Payments] Cancelando auto-save pendente antes de salvar ao clicar fora"),clearTimeout(Qe.current),Qe.current=null),T){console.log(" [Auto-save Payments] J est salvando - ignorando novo salvamento ao clicar fora"),f();return}await wn({autoSave:!0}),console.log(" [Auto-save Payments] Salvo ao clicar fora!")}catch(Ot){console.error(" [Auto-save Payments] Erro ao salvar ao clicar fora:",Ot)}finally{f()}},onEscapeKeyDown:ut=>{ut.preventDefault()},children:!x||x.length===0?Ae.current?o.jsxs(o.Fragment,{children:[o.jsxs(nn,{className:"sr-only",children:[o.jsx(rn,{children:"Aviso"}),o.jsx(_n,{children:"Nenhuma forma de pagamento cadastrada"})]}),o.jsxs("div",{className:"p-8 flex flex-col items-center justify-center gap-4",children:[o.jsx(Af,{className:"w-12 h-12 text-amber-500"}),o.jsxs("div",{className:"text-center space-y-2",children:[o.jsx("p",{className:"font-semibold text-amber-500",children:"Nenhuma forma de pagamento cadastrada"}),o.jsx("p",{className:"text-sm text-text-muted",children:"Cadastre pelo menos uma finalizadora para gerenciar pagamentos."})]}),o.jsxs("div",{className:"flex gap-2 mt-4",children:[o.jsx(oe,{type:"button",variant:"outline",onClick:f,children:"Fechar"}),o.jsx(kI,{to:"/finalizadoras",children:o.jsx(oe,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white",onClick:f,children:"Cadastrar Finalizadora"})})]})]})]}):o.jsxs(o.Fragment,{children:[o.jsxs(nn,{className:"sr-only",children:[o.jsx(rn,{children:"Carregando"}),o.jsx(_n,{children:"Carregando formas de pagamento"})]}),o.jsxs("div",{className:"p-8 flex flex-col items-center justify-center gap-4",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-500"}),o.jsx("p",{className:"text-sm text-text-muted",children:"Carregando formas de pagamento..."})]})]}):o.jsxs(o.Fragment,{children:[o.jsx(nn,{className:"relative pb-4",children:o.jsxs("div",{className:"flex flex-col sm:flex-row items-start justify-between gap-3 sm:gap-4",children:[o.jsxs("div",{className:"flex-1 w-full sm:w-auto",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(rn,{children:"Registrar pagamento"}),Ke&&o.jsxs("span",{className:"inline-flex items-center gap-2 px-2.5 py-1 rounded-full border text-xs bg-blue-600/10 text-blue-400 border-blue-700/30",children:[o.jsxs("svg",{className:"w-3 h-3 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Salvando..."]})]}),o.jsx(_n,{children:"As alteraes so salvas automaticamente enquanto voc edita."})]}),o.jsxs(oe,{type:"button",variant:"outline",size:"sm",onClick:Aa,className:"flex-shrink-0 gap-2 w-full sm:w-auto mt-2 sm:mt-0",title:"Baixar relatrio como imagem",children:[o.jsx(ri,{className:"w-4 h-4"}),o.jsx("span",{children:"Baixar Relatrio"})]})]})}),o.jsxs("div",{className:"space-y-3 sm:space-y-6",children:[o.jsxs("div",{className:"sm:hidden space-y-2 max-w-md mx-auto",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{className:"p-2 rounded-lg bg-emerald-600/10 border border-emerald-500/30 min-w-0 relative group",children:[o.jsx("div",{className:"text-[10px] text-emerald-300/80 mb-1 truncate",children:"Total"}),L?o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(or,{type:"text",value:ne,onChange:ut=>le(wi(ut.target.value)),className:"w-full h-6 text-xs text-center font-bold bg-emerald-950/50 border-emerald-400/50 text-emerald-300 px-1",placeholder:"0,00",autoFocus:!0,onKeyDown:ut=>{ut.key==="Enter"&&ne!==h?Kr():ut.key==="Escape"&&dn()},onBlur:()=>{ne!==h?Kr():dn()}}),ne!==h&&o.jsx("button",{onMouseDown:ut=>ut.preventDefault(),onClick:Kr,className:"p-0.5 rounded hover:bg-emerald-500/20 transition-colors flex-shrink-0",title:"Confirmar",children:o.jsx(ih,{className:"w-3 h-3 text-emerald-400"})})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"text-sm font-bold text-emerald-400 truncate",children:wi(h)||"R$ 0,00"}),o.jsx("button",{onClick:Ur,className:"absolute right-1 top-1/2 -translate-y-1/2 p-0.5 rounded hover:bg-emerald-500/20 transition-colors",title:"Editar",children:o.jsx(El,{className:"w-3 h-3 text-emerald-400"})})]})]}),o.jsxs("div",{className:`p-2 rounded-lg border min-w-0 ${Gr.diff===0?"bg-emerald-600/10 border-emerald-500/30":Gr.diff>0?"bg-amber-600/10 border-amber-500/30":"bg-rose-600/10 border-rose-500/30"}`,children:[o.jsx("div",{className:`text-[10px] mb-1 truncate ${Gr.diff===0?"text-emerald-300/80":Gr.diff>0?"text-amber-300/80":"text-rose-300/80"}`,children:"Diferena"}),o.jsxs("div",{className:`text-sm font-bold truncate ${Gr.diff===0?"text-emerald-400":Gr.diff>0?"text-amber-400":"text-rose-400"}`,children:[Gr.diff>0?"+":"",wi(String(Math.abs(Gr.diff).toFixed(2)))]})]})]}),o.jsxs("div",{className:"flex gap-1.5 text-xs justify-center",children:[o.jsxs("span",{className:"px-2.5 py-1.5 rounded bg-white/5 border border-white/10 whitespace-nowrap",children:[o.jsx("span",{className:"text-text-secondary",children:"Participantes:"})," ",o.jsx("strong",{children:$r})]}),o.jsxs("span",{className:"px-2.5 py-1.5 rounded bg-white/5 border border-white/10 whitespace-nowrap",children:[o.jsx("span",{className:"text-text-secondary",children:"Atribudo:"})," ",o.jsxs("strong",{children:["R$ ",Gr.totalAssigned.toFixed(2)]})]}),o.jsxs("span",{className:"px-2.5 py-1.5 rounded bg-white/5 border border-white/10 whitespace-nowrap",children:[o.jsx("span",{className:"text-text-secondary",children:"Alvo:"})," ",o.jsxs("strong",{children:["R$ ",Gr.totalTarget.toFixed(2)]})]})]}),o.jsxs("div",{className:"flex flex-col gap-2",children:[o.jsx(oe,{type:"button",size:"sm",className:"bg-sky-600 hover:bg-sky-500 text-white text-xs h-8 px-3",onClick:ke,disabled:!h||$r===0,children:(()=>{const ut=Ls(h);if(Number.isFinite(ut)&&$r>0){const Ht=ut/$r;return`Dividir (${wi(String(Ht.toFixed(2)))})`}return"Dividir"})()}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(oe,{type:"button",variant:"ghost",size:"sm",className:"border border-amber-500/30 text-amber-400 hover:bg-amber-500/10 text-xs h-8 px-3 flex-1",onClick:wr,disabled:$r===0,children:"Aplicar taxas"}),o.jsx(oe,{type:"button",variant:"ghost",size:"sm",className:"border border-white/10 text-xs h-8 px-3 flex-1",onClick:Mt,disabled:$r===0,children:"Zerar"})]})]})]}),o.jsx("div",{className:"hidden sm:block p-4 rounded-lg border border-border bg-gradient-to-br from-surface-2 to-surface shadow-md",children:o.jsxs("div",{className:"flex flex-col md:flex-row md:items-start gap-3 w-full",children:[o.jsxs("div",{className:"flex flex-row gap-3",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx(Wt,{className:"font-bold text-base text-white",children:"Valor total a receber"}),o.jsx("div",{className:"w-[180px] px-3 py-2 rounded-md bg-gradient-to-br from-emerald-600/20 to-emerald-700/20 border-2 border-emerald-500/40 shadow-lg flex items-center justify-center gap-2 relative group",children:L?o.jsxs(o.Fragment,{children:[o.jsx(or,{type:"text",value:ne,onChange:ut=>le(wi(ut.target.value)),className:"w-full h-8 text-center text-lg font-bold bg-emerald-950/50 border-emerald-400/50 text-emerald-300",placeholder:"0,00",autoFocus:!0,onKeyDown:ut=>{ut.key==="Enter"&&ne!==h?Kr():ut.key==="Escape"&&dn()},onBlur:()=>{ne!==h?Kr():dn()}}),ne!==h&&o.jsx("button",{onMouseDown:ut=>ut.preventDefault(),onClick:Kr,className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 rounded hover:bg-emerald-500/20 transition-colors",title:"Confirmar (Enter)",children:o.jsx(ih,{className:"w-4 h-4 text-emerald-400"})})]}):o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"text-xl font-bold text-emerald-400",children:wi(h)||"R$ 0,00"}),o.jsx("button",{onClick:Ur,className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 rounded hover:bg-emerald-500/20 transition-colors opacity-0 group-hover:opacity-100",title:"Editar valor total",children:o.jsx(El,{className:"w-4 h-4 text-emerald-400"})})]})})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx(Wt,{className:"font-bold text-base text-white",children:"Diferena"}),o.jsx("div",{className:`w-[180px] px-3 py-2 rounded-md border-2 shadow-lg flex items-center justify-center ${Gr.diff===0?"bg-gradient-to-br from-emerald-600/20 to-emerald-700/20 border-emerald-500/40":Gr.diff>0?"bg-gradient-to-br from-amber-600/20 to-amber-700/20 border-amber-500/40":"bg-gradient-to-br from-rose-600/20 to-rose-700/20 border-rose-500/40"}`,children:o.jsxs("span",{className:`text-xl font-bold ${Gr.diff===0?"text-emerald-400":Gr.diff>0?"text-amber-400":"text-rose-400"}`,children:[Gr.diff>0?"+":"",wi(String(Math.abs(Gr.diff).toFixed(2)))]})})]})]}),o.jsxs("div",{className:"ml-auto flex flex-col gap-3 items-end",children:[o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded bg-white/5 border border-white/10",children:[o.jsx("span",{className:"text-text-secondary",children:"Participantes:"}),o.jsx("strong",{children:$r})]}),o.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded bg-white/5 border border-white/10",children:[o.jsx("span",{className:"text-text-secondary",children:"Atribudo:"}),o.jsxs("strong",{children:["R$ ",Gr.totalAssigned.toFixed(2)]})]}),o.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded bg-white/5 border border-white/10",children:[o.jsx("span",{className:"text-text-secondary",children:"Alvo:"}),o.jsxs("strong",{children:["R$ ",Gr.totalTarget.toFixed(2)]})]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[o.jsx(oe,{type:"button",variant:"secondary",size:"sm",className:"bg-sky-600 hover:bg-sky-500 text-white flex-shrink-0",onClick:ke,disabled:!h||$r===0,children:(()=>{const ut=Ls(h);if(Number.isFinite(ut)&&$r>0){const Ht=ut/$r;return o.jsxs(o.Fragment,{children:["Dividir igualmente (",wi(String(Ht.toFixed(2)))," cada)",o.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-sky-700/50 rounded border border-sky-500/30",children:"F8"})]})}return o.jsxs(o.Fragment,{children:["Dividir igualmente",o.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-sky-700/50 rounded border border-sky-500/30",children:"F8"})]})})()}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(oe,{type:"button",variant:"ghost",size:"sm",className:"border border-amber-500/30 text-amber-400 hover:bg-amber-500/10 flex-1 sm:flex-initial whitespace-nowrap",onClick:wr,disabled:$r===0,children:["Aplicar taxas",o.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-amber-700/50 rounded border border-amber-500/30",children:"F9"})]}),o.jsxs(oe,{type:"button",variant:"ghost",size:"sm",className:"border border-white/10 flex-1 sm:flex-initial",onClick:Mt,disabled:$r===0,children:["Zerar",o.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-white/10 rounded border border-white/20",children:"F10"})]})]})]})]})]})}),(r.selectedClients||[]).length===0?o.jsx("div",{className:"text-xs text-text-muted italic",children:'Nenhum participante neste agendamento. Adicione participantes no campo "Clientes" do modal principal.'}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[o.jsxs("div",{className:"relative flex-1 min-w-0",children:[o.jsx(or,{ref:$e,type:"text",placeholder:"Buscar participante...",value:E,onChange:ut=>P(ut.target.value),className:"pr-16"}),o.jsx("button",{type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs text-amber-400 hover:text-amber-300",onClick:()=>{P(""),$e.current?.focus()},children:"limpar"})]}),o.jsxs(oe,{type:"button",size:"sm",className:"bg-amber-500 hover:bg-amber-400 text-black shadow-md flex-shrink-0",onClick:ut=>{ut.preventDefault(),ut.stopPropagation(),w(2e3),$(!0)},children:[o.jsx("span",{className:"hidden sm:inline",children:"Adicionar participante +"}),o.jsx("span",{className:"sm:hidden",children:"Participante +"})]})]}),S?.type==="pending"&&o.jsxs("div",{role:"alert",className:"mb-2 rounded-md border border-amber-600/40 bg-amber-500/10 px-3 py-2 text-amber-200 flex items-start gap-3",children:[o.jsx(Af,{className:"w-4 h-4 text-amber-300 mt-0.5"}),o.jsxs("div",{className:"flex-1 text-sm",children:[o.jsx("strong",{children:"Ateno:"})," Existem ",o.jsx("strong",{children:S.count})," participante(s) com status ",o.jsx("strong",{children:"Pendente"}),"."]}),o.jsx("button",{type:"button",className:"text-xs px-2 py-1 rounded bg-amber-500/20 hover:bg-amber-500/30 border border-amber-600/40",onClick:()=>I(null),children:"Entendi"})]}),o.jsx("div",{className:"border border-border rounded-md overflow-hidden",children:o.jsx("div",{className:"divide-y divide-border max-h-[50vh] overflow-y-scroll",children:(()=>{const ut=E.trim().toLowerCase(),Ht=k||[],Ft=(re||[]).map((Ot,Br)=>({...Ot,_originalIndex:Br})).filter(Ot=>!Ht.includes(Ot._originalIndex)).filter(Ot=>!ut||String(Ot?.nome||"").toLowerCase().includes(ut));return Ft.length===0?o.jsx("div",{className:"px-3 py-4 text-sm text-text-muted",children:"Nenhum participante com esse nome"}):Ft.map(Ot=>{const Br=`participant-${Ot._originalIndex}`,Vt=Ot._originalIndex,Cr=K.includes(Vt);return o.jsxs("div",{className:`p-2 sm:p-3 border-b last:border-b-0 transition-all duration-500 ease-out ${Cr?"bg-white/10":""}`,children:[o.jsxs("div",{className:"sm:hidden space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[Ot.codigo!==null&&Ot.codigo!==void 0&&o.jsxs("span",{className:`text-xs font-bold rounded px-1.5 py-0.5 shrink-0 ${Ot.status_pagamento==="Pago"?"text-emerald-400 bg-emerald-600/20 border border-emerald-700/40":"text-amber-400 bg-amber-600/20 border border-amber-700/40"}`,children:["#",Ot.codigo]}),sn(Ot.cliente_id)?o.jsxs("div",{className:"relative flex-1 min-w-0",children:[o.jsx("input",{ref:ct=>{ct&&(me.current[Vt]=ct)},type:"text",value:Ot.nome||"",onChange:ct=>$t(Vt,ct.target.value),onFocus:()=>Nt(Vt),onKeyDown:ct=>{if(ct.key==="Enter"){ct.preventDefault();const Gt=qr(Vt);Gt!==null&&setTimeout(()=>{me.current[Gt]?.focus()},0)}else if(ct.key==="Delete"&&Ot.nome&&ct.target===document.activeElement)ct.preventDefault(),ct.stopPropagation(),$t(Vt,""),setTimeout(()=>{me.current[Vt]?.focus()},0);else if(ct.key==="ArrowDown"){ct.preventDefault();const Gt=qr(Vt);Gt!==null&&setTimeout(()=>{me.current[Gt]?.focus()},0)}else if(ct.key==="ArrowUp"){ct.preventDefault();const Gt=Tr(Vt);Gt!==null&&setTimeout(()=>{me.current[Gt]?.focus()},0)}},onBlur:async()=>{Nt(null),!Ot.nome&&Be.current[Vt]&&Qr(Vt);try{Qe.current&&clearTimeout(Qe.current),await wn({autoSave:!0})}catch(ct){console.error("[PaymentModal] Erro ao salvar ao sair do nome consumidor (compacto):",ct)}},placeholder:"Nome do cliente...",className:"font-medium text-sm bg-black/40 text-white placeholder:text-white/50 border border-white/15 rounded px-2 py-0.5 pr-11 focus:border-white/30 focus:outline-none focus:ring-1 focus:ring-white/20 w-full",title:"Editar nome do Cliente Consumidor (histrico do agendamento)"}),Ot.nome?o.jsx("button",{type:"button",onClick:()=>{$t(Vt,""),setTimeout(()=>{me.current[Vt]?.focus()},0)},className:`absolute right-1 top-1/2 -translate-y-1/2 px-1.5 py-0.5 text-[10px] font-bold border rounded transition-all ${kt===Vt||!kt&&Z===Vt?"text-amber-300 bg-amber-500/20 border-amber-400/50 animate-pulse shadow-lg shadow-amber-500/20":"text-white/60 bg-white/10 hover:bg-white/20 hover:text-white/90 border-white/20"}`,title:kt===Vt||!kt&&Z===Vt?"Ser limpo ao pressionar Delete":"Limpar nome (tecla Delete)",children:"DEL"}):Be.current[Vt]?o.jsx("button",{type:"button",onClick:()=>Qr(Vt),className:"absolute right-1 top-1/2 -translate-y-1/2 p-1 text-emerald-400 bg-emerald-500/10 hover:bg-emerald-500/20 hover:text-emerald-300 border border-emerald-500/30 rounded transition-all",title:"Restaurar ltimo nome",children:o.jsx(t6,{className:"w-3 h-3"})}):null]}):o.jsx("span",{className:"font-medium text-sm truncate",children:Ot.nome})]}),o.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[o.jsx("button",{type:"button",className:"p-1 text-text-secondary hover:text-brand transition-colors",onClick:()=>Fr(Vt,Ot.nome),title:"Trocar",children:o.jsx(El,{className:"w-4 h-4"})}),o.jsx(oe,{type:"button",variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-400 h-6 w-6 p-0",onClick:()=>{M(ct=>[...ct,Vt])},children:""})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[o.jsxs("div",{children:[o.jsx(Wt,{className:"text-[10px] text-text-muted",children:"Mtodo"}),o.jsxs(En,{value:String(Ot.finalizadora_id||""),onValueChange:ct=>{G(Gt=>{const gr=[...Gt];if(Vt>=0&&Vt<gr.length){const J=x.find(Xe=>String(Xe.id)===String(ct)),Ye=Number(J?.taxa_percentual||0)>0;gr[Vt]={...gr[Vt],finalizadora_id:ct,aplicar_taxa:Ye?gr[Vt].aplicar_taxa??!0:!1}}return gr})},children:[o.jsx(Sn,{className:"h-8 text-xs",children:o.jsx(kn,{placeholder:"Mtodo"})}),o.jsx(Cn,{children:x.map(ct=>o.jsx(wt,{value:String(ct.id),children:ct.nome||ct.tipo||"Outros"},ct.id))})]}),(()=>{const ct=x.find(Ye=>String(Ye.id)===String(Ot.finalizadora_id)),Gt=Number(ct?.taxa_percentual||0);if(Gt<=0)return o.jsx("div",{className:"h-4 mt-1"});const gr=Ls(Ot.valor_cota),J=Number.isFinite(gr)&&gr>0;return o.jsxs("label",{className:`flex items-center gap-1.5 mt-1 text-[11px] ${J?"cursor-pointer":"cursor-not-allowed opacity-50"}`,title:J?`Taxa de ${Gt.toFixed(2)}%`:"Informe o valor primeiro",children:[o.jsx("input",{type:"checkbox",className:"w-4 h-4",checked:!!Ot.aplicar_taxa,disabled:!J,onChange:Ye=>{if(!J){l({title:"Valor necessrio",description:"Informe o valor antes de aplicar a taxa.",variant:"destructive"});return}G(Xe=>{const it=[...Xe];if(Vt>=0&&Vt<it.length){const Ze=Ye.target.checked;let dt=gr;Ze?dt=gr*(1+Gt/100):dt=gr/(1+Gt/100),it[Vt]={...it[Vt],aplicar_taxa:Ze,valor_cota:wi(dt.toFixed(2))}}return it})},style:{accentColor:"#f59e0b"}}),o.jsxs("span",{className:"text-amber-500 font-medium",children:["Taxa (",Gt.toFixed(2),"%)"]})]})})()]}),o.jsxs("div",{className:"isolate",children:[o.jsx(Wt,{className:"text-[10px] text-text-muted",children:"Valor"}),o.jsx(or,{ref:ct=>{ct&&(pe.current[Vt]=ct)},type:"text",inputMode:"decimal",placeholder:"R$ 0,00",value:wi(Ot.valor_cota),onChange:ct=>{const Gt=wi(ct.target.value),gr=Ls(Gt),J=Number.isFinite(gr)&&gr>0?"Pago":"Pendente";G(Ye=>{const Xe=[...Ye];return Vt>=0&&Vt<Xe.length&&(Xe[Vt]={...Xe[Vt],valor_cota:Gt,status_pagamento:J,aplicar_taxa:Gt===""||gr<=0?!1:Xe[Vt].aplicar_taxa}),Xe})},className:"h-8 text-xs text-text-primary placeholder:text-slate-400 bg-surface-2 border-border hover:border-border-hover focus:border-brand focus:ring-2 focus:ring-brand/20"})]})]}),o.jsx("div",{className:"flex justify-end",children:(()=>{const ct=Ot.status_pagamento==="Pago",Gt=Number.isFinite(Ls(Ot.valor_cota))&&Ls(Ot.valor_cota)>0,gr=ct&&Gt;return o.jsx("button",{type:"button",onClick:()=>Xr(Vt,Ot.status_pagamento,Ot.valor_cota),disabled:gr,className:`inline-flex items-center justify-center px-3 py-0.5 rounded text-xs font-medium border transition-all ${ct&&Gt?"bg-emerald-600/20 text-emerald-400 border-emerald-700/40 cursor-not-allowed":ct?"bg-emerald-600/20 text-emerald-400 border-emerald-700/40 hover:bg-emerald-600/30 hover:border-emerald-600/60 cursor-pointer":"bg-amber-600/20 text-amber-400 border-amber-700/40 hover:bg-amber-600/30 hover:border-amber-600/60 cursor-pointer"}`,title:gr?"No  possvel alterar (valor preenchido)":"Clique para alterar status",children:ct?"Pago":"Pendente"})})()})]}),o.jsxs("div",{className:"hidden sm:flex items-center gap-3",children:[o.jsx("div",{className:"flex-1",children:o.jsxs("div",{className:"flex items-center gap-2",children:[Ot.codigo!==null&&Ot.codigo!==void 0&&o.jsxs("span",{className:`text-sm font-bold rounded-md px-2.5 py-1 shadow-sm ${Ot.status_pagamento==="Pago"?"text-emerald-400 bg-emerald-600/20 border border-emerald-700/40":"text-amber-400 bg-amber-600/20 border border-amber-700/40"}`,children:["#",Ot.codigo]}),sn(Ot.cliente_id)?o.jsxs("div",{className:"relative",children:[o.jsx("input",{ref:ct=>{ct&&(me.current[Vt]=ct)},type:"text",value:Ot.nome||"",onChange:ct=>$t(Vt,ct.target.value),onFocus:()=>Nt(Vt),onKeyDown:ct=>{if(ct.key==="Enter"){ct.preventDefault();const Gt=qr(Vt);Gt!==null&&setTimeout(()=>{me.current[Gt]?.focus()},0)}else if(ct.key==="Delete"&&Ot.nome&&ct.target===document.activeElement)ct.preventDefault(),ct.stopPropagation(),$t(Vt,""),setTimeout(()=>{me.current[Vt]?.focus()},0);else if(ct.key==="ArrowDown"){ct.preventDefault();const Gt=qr(Vt);Gt!==null&&setTimeout(()=>{me.current[Gt]?.focus()},0)}else if(ct.key==="ArrowUp"){ct.preventDefault();const Gt=Tr(Vt);Gt!==null&&setTimeout(()=>{me.current[Gt]?.focus()},0)}},onBlur:async()=>{Nt(null),!Ot.nome&&Be.current[Vt]&&Qr(Vt);try{Qe.current&&clearTimeout(Qe.current),await wn({autoSave:!0})}catch(ct){console.error("[PaymentModal] Erro ao salvar ao sair do nome consumidor (normal):",ct)}},placeholder:"Nome do cliente...",className:"font-medium text-base bg-black/40 text-white placeholder:text-white/50 border border-white/15 rounded-md px-3 py-1.5 pr-14 focus:border-white/30 focus:outline-none focus:ring-2 focus:ring-white/20 min-w-[200px] max-w-[300px]",title:"Editar nome do Cliente Consumidor (histrico do agendamento)"}),Ot.nome?o.jsx("button",{type:"button",onClick:()=>{$t(Vt,""),setTimeout(()=>{me.current[Vt]?.focus()},0)},className:`absolute right-2 top-1/2 -translate-y-1/2 px-2 py-1 text-xs font-bold border rounded transition-all ${kt===Vt||!kt&&Z===Vt?"text-amber-300 bg-amber-500/20 border-amber-400/50 animate-pulse shadow-lg shadow-amber-500/30":"text-white/60 bg-white/10 hover:bg-white/20 hover:text-white/90 border-white/20 shadow-sm"}`,title:kt===Vt||!kt&&Z===Vt?"Ser limpo ao pressionar Delete":"Limpar nome (tecla Delete)",children:"DEL"}):Be.current[Vt]?o.jsx("button",{type:"button",onClick:()=>Qr(Vt),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1.5 text-emerald-400 bg-emerald-500/10 hover:bg-emerald-500/20 hover:text-emerald-300 border border-emerald-500/30 rounded transition-all shadow-sm",title:"Restaurar ltimo nome",children:o.jsx(t6,{className:"w-4 h-4"})}):null]}):o.jsx("span",{className:"font-medium text-base",children:Ot.nome}),o.jsx("button",{type:"button",className:"p-1 text-text-secondary hover:text-brand transition-colors",onClick:()=>Fr(Vt,Ot.nome),title:"Trocar participante",children:o.jsx(El,{className:"w-5 h-5"})})]})}),o.jsx("div",{className:"isolate",children:o.jsx(or,{ref:ct=>{ct&&(pe.current[Vt]=ct)},type:"text",inputMode:"decimal",placeholder:"R$ 0,00",value:wi(Ot.valor_cota),onChange:ct=>{const Gt=wi(ct.target.value),gr=Ls(Gt),J=Number.isFinite(gr)&&gr>0?"Pago":"Pendente";G(Ye=>{const Xe=[...Ye];return Vt>=0&&Vt<Xe.length&&(Xe[Vt]={...Xe[Vt],valor_cota:Gt,status_pagamento:J,aplicar_taxa:Gt===""||gr<=0?!1:Xe[Vt].aplicar_taxa}),Xe})},className:"w-28 text-text-primary placeholder:text-slate-400 bg-surface-2 border-border hover:border-border-hover focus:border-brand focus:ring-2 focus:ring-brand/20"})}),o.jsxs("div",{className:"flex items-center gap-2 min-w-[240px] isolate",children:[o.jsxs(En,{value:String(Ot.finalizadora_id||""),onValueChange:ct=>{G(Gt=>{const gr=[...Gt];if(Vt>=0&&Vt<gr.length){const J=x.find(Xe=>String(Xe.id)===String(ct)),Ye=Number(J?.taxa_percentual||0)>0;gr[Vt]={...gr[Vt],finalizadora_id:ct,aplicar_taxa:Ye?gr[Vt].aplicar_taxa??!0:!1}}return gr})},children:[o.jsx(Sn,{className:"w-[140px] flex-shrink-0",children:o.jsx(kn,{placeholder:"Selecione"})}),o.jsx(Cn,{children:x.map(ct=>o.jsx(wt,{value:String(ct.id),children:ct.nome||ct.tipo||"Outros"},ct.id))})]}),o.jsx("div",{className:"flex-1 min-w-0 isolate",children:(()=>{const ct=x.find(Ye=>String(Ye.id)===String(Ot.finalizadora_id)),Gt=Number(ct?.taxa_percentual||0);if(Gt<=0)return o.jsx("div",{className:"h-5"});const gr=Ls(Ot.valor_cota),J=gr>0;return o.jsxs("label",{className:`flex items-center gap-1.5 text-xs transition-colors ${J?"cursor-pointer hover:text-text-primary":"cursor-not-allowed opacity-50"}`,title:J?`Taxa de ${Gt.toFixed(2)}%`:"Informe o valor primeiro",children:[o.jsx("input",{type:"checkbox",checked:!!Ot.aplicar_taxa,disabled:!J,onChange:Ye=>{if(!J){l({title:"Valor necessrio",description:"Informe o valor antes de aplicar a taxa.",variant:"destructive"});return}G(Xe=>{const it=[...Xe];if(Vt>=0&&Vt<it.length){const Ze=Ye.target.checked;let dt=gr;Ze?dt=gr*(1+Gt/100):dt=gr/(1+Gt/100),it[Vt]={...it[Vt],aplicar_taxa:Ze,valor_cota:wi(dt.toFixed(2))}}return it})},className:`w-4 h-4 rounded border-2 border-amber-500 checked:bg-amber-500 checked:border-amber-500 focus:ring-2 focus:ring-amber-500 focus:ring-offset-1 ${J?"cursor-pointer":"cursor-not-allowed"}`,style:{accentColor:"#f59e0b"}}),o.jsxs("span",{className:"whitespace-nowrap text-amber-500 font-medium",children:["Taxa (",Gt.toFixed(2),"%)"]})]})})()})]}),(()=>{const ct=Ot.status_pagamento==="Pago",Gt=Number.isFinite(Ls(Ot.valor_cota))&&Ls(Ot.valor_cota)>0,gr=ct&&Gt;return o.jsx("button",{type:"button",onClick:()=>Xr(Vt,Ot.status_pagamento,Ot.valor_cota),disabled:gr,className:`inline-flex items-center justify-center w-[90px] px-3 py-1 rounded text-sm font-medium border transition-all ${ct&&Gt?"bg-emerald-600/20 text-emerald-400 border-emerald-700/40 cursor-not-allowed":ct?"bg-emerald-600/20 text-emerald-400 border-emerald-700/40 hover:bg-emerald-600/30 hover:border-emerald-600/60 cursor-pointer":"bg-amber-600/20 text-amber-400 border-amber-700/40 hover:bg-amber-600/30 hover:border-amber-600/60 cursor-pointer"}`,title:gr?"No  possvel alterar (valor preenchido)":"Clique para alterar status",children:ct?"Pago":"Pendente"})})(),o.jsx(oe,{type:"button",variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-400",onClick:()=>{M(ct=>[...ct,Vt])},children:"Remover"})]})]},Br)})})()})})]})]}),o.jsx(Un,{className:"gap-2",children:o.jsxs(oe,{type:"button",variant:"ghost",className:"border border-white/10",onClick:async()=>{console.log(" [Auto-save Payments] Salvando ao fechar modal...");try{Qe.current&&clearTimeout(Qe.current),await wn({autoSave:!0}),console.log(" [Auto-save Payments] Salvo ao fechar!")}catch(ut){console.error(" [Auto-save Payments] Erro ao salvar ao fechar:",ut)}f()},children:["Fechar",o.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-white/10 rounded border border-white/20",children:"Esc"})]})})]})})}),o.jsxs("div",{ref:xa,style:{position:"fixed",left:"0",top:"0",width:"900px",minHeight:"auto",padding:"30px",backgroundColor:"#ffffff !important",color:"#000000 !important",fontFamily:"Arial, sans-serif",opacity:"0",visibility:"hidden",zIndex:"-9999",pointerEvents:"none",overflow:"hidden"},children:[o.jsxs("div",{style:{marginBottom:"8px",paddingBottom:"6px",borderBottom:"2px solid #000",backgroundColor:"#fff",color:"#000"},children:[o.jsx("h1",{style:{fontSize:"18px",fontWeight:"bold",margin:"0 0 6px 0",color:"#000",letterSpacing:"0.5px",textAlign:"center"},children:"RELATRIO DE PAGAMENTOS"}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"10px",color:"#000",fontWeight:"600"},children:[o.jsxs("div",{style:{display:"flex",gap:"20px",flex:1},children:[o.jsxs("div",{children:[o.jsx("span",{style:{fontWeight:"700"},children:"Data:"}),o.jsx("span",{style:{marginLeft:"4px"},children:m?.start?new Date(m.start).toLocaleDateString("pt-BR"):"-"})]}),o.jsxs("div",{children:[o.jsx("span",{style:{fontWeight:"700"},children:"Quadra:"}),o.jsx("span",{style:{marginLeft:"4px"},children:m?.court||"-"})]}),o.jsxs("div",{children:[o.jsx("span",{style:{fontWeight:"700"},children:"Cdigo:"}),o.jsx("span",{style:{marginLeft:"4px"},children:m?.code?`#${m.code}`:"-"})]})]}),o.jsxs("div",{style:{display:"flex",gap:"30px",textAlign:"right"},children:[o.jsxs("div",{children:[o.jsx("span",{style:{fontWeight:"700"},children:"Total:"}),o.jsxs("strong",{style:{marginLeft:"4px",color:"#000",fontSize:"11px",display:"inline"},children:["R$ ",wi(h||0)]})]}),o.jsxs("div",{children:[o.jsx("span",{style:{fontWeight:"700"},children:"Diferena:"}),o.jsxs("strong",{style:{marginLeft:"4px",color:Gr.diff<0?"#dc2626":"#16a34a",fontSize:"11px",display:"inline"},children:[Gr.diff<0?"-":"","R$ ",wi(Math.abs(Gr.diff).toFixed(2))]})]})]})]})]}),o.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"8px",fontSize:"10px",backgroundColor:"#fff",fontFamily:"Arial, sans-serif",border:"1px solid #000",tableLayout:"fixed"},children:[o.jsx("thead",{children:o.jsxs("tr",{style:{backgroundColor:"#cccccc",borderBottom:"1px solid #000"},children:[o.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"5%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"N"}),o.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"35%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Nome"}),o.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"10%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Cdigo"}),o.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"15%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Valor"}),o.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"20%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Forma"}),o.jsx("th",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:"#000",width:"15%",backgroundColor:"#cccccc",fontSize:"9px",border:"1px solid #000",wordWrap:"break-word"},children:"Status"})]})}),o.jsx("tbody",{children:(()=>(re||[]).filter((Ht,dr)=>!(k||[]).includes(dr)).map((Ht,dr)=>{const Ft=x?.find(gr=>String(gr.id)===String(Ht.finalizadora_id)),Ot=Ht.status_pagamento==="Pago",Vt=a?.find(gr=>gr.id===Ht.cliente_id)?.is_consumidor_final,ct=(Ht.nome||"Sem nome").trim().split(/\s+/).slice(0,2).join(" "),Gt=Vt?"0":Ht.codigo||"N/A";return o.jsxs("tr",{"data-participant-index":dr,style:{backgroundColor:"#fff"},children:[o.jsx("td",{style:{padding:"4px 2px",textAlign:"center",color:"#000",backgroundColor:"#fff",fontSize:"10px",fontWeight:"600",border:"1px solid #000",wordWrap:"break-word"},children:dr+1}),o.jsx("td",{style:{padding:"4px 2px",textAlign:"left",color:"#000",backgroundColor:"#fff",fontSize:"10px",fontWeight:"600",border:"1px solid #000",wordWrap:"break-word",overflow:"hidden"},children:ct}),o.jsx("td",{style:{padding:"4px 2px",textAlign:"center",color:"#000",fontSize:"10px",fontWeight:"600",backgroundColor:"#fff",border:"1px solid #000",wordWrap:"break-word"},children:Gt}),o.jsxs("td",{style:{padding:"4px 2px",textAlign:"center",color:"#000",backgroundColor:"#fff",fontSize:"10px",fontWeight:"600",border:"1px solid #000",wordWrap:"break-word"},children:["R$ ",wi(Ht.valor_cota||0)]}),o.jsx("td",{style:{padding:"4px 2px",textAlign:"center",color:"#000",fontSize:"10px",fontWeight:"600",backgroundColor:"#fff",border:"1px solid #000",wordWrap:"break-word"},children:Ft?.nome||"N/D"}),o.jsx("td",{style:{padding:"4px 2px",textAlign:"center",fontWeight:"900",color:Ot?"#16a34a":"#ca8a04",fontSize:"10px",backgroundColor:"#fff",border:"1px solid #000",wordWrap:"break-word"},children:Ot?" Pago":" Pendente"})]},`participant-${dr}-${Ht.cliente_id}`)}))()})]}),o.jsx("div",{style:{height:"2px",backgroundColor:"#fff"}}),o.jsxs("div",{style:{marginTop:"2px",textAlign:"center",fontSize:"10px",color:"#000",borderTop:"1px solid #000",paddingTop:"2px",display:"flex",justifyContent:"space-between",backgroundColor:"#fff"},children:[o.jsxs("div",{style:{color:"#000",fontWeight:"500"},children:["Gerado em: ",new Date().toLocaleString("pt-BR")]}),o.jsx("div",{id:"page-indicator",style:{fontSize:"10px",fontWeight:"bold",color:"#000"}})]})]}),o.jsx(ln,{open:z,onOpenChange:ut=>{ut||(de([]),U("")),$(ut)},children:o.jsxs(on,{className:"sm:max-w-[500px]",onInteractOutside:ut=>{ut.preventDefault(),w(2e3),$(!1)},children:[o.jsxs(nn,{children:[o.jsx(rn,{children:"Adicionar Participante"}),o.jsx(_n,{children:"Selecione um cliente para adicionar aos pagamentos."})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(pi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(or,{ref:Se,placeholder:"Buscar por cdigo ou nome...",value:B,onChange:ut=>{U(ut.target.value),q(0)},onKeyDown:ut=>{const Ht=B.toLowerCase().trim(),dr=(a||[]).filter(Cr=>{if(!Ht)return!0;const ct=String(Cr.codigo||""),Gt=(Cr.nome||"").toLowerCase();return ct.includes(Ht)||Gt.includes(Ht)}),Ft=dr.find(Cr=>Cr?.is_consumidor_final===!0),Br=dr.filter(Cr=>Cr?.is_consumidor_final!==!0).sort((Cr,ct)=>{const Gt=Cr.codigo||0,gr=ct.codigo||0;return Gt-gr}),Vt=Ft?[Ft,...Br]:Br;if(ut.key==="ArrowDown")ut.preventDefault(),q(Cr=>Math.min(Cr+1,Vt.length-1));else if(ut.key==="ArrowUp")ut.preventDefault(),q(Cr=>Math.max(Cr-1,0));else if(ut.key==="Enter"&&Vt[xe]){ut.preventDefault();const ct={...Vt[xe],timestamp:Date.now()};de(Gt=>[...Gt,ct])}},className:"pl-10 pr-10"}),B&&o.jsx("button",{type:"button",onClick:()=>U(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-muted hover:text-text",children:o.jsx(Ml,{className:"h-4 w-4"})})]}),o.jsx(oe,{type:"button",size:"sm",className:"bg-amber-500 hover:bg-amber-400 text-black shadow-md",onClick:()=>{i&&(w(15e3),i(()=>{$(!0)}),$(!1),U(""))},children:"+Novo"})]}),o.jsx("div",{ref:Ue,className:"border rounded-md max-h-[400px] overflow-y-auto",children:(()=>{const ut=B.toLowerCase().trim(),Ht=(a||[]).filter(Vt=>{if(!ut)return!0;const Cr=String(Vt.codigo||""),ct=(Vt.nome||"").toLowerCase();return Cr.includes(ut)||ct.includes(ut)}),dr=Ht.find(Vt=>Vt?.is_consumidor_final===!0),Ot=Ht.filter(Vt=>Vt?.is_consumidor_final!==!0).sort((Vt,Cr)=>{const ct=Vt.codigo||0,Gt=Cr.codigo||0;return ct-Gt}),Br=dr?[dr,...Ot]:Ot;return Br.length===0?o.jsx("div",{className:"p-8 text-center text-text-muted",children:"Nenhum cliente encontrado."}):Br.map((Vt,Cr)=>{const ct=Vt?.is_consumidor_final===!0,Gt=Y.filter(J=>J.id===Vt.id).length,gr=Cr===xe;return o.jsxs("div",{ref:J=>{Ne.current[Cr]=J},role:"button",tabIndex:0,className:`w-full px-4 py-3 text-left transition-all border-b border-border last:border-0 flex items-center gap-3 cursor-pointer ${gr?"ring-2 ring-blue-500 ring-inset z-10":""} ${ct?"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-2 border-l-amber-500/40":Gt>0?"bg-emerald-600/20 hover:bg-emerald-600/30":"hover:bg-surface-2"}`,onMouseEnter:()=>q(Cr),onClick:J=>{J.preventDefault(),J.stopPropagation();const Ye={...Vt,timestamp:Date.now()};de(Xe=>[...Xe,Ye])},onKeyDown:J=>{if(J.key==="Enter"||J.key===" "){J.preventDefault();const Ye={...Vt,timestamp:Date.now()};de(Xe=>[...Xe,Ye])}},children:[o.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[(()=>Vt.codigo!==null&&Vt.codigo!==void 0?o.jsxs("span",{className:`inline-flex items-center justify-center w-10 h-10 rounded-full font-bold text-sm transition-colors ${ct?"bg-amber-500/15 text-amber-300/90 ring-1 ring-amber-500/20":"bg-emerald-600/20 text-emerald-400"}`,children:["#",Vt.codigo]}):null)(),o.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[o.jsx("span",{className:`font-medium ${ct?"text-amber-100/90":""}`,children:Vt.nome}),ct&&o.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium",children:[o.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]})]})]}),Gt>0&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-7 h-7 rounded-full bg-rose-600 hover:bg-rose-500 text-white text-base font-bold transition-colors",onClick:J=>{J.preventDefault(),J.stopPropagation(),de(Ye=>{const Xe=Ye.findIndex(it=>it.id===Vt.id);if(Xe!==-1){const it=[...Ye];return it.splice(Xe,1),it}return Ye})},children:"-"}),o.jsx("span",{className:"inline-flex items-center justify-center min-w-[32px] h-7 px-2 rounded-full bg-sky-600 text-white text-base font-bold",children:Gt}),o.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-7 h-7 rounded-full bg-emerald-600 hover:bg-emerald-500 text-white text-base font-bold transition-colors",onClick:J=>{J.preventDefault(),J.stopPropagation();const Ye={...Vt,timestamp:Date.now()};de(Xe=>[...Xe,Ye])},children:"+"})]})]},Vt.id)})})()})]}),o.jsxs(Un,{className:"flex items-center justify-between",children:[o.jsx("div",{className:"text-sm text-text-muted",children:Y.length>0&&o.jsxs("span",{className:"font-medium",children:[Y.length," ",Y.length===1?"participante selecionado":"participantes selecionados"]})}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(oe,{type:"button",variant:"ghost",className:"border border-border",onClick:ut=>{ut.preventDefault(),ut.stopPropagation(),w(1e3),$(!1),U(""),de([])},children:["Cancelar",o.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-white/10 rounded border border-white/20",children:"Esc"})]}),o.jsxs(oe,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white",disabled:Y.length===0,onClick:ut=>{console.log("[AddParticipant] Boto Salvar clicado"),ut.preventDefault(),ut.stopPropagation(),console.log("[AddParticipant] Protegendo modal de pagamentos (3000ms)"),w(3e3),console.log("[AddParticipant] Adicionando participantes:",Y.length);const Ht=Y.map(dr=>({cliente_id:dr.id,nome:dr.nome,codigo:dr.codigo,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:(()=>{const Ft=sr();return Ft?.id?String(Ft.id):null})(),aplicar_taxa:(()=>{const Ft=sr();return Number(Ft?.taxa_percentual||0)>0})()}));G(dr=>{const Ft=dr.length,Ot=Ht.map((Br,Vt)=>Ft+Vt);return Q(Ot),setTimeout(()=>{Q([])},1e3),[...dr,...Ht]}),console.log("[AddParticipant] Fechando modal de adicionar participante"),$(!1),U(""),de([]),console.log("[AddParticipant] Concludo")},children:["Confirmar (",Y.length,")",o.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-emerald-700/50 rounded border border-emerald-500/30",children:""})]})]})]})]})}),o.jsx(ln,{open:De,onOpenChange:ut=>{console.log(" [DownloadModal] onOpenChange chamado:",{open:ut,downloadStatus:ft}),!ut&&ft==="success"?(console.log(" [DownloadModal] Fechando modal de download (sucesso)"),st(!1)):ut||console.log(" [DownloadModal] BLOQUEADO: Ainda baixando")},children:o.jsxs(on,{className:"sm:max-w-md",onPointerDownOutside:ut=>{ft==="downloading"&&ut.preventDefault()},onEscapeKeyDown:ut=>{ft==="downloading"&&ut.preventDefault()},children:[o.jsxs(nn,{children:[o.jsx(rn,{className:"text-center",children:ft==="downloading"?"Gerando PDF...":"PDF Gerado com Sucesso!"}),o.jsx(_n,{className:"sr-only",children:ft==="downloading"?"Aguarde enquanto o relatrio de pagamentos est sendo gerado":"Relatrio de pagamentos gerado e baixado com sucesso"})]}),o.jsx("div",{className:"flex flex-col items-center justify-center py-6 space-y-4",children:ft==="downloading"?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-green-500"}),o.jsx("p",{className:"text-sm text-gray-500",children:"Gerando seu relatrio..."}),o.jsxs("div",{className:"w-full max-w-xs",children:[o.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[o.jsx("span",{children:"Progresso"}),o.jsxs("span",{children:[Nr,"%"]})]}),o.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:o.jsx("div",{className:"bg-green-600 h-2.5 rounded-full transition-all duration-300",style:{width:`${Nr}%`}})})]})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"rounded-full bg-green-100 p-3",children:o.jsx("svg",{className:"w-12 h-12 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),o.jsx("p",{className:"text-sm text-gray-600 text-center",children:"Relatrio baixado com sucesso!"}),o.jsx("p",{className:"text-xs text-gray-400 text-center",children:tr})]})}),ft==="success"&&o.jsxs("div",{className:"flex flex-col gap-2",children:[navigator.share&&navigator.canShare&&navigator.canShare({files:[]})&&o.jsxs(oe,{onClick:async()=>{if(!rt){l({title:"Arquivo no disponvel",description:"Tente gerar o PDF novamente.",variant:"destructive"});return}try{console.log(" [PDF] Compartilhando via Web Share API...");const ut=new File([rt],tr,{type:"application/pdf"});await navigator.share({files:[ut],title:"Relatrio de Pagamentos",text:"Confira o relatrio de pagamentos"}),console.log(" [PDF] Compartilhado com sucesso"),l({title:"Compartilhado com sucesso!",variant:"success"})}catch(ut){if(ut.name==="AbortError"){console.log(" [PDF] Compartilhamento cancelado");return}console.error(" [PDF] Erro ao compartilhar:",ut),l({title:"Erro ao compartilhar",description:ut.message,variant:"destructive"})}},className:"w-full bg-blue-600 hover:bg-blue-700 text-white",children:[o.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),"Compartilhar"]}),o.jsxs(oe,{onClick:()=>{je?(console.log(" [PDF] Abrindo PDF em nova aba:",je),window.open(je,"_blank")):(console.error(" [PDF] URL do blob no disponvel"),l({title:"Erro ao abrir PDF",description:"URL do PDF no est disponvel.",variant:"destructive"}))},className:"w-full bg-green-600 hover:bg-green-700",children:[o.jsxs("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Abrir PDF"]}),o.jsx("p",{className:"text-xs text-center text-gray-500 px-2",children:"O PDF foi baixado. Abra-o para visualizar, imprimir ou compartilhar."}),o.jsx(oe,{onClick:()=>st(!1),variant:"ghost",className:"w-full",children:"Fechar"})]})]})}),o.jsx(ln,{open:lt.isOpen,onOpenChange:ut=>{if(!ut&&nt.current){console.log(" [StatusConfirmation] Bloqueado onOpenChange (protegido)");return}ut||(console.log(" [StatusConfirmation] Fechando modal via onOpenChange"),rr({isOpen:!1,participantIndex:null,currentStatus:null}))},children:o.jsxs(on,{className:"w-[95vw] sm:max-w-[400px]",onInteractOutside:ut=>{nt.current&&(console.log(" [StatusConfirmation] Bloqueado clique fora"),ut.preventDefault())},onEscapeKeyDown:ut=>{nt.current&&(console.log(" [StatusConfirmation] Bloqueado ESC"),ut.preventDefault())},children:[o.jsxs(nn,{children:[o.jsx(rn,{children:"Alterar Status de Pagamento"}),o.jsx(_n,{children:lt.currentStatus==="Pago"?o.jsxs(o.Fragment,{children:["Tem certeza que deseja marcar este participante como ",o.jsx("strong",{children:"Pendente"}),"?"]}):o.jsxs(o.Fragment,{children:["Tem certeza que deseja marcar este participante como ",o.jsx("strong",{children:"Pago"})," mesmo sem valor registrado?"]})})]}),o.jsx("div",{className:"space-y-4",children:o.jsx("div",{className:"p-3 rounded-lg bg-amber-500/10 border border-amber-500/30",children:o.jsx("p",{className:"text-sm text-amber-400",children:lt.currentStatus==="Pago"?o.jsx(o.Fragment,{children:" Esta ao marcar o participante como pendente novamente para refazer o pagamento."}):o.jsx(o.Fragment,{children:" Esta ao marcar o participante como pago sem um valor especfico."})})})}),o.jsxs(Un,{className:"gap-2",children:[o.jsx(oe,{type:"button",variant:"ghost",className:"border border-white/10",onClick:()=>{rr({isOpen:!1,participantIndex:null,currentStatus:null})},children:"Cancelar"}),o.jsx(oe,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white",onClick:()=>In(lt.currentStatus==="Pago"?"Pendente":"Pago"),children:"Confirmar"})]})]})})]})}function cQe({form:e,setForm:t,localCustomers:r}){oo(),Do();const{isEditParticipantModalOpen:n,closeEditParticipantModal:a,editParticipantData:i,participantsForm:s,setParticipantsForm:l,payMethods:c,protectPaymentModal:d,onParticipantReplacedRef:u}=jN(),[f,m]=p.useState(""),[h,v]=p.useState(!1),[g,y]=p.useState(0),x=ye.useRef(null),b=ye.useRef([]),w=ye.useRef(null),j=S=>{const I=i.participantId;if(s[I]?.cliente_id===S.id)return;console.log(" [EditParticipantModal] Substituindo participante:",{de:i.participantName,para:S.nome,indice:I,id_para:S.id});const T=s[I];if(l.updateLocal&&l.getLocal){const D=l.getLocal();if(I>=0&&I<D.length){const B={cliente_id:S.id,nome:S.nome,codigo:S.codigo,valor_cota:T?.valor_cota||"",status_pagamento:T?.status_pagamento||"Pendente",finalizadora_id:T?.finalizadora_id||(c[0]?.id?String(c[0].id):null),aplicar_taxa:T?.aplicar_taxa||!1},U=[...D];U[I]=B,l.updateLocal(U)}}else l(D=>{if(I<0||I>=D.length)return D;const B={cliente_id:S.id,nome:S.nome,codigo:S.codigo,valor_cota:T?.valor_cota||"",status_pagamento:T?.status_pagamento||"Pendente",finalizadora_id:T?.finalizadora_id||(c[0]?.id?String(c[0].id):null),aplicar_taxa:T?.aplicar_taxa||!1},U=[...D];return U[I]=B,U});d(3e3),a(),m(""),u?.current&&u.current(I)};if(p.useEffect(()=>{n&&(m(""),v(!1),y(0))},[n]),p.useEffect(()=>{n&&b.current[g]&&b.current[g]?.scrollIntoView({behavior:"smooth",block:"nearest"})},[g,n]),!n)return null;const _=f.trim().toLowerCase(),C=(r||[]).filter(S=>_?String(S?.nome||"").toLowerCase().includes(_):!0),E=C.find(S=>S?.is_consumidor_final===!0),k=C.filter(S=>S?.is_consumidor_final!==!0).sort((S,I)=>{const T=Number(S?.codigo),D=Number(I?.codigo);return Number.isFinite(T)&&Number.isFinite(D)?T-D:String(S?.nome||"").localeCompare(String(I?.nome||""))}),M=E?[E,...k]:k;return o.jsx(ln,{open:n,onOpenChange:S=>{console.log("[EditParticipantModal] onOpenChange:",S),S||(console.log("[EditParticipantModal] Protegendo modal de pagamentos"),d(2e3),a(),m(""))},modal:!0,children:o.jsxs(on,{className:"sm:max-w-[500px]",onPointerDownOutside:S=>{console.log(" [EditParticipantModal] onPointerDownOutside - prevenindo"),S.preventDefault(),S.stopPropagation()},onInteractOutside:S=>{console.log(" [EditParticipantModal] onInteractOutside - prevenindo"),S.preventDefault(),S.stopPropagation(),d(2e3)},children:[o.jsxs(nn,{children:[o.jsx(rn,{children:"Trocar Participante"}),o.jsxs(_n,{children:["Substituindo: ",o.jsx("strong",{children:i.participantName})]})]}),o.jsxs("div",{className:"space-y-4 py-4",children:[o.jsxs("div",{children:[o.jsx(Wt,{htmlFor:"edit-participant-search",children:"Buscar cliente"}),o.jsx(or,{ref:x,id:"edit-participant-search",type:"text",placeholder:"Digite o nome do cliente...",value:f,onChange:S=>{m(S.target.value),y(0)},onKeyDown:S=>{if(S.key==="ArrowDown")S.preventDefault(),y(I=>Math.min(I+1,M.length-1));else if(S.key==="ArrowUp")S.preventDefault(),y(I=>Math.max(I-1,0));else if(S.key==="Enter"&&M[g]){S.preventDefault();const I=M[g],T=i.participantId;s[T]?.cliente_id===I.id||(d(2e3),j(I))}},className:"mt-1",autoFocus:!0})]}),o.jsx("div",{ref:w,className:"border border-border rounded-md max-h-[300px] overflow-y-auto",children:h?o.jsx("div",{className:"p-4 text-center text-sm text-text-muted",children:"Carregando clientes..."}):M.length===0?o.jsx("div",{className:"p-4 text-center text-sm text-text-muted",children:_?"Nenhum cliente encontrado":"Nenhum cliente cadastrado"}):M.map((S,I)=>{const T=i.participantId,D=s[T]?.cliente_id===S.id,B=S?.is_consumidor_final===!0,U=I===g;return o.jsxs("button",{ref:z=>{b.current[I]=z},type:"button",className:Yt(U&&"ring-2 ring-blue-500 ring-inset z-10","w-full px-4 py-3 text-left transition-all","border-b border-border last:border-b-0","flex items-center gap-3",D&&"bg-brand/10 cursor-not-allowed opacity-60",!D&&B&&"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-2 border-l-amber-500/40",!D&&!B&&"hover:bg-surface-2"),disabled:D,onMouseEnter:()=>y(I),onClick:z=>{z.preventDefault(),z.stopPropagation(),console.log("[EditParticipantModal] Cliente selecionado - protegendo modal"),d(2e3),j(S)},children:[o.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[S.codigo!==null&&S.codigo!==void 0&&o.jsxs("span",{className:Yt("inline-flex items-center justify-center w-10 h-10 rounded-full font-bold text-sm transition-colors",B&&"bg-amber-500/15 text-amber-300/90 ring-1 ring-amber-500/20",!B&&"bg-emerald-600/20 text-emerald-400"),children:["#",S.codigo]}),o.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[o.jsx("span",{className:Yt("font-medium",B&&"text-amber-100/90"),children:S.nome}),B&&o.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium",children:[o.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]})]})]}),D&&o.jsx("span",{className:"text-xs text-brand font-medium",children:"Atual"})]},S.id)})})]}),o.jsx(Un,{children:o.jsx(oe,{type:"button",variant:"ghost",className:"border border-white/10",onClick:S=>{console.log(" [EditParticipantModal] ========== BOTO CANCELAR CLICADO =========="),console.log(" [EditParticipantModal] preventDefault()"),S.preventDefault(),console.log(" [EditParticipantModal] stopPropagation()"),S.stopPropagation(),console.log(" [EditParticipantModal] Protegendo modal de pagamentos (2000ms)"),d(2e3),console.log(" [EditParticipantModal] Fechando modal de editar participante"),a(),console.log(" [EditParticipantModal] Limpando busca"),m(""),console.log(" [EditParticipantModal] ========== CANCELAR CONCLUDO ==========")},children:"Cancelar"})})]})})}const dQe=e=>e?e.trim().split(/\s+/).slice(0,2).join(" "):"",om=56,aE=30,uQe=6,fQe=24;function mQe({weekStart:e,weekBookings:t,activeCourtFilter:r,courtsMap:n,participantsByAgendamento:a,onBookingClick:i,onSlotClick:s,statusConfig:l,dayStartHour:c=uQe,dayEndHourExclusive:d=fQe,weekDiasFuncionamento:u={},sidebarVisible:f=!1}){const m=p.useRef(null),h=p.useRef(null),[v,g]=ye.useState(0),[y,x]=ye.useState(window.innerWidth<768);ye.useEffect(()=>{const P=()=>{x(window.innerWidth<768)};return window.addEventListener("resize",P),()=>window.removeEventListener("resize",P)},[]);const b=p.useMemo(()=>Array.from({length:7},(P,k)=>Ia(e,k)),[e]);p.useEffect(()=>{const P=()=>{h.current&&m.current&&(m.current.scrollLeft=h.current.scrollLeft)},k=()=>{m.current&&h.current&&(h.current.scrollLeft=m.current.scrollLeft)},M=()=>{if(h.current){const T=h.current.scrollHeight>h.current.clientHeight;g(T?17:0)}},S=h.current,I=m.current;return S&&S.addEventListener("scroll",P),I&&I.addEventListener("scroll",k),M(),window.addEventListener("resize",M),()=>{S&&S.removeEventListener("scroll",P),I&&I.removeEventListener("scroll",k),window.removeEventListener("resize",M)}},[]);const w=p.useMemo(()=>{if(r&&n[r]){const P=n[r],k=P.hora_inicio||`${c}:00:00`,M=P.hora_fim||`${d}:00:00`,[S]=String(k).split(":").map(Number),[I,T]=String(M).split(":").map(Number);let D=I===0&&T===0?24:I;return T>0&&D<24&&(D+=1),{start:S||c,end:D||d}}return{start:c,end:d}},[r,n,c,d]),j=p.useMemo(()=>Array.from({length:Math.max(0,w.end-w.start)},(P,k)=>w.start+k),[w]),_=p.useMemo(()=>Math.max(0,w.end-w.start)*(60/aE)*om,[w]),C=p.useMemo(()=>{const P={};return b.forEach(k=>{P[Jt(k,"yyyy-MM-dd")]=[]}),t.forEach(k=>{const M=Jt(ni(k.start),"yyyy-MM-dd");P[M]&&P[M].push(k)}),P},[b,t]),E=(P,k)=>{const M=P.start.getHours()*60+P.start.getMinutes(),I=P.end.getHours()*60+P.end.getMinutes()-M,T=w.start*60,D=(M-T)/aE*om,B=I/aE*om,z=l[P.status]||{hex:"#888",text:"text-gray-400",label:"Unknown",icon:null},$=z.icon,Y=40,de=Math.max(Y,B-4),xe=Math.min(1.3,de/55),q=Math.max(11,Math.round(13*xe)),L=Math.max(10,Math.round(11*xe)),W=Math.max(9,Math.round(10*xe)),ne=Math.max(14,Math.round(16*xe)),le=k?.[P.id]||[],K=le.filter(G=>String(G.status_pagamento||"").toLowerCase()==="pago").length,Q=le.length,re=I===30;return o.jsx("div",{id:`booking-${P.id}`,className:"absolute left-0.5 right-0.5 rounded-md border-2 bg-surface cursor-pointer transition-all hover:bg-surface-2 hover:shadow-md overflow-hidden",style:{top:`${D}px`,height:`${Math.max(Y,B)}px`,borderColor:z.hex||"#888",borderLeftWidth:"3px",zIndex:5},onClick:()=>i(P),children:o.jsxs("div",{className:"h-full flex flex-col justify-center px-2 py-1",children:[o.jsx("div",{className:"flex items-center gap-1.5 mb-0.5",children:o.jsx("p",{className:"font-semibold truncate",style:{fontSize:`${q}px`,lineHeight:1.1,color:"#e2e8f0"},children:dQe(P.customer)})}),re&&(P.modality||Q>0)&&o.jsxs("div",{className:"flex items-center gap-1 w-full justify-between",style:{lineHeight:1},children:[P.modality&&o.jsx("span",{className:"text-xs font-bold text-white bg-gradient-to-r from-slate-700 to-slate-800 border border-slate-600/60 rounded px-1.5 py-0.5 whitespace-nowrap shadow-sm flex-shrink-0",style:{fontSize:Math.max(7,W-1)},children:P.modality}),Q>0&&o.jsxs("span",{className:`text-xs font-semibold rounded-full px-1.5 py-0.5 border flex items-center gap-0.5 whitespace-nowrap flex-shrink-0 ${K===Q?"text-emerald-300 bg-emerald-500/10 border-emerald-400/30":"text-amber-300 bg-amber-500/10 border-amber-400/30"}`,style:{fontSize:Math.max(8,W-1)},children:[o.jsx(Ui,{style:{width:Math.max(10,W-1),height:Math.max(10,W-1)}}),o.jsxs("span",{children:[K,"/",Q]})]})]}),re&&o.jsxs("div",{className:"flex items-center gap-1.5 justify-between",children:[o.jsxs("span",{className:"font-semibold whitespace-nowrap",style:{fontSize:`${L}px`,color:"#999",lineHeight:1},children:[Jt(P.start,"HH:mm"),"",Jt(P.end,"HH:mm")]}),$&&o.jsxs("div",{className:"flex items-center gap-0.5",children:[!f&&!y&&o.jsx($,{style:{width:Math.max(12,ne-2),height:Math.max(12,ne-2),color:z.hex}}),o.jsx("span",{className:"truncate font-semibold",style:{fontSize:`${L}px`,color:z.hex,lineHeight:1},children:z.label})]})]}),!re&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"truncate",style:{fontSize:`${L}px`,color:"#999",lineHeight:1,marginBottom:"2px"},children:[Jt(P.start,"HH:mm"),"",Jt(P.end,"HH:mm")]}),P.modality&&o.jsx("span",{className:"text-xs font-bold text-white truncate bg-gradient-to-r from-slate-700 to-slate-800 border border-slate-600/60 rounded px-1.5 py-0.5 whitespace-nowrap shadow-sm mb-0.5",style:{fontSize:Math.max(7,W-1),display:"inline-block",width:"fit-content"},children:P.modality}),o.jsxs("div",{className:"flex items-center gap-1 w-full justify-between",children:[$&&o.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[!f&&!y&&o.jsx($,{style:{width:ne,height:ne,color:z.hex}}),o.jsx("span",{className:"truncate font-semibold",style:{fontSize:`${W}px`,color:z.hex,lineHeight:1},children:P.status==="in_progress"?"Andamento":z.label})]}),Q>0&&o.jsxs("span",{className:`text-xs font-semibold rounded-full px-1.5 py-0.5 border flex items-center gap-0.5 whitespace-nowrap flex-shrink-0 ${K===Q?"text-emerald-300 bg-emerald-500/10 border-emerald-400/30":"text-amber-300 bg-amber-500/10 border-amber-400/30"}`,style:{fontSize:Math.max(8,W-1)},children:[o.jsx(Ui,{style:{width:Math.max(12,W),height:Math.max(12,W)}}),o.jsxs("span",{children:[K,"/",Q]})]})]})]})]})},P.id)};return o.jsxs("div",{className:"flex-1 bg-surface rounded-lg border border-border flex flex-col overflow-hidden",children:[o.jsxs("div",{className:"flex sticky top-0 z-20 bg-surface border-b border-border",children:[o.jsx("div",{className:"w-20 flex-shrink-0 flex items-center justify-center font-semibold text-sm border-r border-border bg-surface",children:"Horrios"}),o.jsxs("div",{ref:m,"data-header-scroll":!0,className:"flex flex-1 overflow-auto",style:{scrollbarWidth:"none",msOverflowStyle:"none",paddingRight:`${v}px`,minWidth:0},children:[o.jsx("style",{children:`
            [data-header-scroll]::-webkit-scrollbar {
              display: none;
            }
          `}),b.map(P=>o.jsxs("div",{className:"flex-1 basis-[140px] min-w-[140px] flex flex-col items-center justify-center py-3 border-r border-border bg-surface-2/50 text-center",children:[o.jsx("div",{className:"text-xs font-semibold text-text-muted",children:Jt(P,"EEE",{locale:ia}).toUpperCase()}),o.jsx("div",{className:"text-sm font-bold text-text-primary",children:Jt(P,"dd")})]},Jt(P,"yyyy-MM-dd")))]})]}),o.jsxs("div",{ref:h,className:"flex flex-1 overflow-auto",style:{minWidth:0},children:[o.jsxs("div",{className:"w-20 flex-shrink-0 bg-surface sticky left-0 z-10 flex flex-col relative",style:{borderRight:"1px solid var(--color-border)",minHeight:`${_}px`},children:[j.map(P=>o.jsxs(ye.Fragment,{children:[o.jsx("div",{className:Yt("relative border-b border-border/60",P%2===1&&"bg-surface-2/30"),style:{height:om},children:o.jsxs("span",{className:"absolute left-1/2 -translate-x-1/2 top-1/2 -translate-y-1/2 bg-surface rounded px-1 text-sm font-bold whitespace-nowrap",children:[String(P).padStart(2,"0"),":00"]})}),o.jsx("div",{className:Yt("relative border-b border-border/60",P%2===1&&"bg-surface-2/30"),style:{height:om},children:o.jsxs("span",{className:"absolute left-1/2 -translate-x-1/2 top-1/2 -translate-y-1/2 bg-surface rounded px-1 text-sm font-bold whitespace-nowrap",children:[String(P).padStart(2,"0"),":30"]})})]},`time-${P}`)),o.jsx("div",{className:"absolute right-0 top-0 w-px bg-border pointer-events-none",style:{height:`${_}px`}})]}),b.map(P=>{const k=Jt(P,"yyyy-MM-dd"),M=C[k]||[],S=u[k]||{},I=r&&S[r]&&!S[r].funciona;return o.jsxs("div",{className:"flex-1 basis-[140px] min-w-[140px] relative border-r border-border bg-surface-2/10",style:{minHeight:`${_}px`},children:[j.map(T=>o.jsx("div",{className:Yt("border-b border-border/60",T%2===1&&"bg-surface-2/5"),style:{height:om*2},children:I?o.jsx("div",{className:"w-full h-full cursor-not-allowed bg-surface/60 flex items-center justify-center border-b border-border/60 transition-colors",onClick:D=>D.preventDefault(),children:o.jsxs("div",{className:"text-center pointer-events-none",children:[o.jsx(QW,{className:"h-5 w-5 text-text-primary mx-auto mb-1"}),o.jsx("div",{className:"text-xs font-medium text-text-primary mb-1",children:"Fechada"}),S[r]?.observacao&&o.jsx("div",{className:"text-xs text-text-muted",children:S[r].observacao})]})}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"relative border-b border-border/60 transition-colors flex items-center justify-center cursor-pointer hover:bg-white/5",style:{height:om},onClick:()=>{const D=new Date(P.getTime());D.setHours(T,0,0,0),console.log("Slot :00 clicked",{day:P,hour:T,slotDate:D,activeCourtFilter:r}),s?.(D,r)}}),o.jsx("div",{className:"relative border-b border-border/60 transition-colors flex items-center justify-center cursor-pointer hover:bg-white/5",style:{height:om},onClick:()=>{const D=new Date(P.getTime());D.setHours(T,30,0,0),console.log("Slot :30 clicked",{day:P,hour:T,slotDate:D,activeCourtFilter:r}),s?.(D,r)}})]})},`${k}-${T}`)),M.map(T=>E(T,a))]},k)})]})]})}const ja=30,Gg=e=>{const t=String(e??"").replace(/\D/g,"");if(!t)return"";const r=(Number(t)/100).toFixed(2),[n,a]=r.split(".");return`${n.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${a}`},rf=e=>{if(e==null||e==="")return NaN;const t=String(e).replace(/\./g,"").replace(",","."),r=parseFloat(t);return Number.isFinite(r)?r:NaN};function u9(e){const t=String(e||"").trim().split(/\s+/).filter(Boolean);return t.length===0?"":t.length===1?t[0]:`${t[0]} ${t[1]}`}const xs=56,hQe=6,m4=6,Nne=24;Array.from({length:(Nne-m4)*(60/ja)},(e,t)=>{const r=m4*60+t*ja,n=Math.floor(r/60),a=r%60;return{time:`${String(n).padStart(2,"0")}:${String(a).padStart(2,"0")}`,isHourMark:a===0}});const zh=["Futebol","Beach Tennis","Futevlei","Treino"];function tp(e){return fd(e,{weekStartsOn:1})}function pQe(e){const t=tp(e),r=Ia(t,6);return t.getMonth()===r.getMonth()?`${Jt(t,"dd")}-${Jt(r,"dd")} de ${Jt(r,"MMMM",{locale:ia})} de ${Jt(r,"yyyy")}`:`${Jt(t,"dd")} de ${Jt(t,"MMMM",{locale:ia})} - ${Jt(r,"dd")} de ${Jt(r,"MMMM",{locale:ia})} de ${Jt(r,"yyyy")}`}const $s={scheduled:{label:"Agendado",accent:"bg-[#3B82F6]",text:"text-[#3B82F6]",border:"border-[#3B82F6]",hex:"#3B82F6",icon:Ei},confirmed:{label:"Confirmado",accent:"bg-[#22C55E]",text:"text-[#22C55E]",border:"border-[#22C55E]",hex:"#22C55E",icon:Ai},in_progress:{label:"Em andamento",accent:"bg-[#FACC15]",text:"text-[#FACC15]",border:"border-[#FACC15]",hex:"#FACC15",icon:oH},finished:{label:"Finalizado",accent:"bg-[#6B7280]",text:"text-[#6B7280]",border:"border-[#6B7280]",hex:"#6B7280",icon:qde},canceled:{label:"Cancelado",accent:"bg-[#EF4444]",text:"text-[#EF4444]",border:"border-[#EF4444]",hex:"#EF4444",icon:Py},absent:{label:"Ausente",accent:"bg-[#F97316]",text:"text-[#F97316]",border:"border-[#F97316]",hex:"#F97316",icon:lH}},gQe={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},f9={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},m9=e=>{let t=Math.floor(e/60);const r=e%60;return t>=24&&(t=t%24),`${String(t).padStart(2,"0")}:${String(r).padStart(2,"0")}`};function vQe({sidebarVisible:e=!1}){const{toast:t}=oo(),{loadAlerts:r}=WS(),n=ls(),{isPaymentModalOpen:a,openPaymentModal:i,closePaymentModal:s,isEditParticipantModalOpen:l,openEditParticipantModal:c,closeEditParticipantModal:d,editParticipantData:u,editingBooking:f,setEditingBooking:m,participantsForm:h,setParticipantsForm:v,paymentTotal:g,setPaymentTotal:y,payMethods:x,setPayMethods:b}=jN(),w=p.useMemo(()=>{try{return typeof window<"u"&&localStorage.getItem("debug:agenda")==="1"}catch{return!1}},[]),j=p.useCallback((...ie)=>{if(w)try{console.log("[AgendaDbg]",...ie)}catch{}},[w]);p.useEffect(()=>{const ie=console.log,be=console.info,Ge=console.debug,We=console.warn,_t=console.error,qe=X=>{const Me=String(X||"");return Me.startsWith("[AgendaDbg]")||!1||Me.startsWith("[PulseDump]")||Me.startsWith("[Clientes:load]")||Me.startsWith("[AgendaSettings]")||Me.startsWith("[Auto]")||Me.startsWith("[DEBUG-PaymentModal]")||Me.startsWith(" EditGuard")};return console.log=(...X)=>{try{if(qe(X[0]))return}catch{}return ie(...X)},console.info=(...X)=>{try{if(qe(X[0]))return}catch{}return be(...X)},console.debug=(...X)=>{try{if(qe(X[0]))return}catch{}return Ge(...X)},console.warn=(...X)=>{try{if(qe(X[0]))return}catch{}return We(...X)},console.error=(...X)=>{try{if(qe(X[0]))return}catch{}return _t(...X)},()=>{console.log=ie,console.info=be,console.debug=Ge,console.warn=We,console.error=_t}},[]);const _=p.useRef({active:!1,tag:"",start:0,timer:null,events:[]}),C=p.useCallback((ie,be)=>{if(w)try{const Ge=Date.now(),We=_.current&&_.current.active?Ge-(_.current.start||Ge):0;_.current.events.push({t:Ge,ms:We,event:ie,data:be})}catch{}},[w]),E=p.useCallback(ie=>{if(w){try{if(!_.current.active)return;const{tag:be,start:Ge,events:We}=_.current,_t=`[PulseDump] tag=${be} dur=${Date.now()-Ge}ms reason=${ie}`;console.groupCollapsed(_t);for(const qe of We)console.log(` +${String(qe.ms).padStart(4," ")}ms`,qe.event,qe.data||{});console.groupEnd()}catch{}try{_.current.timer&&clearTimeout(_.current.timer)}catch{}_.current={active:!1,tag:"",start:0,timer:null,events:[]}}},[w]),P=p.useCallback((ie,be=5e3)=>{if(w){try{_.current.timer&&clearTimeout(_.current.timer)}catch{}_.current={active:!0,tag:ie,start:Date.now(),timer:null,events:[]},_.current.timer=setTimeout(()=>E("timeout"),be),j("PulseStart",{tag:ie,timeoutMs:be})}},[w,E,j]),{userProfile:k,authReady:M,company:S}=Do(),[I,T]=NS(),[D,B]=p.useState(new Date),[U,z]=p.useState("day"),[$,Y]=p.useState(!1),[de,xe]=p.useState({}),[q,L]=p.useState(!1),[W,ne]=p.useState({});p.useEffect(()=>{const ie=be=>{if(be.key==="Escape"&&$){Y(!1);return}if(be.key==="F10"){try{be.preventDefault()}catch{}Y(Ge=>!Ge)}};return window.addEventListener("keydown",ie),()=>window.removeEventListener("keydown",ie)},[$]),p.useEffect(()=>{if($&&window.innerWidth<768)if(screen.orientation&&screen.orientation.lock)screen.orientation.lock("landscape").catch(()=>{const ie=document.getElementById("screen-orientation-meta");ie&&ie.setAttribute("content","landscape")});else{const ie=document.getElementById("screen-orientation-meta");ie&&ie.setAttribute("content","landscape")}else if(!$&&window.innerWidth<768){screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock();const ie=document.getElementById("screen-orientation-meta");ie&&ie.setAttribute("content","portrait-primary")}},[$]),p.useEffect(()=>{const ie=I.get("date");if(ie)try{const be=new Date(ie+"T00:00:00");isNaN(be.getTime())||(B(be),I.delete("date"),T(I,{replace:!0}))}catch(be){console.error("[AgendaPage] Erro ao parsear date da URL:",be)}},[I,T]);const[le,K]=p.useState([]),[Q,re]=p.useState(!1),[G,me]=p.useState(!1),[pe,Be]=p.useState(4),[Z,ee]=p.useState(!1),[kt,Nt]=p.useState(!1),De=f,st=m,[ft,yt]=p.useState({}),Nr=p.useRef(0),se=p.useRef("");p.useEffect(()=>{const ie=be=>{try{const Ge=be?.detail||{},We=Ge.agendamentoId,_t=Ge.participants;if(!We||!Array.isArray(_t))return;yt(qe=>{const X=qe[We]||[],Me=_t.map((gt,ir)=>{const Dr=X[ir]||{};return{...Dr,cliente_id:gt.cliente_id,nome:gt.nome,codigo:Dr.codigo!==void 0?Dr.codigo:gt.codigo??null,valor_cota:typeof gt.valor_cota=="string"?gt.valor_cota:Dr.valor_cota??"",status_pagamento:gt.status_pagamento||Dr.status_pagamento||"Pendente",finalizadora_id:gt.finalizadora_id??Dr.finalizadora_id??null,aplicar_taxa:gt.aplicar_taxa??Dr.aplicar_taxa??!1,ordem:Dr.ordem??ir+1}});return{...qe,[We]:Me}})}catch{}};return window.addEventListener("payments:saved",ie),()=>window.removeEventListener("payments:saved",ie)},[]);const rt=p.useRef(!1);p.useEffect(()=>{rt.current=Q,j("Modal state change:",{isModalOpen:Q}),C("modal",{open:Q})},[Q,j]);const mt=p.useRef("init"),tr=p.useRef(0),Ce=p.useRef(!1),je=p.useRef(0),ae=p.useRef(!1),$e=p.useRef(0),[Ae,Tt]=p.useState(!1),Se=p.useRef(0),Ne=p.useRef(!1),Ue=p.useRef(0),Qe=p.useCallback((ie=800)=>{Ue.current=Date.now()+ie,j("UI:busy set",{ms:ie})},[j]),et=p.useCallback(()=>Date.now()<Ue.current,[]),pt=p.useRef(0),Ke=p.useRef(0),qt=p.useRef(!1),lt=p.useCallback(()=>{const ie=Date.now();Q||ie-Ke.current<350||(Ke.current=ie,re(!0),qt.current=!0)},[Q]),rr=p.useRef(!1);p.useEffect(()=>{n.state?.openModal&&!Q&&!rr.current&&(rr.current=!0,lt(),window.history.replaceState({},document.title))},[n.state?.openModal,Q,lt]);const[nt,$t]=p.useState({scheduled:!0,available:!0,canceledOnly:!1,pendingPayments:!1}),[Qr,Xr]=p.useState(null),[In,sn]=p.useState(!0),Qt=p.useMemo(()=>Object.fromEntries((Qr??[]).map(ie=>[ie.nome,ie])),[Qr]),qr=p.useMemo(()=>(Qr??[]).map(ie=>ie.nome),[Qr]),[Tr,sr]=p.useState([]),$r=k?.codigo_empresa,Gr=p.useMemo(()=>$r?`quadras:list:${$r}`:"quadras:list",[$r]),ke=p.useMemo(()=>$r?`agenda:selectedCourts:${$r}`:"agenda:selectedCourts",[$r]),Mt=p.useMemo(()=>$r?`agenda:viewFilter:${$r}`:"agenda:viewFilter",[$r]),[wr,Fr]=p.useState(null),[Ur,Kr]=p.useState(0);p.useEffect(()=>{Tr.length>0&&wr===null&&Fr(Tr[0])},[Tr,wr]);const[dn,wn]=p.useState([]),va=p.useRef(null),xa=p.useRef({scheduled:!0,canceledOnly:!1}),[Aa,ut]=p.useState(null),[Ht,dr]=p.useState(""),Ft=p.useRef(0),Ot=p.useRef(!1),Br=p.useRef(!1),[Vt,Cr]=p.useState(!1),[ct,Gt]=p.useState(()=>{try{return localStorage.getItem("agenda:hideCanceledInfo")==="1"}catch{return!1}});p.useEffect(()=>{try{localStorage.setItem("agenda:hideCanceledInfo",ct?"1":"0")}catch{}},[ct]);const gr=p.useMemo(()=>{if(!k?.codigo_empresa)return null;const ie=Jt(U==="week"?tp(D):D,"yyyy-MM-dd"),be=U==="week"?"week":"day";return`agenda:bookings:${k.codigo_empresa}:${be}:${ie}`},[k?.codigo_empresa,D,U]),J=p.useMemo(()=>{if(!k?.codigo_empresa)return null;const ie=Jt(D,"yyyy-MM-dd");return`agenda:participants:${k.codigo_empresa}:${ie}`},[k?.codigo_empresa,D]),[Ye,Xe]=p.useState(!1),it=p.useMemo(()=>({autoConfirmEnabled:!1,autoConfirmMinutesBefore:120,autoStartEnabled:!0,autoFinishEnabled:!0}),[]),[Ze,dt]=p.useState(it),[Pt,zt]=p.useState(it),[Er,H]=p.useState(!1),[Ee,Te]=p.useState(0),vt=p.useCallback(()=>Date.now()+(Number.isFinite(Ee)?Ee:0),[Ee]),[ze,at]=p.useState(null);p.useEffect(()=>{(async()=>{if(console.log("[AgendaSettings][LOAD] Iniciando carregamento...",{authReady:M,company_id:S?.id}),!M||!S?.id){console.warn("[AgendaSettings][LOAD] Aguardando autenticao...");return}try{console.log("[AgendaSettings][LOAD] Modo:","PRODUO (wrapper)"),console.log("[AgendaSettings][LOAD] Buscando para empresa_id:",S.id);const{data:be,error:Ge}=await ve.from("agenda_settings").select("*").eq("empresa_id",S.id).maybeSingle();if(console.log("[AgendaSettings][LOAD] Resultado da query:",{data:be,error:Ge}),console.log("[AgendaSettings][LOAD] Data type:",be===null?"null":typeof be),Ge){console.error("[AgendaSettings][LOAD] ERRO ao carregar:",Ge);return}if(!be){console.warn("[AgendaSettings][LOAD] Nenhum registro encontrado (ainda no criado)");return}console.log("[AgendaSettings][LOAD]  Registro encontrado:",be);const We={autoConfirmEnabled:!!be.auto_confirm_enabled,autoConfirmMinutesBefore:be.auto_confirm_enabled&&Number.isFinite(Number(be.auto_confirm_hours))?Number(be.auto_confirm_hours)*60:it.autoConfirmMinutesBefore,autoStartEnabled:!!be.auto_start_enabled,autoFinishEnabled:!!be.auto_finish_enabled};console.log("[AgendaSettings][LOAD]  Estado mapeado:",We),dt(_t=>({..._t,...We})),zt(We),console.log("[AgendaSettings][LOAD]  Estados atualizados com sucesso!")}catch(be){console.warn("[AgendaSettings] unexpected load error",be)}})()},[M,S?.id]),p.useEffect(()=>{let ie=!0,be=null,Ge=!1;const We=async()=>{try{const{data:_t,error:qe}=await ve.functions.invoke("time-br",{body:{}});if(!qe&&_t&&ie){const X=Number(_t.nowMs);if(Number.isFinite(X)){const Me=X-Date.now();Te(Me),at(Date.now());return}}if(!Ge){Ge=!0;try{console.warn("[TimeSync] time-br sem dados vlidos; usando relgio local.")}catch{}}}catch{if(!Ge){Ge=!0;try{console.warn("[TimeSync] time-br falhou; usando relgio local.")}catch{}}}};return We(),be=setInterval(We,5*60*1e3),()=>{ie=!1,be&&clearInterval(be)}},[]);const[Zt,zr]=p.useState({}),Ar=2*60*60*1e3,br=p.useCallback(ie=>{zr(be=>({...be,[ie]:Date.now()}))},[]),yr=p.useCallback(ie=>{zr(be=>{if(!be||!(ie in be))return be;const Ge={...be};return delete Ge[ie],Ge})},[]),nr=p.useCallback(ie=>{const be=Zt?.[ie];return typeof be=="number"&&Date.now()-be<Ar},[Zt]),[Zr,tt]=p.useState(null),Lr=p.useCallback(()=>new Promise(ie=>{tt({resolve:ie})}),[]),cn=p.useRef(new Map),pn=async()=>{console.log(" [AgendaSettings][SAVE] FUNO CHAMADA! "),console.log("[AgendaSettings][SAVE] Linha 509 - Antes do try");try{if(console.log("[AgendaSettings][SAVE] Linha 511 - Dentro do try"),console.log("[AgendaSettings][SAVE] authReady:",M),console.log("[AgendaSettings][SAVE] company:",S),!M||!S?.id){console.error("[AgendaSettings][SAVE] ERRO: No autenticado",{authReady:M,company:S}),t({title:"No autenticado",description:"Faa login para salvar as configuraes.",variant:"destructive"});return}console.log("[AgendaSettings][SAVE]  Autenticado! Preparando payload..."),console.log("[AgendaSettings][SAVE] automation atual:",Ze),H(!0);const ie={empresa_id:S.id,auto_confirm_enabled:!!Ze.autoConfirmEnabled,auto_confirm_hours:Ze.autoConfirmEnabled?Math.max(0,Math.round(Number(Ze.autoConfirmMinutesBefore||0)/60)):null,auto_start_enabled:!!Ze.autoStartEnabled,auto_finish_enabled:!!Ze.autoFinishEnabled};console.log("[AgendaSettings][SAVE] Payload preparado:",ie),console.log("[AgendaSettings][SAVE] Modo:","PRODUO (wrapper)"),console.log("[AgendaSettings][SAVE] Supabase client type:",typeof ve.from);const{data:be,error:Ge}=await ve.from("agenda_settings").upsert(ie,{onConflict:"empresa_id"}).select();if(console.log("[AgendaSettings][SAVE] Resultado do upsert:",{data:be,error:Ge}),console.log("[AgendaSettings][SAVE] Data type:",Array.isArray(be)?"array":typeof be),console.log("[AgendaSettings][SAVE] Data length:",be?.length),Ge)throw console.error("[AgendaSettings][SAVE]  ERRO no upsert:",Ge),Ge;!be||be.length===0?console.error("[AgendaSettings][SAVE]  AVISO: Upsert no retornou dados!"):console.log("[AgendaSettings][SAVE]  Dados salvos com sucesso:",be[0]),zt(Ze),console.log("[AgendaSettings][SAVE]  savedAutomation atualizado:",Ze),t({title:"Configuraes salvas",description:"As automaes da agenda foram atualizadas com sucesso."}),Xe(!1),console.log("[AgendaSettings][SAVE]  Salvamento concludo!")}catch(ie){console.error(" [AgendaSettings][SAVE] ERRO CAPTURADO:",ie),console.error("[AgendaSettings][SAVE] Stack:",ie?.stack),console.error("[AgendaSettings][SAVE] Message:",ie?.message);const be=ie?.message||"Falha ao salvar as configuraes.";t({title:"Erro ao salvar",description:be,variant:"destructive"})}finally{console.log("[AgendaSettings][SAVE] Finally executado"),H(!1)}},jn=p.useCallback(async(ie,be,Ge="user")=>{try{const We=["canceled","finished","absent"],_t=["scheduled","confirmed","in_progress"],qe=We.includes(be);let X=!1;if(Ge==="user"&&_t.includes(be)){const ir=(le||[]).find(F=>F.id===ie),Dr=ir?We.includes(ir.status):!1,O=ir?!!ir.auto_disabled:!1;(Dr||O)&&(X=!!await Lr())}const Me=qe?{status:be,auto_disabled:!0}:X?{status:be,auto_disabled:!1}:{status:be},{error:gt}=await ve.from("agendamentos").update(Me).eq("codigo_empresa",k.codigo_empresa).eq("id",ie).select("id");if(gt)throw gt;K(ir=>ir.map(Dr=>{if(Dr.id!==ie)return Dr;const O={...Dr,status:be,customer:Dr.customer||""};return qe?O.auto_disabled=!0:X&&(O.auto_disabled=!1),O}));try{cn.current.set(ie,{status:be,ts:Date.now()})}catch{}try{const ir=JSON.parse(localStorage.getItem(gr)||"[]");if(Array.isArray(ir)&&ir.length>0){const Dr=Array.isArray(ir)?ir.map(O=>{if(O.id!==ie)return O;const F={...O,status:be,customer:O.customer||""};return qe?F.auto_disabled=!0:X&&(F.auto_disabled=!1),F}):ir;localStorage.setItem(gr,JSON.stringify(Dr))}}catch{}if(Ge==="user")try{X?yr(ie):br(ie)}catch{}}catch(We){console.error("Auto-status: falha ao atualizar",ie,be,We)}},[le,gr,br,yr,Lr,nt]),Gn=p.useRef(!1),Ln=p.useRef(null),aa=p.useRef(null),Bn=p.useCallback(()=>{try{Ln.current&&(clearTimeout(Ln.current),Ln.current=null)}catch{}},[]),ya=p.useCallback(()=>{if(!M||!k?.codigo_empresa)return;if(Date.now()<(pt.current||0)){console.log("[AutoDiag] scheduleNextAutomation:deferred returning-from-hidden"),setTimeout(()=>ya(),600);return}if(rt.current){j("scheduleNextAutomation:skipped (modal open)");return}C("auto:schedule"),Bn();const be=vt();let Ge=1/0;const We=_t=>{Number.isFinite(_t)&&_t>be&&_t<Ge&&(Ge=_t)};try{for(const _t of le||[]){if(!_t||_t.auto_disabled||nr(_t.id))continue;const qe=_t.start instanceof Date?_t.start.getTime():new Date(_t.start).getTime(),X=_t.end instanceof Date?_t.end.getTime():new Date(_t.end).getTime();if(_t.status==="scheduled"&&Pt.autoConfirmEnabled){const Me=Number(Pt.autoConfirmMinutesBefore||0)*6e4;We(qe-Me),Pt.autoFinishEnabled&&We(X)}_t.status==="confirmed"&&(Pt.autoStartEnabled&&We(qe),Pt.autoFinishEnabled&&We(X)),_t.status==="in_progress"&&Pt.autoFinishEnabled&&We(X)}}catch{}if(Ge!==1/0){const _t=Math.max(0,Math.min(Ge-be+250,6e5));try{console.debug("[Auto] next schedule in ms",_t)}catch{}try{Fe(Ge)}catch{}Ln.current=setTimeout(()=>{try{aa.current&&aa.current()}catch{}},_t)}},[M,k?.codigo_empresa,le,Pt,nr,Bn,vt]),an=p.useCallback(async ie=>{try{if(!(typeof ze=="number"&&Date.now()-ze<6e5))try{const{data:We}=await ve.functions.invoke("time-br",{body:{}}),_t=Number(We?.nowMs);Number.isFinite(_t)&&(Te(_t-Date.now()),at(Date.now()))}catch{}try{ya()}catch{}let Ge=null;if(ie?.id&&k?.codigo_empresa){const{data:We}=await ve.from("agendamentos").select("id, inicio, fim, status, modalidade, quadra_id, cliente_id, auto_disabled").eq("codigo_empresa",k.codigo_empresa).eq("id",ie.id).single();if(We){const _t={...ie,start:new Date(We.inicio),end:new Date(We.fim),status:We.status||ie.status,modality:We.modalidade||ie.modality,auto_disabled:!!We.auto_disabled,customer:ie.customer||""};Ge=_t,K(qe=>qe.map(X=>X.id===ie.id?_t:X))}}try{const We=Ge||ie;if(We&&We.id){const _t=vt(),qe=We.start instanceof Date?We.start.getTime():new Date(We.start).getTime(),X=We.end instanceof Date?We.end.getTime():new Date(We.end).getTime();if(!We.auto_disabled&&!nr(We.id))if(We.status==="in_progress"&&Pt.autoFinishEnabled&&Number.isFinite(X)&&_t>=X)await jn(We.id,"finished","automation");else if(We.status==="scheduled"&&Pt.autoStartEnabled&&Number.isFinite(qe)&&_t>=qe)await jn(We.id,"in_progress","automation");else if(We.status==="confirmed"&&Pt.autoStartEnabled&&Number.isFinite(qe)&&_t>=qe)await jn(We.id,"in_progress","automation");else if(We.status==="scheduled"&&Pt.autoConfirmEnabled&&Number.isFinite(qe)){const gt=Number(Pt.autoConfirmMinutesBefore||0)*6e4;_t>=qe-gt&&await jn(We.id,"confirmed","automation")}else(We.status==="scheduled"||We.status==="confirmed")&&Pt.autoFinishEnabled&&Number.isFinite(X)&&_t>=X&&await jn(We.id,"finished","automation")}}catch{}try{aa.current&&aa.current()}catch{}try{console.log(" EditGuard | ok | tempo=",typeof ze=="number"?"Servidor":"Local")}catch{}return{booking:Ge}}catch(be){try{console.warn(" EditGuard | falha leve",be?.message||be)}catch{}return{booking:null}}},[ze,ve,k,K,ya,vt,Ze,nr,jn]),Ea=p.useCallback(async()=>{if(!(!M||!k?.codigo_empresa)){if(rt.current){j("runAutomation:skipped (modal open)");return}if(!Gn.current){Gn.current=!0;try{try{console.debug("[Auto] tick")}catch{}C("auto:tick");const ie=vt(),be=new Date(ie),Ge=Jt(be,"yyyy-MM-dd");let We=(le||[]).filter(qe=>Jt(qe.start,"yyyy-MM-dd")===Ge);if(We.length===0)try{const qe=ni(be),X=Ia(qe,1),{data:Me,error:gt}=await ve.from("agendamentos").select("id, inicio, fim, status, auto_disabled").eq("codigo_empresa",k.codigo_empresa).gte("inicio",qe.toISOString()).lt("inicio",X.toISOString());!gt&&Array.isArray(Me)&&(We=Me.map(ir=>({id:ir.id,start:new Date(ir.inicio),end:new Date(ir.fim),status:ir.status||"scheduled",auto_disabled:!!ir.auto_disabled})))}catch{}try{const{data:qe,error:X}=await ve.from("agendamentos").select("id, inicio, fim, status, auto_disabled").eq("codigo_empresa",k.codigo_empresa).lt("fim",be.toISOString()).in("status",["scheduled","confirmed","in_progress"]);if(!X&&Array.isArray(qe)&&qe.length>0){const Me=qe.map(ir=>({id:ir.id,start:new Date(ir.inicio),end:new Date(ir.fim),status:ir.status||"scheduled",auto_disabled:!!ir.auto_disabled})),gt=new Map(We.map(ir=>[ir.id,ir]));for(const ir of Me)gt.has(ir.id)||gt.set(ir.id,ir);We=Array.from(gt.values())}}catch{}let _t=!1;for(const qe of We){if(qe.auto_disabled||nr(qe.id))continue;const X=qe.start instanceof Date?qe.start.getTime():new Date(qe.start).getTime(),Me=qe.end instanceof Date?qe.end.getTime():new Date(qe.end).getTime();if(qe.status==="in_progress"&&Pt.autoFinishEnabled&&ie>=Me){try{console.debug("[Auto] finish",{id:qe.id})}catch{}await jn(qe.id,"finished","automation"),_t=!0;continue}if(qe.status==="scheduled"&&Pt.autoStartEnabled&&ie>=X){try{console.debug("[Auto] start-direct (skip confirm)",{id:qe.id})}catch{}await jn(qe.id,"in_progress","automation"),_t=!0;continue}if(qe.status==="confirmed"&&Pt.autoStartEnabled&&ie>=X){try{console.debug("[Auto] start",{id:qe.id})}catch{}await jn(qe.id,"in_progress","automation"),_t=!0;continue}if(qe.status==="scheduled"&&Pt.autoConfirmEnabled){const gt=Number(Pt.autoConfirmMinutesBefore||0)*6e4;if(ie>=X-gt){try{console.debug("[Auto] confirm",{id:qe.id})}catch{}await jn(qe.id,"confirmed","automation"),_t=!0;continue}}if((qe.status==="scheduled"||qe.status==="confirmed")&&Pt.autoFinishEnabled&&ie>=Me){try{console.debug("[Auto] catchup-finish",{id:qe.id})}catch{}await jn(qe.id,"finished","automation"),_t=!0;continue}}if(_t)try{setTimeout(()=>{try{Sa()}catch{}},800)}catch{}try{ya()}catch{}}finally{Gn.current=!1}}}},[M,k?.codigo_empresa,le,Pt,jn,nr,ya,vt]);p.useEffect(()=>{aa.current=Ea},[Ea]),p.useEffect(()=>{const ie=setInterval(Ea,1e4);try{aa.current&&aa.current()}catch{}try{ya()}catch{}return()=>clearInterval(ie)},[Ea]),p.useEffect(()=>{const ie=setInterval(()=>{try{if(!!!(Pt?.autoConfirmEnabled||Pt?.autoStartEnabled||Pt?.autoFinishEnabled))return;aa.current&&(console.debug("[Auto][Watchdog] forcing periodic automation run"),aa.current())}catch{}},18e5);return()=>clearInterval(ie)},[Pt]),p.useEffect(()=>{if(gr)try{const ie=JSON.parse(localStorage.getItem(gr)||"[]");if(Array.isArray(ie)&&ie.length>0){const be=ie.map(Ge=>({...Ge,start:new Date(Ge.start),end:new Date(Ge.end),customer:Ge.customer||""}));j("cache:bookings:hydrate",{count:be.length,sample:be[0]}),C("cache:hydrate",{count:be.length}),K(Ge=>Ge&&Ge.length>0?Ge:be),Qe(1200)}}catch{}},[gr,j]),p.useEffect(()=>{const ie=()=>{try{const We=new Date().toISOString();if(document.visibilityState==="visible"){const _t=Date.now();pt.current=_t+800}}catch{}},be=()=>{try{const We=new Date().toISOString()}catch{}},Ge=()=>{try{const We=new Date().toISOString()}catch{}};return document.addEventListener("visibilitychange",ie),window.addEventListener("focus",be),window.addEventListener("blur",Ge),()=>{document.removeEventListener("visibilitychange",ie),window.removeEventListener("focus",be),window.removeEventListener("blur",Ge)}},[Q,le]),p.useEffect(()=>{try{ya()}catch{}return()=>{try{Bn()}catch{}}},[le,Ze,ya,Bn]),p.useEffect(()=>{if(J)try{const ie=JSON.parse(localStorage.getItem(J)||"{}");ie&&typeof ie=="object"&&(yt(ie),se.current=Jt(D,"yyyy-MM-dd"))}catch{}},[J]);const Sa=p.useCallback(async()=>{if(!M||!k?.codigo_empresa||Date.now()<(pt.current||0)||Q)return;j("fetchBookings:start",{date:Jt(D,"yyyy-MM-dd"),empresa:k?.codigo_empresa}),C("fetch:start",{day:Jt(D,"yyyy-MM-dd")});const ie=ni(D),be=U==="week"?tp(D):ie,Ge=U==="week"?Ia(be,7):Ia(be,1),{data:We,error:_t}=await ve.from("agendamentos").select(`
        id, codigo, codigo_empresa, quadra_id, cliente_id, clientes, inicio, fim, modalidade, status, auto_disabled,
        quadra:quadra_id ( nome )
      `).eq("codigo_empresa",k.codigo_empresa).gte("inicio",be.toISOString()).lt("inicio",Ge.toISOString()).order("inicio",{ascending:!0});if(_t){j("fetchBookings:error",{message:_t?.message,code:_t?.code,status:_t?.status}),C("fetch:error",{message:_t?.message,code:_t?.code,status:_t?.status}),t({title:"Erro ao carregar agendamentos",description:_t.message,variant:"destructive"}),Ot.current||(Ot.current=!0,setTimeout(Sa,900));return}if(!We||We.length===0){j("fetchBookings:empty-first-hit"),C("fetch:empty-first");let Me=!1;try{const gt=gr?JSON.parse(localStorage.getItem(gr)||"[]"):[];Me=Array.isArray(gt)&&gt.length>0}catch{}if(!Ot.current&&(Ot.current=!0,Me)){setTimeout(Sa,700);return}}Ot.current=!1;const qe=Date.now(),X=(We||[]).map(Me=>{const gt=new Date(Me.inicio),ir=new Date(Me.fim),Dr=Me.quadra?.[0]?.nome||Me.quadra?.nome||Object.values(Qt).find(we=>we.id===Me.quadra_id)?.nome||"";let O="";if(ft[Me.id]){const we=ft[Me.id];Array.isArray(we)&&we.length>0&&(O=we[0]?.nome||"")}if(!O&&Me.clientes)try{const we=typeof Me.clientes=="string"?JSON.parse(Me.clientes):Me.clientes;Array.isArray(we)&&we.length>0&&(O=we[0]?.nome||we[0]||"")}catch{}const F=cn.current.get(Me.id),fe=F&&qe-F.ts<4e3;return{id:Me.id,code:Me.codigo,court:Dr,customer:O,start:gt,end:ir,status:fe?F.status:Me.status||"scheduled",modality:Me.modalidade||"",auto_disabled:!!Me.auto_disabled}});K(X);try{if(gr){const Me=X.map(gt=>({id:gt.id,code:gt.code,court:gt.court,customer:gt.customer,start:gt.start.toISOString(),end:gt.end.toISOString(),status:gt.status,modality:gt.modality,auto_disabled:gt.auto_disabled}));localStorage.setItem(gr,JSON.stringify(Me))}}catch{}},[M,k?.codigo_empresa,D,Qt,gr,t,j,w,ft]);p.useEffect(()=>{if(w)try{const ie=(le||[]).map(be=>`${be.id}:${Jt(be.start,"HH:mm")}-${Jt(be.end,"HH:mm")}:${be.status}`).join(" | ");console.log("[AgendaDbg] bookings:changed",{count:Array.isArray(le)?le.length:0,summary:ie})}catch{}},[le,w]),p.useEffect(()=>{try{const ie=Date.now()+1800;je.current=ie,j("Picker:suppressClose window set",{until:ie})}catch{}},[le]),p.useEffect(()=>{M&&k?.codigo_empresa&&Sa()},[M,k?.codigo_empresa,D,Qt,gr]);const ba=p.useRef(null),[Mo,vi]=p.useState("idle"),[lo,zl]=p.useState(null),yl=p.useRef(!1);p.useEffect(()=>{if(!M||!k?.codigo_empresa)return;const ie=ni(D);Ia(ie,1);const be=setInterval(()=>{rt.current||Sa()},3e4);return()=>{try{ba.current&&clearTimeout(ba.current)}catch{}try{clearInterval(be)}catch{}try{vi("polling")}catch{}}},[M,k?.codigo_empresa,D,Sa]),p.useEffect(()=>{if(!Q&&yl.current){yl.current=!1;try{j("Modal closed: flushing pending realtime refresh"),C("rt:flushAfterModalClose"),Sa()}catch{}}},[Q,Sa,j]);const[ue,Fe]=p.useState(null),ht=p.useRef("");p.useEffect(()=>{try{const ie=typeof ze=="number"&&Date.now()-ze<6e5,be=ir=>typeof ir=="number"?Jt(new Date(ir),"HH:mm:ss",{locale:ia}):"",Ge=ir=>typeof ir=="number"?Jt(new Date(ir),"HH:mm",{locale:ia}):"",We=ie?"":"",qe=String(Mo).toUpperCase()==="SUBSCRIBED"||String(Mo).toLowerCase()==="polling"?"":"",X=typeof ue=="number"?"":"",Me=Array.isArray(le)?le.length:0,gt=` Agenda | ${We} Tempo=${ie?"Servidor":"Local"} (${Math.round(Ee)}ms, sync ${be(ze)}) |  Realtime=${qe} ${Mo}${lo?` (${be(lo)})`:""} | ${X} Prximo=${Ge(ue)} |  Agendamentos=${Me}`;ht.current!==gt&&(ht.current=gt,console.log(gt)),typeof window<"u"&&(window.__AgendaConn={usingServer:ie,serverOffsetMs:Ee,lastTimeSyncAtMs:ze,realtimeStatus:Mo,lastRealtimeEventAtMs:lo,nextAutoAtMs:ue})}catch{}},[Ee,ze,Mo,lo,Ze,ue,k?.codigo_empresa,D,Array.isArray(le)?le.length:0]),p.useEffect(()=>{const ie=setInterval(()=>{try{const be=Date.now();if(be<(pt.current||0)){console.log("[AutoDiag] reconcile:skipped returning-from-hidden");return}if(Q){console.log("[AutoDiag] reconcile:skipped modal-open");return}const Ge=String(Mo||"").toUpperCase()==="SUBSCRIBED",We=typeof lo=="number"?be-lo:1/0,_t=!Ge||We>7*60*1e3,qe=typeof ue=="number"?be>ue+60*1e3:!1;if(_t||qe){console.debug("[Reconcile] forcing fetchBookings (stale=",_t," tickDue=",qe,")"),Sa();try{ya()}catch{}}}catch{}},3e5);return()=>clearInterval(ie)},[Mo,lo,ue,Sa,ya]),p.useEffect(()=>{(async()=>{if(!M||!k?.codigo_empresa||Date.now()<(pt.current||0))return;if(rt.current){j("Participants:skipped (modal open)");return}j("Participants:load start"),C("parts:start");const be=(le||[]).map(Me=>Me.id).filter(Boolean),Ge=Jt(D,"yyyy-MM-dd");if(!be.length){if(se.current!==Ge){yt({});try{J&&localStorage.setItem(J,"{}")}catch{}}se.current=Ge;return}const We=++Nr.current,{data:_t,error:qe}=await ve.from("agendamento_participantes").select("id, agendamento_id, codigo_empresa, cliente_id, nome, valor_cota, status_pagamento, finalizadora_id, aplicar_taxa, cliente:clientes!agendamento_participantes_cliente_id_fkey(nome, codigo)").in("agendamento_id",be).order("ordem",{ascending:!0});if(Nr.current!==We)return;if(qe){console.warn("[Participants] load error",qe),j("Participants:error",{message:qe?.message,code:qe?.code,status:qe?.status}),C("parts:error",{code:qe?.code});return}const X={};for(const Me of _t||[]){const gt=Me.agendamento_id;X[gt]||(X[gt]=[]);const ir=Me.nome||(Array.isArray(Me.cliente)?Me.cliente[0]?.nome:Me.cliente?.nome)||"",Dr=(Array.isArray(Me.cliente)?Me.cliente[0]?.codigo:Me.cliente?.codigo)||null;X[gt].push({...Me,nome:ir,codigo:Dr})}j("Participants:loaded",{bookings:be.length,rows:(_t||[]).length}),C("parts:loaded",{rows:(_t||[]).length}),se.current=Ge,yt(Me=>{const gt={...Me};for(const ir of be)gt[ir]=X[ir]||[];try{J&&localStorage.setItem(J,JSON.stringify(gt))}catch{}return j("Participants:set state for ids",{ids:be}),C("parts:set",{idsCount:be.length}),gt})})()},[M,k?.codigo_empresa,le,D,J,j]),p.useEffect(()=>{(async()=>{if(!(!M||!k?.codigo_empresa||!qr.length)){L(!0);try{const be=Jt(D,"yyyy-MM-dd"),Ge=D.getDay(),{data:We,error:_t}=await ve.from("quadras_dias_funcionamento").select("*").eq("codigo_empresa",k.codigo_empresa).or(`and(tipo.eq.data_fechamento,data_fechamento.eq.${be}),and(tipo.eq.dia_semana,dia_semana.eq.${Ge})`);if(_t){console.error("Erro ao carregar dias de funcionamento:",_t);return}const qe={};qr.forEach(X=>{const Me=Qt[X];if(!Me)return;const gt=We?.find(Dr=>Dr.quadra_id===Me.id&&Dr.tipo==="data_fechamento"&&Dr.data_fechamento===be);if(gt&&!gt.funciona){qe[X]={funciona:!1,motivo:"data_especifica",observacao:gt.observacao||"Fechamento especial"};return}const ir=We?.find(Dr=>Dr.quadra_id===Me.id&&Dr.tipo==="dia_semana"&&Dr.dia_semana===Ge);ir?qe[X]={funciona:ir.funciona,motivo:ir.funciona?"normal":"dia_semana",observacao:ir.funciona?null:"Fechado neste dia da semana"}:qe[X]={funciona:!0,motivo:"normal",observacao:null}}),xe(qe)}catch(be){console.error("Erro ao verificar dias de funcionamento:",be)}finally{L(!1)}}})()},[M,k?.codigo_empresa,D,qr,Qt]),p.useEffect(()=>{if(!M||!k?.codigo_empresa||qr.length===0)return;(async()=>{try{const be=new Date(D);be.setDate(be.getDate()-be.getDay());const{data:Ge,error:We}=await ve.from("quadras_dias_funcionamento").select("*").eq("codigo_empresa",k.codigo_empresa);if(We){console.error("Erro ao carregar funcionamento da semana:",We);return}const _t={};for(let qe=0;qe<7;qe++){const X=new Date(be);X.setDate(X.getDate()+qe);const Me=Jt(X,"yyyy-MM-dd"),gt=X.getDay(),ir={};qr.forEach(Dr=>{const O=Qt[Dr];if(!O)return;const F=Ge?.find(we=>we.quadra_id===O.id&&we.tipo==="data_fechamento"&&we.data_fechamento===Me);if(F&&!F.funciona){ir[Dr]={funciona:!1,motivo:"data_especifica",observacao:F.observacao||"Fechamento especial"};return}const fe=Ge?.find(we=>we.quadra_id===O.id&&we.tipo==="dia_semana"&&we.dia_semana===gt);fe?ir[Dr]={funciona:fe.funciona,motivo:fe.funciona?"normal":"dia_semana",observacao:fe.funciona?null:"Fechado neste dia da semana"}:ir[Dr]={funciona:!0,motivo:"normal",observacao:null}}),_t[Me]=ir}ne(_t)}catch(be){console.error("Erro ao carregar funcionamento da semana:",be)}})()},[M,k?.codigo_empresa,D,qr,Qt]),p.useEffect(()=>{Object.values(de).some(be=>!be.funciona)&&va.current},[de]),p.useEffect(()=>{if($r)try{const ie=JSON.parse(localStorage.getItem(Gr)||"[]");Array.isArray(ie)&&ie.length&&(!Qr||Qr.length===0)&&(Xr(ie),sn(!1))}catch{}},[$r,Gr]),p.useEffect(()=>{const ie=async()=>{if(!k?.codigo_empresa)return;try{const _t=JSON.parse(localStorage.getItem(Gr)||"[]");if(Array.isArray(_t)&&_t.length>0){const qe=_t[0]?.codigo_empresa;if(qe&&qe!==k.codigo_empresa){console.warn(" [Cache Limpo] Quadras de outra empresa detectadas e removidas"),localStorage.removeItem(Gr),localStorage.removeItem(ke),Xr([]);try{sr([])}catch{}try{Fr(null)}catch{}try{setForm(X=>({...X,court:""}))}catch{}}}}catch{}(!Qr||Qr.length===0)&&sn(!0);const{data:be,error:Ge}=await ve.from("quadras").select("id, nome, modalidades, hora_inicio, hora_fim, valor, codigo_empresa, status").eq("codigo_empresa",k.codigo_empresa).eq("status","Ativa").order("nome",{ascending:!0});if(Ge){t({title:"Erro ao carregar quadras",description:Ge.message}),Br.current?sn(!1):(Br.current=!0,setTimeout(ie,900));return}const We=be||[];if(We.length===0){let _t=0;try{const qe=JSON.parse(localStorage.getItem("quadras:list")||"[]");_t=Array.isArray(qe)?qe.length:0}catch{}if(_t>0&&!Br.current){Br.current=!0,sn(!1),setTimeout(ie,700);return}}Br.current=!1,Xr(We);try{localStorage.setItem(Gr,JSON.stringify(We))}catch{}sn(!1)};M&&k?.codigo_empresa&&ie()},[M,k?.codigo_empresa,Gr,ke]),p.useEffect(()=>{try{if(In)return;const ie=qr||[];form?.court&&!ie.includes(form.court)&&setForm(be=>({...be,court:ie[0]||""})),(!form?.court||form.court==="")&&ie.length>0&&setForm(be=>({...be,court:ie[0]}))}catch{}},[In,qr,k?.codigo_empresa]),p.useEffect(()=>{if(In)return;const ie=(()=>{try{return JSON.parse(localStorage.getItem(ke)||"[]")}catch{return[]}})(),be=(()=>{try{return JSON.parse(localStorage.getItem(Mt)||"{}")}catch{return{}}})(),Ge=ie.filter(We=>qr.includes(We));Ge.length>0?sr(Ge):Tr.length===0&&sr(qr),be&&typeof be=="object"&&$t(We=>({...We,canceledOnly:!1,...be}))},[In,qr.length]),p.useEffect(()=>{try{localStorage.setItem(ke,JSON.stringify(Tr))}catch{}},[Tr,ke]),p.useEffect(()=>{try{localStorage.setItem(Mt,JSON.stringify(nt))}catch{}},[nt,Mt]);const At=p.useMemo(()=>{const ie=Tr.map(Ge=>Qt[Ge]?.hora_inicio||"06:00:00").map(Ge=>{const[We,_t]=String(Ge).split(":").map(Number);return(We||0)*60+(_t||0)});if(!ie.length)return m4;const be=Math.min(...ie);return Math.floor(be/60)},[Tr,Qt]),St=p.useMemo(()=>{const ie=Tr.map(Ge=>Qt[Ge]?.hora_fim||"24:00:00").map(Ge=>{const[We,_t]=String(Ge).split(":").map(Number);return(We===0&&_t===0?24:We||0)*60+(_t||0)});if(!ie.length)return Nne;const be=Math.max(...ie);return Math.ceil(be/60)},[Tr,Qt]);p.useEffect(()=>{const ie=new Date,be=cu(ie),Ge=du(ie);setTimeout(()=>{if(!va.current)return;const _t=Math.max(0,(be-At)*60+Ge)/ja;va.current.scrollTop=Math.max(0,_t*xs-120)},150)},[At]);const xr=({booking:ie,courtGridStart:be,courtGridEnd:Ge})=>{const We=xs,_t=ga=>{const Ji=cu(ga),Hs=du(ga);return Ji===0&&Hs===0?1440:Ji*60+Hs},qe=_t(ie.start),X=_t(ie.end),Me=be!==void 0?be:wr?Ir.start*60:At*60,gt=Ge!==void 0?Ge:wr?Ir.end*60:St*60,ir=qe-Me,Dr=(gt-Me)/ja;let O=Math.floor(ir/ja);const F=Math.max(0,X-qe),fe=Math.max(1,Math.ceil(F/ja));let we=O+fe;O=Math.max(0,Math.min(O,Dr-1)),we=Math.max(0,Math.min(we,Dr)),we<=O&&(we=O+1),we=Math.min(we,Dr);const Re=O*We;let Je=(we-O)*We;const He=$s[ie.status]||$s.confirmed,Et=He.icon,Xt=He.border,jt=fe===1,ar=jt?4:hQe,pr=Re+ar,Wr=Math.max(jt?40:32,Je-ar*2),Pr=F>=90,Vr=2,Lt=1.15,xn=Pr?(()=>{const ga=Math.min(Math.max((F-90)/90,0),1);return Math.min(Lt+ga*(Vr-Lt),Vr)})():1,Rn=16,Ma=14,xi=jt?16:24,Xn=Math.round(Rn*(Pr?xn:1)),ka=Math.round(Ma*(Pr?xn:1)),ma=Math.round(xi*(Pr?xn:1)),Ya=jt?12:16,Oi=jt?12:16,us=Pr?Math.min(xn,1.3):1,Xa=Math.round(Ya*us),Ro=Math.round(Oi*us),Xi=ft[ie.id]||[],fo=Xi.filter(ga=>String(ga.status_pagamento||"").toLowerCase()==="pago").length,fs=Xi.length;return o.jsxs(fr.div,{layout:Q?!1:"position",initial:Q?!1:{opacity:0,y:6},animate:Q?!1:{opacity:1,y:0},exit:Q?!1:{opacity:0,y:6},id:`booking-${ie.id}`,className:Yt("absolute left-2 right-2 rounded-md border-2 bg-surface text-sm shadow-sm z-0 cursor-pointer",Xt,"overflow-hidden transition-all duration-150 hover:bg-surface-2 hover:shadow-md"),style:{top:`${pr}px`,height:`${Wr}px`},onClick:async()=>{const ga=an(ie),Ji=new Promise(Ra=>setTimeout(Ra,600));let Hs=null;try{Hs=await Promise.race([ga,Ji])}catch{}const Hu=Hs&&Hs.booking||le.find(Ra=>Ra.id===ie.id)||ie;st(Hu),lt()},children:[o.jsx("div",{className:Yt("absolute left-0 top-0 h-full w-[6px] rounded-l-md",He.accent)}),o.jsx("div",{className:Yt("h-full flex",jt?"px-3 py-3":"px-4 py-4"),style:{paddingLeft:Xa,paddingRight:Xa,paddingTop:Ro,paddingBottom:Ro},children:o.jsxs("div",{className:"flex-1 flex flex-col justify-center",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[o.jsx("p",{className:"font-semibold text-text-primary truncate text-base",style:{fontSize:Xn,lineHeight:1.15},children:u9(ie.customer)}),jt&&o.jsx("span",{className:"text-xs font-bold text-white truncate bg-gradient-to-r from-slate-700 to-slate-800 border border-slate-600/60 rounded-md px-2 py-0.5 whitespace-nowrap shadow-md",style:{fontSize:ka},children:ie.modality})]}),o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[o.jsxs("span",{className:Yt("text-text-muted font-semibold text-base whitespace-nowrap"),style:{fontSize:Xn},children:[Jt(ie.start,"HH:mm"),"",Jt(ie.end,"HH:mm")]}),jt&&o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(Et,{className:Yt(He.text),style:{width:ma,height:ma}}),o.jsx("span",{className:Yt("truncate font-semibold",He.text,"text-base"),style:{fontSize:Xn},children:He.label})]}),jt&&fs>0&&o.jsxs("span",{className:`text-xs font-semibold rounded-full px-2 py-0.5 border ${fo===fs?"text-emerald-300 bg-emerald-500/10 border-emerald-400/30":"text-amber-300 bg-amber-500/10 border-amber-400/30"}`,style:{fontSize:Math.max(11,Math.round(11*(Pr?xn:1)))},children:[fo,"/",fs]})]}),o.jsxs("div",{className:"mt-1 flex items-center justify-between gap-2 flex-wrap",children:[!jt&&o.jsx("span",{className:"text-xs font-bold text-white truncate bg-gradient-to-r from-slate-700 to-slate-800 border border-slate-600/60 rounded-md px-2.5 py-1 shadow-md",style:{fontSize:ka},children:ie.modality}),!jt&&o.jsxs("div",{className:"flex items-center gap-1.5 text-base flex-wrap justify-end",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(Et,{className:Yt(He.text),style:{width:ma,height:ma}}),o.jsx("span",{className:Yt("truncate font-semibold",He.text),style:{fontSize:Xn},children:(()=>typeof window<"u"&&window.innerWidth<768&&ie.status==="in_progress"?"Andamento":He.label)()})]}),fs>0&&(()=>{const ga=typeof window<"u"&&window.innerWidth<768;return o.jsxs("span",{className:Yt("font-bold rounded-full border flex items-center gap-1 whitespace-nowrap",jt?"px-2 py-0.5 text-xs":"px-2.5 py-1 text-sm",fo===fs?"text-emerald-300 bg-emerald-500/10 border-emerald-400/30":"text-amber-300 bg-amber-500/10 border-amber-400/30"),style:{fontSize:Math.max(jt?11:13,Math.round((jt?11:13)*(Pr?xn:1)))},children:[o.jsx(Ui,{className:"w-3 h-3 flex-shrink-0"}),o.jsxs("span",{className:"whitespace-nowrap",children:[fo,"/",fs,ga?"":" pagos"]})]})})()]})]})]})})]})},er=()=>{p.useRef(Math.random().toString(36).slice(2)),jN();const ie=p.useRef(0),be=p.useRef(""),Ge=ge=>{if(!ge)return"";if(typeof ge=="string")return ge;const Le=ge.nome||ge.name||"",Ve=ge.codigo??ge.code;return Ve!=null?`[${Ve}] ${Le}`:Le},We=ge=>ge?typeof ge=="string"?ge:ge.nome||ge.name||"":"",_t=ge=>{const Le=Qt[ge];if(!Le)return{start:At*60,end:St*60};const[Ve,xt]=String(Le.hora_inicio||"06:00:00").split(":").map(Number),[Ct,_r]=String(Le.hora_fim||"24:00:00").split(":").map(Number),Kt=Ct===0&&_r===0?24:Ct;return{start:Ve*60+(xt||0),end:Kt*60+(_r||0)}},qe=()=>{const ge=cu(new Date),Le=du(new Date),Ve=ge*60+Le,xt=qr[0]||"",Ct=_t(xt);return Math.max(Ct.start,Math.min(Ct.end-ja,Math.round(Ve/ja)*ja))},[X,Me]=p.useState(()=>{let ge=[];try{const Ve=sessionStorage.getItem("agenda:customerPicker:closingAt"),xt=Ve?Number(Ve):0,Ct=xt&&Date.now()-xt<1e4,_r=sessionStorage.getItem(Rn),Kt=_r?JSON.parse(_r):[];if(Ct&&Array.isArray(Kt)&&Kt.length>0?ge=Kt:Array.isArray(ka)&&ka.length>0?ge=ka:Array.isArray(Lt.current)&&Lt.current.length>0&&(ge=Lt.current),ge.length>0)try{ir.current=!0}catch{}}catch{}return{selectedClients:ge,court:(()=>qr.find(xt=>!de[xt]||de[xt].funciona)||qr[0]||"")(),modality:zh[0],status:"scheduled",date:D,startMinutes:qe(),endMinutes:qe()+60}}),gt=p.useRef([]),ir=p.useRef(!1),Dr=p.useRef(null);p.useEffect(()=>{gt.current=Array.isArray(X.selectedClients)?X.selectedClients:[];try{(gt.current||[]).length>0&&(ir.current=!0)}catch{}},[X.selectedClients]);const[O,F]=p.useState(!1),[fe,we]=p.useState(""),[Re,Je]=p.useState(0),He=p.useRef(0),Et=p.useRef(!1);p.useEffect(()=>{const ge=()=>{try{if(document.visibilityState==="hidden"){Et.current=!!(Ae||O);const Le=Date.now();try{Se.current=Le+1200}catch{}try{je.current=Le+1200}catch{}try{He.current=Le+800}catch{}}else if(document.visibilityState==="visible"){const Le=Et.current;Et.current=!1;const Ve=Date.now();try{Se.current=Math.max(Se.current||0,Ve+600)}catch{}try{je.current=Math.max(je.current||0,Ve+600)}catch{}try{He.current=Math.max(He.current||0,Ve+400)}catch{}Le&&!rt.current&&setTimeout(()=>{rt.current||(F(!0),Tt(!0))},60)}}catch{}};return document.addEventListener("visibilitychange",ge),()=>document.removeEventListener("visibilitychange",ge)},[Ae,O,Q]),p.useEffect(()=>{},[O,Ae]);const Xt=p.useRef(0);p.useEffect(()=>{const ge=Array.isArray(X.selectedClients)?X.selectedClients.length:-1,Le=Xt.current;ge!==Le&&(Xt.current=ge)},[X.selectedClients,O,Ae]);const[jt,Rt]=p.useState(!1),[ar,pr]=p.useState(null),[Wr,Pr]=p.useState(!1),Vr=p.useRef(!1),Lt=p.useRef([]),xn=p.useRef("init"),Rn=p.useMemo(()=>{try{return`agenda:lastSelection:${k?.codigo_empresa||"no-company"}`}catch{return"agenda:lastSelection:no-company"}},[k?.codigo_empresa]),Ma=p.useCallback(ge=>{try{sessionStorage.setItem(Rn,JSON.stringify(ge||[]))}catch{}},[Rn]),xi=p.useCallback(()=>{try{const ge=sessionStorage.getItem(Rn);if(ge){const Le=JSON.parse(ge);Array.isArray(Le)&&(Lt.current=Le)}}catch{}},[Rn]),Xn=p.useRef(!1),[ka,ma]=p.useState([]),Ya=p.useCallback(ge=>{ma(ge)},[]),Oi=p.useRef(null),us=p.useRef(null),Xa=p.useRef([]);p.useEffect(()=>{Ae&&Xa.current[Re]&&Xa.current[Re]?.scrollIntoView({behavior:"smooth",block:"nearest"})},[Re,Ae]),p.useEffect(()=>{Ae&&Je(0)},[Ae]);const[Ro,Xi]=p.useState(!1),[fo,fs]=p.useState(!1);p.useState(!1);const[ga,Ji]=p.useState(!1),[Hs,Hu]=p.useState(!1),Ra=p.useRef(null),Gs=p.useRef(null),Ul=p.useRef(!1);p.useEffect(()=>{if(!a)return;let ge=!1;return(async()=>{try{if(!M||!k?.codigo_empresa)return;const Le=await Uv({somenteAtivas:!0,codigoEmpresa:k.codigo_empresa});ge||b(Array.isArray(Le)?Le:[])}catch{}})(),()=>{ge=!0}},[a,M,k?.codigo_empresa]),p.useEffect(()=>{if(!a||!Array.isArray(x)||x.length===0)return;const ge=String(x[0].id);v(Le=>Le.length===0&&Array.isArray(X.selectedClients)&&X.selectedClients.length>0?X.selectedClients.map(Ct=>({cliente_id:Ct.id,nome:Ct.nome,valor_cota:"",status_pagamento:"Pendente",finalizadora_id:ge})):Le.map(xt=>({...xt,finalizadora_id:xt.finalizadora_id&&xt.finalizadora_id!==""?xt.finalizadora_id:ge})))},[a,x]);const Ps=p.useCallback((ge,Le)=>{try{const Ve=Date.now(),xt=Ve<(Ft.current||0)||Ve<(je.current||0),Ct=!Ae,_r=!!Xn.current;let Kt=Array.isArray(Le)?Le:[];if(Kt.length===0&&Ct&&xt&&!_r){const lr=Array.isArray(Lt.current)?Lt.current:[];lr.length>0&&(Kt=lr)}try{if(!De&&Array.isArray(Kt)&&Kt.length>0&&Dr.current){const lr=Kt.findIndex(gn=>gn&&gn.id===Dr.current);lr>0&&(Kt=[Kt[lr],...Kt.filter((ea,$n)=>$n!==lr)])}}catch{}if(Me(lr=>({...lr,selectedClients:Kt})),Array.isArray(Kt)&&Kt.length>0){Lt.current=Kt,Ya(Kt);try{sessionStorage.setItem(Rn,JSON.stringify(Kt))}catch{}Xn.current=!1}try{xn.current=ge}catch{}}catch{}},[Ae,Me,Ya,Rn]);p.useState(""),p.useRef(null),p.useEffect(()=>{try{tr.current=Date.now()}catch{}},[O,fo]),p.useEffect(()=>{if(w){if(Ce.current=O,O)P("customer-picker",6e3),C("picker:open"),ae.current=!0,Tt(!0);else if(C("picker:close"),E("picker-close"),yl.current){yl.current=!1;try{j("Picker closed: flushing pending refresh"),C("picker:flush"),Sa()}catch{}}}},[O]);const Ii=p.useCallback((ge,Le={})=>{if(w)try{const Ve=new Date().toISOString(),xt=mt.current,Ct=!!ae.current,_r=!!Vr.current}catch{}},[w,Q,O,Ae,fo,jt]);p.useEffect(()=>{w&&Ii("state-change",{isCustomerPickerOpen:O,effectiveCustomerPickerOpen:Ae})},[w,O,Ae]),p.useEffect(()=>{if(!Q||Ae)return;const ge=Array.isArray(X.selectedClients)?X.selectedClients:[],Le=Array.isArray(Lt.current)?Lt.current:[],Ve=Date.now()<(Se.current||0);if(ge.length===0&&Le.length>0&&!Xn.current&&Ve)xn.current="global:restore",Me(xt=>({...xt,selectedClients:Le}));else if(ge.length===0&&Le.length>0&&Xn.current&&!Ve)try{Lt.current=[]}catch{}},[Q,Ae,X.selectedClients]),p.useEffect(()=>{if(!Q)return;let ge=ae.current;try{const Ve=localStorage.getItem("agenda:customerPicker:desiredAt");if(Ve){const xt=Number(Ve);Number.isFinite(xt)&&Date.now()-xt<3e3&&(ge=!0)}}catch{}if(!ge||O||Date.now()<je.current||et())return;const Le=Date.now();Le-$e.current<800||($e.current=Le,mt.current="open",F(!0),Tt(!0))},[O,Q]),p.useEffect(()=>{const ge=Array.isArray(X.selectedClients)?X.selectedClients:[];ge.length>0&&(Lt.current=ge,Ma(ge),Ya(ge))},[X.selectedClients,Ma]),p.useEffect(()=>{if(!Q||(xi(),Ae)||ae.current)return;const ge=Array.isArray(X.selectedClients)?X.selectedClients:[],Le=(()=>{const Ve=Array.isArray(Lt.current)?Lt.current:[];if(Ve&&Ve.length>0)return Ve;try{const xt=sessionStorage.getItem(Rn),Ct=xt?JSON.parse(xt):[];return Array.isArray(Ct)?Ct:[]}catch{return[]}})();ge.length===0&&Le.length>0&&!Xn.current&&(Me(Ve=>({...Ve,selectedClients:Le})),Vr.current=!1)},[Ae,Q,xi,Rn]);const iu=p.useRef(0);p.useEffect(()=>{try{const ge=Date.now(),Le=Array.isArray(gt.current)?gt.current:[],Ve=Array.isArray(Lt.current)?Lt.current:[];if(ge-iu.current>300&&(iu.current=ge),Q&&!Ae&&Le.length===0&&Ve.length>0&&!Xn.current){try{Ft.current=Date.now()+2e3}catch{}try{const xt=je?.current||0,Ct={ts:new Date().toISOString(),reason:"empty-after-close",modalOpen:Q,pickerOpen:Ae,formLen:Array.isArray(X?.selectedClients)?X.selectedClients.length:NaN,curLen:Le.length,lastLen:Ve.length,clearedByUser:!!Xn?.current,lastAction:xn?.current,chipsLen:Array.isArray(ka)?ka.length:NaN,clientsLoading:!!fo,suppressUntil:xt}}catch{}Ya(Ve);try{sessionStorage.setItem(Rn,JSON.stringify(Ve))}catch{}Me(xt=>({...xt,selectedClients:[...Ve]}));try{Promise.resolve().then(()=>{Me(xt=>({...xt,selectedClients:[...Lt.current]}))})}catch{}try{requestAnimationFrame(()=>{Me(xt=>({...xt,selectedClients:[...Lt.current||[]]}))})}catch{}setTimeout(()=>{const xt=Array.isArray(gt.current)?gt.current:[],Ct=Array.isArray(Lt.current)?Lt.current:[];xt.length===0&&Ct.length>0&&Me(_r=>({..._r,selectedClients:[...Ct]}))},25),setTimeout(()=>{const xt=Array.isArray(gt.current)?gt.current:[],Ct=Array.isArray(Lt.current)?Lt.current:[];xt.length===0&&Ct.length>0&&Me(_r=>({..._r,selectedClients:[...Ct]}))},120),setTimeout(()=>{const xt=Array.isArray(gt.current)?gt.current:[],Ct=Array.isArray(Lt.current)?Lt.current:[];xt.length===0&&Ct.length>0&&Me(_r=>({..._r,selectedClients:[...Ct]}))},240)}}catch{}},[X.selectedClients,Ae,Q]),p.useEffect(()=>{try{const ge=now<(Ft.current||0),Le=Array.isArray(gt.current)?gt.current:[],Ve=Array.isArray(Lt.current)?Lt.current:[],xt=now<(Se.current||0);if(Q&&!Ae&&(ge||xt)&&Le.length===0&&Ve.length>0&&!Xn.current){ma(Ve);try{sessionStorage.setItem(Rn,JSON.stringify(Ve))}catch{}Me(Ct=>({...Ct,selectedClients:[...Ve]}));try{requestAnimationFrame(()=>Me(Ct=>({...Ct,selectedClients:[...Lt.current||[]]})))}catch{}setTimeout(()=>Me(Ct=>({...Ct,selectedClients:[...Lt.current||[]]})),32),setTimeout(()=>Me(Ct=>({...Ct,selectedClients:[...Lt.current||[]]})),96)}}catch{}},[X.selectedClients,Ae,Q]),p.useEffect(()=>{const ge=Date.now();if(ge<(pt.current||0)||!Q||Ae||ge>=(Se.current||0))return;const Le=Array.isArray(X.selectedClients)?X.selectedClients:[],Ve=Array.isArray(Lt.current)?Lt.current:[];if(Le.length===0&&Ve.length>0){ma(Ve);try{sessionStorage.setItem(Rn,JSON.stringify(Ve))}catch{}Me(xt=>({...xt,selectedClients:[...Ve]})),Promise.resolve().then(()=>Me(xt=>({...xt,selectedClients:[...Lt.current||[]]}))),setTimeout(()=>Me(xt=>({...xt,selectedClients:[...Lt.current||[]]})),24),setTimeout(()=>Me(xt=>({...xt,selectedClients:[...Lt.current||[]]})),80),setTimeout(()=>Me(xt=>({...xt,selectedClients:[...Lt.current||[]]})),240)}},[X.selectedClients,Q,Ae]);const[bl,Ks]=p.useState([]);p.useEffect(()=>{a&&Ks([])},[a]);const yi=p.useRef(!1),Xo=p.useRef(!1),[su,kc]=p.useState(null);p.useState(null);const Oc=p.useRef(!1);p.useEffect(()=>{const ge=Array.isArray(X.selectedClients)?X.selectedClients:[],Le=su,Ve=Le&&ge.some(xt=>xt&&xt.id===Le);ge.length>0&&!Ve?kc(ge[0]?.id||null):ge.length===0&&Le&&kc(null)},[X.selectedClients,Q,De]);const co=p.useRef(!1),Vl=p.useRef(!1),[vo,As]=p.useState(dn),Gu=p.useRef(0);p.useEffect(()=>{if(!(Date.now()<(pt.current||0)))if(fo){Gu.current||(Gu.current=Date.now());const Le=setTimeout(()=>{fo&&(!Array.isArray(vo)||vo.length===0)&&fs(!1)},2e3);return()=>clearTimeout(Le)}else Gu.current=0},[fo,vo]);const Ic=p.useMemo(()=>Array.isArray(X.selectedClients)?X.selectedClients:[],[X.selectedClients]),Ih=p.useMemo(()=>{const ge=Ic||[];if(ge.length===0)return"Adicionar clientes";const Le=ge[0]?.nome||"Cliente",Ve=ge.length-1;return Ve>0?`${Le} +${Ve}`:Le},[Ic]),Wf=p.useMemo(()=>{const ge=Array.isArray(X.selectedClients)?X.selectedClients:[],Le=Array.isArray(gt.current)?gt.current:[],Ve=Array.isArray(Lt.current)?Lt.current:[],xt=Array.isArray(ka)?ka:[];return ge.length>0&&ge.every(Ct=>Ct?.nome)?ge:ge.length>0?ge.map(Ct=>{if(Ct?.nome)return Ct;const _r=Le.find(ea=>ea?.id===Ct?.id),Kt=Ve.find(ea=>ea?.id===Ct?.id),lr=xt.find(ea=>ea?.id===Ct?.id),gn=(vo||[]).find(ea=>ea?.id===Ct?.id);return{...Ct,nome:_r?.nome||Kt?.nome||lr?.nome||gn?.nome||Ct?.nome||"Cliente"}}):Le.length>0&&Le.every(Ct=>Ct?.nome)?Le:xt.length>0&&xt.every(Ct=>Ct?.nome)?xt:Ve.length>0&&Ve.every(Ct=>Ct?.nome)?Ve:ge},[X.selectedClients,ka,vo]);p.useEffect(()=>{if(!(Date.now()<(pt.current||0)))try{j("Chips:effective change",{effectiveLen:Array.isArray(Ic)?Ic.length:0,formLen:Array.isArray(X.selectedClients)?X.selectedClients.length:0,lastLen:Array.isArray(Lt.current)?Lt.current.length:0,pickerOpen:O})}catch{}},[Ic,X.selectedClients,O]);const Tc=p.useRef(null),Dc=p.useRef(!1);p.useEffect(()=>{if(Q){Array.isArray(dn)&&dn.length>0&&As(dn);try{if(!vo||vo.length===0){const ge=k?.codigo_empresa?`clientes:list:${k.codigo_empresa}`:null;if(ge){const Le=JSON.parse(localStorage.getItem(ge)||"[]");Array.isArray(Le)&&Le.length>0&&As(Le)}}}catch{}}},[Q,dn]),p.useEffect(()=>{Q||(Tc.current=null,fs(!1))},[Q]),p.useEffect(()=>{Q||(yi.current=!1,Xo.current=!1,Ji(!1),Vl.current=!1)},[Q]);const Mc=p.useRef(!1);p.useEffect(()=>{if(Q&&!Mc.current){Mc.current=!0;try{const ge=sessionStorage.getItem("agenda:customerPicker:sessionId")||"",Le=sessionStorage.getItem("agenda:customerPicker:closingAt"),Ve=Le?Number(Le):0,xt=Ve&&Date.now()-Ve<1e4;ge&&xt?be.current=ge:be.current||(be.current=`${Date.now()}-${Math.random().toString(36).slice(2)}`),sessionStorage.setItem("agenda:modal:sessionId",be.current)}catch{}if(!De){try{const ge=sessionStorage.getItem("agenda:customerPicker:closingAt"),Le=ge?Number(ge):0,Ve=Le&&Date.now()-Le<1e4,xt=sessionStorage.getItem("agenda:customerPicker:sessionId")||"",Ct=sessionStorage.getItem("agenda:modal:sessionId")||"",_r=sessionStorage.getItem(Rn),Kt=_r?JSON.parse(_r):[];if(Ve&&Array.isArray(Kt)&&Kt.length>0&&xt&&Ct&&xt===Ct){try{ir.current=!0}catch{}Me(lr=>({...lr,selectedClients:Kt})),Lt.current=Kt,Ya(Kt);try{Xn.current=!1}catch{}try{Promise.resolve().then(()=>Me(lr=>({...lr,selectedClients:[...Lt.current||[]]})))}catch{}try{requestAnimationFrame(()=>Me(lr=>({...lr,selectedClients:[...Lt.current||[]]})))}catch{}setTimeout(()=>Me(lr=>({...lr,selectedClients:[...Lt.current||[]]})),24),setTimeout(()=>Me(lr=>({...lr,selectedClients:[...Lt.current||[]]})),96);return}if(Ve&&Array.isArray(Kt)&&Kt.length>0){try{ir.current=!0}catch{}Me(lr=>({...lr,selectedClients:Kt})),Lt.current=Kt,Ya(Kt);try{Xn.current=!1}catch{}try{Promise.resolve().then(()=>Me(lr=>({...lr,selectedClients:[...Lt.current||[]]})))}catch{}try{requestAnimationFrame(()=>Me(lr=>({...lr,selectedClients:[...Lt.current||[]]})))}catch{}setTimeout(()=>Me(lr=>({...lr,selectedClients:[...Lt.current||[]]})),24),setTimeout(()=>Me(lr=>({...lr,selectedClients:[...Lt.current||[]]})),96);return}}catch{}try{if(Date.now()<(ie.current||0))return}catch{}try{ae.current=!1,localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{const ge=sessionStorage.getItem(Rn),Le=ge?JSON.parse(ge):[],Ve=Array.isArray(Lt.current)?Lt.current:[];if(!(Array.isArray(Le)&&Le.length>0||Array.isArray(Ve)&&Ve.length>0)){try{Lt.current=[]}catch{}try{ma([])}catch{}try{Xn.current=!1}catch{}Me(xt=>({...xt,selectedClients:[]}))}}catch{try{Lt.current=[]}catch{}try{ma([])}catch{}try{Xn.current=!1}catch{}Me(ge=>({...ge,selectedClients:[]}))}}}else!Q&&Mc.current;if(De)Ys.current=!1;else{if(Ys.current)return;Ys.current=!0;try{const ge=sessionStorage.getItem("agenda:customerPicker:closingAt"),Le=ge?Number(ge):0,Ve=Le&&Date.now()-Le<5e3,xt=sessionStorage.getItem("agenda:customerPicker:sessionId")||"",Ct=sessionStorage.getItem("agenda:modal:sessionId")||"",_r=sessionStorage.getItem(Rn),Kt=_r?JSON.parse(_r):[];if(Ve&&Array.isArray(Kt)&&Kt.length>0&&xt&&Ct&&xt===Ct){try{ir.current=!0}catch{}Me(lr=>({...lr,selectedClients:Kt})),Lt.current=Kt,Ya(Kt);try{Xn.current=!1}catch{}try{Promise.resolve().then(()=>Me(lr=>({...lr,selectedClients:[...Lt.current||[]]})))}catch{}try{requestAnimationFrame(()=>Me(lr=>({...lr,selectedClients:[...Lt.current||[]]})))}catch{}setTimeout(()=>Me(lr=>({...lr,selectedClients:[...Lt.current||[]]})),24),setTimeout(()=>Me(lr=>({...lr,selectedClients:[...Lt.current||[]]})),96);return}if(Ve&&Array.isArray(Kt)&&Kt.length>0){try{ir.current=!0}catch{}Me(lr=>({...lr,selectedClients:Kt})),Lt.current=Kt,Ya(Kt);try{Xn.current=!1}catch{}try{Promise.resolve().then(()=>Me(lr=>({...lr,selectedClients:[...Lt.current||[]]})))}catch{}try{requestAnimationFrame(()=>Me(lr=>({...lr,selectedClients:[...Lt.current||[]]})))}catch{}setTimeout(()=>Me(lr=>({...lr,selectedClients:[...Lt.current||[]]})),24),setTimeout(()=>Me(lr=>({...lr,selectedClients:[...Lt.current||[]]})),96);return}}catch{}try{if(Date.now()<(ie.current||0))return}catch{}try{ae.current=!1,localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{Xn.current=!1}catch{}try{const ge=sessionStorage.getItem(Rn),Le=ge?JSON.parse(ge):[],Ve=Array.isArray(Lt.current)?Lt.current:[];if(!(Array.isArray(Le)&&Le.length>0||Array.isArray(Ve)&&Ve.length>0)){try{Lt.current=[]}catch{}try{ma([])}catch{}Me(xt=>({...xt,selectedClients:[]}))}}catch{try{Lt.current=[]}catch{}try{ma([])}catch{}Me(ge=>({...ge,selectedClients:[]}))}}},[Q,De]);const Ys=p.useRef(!1);p.useEffect(()=>{if(!Q){Ys.current=!1;try{sessionStorage.removeItem("agenda:customerPicker:closing"),sessionStorage.removeItem("agenda:customerPicker:closingAt"),sessionStorage.removeItem("agenda:customerPicker:sessionId"),sessionStorage.removeItem("agenda:modal:sessionId"),be.current="",sessionStorage.removeItem(Rn);try{Lt.current=[]}catch{}try{ma([])}catch{}try{ir.current=!1}catch{}try{ie.current=0}catch{}try{Se.current=0}catch{}me(!1),Be(4);try{je.current=0}catch{}try{mt.current=null}catch{}try{ae.current=!1}catch{}Me(ge=>({...ge,selectedClients:[]})),kc(null)}catch{}return}if(De)Ys.current=!1;else{if(Ys.current)return;Ys.current=!0;try{if(Date.now()<(ie.current||0))return}catch{}try{ae.current=!1,localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{Xn.current=!1}catch{}try{const ge=sessionStorage.getItem(Rn),Le=ge?JSON.parse(ge):[],Ve=Array.isArray(Lt.current)?Lt.current:[];if(!(Array.isArray(Le)&&Le.length>0||Array.isArray(Ve)&&Ve.length>0)){try{Lt.current=[]}catch{}try{ma([])}catch{}Me(xt=>({...xt,selectedClients:[]}))}}catch{try{Lt.current=[]}catch{}try{ma([])}catch{}Me(ge=>({...ge,selectedClients:[]}))}}},[Q,De]);const Jo=p.useCallback(async(ge={})=>{const{autoSave:Le=!1}=ge;if(!ga){Ji(!0);try{const Ve=Qt[X.court];if(!Ve){t({title:"Selecione uma quadra",variant:"destructive"}),yi.current=!1,Xo.current=!1;return}const xt=X.startMinutes,Ct=X.endMinutes;if(!(Number.isFinite(xt)&&Number.isFinite(Ct)&&Ct>xt)){t({title:"Horrio invlido",variant:"destructive"}),yi.current=!1,Xo.current=!1;return}if(!ca(xt,Ct)){t({title:"Conflito de horrio",description:"O horrio selecionado est ocupado.",variant:"destructive"}),yi.current=!1,Xo.current=!1;return}const Kt=(Dn,pa)=>new Date(Dn.getFullYear(),Dn.getMonth(),Dn.getDate(),Math.floor(pa/60),pa%60,0,0),lr=Kt(X.date,xt),gn=Kt(X.date,Ct);let ea=Array.isArray(X.selectedClients)&&X.selectedClients.length>0?X.selectedClients:Array.isArray(gt.current)?gt.current:[];if((!ea||ea.length===0)&&De?.id)try{const Dn=Array.isArray(Lt.current)?Lt.current:[];Dn&&Dn.length>0&&(ea=Dn,Me(pa=>({...pa,selectedClients:Dn})))}catch{}const $n=[...ea];console.log(" [FIX] selNowSnapshot criado:",$n.length,"participantes"),console.log(" [FIX] form.selectedClients:",X.selectedClients?.length||0),console.log(" [FIX] editingBooking.id:",De?.id),console.log(" [LOG 3 - FECHAR MODAL AGENDAMENTO] Estado ao salvar:"),console.log("   Participantes selecionados:",$n.length),$n.forEach((Dn,pa)=>{console.log(`   #${pa+1}: ${Dn.nome}`)}),console.log("   participantsForm (contexto):",(h||[]).length),(h||[]).forEach((Dn,pa)=>{console.log(`   #${pa+1}: ${Dn.nome} | Status: ${Dn.status_pagamento} | Valor: ${Dn.valor_cota}`)});let tn=$n,Ha=!1;if(De?.id){const Dn=$n.map(Qa=>Qa.nome).sort().join("|");let pa="";const Es=ft[De.id]||[];if(Es.length>0&&(pa=Es.map(Qa=>Qa.nome).sort().join("|")),Ha=Dn!==pa,console.log(" [DEBUG] Comparao de nomes:"),console.log("   nomesAtuais:",Dn),console.log("   nomesOriginais:",pa),console.log("   editingBooking.clientes:",De.clientes),console.log("   houveMudancaDeParticipantes:",Ha),!Ha){let Qa=[];if(De.clientes)try{Qa=Array.isArray(De.clientes)?De.clientes:JSON.parse(De.clientes)}catch{Qa=(ft[De.id]||[]).map(Za=>Za.nome)}else Qa=(ft[De.id]||[]).map(Za=>Za.nome);Qa.length>0&&(tn=[...ea].sort((Ti,Za)=>{const Lo=Qa.findIndex(Di=>Di===Ti.nome),hs=Qa.findIndex(Di=>Di===Za.nome);return Lo!==-1&&hs!==-1?Lo-hs:Lo!==-1?-1:hs!==-1?1:0}))}}const La=tn[0],ha=tn.map(We).filter(Boolean);if(!De?.id&&!La?.id){t({title:"Selecione um cliente",description:"Para criar um agendamento, selecione pelo menos um cliente.",variant:"destructive"});return}if(De?.id){const Dn=De.status,pa=X.status!==Dn,Es={quadra_id:Ve.id,cliente_id:La?.id??null,clientes:ha,inicio:lr.toISOString(),fim:gn.toISOString(),modalidade:X.modality};if(!pa){let da=X.status;try{const li=vt(),Co=lr.getTime();if(!!Ze?.autoConfirmEnabled&&Number.isFinite(Number(Ze?.autoConfirmMinutesBefore))){const Xs=Number(Ze.autoConfirmMinutesBefore)*6e4,yd=Co-Xs;da==="confirmed"&&li<yd?da="scheduled":da==="scheduled"&&li>=yd&&(da="confirmed")}}catch{}Es.status=da}const{error:Qa}=await ve.from("agendamentos").update(Es).eq("codigo_empresa",k.codigo_empresa).eq("id",De.id);if(Qa)throw Qa;const{data:Ti}=await ve.from("agendamento_participantes").select("*").eq("codigo_empresa",k.codigo_empresa).eq("agendamento_id",De.id).order("ordem",{ascending:!0}).order("id",{ascending:!0}),Za=Ti||[];if(console.log(" [SAVE-BOOKING] houveMudancaDeParticipantes:",Ha),console.log(" [SAVE-BOOKING] currentArray.length:",Za.length),console.log(" [SAVE-BOOKING] selNowFinal.length:",tn.length),Ha){if(!tn||tn.length===0)console.error(" [SAVE-BOOKING] PROTEO ACIONADA: No vou deletar participantes com selNowFinal vazio!"),console.error(" [SAVE-BOOKING] Isso evita perda de dados. Verifique por que selNowFinal est vazio.");else{console.log(" [SAVE-BOOKING] Deletando e recriando participantes...");const{error:da}=await ve.from("agendamento_participantes").delete().eq("codigo_empresa",k.codigo_empresa).eq("agendamento_id",De.id);da&&console.error("Erro ao deletar participantes:",da)}if(tn&&tn.length>0){const da=tn.map((Co,Qi)=>{const Xs=Za[Qi],yd=Xs&&Xs.cliente_id===Co.id;return{codigo_empresa:k.codigo_empresa,agendamento_id:De.id,cliente_id:Co.id,nome:Co.nome,ordem:Qi+1,valor_cota:yd?Xs.valor_cota??0:0,status_pagamento:yd?Xs.status_pagamento??"Pendente":"Pendente",finalizadora_id:yd?Xs.finalizadora_id??null:null,aplicar_taxa:yd?Xs.aplicar_taxa??!1:!1,pago_em:yd?Xs.pago_em??null:null}}),{error:li}=await ve.from("agendamento_participantes").insert(da);li&&console.error("Erro ao inserir participantes:",li)}}const Lo=La?.nome||La?.name||We(La)||ha[0]||De.customer,hs={...De,court:X.court,customer:Lo,start:lr,end:gn,modality:X.modality,...pa?{}:{status:Es.status??X.status}};if(K(da=>da.map(li=>li.id===De.id?hs:li)),st(hs),pa)try{re(!1),await jn(De.id,X.status,"user")}catch{}Le||t({title:"Agendamento atualizado"}),Xo.current=!0,yi.current=!1;const Di=ea.map((da,li)=>{const Co=Za.find(Xs=>Xs.cliente_id===da.id),Qi=!!Co;return{cliente_id:da.id,nome:da.nome,codigo:da.codigo||null,valor_cota:Qi?Co.valor_cota??0:0,status_pagamento:Qi?Co.status_pagamento??"Pendente":"Pendente",finalizadora_id:Qi?Co.finalizadora_id??null:null,aplicar_taxa:Qi?Co.aplicar_taxa??!1:!1,ordem:li+1}});if(yt(da=>({...da,[De.id]:Di})),console.log(" [FIX] houveMudancaDeParticipantes =",Ha),Ha?(console.log(" [FIX] Mudana de participantes detectada - reconstruindo participantsForm"),v(Di.map(da=>({cliente_id:da.cliente_id,nome:da.nome,codigo:da.codigo,valor_cota:da.valor_cota?Gg(String(Number(da.valor_cota).toFixed(2))):"",status_pagamento:da.status_pagamento,finalizadora_id:da.finalizadora_id?String(da.finalizadora_id):x?.[0]?.id?String(x[0].id):null,aplicar_taxa:da.aplicar_taxa})))):(console.log(" [FIX] Sem mudana de participantes - preservando dados de pagamento do contexto"),v(da=>{const li=(da||[]).map(Co=>{const Qi=Di.find(Xs=>Xs.cliente_id===Co.cliente_id);return Qi?{cliente_id:Co.cliente_id,nome:Co.nome||Qi.nome,codigo:Co.codigo??Qi.codigo,valor_cota:Co.valor_cota||Qi.valor_cota,status_pagamento:Co.status_pagamento||Qi.status_pagamento,finalizadora_id:Co.finalizadora_id??Qi.finalizadora_id,aplicar_taxa:Co.aplicar_taxa??Qi.aplicar_taxa}:Co});return console.log(" [FIX] Dados de pagamento preservados:",li),li.length>0?li:Di})),console.log(" [LOG 3 - RESULTADO FINAL] participantsForm aps atualizao:"),console.log("   Total:",Di.length),Di.forEach((da,li)=>{console.log(`   #${li+1}: ${da.nome} | Status: ${da.status_pagamento} | Valor: ${da.valor_cota}`)}),r().catch(da=>{console.error("[AgendaPage] Erro ao recarregar alertas:",da)}),!Le){try{Lt.current=[]}catch{}try{ma([])}catch{}try{sessionStorage.removeItem(Rn)}catch{}re(!1)}return}let $a=null;try{const{data:Dn}=await ve.from("agendamentos").select("id, status, codigo").eq("codigo_empresa",k.codigo_empresa).eq("quadra_id",Ve.id).eq("inicio",lr.toISOString()).eq("fim",gn.toISOString()).limit(1);Array.isArray(Dn)&&Dn.length>0&&($a=Dn[0])}catch{}if($a?.id&&$a.status!=="canceled"){const Dn={id:$a.id,code:$a.codigo,court:X.court,customer:La?.nome||ha[0]||"",start:lr,end:gn,status:X.status,modality:X.modality};K(pa=>pa.some(Qa=>Qa.id===$a.id)?pa:[...pa,Dn]),t({title:"Agendamento confirmado"}),Xo.current=!0,re(!1);return}if(G&&pe>1){const Dn=[],pa=[];for(let Za=0;Za<pe;Za++){const Lo=Ia(X.date,Za*7),hs=new Date(Lo);hs.setHours(Math.floor(X.startMinutes/60),X.startMinutes%60,0,0);const Di=new Date(Lo);Di.setHours(Math.floor(X.endMinutes/60),X.endMinutes%60,0,0),Dn.push({codigo_empresa:k.codigo_empresa,quadra_id:Ve.id,cliente_id:La?.id??null,clientes:ha,inicio:hs.toISOString(),fim:Di.toISOString(),modalidade:X.modality,status:X.status})}const{data:Es,error:Qa}=await ve.from("agendamentos").insert(Dn).select("id, codigo, inicio, fim");if(Qa)throw Qa;const Ti=[];for(const Za of Es){const Lo=tn.map((hs,Di)=>({codigo_empresa:k.codigo_empresa,agendamento_id:Za.id,cliente_id:hs.id,nome:hs.nome,valor_cota:0,status_pagamento:"Pendente",ordem:Di+1}));Ti.push(...Lo),pa.push({id:Za.id,code:Za.codigo,court:X.court,customer:La?.nome||ha[0]||"",start:new Date(Za.inicio),end:new Date(Za.fim),status:X.status,modality:X.modality})}Ti.length>0&&await ve.from("agendamento_participantes").insert(Ti),K(Za=>[...Za,...pa]),t({title:`${pe} Agendamentos criados!`,description:"Agendamentos recorrentes criados com sucesso.",variant:"success"}),me(!1),Be(4)}else{const{data:Dn,error:pa}=await ve.from("agendamentos").insert({codigo_empresa:k.codigo_empresa,quadra_id:Ve.id,cliente_id:La?.id??null,clientes:ha,inicio:lr.toISOString(),fim:gn.toISOString(),modalidade:X.modality,status:X.status}).select("id, codigo").single();if(pa)throw pa;const Es={id:Dn.id,code:Dn.codigo,court:X.court,customer:La?.nome||ha[0]||"",start:lr,end:gn,status:X.status,modality:X.modality};K(Qa=>[...Qa,Es]),t({title:"Agendamento criado",variant:"success",duration:2e3}),r().catch(Qa=>{console.error("[AgendaPage] Erro ao recarregar alertas:",Qa)});try{const Qa=tn.map((Ti,Za)=>({codigo_empresa:k.codigo_empresa,agendamento_id:Dn.id,cliente_id:Ti.id,nome:Ti.nome,valor_cota:0,status_pagamento:"Pendente",ordem:Za+1}));if(Qa.length>0){const{error:Ti}=await ve.from("agendamento_participantes").insert(Qa);if(!Ti){const Za=Qa.map(Lo=>({agendamento_id:Lo.agendamento_id,cliente_id:Lo.cliente_id,nome:Lo.nome,codigo:tn.find(hs=>hs.id===Lo.cliente_id)?.codigo||null,valor_cota:Lo.valor_cota,status_pagamento:Lo.status_pagamento,ordem:Lo.ordem}));yt(Lo=>({...Lo,[Dn.id]:Za}))}}}catch{}}Xo.current=!0,yi.current=!1;try{Lt.current=[]}catch{}try{ma([])}catch{}try{sessionStorage.removeItem(Rn)}catch{}re(!1)}catch(Ve){t({title:"Erro ao salvar agendamento",description:Ve?.message||"Tentando novamente automaticamente",variant:"destructive"})}finally{Ji(!1)}}},[ga,Qt,X,De,k,ca,K,t,re,jn]);p.useEffect(()=>{if(!De?.id){Ul.current=!1,Gs.current=null;return}if(!Vl.current||!Ul.current){const Le=setTimeout(()=>{Vl.current&&(Ul.current=!0,Gs.current=JSON.stringify({court:X.court,startMinutes:X.startMinutes,endMinutes:X.endMinutes,modality:X.modality,status:X.status,selectedClients:X.selectedClients}))},500);return()=>clearTimeout(Le)}const ge=JSON.stringify({court:X.court,startMinutes:X.startMinutes,endMinutes:X.endMinutes,modality:X.modality,status:X.status,selectedClients:X.selectedClients});if(ge!==Gs.current)return Ra.current&&clearTimeout(Ra.current),Ra.current=setTimeout(async()=>{if(!Qt[X.court])return;const Ve=X.startMinutes,xt=X.endMinutes;if(!(Number.isFinite(Ve)&&Number.isFinite(xt)&&xt>Ve)||!ca(Ve,xt))return;const _r=Gs.current?JSON.parse(Gs.current).selectedClients:[],Kt=X.selectedClients||[],lr=JSON.stringify(_r)!==JSON.stringify(Kt);console.log(lr?" [Auto-save] Salvando alteraes (participantes modificados)...":" [Auto-save] Salvando alteraes..."),Hu(!0);try{await Jo({autoSave:!0}),Gs.current=ge,console.log(lr?" [Auto-save] Participantes salvos no banco! Disponveis no modal de pagamentos.":" [Auto-save] Salvo com sucesso!")}catch(gn){console.error(" [Auto-save] Erro ao salvar:",gn)}finally{Hu(!1)}},1500),()=>{Ra.current&&clearTimeout(Ra.current)}},[De?.id,X.court,X.startMinutes,X.endMinutes,X.modality,X.status,X.selectedClients,Qt,ca,Jo]),p.useEffect(()=>{const ge=async()=>{if(!Q||!k?.codigo_empresa)return;const Le=String(k.codigo_empresa);if(Tc.current!==Le)try{fs(!0);try{const Ct=`clientes:list:${k.codigo_empresa}`,_r=JSON.parse(localStorage.getItem(Ct)||"[]");if(Array.isArray(_r)&&_r.length>0){As(_r);try{wn(Kt=>JSON.stringify(Kt)===JSON.stringify(_r)?Kt:_r)}catch{}}}catch{}const{data:Ve,error:xt}=await ve.from("clientes").select("id, nome, codigo, email, telefone, status, codigo_empresa, is_consumidor_final").eq("codigo_empresa",k.codigo_empresa).eq("status","active").eq("flag_cliente",!0).order("nome",{ascending:!0});if(xt){console.error("Falha ao carregar clientes:",xt);return}if(Array.isArray(Ve)){if(Ve.length===0){let Ct=0;try{const _r=`clientes:list:${k.codigo_empresa}`,Kt=JSON.parse(localStorage.getItem(_r)||"[]");Ct=Array.isArray(Kt)?Kt.length:0}catch{}if(Ct>0&&!Dc.current){Dc.current=!0,setTimeout(ge,700);return}}Dc.current=!1,Tc.current=Le,As(Ve);try{const Ct=`clientes:list:${k.codigo_empresa}`;localStorage.setItem(Ct,JSON.stringify(Ve))}catch{}try{wn(Ct=>JSON.stringify(Ct)===JSON.stringify(Ve)?Ct:Ve)}catch{}}}catch{}finally{fs(!1)}};ge()},[Q,k?.codigo_empresa]),p.useEffect(()=>{const ge=Qt[X.court];if(!ge)return;const Le=Number(ge.valor||0);if(!Number.isFinite(Le)||Le<=0)return;const Ve=Math.max(0,X.endMinutes-X.startMinutes);if(Ve<=0)return;const xt=Ve/ja,Ct=Math.round(Le*xt*100)/100;y(Gg(String(Ct.toFixed(2))))},[Qt,X.court,X.startMinutes,X.endMinutes]),p.useEffect(()=>{if(Q&&!Vl.current)if(De){const ge=cu(De.start)*60+du(De.start),Le=cu(De.end)*60+du(De.end),Ve=ft[De.id]||[],xt=Ve.filter(Kt=>Kt&&Kt.cliente_id).map(Kt=>({id:Kt.cliente_id,nome:Kt.nome,codigo:Kt.codigo||null})),Ct=Qt[De.court]?.modalidades||zh,_r=Ct.includes(De.modality)?De.modality:Ct[0]||"";Me({selectedClients:xt,court:De.court,modality:_r,status:De.status,date:ni(De.start),startMinutes:ge,endMinutes:Le}),co.current=!0,v(Ve.map(Kt=>({cliente_id:Kt.cliente_id,nome:Kt.nome,codigo:Kt.codigo,valor_cota:(()=>{const lr=Number.isFinite(Number(Kt.valor_cota))?Number(Kt.valor_cota):rf(Kt.valor_cota);return Gg(String((Number.isFinite(lr)?lr:0).toFixed(2)))})(),status_pagamento:Kt.status_pagamento||"Pendente",finalizadora_id:Kt.finalizadora_id?String(Kt.finalizadora_id):null,aplicar_taxa:Kt.aplicar_taxa||!1}))),kc(xt[0]?.id||null),(async()=>{try{const{data:Kt,error:lr}=await ve.from("agendamento_participantes").select("cliente_id, nome, valor_cota, status_pagamento, finalizadora_id, aplicar_taxa, cliente:clientes!agendamento_participantes_cliente_id_fkey ( nome, codigo )").eq("codigo_empresa",k.codigo_empresa).eq("agendamento_id",De.id).order("ordem",{ascending:!0}).order("id",{ascending:!0});if(!lr&&Array.isArray(Kt)){const gn=(X?.selectedClients||[]).slice();let ea=Kt.slice();if(gn.length>0){const tn=new Map;Kt.forEach(ha=>{const $a=tn.get(ha.cliente_id)||[];$a.push(ha),tn.set(ha.cliente_id,$a)});const Ha=new Map,La=[];for(const ha of gn){const $a=Ha.get(ha.id)||0,pa=(tn.get(ha.id)||[])[$a];pa&&(La.push(pa),Ha.set(ha.id,$a+1))}La.length===gn.length&&(ea=La)}else if(Array.isArray(De?.clientes)&&De.clientes.length>0){const tn=new Map;Kt.forEach(ha=>{const $a=ha.nome||ha.cliente?.nome||"",Dn=tn.get($a)||[];Dn.push(ha),tn.set($a,Dn)});const Ha=new Map,La=[];for(const ha of De.clientes){const $a=Ha.get(ha)||0,pa=(tn.get(ha)||[])[$a];pa&&(La.push(pa),Ha.set(ha,$a+1))}La.length===Kt.length&&(ea=La)}try{const tn=ea.findIndex(Ha=>String(Ha?.nome||"").toLowerCase()!=="cliente consumidor");if(tn>0){const Ha=ea.splice(tn,1)[0];ea.unshift(Ha)}}catch{}const $n=ea.filter(tn=>tn&&tn.cliente_id).map(tn=>({id:tn.cliente_id,nome:tn.nome||tn.cliente?.nome||"",codigo:tn.cliente?.codigo||null}));Me(tn=>({...tn,selectedClients:$n})),v(ea.map(tn=>({cliente_id:tn.cliente_id,nome:tn.nome||tn.cliente?.nome||"",codigo:tn.cliente?.codigo||null,valor_cota:(()=>{const Ha=Number.isFinite(Number(tn.valor_cota))?Number(tn.valor_cota):rf(tn.valor_cota);return Gg(String((Number.isFinite(Ha)?Ha:0).toFixed(2)))})(),status_pagamento:tn.status_pagamento||"Pendente",finalizadora_id:tn.finalizadora_id?String(tn.finalizadora_id):null,aplicar_taxa:tn.aplicar_taxa||!1}))),kc($n[0]?.id||null)}}catch(Kt){console.error("Falha ao carregar participantes (refresh)",Kt)}})(),Vl.current=!0,Gs.current=JSON.stringify({court:De.court,startMinutes:ge,endMinutes:Le,modality:_r,status:De.status,selectedClients:xt})}else if(Aa){const ge=(qr||[]).includes(Aa.court)?Aa.court:(qr||[])[0]||"",Le={selectedClients:ir.current?Array.isArray(X.selectedClients)?X.selectedClients:[]:[],court:ge,modality:(()=>(Qt[ge]?.modalidades||zh)[0]||"")(),status:"scheduled",date:Aa.date??D,startMinutes:Aa.startMinutes??qe(),endMinutes:Aa.endMinutes??qe()+60};Me(Le),v([]),co.current=!0,Vl.current=!0}else{const ge=qr[0]||"",Le=Qt[ge]?.modalidades||zh,Ve=Array.isArray(ka)?ka:[],xt=ir.current?Array.isArray(X.selectedClients)?X.selectedClients:[]:Ve.length>0?Ve:[];if(!ir.current&&Ve.length>0)try{ir.current=!0}catch{}Me({selectedClients:xt,court:ge,modality:Le[0]||"",status:"scheduled",date:D,startMinutes:qe(),endMinutes:qe()+60}),v([]),co.current=!0,Vl.current=!0}},[Q,De,D,Aa,qr,zh,ft]),p.useEffect(()=>{if(Q&&De){Vl.current=!1,Oc.current=!1,ir.current||Me(ge=>({...ge,selectedClients:[]}));try{Xn.current=!1}catch{}}},[De,Q]),p.useEffect(()=>{if(Q)try{Oc.current=!1}catch{}},[Q]),p.useEffect(()=>{if(!Q||!De||Oc.current||Ul.current)return;const ge=ft[De.id]||[];if(!ge.length)return;let Le=ge.slice();const Ve=(X?.selectedClients||[]).slice();if(Ve.length>0){const Ct=new Map;ge.forEach(lr=>{const gn=Ct.get(lr.cliente_id)||[];gn.push(lr),Ct.set(lr.cliente_id,gn)});const _r=new Map,Kt=[];for(const lr of Ve){const gn=_r.get(lr.id)||0,$n=(Ct.get(lr.id)||[])[gn];$n&&(Kt.push($n),_r.set(lr.id,gn+1))}Kt.length===Ve.length&&(Le=Kt)}else if(Array.isArray(De?.clientes)&&De.clientes.length>0){const Ct=new Map;ge.forEach(lr=>{const gn=lr.nome||"",ea=Ct.get(gn)||[];ea.push(lr),Ct.set(gn,ea)});const _r=new Map,Kt=[];for(const lr of De.clientes){const gn=_r.get(lr)||0,$n=(Ct.get(lr)||[])[gn];$n&&(Kt.push($n),_r.set(lr,gn+1))}Kt.length===ge.length&&(Le=Kt)}try{const Ct=Le.findIndex(_r=>String(_r?.nome||"").toLowerCase()!=="cliente consumidor");if(Ct>0){const _r=Le.splice(Ct,1)[0];Le.unshift(_r)}}catch{}const xt=Le.filter(Ct=>Ct&&Ct.cliente_id).map(Ct=>({id:Ct.cliente_id,nome:Ct.nome,codigo:Ct.codigo||null}));if(xt.length>0){try{localStorage.getItem("debug:agenda")==="1"&&(console.log("[ORDER-AGENDA] chipsIdsNow:",Ve.map(Ct=>Ct.id)),console.log("[ORDER-AGENDA] selectedFromPartsIds:",xt.map(Ct=>Ct.id)))}catch{}Me(Ct=>({...Ct,selectedClients:xt})),v(Le.map(Ct=>({cliente_id:Ct.cliente_id,nome:Ct.nome,codigo:Ct.codigo||null,valor_cota:(()=>{const _r=Number.isFinite(Number(Ct.valor_cota))?Number(Ct.valor_cota):rf(Ct.valor_cota);return Gg(String((Number.isFinite(_r)?_r:0).toFixed(2)))})(),status_pagamento:Ct.status_pagamento||"Pendente",finalizadora_id:Ct.finalizadora_id||null,aplicar_taxa:Ct.aplicar_taxa||!1}))),kc(xt[0]?.id||null),Oc.current=!0}},[Q,De,ft]),p.useEffect(()=>{const ge=Le=>{if(Q&&!a){if(Le.key==="Escape"){if(Le.preventDefault(),De?.id){console.log(" [Auto-save] Salvando ao fechar modal (ESC)..."),Ra.current&&clearTimeout(Ra.current),Jo({autoSave:!0}).then(()=>{console.log(" [Auto-save] Salvo ao fechar (ESC)!"),re(!1)}).catch(Ve=>{console.error(" [Auto-save] Erro ao salvar ao fechar (ESC):",Ve),re(!1)});return}re(!1)}Le.key==="Enter"&&!["INPUT","TEXTAREA"].includes(Le.target.tagName)&&(Le.preventDefault(),!yi.current&&!Xo.current&&(yi.current=!0,Xo.current=!1,Jo().catch(()=>{}))),De&&(Le.key==="F3"&&(Le.preventDefault(),Xi(!0)),Le.key==="F4"&&(Le.preventDefault(),i()))}};return window.addEventListener("keydown",ge),()=>window.removeEventListener("keydown",ge)},[Q,De,a,i,Xi,Jo,yi,Xo,re,X]);const bi=p.useMemo(()=>{const ge=Qt[X.court];if(!ge)return{start:At*60,end:St*60};const[Le,Ve]=String(ge.hora_inicio||"06:00:00").split(":").map(Number),[xt,Ct]=String(ge.hora_fim||"24:00:00").split(":").map(Number),_r=xt===0&&Ct===0?24:xt;return{start:Le*60+(Ve||0),end:_r*60+(Ct||0)}},[Qt,X.court,At,St]),ms=p.useMemo(()=>{const ge=Jt(X.date,"yyyy-MM-dd"),Le=Ve=>{const xt=cu(Ve),Ct=du(Ve);return xt===0&&Ct===0?1440:xt*60+Ct};return le.filter(Ve=>Ve.court===X.court&&Jt(Ve.start,"yyyy-MM-dd")===ge&&Ve.status!=="canceled"&&(!De||Ve.id!==De.id)).map(Ve=>[Le(Ve.start),Le(Ve.end)]).sort((Ve,xt)=>Ve[0]-xt[0])},[le,X.court,X.date,De]),Rc=(ge,Le,Ve,xt)=>ge<xt&&Ve<Le;function ca(ge,Le){if(Le<=ge||ge<bi.start||Le>bi.end)return!1;for(const[Ve,xt]of ms)if(Rc(ge,Le,Ve,xt))return!1;return!0}const Ja=ge=>{let Le=ge+ja;if(!ca(ge,Le))return null;for(;Le+ja<=bi.end&&ca(ge,Le+ja);)Le+=ja;return Le},Uo=p.useMemo(()=>{const ge=bi,Le=[];for(let Ve=ge.start;Ve<=ge.end;Ve+=ja){const xt=ca(Ve,Ve+ja);let Ct=Math.floor(Ve/60);const _r=Ve%60;Ct>=24&&Ve===1440&&(Ct=0),Le.push({value:Ve,label:`${String(Ct).padStart(2,"0")}:${String(_r).padStart(2,"0")}`,available:xt})}return Le},[bi,ms]),si=p.useMemo(()=>{const ge=Ja(X.startMinutes),Le=[];for(let Ve=X.startMinutes+ja;Ve<=bi.end;Ve+=ja){const xt=!!ge&&Ve<=ge;let Ct=Math.floor(Ve/60);const _r=Ve%60;Ct>=24&&(Ct=Ct%24),Le.push({value:Ve,label:`${String(Ct).padStart(2,"0")}:${String(_r).padStart(2,"0")}`,available:xt})}return Le},[X.startMinutes,ms,bi]);p.useEffect(()=>{if(co.current){co.current=!1;return}const Le=(()=>{if(ca(X.startMinutes,X.startMinutes+ja))return X.startMinutes;for(let Ct=Math.max(bi.start,X.startMinutes);Ct<=bi.end-ja;Ct+=ja)if(ca(Ct,Ct+ja))return Ct;for(let Ct=bi.start;Ct<=bi.end-ja;Ct+=ja)if(ca(Ct,Ct+ja))return Ct;return X.startMinutes})();if(Le!==X.startMinutes){Me(Ct=>({...Ct,startMinutes:Le}));return}const Ve=Ja(Le);if(!Ve)return;let xt=X.endMinutes;(!Number.isFinite(xt)||xt<=Le||xt>Ve)&&(xt=Math.min(Le+60,Ve),xt<Le+ja&&(xt=Le+ja),Me(Ct=>({...Ct,endMinutes:xt})))},[X.startMinutes,X.court,X.date,ms,bi]);const xd=p.useMemo(()=>Qt[X.court]?.modalidades||zh,[Qt,X.court]);p.useEffect(()=>{const ge=Qt[X.court]?.modalidades||zh;ge.includes(X.modality)||Me(Le=>({...Le,modality:ge[0]||""}))},[X.court,Qt]),p.useEffect(()=>{if(co.current||!Vs(X.date,D))return;if(de[X.court]&&!de[X.court].funciona){const Ve=qr.find(xt=>!de[xt]||de[xt].funciona);Ve&&Me(xt=>({...xt,court:Ve}))}},[X.court,X.date,de,qr,D]);const Th=p.useMemo(()=>{const ge=Math.max(0,X.endMinutes-X.startMinutes),Le=Math.floor(ge/60),Ve=ge%60;return Le>0&&Ve>0?`${Le}h ${Ve}min`:Le>0?`${Le}h`:`${Ve}min`},[X.startMinutes,X.endMinutes]),Ku=p.useMemo(()=>{if(!Q)return"";const ge=new Date,Le=cu(ge)*60+du(ge),Ve=Number(X.startMinutes),xt=Number(X.endMinutes),Ct=_r=>{let Kt=Math.floor(_r/60);const lr=_r%60;return Kt>=24&&(Kt=Kt%24),`${String(Kt).padStart(2,"0")}:${String(lr).padStart(2,"0")}`};if(Ze.autoConfirmEnabled&&X.status==="scheduled"){const _r=Math.max(0,Ve-Number(Ze.autoConfirmMinutesBefore||0));if(Le<_r)return`Este agendamento est com automao ativa (Confirmar automaticamente s ${Ct(_r)})`}return Ze.autoStartEnabled&&X.status==="confirmed"&&Le<Ve?`Este agendamento est com automao ativa (Iniciar automaticamente s ${Ct(Ve)})`:Ze.autoFinishEnabled&&X.status==="in_progress"&&Le<xt?`Este agendamento est com automao ativa (Finalizar automaticamente s ${Ct(xt)})`:""},[Q,X.startMinutes,X.endMinutes,X.status,Ze]),Dh=p.useMemo(()=>(h||[]).length,[h]),Ng=p.useMemo(()=>{const Le=(h||[]).map(lr=>{const gn=rf(lr?.valor_cota);return Number.isFinite(gn)?gn:0}).reduce((lr,gn)=>lr+gn,0),Ve=rf(g),xt=Number.isFinite(Ve)?Ve:0,Ct=Number((xt-Le).toFixed(2));let _r=0,Kt=0;for(const lr of h||[])(lr?.status_pagamento||"Pendente")==="Pago"?_r++:Kt++;return{totalAssigned:Le,totalTarget:xt,diff:Ct,paid:_r,pending:Kt}},[h,g]);p.useEffect(()=>{const ge=rf(g);if(!Number.isFinite(ge)||ge<=0)return;(h||[]).some(Ve=>rf(Ve?.valor_cota)>=ge)&&(h||[]).some(Ve=>Ve.status_pagamento!=="Pago")&&v(Ve=>Ve.map(xt=>({...xt,status_pagamento:"Pago"})))},[h,g]),p.useCallback(()=>{const ge=(X.selectedClients||[]).length;if(!ge)return;const Le=rf(g);if(!Number.isFinite(Le)||Le<0)return;const Ve=Math.round(Le*100),xt=Math.floor(Ve/ge);let Ct=Ve-xt*ge;v(_r=>{const Kt=(X.selectedClients||[]).slice(),lr=new Map,gn=new Map;return(_r||[]).forEach($n=>{const tn=gn.get($n.cliente_id)||[];tn.push($n),gn.set($n.cliente_id,tn)}),Kt.map($n=>{const tn=lr.get($n.id)||0,La=(gn.get($n.id)||[])[tn];lr.set($n.id,tn+1);const ha=xt+(Ct>0?1:0);Ct>0&&Ct--;const $a=(ha/100).toFixed(2),Dn=Gg(String($a)),pa=rf(Dn);return{cliente_id:$n.id,nome:$n.nome,codigo:La?.codigo??$n.codigo??null,valor_cota:Dn,status_pagamento:Number.isFinite(pa)&&pa>0?"Pago":"Pendente",finalizadora_id:La?.finalizadora_id??null,aplicar_taxa:La?.aplicar_taxa??!1}})})},[X.selectedClients,g,v]),p.useCallback(()=>{v(ge=>ge.map(Le=>({...Le,valor_cota:"",status_pagamento:"Pendente"})))},[v]);const Hf=p.useCallback(async()=>{try{ae.current=!1,localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{mt.current="close"}catch{}try{F(!1),Tt(!1)}catch{}if(De?.id&&Ul.current)try{Ra.current&&clearTimeout(Ra.current),console.log(" [CustomerPicker] Salvando participantes ao fechar..."),await Jo({autoSave:!0}),console.log(" [CustomerPicker] Participantes salvos!")}catch(ge){console.error(" [CustomerPicker] Erro ao salvar:",ge)}},[De?.id,Jo]);return o.jsxs(o.Fragment,{children:[Zr&&o.jsx(ln,{open:!0,onOpenChange:ge=>{if(!ge&&Zr){try{Zr.resolve(!1)}catch{}tt(null)}},children:o.jsxs(on,{onOpenAutoFocus:ge=>ge.preventDefault(),children:[o.jsxs(nn,{children:[o.jsx(rn,{children:"Reativar automao?"}),o.jsx(_n,{children:"Ao reativar, este agendamento voltar a ser atualizado automaticamente (incio e trmino) pelas regras da agenda."})]}),o.jsx(Un,{children:o.jsxs("div",{className:"ml-auto flex gap-2",children:[o.jsx(oe,{type:"button",variant:"ghost",className:"border border-white/10",onClick:()=>{try{Zr?.resolve(!1)}catch{}tt(null)},children:"Cancelar"}),o.jsx(oe,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white",onClick:()=>{try{Zr?.resolve(!0)}catch{}tt(null)},children:"Reativar"})]})})]})}),Q&&o.jsx(ln,{open:!0,onOpenChange:async ge=>{if(ge)re(!0);else{try{const Le=Date.now()<(je.current||0);if(Ae||jt||Le){try{const Ve={ts:new Date().toISOString(),hook:"Dialog:onOpenChange(blocked)",effectiveCustomerPickerOpen:Ae,isClientFormOpen:jt,suppressUntil:je.current,formLen:Array.isArray(X?.selectedClients)?X.selectedClients.length:NaN,curLen:Array.isArray(gt.current)?gt.current.length:NaN,lastLen:Array.isArray(Lt.current)?Lt.current.length:NaN};console.warn("[CustomerPicker][DIALOG:block-close]",Ve)}catch{}return}}catch{}try{const Le={ts:new Date().toISOString(),hook:"Dialog:onOpenChange(allow-close)",effectiveCustomerPickerOpen:Ae,isClientFormOpen:jt,suppressUntil:je.current,formLen:Array.isArray(X?.selectedClients)?X.selectedClients.length:NaN,curLen:Array.isArray(gt.current)?gt.current.length:NaN,lastLen:Array.isArray(Lt.current)?Lt.current.length:NaN};console.warn("[CustomerPicker][DIALOG:allow-close]",Le)}catch{}if(a&&console.log("[Dialog] Fechamento solicitado com PaymentModal aberto - iniciando coordenao"),console.log(" [FLUXO CRTICO] Solicitao de fechamento do modal de agendamento recebida"),console.log(" Estado atual:",{isPaymentModalOpen:a,editingBooking:De?.id,timestamp:new Date().toISOString()}),a&&typeof window<"u"){console.log(" [FLUXO CRTICO] PaymentModal aberto - solicitando save-and-close");try{await new Promise(Le=>{const Ve=()=>{window.removeEventListener("paymentmodal:closed",Ve),console.log(" [FLUXO CRTICO] PaymentModal confirmou fechamento"),Le()},xt=setTimeout(()=>{window.removeEventListener("paymentmodal:closed",Ve),console.warn(" [FLUXO CRTICO] Timeout aguardando PaymentModal fechar"),Le()},3e3),Ct=()=>{clearTimeout(xt),Ve()};window.addEventListener("paymentmodal:closed",Ct,{once:!0}),window.dispatchEvent(new Event("paymentmodal:save-and-close"))})}catch{}}re(!1),st(null),ut(null),Oc.current=!1,console.log(" [FLUXO CRTICO] Modal de agendamento fechado"),me(!1),Be(4)}},children:o.jsxs(on,{forceMount:!0,disableAnimations:!0,alignTop:!0,className:"sm:max-w-[960px] max-h-[85vh] min-h-[360px] flex flex-col p-0",onOpenAutoFocus:ge=>ge.preventDefault(),onInteractOutside:async ge=>{try{const Le=Date.now()<(je.current||0);if(a||Ae||jt||Le){try{const Ve={ts:new Date().toISOString(),hook:"DialogContent:onInteractOutside(blocked)",effectiveCustomerPickerOpen:Ae,isClientFormOpen:jt,isPaymentModalOpen:a,suppressUntil:je.current,formLen:Array.isArray(X?.selectedClients)?X.selectedClients.length:NaN,curLen:Array.isArray(gt.current)?gt.current.length:NaN,lastLen:Array.isArray(Lt.current)?Lt.current.length:NaN}}catch{}ge.preventDefault();return}if(De?.id){ge.preventDefault(),console.log(" [Auto-save] Salvando ao clicar fora do modal...");try{Ra.current&&clearTimeout(Ra.current),await Jo({autoSave:!0}),console.log(" [Auto-save] Salvo ao clicar fora!")}catch(Ve){console.error(" [Auto-save] Erro ao salvar ao clicar fora:",Ve)}finally{re(!1)}return}}catch{}},onEscapeKeyDown:ge=>{try{const Le=Date.now()<(je.current||0);if(a||Ae||jt||Le){ge.preventDefault();return}}catch{}},children:[o.jsxs(nn,{className:"px-6 pt-6 pb-4 flex-shrink-0",children:[o.jsxs(rn,{className:"flex items-center justify-between gap-3 flex-wrap",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{children:De?(()=>{const ge=De?.code,Le=typeof ge=="number"?String(ge).padStart(3,"0"):null;return Le?`Editar agendamento - ${Le}`:"Editar Agendamento"})():"Novo Agendamento"}),Hs&&o.jsxs("span",{className:"inline-flex items-center gap-2 px-2.5 py-1 rounded-full border text-xs bg-blue-600/10 text-blue-400 border-blue-700/30",children:[o.jsxs("svg",{className:"w-3 h-3 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Salvando..."]})]}),De&&(()=>{Ng?.pending===0&&Dh>0;const ge=(Ng?.pending||0)>0,Le="inline-flex items-center gap-2 px-2.5 py-1 rounded-full border text-xs",Ve="bg-emerald-600/10 text-emerald-400 border-emerald-700/30",xt="bg-amber-600/15 text-amber-400 border-amber-700/30",Ct=_r=>o.jsx("span",{"aria-hidden":!0,className:`inline-block w-2 h-2 rounded-full ${_r}`});return o.jsxs("span",{className:`${Le} ${ge?xt:Ve}`,title:ge?"H pagamentos pendentes":"Todos participantes pagos","aria-live":"polite",children:[Ct(ge?"bg-amber-400":"bg-emerald-400"),o.jsx("span",{className:"tracking-wide",children:"Pagos"}),o.jsx("strong",{className:"text-base font-semibold tabular-nums",children:Ng?.paid||0}),o.jsx("span",{className:"opacity-60",children:"/"}),o.jsx("span",{className:"text-base font-semibold tabular-nums",children:Dh})]})})(),o.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-md border text-sm bg-white/5 border-white/10 text-text-primary",title:"Data do agendamento",children:[o.jsx(Ei,{className:"w-4 h-4 opacity-80"}),o.jsxs("span",{className:"font-semibold",children:[Jt(X.date,"dd/MM/yyyy"),(()=>{const ge=Number(X?.startMinutes),Le=Number(X?.endMinutes);if(!(Number.isFinite(ge)&&Number.isFinite(Le)&&Le>ge))return"";const xt=Ct=>{let _r=Math.floor(Ct/60);const Kt=Ct%60;return _r>=24&&(_r=_r%24),`${String(_r).padStart(2,"0")}:${String(Kt).padStart(2,"0")}`};return`  ${xt(ge)}${xt(Le)}`})()]})]})]}),o.jsx(_n,{children:De?"As alteraes so salvas automaticamente enquanto voc edita.":"Preencha os detalhes para criar uma nova reserva."})]}),o.jsx("div",{className:"flex-1 overflow-y-auto px-6",children:o.jsxs("div",{className:"grid md:grid-cols-2 gap-4 pb-4",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(Wt,{htmlFor:"clientes-field",className:"font-bold",children:"Clientes"}),o.jsxs("div",{className:"flex gap-2 mt-1",children:[o.jsxs(xc,{modal:!1,open:Ae,onOpenChange:ge=>{const Le=Date.now(),Ve=Le<(Se.current||0)||Le<(je.current||0)||Le<(He.current||0)||et();if(!((jt||fo)&&ge===!1)){if(!ge&&Ve){Ii("onOpenChange:blocked:guard-window");return}if(!ge&&mt.current!=="close"){Ii("onOpenChange:blocked:sticky-close");return}if(ge){ae.current=!0;try{localStorage.setItem("agenda:customerPicker:desiredAt",String(Date.now()))}catch{}Tt(!0),Ii("open:accepted")}else{ae.current=!1;try{localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{const xt=Array.isArray(gt.current)?[...gt.current]:[];if(xt.length>0){xn.current="onOpenChange:close:preserve";try{sessionStorage.setItem(Rn,JSON.stringify(xt))}catch{}Ya(xt),Ps("onOpenChange:close:preserve",xt)}else Xn.current||(xn.current="onOpenChange:close:empty",Ps("onOpenChange:close:empty",[]))}catch{}try{je.current=Date.now()+1500}catch{}try{const xt={ts:new Date().toISOString(),hook:"onOpenChange(false)",formLen:Array.isArray(X?.selectedClients)?X.selectedClients.length:NaN,curLen:Array.isArray(gt.current)?gt.current.length:NaN,lastLen:Array.isArray(Lt.current)?Lt.current.length:NaN,chipsLen:Array.isArray(ka)?ka.length:NaN,clientsLoading:!!fo,lastAction:xn?.current,clearedByUser:!!Xn?.current,suppressUntil:je.current};console.warn("[CustomerPicker][CLOSE:onOpenChange]",xt)}catch{}Tt(!1),Ii("close:accepted")}!ge&&Vr.current&&(Pr(!0),Vr.current=!1,setTimeout(()=>Pr(!1),1200)),mt.current=ge?"open":"close",F(ge)}},children:[o.jsx(yc,{asChild:!0,children:o.jsxs(oe,{type:"button",variant:"outline",className:Yt("min-w-[180px] justify-between",Wr&&"ring-2 ring-emerald-500/40 ring-offset-2 ring-offset-transparent transition-shadow"),onClick:()=>{Ii("trigger:click");try{mt.current="open"}catch{}try{ae.current=!0,localStorage.setItem("agenda:customerPicker:desiredAt",String(Date.now()))}catch{}F(!0),Tt(!0),setTimeout(()=>{F(!0),Tt(!0),Ii("trigger:reassert-open")},30),Ii("trigger:after-set-open")},children:[Ih,o.jsx(L1,{className:"w-4 h-4 ml-2 opacity-60"})]})}),o.jsx(Rl,{forceMount:!0,side:"bottom",align:"start",className:"w-[360px] p-2 z-[9999]",onPointerDownOutside:ge=>{const Le=Date.now();if(Le<(Se.current||0)||Le<(je.current||0)||Le<(He.current||0)||et()){ge.preventDefault();return}if(jt||fo){ge.preventDefault();return}try{const xt=Array.isArray(gt.current)?[...gt.current]:[];if(xt.length>0){xn.current="outside:close:snapshot",Lt.current=xt;try{sessionStorage.setItem(Rn,JSON.stringify(xt))}catch{}Ya(xt),Ps("outside:close:apply",xt),Xn.current=!1}else{if(xn.current="outside:close:empty",Xn.current){Lt.current=[];try{sessionStorage.removeItem(Rn)}catch{}console.warn("[CustomerPicker][outside:close:empty:cleared]",{ts:new Date().toISOString()})}Ps("outside:close:empty",[])}}catch{}try{je.current=Date.now()+1500}catch{}try{const xt={ts:new Date().toISOString(),hook:"onPointerDownOutside",formLen:Array.isArray(X?.selectedClients)?X.selectedClients.length:NaN,curLen:Array.isArray(gt.current)?gt.current.length:NaN,lastLen:Array.isArray(Lt.current)?Lt.current.length:NaN,chipsLen:Array.isArray(ka)?ka.length:NaN,clientsLoading:!!fo,lastAction:xn?.current,clearedByUser:!!Xn?.current,suppressUntil:je.current}}catch{}Vr.current=!0,mt.current="close",ae.current=!1;try{localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}F(!1),Tt(!1),De?.id&&Ul.current&&(async()=>{try{Ra.current&&clearTimeout(Ra.current),console.log(" [CustomerPicker] Salvando participantes (clique fora)..."),await Jo({autoSave:!0}),console.log(" [CustomerPicker] Participantes salvos!")}catch(xt){console.error(" [CustomerPicker] Erro ao salvar:",xt)}})()},onFocusOutside:ge=>{Ii("focusOutside"),(jt||fo)&&ge.preventDefault()},onEscapeKeyDown:ge=>{Ii("escapeKeyDown"),(jt||fo)&&ge.preventDefault()},children:o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"relative",children:[o.jsx(pi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(or,{ref:Oi,placeholder:"Buscar por cdigo ou nome...",value:fe,onChange:ge=>{we(ge.target.value),Je(0)},onKeyDown:ge=>{if(ge.key==="ArrowDown"||ge.key==="ArrowUp"){ge.preventDefault();const Le=(vo||[]).filter(Kt=>{const lr=fe.trim().toLowerCase();return lr?String(Ge(Kt)||"").toLowerCase().includes(lr):!0}),Ve=Le.find(Kt=>Kt?.is_consumidor_final===!0),Ct=Le.filter(Kt=>Kt?.is_consumidor_final!==!0).slice().sort((Kt,lr)=>{const gn=typeof Kt=="object"&&Number.isFinite(Number(Kt?.codigo))?Number(Kt.codigo):1/0,ea=typeof lr=="object"&&Number.isFinite(Number(lr?.codigo))?Number(lr.codigo):1/0;if(gn!==ea)return gn-ea;const $n=String(We(Kt)||"").toLowerCase(),tn=String(We(lr)||"").toLowerCase();return $n.localeCompare(tn)}),_r=Ve?[Ve,...Ct]:Ct;ge.key==="ArrowDown"?Je(Kt=>Math.min(Kt+1,_r.length-1)):Je(Kt=>Math.max(Kt-1,0))}if(ge.key==="Enter"){ge.preventDefault();const Le=(vo||[]).filter(lr=>{const gn=fe.trim().toLowerCase();return gn?String(Ge(lr)||"").toLowerCase().includes(gn):!0}),Ve=Le.find(lr=>lr?.is_consumidor_final===!0),Ct=Le.filter(lr=>lr?.is_consumidor_final!==!0).slice().sort((lr,gn)=>{const ea=typeof lr=="object"&&Number.isFinite(Number(lr?.codigo))?Number(lr.codigo):1/0,$n=typeof gn=="object"&&Number.isFinite(Number(gn?.codigo))?Number(gn.codigo):1/0;if(ea!==$n)return ea-$n;const tn=String(We(lr)||"").toLowerCase(),Ha=String(We(gn)||"").toLowerCase();return tn.localeCompare(Ha)}),Kt=(Ve?[Ve,...Ct]:Ct)[Re];if(Kt){const lr=Kt.id,gn=We(Kt),ea=Kt.codigo,$n={id:lr,nome:gn,codigo:ea},tn=[...Array.isArray(gt.current)?gt.current:[],$n];try{(gt.current||[]).length===0&&(Dr.current=lr||null)}catch{}try{Xn.current=!1}catch{}try{tn.length>0&&(Lt.current=tn)}catch{}try{gt.current=tn}catch{}Ps("keyboard:enter",tn),ae.current=!0;try{localStorage.setItem("agenda:customerPicker:desiredAt",String(Date.now()))}catch{}}}},className:"pl-10 pr-10"}),fe&&o.jsx("button",{type:"button","aria-label":"Limpar busca",className:"absolute right-2 top-1/2 -translate-y-1/2 text-text-muted hover:text-text-primary p-1 rounded hover:bg-white/10",onClick:()=>{we(""),Oi.current?.focus()},children:o.jsx(Ml,{className:"w-4 h-4"})})]}),o.jsxs("div",{ref:us,className:"max-h-[260px] overflow-y-auto divide-y divide-border rounded-md border border-border",onWheel:ge=>{ge.stopPropagation()},onTouchMove:ge=>{ge.stopPropagation()},style:{overscrollBehavior:"contain"},children:[fo&&(vo||[]).length===0&&o.jsx("div",{className:"px-3 py-4 text-sm text-text-muted",children:"Carregando clientes"}),!fo&&(vo||[]).length===0&&o.jsx("div",{className:"px-3 py-4 text-sm text-text-muted",children:"Nenhum cliente encontrado"}),!fo&&(()=>{const ge=(vo||[]).filter(_r=>{const Kt=fe.trim().toLowerCase();return Kt?String(Ge(_r)||"").toLowerCase().includes(Kt):!0}),Le=ge.find(_r=>_r?.is_consumidor_final===!0),xt=ge.filter(_r=>_r?.is_consumidor_final!==!0).slice().sort((_r,Kt)=>{const lr=typeof _r=="object"&&Number.isFinite(Number(_r?.codigo))?Number(_r.codigo):1/0,gn=typeof Kt=="object"&&Number.isFinite(Number(Kt?.codigo))?Number(Kt.codigo):1/0;if(lr!==gn)return lr-gn;const ea=String(We(_r)||"").toLowerCase(),$n=String(We(Kt)||"").toLowerCase();return ea.localeCompare($n)});return Le?[Le,...xt]:xt})().map((ge,Le)=>{const Ve=ge?.is_consumidor_final===!0,xt=typeof ge=="object"?ge.id:null,Ct=We(ge),_r=typeof ge=="object"?ge.codigo:null,Kt=String(Ct||"").toLowerCase(),lr=$n=>$n.id&&xt?$n.id===xt:String($n.nome||"").toLowerCase()===Kt,gn=(X.selectedClients||[]).some(lr),ea=Le===Re;return o.jsxs("button",{ref:$n=>{Xa.current[Le]=$n},type:"button",className:`w-full text-left py-3 px-4 flex items-center gap-3 transition-all border-b border-border last:border-0 ${ea?"ring-2 ring-blue-500 ring-inset z-10":""} ${Ve?"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-2 border-l-amber-500/40":gn?"bg-emerald-600/20 hover:bg-emerald-600/30":"hover:bg-surface-2"}`,onMouseEnter:()=>Je(Le),onMouseDown:$n=>{$n.stopPropagation()},role:"option","aria-checked":gn,onClick:()=>{const $n={id:xt,nome:Ct,codigo:_r},tn=[...Array.isArray(gt.current)?gt.current:[],$n];try{(gt.current||[]).length===0&&(Dr.current=xt||null)}catch{}try{Xn.current=!1}catch{}try{tn.length>0&&(Lt.current=tn)}catch{}try{gt.current=tn}catch{}Ps("list:add",tn),ae.current=!0;try{localStorage.setItem("agenda:customerPicker:desiredAt",String(Date.now()))}catch{}},children:[o.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[_r!=null&&o.jsxs("span",{className:`inline-flex items-center justify-center w-10 h-10 rounded-full font-bold text-sm transition-colors ${Ve?"bg-amber-500/15 text-amber-300/90 ring-1 ring-amber-500/20":"bg-emerald-600/20 text-emerald-400"}`,children:["#",_r]}),o.jsxs("div",{className:"flex-1 flex flex-col gap-1",children:[o.jsx("span",{className:`font-medium truncate ${Ve?"text-amber-100/90":""}`,children:Ct}),Ve&&o.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium",children:[o.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]})]})]}),(()=>{const $n=(X.selectedClients||[]).filter(tn=>lr(tn)).length;return $n>0?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-7 h-7 rounded-full bg-rose-600 hover:bg-rose-500 text-white text-base font-bold transition-colors",onClick:tn=>{tn.stopPropagation();const Ha=Array.isArray(gt.current)?gt.current:[],La=Ha.findIndex(ha=>lr(ha));if(La!==-1){const ha=[...Ha];ha.splice(La,1);try{Xn.current=ha.length===0}catch{}try{ha.length===0&&(Dr.current=null)}catch{}try{ha.length>0&&(Lt.current=ha)}catch{}try{gt.current=ha}catch{}Ps("list:remove-one",ha)}},children:"-"}),o.jsx("span",{className:"inline-flex items-center justify-center min-w-[32px] h-7 px-2 rounded-full bg-sky-600 text-white text-base font-bold",children:$n}),o.jsx("button",{type:"button",className:"inline-flex items-center justify-center w-7 h-7 rounded-full bg-emerald-600 hover:bg-emerald-500 text-white text-base font-bold transition-colors",onClick:tn=>{tn.stopPropagation();const Ha={id:xt,nome:Ct,codigo:_r},La=[...Array.isArray(gt.current)?gt.current:[],Ha];try{(gt.current||[]).length===0&&(Dr.current=xt||null)}catch{}try{Xn.current=!1}catch{}try{La.length>0&&(Lt.current=La)}catch{}try{gt.current=La}catch{}Ps("list:add-one",La)},children:"+"})]}):null})()]},xt||Kt)})]}),o.jsxs("div",{className:"flex items-center justify-between pt-1",children:[o.jsx(oe,{type:"button",size:"sm",className:"bg-emerald-600 hover:bg-emerald-500 text-white shadow-md ring-2 ring-emerald-400/40 ring-offset-2 ring-offset-transparent",onMouseDown:ge=>{try{je.current=Date.now()+3e3}catch{}try{Se.current=Date.now()+3500}catch{}try{ie.current=Date.now()+5e3}catch{}try{mt.current="close"}catch{}try{ae.current=!1,localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}try{sessionStorage.setItem("agenda:customerPicker:closing","1"),sessionStorage.setItem("agenda:customerPicker:closingAt",String(Date.now()));const Le=be.current||sessionStorage.getItem("agenda:modal:sessionId")||"";Le&&sessionStorage.setItem("agenda:customerPicker:sessionId",Le);const Ve=Array.isArray(gt.current)?gt.current:[];Ve.length>0&&sessionStorage.setItem(Rn,JSON.stringify(Ve));try{const xt={ts:new Date().toISOString(),hook:"conclude:mousedown",modalSessionId:Le,closingAt:sessionStorage.getItem("agenda:customerPicker:closingAt"),selLen:Array.isArray(Ve)?Ve.length:NaN,formLen:Array.isArray(X?.selectedClients)?X.selectedClients.length:NaN,lockUntil:Se.current,suppressUntil:je.current,isPickerOpen:!!Ae,isModalOpen:!!Q}}catch{}}catch{}ge.stopPropagation()},onClick:()=>{mt.current="close",ae.current=!1;try{ie.current=Date.now()+5e3}catch{}try{localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}Ne.current=!0;const Le=Array.isArray(gt.current)?[...gt.current]:[];try{Le.length>0&&(xn.current="conclude:close:snapshot",Lt.current=Le,sessionStorage.setItem(Rn,JSON.stringify(Le)))}catch{}Ya(Le);try{Se.current=Date.now()+3e3}catch{}Ps("conclude:close:apply",Le),Me(Ve=>({...Ve,selectedClients:[...Le]}));try{Xn.current=!1}catch{}try{je.current=Date.now()+2500}catch{}F(!1),Tt(!1),setTimeout(()=>{try{je.current=Date.now()+2500}catch{}F(!1),Tt(!1)},15),setTimeout(()=>{try{je.current=Date.now()+2500}catch{}F(!1),Tt(!1)},120),De?.id&&Ul.current&&(async()=>{try{Ra.current&&clearTimeout(Ra.current),console.log(" [CustomerPicker] Salvando participantes (Concluir)..."),await Jo({autoSave:!0}),console.log(" [CustomerPicker] Participantes salvos!")}catch(Ve){console.error(" [CustomerPicker] Erro ao salvar:",Ve)}})();try{je.current=Date.now()+2500}catch{}try{const Ve={ts:new Date().toISOString(),hook:"conclude:click",formLen:Array.isArray(X?.selectedClients)?X.selectedClients.length:NaN,curLen:Array.isArray(gt.current)?gt.current.length:NaN,lastLen:Array.isArray(Lt.current)?Lt.current.length:NaN,chipsLen:Array.isArray(ka)?ka.length:NaN,clientsLoading:!!fo,lastAction:xn?.current,clearedByUser:!!Xn?.current,suppressUntil:je.current,selectionLockUntil:Se.current,restoreGuardUntil:Ft.current,modalSessionId:be.current||sessionStorage.getItem("agenda:modal:sessionId")||"",closingAt:sessionStorage.getItem("agenda:customerPicker:closingAt"),pickerOpen:!!Ae,modalOpen:!!Q}}catch{}setTimeout(()=>{try{Ne.current=!1}catch{}},3e3)},children:"Concluir"}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsxs("span",{className:"text-xs text-text-muted",children:[(Ic||[]).length," selecionado(s)"]})})]})]})})]}),o.jsx(oe,{type:"button",onClick:()=>{try{const ge=Array.isArray(gt.current)?gt.current:[];ge.length>0&&(Lt.current=ge,sessionStorage.setItem(Rn,JSON.stringify(ge)),Ya(ge),console.warn("[CustomerPicker][+Novo:save-selection]",{savedCount:ge.length}))}catch{}ae.current=!1;try{localStorage.removeItem("agenda:customerPicker:desiredAt")}catch{}mt.current="close",F(!1),Tt(!1),pr(null),Rt(!0)},children:"+ Novo"})]}),Wf.length>0?o.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:Wf.map((ge,Le)=>{const Ve=String(ge?.nome||"").toLowerCase(),xt=`${ge?.id||Ve}-${Le}`,Ct=ge?.id||`__name:${Ve}`;return o.jsxs("span",{className:"text-sm font-medium bg-white/5 border border-white/10 rounded px-2 py-1 flex items-center gap-2",children:[u9(ge.nome),o.jsxs("button",{type:"button","aria-label":"Remover cliente",title:"Remover cliente",className:"text-text-muted hover:text-red-400 p-1 rounded hover:bg-red-500/10",onClick:()=>{j("CustomerPicker:chip:remove",{token:Ct,chipIdx:Le});const _r=(Array.isArray(gt.current)?gt.current:[]).filter((Kt,lr)=>lr!==Le);try{Xn.current=_r.length===0}catch{}try{Lt.current=_r,_r.length===0&&(sessionStorage.removeItem(Rn),console.warn("[CustomerPicker][chip:remove:cleared-all]",{ts:new Date().toISOString()}))}catch{}try{gt.current=_r}catch{}Ps("chips:remove",_r)},children:[o.jsx(Ml,{className:"w-5 h-5"}),o.jsx("span",{className:"sr-only",children:"Remover"})]})]},xt)})}):null]}),o.jsxs("div",{children:[o.jsx(Wt,{htmlFor:"quadra-select",className:"font-bold",children:"Quadra"}),o.jsxs(En,{value:X.court,onValueChange:ge=>Me(Le=>({...Le,court:ge})),children:[o.jsx(Sn,{className:"mt-1",onMouseDown:()=>{Ae&&setTimeout(Hf,0)},children:o.jsx(kn,{children:X.court&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"inline-block w-2.5 h-2.5 rounded-full",style:{backgroundColor:hm(X.court)}}),o.jsx("span",{children:X.court})]})})}),o.jsx(Cn,{className:"z-[60]",children:qr.map(ge=>{const Le=Jt(X.date,"yyyy-MM-dd"),Ve=W[Le]||{},xt=Ve[ge]&&!Ve[ge].funciona;return o.jsx(wt,{value:ge,disabled:xt,className:xt?"opacity-50 cursor-not-allowed":"",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"inline-block w-2.5 h-2.5 rounded-full",style:{backgroundColor:hm(ge)}}),o.jsx("span",{children:ge}),xt&&o.jsx("span",{className:"text-xs text-text-muted ml-auto",children:"(Fechada)"})]})},ge)})})]})]}),o.jsxs("div",{children:[o.jsx(Wt,{htmlFor:"modalidade-select",className:"font-bold",children:"Modalidade"}),o.jsxs(En,{value:X.modality,onValueChange:ge=>Me(Le=>({...Le,modality:ge})),children:[o.jsx(Sn,{className:"mt-1",onMouseDown:()=>{Ae&&setTimeout(Hf,0)},children:o.jsx(kn,{})}),o.jsx(Cn,{children:(xd||[]).map(ge=>o.jsx(wt,{value:ge,children:ge},ge))})]})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(Wt,{htmlFor:"status-select",className:"font-bold",children:"Status"}),o.jsxs(En,{value:X.status,onValueChange:ge=>Me(Le=>({...Le,status:ge})),children:[o.jsx(Sn,{className:"mt-1",onMouseDown:()=>{Ae&&setTimeout(Hf,0)},children:o.jsx(kn,{})}),o.jsx(Cn,{children:Object.keys($s).map(ge=>o.jsx(wt,{value:ge,children:o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx("span",{"aria-hidden":!0,className:`inline-block h-4 w-1 rounded ${$s[ge].accent}`}),$s[ge].label]})},ge))})]}),Ku&&o.jsx("div",{className:"mt-1.5 text-xs text-text-primary font-medium bg-brand/5 border border-brand/20 rounded px-2 py-1.5",children:Ku})]}),o.jsxs("div",{children:[o.jsx(Wt,{htmlFor:"horario-inicio",className:"font-bold",children:"Horrio"}),o.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[o.jsxs(En,{value:String(X.startMinutes),onValueChange:ge=>Me(Le=>({...Le,startMinutes:Number(ge)})),children:[o.jsx(Sn,{className:"w-32","aria-label":"Hora incio",onMouseDown:()=>{Ae&&setTimeout(Hf,0)},children:o.jsx(kn,{})}),o.jsx(Cn,{className:"max-h-[300px] z-[60] [&>div]:scrollbar-thin [&>div]:scrollbar-track-surface [&>div]:scrollbar-thumb-brand/40 [&>div]:hover:scrollbar-thumb-brand/60",children:Uo.map(ge=>o.jsx(wt,{value:String(ge.value),disabled:!ge.available,className:Yt(!ge.available&&"opacity-60"),children:o.jsxs("span",{className:"inline-flex items-center gap-2",children:[ge.available?o.jsx(Vd,{className:"w-4 h-4 opacity-80"}):o.jsx(sh,{className:"w-4 h-4 opacity-80"}),ge.label]})},ge.value))})]}),o.jsxs(En,{value:String(X.endMinutes),onValueChange:ge=>Me(Le=>({...Le,endMinutes:Number(ge)})),children:[o.jsx(Sn,{className:"w-32","aria-label":"Hora fim",onMouseDown:()=>{Ae&&setTimeout(Hf,0)},children:o.jsx(kn,{})}),o.jsx(Cn,{className:"max-h-[300px] z-[60] [&>div]:scrollbar-thin [&>div]:scrollbar-track-surface [&>div]:scrollbar-thumb-brand/40 [&>div]:hover:scrollbar-thumb-brand/60",children:si.map(ge=>o.jsx(wt,{value:String(ge.value),disabled:!ge.available,className:Yt(!ge.available&&"opacity-60"),children:o.jsxs("span",{className:"inline-flex items-center gap-2",children:[ge.available?o.jsx(Vd,{className:"w-4 h-4 opacity-80"}):o.jsx(sh,{className:"w-4 h-4 opacity-80"}),ge.label]})},ge.value))})]})]}),o.jsxs("div",{className:"mt-1 inline-block text-xs font-semibold text-text-secondary bg-white/5 border border-white/10 rounded px-2 py-0.5",children:["Durao: ",Th]})]}),!De&&o.jsxs("div",{className:"border-t border-border pt-4 mt-4",children:[o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("input",{type:"checkbox",id:"is-recorrente",checked:G,onChange:ge=>me(ge.target.checked),className:"mt-1 h-4 w-4 rounded border-gray-300 text-brand focus:ring-brand"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("label",{htmlFor:"is-recorrente",className:"font-semibold text-text-primary cursor-pointer",children:"Agendamento Fixo (Recorrente)"}),o.jsx("p",{className:"text-xs text-text-secondary mt-0.5",children:"Criar este agendamento automaticamente nas prximas semanas, no mesmo dia e horrio"})]})]}),G&&o.jsxs("div",{className:"ml-7 mt-3 space-y-3",children:[o.jsxs("div",{children:[o.jsx(Wt,{htmlFor:"quantidade-semanas",className:"text-sm font-medium",children:"Repetir por quantas semanas?"}),o.jsxs("div",{className:"flex items-center gap-3 mt-1.5",children:[o.jsxs("div",{className:"flex items-center border border-border rounded-md bg-surface-2",children:[o.jsx("button",{type:"button",onClick:()=>Be(ge=>Math.max(2,(ge||2)-1)),className:"px-3 py-2 hover:bg-surface-3 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:pe<=2,children:o.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),o.jsx("div",{className:"px-4 py-2 min-w-[60px] text-center font-semibold border-x border-border",children:pe}),o.jsx("button",{type:"button",onClick:()=>Be(ge=>(ge||2)+1),className:"px-3 py-2 hover:bg-surface-3 transition-colors",children:o.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]}),o.jsxs("span",{className:"text-sm text-text-secondary",children:["semanas (",pe," agendamentos)"]})]})]}),X.date&&pe>=2&&o.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-3",children:[o.jsx("p",{className:"text-xs font-semibold text-slate-300 mb-2 uppercase tracking-wide",children:"Datas que sero criadas:"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from({length:pe}).map((ge,Le)=>{const Ve=Ia(X.date,Le*7);return o.jsxs("div",{className:"inline-flex items-center gap-1.5 bg-slate-700/50 border border-slate-600 rounded px-2 py-1",children:[o.jsx("svg",{className:"w-3.5 h-3.5 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),o.jsx("span",{className:"text-xs font-medium text-white",children:Jt(Ve,"dd/MM/yyyy '('EEEE')'",{locale:ia})})]},Le)})})]}),o.jsx("div",{className:"bg-slate-800/50 border-l-4 border-blue-600 rounded-r-lg p-3",children:o.jsxs("div",{className:"flex gap-3",children:[o.jsx("div",{className:"flex-shrink-0 mt-0.5",children:o.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),o.jsxs("div",{className:"text-xs text-gray-300",children:[o.jsx("p",{className:"font-semibold mb-1 text-blue-300",children:"Importante: Revise os dados antes de salvar"}),o.jsxs("p",{children:["Sero criados ",o.jsxs("strong",{className:"text-white",children:[pe," agendamentos"]})," incluindo a data selecionada e as prximas ",pe-1," semanas. Editar ou cancelar depois exigir alterar cada agendamento individualmente."]})]})]})})]})]})]})]})}),o.jsx(Un,{className:"flex-shrink-0 border-t border-border bg-surface px-6 py-3",children:o.jsxs("div",{className:"w-full flex flex-col gap-3 sm:flex-row sm:items-center",children:[De&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:mr-auto w-full sm:w-auto",children:[o.jsxs(oe,{type:"button",variant:"destructive",className:"bg-red-600 hover:bg-red-500 text-white border border-red-700 w-full sm:w-auto justify-center",onClick:()=>Xi(!0),children:[o.jsx(Py,{className:"w-4 h-4 mr-2 opacity-90"}),"Cancelar agendamento",o.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-red-700/50 rounded border border-red-500/30",children:"F3"})]}),o.jsxs(oe,{type:"button",variant:"secondary",className:"bg-teal-600 hover:bg-teal-500 text-white border-teal-700 w-full sm:w-auto justify-center",onClick:()=>{i()},children:[o.jsx(Ui,{className:"w-4 h-4 mr-2 opacity-90"}),o.jsx("span",{className:"hidden sm:inline",children:"Gerenciar Pagamentos"}),o.jsx("span",{className:"sm:hidden",children:"Pagamentos"}),o.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-teal-700/50 rounded border border-teal-500/30",children:"F4"})]})]}),o.jsx(Md,{open:Ro,onOpenChange:Xi,children:o.jsxs(Gc,{children:[o.jsxs(Kc,{children:[o.jsx(Xc,{children:"Cancelar agendamento?"}),o.jsx(Jc,{children:'Ao cancelar, este agendamento deixar de aparecer na agenda padro. Ele s ser visvel ao selecionar o filtro "Cancelados".'})]}),o.jsxs(Yc,{children:[o.jsx(Qc,{children:"Voltar"}),o.jsx(Rd,{className:"bg-red-600 hover:bg-red-500",onClick:async()=>{try{Xi(!1),re(!1),await jn(De.id,"canceled","user"),t({title:"Agendamento cancelado"})}catch(ge){t({title:"Erro ao cancelar",description:ge?.message||"Tente novamente."})}},children:"Confirmar cancelamento"})]})]})})]}),o.jsxs("div",{className:"flex gap-2 w-full sm:w-auto sm:ml-auto",children:[o.jsxs(oe,{type:"button",variant:"ghost",className:"border border-white/10 flex-1 sm:flex-none",onClick:async()=>{if(De?.id){console.log(" [Auto-save] Salvando ao fechar modal...");try{Ra.current&&clearTimeout(Ra.current),await Jo({autoSave:!0}),console.log(" [Auto-save] Salvo ao fechar!")}catch(ge){console.error(" [Auto-save] Erro ao salvar ao fechar:",ge)}}re(!1)},children:["Fechar",o.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-white/10 rounded border border-white/20",children:"Esc"})]}),!De?.id&&o.jsxs(oe,{type:"button",className:"bg-emerald-600 hover:bg-emerald-500 text-white disabled:opacity-60 disabled:cursor-not-allowed flex-1 sm:flex-none",disabled:ga,onClick:async()=>{try{if(ga)return;if(G&&!De){ee(!0);return}yi.current=!0,Xo.current=!1,await Jo()}catch{}},children:["Salvar",o.jsx("kbd",{className:"hidden sm:inline ml-2 px-2 py-1 text-sm font-mono bg-emerald-700/50 rounded border border-emerald-500/30",children:""})]})]})]})})]})}),o.jsx(Md,{open:Z,onOpenChange:ee,children:o.jsxs(Gc,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[o.jsxs(Kc,{children:[o.jsxs(Xc,{className:"flex items-center gap-3 text-xl",children:[o.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-lg bg-orange-600/20 border border-orange-600/40",children:o.jsx("svg",{className:"w-6 h-6 text-orange-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),"Confirmar Criao de Agendamentos Recorrentes"]}),o.jsxs(Jc,{className:"space-y-4 mt-4",children:[X.date&&pe>=2&&o.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-3",children:[o.jsx("p",{className:"text-xs font-semibold text-slate-300 mb-2 uppercase tracking-wide",children:" Datas que sero criadas:"}),o.jsx("div",{className:"grid grid-cols-2 gap-2",children:Array.from({length:pe}).map((ge,Le)=>{const Ve=Ia(X.date,Le*7);return o.jsxs("div",{className:"flex items-center gap-2 bg-slate-700/50 border border-slate-600 rounded px-2 py-1.5",children:[o.jsxs("span",{className:"text-xs font-semibold text-slate-400",children:["#",Le+1]}),o.jsx("span",{className:"text-xs font-medium text-white",children:Jt(Ve,"dd/MM/yyyy '('EEEE')'",{locale:ia})})]},Le)})})]}),o.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 rounded-lg p-4",children:[o.jsx("h4",{className:"text-sm font-semibold text-slate-300 mb-3 uppercase tracking-wide",children:"Resumo do Agendamento"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-700/50",children:[o.jsx("span",{className:"text-sm text-slate-400",children:"Quadra"}),o.jsx("span",{className:"font-semibold text-white",children:Qt[X.court]?.name||X.court})]}),o.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-700/50",children:[o.jsx("span",{className:"text-sm text-slate-400",children:"Horrio"}),o.jsxs("span",{className:"font-semibold text-white font-mono",children:[m9(X.startMinutes)," - ",m9(X.endMinutes)]})]}),o.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-700/50",children:[o.jsx("span",{className:"text-sm text-slate-400",children:"Modalidade"}),o.jsx("span",{className:"font-semibold text-white",children:X.modality})]}),o.jsxs("div",{className:"flex items-start justify-between py-2",children:[o.jsx("span",{className:"text-sm text-slate-400",children:"Participantes"}),o.jsx("div",{className:"text-right max-w-xs",children:X.selectedClients?.length>0?o.jsxs("div",{className:"font-semibold text-white",children:[kt?X.selectedClients.map(ge=>ge.nome).join(", "):X.selectedClients.slice(0,3).map(ge=>ge.nome).join(", "),!kt&&X.selectedClients.length>3&&o.jsxs("span",{className:"text-slate-400",children:[" +",X.selectedClients.length-3]}),X.selectedClients.length>3&&o.jsxs(o.Fragment,{children:[" ",o.jsx("button",{type:"button",onClick:()=>Nt(!kt),className:"text-xs text-blue-400 hover:text-blue-300 underline inline",children:kt?"Ver menos":"Ver todos"})]})]}):o.jsx("span",{className:"font-semibold text-white",children:"Nenhum participante"})})]})]})]}),o.jsx("div",{className:"bg-red-900/30 border-l-4 border-red-600 rounded-r-lg p-4",children:o.jsxs("div",{className:"flex gap-3",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("svg",{className:"w-5 h-5 text-red-400 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),o.jsx("div",{children:o.jsxs("p",{className:"text-sm text-gray-300",children:[o.jsx("strong",{className:"text-red-300",children:"Importante:"})," Aps criar, editar ou cancelar exigir alterar cada agendamento individualmente. Certifique-se de que todos os dados esto corretos!"]})})]})})]})]}),o.jsxs(Yc,{className:"gap-2",children:[o.jsx(Qc,{onClick:()=>{ee(!1),Nt(!1)},className:"border-slate-600 hover:bg-slate-800",children:"Cancelar e Revisar"}),o.jsxs(Rd,{className:"bg-emerald-700 hover:bg-emerald-600 text-white font-semibold",onClick:async()=>{ee(!1),Nt(!1),yi.current=!0,Xo.current=!1,await Jo()},children:[o.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Confirmar e Criar ",pe," Agendamentos"]})]})]})}),jt&&o.jsx(nre,{open:jt,onOpenChange:ge=>{Rt(ge),ge||(pr(null),window.__paymentModalCallback&&(window.__paymentModalCallback=null))},client:ar,onSaved:ge=>{try{if(ge&&typeof ge=="object"){console.warn("[CustomerPicker][onSaved:START]",{clientId:ge.id,clientName:ge.nome,currentSelection:Array.isArray(gt.current)?gt.current.length:0});try{ie.current=Date.now()+3e3,Se.current=Date.now()+3e3,Ft.current=Date.now()+3e3}catch{}(vo||[]).some(Ve=>typeof Ve=="object"?Ve.id===ge.id:!1)||(As(Ve=>[...Ve||[],ge]),wn(Ve=>[...Ve||[],ge])),Me(Ve=>{const xt=Array.isArray(Ve.selectedClients)?Ve.selectedClients:[],Ct={id:ge.id,nome:ge.nome||ge.name||We(ge),codigo:ge.codigo},_r=xt.filter(lr=>lr.id!==ge.id),Kt=[Ct,..._r];try{gt.current=Kt}catch{}try{Lt.current=Kt}catch{}try{Ya(Kt)}catch{}try{sessionStorage.setItem(Rn,JSON.stringify(Kt))}catch{}try{Xn.current=!1}catch{}return console.warn("[CustomerPicker][onSaved:COMPLETE]",{newClientId:ge.id,newClientName:ge.nome,totalSelected:Kt.length,refsSynced:!0,protectionActive:!0}),{...Ve,selectedClients:Kt}}),Promise.resolve().then(()=>{try{const Ve=Array.isArray(gt.current)?gt.current:[];Ve.length>0&&(Me(xt=>({...xt,selectedClients:[...Ve]})),console.warn("[CustomerPicker][onSaved:REASSERT]",{count:Ve.length}))}catch{}})}if(window.__paymentModalCallback&&typeof window.__paymentModalCallback=="function")try{window.__protectPaymentModal&&window.__protectPaymentModal(3e3),window.__paymentModalCallback(),window.__paymentModalCallback=null}catch(Le){console.error("[PaymentModal][callback:ERROR]",Le)}}catch(Le){console.error("[CustomerPicker][onSaved:ERROR]",Le)}}}),a&&o.jsx(lQe,{setIsModalOpen:re,setBookings:K,form:X,setForm:Me,localCustomers:vo,onOpenClientModal:ge=>{Rt(!0),window.__paymentModalCallback=ge}}),l&&o.jsx(cQe,{form:X,setForm:Me,localCustomers:vo})]})},jr=p.useMemo(()=>{const ie=Jt(D,"yyyy-MM-dd");let be=le.filter(Ge=>Jt(Ge.start,"yyyy-MM-dd")===ie);if(be=nt.canceledOnly?be.filter(Ge=>Ge.status==="canceled"):be.filter(Ge=>Ge.status!=="canceled"),nt.pendingPayments&&(be=be.filter(Ge=>{const We=ft[Ge.id]||[];return We.some(qe=>String(qe.status_pagamento||"").toLowerCase()!=="pago")&&We.length>0})),Ht.trim()){const Ge=Ht.trim().toLowerCase();be=be.filter(We=>(We.customer||"").toLowerCase().includes(Ge)||(We.court||"").toLowerCase().includes(Ge)||($s[We.status]?.label||"").toLowerCase().includes(Ge))}return nt.scheduled||nt.canceledOnly||nt.pendingPayments?be:[]},[le,D,nt.scheduled,nt.canceledOnly,nt.pendingPayments,Ht,ft]),cr=p.useMemo(()=>{const ie=Jt(D,"yyyy-MM-dd"),be=wr||Tr[0],Ge=le.filter(_t=>Jt(_t.start,"yyyy-MM-dd")===ie&&_t.status!=="canceled"&&_t.court===be);let We=0;return Ge.forEach(_t=>{const X=(ft[_t.id]||[]).filter(Me=>String(Me.status_pagamento||"").toLowerCase()!=="pago").length;We+=X}),{totalBookings:Ge.length,totalPendingPayments:We}},[le,D,ft,wr,Tr]),It=p.useMemo(()=>{const ie=tp(D),be=Ia(ie,6);let Ge=le.filter(We=>{const _t=ni(We.start),qe=ni(ie),X=ni(be);return _t>=qe&&_t<=X});if(Ge=nt.canceledOnly?Ge.filter(We=>We.status==="canceled"):Ge.filter(We=>We.status!=="canceled"),nt.pendingPayments&&(Ge=Ge.filter(We=>{const _t=ft[We.id]||[];return _t.some(X=>String(X.status_pagamento||"").toLowerCase()!=="pago")&&_t.length>0})),Ht.trim()){const We=Ht.trim().toLowerCase();Ge=Ge.filter(_t=>(_t.customer||"").toLowerCase().includes(We)||(_t.court||"").toLowerCase().includes(We)||($s[_t.status]?.label||"").toLowerCase().includes(We))}return nt.scheduled||nt.canceledOnly||nt.pendingPayments?Ge:[]},[le,D,nt.scheduled,nt.canceledOnly,nt.pendingPayments,Ht,ft]);p.useEffect(()=>{if(!Ht.trim()||!(nt.scheduled||nt.canceledOnly||nt.pendingPayments)||!jr||jr.length===0)return;const ie=[...jr].sort((Ge,We)=>Ge.start-We.start)[0];if(!ie?.id)return;const be=document.getElementById(`booking-${ie.id}`);be?.scrollIntoView&&be.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},[Ht,jr,nt.scheduled,nt.canceledOnly,nt.pendingPayments]),p.useEffect(()=>{const ie=va.current,be=xa.current||{},Ge=nt.canceledOnly&&!be.canceledOnly,We=nt.scheduled&&!be.scheduled&&!nt.canceledOnly,_t=nt.pendingPayments&&!be.pendingPayments;if(!ie||!Ge&&!We&&!_t){xa.current={scheduled:nt.scheduled,canceledOnly:nt.canceledOnly,pendingPayments:nt.pendingPayments};return}const qe=jr||[];if(qe.length===0){xa.current={scheduled:nt.scheduled,canceledOnly:nt.canceledOnly,pendingPayments:nt.pendingPayments};return}const X=ie.getBoundingClientRect();if(!qe.some(gt=>{const ir=document.getElementById(`booking-${gt.id}`);if(!ir)return!1;const Dr=ir.getBoundingClientRect();return Dr.bottom>X.top&&Dr.top<X.bottom})){const gt=[...qe].sort((Dr,O)=>Dr.start-O.start)[0],ir=gt&&document.getElementById(`booking-${gt.id}`);ir?.scrollIntoView&&ir.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}xa.current={scheduled:nt.scheduled,canceledOnly:nt.canceledOnly,pendingPayments:nt.pendingPayments}},[nt.scheduled,nt.canceledOnly,nt.pendingPayments,jr]);const Ir=p.useMemo(()=>{if(!wr||!Qt[wr])return{start:At,end:St};const ie=Qt[wr],be=ie.hora_inicio||`${At}:00:00`,Ge=ie.hora_fim||`${St}:00:00`,[We,_t]=String(be).split(":").map(Number),[qe,X]=String(Ge).split(":").map(Number),Me=qe===0&&X===0?24:qe,gt=Me*60+(X||0);return{start:We||At,end:Me||St,startMinutes:(We||0)*60+(_t||0),endMinutes:gt}},[wr,Qt,At,St]);return p.useMemo(()=>{const ie=Ir.start,be=Ir.end;return Array.from({length:Math.max(0,be-ie)},(Ge,We)=>ie+We)},[Ir]),p.useMemo(()=>{const ie=Ir.start,be=Ir.end;return Math.max(0,be-ie)*(60/ja)*xs},[Ir]),o.jsxs(o.Fragment,{children:[o.jsxs(fr.div,{variants:Q?void 0:gQe,initial:Q?!1:"hidden",animate:Q?!1:"visible",className:Yt("h-full w-full flex flex-col md:px-0",$&&"fixed inset-0 z-40 bg-surface"),children:[o.jsx(fr.div,{variants:f9,className:"p-3 bg-surface mb-6 md:rounded-lg",children:o.jsxs("div",{className:"max-w-[1200px] mx-auto w-full flex flex-col gap-3 md:flex-row md:items-center md:gap-4",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(oe,{variant:"ghost",size:"icon",className:"h-9 w-9",onClick:()=>B(U==="day"?My(D,1):My(D,7)),children:o.jsx(tH,{className:"h-5 w-5"})}),o.jsxs(xc,{children:[o.jsx(yc,{asChild:!0,children:o.jsxs(oe,{variant:"ghost",className:"w-full sm:w-auto max-w-full justify-center text-base font-semibold whitespace-nowrap truncate",children:[o.jsx(Ei,{className:"mr-2 h-5 w-5"}),U==="day"?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"hidden sm:inline",children:Jt(D,"EEE, dd 'de' MMMM 'de' yyyy",{locale:ia})}),o.jsx("span",{className:"sm:hidden",children:Jt(D,"EEE, dd/MM/yyyy",{locale:ia})})]}):o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"hidden sm:inline",children:pQe(D)}),o.jsxs("span",{className:"sm:hidden",children:[Jt(tp(D),"dd/MM/yyyy")," - ",Jt(Ia(tp(D),6),"dd/MM/yyyy")]})]})]})}),o.jsx(Rl,{className:"w-auto p-0",children:o.jsx(bc,{mode:"single",selected:D,onSelect:ie=>ie&&B(ie),initialFocus:!0})})]}),o.jsx(oe,{variant:"ghost",size:"icon",className:"h-9 w-9",onClick:()=>B(U==="day"?Ia(D,1):Ia(D,7)),children:o.jsx(Kx,{className:"h-5 w-5"})})]}),Tr.length>0&&o.jsx("div",{className:"hidden md:flex md:justify-center md:flex-1",children:Tr.length===1?o.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg w-52 h-10 border-2 border-brand/30 bg-gradient-to-r from-brand/5 to-brand/10",children:[o.jsx("div",{className:"h-3 w-3 rounded-full shadow-sm",style:{backgroundColor:hm(Tr[0])}}),o.jsx("span",{className:"font-semibold text-sm",children:Tr[0]})]}):o.jsxs(En,{value:wr||Tr[0],onValueChange:ie=>{Fr(ie)},children:[o.jsx(Sn,{className:"w-52 h-10 border-2 border-brand/30 bg-gradient-to-r from-brand/5 to-brand/10 hover:border-brand/50 hover:bg-gradient-to-r hover:from-brand/10 hover:to-brand/15 transition-all shadow-sm",children:o.jsx(kn,{placeholder:"Selecionar quadra"})}),o.jsx(Cn,{className:"border-brand/30",children:Tr.map(ie=>{const be=hm(ie);return o.jsx(wt,{value:ie,children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"h-3 w-3 rounded-full shadow-sm",style:{backgroundColor:be}}),o.jsx("span",{className:"font-semibold",children:ie})]})},ie)})})]})}),o.jsxs("div",{className:"flex flex-col gap-3 w-full md:w-auto md:ml-auto",children:[o.jsxs("div",{className:"flex items-center gap-3 justify-center md:hidden",children:[o.jsxs("div",{className:"flex items-center border border-border rounded-lg bg-surface-2/30 p-0.5",children:[o.jsx(oe,{variant:U==="day"?"default":"ghost",size:"sm",className:"h-8 px-3 text-xs font-medium",onClick:()=>z("day"),children:"Dia"}),o.jsx(oe,{variant:U==="week"?"default":"ghost",size:"sm",className:"h-8 px-3 text-xs font-medium",onClick:()=>z("week"),children:"Semana"})]}),o.jsxs(Uy,{children:[o.jsx(Vy,{asChild:!0,children:o.jsxs(oe,{variant:"outline",size:"sm",className:"gap-2",disabled:qr.length===0,children:[o.jsx(n6,{className:"h-4 w-4"})," Filtros"]})}),o.jsxs(zv,{align:"end",className:"w-64",children:[o.jsxs("div",{className:"flex items-center justify-between px-2 py-1.5",children:[o.jsx(W3,{className:"p-0",children:"Exibio"}),o.jsx(oe,{variant:"ghost",size:"sm",className:"h-7 text-xs text-text-muted hover:text-text-primary",onClick:()=>$t({scheduled:!0,available:!0,canceledOnly:!1,pendingPayments:!1}),children:"Limpar"})]}),o.jsx(jj,{}),o.jsx(sl,{onClick:ie=>ie.preventDefault(),children:o.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Ei,{className:"h-4 w-4 text-text-muted"}),o.jsx("span",{children:"Agendados"})]}),o.jsx(Bo,{checked:nt.scheduled,onCheckedChange:ie=>$t(be=>({...be,scheduled:!!ie,canceledOnly:ie?!1:be.canceledOnly}))})]})}),o.jsx(sl,{onClick:ie=>ie.preventDefault(),children:o.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Pk,{className:"h-4 w-4 text-text-muted"}),o.jsx("span",{children:"Livres"})]}),o.jsx(Bo,{checked:nt.available,onCheckedChange:ie=>$t(be=>({...be,available:!!ie,canceledOnly:ie?!1:be.canceledOnly}))})]})}),o.jsx(sl,{onClick:ie=>ie.preventDefault(),children:o.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Py,{className:"h-4 w-4 text-rose-400"}),o.jsx("span",{children:"Cancelados"})]}),o.jsx(Bo,{checked:nt.canceledOnly,onCheckedChange:ie=>{const be=!!ie;$t(Ge=>({...Ge,canceledOnly:be,scheduled:be?!1:Ge.scheduled,available:be?!1:Ge.available})),be&&!ct&&Cr(!0)}})]})}),o.jsx(sl,{onClick:ie=>ie.preventDefault(),children:o.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Ui,{className:"h-4 w-4 text-warning"}),o.jsx("span",{children:"Pagamentos Pendentes"})]}),o.jsx(Bo,{checked:nt.pendingPayments,onCheckedChange:ie=>$t(be=>({...be,pendingPayments:!!ie}))})]})})]})]}),o.jsxs("div",{className:"relative inline-block group",children:[o.jsx(oe,{variant:$?"default":"ghost",size:"icon",className:"h-8 w-8",onClick:()=>Y(!$),"aria-label":$?"Minimizar grid":"Expandir grid",children:$?o.jsx(ZL,{className:"h-4 w-4"}):o.jsx(QL,{className:"h-4 w-4"})}),o.jsx("div",{className:"hidden group-hover:block absolute right-0 mt-1 z-50 pointer-events-none",children:o.jsx("div",{className:"px-2 py-1 rounded-md bg-surface-2 text-xs text-text-primary border border-border shadow",children:$?"Minimizar (F10)":"Expandir (F10)"})})]}),o.jsx(oe,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>Xe(!0),disabled:qr.length===0,"aria-label":"Configurar agenda",title:"Configurar agenda",children:o.jsx(zm,{className:"h-5 w-5"})})]}),o.jsxs("div",{className:"flex items-center gap-3 justify-end flex-shrink-0",children:[o.jsxs("div",{className:"relative w-full sm:w-56",children:[o.jsx(pi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(or,{placeholder:"Buscar agendamento...",className:"pl-9",value:Ht,onChange:ie=>dr(ie.target.value),onBlur:()=>dr("")}),Ht&&o.jsx("button",{type:"button","aria-label":"Limpar busca",className:"absolute right-2 top-1/2 -translate-y-1/2 px-2 py-0.5 rounded text-xs font-medium text-primary hover:bg-surface-2",onClick:()=>dr(""),children:"Limpar"})]}),o.jsxs(oe,{size:"sm",onClick:()=>{st(null),ut(null);try{sessionStorage.removeItem("agenda:customerPicker:closing"),sessionStorage.removeItem("agenda:customerPicker:closingAt")}catch{}lt()},"aria-label":"Novo agendamento",className:"gap-2",disabled:qr.length===0||Tr.every(ie=>de[ie]&&!de[ie].funciona),children:[o.jsx(Ka,{className:"h-4 w-4"})," Agendar"]})]}),Tr.length>0&&o.jsx("div",{className:"md:hidden flex justify-center",children:Tr.length===1?o.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg w-full h-10 border-2 border-brand/30 bg-gradient-to-r from-brand/5 to-brand/10",children:[o.jsx("div",{className:"h-3 w-3 rounded-full shadow-sm",style:{backgroundColor:hm(Tr[0])}}),o.jsx("span",{className:"font-semibold text-sm",children:Tr[0]})]}):o.jsxs(En,{value:Tr[Ur%Tr.length],onValueChange:ie=>{const be=Tr.indexOf(ie);be!==-1&&Kr(be)},children:[o.jsx(Sn,{className:"w-48 h-10 border-2 border-brand/30 bg-gradient-to-r from-brand/5 to-brand/10 hover:border-brand/50 hover:bg-gradient-to-r hover:from-brand/10 hover:to-brand/15 transition-all shadow-sm",children:o.jsx(kn,{placeholder:"Selecionar quadra"})}),o.jsx(Cn,{className:"border-brand/30",children:Tr.map(ie=>{const be=hm(ie);return o.jsx(wt,{value:ie,children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"h-3 w-3 rounded-full shadow-sm",style:{backgroundColor:be}}),o.jsx("span",{className:"font-semibold",children:ie})]})},ie)})})]})}),o.jsxs("div",{className:"hidden md:flex items-center gap-3 justify-end",children:[o.jsxs("div",{className:"flex items-center border border-border rounded-lg bg-surface-2/30 p-0.5",children:[o.jsx(oe,{variant:U==="day"?"default":"ghost",size:"sm",className:"h-8 px-3 text-xs font-medium",onClick:()=>z("day"),children:"Dia"}),o.jsx(oe,{variant:U==="week"?"default":"ghost",size:"sm",className:"h-8 px-3 text-xs font-medium",onClick:()=>z("week"),children:"Semana"})]}),o.jsxs(Uy,{children:[o.jsx(Vy,{asChild:!0,children:o.jsxs(oe,{variant:"outline",size:"sm",className:"gap-2",disabled:qr.length===0,children:[o.jsx(n6,{className:"h-4 w-4"})," Filtros"]})}),o.jsxs(zv,{align:"end",className:"w-64",children:[o.jsxs("div",{className:"flex items-center justify-between px-2 py-1.5",children:[o.jsx(W3,{className:"p-0",children:"Exibio"}),o.jsx(oe,{variant:"ghost",size:"sm",className:"h-7 text-xs text-text-muted hover:text-text-primary",onClick:()=>$t({scheduled:!0,available:!0,canceledOnly:!1,pendingPayments:!1}),children:"Limpar"})]}),o.jsx(jj,{}),o.jsx(sl,{onClick:ie=>ie.preventDefault(),children:o.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Ei,{className:"h-4 w-4 text-text-muted"}),o.jsx("span",{children:"Agendados"})]}),o.jsx(Bo,{checked:nt.scheduled,onCheckedChange:ie=>$t(be=>({...be,scheduled:!!ie,canceledOnly:ie?!1:be.canceledOnly}))})]})}),o.jsx(sl,{onClick:ie=>ie.preventDefault(),children:o.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Pk,{className:"h-4 w-4 text-text-muted"}),o.jsx("span",{children:"Livres"})]}),o.jsx(Bo,{checked:nt.available,onCheckedChange:ie=>$t(be=>({...be,available:!!ie,canceledOnly:ie?!1:be.canceledOnly}))})]})}),o.jsx(sl,{onClick:ie=>ie.preventDefault(),children:o.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Py,{className:"h-4 w-4 text-rose-400"}),o.jsx("span",{children:"Cancelados"})]}),o.jsx(Bo,{checked:nt.canceledOnly,onCheckedChange:ie=>{const be=!!ie;$t(Ge=>({...Ge,canceledOnly:be,scheduled:be?!1:Ge.scheduled,available:be?!1:Ge.available})),be&&!ct&&Cr(!0)}})]})}),o.jsx(sl,{onClick:ie=>ie.preventDefault(),children:o.jsxs("div",{className:"flex items-center justify-between gap-3 w-full",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Ui,{className:"h-4 w-4 text-warning"}),o.jsx("span",{children:"Pagamentos Pendentes"})]}),o.jsx(Bo,{checked:nt.pendingPayments,onCheckedChange:ie=>$t(be=>({...be,pendingPayments:!!ie}))})]})})]})]}),o.jsxs("div",{className:"relative inline-block group",children:[o.jsx(oe,{variant:$?"default":"ghost",size:"icon",className:"h-8 w-8",onClick:()=>Y(!$),"aria-label":$?"Minimizar grid":"Expandir grid",children:$?o.jsx(ZL,{className:"h-4 w-4"}):o.jsx(QL,{className:"h-4 w-4"})}),o.jsx("div",{className:"hidden group-hover:block absolute right-0 mt-1 z-50 pointer-events-none",children:o.jsx("div",{className:"px-2 py-1 rounded-md bg-surface-2 text-xs text-text-primary border border-border shadow",children:$?"Minimizar (F10)":"Expandir (F10)"})})]}),o.jsx(oe,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>Xe(!0),disabled:qr.length===0,"aria-label":"Configurar agenda",title:"Configurar agenda",children:o.jsx(zm,{className:"h-5 w-5"})})]})]})]})}),o.jsx(ln,{open:Ye,onOpenChange:ie=>{ie||dt(Pt),Xe(ie)},children:o.jsxs(on,{className:"sm:max-w-[680px]",onOpenAutoFocus:ie=>ie.preventDefault(),children:[o.jsx(nn,{className:"pb-3 border-b border-border bg-surface-2/40 rounded-t-lg px-2 -mx-2 -mt-2",children:o.jsx(rn,{className:"text-base font-semibold tracking-tight",children:"Configuraes da Agenda"})}),o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center gap-2 text-text-secondary",children:[o.jsx(Ai,{className:"h-4 w-4",style:{color:$s.confirmed.hex}}),o.jsx("span",{className:"text-sm font-medium",children:"Confirmao automtica"})]}),o.jsxs("div",{className:"rounded-lg border border-border bg-surface-2/40 p-4 space-y-3",style:{borderLeftWidth:3,borderLeftColor:$s.confirmed.hex},children:[o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Bo,{id:"autoConfirmEnabled",checked:Ze.autoConfirmEnabled,onCheckedChange:ie=>dt(be=>({...be,autoConfirmEnabled:!!ie}))}),o.jsxs("span",{className:"inline-flex items-center gap-2",children:[o.jsx("span",{className:"inline-block w-2 h-2 rounded-full",style:{backgroundColor:$s.confirmed.hex}}),o.jsx(Wt,{htmlFor:"autoConfirmEnabled",className:"font-medium",children:"Confirmao automtica"})]})]})}),o.jsxs("div",{className:"space-y-1",children:[o.jsx(Wt,{htmlFor:"autoconfirm-hours",className:"text-sm text-text-muted",children:"Confirmar se faltar"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs(En,{value:String(Math.max(0,Math.round((Ze.autoConfirmMinutesBefore||0)/60))),onValueChange:ie=>dt(be=>({...be,autoConfirmMinutesBefore:Math.max(0,Number(ie))*60})),disabled:!Ze.autoConfirmEnabled,children:[o.jsx(Sn,{className:"w-32",children:o.jsx(kn,{placeholder:"Horas"})}),o.jsxs(Cn,{align:"start",children:[o.jsx(wt,{value:"0",children:"Imediato"}),o.jsx(wt,{value:"1",children:"1 h"}),o.jsx(wt,{value:"2",children:"2 h"}),o.jsx(wt,{value:"3",children:"3 h"}),o.jsx(wt,{value:"4",children:"4 h"}),o.jsx(wt,{value:"6",children:"6 h"}),o.jsx(wt,{value:"8",children:"8 h"}),o.jsx(wt,{value:"12",children:"12 h"}),o.jsx(wt,{value:"24",children:"24 h"})]})]}),o.jsx("span",{className:"text-sm text-text-muted",children:"antes"})]})]})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center gap-2 text-text-secondary",children:[o.jsx(oH,{className:"h-4 w-4",style:{color:$s.in_progress.hex}}),o.jsx("span",{className:"text-sm font-medium",children:"Transies automticas"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"rounded-lg border border-border bg-surface-2/40 p-4 space-y-2",style:{borderLeftWidth:3,borderLeftColor:$s.in_progress.hex},children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Bo,{id:"autoStartEnabled",checked:Ze.autoStartEnabled,onCheckedChange:ie=>dt(be=>({...be,autoStartEnabled:!!ie}))}),o.jsxs("span",{className:"inline-flex items-center gap-2",children:[o.jsx("span",{className:"inline-block w-2 h-2 rounded-full",style:{backgroundColor:$s.in_progress.hex}}),o.jsx(Wt,{htmlFor:"autoStartEnabled",className:"font-medium",children:"Iniciar no horrio"})]})]}),o.jsx("p",{className:"text-xs text-text-muted ml-7",children:"Confirmado  Em andamento no horrio de incio."})]}),o.jsxs("div",{className:"rounded-lg border border-border bg-surface-2/40 p-4 space-y-2",style:{borderLeftWidth:3,borderLeftColor:$s.finished.hex},children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Bo,{id:"autoFinishEnabled",checked:Ze.autoFinishEnabled,onCheckedChange:ie=>dt(be=>({...be,autoFinishEnabled:!!ie}))}),o.jsxs("span",{className:"inline-flex items-center gap-2",children:[o.jsx("span",{className:"inline-block w-2 h-2 rounded-full",style:{backgroundColor:$s.finished.hex}}),o.jsx(Wt,{htmlFor:"autoFinishEnabled",className:"font-medium",children:"Finalizar ao trmino"})]})]}),o.jsx("p",{className:"text-xs text-text-muted ml-7",children:"Em andamento  Finalizado no horrio de trmino."})]})]})]})]}),o.jsxs(Un,{className:"mt-2 gap-2",children:[o.jsx(oe,{type:"button",variant:"ghost",className:"border border-white/10",onClick:()=>Xe(!1),children:"Cancelar"}),o.jsx(oe,{type:"button",variant:"default",onClick:()=>{console.log(" BOTO SALVAR CLICADO!"),pn()},disabled:Er,children:Er?"Salvando":"Salvar"})]})]})}),o.jsx(ln,{open:Vt,onOpenChange:Cr,children:o.jsxs(on,{className:"sm:max-w-[520px]",onOpenAutoFocus:ie=>ie.preventDefault(),children:[o.jsxs(nn,{children:[o.jsx(rn,{children:"Sobre agendamentos cancelados"}),o.jsx(_n,{children:"Agendamentos cancelados no aparecem na agenda quando o filtro no est selecionado e no ocupam horrio."})]}),o.jsxs("div",{className:"flex items-start gap-3 mt-2",children:[o.jsx(Bo,{id:"hide-canceled-info",checked:ct,onCheckedChange:ie=>Gt(!!ie),className:"mt-0.5"}),o.jsx(Wt,{htmlFor:"hide-canceled-info",className:"text-sm cursor-pointer text-text-secondary",children:"No mostrar novamente"})]}),o.jsx(Un,{className:"mt-4",children:o.jsx(oe,{type:"button",onClick:()=>Cr(!1),children:"Entendi"})})]})}),!In&&qr.length===0&&o.jsxs("div",{className:"mb-4 p-4 rounded-lg border border-border bg-surface text-sm flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[o.jsxs("div",{children:[o.jsx("div",{className:"font-medium",children:"Nenhuma quadra encontrada"}),o.jsx("div",{className:"text-text-muted",children:"Cadastre suas quadras para comear a usar a agenda."})]}),o.jsx(oe,{asChild:!0,className:"w-full sm:w-auto",children:o.jsxs(kI,{to:"/quadras",children:[o.jsx("span",{className:"hidden sm:inline",children:"Ir para Cadastros  Quadras"}),o.jsx("span",{className:"sm:hidden",children:"Adicionar"})]})})]}),Tr.length>0&&U==="week"&&(()=>{const ie=wr||Tr[0],be=It.filter(Ge=>Ge.court===ie);return o.jsx(o.Fragment,{children:o.jsx(mQe,{weekStart:tp(D),weekBookings:be,activeCourtFilter:ie,courtsMap:Qt,participantsByAgendamento:ft,onBookingClick:Ge=>{st(Ge),re(!0)},onSlotClick:(Ge,We)=>{st(null);const _t=Ge.getHours()*60+Ge.getMinutes(),qe=We||wr||Tr[0],X=Jt(Ge,"yyyy-MM-dd"),Me=(()=>{try{return(le||[]).filter(F=>F.court===qe&&Jt(F.start,"yyyy-MM-dd")===X&&F.status!=="canceled").map(F=>cu(F.start)*60+du(F.start)).filter(F=>F>_t).sort((F,fe)=>F-fe)[0]}catch{}})(),gt=(()=>{const F=Qt[qe]?.hora_fim;if(!F)return St*60;const[fe,we]=String(F).split(":").map(Number);return(fe===0&&(we||0)===0?24:fe)*60+(we||0)})(),ir=typeof Me=="number"?Me:gt;let Dr=Math.min(_t+60,ir);Dr-_t<30&&(ir-30>=_t?Dr=ir:Dr=Math.min(gt,_t+30));const O={date:ni(Ge),court:qe,startMinutes:_t,endMinutes:Dr};console.log("onSlotClick in AgendaPage - BEFORE setPrefill",{slotDate:Ge,court:We,activeCourtFilter:wr,selectedCourts:Tr,startMinutes:_t,endMinutes:Dr,prefillData:O}),ut(O),console.log("onSlotClick in AgendaPage - AFTER setPrefill (state not updated yet)");try{sessionStorage.removeItem("agenda:customerPicker:closing"),sessionStorage.removeItem("agenda:customerPicker:closingAt")}catch{}lt()},statusConfig:$s,dayStartHour:At,dayEndHourExclusive:St,weekDiasFuncionamento:W,sidebarVisible:e},`weekly-${ie}`)})})(),Tr.length>0&&U==="day"&&(()=>{const ie=typeof window<"u"&&window.innerWidth<768,be=ie?[Tr[Ur%Tr.length]]:wr?[wr]:Tr,Ge=ie?be[0]:wr,We=(()=>{if(Ge&&Qt[Ge]){const X=Qt[Ge],Me=X.hora_inicio||`${At}:00:00`,gt=X.hora_fim||`${St}:00:00`,[ir]=String(Me).split(":").map(Number),[Dr,O]=String(gt).split(":").map(Number);let F=Dr===0&&O===0?24:Dr;return O>0&&F<24&&(F+=1),{start:ir||At,end:F||St}}return{start:At,end:St}})(),_t=Array.from({length:Math.max(0,We.end-We.start)},(X,Me)=>We.start+Me),qe=Math.max(0,We.end-We.start)*(60/ja)*xs;return be.some(X=>de[X]&&!de[X].funciona),o.jsx(o.Fragment,{children:o.jsx(fr.div,{variants:Q?void 0:f9,className:Yt("bg-surface fx-scroll","overflow-auto",ie?"":"rounded-lg border border-border"),ref:va,style:{flex:"1 1 auto",minWidth:0},children:o.jsxs("div",{className:Yt("grid",!ie&&"mx-auto"),style:{gridTemplateColumns:ie?"60px 1fr":be.length===1?"120px 760px":be.length===2?"120px repeat(2, 520px)":`120px repeat(${be.length}, 1fr)`,width:ie?"100%":be.length<=2?"fit-content":void 0,columnGap:ie?"4px":"16px"},children:[o.jsxs("div",{className:"sticky left-0 bg-surface z-20",children:[o.jsx("div",{className:"sticky top-0 z-20 h-14 border-b border-r border-border bg-surface flex items-center justify-center px-2",children:o.jsxs(Uy,{children:[o.jsx(Vy,{asChild:!0,children:o.jsx(oe,{size:"sm",variant:"ghost",className:"hover:bg-surface-2/50 text-lg font-semibold",children:Vs(D,new Date)?"Hoje":Jt(D,"EEEE",{locale:ia})})}),o.jsxs(zv,{align:"center",children:[o.jsx(sl,{onClick:()=>B(new Date),children:"Hoje"}),o.jsx(jj,{}),(()=>{const X=["Segunda","Tera","Quarta","Quinta","Sexta","Sbado","Domingo"],Me=fd(D,{weekStartsOn:1,locale:ia});return X.map((gt,ir)=>o.jsx(sl,{onClick:()=>B(Ia(Me,ir)),children:gt},gt))})()]})]})}),_t.map(X=>o.jsxs("div",{className:Yt("border-r border-border",X%2===1&&"bg-surface-2/30"),children:[o.jsx("div",{className:"relative border-b border-border/80",style:{height:xs},children:o.jsxs("span",{className:Yt("absolute left-1/2 -translate-x-1/2 top-1/2 -translate-y-1/2 bg-surface rounded font-bold",ie?"px-1 text-sm":"px-2 text-lg"),children:[String(X).padStart(2,"0"),":00"]})}),o.jsx("div",{className:"relative border-b border-border/80",style:{height:xs},children:o.jsxs("span",{className:Yt("absolute left-1/2 -translate-x-1/2 top-1/2 -translate-y-1/2 bg-surface rounded font-bold",ie?"px-1 text-sm":"px-2 text-lg"),children:[String(X).padStart(2,"0"),":30"]})})]},`time-${X}`))]}),be.map((X,Me)=>o.jsxs("div",{className:"relative border-r border-border",children:[o.jsx("div",{className:"h-14 border-b border-border sticky top-0 bg-surface z-10 flex items-center justify-center",children:Me===0&&o.jsxs("div",{className:"flex items-center gap-4",children:[cr.totalBookings>0&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-md bg-surface-2/50",children:[o.jsx("span",{className:"text-lg",children:""}),o.jsx("span",{className:"font-bold text-text-primary",children:cr.totalBookings}),o.jsxs("span",{className:"font-semibold text-xs text-text-muted",children:["agendamento",cr.totalBookings!==1?"s":""]})]}),cr.totalPendingPayments>0&&o.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-md bg-surface-2/50",children:[o.jsx("span",{className:"text-lg",children:""}),o.jsx("span",{className:"font-bold text-text-primary",children:cr.totalPendingPayments}),o.jsxs("span",{className:"font-semibold text-xs text-text-muted",children:["pendente",cr.totalPendingPayments!==1?"s":""]})]})]})}),o.jsxs("div",{className:Yt("relative"),style:{height:qe},children:[de[X]&&!de[X].funciona?(()=>_t.map(gt=>o.jsx("div",{className:"absolute w-full cursor-not-allowed bg-surface/60 flex items-center justify-center border-b border-border/30 transition-colors",style:{height:xs*2,top:_t.indexOf(gt)*xs*2},children:o.jsxs("div",{className:"text-center pointer-events-none",children:[o.jsx(QW,{className:"h-5 w-5 text-text-primary mx-auto mb-1"}),o.jsx("div",{className:"text-xs font-medium text-text-primary mb-1",children:"Fechada"}),de[X].observacao&&o.jsx("div",{className:"text-xs text-text-muted",children:de[X].observacao})]})},`closed-${X}-${gt}`)))():null,(nt.scheduled||nt.canceledOnly||nt.pendingPayments)&&(()=>{const gt=We.start*60,ir=We.end*60,Dr=(()=>{const Xt=Qt[X]?.hora_inicio,jt=Qt[X]?.hora_fim,[Rt,ar]=String(Xt||`${We.start}:00:00`).split(":").map(Number),[pr,Wr]=String(jt||`${We.end}:00:00`).split(":").map(Number),Pr=pr===0&&Wr===0?24:pr||0;return{start:(Rt||0)*60+(ar||0),end:Pr*60+(Wr||0)}})(),O=Math.max(Dr.start,gt),F=Math.min(Dr.end,ir),fe=Math.max(0,Math.floor((O-gt)/ja)),we=Math.max(fe,Math.ceil((F-gt)/ja)),Re=Math.max(0,(ir-gt)/ja),Je=fe*xs,He=Math.min(Re,Math.max(0,we-fe)),Et=Math.max(0,(Re-we)*xs);return o.jsxs(o.Fragment,{children:[Je>0&&o.jsx("div",{style:{height:Je}}),Array.from({length:He},(Xt,jt)=>{const Rt=fe+jt,pr=(Math.floor(Rt/(60/ja))+Math.floor(gt/60))%2===1;return o.jsx("div",{className:Yt("border-b border-border/80",pr&&"bg-surface-2/30"),style:{height:xs}},`base-${X}-slot-${Rt}`)}),Et>0&&o.jsx("div",{style:{height:Et}})]})})(),(nt.scheduled||nt.canceledOnly||nt.pendingPayments)&&jr.filter(gt=>gt.court===X).map(gt=>o.jsx(xr,{booking:gt,courtGridStart:We.start*60,courtGridEnd:We.end*60},gt.id)),nt.available&&!(de[X]&&!de[X].funciona)&&(()=>{const gt=(()=>{const Je=Qt[X]?.hora_inicio;if(!Je)return At*60;const[He,Et]=String(Je).split(":").map(Number);return He*60+(Et||0)})(),ir=(()=>{const Je=Qt[X]?.hora_fim;if(!Je)return St*60;const[He,Et]=String(Je).split(":").map(Number);return(He===0&&Et===0?24:He)*60+(Et||0)})(),Dr=Je=>{const He=cu(Je),Et=du(Je);return He===0&&Et===0?1440:He*60+Et},O=Jt(D,"yyyy-MM-dd"),F=le.filter(Je=>Je.court===X&&Jt(Je.start,"yyyy-MM-dd")===O&&Je.status!=="canceled").map(Je=>[Dr(Je.start),Dr(Je.end)]).sort((Je,He)=>Je[0]-He[0]),fe=[];let we=gt;for(const[Je,He]of F)Je>we&&fe.push([we,Je]),we=Math.max(we,He);we<ir&&fe.push([we,ir]);const Re=({startM:Je,endM:He})=>{const[Et,Xt]=p.useState(null),jt=We.start*60,Rt=Math.floor((Je-jt)/ja),ar=Math.max(1,Math.ceil((He-Je)/ja)),pr=Rt+ar,Wr=Rt*xs-1,Pr=(pr-Rt)*xs+2;let Vr=Math.floor(Je/60),Lt=Math.floor(He/60);Vr>=24&&(Vr=Vr%24),Lt>=24&&(Lt=Lt%24);const xn=`${String(Vr).padStart(2,"0")}:${String(Je%60).padStart(2,"0")}`,Rn=`${String(Lt).padStart(2,"0")}:${String(He%60).padStart(2,"0")}`;return o.jsxs("div",{className:Yt("absolute left-2 right-2 rounded-md border-2 border-dashed text-sm z-0 cursor-pointer","border-[#10B981]","bg-transparent hover:border-[#10B981]/80 hover:shadow-sm"),style:{top:`${Wr}px`,height:`${Pr}px`},onMouseMove:Ma=>{const xi=Ma.currentTarget.getBoundingClientRect(),Xn=Math.min(Math.max(0,Ma.clientY-xi.top),xi.height);let ka=Math.floor(Xn/xs);ka=Math.max(0,Math.min(ka,ar-1)),Xt(ka)},onMouseLeave:()=>Xt(null),onClick:Ma=>{const xi=Ma.currentTarget.getBoundingClientRect(),Xn=Math.min(Math.max(0,Ma.clientY-xi.top),xi.height),ka=Math.floor(Xn/xs);let ma=Je+ka*ja;ma=Math.max(Je,Math.min(ma,He-ja));const Ya=(()=>le.filter(Ro=>Ro.court===X&&Jt(Ro.start,"yyyy-MM-dd")===O).map(Ro=>cu(Ro.start)*60+du(Ro.start)).filter(Ro=>Ro>ma).sort((Ro,Xi)=>Ro-Xi)[0])(),Oi=typeof Ya=="number"?Ya:ir;let us=Math.min(ma+60,Oi);if(us-ma<30){const Xa=Oi-30;Xa>=Je?(ma=Math.max(Je,Math.min(ma,Xa)),us=Oi):(ma=Je,us=Math.min(Oi,He))}st(null);{const Xa=qr||[],Ro=Xa.includes(X)?X:Xa[0]||"";ut({court:Ro,date:D,startMinutes:ma,endMinutes:us})}try{lastNonEmptySelectionRef.current=[],setChipsSnapshot([]),sessionStorage.removeItem(persistLastKey),sessionStorage.removeItem("agenda:customerPicker:closing"),sessionStorage.removeItem("agenda:customerPicker:closingAt")}catch{}lt()},title:`Livre: ${xn}${Rn}`,children:[Et!==null&&o.jsx("div",{className:"pointer-events-none absolute left-[6px] right-[6px] rounded-md border border-white/10 bg-white/5",style:{top:`${Et*xs}px`,height:`${xs}px`}}),o.jsxs("div",{className:"h-full px-3 py-2 flex items-center justify-between",children:[o.jsx("span",{className:"font-medium text-[#10B981]",children:"Livre"}),o.jsxs("span",{className:"text-text-muted",children:[xn,"",Rn]})]})]})};return fe.map(([Je,He],Et)=>o.jsx(Re,{startM:Je,endM:He},`free-${X}-${Et}`))})()]})]},X))]})})})})()]}),er()]})}function h9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function p9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h9(Object(r),!0).forEach(function(n){Ebe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Sl(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var g9=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),oE=function(){return Math.random().toString(36).substring(7).split("").join(".")},v9={INIT:"@@redux/INIT"+oE(),REPLACE:"@@redux/REPLACE"+oE(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+oE()}};function xQe(e){if(typeof e!="object"||e===null)return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function _ne(e,t,r){var n;if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Sl(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Sl(1));return r(_ne)(e,t)}if(typeof e!="function")throw new Error(Sl(2));var a=e,i=t,s=[],l=s,c=!1;function d(){l===s&&(l=s.slice())}function u(){if(c)throw new Error(Sl(3));return i}function f(g){if(typeof g!="function")throw new Error(Sl(4));if(c)throw new Error(Sl(5));var y=!0;return d(),l.push(g),function(){if(y){if(c)throw new Error(Sl(6));y=!1,d();var b=l.indexOf(g);l.splice(b,1),s=null}}}function m(g){if(!xQe(g))throw new Error(Sl(7));if(typeof g.type>"u")throw new Error(Sl(8));if(c)throw new Error(Sl(9));try{c=!0,i=a(i,g)}finally{c=!1}for(var y=s=l,x=0;x<y.length;x++){var b=y[x];b()}return g}function h(g){if(typeof g!="function")throw new Error(Sl(10));a=g,m({type:v9.REPLACE})}function v(){var g,y=f;return g={subscribe:function(b){if(typeof b!="object"||b===null)throw new Error(Sl(11));function w(){b.next&&b.next(u())}w();var j=y(w);return{unsubscribe:j}}},g[g9]=function(){return this},g}return m({type:v9.INIT}),n={dispatch:m,subscribe:f,getState:u,replaceReducer:h},n[g9]=v,n}function x9(e,t){return function(){return t(e.apply(this,arguments))}}function y9(e,t){if(typeof e=="function")return x9(e,t);if(typeof e!="object"||e===null)throw new Error(Sl(16));var r={};for(var n in e){var a=e[n];typeof a=="function"&&(r[n]=x9(a,t))}return r}function Sne(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.length===0?function(n){return n}:t.length===1?t[0]:t.reduce(function(n,a){return function(){return n(a.apply(void 0,arguments))}})}function yQe(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(n){return function(){var a=n.apply(void 0,arguments),i=function(){throw new Error(Sl(15))},s={getState:a.getState,dispatch:function(){return i.apply(void 0,arguments)}},l=t.map(function(c){return c(s)});return i=Sne.apply(void 0,l)(a.dispatch),p9(p9({},a),{},{dispatch:i})}}}var Cne=ye.createContext(null);function bQe(e){e()}var Pne=bQe,wQe=function(t){return Pne=t},jQe=function(){return Pne};function NQe(){var e=jQe(),t=null,r=null;return{clear:function(){t=null,r=null},notify:function(){e(function(){for(var a=t;a;)a.callback(),a=a.next})},get:function(){for(var a=[],i=t;i;)a.push(i),i=i.next;return a},subscribe:function(a){var i=!0,s=r={callback:a,next:null,prev:r};return s.prev?s.prev.next=s:t=s,function(){!i||t===null||(i=!1,s.next?s.next.prev=s.prev:r=s.prev,s.prev?s.prev.next=s.next:t=s.next)}}}}var b9={notify:function(){},get:function(){return[]}};function Ane(e,t){var r,n=b9;function a(f){return c(),n.subscribe(f)}function i(){n.notify()}function s(){u.onStateChange&&u.onStateChange()}function l(){return!!r}function c(){r||(r=t?t.addNestedSub(s):e.subscribe(s),n=NQe())}function d(){r&&(r(),r=void 0,n.clear(),n=b9)}var u={addNestedSub:a,notifyNestedSubs:i,handleChangeWrapper:s,isSubscribed:l,trySubscribe:c,tryUnsubscribe:d,getListeners:function(){return n}};return u}var Ene=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?p.useLayoutEffect:p.useEffect;function _Qe(e){var t=e.store,r=e.context,n=e.children,a=p.useMemo(function(){var l=Ane(t);return{store:t,subscription:l}},[t]),i=p.useMemo(function(){return t.getState()},[t]);Ene(function(){var l=a.subscription;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),i!==t.getState()&&l.notifyNestedSubs(),function(){l.tryUnsubscribe(),l.onStateChange=null}},[a,i]);var s=r||Cne;return ye.createElement(s.Provider,{value:a},n)}var kne={exports:{}},so={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ds=typeof Symbol=="function"&&Symbol.for,CM=ds?Symbol.for("react.element"):60103,PM=ds?Symbol.for("react.portal"):60106,i5=ds?Symbol.for("react.fragment"):60107,s5=ds?Symbol.for("react.strict_mode"):60108,l5=ds?Symbol.for("react.profiler"):60114,c5=ds?Symbol.for("react.provider"):60109,d5=ds?Symbol.for("react.context"):60110,AM=ds?Symbol.for("react.async_mode"):60111,u5=ds?Symbol.for("react.concurrent_mode"):60111,f5=ds?Symbol.for("react.forward_ref"):60112,m5=ds?Symbol.for("react.suspense"):60113,SQe=ds?Symbol.for("react.suspense_list"):60120,h5=ds?Symbol.for("react.memo"):60115,p5=ds?Symbol.for("react.lazy"):60116,CQe=ds?Symbol.for("react.block"):60121,PQe=ds?Symbol.for("react.fundamental"):60117,AQe=ds?Symbol.for("react.responder"):60118,EQe=ds?Symbol.for("react.scope"):60119;function Ec(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case CM:switch(e=e.type,e){case AM:case u5:case i5:case l5:case s5:case m5:return e;default:switch(e=e&&e.$$typeof,e){case d5:case f5:case p5:case h5:case c5:return e;default:return t}}case PM:return t}}}function One(e){return Ec(e)===u5}so.AsyncMode=AM;so.ConcurrentMode=u5;so.ContextConsumer=d5;so.ContextProvider=c5;so.Element=CM;so.ForwardRef=f5;so.Fragment=i5;so.Lazy=p5;so.Memo=h5;so.Portal=PM;so.Profiler=l5;so.StrictMode=s5;so.Suspense=m5;so.isAsyncMode=function(e){return One(e)||Ec(e)===AM};so.isConcurrentMode=One;so.isContextConsumer=function(e){return Ec(e)===d5};so.isContextProvider=function(e){return Ec(e)===c5};so.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===CM};so.isForwardRef=function(e){return Ec(e)===f5};so.isFragment=function(e){return Ec(e)===i5};so.isLazy=function(e){return Ec(e)===p5};so.isMemo=function(e){return Ec(e)===h5};so.isPortal=function(e){return Ec(e)===PM};so.isProfiler=function(e){return Ec(e)===l5};so.isStrictMode=function(e){return Ec(e)===s5};so.isSuspense=function(e){return Ec(e)===m5};so.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===i5||e===u5||e===l5||e===s5||e===m5||e===SQe||typeof e=="object"&&e!==null&&(e.$$typeof===p5||e.$$typeof===h5||e.$$typeof===c5||e.$$typeof===d5||e.$$typeof===f5||e.$$typeof===PQe||e.$$typeof===AQe||e.$$typeof===EQe||e.$$typeof===CQe)};so.typeOf=Ec;kne.exports=so;var kQe=kne.exports,EM=kQe,OQe={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},IQe={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},TQe={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Ine={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},kM={};kM[EM.ForwardRef]=TQe;kM[EM.Memo]=Ine;function w9(e){return EM.isMemo(e)?Ine:kM[e.$$typeof]||OQe}var DQe=Object.defineProperty,MQe=Object.getOwnPropertyNames,j9=Object.getOwnPropertySymbols,RQe=Object.getOwnPropertyDescriptor,LQe=Object.getPrototypeOf,N9=Object.prototype;function Tne(e,t,r){if(typeof t!="string"){if(N9){var n=LQe(t);n&&n!==N9&&Tne(e,n,r)}var a=MQe(t);j9&&(a=a.concat(j9(t)));for(var i=w9(e),s=w9(t),l=0;l<a.length;++l){var c=a[l];if(!IQe[c]&&!(r&&r[c])&&!(s&&s[c])&&!(i&&i[c])){var d=RQe(t,c);try{DQe(e,c,d)}catch{}}}}return e}var $Qe=Tne;const _9=qa($Qe);var Dne={exports:{}},go={};/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g5=60103,v5=60106,mw=60107,hw=60108,pw=60114,gw=60109,vw=60110,xw=60112,yw=60113,OM=60120,bw=60115,ww=60116,Mne=60121,Rne=60122,Lne=60117,$ne=60129,Fne=60131;if(typeof Symbol=="function"&&Symbol.for){var ys=Symbol.for;g5=ys("react.element"),v5=ys("react.portal"),mw=ys("react.fragment"),hw=ys("react.strict_mode"),pw=ys("react.profiler"),gw=ys("react.provider"),vw=ys("react.context"),xw=ys("react.forward_ref"),yw=ys("react.suspense"),OM=ys("react.suspense_list"),bw=ys("react.memo"),ww=ys("react.lazy"),Mne=ys("react.block"),Rne=ys("react.server.block"),Lne=ys("react.fundamental"),$ne=ys("react.debug_trace_mode"),Fne=ys("react.legacy_hidden")}function ou(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case g5:switch(e=e.type,e){case mw:case pw:case hw:case yw:case OM:return e;default:switch(e=e&&e.$$typeof,e){case vw:case xw:case ww:case bw:case gw:return e;default:return t}}case v5:return t}}}var FQe=gw,BQe=g5,qQe=xw,zQe=mw,UQe=ww,VQe=bw,WQe=v5,HQe=pw,GQe=hw,KQe=yw;go.ContextConsumer=vw;go.ContextProvider=FQe;go.Element=BQe;go.ForwardRef=qQe;go.Fragment=zQe;go.Lazy=UQe;go.Memo=VQe;go.Portal=WQe;go.Profiler=HQe;go.StrictMode=GQe;go.Suspense=KQe;go.isAsyncMode=function(){return!1};go.isConcurrentMode=function(){return!1};go.isContextConsumer=function(e){return ou(e)===vw};go.isContextProvider=function(e){return ou(e)===gw};go.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===g5};go.isForwardRef=function(e){return ou(e)===xw};go.isFragment=function(e){return ou(e)===mw};go.isLazy=function(e){return ou(e)===ww};go.isMemo=function(e){return ou(e)===bw};go.isPortal=function(e){return ou(e)===v5};go.isProfiler=function(e){return ou(e)===pw};go.isStrictMode=function(e){return ou(e)===hw};go.isSuspense=function(e){return ou(e)===yw};go.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===mw||e===pw||e===$ne||e===hw||e===yw||e===OM||e===Fne||typeof e=="object"&&e!==null&&(e.$$typeof===ww||e.$$typeof===bw||e.$$typeof===gw||e.$$typeof===vw||e.$$typeof===xw||e.$$typeof===Lne||e.$$typeof===Mne||e[0]===Rne)};go.typeOf=ou;Dne.exports=go;var YQe=Dne.exports,XQe=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],JQe=["reactReduxForwardedRef"],QQe=[],ZQe=[null,null];function eZe(e,t){var r=e[1];return[t.payload,r+1]}function S9(e,t,r){Ene(function(){return e.apply(void 0,t)},r)}function tZe(e,t,r,n,a,i,s){e.current=n,t.current=a,r.current=!1,i.current&&(i.current=null,s())}function rZe(e,t,r,n,a,i,s,l,c,d){if(e){var u=!1,f=null,m=function(){if(!u){var g=t.getState(),y,x;try{y=n(g,a.current)}catch(b){x=b,f=b}x||(f=null),y===i.current?s.current||c():(i.current=y,l.current=y,s.current=!0,d({type:"STORE_UPDATED",payload:{error:x}}))}};r.onStateChange=m,r.trySubscribe(),m();var h=function(){if(u=!0,r.tryUnsubscribe(),r.onStateChange=null,f)throw f};return h}}var nZe=function(){return[null,0]};function aZe(e,t){t===void 0&&(t={});var r=t,n=r.getDisplayName,a=n===void 0?function(w){return"ConnectAdvanced("+w+")"}:n,i=r.methodName,s=i===void 0?"connectAdvanced":i,l=r.renderCountProp,c=l===void 0?void 0:l,d=r.shouldHandleStateChanges,u=d===void 0?!0:d,f=r.storeKey,m=f===void 0?"store":f;r.withRef;var h=r.forwardRef,v=h===void 0?!1:h,g=r.context,y=g===void 0?Cne:g,x=a_(r,XQe),b=y;return function(j){var _=j.displayName||j.name||"Component",C=a(_),E=qn({},x,{getDisplayName:a,methodName:s,renderCountProp:c,shouldHandleStateChanges:u,storeKey:m,displayName:C,wrappedComponentName:_,WrappedComponent:j}),P=x.pure;function k(D){return e(D.dispatch,E)}var M=P?p.useMemo:function(D){return D()};function S(D){var B=p.useMemo(function(){var st=D.reactReduxForwardedRef,ft=a_(D,JQe);return[D.context,st,ft]},[D]),U=B[0],z=B[1],$=B[2],Y=p.useMemo(function(){return U&&U.Consumer&&YQe.isContextConsumer(ye.createElement(U.Consumer,null))?U:b},[U,b]),de=p.useContext(Y),xe=!!D.store&&!!D.store.getState&&!!D.store.dispatch;de&&de.store;var q=xe?D.store:de.store,L=p.useMemo(function(){return k(q)},[q]),W=p.useMemo(function(){if(!u)return ZQe;var st=Ane(q,xe?null:de.subscription),ft=st.notifyNestedSubs.bind(st);return[st,ft]},[q,xe,de]),ne=W[0],le=W[1],K=p.useMemo(function(){return xe?de:qn({},de,{subscription:ne})},[xe,de,ne]),Q=p.useReducer(eZe,QQe,nZe),re=Q[0],G=re[0],me=Q[1];if(G&&G.error)throw G.error;var pe=p.useRef(),Be=p.useRef($),Z=p.useRef(),ee=p.useRef(!1),kt=M(function(){return Z.current&&$===Be.current?Z.current:L(q.getState(),$)},[q,G,$]);S9(tZe,[Be,pe,ee,$,kt,Z,le]),S9(rZe,[u,q,ne,L,Be,pe,ee,Z,le,me],[q,ne,L]);var Nt=p.useMemo(function(){return ye.createElement(j,qn({},kt,{ref:z}))},[z,j,kt]),De=p.useMemo(function(){return u?ye.createElement(Y.Provider,{value:K},Nt):Nt},[Y,Nt,K]);return De}var I=P?ye.memo(S):S;if(I.WrappedComponent=j,I.displayName=S.displayName=C,v){var T=ye.forwardRef(function(B,U){return ye.createElement(I,qn({},B,{reactReduxForwardedRef:U}))});return T.displayName=C,T.WrappedComponent=j,_9(T,j)}return _9(I,j)}}function C9(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function iE(e,t){if(C9(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var a=0;a<r.length;a++)if(!Object.prototype.hasOwnProperty.call(t,r[a])||!C9(e[r[a]],t[r[a]]))return!1;return!0}function oZe(e,t){var r={},n=function(s){var l=e[s];typeof l=="function"&&(r[s]=function(){return t(l.apply(void 0,arguments))})};for(var a in e)n(a);return r}function IM(e){return function(r,n){var a=e(r,n);function i(){return a}return i.dependsOnOwnProps=!1,i}}function P9(e){return e.dependsOnOwnProps!==null&&e.dependsOnOwnProps!==void 0?!!e.dependsOnOwnProps:e.length!==1}function Bne(e,t){return function(n,a){a.displayName;var i=function(l,c){return i.dependsOnOwnProps?i.mapToProps(l,c):i.mapToProps(l)};return i.dependsOnOwnProps=!0,i.mapToProps=function(l,c){i.mapToProps=e,i.dependsOnOwnProps=P9(e);var d=i(l,c);return typeof d=="function"&&(i.mapToProps=d,i.dependsOnOwnProps=P9(d),d=i(l,c)),d},i}}function iZe(e){return typeof e=="function"?Bne(e):void 0}function sZe(e){return e?void 0:IM(function(t){return{dispatch:t}})}function lZe(e){return e&&typeof e=="object"?IM(function(t){return oZe(e,t)}):void 0}const cZe=[iZe,sZe,lZe];function dZe(e){return typeof e=="function"?Bne(e):void 0}function uZe(e){return e?void 0:IM(function(){return{}})}const fZe=[dZe,uZe];function mZe(e,t,r){return qn({},r,e,t)}function hZe(e){return function(r,n){n.displayName;var a=n.pure,i=n.areMergedPropsEqual,s=!1,l;return function(d,u,f){var m=e(d,u,f);return s?(!a||!i(m,l))&&(l=m):(s=!0,l=m),l}}}function pZe(e){return typeof e=="function"?hZe(e):void 0}function gZe(e){return e?void 0:function(){return mZe}}const vZe=[pZe,gZe];var xZe=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function yZe(e,t,r,n){return function(i,s){return r(e(i,s),t(n,s),s)}}function bZe(e,t,r,n,a){var i=a.areStatesEqual,s=a.areOwnPropsEqual,l=a.areStatePropsEqual,c=!1,d,u,f,m,h;function v(w,j){return d=w,u=j,f=e(d,u),m=t(n,u),h=r(f,m,u),c=!0,h}function g(){return f=e(d,u),t.dependsOnOwnProps&&(m=t(n,u)),h=r(f,m,u),h}function y(){return e.dependsOnOwnProps&&(f=e(d,u)),t.dependsOnOwnProps&&(m=t(n,u)),h=r(f,m,u),h}function x(){var w=e(d,u),j=!l(w,f);return f=w,j&&(h=r(f,m,u)),h}function b(w,j){var _=!s(j,u),C=!i(w,d,j,u);return d=w,u=j,_&&C?g():_?y():C?x():h}return function(j,_){return c?b(j,_):v(j,_)}}function wZe(e,t){var r=t.initMapStateToProps,n=t.initMapDispatchToProps,a=t.initMergeProps,i=a_(t,xZe),s=r(e,i),l=n(e,i),c=a(e,i),d=i.pure?bZe:yZe;return d(s,l,c,e,i)}var jZe=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];function sE(e,t,r){for(var n=t.length-1;n>=0;n--){var a=t[n](e);if(a)return a}return function(i,s){throw new Error("Invalid value of type "+typeof e+" for "+r+" argument when connecting component "+s.wrappedComponentName+".")}}function NZe(e,t){return e===t}function _Ze(e){var t=e===void 0?{}:e,r=t.connectHOC,n=r===void 0?aZe:r,a=t.mapStateToPropsFactories,i=a===void 0?fZe:a,s=t.mapDispatchToPropsFactories,l=s===void 0?cZe:s,c=t.mergePropsFactories,d=c===void 0?vZe:c,u=t.selectorFactory,f=u===void 0?wZe:u;return function(h,v,g,y){y===void 0&&(y={});var x=y,b=x.pure,w=b===void 0?!0:b,j=x.areStatesEqual,_=j===void 0?NZe:j,C=x.areOwnPropsEqual,E=C===void 0?iE:C,P=x.areStatePropsEqual,k=P===void 0?iE:P,M=x.areMergedPropsEqual,S=M===void 0?iE:M,I=a_(x,jZe),T=sE(h,i,"mapStateToProps"),D=sE(v,l,"mapDispatchToProps"),B=sE(g,d,"mergeProps");return n(f,qn({methodName:"connect",getDisplayName:function(z){return"Connect("+z+")"},shouldHandleStateChanges:!!h,initMapStateToProps:T,initMapDispatchToProps:D,initMergeProps:B,pure:w,areStatesEqual:_,areOwnPropsEqual:E,areStatePropsEqual:k,areMergedPropsEqual:S},I))}}const qne=_Ze();wQe($f.unstable_batchedUpdates);function SZe(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function zne(e,t){var r=p.useState(function(){return{inputs:t,result:e()}})[0],n=p.useRef(!0),a=p.useRef(r),i=n.current||!!(t&&a.current.inputs&&SZe(t,a.current.inputs)),s=i?a.current:{inputs:t,result:e()};return p.useEffect(function(){n.current=!1,a.current=s},[s]),s.result}function CZe(e,t){return zne(function(){return e},t)}var Ua=zne,Tn=CZe,Bd=function(t){var r=t.top,n=t.right,a=t.bottom,i=t.left,s=n-i,l=a-r,c={top:r,right:n,bottom:a,left:i,width:s,height:l,x:i,y:r,center:{x:(n+i)/2,y:(a+r)/2}};return c},TM=function(t,r){return{top:t.top-r.top,left:t.left-r.left,bottom:t.bottom+r.bottom,right:t.right+r.right}},A9=function(t,r){return{top:t.top+r.top,left:t.left+r.left,bottom:t.bottom-r.bottom,right:t.right-r.right}},PZe=function(t,r){return{top:t.top+r.y,left:t.left+r.x,bottom:t.bottom+r.y,right:t.right+r.x}},lE={top:0,right:0,bottom:0,left:0},DM=function(t){var r=t.borderBox,n=t.margin,a=n===void 0?lE:n,i=t.border,s=i===void 0?lE:i,l=t.padding,c=l===void 0?lE:l,d=Bd(TM(r,a)),u=Bd(A9(r,s)),f=Bd(A9(u,c));return{marginBox:d,borderBox:Bd(r),paddingBox:u,contentBox:f,margin:a,border:s,padding:c}},zc=function(t){var r=t.slice(0,-2),n=t.slice(-2);if(n!=="px")return 0;var a=Number(r);return isNaN(a)&&uh(!1),a},AZe=function(){return{x:window.pageXOffset,y:window.pageYOffset}},U_=function(t,r){var n=t.borderBox,a=t.border,i=t.margin,s=t.padding,l=PZe(n,r);return DM({borderBox:l,border:a,margin:i,padding:s})},V_=function(t,r){return r===void 0&&(r=AZe()),U_(t,r)},Une=function(t,r){var n={top:zc(r.marginTop),right:zc(r.marginRight),bottom:zc(r.marginBottom),left:zc(r.marginLeft)},a={top:zc(r.paddingTop),right:zc(r.paddingRight),bottom:zc(r.paddingBottom),left:zc(r.paddingLeft)},i={top:zc(r.borderTopWidth),right:zc(r.borderRightWidth),bottom:zc(r.borderBottomWidth),left:zc(r.borderLeftWidth)};return DM({borderBox:t,margin:n,padding:a,border:i})},Vne=function(t){var r=t.getBoundingClientRect(),n=window.getComputedStyle(t);return Une(r,n)},E9=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function EZe(e,t){return!!(e===t||E9(e)&&E9(t))}function kZe(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!EZe(e[r],t[r]))return!1;return!0}function is(e,t){t===void 0&&(t=kZe);var r,n=[],a,i=!1;function s(){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c];return i&&r===this&&t(l,n)||(a=e.apply(this,l),i=!0,r=this,n=l),a}return s}var OZe=function(t){var r=[],n=null,a=function(){for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];r=l,!n&&(n=requestAnimationFrame(function(){n=null,t.apply(void 0,r)}))};return a.cancel=function(){n&&(cancelAnimationFrame(n),n=null)},a};const C1=OZe;function Wne(e,t){}Wne.bind(null,"warn");Wne.bind(null,"error");function th(){}function IZe(e,t){return qn({},e,{},t)}function od(e,t,r){var n=t.map(function(a){var i=IZe(r,a.options);return e.addEventListener(a.eventName,a.fn,i),function(){e.removeEventListener(a.eventName,a.fn,i)}});return function(){n.forEach(function(i){i()})}}var TZe="Invariant failed";function W_(e){this.message=e}W_.prototype.toString=function(){return this.message};function Hr(e,t){if(!e)throw new W_(TZe)}var DZe=function(e){UJ(t,e);function t(){for(var n,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=e.call.apply(e,[this].concat(i))||this,n.callbacks=null,n.unbind=th,n.onWindowError=function(l){var c=n.getCallbacks();c.isDragging()&&c.tryAbort();var d=l.error;d instanceof W_&&l.preventDefault()},n.getCallbacks=function(){if(!n.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return n.callbacks},n.setCallbacks=function(l){n.callbacks=l},n}var r=t.prototype;return r.componentDidMount=function(){this.unbind=od(window,[{eventName:"error",fn:this.onWindowError}])},r.componentDidCatch=function(a){if(a instanceof W_){this.setState({});return}throw a},r.componentWillUnmount=function(){this.unbind()},r.render=function(){return this.props.children(this.setCallbacks)},t}(ye.Component),MZe=`
  Press space bar to start a drag.
  When dragging you can use the arrow keys to move the item around and escape to cancel.
  Some screen readers may require you to be in focus mode or to use your pass through key
`,H_=function(t){return t+1},RZe=function(t){return`
  You have lifted an item in position `+H_(t.source.index)+`
`},Hne=function(t,r){var n=t.droppableId===r.droppableId,a=H_(t.index),i=H_(r.index);return n?`
      You have moved the item from position `+a+`
      to position `+i+`
    `:`
    You have moved the item from position `+a+`
    in list `+t.droppableId+`
    to list `+r.droppableId+`
    in position `+i+`
  `},Gne=function(t,r,n){var a=r.droppableId===n.droppableId;return a?`
      The item `+t+`
      has been combined with `+n.draggableId:`
      The item `+t+`
      in list `+r.droppableId+`
      has been combined with `+n.draggableId+`
      in list `+n.droppableId+`
    `},LZe=function(t){var r=t.destination;if(r)return Hne(t.source,r);var n=t.combine;return n?Gne(t.draggableId,t.source,n):"You are over an area that cannot be dropped on"},k9=function(t){return`
  The item has returned to its starting position
  of `+H_(t.index)+`
`},$Ze=function(t){if(t.reason==="CANCEL")return`
      Movement cancelled.
      `+k9(t.source)+`
    `;var r=t.destination,n=t.combine;return r?`
      You have dropped the item.
      `+Hne(t.source,r)+`
    `:n?`
      You have dropped the item.
      `+Gne(t.draggableId,t.source,n)+`
    `:`
    The item has been dropped while not over a drop area.
    `+k9(t.source)+`
  `},Aj={dragHandleUsageInstructions:MZe,onDragStart:RZe,onDragUpdate:LZe,onDragEnd:$Ze},ss={x:0,y:0},Ns=function(t,r){return{x:t.x+r.x,y:t.y+r.y}},fc=function(t,r){return{x:t.x-r.x,y:t.y-r.y}},rh=function(t,r){return t.x===r.x&&t.y===r.y},y0=function(t){return{x:t.x!==0?-t.x:0,y:t.y!==0?-t.y:0}},ig=function(t,r,n){var a;return n===void 0&&(n=0),a={},a[t]=r,a[t==="x"?"y":"x"]=n,a},P1=function(t,r){return Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2))},O9=function(t,r){return Math.min.apply(Math,r.map(function(n){return P1(t,n)}))},Kne=function(t){return function(r){return{x:t(r.x),y:t(r.y)}}},FZe=function(e,t){var r=Bd({top:Math.max(t.top,e.top),right:Math.min(t.right,e.right),bottom:Math.min(t.bottom,e.bottom),left:Math.max(t.left,e.left)});return r.width<=0||r.height<=0?null:r},jw=function(t,r){return{top:t.top+r.y,left:t.left+r.x,bottom:t.bottom+r.y,right:t.right+r.x}},I9=function(t){return[{x:t.left,y:t.top},{x:t.right,y:t.top},{x:t.left,y:t.bottom},{x:t.right,y:t.bottom}]},BZe={top:0,right:0,bottom:0,left:0},qZe=function(t,r){return r?jw(t,r.scroll.diff.displacement):t},zZe=function(t,r,n){if(n&&n.increasedBy){var a;return qn({},t,(a={},a[r.end]=t[r.end]+n.increasedBy[r.line],a))}return t},UZe=function(t,r){return r&&r.shouldClipSubject?FZe(r.pageMarginBox,t):Bd(t)},Bx=function(e){var t=e.page,r=e.withPlaceholder,n=e.axis,a=e.frame,i=qZe(t.marginBox,a),s=zZe(i,n,r),l=UZe(s,a);return{page:t,withPlaceholder:r,active:l}},MM=function(e,t){e.frame||Hr(!1);var r=e.frame,n=fc(t,r.scroll.initial),a=y0(n),i=qn({},r,{scroll:{initial:r.scroll.initial,current:t,diff:{value:n,displacement:a},max:r.scroll.max}}),s=Bx({page:e.subject.page,withPlaceholder:e.subject.withPlaceholder,axis:e.axis,frame:i}),l=qn({},e,{frame:i,subject:s});return l};function G_(e){return Object.values?Object.values(e):Object.keys(e).map(function(t){return e[t]})}function RM(e,t){if(e.findIndex)return e.findIndex(t);for(var r=0;r<e.length;r++)if(t(e[r]))return r;return-1}function Oh(e,t){if(e.find)return e.find(t);var r=RM(e,t);if(r!==-1)return e[r]}function Yne(e){return Array.prototype.slice.call(e)}var Xne=is(function(e){return e.reduce(function(t,r){return t[r.descriptor.id]=r,t},{})}),Jne=is(function(e){return e.reduce(function(t,r){return t[r.descriptor.id]=r,t},{})}),x5=is(function(e){return G_(e)}),VZe=is(function(e){return G_(e)}),b0=is(function(e,t){var r=VZe(t).filter(function(n){return e===n.descriptor.droppableId}).sort(function(n,a){return n.descriptor.index-a.descriptor.index});return r});function LM(e){return e.at&&e.at.type==="REORDER"?e.at.destination:null}function y5(e){return e.at&&e.at.type==="COMBINE"?e.at.combine:null}var b5=is(function(e,t){return t.filter(function(r){return r.descriptor.id!==e.descriptor.id})}),WZe=function(e){var t=e.isMovingForward,r=e.draggable,n=e.destination,a=e.insideDestination,i=e.previousImpact;if(!n.isCombineEnabled)return null;var s=LM(i);if(!s)return null;function l(g){var y={type:"COMBINE",combine:{draggableId:g,droppableId:n.descriptor.id}};return qn({},i,{at:y})}var c=i.displaced.all,d=c.length?c[0]:null;if(t)return d?l(d):null;var u=b5(r,a);if(!d){if(!u.length)return null;var f=u[u.length-1];return l(f.descriptor.id)}var m=RM(u,function(g){return g.descriptor.id===d});m===-1&&Hr(!1);var h=m-1;if(h<0)return null;var v=u[h];return l(v.descriptor.id)},w0=function(e,t){return e.descriptor.droppableId===t.descriptor.id},Qne={point:ss,value:0},A1={invisible:{},visible:{},all:[]},HZe={displaced:A1,displacedBy:Qne,at:null},ld=function(e,t){return function(r){return e<=r&&r<=t}},Zne=function(e){var t=ld(e.top,e.bottom),r=ld(e.left,e.right);return function(n){var a=t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right);if(a)return!0;var i=t(n.top)||t(n.bottom),s=r(n.left)||r(n.right),l=i&&s;if(l)return!0;var c=n.top<e.top&&n.bottom>e.bottom,d=n.left<e.left&&n.right>e.right,u=c&&d;if(u)return!0;var f=c&&s||d&&i;return f}},GZe=function(e){var t=ld(e.top,e.bottom),r=ld(e.left,e.right);return function(n){var a=t(n.top)&&t(n.bottom)&&r(n.left)&&r(n.right);return a}},$M={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},eae={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"},KZe=function(e){return function(t){var r=ld(t.top,t.bottom),n=ld(t.left,t.right);return function(a){return e===$M?r(a.top)&&r(a.bottom):n(a.left)&&n(a.right)}}},YZe=function(t,r){var n=r.frame?r.frame.scroll.diff.displacement:ss;return jw(t,n)},XZe=function(t,r,n){return r.subject.active?n(r.subject.active)(t):!1},JZe=function(t,r,n){return n(r)(t)},FM=function(t){var r=t.target,n=t.destination,a=t.viewport,i=t.withDroppableDisplacement,s=t.isVisibleThroughFrameFn,l=i?YZe(r,n):r;return XZe(l,n,s)&&JZe(l,a,s)},QZe=function(t){return FM(qn({},t,{isVisibleThroughFrameFn:Zne}))},tae=function(t){return FM(qn({},t,{isVisibleThroughFrameFn:GZe}))},ZZe=function(t){return FM(qn({},t,{isVisibleThroughFrameFn:KZe(t.destination.axis)}))},eet=function(t,r,n){if(typeof n=="boolean")return n;if(!r)return!0;var a=r.invisible,i=r.visible;if(a[t])return!1;var s=i[t];return s?s.shouldAnimate:!0};function tet(e,t){var r=e.page.marginBox,n={top:t.point.y,right:0,bottom:0,left:t.point.x};return Bd(TM(r,n))}function E1(e){var t=e.afterDragging,r=e.destination,n=e.displacedBy,a=e.viewport,i=e.forceShouldAnimate,s=e.last;return t.reduce(function(c,d){var u=tet(d,n),f=d.descriptor.id;c.all.push(f);var m=QZe({target:u,destination:r,viewport:a,withDroppableDisplacement:!0});if(!m)return c.invisible[d.descriptor.id]=!0,c;var h=eet(f,s,i),v={draggableId:f,shouldAnimate:h};return c.visible[f]=v,c},{all:[],visible:{},invisible:{}})}function ret(e,t){if(!e.length)return 0;var r=e[e.length-1].descriptor.index;return t.inHomeList?r:r+1}function T9(e){var t=e.insideDestination,r=e.inHomeList,n=e.displacedBy,a=e.destination,i=ret(t,{inHomeList:r});return{displaced:A1,displacedBy:n,at:{type:"REORDER",destination:{droppableId:a.descriptor.id,index:i}}}}function K_(e){var t=e.draggable,r=e.insideDestination,n=e.destination,a=e.viewport,i=e.displacedBy,s=e.last,l=e.index,c=e.forceShouldAnimate,d=w0(t,n);if(l==null)return T9({insideDestination:r,inHomeList:d,displacedBy:i,destination:n});var u=Oh(r,function(g){return g.descriptor.index===l});if(!u)return T9({insideDestination:r,inHomeList:d,displacedBy:i,destination:n});var f=b5(t,r),m=r.indexOf(u),h=f.slice(m),v=E1({afterDragging:h,destination:n,displacedBy:i,last:s,viewport:a.frame,forceShouldAnimate:c});return{displaced:v,displacedBy:i,at:{type:"REORDER",destination:{droppableId:n.descriptor.id,index:l}}}}function gh(e,t){return!!t.effected[e]}var net=function(e){var t=e.isMovingForward,r=e.destination,n=e.draggables,a=e.combine,i=e.afterCritical;if(!r.isCombineEnabled)return null;var s=a.draggableId,l=n[s],c=l.descriptor.index,d=gh(s,i);return d?t?c:c-1:t?c+1:c},aet=function(e){var t=e.isMovingForward,r=e.isInHomeList,n=e.insideDestination,a=e.location;if(!n.length)return null;var i=a.index,s=t?i+1:i-1,l=n[0].descriptor.index,c=n[n.length-1].descriptor.index,d=r?c:c+1;return s<l||s>d?null:s},oet=function(e){var t=e.isMovingForward,r=e.isInHomeList,n=e.draggable,a=e.draggables,i=e.destination,s=e.insideDestination,l=e.previousImpact,c=e.viewport,d=e.afterCritical,u=l.at;if(u||Hr(!1),u.type==="REORDER"){var f=aet({isMovingForward:t,isInHomeList:r,location:u.destination,insideDestination:s});return f==null?null:K_({draggable:n,insideDestination:s,destination:i,viewport:c,last:l.displaced,displacedBy:l.displacedBy,index:f})}var m=net({isMovingForward:t,destination:i,displaced:l.displaced,draggables:a,combine:u.combine,afterCritical:d});return m==null?null:K_({draggable:n,insideDestination:s,destination:i,viewport:c,last:l.displaced,displacedBy:l.displacedBy,index:m})},iet=function(e){var t=e.displaced,r=e.afterCritical,n=e.combineWith,a=e.displacedBy,i=!!(t.visible[n]||t.invisible[n]);return gh(n,r)?i?ss:y0(a.point):i?a.point:ss},set=function(e){var t=e.afterCritical,r=e.impact,n=e.draggables,a=y5(r);a||Hr(!1);var i=a.draggableId,s=n[i].page.borderBox.center,l=iet({displaced:r.displaced,afterCritical:t,combineWith:i,displacedBy:r.displacedBy});return Ns(s,l)},rae=function(t,r){return r.margin[t.start]+r.borderBox[t.size]/2},cet=function(t,r){return r.margin[t.end]+r.borderBox[t.size]/2},BM=function(t,r,n){return r[t.crossAxisStart]+n.margin[t.crossAxisStart]+n.borderBox[t.crossAxisSize]/2},D9=function(t){var r=t.axis,n=t.moveRelativeTo,a=t.isMoving;return ig(r.line,n.marginBox[r.end]+rae(r,a),BM(r,n.marginBox,a))},M9=function(t){var r=t.axis,n=t.moveRelativeTo,a=t.isMoving;return ig(r.line,n.marginBox[r.start]-cet(r,a),BM(r,n.marginBox,a))},det=function(t){var r=t.axis,n=t.moveInto,a=t.isMoving;return ig(r.line,n.contentBox[r.start]+rae(r,a),BM(r,n.contentBox,a))},uet=function(e){var t=e.impact,r=e.draggable,n=e.draggables,a=e.droppable,i=e.afterCritical,s=b0(a.descriptor.id,n),l=r.page,c=a.axis;if(!s.length)return det({axis:c,moveInto:a.page,isMoving:l});var d=t.displaced,u=t.displacedBy,f=d.all[0];if(f){var m=n[f];if(gh(f,i))return M9({axis:c,moveRelativeTo:m.page,isMoving:l});var h=U_(m.page,u.point);return M9({axis:c,moveRelativeTo:h,isMoving:l})}var v=s[s.length-1];if(v.descriptor.id===r.descriptor.id)return l.borderBox.center;if(gh(v.descriptor.id,i)){var g=U_(v.page,y0(i.displacedBy.point));return D9({axis:c,moveRelativeTo:g,isMoving:l})}return D9({axis:c,moveRelativeTo:v.page,isMoving:l})},h4=function(e,t){var r=e.frame;return r?Ns(t,r.scroll.diff.displacement):t},fet=function(t){var r=t.impact,n=t.draggable,a=t.droppable,i=t.draggables,s=t.afterCritical,l=n.page.borderBox.center,c=r.at;return!a||!c?l:c.type==="REORDER"?uet({impact:r,draggable:n,draggables:i,droppable:a,afterCritical:s}):set({impact:r,draggables:i,afterCritical:s})},w5=function(e){var t=fet(e),r=e.droppable,n=r?h4(r,t):t;return n},nae=function(e,t){var r=fc(t,e.scroll.initial),n=y0(r),a=Bd({top:t.y,bottom:t.y+e.frame.height,left:t.x,right:t.x+e.frame.width}),i={frame:a,scroll:{initial:e.scroll.initial,max:e.scroll.max,current:t,diff:{value:r,displacement:n}}};return i};function R9(e,t){return e.map(function(r){return t[r]})}function met(e,t){for(var r=0;r<t.length;r++){var n=t[r].visible[e];if(n)return n}return null}var het=function(e){var t=e.impact,r=e.viewport,n=e.destination,a=e.draggables,i=e.maxScrollChange,s=nae(r,Ns(r.scroll.current,i)),l=n.frame?MM(n,Ns(n.frame.scroll.current,i)):n,c=t.displaced,d=E1({afterDragging:R9(c.all,a),destination:n,displacedBy:t.displacedBy,viewport:s.frame,last:c,forceShouldAnimate:!1}),u=E1({afterDragging:R9(c.all,a),destination:l,displacedBy:t.displacedBy,viewport:r.frame,last:c,forceShouldAnimate:!1}),f={},m={},h=[c,d,u];c.all.forEach(function(g){var y=met(g,h);if(y){m[g]=y;return}f[g]=!0});var v=qn({},t,{displaced:{all:c.all,invisible:f,visible:m}});return v},pet=function(e,t){return Ns(e.scroll.diff.displacement,t)},qM=function(e){var t=e.pageBorderBoxCenter,r=e.draggable,n=e.viewport,a=pet(n,t),i=fc(a,r.page.borderBox.center);return Ns(r.client.borderBox.center,i)},aae=function(e){var t=e.draggable,r=e.destination,n=e.newPageBorderBoxCenter,a=e.viewport,i=e.withDroppableDisplacement,s=e.onlyOnMainAxis,l=s===void 0?!1:s,c=fc(n,t.page.borderBox.center),d=jw(t.page.borderBox,c),u={target:d,destination:r,withDroppableDisplacement:i,viewport:a};return l?ZZe(u):tae(u)},get=function(e){var t=e.isMovingForward,r=e.draggable,n=e.destination,a=e.draggables,i=e.previousImpact,s=e.viewport,l=e.previousPageBorderBoxCenter,c=e.previousClientSelection,d=e.afterCritical;if(!n.isEnabled)return null;var u=b0(n.descriptor.id,a),f=w0(r,n),m=WZe({isMovingForward:t,draggable:r,destination:n,insideDestination:u,previousImpact:i})||oet({isMovingForward:t,isInHomeList:f,draggable:r,draggables:a,destination:n,insideDestination:u,previousImpact:i,viewport:s,afterCritical:d});if(!m)return null;var h=w5({impact:m,draggable:r,droppable:n,draggables:a,afterCritical:d}),v=aae({draggable:r,destination:n,newPageBorderBoxCenter:h,viewport:s.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0});if(v){var g=qM({pageBorderBoxCenter:h,draggable:r,viewport:s});return{clientSelection:g,impact:m,scrollJumpRequest:null}}var y=fc(h,l),x=het({impact:m,viewport:s,destination:n,draggables:a,maxScrollChange:y});return{clientSelection:c,impact:x,scrollJumpRequest:y}},el=function(t){var r=t.subject.active;return r||Hr(!1),r},vet=function(e){var t=e.isMovingForward,r=e.pageBorderBoxCenter,n=e.source,a=e.droppables,i=e.viewport,s=n.subject.active;if(!s)return null;var l=n.axis,c=ld(s[l.start],s[l.end]),d=x5(a).filter(function(f){return f!==n}).filter(function(f){return f.isEnabled}).filter(function(f){return!!f.subject.active}).filter(function(f){return Zne(i.frame)(el(f))}).filter(function(f){var m=el(f);return t?s[l.crossAxisEnd]<m[l.crossAxisEnd]:m[l.crossAxisStart]<s[l.crossAxisStart]}).filter(function(f){var m=el(f),h=ld(m[l.start],m[l.end]);return c(m[l.start])||c(m[l.end])||h(s[l.start])||h(s[l.end])}).sort(function(f,m){var h=el(f)[l.crossAxisStart],v=el(m)[l.crossAxisStart];return t?h-v:v-h}).filter(function(f,m,h){return el(f)[l.crossAxisStart]===el(h[0])[l.crossAxisStart]});if(!d.length)return null;if(d.length===1)return d[0];var u=d.filter(function(f){var m=ld(el(f)[l.start],el(f)[l.end]);return m(r[l.line])});return u.length===1?u[0]:u.length>1?u.sort(function(f,m){return el(f)[l.start]-el(m)[l.start]})[0]:d.sort(function(f,m){var h=O9(r,I9(el(f))),v=O9(r,I9(el(m)));return h!==v?h-v:el(f)[l.start]-el(m)[l.start]})[0]},L9=function(t,r){var n=t.page.borderBox.center;return gh(t.descriptor.id,r)?fc(n,r.displacedBy.point):n},xet=function(t,r){var n=t.page.borderBox;return gh(t.descriptor.id,r)?jw(n,y0(r.displacedBy.point)):n},yet=function(e){var t=e.pageBorderBoxCenter,r=e.viewport,n=e.destination,a=e.insideDestination,i=e.afterCritical,s=a.filter(function(l){return tae({target:xet(l,i),destination:n,viewport:r.frame,withDroppableDisplacement:!0})}).sort(function(l,c){var d=P1(t,h4(n,L9(l,i))),u=P1(t,h4(n,L9(c,i)));return d<u?-1:u<d?1:l.descriptor.index-c.descriptor.index});return s[0]||null},Nw=is(function(t,r){var n=r[t.line];return{value:n,point:ig(t.line,n)}}),bet=function(t,r,n){var a=t.axis;if(t.descriptor.mode==="virtual")return ig(a.line,r[a.line]);var i=t.subject.page.contentBox[a.size],s=b0(t.descriptor.id,n),l=s.reduce(function(u,f){return u+f.client.marginBox[a.size]},0),c=l+r[a.line],d=c-i;return d<=0?null:ig(a.line,d)},oae=function(t,r){return qn({},t,{scroll:qn({},t.scroll,{max:r})})},iae=function(t,r,n){var a=t.frame;w0(r,t)&&Hr(!1),t.subject.withPlaceholder&&Hr(!1);var i=Nw(t.axis,r.displaceBy).point,s=bet(t,i,n),l={placeholderSize:i,increasedBy:s,oldFrameMaxScroll:t.frame?t.frame.scroll.max:null};if(!a){var c=Bx({page:t.subject.page,withPlaceholder:l,axis:t.axis,frame:t.frame});return qn({},t,{subject:c})}var d=s?Ns(a.scroll.max,s):a.scroll.max,u=oae(a,d),f=Bx({page:t.subject.page,withPlaceholder:l,axis:t.axis,frame:u});return qn({},t,{subject:f,frame:u})},wet=function(t){var r=t.subject.withPlaceholder;r||Hr(!1);var n=t.frame;if(!n){var a=Bx({page:t.subject.page,axis:t.axis,frame:null,withPlaceholder:null});return qn({},t,{subject:a})}var i=r.oldFrameMaxScroll;i||Hr(!1);var s=oae(n,i),l=Bx({page:t.subject.page,axis:t.axis,frame:s,withPlaceholder:null});return qn({},t,{subject:l,frame:s})},jet=function(e){var t=e.previousPageBorderBoxCenter,r=e.moveRelativeTo,n=e.insideDestination,a=e.draggable,i=e.draggables,s=e.destination,l=e.viewport,c=e.afterCritical;if(!r){if(n.length)return null;var d={displaced:A1,displacedBy:Qne,at:{type:"REORDER",destination:{droppableId:s.descriptor.id,index:0}}},u=w5({impact:d,draggable:a,droppable:s,draggables:i,afterCritical:c}),f=w0(a,s)?s:iae(s,a,i),m=aae({draggable:a,destination:f,newPageBorderBoxCenter:u,viewport:l.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0});return m?d:null}var h=t[s.axis.line]<=r.page.borderBox.center[s.axis.line],v=function(){var y=r.descriptor.index;return r.descriptor.id===a.descriptor.id||h?y:y+1}(),g=Nw(s.axis,a.displaceBy);return K_({draggable:a,insideDestination:n,destination:s,viewport:l,displacedBy:g,last:A1,index:v})},Net=function(e){var t=e.isMovingForward,r=e.previousPageBorderBoxCenter,n=e.draggable,a=e.isOver,i=e.draggables,s=e.droppables,l=e.viewport,c=e.afterCritical,d=vet({isMovingForward:t,pageBorderBoxCenter:r,source:a,droppables:s,viewport:l});if(!d)return null;var u=b0(d.descriptor.id,i),f=yet({pageBorderBoxCenter:r,viewport:l,destination:d,insideDestination:u,afterCritical:c}),m=jet({previousPageBorderBoxCenter:r,destination:d,draggable:n,draggables:i,moveRelativeTo:f,insideDestination:u,viewport:l,afterCritical:c});if(!m)return null;var h=w5({impact:m,draggable:n,droppable:d,draggables:i,afterCritical:c}),v=qM({pageBorderBoxCenter:h,draggable:n,viewport:l});return{clientSelection:v,impact:m,scrollJumpRequest:null}},wc=function(e){var t=e.at;return t?t.type==="REORDER"?t.destination.droppableId:t.combine.droppableId:null},_et=function(t,r){var n=wc(t);return n?r[n]:null},Cet=function(e){var t=e.state,r=e.type,n=_et(t.impact,t.dimensions.droppables),a=!!n,i=t.dimensions.droppables[t.critical.droppable.id],s=n||i,l=s.axis.direction,c=l==="vertical"&&(r==="MOVE_UP"||r==="MOVE_DOWN")||l==="horizontal"&&(r==="MOVE_LEFT"||r==="MOVE_RIGHT");if(c&&!a)return null;var d=r==="MOVE_DOWN"||r==="MOVE_RIGHT",u=t.dimensions.draggables[t.critical.draggable.id],f=t.current.page.borderBoxCenter,m=t.dimensions,h=m.draggables,v=m.droppables;return c?get({isMovingForward:d,previousPageBorderBoxCenter:f,draggable:u,destination:s,draggables:h,viewport:t.viewport,previousClientSelection:t.current.client.selection,previousImpact:t.impact,afterCritical:t.afterCritical}):Net({isMovingForward:d,previousPageBorderBoxCenter:f,draggable:u,isOver:s,draggables:h,droppables:v,viewport:t.viewport,afterCritical:t.afterCritical})};function rp(e){return e.phase==="DRAGGING"||e.phase==="COLLECTING"}function sae(e){var t=ld(e.top,e.bottom),r=ld(e.left,e.right);return function(a){return t(a.y)&&r(a.x)}}function Pet(e,t){return e.left<t.right&&e.right>t.left&&e.top<t.bottom&&e.bottom>t.top}function Aet(e){var t=e.pageBorderBox,r=e.draggable,n=e.candidates,a=r.page.borderBox.center,i=n.map(function(s){var l=s.axis,c=ig(s.axis.line,t.center[l.line],s.page.borderBox.center[l.crossAxisLine]);return{id:s.descriptor.id,distance:P1(a,c)}}).sort(function(s,l){return l.distance-s.distance});return i[0]?i[0].id:null}function Eet(e){var t=e.pageBorderBox,r=e.draggable,n=e.droppables,a=x5(n).filter(function(i){if(!i.isEnabled)return!1;var s=i.subject.active;if(!s||!Pet(t,s))return!1;if(sae(s)(t.center))return!0;var l=i.axis,c=s.center[l.crossAxisLine],d=t[l.crossAxisStart],u=t[l.crossAxisEnd],f=ld(s[l.crossAxisStart],s[l.crossAxisEnd]),m=f(d),h=f(u);return!m&&!h?!0:m?d<c:u>c});return a.length?a.length===1?a[0].descriptor.id:Aet({pageBorderBox:t,draggable:r,candidates:a}):null}var lae=function(t,r){return Bd(jw(t,r))},ket=function(e,t){var r=e.frame;return r?lae(t,r.scroll.diff.value):t};function cae(e){var t=e.displaced,r=e.id;return!!(t.visible[r]||t.invisible[r])}function Oet(e){var t=e.draggable,r=e.closest,n=e.inHomeList;return r?n&&r.descriptor.index>t.descriptor.index?r.descriptor.index-1:r.descriptor.index:null}var Iet=function(e){var t=e.pageBorderBoxWithDroppableScroll,r=e.draggable,n=e.destination,a=e.insideDestination,i=e.last,s=e.viewport,l=e.afterCritical,c=n.axis,d=Nw(n.axis,r.displaceBy),u=d.value,f=t[c.start],m=t[c.end],h=b5(r,a),v=Oh(h,function(y){var x=y.descriptor.id,b=y.page.borderBox.center[c.line],w=gh(x,l),j=cae({displaced:i,id:x});return w?j?m<=b:f<b-u:j?m<=b+u:f<b}),g=Oet({draggable:r,closest:v,inHomeList:w0(r,n)});return K_({draggable:r,insideDestination:a,destination:n,viewport:s,last:i,displacedBy:d,index:g})},Tet=4,Det=function(e){var t=e.draggable,r=e.pageBorderBoxWithDroppableScroll,n=e.previousImpact,a=e.destination,i=e.insideDestination,s=e.afterCritical;if(!a.isCombineEnabled)return null;var l=a.axis,c=Nw(a.axis,t.displaceBy),d=c.value,u=r[l.start],f=r[l.end],m=b5(t,i),h=Oh(m,function(g){var y=g.descriptor.id,x=g.page.borderBox,b=x[l.size],w=b/Tet,j=gh(y,s),_=cae({displaced:n.displaced,id:y});return j?_?f>x[l.start]+w&&f<x[l.end]-w:u>x[l.start]-d+w&&u<x[l.end]-d-w:_?f>x[l.start]+d+w&&f<x[l.end]+d-w:u>x[l.start]+w&&u<x[l.end]-w});if(!h)return null;var v={displacedBy:c,displaced:n.displaced,at:{type:"COMBINE",combine:{draggableId:h.descriptor.id,droppableId:a.descriptor.id}}};return v},dae=function(e){var t=e.pageOffset,r=e.draggable,n=e.draggables,a=e.droppables,i=e.previousImpact,s=e.viewport,l=e.afterCritical,c=lae(r.page.borderBox,t),d=Eet({pageBorderBox:c,draggable:r,droppables:a});if(!d)return HZe;var u=a[d],f=b0(u.descriptor.id,n),m=ket(u,c);return Det({pageBorderBoxWithDroppableScroll:m,draggable:r,previousImpact:i,destination:u,insideDestination:f,afterCritical:l})||Iet({pageBorderBoxWithDroppableScroll:m,draggable:r,destination:u,insideDestination:f,last:i.displaced,viewport:s,afterCritical:l})},zM=function(e,t){var r;return qn({},e,(r={},r[t.descriptor.id]=t,r))},Met=function(t){var r=t.previousImpact,n=t.impact,a=t.droppables,i=wc(r),s=wc(n);if(!i||i===s)return a;var l=a[i];if(!l.subject.withPlaceholder)return a;var c=wet(l);return zM(a,c)},Ret=function(e){var t=e.draggable,r=e.draggables,n=e.droppables,a=e.previousImpact,i=e.impact,s=Met({previousImpact:a,impact:i,droppables:n}),l=wc(i);if(!l)return s;var c=n[l];if(w0(t,c)||c.subject.withPlaceholder)return s;var d=iae(c,t,r);return zM(s,d)},Zy=function(e){var t=e.state,r=e.clientSelection,n=e.dimensions,a=e.viewport,i=e.impact,s=e.scrollJumpRequest,l=a||t.viewport,c=n||t.dimensions,d=r||t.current.client.selection,u=fc(d,t.initial.client.selection),f={offset:u,selection:d,borderBoxCenter:Ns(t.initial.client.borderBoxCenter,u)},m={selection:Ns(f.selection,l.scroll.current),borderBoxCenter:Ns(f.borderBoxCenter,l.scroll.current),offset:Ns(f.offset,l.scroll.diff.value)},h={client:f,page:m};if(t.phase==="COLLECTING")return qn({phase:"COLLECTING"},t,{dimensions:c,viewport:l,current:h});var v=c.draggables[t.critical.draggable.id],g=i||dae({pageOffset:m.offset,draggable:v,draggables:c.draggables,droppables:c.droppables,previousImpact:t.impact,viewport:l,afterCritical:t.afterCritical}),y=Ret({draggable:v,impact:g,previousImpact:t.impact,draggables:c.draggables,droppables:c.droppables}),x=qn({},t,{current:h,dimensions:{draggables:c.draggables,droppables:y},impact:g,viewport:l,scrollJumpRequest:s||null,forceShouldAnimate:s?!1:null});return x};function Let(e,t){return e.map(function(r){return t[r]})}var uae=function(e){var t=e.impact,r=e.viewport,n=e.draggables,a=e.destination,i=e.forceShouldAnimate,s=t.displaced,l=Let(s.all,n),c=E1({afterDragging:l,destination:a,displacedBy:t.displacedBy,viewport:r.frame,forceShouldAnimate:i,last:s});return qn({},t,{displaced:c})},fae=function(e){var t=e.impact,r=e.draggable,n=e.droppable,a=e.draggables,i=e.viewport,s=e.afterCritical,l=w5({impact:t,draggable:r,draggables:a,droppable:n,afterCritical:s});return qM({pageBorderBoxCenter:l,draggable:r,viewport:i})},mae=function(e){var t=e.state,r=e.dimensions,n=e.viewport;t.movementMode!=="SNAP"&&Hr(!1);var a=t.impact,i=n||t.viewport,s=r||t.dimensions,l=s.draggables,c=s.droppables,d=l[t.critical.draggable.id],u=wc(a);u||Hr(!1);var f=c[u],m=uae({impact:a,viewport:i,destination:f,draggables:l}),h=fae({impact:m,draggable:d,droppable:f,draggables:l,viewport:i,afterCritical:t.afterCritical});return Zy({impact:m,clientSelection:h,state:t,dimensions:s,viewport:i})},$et=function(e){return{index:e.index,droppableId:e.droppableId}},hae=function(e){var t=e.draggable,r=e.home,n=e.draggables,a=e.viewport,i=Nw(r.axis,t.displaceBy),s=b0(r.descriptor.id,n),l=s.indexOf(t);l===-1&&Hr(!1);var c=s.slice(l+1),d=c.reduce(function(h,v){return h[v.descriptor.id]=!0,h},{}),u={inVirtualList:r.descriptor.mode==="virtual",displacedBy:i,effected:d},f=E1({afterDragging:c,destination:r,displacedBy:i,last:null,viewport:a.frame,forceShouldAnimate:!1}),m={displaced:f,displacedBy:i,at:{type:"REORDER",destination:$et(t.descriptor)}};return{impact:m,afterCritical:u}},Fet=function(e,t){return{draggables:e.draggables,droppables:zM(e.droppables,t)}},Bet=function(e){var t=e.draggable,r=e.offset,n=e.initialWindowScroll,a=U_(t.client,r),i=V_(a,n),s=qn({},t,{placeholder:qn({},t.placeholder,{client:a}),client:a,page:i});return s},qet=function(e){var t=e.frame;return t||Hr(!1),t},zet=function(e){var t=e.additions,r=e.updatedDroppables,n=e.viewport,a=n.scroll.diff.value;return t.map(function(i){var s=i.descriptor.droppableId,l=r[s],c=qet(l),d=c.scroll.diff.value,u=Ns(a,d),f=Bet({draggable:i,offset:u,initialWindowScroll:n.scroll.initial});return f})},Uet=function(e){var t=e.state,r=e.published,n=r.modified.map(function(w){var j=t.dimensions.droppables[w.droppableId],_=MM(j,w.scroll);return _}),a=qn({},t.dimensions.droppables,{},Xne(n)),i=Jne(zet({additions:r.additions,updatedDroppables:a,viewport:t.viewport})),s=qn({},t.dimensions.draggables,{},i);r.removals.forEach(function(w){delete s[w]});var l={droppables:a,draggables:s},c=wc(t.impact),d=c?l.droppables[c]:null,u=l.draggables[t.critical.draggable.id],f=l.droppables[t.critical.droppable.id],m=hae({draggable:u,home:f,draggables:s,viewport:t.viewport}),h=m.impact,v=m.afterCritical,g=d&&d.isCombineEnabled?t.impact:h,y=dae({pageOffset:t.current.page.offset,draggable:l.draggables[t.critical.draggable.id],draggables:l.draggables,droppables:l.droppables,previousImpact:g,viewport:t.viewport,afterCritical:v}),x=qn({phase:"DRAGGING"},t,{phase:"DRAGGING",impact:y,onLiftImpact:h,dimensions:l,afterCritical:v,forceShouldAnimate:!1});if(t.phase==="COLLECTING")return x;var b=qn({phase:"DROP_PENDING"},x,{phase:"DROP_PENDING",reason:t.reason,isWaiting:!1});return b},p4=function(t){return t.movementMode==="SNAP"},cE=function(t,r,n){var a=Fet(t.dimensions,r);return!p4(t)||n?Zy({state:t,dimensions:a}):mae({state:t,dimensions:a})};function dE(e){return e.isDragging&&e.movementMode==="SNAP"?qn({phase:"DRAGGING"},e,{scrollJumpRequest:null}):e}var $9={phase:"IDLE",completed:null,shouldFlush:!1},Vet=function(e,t){if(e===void 0&&(e=$9),t.type==="FLUSH")return qn({},$9,{shouldFlush:!0});if(t.type==="INITIAL_PUBLISH"){e.phase!=="IDLE"&&Hr(!1);var r=t.payload,n=r.critical,a=r.clientSelection,i=r.viewport,s=r.dimensions,l=r.movementMode,c=s.draggables[n.draggable.id],d=s.droppables[n.droppable.id],u={selection:a,borderBoxCenter:c.client.borderBox.center,offset:ss},f={client:u,page:{selection:Ns(u.selection,i.scroll.initial),borderBoxCenter:Ns(u.selection,i.scroll.initial),offset:Ns(u.selection,i.scroll.diff.value)}},m=x5(s.droppables).every(function(me){return!me.isFixedOnPage}),h=hae({draggable:c,home:d,draggables:s.draggables,viewport:i}),v=h.impact,g=h.afterCritical,y={phase:"DRAGGING",isDragging:!0,critical:n,movementMode:l,dimensions:s,initial:f,current:f,isWindowScrollAllowed:m,impact:v,afterCritical:g,onLiftImpact:v,viewport:i,scrollJumpRequest:null,forceShouldAnimate:null};return y}if(t.type==="COLLECTION_STARTING"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&Hr(!1);var x=qn({phase:"COLLECTING"},e,{phase:"COLLECTING"});return x}if(t.type==="PUBLISH_WHILE_DRAGGING")return e.phase==="COLLECTING"||e.phase==="DROP_PENDING"||Hr(!1),Uet({state:e,published:t.payload});if(t.type==="MOVE"){if(e.phase==="DROP_PENDING")return e;rp(e)||Hr(!1);var b=t.payload.client;return rh(b,e.current.client.selection)?e:Zy({state:e,clientSelection:b,impact:p4(e)?e.impact:null})}if(t.type==="UPDATE_DROPPABLE_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="COLLECTING")return dE(e);rp(e)||Hr(!1);var w=t.payload,j=w.id,_=w.newScroll,C=e.dimensions.droppables[j];if(!C)return e;var E=MM(C,_);return cE(e,E,!1)}if(t.type==="UPDATE_DROPPABLE_IS_ENABLED"){if(e.phase==="DROP_PENDING")return e;rp(e)||Hr(!1);var P=t.payload,k=P.id,M=P.isEnabled,S=e.dimensions.droppables[k];S||Hr(!1),S.isEnabled===M&&Hr(!1);var I=qn({},S,{isEnabled:M});return cE(e,I,!0)}if(t.type==="UPDATE_DROPPABLE_IS_COMBINE_ENABLED"){if(e.phase==="DROP_PENDING")return e;rp(e)||Hr(!1);var T=t.payload,D=T.id,B=T.isCombineEnabled,U=e.dimensions.droppables[D];U||Hr(!1),U.isCombineEnabled===B&&Hr(!1);var z=qn({},U,{isCombineEnabled:B});return cE(e,z,!0)}if(t.type==="MOVE_BY_WINDOW_SCROLL"){if(e.phase==="DROP_PENDING"||e.phase==="DROP_ANIMATING")return e;rp(e)||Hr(!1),e.isWindowScrollAllowed||Hr(!1);var $=t.payload.newScroll;if(rh(e.viewport.scroll.current,$))return dE(e);var Y=nae(e.viewport,$);return p4(e)?mae({state:e,viewport:Y}):Zy({state:e,viewport:Y})}if(t.type==="UPDATE_VIEWPORT_MAX_SCROLL"){if(!rp(e))return e;var de=t.payload.maxScroll;if(rh(de,e.viewport.scroll.max))return e;var xe=qn({},e.viewport,{scroll:qn({},e.viewport.scroll,{max:de})});return qn({phase:"DRAGGING"},e,{viewport:xe})}if(t.type==="MOVE_UP"||t.type==="MOVE_DOWN"||t.type==="MOVE_LEFT"||t.type==="MOVE_RIGHT"){if(e.phase==="COLLECTING"||e.phase==="DROP_PENDING")return e;e.phase!=="DRAGGING"&&Hr(!1);var q=Cet({state:e,type:t.type});return q?Zy({state:e,impact:q.impact,clientSelection:q.clientSelection,scrollJumpRequest:q.scrollJumpRequest}):e}if(t.type==="DROP_PENDING"){var L=t.payload.reason;e.phase!=="COLLECTING"&&Hr(!1);var W=qn({phase:"DROP_PENDING"},e,{phase:"DROP_PENDING",isWaiting:!0,reason:L});return W}if(t.type==="DROP_ANIMATE"){var ne=t.payload,le=ne.completed,K=ne.dropDuration,Q=ne.newHomeClientOffset;e.phase==="DRAGGING"||e.phase==="DROP_PENDING"||Hr(!1);var re={phase:"DROP_ANIMATING",completed:le,dropDuration:K,newHomeClientOffset:Q,dimensions:e.dimensions};return re}if(t.type==="DROP_COMPLETE"){var G=t.payload.completed;return{phase:"IDLE",completed:G,shouldFlush:!1}}return e},Wet=function(t){return{type:"BEFORE_INITIAL_CAPTURE",payload:t}},Het=function(t){return{type:"LIFT",payload:t}},Get=function(t){return{type:"INITIAL_PUBLISH",payload:t}},Ket=function(t){return{type:"PUBLISH_WHILE_DRAGGING",payload:t}},Yet=function(){return{type:"COLLECTION_STARTING",payload:null}},Xet=function(t){return{type:"UPDATE_DROPPABLE_SCROLL",payload:t}},Jet=function(t){return{type:"UPDATE_DROPPABLE_IS_ENABLED",payload:t}},Qet=function(t){return{type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:t}},pae=function(t){return{type:"MOVE",payload:t}},Zet=function(t){return{type:"MOVE_BY_WINDOW_SCROLL",payload:t}},ett=function(t){return{type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:t}},ttt=function(){return{type:"MOVE_UP",payload:null}},rtt=function(){return{type:"MOVE_DOWN",payload:null}},ntt=function(){return{type:"MOVE_RIGHT",payload:null}},att=function(){return{type:"MOVE_LEFT",payload:null}},UM=function(){return{type:"FLUSH",payload:null}},ott=function(t){return{type:"DROP_ANIMATE",payload:t}},VM=function(t){return{type:"DROP_COMPLETE",payload:t}},gae=function(t){return{type:"DROP",payload:t}},itt=function(t){return{type:"DROP_PENDING",payload:t}},vae=function(){return{type:"DROP_ANIMATION_FINISHED",payload:null}},stt=function(e){return function(t){var r=t.getState,n=t.dispatch;return function(a){return function(i){if(i.type!=="LIFT"){a(i);return}var s=i.payload,l=s.id,c=s.clientSelection,d=s.movementMode,u=r();u.phase==="DROP_ANIMATING"&&n(VM({completed:u.completed})),r().phase!=="IDLE"&&Hr(!1),n(UM()),n(Wet({draggableId:l,movementMode:d}));var f={shouldPublishImmediately:d==="SNAP"},m={draggableId:l,scrollOptions:f},h=e.startPublishing(m),v=h.critical,g=h.dimensions,y=h.viewport;n(Get({critical:v,dimensions:g,clientSelection:c,movementMode:d,viewport:y}))}}}},ltt=function(e){return function(){return function(t){return function(r){r.type==="INITIAL_PUBLISH"&&e.dragging(),r.type==="DROP_ANIMATE"&&e.dropping(r.payload.completed.result.reason),(r.type==="FLUSH"||r.type==="DROP_COMPLETE")&&e.resting(),t(r)}}}},WM={outOfTheWay:"cubic-bezier(0.2, 0, 0, 1)",drop:"cubic-bezier(.2,1,.1,1)"},k1={opacity:{drop:0,combining:.7},scale:{drop:.75}},HM={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},Uh=HM.outOfTheWay+"s "+WM.outOfTheWay,eb={fluid:"opacity "+Uh,snap:"transform "+Uh+", opacity "+Uh,drop:function(t){var r=t+"s "+WM.drop;return"transform "+r+", opacity "+r},outOfTheWay:"transform "+Uh,placeholder:"height "+Uh+", width "+Uh+", margin "+Uh},F9=function(t){return rh(t,ss)?null:"translate("+t.x+"px, "+t.y+"px)"},g4={moveTo:F9,drop:function(t,r){var n=F9(t);return n?r?n+" scale("+k1.scale.drop+")":n:null}},v4=HM.minDropTime,xae=HM.maxDropTime,ctt=xae-v4,B9=1500,dtt=.6,utt=function(e){var t=e.current,r=e.destination,n=e.reason,a=P1(t,r);if(a<=0)return v4;if(a>=B9)return xae;var i=a/B9,s=v4+ctt*i,l=n==="CANCEL"?s*dtt:s;return Number(l.toFixed(2))},ftt=function(e){var t=e.impact,r=e.draggable,n=e.dimensions,a=e.viewport,i=e.afterCritical,s=n.draggables,l=n.droppables,c=wc(t),d=c?l[c]:null,u=l[r.descriptor.droppableId],f=fae({impact:t,draggable:r,draggables:s,afterCritical:i,droppable:d||u,viewport:a}),m=fc(f,r.client.borderBox.center);return m},mtt=function(e){var t=e.draggables,r=e.reason,n=e.lastImpact,a=e.home,i=e.viewport,s=e.onLiftImpact;if(!n.at||r!=="DROP"){var l=uae({draggables:t,impact:s,destination:a,viewport:i,forceShouldAnimate:!0});return{impact:l,didDropInsideDroppable:!1}}if(n.at.type==="REORDER")return{impact:n,didDropInsideDroppable:!0};var c=qn({},n,{displaced:A1});return{impact:c,didDropInsideDroppable:!0}},htt=function(e){var t=e.getState,r=e.dispatch;return function(n){return function(a){if(a.type!=="DROP"){n(a);return}var i=t(),s=a.payload.reason;if(i.phase==="COLLECTING"){r(itt({reason:s}));return}if(i.phase!=="IDLE"){var l=i.phase==="DROP_PENDING"&&i.isWaiting;l&&Hr(!1),i.phase==="DRAGGING"||i.phase==="DROP_PENDING"||Hr(!1);var c=i.critical,d=i.dimensions,u=d.draggables[i.critical.draggable.id],f=mtt({reason:s,lastImpact:i.impact,afterCritical:i.afterCritical,onLiftImpact:i.onLiftImpact,home:i.dimensions.droppables[i.critical.droppable.id],viewport:i.viewport,draggables:i.dimensions.draggables}),m=f.impact,h=f.didDropInsideDroppable,v=h?LM(m):null,g=h?y5(m):null,y={index:c.draggable.index,droppableId:c.droppable.id},x={draggableId:u.descriptor.id,type:u.descriptor.type,source:y,reason:s,mode:i.movementMode,destination:v,combine:g},b=ftt({impact:m,draggable:u,dimensions:d,viewport:i.viewport,afterCritical:i.afterCritical}),w={critical:i.critical,afterCritical:i.afterCritical,result:x,impact:m},j=!rh(i.current.client.offset,b)||!!x.combine;if(!j){r(VM({completed:w}));return}var _=utt({current:i.current.client.offset,destination:b,reason:s}),C={newHomeClientOffset:b,dropDuration:_,completed:w};r(ott(C))}}}},yae=function(){return{x:window.pageXOffset,y:window.pageYOffset}};function ptt(e){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(r){r.target!==window&&r.target!==window.document||e()}}}function gtt(e){var t=e.onWindowScroll;function r(){t(yae())}var n=C1(r),a=ptt(n),i=th;function s(){return i!==th}function l(){s()&&Hr(!1),i=od(window,[a])}function c(){s()||Hr(!1),n.cancel(),i(),i=th}return{start:l,stop:c,isActive:s}}var vtt=function(t){return t.type==="DROP_COMPLETE"||t.type==="DROP_ANIMATE"||t.type==="FLUSH"},xtt=function(e){var t=gtt({onWindowScroll:function(n){e.dispatch(Zet({newScroll:n}))}});return function(r){return function(n){!t.isActive()&&n.type==="INITIAL_PUBLISH"&&t.start(),t.isActive()&&vtt(n)&&t.stop(),r(n)}}},ytt=function(e){var t=!1,r=!1,n=setTimeout(function(){r=!0}),a=function(s){t||r||(t=!0,e(s),clearTimeout(n))};return a.wasCalled=function(){return t},a},btt=function(){var e=[],t=function(i){var s=RM(e,function(d){return d.timerId===i});s===-1&&Hr(!1);var l=e.splice(s,1),c=l[0];c.callback()},r=function(i){var s=setTimeout(function(){return t(s)}),l={timerId:s,callback:i};e.push(l)},n=function(){if(e.length){var i=[].concat(e);e.length=0,i.forEach(function(s){clearTimeout(s.timerId),s.callback()})}};return{add:r,flush:n}},wtt=function(t,r){return t==null&&r==null?!0:t==null||r==null?!1:t.droppableId===r.droppableId&&t.index===r.index},jtt=function(t,r){return t==null&&r==null?!0:t==null||r==null?!1:t.draggableId===r.draggableId&&t.droppableId===r.droppableId},Ntt=function(t,r){if(t===r)return!0;var n=t.draggable.id===r.draggable.id&&t.draggable.droppableId===r.draggable.droppableId&&t.draggable.type===r.draggable.type&&t.draggable.index===r.draggable.index,a=t.droppable.id===r.droppable.id&&t.droppable.type===r.droppable.type;return n&&a},ey=function(t,r){r()},V2=function(t,r){return{draggableId:t.draggable.id,type:t.droppable.type,source:{droppableId:t.droppable.id,index:t.draggable.index},mode:r}},uE=function(t,r,n,a){if(!t){n(a(r));return}var i=ytt(n),s={announce:i};t(r,s),i.wasCalled()||n(a(r))},_tt=function(e,t){var r=btt(),n=null,a=function(m,h){n&&Hr(!1),ey("onBeforeCapture",function(){var v=e().onBeforeCapture;if(v){var g={draggableId:m,mode:h};v(g)}})},i=function(m,h){n&&Hr(!1),ey("onBeforeDragStart",function(){var v=e().onBeforeDragStart;v&&v(V2(m,h))})},s=function(m,h){n&&Hr(!1);var v=V2(m,h);n={mode:h,lastCritical:m,lastLocation:v.source,lastCombine:null},r.add(function(){ey("onDragStart",function(){return uE(e().onDragStart,v,t,Aj.onDragStart)})})},l=function(m,h){var v=LM(h),g=y5(h);n||Hr(!1);var y=!Ntt(m,n.lastCritical);y&&(n.lastCritical=m);var x=!wtt(n.lastLocation,v);x&&(n.lastLocation=v);var b=!jtt(n.lastCombine,g);if(b&&(n.lastCombine=g),!(!y&&!x&&!b)){var w=qn({},V2(m,n.mode),{combine:g,destination:v});r.add(function(){ey("onDragUpdate",function(){return uE(e().onDragUpdate,w,t,Aj.onDragUpdate)})})}},c=function(){n||Hr(!1),r.flush()},d=function(m){n||Hr(!1),n=null,ey("onDragEnd",function(){return uE(e().onDragEnd,m,t,Aj.onDragEnd)})},u=function(){if(n){var m=qn({},V2(n.lastCritical,n.mode),{combine:null,destination:null,reason:"CANCEL"});d(m)}};return{beforeCapture:a,beforeStart:i,start:s,update:l,flush:c,drop:d,abort:u}},Stt=function(e,t){var r=_tt(e,t);return function(n){return function(a){return function(i){if(i.type==="BEFORE_INITIAL_CAPTURE"){r.beforeCapture(i.payload.draggableId,i.payload.movementMode);return}if(i.type==="INITIAL_PUBLISH"){var s=i.payload.critical;r.beforeStart(s,i.payload.movementMode),a(i),r.start(s,i.payload.movementMode);return}if(i.type==="DROP_COMPLETE"){var l=i.payload.completed.result;r.flush(),a(i),r.drop(l);return}if(a(i),i.type==="FLUSH"){r.abort();return}var c=n.getState();c.phase==="DRAGGING"&&r.update(c.critical,c.impact)}}}},Ctt=function(e){return function(t){return function(r){if(r.type!=="DROP_ANIMATION_FINISHED"){t(r);return}var n=e.getState();n.phase!=="DROP_ANIMATING"&&Hr(!1),e.dispatch(VM({completed:n.completed}))}}},Ptt=function(e){var t=null,r=null;function n(){r&&(cancelAnimationFrame(r),r=null),t&&(t(),t=null)}return function(a){return function(i){if((i.type==="FLUSH"||i.type==="DROP_COMPLETE"||i.type==="DROP_ANIMATION_FINISHED")&&n(),a(i),i.type==="DROP_ANIMATE"){var s={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){var c=e.getState();c.phase==="DROP_ANIMATING"&&e.dispatch(vae())}};r=requestAnimationFrame(function(){r=null,t=od(window,[s])})}}}},Att=function(e){return function(){return function(t){return function(r){(r.type==="DROP_COMPLETE"||r.type==="FLUSH"||r.type==="DROP_ANIMATE")&&e.stopPublishing(),t(r)}}}},Ett=function(e){var t=!1;return function(){return function(r){return function(n){if(n.type==="INITIAL_PUBLISH"){t=!0,e.tryRecordFocus(n.payload.critical.draggable.id),r(n),e.tryRestoreFocusRecorded();return}if(r(n),!!t){if(n.type==="FLUSH"){t=!1,e.tryRestoreFocusRecorded();return}if(n.type==="DROP_COMPLETE"){t=!1;var a=n.payload.completed.result;a.combine&&e.tryShiftRecord(a.draggableId,a.combine.draggableId),e.tryRestoreFocusRecorded()}}}}}},ktt=function(t){return t.type==="DROP_COMPLETE"||t.type==="DROP_ANIMATE"||t.type==="FLUSH"},Ott=function(e){return function(t){return function(r){return function(n){if(ktt(n)){e.stop(),r(n);return}if(n.type==="INITIAL_PUBLISH"){r(n);var a=t.getState();a.phase!=="DRAGGING"&&Hr(!1),e.start(a);return}r(n),e.scroll(t.getState())}}}},Itt=function(e){return function(t){return function(r){if(t(r),r.type==="PUBLISH_WHILE_DRAGGING"){var n=e.getState();n.phase==="DROP_PENDING"&&(n.isWaiting||e.dispatch(gae({reason:n.reason})))}}}},Ttt=Sne,Dtt=function(e){var t=e.dimensionMarshal,r=e.focusMarshal,n=e.styleMarshal,a=e.getResponders,i=e.announce,s=e.autoScroller;return _ne(Vet,Ttt(yQe(ltt(n),Att(t),stt(t),htt,Ctt,Ptt,Itt,Ott(s),xtt,Ett(r),Stt(a,i))))},fE=function(){return{additions:{},removals:{},modified:{}}};function Mtt(e){var t=e.registry,r=e.callbacks,n=fE(),a=null,i=function(){a||(r.collectionStarting(),a=requestAnimationFrame(function(){a=null;var u=n,f=u.additions,m=u.removals,h=u.modified,v=Object.keys(f).map(function(x){return t.draggable.getById(x).getDimension(ss)}).sort(function(x,b){return x.descriptor.index-b.descriptor.index}),g=Object.keys(h).map(function(x){var b=t.droppable.getById(x),w=b.callbacks.getScrollWhileDragging();return{droppableId:x,scroll:w}}),y={additions:v,removals:Object.keys(m),modified:g};n=fE(),r.publish(y)}))},s=function(u){var f=u.descriptor.id;n.additions[f]=u,n.modified[u.descriptor.droppableId]=!0,n.removals[f]&&delete n.removals[f],i()},l=function(u){var f=u.descriptor;n.removals[f.id]=!0,n.modified[f.droppableId]=!0,n.additions[f.id]&&delete n.additions[f.id],i()},c=function(){a&&(cancelAnimationFrame(a),a=null,n=fE())};return{add:s,remove:l,stop:c}}var bae=function(e){var t=e.scrollHeight,r=e.scrollWidth,n=e.height,a=e.width,i=fc({x:r,y:t},{x:a,y:n}),s={x:Math.max(0,i.x),y:Math.max(0,i.y)};return s},wae=function(){var e=document.documentElement;return e||Hr(!1),e},jae=function(){var e=wae(),t=bae({scrollHeight:e.scrollHeight,scrollWidth:e.scrollWidth,width:e.clientWidth,height:e.clientHeight});return t},Rtt=function(){var e=yae(),t=jae(),r=e.y,n=e.x,a=wae(),i=a.clientWidth,s=a.clientHeight,l=n+i,c=r+s,d=Bd({top:r,left:n,right:l,bottom:c}),u={frame:d,scroll:{initial:e,current:e,max:t,diff:{value:ss,displacement:ss}}};return u},Ltt=function(e){var t=e.critical,r=e.scrollOptions,n=e.registry,a=Rtt(),i=a.scroll.current,s=t.droppable,l=n.droppable.getAllByType(s.type).map(function(f){return f.callbacks.getDimensionAndWatchScroll(i,r)}),c=n.draggable.getAllByType(t.draggable.type).map(function(f){return f.getDimension(i)}),d={draggables:Jne(c),droppables:Xne(l)},u={dimensions:d,critical:t,viewport:a};return u};function q9(e,t,r){if(r.descriptor.id===t.id||r.descriptor.type!==t.type)return!1;var n=e.droppable.getById(r.descriptor.droppableId);return n.descriptor.mode==="virtual"}var $tt=function(e,t){var r=null,n=Mtt({callbacks:{publish:t.publishWhileDragging,collectionStarting:t.collectionStarting},registry:e}),a=function(h,v){e.droppable.exists(h)||Hr(!1),r&&t.updateDroppableIsEnabled({id:h,isEnabled:v})},i=function(h,v){r&&(e.droppable.exists(h)||Hr(!1),t.updateDroppableIsCombineEnabled({id:h,isCombineEnabled:v}))},s=function(h,v){r&&(e.droppable.exists(h)||Hr(!1),t.updateDroppableScroll({id:h,newScroll:v}))},l=function(h,v){r&&e.droppable.getById(h).callbacks.scroll(v)},c=function(){if(r){n.stop();var h=r.critical.droppable;e.droppable.getAllByType(h.type).forEach(function(v){return v.callbacks.dragStopped()}),r.unsubscribe(),r=null}},d=function(h){r||Hr(!1);var v=r.critical.draggable;h.type==="ADDITION"&&q9(e,v,h.value)&&n.add(h.value),h.type==="REMOVAL"&&q9(e,v,h.value)&&n.remove(h.value)},u=function(h){r&&Hr(!1);var v=e.draggable.getById(h.draggableId),g=e.droppable.getById(v.descriptor.droppableId),y={draggable:v.descriptor,droppable:g.descriptor},x=e.subscribe(d);return r={critical:y,unsubscribe:x},Ltt({critical:y,registry:e,scrollOptions:h.scrollOptions})},f={updateDroppableIsEnabled:a,updateDroppableIsCombineEnabled:i,scrollDroppable:l,updateDroppableScroll:s,startPublishing:u,stopPublishing:c};return f},Nae=function(e,t){return e.phase==="IDLE"?!0:e.phase!=="DROP_ANIMATING"||e.completed.result.draggableId===t?!1:e.completed.result.reason==="DROP"},Ftt=function(e){window.scrollBy(e.x,e.y)},Btt=is(function(e){return x5(e).filter(function(t){return!(!t.isEnabled||!t.frame)})}),qtt=function(t,r){var n=Oh(Btt(r),function(a){return a.frame||Hr(!1),sae(a.frame.pageMarginBox)(t)});return n},ztt=function(e){var t=e.center,r=e.destination,n=e.droppables;if(r){var a=n[r];return a.frame?a:null}var i=qtt(t,n);return i},nh={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:function(t){return Math.pow(t,2)},durationDampening:{stopDampeningAt:1200,accelerateAt:360}},Utt=function(e,t){var r=e[t.size]*nh.startFromPercentage,n=e[t.size]*nh.maxScrollAtPercentage,a={startScrollingFrom:r,maxScrollValueAt:n};return a},_ae=function(e){var t=e.startOfRange,r=e.endOfRange,n=e.current,a=r-t;if(a===0)return 0;var i=n-t,s=i/a;return s},GM=1,Vtt=function(e,t){if(e>t.startScrollingFrom)return 0;if(e<=t.maxScrollValueAt)return nh.maxPixelScroll;if(e===t.startScrollingFrom)return GM;var r=_ae({startOfRange:t.maxScrollValueAt,endOfRange:t.startScrollingFrom,current:e}),n=1-r,a=nh.maxPixelScroll*nh.ease(n);return Math.ceil(a)},z9=nh.durationDampening.accelerateAt,U9=nh.durationDampening.stopDampeningAt,Wtt=function(e,t){var r=t,n=U9,a=Date.now(),i=a-r;if(i>=U9)return e;if(i<z9)return GM;var s=_ae({startOfRange:z9,endOfRange:n,current:i}),l=e*nh.ease(s);return Math.ceil(l)},V9=function(e){var t=e.distanceToEdge,r=e.thresholds,n=e.dragStartTime,a=e.shouldUseTimeDampening,i=Vtt(t,r);return i===0?0:a?Math.max(Wtt(i,n),GM):i},W9=function(e){var t=e.container,r=e.distanceToEdges,n=e.dragStartTime,a=e.axis,i=e.shouldUseTimeDampening,s=Utt(t,a),l=r[a.end]<r[a.start];return l?V9({distanceToEdge:r[a.end],thresholds:s,dragStartTime:n,shouldUseTimeDampening:i}):-1*V9({distanceToEdge:r[a.start],thresholds:s,dragStartTime:n,shouldUseTimeDampening:i})},Htt=function(e){var t=e.container,r=e.subject,n=e.proposedScroll,a=r.height>t.height,i=r.width>t.width;return!i&&!a?n:i&&a?null:{x:i?0:n.x,y:a?0:n.y}},Gtt=Kne(function(e){return e===0?0:e}),Sae=function(e){var t=e.dragStartTime,r=e.container,n=e.subject,a=e.center,i=e.shouldUseTimeDampening,s={top:a.y-r.top,right:r.right-a.x,bottom:r.bottom-a.y,left:a.x-r.left},l=W9({container:r,distanceToEdges:s,dragStartTime:t,axis:$M,shouldUseTimeDampening:i}),c=W9({container:r,distanceToEdges:s,dragStartTime:t,axis:eae,shouldUseTimeDampening:i}),d=Gtt({x:c,y:l});if(rh(d,ss))return null;var u=Htt({container:r,subject:n,proposedScroll:d});return u?rh(u,ss)?null:u:null},Ktt=Kne(function(e){return e===0?0:e>0?1:-1}),KM=function(){var e=function(r,n){return r<0?r:r>n?r-n:0};return function(t){var r=t.current,n=t.max,a=t.change,i=Ns(r,a),s={x:e(i.x,n.x),y:e(i.y,n.y)};return rh(s,ss)?null:s}}(),Cae=function(t){var r=t.max,n=t.current,a=t.change,i={x:Math.max(n.x,r.x),y:Math.max(n.y,r.y)},s=Ktt(a),l=KM({max:i,current:n,change:s});return!l||s.x!==0&&l.x===0||s.y!==0&&l.y===0},YM=function(t,r){return Cae({current:t.scroll.current,max:t.scroll.max,change:r})},Ytt=function(t,r){if(!YM(t,r))return null;var n=t.scroll.max,a=t.scroll.current;return KM({current:a,max:n,change:r})},XM=function(t,r){var n=t.frame;return n?Cae({current:n.scroll.current,max:n.scroll.max,change:r}):!1},Xtt=function(t,r){var n=t.frame;return!n||!XM(t,r)?null:KM({current:n.scroll.current,max:n.scroll.max,change:r})},Jtt=function(e){var t=e.viewport,r=e.subject,n=e.center,a=e.dragStartTime,i=e.shouldUseTimeDampening,s=Sae({dragStartTime:a,container:t.frame,subject:r,center:n,shouldUseTimeDampening:i});return s&&YM(t,s)?s:null},Qtt=function(e){var t=e.droppable,r=e.subject,n=e.center,a=e.dragStartTime,i=e.shouldUseTimeDampening,s=t.frame;if(!s)return null;var l=Sae({dragStartTime:a,container:s.pageMarginBox,subject:r,center:n,shouldUseTimeDampening:i});return l&&XM(t,l)?l:null},H9=function(e){var t=e.state,r=e.dragStartTime,n=e.shouldUseTimeDampening,a=e.scrollWindow,i=e.scrollDroppable,s=t.current.page.borderBoxCenter,l=t.dimensions.draggables[t.critical.draggable.id],c=l.page.marginBox;if(t.isWindowScrollAllowed){var d=t.viewport,u=Jtt({dragStartTime:r,viewport:d,subject:c,center:s,shouldUseTimeDampening:n});if(u){a(u);return}}var f=ztt({center:s,destination:wc(t.impact),droppables:t.dimensions.droppables});if(f){var m=Qtt({dragStartTime:r,droppable:f,subject:c,center:s,shouldUseTimeDampening:n});m&&i(f.descriptor.id,m)}},Ztt=function(e){var t=e.scrollWindow,r=e.scrollDroppable,n=C1(t),a=C1(r),i=null,s=function(u){i||Hr(!1);var f=i,m=f.shouldUseTimeDampening,h=f.dragStartTime;H9({state:u,scrollWindow:n,scrollDroppable:a,dragStartTime:h,shouldUseTimeDampening:m})},l=function(u){i&&Hr(!1);var f=Date.now(),m=!1,h=function(){m=!0};H9({state:u,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:h,scrollDroppable:h}),i={dragStartTime:f,shouldUseTimeDampening:m},m&&s(u)},c=function(){i&&(n.cancel(),a.cancel(),i=null)};return{start:l,stop:c,scroll:s}},ert=function(e){var t=e.move,r=e.scrollDroppable,n=e.scrollWindow,a=function(d,u){var f=Ns(d.current.client.selection,u);t({client:f})},i=function(d,u){if(!XM(d,u))return u;var f=Xtt(d,u);if(!f)return r(d.descriptor.id,u),null;var m=fc(u,f);r(d.descriptor.id,m);var h=fc(u,m);return h},s=function(d,u,f){if(!d||!YM(u,f))return f;var m=Ytt(u,f);if(!m)return n(f),null;var h=fc(f,m);n(h);var v=fc(f,h);return v},l=function(d){var u=d.scrollJumpRequest;if(u){var f=wc(d.impact);f||Hr(!1);var m=i(d.dimensions.droppables[f],u);if(m){var h=d.viewport,v=s(d.isWindowScrollAllowed,h,m);v&&a(d,v)}}};return l},trt=function(e){var t=e.scrollDroppable,r=e.scrollWindow,n=e.move,a=Ztt({scrollWindow:r,scrollDroppable:t}),i=ert({move:n,scrollWindow:r,scrollDroppable:t}),s=function(d){if(d.phase==="DRAGGING"){if(d.movementMode==="FLUID"){a.scroll(d);return}d.scrollJumpRequest&&i(d)}},l={scroll:s,start:a.start,stop:a.stop};return l},qx="data-rbd",zx=function(){var e=qx+"-drag-handle";return{base:e,draggableId:e+"-draggable-id",contextId:e+"-context-id"}}(),x4=function(){var e=qx+"-draggable";return{base:e,contextId:e+"-context-id",id:e+"-id"}}(),rrt=function(){var e=qx+"-droppable";return{base:e,contextId:e+"-context-id",id:e+"-id"}}(),G9={contextId:qx+"-scroll-container-context-id"},nrt=function(t){return function(r){return"["+r+'="'+t+'"]'}},ty=function(t,r){return t.map(function(n){var a=n.styles[r];return a?n.selector+" { "+a+" }":""}).join(" ")},art="pointer-events: none;",ort=function(e){var t=nrt(e),r=function(){var l=`
      cursor: -webkit-grab;
      cursor: grab;
    `;return{selector:t(zx.contextId),styles:{always:`
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: rgba(0,0,0,0);
          touch-action: manipulation;
        `,resting:l,dragging:art,dropAnimating:l}}}(),n=function(){var l=`
      transition: `+eb.outOfTheWay+`;
    `;return{selector:t(x4.contextId),styles:{dragging:l,dropAnimating:l,userCancel:l}}}(),a={selector:t(rrt.contextId),styles:{always:"overflow-anchor: none;"}},i={selector:"body",styles:{dragging:`
        cursor: grabbing;
        cursor: -webkit-grabbing;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        overflow-anchor: none;
      `}},s=[n,r,a,i];return{always:ty(s,"always"),resting:ty(s,"resting"),dragging:ty(s,"dragging"),dropAnimating:ty(s,"dropAnimating"),userCancel:ty(s,"userCancel")}},jc=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?p.useLayoutEffect:p.useEffect,mE=function(){var t=document.querySelector("head");return t||Hr(!1),t},K9=function(t){var r=document.createElement("style");return t&&r.setAttribute("nonce",t),r.type="text/css",r};function irt(e,t){var r=Ua(function(){return ort(e)},[e]),n=p.useRef(null),a=p.useRef(null),i=Tn(is(function(f){var m=a.current;m||Hr(!1),m.textContent=f}),[]),s=Tn(function(f){var m=n.current;m||Hr(!1),m.textContent=f},[]);jc(function(){!n.current&&!a.current||Hr(!1);var f=K9(t),m=K9(t);return n.current=f,a.current=m,f.setAttribute(qx+"-always",e),m.setAttribute(qx+"-dynamic",e),mE().appendChild(f),mE().appendChild(m),s(r.always),i(r.resting),function(){var h=function(g){var y=g.current;y||Hr(!1),mE().removeChild(y),g.current=null};h(n),h(a)}},[t,s,i,r.always,r.resting,e]);var l=Tn(function(){return i(r.dragging)},[i,r.dragging]),c=Tn(function(f){if(f==="DROP"){i(r.dropAnimating);return}i(r.userCancel)},[i,r.dropAnimating,r.userCancel]),d=Tn(function(){a.current&&i(r.resting)},[i,r.resting]),u=Ua(function(){return{dragging:l,dropping:c,resting:d}},[l,c,d]);return u}var Pae=function(e){return e&&e.ownerDocument?e.ownerDocument.defaultView:window};function j5(e){return e instanceof Pae(e).HTMLElement}function srt(e,t){var r="["+zx.contextId+'="'+e+'"]',n=Yne(document.querySelectorAll(r));if(!n.length)return null;var a=Oh(n,function(i){return i.getAttribute(zx.draggableId)===t});return!a||!j5(a)?null:a}function lrt(e){var t=p.useRef({}),r=p.useRef(null),n=p.useRef(null),a=p.useRef(!1),i=Tn(function(m,h){var v={id:m,focus:h};return t.current[m]=v,function(){var y=t.current,x=y[m];x!==v&&delete y[m]}},[]),s=Tn(function(m){var h=srt(e,m);h&&h!==document.activeElement&&h.focus()},[e]),l=Tn(function(m,h){r.current===m&&(r.current=h)},[]),c=Tn(function(){n.current||a.current&&(n.current=requestAnimationFrame(function(){n.current=null;var m=r.current;m&&s(m)}))},[s]),d=Tn(function(m){r.current=null;var h=document.activeElement;h&&h.getAttribute(zx.draggableId)===m&&(r.current=m)},[]);jc(function(){return a.current=!0,function(){a.current=!1;var m=n.current;m&&cancelAnimationFrame(m)}},[]);var u=Ua(function(){return{register:i,tryRecordFocus:d,tryRestoreFocusRecorded:c,tryShiftRecord:l}},[i,d,c,l]);return u}function crt(){var e={draggables:{},droppables:{}},t=[];function r(f){return t.push(f),function(){var h=t.indexOf(f);h!==-1&&t.splice(h,1)}}function n(f){t.length&&t.forEach(function(m){return m(f)})}function a(f){return e.draggables[f]||null}function i(f){var m=a(f);return m||Hr(!1),m}var s={register:function(m){e.draggables[m.descriptor.id]=m,n({type:"ADDITION",value:m})},update:function(m,h){var v=e.draggables[h.descriptor.id];v&&v.uniqueId===m.uniqueId&&(delete e.draggables[h.descriptor.id],e.draggables[m.descriptor.id]=m)},unregister:function(m){var h=m.descriptor.id,v=a(h);v&&m.uniqueId===v.uniqueId&&(delete e.draggables[h],n({type:"REMOVAL",value:m}))},getById:i,findById:a,exists:function(m){return!!a(m)},getAllByType:function(m){return G_(e.draggables).filter(function(h){return h.descriptor.type===m})}};function l(f){return e.droppables[f]||null}function c(f){var m=l(f);return m||Hr(!1),m}var d={register:function(m){e.droppables[m.descriptor.id]=m},unregister:function(m){var h=l(m.descriptor.id);h&&m.uniqueId===h.uniqueId&&delete e.droppables[m.descriptor.id]},getById:c,findById:l,exists:function(m){return!!l(m)},getAllByType:function(m){return G_(e.droppables).filter(function(h){return h.descriptor.type===m})}};function u(){e.draggables={},e.droppables={},t.length=0}return{draggable:s,droppable:d,subscribe:r,clean:u}}function drt(){var e=Ua(crt,[]);return p.useEffect(function(){return function(){requestAnimationFrame(e.clean)}},[e]),e}var JM=ye.createContext(null),Y_=function(){var e=document.body;return e||Hr(!1),e},urt={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},frt=function(t){return"rbd-announcement-"+t};function mrt(e){var t=Ua(function(){return frt(e)},[e]),r=p.useRef(null);p.useEffect(function(){var i=document.createElement("div");return r.current=i,i.id=t,i.setAttribute("aria-live","assertive"),i.setAttribute("aria-atomic","true"),qn(i.style,urt),Y_().appendChild(i),function(){setTimeout(function(){var c=Y_();c.contains(i)&&c.removeChild(i),i===r.current&&(r.current=null)})}},[t]);var n=Tn(function(a){var i=r.current;if(i){i.textContent=a;return}},[]);return n}var hrt=0,prt={separator:"::"};function QM(e,t){return t===void 0&&(t=prt),Ua(function(){return""+e+t.separator+hrt++},[t.separator,e])}function grt(e){var t=e.contextId,r=e.uniqueId;return"rbd-hidden-text-"+t+"-"+r}function vrt(e){var t=e.contextId,r=e.text,n=QM("hidden-text",{separator:"-"}),a=Ua(function(){return grt({contextId:t,uniqueId:n})},[n,t]);return p.useEffect(function(){var s=document.createElement("div");return s.id=a,s.textContent=r,s.style.display="none",Y_().appendChild(s),function(){var c=Y_();c.contains(s)&&c.removeChild(s)}},[a,r]),a}var N5=ye.createContext(null);function Aae(e){var t=p.useRef(e);return p.useEffect(function(){t.current=e}),t}function xrt(){var e=null;function t(){return!!e}function r(s){return s===e}function n(s){e&&Hr(!1);var l={abandon:s};return e=l,l}function a(){e||Hr(!1),e=null}function i(){e&&(e.abandon(),a())}return{isClaimed:t,isActive:r,claim:n,release:a,tryAbandon:i}}var yrt=9,brt=13,ZM=27,Eae=32,wrt=33,jrt=34,Nrt=35,_rt=36,Srt=37,Crt=38,Prt=39,Art=40,W2,Ert=(W2={},W2[brt]=!0,W2[yrt]=!0,W2),kae=function(e){Ert[e.keyCode]&&e.preventDefault()},_5=function(){var e="visibilitychange";if(typeof document>"u")return e;var t=[e,"ms"+e,"webkit"+e,"moz"+e,"o"+e],r=Oh(t,function(n){return"on"+n in document});return r||e}(),Oae=0,Y9=5;function krt(e,t){return Math.abs(t.x-e.x)>=Y9||Math.abs(t.y-e.y)>=Y9}var X9={type:"IDLE"};function Ort(e){var t=e.cancel,r=e.completed,n=e.getPhase,a=e.setPhase;return[{eventName:"mousemove",fn:function(s){var l=s.button,c=s.clientX,d=s.clientY;if(l===Oae){var u={x:c,y:d},f=n();if(f.type==="DRAGGING"){s.preventDefault(),f.actions.move(u);return}f.type!=="PENDING"&&Hr(!1);var m=f.point;if(krt(m,u)){s.preventDefault();var h=f.actions.fluidLift(u);a({type:"DRAGGING",actions:h})}}}},{eventName:"mouseup",fn:function(s){var l=n();if(l.type!=="DRAGGING"){t();return}s.preventDefault(),l.actions.drop({shouldBlockNextClick:!0}),r()}},{eventName:"mousedown",fn:function(s){n().type==="DRAGGING"&&s.preventDefault(),t()}},{eventName:"keydown",fn:function(s){var l=n();if(l.type==="PENDING"){t();return}if(s.keyCode===ZM){s.preventDefault(),t();return}kae(s)}},{eventName:"resize",fn:t},{eventName:"scroll",options:{passive:!0,capture:!1},fn:function(){n().type==="PENDING"&&t()}},{eventName:"webkitmouseforcedown",fn:function(s){var l=n();if(l.type==="IDLE"&&Hr(!1),l.actions.shouldRespectForcePress()){t();return}s.preventDefault()}},{eventName:_5,fn:t}]}function Irt(e){var t=p.useRef(X9),r=p.useRef(th),n=Ua(function(){return{eventName:"mousedown",fn:function(f){if(!f.defaultPrevented&&f.button===Oae&&!(f.ctrlKey||f.metaKey||f.shiftKey||f.altKey)){var m=e.findClosestDraggableId(f);if(m){var h=e.tryGetLock(m,s,{sourceEvent:f});if(h){f.preventDefault();var v={x:f.clientX,y:f.clientY};r.current(),d(h,v)}}}}}},[e]),a=Ua(function(){return{eventName:"webkitmouseforcewillbegin",fn:function(f){if(!f.defaultPrevented){var m=e.findClosestDraggableId(f);if(m){var h=e.findOptionsForDraggable(m);h&&(h.shouldRespectForcePress||e.canGetLock(m)&&f.preventDefault())}}}}},[e]),i=Tn(function(){var f={passive:!1,capture:!0};r.current=od(window,[a,n],f)},[a,n]),s=Tn(function(){var u=t.current;u.type!=="IDLE"&&(t.current=X9,r.current(),i())},[i]),l=Tn(function(){var u=t.current;s(),u.type==="DRAGGING"&&u.actions.cancel({shouldBlockNextClick:!0}),u.type==="PENDING"&&u.actions.abort()},[s]),c=Tn(function(){var f={capture:!0,passive:!1},m=Ort({cancel:l,completed:s,getPhase:function(){return t.current},setPhase:function(v){t.current=v}});r.current=od(window,m,f)},[l,s]),d=Tn(function(f,m){t.current.type!=="IDLE"&&Hr(!1),t.current={type:"PENDING",point:m,actions:f},c()},[c]);jc(function(){return i(),function(){r.current()}},[i])}var Kg;function Trt(){}var Drt=(Kg={},Kg[jrt]=!0,Kg[wrt]=!0,Kg[_rt]=!0,Kg[Nrt]=!0,Kg);function Mrt(e,t){function r(){t(),e.cancel()}function n(){t(),e.drop()}return[{eventName:"keydown",fn:function(i){if(i.keyCode===ZM){i.preventDefault(),r();return}if(i.keyCode===Eae){i.preventDefault(),n();return}if(i.keyCode===Art){i.preventDefault(),e.moveDown();return}if(i.keyCode===Crt){i.preventDefault(),e.moveUp();return}if(i.keyCode===Prt){i.preventDefault(),e.moveRight();return}if(i.keyCode===Srt){i.preventDefault(),e.moveLeft();return}if(Drt[i.keyCode]){i.preventDefault();return}kae(i)}},{eventName:"mousedown",fn:r},{eventName:"mouseup",fn:r},{eventName:"click",fn:r},{eventName:"touchstart",fn:r},{eventName:"resize",fn:r},{eventName:"wheel",fn:r,options:{passive:!0}},{eventName:_5,fn:r}]}function Rrt(e){var t=p.useRef(Trt),r=Ua(function(){return{eventName:"keydown",fn:function(i){if(i.defaultPrevented||i.keyCode!==Eae)return;var s=e.findClosestDraggableId(i);if(!s)return;var l=e.tryGetLock(s,u,{sourceEvent:i});if(!l)return;i.preventDefault();var c=!0,d=l.snapLift();t.current();function u(){c||Hr(!1),c=!1,t.current(),n()}t.current=od(window,Mrt(d,u),{capture:!0,passive:!1})}}},[e]),n=Tn(function(){var i={passive:!1,capture:!0};t.current=od(window,[r],i)},[r]);jc(function(){return n(),function(){t.current()}},[n])}var hE={type:"IDLE"},Lrt=120,$rt=.15;function Frt(e){var t=e.cancel,r=e.getPhase;return[{eventName:"orientationchange",fn:t},{eventName:"resize",fn:t},{eventName:"contextmenu",fn:function(a){a.preventDefault()}},{eventName:"keydown",fn:function(a){if(r().type!=="DRAGGING"){t();return}a.keyCode===ZM&&a.preventDefault(),t()}},{eventName:_5,fn:t}]}function Brt(e){var t=e.cancel,r=e.completed,n=e.getPhase;return[{eventName:"touchmove",options:{capture:!1},fn:function(i){var s=n();if(s.type!=="DRAGGING"){t();return}s.hasMoved=!0;var l=i.touches[0],c=l.clientX,d=l.clientY,u={x:c,y:d};i.preventDefault(),s.actions.move(u)}},{eventName:"touchend",fn:function(i){var s=n();if(s.type!=="DRAGGING"){t();return}i.preventDefault(),s.actions.drop({shouldBlockNextClick:!0}),r()}},{eventName:"touchcancel",fn:function(i){if(n().type!=="DRAGGING"){t();return}i.preventDefault(),t()}},{eventName:"touchforcechange",fn:function(i){var s=n();s.type==="IDLE"&&Hr(!1);var l=i.touches[0];if(l){var c=l.force>=$rt;if(c){var d=s.actions.shouldRespectForcePress();if(s.type==="PENDING"){d&&t();return}if(d){if(s.hasMoved){i.preventDefault();return}t();return}i.preventDefault()}}}},{eventName:_5,fn:t}]}function qrt(e){var t=p.useRef(hE),r=p.useRef(th),n=Tn(function(){return t.current},[]),a=Tn(function(h){t.current=h},[]),i=Ua(function(){return{eventName:"touchstart",fn:function(h){if(!h.defaultPrevented){var v=e.findClosestDraggableId(h);if(v){var g=e.tryGetLock(v,l,{sourceEvent:h});if(g){var y=h.touches[0],x=y.clientX,b=y.clientY,w={x,y:b};r.current(),f(g,w)}}}}}},[e]),s=Tn(function(){var h={capture:!0,passive:!1};r.current=od(window,[i],h)},[i]),l=Tn(function(){var m=t.current;m.type!=="IDLE"&&(m.type==="PENDING"&&clearTimeout(m.longPressTimerId),a(hE),r.current(),s())},[s,a]),c=Tn(function(){var m=t.current;l(),m.type==="DRAGGING"&&m.actions.cancel({shouldBlockNextClick:!0}),m.type==="PENDING"&&m.actions.abort()},[l]),d=Tn(function(){var h={capture:!0,passive:!1},v={cancel:c,completed:l,getPhase:n},g=od(window,Brt(v),h),y=od(window,Frt(v),h);r.current=function(){g(),y()}},[c,n,l]),u=Tn(function(){var h=n();h.type!=="PENDING"&&Hr(!1);var v=h.actions.fluidLift(h.point);a({type:"DRAGGING",actions:v,hasMoved:!1})},[n,a]),f=Tn(function(h,v){n().type!=="IDLE"&&Hr(!1);var g=setTimeout(u,Lrt);a({type:"PENDING",point:v,actions:h,longPressTimerId:g}),d()},[d,n,a,u]);jc(function(){return s(),function(){r.current();var v=n();v.type==="PENDING"&&(clearTimeout(v.longPressTimerId),a(hE))}},[n,s,a]),jc(function(){var h=od(window,[{eventName:"touchmove",fn:function(){},options:{capture:!1,passive:!1}}]);return h},[])}var zrt={input:!0,button:!0,textarea:!0,select:!0,option:!0,optgroup:!0,video:!0,audio:!0};function Iae(e,t){if(t==null)return!1;var r=!!zrt[t.tagName.toLowerCase()];if(r)return!0;var n=t.getAttribute("contenteditable");return n==="true"||n===""?!0:t===e?!1:Iae(e,t.parentElement)}function Urt(e,t){var r=t.target;return j5(r)?Iae(e,r):!1}var Vrt=function(e){return Bd(e.getBoundingClientRect()).center};function Wrt(e){return e instanceof Pae(e).Element}var Hrt=function(){var e="matches";if(typeof document>"u")return e;var t=[e,"msMatchesSelector","webkitMatchesSelector"],r=Oh(t,function(n){return n in Element.prototype});return r||e}();function Tae(e,t){return e==null?null:e[Hrt](t)?e:Tae(e.parentElement,t)}function Grt(e,t){return e.closest?e.closest(t):Tae(e,t)}function Krt(e){return"["+zx.contextId+'="'+e+'"]'}function Yrt(e,t){var r=t.target;if(!Wrt(r))return null;var n=Krt(e),a=Grt(r,n);return!a||!j5(a)?null:a}function Xrt(e,t){var r=Yrt(e,t);return r?r.getAttribute(zx.draggableId):null}function Jrt(e,t){var r="["+x4.contextId+'="'+e+'"]',n=Yne(document.querySelectorAll(r)),a=Oh(n,function(i){return i.getAttribute(x4.id)===t});return!a||!j5(a)?null:a}function Qrt(e){e.preventDefault()}function H2(e){var t=e.expected,r=e.phase,n=e.isLockActive;return e.shouldWarn,!(!n()||t!==r)}function Dae(e){var t=e.lockAPI,r=e.store,n=e.registry,a=e.draggableId;if(t.isClaimed())return!1;var i=n.draggable.findById(a);return!(!i||!i.options.isEnabled||!Nae(r.getState(),a))}function Zrt(e){var t=e.lockAPI,r=e.contextId,n=e.store,a=e.registry,i=e.draggableId,s=e.forceSensorStop,l=e.sourceEvent,c=Dae({lockAPI:t,store:n,registry:a,draggableId:i});if(!c)return null;var d=a.draggable.getById(i),u=Jrt(r,d.descriptor.id);if(!u||l&&!d.options.canDragInteractiveElements&&Urt(u,l))return null;var f=t.claim(s||th),m="PRE_DRAG";function h(){return d.options.shouldRespectForcePress}function v(){return t.isActive(f)}function g(C,E){H2({expected:C,phase:m,isLockActive:v,shouldWarn:!0})&&n.dispatch(E())}var y=g.bind(null,"DRAGGING");function x(C){function E(){t.release(),m="COMPLETED"}m!=="PRE_DRAG"&&(E(),m!=="PRE_DRAG"&&Hr(!1)),n.dispatch(Het(C.liftActionArgs)),m="DRAGGING";function P(k,M){if(M===void 0&&(M={shouldBlockNextClick:!1}),C.cleanup(),M.shouldBlockNextClick){var S=od(window,[{eventName:"click",fn:Qrt,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(S)}E(),n.dispatch(gae({reason:k}))}return qn({isActive:function(){return H2({expected:"DRAGGING",phase:m,isLockActive:v,shouldWarn:!1})},shouldRespectForcePress:h,drop:function(M){return P("DROP",M)},cancel:function(M){return P("CANCEL",M)}},C.actions)}function b(C){var E=C1(function(k){y(function(){return pae({client:k})})}),P=x({liftActionArgs:{id:i,clientSelection:C,movementMode:"FLUID"},cleanup:function(){return E.cancel()},actions:{move:E}});return qn({},P,{move:E})}function w(){var C={moveUp:function(){return y(ttt)},moveRight:function(){return y(ntt)},moveDown:function(){return y(rtt)},moveLeft:function(){return y(att)}};return x({liftActionArgs:{id:i,clientSelection:Vrt(u),movementMode:"SNAP"},cleanup:th,actions:C})}function j(){var C=H2({expected:"PRE_DRAG",phase:m,isLockActive:v,shouldWarn:!0});C&&t.release()}var _={isActive:function(){return H2({expected:"PRE_DRAG",phase:m,isLockActive:v,shouldWarn:!1})},shouldRespectForcePress:h,fluidLift:b,snapLift:w,abort:j};return _}var ent=[Irt,Rrt,qrt];function tnt(e){var t=e.contextId,r=e.store,n=e.registry,a=e.customSensors,i=e.enableDefaultSensors,s=[].concat(i?ent:[],a||[]),l=p.useState(function(){return xrt()})[0],c=Tn(function(b,w){b.isDragging&&!w.isDragging&&l.tryAbandon()},[l]);jc(function(){var b=r.getState(),w=r.subscribe(function(){var j=r.getState();c(b,j),b=j});return w},[l,r,c]),jc(function(){return l.tryAbandon},[l.tryAbandon]);for(var d=Tn(function(x){return Dae({lockAPI:l,registry:n,store:r,draggableId:x})},[l,n,r]),u=Tn(function(x,b,w){return Zrt({lockAPI:l,registry:n,contextId:t,store:r,draggableId:x,forceSensorStop:b,sourceEvent:w&&w.sourceEvent?w.sourceEvent:null})},[t,l,n,r]),f=Tn(function(x){return Xrt(t,x)},[t]),m=Tn(function(x){var b=n.draggable.findById(x);return b?b.options:null},[n.draggable]),h=Tn(function(){l.isClaimed()&&(l.tryAbandon(),r.getState().phase!=="IDLE"&&r.dispatch(UM()))},[l,r]),v=Tn(l.isClaimed,[l]),g=Ua(function(){return{canGetLock:d,tryGetLock:u,findClosestDraggableId:f,findOptionsForDraggable:m,tryReleaseLock:h,isLockClaimed:v}},[d,u,f,m,h,v]),y=0;y<s.length;y++)s[y](g)}var rnt=function(t){return{onBeforeCapture:t.onBeforeCapture,onBeforeDragStart:t.onBeforeDragStart,onDragStart:t.onDragStart,onDragEnd:t.onDragEnd,onDragUpdate:t.onDragUpdate}};function ry(e){return e.current||Hr(!1),e.current}function nnt(e){var t=e.contextId,r=e.setCallbacks,n=e.sensors,a=e.nonce,i=e.dragHandleUsageInstructions,s=p.useRef(null),l=Aae(e),c=Tn(function(){return rnt(l.current)},[l]),d=mrt(t),u=vrt({contextId:t,text:i}),f=irt(t,a),m=Tn(function(k){ry(s).dispatch(k)},[]),h=Ua(function(){return y9({publishWhileDragging:Ket,updateDroppableScroll:Xet,updateDroppableIsEnabled:Jet,updateDroppableIsCombineEnabled:Qet,collectionStarting:Yet},m)},[m]),v=drt(),g=Ua(function(){return $tt(v,h)},[v,h]),y=Ua(function(){return trt(qn({scrollWindow:Ftt,scrollDroppable:g.scrollDroppable},y9({move:pae},m)))},[g.scrollDroppable,m]),x=lrt(t),b=Ua(function(){return Dtt({announce:d,autoScroller:y,dimensionMarshal:g,focusMarshal:x,getResponders:c,styleMarshal:f})},[d,y,g,x,c,f]);s.current=b;var w=Tn(function(){var k=ry(s),M=k.getState();M.phase!=="IDLE"&&k.dispatch(UM())},[]),j=Tn(function(){var k=ry(s).getState();return k.isDragging||k.phase==="DROP_ANIMATING"},[]),_=Ua(function(){return{isDragging:j,tryAbort:w}},[j,w]);r(_);var C=Tn(function(k){return Nae(ry(s).getState(),k)},[]),E=Tn(function(){return rp(ry(s).getState())},[]),P=Ua(function(){return{marshal:g,focus:x,contextId:t,canLift:C,isMovementAllowed:E,dragHandleUsageInstructionsId:u,registry:v}},[t,g,u,x,C,E,v]);return tnt({contextId:t,store:b,registry:v,customSensors:n,enableDefaultSensors:e.enableDefaultSensors!==!1}),p.useEffect(function(){return w},[w]),ye.createElement(N5.Provider,{value:P},ye.createElement(_Qe,{context:JM,store:b},e.children))}var ant=0;function ont(){return Ua(function(){return""+ant++},[])}function int(e){var t=ont(),r=e.dragHandleUsageInstructions||Aj.dragHandleUsageInstructions;return ye.createElement(DZe,null,function(n){return ye.createElement(nnt,{nonce:e.nonce,contextId:t,setCallbacks:n,dragHandleUsageInstructions:r,enableDefaultSensors:e.enableDefaultSensors,sensors:e.sensors,onBeforeCapture:e.onBeforeCapture,onBeforeDragStart:e.onBeforeDragStart,onDragStart:e.onDragStart,onDragUpdate:e.onDragUpdate,onDragEnd:e.onDragEnd},e.children)})}var Mae=function(t){return function(r){return t===r}},snt=Mae("scroll"),lnt=Mae("auto"),J9=function(t,r){return r(t.overflowX)||r(t.overflowY)},cnt=function(t){var r=window.getComputedStyle(t),n={overflowX:r.overflowX,overflowY:r.overflowY};return J9(n,snt)||J9(n,lnt)},dnt=function(){return!1},unt=function e(t){return t==null?null:t===document.body?dnt()?t:null:t===document.documentElement?null:cnt(t)?t:e(t.parentElement)},y4=function(e){return{x:e.scrollLeft,y:e.scrollTop}},fnt=function e(t){if(!t)return!1;var r=window.getComputedStyle(t);return r.position==="fixed"?!0:e(t.parentElement)},mnt=function(e){var t=unt(e),r=fnt(e);return{closestScrollable:t,isFixedOnPage:r}},hnt=function(e){var t=e.descriptor,r=e.isEnabled,n=e.isCombineEnabled,a=e.isFixedOnPage,i=e.direction,s=e.client,l=e.page,c=e.closest,d=function(){if(!c)return null;var h=c.scrollSize,v=c.client,g=bae({scrollHeight:h.scrollHeight,scrollWidth:h.scrollWidth,height:v.paddingBox.height,width:v.paddingBox.width});return{pageMarginBox:c.page.marginBox,frameClient:v,scrollSize:h,shouldClipSubject:c.shouldClipSubject,scroll:{initial:c.scroll,current:c.scroll,max:g,diff:{value:ss,displacement:ss}}}}(),u=i==="vertical"?$M:eae,f=Bx({page:l,withPlaceholder:null,axis:u,frame:d}),m={descriptor:t,isCombineEnabled:n,isFixedOnPage:a,axis:u,isEnabled:r,client:s,page:l,frame:d,subject:f};return m},pnt=function(t,r){var n=Vne(t);if(!r||t!==r)return n;var a=n.paddingBox.top-r.scrollTop,i=n.paddingBox.left-r.scrollLeft,s=a+r.scrollHeight,l=i+r.scrollWidth,c={top:a,right:l,bottom:s,left:i},d=TM(c,n.border),u=DM({borderBox:d,margin:n.margin,border:n.border,padding:n.padding});return u},gnt=function(e){var t=e.ref,r=e.descriptor,n=e.env,a=e.windowScroll,i=e.direction,s=e.isDropDisabled,l=e.isCombineEnabled,c=e.shouldClipSubject,d=n.closestScrollable,u=pnt(t,d),f=V_(u,a),m=function(){if(!d)return null;var v=Vne(d),g={scrollHeight:d.scrollHeight,scrollWidth:d.scrollWidth};return{client:v,page:V_(v,a),scroll:y4(d),scrollSize:g,shouldClipSubject:c}}(),h=hnt({descriptor:r,isEnabled:!s,isCombineEnabled:l,isFixedOnPage:n.isFixedOnPage,direction:i,client:u,page:f,closest:m});return h},vnt={passive:!1},xnt={passive:!0},Q9=function(e){return e.shouldPublishImmediately?vnt:xnt};function X_(e){var t=p.useContext(e);return t||Hr(!1),t}var G2=function(t){return t&&t.env.closestScrollable||null};function ynt(e){var t=p.useRef(null),r=X_(N5),n=QM("droppable"),a=r.registry,i=r.marshal,s=Aae(e),l=Ua(function(){return{id:e.droppableId,type:e.type,mode:e.mode}},[e.droppableId,e.mode,e.type]),c=p.useRef(l),d=Ua(function(){return is(function(j,_){t.current||Hr(!1);var C={x:j,y:_};i.updateDroppableScroll(l.id,C)})},[l.id,i]),u=Tn(function(){var j=t.current;return!j||!j.env.closestScrollable?ss:y4(j.env.closestScrollable)},[]),f=Tn(function(){var j=u();d(j.x,j.y)},[u,d]),m=Ua(function(){return C1(f)},[f]),h=Tn(function(){var j=t.current,_=G2(j);j&&_||Hr(!1);var C=j.scrollOptions;if(C.shouldPublishImmediately){f();return}m()},[m,f]),v=Tn(function(j,_){t.current&&Hr(!1);var C=s.current,E=C.getDroppableRef();E||Hr(!1);var P=mnt(E),k={ref:E,descriptor:l,env:P,scrollOptions:_};t.current=k;var M=gnt({ref:E,descriptor:l,env:P,windowScroll:j,direction:C.direction,isDropDisabled:C.isDropDisabled,isCombineEnabled:C.isCombineEnabled,shouldClipSubject:!C.ignoreContainerClipping}),S=P.closestScrollable;return S&&(S.setAttribute(G9.contextId,r.contextId),S.addEventListener("scroll",h,Q9(k.scrollOptions))),M},[r.contextId,l,h,s]),g=Tn(function(){var j=t.current,_=G2(j);return j&&_||Hr(!1),y4(_)},[]),y=Tn(function(){var j=t.current;j||Hr(!1);var _=G2(j);t.current=null,_&&(m.cancel(),_.removeAttribute(G9.contextId),_.removeEventListener("scroll",h,Q9(j.scrollOptions)))},[h,m]),x=Tn(function(j){var _=t.current;_||Hr(!1);var C=G2(_);C||Hr(!1),C.scrollTop+=j.y,C.scrollLeft+=j.x},[]),b=Ua(function(){return{getDimensionAndWatchScroll:v,getScrollWhileDragging:g,dragStopped:y,scroll:x}},[y,v,g,x]),w=Ua(function(){return{uniqueId:n,descriptor:l,callbacks:b}},[b,l,n]);jc(function(){return c.current=w.descriptor,a.droppable.register(w),function(){t.current&&y(),a.droppable.unregister(w)}},[b,l,y,w,i,a.droppable]),jc(function(){t.current&&i.updateDroppableIsEnabled(c.current.id,!e.isDropDisabled)},[e.isDropDisabled,i]),jc(function(){t.current&&i.updateDroppableIsCombineEnabled(c.current.id,e.isCombineEnabled)},[e.isCombineEnabled,i])}function pE(){}var Z9={width:0,height:0,margin:BZe},bnt=function(t){var r=t.isAnimatingOpenOnMount,n=t.placeholder,a=t.animate;return r||a==="close"?Z9:{height:n.client.borderBox.height,width:n.client.borderBox.width,margin:n.client.margin}},wnt=function(t){var r=t.isAnimatingOpenOnMount,n=t.placeholder,a=t.animate,i=bnt({isAnimatingOpenOnMount:r,placeholder:n,animate:a});return{display:n.display,boxSizing:"border-box",width:i.width,height:i.height,marginTop:i.margin.top,marginRight:i.margin.right,marginBottom:i.margin.bottom,marginLeft:i.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:a!=="none"?eb.placeholder:null}};function jnt(e){var t=p.useRef(null),r=Tn(function(){t.current&&(clearTimeout(t.current),t.current=null)},[]),n=e.animate,a=e.onTransitionEnd,i=e.onClose,s=e.contextId,l=p.useState(e.animate==="open"),c=l[0],d=l[1];p.useEffect(function(){return c?n!=="open"?(r(),d(!1),pE):t.current?pE:(t.current=setTimeout(function(){t.current=null,d(!1)}),r):pE},[n,c,r]);var u=Tn(function(m){m.propertyName==="height"&&(a(),n==="close"&&i())},[n,i,a]),f=wnt({isAnimatingOpenOnMount:c,animate:e.animate,placeholder:e.placeholder});return ye.createElement(e.placeholder.tagName,{style:f,"data-rbd-placeholder-context-id":s,onTransitionEnd:u,ref:e.innerRef})}var Nnt=ye.memo(jnt),eR=ye.createContext(null),_nt=function(e){UJ(t,e);function t(){for(var n,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return n=e.call.apply(e,[this].concat(i))||this,n.state={isVisible:!!n.props.on,data:n.props.on,animate:n.props.shouldAnimate&&n.props.on?"open":"none"},n.onClose=function(){n.state.animate==="close"&&n.setState({isVisible:!1})},n}t.getDerivedStateFromProps=function(a,i){return a.shouldAnimate?a.on?{isVisible:!0,data:a.on,animate:"open"}:i.isVisible?{isVisible:!0,data:i.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:!!a.on,data:a.on,animate:"none"}};var r=t.prototype;return r.render=function(){if(!this.state.isVisible)return null;var a={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(a)},t}(ye.PureComponent),eU={dragging:5e3,dropAnimating:4500},Snt=function(t,r){return r?eb.drop(r.duration):t?eb.snap:eb.fluid},Cnt=function(t,r){return t?r?k1.opacity.drop:k1.opacity.combining:null},Pnt=function(t){return t.forceShouldAnimate!=null?t.forceShouldAnimate:t.mode==="SNAP"};function Ant(e){var t=e.dimension,r=t.client,n=e.offset,a=e.combineWith,i=e.dropping,s=!!a,l=Pnt(e),c=!!i,d=c?g4.drop(n,s):g4.moveTo(n),u={position:"fixed",top:r.marginBox.top,left:r.marginBox.left,boxSizing:"border-box",width:r.borderBox.width,height:r.borderBox.height,transition:Snt(l,i),transform:d,opacity:Cnt(s,c),zIndex:c?eU.dropAnimating:eU.dragging,pointerEvents:"none"};return u}function Ent(e){return{transform:g4.moveTo(e.offset),transition:e.shouldAnimateDisplacement?null:"none"}}function knt(e){return e.type==="DRAGGING"?Ant(e):Ent(e)}function Ont(e,t,r){r===void 0&&(r=ss);var n=window.getComputedStyle(t),a=t.getBoundingClientRect(),i=Une(a,n),s=V_(i,r),l={client:i,tagName:t.tagName.toLowerCase(),display:n.display},c={x:i.marginBox.width,y:i.marginBox.height},d={descriptor:e,placeholder:l,displaceBy:c,client:i,page:s};return d}function Int(e){var t=QM("draggable"),r=e.descriptor,n=e.registry,a=e.getDraggableRef,i=e.canDragInteractiveElements,s=e.shouldRespectForcePress,l=e.isEnabled,c=Ua(function(){return{canDragInteractiveElements:i,shouldRespectForcePress:s,isEnabled:l}},[i,l,s]),d=Tn(function(h){var v=a();return v||Hr(!1),Ont(r,v,h)},[r,a]),u=Ua(function(){return{uniqueId:t,descriptor:r,options:c,getDimension:d}},[r,d,c,t]),f=p.useRef(u),m=p.useRef(!0);jc(function(){return n.draggable.register(f.current),function(){return n.draggable.unregister(f.current)}},[n.draggable]),jc(function(){if(m.current){m.current=!1;return}var h=f.current;f.current=u,n.draggable.update(u,h)},[u,n.draggable])}function Tnt(e){e.preventDefault()}function Dnt(e){var t=p.useRef(null),r=Tn(function(k){t.current=k},[]),n=Tn(function(){return t.current},[]),a=X_(N5),i=a.contextId,s=a.dragHandleUsageInstructionsId,l=a.registry,c=X_(eR),d=c.type,u=c.droppableId,f=Ua(function(){return{id:e.draggableId,index:e.index,type:d,droppableId:u}},[e.draggableId,e.index,d,u]),m=e.children,h=e.draggableId,v=e.isEnabled,g=e.shouldRespectForcePress,y=e.canDragInteractiveElements,x=e.isClone,b=e.mapped,w=e.dropAnimationFinished;if(!x){var j=Ua(function(){return{descriptor:f,registry:l,getDraggableRef:n,canDragInteractiveElements:y,shouldRespectForcePress:g,isEnabled:v}},[f,l,n,y,g,v]);Int(j)}var _=Ua(function(){return v?{tabIndex:0,role:"button","aria-describedby":s,"data-rbd-drag-handle-draggable-id":h,"data-rbd-drag-handle-context-id":i,draggable:!1,onDragStart:Tnt}:null},[i,s,h,v]),C=Tn(function(k){b.type==="DRAGGING"&&b.dropping&&k.propertyName==="transform"&&w()},[w,b]),E=Ua(function(){var k=knt(b),M=b.type==="DRAGGING"&&b.dropping?C:null,S={innerRef:r,draggableProps:{"data-rbd-draggable-context-id":i,"data-rbd-draggable-id":h,style:k,onTransitionEnd:M},dragHandleProps:_};return S},[i,_,h,b,C,r]),P=Ua(function(){return{draggableId:f.id,type:f.type,source:{index:f.index,droppableId:f.droppableId}}},[f.droppableId,f.id,f.index,f.type]);return m(E,b.snapshot,P)}var Rae=function(e,t){return e===t},Lae=function(e){var t=e.combine,r=e.destination;return r?r.droppableId:t?t.droppableId:null},Mnt=function(t){return t.combine?t.combine.draggableId:null},Rnt=function(t){return t.at&&t.at.type==="COMBINE"?t.at.combine.draggableId:null};function Lnt(){var e=is(function(a,i){return{x:a,y:i}}),t=is(function(a,i,s,l,c){return{isDragging:!0,isClone:i,isDropAnimating:!!c,dropAnimation:c,mode:a,draggingOver:s,combineWith:l,combineTargetFor:null}}),r=is(function(a,i,s,l,c,d,u){return{mapped:{type:"DRAGGING",dropping:null,draggingOver:c,combineWith:d,mode:i,offset:a,dimension:s,forceShouldAnimate:u,snapshot:t(i,l,c,d,null)}}}),n=function(i,s){if(i.isDragging){if(i.critical.draggable.id!==s.draggableId)return null;var l=i.current.client.offset,c=i.dimensions.draggables[s.draggableId],d=wc(i.impact),u=Rnt(i.impact),f=i.forceShouldAnimate;return r(e(l.x,l.y),i.movementMode,c,s.isClone,d,u,f)}if(i.phase==="DROP_ANIMATING"){var m=i.completed;if(m.result.draggableId!==s.draggableId)return null;var h=s.isClone,v=i.dimensions.draggables[s.draggableId],g=m.result,y=g.mode,x=Lae(g),b=Mnt(g),w=i.dropDuration,j={duration:w,curve:WM.drop,moveTo:i.newHomeClientOffset,opacity:b?k1.opacity.drop:null,scale:b?k1.scale.drop:null};return{mapped:{type:"DRAGGING",offset:i.newHomeClientOffset,dimension:v,dropping:j,draggingOver:x,combineWith:b,mode:y,forceShouldAnimate:null,snapshot:t(y,h,x,b,j)}}}return null};return n}function $ae(e){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:e,combineWith:null}}var $nt={mapped:{type:"SECONDARY",offset:ss,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:$ae(null)}};function Fnt(){var e=is(function(s,l){return{x:s,y:l}}),t=is($ae),r=is(function(s,l,c){return l===void 0&&(l=null),{mapped:{type:"SECONDARY",offset:s,combineTargetFor:l,shouldAnimateDisplacement:c,snapshot:t(l)}}}),n=function(l){return l?r(ss,l,!0):null},a=function(l,c,d,u){var f=d.displaced.visible[l],m=!!(u.inVirtualList&&u.effected[l]),h=y5(d),v=h&&h.draggableId===l?c:null;if(!f){if(!m)return n(v);if(d.displaced.invisible[l])return null;var g=y0(u.displacedBy.point),y=e(g.x,g.y);return r(y,v,!0)}if(m)return n(v);var x=d.displacedBy.point,b=e(x.x,x.y);return r(b,v,f.shouldAnimate)},i=function(l,c){if(l.isDragging)return l.critical.draggable.id===c.draggableId?null:a(c.draggableId,l.critical.draggable.id,l.impact,l.afterCritical);if(l.phase==="DROP_ANIMATING"){var d=l.completed;return d.result.draggableId===c.draggableId?null:a(c.draggableId,d.result.draggableId,d.impact,d.afterCritical)}return null};return i}var Bnt=function(){var t=Lnt(),r=Fnt(),n=function(i,s){return t(i,s)||r(i,s)||$nt};return n},qnt={dropAnimationFinished:vae},znt=qne(Bnt,qnt,null,{context:JM,pure:!0,areStatePropsEqual:Rae})(Dnt);function Fae(e){var t=X_(eR),r=t.isUsingCloneFor;return r===e.draggableId&&!e.isClone?null:ye.createElement(znt,e)}function Unt(e){var t=typeof e.isDragDisabled=="boolean"?!e.isDragDisabled:!0,r=!!e.disableInteractiveElementBlocking,n=!!e.shouldRespectForcePress;return ye.createElement(Fae,qn({},e,{isClone:!1,isEnabled:t,canDragInteractiveElements:r,shouldRespectForcePress:n}))}function Vnt(e){var t=p.useContext(N5);t||Hr(!1);var r=t.contextId,n=t.isMovementAllowed,a=p.useRef(null),i=p.useRef(null),s=e.children,l=e.droppableId,c=e.type,d=e.mode,u=e.direction,f=e.ignoreContainerClipping,m=e.isDropDisabled,h=e.isCombineEnabled,v=e.snapshot,g=e.useClone,y=e.updateViewportMaxScroll,x=e.getContainerForClone,b=Tn(function(){return a.current},[]),w=Tn(function(S){a.current=S},[]);Tn(function(){return i.current},[]);var j=Tn(function(S){i.current=S},[]),_=Tn(function(){n()&&y({maxScroll:jae()})},[n,y]);ynt({droppableId:l,type:c,mode:d,direction:u,isDropDisabled:m,isCombineEnabled:h,ignoreContainerClipping:f,getDroppableRef:b});var C=ye.createElement(_nt,{on:e.placeholder,shouldAnimate:e.shouldAnimatePlaceholder},function(S){var I=S.onClose,T=S.data,D=S.animate;return ye.createElement(Nnt,{placeholder:T,onClose:I,innerRef:j,animate:D,contextId:r,onTransitionEnd:_})}),E=Ua(function(){return{innerRef:w,placeholder:C,droppableProps:{"data-rbd-droppable-id":l,"data-rbd-droppable-context-id":r}}},[r,l,C,w]),P=g?g.dragging.draggableId:null,k=Ua(function(){return{droppableId:l,type:c,isUsingCloneFor:P}},[l,P,c]);function M(){if(!g)return null;var S=g.dragging,I=g.render,T=ye.createElement(Fae,{draggableId:S.draggableId,index:S.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},function(D,B){return I(D,B,S)});return DW.createPortal(T,x())}return ye.createElement(eR.Provider,{value:k},s(E,v),M())}var gE=function(t,r){return t===r.droppable.type},tU=function(t,r){return r.draggables[t.draggable.id]},Wnt=function(){var t={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},r=qn({},t,{shouldAnimatePlaceholder:!1}),n=is(function(s){return{draggableId:s.id,type:s.type,source:{index:s.index,droppableId:s.droppableId}}}),a=is(function(s,l,c,d,u,f){var m=u.descriptor.id,h=u.descriptor.droppableId===s;if(h){var v=f?{render:f,dragging:n(u.descriptor)}:null,g={isDraggingOver:c,draggingOverWith:c?m:null,draggingFromThisWith:m,isUsingPlaceholder:!0};return{placeholder:u.placeholder,shouldAnimatePlaceholder:!1,snapshot:g,useClone:v}}if(!l)return r;if(!d)return t;var y={isDraggingOver:c,draggingOverWith:m,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:u.placeholder,shouldAnimatePlaceholder:!0,snapshot:y,useClone:null}}),i=function(l,c){var d=c.droppableId,u=c.type,f=!c.isDropDisabled,m=c.renderClone;if(l.isDragging){var h=l.critical;if(!gE(u,h))return r;var v=tU(h,l.dimensions),g=wc(l.impact)===d;return a(d,f,g,g,v,m)}if(l.phase==="DROP_ANIMATING"){var y=l.completed;if(!gE(u,y.critical))return r;var x=tU(y.critical,l.dimensions);return a(d,f,Lae(y.result)===d,wc(y.impact)===d,x,m)}if(l.phase==="IDLE"&&l.completed&&!l.shouldFlush){var b=l.completed;if(!gE(u,b.critical))return r;var w=wc(b.impact)===d,j=!!(b.impact.at&&b.impact.at.type==="COMBINE"),_=b.critical.droppable.id===d;return w?j?t:r:_?t:r}return r};return i},Hnt={updateViewportMaxScroll:ett};function Gnt(){return document.body||Hr(!1),document.body}var Knt={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:Gnt},Bae=qne(Wnt,Hnt,null,{context:JM,pure:!0,areStatePropsEqual:Rae})(Vnt);Bae.defaultProps=Knt;function Yg({className:e,...t}){return o.jsx("div",{className:Yt("animate-pulse rounded-md bg-muted/20",e),...t})}function S5(e){return{id:e.id,code:e.codigo_produto??"",name:e.nome,category:e.categoria??"",type:e.tipo_produto==="uso_interno"?"Uso Interno":"Venda",cost:Number(e.valor_custo??e.preco_custo??0),price:Number(e.valor_venda??e.preco_venda??0),stock:Number(e.estoque??e.estoque_atual??0),minStock:Number(e.estoque_minimo??0),status:e.status??(e.ativo===!1||Number(e.estoque??0)===0?"inactive":Number(e.estoque??0)>0&&Number(e.estoque??0)<=Number(e.estoque_minimo??0)?"low_stock":"active"),validade:e.validade?new Date(e.validade):null,barcode:e.codigo_barras??"",barcodeBox:e.codigo_barras_caixa??"",reference:e.referencia??"",brand:e.marca??"",group:e.grupo??"",unit:e.unidade??"UN",initialStock:Number(e.estoque_inicial??0),currentStock:Number(e.estoque_atual??e.estoque??0),weight:e.peso!=null?Number(e.peso):null,buyPrice:e.preco_compra!=null?Number(e.preco_compra):null,costsPercent:e.custos_percent!=null?Number(e.custos_percent):null,costPrice:e.preco_custo!=null?Number(e.preco_custo):null,marginPercent:e.lucro_percent!=null?Number(e.lucro_percent):null,salePrice:e.preco_venda!=null?Number(e.preco_venda):null,wholesaleQty:e.qtd_atacado!=null?Number(e.qtd_atacado):null,wholesalePrice:e.preco_atacado!=null?Number(e.preco_atacado):null,commissionPercent:e.comissao_percent!=null?Number(e.comissao_percent):null,discountPercent:e.desconto_percent!=null?Number(e.desconto_percent):null,cfopInterno:e.cfop_interno??"",cstIcmsInterno:e.cst_icms_interno??"",csosnInterno:e.csosn_interno??"",aliqIcmsInterno:e.aliquota_icms_interno!=null?Number(e.aliquota_icms_interno):null,cfopExterno:e.cfop_externo??"",cstIcmsExterno:e.cst_icms_externo??"",csosnExterno:e.csosn_externo??"",aliqIcmsExterno:e.aliquota_icms_externo!=null?Number(e.aliquota_icms_externo):null,cstPisEntrada:e.cst_pis_entrada??"",cstPisSaida:e.cst_pis_saida??"",aliqPisPercent:e.aliquota_pis_percent!=null?Number(e.aliquota_pis_percent):null,aliqCofinsPercent:e.aliquota_cofins_percent!=null?Number(e.aliquota_cofins_percent):null,cstIpi:e.cst_ipi??"",aliqIpiPercent:e.aliquota_ipi_percent!=null?Number(e.aliquota_ipi_percent):null,fcpPercent:e.fcp_percent!=null?Number(e.fcp_percent):null,mvaPercent:e.mva_percent!=null?Number(e.mva_percent):null,baseReduzidaPercent:e.base_reduzida_percent!=null?Number(e.base_reduzida_percent):null,ncm:e.ncm??"",ncmDescription:e.descricao_ncm??"",cest:e.cest??"",active:e.ativo??!0,allowSale:e.permite_venda??!0,payCommission:e.paga_comissao??!1,variablePrice:e.preco_variavel??!1,composition:e.composicao??!1,service:e.servico??!1,hasGrid:e.grade??!1,usePriceTable:e.usar_tabela_preco??!1,fuel:e.combustivel??!1,useImei:e.usa_imei??!1,stockByGrid:e.controle_estoque_por_grade??!1,showInApp:e.mostrar_no_app??!1,dataImportacao:e.data_importacao?new Date(e.data_importacao):null,importadoViaXml:e.importado_via_xml??!1}}async function Ynt({from:e,to:t,codigoEmpresa:r,limit:n=1e3}={}){if(!e||!t)throw new Error("Perodo invlido");const a=(e instanceof Date?e:new Date(e)).toISOString(),i=(t instanceof Date?t:new Date(t)).toISOString(),{data:s,error:l}=await Ki(v=>{let g=ve.from("comanda_itens").select("produto_id, quantidade, created_at").gte("created_at",a).lte("created_at",i).limit(n).abortSignal(v);return r&&(g=g.eq("codigo_empresa",r)),g},2e4,"Timeout getSoldProductsByPeriod (20s)");if(l)throw l;const c=new Map;for(const v of s||[]){const g=v.produto_id,y=Number(v.quantidade||0);c.set(g,(c.get(g)||0)+y)}const d=Array.from(c.entries()).sort((v,g)=>g[1]-v[1]);if(d.length===0)return[];const u=d.map(([v])=>v),{data:f,error:m}=await Ki(v=>{let g=ve.from("produtos").select("id, nome").in("id",u).abortSignal(v);return r&&(g=g.eq("codigo_empresa",r)),g},15e3,"Timeout getSoldProductsByPeriod:produtos (15s)");if(m)throw m;const h=new Map((f||[]).map(v=>[v.id,v.nome]));return d.map(([v,g])=>({id:v,name:h.get(v)||String(v),total:g}))}async function Gv({productId:e,delta:t,codigoEmpresa:r}){const n=Number(t);if(!e||!Number.isFinite(n)||n===0)throw new Error("Parmetros invlidos para ajuste de estoque");const{data:a,error:i}=await Ki(d=>{let u=ve.from("produtos").select("id, estoque, estoque_atual").eq("id",e).single().abortSignal(d);return r&&(u=u.eq("codigo_empresa",r)),u},1e4,"Timeout get current stock (10s)");if(i)throw i;const l=Number(a?.estoque??a?.estoque_atual??0)+n,{error:c}=await Ki(d=>{let u=ve.from("produtos").update({estoque:l,estoque_atual:l}).eq("id",e).abortSignal(d);return r&&(u=u.eq("codigo_empresa",r)),u},1e4,"Timeout update stock (10s)");if(c)throw c;return{id:e,stock:l}}async function Xnt({limit:e=5,codigoEmpresa:t}={}){const r=new Date;r.setHours(0,0,0,0);const n=r.toISOString(),{data:a,error:i}=await Ki(m=>{let h=ve.from("comanda_itens").select("produto_id, quantidade, created_at").gte("created_at",n).abortSignal(m);return t&&(h=h.eq("codigo_empresa",t)),h},15e3,"Timeout getMostSoldProductsToday (15s)");if(i)throw i;const s=new Map;for(const m of a||[]){const h=m.produto_id,v=Number(m.quantidade||0);s.set(h,(s.get(h)||0)+v)}const l=Array.from(s.entries()).sort((m,h)=>h[1]-m[1]).slice(0,e);if(l.length===0)return[];const c=l.map(([m])=>m),{data:d,error:u}=await Ki(m=>{let h=ve.from("produtos").select("id, nome").in("id",c).abortSignal(m);return t&&(h=h.eq("codigo_empresa",t)),h},15e3,"Timeout getMostSoldProductsToday:produtos (15s)");if(u)throw u;const f=new Map((d||[]).map(m=>[m.id,m.nome]));return l.map(([m,h])=>({id:m,name:f.get(m)||String(m),total:h}))}function qae(e){return{codigo_produto:e.code||null,nome:e.name,categoria:e.category||null,tipo_produto:e.type==="Uso Interno"?"uso_interno":"venda",valor_custo:e.cost!=null?Number(e.cost):0,valor_venda:e.price!=null?Number(e.price):0,estoque:e.stock!=null?Number(e.stock):0,estoque_minimo:e.minStock!=null?Number(e.minStock):0,status:e.status||null,validade:e.validade?new Date(e.validade).toISOString().slice(0,10):null,codigo_barras:e.barcode||null,codigo_barras_caixa:e.barcodeBox||null,referencia:e.reference||null,marca:e.brand||null,grupo:e.group||null,unidade:e.unit||null,estoque_inicial:e.initialStock!=null?Number(e.initialStock):null,estoque_atual:e.currentStock!=null?Number(e.currentStock):null,peso:e.weight!=null?Number(e.weight):null,preco_compra:e.buyPrice!=null?Number(e.buyPrice):null,custos_percent:e.costsPercent!=null?Number(e.costsPercent):null,preco_custo:e.costPrice!=null?Number(e.costPrice):null,lucro_percent:e.marginPercent!=null?Number(e.marginPercent):null,preco_venda:e.salePrice!=null?Number(e.salePrice):null,qtd_atacado:e.wholesaleQty!=null?Number(e.wholesaleQty):null,preco_atacado:e.wholesalePrice!=null?Number(e.wholesalePrice):null,comissao_percent:e.commissionPercent!=null?Number(e.commissionPercent):null,desconto_percent:e.discountPercent!=null?Number(e.discountPercent):null,cfop_interno:e.cfopInterno||null,cst_icms_interno:e.cstIcmsInterno||null,csosn_interno:e.csosnInterno||null,aliquota_icms_interno:e.aliqIcmsInterno!=null?Number(e.aliqIcmsInterno):null,cfop_externo:e.cfopExterno||null,cst_icms_externo:e.cstIcmsExterno||null,csosn_externo:e.csosnExterno||null,aliquota_icms_externo:e.aliqIcmsExterno!=null?Number(e.aliqIcmsExterno):null,cst_pis_entrada:e.cstPisEntrada||null,cst_pis_saida:e.cstPisSaida||null,aliquota_pis_percent:e.aliqPisPercent!=null?Number(e.aliqPisPercent):null,aliquota_cofins_percent:e.aliqCofinsPercent!=null?Number(e.aliqCofinsPercent):null,cst_ipi:e.cstIpi||null,aliquota_ipi_percent:e.aliqIpiPercent!=null?Number(e.aliqIpiPercent):null,fcp_percent:e.fcpPercent!=null?Number(e.fcpPercent):null,mva_percent:e.mvaPercent!=null?Number(e.mvaPercent):null,base_reduzida_percent:e.baseReduzidaPercent!=null?Number(e.baseReduzidaPercent):null,ncm:e.ncm||null,descricao_ncm:e.ncmDescription||null,cest:e.cest||null,ativo:e.active!=null?!!e.active:!0,permite_venda:e.allowSale!=null?!!e.allowSale:!0,paga_comissao:e.payCommission!=null?!!e.payCommission:!1,preco_variavel:e.variablePrice!=null?!!e.variablePrice:!1,composicao:e.composition!=null?!!e.composition:!1,servico:e.service!=null?!!e.service:!1,grade:e.hasGrid!=null?!!e.hasGrid:!1,usar_tabela_preco:e.usePriceTable!=null?!!e.usePriceTable:!1,combustivel:e.fuel!=null?!!e.fuel:!1,usa_imei:e.useImei!=null?!!e.useImei:!1,controle_estoque_por_grade:e.stockByGrid!=null?!!e.stockByGrid:!1,mostrar_no_app:e.showInApp!=null?!!e.showInApp:!1,importado_via_xml:e.importedViaXML===!0,data_importacao:e.dataImportacao?e.dataImportacao instanceof Date?e.dataImportacao.toISOString():new Date(e.dataImportacao).toISOString():null,xml_chave:e.xmlChave||null,xml_numero:e.xmlNumero||null,xml_serie:e.xmlSerie||null,xml_emissao:e.xmlEmissao?new Date(e.xmlEmissao).toISOString():null}}async function qu(e={}){const{includeInactive:t=!1,search:r="",codigoEmpresa:n}=e;console.log("[products.api] ====== listProducts INICIO ======"),console.log("[products.api] Parametros:",{includeInactive:t,search:r,codigoEmpresa:n});const{data:a,error:i}=await Ki(c=>{let d=ve.from("produtos").select("*").eq("codigo_empresa",n).order("nome",{ascending:!0}).abortSignal(c);if(t||(d=d.neq("status","inactive"),d=d.or("ativo.is.null,ativo.eq.true"),console.log("[products.api] Filtro aplicado: status != inactive AND (ativo IS NULL OR ativo = true)")),r&&r.trim().length>0){const u=r.trim();d=d.or(`nome.ilike.%${u}%,codigo_produto.ilike.%${u}%`)}return d},15e3,"Timeout listProducts (15s)");if(i)throw console.error("[products.api] listProducts:error",i),i;const s=(a||[]).map(S5);console.log("[products.api] listProducts RETORNOU:",s.length,"produtos"),console.log("[products.api] includeInactive:",t),console.log("[products.api] Produtos:",s.map(c=>({id:c.id,name:c.name,code:c.code})));const l=s.filter(c=>!c.code||c.code.trim()==="");return console.log("[products.api] Produtos SEM cdigo:",l.length),l.length>0&&l.forEach(c=>{console.log("  -",c.name,"| active:",c.active,"| status:",c.status,"| code:",c.code||"NULL")}),s}async function Jnt(e={}){const{includeInactive:t=!1,search:r="",codigoEmpresa:n,page:a=1,pageSize:i=100}=e;if(!n)return{data:[],count:0};const s=a>0?a:1,l=i>0?i:100,c=(s-1)*l,d=c+l-1;console.log("[products.api] ====== listProductsPaged INICIO ======",{includeInactive:t,search:r,codigoEmpresa:n,page:s,pageSize:l});try{const{data:u,error:f,count:m}=await Ki(v=>{let g=ve.from("produtos").select("*",{count:"exact"}).eq("codigo_empresa",n).order("nome",{ascending:!0}).range(c,d).abortSignal(v);if(t||(g=g.neq("status","inactive"),g=g.or("ativo.is.null,ativo.eq.true")),r&&r.trim().length>0){const y=r.trim();g=g.or(`nome.ilike.%${y}%,codigo_produto.ilike.%${y}%`)}return g},2e4,"Timeout listProductsPaged (20s)");if(f)throw console.error("[products.api] listProductsPaged:error",f),f;const h=(u||[]).map(S5);return console.log("[products.api] listProductsPaged RETORNOU:",h.length,"produtos de",m||0),{data:h,count:m||0}}catch(u){return console.error("[products.api] listProductsPaged:exception",u),{data:[],count:0}}}async function J_(e,t={}){const{codigoEmpresa:r}=t,n=qae(e);r&&(n.codigo_empresa=r),console.info("[products.api] createProduct: payload",n);const a=async()=>Ki(d=>ve.from("produtos").insert(n).select("*").single().abortSignal(d),15e3,"Timeout createProduct (15s)"),i=d=>{if(!d)return!1;if(d.code&&String(d.code)==="23505")return!0;const u=[d.message,d.details,d.hint].filter(Boolean).join(" ").toLowerCase();return u.includes("duplicate key")||u.includes("unique constraint")||u.includes("ux_produtos_empresa_codigo_produto")||u.includes("codigo_produto")};let s,l;if({data:s,error:l}=await a(),l&&i(l)&&n.codigo_produto){console.warn("[products.api] createProduct: duplicate code, trying to free code from inactive product");const{data:d,error:u}=await Ki(m=>ve.from("produtos").select("id,status").eq("codigo_produto",n.codigo_produto).eq("status","inactive").limit(1).abortSignal(m),15e3,"Timeout find duplicate product (15s)"),f=Array.isArray(d)&&d.length>0?d[0]:null;if(!u&&f&&f.status==="inactive"){const{error:m}=await Ki(h=>ve.from("produtos").update({codigo_produto:null}).eq("id",f.id).abortSignal(h),15e3,"Timeout clear duplicate code (15s)");m||({data:s,error:l}=await a())}else{const m=n.codigo_produto;n.codigo_produto=null,console.warn("[products.api] createProduct: no inactive found for duplicate code, retrying with codigo_produto = null (original:",m,")"),{data:s,error:l}=await a()}}if(l)throw console.error("[products.api] createProduct:error",l),l;const c=S5(s);return console.info("[products.api] createProduct: ok",c),c}async function C5(e,t,r={}){const n=qae(t);n.data_importacao=null,console.info("[products.api] updateProduct: id",e,"payload",n);const{data:a,error:i}=await Ki(l=>ve.from("produtos").update(n).eq("id",e).select("*").single().abortSignal(l),15e3,"Timeout updateProduct (15s)");if(i)throw console.error("[products.api] updateProduct:error",i),i;const s=S5(a);return console.info("[products.api] updateProduct: ok",s),s}async function Ki(e,t,r){const n=new AbortController,a=setTimeout(()=>n.abort(new Error(r)),t);try{return await e(n.signal)}catch(i){throw i?.name==="AbortError"?new Error(r):i}finally{clearTimeout(a)}}async function tR(e){console.info("[products.api] deleteProduct (soft): id",e);const{error:t}=await Ki(r=>ve.from("produtos").update({status:"inactive",codigo_produto:null}).eq("id",e).abortSignal(r),15e3,"Timeout deleteProduct (15s)");if(t)throw console.error("[products.api] deleteProduct:error",t),t;return console.info("[products.api] deleteProduct: ok (inativado)"),!0}async function Qnt({ids:e,status:t}){const r=Array.isArray(e)?e.filter(Boolean):[];if(!r.length)throw new Error("Nenhum produto selecionado para atualizao em massa");if(!["active","inactive","low_stock"].includes(t))throw new Error("Status invlido para atualizao em massa");const n=t!=="inactive";console.info("[products.api] bulkUpdateProductStatus:start",{count:r.length,status:t});const{error:a}=await Ki(i=>ve.from("produtos").update({status:t,ativo:n}).in("id",r).abortSignal(i),2e4,"Timeout bulkUpdateProductStatus (20s)");if(a)throw console.error("[products.api] bulkUpdateProductStatus:error",a),a;return console.info("[products.api] bulkUpdateProductStatus:ok",{count:r.length,status:t}),!0}async function Znt({ids:e}){const t=Array.isArray(e)?e.filter(Boolean):[];if(!t.length)throw new Error("Nenhum produto selecionado para limpar flag de novo");console.info("[products.api] bulkClearNewFlag:start",{count:t.length});const{error:r}=await Ki(n=>ve.from("produtos").update({data_importacao:null}).in("id",t).abortSignal(n),2e4,"Timeout bulkClearNewFlag (20s)");if(r)throw console.error("[products.api] bulkClearNewFlag:error",r),r;return console.info("[products.api] bulkClearNewFlag:ok",{count:t.length}),!0}async function rU(){console.info("[products.api] listCategories: start");const{data:e,error:t}=await Ki(n=>ve.from("produto_categorias").select("nome").eq("ativa",!0).order("nome",{ascending:!0}).abortSignal(n),15e3,"Timeout listCategories (15s)");if(t)throw console.error("[products.api] listCategories:error",t),t;const r=(e||[]).map(n=>n.nome).filter(Boolean);return console.info("[products.api] listCategories: ok",{count:r.length}),r}async function eat(e){const t=String(e||"").trim();if(!t)throw new Error("Nome da categoria invlido");console.info("[products.api] createCategory:",t);const{data:r,error:n}=await Ki(a=>ve.from("produto_categorias").insert({nome:t}).select("nome").single().abortSignal(a),15e3,"Timeout createCategory (15s)");if(n)throw console.error("[products.api] createCategory:error",n),n;return r?.nome||t}async function tat(e){const t=String(e||"").trim();if(!t)throw new Error("Nome da categoria invlido");console.info("[products.api] removeCategory:",t);const{count:r,error:n}=await Ki(l=>ve.from("produtos").select("id",{count:"exact",head:!0}).eq("categoria",t).neq("status","inactive").abortSignal(l),15e3,"Timeout removeCategory:count (15s)");if(n)throw console.error("[products.api] removeCategory:count:error",n),n;if((r??0)>0){const l=new Error("Categoria possui produtos ativos vinculados");throw console.warn("[products.api] removeCategory: blocked by active products",{nome:t,prodCount:r}),l}const{data:a,error:i}=await Ki(l=>ve.from("produto_categorias").update({ativa:!1}).eq("nome",t).select("nome").abortSignal(l),15e3,"Timeout removeCategory (15s)");if(i)throw console.error("[products.api] removeCategory:error",i),i;if((Array.isArray(a)?a.length:0)===0){const l=new Error("Categoria no encontrada para desativar");throw console.warn("[products.api] removeCategory: no rows affected",{nome:t}),l}return!0}function rat({item:e,onApply:t,onClose:r,codigoEmpresa:n}){const{toast:a}=oo(),[i,s]=p.useState(e?.desconto_tipo||"percentual"),[l,c]=p.useState(e?.desconto_valor||0),[d,u]=p.useState(e?.desconto_motivo||""),[f,m]=p.useState(!1);if(!e)return null;const h=Number(e.price||e.preco_unitario||0),v=Number(e.quantity||e.quantidade||1),g=h*v,y=i==="percentual"?g*(1-l/100):g-l,x=async()=>{try{if(m(!0),l<0){a({title:"Erro",description:"Desconto no pode ser negativo",variant:"destructive"});return}if(i==="percentual"&&l>100){a({title:"Erro",description:"Desconto percentual no pode ser maior que 100%",variant:"destructive"});return}console.log("Aplicando desconto:",{itemId:e.id,desconto_tipo:i,desconto_valor:Number(l),desconto_motivo:d||null,codigoEmpresa:n});const w=await iGe({itemId:e.id,desconto_tipo:i,desconto_valor:Number(l),desconto_motivo:d||null,codigoEmpresa:n});console.log("Resultado:",w),a({title:"Sucesso",description:"Desconto aplicado!",variant:"success"}),t(),r()}catch(w){console.error("Erro ao aplicar desconto:",w),a({title:"Erro",description:w.message||"Falha ao aplicar desconto",variant:"destructive"})}finally{m(!1)}},b=async()=>{try{m(!0),await lGe({itemId:e.id,codigoEmpresa:n}),a({title:"Sucesso",description:"Desconto removido!",variant:"success"}),t(),r()}catch(w){console.error("Erro ao remover desconto:",w),a({title:"Erro",description:w.message||"Falha ao remover desconto",variant:"destructive"})}finally{m(!1)}};return o.jsx(ln,{open:!0,onOpenChange:r,children:o.jsxs(on,{overlayClassName:"z-[90]",className:"sm:max-w-[420px] w-[92vw] max-h-[85vh] flex flex-col animate-none z-[91]",children:[o.jsx(nn,{children:o.jsxs(rn,{className:"text-lg font-bold",children:["Desconto - ",e.name]})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(Wt,{className:"text-sm font-semibold mb-2 block",children:"Tipo de Desconto"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(oe,{variant:i==="percentual"?"default":"outline",onClick:()=>s("percentual"),disabled:f,className:"flex-1",children:"Percentual (%)"}),o.jsx(oe,{variant:i==="fixo"?"default":"outline",onClick:()=>s("fixo"),disabled:f,className:"flex-1",children:"Fixo (R$)"})]})]}),o.jsxs("div",{children:[o.jsxs(Wt,{htmlFor:"desconto-valor",className:"text-sm font-semibold",children:["Valor ",i==="percentual"?"(%)":"(R$)"]}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx(or,{id:"desconto-valor",type:"text",value:i==="percentual"?l===0?"":l:l===0?"":`R$ ${l.toFixed(2)}`,onChange:w=>{let j=w.target.value.trim();if(j===""){c(0);return}i==="fixo"&&(j=j.replace(/[^\d.,]/g,"").replace(",","."));let _=Number(j);isNaN(_)&&(_=0),i==="percentual"&&_>100&&(_=100),_<0&&(_=0),c(_)},placeholder:i==="percentual"?"0":"0,00",disabled:f,className:"mt-1"}),i==="percentual"&&o.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-text-secondary font-semibold",children:"%"})]})]}),o.jsxs("div",{children:[o.jsx(Wt,{htmlFor:"desconto-motivo",className:"text-sm font-semibold",children:"Motivo"}),o.jsxs("select",{id:"desconto-motivo",value:d,onChange:w=>u(w.target.value),className:"w-full border border-border rounded-md p-2 mt-1 text-sm bg-background",disabled:f,children:[o.jsx("option",{value:"",children:"Selecione um motivo..."}),o.jsx("option",{value:"Promoo",children:"Promoo"}),o.jsx("option",{value:"Meia entrada",children:"Meia entrada"}),o.jsx("option",{value:"Cortesia",children:"Cortesia"}),o.jsx("option",{value:"Ajuste",children:"Ajuste"}),o.jsx("option",{value:"Outro",children:"Outro"})]})]}),o.jsxs("div",{className:"bg-surface-2 p-4 rounded-lg space-y-2 border border-border",children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{className:"text-text-secondary",children:"Preo Original:"}),o.jsxs("span",{className:"font-semibold",children:["R$ ",g.toFixed(2)]})]}),o.jsxs("div",{className:"flex justify-between text-sm text-destructive font-semibold",children:[o.jsx("span",{children:"Desconto:"}),o.jsxs("span",{children:["-R$ ",(g-y).toFixed(2)]})]}),o.jsxs("div",{className:"flex justify-between text-base font-bold border-t border-border pt-2",children:[o.jsx("span",{children:"Total do Item:"}),o.jsxs("span",{className:"text-brand",children:["R$ ",Math.max(0,y).toFixed(2)]})]})]}),d&&o.jsxs("div",{className:"text-xs text-text-secondary bg-surface p-2 rounded",children:[o.jsx("strong",{children:"Motivo:"})," ",d]})]}),o.jsxs(Un,{className:"flex gap-2",children:[o.jsx(oe,{variant:"outline",onClick:r,disabled:f,children:"Cancelar"}),e.desconto_valor>0&&o.jsxs(oe,{variant:"destructive",onClick:b,disabled:f,size:"sm",className:"gap-2",children:[o.jsx(Um,{className:"w-4 h-4"}),"Remover"]}),o.jsx(oe,{onClick:x,disabled:f,className:"gap-2",children:f?"Aplicando...":"Aplicar Desconto"})]})]})})}function nat({comanda:e,subtotal:t,onApply:r,onClose:n,codigoEmpresa:a}){const{toast:i}=oo(),[s,l]=p.useState(e?.desconto_tipo||"percentual"),[c,d]=p.useState(e?.desconto_valor||0),[u,f]=p.useState(e?.desconto_motivo||""),[m,h]=p.useState(!1);if(!e)return null;const v=s==="percentual"?t*c/100:c,g=Math.max(0,t-v),y=async()=>{try{if(h(!0),c<0){i({title:"Erro",description:"Desconto no pode ser negativo",variant:"destructive"});return}if(s==="percentual"&&c>100){i({title:"Erro",description:"Desconto percentual no pode ser maior que 100%",variant:"destructive"});return}if(v>t){i({title:"Erro",description:"Desconto no pode ser maior que o subtotal",variant:"destructive"});return}console.log("Aplicando desconto comanda:",{comandaId:e.id,desconto_tipo:s,desconto_valor:Number(c),desconto_motivo:u||null,codigoEmpresa:a});const b=await sGe({comandaId:e.id,desconto_tipo:s,desconto_valor:Number(c),desconto_motivo:u||null,codigoEmpresa:a});console.log("Resultado comanda:",b),i({title:"Sucesso",description:"Desconto aplicado na comanda!",variant:"success"}),r(),n()}catch(b){console.error("Erro ao aplicar desconto:",b),i({title:"Erro",description:b.message||"Falha ao aplicar desconto",variant:"destructive"})}finally{h(!1)}},x=async()=>{try{h(!0),await cGe({comandaId:e.id,codigoEmpresa:a}),i({title:"Sucesso",description:"Desconto removido!",variant:"success"}),r(),n()}catch(b){console.error("Erro ao remover desconto:",b),i({title:"Erro",description:b.message||"Falha ao remover desconto",variant:"destructive"})}finally{h(!1)}};return o.jsx(ln,{open:!0,onOpenChange:n,children:o.jsxs(on,{className:"sm:max-w-[420px]",children:[o.jsx(nn,{children:o.jsx(rn,{className:"text-lg font-bold",children:"Desconto da Comanda"})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(Wt,{className:"text-sm font-semibold mb-2 block",children:"Tipo de Desconto"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(oe,{variant:s==="percentual"?"default":"outline",onClick:()=>l("percentual"),disabled:m,className:"flex-1",children:"Percentual (%)"}),o.jsx(oe,{variant:s==="fixo"?"default":"outline",onClick:()=>l("fixo"),disabled:m,className:"flex-1",children:"Fixo (R$)"})]})]}),o.jsxs("div",{children:[o.jsxs(Wt,{htmlFor:"desconto-valor",className:"text-sm font-semibold",children:["Valor ",s==="percentual"?"(%)":"(R$)"]}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx(or,{id:"desconto-valor",type:"text",name:"desconto-valor",autoComplete:"off",autoCorrect:"off",spellCheck:!1,value:s==="percentual"?c===0?"":c:c===0?"":`R$ ${c.toFixed(2)}`,onChange:b=>{let w=b.target.value.trim();if(w===""){d(0);return}s==="fixo"&&(w=w.replace(/[^\d.,]/g,"").replace(",","."));let j=Number(w);isNaN(j)&&(j=0),s==="percentual"&&j>100&&(j=100),j<0&&(j=0),d(j)},placeholder:s==="percentual"?"0":"0,00",disabled:m,className:"mt-1"}),s==="percentual"&&o.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-text-secondary font-semibold",children:"%"})]})]}),o.jsxs("div",{children:[o.jsx(Wt,{htmlFor:"desconto-motivo",className:"text-sm font-semibold",children:"Motivo"}),o.jsxs("select",{id:"desconto-motivo",value:u,onChange:b=>f(b.target.value),className:"w-full border border-border rounded-md p-2 mt-1 text-sm bg-background",disabled:m,children:[o.jsx("option",{value:"",children:"Selecione um motivo..."}),o.jsx("option",{value:"Promoo",children:"Promoo"}),o.jsx("option",{value:"Cortesia",children:"Cortesia"}),o.jsx("option",{value:"Ajuste",children:"Ajuste"}),o.jsx("option",{value:"Outro",children:"Outro"})]})]}),o.jsxs("div",{className:"bg-surface-2 p-4 rounded-lg space-y-2 border border-border",children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{className:"text-text-secondary",children:"Subtotal:"}),o.jsxs("span",{className:"font-semibold",children:["R$ ",t.toFixed(2)]})]}),o.jsxs("div",{className:"flex justify-between text-sm text-destructive font-semibold",children:[o.jsx("span",{children:"Desconto:"}),o.jsxs("span",{children:["-R$ ",v.toFixed(2)]})]}),o.jsxs("div",{className:"flex justify-between text-base font-bold border-t border-border pt-2",children:[o.jsx("span",{children:"Total da Comanda:"}),o.jsxs("span",{className:"text-brand",children:["R$ ",g.toFixed(2)]})]})]}),u&&o.jsxs("div",{className:"text-xs text-text-secondary bg-surface p-2 rounded",children:[o.jsx("strong",{children:"Motivo:"})," ",u]})]}),o.jsxs(Un,{className:"flex gap-2",children:[o.jsx(oe,{variant:"outline",onClick:n,disabled:m,children:"Cancelar"}),e.desconto_valor>0&&o.jsxs(oe,{variant:"destructive",onClick:x,disabled:m,size:"sm",className:"gap-2",children:[o.jsx(Um,{className:"w-4 h-4"}),"Remover"]}),o.jsx(oe,{onClick:y,disabled:m,className:"gap-2",children:m?"Aplicando...":"Aplicar Desconto"})]})]})})}const aat={available:{label:"Livre",color:"border-success/50 bg-success/10 text-success",icon:Ai},"in-use":{label:"Em Uso",color:"border-warning/50 bg-warning/10 text-warning",icon:Vd},"awaiting-payment":{label:"Pagamento",color:"border-info/50 bg-info/10 text-info",icon:ns}};function oat(){const{toast:e}=oo(),{userProfile:t,authReady:r}=Do(),n=Pc(),[a,i]=p.useState([]),[s,l]=p.useState(null),[c,d]=p.useState(!1),[u,f]=p.useState(0);p.useRef(!1);const[m,h]=p.useState(!1);p.useState([]);const[v,g]=p.useState(!1),[y,x]=p.useState(new Map),[b,w]=p.useState(!1);p.useRef(null),p.useRef(null);const j=p.useRef([]),_=p.useRef(null),[C,E]=p.useState(0),[P,k]=p.useState("tables");p.useRef(null);const[M,S]=p.useState("order");p.useRef(null),p.useRef(null),p.useState(!1);const[I,T]=p.useState(null),[D,B]=p.useState(null),[U,z]=p.useState(!1),[$,Y]=p.useState(!1),[de,xe]=p.useState(!1),[q,L]=p.useState(null),[W,ne]=p.useState(!1),[le,K]=p.useState([]),[Q,re]=p.useState(!1),[G,me]=p.useState(!1),[pe,Be]=p.useState(!1),[Z,ee]=p.useState(!1),[kt,Nt]=p.useState(null),[De,st]=p.useState(""),[ft,yt]=p.useState(!1),[Nr,se]=p.useState(!1),[rt,mt]=p.useState([]),[tr,Ce]=p.useState(null),[je,ae]=p.useState(null),[$e,Ae]=p.useState(!1),Tt=p.useRef(""),[Se,Ne]=p.useState(!1),[Ue,Qe]=p.useState(!1),[et,pt]=p.useState("order"),[Ke,qt]=p.useState(!1),[lt,rr]=p.useState(""),[nt,$t]=p.useState(()=>{try{return typeof window<"u"&&window.innerWidth<=640}catch{return!1}}),[Qr,Xr]=p.useState(null),[In,sn]=p.useState(!1),Qt=p.useMemo(()=>{const ue=new Map,Fe=s?.order||[];for(const ht of Fe)ue.set(ht.productId,(ue.get(ht.productId)||0)+Number(ht.quantity||0));return ue},[s?.order]),qr=async ue=>{try{const ht=(s?.order||[]).find(cr=>String(cr.productId)===String(ue.id));if(!ht)return;const At=Number(ht.quantity||0)-1;At>0?await Vc({itemId:ht.id,quantidade:At,codigoEmpresa:t?.codigo_empresa}):await Cv({itemId:ht.id,codigoEmpresa:t?.codigo_empresa});const xr=(await Ci({comandaId:s.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(cr=>({id:cr.id,productId:cr.produto_id,name:cr.descricao||"Item",price:Number(cr.preco_unitario||0),quantity:Number(cr.quantidade||1)})),er=(xr||[]).reduce((cr,It)=>cr+Number(It.price||0)*Number(It.quantity||0),0),jr={...s,order:xr,totalHint:er};l(jr),i(cr=>cr.map(It=>It.id===jr.id?jr:It));try{const cr=await Vv({codigoEmpresa:t?.codigo_empresa}),It=new Map;for(const Ir of cr||[]){const ie=Ir.produto_id,be=Number(Ir.quantidade||0);It.set(ie,(It.get(ie)||0)+be)}x(It)}catch(cr){console.error("[decProduct] Erro ao atualizar estoque reservado:",cr)}}catch(Fe){e({title:"Falha ao alterar quantidade",description:Fe?.message||"Tente novamente",variant:"destructive"})}},Tr=p.useRef(null),sr=p.useCallback(()=>{try{const ue=Tr.current;if(!ue)return 1;const ht=window.getComputedStyle(ue).gridTemplateColumns||"";if(ht){const St=ht.split(" ").filter(Boolean).length;if(St>0)return St}const At=ue.querySelector("[data-table-id]");if(At){const St=At.getBoundingClientRect().width,xr=ue.getBoundingClientRect().width;if(St>0)return Math.max(1,Math.floor(xr/St))}return 1}catch{return 1}},[]),[$r,Gr]=p.useState(!1);ls();const ke=p.useMemo(()=>(a||[]).find(ue=>ue.status==="available")?.id||null,[a]),Mt=G||Z||$||v||ft||$e||m||U||Ue||!1,wr=async ue=>{try{if(!ue)return;if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de gerenciar as mesas.",variant:"warning"});return}if(Nr)return;if(se(!0),l(Fe=>!Fe||Fe.id!==ue.id?ue:Fe),ue.status==="available"||!ue.comandaId){Nt(ue),ee(!0);return}try{await Br(ue)}catch{try{const At=(await Ci({comandaId:ue.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(er=>({id:er.id,productId:er.produto_id,name:er.descricao||"Item",price:Number(er.preco_unitario||0),quantity:Number(er.quantidade||1)}));let St=null;try{const jr=(await Zi({comandaId:ue.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(cr=>cr?.nome).filter(Boolean);St=jr.length?jr.join(", "):null}catch{}const xr={...ue,order:At,customer:St};l(xr),i(er=>er.map(jr=>jr.id===xr.id?xr:jr))}catch{}}}finally{se(!1)}};p.useEffect(()=>{const ue=()=>{try{$t(typeof window<"u"&&window.innerWidth<=640)}catch{$t(!1)}};return ue(),window.addEventListener("resize",ue),()=>window.removeEventListener("resize",ue)},[]),p.useEffect(()=>{const ue=async Fe=>{try{if(b)return;const ht=String(Fe.target?.tagName||"").toLowerCase();if(["input","textarea","select"].includes(ht)||Fe.target?.isContentEditable||Mt)return;if(Fe.key==="F1"){Fe.preventDefault();try{const St=(a||[]).filter(xr=>xr.status==="available");St.length>0?(l(St[0]),Nt?.(St[0])):!s&&Array.isArray(a)&&a.length>0&&(l(a[0]),Nt?.(a[0]))}catch{}ee(!0);return}if(Fe.key==="F2"){Fe.preventDefault(),s?.comandaId?await ut():e({title:"Nenhuma comanda selecionada",description:"Selecione uma mesa com comanda aberta antes de fechar.",variant:"warning"});return}if(Fe.key==="F10"){Fe.preventDefault(),c?e({title:"Caixa j est aberto",description:"Use F11 para ver detalhes do caixa.",variant:"info"}):Ae(!0);return}if(Fe.key==="F11"){Fe.preventDefault(),g(!0);return}if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(Fe.key)){if(P!=="tables"||!s||!Array.isArray(a)||a.length===0)return;Fe.preventDefault(),Fe.stopPropagation();let St=Math.max(0,a.findIndex(It=>It.id===s?.id));St<0&&(St=0);let xr=sr(),er=St;Fe.key==="ArrowRight"&&(er=St+1),Fe.key==="ArrowLeft"&&(er=St-1),Fe.key==="ArrowDown"&&(er=St+xr),Fe.key==="ArrowUp"&&(er=St-xr);const jr=a.length;er=(er%jr+jr)%jr;const cr=a[er];cr&&cr.id!==s?.id&&(l(cr),setTimeout(()=>{try{document.querySelector(`[data-table-id="${cr.id}"]`)?.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"})}catch{}},0));return}if(Fe.key==="Enter"){if(P!=="tables")return;Fe.preventDefault(),Fe.stopPropagation(),s&&!Nr&&await wr(s);return}if(Fe.key==="Escape"){if(Fe.preventDefault(),s&&(M==="products"||et==="products")){S("order"),pt("order");return}if(s){l(null);return}return}if(Fe.key==="p"||Fe.key==="P"){if(Fe.preventDefault(),m){setTimeout(()=>{try{_.current?.focus()}catch{}},0);return}if(s){w(!0);return}h(!0),setTimeout(()=>{try{_.current?.focus()}catch{}},50);return}}catch{}};return window.addEventListener("keydown",ue),()=>window.removeEventListener("keydown",ue)},[Mt,s?.id,a,sr,b]),p.useEffect(()=>{try{s?.id&&t?.codigo_empresa&&localStorage.setItem(`vendas:selected:${t.codigo_empresa}`,String(s.id))}catch{}},[s?.id,t?.codigo_empresa]),p.useEffect(()=>{(async()=>{try{if(!s&&t?.codigo_empresa&&Array.isArray(a)&&a.length>0){const Fe=localStorage.getItem(`vendas:selected:${t.codigo_empresa}`);if(Fe){const ht=a.find(At=>String(At.id)===String(Fe));if(ht)if(k("tables"),ht.comandaId)try{await Br(ht),k("tables")}catch(At){console.error("[Restore Selection] Erro ao carregar detalhes:",At),localStorage.removeItem(`vendas:selected:${t.codigo_empresa}`)}else localStorage.removeItem(`vendas:selected:${t.codigo_empresa}`)}}}catch(Fe){console.error("[Restore Selection] Erro:",Fe)}})()},[a,s,t?.codigo_empresa]);const Fr=p.useCallback(async()=>{try{const ue=await km({codigoEmpresa:t?.codigo_empresa});d(!!(ue&&(ue.id||ue?.length)))}catch{d(!1)}},[t?.codigo_empresa]),Ur=async()=>{const ue=t?.codigo_empresa||null;try{if(!ue)return;const[Fe,ht]=await Promise.all([g1({codigoEmpresa:ue}).catch(()=>null),km({codigoEmpresa:ue}).catch(()=>null)]);if(!ht?.id){T(null);return}let At=0,St=[];try{St=await Op({caixaSessaoId:ht.id,codigoEmpresa:ue}),At=(St||[]).filter(er=>(er?.tipo||"")==="sangria").reduce((er,jr)=>er+Number(jr?.valor||0),0)}catch{}const xr={saldo_inicial:ht.saldo_inicial||0,totalPorFinalizadora:Fe?.totalPorFinalizadora||Fe?.porFinalizadora||{},totalEntradas:Fe?.totalEntradas||Fe?.entradas||0,totalSangria:At,totalSaidas:At,sessaoId:ht.id,movimentacoes:St};ye.startTransition(()=>{T(xr)})}catch{ye.startTransition(()=>{T(null)})}finally{}},Kr=p.useRef(!1);p.useEffect(()=>{v&&!Kr.current?(Kr.current=!0,Ur().catch(()=>{})):v||(Kr.current=!1)},[v]);const dn=ue=>ue==="in_use"?"in-use":ue==="awaiting_payment"?"awaiting-payment":"available",wn=p.useRef(!0);p.useEffect(()=>(wn.current=!0,()=>{wn.current=!1}),[]);const va=p.useRef(0),xa=p.useRef(0),Aa=p.useRef(0);p.useEffect(()=>{const ue=t?.codigo_empresa||null,Fe=ue?`vendas:tables:${ue}`:null,ht=()=>{try{if(!Fe)return;const St=JSON.parse(localStorage.getItem(Fe)||"[]");Array.isArray(St)&&St.length>0&&i(St)}catch{}};ue&&ht();const At=async()=>{try{if(!r||!ue)return;const St=++Aa.current,xr=setTimeout(()=>{wn.current&&ht()},2e3),er=setTimeout(()=>{wn.current&&Aa.current===St&&ht()},1e4),[jr,cr]=await Promise.all([xp(ue),Vv({codigoEmpresa:ue}).catch(()=>[])]);if(wn.current&&Aa.current===St){const X=new Map;for(const Me of cr||[]){const gt=Me.produto_id,ir=Number(Me.quantidade||0);X.set(gt,(X.get(gt)||0)+ir)}x(X)}let It=[];try{It=await sc({codigoEmpresa:ue})}catch(X){console.error("[VendasPage:load] Erro ao carregar comandas abertas:",X)}const Ir=await(async()=>{try{return await H3((It||[]).map(X=>X.id),ue)}catch{return{}}})(),ie=await(async()=>{try{const X=await Promise.all((It||[]).map(async Me=>{try{const ir=(await Zi({comandaId:Me.id,codigoEmpresa:ue})||[]).map(Dr=>Dr?.nome).filter(Boolean);return[Me.id,ir.length?ir.join(", "):null]}catch{return[Me.id,null]}}));return Object.fromEntries(X)}catch{return{}}})(),be=new Map;(It||[]).forEach(X=>be.set(X.mesa_id,X));const We=(jr||[]).map(X=>{const Me=be.get(X.id);let gt=dn(X.status),ir=null,Dr=null,O=0,F=null;return Me&&(gt=Me.status==="awaiting-payment"||Me.status==="awaiting_payment"?"awaiting-payment":"in-use",ir=Me.id,Dr=ie[Me.id]||null,O=Ir[Me.id]||0,F=Me.aberto_em||null),{id:X.id,number:X.numero,name:X.nome||null,status:gt,order:[],customer:Dr,comandaId:ir,totalHint:O,aberto_em:F}}).map(X=>s&&X.id===s.id?{...X,order:s.order||[],customer:s.customer||X.customer}:X);if(!wn.current||Aa.current!==St){clearTimeout(xr),clearTimeout(er);return}if(i(We),(We||[]).length===0)try{Fe&&localStorage.removeItem(Fe)}catch{}else try{Fe&&localStorage.setItem(Fe,JSON.stringify(We))}catch{}const _t=ue?`vendas:selected:${ue}`:null;if(_t)try{const X=localStorage.getItem(_t);if(X){const Me=We.find(gt=>String(gt.id)===String(X));Me&&!Me.comandaId&&localStorage.removeItem(_t)}}catch{}xa.current=Array.isArray(We)?We.length:0,va.current=Date.now();let qe=null;try{const X=ue?`vendas:selected:${ue}`:null,Me=X?localStorage.getItem(X):null;if(Me){const gt=We.find(ir=>String(ir.id)===String(Me));gt&&(qe=gt)}}catch{}qe?ft||l(X=>!X||X.id!==qe.id?qe:{...qe,order:X.order||qe.order||[],customer:X.customer||qe.customer||null,observacoes:X.observacoes??qe.observacoes??null,desconto_tipo:X.desconto_tipo??qe.desconto_tipo??null,desconto_valor:X.desconto_valor??qe.desconto_valor??0,desconto_motivo:X.desconto_motivo??qe.desconto_motivo??null}):ft||l(X=>{const Me=X?We.find(ir=>ir.id===X.id):null;return Me?{...Me,order:X.order||Me.order||[],customer:X.customer||Me.customer||null,observacoes:X.observacoes??Me.observacoes??null,desconto_tipo:X.desconto_tipo??Me.desconto_tipo??null,desconto_valor:X.desconto_valor??Me.desconto_valor??0,desconto_motivo:X.desconto_motivo??Me.desconto_motivo??null}:We[0]||null});try{const X=await qu({includeInactive:!1,codigoEmpresa:ue});K(X||[])}catch(X){console.warn("Falha ao carregar produtos:",X?.message||X)}clearTimeout(xr),clearTimeout(er)}catch(St){console.error("Erro ao carregar mesas:",St)}};return ht(),r&&ue&&At(),()=>{}},[r,t?.codigo_empresa,Mt]),p.useEffect(()=>{!r||!t?.codigo_empresa||Fr()},[r,t?.codigo_empresa,Fr]),p.useEffect(()=>{let ue=!0;return(async()=>{try{if(!t?.codigo_empresa){ue&&f(0);return}const Fe=await sc({codigoEmpresa:t?.codigo_empresa});if(!ue)return;f(Array.isArray(Fe)?Fe.length:0)}catch{ue&&f(0)}})(),()=>{ue=!1}},[t?.codigo_empresa,a.length]),p.useEffect(()=>{const ue=t?.codigo_empresa||null,Fe=ue?`vendas:selected:${ue}`:null;try{Fe&&s?.id&&localStorage.setItem(Fe,String(s.id))}catch{}s?.comandaId&&(!s.order||s.order.length===0)&&Br(s)},[s?.id,s?.comandaId]),p.useEffect(()=>()=>{},[s?.comandaId,Mt,de]);const ut=async()=>{try{if(!s?.comandaId){e({title:"Selecione uma mesa com comanda aberta",variant:"warning"});return}await uf({codigoEmpresa:t?.codigo_empresa});try{const At=(await Ci({comandaId:s.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(xr=>({id:xr.id,productId:xr.produto_id,name:xr.descricao||"Item",price:Number(xr.preco_unitario||0),quantity:Number(xr.quantidade||1),desconto_tipo:xr.desconto_tipo||null,desconto_valor:Number(xr.desconto_valor||0),desconto_motivo:xr.desconto_motivo||null})),St={...s,order:At};l(St),i(xr=>xr.map(er=>er.id===St.id?St:er))}catch{}const ue=await Uv({somenteAtivas:!0,codigoEmpresa:t?.codigo_empresa});mt(ue||[]);const Fe=ue&&ue[0]&&ue[0].id?ue[0].id:null;Ce(Fe),ae(Fe),yt(!0)}catch(ue){e({title:"Falha ao carregar finalizadoras",description:ue?.message||"Tente novamente",variant:"destructive"})}},Ht=ue=>{if(!ue.destination)return;const Fe=Array.from(a),[ht]=Fe.splice(ue.source.index,1);Fe.splice(ue.destination.index,0,ht),i(Fe),e({title:"Layout das mesas atualizado!",description:"As posies foram salvas temporariamente.",variant:"success"})},dr=(ue,Fe)=>{let ht=0;for(const St of ue||[]){let xr=(St.price||0)*(St.quantity||1);St.desconto_tipo==="percentual"&&St.desconto_valor>0?xr*=1-St.desconto_valor/100:St.desconto_tipo==="fixo"&&St.desconto_valor>0&&(xr-=St.desconto_valor),ht+=Math.max(0,xr)}let At=ht;return Fe?.desconto_tipo==="percentual"&&Fe?.desconto_valor>0?At*=1-Fe.desconto_valor/100:Fe?.desconto_tipo==="fixo"&&Fe?.desconto_valor>0&&(At-=Fe.desconto_valor),Math.max(0,At)},Ft=ue=>{if(!ue)return"";const Fe=ue.trim().split(/\s+/);return Fe.length<=2?ue:Fe.slice(0,2).join(" ")},Ot=ue=>{if(!ue)return"";const Fe=At=>String(At).replace(/^\s*[\[]+\s*/g,"").replace(/\s*[\]]+\s*$/g,"").trim(),ht=ue.split(",").map(At=>Fe(At)).filter(Boolean);return ht.length===0?"":ht.length===1?Ft(ht[0]):`${Ft(ht[0])} +${ht.length-1}`},Br=async ue=>{try{if(!ue?.comandaId)return;const ht=(await Ci({comandaId:ue.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(er=>({id:er.id,productId:er.produto_id,name:er.descricao||"Item",price:Number(er.preco_unitario||0),quantity:Number(er.quantidade||1),desconto_tipo:er.desconto_tipo||null,desconto_valor:Number(er.desconto_valor||0),desconto_motivo:er.desconto_motivo||null}));let At=ue.customer||null;try{const jr=(await Zi({comandaId:ue.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(cr=>cr?.nome).filter(Boolean);At=jr.length?jr.join(", "):null}catch{}let St=ue;try{const jr=(await sc({codigoEmpresa:t?.codigo_empresa}))?.find(cr=>cr.id===ue.comandaId);jr&&(St={...ue,desconto_tipo:jr.desconto_tipo||null,desconto_valor:Number(jr.desconto_valor||0),desconto_motivo:jr.desconto_motivo||null,observacoes:jr.observacoes||null})}catch{}const xr={...St,status:ue.status==="awaiting-payment"?"awaiting-payment":"in-use",order:ht,customer:At};l(xr),i(er=>er.map(jr=>jr.id===xr.id?xr:jr))}catch(Fe){console.warn("[VendasPage] Falha ao recarregar detalhes da mesa selecionada:",Fe)}},Vt=async({showToast:ue=!1}={})=>{try{const Fe=t?.codigo_empresa;if(!Fe)return;const ht=await xp(Fe);let At=[];try{At=await sc({codigoEmpresa:Fe})}catch(It){console.error("[refreshTablesLight] Erro ao carregar comandas:",It)}const St=new Map((At||[]).map(It=>[It.mesa_id,It])),xr={},er={};try{const It=(At||[]).map(be=>be.id);(await Promise.all(It.map(async be=>{try{return{id:be,vinculos:await Zi({comandaId:be,codigoEmpresa:Fe})}}catch{return{id:be,vinculos:[]}}}))).forEach(({id:be,vinculos:Ge})=>{const We=(Ge||[]).map(_t=>_t?.nome).filter(Boolean);xr[be]=We.length?We.join(", "):null}),(await Promise.all(It.map(async be=>{try{const We=(await Ci({comandaId:be,codigoEmpresa:Fe})||[]).reduce((_t,qe)=>{const X=(qe.quantidade||0)*(qe.preco_unitario||0)-(qe.desconto||0);return _t+X},0);return{comandaId:be,total:We}}catch(Ge){return console.error(`[refreshTablesLight] Erro ao buscar itens da comanda ${be}:`,Ge),{comandaId:be,total:0}}}))).forEach(({comandaId:be,total:Ge})=>{er[be]=Ge})}catch(It){console.error("[refreshTablesLight] Erro ao carregar clientes/totais:",It)}const cr=(ht||[]).map(It=>{const Ir=St.get(It.id);let ie=dn(It.status),be=null,Ge=null,We=0;return Ir&&(ie=Ir.status==="awaiting-payment"||Ir.status==="awaiting_payment"?"awaiting-payment":"in-use",be=Ir.id,Ge=xr[Ir.id]||null,We=er[Ir.id]||0),{id:It.id,number:It.numero,name:It.nome||null,status:ie,order:[],customer:Ge,comandaId:be,totalHint:We}}).map(It=>s&&It.id===s.id?It.comandaId?{...It,order:s.order||[],customer:s.customer||It.customer}:{...It,order:[],customer:null}:It);if(i(cr),s){const It=cr.find(Ir=>Ir.id===s.id);It&&!It.comandaId&&l({...It,order:[],customer:null})}}catch(Fe){console.error("[refreshTablesLight] Erro fatal:",Fe),ue&&e({title:"Erro ao atualizar mesas",description:"Recarregue a pgina se o problema persistir",variant:"destructive"})}},Cr=({table:ue,provided:Fe,isDragging:ht})=>{const At=aat[ue.status],St=At.icon,xr=Array.isArray(ue.order)?ue.order:[],er=xr.filter(be=>String(be.id||"").startsWith("tmp-")).reduce((be,Ge)=>be+Number(Ge.quantity||0)*Number(Ge.price||0),0),jr=xr.filter(be=>!String(be.id||"").startsWith("tmp-")).reduce((be,Ge)=>be+Number(Ge.quantity||0)*Number(Ge.price||0),0),cr=Number(ue.totalHint||0);Ot(ue.customer);const It=ue.status==="available"&&ue.id===ke,Ir=ue.status==="in-use"||ue.status==="awaiting-payment"?(cr>0?cr:jr)+er:0,ie=ue.status==="available"?"text-success bg-success/10 border-success/30":ue.status==="in-use"?"text-warning bg-warning/10 border-warning/30":"text-info bg-info/10 border-info/30";return o.jsxs("div",{ref:Fe?.innerRef,"data-table-id":ue.id,...Fe?.draggableProps||{},className:Yt("p-4 rounded-lg border bg-surface flex flex-col relative h-44 shadow-sm min-w-[240px]",ht&&"shadow-lg",P==="tables"&&s?.id===ue.id&&"ring-2 ring-brand/60 bg-surface-2",c?"cursor-pointer":"cursor-not-allowed opacity-60"),onClick:()=>{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de gerenciar as mesas.",variant:"warning"});return}wr(ue)},children:[o.jsx("div",{...Fe?.dragHandleProps||{},className:"absolute top-2 right-2 text-text-muted opacity-60 hover:opacity-100",children:o.jsx(Vde,{size:14})}),o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx(St,{className:"w-5 h-5 text-text-secondary"}),o.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[o.jsx("span",{className:"text-lg font-semibold text-text-primary truncate",children:ue.name?ue.name:`Mesa ${ue.number}`}),It&&o.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"F1"})]}),o.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[(ue.status==="in-use"||ue.status==="awaiting-payment")&&ue.aberto_em&&o.jsxs("div",{className:"flex items-center gap-0.5 text-xs text-text-secondary",children:[o.jsx(Vd,{className:"w-3.5 h-3.5 text-text-muted"}),o.jsx("span",{className:"font-medium",children:(()=>{try{const be=new Date(ue.aberto_em),We=new Date-be,_t=Math.floor(We/6e4),qe=Math.floor(_t/60),X=_t%60;return _t<1?"agora":qe===0?`${X}m`:qe>0&&X===0?`${qe}h`:`${qe}h${X}m`}catch{return""}})()})]}),o.jsx("span",{className:Yt("text-[11px] font-medium px-2 py-0.5 rounded-full border flex-shrink-0",ie),children:At.label})]})]}),o.jsx("div",{className:Yt("flex-1 flex items-center justify-center"),children:ue.status==="available"?o.jsx("img",{src:"/mesalivre.png",alt:"Mesa livre",className:Yt("w-16 h-16 object-contain opacity-80",s?.id===ue.id&&"opacity-100")}):ue.status==="in-use"?o.jsx("img",{src:"/mesaocupada.png",alt:"Mesa ocupada",className:Yt("w-16 h-16 object-contain opacity-80",s?.id===ue.id&&"opacity-100")}):o.jsx("div",{className:Yt("w-16 h-16 rounded-lg bg-info/20 border-2 border-info/40 flex items-center justify-center",s?.id===ue.id&&"bg-info/30 border-info/60"),children:o.jsx(ns,{className:"w-8 h-8 text-info"})})}),o.jsx("div",{className:"w-full mt-auto",children:ue.status==="in-use"||ue.status==="awaiting-payment"?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[o.jsx(cl,{className:"w-3 h-3 text-text-muted flex-shrink-0"}),o.jsx("div",{className:"text-sm sm:text-base font-medium text-text-primary truncate",title:ue.customer||"",children:Ot(ue.customer)||""})]}),o.jsxs("div",{className:"flex items-center gap-1 justify-between",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(Ui,{className:"w-3 h-3 text-text-muted flex-shrink-0"}),o.jsxs("div",{className:"text-sm font-bold text-text-secondary",children:["R$ ",Ir.toFixed(2)]})]}),o.jsx("button",{onClick:be=>{be.stopPropagation(),n(`/historico?mesa=${ue.id}`)},className:"p-1 hover:bg-surface-2 rounded transition-colors",title:"Ver histrico desta mesa",children:o.jsx(ns,{className:"w-4 h-4 text-text-secondary hover:text-text-primary"})})]})]}):o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("div",{className:"text-xs text-text-muted",children:"Sem comanda"}),o.jsx("button",{onClick:be=>{be.stopPropagation(),n(`/historico?mesa=${ue.id}`)},className:"p-1 hover:bg-surface-2 rounded transition-colors",title:"Ver histrico desta mesa",children:o.jsx(ns,{className:"w-4 h-4 text-text-secondary hover:text-text-primary"})})]})})]})},ct=()=>{const ue=s?dr(s.order,s):0,[Fe,ht]=p.useState(!1),[At,St]=p.useState([]),[xr,er]=p.useState(1),[jr,cr]=p.useState([]),It=p.useRef(new Map),Ir=typeof window<"u"&&window.innerWidth<=640,ie=F=>{const fe=String(F||"").replace(/\D/g,"");return fe?Number(fe)/100:0},be=F=>new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Math.max(0,Number(F)||0)),Ge=F=>{const fe=(rt||[]).find(Re=>String(Re.id)===String(F.methodId)),we=fe&&fe.taxa_percentual!=null?Number(fe.taxa_percentual):0;return Number.isFinite(we)?we/100:0},We=()=>(At||[]).reduce((F,fe)=>F+ie(fe.value),0),_t=(F,fe)=>{try{if(Ir)return;const we=(At||[]).findIndex(Re=>Re.id===fe);if(we>=0){const Re=(At||[])[we+1]||null;if(Re&&It.current.get(Re.id)){const Je=It.current.get(Re.id);setTimeout(()=>{try{Je.focus(),Je.select?.()}catch{}},0);return}}if(F&&F instanceof HTMLElement){const Re=Array.from(document.querySelectorAll('input[data-pay-value="1"]')),Je=Re.indexOf(F);if(Je>=0&&Re[Je+1]){const He=Re[Je+1];setTimeout(()=>{try{He.focus(),He.select?.()}catch{}},0);return}}St(Re=>{const Je=jr[0]?.id||"",He=rt&&rt[0]&&rt[0].id?rt[0].id:null,Et=xr,Xt=[...Re,{id:Et,clientId:Je,methodId:He,value:"",chargeFee:!0}];return er(jt=>jt+1),Ir||setTimeout(()=>{const jt=It.current.get(Et);if(jt)try{jt.focus(),jt.select?.()}catch{}},0),Xt})}catch{}};p.useEffect(()=>{let F=!0;return(async()=>{try{if(!ft||!s?.comandaId)return;let we=[];try{const pr=await ZHe({comandaId:s.comandaId,status:"Pendente",codigoEmpresa:t?.codigo_empresa});we=Array.isArray(pr)?pr:[]}catch{we=[]}let Re=[];try{const pr=await Zi({comandaId:s.comandaId,codigoEmpresa:t?.codigo_empresa});Re=(Array.isArray(pr)?pr:[]).map(Pr=>{const Vr=Pr?.cliente_id??Pr?.clientes?.id??Pr?.id??null,Lt=Pr?.clientes?.nome??Pr?.nome??Pr?.nome_livre??"";return!Vr&&Lt?{id:`livre-${Pr?.id||Math.random()}`,nome:Lt}:Vr?{id:Vr,nome:Lt}:null}).filter(Boolean)}catch{Re=[]}if(!F)return;if(cr(Re),Array.isArray(we)&&we.length>0){const pr=we.map((Wr,Pr)=>{const Vr=Number(Wr.valor||0),xn={id:Pr+1,clientId:Wr.cliente_id||null,methodId:Wr.finalizadora_id||null,chargeFee:!0},Rn=Ge(xn),Ma=Rn>0?Vr/(1+Rn):Vr,xi=Ma*(1+Rn);return{...xn,baseValue:Ma,value:be(xi)}});St(pr),er(pr.length+1);return}let Je=rt&&rt[0]&&rt[0].id?rt[0].id:null,He=Re[0]?.id||null,Et="";try{const Wr=(await Ci({comandaId:s.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).reduce((Pr,Vr)=>Pr+Number(Vr.quantidade||0)*Number(Vr.preco_unitario||0),0);Wr>0&&(Et=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Wr))}catch{}const Xt=ie(Et),jt={id:1,clientId:He,methodId:Je,baseValue:Xt,chargeFee:!0},Rt=Ge(jt),ar=jt.chargeFee?Xt*(1+Rt):Xt;St([{...jt,value:be(ar)}]),er(2)}catch(we){console.error(we)}})(),()=>{F=!1}},[ft,s?.comandaId,rt]),p.useEffect(()=>{if(!ft||!s?.comandaId||!Array.isArray(At)||At.length===0)return;const F=setTimeout(async()=>{try{const fe=(At||[]).map(we=>{const Re=ie(we.value),Je=(rt||[]).find(Et=>String(Et.id)===String(we.methodId)),He=Je?.tipo||Je?.nome||"outros";return{clienteId:we.clientId||null,finalizadoraId:we.methodId||null,metodo:He,valor:Re}});await Tq({comandaId:s.comandaId,linhas:fe,codigoEmpresa:t?.codigo_empresa})}catch(fe){console.warn("[PayDialog] Falha ao salvar rascunho de pagamentos (debounced):",fe)}},400);return()=>{clearTimeout(F)}},[ft,s?.comandaId,At,rt,t?.codigo_empresa]),p.useEffect(()=>{let F=!0;return(async()=>{try{if(!ft||Array.isArray(rt)&&rt.length>0)return;const we=await Uv({somenteAtivas:!0,codigoEmpresa:t?.codigo_empresa});if(!F)return;mt(we||[])}catch{}})(),()=>{F=!1}},[ft]),p.useEffect(()=>{ft&&(!Array.isArray(rt)||rt.length===0||St(F=>{if(!Array.isArray(F)||F.length===0)return F;const fe=rt&&rt[0]&&rt[0].id?rt[0].id:null;if(!fe)return F;let we=!1;const Re=F.map(Je=>{if(!Je.methodId){we=!0;const He={...Je,methodId:fe},Et=Ge(He),Xt=He.chargeFee!==!1?Number(He.baseValue||0)*(1+Et):Number(He.baseValue||0);return{...He,value:be(Xt)}}return Je});return we?Re:F}))},[ft,rt]);const qe=async()=>{try{if(!s?.comandaId)return;const F=t?.codigo_empresa;if(!F){e({title:"Empresa no definida",variant:"destructive"});return}if(!Array.isArray(At)||At.length===0){e({title:"Informe os pagamentos",description:"Adicione pelo menos uma forma de pagamento.",variant:"warning"});return}for(const Rt of At){if(!Rt.methodId){e({title:"Forma de pagamento faltando",description:"Selecione a finalizadora em todas as linhas.",variant:"warning"});return}if(ie(Rt.value)<=0){e({title:"Valor invlido",description:"Informe valores maiores que zero.",variant:"warning"});return}}const fe=ue>0?ue:0,we=(At||[]).reduce((Rt,ar)=>Rt+ie(ar.value),0),Re=(At||[]).reduce((Rt,ar)=>{const pr=Number(ar.baseValue||0),Wr=Ge(ar);return Rt+(ar.chargeFee!==!1&&Wr>0?pr*Wr:0)},0),Je=fe+Re,He=we-Je,Et=Math.abs(He);let Xt=ue;if(Xt<=0)try{Xt=(await Ci({comandaId:s.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).reduce((pr,Wr)=>pr+Number(Wr.quantidade||0)*Number(Wr.preco_unitario||0),0)}catch{}ht(!0),await uf({codigoEmpresa:t?.codigo_empresa});try{const Rt=(At||[]).map(ar=>{const pr=ie(ar.value),Wr=(rt||[]).find(Vr=>String(Vr.id)===String(ar.methodId)),Pr=Wr?.tipo||Wr?.nome||"outros";return{clienteId:ar.clientId||null,finalizadoraId:ar.methodId||null,metodo:Pr,valor:pr}});await Tq({comandaId:s.comandaId,linhas:Rt,codigoEmpresa:F})}catch(Rt){console.warn("[PayDialog] Falha ao salvar rascunho antes de promover:",Rt)}await eGe({comandaId:s.comandaId,codigoEmpresa:F}),await Rx({comandaId:s.comandaId,codigoEmpresa:t?.codigo_empresa,diferencaPagamento:He}),i(Rt=>Rt.map(ar=>ar.id===s.id?{...ar,status:"available",order:[],comandaId:null,customer:null,totalHint:0}:ar)),l(Rt=>Rt&&{...Rt,status:"available",order:[],comandaId:null,customer:null,totalHint:0});try{t?.codigo_empresa&&localStorage.removeItem(`vendas:tables:${t.codigo_empresa}`)}catch{}try{const Rt=await xp(t?.codigo_empresa),ar=await sc({codigoEmpresa:t?.codigo_empresa}),pr={};await Promise.all((ar||[]).map(async Pr=>{try{const Lt=(await Zi({comandaId:Pr.id,codigoEmpresa:t?.codigo_empresa})||[]).map(xn=>xn?.nome).filter(Boolean);pr[Pr.id]=Lt.length?Lt.join(", "):null}catch{pr[Pr.id]=null}}));const Wr=(Rt||[]).map(Pr=>{const Vr=(ar||[]).find(Lt=>Lt.mesa_id===Pr.id);return{id:Pr.id,name:Pr.nome||`Mesa ${Pr.numero}`,status:Vr?"in-use":"available",comandaId:Vr?.id||null,customer:Vr?pr[Vr.id]:null,order:[],totalHint:0,aberto_em:Vr?.aberto_em||null}});i(Wr)}catch{}const jt=Et>.009?He>0?` | Diferena cobrada a mais: R$ ${Et.toFixed(2)}`:` | Diferena cobrada a menos: R$ ${Et.toFixed(2)}`:"";e({title:"Pagamento registrado",description:`Total itens R$ ${Xt.toFixed(2)} | Pagamentos R$ ${we.toFixed(2)}${jt}`,variant:"success"}),yt(!1)}catch(F){e({title:"Falha ao registrar pagamento",description:F?.message||"Tente novamente",variant:"destructive"})}finally{ht(!1)}};At&&At.length>0;const X=ue>0?ue:0,Me=(At||[]).reduce((F,fe)=>F+ie(fe.value),0),gt=(At||[]).reduce((F,fe)=>{const we=Number(fe.baseValue||0),Re=Ge(fe);return F+(fe.chargeFee!==!1&&Re>0?we*Re:0)},0),ir=X+gt,Dr=Me-ir,O=Math.abs(Dr);return o.jsx(ln,{open:ft,onOpenChange:yt,children:o.jsxs(on,{className:"sm:max-w-xl w-[92vw] max-h-[85vh] animate-none flex flex-col overflow-hidden",onKeyDown:F=>F.stopPropagation(),onKeyDownCapture:F=>F.stopPropagation(),onPointerDownOutside:F=>F.stopPropagation(),onInteractOutside:F=>F.stopPropagation(),children:[o.jsxs(nn,{children:[o.jsx(rn,{className:"text-2xl font-bold",children:"Fechar Conta"}),o.jsx(_n,{children:"Divida o pagamento entre clientes e vrias finalizadoras, se necessrio."})]}),o.jsxs("div",{className:"space-y-2",children:[(()=>{let F=0,fe=0,we=0;for(const He of s?.order||[]){const Et=(He.price||0)*(He.quantity||1);F+=Et,He.desconto_tipo==="percentual"&&He.desconto_valor>0?fe+=Et*(He.desconto_valor/100):He.desconto_tipo==="fixo"&&He.desconto_valor>0&&(fe+=He.desconto_valor)}const Re=F-fe;s?.desconto_tipo==="percentual"&&s?.desconto_valor>0?we=Re*(s.desconto_valor/100):s?.desconto_tipo==="fixo"&&s?.desconto_valor>0&&(we=s.desconto_valor);const Je=fe+we;return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center gap-8 text-sm",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-text-secondary",children:"Subtotal"}),o.jsxs("span",{className:"font-semibold",children:["R$ ",F.toFixed(2)]})]}),Je>0&&o.jsxs("div",{className:"flex items-center gap-2 text-destructive",children:[o.jsx("span",{children:"Descontos"}),o.jsxs("span",{className:"font-semibold",children:["-R$ ",Je.toFixed(2)]})]})]}),o.jsxs("div",{className:"border-t border-border pt-1 flex items-center justify-between",children:[o.jsx("div",{className:"font-semibold",children:"Total"}),o.jsxs("div",{className:"font-bold text-lg",children:["R$ ",ue.toFixed(2)]})]})]})})(),o.jsxs("div",{className:"flex items-center gap-8 text-xs text-text-muted pt-1",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{children:"Pagamentos"}),o.jsxs("span",{className:"font-semibold",children:["R$ ",Me.toFixed(2)]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{children:"Diferena"}),o.jsx("span",{className:O>.009?Dr>0?"font-semibold text-emerald-600":"font-semibold text-amber-600":"font-semibold",children:O>.009?`${Dr>0?"+":"-"} R$ ${O.toFixed(2)}`:"R$ 0,00"})]})]}),o.jsxs("div",{className:"flex-1 space-y-2 overflow-y-auto thin-scroll pr-1 max-h-[60vh]",children:[o.jsx(Wt,{className:"block",children:"Pagamentos"}),(At||[]).map((F,fe)=>{const we=He=>{if(!He)return"Cliente";const Et=(jr||[]).find(Xt=>String(Xt.id)===String(He));return Et?.nome?Et.nome:"Cliente"},Re=(jr||[]).length>1,Je=(jr||[])[0]||null;return(jr||[]).filter(He=>String(He.id)!==String(Je?.id||"")),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-12 gap-2 items-center",children:[o.jsx("div",{className:"sm:col-span-1 flex sm:justify-start",children:At.length>1&&fe>0&&o.jsx(oe,{type:"button",variant:"outline",size:"sm",className:"h-8 w-8",onClick:()=>{St(He=>{const Et=He.filter(ar=>ar.id!==F.id);if(Et.length===0)return[];const Xt=ue>0?ue:0,jt=Math.floor(Xt/Et.length*100)/100,Rt=Xt-jt*Et.length;return Et.map((ar,pr)=>{const Wr=pr===Et.length-1?jt+Rt:jt,Pr={...ar},Vr=Ge(Pr),xn=Pr.chargeFee!==!1&&Vr>0?Wr/(1+Vr):Wr;return{...Pr,baseValue:xn,value:be(Wr)}})})},children:""})}),fe===0?o.jsx("div",{className:"sm:col-span-4",children:o.jsx("div",{className:"h-9 px-3 rounded-md border border-border bg-surface flex items-center text-sm truncate",children:we(Je?.id||F.clientId)})}):Re?o.jsx("div",{className:"sm:col-span-4",children:o.jsxs(En,{value:F.clientId||"",onValueChange:He=>St(Et=>Et.map(Xt=>Xt.id===F.id?{...Xt,clientId:He}:Xt)),children:[o.jsx(Sn,{className:"w-full truncate",children:o.jsx(kn,{placeholder:"Cliente"})}),o.jsx(Cn,{children:(jr||[]).map(He=>o.jsx(wt,{value:He.id,children:He.nome},He.id))})]})}):o.jsx("div",{className:"sm:col-span-4",children:o.jsx("div",{className:"h-9 px-3 rounded-md border border-border bg-surface flex items-center text-sm truncate",children:we(Je?.id||F.clientId)})}),o.jsx("div",{className:"sm:col-span-4",children:o.jsxs(En,{value:F.methodId||"",onValueChange:He=>{St(Et=>Et.map(Xt=>{if(Xt.id!==F.id)return Xt;const Rt={...Xt,methodId:He},ar=Ge(Rt),pr=Rt.chargeFee!==!1?Number(Rt.baseValue||0)*(1+ar):Number(Rt.baseValue||0);return{...Rt,value:be(pr)}}))},children:[o.jsx(Sn,{className:"w-full truncate",children:o.jsx(kn,{placeholder:"Forma de pagamento"})}),o.jsx(Cn,{children:(rt||[]).map(He=>o.jsx(wt,{value:He.id,children:He.nome},He.id))})]})}),o.jsx("div",{className:"sm:col-span-3",children:o.jsx(or,{placeholder:"0,00",inputMode:"numeric",value:F.value,"data-pay-value":"1",ref:He=>{He?It.current.set(F.id,He):It.current.delete(F.id)},onChange:He=>{const Et=(He.target.value||"").replace(/\D/g,""),Xt=Et?Number(Et)/100:0;St(jt=>jt.map(Rt=>{if(Rt.id!==F.id)return Rt;const ar=Ge(Rt),pr=Rt.chargeFee!==!1&&ar>0?Xt/(1+ar):Xt,Wr=Rt.chargeFee!==!1?pr*(1+ar):pr;return{...Rt,baseValue:pr,value:be(Wr)}}))},onKeyDown:He=>{if(He.stopPropagation(),He.key==="Enter"){He.preventDefault(),_t(He.currentTarget,F.id);return}["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(He.key)||/^[0-9]$/.test(He.key)||He.preventDefault()},onBeforeInput:He=>{const Et=He.data??"";Et&&/\D/.test(Et)&&He.preventDefault()}})}),o.jsx("div",{className:"sm:col-span-12 -mt-1 pl-1",children:(()=>{const He=Ge(F),Et=He*100,Xt=F.chargeFee!==!1,jt=F.baseValue!=null?Number(F.baseValue):(()=>{const pr=(F.value||"").toString().replace(/\D/g,""),Wr=pr?Number(pr)/100:0;return Xt&&He>0?Wr/(1+He):Wr})();if(!Et||Et<=0||!Number.isFinite(jt)||jt<=0)return null;const Rt=Xt?jt*He:0;return o.jsxs("button",{type:"button",onClick:()=>{St(ar=>ar.map(pr=>{if(pr.id!==F.id)return pr;const Wr=Ge(pr),Pr=pr.chargeFee!==!1,Vr=pr.baseValue!=null?Number(pr.baseValue):ie(pr.value),Lt=Pr?Vr:Vr*(1+Wr);return{...pr,chargeFee:!Pr,baseValue:Vr,value:be(Lt)}}))},className:["inline-flex items-center gap-2 px-3 py-1 rounded-sm text-xs font-medium border transition-colors",Xt?"bg-black text-amber-400 border-amber-500":"bg-surface text-text-secondary border-border hover:border-border-hover"].join(" "),title:Xt?"Desmarcar taxa":"Cobrar taxa",children:[o.jsx("span",{className:["inline-block h-3 w-3 rounded-sm border",Xt?"bg-amber-500 border-amber-400":"bg-transparent border-border"].join(" ")}),o.jsxs("span",{children:["Taxa R$ ",Rt.toFixed(2)]})]})})()})]},F.id)}),o.jsx("div",{children:o.jsx(oe,{type:"button",variant:"secondary",size:"sm",className:"pointer-events-auto",onPointerUp:F=>{F.preventDefault(),F.stopPropagation(),St(fe=>{const we=jr[0]?.id||"",Re=rt&&rt[0]&&rt[0].id?rt[0].id:null,Je=[...fe,{id:xr,clientId:we,methodId:Re,value:"",chargeFee:!0}],He=ue>0?ue:0,Et=Math.floor(He/Je.length*100)/100,Xt=He-Et*Je.length;return Je.map((jt,Rt)=>{const ar=Rt===Je.length-1?Et+Xt:Et,pr=Ge(jt),Pr=jt.chargeFee!==!1&&pr>0?ar/(1+pr):ar;return{...jt,baseValue:Pr,value:be(ar)}})}),er(fe=>fe+1)},children:"Adicionar forma"})}),(()=>{const F=We(),fe=(At||[]).reduce((Je,He)=>{const Et=Number(He.baseValue||0),Xt=Ge(He);return Je+(He.chargeFee!==!1&&Xt>0?Et*Xt:0)},0),Re=(ue>0?ue:0)+fe-F;return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"text-sm text-text-secondary flex justify-between",children:[o.jsx("span",{children:"Soma"}),o.jsxs("span",{children:["R$ ",F.toFixed(2)]})]}),o.jsxs("div",{className:"text-sm font-semibold flex justify-between",children:[o.jsx("span",{children:"Restante"}),o.jsxs("span",{className:Math.abs(Re)<.005?"text-success":"text-warning",children:["R$ ",Re.toFixed(2)]})]})]})})()]})]}),o.jsxs(Un,{children:[o.jsx(oe,{type:"button",variant:"outline",onClick:()=>yt(!1),disabled:Fe,children:"Cancelar"}),o.jsx(oe,{type:"button",onClick:qe,disabled:!(At&&At.length>0&&!Fe),children:Fe?"Processando...":"Confirmar Pagamento"})]})]})})},Gt=ye.memo(({open:ue,onOpenChange:Fe,cashSummary:ht})=>{const At=Me=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(Me||0)),[St,xr]=p.useState(!0);p.useEffect(()=>{xr(!!ue)},[ue]);const er=p.useMemo(()=>{const Me=Number(ht?.saldo_inicial??ht?.saldoInicial??0),gt=ht?.totalPorFinalizadora||ht?.porFinalizadora||{},ir=Number(ht?.totalEntradas??ht?.entradas??0),Dr=ir>0?ir:Object.values(gt||{}).reduce((we,Re)=>we+Number(Re||0),0),O=Number(ht?.sangria??ht?.totalSangria??0),F=Number(ht?.totalSaidas??ht?.saidas??O),fe=Math.max(0,Me+Dr-F);return{saldoInicial:Me,porFinalizadora:gt,entradasInformadas:ir,entradasCalc:Dr,sangriaVal:O,saidas:F,saldoAtual:fe}},[ht]);p.useEffect(()=>{if(ue&&ht){const Me=setTimeout(()=>xr(!1),50);return()=>clearTimeout(Me)}},[ue,ht]);const{porFinalizadora:jr,sangriaVal:cr}=er,[It,Ir]=p.useState(!1),[ie,be]=p.useState(""),[Ge,We]=p.useState(""),[_t,qe]=p.useState(!1),X=async()=>{try{qe(!0);const Me=String(ie||"").replace(/\D/g,""),gt=Me?Number(Me)/100:0;if(gt<=0){e({title:"Valor invlido",description:"Informe um valor positivo.",variant:"warning"});return}await uf({codigoEmpresa:t?.codigo_empresa}),await G3({tipo:"sangria",valor:gt,observacao:Ge,codigoEmpresa:t?.codigo_empresa}),Ir(!1),be(""),We(""),await Ur(),e({title:"Sangria registrada",variant:"success"})}catch(Me){e({title:"Falha ao registrar sangria",description:Me?.message||"Tente novamente",variant:"destructive"})}finally{qe(!1)}};return o.jsx(ln,{open:ue,onOpenChange:Fe,children:o.jsxs(on,{forceMount:!0,className:"sm:max-w-lg w-[92vw] max-h-[85vh] animate-none flex flex-col overflow-hidden",onOpenAutoFocus:Me=>Me.preventDefault(),onKeyDown:Me=>Me.stopPropagation(),onKeyDownCapture:Me=>Me.stopPropagation(),onPointerDownOutside:Me=>Me.stopPropagation(),onInteractOutside:Me=>Me.stopPropagation(),children:[o.jsxs(nn,{children:[o.jsx(rn,{className:"text-2xl font-bold",children:"Detalhes do Caixa"}),o.jsx(_n,{children:"Resumo da sesso atual do caixa."})]}),St||!ht?o.jsxs("div",{className:"px-4 space-y-3",children:[o.jsx(Yg,{className:"h-16 w-full"}),o.jsx(Yg,{className:"h-16 w-full"}),o.jsx(Yg,{className:"h-12 w-full"})]}):o.jsxs("div",{className:"px-1",children:[Object.keys(jr).length===0?o.jsx("div",{className:"p-3 text-sm text-text-muted border rounded-md",children:"Nenhuma finalizadora registrada ainda."}):o.jsxs(o.Fragment,{children:[o.jsx("ul",{className:"rounded-md border border-border overflow-hidden divide-y divide-border",children:Object.entries(jr).map(([Me,gt])=>o.jsxs("li",{className:"bg-surface px-3 py-2 flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:String(Me)}),o.jsx("span",{className:"text-sm font-semibold tabular-nums",children:At(gt)})]},Me))}),o.jsxs("div",{className:"mt-2 rounded-md border border-border bg-surface px-3 py-2 flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:"Sangrias"}),o.jsx("span",{className:"text-sm font-semibold tabular-nums text-danger",children:At(cr)})]})]}),o.jsx("div",{className:"mt-3 text-xs text-text-muted leading-relaxed px-1",children:'Sadas incluem sangrias e ajustes. Use "Registrar Sangria" para lanar uma retirada.'})]}),o.jsxs(Un,{className:"flex items-center justify-between gap-2",children:[o.jsx("div",{className:"mr-auto"}),o.jsx(oe,{variant:"destructive",onClick:()=>Ir(!0),children:"Registrar Sangria"}),o.jsx(oe,{variant:"secondary",onClick:()=>Fe(!1),children:"Fechar"})]}),o.jsx(ln,{open:It,onOpenChange:Ir,children:o.jsxs(on,{className:"sm:max-w-sm w-[92vw] max-h-[85vh] animate-none",onKeyDown:Me=>Me.stopPropagation(),onKeyDownCapture:Me=>Me.stopPropagation(),children:[o.jsxs(nn,{children:[o.jsx(rn,{className:"text-xl font-bold",children:"Registrar Sangria"}),o.jsx(_n,{children:"Informe o valor a retirar do caixa e, opcionalmente, uma observao."})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx(Wt,{htmlFor:"sangria-valor",children:"Valor"}),o.jsx(or,{id:"sangria-valor",type:"text",inputMode:"numeric",autoComplete:"off",placeholder:"0,00",value:ie,onChange:Me=>{const gt=(Me.target.value||"").replace(/\D/g,""),ir=gt?Number(gt)/100:0,Dr=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(ir);be(Dr)},onKeyDown:Me=>{Me.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(Me.key)&&(/^[0-9]$/.test(Me.key)||Me.preventDefault())},onBeforeInput:Me=>{const gt=Me.data??"";gt&&/\D/.test(gt)&&Me.preventDefault()}})]}),o.jsxs("div",{children:[o.jsx(Wt,{htmlFor:"sangria-obs",children:"Observao"}),o.jsx(or,{id:"sangria-obs",placeholder:"Opcional",value:Ge,onChange:Me=>We(Me.target.value)})]})]}),o.jsxs(Un,{children:[o.jsx(oe,{variant:"outline",onClick:()=>Ir(!1),disabled:_t,children:"Cancelar"}),o.jsx(oe,{onClick:X,disabled:_t,children:_t?"Registrando...":"Confirmar"})]})]})})]})})}),gr=()=>{const ue=async()=>{if(q)try{await Cv({itemId:q.id,codigoEmpresa:t?.codigo_empresa}),e({title:"Item removido",description:q.name,variant:"warning"})}catch(Fe){e({title:"Falha ao remover item",description:Fe?.message||"Tente novamente",variant:"destructive"})}finally{ne(!1),L(null)}};return o.jsx(Md,{open:W,onOpenChange:ne,children:o.jsxs(Gc,{children:[o.jsxs(Kc,{children:[o.jsx(Xc,{children:"Remover item?"}),o.jsxs(Jc,{children:['Tem certeza que deseja remover "',q?.name,'" da comanda? Esta ao no pode ser desfeita.']})]}),o.jsxs(Yc,{children:[o.jsx(Qc,{children:"Cancelar"}),o.jsx(Rd,{onClick:ue,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remover"})]})]})})},J=()=>{const ue=s,Fe=ue?.order||[],ht=ue?dr(Fe):0;return console.log("[OrderDetailsDialog] tbl:",ue,"comandaId:",ue?.comandaId),o.jsx(ln,{open:$,onOpenChange:Y,children:o.jsxs(on,{className:"sm:max-w-xl w-[92vw] animate-none",onKeyDown:At=>At.stopPropagation(),onKeyDownCapture:At=>At.stopPropagation(),onPointerDownOutside:At=>At.stopPropagation(),onInteractOutside:At=>At.stopPropagation(),children:[o.jsxs(nn,{children:[o.jsxs(rn,{className:"text-2xl font-bold",children:["Comanda da Mesa ",ue?.number??""]}),o.jsx(_n,{children:ue?.customer?`Cliente: ${ue.customer}`:"Sem cliente vinculado"})]}),o.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto thin-scroll",children:Fe.length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Nenhum item na comanda."}):o.jsx("ul",{className:"divide-y divide-border",children:Fe.map(At=>o.jsxs("li",{className:"py-2 flex items-center justify-between gap-4",children:[o.jsxs("div",{className:"min-w-0",children:[o.jsx("div",{className:"font-medium truncate",children:At.name}),o.jsxs("div",{className:"text-xs text-text-muted",children:["Qtd: ",At.quantity,"  Unit: R$ ",Number(At.price||0).toFixed(2)]})]}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsxs("div",{className:"font-semibold",children:["R$ ",(Number(At.price||0)*Number(At.quantity||0)).toFixed(2)]})})]},At.id))})}),o.jsxs(Un,{children:[o.jsxs("div",{className:"mr-auto text-sm font-semibold",children:["Total: R$ ",ht.toFixed(2)]}),o.jsx(oe,{variant:"secondary",onClick:()=>Y(!1),children:"Fechar"}),ue?.comandaId&&o.jsxs(oe,{variant:"outline",onClick:()=>window.open(`/print-comanda?comanda=${ue.comandaId}`,"_blank"),children:[o.jsx(iH,{className:"mr-2 h-4 w-4"})," Imprimir"]}),o.jsxs(oe,{onClick:async()=>{Y(!1),await ut()},disabled:!ue||Fe.length===0,children:[o.jsx(Ui,{className:"mr-2 h-4 w-4"})," Fechar Conta",o.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-amber-600 border border-amber-700 rounded shadow-sm",children:"F2"})]})]})]})})},Ye=({table:ue})=>{const[Fe,ht]=p.useState(""),[At,St]=p.useState(!1),[xr,er]=p.useState(!1),jr=async()=>{if(!(!ue?.comandaId||At))try{St(!0),await dGe({comandaId:ue.comandaId,observacoes:Fe,codigoEmpresa:Number(t?.codigo_empresa)}),e({title:"Observaes salvas",description:"As observaes da comanda foram atualizadas."});try{await Br(ue)}catch(cr){console.error("Erro ao recarregar detalhes da comanda aps salvar observaes:",cr)}}catch(cr){cr?.code!=="42804"&&(console.error("Erro ao salvar observao:",cr),e({title:"Erro ao salvar observaes",description:"Tente novamente mais tarde.",variant:"destructive"}))}finally{St(!1)}};return p.useEffect(()=>{if(!ue?.comandaId){ht("");return}ht(ue.observacoes||"")},[ue?.comandaId,ue?.observacoes]),ue?o.jsxs("div",{className:"flex flex-col h-full p-4 space-y-4 overflow-y-auto thin-scroll",children:[ue.order&&ue.order.length>0&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(Wt,{className:"text-sm font-semibold",children:"Descontos por Item"}),o.jsx(oe,{size:"xs",variant:"ghost",className:"h-6 px-2 text-[11px]",onClick:()=>er(cr=>!cr),children:xr?"Esconder":`Mostrar (${ue.order.length})`})]}),xr&&o.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:ue.order.map(cr=>o.jsx("button",{onClick:()=>Xr(cr),className:"w-full p-3 rounded border border-border bg-surface hover:bg-surface-2 transition text-left",children:o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-sm font-semibold truncate",children:cr.name}),o.jsxs("p",{className:"text-xs text-text-secondary",children:["Qtd: ",cr.quantity,"  R$ ",(cr.price||0).toFixed(2)]})]}),o.jsx("div",{className:"text-right flex-shrink-0",children:cr.desconto_valor>0?o.jsxs("span",{className:"text-xs font-bold text-destructive",children:["-",cr.desconto_tipo==="percentual"?cr.desconto_valor+"%":"R$"+(cr.desconto_valor||0).toFixed(2)]}):o.jsx("span",{className:"text-xs text-text-muted",children:"Sem desconto"})})]})},cr.id))})]}),ue.comandaId&&o.jsxs("div",{className:"flex flex-col gap-2",children:[o.jsxs("div",{className:"flex items-center justify-between gap-3",children:[o.jsx(Wt,{className:"text-sm font-semibold",children:"Observaes"}),At&&o.jsx("span",{className:"text-[11px] text-text-secondary",children:"Salvando..."})]}),o.jsx("textarea",{className:"border border-border rounded p-3 text-sm resize-none bg-background min-h-20",placeholder:"Ex: sem cebola, urgente, etc.",value:Fe,onChange:cr=>{const It=cr.target.value;ht(It)},onKeyDown:async cr=>{cr.key==="Enter"&&!cr.shiftKey&&(cr.preventDefault(),await jr())}})]}),ue.comandaId&&o.jsxs("div",{className:"space-y-2",children:[o.jsx(Wt,{className:"text-sm font-semibold",children:"Desconto da Comanda"}),o.jsx(oe,{size:"sm",variant:ue.desconto_valor>0?"default":"outline",onClick:()=>sn(!0),className:"w-full gap-2",children:ue.desconto_valor>0?o.jsxs(o.Fragment,{children:[o.jsx("span",{children:"Desconto Ativo:"}),o.jsxs("span",{className:"font-bold",children:["-",ue.desconto_tipo==="percentual"?ue.desconto_valor+"%":"R$"+ue.desconto_valor.toFixed(2)]})]}):"Aplicar Desconto"}),ue.desconto_motivo&&o.jsxs("div",{className:"text-xs text-text-secondary bg-surface p-2 rounded border border-border",children:[o.jsx("strong",{children:"Motivo:"})," ",ue.desconto_motivo]})]})]}):o.jsx("div",{className:"flex items-center justify-center h-full text-text-muted",children:o.jsxs("div",{className:"text-center",children:[o.jsx(ns,{className:"mx-auto mb-4 h-12 w-12 opacity-50"}),o.jsx("p",{children:"Selecione uma mesa"})]})})},Xe=({table:ue})=>{if(!ue)return o.jsx("div",{className:"flex items-center justify-center h-full text-text-muted",children:o.jsxs("div",{className:"text-center",children:[o.jsx(Tv,{className:"mx-auto mb-4 h-12 w-12 opacity-50"}),o.jsx("p",{children:"Selecione uma mesa para ver a comanda"})]})});if($r)return o.jsxs("div",{className:"flex flex-col h-full",children:[o.jsxs("div",{className:"p-3 border-b border-border flex items-center justify-between gap-2",children:[o.jsx("div",{className:"h-0 w-0","aria-hidden":"true"}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsx(oe,{size:"sm",className:"h-7 px-2.5 rounded-full text-[12px] font-medium leading-none whitespace-nowrap",disabled:!c,onClick:()=>{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de abrir uma mesa.",variant:"warning"});return}Nt(ue),ee(!0)},children:"Abrir Mesa"})})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 thin-scroll",children:[o.jsx(Yg,{className:"h-20 w-full"}),o.jsx(Yg,{className:"h-20 w-full"}),o.jsx(Yg,{className:"h-20 w-full"})]}),o.jsxs("div",{className:"p-4 border-t border-border mt-auto",children:[o.jsxs("div",{className:"flex justify-between items-center text-sm font-semibold text-text-secondary mb-2",children:[o.jsx("span",{children:"Total"}),o.jsx("span",{children:"R$ 0,00"})]}),o.jsx(oe,{size:"lg",className:"w-full",disabled:!c,children:"Fechar Conta"})]})]});const Fe=dr(ue.order,ue),ht=Ot(ue.customer),At=async()=>{if(!ue?.comandaId)return;const jr=(await Ci({comandaId:ue.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(ie=>({id:ie.id,productId:ie.produto_id,name:ie.descricao||"Item",price:Number(ie.preco_unitario||0),quantity:Number(ie.quantidade||1)})),cr=(jr||[]).reduce((ie,be)=>ie+Number(be.price||0)*Number(be.quantity||0),0);let It=ue.customer||null;try{const be=(await Zi({comandaId:ue.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(Ge=>Ge?.nome).filter(Boolean);It=be.length?be.join(", "):null}catch{}const Ir={...ue,order:jr,customer:It,totalHint:cr};l(Ir),i(ie=>ie.map(be=>be.id===Ir.id?Ir:be))},St=async(er,jr)=>{try{const It=Number(er.quantity||1)+jr;if(It<=0){L(er),ne(!0),setTimeout(async()=>{W||await At()},100);return}const Ir=Number(er.price||0)*Number(jr||0);Ir&&(l(ie=>ie&&{...ie,totalHint:Math.max(0,Number(ie.totalHint||0)+Ir)}),i(ie=>ie.map(be=>be.id===s?.id?{...be,totalHint:Math.max(0,Number(be.totalHint||0)+Ir)}:be))),await Vc({itemId:er.id,quantidade:It,codigoEmpresa:t?.codigo_empresa}),await At(),e({title:"Quantidade atualizada",description:`${er.name}: ${It}`,variant:"success"})}catch(cr){e({title:"Falha ao atualizar quantidade",description:cr?.message||"Tente novamente",variant:"destructive"})}},xr=async er=>{L(er),ne(!0),setTimeout(async()=>{W||await At()},100)};return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex flex-col h-full",onMouseDown:er=>{er.target===er.currentTarget&&er.preventDefault()},children:[o.jsxs("div",{className:"p-3 border-b border-border flex items-center justify-center md:justify-between gap-2",children:[ht?o.jsx("div",{className:"hidden sm:block text-sm font-medium text-text-primary leading-none truncate",title:ue.customer||"",children:ht}):o.jsx("div",{className:"h-0 w-0","aria-hidden":"true"}),o.jsx("div",{className:"flex items-center gap-2",children:ue.comandaId?o.jsxs(o.Fragment,{children:[o.jsxs(oe,{size:"sm",className:"h-8 px-3 rounded-full text-[12px] font-medium leading-none whitespace-nowrap bg-black/60 text-white border border-white/10 shadow-sm hover:bg-black/80 hover:shadow transition-all flex items-center",onClick:()=>xe(!0),children:[o.jsx(cl,{size:12,className:"text-white/80 mr-1.5"}),"Clientes"]}),o.jsxs(oe,{size:"sm",variant:"outline",className:"h-8 px-3 rounded-full text-[12px] font-medium leading-none whitespace-nowrap bg-black/60 text-white border border-white/10 shadow-sm hover:bg-black/80 hover:shadow transition-all",onClick:()=>Y(!0),children:[o.jsx("span",{className:"inline-flex items-center justify-center h-5 w-5 rounded-full bg-black/40 border border-white/10 mr-1.5",children:o.jsx(ns,{size:12,className:"text-white/80"})}),"Comanda"]}),o.jsxs(Md,{children:[o.jsx(vp,{asChild:!0,children:o.jsx(oe,{size:"sm",className:"h-7 px-2.5 rounded-full text-[12px] font-medium leading-none whitespace-nowrap bg-red-600 hover:bg-red-500 text-white border border-red-600/70 focus:outline-none focus:ring-0 focus-visible:ring-0 shadow-none",children:"Cancelar"})}),o.jsxs(Gc,{className:"sm:max-w-[420px] animate-none",onKeyDown:er=>er.stopPropagation(),children:[o.jsxs(Kc,{children:[o.jsx(Xc,{children:"Cancelar comanda?"}),o.jsx(Jc,{children:"Esta ao no pode ser desfeita. Os itens sero descartados e a mesa voltar a ficar livre."})]}),o.jsxs(Yc,{children:[o.jsx(Qc,{children:"Voltar"}),o.jsx(Rd,{disabled:!1,onClick:async er=>{const jr=er.currentTarget.closest('[role="alertdialog"]');jr&&jr.querySelector("[data-radix-collection-item]")?.click();try{const cr=t?.codigo_empresa;if(cr)try{localStorage.removeItem(`vendas:selected:${cr}`),localStorage.removeItem(`vendas:tables:${cr}`)}catch{}await Dq({comandaId:ue.comandaId,codigoEmpresa:cr}),l(null),await Vt({showToast:!1}),e({title:"Comanda cancelada",variant:"success"})}catch(cr){console.error("[Cancelar Comanda] Erro:",cr),e({title:"Falha ao cancelar comanda",description:cr?.message||"Tente novamente",variant:"destructive"});try{await Vt({showToast:!1})}catch(It){console.error("[Cancelar Comanda] Erro ao recarregar aps falha:",It)}}},children:"Confirmar Cancelamento"})]})]})]})]}):o.jsx(oe,{size:"sm",className:"h-7 px-2.5 rounded-full text-[12px] font-medium leading-none whitespace-nowrap",disabled:!c,onClick:()=>{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de abrir uma mesa.",variant:"warning"});return}Nt(ue),ee(!0)},children:"Abrir Mesa"})})]}),o.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto p-4 thin-scroll",children:ue.order.length===0?o.jsx("div",{className:"text-center text-text-muted pt-16",children:o.jsx("p",{children:"Comanda vazia. Adicione produtos na aba ao lado."})}):o.jsx("ul",{className:"space-y-3",children:ue.order.map(er=>o.jsxs("li",{className:"p-2 rounded-md border border-border/30 bg-surface",children:[o.jsx("div",{className:"flex-1 min-w-0",children:o.jsx("p",{className:"text-sm font-semibold text-text-primary truncate",title:er.name,children:er.name})}),o.jsxs("div",{className:"mt-1 flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(oe,{variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>St(er,-1),children:o.jsx(gv,{size:12})}),o.jsx("span",{className:"w-7 text-center font-semibold text-sm",children:er.quantity}),o.jsx(oe,{variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>St(er,1),children:o.jsx(Ka,{size:12})})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"text-right flex-1",children:o.jsxs("div",{className:"flex items-center justify-end gap-2",children:[o.jsxs("span",{className:"font-bold text-text-primary",children:["R$ ",(er.price*er.quantity).toFixed(2)]}),er.desconto_valor>0&&o.jsxs("span",{className:"text-xs font-semibold text-destructive",children:["-",er.desconto_tipo==="percentual"?er.desconto_valor+"%":"R$"+(er.desconto_valor||0).toFixed(2)]})]})}),o.jsx(oe,{variant:"ghost",size:"icon",className:"text-danger/80 hover:text-danger h-7 w-7",onClick:()=>xr(er),children:o.jsx(Um,{size:14})})]})]})]},er.id))})}),o.jsxs("div",{className:"p-4 border-t border-border mt-auto space-y-3",children:[o.jsxs("div",{className:"flex justify-between items-center text-sm font-semibold text-text-secondary",children:[o.jsx("span",{children:"Total"}),o.jsxs("span",{children:["R$ ",Fe.toFixed(2)]})]}),o.jsxs(oe,{size:"lg",className:"w-full",onClick:ut,children:[o.jsx(Ui,{className:"mr-2"})," Fechar Conta",o.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-amber-600 border border-amber-700 rounded shadow-sm",children:"F2"})]})]})]}),o.jsx(ct,{})]})},it=()=>{const[ue,Fe]=p.useState(""),[ht,At]=p.useState(""),St=async()=>{try{if(Q)return;re(!0);const xr=(ue??"").toString().trim(),er=xr?Number(xr):void 0;if(er!==void 0&&(Number.isNaN(er)||er<=0)){e({title:"Nmero invlido",description:"Informe um nmero positivo.",variant:"warning"});return}const jr=await tGe({numero:er,nome:(ht||"").trim()||void 0,codigoEmpresa:t?.codigo_empresa}),cr={id:jr.id,number:jr.numero,name:jr.nome,status:"available",order:[],customer:null,comandaId:null,totalHint:0};i(It=>(It.some(be=>be.id===cr.id)?It.map(be=>be.id===cr.id?cr:be):[...It,cr]).slice().sort((be,Ge)=>Number(be.number)-Number(Ge.number))),ye.startTransition(()=>{l(cr),Be(!1)}),e({title:"Mesa criada",description:`Mesa ${jr.numero} adicionada`,variant:"success"}),Fe(""),At("")}catch(xr){e({title:"Falha ao criar mesa",description:xr?.message||"Tente novamente",variant:"destructive"})}finally{re(!1)}};return o.jsx(ln,{open:pe,onOpenChange:xr=>{Be(xr),xr||(Fe(""),At(""))},children:o.jsxs(on,{className:"sm:max-w-md w-[92vw]",children:[o.jsxs(nn,{children:[o.jsx(rn,{className:"text-2xl font-bold",children:"Nova Mesa"}),o.jsx(_n,{children:"Informe o nome da mesa. Se deixar em branco, ser criada com numerao automtica."})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsx(Wt,{htmlFor:"nova-mesa-nome",children:"Nome da mesa"}),o.jsx(or,{id:"nova-mesa-nome",type:"text",placeholder:"Ex: Mesa 1, Varanda, etc.",value:ht,onChange:xr=>At(xr.target.value),onKeyDown:xr=>{xr.stopPropagation(),xr.key==="Enter"&&!Q&&(xr.preventDefault(),St())},onKeyPress:xr=>xr.stopPropagation()})]}),o.jsxs(Un,{children:[o.jsx(oe,{type:"button",variant:"outline",onClick:()=>Be(!1),disabled:Q,children:"Cancelar"}),o.jsx(oe,{type:"button",onClick:St,disabled:Q,children:Q?"Criando...":"Criar Mesa"})]})]})})},Ze=async ue=>{try{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de adicionar produtos.",variant:"warning"});return}if(!s?.comandaId){e({title:"Selecione uma mesa",description:"Abra a comanda clicando na mesa primeiro.",variant:"destructive"});return}const Fe=Number(ue.stock??ue.currentStock??0),ht=y.get(ue.id)||0,At=Math.max(0,Fe-ht);if(((s?.order||[]).find(Ge=>Ge.productId===ue.id)?.quantity||0)+1>At){e({title:"Estoque insuficiente",description:`${ue.name} - Estoque disponvel: ${At} (${Fe} total, ${ht} reservado em outras comandas)`,variant:"destructive"});return}const er=Number(ue.salePrice??ue.price??0),jr=(s?.order||[]).find(Ge=>Ge.productId===ue.id);let cr;jr?(await Vc({itemId:jr.id,quantidade:Number(jr.quantity||1)+1,codigoEmpresa:t?.codigo_empresa}),cr={...jr,quantity:Number(jr.quantity||1)+1}):cr=await K3({comandaId:s.comandaId,produtoId:ue.id,descricao:ue.name,quantidade:1,precoUnitario:er,codigoEmpresa:t?.codigo_empresa});const Ir=(await Ci({comandaId:s.comandaId,codigoEmpresa:t?.codigo_empresa})||[]).map(Ge=>({id:Ge.id,productId:Ge.produto_id,name:Ge.descricao||"Item",price:Number(Ge.preco_unitario||0),quantity:Number(Ge.quantidade||1)})),ie=(Ir||[]).reduce((Ge,We)=>Ge+Number(We.price||0)*Number(We.quantity||0),0),be={...s,order:Ir,totalHint:ie};l(be),i(Ge=>Ge.map(We=>We.id===be.id?be:We));try{const Ge=await Vv({codigoEmpresa:t?.codigo_empresa}),We=new Map;for(const _t of Ge||[]){const qe=_t.produto_id,X=Number(_t.quantidade||0);We.set(qe,(We.get(qe)||0)+X)}x(We)}catch(Ge){console.error("[addProductToComanda] Erro ao atualizar estoque reservado:",Ge)}e({title:"Produto adicionado",variant:"success"})}catch(Fe){console.error("[addProductToComanda] EXCEPTION:",Fe),e({title:"Falha ao adicionar produto",description:Fe?.message||"Tente novamente",variant:"destructive"})}},dt=()=>{const[ue,Fe]=p.useState(""),[ht,At]=p.useState("all"),St=p.useRef(null),xr=p.useRef(0),er=p.useRef(null),cr=(le||[]).slice().sort((It,Ir)=>{const ie=It.code||"",be=Ir.code||"";return/^\d+$/.test(ie)&&/^\d+$/.test(be)?parseInt(ie,10)-parseInt(be,10):ie.localeCompare(be)}).filter(It=>{const Ir=ue.trim().toLowerCase(),ie=!Ir||(It.name||"").toLowerCase().includes(Ir)||String(It.code||"").toLowerCase().includes(Ir);if(ht==="all")return ie;const be=Number(It.stock??It.currentStock??0),Ge=y.get(It.id)||0,We=Math.max(0,be-Ge);return ht==="available"?ie&&We>0:ht==="low"?ie&&We>0&&We<=5:ht==="out"?ie&&We<=0:ie});return p.useEffect(()=>{try{const It=C??0,Ir=j.current?.[It];Ir&&typeof Ir.scrollIntoView=="function"&&Ir.scrollIntoView({block:"nearest"})}catch{}},[C]),s?o.jsx(ln,{open:b,onOpenChange:It=>{w(It),k(It?"panel":"tables")},children:o.jsxs(on,{className:"w-[95vw] sm:max-w-4xl max-h-[80vh] sm:max-h-[85vh] flex flex-col p-0 gap-0 focus:outline-none focus-visible:outline-none",onOpenAutoFocus:It=>{try{if(St.current){It.preventDefault(),St.current.focus(),k("panel");return}}catch{}},onWheel:It=>{It.stopPropagation()},onKeyDownCapture:It=>{["ArrowDown","ArrowUp","Home","End","PageDown","PageUp","Space"].includes(It.key)&&It.preventDefault()},onKeyDown:It=>{const Ir=It.target,ie=Ir&&(Ir.tagName==="INPUT"||Ir.closest("input")),be=Ir&&Ir.closest("[data-product-card]");if(!["ArrowDown","ArrowUp","Home","End","Enter","Delete","Escape"].includes(It.key)||ie||be)return;It.preventDefault(),It.stopPropagation();const Ge=C||0,We=cr.length;if(It.key==="ArrowDown"){const _t=Math.min(Ge+1,We-1);E(_t),xr.current=_t,requestAnimationFrame(()=>j.current[_t]?.focus());return}if(It.key==="ArrowUp"){const _t=Math.max(Ge-1,0);E(_t),xr.current=_t,requestAnimationFrame(()=>j.current[_t]?.focus());return}if(It.key==="Home"){E(0),xr.current=0,requestAnimationFrame(()=>j.current[0]?.focus());return}if(It.key==="End"){const _t=Math.max(0,We-1);E(_t),xr.current=_t,requestAnimationFrame(()=>j.current[_t]?.focus());return}if(It.key==="Escape"){w(!1);return}},children:[o.jsxs(nn,{className:"px-6 py-4 border-b border-border",children:[o.jsxs(rn,{className:"text-2xl font-bold flex items-center gap-3",children:[o.jsx(Tv,{className:"w-6 h-6 text-brand"}),"Adicionar Produtos"]}),o.jsxs(_n,{className:"text-base mt-2",children:["Mesa ",s.number,"  ",Ot(s.customer)||"Sem cliente"]})]}),o.jsxs("div",{className:"flex flex-col flex-1 min-h-0",children:[o.jsxs("div",{className:"px-6 py-4 border-b border-border bg-surface/50",children:[o.jsxs("div",{className:"relative",children:[o.jsx(pi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-text-muted"}),o.jsx("input",{ref:St,type:"text",className:"w-full pl-10 pr-4 py-3 text-base rounded-lg bg-background border-2 border-border focus:border-brand focus:ring-2 focus:ring-brand/20 transition-all outline-none",placeholder:"Digite o nome ou cdigo do produto...",value:ue,onChange:It=>Fe(It.target.value),onClick:It=>{It.stopPropagation(),It.currentTarget.focus(),k("panel")},onFocus:It=>{It.stopPropagation(),k("panel")},onKeyDown:It=>{if(It.stopPropagation(),It.nativeEvent&&typeof It.nativeEvent.stopImmediatePropagation=="function"&&It.nativeEvent.stopImmediatePropagation(),k("panel"),["ArrowDown","ArrowUp","Home","End","Escape"].includes(It.key)){It.preventDefault();const Ir=C||0,ie=cr.length;if(It.key==="ArrowDown"){E(Math.min(Ir+1,ie-1));return}if(It.key==="ArrowUp"){E(Math.max(Ir-1,0));return}if(It.key==="Home"){E(0);return}if(It.key==="End"){E(ie-1);return}if(It.key==="Escape"){w(!1);return}}}})]}),o.jsxs("div",{className:"flex items-center justify-between gap-4 mt-3",children:[o.jsx("button",{onClick:()=>At("all"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${ht==="all"?"bg-brand text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Todos"}),o.jsx("button",{onClick:()=>At("available"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${ht==="available"?"bg-success text-white":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Disponvel"}),o.jsx("button",{onClick:()=>At("low"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${ht==="low"?"bg-warning text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Estoque Baixo"}),o.jsx("button",{onClick:()=>At("out"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${ht==="out"?"bg-destructive text-white":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Sem Estoque"}),o.jsxs("div",{className:"hidden sm:flex items-center gap-2 ml-auto text-xs text-text-muted flex-shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface border border-border rounded text-xs font-mono",children:""}),o.jsx("span",{children:"Navegar"})]}),o.jsx("div",{className:"w-px h-3 bg-border"}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface border border-border rounded text-xs font-mono",children:"Esc"}),o.jsx("span",{children:"Fechar"})]})]})]})]}),o.jsx("div",{ref:er,className:"flex-1 overflow-y-auto px-6 py-4 focus:outline-none",tabIndex:-1,onKeyDown:It=>{["ArrowDown","ArrowUp","Home","End","PageDown","PageUp","Space"].includes(It.key)&&(It.preventDefault(),It.stopPropagation(),It.nativeEvent&&typeof It.nativeEvent.stopImmediatePropagation=="function"&&It.nativeEvent.stopImmediatePropagation()),It.stopPropagation();const Ir=It.target,ie=Ir&&(Ir.tagName==="INPUT"||Ir.closest("input"));if(!["ArrowDown","ArrowUp","Home","End","Escape"].includes(It.key)||ie)return;const be=C||0,Ge=cr.length;if(It.key==="ArrowDown"){const We=Math.min(be+1,Ge-1);E(We),xr.current=We,requestAnimationFrame(()=>j.current[We]?.focus());return}if(It.key==="ArrowUp"){const We=Math.max(be-1,0);E(We),xr.current=We,requestAnimationFrame(()=>j.current[We]?.focus());return}if(It.key==="Home"){E(0),xr.current=0,requestAnimationFrame(()=>j.current[0]?.focus());return}if(It.key==="End"){const We=Math.max(0,Ge-1);E(We),xr.current=We,requestAnimationFrame(()=>j.current[We]?.focus());return}if(It.key==="Escape"){w(!1);return}},children:cr.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center py-12",children:[o.jsx(Tv,{className:"w-16 h-16 text-text-muted mb-4"}),o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Nenhum produto encontrado"}),o.jsx("p",{className:"text-text-muted mb-4",children:"Tente ajustar sua busca ou cadastre novos produtos"}),o.jsxs(oe,{onClick:()=>{w(!1),n("/produtos")},children:[o.jsx(Ka,{className:"w-4 h-4 mr-2"}),"Cadastrar Produtos"]})]}):o.jsx("div",{className:"flex flex-col gap-1.5",children:cr.map((It,Ir)=>{const ie=Qt.get(It.id)||0,be=Number(It.stock??It.currentStock??0),Ge=y.get(It.id)||0,We=Math.max(0,be-Ge),_t=Ir===C;return o.jsxs("div",{ref:qe=>{console.log("[Card ref] Atribuindo ref para idx:",Ir,"prod:",It.name,"el:",!!qe),j.current[Ir]=qe,console.log("[Card ref] productItemRefs.current:",j.current.length,"elementos")},"data-product-card":!0,className:Yt("flex items-center gap-2 sm:gap-4 p-2.5 sm:p-3 rounded-lg border-2 transition-all outline-none focus:outline-none focus-visible:outline-none",We===0&&ie===0?"opacity-50 cursor-not-allowed bg-surface-2 border-border":"cursor-pointer",_t?"border-brand bg-brand/5 shadow-md":We>0?"border-border bg-surface hover:border-brand/50 hover:bg-surface-2":ie>0?"border-border bg-surface":"border-border"),tabIndex:We>0||ie>0?0:-1,onKeyDown:qe=>{if(["ArrowDown","ArrowUp","Home","End","PageDown","PageUp","Space"].includes(qe.key)&&(qe.preventDefault(),qe.stopPropagation(),qe.nativeEvent&&typeof qe.nativeEvent.stopImmediatePropagation=="function"&&qe.nativeEvent.stopImmediatePropagation()),!["ArrowDown","ArrowUp","Home","End","Escape"].includes(qe.key))return;qe.stopPropagation();const X=cr.length;if(qe.key==="ArrowDown"){const Me=Math.min(Ir+1,X-1);E(Me),xr.current=Me,requestAnimationFrame(()=>j.current[Me]?.focus());return}if(qe.key==="ArrowUp"){const Me=Math.max(Ir-1,0);E(Me),xr.current=Me,requestAnimationFrame(()=>j.current[Me]?.focus());return}if(qe.key==="Home"){E(0),xr.current=0,requestAnimationFrame(()=>j.current[0]?.focus());return}if(qe.key==="End"){const Me=Math.max(0,X-1);E(Me),xr.current=Me,requestAnimationFrame(()=>j.current[Me]?.focus());return}if(qe.key==="Escape"){w(!1);return}},onClick:()=>{We===0&&ie===0||(E(Ir),xr.current=Ir,requestAnimationFrame(()=>j.current[Ir]?.focus()))},onMouseDown:qe=>{if(We===0&&ie===0){qe.preventDefault();return}qe.currentTarget.focus()},children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[It.code&&o.jsx("span",{className:"px-2 py-0.5 text-xs font-mono font-semibold bg-surface-2 border border-border rounded",children:It.code}),o.jsx("h4",{className:"font-semibold text-sm sm:text-base text-text-primary truncate",children:It.name})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-[11px] sm:text-xs mt-0.5",children:[o.jsx("span",{className:Yt("font-bold",We===0?"text-text-muted":"text-brand"),children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(It.salePrice??It.price??0))}),o.jsxs("span",{className:"text-text-muted whitespace-nowrap",children:["Estoque: ",o.jsx("span",{className:Yt("font-semibold",We<=5?"text-destructive":"text-text-secondary"),children:We})]}),ie>0&&o.jsxs("span",{className:"px-2 py-0.5 bg-brand/10 text-brand text-[11px] font-semibold rounded whitespace-nowrap",children:[ie,"x na comanda"]})]})]}),o.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[o.jsx(oe,{size:"icon",variant:"outline",onClick:qe=>{qe.stopPropagation(),qr(It)},disabled:ie===0,className:"h-8 w-8 p-0",children:o.jsx(gv,{className:"w-4 h-4"})}),o.jsx(oe,{size:"icon",onClick:qe=>{qe.stopPropagation(),Ze(It)},disabled:We===0,className:"h-8 w-8 p-0 bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",children:o.jsx(Ka,{className:"w-4 h-4"})})]})]},It.id)})})}),o.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 border-t border-border bg-surface/50",children:o.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-2",children:[o.jsxs("div",{className:"hidden sm:block text-sm text-text-muted",children:[cr.length," produto",cr.length!==1?"s":"","  ",(s.order||[]).length," ite",(s.order||[]).length!==1?"ns":"m"," na comanda"]}),o.jsxs("div",{className:"flex items-center justify-end gap-3 w-full sm:w-auto",children:[o.jsxs("div",{className:"text-left sm:text-right",children:[o.jsx("div",{className:"text-xs text-text-muted",children:"Total"}),o.jsx("div",{className:"text-lg sm:text-xl font-bold text-green-600",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s.totalHint||0)})]}),o.jsx(oe,{onClick:()=>w(!1),className:"px-4 sm:px-6 min-w-[96px] sm:min-w-[120px]",size:"sm",children:"Concluir"})]})]})})]})]})}):null},[Pt,zt]=p.useState(null),[Er,H]=p.useState([]),[Ee,Te]=p.useState(!1),[vt,ze]=p.useState(""),[at,Zt]=p.useState(!1),[zr,Ar]=p.useState([]),[br,yr]=p.useState(!1),[nr,Zr]=p.useState(null),[tt,Lr]=p.useState(!1),[cn,pn]=p.useState(null),jn=p.useMemo(()=>{const ue=new Map;for(const Fe of Er||[]){const ht=Fe.productId,At=Number(Fe.quantity||0);ue.set(ht,(ue.get(ht)||0)+At)}return ue},[Er]),Gn=async ue=>{if(!ue)return;const ht=(await Ci({comandaId:ue,codigoEmpresa:t?.codigo_empresa})||[]).map(At=>({id:At.id,productId:At.produto_id,name:At.descricao||"Item",price:Number(At.preco_unitario||0),quantity:Number(At.quantidade||1)}));H(ht)},Ln=async ue=>{try{const Fe=t?.codigo_empresa;if(!Fe){e({title:"Empresa no definida",description:"Faa login novamente.",variant:"destructive"});return}let ht=Pt;if(!ht){if(ht=(await Nj({codigoEmpresa:Fe}))?.id,!ht){e({title:"Falha ao iniciar venda no balco",description:"No foi possvel criar ou recuperar a comanda.",variant:"destructive"});return}zt(ht)}const At=Number(ue.salePrice??ue.price??0);await K3({comandaId:ht,produtoId:ue.id,descricao:ue.name,quantidade:1,precoUnitario:At,codigoEmpresa:Fe}),await Gn(ht),e({title:"Produto adicionado (balco)",description:ue.name,variant:"success"})}catch(Fe){e({title:"Falha ao adicionar produto (balco)",description:Fe?.message||"Tente novamente",variant:"destructive"})}},aa=async ue=>{if(!(!Pt||!ue)){Zt(!1);try{await Wv({comandaId:Pt,clienteIds:[ue],nomesLivres:[],codigoEmpresa:t?.codigo_empresa}),Zr(ue),ze(""),Ar([]),e({title:"Cliente associado",variant:"success"})}catch(Fe){e({title:"Falha ao associar cliente",description:Fe?.message||"Tente novamente",variant:"destructive"}),Zt(!0)}}},Bn=async()=>{if(Pt)try{const ue=dr(Er,null);if(ue<=0){e({title:"Sem itens",description:"Adicione itens antes de pagar.",variant:"warning"});return}Te(!0),await uf({codigoEmpresa:t?.codigo_empresa});let Fe=rt;if(!Array.isArray(Fe)||Fe.length===0)try{Fe=await Uv({somenteAtivas:!0,codigoEmpresa:t?.codigo_empresa}),mt(Fe)}catch{}const ht=Fe?.[0],At=ht?.tipo||ht?.nome||"outros";await dM({comandaId:Pt,finalizadoraId:ht?.id,metodo:At,valor:ue,codigoEmpresa:t?.codigo_empresa}),await Rx({comandaId:Pt,codigoEmpresa:t?.codigo_empresa}),e({title:"Pagamento registrado (balco)",description:`R$ ${ue.toFixed(2)}`,variant:"success"}),H([]),zt(null),h(!1)}catch(ue){e({title:"Falha no pagamento (balco)",description:ue?.message||"Tente novamente",variant:"destructive"})}finally{Te(!1)}},ya=()=>{p.useEffect(()=>{let Fe=!0;return(async()=>{if(m)try{Te(!0);const At=t?.codigo_empresa;if(!At){Fe&&e({title:"Empresa no definida",description:"Faa login novamente.",variant:"destructive"});return}const St=await cM({codigoEmpresa:At});if(!Fe)return;if(St?.id){zt(St.id),await Gn(St.id);try{const xr=await Zi({comandaId:St.id,codigoEmpresa:At}),er=Array.isArray(xr)&&xr.length>0?xr[0]:null;er?.cliente_id&&Zr(er.cliente_id)}catch{}}else zt(null),H([])}catch(At){Fe&&e({title:"Falha ao abrir Modo Balco",description:At?.message||"Tente novamente",variant:"destructive"})}finally{Fe&&Te(!1)}})(),()=>{Fe=!1}},[m]),p.useEffect(()=>{if(!at)return;let Fe=!0;const At=setTimeout(async()=>{try{yr(!0);const St=await _j({searchTerm:vt,limit:20,codigoEmpresa:t?.codigo_empresa});Fe&&Ar(St||[])}catch{Fe&&Ar([])}finally{Fe&&yr(!1)}},250);return()=>{Fe=!1,clearTimeout(At)}},[at,vt]);const ue=dr(Er,null);return o.jsx(ln,{open:m,onOpenChange:h,children:o.jsxs(on,{className:"max-w-4xl h-[90vh]",onKeyDown:Fe=>Fe.stopPropagation(),onKeyDownCapture:Fe=>Fe.stopPropagation(),onPointerDownOutside:Fe=>Fe.stopPropagation(),onInteractOutside:Fe=>Fe.stopPropagation(),children:[o.jsxs(nn,{children:[o.jsx(rn,{className:"text-2xl font-bold",children:"Modo Balco"}),o.jsx(_n,{children:"Venda rpida para clientes sem mesa."})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-6 h-full overflow-hidden pt-4",children:[o.jsxs("div",{className:"col-span-1 flex flex-col border-r border-border pr-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold",children:"Catlogo de Produtos"}),o.jsx(oe,{variant:"outline",size:"sm",onClick:()=>Zt(!0),children:nr?o.jsxs(o.Fragment,{children:[o.jsx(Ai,{className:"mr-1 h-4 w-4 text-success"})," Cliente"]}):"Cliente"})]}),o.jsxs("div",{className:"relative mb-4",children:[o.jsx(pi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(or,{placeholder:"Buscar produto...",className:"pl-9",value:vt,onChange:Fe=>ze(Fe.target.value),ref:_})]}),o.jsx("div",{className:"flex-1 overflow-y-auto -mr-4 pr-4 thin-scroll",children:o.jsxs("ul",{className:"space-y-2",children:[(le||[]).filter(Fe=>{const ht=vt.trim().toLowerCase();return ht?(Fe.name||"").toLowerCase().includes(ht)||(Fe.code||"").toLowerCase().includes(ht):!0}).sort((Fe,ht)=>{const At=Fe.code||"",St=ht.code||"";return/^\d+$/.test(At)&&/^\d+$/.test(St)?parseInt(At,10)-parseInt(St,10):At.localeCompare(St)}).map(Fe=>{const ht=(Er||[]).reduce((er,jr)=>er+(jr.productId===Fe.id?Number(jr.quantity||0):0),0),At=Number(Fe.stock??Fe.currentStock??0),St=y.get(Fe.id)||0,xr=Math.max(0,At-St);return o.jsxs("li",{className:"flex items-center p-2 rounded-md hover:bg-surface-2 transition-colors",onClick:()=>{pn(Fe),Lr(!0)},children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("p",{className:"font-semibold truncate",title:`${Fe.code?`[${Fe.code}] `:""}${Fe.name}`,children:[Fe.code&&o.jsxs("span",{className:"text-text-muted",children:["[",Fe.code,"]"]})," ",Fe.name]}),ht>0&&o.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-brand/15 text-brand border border-brand/30 flex-shrink-0",children:["x",ht]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("p",{className:"text-sm text-text-muted",children:["R$ ",Number(Fe.salePrice??Fe.price??0).toFixed(2)]}),o.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-surface-2 text-text-secondary border border-border flex-shrink-0",children:["Qtd ",xr]})]})]}),o.jsx(oe,{size:"icon",className:"flex-shrink-0 bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",onClick:er=>{er.stopPropagation(),Ln(Fe)},"aria-label":`Adicionar ${Fe.name}`,children:o.jsx(Ka,{size:16})})]},Fe.id)}),(!le||le.length===0)&&o.jsxs("li",{className:"text-center text-text-muted py-8",children:[o.jsx("div",{className:"mb-3",children:"Nenhum produto cadastrado. Cadastre produtos para vender no balco."}),o.jsx(oe,{size:"sm",onClick:()=>n("/produtos"),children:"Cadastrar Produtos"})]})]})})]}),o.jsxs("div",{className:"col-span-1 flex flex-col",children:[o.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Comanda do Balco"}),o.jsx("div",{className:"flex-1 overflow-y-auto bg-surface-2 rounded-lg p-4 thin-scroll",children:Er.length===0?o.jsx("p",{className:"text-center text-text-muted pt-16",children:"Adicione produtos  comanda."}):o.jsx("ul",{className:"divide-y divide-border",children:Er.map(Fe=>o.jsxs("li",{className:"py-2 flex items-center justify-between gap-4",children:[o.jsxs("div",{className:"min-w-0",children:[o.jsx("div",{className:"font-medium truncate",children:Fe.name}),o.jsxs("div",{className:"text-xs text-text-muted",children:["Qtd: ",Fe.quantity,"  Unit: R$ ",Number(Fe.price||0).toFixed(2)]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("div",{className:"font-semibold mr-2",children:["R$ ",(Number(Fe.price||0)*Number(Fe.quantity||0)).toFixed(2)]}),o.jsx(oe,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:async()=>{const ht=Number(Fe.quantity||1)-1;if(ht<=0)L(Fe),ne(!0),setTimeout(async()=>{W||await Gn(Pt)},100);else try{await Vc({itemId:Fe.id,quantidade:ht,codigoEmpresa:t?.codigo_empresa}),await Gn(Pt)}catch(At){e({title:"Falha ao atualizar",description:At?.message||"Tente novamente",variant:"destructive"})}},children:o.jsx(gv,{size:14})}),o.jsx("span",{className:"w-8 text-center font-semibold",children:Fe.quantity}),o.jsx(oe,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:async()=>{try{await Vc({itemId:Fe.id,quantidade:Number(Fe.quantity||1)+1,codigoEmpresa:t?.codigo_empresa}),await Gn(Pt)}catch(ht){e({title:"Falha ao atualizar",description:ht?.message||"Tente novamente",variant:"destructive"})}},children:o.jsx(Ka,{size:14})})]})]},Fe.id))})}),o.jsxs("div",{className:"p-4 border-t border-border mt-auto",children:[o.jsxs("div",{className:"flex justify-between items-center text-xl font-bold mb-4",children:[o.jsx("span",{children:"Total"}),o.jsxs("span",{children:["R$ ",ue.toFixed(2)]})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsxs(Md,{children:[o.jsx(vp,{asChild:!0,children:o.jsx(oe,{size:"lg",className:"flex-1 bg-red-600 hover:bg-red-500 text-white border border-red-600/70",children:"Cancelar"})}),o.jsxs(Gc,{className:"sm:max-w-[420px] animate-none",onKeyDown:Fe=>Fe.stopPropagation(),children:[o.jsxs(Kc,{children:[o.jsx(Xc,{children:"Cancelar comanda do balco?"}),o.jsx(Jc,{children:"Os itens sero descartados e o balco ser limpo. Esta ao no pode ser desfeita."})]}),o.jsxs(Yc,{children:[o.jsx(Qc,{children:"Voltar"}),o.jsx(Rd,{onClick:async()=>{try{if(!Pt){h(!1);return}await Dq({comandaId:Pt,codigoEmpresa:t?.codigo_empresa}),H([]),zt(null),h(!1),e({title:"Comanda cancelada (balco)",variant:"success"})}catch(Fe){e({title:"Falha ao cancelar",description:Fe?.message||"Tente novamente",variant:"destructive"})}},children:"Confirmar Cancelamento"})]})]})]}),o.jsxs(oe,{size:"lg",className:"flex-1",onClick:Bn,disabled:Ee||ue<=0,children:[o.jsx(Ui,{className:"mr-2"})," Finalizar Pagamento"]})]})]})]})]}),at&&o.jsx("div",{className:"absolute inset-0 bg-background/80 backdrop-blur-sm flex items-center justify-center",onClick:Fe=>{Fe.target===Fe.currentTarget&&Zt(!1)},onKeyDown:Fe=>{Fe.key==="Escape"&&Zt(!1)},children:o.jsxs("div",{className:"bg-surface rounded-lg border border-border shadow-lg w-full max-w-md p-4",role:"dialog","aria-modal":"true",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h4",{className:"text-lg font-semibold",children:"Selecionar Cliente"}),o.jsx(oe,{variant:"ghost",size:"sm",onClick:()=>Zt(!1),children:"Fechar"})]}),o.jsxs("div",{className:"relative mb-2",children:[o.jsx(pi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(or,{placeholder:"Nome, e-mail, telefone ou cdigo",className:"pl-9",value:vt,onChange:Fe=>ze(Fe.target.value)})]}),o.jsx("div",{className:"max-h-64 overflow-auto thin-scroll border rounded-md",children:br?o.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Carregando clientes..."}):zr.length>0?o.jsx("ul",{children:zr.map(Fe=>o.jsxs("li",{className:Yt("p-2 flex items-center justify-between cursor-pointer hover:bg-surface-2",nr===Fe.id&&"bg-surface-2"),onClick:()=>aa(Fe.id),children:[o.jsx("div",{children:o.jsxs("div",{className:"font-medium",children:[Fe.codigo!=null?String(Fe.codigo)+" - ":"",Fe.nome]})}),nr===Fe.id&&o.jsx(Ai,{size:16,className:"text-success"})]},Fe.id))}):o.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum cliente encontrado."})})]})})]})})},an=()=>{const ue=cn,Fe=ue&&jn.get(ue.id)||0,ht=ue?Number(ue.salePrice??ue.price??0):0,At=St=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(St||0));return o.jsx(ln,{open:tt,onOpenChange:St=>{Lr(St),St||pn(null)},children:o.jsxs(on,{overlayClassName:"z-[60]",className:"sm:max-w-[420px] w-[92vw] max-h-[85vh] flex flex-col animate-none z-[61]",onKeyDown:St=>St.stopPropagation(),onPointerDownOutside:St=>St.stopPropagation(),onInteractOutside:St=>St.stopPropagation(),onEscapeKeyDown:St=>{St.preventDefault(),St.stopPropagation()},children:[o.jsxs(nn,{children:[o.jsx(rn,{className:"text-xl font-bold break-words",title:ue?.name||"",children:ue?.name||"Produto"}),o.jsx(_n,{children:"Detalhes do produto (Balco)."})]}),ue?o.jsxs("div",{className:"space-y-3 overflow-y-auto pr-1",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Preo"}),o.jsx("span",{className:"text-sm font-semibold",children:At(ht)})]}),ue.category?o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Categoria"}),o.jsx("span",{className:"text-sm font-medium",children:ue.category})]}):null,o.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[typeof ue.stock<"u"&&o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("div",{className:"text-xs text-text-secondary",children:"Estoque"}),o.jsx("div",{className:"text-base font-semibold",children:ue.stock})]}),typeof ue.minStock<"u"&&o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("div",{className:"text-xs text-text-secondary",children:"Mnimo"}),o.jsx("div",{className:"text-base font-semibold",children:ue.minStock})]}),o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("div",{className:"text-xs text-text-secondary",children:"Na Comanda"}),o.jsxs("div",{className:"text-base font-semibold",children:["x",Fe]})]})]})]}):null,o.jsxs(Un,{className:"flex items-center justify-between gap-2",children:[o.jsxs(oe,{variant:"ghost",size:"sm",className:"mr-auto inline-flex items-center gap-1",onClick:()=>{ue&&n("/produtos",{state:{productId:ue.id,productName:ue.name}})},children:[o.jsx(ns,{className:"w-4 h-4"}),o.jsx("span",{children:"Info"})]}),o.jsx(oe,{variant:"outline",onClick:()=>{Lr(!1),pn(null)},children:"Fechar"}),o.jsx(oe,{onClick:async()=>{ue&&(await Ln(ue),Lr(!1),pn(null))},children:"Adicionar"})]})]})})},Ea=()=>{const[ue,Fe]=p.useState(""),[ht,At]=p.useState(!1),[St,xr]=p.useState([]),[er,jr]=p.useState([]),[cr,It]=p.useState(0),[Ir,ie]=p.useState(!1),[be,Ge]=p.useState(0),We=p.useRef([]),_t=p.useRef(null),qe=p.useRef(null),X=p.useRef(null),Me=p.useRef(null),gt=p.useRef(0),ir=p.useRef(0);p.useEffect(()=>{let F=!0;return(async()=>{try{At(!0);const we=await _j({searchTerm:ue,limit:20});if(!F)return;const Re=(we||[]).slice(),Je=String(ue||"").trim().toLowerCase(),He=Et=>{const Xt=String(Et?.nome||"").toLowerCase();return Je?Xt.startsWith(Je)?0:Xt.includes(Je)?1:2:2};Re.sort((Et,Xt)=>{const jt=He(Et),Rt=He(Xt);if(jt!==Rt)return jt-Rt;const ar=Number(Et?.codigo||0),pr=Number(Xt?.codigo||0);return ar-pr}),xr(Re),Ge(0)}catch{if(!F)return;xr([])}finally{F&&At(!1)}})(),()=>{F=!1}},[ue]);const Dr=p.useRef(!1);p.useEffect(()=>{try{Z&&!Dr.current&&(Dr.current=!0,X.current&&(X.current.scrollTop=0),_t.current&&(_t.current.scrollTop=0),qe.current&&(qe.current.scrollTop=0)),Z||(Dr.current=!1)}catch{}},[Z]),p.useEffect(()=>{try{Z&&Array.isArray(St)&&St.length>0&&(Ge(0),setTimeout(()=>{try{_t.current?.focus(),qe.current&&(qe.current.scrollTop=0)}catch{}},0))}catch{}},[Z,St.length]);const O=async(F=null)=>{try{if(!kt)return;const fe=await aGe({mesaId:kt.id,codigoEmpresa:t?.codigo_empresa}),Re=Array.isArray(F)?F:er,Je=Array.isArray(Re)?Array.from(new Set(Re)):[];let He=[],Et=Math.max(0,Number(cr||0));Je.length===0&&Et===0&&(Et=1);for(let Rt=0;Rt<Et;Rt++)He.push("Consumidor");console.log("[confirmOpen] Chamando adicionarClientesAComanda com:",{comandaId:fe.id,clienteIds:Je,nomesLivres:He}),await Wv({comandaId:fe.id,clienteIds:Je,nomesLivres:He,codigoEmpresa:t?.codigo_empresa,replace:!0});let Xt=null;try{const Rt=await Zi({comandaId:fe.id,codigoEmpresa:t?.codigo_empresa}),pr=(Array.isArray(Rt)?Rt:[]).map(Wr=>Wr?.nome).filter(Boolean);Xt=pr.length?pr.join(", "):null}catch(Rt){console.warn("[confirmOpen] Erro ao buscar vnculos:",Rt)}if(!Xt){const Rt=Array.isArray(Je)?Je:[],ar=Array.isArray(St)?St:[];Xt=Rt.length?Rt.map(pr=>ar.find(Wr=>Wr.id===pr)?.nome).filter(Boolean).join(", "):He.length>0?He.join(", "):""}console.log("[confirmOpen] displayName calculado:",{displayName:Xt,nomesLivres:He,clienteIds:Je});const jt={...kt,comandaId:fe.id,status:"in-use",customer:Xt||null,order:[]};l(jt),i(Rt=>Rt.map(ar=>ar.id===jt.id?jt:ar)),await new Promise(Rt=>setTimeout(Rt,500));try{const Rt=await xp(t?.codigo_empresa),ar=await sc({codigoEmpresa:t?.codigo_empresa}),pr={},Wr={},Pr=Array.isArray(ar)?ar:[];await Promise.all(Pr.map(async Lt=>{try{const xn=await Zi({comandaId:Lt.id,codigoEmpresa:t?.codigo_empresa}),Ma=(Array.isArray(xn)?xn:[]).map(ma=>ma?.nome).filter(Boolean);pr[Lt.id]=Ma.length?Ma.join(", "):null,console.log("[confirmOpen] Clientes da comanda",Lt.id,":",{vincs:xn,nomes:Ma,resultado:pr[Lt.id]});const xi=await Ci({comandaId:Lt.id,codigoEmpresa:t?.codigo_empresa}),ka=(Array.isArray(xi)?xi:[]).reduce((ma,Ya)=>{const Oi=(Ya.quantidade||0)*(Ya.preco_unitario||0)-(Ya.desconto||0);return ma+Oi},0);Wr[Lt.id]=ka}catch(xn){console.warn("[confirmOpen] Erro ao buscar dados da comanda:",xn),pr[Lt.id]=null,Wr[Lt.id]=0}}));const Vr=(Rt||[]).map(Lt=>{const xn=(ar||[]).find(Ma=>Ma.mesa_id===Lt.id),Rn=xn?pr[xn.id]!==null?pr[xn.id]:Xt:null;return{id:Lt.id,name:Lt.nome||`Mesa ${Lt.numero}`,status:xn?"in-use":"available",comandaId:xn?.id||null,customer:Rn,order:[],totalHint:xn&&Wr[xn.id]||0,aberto_em:xn?.aberto_em||null}});i(Vr)}catch(Rt){console.error("[confirmOpen] Erro ao atualizar mesas:",Rt)}ee(!1),Nt(null),st(""),jr([]),It(0),ie(!1),e({title:"Mesa aberta",description:Xt?`Comanda criada para: ${Xt}`:"Comanda criada.",variant:"success"})}catch(fe){try{console.error("[confirmOpen] Falha ao abrir mesa:",fe?.message||fe,fe?.stack),console.log("[confirmOpen] Contexto debug:",{pendingTable:kt,consumidorCount:cr,selectedClientIds:er,clienteIdsType:Array.isArray(er)})}catch{}e({title:"Falha ao abrir mesa",description:fe?.message||"Tente novamente",variant:"destructive"})}};return o.jsx(ln,{open:Z,onOpenChange:F=>{ee(F),F||(Nt(null),st(""),jr([]),It(0),ie(!1))},children:o.jsxs(on,{className:"w-[95vw] max-w-md h-[560px] max-h-[75vh] flex flex-col animate-none overflow-hidden",onOpenAutoFocus:F=>F.preventDefault(),onPointerDownOutside:F=>{F.preventDefault(),F.stopPropagation()},onInteractOutside:F=>{F.preventDefault(),F.stopPropagation()},onEscapeKeyDown:F=>{F.preventDefault(),ee(!1)},onKeyDown:F=>{F.key==="Escape"&&(F.preventDefault(),F.stopPropagation(),ee(!1))},ref:X,children:[o.jsxs(nn,{className:"flex-shrink-0",children:[o.jsxs(rn,{className:"text-xl font-bold",children:["Abrir Mesa ",kt?`#${kt.number}`:""]}),o.jsx(_n,{className:"text-sm",children:"Selecione um ou mais clientes para a mesa."})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto thin-scroll min-h-0 space-y-2 py-2",ref:qe,children:[o.jsxs("div",{children:[o.jsx(Wt,{className:"text-sm font-medium mb-1.5 block",children:"Buscar cliente"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(pi,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(or,{placeholder:"Nome, telefone ou cdigo",className:"pl-8 h-9 text-sm",value:ue,ref:Me,onChange:F=>{ir.current=Date.now(),Fe(F.target.value)},onKeyDown:F=>{if(F.key==="Enter"){F.preventDefault();try{if(Array.isArray(St)&&St.length>0){const fe=Math.min(Math.max(be||0,0),St.length-1),we=St[fe];we?.id&&jr(Re=>Re.includes(we.id)?Re.filter(Je=>Je!==we.id):[...Re,we.id])}}catch{}Fe(""),setTimeout(()=>{try{_t.current?.focus()}catch{}},0)}else ir.current=Date.now()}})]}),o.jsx(oe,{type:"button",size:"icon",title:"Cadastrar cliente",className:"h-9 w-9 flex-shrink-0 bg-brand text-black hover:bg-brand/90",onClick:()=>{window.location.href="/clientes"},children:o.jsx(Ka,{className:"h-4 w-4"})})]}),o.jsxs("div",{className:"mt-1.5 text-[12px] text-text-muted flex items-center gap-2",children:[o.jsxs("span",{className:"inline-flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 rounded border border-border/70 bg-surface-2",children:""})," seleciona"]}),o.jsxs("span",{className:"inline-flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 rounded border border-border/70 bg-surface-2",children:""})," desmarca"]}),o.jsxs("span",{className:"inline-flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 rounded border border-border/70 bg-surface-2",children:"Enter"})," confirma"]}),o.jsx("span",{className:"inline-flex items-center gap-1",children:"Digite para buscar"})]})]}),o.jsx("div",{className:"min-h-[8px]",children:er.length>0&&o.jsxs("div",{className:"bg-success/10 border border-success/30 rounded-md p-2.5",children:[o.jsxs("div",{className:"text-xs font-medium text-success mb-1",children:[er.length," cliente",er.length>1?"s":""," selecionado",er.length>1?"s":""]}),o.jsx("div",{className:"text-sm text-text-primary",children:St.filter(F=>er.includes(F.id)).map(F=>F.nome).join(", ")})]})}),o.jsx("div",{className:"border rounded-md focus:outline-none focus:ring-0 focus-visible:outline-none focus-visible:ring-0",role:"listbox","aria-label":"Clientes","aria-activedescendant":St&&St.length>0&&St[be]&&St[be].id?`ot-option-${St[be].id}`:void 0,ref:_t,tabIndex:0,onKeyDown:F=>{try{if(F.key&&F.key.length===1&&!F.ctrlKey&&!F.metaKey&&!F.altKey||F.key==="Backspace"){F.preventDefault(),F.stopPropagation();let we=String(ue||"");F.key==="Backspace"?we=we.slice(0,-1):we+=F.key,Fe(we),ir.current=Date.now();try{qe.current&&(qe.current.scrollTop=0)}catch{}setTimeout(()=>{try{if(Me.current){Me.current.focus();const Re=we.length;Me.current.setSelectionRange?.(Re,Re)}}catch{}},0);return}if(["ArrowDown","ArrowUp","Home","End","ArrowRight","ArrowLeft"," "].includes(F.key)){let we=be||0;const Re=St.length;F.key==="ArrowDown"&&(we=Math.min(we+1,Re-1)),F.key==="ArrowUp"&&(we=Math.max(we-1,0)),F.key==="Home"&&(we=0),F.key==="End"&&(we=Re-1),Ge(we),setTimeout(()=>{try{We.current[we]?.scrollIntoView({block:"nearest"})}catch{}},0);const Je=St[we],He=Je?.codigo===0;if(F.key==="ArrowRight"&&Je?.id&&(He?(ie(!0),It(Et=>Et+1)):(st(""),jr(Et=>Et.includes(Je.id)?Et:[...Et,Je.id]))),F.key==="ArrowLeft"&&Je?.id)if(He){const Et=Math.max(0,cr-1);It(Et),Et===0&&ie(!1)}else jr(Et=>Et.filter(Xt=>Xt!==Je.id));F.key===" "&&Je?.id&&(st(""),jr(Et=>Et.includes(Je.id)?Et.filter(Xt=>Xt!==Je.id):[...Et,Je.id]));return}if(F.key==="Enter"){F.preventDefault();const we=Math.min(Math.max(be||0,0),St.length-1),Re=St[we];if(Date.now()-ir.current<600||document.activeElement===Me.current||ue&&ue.length>0){Re?.id&&(st(""),jr(Et=>Et.includes(Re.id)?Et.filter(Xt=>Xt!==Re.id):[...Et,Re.id])),Fe(""),setTimeout(()=>{try{_t.current?.focus(),qe.current&&(qe.current.scrollTop=0)}catch{}},0);return}if(Re?.id){const Et=er.includes(Re.id)?er:[...er,Re.id];er.includes(Re.id)||jr(Xt=>[...Xt,Re.id]),setTimeout(()=>{try{O(Et)}catch{}},0);return}setTimeout(()=>{try{O(er)}catch{}},0);return}}catch{}},children:ht?o.jsx("div",{className:"p-3 text-center text-sm text-text-muted",children:"Carregando..."}):St.length>0?o.jsx("ul",{className:"divide-y divide-border",children:St.map((F,fe)=>{const we=F.codigo===0,Re=er.includes(F.id),Je=fe===(be||0),He=we?cr:0;return o.jsxs("li",{id:`ot-option-${F.id}`,ref:Et=>{We.current[fe]=Et},role:"option","aria-selected":Je,className:Yt("p-2.5 flex items-center gap-2 cursor-pointer transition-colors outline-none focus:outline-none focus-visible:outline-none border border-transparent",we?"bg-amber-500/5 border-l-2 border-l-amber-500/40":"",Re&&!we?"bg-success/10 hover:bg-success/15":"hover:bg-surface-2",Ir&&we?"bg-amber-500/10":"",Je?"bg-brand/10":""),onClick:()=>{we?Ir||(ie(!0),It(1)):(st(""),jr(Et=>Et.includes(F.id)?Et.filter(Xt=>Xt!==F.id):[...Et,F.id]))},onDoubleClick:()=>{if(!we){const Et=er.includes(F.id)?er:[...er,F.id];jr(Et),setTimeout(()=>{try{O(Et)}catch{}},0)}},onMouseEnter:()=>{Date.now()-(gt.current||0)>300&&Ge(fe)},tabIndex:-1,children:[o.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[!we&&o.jsx("span",{className:Yt("w-2 h-2 rounded-full flex-shrink-0",Re?"bg-success":Je?"bg-brand":"bg-border")}),o.jsxs("div",{className:"font-medium text-sm truncate",children:[F.codigo!=null&&F.codigo!==0?`${F.codigo} - `:"",F.nome,we&&o.jsx("span",{className:"ml-2 text-xs text-amber-600",children:"Cliente Padro"})]})]}),we?Ir?o.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[o.jsx(oe,{type:"button",size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-red-500/10",onClick:Et=>{Et.stopPropagation();const Xt=Math.max(0,cr-1);It(Xt),Xt===0&&ie(!1)},children:o.jsx(gv,{className:"h-4 w-4"})}),o.jsx("div",{className:"w-8 h-7 flex items-center justify-center bg-surface-2 rounded text-sm font-medium",children:He}),o.jsx(oe,{type:"button",size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-500/10",onClick:Et=>{Et.stopPropagation(),It(Xt=>Xt+1)},children:o.jsx(Ka,{className:"h-4 w-4"})})]}):null:o.jsx("div",{className:"ml-2 flex-shrink-0",children:Re?o.jsx(Ai,{size:18,className:"text-success"}):o.jsx("div",{className:"w-[18px] h-[18px] rounded-full border-2 border-border"})})]},F.id)})}):o.jsx("div",{className:"p-4 text-center text-sm text-text-muted",children:"Nenhum cliente encontrado"})})]}),o.jsxs(Un,{className:"flex-shrink-0 pt-3",children:[o.jsx(oe,{type:"button",variant:"outline",onClick:()=>{ee(!1),Nt(null),st(""),jr([])},children:"Cancelar"}),o.jsx(oe,{onClick:()=>O(),disabled:!kt,children:"Confirmar Abertura"})]})]})})},Sa=()=>{const[ue,Fe]=p.useState("");return p.useEffect(()=>{Tt.current&&Fe(Tt.current)},[]),o.jsxs(o.Fragment,{children:[o.jsxs(Kc,{children:[o.jsx(Xc,{children:"Abrir Caixa"}),o.jsx(Jc,{children:"Insira o valor inicial (suprimento) para abrir o caixa."})]}),o.jsxs("div",{className:"py-4",children:[o.jsx(Wt,{htmlFor:"initial-value",children:"Valor Inicial"}),o.jsxs("div",{className:"relative mt-2",children:[o.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted",children:"R$"}),o.jsx(or,{id:"initial-value",type:"text",inputMode:"numeric",pattern:"[0-9.,]*",autoComplete:"off",autoCorrect:"off",autoCapitalize:"none",spellCheck:!1,name:"cash-open-initial",placeholder:"0,00",className:"pl-9 font-semibold",value:ue,onChange:ht=>{const At=(ht.target.value||"").replace(/\D/g,""),St=At?Number(At)/100:0,xr=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(St);Fe(xr),Tt.current=xr},onKeyDown:ht=>{ht.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(ht.key)&&(/^[0-9]$/.test(ht.key)||ht.preventDefault())},onBeforeInput:ht=>{const At=ht.data??"";At&&/\D/.test(At)&&ht.preventDefault()},onMouseDown:ht=>ht.stopPropagation()})]})]}),o.jsxs(Yc,{children:[o.jsx(Qc,{onClick:()=>Ae(!1),children:"Cancelar"}),o.jsx(Rd,{onClick:async()=>{if(!Se){Ne(!0);try{const ht=String(ue).replace(/\./g,"").replace(",","."),At=Number(ht)||0;try{localStorage.setItem("cash:opening",String(Date.now()))}catch{}await uf({saldoInicial:At,codigoEmpresa:t?.codigo_empresa}),await Fr(),await Vt({showToast:!1}),Ae(!1),e({title:"Caixa aberto com sucesso!",variant:"success"}),Tt.current="",Fe("")}catch(ht){e({title:"Falha ao abrir caixa",description:ht?.message||"Tente novamente",variant:"destructive"})}finally{try{localStorage.removeItem("cash:opening")}catch{}Ne(!1)}}},children:"Confirmar Abertura"})]})]})},ba=()=>o.jsxs(Md,{open:$e,onOpenChange:Ae,children:[o.jsx(vp,{asChild:!0,children:o.jsxs(oe,{variant:"success",size:"sm",disabled:c||Se,onClick:()=>Ae(!0),className:"px-3",children:[o.jsx(sH,{className:"h-4 w-4"}),o.jsx("span",{className:"ml-2 md:hidden",children:"Abrir"}),o.jsx("span",{className:"ml-2 hidden md:inline",children:"Abrir Caixa"}),o.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-emerald-700 border border-emerald-800 rounded shadow-sm",children:"F10"})]})}),o.jsx(Gc,{className:"sm:max-w-[425px] animate-none",onKeyDown:ue=>ue.stopPropagation(),onKeyDownCapture:ue=>ue.stopPropagation(),onEscapeKeyDown:ue=>ue.preventDefault(),onPointerDownOutside:ue=>{ue.preventDefault(),ue.stopPropagation()},onInteractOutside:ue=>{ue.preventDefault(),ue.stopPropagation()},children:o.jsx(Sa,{})})]}),Mo=()=>{const[ue,Fe]=p.useState({loading:!1,saldoInicial:0,resumo:null}),[ht,At]=p.useState(!1),[St,xr]=p.useState(!1),[er,jr]=p.useState(!1),[cr,It]=p.useState(!1),[Ir,ie]=p.useState(""),be=async()=>{try{Fe({loading:!0,saldoInicial:0,resumo:null});const qe=await km({codigoEmpresa:t?.codigo_empresa}),X=await g1({codigoEmpresa:t?.codigo_empresa});Fe({loading:!1,saldoInicial:Number(qe?.saldo_inicial||0),resumo:X||{totalPorFinalizadora:{}}})}catch{Fe({loading:!1,saldoInicial:0,resumo:{totalPorFinalizadora:{}}})}},Ge=ue?.resumo?.totalPorFinalizadora||{},We=Object.values(Ge).reduce((qe,X)=>qe+Number(X||0),0),_t=Number(ue.saldoInicial||0)+We;return o.jsxs(o.Fragment,{children:[o.jsxs(Md,{open:ht,onOpenChange:qe=>{At(qe),qe&&be()},children:[o.jsx(vp,{asChild:!0,children:o.jsxs(oe,{variant:"destructive",size:"sm",disabled:!c,onClick:()=>At(!0),className:"px-3",children:[o.jsx(sh,{className:"h-4 w-4"}),o.jsx("span",{className:"ml-2 md:hidden",children:"Fechar"}),o.jsx("span",{className:"ml-2 hidden md:inline",children:"Fechar Caixa"})]})}),o.jsxs(Gc,{className:"sm:max-w-[425px] w-[92vw] max-h-[85vh] animate-none",onOpenAutoFocus:qe=>qe.preventDefault(),onKeyDown:qe=>qe.stopPropagation(),onKeyDownCapture:qe=>qe.stopPropagation(),onPointerDownOutside:qe=>{qe.preventDefault(),qe.stopPropagation()},onInteractOutside:qe=>{qe.preventDefault(),qe.stopPropagation()},children:[o.jsxs(Kc,{children:[o.jsx(Xc,{children:"Fechar Caixa"}),o.jsx(Jc,{children:"Confira os valores e confirme o fechamento do caixa. Esta ao  irreversvel."})]}),er&&o.jsxs("div",{className:"md:hidden mb-2 text-[12px] text-warning bg-warning/10 border border-warning/30 rounded px-2 py-1 flex items-center gap-1",children:[o.jsx(hc,{className:"h-3.5 w-3.5"}),"Existem comandas abertas. Finalize-as antes de fechar o caixa."]}),ue.loading?o.jsx("div",{className:"py-4 text-text-muted",children:"Carregando resumo"}):o.jsxs("div",{className:"py-4 space-y-2",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Valor Inicial:"})," ",o.jsxs("span",{className:"font-mono",children:["R$ ",Number(ue.saldoInicial||0).toFixed(2)]})]}),Object.keys(Ge).length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Sem pagamentos nesta sesso."}):Object.entries(Ge).map(([qe,X])=>o.jsxs("div",{className:"flex justify-between",children:[o.jsxs("span",{className:"text-text-secondary",children:[String(qe),":"]})," ",o.jsxs("span",{className:"font-mono",children:["R$ ",Number(X||0).toFixed(2)]})]},qe)),o.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[o.jsx("span",{className:"text-text-primary",children:"Total em Caixa:"})," ",o.jsxs("span",{className:"font-mono text-success",children:["R$ ",Number(_t||0).toFixed(2)]})]})]}),o.jsxs(Yc,{children:[o.jsx(Qc,{onClick:()=>At(!1),disabled:cr,children:"Cancelar"}),o.jsx(Rd,{onClick:()=>{xr(!0)},disabled:cr,children:"Continuar"})]})]})]}),o.jsx(Md,{open:St,onOpenChange:qe=>{cr||xr(qe)},children:o.jsxs(Gc,{className:"sm:max-w-[425px] w-[92vw] max-h-[85vh] animate-none",onOpenAutoFocus:qe=>qe.preventDefault(),onEscapeKeyDown:qe=>{cr||qe.preventDefault()},onKeyDown:qe=>qe.stopPropagation(),onKeyDownCapture:qe=>qe.stopPropagation(),onPointerDownOutside:qe=>{cr||(qe.preventDefault(),qe.stopPropagation())},onInteractOutside:qe=>{cr||(qe.preventDefault(),qe.stopPropagation())},children:[o.jsxs(Kc,{children:[o.jsx(Xc,{children:"Confirmar Fechamento do Caixa"}),o.jsx(Jc,{children:"Informe o saldo final para finalizar o fechamento."})]}),o.jsxs("div",{className:"py-4",children:[o.jsx(Wt,{htmlFor:"valor-contado-final",className:"text-sm font-medium text-text-primary mb-2 block",children:"Saldo Final (opcional)"}),o.jsx("input",{id:"valor-contado-final",type:"text",placeholder:"R$ 0,00",value:Ir,onChange:qe=>{let X=qe.target.value.replace(/\D/g,"");X.length>0&&(X=(Number(X)/100).toFixed(2),X=X.replace(".",","),X="R$ "+X),ie(X)},className:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-ring"})]}),o.jsxs(Yc,{children:[o.jsx(Qc,{onClick:()=>{xr(!1)},disabled:cr,children:"Voltar"}),o.jsx(Rd,{onClick:async()=>{try{if(cr)return;It(!0);const qe=Number(ue.saldoInicial||0)+We,X=Ir?Number(Ir.replace(/[^0-9,]/g,"").replace(",",".")):null;await zte({saldoFinal:qe,valorFinalDinheiro:X,codigoEmpresa:t?.codigo_empresa}),d(!1),typeof requestAnimationFrame=="function"?requestAnimationFrame(()=>{xr(!1),At(!1),ie(""),e({title:"Caixa fechado!",description:`Saldo final: R$ ${qe.toFixed(2)}`,duration:4e3})}):(xr(!1),At(!1),ie(""),e({title:"Caixa fechado!",description:`Saldo final: R$ ${qe.toFixed(2)}`,duration:4e3})),setTimeout(async()=>{try{await km({codigoEmpresa:t?.codigo_empresa})}catch{}},0)}catch(qe){console.error(qe);const X=qe?.message||"Tente novamente";if(nt){rr(X.includes("Existem")?X:`Falha ao fechar caixa: ${X}`);try{xr(!1),At(!1)}catch{}typeof requestAnimationFrame=="function"?requestAnimationFrame(()=>{qt(!0)}):qt(!0),setTimeout(()=>qt(!1),2600)}else e({title:"Falha ao fechar caixa",description:X,variant:"destructive"})}finally{It(!1)}},children:"Confirmar Fechamento"})]})]})})]})},vi=()=>{const[ue,Fe]=p.useState(""),[ht,At]=p.useState([]),[St,xr]=p.useState([]),[er,jr]=p.useState(!1),[cr,It]=p.useState(new Set),Ir=p.useRef([]),ie=p.useRef(!1),be=p.useRef(!1),[Ge,We]=p.useState(0);p.useRef([]);const _t=p.useRef(null);p.useRef(0);const[qe,X]=p.useState(!1),[Me,gt]=p.useState(null),[ir,Dr]=p.useState(null),[O,F]=p.useState("");p.useEffect(()=>{let jt=!0;const Rt=async()=>{if(!(!de||!s?.comandaId)&&!(ie.current&&ue===""))try{jr(!0);const ar=await Zi({comandaId:s.comandaId,codigoEmpresa:t?.codigo_empresa});if(!jt)return;console.log("[ManageClientsDialog] Clientes da comanda:",ar);const pr=(ar||[]).map(Vr=>({id:Vr.id,cliente_id:Vr.cliente_id,nome:Vr.nome||"",tipo:Vr.tipo||(Vr.cliente_id?"cadastrado":"livre")}));console.log("[ManageClientsDialog] Linked mapeado:",pr),be.current||(xr(pr),Ir.current=JSON.parse(JSON.stringify(pr)),It(new Set));const Wr=await _j({searchTerm:ue,limit:50});if(!jt)return;const Pr=(Wr||[]).slice().sort((Vr,Lt)=>Number(Vr?.codigo||0)-Number(Lt?.codigo||0));At(Pr),We(0),ie.current=!0}catch(ar){console.error("Erro ao carregar clientes:",ar)}finally{jt&&jr(!1)}};return de?(Rt(),()=>{jt=!1}):(ie.current=!1,Fe(""),()=>{jt=!1})},[de,s?.comandaId]),p.useEffect(()=>{be.current=cr.size>0},[cr]),p.useEffect(()=>{de&&Array.isArray(ht)&&ht.length>0&&(We(0),setTimeout(()=>{try{const jt=document.querySelector('[role="dialog"]');if(jt){const Rt=jt.querySelector(".overflow-y-auto");Rt&&(Rt.scrollTop=0)}}catch{}},0))},[de,ht.length]);const fe=()=>{s?.comandaId&&(async()=>{try{jr(!0);const{data:jt,error:Rt}=await ve.from("comanda_clientes").insert({comanda_id:s.comandaId,nome_livre:"Consumidor",codigo_empresa:t?.codigo_empresa}).select("id, cliente_id, nome_livre").single();if(Rt)throw Rt;const ar={id:jt.id,cliente_id:jt.cliente_id,nome:jt.nome_livre||"Consumidor",tipo:"livre"};xr(pr=>[...pr,ar]),Dr(ar.id),F(ar.nome||"Consumidor")}catch(jt){console.error("[ManageClientsDialog] Erro ao adicionar consumidor:",jt),e({title:"Falha ao adicionar consumidor",description:jt?.message||"Tente novamente",variant:"destructive"})}finally{jr(!1)}})()},we=jt=>{if(!s?.comandaId)return;const Rt=ht.find(ar=>ar.id===jt);Rt&&(async()=>{try{jr(!0);const{data:ar,error:pr}=await ve.from("comanda_clientes").insert({comanda_id:s.comandaId,cliente_id:jt,codigo_empresa:t?.codigo_empresa}).select("id, cliente_id").single();if(pr)throw pr;const Wr={id:ar.id,cliente_id:ar.cliente_id,nome:Rt.nome,tipo:"cadastrado"};xr(Pr=>[...Pr,Wr]),X(!1)}catch(ar){console.error("[ManageClientsDialog] Erro ao adicionar cliente:",ar),e({title:"Falha ao adicionar cliente",description:ar?.message||"Tente novamente",variant:"destructive"})}finally{jr(!1)}})()},Re=(jt,Rt)=>{if(!s?.comandaId)return;const ar=ht.find(Wr=>Wr.id===Rt);!ar||!St.find(Wr=>Wr.id===jt)||(async()=>{try{jr(!0);const{error:Wr}=await ve.from("comanda_clientes").update({cliente_id:Rt}).eq("id",jt).eq("codigo_empresa",t?.codigo_empresa);if(Wr)throw Wr;xr(Pr=>Pr.map(Vr=>Vr.id===jt?{...Vr,cliente_id:Rt,nome:ar.nome,tipo:"cadastrado"}:Vr)),gt(null),X(!1)}catch(Wr){console.error("[ManageClientsDialog] Erro ao trocar cliente:",Wr),e({title:"Falha ao trocar cliente",description:Wr?.message||"Tente novamente",variant:"destructive"})}finally{jr(!1)}})()},Je=jt=>{const Rt=St.find(ar=>ar.id===jt);Rt&&(xr(ar=>ar.filter(pr=>pr.id!==jt)),!(!s?.comandaId||String(jt).startsWith("temp-"))&&(async()=>{try{jr(!0);const{error:ar}=await ve.from("comanda_clientes").delete().eq("id",jt).eq("codigo_empresa",t?.codigo_empresa);if(ar)throw ar}catch(ar){console.error("[ManageClientsDialog] Erro ao remover cliente:",ar),e({title:"Falha ao remover cliente",description:ar?.message||"Tente novamente",variant:"destructive"}),xr(pr=>[...pr,Rt])}finally{jr(!1)}})())},He=jt=>{const Rt=St.find(ar=>ar.id===jt);Rt&&(Dr(jt),F(Rt.nome||"Consumidor"))},Et=()=>{if(!ir||!s?.comandaId)return;const jt=O.trim()||"Consumidor";(async()=>{try{jr(!0);const{error:Rt}=await ve.from("comanda_clientes").update({nome_livre:jt}).eq("id",ir).eq("codigo_empresa",t?.codigo_empresa);if(Rt)throw Rt;xr(ar=>ar.map(pr=>pr.id===ir?{...pr,nome:jt}:pr))}catch(Rt){console.error("[ManageClientsDialog] Erro ao salvar consumidor:",Rt),e({title:"Falha ao salvar cliente",description:Rt?.message||"Tente novamente",variant:"destructive"})}finally{Dr(null),F(""),jr(!1)}})()},Xt=async()=>{if(!s?.comandaId){xe(!1);return}if(cr.size===0){xe(!1);return}jr(!0);try{const jt=Ir.current.map(Pr=>Pr.id),Rt=St.map(Pr=>Pr.id),ar=Ir.current.filter(Pr=>!Rt.includes(Pr.id));for(const Pr of ar)if(!String(Pr.id).startsWith("temp-")){const{error:Vr}=await ve.from("comanda_clientes").delete().eq("id",Pr.id).eq("codigo_empresa",t?.codigo_empresa);if(Vr)throw console.error("[confirmChanges] Erro ao remover:",Vr),Vr}const pr=St.filter(Pr=>String(Pr.id).startsWith("temp-")),Wr=St.filter(Pr=>{if(String(Pr.id).startsWith("temp-")||Pr.tipo!=="livre")return!1;const Vr=Ir.current.find(Lt=>Lt.id===Pr.id);return Vr&&Vr.nome!==Pr.nome});if(pr.length>0){const Pr=pr.filter(Lt=>Lt.tipo==="cadastrado").map(Lt=>Lt.cliente_id),Vr=pr.filter(Lt=>Lt.tipo==="livre").map(Lt=>Lt.nome);console.log("[confirmChanges] Adicionando:",{clienteIds:Pr,nomesLivres:Vr}),await Wv({comandaId:s.comandaId,clienteIds:Pr,nomesLivres:Vr,codigoEmpresa:t?.codigo_empresa})}for(const Pr of Wr){const{error:Vr}=await ve.from("comanda_clientes").update({nome_livre:Pr.nome}).eq("id",Pr.id).eq("codigo_empresa",t?.codigo_empresa);if(Vr)throw console.error("[confirmChanges] Erro ao atualizar:",Vr),Vr}console.log("[confirmChanges] Operaes concludas, atualizando mesa"),await Br(s),await Vt({showToast:!1}),e({title:"Clientes atualizados",variant:"success"})}catch(jt){console.error("[confirmChanges] Erro:",jt),e({title:"Falha ao atualizar clientes",description:jt?.message||"Tente novamente",variant:"destructive"})}finally{jr(!1)}};return o.jsxs(ln,{open:de,onOpenChange:xe,children:[o.jsxs(on,{className:"sm:max-w-[480px] w-[92vw] max-h-[85vh] h-[85vh] animate-none flex flex-col overflow-hidden",onOpenAutoFocus:jt=>jt.preventDefault(),onPointerDownOutside:jt=>{jt.preventDefault(),jt.stopPropagation()},onInteractOutside:jt=>{jt.preventDefault(),jt.stopPropagation()},onEscapeKeyDown:jt=>jt.preventDefault(),children:[o.jsxs(nn,{className:"flex-shrink-0",children:[o.jsx(rn,{children:"Gerenciar Clientes da Mesa"}),o.jsx(_n,{children:"Gerencie os clientes vinculados a esta mesa."})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0 space-y-4 thin-scroll",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"text-sm font-medium text-text-primary",children:["Clientes vinculados (",St.length,"):"]}),er&&St.length===0?o.jsx("div",{className:"p-4 text-center text-sm text-text-muted border border-dashed rounded-md",children:"Carregando clientes da mesa..."}):St.length===0?o.jsx("div",{className:"p-4 text-center text-sm text-text-muted border border-dashed rounded-md",children:"Nenhum cliente vinculado ainda"}):o.jsx("div",{className:"space-y-2",children:St.map(jt=>{const Rt=jt.tipo==="livre",ar=ir===jt.id;return o.jsx("div",{className:Yt("flex items-center gap-2 p-2 rounded-md border",Rt?"bg-amber-500/10 border-amber-500/30":"bg-surface-2 border-border"),children:ar?o.jsxs(o.Fragment,{children:[o.jsx(or,{value:O,onChange:pr=>F(pr.target.value),onKeyDown:pr=>{pr.key==="Enter"&&Et(),pr.key==="Escape"&&(Dr(null),F("")),pr.stopPropagation()},className:"flex-1 h-8",autoFocus:!0}),o.jsx(oe,{size:"sm",onClick:Et,className:"h-8 px-2",children:o.jsx(Ai,{className:"h-4 w-4"})})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:Yt("flex-1 text-sm truncate p-1 rounded",Rt?"cursor-pointer hover:bg-amber-500/10":"cursor-default"),onClick:()=>Rt&&He(jt.id),title:Rt?"Clique para editar":"",children:[o.jsx("span",{children:jt.nome}),Rt&&o.jsx("span",{className:"ml-2 text-[11px] px-1.5 py-0.5 rounded bg-amber-500/15 text-amber-600 border border-amber-500/30 align-middle",children:"Cliente Padro"})]}),!Rt&&o.jsx(oe,{size:"sm",variant:"ghost",onClick:()=>{gt(jt.id),X(!0)},className:"h-7 px-2",title:"Trocar cliente",children:o.jsx(El,{className:"h-4 w-4"})}),o.jsx(oe,{size:"sm",variant:"ghost",onClick:()=>Je(jt.id),className:"h-7 px-2 text-destructive hover:text-destructive",children:o.jsx(Ml,{className:"h-4 w-4"})})]})},jt.id)})})]}),o.jsxs(oe,{onClick:()=>{gt(null),X(!0)},className:"w-full",size:"sm",children:[o.jsx(Ka,{className:"h-4 w-4 mr-2"}),"Adicionar Cliente"]})]}),o.jsxs(Un,{children:[o.jsx(oe,{variant:"outline",onClick:()=>xe(!1),disabled:er,children:"Cancelar"}),o.jsx(oe,{onClick:Xt,disabled:er,children:er?"Salvando...":`Confirmar ${cr.size>0?`(${cr.size} alteraes)`:""}`})]})]}),o.jsx(ln,{open:qe,onOpenChange:X,children:o.jsxs(on,{className:"sm:max-w-[500px] max-h-[80vh] flex flex-col",children:[o.jsxs(nn,{children:[o.jsx(rn,{children:Me?"Trocar Cliente":"Adicionar Cliente"}),o.jsx(_n,{children:"Selecione um cliente da lista"})]}),o.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col gap-3",children:[o.jsxs("div",{className:"relative",children:[o.jsx(pi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(or,{placeholder:"Buscar cliente...",className:"pl-9",value:ue,onChange:jt=>Fe(jt.target.value)})]}),o.jsx("div",{className:"flex-1 border rounded-md overflow-y-auto thin-scroll",role:"listbox","aria-label":"Clientes disponveis",ref:_t,tabIndex:0,children:er?o.jsx("div",{className:"p-4 text-center text-text-muted",children:"Carregando..."}):ht.length===0?o.jsx("div",{className:"p-4 text-center text-text-muted",children:"Nenhum cliente encontrado"}):o.jsx("ul",{className:"divide-y divide-border",children:ht.map(jt=>{const Rt=jt.codigo===0,ar=St.some(pr=>pr.cliente_id===jt.id&&pr.tipo==="cadastrado");return o.jsxs("li",{className:Yt("p-3 cursor-pointer transition-colors flex items-center justify-between",Rt?"bg-amber-500/5 hover:bg-amber-500/10":"hover:bg-surface-2"),onClick:()=>{Rt?Me?(gt(null),X(!1)):(fe(),X(!1)):Me?Re(Me,jt.id):we(jt.id)},children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"font-medium truncate flex items-center gap-2",children:[Rt?"Cliente Consumidor":`${jt?.codigo?`${jt.codigo} - `:""}${jt?.nome||""}`,Rt&&o.jsx("span",{className:"text-[11px] px-1.5 py-0.5 rounded bg-amber-500/15 text-amber-600 border border-amber-500/30",children:"Cliente Padro"})]}),!Rt&&jt.telefone&&o.jsx("div",{className:"text-xs text-text-muted",children:jt.telefone}),Rt&&o.jsx("div",{className:"text-xs text-text-muted",children:"Clique para adicionar consumidor"})]}),ar&&!Rt&&o.jsx(Ai,{className:"h-5 w-5 text-success ml-2 flex-shrink-0"})]},jt.id)})})})]}),o.jsx(Un,{children:o.jsx(oe,{variant:"outline",onClick:()=>X(!1),children:"Cancelar"})})]})})]})},lo=()=>{const ue=ht=>ht==="available"?"bg-success/10 border-success/30 text-success":ht==="in-use"?"bg-warning/10 border-warning/30 text-warning":ht==="awaiting-payment"?"bg-info/10 border-info/30 text-info":"bg-surface-2 border-border text-text-secondary",Fe=ht=>ht==="available"?"Livre":ht==="in-use"?"Ocupada":ht==="awaiting-payment"?"Aguardando":"Desconhecido";return o.jsx("div",{className:"md:hidden space-y-2",children:a.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[o.jsx("div",{className:"text-text-muted mb-4",children:o.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Nenhuma mesa encontrada"}),o.jsx("p",{className:"text-text-muted mb-4",children:"Crie sua primeira mesa para comear"})]}):a.map(ht=>{const At=dr(ht.order||[],ht),St=ht.totalHint>0?ht.totalHint:At;return o.jsx("div",{onClick:async()=>{if(!c){e({title:"Caixa Fechado",description:"Abra o caixa antes de gerenciar as mesas.",variant:"warning"});return}await wr(ht),ht.status!=="available"&&Qe(!0)},className:Yt("p-3 rounded-lg border-2 bg-surface transition-all active:scale-[0.98]",ue(ht.status),s?.id===ht.id&&"ring-2 ring-brand/60",c?"cursor-pointer":"cursor-not-allowed opacity-60"),children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[o.jsx("h3",{className:"font-bold text-base truncate",children:ht.name||`Mesa ${ht.number}`}),ht.status==="available"&&ht.id===ke&&o.jsx("kbd",{className:"hidden md:inline px-2 py-1 text-xs font-bold font-mono text-gray-400 bg-transparent border border-gray-300/50 rounded flex-shrink-0",children:"F1"})]}),o.jsx("span",{className:Yt("text-xs px-2 py-0.5 rounded-full border font-medium flex-shrink-0",ue(ht.status)),children:Fe(ht.status)})]}),ht.status==="in-use"||ht.status==="awaiting-payment"?o.jsxs("div",{className:"space-y-0.5",children:[o.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-text-secondary",children:[o.jsx(cl,{className:"w-3.5 h-3.5 flex-shrink-0"}),o.jsx("span",{className:"truncate",children:Ot(ht.customer)||"Sem cliente"})]}),o.jsxs("div",{className:"flex items-center gap-1.5 text-sm font-semibold text-text-primary",children:[o.jsx(Ui,{className:"w-3.5 h-3.5 flex-shrink-0"}),o.jsxs("span",{children:["R$ ",St.toFixed(2)]})]})]}):o.jsx("div",{className:"text-xs text-text-muted",children:"Mesa disponvel"})]}),o.jsx(Kx,{className:"w-5 h-5 text-text-muted flex-shrink-0 ml-2"})]})},ht.id)})})},zl=()=>s?o.jsx(ln,{open:Ue,modal:!U,onOpenChange:ue=>{!ue&&U||(Qe(ue),ue||Xr(null),ue&&k("tables"))},children:o.jsxs(on,{className:"w-[95vw] sm:max-w-2xl max-h-[85vh] flex flex-col p-0 gap-0 animate-none",children:[o.jsxs("div",{className:"p-4 border-b border-border bg-surface-2",children:[o.jsx("div",{className:"flex items-center justify-between mb-2",children:o.jsx(rn,{className:"text-xl font-bold",children:s.name||`Mesa ${s.number}`})}),o.jsx(_n,{className:"sr-only",children:"Visualizao da comanda e produtos da mesa selecionada"}),(s.status==="in-use"||s.status==="awaiting-payment")&&o.jsxs("div",{className:"flex items-center gap-4 text-sm text-text-secondary",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(cl,{className:"w-4 h-4"}),o.jsx("span",{children:Ot(s.customer)||"Sem cliente"})]}),s.order&&s.order.length>0&&o.jsxs("div",{className:"flex items-center gap-1 font-semibold text-text-primary",children:[o.jsx(Ui,{className:"w-4 h-4"}),o.jsxs("span",{children:["R$ ",(s.totalHint>0?s.totalHint:dr(s.order||[])).toFixed(2)]})]})]})]}),o.jsxs(Fd,{value:et,onValueChange:ue=>{pt(ue),Xr(null),ue==="products"&&s&&(w(!0),pt("order"))},className:"flex flex-col flex-1 min-h-0",children:[o.jsxs(ad,{className:"grid w-full grid-cols-3 m-2 rounded-lg",children:[o.jsx(wa,{value:"order",className:"text-sm flex items-center justify-center gap-2",children:"Comanda"}),o.jsx(wa,{value:"details",className:"text-sm flex items-center justify-center gap-2",children:"Detalhes"}),o.jsxs(wa,{value:"products",className:"text-sm flex items-center justify-center gap-2",onClick:()=>{s&&w(!0)},children:["Produtos",o.jsx("kbd",{className:"hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"P"})]})]}),o.jsx(Wi,{value:"order",className:"flex-1 overflow-hidden min-h-0 m-0",onKeyDown:ue=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(ue.key)&&k("tables")},children:o.jsx(Xe,{table:s})}),o.jsx(Wi,{value:"details",className:"flex-1 overflow-hidden min-h-0 m-0",children:o.jsx(Ye,{table:s})})]})]})}):null,yl=()=>{const ue=D,Fe=ue&&Qt.get(ue.id)||0,ht=ue?Number(ue.salePrice??ue.price??0):0,At=St=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(St||0));return o.jsx(ln,{open:U,onOpenChange:St=>{z(St),St||B(null)},children:o.jsxs(on,{overlayClassName:"z-[70]",className:"sm:max-w-[420px] w-[92vw] max-h-[85vh] flex flex-col animate-none z-[71]",onOpenAutoFocus:St=>{},onKeyDown:St=>St.stopPropagation(),children:[o.jsxs(nn,{children:[o.jsx(rn,{className:"text-xl font-bold break-words",title:ue?.name||"",children:ue?.name||"Produto"}),o.jsx(_n,{children:"Detalhes do produto e aes rpidas."})]}),ue?o.jsxs("div",{className:"space-y-3 overflow-y-auto pr-1",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Preo"}),o.jsx("span",{className:"text-sm font-semibold",children:At(ht)})]}),ue.category?o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Categoria"}),o.jsx("span",{className:"text-sm font-medium",children:ue.category})]}):null,o.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[typeof ue.stock<"u"&&o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("div",{className:"text-xs text-text-secondary",children:"Estoque"}),o.jsx("div",{className:"text-base font-semibold",children:ue.stock})]}),typeof ue.minStock<"u"&&o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("div",{className:"text-xs text-text-secondary",children:"Mnimo"}),o.jsx("div",{className:"text-base font-semibold",children:ue.minStock})]}),o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("div",{className:"text-xs text-text-secondary",children:"Na Comanda"}),o.jsxs("div",{className:"text-base font-semibold",children:["x",Fe]})]})]})]}):null,o.jsxs(Un,{className:"flex items-center justify-between gap-2",children:[o.jsxs(oe,{variant:"ghost",size:"sm",className:"mr-auto inline-flex items-center gap-1",onClick:()=>{ue&&n("/produtos",{state:{productId:ue.id,productName:ue.name}})},children:[o.jsx(ns,{className:"w-4 h-4"}),o.jsx("span",{children:"Info"})]}),o.jsx(oe,{variant:"outline",onClick:()=>{z(!1),B(null)},children:"Fechar"}),o.jsx(oe,{onClick:async()=>{ue&&(await Ze(ue),z(!1),B(null))},children:"Adicionar"})]})]})})};return o.jsxs(o.Fragment,{children:[o.jsx(yl,{}),o.jsx(an,{}),o.jsxs("div",{className:"h-full flex flex-col",children:[o.jsx("div",{className:"md:hidden mb-2 w-full",children:o.jsx(Fd,{value:"mesas",onValueChange:ue=>{ue==="mesas"&&n("/vendas"),ue==="balcao"&&n("/balcao"),ue==="historico"&&n("/historico")},children:o.jsxs(ad,{className:"grid w-full grid-cols-3",children:[o.jsx(wa,{value:"mesas",className:"text-xs",title:"Pressione B para alternar",children:"Mesas"}),o.jsx(wa,{value:"balcao",className:"text-xs",title:"Pressione B para alternar",children:"Balco"}),o.jsx(wa,{value:"historico",className:"text-xs",title:"Pressione H para ir ao histrico",children:"Histrico"})]})})}),o.jsxs("div",{className:"flex items-center justify-between mb-2 md:mb-6 gap-2 md:gap-4",children:[o.jsx("div",{className:"hidden md:flex items-center gap-2 md:gap-3",children:o.jsx(Fd,{value:"mesas",onValueChange:ue=>{ue==="mesas"&&n("/vendas"),ue==="balcao"&&n("/balcao"),ue==="historico"&&n("/historico")},children:o.jsxs(ad,{className:"inline-flex",children:[o.jsx(wa,{value:"mesas",className:"text-sm",title:"Pressione B para alternar",children:"Mesas"}),o.jsx(wa,{value:"balcao",className:"text-sm",title:"Pressione B para alternar",children:"Balco"}),o.jsx(wa,{value:"historico",className:"text-sm",title:"Pressione H para ir ao histrico",children:"Histrico"})]})})}),o.jsxs("div",{className:"flex items-center gap-1.5 md:gap-3 flex-shrink-0",children:[o.jsx(ba,{}),o.jsx(Mo,{}),o.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>g(!0),className:"px-3",children:[o.jsx(ZW,{className:"h-4 w-4"}),o.jsx("span",{className:"ml-2 md:hidden",children:"Detalhes"}),o.jsx("span",{className:"ml-2 hidden md:inline",children:"Detalhes do Caixa"}),o.jsx("kbd",{className:"ml-2 hidden md:inline px-2 py-1 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"F11"})]}),o.jsx("div",{className:"hidden md:block w-px h-6 bg-border mx-1"}),o.jsxs(oe,{onClick:()=>Be(!0),className:"hidden md:flex",size:"sm",children:[o.jsx(Ka,{className:"mr-2 h-4 w-4"})," Nova Mesa",o.jsx("kbd",{className:"ml-2 px-2 py-1 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"F1"})]})]})]}),!c&&u>0&&o.jsxs("div",{className:"md:hidden mb-3 text-[11px] text-warning flex items-center gap-2",children:[o.jsx(hc,{className:"h-3 w-3"}),"H comandas abertas, mas o caixa parece fechado.",o.jsx(oe,{size:"sm",variant:"outline",className:"h-6 px-2 text-[11px]",onClick:()=>Ae(!0),children:"Reabrir sesso"})]}),o.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 overflow-visible min-h-0",children:[o.jsxs("div",{className:"lg:col-span-2 bg-surface rounded-lg border border-border p-4 md:p-6 overflow-y-auto thin-scroll min-h-0",tabIndex:0,onKeyDown:ue=>{P==="tables"&&["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(ue.key)&&ue.preventDefault()},onClick:ue=>{ue.stopPropagation(),ue.preventDefault(),k("tables"),!s&&a.length>0&&l(a[0]),ue.currentTarget.focus()},onFocus:()=>{k("tables"),!s&&a.length>0&&l(a[0])},style:{outline:P==="tables"?"2px solid rgba(148, 163, 184, 0.4)":"none",outlineOffset:"-2px",transition:"outline 0.15s ease"},children:[o.jsxs("div",{className:"flex items-center justify-between mb-4 gap-4",children:[o.jsx("h2",{className:"text-xl font-bold",children:"Mapa de Mesas"}),o.jsxs("div",{className:"hidden md:flex items-center gap-2 text-xs text-text-muted flex-shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:""}),o.jsx("span",{children:"Navegar"})]}),o.jsx("div",{className:"w-px h-3 bg-border"}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("kbd",{className:"px-1.5 py-0.5 text-xs font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"Enter"}),o.jsx("span",{children:"Selecionar"})]})]}),o.jsx(oe,{type:"button",className:"md:hidden h-9 w-9 p-0 bg-amber-400 text-black hover:bg-amber-300 flex-shrink-0",size:"icon",title:"Nova Mesa",onClick:()=>Be(!0),children:o.jsx(Ka,{className:"h-5 w-5"})})]}),o.jsx(lo,{}),o.jsx("div",{className:"hidden md:block",children:o.jsx(int,{onDragEnd:Ht,children:o.jsx(Bae,{droppableId:"tables",children:ue=>o.jsxs("div",{...ue.droppableProps,ref:Fe=>{ue.innerRef(Fe),Tr.current=Fe},role:"grid","aria-label":"Lista de mesas",className:"grid gap-5 grid-cols-[repeat(auto-fit,minmax(240px,1fr))]",children:[a.length===0?o.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-12 text-center",children:[o.jsx("div",{className:"text-text-muted mb-4",children:o.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Nenhuma mesa encontrada"}),o.jsx("p",{className:"text-text-muted mb-4",children:"Crie sua primeira mesa para comear a receber pedidos"}),o.jsxs(oe,{onClick:()=>Be(!0),className:"flex items-center gap-2",children:[o.jsx(Ka,{size:16}),"Criar Nova Mesa"]})]}):a.map((Fe,ht)=>o.jsx(Unt,{draggableId:Fe.id,index:ht,children:(At,St)=>o.jsx(Cr,{table:Fe,provided:At,isDragging:St.isDragging})},Fe.id)),ue.placeholder]})})})})]}),o.jsx("div",{className:"hidden md:flex bg-surface rounded-lg border border-border flex-col min-h-0 transition-all overflow-hidden",style:{boxShadow:P==="panel"?"inset 0 0 0 2px rgba(148, 163, 184, 0.4)":"none"},children:o.jsxs(Fd,{value:M,onValueChange:ue=>{S(ue),ue==="products"&&s&&(w(!0),S("order"))},className:"flex flex-col h-full",children:[o.jsxs(ad,{className:"grid w-full grid-cols-3 m-2",children:[o.jsx(wa,{value:"order",className:"flex items-center justify-center gap-2 text-xs",children:"Comanda"}),o.jsx(wa,{value:"details",className:"flex items-center justify-center gap-2 text-xs",children:"Detalhes"}),o.jsxs(wa,{value:"products",onClick:()=>{s&&w(!0)},className:"flex items-center justify-center gap-2 text-xs",children:["Produtos",o.jsx("kbd",{className:"hidden md:inline px-1 py-0.5 text-[10px] font-bold font-mono text-white bg-gray-700 border border-gray-600 rounded",children:"P"})]})]}),o.jsx(Wi,{value:"order",className:"flex-1 overflow-hidden min-h-0",children:o.jsx(Xe,{table:s})}),o.jsx(Wi,{value:"details",className:"flex-1 overflow-hidden min-h-0",children:o.jsx(Ye,{table:s})})]})})]})]}),o.jsx(zl,{}),o.jsx(ya,{}),o.jsx(Gt,{open:v,onOpenChange:g,cashSummary:I}),o.jsx(J,{}),o.jsx(gr,{}),o.jsx(vi,{}),o.jsx(Ea,{}),o.jsx(it,{}),Ke&&o.jsx("div",{className:"fixed left-3 right-3 z-[9999]",role:"alert","aria-live":"assertive",style:{bottom:"calc(12px + env(safe-area-inset-bottom, 0px))"},children:o.jsxs("div",{className:"pointer-events-none flex items-start gap-2 rounded-md border border-amber-500 bg-amber-400 text-black px-3 py-2 shadow-lg",children:[o.jsx(hc,{className:"h-4 w-4 mt-0.5","aria-hidden":"true"}),o.jsx("div",{className:"text-sm font-semibold leading-snug drop-shadow-[0_1px_0_rgba(255,255,255,0.25)]",children:lt||"Ateno"})]})}),Qr&&o.jsx(rat,{item:Qr,onApply:()=>{s&&Br(s)},onClose:()=>{Xr(null)},codigoEmpresa:t?.codigo_empresa}),s&&In&&o.jsx(nat,{comanda:s,subtotal:dr(s.order||[],s),onApply:()=>{s&&Br(s)},onClose:()=>sn(!1),codigoEmpresa:t?.codigo_empresa}),o.jsx(dt,{})]})}function iat(){const{toast:e}=oo(),t=Pc(),{userProfile:r}=Do(),[n,a]=p.useState(null),[i,s]=p.useState([]),[l,c]=p.useState([]),[d,u]=p.useState(!0),[f,m]=p.useState(""),[h,v]=p.useState(""),[g,y]=p.useState(null),[x,b]=p.useState(null),[w,j]=p.useState(!1),_=p.useRef(!1),[C,E]=p.useState(new Map),[P,k]=p.useState(!1),[M,S]=p.useState(!1),[I,T]=p.useState(!1),[D,B]=p.useState(!1),[U,z]=p.useState(null),[$,Y]=p.useState(!1),[de,xe]=p.useState([]);p.useState(null);const[q,L]=p.useState(!1),[W,ne]=p.useState([]),[le,K]=p.useState(1),[Q,re]=p.useState([]),[G,me]=p.useState(null),[pe,Be]=p.useState(!1),[Z,ee]=p.useState(null),[kt,Nt]=p.useState(!1),[De,st]=p.useState(""),[ft,yt]=p.useState(!1),[Nr,se]=p.useState(""),[rt,mt]=p.useState(()=>{try{return typeof window<"u"&&window.innerWidth<=640}catch{return!1}});p.useEffect(()=>{const J=()=>{try{mt(typeof window<"u"&&window.innerWidth<=640)}catch{mt(!1)}};return J(),window.addEventListener("resize",J),()=>window.removeEventListener("resize",J)},[]),p.useState("cadastrado");const[tr,Ce]=p.useState(""),[je,ae]=p.useState([]),[$e,Ae]=p.useState([]);p.useState(!1),p.useState(!1);const[Tt,Se]=p.useState(!1),[Ne,Ue]=p.useState(!1),[Qe,et]=p.useState(0),[pt,Ke]=p.useState("all"),[qt,lt]=p.useState(()=>{try{return localStorage.getItem("balcao_sort_order")||"code"}catch{return"code"}}),rr=p.useRef([]),nt=p.useRef(null),[$t,Qr]=p.useState(()=>{try{const J=localStorage.getItem("balcao_left_panel_width");return J?parseFloat(J):50}catch{return 50}}),[Xr,In]=p.useState(!1),sn=p.useRef(null),Qt=p.useRef(0),qr=p.useRef([]);p.useEffect(()=>{qr.current=l},[l]);const Tr=p.useRef(!1);p.useEffect(()=>(Tr.current=!0,()=>{Tr.current=!1}),[]),p.useEffect(()=>{(l||[]).length>0&&(_.current=!0)},[l]),p.useEffect(()=>{n&&_.current&&(l||[]).length===0&&Ot(n,2)},[n,l?.length]),p.useEffect(()=>{let J=!0;return(async()=>{try{const Ye=await km({codigoEmpresa:r?.codigo_empresa});J&&k(!!Ye)}catch{J&&k(!1)}})(),()=>{J=!1}},[r?.codigo_empresa]);const sr=async()=>{const J=r?.codigo_empresa||null;try{if(!J)return;B(!0);const[Ye,Xe]=await Promise.all([g1({codigoEmpresa:J}).catch(()=>null),km({codigoEmpresa:J}).catch(()=>null)]);if(!Xe?.id){z(null);return}let it=0,Ze=0,dt=[];try{dt=await Op({caixaSessaoId:Xe.id,codigoEmpresa:J}),it=(dt||[]).filter(zt=>String(zt?.tipo||"").toLowerCase()==="sangria").reduce((zt,Er)=>zt+Number(Er?.valor||0),0),Ze=(dt||[]).filter(zt=>String(zt?.tipo||"").toLowerCase()==="suprimento").reduce((zt,Er)=>zt+Number(Er?.valor||0),0)}catch{}const Pt={saldo_inicial:Xe.saldo_inicial||0,totalPorFinalizadora:Ye?.totalPorFinalizadora||Ye?.porFinalizadora||{},totalEntradas:Ye?.totalEntradas||Ye?.entradas||0,totalSangria:it,totalSuprimento:Ze,totalSaidas:it,sessaoId:Xe.id,movimentacoes:dt};z(Pt)}catch{z(null)}finally{B(!1)}};p.useEffect(()=>{let J=!0;return(async()=>{try{if(!$||!n)return;const Xe=r?.codigo_empresa;let it=[];try{const Pt=await Zi({comandaId:n,codigoEmpresa:Xe});it=(Array.isArray(Pt)?Pt:[]).map(Er=>{const H=Er?.clientes?.id??Er?.cliente_id??Er?.id??null,Ee=Er?.clientes?.nome??Er?.nome??Er?.nome_livre??"";return H?{id:H,nome:Ee}:null}).filter(Boolean)}catch{it=[]}if(!J)return;re(it);const dt=Array.isArray($e)&&$e.length>0?$e:it.map(Pt=>Pt.id);if(!Array.isArray(dt)||dt.length===0)return;ne(Pt=>{let zt=Pt&&Pt.length?[...Pt]:[{id:1,clientId:dt[0],methodId:de[0]?.id||"",value:""}];zt[0]||(zt[0]={id:1,clientId:dt[0],methodId:de[0]?.id||"",value:""}),zt[0].clientId=dt[0];const Er=new Set([zt[0].clientId].filter(Boolean));for(let H=1;H<zt.length;H++){if(!zt[H].clientId||Er.has(zt[H].clientId)){const Ee=(dt||[]).find(Te=>!Er.has(Te));zt[H].clientId=Ee||dt[0]}Er.add(zt[H].clientId)}return zt})}catch{}})(),()=>{J=!1}},[$,$e,n,r?.codigo_empresa]);const $r=J=>{const Ye=String(J||"").replace(/\D/g,"");return Ye?Number(Ye)/100:0},Gr=J=>new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(J),ke=J=>(de||[]).find(Ye=>String(Ye.id)===String(J)),Mt=J=>Number(ke(J.methodId)?.taxa_percentual||0),wr=J=>{const Ye=$r(J.value),Xe=Mt(J);return!J.chargeFee||!Xe?Ye:Ye/(1+Xe/100)},Fr=J=>{const Ye=wr(J),Xe=Mt(J);return!J.chargeFee||!Xe||Ye<=0?0:Ye*(Xe/100)},Ur=(J,Ye)=>{const Xe=Mt(J);if(J.chargeFee&&Xe>0){const it=Ye*(1+Xe/100);return{...J,value:Gr(it)}}return{...J,value:Gr(Ye)}},Kr=()=>(W||[]).reduce((J,Ye)=>J+wr(Ye),0),dn=()=>(W||[]).reduce((J,Ye)=>J+Fr(Ye),0),wn=()=>Kr()+dn();p.useEffect(()=>{try{if(!$)return;let J=0;try{J=(l||[]).reduce((it,Ze)=>it+Number(Ze.quantity||0)*Number(Ze.price||0),0)}catch{}const Ye=Kr(),Xe=J-Ye;Math.abs(Xe)>.009&&Math.abs(Xe)<=.05&&Array.isArray(W)&&W.length>0&&ne(it=>it.map((Ze,dt,Pt)=>{if(dt!==Pt.length-1)return Ze;const zt=wr(Ze)+Xe;return Ur(Ze,zt)}))}catch{}},[W,$]);const va=async()=>{try{if(!n){e({title:"Nenhuma comanda aberta",description:"Adicione itens para abrir uma comanda.",variant:"warning"});return}const J=r?.codigo_empresa;if(!J){e({title:"Empresa no definida",variant:"destructive"});return}try{const{data:Ze,error:dt}=await ve.from("comandas").select("id").eq("id",n).eq("codigo_empresa",J).single();if(dt||!Ze){console.error("[confirmPay] Comanda no encontrada no banco:",n),e({title:"Comanda invlida",description:"A comanda no existe mais. Criando nova comanda...",variant:"warning"}),a(null),c([]);try{localStorage.removeItem(Ft.comandaId),localStorage.removeItem(Ft.items)}catch{}await Br();return}}catch(Ze){console.error("[confirmPay] Erro ao validar comanda:",Ze),e({title:"Erro de validao",description:"No foi possvel validar a comanda.",variant:"destructive"});return}if(!Array.isArray(W)||W.length===0){e({title:"Informe os pagamentos",description:"Adicione pelo menos uma forma de pagamento.",variant:"warning"});return}for(const Ze of W){if(!Ze.methodId){e({title:"Forma de pagamento faltando",description:"Selecione a finalizadora em todas as linhas.",variant:"warning"});return}if(!String(Ze.value||"").replace(/\D/g,"")){e({title:"Valor invlido",description:"Informe valores maiores que zero.",variant:"warning"});return}}let Ye=0;try{Ye=(await Ci({comandaId:n,codigoEmpresa:J})||[]).reduce((dt,Pt)=>dt+Number(Pt.quantidade||0)*Number(Pt.preco_unitario||0),0)}catch{}const Xe=Kr(),it=Math.abs(Xe-Ye);if(it>.009&&it<=.05){const Ze=Ye-Xe;ne(dt=>dt.map((Pt,zt,Er)=>{if(zt!==Er.length-1)return Pt;const H=wr(Pt)+Ze;return Ur(Pt,H)}))}else if(it>.05){const Ze=Ye-Xe;Ze>0?e({title:"Valor insuficiente",description:`Faltam R$ ${Ze.toFixed(2)} para fechar o total.`,variant:"warning"}):e({title:"Valor excedente",description:`Excedeu em R$ ${Math.abs(Ze).toFixed(2)}. Ajuste os valores.`,variant:"warning"});return}L(!0),await uf({codigoEmpresa:J});for(const Ze of W){const dt=$r(Ze.value),Pt=de.find(Er=>String(Er.id)===String(Ze.methodId)),zt=Pt?.nome||Pt?.tipo||"outros";await dM({comandaId:n,finalizadoraId:Ze.methodId,metodo:zt,valor:dt,status:"Pago",codigoEmpresa:J,clienteId:Ze.clientId||null})}await Rx({comandaId:n,codigoEmpresa:J}),a(null),c([]),Ae([]),m(""),Ue(!1),ne([]);try{localStorage.removeItem(Ft.comandaId),localStorage.removeItem(Ft.items),localStorage.removeItem(Ft.customerName)}catch{}e({title:"Pagamento concludo",description:`Total R$ ${Ye.toFixed(2)}`,variant:"success"}),Y(!1)}catch(J){e({title:"Falha ao concluir",description:J?.message||"Tente novamente",variant:"destructive"})}finally{L(!1)}};p.useEffect(()=>{(async()=>{try{if(!M)return;await sr()}catch{}})()},[M,r?.codigo_empresa]);const xa=()=>{const[J,Ye]=p.useState(""),Xe=p.useRef(null);return p.useEffect(()=>{if(typeof window<"u"&&window.innerWidth<=640)return;const Ze=setTimeout(()=>{try{Xe.current?.focus()}catch{}},0);return()=>clearTimeout(Ze)},[]),o.jsxs(o.Fragment,{children:[o.jsxs(Kc,{children:[o.jsx(Xc,{children:"Abrir Caixa"}),o.jsx(Jc,{children:"Insira o valor inicial (suprimento) para abrir o caixa."})]}),o.jsxs("div",{className:"py-4",children:[o.jsx(Wt,{className:"mb-2 block",htmlFor:"open-cash-initial",children:"Saldo inicial"}),o.jsx(or,{id:"open-cash-initial",ref:Xe,type:"text",inputMode:"numeric",autoComplete:"off",placeholder:"0,00",value:J,onChange:it=>{const Ze=(it.target.value||"").replace(/\D/g,""),dt=Ze?Number(Ze)/100:0,Pt=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(dt);Ye(Pt)},onKeyDown:it=>{it.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(it.key)&&(/^[0-9]$/.test(it.key)||it.preventDefault())},onBeforeInput:it=>{const Ze=it.data??"";Ze&&/\D/.test(Ze)&&it.preventDefault()}}),o.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Digite nmeros; a mscara formata em reais automaticamente."})]}),o.jsxs(Yc,{children:[o.jsx(Qc,{onClick:()=>T(!1),children:"Cancelar"}),o.jsx(Rd,{onClick:async()=>{try{const it=String(J||"").replace(/\D/g,""),Ze=it?Number(it)/100:0;await uf({saldoInicial:Ze,codigoEmpresa:r?.codigo_empresa}),k(!0),T(!1),e({title:"Caixa aberto com sucesso!",variant:"success"})}catch(it){e({title:"Falha ao abrir caixa",description:it?.message||"Tente novamente",variant:"destructive"})}},children:"Confirmar Abertura"})]})]})},Aa=()=>o.jsxs(Md,{open:I,onOpenChange:T,children:[o.jsx(vp,{asChild:!0,children:o.jsxs(oe,{variant:"success",size:"sm",disabled:P,onClick:()=>T(!0),className:"px-3",children:[o.jsx(sH,{className:"h-4 w-4"}),o.jsx("span",{className:"ml-2 md:hidden",children:"Abrir"}),o.jsx("span",{className:"ml-2 hidden md:inline",children:"Abrir Caixa"})]})}),o.jsx(Gc,{className:"sm:max-w-[425px] w-[92vw] animate-none",onKeyDown:J=>J.stopPropagation(),onPointerDownOutside:J=>{J.preventDefault(),J.stopPropagation()},onInteractOutside:J=>{J.preventDefault(),J.stopPropagation()},children:o.jsx(xa,{})})]}),ut=()=>{const[J,Ye]=p.useState({loading:!1,saldoInicial:0,resumo:null}),[Xe,it]=p.useState(!1),[Ze,dt]=p.useState(""),[Pt,zt]=p.useState(!1),Er=async()=>{try{Ye({loading:!0,saldoInicial:0,resumo:null});const at=await km({codigoEmpresa:r?.codigo_empresa}),Zt=await g1({codigoEmpresa:r?.codigo_empresa});Ye({loading:!1,saldoInicial:Number(at?.saldo_inicial||0),resumo:Zt||{totalPorFinalizadora:{}}})}catch{Ye({loading:!1,saldoInicial:0,resumo:{totalPorFinalizadora:{}}})}},H=J?.resumo?.totalPorFinalizadora||{},Ee=Object.values(H).reduce((at,Zt)=>at+Number(Zt||0),0),Te=Number(J.saldoInicial||0)+Ee,vt=Number(U?.totalSuprimento||0),ze=Number(U?.totalSangria||0);return o.jsxs(Md,{onOpenChange:at=>{at&&(zt(!1),Er())},children:[o.jsx(vp,{asChild:!0,children:o.jsxs(oe,{variant:"destructive",size:"sm",disabled:!P,onClick:Er,className:"px-3",children:[o.jsx(sh,{className:"h-4 w-4"}),o.jsx("span",{className:"ml-2",children:"Fechar Caixa"})]})}),o.jsxs(Gc,{className:"sm:max-w-[425px] animate-none",onKeyDown:at=>at.stopPropagation(),onPointerDownOutside:at=>{at.preventDefault(),at.stopPropagation()},onInteractOutside:at=>{at.preventDefault(),at.stopPropagation()},children:[o.jsxs(Kc,{children:[o.jsx(Xc,{children:"Fechar Caixa"}),o.jsx(Jc,{children:"Confira os valores e confirme o fechamento do caixa. Esta ao  irreversvel."})]}),Xe&&o.jsxs("div",{className:"md:hidden mb-2 text-[12px] text-warning bg-warning/10 border border-warning/30 rounded px-2 py-1 flex items-center gap-1",children:[o.jsx(hc,{className:"h-3.5 w-3.5"}),"Existem comandas abertas. Finalize-as antes de fechar o caixa."]}),J.loading?o.jsx("div",{className:"py-4 text-text-muted",children:"Carregando resumo"}):o.jsx("div",{className:"py-4 space-y-2",children:Pt?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Valor Inicial"})," ",o.jsxs("span",{className:"font-mono",children:["R$ ",Number(J.saldoInicial||0).toFixed(2)]})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Valor Final"})," ",o.jsx("span",{className:"font-mono",children:(()=>{const at=String(Ze||"").replace(/\D/g,""),Zt=at?Number(at)/100:0;return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Zt)})()})]})]}),o.jsxs("div",{className:"mt-2",children:[o.jsx(Wt,{className:"mb-1 block",children:"Saldo Final (opcional)"}),o.jsx(or,{type:"text",inputMode:"numeric",placeholder:"0,00",value:Ze,onChange:at=>{const Zt=(at.target.value||"").replace(/\D/g,""),zr=Zt?Number(Zt)/100:0,Ar=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(zr);dt(Ar)},onKeyDown:at=>{at.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(at.key)&&(/^[0-9]$/.test(at.key)||at.preventDefault())},onBeforeInput:at=>{const Zt=at.data??"";Zt&&/\D/.test(Zt)&&at.preventDefault()}})]})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"text-xs font-medium text-text-muted uppercase tracking-wide mb-1",children:"Resumo"}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Valor Inicial"})," ",o.jsxs("span",{className:"font-mono",children:["R$ ",Number(J.saldoInicial||0).toFixed(2)]})]}),Object.keys(H).length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Sem pagamentos nesta sesso."}):o.jsx("div",{className:"space-y-1",children:Object.entries(H).map(([at,Zt])=>o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:String(at)})," ",o.jsxs("span",{className:"font-mono",children:["R$ ",Number(Zt||0).toFixed(2)]})]},at))}),o.jsx("div",{className:"my-2 h-px bg-border"}),o.jsx("div",{className:"text-xs font-medium text-text-muted uppercase tracking-wide mb-1",children:"Conferncia"}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Suprimentos"})," ",o.jsxs("span",{className:"font-mono",children:["R$ ",vt.toFixed(2)]})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Sangrias"})," ",o.jsxs("span",{className:"font-mono",children:["R$ ",ze.toFixed(2)]})]}),o.jsxs("div",{className:"flex justify-between font-medium text-base",children:[o.jsx("span",{className:"text-text-secondary",children:"Total em Caixa"})," ",o.jsxs("span",{className:"font-mono text-success",children:["R$ ",Number(Te||0).toFixed(2)]})]})]})}),o.jsx(Yc,{children:Pt?o.jsxs(o.Fragment,{children:[o.jsx(oe,{variant:"outline",onClick:()=>zt(!1),children:"Voltar"}),o.jsx(oe,{onClick:async()=>{try{try{const zr=await sc({codigoEmpresa:r?.codigo_empresa});if(Array.isArray(zr)&&zr.length>0){rt?(it(!0),e({title:"Fechamento bloqueado",description:`Existem ${zr.length} comandas abertas. Feche todas antes de encerrar o caixa.`,variant:"warning"})):e({title:"Fechamento bloqueado",description:`Existem ${zr.length} comandas abertas. Feche todas antes de encerrar o caixa.`,variant:"warning",duration:2500});return}}catch{}const at=String(Ze||"").replace(/\D/g,""),Zt=at?Number(at)/100:0;await zte({codigoEmpresa:r?.codigo_empresa,valorFinalDinheiro:Zt}),k(!1),e({title:"Caixa fechado!",description:"Fechamento registrado com sucesso.",variant:"success"})}catch(at){e({title:"Falha ao fechar caixa",description:at?.message||"Tente novamente",variant:"destructive"})}},children:"Fechar Caixa"})]}):o.jsxs(o.Fragment,{children:[o.jsx(Qc,{children:"Cancelar"}),o.jsx(oe,{onClick:()=>zt(!0),children:"Confirmar Fechamento"})]})})]})]})},Ht=()=>{const J=yr=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(yr||0)),[Ye,Xe]=p.useState(!1),[it,Ze]=p.useState(!1),[dt,Pt]=p.useState(""),[zt,Er]=p.useState(""),[H,Ee]=p.useState(!1),Te=async()=>{try{Ee(!0);const yr=String(dt||"").replace(/\D/g,""),nr=yr?Number(yr)/100:0;if(nr<=0){e({title:"Valor invlido",description:"Informe um valor positivo.",variant:"warning"});return}await uf({codigoEmpresa:r?.codigo_empresa}),await G3({tipo:"sangria",valor:nr,observacao:zt,codigoEmpresa:r?.codigo_empresa}),Xe(!1),Pt(""),Er(""),await sr(),e({title:"Sangria registrada",variant:"success"})}catch(yr){e({title:"Falha ao registrar sangria",description:yr?.message||"Tente novamente",variant:"destructive"})}finally{Ee(!1)}},[vt,ze]=p.useState(""),[at,Zt]=p.useState(""),[zr,Ar]=p.useState(!1),br=async()=>{try{Ar(!0);const yr=String(vt||"").replace(/\D/g,""),nr=yr?Number(yr)/100:0;if(nr<=0){e({title:"Valor invlido",description:"Informe um valor positivo.",variant:"warning"});return}await uf({codigoEmpresa:r?.codigo_empresa}),await G3({tipo:"suprimento",valor:nr,observacao:at,codigoEmpresa:r?.codigo_empresa}),Ze(!1),ze(""),Zt(""),await sr(),e({title:"Suprimento registrado",variant:"success"})}catch(yr){e({title:"Falha ao registrar suprimento",description:yr?.message||"Tente novamente",variant:"destructive"})}finally{Ar(!1)}};return o.jsx(ln,{open:M,onOpenChange:S,children:o.jsxs(on,{className:"sm:max-w-lg w-[92vw] max-h-[85vh] animate-none flex flex-col overflow-hidden",onKeyDown:yr=>yr.stopPropagation(),children:[o.jsxs(nn,{children:[o.jsx(rn,{className:"text-2xl font-bold",children:"Detalhes do Caixa"}),o.jsx(_n,{children:D?"Carregando resumo...":U?"Resumo da sesso atual do caixa.":"Nenhuma sesso de caixa aberta."})]}),U?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex-1 overflow-y-auto pr-1",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-3",children:[o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border text-center",children:[o.jsx("div",{className:"text-[12px] text-text-secondary whitespace-nowrap mb-1",children:"Saldo Inicial"}),o.jsx("div",{className:"text-base md:text-lg font-bold tabular-nums leading-tight",children:J(U.saldo_inicial)})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border text-center",children:[o.jsx("div",{className:"text-[12px] text-text-secondary whitespace-nowrap mb-1",children:"Entradas"}),o.jsx("div",{className:"text-base md:text-lg font-bold text-success tabular-nums leading-tight",children:J(U.totalEntradas)})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border text-center",children:[o.jsx("div",{className:"text-[12px] text-text-secondary whitespace-nowrap mb-1",children:"Sadas"}),o.jsx("div",{className:"text-base md:text-lg font-bold text-danger tabular-nums leading-tight",children:J(U.totalSangria)})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border text-center",children:[o.jsx("div",{className:"text-[12px] text-text-secondary whitespace-nowrap mb-1",children:"Saldo Atual"}),o.jsx("div",{className:"text-base md:text-lg font-bold tabular-nums leading-tight",children:J((U.saldo_inicial||0)+(U.totalEntradas||0)-(U.totalSangria||0))})]})]}),o.jsxs("div",{className:"mt-5",children:[o.jsx("div",{className:"flex items-center justify-between mb-3",children:o.jsx("h4",{className:"text-sm font-semibold text-text-secondary",children:"Totais por Finalizadora"})}),Object.keys(U.totalPorFinalizadora||{}).length===0?o.jsx("div",{className:"p-3 text-sm text-text-muted border rounded-md",children:"Nenhuma finalizadora registrada ainda."}):o.jsx("ul",{className:"rounded-md border border-border overflow-hidden divide-y divide-border",children:Object.entries(U.totalPorFinalizadora||{}).map(([yr,nr])=>o.jsxs("li",{className:"bg-surface px-3 py-2 flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:String(yr)}),o.jsx("span",{className:"text-sm font-semibold tabular-nums",children:J(nr)})]},yr))}),o.jsxs("div",{className:"mt-2 rounded-md border border-border bg-surface px-3 py-2 flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:"Suprimentos"}),o.jsx("span",{className:"text-sm font-semibold tabular-nums text-success",children:J(U.totalSuprimento||0)})]}),o.jsxs("div",{className:"mt-2 rounded-md border border-border bg-surface px-3 py-2 flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary truncate pr-3",children:"Sangrias"}),o.jsx("span",{className:"text-sm font-semibold tabular-nums text-danger",children:J(U.totalSangria||0)})]})]})]}),o.jsxs(Un,{className:"flex items-center justify-between gap-2",children:[o.jsx("div",{className:"mr-auto"}),o.jsx(oe,{variant:"outline",onClick:()=>Ze(!0),children:"Registrar Suprimento"}),o.jsx(oe,{variant:"destructive",onClick:()=>Xe(!0),children:"Registrar Sangria"}),o.jsx(oe,{variant:"secondary",onClick:()=>S(!1),children:"Fechar"})]}),o.jsx(ln,{open:it,onOpenChange:Ze,children:o.jsxs(on,{className:"sm:max-w-sm w-[92vw] max-h-[85vh] animate-none",onKeyDown:yr=>yr.stopPropagation(),children:[o.jsxs(nn,{children:[o.jsx(rn,{className:"text-xl font-bold",children:"Registrar Suprimento"}),o.jsx(_n,{children:"Informe o valor de entrada no caixa e, opcionalmente, uma observao."})]}),o.jsxs("div",{className:"flex-1 flex flex-col space-y-3",children:[o.jsxs("div",{children:[o.jsx(Wt,{htmlFor:"r-valor",children:"Valor"}),o.jsx(or,{id:"r-valor",type:"text",inputMode:"numeric",autoComplete:"off",placeholder:"0,00",value:vt,onChange:yr=>{const nr=(yr.target.value||"").replace(/\D/g,""),Zr=nr?Number(nr)/100:0,tt=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Zr);ze(tt)},onKeyDown:yr=>{yr.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(yr.key)&&(/^[0-9]$/.test(yr.key)||yr.preventDefault())},onBeforeInput:yr=>{const nr=yr.data??"";nr&&/\D/.test(nr)&&yr.preventDefault()}})]}),o.jsxs("div",{children:[o.jsx(Wt,{htmlFor:"r-obs",children:"Observao"}),o.jsx(or,{id:"r-obs",placeholder:"Opcional",value:at,onChange:yr=>Zt(yr.target.value)})]})]}),o.jsxs(Un,{children:[o.jsx(oe,{variant:"outline",onClick:()=>Ze(!1),disabled:zr,children:"Cancelar"}),o.jsx(oe,{onClick:br,disabled:zr,children:zr?"Registrando...":"Confirmar"})]})]})}),o.jsx(ln,{open:Ye,onOpenChange:Xe,children:o.jsxs(on,{className:"sm:max-w-sm w-[92vw] max-h-[85vh] animate-none",onKeyDown:yr=>yr.stopPropagation(),children:[o.jsxs(nn,{children:[o.jsx(rn,{className:"text-xl font-bold",children:"Registrar Sangria"}),o.jsx(_n,{children:"Informe o valor a retirar do caixa e, opcionalmente, uma observao."})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx(Wt,{htmlFor:"s-valor",children:"Valor"}),o.jsx(or,{id:"s-valor",type:"text",inputMode:"numeric",autoComplete:"off",placeholder:"0,00",value:dt,onChange:yr=>{const nr=(yr.target.value||"").replace(/\D/g,""),Zr=nr?Number(nr)/100:0,tt=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(Zr);Pt(tt)},onKeyDown:yr=>{yr.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(yr.key)&&(/^[0-9]$/.test(yr.key)||yr.preventDefault())},onBeforeInput:yr=>{const nr=yr.data??"";nr&&/\D/.test(nr)&&yr.preventDefault()}})]}),o.jsxs("div",{children:[o.jsx(Wt,{htmlFor:"s-obs",children:"Observao"}),o.jsx(or,{id:"s-obs",placeholder:"Opcional",value:zt,onChange:yr=>Er(yr.target.value)})]})]}),o.jsxs(Un,{children:[o.jsx(oe,{variant:"outline",onClick:()=>Xe(!1),disabled:H,children:"Cancelar"}),o.jsx(oe,{onClick:Te,disabled:H,children:H?"Registrando...":"Confirmar"})]})]})})]}):o.jsx("div",{className:"text-sm text-text-muted",children:"Nenhuma sesso de caixa aberta."})]})})},dr=r?.codigo_empresa||"anon",Ft={comandaId:`balcao:comandaId:${dr}`,items:`balcao:items:${dr}`,customerName:`balcao:customer:${dr}`,clientChosen:`balcao:clientChosen:${dr}`,pendingClientIds:`balcao:pendingClientIds:${dr}`,missCount:`balcao:missCount:${dr}`,lastMissTs:`balcao:lastMissTs:${dr}`},Ot=async(J,Ye=3)=>{if(!J)return;const Xe=r?.codigo_empresa,it=++Qt.current;for(let Ze=0;Ze<Ye;Ze++)try{const dt=await Ci({comandaId:J,codigoEmpresa:Xe});if(it!==Qt.current)return;const Pt=(dt||[]).map(zt=>({id:zt.id,productId:zt.produto_id,name:zt.descricao||"Item",price:Number(zt.preco_unitario||0),quantity:Number(zt.quantidade||1)}));c(Pt);try{const zt=await Zi({comandaId:J,codigoEmpresa:Xe});if(it!==Qt.current)return;const Er=(zt||[]).map(Ee=>Ee?.nome).filter(Boolean),H=Er.length?Er.join(", "):"";m(H),Ue(!!H)}catch{m(""),Ue(!1)}break}catch(dt){if(Ze===Ye-1)e({title:"Falha ao atualizar itens",description:dt?.message||"Tente novamente",variant:"destructive"});else{const Pt=350*(Ze+1),zt=Math.floor(Math.random()*120);await new Promise(Er=>setTimeout(Er,Pt+zt))}}},Br=async()=>{try{u(!0);let J=setTimeout(()=>{Tr.current&&u(!1)},1e4);const Ye=r?.codigo_empresa;if(!Ye){Tr.current&&u(!1);return}try{const dt=localStorage.getItem(Ft.comandaId),Pt=JSON.parse(localStorage.getItem(Ft.items)||"[]"),zt=localStorage.getItem(Ft.customerName)||"",Er=localStorage.getItem(Ft.clientChosen),H=JSON.parse(localStorage.getItem(Ft.pendingClientIds)||"[]");dt&&a(Number.isNaN(+dt)?dt:Number(dt)),Array.isArray(Pt)&&Pt.length>0&&c(Pt),zt&&m(zt),Er==="true"&&Ue(!0),Array.isArray(H)&&H.length>0&&Ae(H)}catch{}const Xe=localStorage.getItem(Ft.comandaId),it=Xe?Number.isNaN(+Xe)?Xe:Number(Xe):null,Ze=await cM({codigoEmpresa:Ye}).catch(()=>null);if(Ze?.id)a(Ze.id),await Ot(Ze.id);else if(it)a(it),await Ot(it,3);else{let dt=0,Pt=0;try{dt=Number(localStorage.getItem(Ft.missCount)||"0"),Pt=Number(localStorage.getItem(Ft.lastMissTs)||"0")}catch{}const zt=Date.now(),H=zt-Pt<9e4?dt+1:1;try{localStorage.setItem(Ft.missCount,String(H)),localStorage.setItem(Ft.lastMissTs,String(zt))}catch{}try{const Ee=localStorage.getItem(Ft.customerName)||"",Te=localStorage.getItem(Ft.clientChosen)==="true",vt=JSON.parse(localStorage.getItem(Ft.pendingClientIds)||"[]");m(Ee||""),Ue(!!Te),Ae(Array.isArray(vt)?vt:[])}catch{}if(a(null),H>=2){c([]);try{localStorage.removeItem(Ft.comandaId),localStorage.removeItem(Ft.items)}catch{}}else try{const Ee=JSON.parse(localStorage.getItem(Ft.items)||"[]");Array.isArray(Ee)&&Ee.length>0&&c(Ee)}catch{}}try{const dt=await qu({includeInactive:!1,search:h?.trim()||void 0,codigoEmpresa:Ye});Tr.current&&s(dt||[])}catch{s([])}clearTimeout(J)}catch(J){e({title:"Falha ao carregar Modo Balco",description:J?.message||"Tente novamente",variant:"destructive"})}finally{Tr.current&&u(!1)}},Vt=async()=>{try{j(!0);const J=r?.codigo_empresa;if(n&&J)try{try{await ve.from("comanda_itens").delete().eq("comanda_id",n).eq("codigo_empresa",J)}catch{}try{await ve.from("comanda_clientes").delete().eq("comanda_id",n).eq("codigo_empresa",J)}catch{}await ve.from("comandas").delete().eq("id",n).eq("codigo_empresa",J)}catch{}}finally{a(null),c([]),Ae([]),m(""),Ue(!1),b(null);try{localStorage.removeItem(Ft.comandaId),localStorage.removeItem(Ft.items),localStorage.removeItem(Ft.customerName)}catch{}j(!1),e({title:"Venda cancelada",variant:"success"})}};p.useEffect(()=>{let J=!1;(async()=>{await Br(),!J&&Tr.current&&!n&&(qr.current||[]).length===0&&(J=!0,setTimeout(()=>{Tr.current&&Br()},700))})()},[r?.codigo_empresa]),p.useEffect(()=>{try{n&&localStorage.setItem(Ft.comandaId,String(n)),localStorage.setItem(Ft.items,JSON.stringify(l||[])),localStorage.setItem(Ft.customerName,f||""),localStorage.setItem(Ft.clientChosen,Ne?"true":"false"),n?localStorage.removeItem(Ft.pendingClientIds):localStorage.setItem(Ft.pendingClientIds,JSON.stringify($e||[]))}catch{}},[n,l,f,Ne,$e]),p.useEffect(()=>{const J=()=>{n&&Ot(n,2)},Ye=()=>{document.visibilityState==="visible"&&n&&Ot(n,2)};return window.addEventListener("focus",J),document.addEventListener("visibilitychange",Ye),()=>{window.removeEventListener("focus",J),document.removeEventListener("visibilitychange",Ye)}},[n]),p.useEffect(()=>{const J=Ye=>{const Xe=Ye.target;if(!(Xe&&(Xe.tagName==="INPUT"||Xe.tagName==="TEXTAREA"))){if(Ye.key==="p"||Ye.key==="P"){Ye.preventDefault(),nt.current?.focus();return}if((Ye.key==="c"||Ye.key==="C")&&P&&Ne){Ye.preventDefault(),Se(!0);return}if(Ye.key==="Escape"){if(kt){Nt(!1);return}if(Tt){Se(!1);return}if($){Y(!1);return}if(pe){Be(!1);return}}}};return window.addEventListener("keydown",J),()=>window.removeEventListener("keydown",J)},[P,Ne,kt,Tt,$,pe]),p.useEffect(()=>{const J=Xe=>{if(!Xr||!sn.current)return;const Ze=sn.current.getBoundingClientRect(),dt=18;Ze.width-dt;const zt=(Xe.clientX-Ze.left)/Ze.width*100;zt>=20&&zt<=80&&Qr(zt)},Ye=()=>{if(Xr){In(!1);try{localStorage.setItem("balcao_left_panel_width",String($t))}catch{}}};return Xr&&(document.addEventListener("mousemove",J),document.addEventListener("mouseup",Ye),document.body.style.cursor="col-resize",document.body.style.userSelect="none"),()=>{document.removeEventListener("mousemove",J),document.removeEventListener("mouseup",Ye),document.body.style.cursor="",document.body.style.userSelect=""}},[Xr,$t]),p.useEffect(()=>{let J=!0;const Ye=setTimeout(async()=>{try{const Xe=await qu({includeInactive:!1,search:h?.trim()||void 0,codigoEmpresa:r?.codigo_empresa});if(!J)return;let it=Xe||[];if(h?.trim()){const Ze=h.trim().toLowerCase();it=it.filter(dt=>(dt.name||"").toLowerCase().includes(Ze)||(dt.code||"").toLowerCase().includes(Ze))}it.sort((Ze,dt)=>{const Pt=Ze.code||"",zt=dt.code||"";return/^\d+$/.test(Pt)&&/^\d+$/.test(zt)?parseInt(Pt,10)-parseInt(zt,10):Pt.localeCompare(zt)}),s(it)}catch{J&&s([])}},300);return()=>{J=!1,clearTimeout(Ye)}},[h]),p.useEffect(()=>{let J=!0;const Ye=async()=>{try{const it=r?.codigo_empresa;if(!it)return;const Ze=await Vv({codigoEmpresa:it});if(!J)return;console.log("[BalcaoPage] Itens de todas comandas abertas:",Ze?.length||0);const dt=new Map;for(const Pt of Ze||[]){const zt=Pt.produto_id,Er=Number(Pt.quantidade||0);dt.set(zt,(dt.get(zt)||0)+Er)}console.log("[BalcaoPage] Estoque reservado atualizado:",dt.size,"produtos diferentes"),dt.size>0&&console.log("[BalcaoPage] Produtos reservados:",Array.from(dt.entries()).map(([Pt,zt])=>({id:Pt,qty:zt}))),E(dt)}catch(it){console.error("[BalcaoPage] Erro ao buscar estoque reservado:",it),J&&E(new Map)}};Ye();const Xe=setInterval(Ye,5e3);return()=>{J=!1,clearInterval(Xe)}},[r?.codigo_empresa,l]),p.useEffect(()=>{let J=!0;const Ye=setTimeout(async()=>{try{const Xe=await _j({searchTerm:tr,limit:20,codigoEmpresa:r?.codigo_empresa});if(!J)return;const it=(Xe||[]).slice().sort((Ze,dt)=>Number(Ze?.codigo||0)-Number(dt?.codigo||0));if(ae(it),Tt&&(!$e||$e.length===0)){const Ze=it?.find(dt=>dt?.codigo===0);if(Ze){Ae([Ze.id]);try{localStorage.setItem(Ft.pendingClientIds,JSON.stringify([Ze.id]))}catch{}}}}catch{J&&ae([])}},250);return()=>{J=!1,clearTimeout(Ye)}},[tr,Tt]);const Cr=p.useMemo(()=>l.reduce((J,Ye)=>J+Number(Ye.price||0)*Number(Ye.quantity||0),0),[l]),ct=p.useMemo(()=>{const J=new Map;for(const Ye of l||[]){const Xe=Ye.productId;if(!Xe)continue;const it=Number(Ye.quantity||0);J.set(Xe,(J.get(Xe)||0)+it)}return J},[l]),Gt=async(J,Ye={})=>{try{if(!P){e({title:"Caixa Fechado",description:"Abra o caixa antes de iniciar uma venda.",variant:"warning"});return}if(!Ne&&!Ye.skipClientCheck){b(J),Se(!0),e({title:"Selecione o cliente",description:"Escolha um cliente cadastrado antes de vender.",variant:"warning"});return}const Xe=r?.codigo_empresa;if(!Xe){e({title:"Empresa no definida",description:"Faa login novamente.",variant:"destructive"});return}if(g)return;const it=Number(J.stock??J.currentStock??0),Ze=C.get(J.id)||0,dt=Math.max(0,it-Ze),Pt=Number(J.minStock??0);if(dt<=0){e({title:"Sem estoque disponvel",description:`Produto "${J.name}" est sem estoque (${it} total, ${Ze} reservado em outras comandas).`,variant:"destructive"});return}y(J.id);let zt=n;const Er=!zt;if(!zt)try{const Te=await Nj({codigoEmpresa:Xe});zt=Te.id,a(Te.id),await new Promise(ze=>setTimeout(ze,300));const{data:vt}=await ve.from("comandas").select("id").eq("id",zt).eq("codigo_empresa",Xe).single();if(!vt)throw new Error("Comanda criada mas no acessvel via RLS")}catch(Te){if(Te?.code==="NO_OPEN_CASH_SESSION"){e({title:"Abra o caixa para vender",description:"Voc precisa abrir o caixa antes de iniciar uma comanda no Balco.",variant:"warning"});return}throw Te}const H=Number(J.salePrice??J.price??0),Ee=(qr.current||[]).find(Te=>Te.productId===J.id);Ee?await Vc({itemId:Ee.id,quantidade:Number(Ee.quantity||0)+1,codigoEmpresa:Xe}):await K3({comandaId:zt,produtoId:J.id,descricao:J.name,quantidade:1,precoUnitario:H,codigoEmpresa:Xe}),await Ot(zt);try{const Te=await Vv({codigoEmpresa:Xe}),vt=new Map;for(const ze of Te||[]){const at=ze.produto_id,Zt=Number(ze.quantidade||0);vt.set(at,(vt.get(at)||0)+Zt)}E(vt),console.log("[BalcaoPage:addProduct] Estoque reservado atualizado:",vt.size,"produtos")}catch(Te){console.error("[BalcaoPage:addProduct] Erro ao atualizar estoque reservado:",Te)}if(Er)try{const Te=Array.from(new Set($e||[]));if(Te.length>0){await Wv({comandaId:zt,clienteIds:Te,nomesLivres:[],codigoEmpresa:Xe}),await Ot(zt);const ze=(await Zi({comandaId:zt,codigoEmpresa:Xe})||[]).map(at=>at?.nome).filter(Boolean);m(ze.length?ze.join(", "):""),Ue(!0);try{localStorage.removeItem(Ft.pendingClientIds),localStorage.setItem(Ft.customerName,ze.length?ze.join(", "):""),localStorage.setItem(Ft.clientChosen,"true")}catch(at){console.error("Erro ao atualizar cache local:",at)}}}catch(Te){console.error("Erro ao associar clientes:",Te)}it-1<=0?e({title:"ltima unidade vendida",description:`"${J.name}" esgotou aps esta venda.`,variant:"warning"}):it-1<=Pt?e({title:"Estoque baixo",description:`"${J.name}" atingiu nvel de estoque baixo.`,variant:"warning"}):e({title:"Produto adicionado",description:J.name,variant:"success"})}catch(Xe){const it=String(Xe?.message||"").toLowerCase();Xe?.code==="OUT_OF_STOCK"||it.includes("sem estoque")?e({title:"Sem estoque",description:"Este produto est sem estoque.",variant:"destructive"}):Xe?.code==="INSUFFICIENT_STOCK"||it.includes("insuficiente")?e({title:"Estoque insuficiente",description:Xe?.message||"Quantidade maior que o disponvel.",variant:"destructive"}):e({title:"Falha ao adicionar",description:Xe?.message||"Tente novamente",variant:"destructive"})}finally{y(null)}},gr=async()=>{try{if(L(!0),!Ne){Se(!0),e({title:"Selecione o cliente",description:"Escolha um cliente cadastrado antes de pagar.",variant:"warning"}),L(!1);return}const J=r?.codigo_empresa;if(!J){e({title:"Empresa no definida",variant:"destructive"});return}if(!n)try{const Te=await Nj({codigoEmpresa:J});if(!Te?.id){e({title:"Comanda no encontrada",description:"Abra uma comanda antes de pagar.",variant:"destructive"}),L(!1);return}a(Te.id)}catch(Te){if(Te?.code==="NO_OPEN_CASH_SESSION"){e({title:"Abra o caixa para pagar",description:" necessrio abrir o caixa antes de iniciar/confirmar uma venda.",variant:"warning"}),L(!1);return}throw Te}try{await QHe({comandaId:n,codigoEmpresa:J})}catch(Te){const vt=Array.isArray(Te?.items)&&Te.items.length?Te.items.map(ze=>`${ze.name} (solicitado ${ze.solicitado}, estoque ${ze.estoque})`).join("; "):Te?.message||"Estoque insuficiente na comanda";e({title:"Estoque insuficiente",description:vt,variant:"destructive",duration:7e3}),L(!1);return}const Ye=await Uv({somenteAtivas:!0,codigoEmpresa:J});xe(Ye||[]);let Xe=[];try{const Te=await Zi({comandaId:n,codigoEmpresa:J});Xe=(Array.isArray(Te)?Te:[]).map(ze=>{const at=ze?.cliente_id??ze?.clientes?.id??null,Zt=ze?.clientes?.nome??ze?.nome??ze?.nome_livre??"";return at?{id:at,nome:Zt}:null}).filter(Boolean)}catch{Xe=[]}re(Xe);const it=Ye&&Ye[0]&&Ye[0].id?Ye[0].id:null,Ze=$e&&$e.length>0?$e[0]:Xe[0]?.id||null;let dt=0;try{dt=(await Ci({comandaId:n,codigoEmpresa:J})||[]).reduce((vt,ze)=>vt+Number(ze.quantidade||0)*Number(ze.preco_unitario||0),0)}catch{}const Pt=(Ye||[]).find(Te=>String(Te.id)===String(it)),zt=Number(Pt?.taxa_percentual||0),Er=zt>0,H=Er?dt*(1+zt/100):dt,Ee=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(H);ne([{id:1,clientId:Ze,methodId:it,value:Ee,chargeFee:Er}]),K(2),Y(!0),L(!1);return}catch(J){if(J?.code==="NO_OPEN_CASH_SESSION"){e({title:"Abra o caixa para pagar",description:" necessrio abrir o caixa antes de iniciar/confirmar uma venda.",variant:"warning"}),L(!1);return}e({title:"Falha ao iniciar pagamento",description:J?.message||"Tente novamente",variant:"destructive"})}finally{}};return o.jsxs("div",{className:"h-full flex flex-col",children:[o.jsx("div",{className:"md:hidden mb-2 w-full",children:o.jsx(Fd,{value:"balcao",onValueChange:J=>{J==="mesas"&&t("/vendas"),J==="balcao"&&t("/balcao"),J==="historico"&&t("/historico")},children:o.jsxs(ad,{className:"grid w-full grid-cols-3",children:[o.jsx(wa,{value:"mesas",className:"text-xs",children:"Mesas"}),o.jsx(wa,{value:"balcao",className:"text-xs",children:"Balco"}),o.jsx(wa,{value:"historico",className:"text-xs",children:"Histrico"})]})})}),o.jsxs("div",{className:"flex items-center justify-between mb-2 md:mb-6 gap-2 md:gap-4",children:[o.jsx("div",{className:"hidden md:flex items-center gap-2 md:gap-3",children:o.jsx(Fd,{value:"balcao",onValueChange:J=>{J==="mesas"&&t("/vendas"),J==="balcao"&&t("/balcao"),J==="historico"&&t("/historico")},children:o.jsxs(ad,{className:"inline-flex",children:[o.jsx(wa,{value:"mesas",className:"text-sm",children:"Mesas"}),o.jsx(wa,{value:"balcao",className:"text-sm",children:"Balco"}),o.jsx(wa,{value:"historico",className:"text-sm",children:"Histrico"})]})})}),o.jsxs("div",{className:"flex items-center gap-1.5 md:gap-3 md:ml-auto",children:[o.jsx(Aa,{}),o.jsx(ut,{}),o.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>S(!0),className:"px-3",children:[o.jsx(ZW,{className:"h-4 w-4"}),o.jsx("span",{className:"ml-2 md:hidden",children:"Detalhes"}),o.jsx("span",{className:"ml-2 hidden md:inline",children:"Detalhes do Caixa"})]})]})]}),o.jsx("div",{className:"md:hidden flex-1 flex flex-col",children:o.jsxs("div",{className:"flex flex-col border rounded-lg border-border overflow-hidden bg-surface flex-1 min-h-0",children:[o.jsxs("div",{className:"p-3 border-b border-border flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("div",{className:"text-xs text-text-secondary",children:"Comanda"}),o.jsx("div",{className:"text-base font-bold truncate",children:"Balco"}),Ne&&f&&o.jsx("div",{className:"text-[11px] text-text-muted truncate mt-0.5",children:f})]}),o.jsx("div",{className:"flex flex-col items-end gap-1",children:Ne?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsxs(oe,{size:"sm",className:"h-8 px-2 text-xs bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",disabled:!P,onClick:()=>{if(!P){e({title:"Caixa Fechado",description:"Abra o caixa antes de adicionar produtos.",variant:"warning"});return}Nt(!0)},children:[o.jsx(Ka,{className:"h-4 w-4 mr-1"})," Produto"]}),o.jsx(oe,{size:"sm",variant:"outline",className:"h-8 px-2 text-xs",onClick:()=>Se(!0),children:"+ Cliente"})]}),o.jsxs("span",{className:"text-xs text-text-muted whitespace-nowrap",children:["Total: R$ ",Cr.toFixed(2)]})]}):o.jsx(oe,{size:"sm",className:"h-8 px-3 text-xs bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",disabled:!P,onClick:()=>{if(!P){e({title:"Caixa Fechado",description:"Abra o caixa antes de iniciar uma venda.",variant:"warning"});return}Se(!0)},children:"Iniciar venda"})})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-3 thin-scroll min-h-0",children:Ne?l.length===0?o.jsxs("div",{className:"text-center pt-8 text-xs text-text-muted space-y-2",children:[o.jsx("div",{children:"Comanda criada para o cliente."}),o.jsxs("div",{children:["Use o boto ",o.jsx("span",{className:"font-semibold",children:"Produto"})," para adicionar itens."]})]}):o.jsx("ul",{className:"space-y-2",children:l.map(J=>o.jsxs("li",{className:"p-2 rounded-md border border-border/40 bg-surface-2",children:[o.jsx("div",{className:"text-sm font-medium truncate",title:J.name,children:J.name}),o.jsxs("div",{className:"mt-1 flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(oe,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:async Ye=>{Ye.stopPropagation();const Xe=r?.codigo_empresa;if(!Xe){e({title:"Empresa no definida",variant:"destructive"});return}const it=Number(J.quantity||1)-1;try{it<=0?(await Cv({itemId:J.id,codigoEmpresa:Xe}),c(Ze=>Ze.filter(dt=>dt.id!==J.id))):(await Vc({itemId:J.id,quantidade:it,codigoEmpresa:Xe}),c(Ze=>Ze.map(dt=>dt.id===J.id?{...dt,quantity:it}:dt)))}catch(Ze){e({title:"Falha ao atualizar item",description:Ze?.message||"Tente novamente",variant:"destructive"})}},children:"-"}),o.jsx("span",{className:"w-7 text-center text-sm font-semibold",children:J.quantity}),o.jsx(oe,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:async Ye=>{Ye.stopPropagation();const Xe=r?.codigo_empresa;if(!Xe){e({title:"Empresa no definida",variant:"destructive"});return}const it=Number(J.quantity||1)+1;try{await Vc({itemId:J.id,quantidade:it,codigoEmpresa:Xe}),c(Ze=>Ze.map(dt=>dt.id===J.id?{...dt,quantity:it}:dt))}catch(Ze){e({title:"Falha ao atualizar item",description:Ze?.message||"Tente novamente",variant:"destructive"})}},children:"+"})]}),o.jsxs("span",{className:"text-sm font-semibold whitespace-nowrap",children:["R$ ",(Number(J.quantity)*Number(J.price)).toFixed(2)]})]})]},J.id))}):o.jsx("div",{className:"text-center pt-8 text-xs text-text-muted space-y-2",children:o.jsxs("div",{children:["Para comear, toque em ",o.jsx("span",{className:"font-semibold",children:"Iniciar venda"})," e selecione o cliente."]})})}),o.jsx("div",{className:"p-3 border-t border-border flex gap-2",children:Ne?o.jsxs(o.Fragment,{children:[o.jsx(oe,{className:"flex-1",variant:"outline",size:"sm",onClick:Vt,disabled:l.length===0,children:"Cancelar"}),o.jsx(oe,{className:"flex-1",size:"sm",disabled:Cr<=0,onClick:gr,children:"Finalizar"})]}):o.jsx(oe,{className:"flex-1",size:"sm",variant:"outline",disabled:!P,onClick:()=>{if(!P){e({title:"Caixa Fechado",description:"Abra o caixa antes de iniciar uma venda.",variant:"warning"});return}Se(!0)},children:"Iniciar venda"})})]})}),o.jsx(Ht,{}),o.jsx(ln,{open:pe,onOpenChange:J=>{Be(J),J||me(null)},children:o.jsxs(on,{className:"sm:max-w-[420px] w-full max-h-[85vh] flex flex-col animate-none",onKeyDown:J=>J.stopPropagation(),onPointerDownOutside:J=>J.stopPropagation(),onInteractOutside:J=>J.stopPropagation(),children:[o.jsxs(nn,{children:[o.jsx(rn,{className:"text-xl font-bold break-words",title:G?.name||"",children:G?.name||"Produto"}),o.jsx(_n,{children:"Detalhes do produto e aes rpidas."})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Preo"}),o.jsx("span",{className:"text-sm font-semibold",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(G?.price??G?.salePrice??0))})]}),G?.category?o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Categoria"}),o.jsx("span",{className:"text-sm font-medium",children:G.category})]}):null,o.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[typeof G?.stock<"u"&&o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("div",{className:"text-xs text-text-secondary",children:"Estoque"}),o.jsx("div",{className:"text-base font-semibold",children:G.stock})]}),typeof G?.minStock<"u"&&o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("div",{className:"text-xs text-text-secondary",children:"Mnimo"}),o.jsx("div",{className:"text-base font-semibold",children:G.minStock})]}),o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("div",{className:"text-xs text-text-secondary",children:"Na Comanda"}),o.jsxs("div",{className:"text-base font-semibold",children:["x",ct.get(G?.id)||0]})]})]})]}),o.jsxs(Un,{className:"flex items-center justify-between gap-2",children:[o.jsxs(oe,{variant:"ghost",size:"sm",className:"mr-auto inline-flex items-center gap-1",onClick:()=>{G&&t("/produtos",{state:{productId:G.id,productName:G.name}})},children:[o.jsx(ns,{className:"w-4 h-4"}),o.jsx("span",{children:"Info"})]}),o.jsx(oe,{variant:"outline",onClick:()=>{Be(!1),me(null)},children:"Fechar"}),o.jsx(oe,{onClick:async()=>{G&&(await Gt(G,{skipClientCheck:!1}),Be(!1),me(null))},children:"Adicionar"})]})]})}),o.jsx(ln,{open:kt,onOpenChange:Nt,children:o.jsxs(on,{className:"sm:max-w-xl w-[92vw] max-h-[85vh] flex flex-col overflow-hidden animate-none",onOpenAutoFocus:J=>J.preventDefault(),onKeyDown:J=>J.stopPropagation(),children:[o.jsxs(nn,{children:[o.jsx(rn,{className:"text-xl font-bold",children:"Adicionar Produtos"}),o.jsx(_n,{children:"Busque e adicione produtos  comanda do balco."})]}),o.jsx("div",{className:"p-4 pt-0",children:o.jsxs("div",{className:"relative",children:[o.jsx(pi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(or,{placeholder:"Buscar produto...",className:"pl-9",value:De,onChange:J=>st(J.target.value)})]})}),o.jsxs("div",{className:"flex-1 overflow-y-auto px-4 pb-4 thin-scroll",children:[o.jsx("ul",{className:"space-y-2",children:(i||[]).filter(J=>{const Ye=(De||"").toLowerCase();if(!Ye)return!0;const Xe=String(J.name||J.descricao||"").toLowerCase(),it=String(J.code||J.codigo||"").toLowerCase();return Xe.includes(Ye)||it.includes(Ye)}).sort((J,Ye)=>{const Xe=J.code?parseInt(J.code,10):999999,it=Ye.code?parseInt(Ye.code,10):999999;return Xe-it}).map(J=>{const Ye=ct.get(J.id)||0,Xe=Number(J.stock??J.currentStock??0),it=Math.max(0,Xe-Ye),Ze=Number(J.salePrice??J.price??0);return o.jsxs("li",{className:"flex items-center p-2 rounded-md hover:bg-surface-2 transition-colors border border-border/40",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("p",{className:"font-semibold truncate max-w-[200px]",title:`${J.code?`[${J.code}] `:""}${J.name}`,children:[J.code&&o.jsxs("span",{className:"text-text-muted",children:["[",J.code,"]"]})," ",J.name]}),Ye>0&&o.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-brand/15 text-brand border border-brand/30 flex-shrink-0",children:["x",Ye]}),o.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-surface-2 text-text-secondary border border-border flex-shrink-0",children:["Qtd ",it]})]}),o.jsxs("p",{className:"text-sm text-text-muted",children:["R$ ",Ze.toFixed(2)]})]}),o.jsx(oe,{size:"icon",className:"flex-shrink-0 bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",onClick:async()=>{await Gt(J)},"aria-label":`Adicionar ${J.name}`,children:o.jsx(Ka,{className:"h-4 w-4"})})]},J.id)})}),Array.isArray(i)&&i.length===0&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[o.jsx(Tv,{className:"w-16 h-16 text-text-muted mb-4"}),o.jsx("p",{className:"text-sm text-text-muted",children:"Nenhum produto encontrado."})]})]}),o.jsx(Un,{children:o.jsx(oe,{variant:"outline",onClick:()=>Nt(!1),children:"Fechar"})})]})}),o.jsxs("div",{ref:sn,className:"hidden md:flex gap-0 h-full overflow-hidden relative",children:[o.jsxs("div",{className:"flex flex-col border rounded-lg border-border overflow-hidden",style:{width:`${$t}%`},children:[o.jsxs("div",{className:"p-4 border-b border-border space-y-3 cursor-pointer",onClick:J=>{J.target.tagName==="INPUT"||J.target.tagName==="BUTTON"||J.target.closest("button")||nt.current?.focus()},children:[o.jsxs("div",{className:"relative",children:[o.jsx(pi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(or,{placeholder:"Buscar produto...",className:"pl-9",value:h,onChange:J=>v(J.target.value),onKeyDown:J=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(J.key)&&J.stopPropagation()}})]}),o.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[o.jsx("button",{onClick:()=>Ke("all"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${pt==="all"?"bg-brand text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Todos"}),o.jsx("button",{onClick:()=>Ke("available"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${pt==="available"?"bg-success text-white":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Disponvel"}),o.jsx("button",{onClick:()=>Ke("low"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${pt==="low"?"bg-warning text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Estoque Baixo"}),o.jsx("button",{onClick:()=>Ke("out"),className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${pt==="out"?"bg-destructive text-white":"bg-surface text-text-muted hover:bg-surface-2"}`,children:"Sem Estoque"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:()=>{lt("code");try{localStorage.setItem("balcao_sort_order","code")}catch{}},className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${qt==="code"?"bg-brand text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,title:"Ordenar por cdigo",children:"Cdigo"}),o.jsx("button",{onClick:()=>{lt("name");try{localStorage.setItem("balcao_sort_order","name")}catch{}},className:`px-3 py-1.5 rounded-md text-xs font-medium transition-colors whitespace-nowrap ${qt==="name"?"bg-brand text-black":"bg-surface text-text-muted hover:bg-surface-2"}`,title:"Ordenar por nome",children:"A-Z"})]})]}),o.jsx("div",{className:"flex items-center gap-4 text-sm text-text-muted cursor-pointer",onClick:()=>nt.current?.focus(),children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("kbd",{className:"px-2 py-1 bg-surface border border-border rounded text-xs font-mono",children:""}),o.jsx("span",{children:"Navegar"})]})})]}),o.jsx("div",{ref:nt,className:"flex-1 overflow-y-auto p-4 thin-scroll focus:outline-none focus:ring-2 focus:ring-brand/20",tabIndex:0,onClick:()=>nt.current?.focus(),onKeyDown:J=>{const Ye=i.filter(Ze=>{const dt=h.trim().toLowerCase(),Pt=!dt||(Ze.name||"").toLowerCase().includes(dt)||String(Ze.code||"").toLowerCase().includes(dt);if(pt==="all")return Pt;const zt=C.get(Ze.id)||0,Er=Number(Ze.stock??Ze.currentStock??0),H=Math.max(0,Er-zt);return pt==="available"?Pt&&H>0:pt==="low"?Pt&&H>0&&H<=5:pt==="out"?Pt&&H<=0:Pt}).sort((Ze,dt)=>{if(qt==="name"){const Pt=(Ze.name||"").toLowerCase(),zt=(dt.name||"").toLowerCase();return Pt.localeCompare(zt)}else{const Pt=Ze.code?parseInt(Ze.code,10):999999,zt=dt.code?parseInt(dt.code,10):999999;return Pt-zt}});if(!["ArrowDown","ArrowUp","Home","End"].includes(J.key))return;J.preventDefault();const Xe=Qe||0,it=Ye.length;if(J.key==="ArrowDown"){const Ze=Math.min(Xe+1,it-1);et(Ze),requestAnimationFrame(()=>rr.current[Ze]?.scrollIntoView({block:"nearest"}))}if(J.key==="ArrowUp"){const Ze=Math.max(Xe-1,0);et(Ze),requestAnimationFrame(()=>rr.current[Ze]?.scrollIntoView({block:"nearest"}))}if(J.key==="Home"&&(et(0),requestAnimationFrame(()=>rr.current[0]?.scrollIntoView({block:"nearest"}))),J.key==="End"){const Ze=Math.max(0,it-1);et(Ze),requestAnimationFrame(()=>rr.current[Ze]?.scrollIntoView({block:"nearest"}))}},children:(i||[]).length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center h-full py-12",children:[o.jsx(Tv,{className:"w-16 h-16 text-text-muted mb-4"}),o.jsx("p",{className:"text-lg font-semibold text-text-primary mb-2",children:"Nenhum produto cadastrado"}),o.jsx("p",{className:"text-sm text-text-muted mb-6 text-center",children:"Cadastre produtos para comear a vender"}),o.jsxs(oe,{onClick:()=>t("/produtos"),children:[o.jsx(Ka,{className:"mr-2 h-4 w-4"}),"Cadastrar Produto"]})]}):o.jsx("ul",{className:"space-y-2",children:i.filter(J=>{const Ye=h.trim().toLowerCase(),Xe=!Ye||(J.name||"").toLowerCase().includes(Ye)||String(J.code||"").toLowerCase().includes(Ye);if(pt==="all")return Xe;const it=C.get(J.id)||0,Ze=Number(J.stock??J.currentStock??0),dt=Math.max(0,Ze-it);return pt==="available"?Xe&&dt>0:pt==="low"?Xe&&dt>0&&dt<=5:pt==="out"?Xe&&dt<=0:Xe}).sort((J,Ye)=>{if(qt==="name"){const Xe=(J.name||"").toLowerCase(),it=(Ye.name||"").toLowerCase();return Xe.localeCompare(it)}else{const Xe=J.code?parseInt(J.code,10):999999,it=Ye.code?parseInt(Ye.code,10):999999;return Xe-it}}).map((J,Ye)=>{const Xe=ct.get(J.id)||0,it=C.get(J.id)||0,Ze=Number(J.stock??J.currentStock??0),dt=Math.max(0,Ze-it),Pt=Number(J.salePrice??J.price??0),zt=Ye===Qe;return o.jsx(ye.Fragment,{children:o.jsxs("li",{ref:Er=>{rr.current[Ye]=Er},className:`flex items-center gap-3 p-2 rounded-md transition-colors border-2 ${zt?"border-brand bg-brand/5":"border-transparent hover:bg-surface-2"} ${dt===0&&Xe===0?"opacity-50 cursor-not-allowed":""}`,onClick:()=>{et(Ye),nt.current?.focus()},children:[o.jsxs("div",{className:"flex-1 min-w-0 cursor-pointer",onClick:Er=>{Er.stopPropagation(),me({...J,qty:Xe,remaining:dt,price:Pt}),Be(!0)},children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsxs("p",{className:"font-semibold truncate",title:`${J.code?`[${J.code}] `:""}${J.name}`,children:[J.code&&o.jsxs("span",{className:"text-text-muted",children:["[",J.code,"]"]})," ",J.name]}),Xe>0&&o.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-brand/15 text-brand border border-brand/30 flex-shrink-0",children:["x",Xe]})]}),o.jsxs("div",{className:"flex items-center justify-between gap-3",children:[o.jsxs("p",{className:"text-sm text-text-muted",children:["R$ ",Pt.toFixed(2)]}),o.jsxs("span",{className:`text-xs font-medium whitespace-nowrap ${dt<=0?"text-destructive":dt<=5?"text-warning":"text-text-secondary"}`,children:["Estoque: ",dt]})]})]}),o.jsx(oe,{size:"icon",className:"flex-shrink-0 bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",onClick:Er=>{Er.stopPropagation(),Gt(J)},disabled:dt===0,"aria-label":`Adicionar ${J.name}`,children:o.jsx(Ka,{className:"h-4 w-4"})})]})},J.id)})})})]}),o.jsx("div",{className:"w-2 bg-border hover:bg-brand cursor-col-resize transition-colors flex-shrink-0 mx-2",onMouseDown:()=>In(!0),title:"Arraste para redimensionar"}),o.jsxs("div",{className:"flex flex-col border rounded-lg border-border overflow-hidden",style:{width:`${100-$t}%`},children:[o.jsxs("div",{className:"p-3 border-b border-border flex items-center justify-between gap-2 flex-wrap",children:[o.jsxs("div",{className:"min-w-0 flex-shrink",children:[o.jsx("div",{className:"text-xs text-text-secondary",children:"Comanda"}),o.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[o.jsx("span",{className:"text-base font-bold whitespace-nowrap",children:"Balco"}),f?o.jsx("span",{className:"truncate text-[11px] px-2 py-0.5 rounded-full border border-border bg-surface-2 text-text-secondary",children:f}):null]})]}),o.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0 flex-wrap",children:[o.jsxs(oe,{size:"sm",className:"md:hidden h-8 px-2 text-xs whitespace-nowrap bg-amber-500 hover:bg-amber-400 text-black border border-amber-500/60",disabled:!P,onClick:()=>{if(!P){e({title:"Caixa Fechado",description:"Abra o caixa antes de adicionar produtos.",variant:"warning"});return}Nt(!0)},title:"Adicionar produto",children:[o.jsx(Ka,{className:"h-4 w-4 mr-1"}),"Produto"]}),Ne&&o.jsx(oe,{size:"sm",variant:"outline",className:"h-8 px-2 text-xs whitespace-nowrap",disabled:!P,onClick:()=>{if(!P){e({title:"Caixa Fechado",description:"Abra o caixa antes de adicionar clientes.",variant:"warning"});return}Se(!0)},children:"+ Cliente"}),Ne?o.jsxs(Md,{children:[o.jsx(vp,{asChild:!0,children:o.jsx(oe,{size:"sm",className:"h-8 px-2 text-xs whitespace-nowrap bg-red-600 hover:bg-red-500 text-white border border-red-600/70 focus:outline-none focus:ring-0 focus-visible:ring-0 shadow-none",disabled:w,children:w?"Cancelando...":"Cancelar"})}),o.jsxs(Gc,{className:"sm:max-w-[420px] animate-none",onKeyDown:J=>J.stopPropagation(),children:[o.jsxs(Kc,{children:[o.jsx(Xc,{children:"Cancelar venda do balco?"}),o.jsx(Jc,{children:"Os itens sero descartados e a venda ser limpa. Esta ao no pode ser desfeita."})]}),o.jsxs(Yc,{children:[o.jsx(Qc,{children:"Voltar"}),o.jsx(Rd,{onClick:Vt,children:"Confirmar Cancelamento"})]})]})]}):o.jsx(oe,{size:"sm",variant:"outline",className:"h-8 px-2 text-xs opacity-60 cursor-not-allowed whitespace-nowrap",disabled:!0,children:"Cancelar"})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4 thin-scroll",children:Ne?l.length===0?o.jsx("div",{className:"text-center text-text-muted pt-16",children:'Comanda vazia. Use o boto "+" para adicionar produtos.'}):o.jsx("ul",{className:"space-y-3 pr-1",children:l.map(J=>o.jsxs("li",{className:"p-2 rounded-md border border-border/30 bg-surface hover:bg-surface-2 transition-colors",children:[o.jsx("div",{className:"min-w-0 flex-1",children:o.jsx("div",{className:"font-medium truncate",title:J.name,children:J.name})}),o.jsxs("div",{className:"mt-1 flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(oe,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:async Ye=>{Ye.stopPropagation();const Xe=r?.codigo_empresa;if(!Xe){e({title:"Empresa no definida",variant:"destructive"});return}const it=Number(J.quantity||1)-1;try{it<=0?(await Cv({itemId:J.id,codigoEmpresa:Xe}),c(Ze=>Ze.filter(dt=>dt.id!==J.id))):(await Vc({itemId:J.id,quantidade:it,codigoEmpresa:Xe}),c(Ze=>Ze.map(dt=>dt.id===J.id?{...dt,quantity:it}:dt)));try{const Ze=await Vv({codigoEmpresa:Xe}),dt=new Map;for(const Pt of Ze||[]){const zt=Pt.produto_id,Er=Number(Pt.quantidade||0);dt.set(zt,(dt.get(zt)||0)+Er)}E(dt)}catch(Ze){console.error("[BalcaoPage:removeItem] Erro ao atualizar estoque reservado:",Ze)}}catch(Ze){const dt=String(Ze?.message||"").toLowerCase();Ze?.code==="INSUFFICIENT_STOCK"||dt.includes("insuficiente")?e({title:"Estoque insuficiente",description:Ze?.message||"Quantidade maior que o disponvel.",variant:"warning"}):e({title:"Falha ao atualizar item",description:Ze?.message||"Tente novamente",variant:"destructive"})}},children:"-"}),o.jsx("span",{className:"w-7 text-center font-semibold",children:J.quantity}),o.jsx(oe,{size:"icon",variant:"outline",className:"h-7 w-7",onClick:async Ye=>{Ye.stopPropagation();const Xe=r?.codigo_empresa;if(!Xe){e({title:"Empresa no definida",variant:"destructive"});return}const it=Number(J.quantity||1)+1;try{await Vc({itemId:J.id,quantidade:it,codigoEmpresa:Xe}),c(Ze=>Ze.map(dt=>dt.id===J.id?{...dt,quantity:it}:dt))}catch(Ze){const dt=String(Ze?.message||"").toLowerCase();Ze?.code==="INSUFFICIENT_STOCK"||dt.includes("insuficiente")?e({title:"Estoque insuficiente",description:Ze?.message||"Quantidade maior que o disponvel.",variant:"warning"}):e({title:"Falha ao atualizar item",description:Ze?.message||"Tente novamente",variant:"destructive"})}},children:"+"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("span",{className:"font-semibold whitespace-nowrap",children:["R$ ",(Number(J.quantity)*Number(J.price)).toFixed(2)]}),o.jsxs("span",{className:"inline-flex items-center justify-center text-[11px] px-1.5 py-0.5 rounded-full bg-surface text-text-secondary border border-border",children:["x",J.quantity]})]})]})]},J.id))}):o.jsxs("div",{className:"text-center pt-12",children:[o.jsx("div",{className:"text-sm text-text-secondary mb-3",children:"Para comear, inicie uma nova venda e selecione o cliente."}),o.jsx(oe,{disabled:!P,onClick:()=>{if(!P){e({title:"Caixa Fechado",description:"Abra o caixa antes de iniciar uma venda.",variant:"warning"});return}Se(!0)},children:"Iniciar nova venda"})]})}),o.jsxs("div",{className:"p-4 border-t border-border",children:[o.jsxs("div",{className:"flex justify-between items-center text-lg font-bold mb-3",children:[o.jsx("span",{children:"Total"}),o.jsxs("span",{children:["R$ ",Cr.toFixed(2)]})]}),o.jsx(oe,{size:"lg",className:"w-full",onClick:gr,disabled:Cr<=0,children:"Finalizar Pagamento"})]})]})]}),o.jsx(ln,{open:$,onOpenChange:Y,children:o.jsxs(on,{className:"sm:max-w-xl w-[92vw] max-h-[90vh] flex flex-col overflow-hidden animate-none",onKeyDown:J=>J.stopPropagation(),children:[o.jsxs(nn,{children:[o.jsx(rn,{className:"text-2xl font-bold",children:"Fechar Conta"}),o.jsx(_n,{children:"Divida o pagamento entre clientes e vrias finalizadoras, se necessrio."})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[o.jsx("span",{children:"Total"}),o.jsxs("span",{children:["R$ ",Cr.toFixed(2)]})]}),o.jsxs("div",{className:"flex-1 space-y-2 overflow-y-auto thin-scroll pr-1",children:[o.jsx(Wt,{className:"block",children:"Pagamentos"}),(()=>null)(),(()=>null)(),(W||[]).map((J,Ye)=>{const Xe=dt=>{if(!dt)return f||"Cliente";const Pt=String(dt),zt=(Q||[]).find(H=>String(H.id)===Pt);if(zt?.nome)return zt.nome;const Er=(je||[]).find(H=>String(H.id)===Pt);return Er?.nome?Er.nome:f||"Cliente"},it=(Q||[]).length>1,Ze=(Q||[])[0]||null;return(Q||[]).filter(dt=>String(dt.id)!==String(Ze?.id||"")),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-12 gap-2 items-start",children:[o.jsx("div",{className:"sm:col-span-1 flex sm:justify-start",children:W.length>1&&Ye>0&&o.jsx(oe,{type:"button",variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>{ne(dt=>{const Pt=dt.filter(Ee=>Ee.id!==J.id);if(Pt.length===0)return[];const zt=(l||[]).reduce((Ee,Te)=>Ee+Number(Te.quantity||0)*Number(Te.price||0),0),Er=Math.floor(zt/Pt.length*100)/100,H=zt-Er*Pt.length;return Pt.map((Ee,Te)=>{const vt=Te===Pt.length-1?Er+H:Er;return Ur(Ee,vt)})})},children:o.jsx(Ml,{className:"h-4 w-4"})})}),Ye===0?o.jsx("div",{className:"sm:col-span-4",children:o.jsx("div",{className:"h-9 px-3 rounded-md border border-border bg-surface flex items-center text-sm truncate",children:Xe(Ze?.id||J.clientId)})}):it?o.jsx("div",{className:"sm:col-span-4",children:o.jsxs(En,{value:J.clientId||"",onValueChange:dt=>ne(Pt=>Pt.map(zt=>zt.id===J.id?{...zt,clientId:dt}:zt)),children:[o.jsx(Sn,{className:"w-full truncate",children:o.jsx(kn,{placeholder:"Cliente"})}),o.jsx(Cn,{children:(Q||[]).map(dt=>o.jsx(wt,{value:dt.id,children:dt.nome},dt.id))})]})}):o.jsx("div",{className:"sm:col-span-4",children:o.jsx("div",{className:"h-9 px-3 rounded-md border border-border bg-surface flex items-center text-sm truncate",children:Xe(Ze?.id||J.clientId)})}),o.jsxs("div",{className:"sm:col-span-4",children:[o.jsxs(En,{value:J.methodId||"",onValueChange:dt=>ne(Pt=>Pt.map(zt=>{if(zt.id!==J.id)return zt;const Er=ke(dt),H=Number(Er?.taxa_percentual||0);if(H>0){const Te=wr(zt)*(1+H/100);return{...zt,methodId:dt,chargeFee:!0,value:Gr(Te)}}else{const Ee=wr(zt);return{...zt,methodId:dt,chargeFee:!1,value:Gr(Ee)}}})),children:[o.jsx(Sn,{className:"w-full h-9 truncate",children:o.jsx(kn,{placeholder:"Forma de pagamento"})}),o.jsx(Cn,{children:(de||[]).map(dt=>o.jsx(wt,{value:dt.id,children:dt.nome},dt.id))})]}),(()=>{const dt=Mt(J);if(!dt)return null;const Pt=Fr(J),zt=!!J.chargeFee;return o.jsx("div",{className:"mt-1",children:o.jsxs("button",{type:"button",onClick:()=>ne(Er=>Er.map(H=>{if(H.id!==J.id)return H;const Ee=wr(H);if(!zt){const Te=Ee*(1+dt/100);return{...H,chargeFee:!0,value:Gr(Te)}}return{...H,chargeFee:!1,value:Gr(Ee)}})),className:["inline-flex items-center gap-2 px-3 py-1 rounded-sm text-xs font-medium border transition-colors",zt?"bg-black text-amber-400 border-amber-500":"bg-surface text-text-secondary border-border hover:border-border-hover"].join(" "),title:zt?"Desmarcar taxa":"Cobrar taxa",children:[o.jsx("span",{className:["inline-block h-3 w-3 rounded-sm border",zt?"bg-amber-500 border-amber-400":"bg-transparent border-border"].join(" ")}),o.jsxs("span",{children:["Taxa R$ ",Pt.toFixed(2)]})]})})})()]}),o.jsx("div",{className:"sm:col-span-3",children:o.jsx(or,{placeholder:"0,00",inputMode:"numeric",value:J.value,className:"h-9",onChange:dt=>{const Pt=(dt.target.value||"").replace(/\D/g,""),zt=Pt?Number(Pt)/100:0,Er=new Intl.NumberFormat("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(zt);ne(H=>H.map(Ee=>Ee.id===J.id?{...Ee,value:Er}:Ee))},onKeyDown:dt=>{dt.stopPropagation(),!["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(dt.key)&&(/^[0-9]$/.test(dt.key)||dt.preventDefault())},onBeforeInput:dt=>{const Pt=dt.data??"";Pt&&/\D/.test(Pt)&&dt.preventDefault()}})})]},J.id)}),o.jsx("div",{children:o.jsx(oe,{type:"button",variant:"secondary",size:"sm",onClick:()=>{ne(J=>{const Xe=Array.isArray($e)&&$e.length>0?$e:(Q||[]).map(ze=>ze.id),it=new Set(J.map(ze=>ze.clientId).filter(Boolean)),dt=(Xe||[]).filter(ze=>!it.has(ze))[0]||Xe[0]||"",Pt=de[0]?.id||"",zt=ke(Pt),Er=Number(zt?.taxa_percentual||0)>0,H=[...J,{id:le,clientId:dt,methodId:Pt,value:"",chargeFee:Er}],Ee=(l||[]).reduce((ze,at)=>ze+Number(at.quantity||0)*Number(at.price||0),0),Te=Math.floor(Ee/H.length*100)/100,vt=Ee-Te*H.length;return H.map((ze,at)=>{const Zt=at===H.length-1?Te+vt:Te;return Ur(ze,Zt)})}),K(J=>J+1)},children:"Adicionar forma"})}),(()=>{const J=wn(),Ye=dn(),Ze=(l||[]).reduce((dt,Pt)=>dt+Number(Pt.quantity||0)*Number(Pt.price||0),0)+Ye-J;return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"text-sm text-text-secondary flex justify-between",children:[o.jsx("span",{children:"Soma"}),o.jsxs("span",{children:["R$ ",J.toFixed(2)]})]}),o.jsxs("div",{className:"text-sm text-text-secondary flex justify-between",children:[o.jsx("span",{children:"Taxas"}),o.jsxs("span",{children:["R$ ",Ye.toFixed(2)]})]}),o.jsxs("div",{className:"text-sm font-semibold flex justify-between",children:[o.jsx("span",{children:"Restante"}),o.jsxs("span",{className:Math.abs(Ze)<.005?"text-success":"text-warning",children:["R$ ",Ze.toFixed(2)]})]})]})})()]})]}),o.jsxs(Un,{children:[o.jsx(oe,{variant:"outline",onClick:()=>Y(!1),disabled:q,children:"Cancelar"}),o.jsx(oe,{onClick:va,disabled:q,children:q?"Processando...":"Confirmar Pagamento"})]})]})}),o.jsx(ln,{open:Tt,onOpenChange:J=>Se(J),children:o.jsxs(on,{className:"max-w-lg",onOpenAutoFocus:J=>J.preventDefault(),onKeyDown:J=>J.stopPropagation(),children:[o.jsxs(nn,{children:[o.jsx(rn,{className:"text-2xl font-bold",children:"Identificar Cliente"}),o.jsx(_n,{children:"Selecione um cliente cadastrado para esta venda."})]}),o.jsx("div",{className:"space-y-4",children:o.jsxs("div",{className:"w-full",children:[o.jsx(Wt,{className:"mb-1 block",children:"Buscar cliente"}),o.jsxs("div",{className:"flex items-center gap-2 justify-between",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(pi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(or,{placeholder:"Nome, e-mail, telefone ou cdigo",className:"pl-9",value:tr,onChange:J=>Ce(J.target.value),onKeyDown:J=>J.stopPropagation()})]}),o.jsx(oe,{type:"button",size:"icon",title:"Cadastrar cliente",className:"ml-2 bg-brand text-black hover:bg-brand/90 border border-brand",onClick:()=>{window.location.href="/clientes"},children:o.jsx(Ka,{className:"h-4 w-4"})})]}),o.jsx("div",{className:"mt-2 max-h-48 overflow-auto border rounded-md thin-scroll",children:o.jsxs("ul",{children:[(je||[]).map(J=>{const Ye=($e||[]).includes(J.id);return o.jsxs("li",{className:`p-2 flex items-center justify-between cursor-pointer hover:bg-surface-2 ${J?.codigo===0?"bg-warning/10 border-l-4 border-warning":""} ${Ye?"bg-surface-2":""}`,onClick:()=>{Ae(Xe=>{const it=new Set(Xe||[]);it.has(J.id)?it.delete(J.id):it.add(J.id);const Ze=Array.from(it);try{localStorage.setItem(Ft.pendingClientIds,JSON.stringify(Ze))}catch{}return Ze})},children:[o.jsx("div",{children:o.jsxs("div",{className:"font-medium",children:[J.codigo!=null?String(J.codigo)+" - ":"",J.nome,J?.codigo===0&&o.jsx("span",{className:"ml-2 text-xs text-warning",children:"(Padro)"})]})}),o.jsx(Ai,{size:16,className:Ye?"text-success":"text-text-muted opacity-40"})]},J.id)}),(!je||je.length===0)&&o.jsx("li",{className:"p-2 text-sm text-text-muted",children:"Nenhum cliente encontrado."})]})})]})}),o.jsxs(Un,{children:[o.jsx(oe,{variant:"outline",onClick:()=>Se(!1),children:"Fechar"}),o.jsx(oe,{onClick:async()=>{try{const J=Array.from(new Set($e||[]));if(J.length===0){e({title:"Selecione pelo menos um cliente",variant:"warning"});return}const Ye=r?.codigo_empresa;if(n){try{const{data:Ze,error:dt}=await ve.from("comandas").select("id").eq("id",n).eq("codigo_empresa",Ye).single();if(dt||!Ze){console.error("[ClientWizard] Comanda no encontrada:",n),e({title:"Comanda invlida",description:"A comanda no existe mais. Reiniciando...",variant:"warning"}),a(null),c([]),Ue(!1),m("");try{localStorage.removeItem(Ft.comandaId),localStorage.removeItem(Ft.items),localStorage.removeItem(Ft.customerName),localStorage.removeItem(Ft.clientChosen)}catch{}Se(!1);return}}catch(Ze){console.error("[ClientWizard] Erro ao validar comanda:",Ze),e({title:"Erro de validao",variant:"destructive"});return}try{await Wv({comandaId:n,clienteIds:J,nomesLivres:[],codigoEmpresa:Ye})}catch(Ze){if(Ze?.message?.includes("violates foreign key")){console.error("[ClientWizard] Foreign key error, limpando cache:",Ze),a(null),c([]);try{localStorage.removeItem(Ft.comandaId),localStorage.removeItem(Ft.items)}catch{}e({title:"Comanda invlida",description:"Reinicie a venda.",variant:"destructive"}),Se(!1);return}if(!Ze?.message?.includes("duplicate"))throw Ze;console.log("Alguns clientes j estavam vinculados, continuando...")}const it=(await Zi({comandaId:n,codigoEmpresa:Ye})||[]).map(Ze=>Ze?.nome).filter(Boolean);m(it.length?it.join(", "):""),Ue(!0),Se(!1)}else{if(!Ye){e({title:"Empresa no definida",variant:"destructive"});return}try{const Xe=await Nj({codigoEmpresa:Ye});if(!Xe?.id){e({title:"Falha ao abrir venda",description:"No foi possvel criar a comanda.",variant:"destructive"});return}const it=Xe.id;await Wv({comandaId:it,clienteIds:J,nomesLivres:[],codigoEmpresa:Ye}),a(it);const Ze=(je||[]).filter(Pt=>J.includes(Pt.id)).map(Pt=>Pt?.nome).filter(Boolean),dt=Ze.length?Ze.join(", "):"";m(dt),Ue(!0);try{localStorage.setItem(Ft.comandaId,String(it)),localStorage.setItem(Ft.customerName,dt||""),localStorage.setItem(Ft.clientChosen,"true"),localStorage.removeItem(Ft.pendingClientIds)}catch{}try{await Ot(it,2)}catch{}Se(!1)}catch(Xe){console.error("[ClientWizard] Erro ao criar comanda de balco:",Xe),e({title:"Falha ao iniciar venda",description:Xe?.message||"Tente novamente.",variant:"destructive"});return}}if(x){const Xe=x;b(null),await Gt(Xe,{skipClientCheck:!0})}}catch(J){e({title:"Falha ao iniciar venda",description:J?.message||"Tente novamente",variant:"destructive"})}},children:"Confirmar"})]})]})}),o.jsx(ln,{open:!!Z,onOpenChange:J=>!J&&ee(null),children:o.jsx(on,{className:"sm:max-w-[425px]",children:Z&&o.jsxs(o.Fragment,{children:[o.jsxs(nn,{children:[o.jsx(rn,{className:"text-lg",children:Z.name}),o.jsx(_n,{className:"text-sm",children:"Detalhes do item"})]}),o.jsxs("div",{className:"grid gap-4 py-4",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("p",{className:"text-sm font-medium",children:"Preo Unitrio"}),o.jsxs("p",{className:"text-lg font-bold",children:["R$ ",Number(Z.price).toFixed(2)]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("p",{className:"text-sm font-medium",children:"Quantidade"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(oe,{size:"sm",variant:"outline",className:"h-8 w-8 p-0",onClick:async J=>{J.stopPropagation();const Ye=r?.codigo_empresa;if(!Ye){e({title:"Empresa no definida",variant:"destructive"});return}const Xe=Math.max(0,Z.quantity-1);try{Xe<=0?(await Cv({itemId:Z.id,codigoEmpresa:Ye}),ee(null)):(await Vc({itemId:Z.id,quantidade:Xe,codigoEmpresa:Ye}),ee({...Z,quantity:Xe}));const it=await Ci({comandaId:n,codigoEmpresa:Ye});c((it||[]).map(Ze=>({id:Ze.id,productId:Ze.produto_id,name:Ze.descricao||"Item",price:Number(Ze.preco_unitario||0),quantity:Number(Ze.quantidade||1)})))}catch(it){e({title:"Erro ao atualizar quantidade",description:it?.message||"Tente novamente",variant:"destructive"})}},children:"-"}),o.jsx("span",{className:"w-8 text-center font-semibold",children:Z.quantity}),o.jsx(oe,{size:"sm",variant:"outline",className:"h-8 w-8 p-0",onClick:async J=>{J.stopPropagation();const Ye=r?.codigo_empresa;if(!Ye){e({title:"Empresa no definida",variant:"destructive"});return}const Xe=Z.quantity+1;try{await Vc({itemId:Z.id,quantidade:Xe,codigoEmpresa:Ye}),ee({...Z,quantity:Xe});const it=await Ci({comandaId:n,codigoEmpresa:Ye});c((it||[]).map(Ze=>({id:Ze.id,productId:Ze.produto_id,name:Ze.descricao||"Item",price:Number(Ze.preco_unitario||0),quantity:Number(Ze.quantidade||1)})))}catch(it){e({title:"Erro ao atualizar quantidade",description:it?.message||"Tente novamente",variant:"destructive"})}},children:"+"})]})]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("p",{className:"text-sm font-medium",children:"Subtotal"}),o.jsxs("p",{className:"text-lg font-bold",children:["R$ ",(Z.quantity*Z.price).toFixed(2)]})]})]}),o.jsx(Un,{children:o.jsx(oe,{variant:"destructive",onClick:async()=>{try{const J=r?.codigo_empresa;if(!J){e({title:"Empresa no definida",variant:"destructive"});return}await Cv({itemId:Z.id,codigoEmpresa:J});const Ye=await Ci({comandaId:n,codigoEmpresa:J});c((Ye||[]).map(Xe=>({id:Xe.id,productId:Xe.produto_id,name:Xe.descricao||"Item",price:Number(Xe.preco_unitario||0),quantity:Number(Xe.quantidade||1)}))),ee(null),e({title:"Item removido",variant:"success"})}catch(J){e({title:"Falha ao remover item",description:J?.message||"Tente novamente",variant:"destructive"})}},children:"Remover Item"})})]})})}),ft&&o.jsx("div",{className:"fixed left-3 right-3 z-[9999] md:hidden",role:"alert","aria-live":"assertive",style:{bottom:"calc(12px + env(safe-area-inset-bottom, 0px))"},children:o.jsxs("div",{className:"pointer-events-none flex items-start gap-2 rounded-md border border-amber-500 bg-amber-400 text-black px-3 py-2 shadow-lg",children:[o.jsx(hc,{className:"h-4 w-4 mt-0.5","aria-hidden":"true"}),o.jsx("div",{className:"text-sm font-semibold leading-snug drop-shadow-[0_1px_0_rgba(255,255,255,0.25)]",children:Nr||"Ateno"})]})})]})}async function zae({userId:e,scope:t}){if(!e||!t)return null;try{const{data:r,error:n}=await ve.from("user_ui_settings").select("settings").eq("user_id",e).eq("scope",t).maybeSingle();return n?(console.error("[user_ui_settings] getUserUISettings:error",n),null):r?.settings||null}catch(r){return console.error("[user_ui_settings] getUserUISettings:exception",r),null}}async function Uae({userId:e,scope:t,settings:r}){if(!(!e||!t))try{const n={user_id:e,scope:t,settings:r||{},updated_at:new Date().toISOString()},{error:a}=await ve.from("user_ui_settings").upsert(n,{onConflict:"user_id,scope"});a&&console.error("[user_ui_settings] saveUserUISettings:error",a)}catch(n){console.error("[user_ui_settings] saveUserUISettings:exception",n)}}function Q_(e){try{const r=new DOMParser().parseFromString(e,"text/xml"),n=r.querySelector("parsererror");if(n)throw new Error("XML invlido: "+n.textContent);const a=sat(r),i=lat(r),s=cat(r),l=dat(r),c=s.reduce((u,f)=>u+(f.valorTotal||0),0),d={produtos:s,fornecedor:i,pagamentos:l,nfe:{...a,totalNota:c},success:!0};return console.log("[XMLParser] Resultado final:",d),{data:d,success:!0}}catch(t){return console.error("[XMLParser] Erro ao fazer parse do XML:",t),{produtos:[],fornecedor:null,nfe:null,success:!1,error:t.message}}}function sat(e){const t=e.querySelector("ide");if(!t)return null;let r="";const n=e.querySelector("chNFe");if(n&&(r=n.textContent.trim()),!r){const a=e.querySelector("infNFe");if(a){const i=a.getAttribute("Id");i&&(r=i.replace("NFe",""))}}return{numero:sa(t,"nNF"),serie:sa(t,"serie"),dataEmissao:sa(t,"dhEmi"),chaveAcesso:r,tipo:sa(t,"tpNF")==="0"?"Entrada":"Sada",naturezaOperacao:sa(t,"natOp"),modelo:sa(t,"mod")||null}}function lat(e){const t=e.querySelector("emit");return t?{cnpj:sa(t,"CNPJ"),razaoSocial:sa(t,"xNome"),nomeFantasia:sa(t,"xFant"),endereco:{logradouro:sa(t,"xLgr"),numero:sa(t,"nro"),bairro:sa(t,"xBairro"),cidade:sa(t,"xMun"),uf:sa(t,"UF"),cep:sa(t,"CEP")}}:null}function cat(e){const t=e.querySelectorAll("det"),r=new Map;return t.forEach((n,a)=>{const i=n.querySelector("prod"),s=n.querySelector("imposto");if(!i)return;const l=sa(i,"cProd"),c=sa(i,"cEAN"),d=sa(i,"xProd"),u=parseFloat(sa(i,"qCom")||"0"),f=c&&c!=="SEM GTIN"?`ean:${c}`:l?`cod:${l}`:`nome:${d.toLowerCase().trim()}`;if(r.has(f)){const m=r.get(f);m.quantidade+=u,m.valorTotal+=parseFloat(sa(i,"vProd")||"0")}else{const m={codigo:l,ean:c,nome:d,ncm:sa(i,"NCM"),cest:sa(i,"CEST"),cfop:sa(i,"CFOP"),unidade:sa(i,"uCom"),quantidade:u,valorUnitario:parseFloat(sa(i,"vUnCom")||"0"),precoVenda:parseFloat(sa(i,"vUnCom")||"0"),valorTotal:parseFloat(sa(i,"vProd")||"0"),desconto:parseFloat(sa(i,"vDesc")||"0"),impostos:fat(s),descricao:d,origem:a+1};r.set(f,m)}}),Array.from(r.values())}function dat(e){const t=e.querySelectorAll("pag"),r=[];return t.forEach(n=>{const a=sa(n,"tPag"),i=parseFloat(sa(n,"vPag")||"0");a&&r.push({codigoSefaz:a,valor:i,nome:uat(a)})}),console.log("[XMLParser] Pagamentos extrados:",r),r}function uat(e){return{"01":"Dinheiro","02":"Cheque","03":"Carto de Crdito","04":"Carto de Dbito","05":"Carto da Loja",10:"Vale Alimentao",11:"Vale Refeio",12:"Vale Presente",13:"Vale Combustvel",14:"Duplicata Mercantil",15:"Boleto Bancrio",16:"Depsito Bancrio",17:"PIX Dinmico",18:"Transferncia Bancria",19:"Programa de Fidelidade",20:"PIX Esttico",21:"Crdito em Loja",22:"Pagamento Eletrnico",90:"Sem Pagamento",99:"Outros"}[e]||"Outros"}function fat(e){if(!e)return{};const t={},r=e.querySelector("ICMS");if(r){const s=r.children[0];s&&(t.icms={cst:sa(s,"CST"),csosn:sa(s,"CSOSN"),aliquota:parseFloat(sa(s,"pICMS")||"0"),valor:parseFloat(sa(s,"vICMS")||"0")})}const n=e.querySelector("PIS");if(n){const s=n.children[0];s&&(t.pis={cst:sa(s,"CST"),aliquota:parseFloat(sa(s,"pPIS")||"0"),valor:parseFloat(sa(s,"vPIS")||"0")})}const a=e.querySelector("COFINS");if(a){const s=a.children[0];s&&(t.cofins={cst:sa(s,"CST"),aliquota:parseFloat(sa(s,"pCOFINS")||"0"),valor:parseFloat(sa(s,"vCOFINS")||"0")})}const i=e.querySelector("IPI");if(i){const s=i.querySelector("IPITrib");s&&(t.ipi={cst:sa(s,"CST"),aliquota:parseFloat(sa(s,"pIPI")||"0"),valor:parseFloat(sa(s,"vIPI")||"0")})}return t}function sa(e,t){if(!e)return"";const r=e.querySelector(t);return r?r.textContent.trim():""}function Z_(e,t){const r=e.unidade?.toUpperCase().trim()||"";if(e.ean&&e.ean!=="SEM GTIN"){const a=t.find(s=>{const l=s.unit?.toUpperCase().trim()||"";return s.barcode===e.ean&&l===r});if(a)return a;const i=t.find(s=>s.barcode===e.ean);i&&console.log("[xmlParser] EAN igual mas unidade diferente (no considerar o mesmo produto):",{ean:e.ean,unidadeXML:r,unidadeSistema:(i.unit||"").toUpperCase()})}if(e.codigo){const a=t.find(s=>{const l=s.unit?.toUpperCase().trim()||"";return s.code===e.codigo&&l===r});if(a)return a;const i=t.find(s=>s.code===e.codigo);i&&console.log("[xmlParser] Cdigo igual mas unidade diferente (no considerar o mesmo produto):",{codigo:e.codigo,unidadeXML:r,unidadeSistema:(i.unit||"").toUpperCase()})}const n=e.nome?.toLowerCase().trim()||"";if(n){const a=t.find(i=>{const s=i.name?.toLowerCase().trim()||"",l=i.unit?.toUpperCase().trim()||"",c=s===n,d=l===r,u=c&&d;return c&&!d&&(console.log("[xmlParser] Nome igual mas UNIDADE diferente - NO  o mesmo produto:"),console.log("  Nome XML:",n,"| Unidade XML:",r),console.log("  Nome Sistema:",s,"| Unidade Sistema:",l)),u&&(console.log("[xmlParser] MATCH ENCONTRADO (nome + unidade):"),console.log("  XML:",n,"| Unidade:",r),console.log("  Sistema:",s,"| Unidade:",l),console.log("  Produto:",i)),u});if(a)return console.log("[xmlParser] Produto existente encontrado por nome + unidade:",a.name,a.unit),a}return console.log("[xmlParser] Nenhum produto encontrado para:",n,"| Unidade:",r),null}function b4(e,t){const r=e.valorUnitario||0,n=30,a=r>0?r/(1-n/100):0;return{code:e.codigo||"",name:e.nome||"",barcode:e.ean&&e.ean!=="SEM GTIN"?e.ean:"",ncm:e.ncm||"",cest:e.cest||"",unit:e.unidade||"UN",costPrice:r,salePrice:a,price:a,stock:0,minStock:0,status:"active",active:!0,type:"Venda",category:"Importados",cfopInterno:e.cfop||"",cstIcmsInterno:e.impostos?.icms?.cst||"",csosnInterno:e.impostos?.icms?.csosn||"",aliqIcmsInterno:e.impostos?.icms?.aliquota||0,cstPisEntrada:e.impostos?.pis?.cst||"",aliqPisPercent:e.impostos?.pis?.aliquota||0,aliqCofinsPercent:e.impostos?.cofins?.aliquota||0,cstIpi:e.impostos?.ipi?.cst||"",aliqIpiPercent:e.impostos?.ipi?.aliquota||0,codigo_empresa:t,importedViaXML:!0,dataImportacao:new Date,xmlChave:e?.xmlChave||null,xmlNumero:e?.xmlNumero||null,xmlSerie:e?.xmlSerie||null,xmlEmissao:e?.xmlEmissao||null}}async function mat(e,t){if(!e||!t)return null;const r=e.replace(/\D/g,"");try{const{data:n,error:a}=await ve.from("clientes").select("*").eq("codigo_empresa",t).eq("cnpj",r).eq("flag_fornecedor",!0).maybeSingle();if(a)throw a;return n}catch(n){throw console.error("[Suppliers] Erro ao buscar fornecedor:",n),n}}async function hat(e,t){if(!e||!t)throw new Error("Dados do fornecedor e cdigo da empresa so obrigatrios");const r=e.cnpj?.replace(/\D/g,"")||"";if(!r)throw new Error("CNPJ do fornecedor no encontrado no XML");const n={codigo_empresa:t,tipo_pessoa:"PJ",cnpj:r,nome:e.razaoSocial||"Fornecedor Importado",apelido:e.nomeFantasia||e.razaoSocial,flag_fornecedor:!0,flag_cliente:!1,status:"active",endereco:e.endereco?.logradouro||null,numero:e.endereco?.numero||null,bairro:e.endereco?.bairro||null,cidade:e.endereco?.cidade||null,uf:e.endereco?.uf||null,cep:e.endereco?.cep?.replace(/\D/g,"")||null};try{const{data:a,error:i}=await ve.from("clientes").insert(n).select().single();if(i)throw i;return console.log("[Suppliers] Fornecedor criado:",a),a}catch(a){throw console.error("[Suppliers] Erro ao criar fornecedor:",a),a}}async function pat(e,t){if(!e?.cnpj)throw new Error("CNPJ do fornecedor no encontrado no XML");try{const r=await mat(e.cnpj,t);return r?(console.log("[Suppliers] Fornecedor encontrado:",r.razao_social),r):(console.log("[Suppliers] Criando novo fornecedor:",e.razaoSocial),await hat(e,t))}catch(r){throw console.error("[Suppliers] Erro ao buscar/criar fornecedor:",r),r}}async function gat(e,t){if(!e||!t)return null;try{const{data:r,error:n}=await ve.from("compras").select("*").eq("codigo_empresa",t).eq("chave_nfe",e).order("ativo",{ascending:!1}).maybeSingle();if(n)throw n;return r}catch(r){throw console.error("[Purchases] Erro ao buscar compra:",r),r}}async function vat(e){const t={codigo_empresa:e.codigoEmpresa,fornecedor_id:e.fornecedorId,chave_nfe:e.chaveNfe,numero_nfe:e.numeroNfe,serie_nfe:e.serieNfe,data_emissao:e.dataEmissao,tipo_operacao:e.tipoOperacao,natureza_operacao:e.naturezaOperacao,valor_produtos:e.valorProdutos,valor_total:e.valorTotal,forma_pagamento:e.formaPagamento||null,status:"processada",observacoes:e.observacoes||null,xml_completo:e.xmlCompleto||null};try{const{data:r,error:n}=await ve.from("compras").insert(t).select().single();if(n)throw n;return console.log("[Purchases] Compra criada:",r.numero_nfe,"ID:",r.id),r}catch(r){throw console.error("[Purchases] Erro ao criar compra:",r),r}}async function Vae(e,t){if(!e||!t||t.length===0)throw new Error("ID da compra e itens so obrigatrios");const r=t.map(n=>({compra_id:e,produto_id:n.produtoId||null,codigo_produto_xml:n.codigoProdutoXML||null,nome_produto_xml:n.nomeProdutoXML,ean_xml:n.eanXML||null,ncm_xml:n.ncmXML||null,cfop_xml:n.cfopXML||null,unidade_xml:n.unidadeXML||null,quantidade:n.quantidade,valor_unitario:n.valorUnitario,valor_total:n.valorTotal,valor_desconto:n.valorDesconto||0,valor_frete:n.valorFrete||0,valor_seguro:n.valorSeguro||0,valor_outras_despesas:n.valorOutrasDespesas||0,icms_aliquota:n.icmsAliquota||null,icms_valor:n.icmsValor||null,ipi_aliquota:n.ipiAliquota||null,ipi_valor:n.ipiValor||null,pis_aliquota:n.pisAliquota||null,pis_valor:n.pisValor||null,cofins_aliquota:n.cofinsAliquota||null,cofins_valor:n.cofinsValor||null,vinculado_manualmente:n.vinculadoManualmente||!1,observacoes:n.observacoes||null,selecionado_na_importacao:n.selecionadoNaImportacao||!1}));try{const{data:n,error:a}=await ve.from("compras_itens").insert(r).select();if(a)throw a;return console.log("[Purchases] Itens criados:",n.length),n}catch(n){throw console.error("[Purchases] Erro ao criar itens:",n),n}}async function xat(e,t={}){if(!e)return{data:[],count:0};try{const r=t.page&&t.page>0?t.page:1,n=t.pageSize&&t.pageSize>0?t.pageSize:100,a=(r-1)*n,i=a+n-1;let s=ve.from("compras").select(`
				*,
				fornecedor:clientes!compras_fornecedor_id_fkey(id, nome, cnpj)
			`,{count:"exact"}).eq("codigo_empresa",e);t.apenasInativas?s=s.eq("ativo",!1):t.incluirInativas||(s=s.eq("ativo",!0)),t.status&&(s=s.eq("status",t.status)),t.fornecedorId&&(s=s.eq("fornecedor_id",t.fornecedorId)),t.dataInicio&&(s=s.gte("data_emissao",t.dataInicio)),t.dataFim&&(s=s.lte("data_emissao",t.dataFim)),s=s.order("data_emissao",{ascending:!1}).range(a,i);const{data:l,error:c,count:d}=await s;if(c)throw c;return{data:l||[],count:d??0}}catch(r){return console.error("[Purchases] Erro ao listar compras:",r),{data:[],count:0}}}async function Wae(e){try{const{data:t,error:r}=await ve.from("compras_itens").select(`
        *,
        produto:produto_id(id, nome, codigo_produto, codigo_barras, data_importacao)
      `).eq("compra_id",e).order("criado_em",{ascending:!0});if(r)throw console.error("[Purchases] Erro ao buscar itens:",r),r;return t}catch(t){throw console.error("[Purchases] Erro ao buscar itens:",t),t}}async function yat(e,t,r){if(!e||!t)throw new Error("ID da compra e motivo so obrigatrios");try{const{data:n,error:a}=await ve.from("compras").update({ativo:!1,motivo_inativacao:t,inativado_em:new Date().toISOString(),inativado_por:r}).eq("id",e).select().single();if(a)throw a;return console.log("[Purchases] Compra inativada:",e),n}catch(n){throw console.error("[Purchases] Erro ao inativar compra:",n),n}}async function bat(e){try{console.log("[Purchases] Deletando itens da compra:",e);const{error:t}=await ve.from("compras_itens").delete().eq("compra_id",e);if(t)throw console.error("[Purchases] Erro ao deletar itens:",t),t;return console.log("[Purchases] Itens deletados com sucesso"),!0}catch(t){throw console.error("[Purchases] Erro ao deletar itens:",t),t}}async function wat(e,t){try{return console.log("[Purchases] Reprocessando XML da compra:",e),await bat(e),await Vae(e,t),console.log("[Purchases] XML reprocessado com sucesso"),!0}catch(r){throw console.error("[Purchases] Erro ao reprocessar XML:",r),r}}async function jat(e,t){try{console.log("[Purchases] Atualizando compra:",e,t);const{data:r,error:n}=await ve.from("compras").update({fornecedor_id:t.fornecedorId,numero_nfe:t.numeroNfe,serie_nfe:t.serieNfe,data_emissao:t.dataEmissao,tipo_operacao:t.tipoOperacao,natureza_operacao:t.naturezaOperacao,valor_produtos:t.valorProdutos,valor_total:t.valorTotal,forma_pagamento:t.formaPagamento,observacoes:t.observacoes,atualizado_em:new Date().toISOString()}).eq("id",e).select().single();if(n)throw console.error("[Purchases] Erro ao atualizar compra:",n),n;return console.log("[Purchases] Compra atualizada:",r),r}catch(r){throw console.error("[Purchases] Erro ao atualizar compra:",r),r}}function Hae({isOpen:e,onClose:t,onSelect:r,currentProduct:n}){const{userProfile:a}=Do(),[i,s]=p.useState([]),[l,c]=p.useState(!0),[d,u]=p.useState(""),[f,m]=p.useState(null);p.useEffect(()=>{e&&a?.codigo_empresa&&h()},[e,a?.codigo_empresa]);const h=async()=>{try{c(!0),console.log("[ProductSelectionModal] Carregando produtos para empresa:",a.codigo_empresa);const x=await qu({codigoEmpresa:a.codigo_empresa,includeInactive:!1,search:""});console.log("[ProductSelectionModal] Produtos carregados:",x?.length||0),console.log("[ProductSelectionModal] Primeiro produto:",x?.[0]),console.log("[ProductSelectionModal] Estrutura do produto:",Object.keys(x?.[0]||{})),s(x||[])}catch(x){console.error("[ProductSelectionModal] Erro ao carregar produtos:",x),s([])}finally{c(!1)}},v=p.useMemo(()=>{if(console.log("[ProductSelectionModal] Filtrando produtos. Total:",i.length,"Busca:",d),!d.trim())return i;const x=d.toLowerCase().trim(),b=i.filter(w=>(w.name||w.nome)?.toLowerCase().includes(x)||(w.code||w.codigo_produto)?.toLowerCase().includes(x)||(w.barcode||w.codigo_barras)?.toLowerCase().includes(x));return console.log("[ProductSelectionModal] Produtos filtrados:",b.length),b},[i,d]),g=()=>{f?(console.log("[ProductSelectionModal] Produto selecionado para vinculao:",f),console.log("[ProductSelectionModal] ID do produto:",f.id),console.log("[ProductSelectionModal] Nome do produto:",f.name),r(f),y()):console.log("[ProductSelectionModal] ERRO: Nenhum produto selecionado")},y=()=>{u(""),m(null),t()};return o.jsx(ln,{open:e,onOpenChange:y,children:o.jsxs(on,{className:"w-[95vw] sm:max-w-3xl max-h-[80vh] overflow-hidden flex flex-col bg-black text-white border border-neutral-700",children:[o.jsxs(nn,{className:"bg-neutral-900 -mx-6 -mt-6 mb-4 px-6 py-4 border-b border-neutral-600",children:[o.jsxs(rn,{className:"flex items-center gap-2 text-white",children:[o.jsx(ud,{className:"h-5 w-5 text-yellow-500"}),"Selecionar Produto para Vinculao"]}),o.jsx(_n,{className:"text-neutral-300",children:"Busque e selecione um produto cadastrado para vincular ao item do XML"})]}),o.jsx("div",{className:"px-6 pb-4",children:o.jsxs("div",{className:"relative",children:[o.jsx(pi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-neutral-400"}),o.jsx(or,{placeholder:"Buscar por nome, cdigo do produto ou cdigo de barras...",value:d,onChange:x=>u(x.target.value),className:"pl-10 bg-neutral-900 border-neutral-600 text-white placeholder-neutral-400 focus:border-yellow-500",autoFocus:!0})]})}),o.jsx("div",{className:"flex-1 overflow-hidden flex flex-col px-6",children:l?o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-500 mb-4"}),o.jsx("p",{className:"text-neutral-400",children:"Carregando produtos..."})]})}):v.length===0?o.jsx("div",{className:"flex-1 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx(ud,{className:"h-12 w-12 text-neutral-400 mx-auto mb-4"}),o.jsx("p",{className:"text-neutral-400",children:d?"Nenhum produto encontrado":"Nenhum produto cadastrado"}),d&&o.jsx("p",{className:"text-sm text-neutral-500 mt-2",children:"Tente buscar por nome, cdigo ou cdigo de barras"})]})}):o.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:o.jsx("ul",{className:"space-y-2",children:v.map(x=>{const b=x.code||x.codigo_produto,w=x.name||x.nome||"Produto sem nome",j=x.stock||x.estoque||0,_=Number(x.salePrice||x.preco_venda||0),C=f?.id===x.id;return o.jsxs("li",{className:`flex items-center gap-3 p-3 rounded-lg transition-all cursor-pointer border-2 ${C?"border-yellow-500 bg-yellow-500/10":"border-neutral-600 bg-black hover:border-yellow-400 hover:bg-neutral-900"}`,onClick:()=>m(x),children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"flex items-center gap-2 mb-1",children:o.jsxs("p",{className:"font-semibold text-white truncate",title:`${b?`[${b}] `:""}${w}`,children:[b&&o.jsxs("span",{className:"text-neutral-400",children:["[",b,"]"]})," ",w]})}),o.jsxs("div",{className:"flex items-center justify-between gap-3",children:[o.jsxs("p",{className:"text-sm text-neutral-300",children:["R$ ",_.toFixed(2)]}),o.jsxs("span",{className:"text-xs font-medium text-neutral-400 whitespace-nowrap",children:["Estoque: ",j]})]})]}),C&&o.jsx(ih,{className:"h-5 w-5 text-yellow-500 flex-shrink-0"})]},x.id)})})})}),o.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-neutral-600 px-6 pb-6",children:[o.jsxs("div",{className:"text-sm text-neutral-400",children:[v.length," produto",v.length!==1?"s":"",d&&` encontrado${v.length!==1?"s":""}`]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(oe,{variant:"outline",onClick:y,className:"border-neutral-600 text-neutral-300 hover:bg-neutral-700",children:"Cancelar"}),o.jsxs(oe,{onClick:g,disabled:!f,className:"gap-2 bg-yellow-600 hover:bg-yellow-700 text-black",children:[o.jsx(ih,{className:"h-4 w-4"}),"Vincular Produto"]})]})]})]})})}function Gae({isOpen:e,onClose:t,onConfirm:r,products:n,editedProducts:a,isReprocess:i=!1,allProducts:s=[]}){if(!e||!n)return null;const l=n.filter(d=>d.selected),c=l.reduce((d,u,f)=>{const m=u.originalIndex!==void 0?u.originalIndex:f,h=a[m]||{},v=h.linkedProductId,g=h.updatePrice,y=Number(h.quantity||h.qty||u.xml?.quantidade||0);let x=0;if(h.salePrice!=null?x=Number(h.salePrice):h.margin!=null&&u.xml?.valorUnitario?x=Number(u.xml.valorUnitario)*(1+h.margin/100):u.xml?.precoVenda&&(x=Number(u.xml.precoVenda)),u.isNew&&!v)d.newProducts.push({name:h.name||u.xml?.nome,quantity:y,price:x,total:y*(u.xml?.valorUnitario||0),xmlName:u.xml?.nome});else if(v||u.existing){const b=v&&s.find(E=>E.id===v)||u.existing,w=Number(b?.stock||0),j=Number(b?.preco_venda||b?.salePrice||b?.price||0),_=i?0:y,C=i?w:w+y;d.updatedProducts.push({name:b?.name||h.name||u.xml?.nome,currentStock:w,newStock:C,stockChange:_,currentPrice:j,newPrice:g?x:j,priceChange:g?x-j:0,willUpdatePrice:g,total:y*(u.xml?.valorUnitario||0),xmlName:u.xml?.nome,isLinked:!!v,linkedProductId:v,linkedProductName:v?b?.name:null})}else v&&d.linkedProducts.push({xmlName:u.xml?.nome,linkedName:h.name||u.xml?.nome,quantity:y,total:y*(u.xml?.valorUnitario||0),linkedProductId:v});return d.totalValue+=y*(u.xml?.valorUnitario||0),d.totalItems+=y,d},{newProducts:[],updatedProducts:[],linkedProducts:[],totalValue:0,totalItems:0});return o.jsx(ln,{open:e,onOpenChange:t,children:o.jsxs(on,{className:"max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[o.jsx(nn,{children:o.jsxs(rn,{className:"flex items-center gap-2",children:[o.jsx(Af,{className:"h-5 w-5 text-warning"}),"Confirmar ",i?"Reprocessamento":"Importao"]})}),o.jsxs("div",{className:"flex-1 overflow-y-auto space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"bg-surface border border-border rounded-lg p-4",children:[o.jsxs("div",{className:"flex items-center gap-2 text-text-primary mb-2",children:[o.jsx(ud,{className:"h-4 w-4 text-warning"}),o.jsx("span",{className:"font-medium",children:"Total de Produtos"})]}),o.jsx("p",{className:"text-2xl font-bold text-text-primary",children:l.length})]}),o.jsxs("div",{className:"bg-surface border border-border rounded-lg p-4",children:[o.jsxs("div",{className:"flex items-center gap-2 text-text-primary mb-2",children:[o.jsx(Wde,{className:"h-4 w-4 text-warning"}),o.jsx("span",{className:"font-medium",children:"Total de Itens"})]}),o.jsx("p",{className:"text-2xl font-bold text-text-primary",children:c.totalItems})]}),o.jsxs("div",{className:"bg-surface border border-border rounded-lg p-4",children:[o.jsxs("div",{className:"flex items-center gap-2 text-text-primary mb-2",children:[o.jsx(Ui,{className:"h-4 w-4 text-warning"}),o.jsx("span",{className:"font-medium",children:"Valor Total"})]}),o.jsxs("p",{className:"text-2xl font-bold text-text-primary",children:["R$ ",c.totalValue.toFixed(2)]})]})]}),!i&&c.newProducts.length>0&&o.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[o.jsx("div",{className:"p-4 border-b border-border",children:o.jsxs("h3",{className:"font-semibold text-text-primary flex items-center gap-2",children:[o.jsx(Ka,{className:"h-4 w-4 text-success"}),"Produtos que sero criados (",c.newProducts.length,")"]})}),o.jsx("div",{className:"p-4 space-y-3",children:c.newProducts.map((d,u)=>o.jsxs("div",{className:"flex items-center justify-between p-3 bg-surface-2 rounded-lg border border-border",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-text-primary",children:d.name}),o.jsxs("p",{className:"text-sm text-text-muted",children:["Quantidade: ",d.quantity,"  Preo unit.: R$ ",(d.total/d.quantity).toFixed(2),"  Total: R$ ",d.total.toFixed(2)]})]}),o.jsx("div",{className:"text-right",children:o.jsxs("p",{className:"font-medium text-warning",children:["R$ ",d.total.toFixed(2)]})})]},u))})]}),!i&&c.updatedProducts.length>0&&o.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[o.jsx("div",{className:"p-4 border-b border-border",children:o.jsxs("h3",{className:"font-semibold text-text-primary flex items-center gap-2",children:[o.jsx(Cp,{className:"h-4 w-4 text-info"}),"Produtos que sero atualizados (",c.updatedProducts.length,")"]})}),o.jsx("div",{className:"p-4 space-y-3",children:c.updatedProducts.map((d,u)=>o.jsx("div",{className:"p-3 bg-surface-2 rounded-lg border border-border",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1",children:[d.isLinked?o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx(aH,{className:"h-4 w-4 text-warning"}),o.jsxs("p",{className:"font-medium text-text-primary",children:[d.xmlName,"  ",d.linkedProductName||d.name]})]}):o.jsx("p",{className:"font-medium text-text-primary",children:d.name}),o.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[i?o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-text-muted",children:"Estoque:"}),o.jsx("span",{className:"font-medium text-text-primary",children:d.currentStock}),o.jsx("span",{className:"text-text-muted",children:"(sem alterao no reprocesso)"})]}):o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-text-muted",children:"Estoque:"}),o.jsx("span",{className:"font-medium text-text-primary",children:d.currentStock}),o.jsx(Up,{className:"h-3 w-3 text-success"}),o.jsx("span",{className:"font-medium text-success",children:d.newStock}),o.jsxs("span",{className:"text-success",children:["(+",d.stockChange,")"]})]}),d.willUpdatePrice&&d.priceChange!==0&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-text-muted",children:"Preo:"}),o.jsxs("span",{className:"font-medium text-text-primary",children:["R$ ",d.currentPrice.toFixed(2)]}),d.priceChange>0?o.jsx(Up,{className:"h-3 w-3 text-success"}):o.jsx(aue,{className:"h-3 w-3 text-destructive"}),o.jsxs("span",{className:`font-medium ${d.priceChange>0?"text-success":"text-destructive"}`,children:["R$ ",d.newPrice.toFixed(2)]}),o.jsxs("span",{className:d.priceChange>0?"text-success":"text-destructive",children:["(",d.priceChange>0?"+":"","R$ ",d.priceChange.toFixed(2),")"]})]})]})]}),o.jsxs("div",{className:"text-right",children:[i?o.jsxs("p",{className:"text-xs text-text-muted",children:["Total NF-e (custo): R$ ",d.total.toFixed(2)]}):o.jsxs("p",{className:"text-xs text-text-muted",children:["Unit.: R$ ",(d.total/d.stockChange).toFixed(2)]}),o.jsxs("p",{className:"font-medium text-warning",children:["R$ ",d.total.toFixed(2)]})]})]})},u))})]}),i&&o.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[o.jsx("div",{className:"p-4 border-b border-border",children:o.jsxs("h3",{className:"font-semibold text-text-primary flex items-center gap-2",children:[o.jsx(Cp,{className:"h-4 w-4 text-info"}),"Itens da NF-e que sero reprocessados (",l.length,")"]})}),o.jsx("div",{className:"p-4 space-y-3",children:l.map((d,u)=>{const f=d.originalIndex!==void 0?d.originalIndex:u,m=a[f]||{},h=Number(m.quantity||m.qty||d.xml?.quantidade||0),v=Number(d.xml?.valorUnitario||0),g=h*v;return o.jsxs("div",{className:"flex items-center justify-between p-3 bg-surface-2 rounded-lg border border-border",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-text-primary",children:d.xml?.nome}),o.jsxs("p",{className:"text-sm text-text-muted",children:["Quantidade: ",h,"  Valor unit.: R$ ",v.toFixed(2),"  Total: R$ ",g.toFixed(2)]})]}),o.jsx("div",{className:"text-right",children:o.jsxs("p",{className:"font-medium text-warning",children:["R$ ",g.toFixed(2)]})})]},u)})})]}),o.jsx("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(Af,{className:"h-5 w-5 text-warning flex-shrink-0 mt-0.5"}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium text-warning mb-2",children:i?"Ateno - Reprocessamento":"Ateno - Importao"}),o.jsxs("ul",{className:"text-sm text-text-muted space-y-1",children:[i?o.jsxs(o.Fragment,{children:[o.jsx("li",{children:" Os itens atuais da compra sero substitudos pelos selecionados"}),o.jsx("li",{children:" As quantidades de estoque sero ajustadas conforme as mudanas"}),o.jsx("li",{children:" Esta ao no pode ser desfeita automaticamente"})]}):o.jsxs(o.Fragment,{children:[o.jsx("li",{children:" Os produtos selecionados sero criados ou atualizados no sistema"}),o.jsx("li",{children:" As quantidades sero adicionadas ao estoque atual"}),o.jsx("li",{children:" Uma nova compra ser registrada no histrico"})]}),o.jsx("li",{children:" Verifique cuidadosamente as informaes antes de confirmar"})]})]})]})})]}),o.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-border",children:[o.jsxs("div",{className:"text-sm text-text-muted",children:[l.length," produto",l.length!==1?"s":""," selecionado",l.length!==1?"s":""]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(oe,{variant:"outline",onClick:t,children:"Cancelar"}),o.jsxs(oe,{onClick:r,className:"gap-2",children:[o.jsx(Cp,{className:"h-4 w-4"}),"Confirmar ",i?"Reprocessamento":"Importao"]})]})]})]})})}function Nat({open:e,onOpenChange:t,products:r,codigoEmpresa:n,onSuccess:a}){const{toast:i}=oo(),[s,l]=p.useState("upload"),[c,d]=p.useState(null),[u,f]=p.useState(null),[m,h]=p.useState([]),[v,g]=p.useState(!1),[y,x]=p.useState({created:0,updated:0,errors:0,details:[]}),[b,w]=p.useState({}),[j,_]=p.useState({}),[C,E]=p.useState({isOpen:!1,productIndex:null,currentProduct:null}),[P,k]=p.useState({isOpen:!1}),M=()=>{const L=u?.nfe?.modelo;return L==="55"?"NF-e":L==="65"?"NFC-e":"NF-e / NFC-e"},S=async L=>{const W=L.target.files?.[0];if(!W){console.log("[XMLImport] Nenhum arquivo selecionado");return}if(console.log("[XMLImport] Arquivo selecionado:",W.name),!W.name.endsWith(".xml")){i({title:"Arquivo invlido",description:"Selecione um arquivo XML vlido.",variant:"destructive"});return}d(W);try{console.log("[XMLImport] Lendo contedo do arquivo...");const ne=await W.text();console.log("[XMLImport] Arquivo lido, parseando XML...");const le=Q_(ne);if(console.log("[XMLImport] XML parseado:",le),!le.success){i({title:"Erro ao ler XML",description:le.error||"XML invlido",variant:"destructive"});return}if(!le.data?.produtos||le.data.produtos.length===0){i({title:"Nenhum produto encontrado",description:"O XML no contm produtos.",variant:"warning"});return}f(le.data);let K=r;try{K=await qu({search:"",codigoEmpresa:n,includeInactive:!0})||r,console.log("[XMLImport] Produtos carregados para validao:",K.length),console.log("[XMLImport] Nomes dos produtos:",K.map(me=>me.name))}catch(G){console.warn("[XMLImport] No foi possvel carregar lista completa, usando cache:",G)}const Q=le.data.produtos.map((G,me)=>{const pe=Z_(G,K),Be={...G};if(G.impostos){const{icms:Z,pis:ee,cofins:kt,ipi:Nt}=G.impostos;Z&&(Be.icmsAliquota=Z.aliquota??Be.icmsAliquota,Be.icmsValor=Z.valor??Be.icmsValor),Nt&&(Be.ipiAliquota=Nt.aliquota??Be.ipiAliquota,Be.ipiValor=Nt.valor??Be.ipiValor),ee&&(Be.pisAliquota=ee.aliquota??Be.pisAliquota,Be.pisValor=ee.valor??Be.pisValor),kt&&(Be.cofinsAliquota=kt.aliquota??Be.cofinsAliquota,Be.cofinsValor=kt.valor??Be.cofinsValor)}return{xml:Be,existing:pe,isNew:!pe,willCreate:!pe,willUpdate:!!pe,selected:!0,index:me}});h(Q);const re={};Q.forEach((G,me)=>{G.xml.precoVenda&&(re[me]={salePrice:Number(G.xml.precoVenda)})}),console.log("[XMLImport] Pr-populando editedProducts:",re),w(re),console.log("[XMLImport] Preview preparado, mudando para step preview. Total produtos:",Q.length),l("preview")}catch(ne){console.error("[XMLImport] Erro ao processar arquivo:",ne),i({title:"Erro ao processar XML",description:ne.message,variant:"destructive"})}},I=()=>{k({isOpen:!0})},T=async()=>{k({isOpen:!1});let L="";if(c)try{L=await c.text()}catch(K){console.error("[XMLImport] Erro ao ler XML:",K),i({title:"Erro ao ler XML",description:"No foi possvel ler o arquivo XML.",variant:"destructive"});return}l("processing"),g(!0);const W={created:0,updated:0,errors:0,skipped:0,details:[],supplierId:null},ne=m.filter(K=>K.selected);if(ne.length===0){i({title:"Nenhum produto selecionado",description:"Selecione ao menos um produto para importar.",variant:"warning"}),g(!1),l("preview");return}let le=null;if(u?.fornecedor)try{le=await pat(u.fornecedor,n),W.supplierId=le.id,console.log("[XMLImport] Fornecedor processado:",le.razao_social,"ID:",le.id)}catch(K){console.error("[XMLImport] Erro ao processar fornecedor:",K),i({title:"Aviso",description:"No foi possvel criar/vincular o fornecedor, mas os produtos sero importados.",variant:"warning"})}console.log("[XMLImport] Processando apenas produtos selecionados:",ne.length);for(const K of ne){const Q=b[K.index]||{},re=Q.name||K.xml.nome,G=Q.qty!==void 0?Q.qty:Number(K.xml.quantidade),me=Q.margin,pe=Q.salePrice,Be=Q.linkedProductId;try{if(Be&&Be!=="force-new"){G>0&&await Gv({productId:Be,delta:G,codigoEmpresa:n}),W.updated++,W.details.push({produto:re,acao:`Vinculado - Estoque atualizado (+${G})`,status:"success"});continue}if(K.isNew||Be==="force-new"){const Z=b4(K.xml,n);if(Q.name&&(Z.name=Q.name),pe!=null)Z.salePrice=pe,Z.price=pe;else if(me!=null&&me>0){const ee=Z.costPrice||0;if(ee>0){const kt=ee*(1+me/100);Z.salePrice=kt,Z.price=kt}}else Z.salePrice!=null&&Z.price==null&&(Z.price=Z.salePrice);Z.stock=G,Z.initialStock=G,Z.currentStock=G,Z.importedViaXML=!0,Z.category="Importados",u?.nfe&&(Z.xmlChave=u.nfe.chaveAcesso||null,Z.xmlNumero=u.nfe.numero||null,Z.xmlSerie=u.nfe.serie||null,Z.xmlEmissao=u.nfe.dataEmissao||null);try{await J_(Z,{codigoEmpresa:n}),W.created++,W.details.push({produto:re,acao:"Criado",status:"success"})}catch(ee){if(ee.message?.includes("duplicate")||ee.message?.includes("unique constraint")){console.warn("[XMLImport] Produto j existe, tentando atualizar estoque:",K.xml.nome);const Nt=(await qu({search:K.xml.nome,codigoEmpresa:n,includeInactive:!0})).find(De=>{const st=(De.name||"").toLowerCase().trim()===(K.xml.nome||"").toLowerCase().trim(),ft=(De.unit||"").toUpperCase().trim()===(K.xml.unidade||"").toUpperCase().trim(),yt=(De.barcode||"")===(K.xml.ean||""),Nr=(De.code||"")===(K.xml.codigo||""),se=st&&ft||yt&&ft||Nr&&ft;return!se&&(yt||Nr)&&!ft&&console.log("[XMLImport] Encontrado mesmo EAN/Cdigo porm unidade diferente. NO unir:",{nomeSistema:De.name,unidadeSistema:De.unit,nomeXML:K.xml.nome,unidadeXML:K.xml.unidade,ean:K.xml.ean,codigo:K.xml.codigo}),se});if(Nt&&Number(K.xml.quantidade)>0)await Gv({productId:Nt.id,delta:Number(K.xml.quantidade)||0,codigoEmpresa:n}),W.updated++,W.details.push({produto:K.xml.nome,acao:"J existe - Estoque atualizado",status:"success"});else if(Nt)W.skipped++,W.details.push({produto:K.xml.nome,acao:"Sem quantidade para ajustar",status:"warning"});else try{console.log("[XMLImport] Duplicate report mas no encontrou por nome+unidade/EAN+unidade/cdigo+unidade. Tentando criar novo produto.");const De=b4(K.xml,n);De.salePrice!=null&&De.price==null&&(De.price=De.salePrice);const st=Number(K.xml.quantidade)||0;De.stock=st,De.initialStock=st,De.currentStock=st,await J_(De,{codigoEmpresa:n}),W.created++,W.details.push({produto:K.xml.nome,acao:"Criado aps checagem",status:"success"})}catch(De){console.warn("[XMLImport] Falhou ao criar aps duplicate:",De),W.skipped++,W.details.push({produto:K.xml.nome,acao:"Falha ao criar aps duplicate",status:"warning"})}}else throw ee}}else{const Z=Number(K.xml.quantidade)||0;if(Z>0&&await Gv({productId:K.existing.id,delta:Z,codigoEmpresa:n}),Q.updatePrice===!0){const kt=Number(K.xml.valorUnitario)||0;if(kt>0)try{const Nt={costPrice:kt};if(pe!=null)Nt.salePrice=pe,Nt.price=pe;else if(me!=null&&me>0){const De=kt*(1+me/100);Nt.salePrice=De,Nt.price=De}await C5(K.existing.id,Nt)}catch(Nt){console.warn("[XMLImport] Falha ao atualizar preo do produto existente",Nt)}}W.updated++,W.details.push({produto:K.xml.nome,acao:Z>0?`Estoque +${Z} (somado)`:"Verificado",status:"success"})}}catch(Z){console.error("[XMLImport] Erro ao processar produto:",K.xml.nome,Z),W.errors++,W.details.push({produto:K.xml.nome,acao:"Erro",status:"error",error:Z.message})}}if(u?.nfe?.chaveAcesso&&le)try{const K=await gat(u.nfe.chaveAcesso,n);let Q=K;if(!K||!K.ativo){const G={codigoEmpresa:n,fornecedorId:le.id,chaveNfe:u.nfe.chaveAcesso,numeroNfe:u.nfe.numero,serieNfe:u.nfe.serie,dataEmissao:u.nfe.dataEmissao,tipoOperacao:u.nfe.tipo||"Entrada",naturezaOperacao:u.nfe.naturezaOperacao,valorProdutos:u.nfe.totalNota||0,valorTotal:u.nfe.totalNota||0,xmlCompleto:L,formaPagamento:u.pagamentos&&u.pagamentos.length>0?u.pagamentos.map(me=>me.nome).join(", "):null};Q=await vat(G),console.log("[XMLImport] Nova compra registrada:",Q.numero_nfe)}else console.log("[XMLImport] NF-e j existe, adicionando novos itens:",K.numero_nfe),W.purchaseAlreadyExists=!0;const re=ne.map(G=>{const me=b[G.index]||{},pe=me.linkedProductId;let Be=null;return pe&&pe!=="force-new"?Be=pe:G.existing&&!pe&&(Be=G.existing.id),{produtoId:Be,codigoProdutoXML:G.xml.codigo,nomeProdutoXML:G.xml.nome,eanXML:G.xml.ean,ncmXML:G.xml.ncm,cfopXML:G.xml.cfop,unidadeXML:G.xml.unidade,quantidade:me.qty!==void 0?me.qty:Number(G.xml.quantidade),valorUnitario:Number(G.xml.valorUnitario)||0,valorTotal:Number(G.xml.valorTotal)||0,valorDesconto:G.xml.valorDesconto||0,valorFrete:G.xml.valorFrete||0,valorSeguro:G.xml.valorSeguro||0,valorOutrasDespesas:G.xml.valorOutrasDespesas||0,icmsAliquota:G.xml.icmsAliquota,icmsValor:G.xml.icmsValor,ipiAliquota:G.xml.ipiAliquota,ipiValor:G.xml.ipiValor,pisAliquota:G.xml.pisAliquota,pisValor:G.xml.pisValor,cofinsAliquota:G.xml.cofinsAliquota,cofinsValor:G.xml.cofinsValor,vinculadoManualmente:!!me.linkedProductId,observacoes:me.observacoes||null,selecionadoNaImportacao:G.selected}});await Vae(Q.id,re),console.log("[XMLImport] Itens adicionados  compra:",re.length),W.purchaseId=Q.id}catch(K){console.error("[XMLImport] Erro ao registrar compra:",K)}x(W),g(!1),l("done"),W.purchaseAlreadyExists?i({title:"NF-e j importada!",description:`Esta NF-e j existe no sistema. ${W.created} produto(s) criado(s), ${W.updated} atualizado(s).`,variant:"warning"}):W.errors===0?i({title:"Importao concluda!",description:`${W.created} produto(s) criado(s), ${W.updated} atualizado(s).`,variant:"success"}):i({title:"Importao concluda com erros",description:`${W.created} criado(s), ${W.updated} atualizado(s), ${W.errors} erro(s).`,variant:"warning"}),a&&a()},D=()=>{console.log("[XMLImport] Fechando modal"),l("upload"),d(null),f(null),h([]),w({}),_({}),x({created:0,updated:0,errors:0,details:[]}),t(!1)};ye.useEffect(()=>{e&&console.log("[XMLImport] Modal aberto. Step atual:",s)},[e,s]);const B=()=>{l("upload"),d(null),f(null),h([]),w({}),_({})},U=L=>{h(W=>W.map((ne,le)=>le===L?{...ne,selected:!ne.selected}:ne))},z=()=>{const L=m.every(W=>W.selected);h(W=>W.map(ne=>({...ne,selected:!L})))},$=(L,W,ne)=>{w(le=>({...le,[L]:{...le[L],[W]:ne}}))},Y=(L,W)=>{console.log("[XMLImportModal] handleLinkProduct chamado:",{index:L,productId:W}),console.log("[XMLImportModal] Estado editedProducts completo antes:",b),console.log("[XMLImportModal] Estado editedProducts[index] antes:",b[L]),w(ne=>{console.log("[XMLImportModal] Estado prev no setEditedProducts:",ne);const le={...ne,[L]:{...ne[L],linkedProductId:W}};return console.log("[XMLImportModal] Novo estado editedProducts:",le),le})},de=(L,W)=>!L||!W?0:L*(1+W/100),xe=(L,W,ne)=>b[L]?.[W]??ne,q=L=>{_(W=>({...W,[L]:!W[L]}))};return o.jsxs(ln,{open:e,onOpenChange:D,children:[o.jsxs(on,{className:"w-[95vw] sm:max-w-4xl max-h-[85vh] flex flex-col",children:[o.jsxs(nn,{className:"flex-shrink-0",children:[o.jsxs(rn,{className:"flex items-center gap-2 text-2xl font-bold",children:[o.jsx("span",{children:"Importar XML de Compra"}),u?.nfe&&o.jsx("span",{className:"inline-flex items-center rounded-full bg-surface-2 border border-border px-2 py-0.5 text-xs font-semibold text-text-muted uppercase tracking-wide",children:M()})]}),o.jsxs(_n,{children:[s==="upload"&&"Selecione o arquivo XML da nota fiscal de entrada",s==="preview"&&"Revise os produtos que sero importados",s==="processing"&&"Processando produtos...",s==="done"&&"Importao finalizada"]})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto px-2 py-1",children:[s==="upload"&&o.jsx("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:o.jsx("div",{className:"w-full max-w-md",children:o.jsxs("label",{htmlFor:"xml-upload",className:"flex flex-col items-center justify-center w-full h-64 border-2 border-dashed border-border rounded-lg cursor-pointer bg-surface hover:bg-surface-2 transition-colors",children:[o.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[o.jsx(LI,{className:"w-12 h-12 mb-4 text-text-muted"}),o.jsx("p",{className:"mb-2 text-sm text-text-primary font-semibold",children:"Clique para selecionar ou arraste o arquivo"}),o.jsx("p",{className:"text-xs text-text-muted",children:"Arquivo XML de NF-e (Nota Fiscal Eletrnica)"})]}),o.jsx("input",{id:"xml-upload",type:"file",accept:".xml",className:"hidden",onChange:S})]})})}),s==="preview"&&o.jsxs("div",{className:"space-y-4",children:[u?.nfe&&o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[o.jsxs("div",{className:"flex items-start justify-between gap-4 mb-3",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("h3",{className:"font-semibold mb-2",children:["Informaes da ",M()]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Nmero:"})," ",o.jsx("span",{className:"font-mono",children:u.nfe.numero})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Srie:"})," ",o.jsx("span",{className:"font-mono",children:u.nfe.serie})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Tipo:"})," ",o.jsx("span",{children:u.nfe.tipo})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Fornecedor:"})," ",o.jsx("span",{children:u.fornecedor?.razaoSocial})]})]})]}),o.jsxs("div",{className:"flex flex-col gap-2 min-w-[200px]",children:[o.jsxs("div",{className:"bg-brand/10 rounded-lg p-3 border border-brand/20",children:[o.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Valor Total NF-e"}),o.jsxs("p",{className:"text-xl font-bold text-brand",children:["R$ ",Number(u.nfe.totalNota||0).toFixed(2)]})]}),u.pagamentos&&u.pagamentos.length>0&&o.jsxs("div",{className:"bg-success/10 rounded-lg p-2.5 border border-success/20",children:[o.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Forma de Pagamento"}),o.jsx("p",{className:"text-sm font-semibold text-success",children:u.pagamentos.map(L=>L.nome).join(", ")})]})]})]}),u.nfe.chaveAcesso&&o.jsxs("div",{className:"mt-2 pt-2 border-t border-border",children:[o.jsx("span",{className:"text-text-muted text-xs",children:"Chave de Acesso:"}),o.jsx("p",{className:"font-mono text-xs break-all",children:u.nfe.chaveAcesso})]})]}),o.jsxs("div",{className:"flex items-center justify-between gap-4 px-2",children:[o.jsx(oe,{variant:"outline",size:"sm",onClick:z,children:m.every(L=>L.selected)?"Desmarcar Todos":"Selecionar Todos"}),o.jsxs("span",{className:"text-sm text-text-muted",children:[m.filter(L=>L.selected).length," de ",m.length," selecionados"]})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[o.jsx("h3",{className:"font-semibold mb-3 text-base",children:"Produtos Encontrados"}),o.jsx("div",{className:"space-y-2",children:m.map((L,W)=>{const ne=xe(W,"linkedProductId",null),le=xe(W,"name",L.xml.nome),K=xe(W,"quantity",L.xml.quantidade),Q=xe(W,"margin",L.xml.margem),re=xe(W,"salePrice",null),G=L.xml.valorUnitario||0;let me=re;me==null&&!L.isNew&&L.existing&&(me=Number(L.existing.preco_venda||L.existing.salePrice||L.existing.price||0)),me==null&&Q!=null&&(me=de(G,Q)),me==null&&L.xml.precoVenda&&(me=Number(L.xml.precoVenda));let pe=null;if(Q!=null)pe=Q;else if(me!=null&&G>0&&me>0){const Z=(me-G)/G*100;pe=Math.max(-999,Math.min(9999,Z))}const Be=j[W];return o.jsxs("div",{className:Yt("rounded-lg border transition-all",L.selected?L.isNew?"bg-success/10 border-success/30":"bg-info/10 border-info/30":"bg-surface opacity-60 border-border"),children:[o.jsxs("div",{className:"p-3 flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3",children:[o.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[o.jsx("input",{type:"checkbox",checked:L.selected,onChange:()=>U(W),className:"w-4 h-4 rounded border-border accent-warning cursor-pointer"}),o.jsx("button",{onClick:()=>q(W),className:"p-0.5 hover:bg-surface-2 rounded transition-colors",children:Be?o.jsx(L1,{className:"w-4 h-4 text-text-muted"}):o.jsx(Kx,{className:"w-4 h-4 text-text-muted"})}),o.jsx("div",{children:L.isNew?o.jsx(Ka,{className:"w-5 h-5 text-success"}):o.jsx(Cp,{className:"w-5 h-5 text-info"})})]}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-baseline justify-between gap-2",children:[o.jsxs("div",{className:"min-w-0",children:[o.jsx("p",{className:"font-semibold text-sm truncate",children:le}),o.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-text-muted mt-0.5",children:[L.xml.codigo&&o.jsxs("span",{className:"flex-shrink-0",children:["#",L.xml.codigo]}),o.jsxs("span",{children:["Qtd: ",K]})]})]}),o.jsx("div",{className:"flex-shrink-0 ml-2",children:L.isNew?o.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-success/20 text-success font-medium",children:"Novo"}):o.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-info/20 text-info font-medium",children:"Cadastrado"})})]}),o.jsxs("div",{className:"mt-1 text-[11px] text-text-muted",children:[o.jsxs("span",{children:["R$ ",Number(G).toFixed(2),me?`  R$ ${me.toFixed(2)}`:""]}),pe!=null&&o.jsxs("span",{className:"ml-2 "+(pe>0?"text-success":pe<0?"text-destructive":"text-text-muted"),children:[pe.toFixed(1),"%"]})]})]})]}),Be&&o.jsxs("div",{className:"px-3 pb-3 pt-0 space-y-3 border-t border-border/50",children:[o.jsxs("div",{className:"mt-3",children:[o.jsx("label",{className:"text-sm font-medium text-text-primary mb-1 block",children:"Nome do Produto"}),o.jsx("input",{type:"text",value:le,onChange:Z=>$(W,"name",Z.target.value),disabled:!L.selected,className:"w-full px-3 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 disabled:cursor-not-allowed"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Quantidade"}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{type:"button",onClick:()=>$(W,"qty",Math.max(0,K-1)),disabled:!L.selected||K<=0,className:"w-9 h-9 rounded-md border border-border bg-surface hover:bg-surface-2 disabled:opacity-30 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:o.jsx(gv,{className:"w-4 h-4"})}),o.jsx("input",{type:"text",value:K,onChange:Z=>{const ee=Z.target.value.replace(/\D/g,"");$(W,"qty",ee===""?0:Number(ee))},disabled:!L.selected,className:"w-14 text-center px-2 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50"}),o.jsx("button",{type:"button",onClick:()=>$(W,"qty",K+1),disabled:!L.selected,className:"w-9 h-9 rounded-md bg-warning hover:bg-warning/90 disabled:opacity-30 disabled:cursor-not-allowed transition-colors flex items-center justify-center text-black font-bold shadow-sm",children:o.jsx(Ka,{className:"w-4 h-4"})})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Margem %"}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"text",value:(()=>{const Z=xe(W,"margin",null);if(Z!=null)return String(Z);if(!L.isNew&&L.existing&&G>0){const ee=Number(L.existing.preco_venda||L.existing.salePrice||L.existing.price||0);if(ee>0)return((ee-G)/G*100).toFixed(1)}return""})(),onChange:Z=>{const ee=Z.target.value;if(ee===""){$(W,"margin",null);return}const kt=ee.replace(/[^0-9.,\-]/g,"").replace(",",".");if(kt==="."||kt==="-"||kt==="-.")return;const Nt=parseFloat(kt);if(!isNaN(Nt)&&($(W,"margin",Nt),G>0)){const De=de(G,Nt);$(W,"salePrice",De)}},disabled:!L.selected,placeholder:"0",className:"w-24 pl-3 pr-6 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 text-right"}),o.jsx("span",{className:"absolute right-1.5 top-1/2 -translate-y-1/2 text-sm text-text-muted pointer-events-none",children:"%"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Custo"}),o.jsx("div",{className:"px-3 py-2 bg-surface/50 rounded-md border border-border",children:o.jsxs("span",{className:"text-sm font-semibold",children:["R$ ",G.toFixed(2)]})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Preo Venda"}),o.jsxs("div",{className:"relative",children:[o.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-sm text-text-muted pointer-events-none",children:"R$"}),o.jsx("input",{type:"text",value:(()=>{const Z=xe(W,"salePrice",me);return Z==null?"":Number(Z).toFixed(2).replace(".",",")})(),onChange:Z=>{const ee=Z.target.value.replace(/\D/g,"");if(ee===""){$(W,"salePrice",null);return}const kt=Number(ee)/100;if($(W,"salePrice",kt),kt>0&&G>0){const Nt=(kt-G)/G*100;$(W,"margin",Math.round(Nt*100)/100)}},disabled:!L.selected,placeholder:"0,00",className:"w-28 pl-7 pr-3 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 text-right font-semibold text-success"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium text-text-primary mb-1 block",children:L.isNew?"Vincular a Produto Existente (Opcional)":"Ao para este Produto"}),o.jsx("div",{className:"flex gap-2",children:o.jsxs(En,{value:ne==="force-new"?"force-new":ne||(L.isNew?"new":L.existing?.id||"new"),onValueChange:Z=>{Z==="new"||Z===L.existing?.id?Y(W,null):Z==="search"?E({isOpen:!0,productIndex:W,currentProduct:L}):Y(W,Z)},disabled:!L.selected,children:[o.jsx(Sn,{className:"flex-1 hover:bg-white/5 transition-colors text-xs sm:text-sm",children:o.jsx(kn,{placeholder:L.isNew?"Criar novo":"Atualizar existente",children:ne&&ne!=="force-new"&&ne!=="new"?(()=>{const Z=r?.find(ee=>ee.id===ne);return Z?`Vinculado: ${Z.name}`:L.isNew?"Criar novo":"Atualizar existente"})():ne==="force-new"?"Criar novo (ignorar)":L.isNew?"Criar novo":"Atualizar existente"})}),o.jsxs(Cn,{className:"max-h-[300px] overflow-y-auto text-xs sm:text-sm",children:[L.isNew?o.jsx(wt,{value:"new",children:"Criar novo produto"}):o.jsxs(wt,{value:L.existing?.id||"new",children:["Atualizar: ",L.existing?.name," (Estoque: ",L.existing?.stock||0,")"]}),!L.isNew&&o.jsx(wt,{value:"force-new",children:"Criar novo (ignorar existente)"}),o.jsx(wt,{value:"search",children:"Buscar produto para vincular"})]})]})})]}),!L.isNew&&o.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:xe(W,"updatePrice",!1),onChange:Z=>$(W,"updatePrice",Z.target.checked),disabled:!L.selected,className:"w-4 h-4 rounded border-border bg-surface text-brand focus:ring-2 focus:ring-brand/50 disabled:opacity-50 disabled:cursor-not-allowed"}),o.jsx("span",{className:"text-text-secondary",children:"Atualizar preo de custo e venda deste produto"})]}),o.jsxs("div",{className:"flex flex-wrap gap-2 text-xs",children:[L.xml.codigo&&o.jsxs("span",{className:"px-2 py-1 bg-surface rounded border border-border",children:["Cdigo: ",L.xml.codigo]}),L.xml.ean&&L.xml.ean!=="SEM GTIN"&&o.jsxs("span",{className:"px-2 py-1 bg-surface rounded border border-border",children:["EAN: ",L.xml.ean]}),o.jsxs("span",{className:"px-2 py-1 bg-surface rounded border border-border",children:["Unidade: ",L.xml.unidade]})]})]})]},W)})})]}),o.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-success"}),o.jsxs("span",{children:[m.filter(L=>L.isNew&&L.selected).length," novos"]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-info"}),o.jsxs("span",{children:[m.filter(L=>!L.isNew&&L.selected).length," existentes"]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-warning"}),o.jsxs("span",{children:[m.filter(L=>b[L.index]?.linkedProductId).length," vinculados"]})]})]})]}),s==="processing"&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[o.jsx(Pm,{className:"w-12 h-12 animate-spin text-warning mb-4"}),o.jsx("p",{className:"text-lg font-semibold",children:"Processando produtos..."}),o.jsx("p",{className:"text-sm text-text-muted",children:"Aguarde enquanto importamos os produtos"})]}),s==="done"&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"bg-surface-2 rounded-lg p-6 border border-border text-center",children:[o.jsx(Ai,{className:"w-16 h-16 text-success mx-auto mb-4"}),o.jsx("h3",{className:"text-xl font-bold mb-2",children:"Importao Concluda!"}),o.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-4",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-success",children:y.created}),o.jsx("p",{className:"text-sm text-text-muted",children:"Criados"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-info",children:y.updated}),o.jsx("p",{className:"text-sm text-text-muted",children:"Atualizados"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-danger",children:y.errors}),o.jsx("p",{className:"text-sm text-text-muted",children:"Erros"})]})]})]}),y.details.length>0&&o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[o.jsx("h3",{className:"font-semibold mb-3",children:"Detalhes"}),o.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:y.details.map((L,W)=>o.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[L.status==="success"?o.jsx(Ai,{className:"w-4 h-4 text-success flex-shrink-0"}):o.jsx(hc,{className:"w-4 h-4 text-danger flex-shrink-0"}),o.jsx("span",{className:"flex-1 truncate",children:L.produto}),o.jsx("span",{className:Yt("text-xs px-2 py-1 rounded",L.status==="success"?"bg-success/20 text-success":"bg-danger/20 text-danger"),children:L.acao})]},W))})]})]})]}),o.jsxs(Un,{children:[s==="upload"&&o.jsx(oe,{variant:"outline",onClick:D,children:"Cancelar"}),s==="preview"&&o.jsxs(o.Fragment,{children:[o.jsx(oe,{variant:"outline",onClick:B,children:"Voltar"}),o.jsxs(oe,{onClick:I,disabled:m.filter(L=>L.selected).length===0,children:["Confirmar Importao (",m.filter(L=>L.selected).length," de ",m.length," produtos)"]})]}),s==="done"&&o.jsx(oe,{onClick:D,children:"Fechar"})]})]}),o.jsx(Hae,{isOpen:C.isOpen,onClose:()=>E({isOpen:!1,productIndex:null,currentProduct:null}),onSelect:L=>{console.log("[XMLImportModal] onSelect chamado com produto:",L),console.log("[XMLImportModal] Index do produto:",C.productIndex),Y(C.productIndex,L.id),E({isOpen:!1,productIndex:null,currentProduct:null})},currentProduct:C.currentProduct}),o.jsx(Gae,{isOpen:P.isOpen,onClose:()=>k({isOpen:!1}),onConfirm:T,products:m.map((L,W)=>({...L,originalIndex:W})),editedProducts:b,allProducts:r,isReprocess:!1})]})}const _at=[],Sat=[],Cat={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},w4={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},nU="produtosPage:settings";function Pat(e){const t=["Cdigo","Produto","Categoria","Tipo","Unidade","Preo Custo","Preo Venda","% Lucro","Estoque","Estoque Mn.","Validade","Status","Ativo","EAN-13","EAN-13 Caixa","Referncia","Marca","Grupo","NCM","Descrio NCM","CEST","Usar CSOSN","CFOP Interno","CST ICMS Interno","CSOSN Interno","Aliq ICMS Interno (%)","CFOP Externo","CST ICMS Externo","CSOSN Externo","Aliq ICMS Externo (%)","CST PIS Entrada","CST PIS Sada","Aliq PIS (%)","Aliq COFINS (%)","CST IPI","Aliq IPI (%)","FCP (%)","MVA (%)","Base Reduzida (%)"],r=";",n=g=>{const y=Number(g??0);return Number.isFinite(y)?y.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):"0,00"},a=g=>`R$ ${n(g)}`,i=g=>{const y=Number(g??0);return Number.isFinite(y)?y.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""},s=g=>{if(!g)return"";try{if(typeof g=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(g)){const[x,b,w]=g.split("-");return`${w}/${b}/${x}`}const y=new Date(g);if(!isNaN(y)){const x=String(y.getDate()).padStart(2,"0"),b=String(y.getMonth()+1).padStart(2,"0"),w=y.getFullYear();return`${x}/${b}/${w}`}}catch{}return String(g)},l=g=>g==="active"?"Ativo":g==="low_stock"?"Estoque Baixo":g==="inactive"?"Inativo":"",c=g=>g?"Sim":"No",d=g=>g??"",u=g=>{const y=g==null?"":String(g);return/[";\n]/.test(y)?`"${y.replace(/"/g,'""')}"`:y},f=[];f.push("\uFEFF"+t.join(r));for(const g of e){const y=[d(g.code),d(g.name),d(g.category),d(g.type),d(g.unit),a(g.costPrice),a(g.price??g.salePrice),i(g.marginPercent),Number(g.stock??0),Number(g.minStock??0),s(g.validade),l(g.status),c(g.active!==!1),d(g.barcode),d(g.barcodeBox),d(g.reference),d(g.brand),d(g.group),d(g.ncm),d(g.ncmDescription),d(g.cest),g.useCsosn?"Sim":"",d(g.cfopInterno),d(g.cstIcmsInterno),d(g.csosnInterno),i(g.aliqIcmsInterno),d(g.cfopExterno),d(g.cstIcmsExterno),d(g.csosnExterno),i(g.aliqIcmsExterno),d(g.cstPisEntrada),d(g.cstPisSaida),i(g.aliqPisPercent),i(g.aliqCofinsPercent),d(g.cstIpi),i(g.aliqIpiPercent),i(g.fcpPercent),i(g.mvaPercent),i(g.baseReduzidaPercent)].map(u).join(r);f.push(y)}const m=new Blob([f.join(`
`)],{type:"text/csv;charset=utf-8;"}),h=URL.createObjectURL(m),v=document.createElement("a");v.href=h,v.download="produtos.csv",document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(h)}function rc(e,{action:t}={}){const r=String(e?.message||e||"").toLowerCase();if(r.includes("categoria possui produtos ativos vinculados"))return{title:"No  possvel remover",description:"Existem produtos ativos vinculados a esta categoria. Inative ou recategoriz-os antes."};if(r.includes("categoria no encontrada"))return{title:"Categoria no encontrada",description:"No foi possvel localizar a categoria para desativao."};if(r.includes("duplicate key")&&r.includes("ux_produtos_empresa_codigo_produto"))return{title:"Cdigo j cadastrado",description:"J existe um produto com este cdigo na sua empresa. Informe outro cdigo."};if(r.includes("duplicate key")&&r.includes("unique constraint"))return{title:"Registro j existe",description:"J existe um registro com estes dados."};if(r.includes("permission denied")||r.includes("violates row-level security")||r.includes("rls"))return{title:"Sem permisso",description:"Voc no tem permisso para executar esta ao."};const n=r.match(/null value in column "([^"]+)" violates not-null constraint/);return n?{title:"Campo obrigatrio",description:`Preencha o campo "${n[1].replace(/_/g," ")}".`}:r.includes("invalid input syntax")||r.includes("invalid input value")?{title:"Valor invlido",description:"Revise os valores informados (formato invlido)."}:r.includes("violates check constraint")?{title:"Valor invlido",description:"Os dados informados no atendem s regras do sistema."}:r.includes("violates foreign key constraint")?r.includes("update or delete on table")?{title:"No  possvel excluir",description:"Existem registros vinculados que impedem a excluso."}:{title:"Relao invlida",description:"O registro relacionado no foi encontrado ou  invlido."}:r.includes("failed to fetch")||r.includes("networkerror")||r.includes("network error")?{title:"Falha de conexo",description:"Verifique sua internet e tente novamente."}:r.includes("timeout")?{title:"Tempo esgotado",description:"A operao demorou demais. Tente novamente."}:r.includes("rate limit")||r.includes("too many requests")||r.includes("status code 429")?{title:"Muitas solicitaes",description:"Aguarde alguns segundos e tente novamente."}:t==="save"?{title:"Falha ao salvar",description:"No foi possvel salvar o produto. Tente novamente."}:t==="delete"?{title:"Falha ao inativar",description:"No foi possvel inativar o produto."}:t==="fetch"?{title:"Erro ao carregar",description:"No foi possvel atualizar a lista de produtos."}:t==="export"?{title:"Falha ao exportar",description:"No foi possvel gerar o arquivo."}:{title:"Erro",description:e?.message||"Ocorreu um erro."}}const vE=({icon:e,title:t,value:r,subtitle:n,color:a,onClick:i,isActive:s})=>{const l=e;return o.jsxs(fr.div,{variants:w4,className:Yt("bg-surface rounded-2xl border-2 p-3 sm:p-4 flex flex-col justify-between gap-2 cursor-pointer transition-all duration-300",s?`${a}/30 border-${a}`:"border-border hover:border-border-hover"),onClick:i,children:[o.jsxs("div",{className:"flex items-center justify-between gap-2 min-w-0",children:[o.jsx("p",{className:"text-text-secondary text-xs sm:text-sm font-semibold leading-snug whitespace-nowrap overflow-hidden text-ellipsis",children:t}),o.jsx(l,{className:Yt("w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0",a)})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold text-text-primary leading-tight whitespace-nowrap overflow-hidden text-ellipsis",children:r}),o.jsx("p",{className:"hidden sm:block text-xs text-text-muted",children:n})]})]})};function Aat({open:e,onOpenChange:t,product:r,onSave:n,categories:a,onCreateCategory:i,suggestedCode:s,onRefreshProducts:l,products:c}){const{toast:d}=oo(),{userProfile:u}=Do(),[f,m]=p.useState("dados"),[h,v]=p.useState(r?.code||""),[g,y]=p.useState(r?.name||""),[x,b]=p.useState(r?.category||""),[w,j]=p.useState(r?.type||"Venda"),[_,C]=p.useState(r?.unit||"UN"),[E,P]=p.useState(r?.active??!0),[k,M]=p.useState(r?.barcode||""),[S,I]=p.useState(r?.barcodeBox||""),[T,D]=p.useState(r?.reference||""),[B,U]=p.useState(r?.brand||""),[z,$]=p.useState(r?.group||""),[Y,de]=p.useState(!!r?.allowSale),[xe,q]=p.useState(!!r?.payCommission),[L,W]=p.useState(!!r?.variablePrice),[ne,le]=p.useState(!!r?.composition),[K,Q]=p.useState(!!r?.service),[re,G]=p.useState(!!r?.hasGrid),[me,pe]=p.useState(!!r?.usePriceTable),[Be,Z]=p.useState(!!r?.fuel),[ee,kt]=p.useState(!!r?.useImei),[Nt,De]=p.useState(!!r?.stockByGrid),[st,ft]=p.useState(!!r?.showInApp),[yt,Nr]=p.useState(r?.costPrice!=null?Number(r.costPrice).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):r?.cost!=null?Number(r.cost).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""),[se,rt]=p.useState(r?.salePrice!=null?Number(r.salePrice).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):r?.price!=null?Number(r.price).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""),[mt,tr]=p.useState(r?.marginPercent!=null?String(Number(r.marginPercent).toFixed(2)).replace(".",","):""),[Ce,je]=p.useState(r?.stock?String(r.stock):""),[ae,$e]=p.useState(r?.minStock?String(r.minStock):""),[Ae,Tt]=p.useState(r?.status||"active"),[Se,Ne]=p.useState(r?.validade||null),[Ue,Qe]=p.useState(!1),[et,pt]=p.useState(!1),[Ke,qt]=p.useState(""),[lt,rr]=p.useState(!0),[nt,$t]=p.useState(!!(r?.csosnInterno||r?.csosnExterno)),[Qr,Xr]=p.useState(r?.cfopInterno||""),[In,sn]=p.useState(r?.cstIcmsInterno||""),[Qt,qr]=p.useState(r?.csosnInterno||""),[Tr,sr]=p.useState(r?.aliqIcmsInterno!=null?String(r.aliqIcmsInterno).replace(".",","):""),[$r,Gr]=p.useState(r?.cfopExterno||""),[ke,Mt]=p.useState(r?.cstIcmsExterno||""),[wr,Fr]=p.useState(r?.csosnExterno||""),[Ur,Kr]=p.useState(r?.aliqIcmsExterno!=null?String(r.aliqIcmsExterno).replace(".",","):""),[dn,wn]=p.useState(r?.cstPisEntrada||""),[va,xa]=p.useState(r?.cstPisSaida||""),[Aa,ut]=p.useState(r?.aliqPisPercent!=null?String(r.aliqPisPercent).replace(".",","):""),[Ht,dr]=p.useState(r?.aliqCofinsPercent!=null?String(r.aliqCofinsPercent).replace(".",","):""),[Ft,Ot]=p.useState(r?.cstIpi||""),[Br,Vt]=p.useState(r?.aliqIpiPercent!=null?String(r.aliqIpiPercent).replace(".",","):""),[Cr,ct]=p.useState(r?.fcpPercent!=null?String(r.fcpPercent).replace(".",","):""),[Gt,gr]=p.useState(r?.mvaPercent!=null?String(r.mvaPercent).replace(".",","):""),[J,Ye]=p.useState(r?.baseReduzidaPercent!=null?String(r.baseReduzidaPercent).replace(".",","):""),[Xe,it]=p.useState(r?.ncm||""),[Ze,dt]=p.useState(r?.ncmDescription||""),[Pt,zt]=p.useState(r?.cest||""),[Er,H]=p.useState(!1),[Ee,Te]=p.useState(!1),vt=tt=>{const Lr=String(tt||"").replace(/\D/g,"");return(Lr?Number(Lr)/100:0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})},ze=tt=>{if(!tt)return 0;const Lr=String(tt).replace(/\./g,"").replace(",","."),cn=Number(Lr);return Number.isFinite(cn)?cn:0},at=tt=>{const Lr=String(tt||"").replace(/[^\d,]/g,"");return Lr?`% ${Lr}`:""},Zt=tt=>{if(tt==null||tt==="")return 0;const Lr=String(tt).replace(/\./g,"").replace(",","."),cn=Number(Lr);return Number.isFinite(cn)?cn:0},zr=tt=>String(tt||"").replace(/\D/g,"").slice(0,13),Ar=tt=>String(tt||"").replace(/\D/g,"").slice(0,4),br=tt=>String(tt||"").replace(/\D/g,"").slice(0,8),yr=tt=>String(tt||"").replace(/\D/g,"").slice(0,7);p.useEffect(()=>{v(r?.code||""),y(r?.name||""),b(r?.category||""),j(r?.type||"Venda"),C(r?.unit||"UN"),P(r?.active??!0),M(r?.barcode||""),I(r?.barcodeBox||""),D(r?.reference||""),U(r?.brand||""),$(r?.group||""),de(!!r?.allowSale),q(!!r?.payCommission),W(!!r?.variablePrice),le(!!r?.composition),Q(!!r?.service),G(!!r?.hasGrid),pe(!!r?.usePriceTable),Z(!!r?.fuel),kt(!!r?.useImei),De(!!r?.stockByGrid),ft(!!r?.showInApp),Nr(r?.costPrice!=null?Number(r.costPrice).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):r?.cost!=null?Number(r.cost).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""),rt(r?.salePrice!=null?Number(r.salePrice).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):r?.price!=null?Number(r.price).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""),tr(r?.marginPercent!=null?String(Number(r.marginPercent).toFixed(2)).replace(".",","):""),je(r?.stock?String(r.stock):""),$e(r?.minStock?String(r.minStock):""),Tt(r?.status||"active"),Ne(r?.validade||null),$t(!!(r?.csosnInterno||r?.csosnExterno)),Xr(r?.cfopInterno||""),sn(r?.cstIcmsInterno||""),qr(r?.csosnInterno||""),sr(r?.aliqIcmsInterno!=null?String(r.aliqIcmsInterno).replace(".",","):""),Gr(r?.cfopExterno||""),Mt(r?.cstIcmsExterno||""),Fr(r?.csosnExterno||""),Kr(r?.aliqIcmsExterno!=null?String(r.aliqIcmsExterno).replace(".",","):""),wn(r?.cstPisEntrada||""),xa(r?.cstPisSaida||""),ut(r?.aliqPisPercent!=null?String(r.aliqPisPercent).replace(".",","):""),dr(r?.aliqCofinsPercent!=null?String(r.aliqCofinsPercent).replace(".",","):""),Ot(r?.cstIpi||""),Vt(r?.aliqIpiPercent!=null?String(r.aliqIpiPercent).replace(".",","):""),ct(r?.fcpPercent!=null?String(r.fcpPercent).replace(".",","):""),gr(r?.mvaPercent!=null?String(r.mvaPercent).replace(".",","):""),Ye(r?.baseReduzidaPercent!=null?String(r.baseReduzidaPercent).replace(".",","):""),it(r?.ncm||""),dt(r?.ncmDescription||""),zt(r?.cest||""),rr(!0),!r&&s&&!h&&v(s),H(!1),Te(!1)},[r,e]);const nr=p.useRef("salePrice");p.useEffect(()=>{if(nr.current==="salePrice"){const tt=ze(yt),Lr=ze(se);if(Lr>0){const cn=(Lr-tt)/Lr*100;tr(cn.toFixed(2).replace(".",","))}else tr("")}},[yt,se]),p.useEffect(()=>{if(nr.current==="marginPercent"){const tt=setTimeout(()=>{const Lr=ze(yt),cn=Zt(mt);if(console.log("[Margem] Custo:",Lr,"Margem:",cn),Lr>0&&cn>0)if(cn>=100){const pn=Lr*(1+cn/100);console.log("[Margem] Preo calculado (markup):",pn),rt(pn.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}))}else{const pn=Lr/(1-cn/100);console.log("[Margem] Preo calculado (margem):",pn),rt(pn.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}))}},500);return()=>clearTimeout(tt)}},[mt,yt]);const Zr=async tt=>{if(tt.preventDefault(),Ue)return;const Lr=[];if(g?.trim()||Lr.push("Descrio"),_?.trim()||Lr.push("Unidade"),w||Lr.push("Tipo de Produto"),ze(se)<=0&&Lr.push("Preo de Venda"),Lr.length){d({title:"Preencha os campos obrigatrios",description:Lr.join(", "),variant:"destructive"});return}console.log("[ProdutosPage] handleSave - Estado active antes de salvar:",E);let cn=Ae;E?Ae==="inactive"&&E&&(cn="active"):cn="inactive",console.log("[ProdutosPage] handleSave - Status ajustado:",cn);const pn={id:r?.id,code:h?.trim()||"",name:g,category:x,type:w,stock:Number(Ce||0),minStock:Number(ae||0),status:cn,validade:Se,unit:_,active:E,barcode:zr(k),barcodeBox:zr(S),reference:T?.trim()||null,brand:B?.trim()||null,group:z?.trim()||null,cost:ze(yt),price:ze(se),buyPrice:null,costsPercent:null,costPrice:ze(yt),salePrice:ze(se),marginPercent:Zt(mt),allowSale:Y,payCommission:xe,variablePrice:L,composition:ne,service:K,hasGrid:re,usePriceTable:me,fuel:Be,useImei:ee,stockByGrid:Nt,showInApp:st,cfopInterno:Ar(Qr)||null,cstIcmsInterno:nt?null:In||null,csosnInterno:nt&&Qt||null,aliqIcmsInterno:Zt(Tr),cfopExterno:Ar($r)||null,cstIcmsExterno:nt?null:ke||null,csosnExterno:nt&&wr||null,aliqIcmsExterno:Zt(Ur),cstPisEntrada:dn||null,cstPisSaida:va||null,aliqPisPercent:Zt(Aa),aliqCofinsPercent:Zt(Ht),cstIpi:Ft||null,aliqIpiPercent:Zt(Br),fcpPercent:Zt(Cr),mvaPercent:Zt(Gt),baseReduzidaPercent:Zt(J),ncm:br(Xe)||null,ncmDescription:Ze||null,cest:yr(Pt)||null};try{Qe(!0),console.log("[Produtos] Salvando produto",pn);const jn=2e4,Gn=new Promise((Ln,aa)=>setTimeout(()=>aa(new Error("Timeout ao salvar produto (20s)")),jn));await Promise.race([n(pn),Gn]),d({title:"Produto salvo",description:"O produto foi salvo com sucesso.",variant:"success",duration:4e3,className:"bg-amber-500 text-black shadow-xl"}),t(!1)}catch(jn){console.error("[Produtos] Erro ao salvar",jn);const Gn=rc(jn,{action:"save"});d({title:Gn.title,description:Gn.description,variant:"destructive",duration:6e3})}finally{Qe(!1)}};return p.useEffect(()=>{e||Qe(!1)},[e]),o.jsxs(ln,{open:e,onOpenChange:t,children:[o.jsxs(on,{className:"w-[90vw] sm:max-w-[780px] max-h-[80vh] sm:max-h-[85vh] flex flex-col",onKeyDown:tt=>{tt.key==="F5"&&(tt.preventDefault(),Zr(tt)),tt.key==="Escape"&&(tt.preventDefault(),t(!1))},children:[o.jsx(nn,{children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{children:[o.jsx(rn,{className:"text-lg sm:text-xl",children:r?"Detalhes do Produto":"Novo Produto"}),o.jsx(_n,{className:"text-xs sm:text-sm",children:"Preencha as informaes e use as abas para navegar."})]})})}),o.jsx("form",{onSubmit:Zr,className:"grid gap-4 py-2 flex-1 overflow-y-auto pr-1 fx-scroll",children:o.jsxs(Fd,{value:f,onValueChange:m,className:"w-full",children:[o.jsx("div",{className:"sm:hidden mb-4",children:o.jsxs(En,{value:f,onValueChange:m,children:[o.jsx(Sn,{className:"w-full",children:o.jsx(kn,{})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"dados",children:"Dados"}),o.jsx(wt,{value:"estoque",children:"Estoque"}),o.jsx(wt,{value:"preco",children:"Preo e Lucro"}),o.jsx(wt,{value:"impostos",children:"Impostos"}),o.jsx(wt,{value:"outras",children:"Outras Info"})]})]})}),o.jsxs(ad,{className:"hidden sm:grid grid-cols-5 gap-1",children:[o.jsx(wa,{value:"dados",children:"Dados"}),o.jsx(wa,{value:"estoque",children:"Estoque"}),o.jsx(wa,{value:"preco",children:"Preo e Lucro"}),o.jsx(wa,{value:"impostos",children:"Impostos"}),o.jsx(wa,{value:"outras",children:"Outras Info"})]}),o.jsx("div",{className:"mt-2 text-[10px] sm:text-[11px] text-text-muted",children:"* Campo obrigatrio"}),o.jsxs(Wi,{value:"dados",className:"space-y-3 mt-2",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsxs(Wt,{htmlFor:"code",className:"text-left sm:text-right text-xs sm:text-sm",children:["Cdigo ",o.jsx("span",{className:"text-text-muted text-[10px] sm:text-xs",children:"(auto)"})]}),o.jsx(or,{id:"code",value:h,onChange:tt=>v(tt.target.value.replace(/\D/g,"")),className:"col-span-1 sm:col-span-3 text-sm",placeholder:s||"Ex.: 0001",disabled:!lt})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsxs(Wt,{htmlFor:"name",className:"text-left sm:text-right text-xs sm:text-sm",children:["Descrio ",!g?.trim()&&o.jsx("span",{className:"text-danger",children:"*"})]}),o.jsx(or,{id:"name",value:g,onChange:tt=>y(tt.target.value),className:"col-span-1 sm:col-span-3 text-sm",disabled:!lt})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{htmlFor:"category",className:"text-left sm:text-right text-xs sm:text-sm",children:"Categoria"}),o.jsxs("div",{className:"col-span-3 flex gap-2 items-center",children:[o.jsxs(En,{value:x,onValueChange:tt=>lt&&b(tt),children:[o.jsx(Sn,{className:"w-full",disabled:!lt,children:o.jsx(kn,{placeholder:"Selecione..."})}),o.jsx(Cn,{children:a.map(tt=>o.jsx(wt,{value:tt,children:tt},tt))})]}),o.jsxs(oe,{type:"button",onClick:()=>pt(tt=>!tt),className:"bg-amber-500 hover:bg-amber-400 text-black inline-flex items-center gap-2 whitespace-nowrap px-3",title:et?"Fechar":"Adicionar nova categoria",disabled:!lt,children:[o.jsx("span",{className:"font-bold",children:"+"}),o.jsx("span",{children:"Novo"})]})]})]}),et&&o.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[o.jsx("div",{className:"col-span-1"}),o.jsxs("div",{className:"col-span-3 flex gap-2",children:[o.jsx(or,{value:Ke,onChange:tt=>qt(tt.target.value),placeholder:"Nome da nova categoria"}),o.jsx(oe,{type:"button",onClick:async()=>{const tt=Ke.trim();if(tt)try{if(a.includes(tt)){d({title:"Categoria j existe",description:"Escolha outro nome.",variant:"destructive"});return}await i?.(tt),b(tt),qt(""),pt(!1),d({title:"Categoria adicionada",description:"Ela j est selecionada no formulrio.",variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(Lr){console.error("[Produto] add category inline:error",Lr);const cn=rc(Lr,{action:"save"});d({title:cn.title,description:cn.description,variant:"destructive"})}},children:"Adicionar"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsxs(Wt,{htmlFor:"unit",className:"text-left sm:text-right text-xs sm:text-sm",children:["Unidade ",!_?.trim()&&o.jsx("span",{className:"text-danger",children:"*"})]}),o.jsxs(En,{value:_,onValueChange:tt=>lt&&C(tt),children:[o.jsx(Sn,{className:"col-span-1 sm:col-span-3 text-sm",disabled:!lt,children:o.jsx(kn,{placeholder:"Selecione a unidade"})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"UN",children:"UN - Unidade"}),o.jsx(wt,{value:"CX",children:"CX - Caixa"}),o.jsx(wt,{value:"PC",children:"PC - Pea"}),o.jsx(wt,{value:"KG",children:"KG - Quilograma"}),o.jsx(wt,{value:"G",children:"G - Grama"}),o.jsx(wt,{value:"L",children:"L - Litro"}),o.jsx(wt,{value:"ML",children:"ML - Mililitro"}),o.jsx(wt,{value:"M",children:"M - Metro"}),o.jsx(wt,{value:"M2",children:"M - Metro Quadrado"}),o.jsx(wt,{value:"M3",children:"M - Metro Cbico"}),o.jsx(wt,{value:"PAR",children:"PAR - Par"}),o.jsx(wt,{value:"DZ",children:"DZ - Dzia"}),o.jsx(wt,{value:"FD",children:"FD - Fardo"}),o.jsx(wt,{value:"SC",children:"SC - Saco"}),o.jsx(wt,{value:"PT",children:"PT - Pacote"}),o.jsx(wt,{value:"SERV",children:"SERV - Servio"})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsxs(Wt,{className:"text-left sm:text-right text-xs sm:text-sm",children:["Tipo ",!w&&o.jsx("span",{className:"text-danger",children:"*"})]}),o.jsxs(En,{value:w,onValueChange:tt=>lt&&j(tt),children:[o.jsx(Sn,{className:"col-span-1 sm:col-span-3 text-sm",disabled:!lt,children:o.jsx(kn,{placeholder:"Selecione o tipo"})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"Venda",children:"Produto para Venda"}),o.jsx(wt,{value:"Uso Interno",children:"Produto de Uso Interno"})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{className:"text-left sm:text-right text-xs sm:text-sm",children:"Ativo"}),o.jsx("div",{className:"col-span-1 sm:col-span-3",children:r?o.jsxs(o.Fragment,{children:[o.jsx(Bo,{checked:E,onCheckedChange:tt=>{console.log("[ProdutosPage] Checkbox active mudou para:",tt),P(!!tt)},disabled:!lt}),o.jsx("span",{className:"ml-2 text-xs sm:text-sm",children:"Ativo"})]}):o.jsxs(En,{value:E?"ativo":"inativo",onValueChange:tt=>{console.log("[ProdutosPage] Select active mudou para:",tt),P(tt==="ativo")},children:[o.jsx(Sn,{className:"w-full sm:w-48 text-sm",disabled:!lt,children:o.jsx(kn,{placeholder:"Selecione"})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"ativo",children:"Ativo"}),o.jsx(wt,{value:"inativo",children:"Inativo"})]})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{htmlFor:"barcode",className:"text-left sm:text-right text-xs sm:text-sm",children:"EAN-13"}),o.jsx(or,{id:"barcode",value:k,onChange:tt=>M(zr(tt.target.value)),className:"col-span-1 sm:col-span-3 text-sm",placeholder:"789...",disabled:!lt})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsxs(Wt,{htmlFor:"validade",className:"text-left sm:text-right text-xs sm:text-sm",children:["Validade ",o.jsx("span",{className:"text-text-muted text-[10px] sm:text-xs",children:"(Opcional)"})]}),o.jsxs(xc,{children:[o.jsx(yc,{asChild:!0,children:o.jsxs(oe,{variant:"outline",className:Yt("col-span-1 sm:col-span-3 justify-start text-left font-normal text-xs sm:text-sm",!Se&&"text-muted-foreground"),disabled:!lt,children:[o.jsx(dj,{className:"mr-2 h-3 w-3 sm:h-4 sm:w-4"}),Se?Jt(Se,"dd/MM/yyyy"):o.jsx("span",{children:"Selecione a data"})]})}),o.jsx(Rl,{className:"p-0 w-[280px] sm:w-[300px]",children:o.jsx("div",{className:"w-[280px] sm:w-[300px] min-h-[300px] sm:min-h-[332px]",children:o.jsx(bc,{mode:"single",selected:Se,onSelect:Ne,initialFocus:!0,fixedWeeks:!0})})})]})]})]}),o.jsx(Wi,{value:"estoque",className:"space-y-3 mt-2",children:o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"grid grid-cols-2 items-center gap-2",children:[o.jsx(Wt,{htmlFor:"stock",className:"text-right",children:"Estoque"}),o.jsx(or,{id:"stock",value:Ce,onChange:tt=>je(tt.target.value.replace(/[^0-9]/g,"")),disabled:!lt,className:"col-span-1",inputMode:"numeric"})]}),o.jsxs("div",{className:"grid grid-cols-2 items-center gap-4",children:[o.jsx(Wt,{htmlFor:"minStock",className:"text-right",children:"Estoque Mn."}),o.jsx(or,{id:"minStock",value:ae,onChange:tt=>$e(tt.target.value.replace(/[^0-9]/g,"")),disabled:!lt,inputMode:"numeric"})]})]})}),o.jsxs(Wi,{value:"preco",className:"space-y-3 mt-2",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{htmlFor:"costPrice",className:"text-xs sm:text-right",children:"Preo de Custo (R$)"}),o.jsx(or,{id:"costPrice",inputMode:"numeric",placeholder:"Ex.: 10,00",value:`R$ ${yt||"0,00"}`,onChange:tt=>{Nr(vt(tt.target.value))},disabled:!lt,className:"sm:col-span-3 text-xs sm:text-sm"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsxs(Wt,{htmlFor:"salePrice",className:"text-xs sm:text-right",children:["Preo de Venda (R$) ",(!se||ze(se)<=0)&&o.jsx("span",{className:"text-danger",children:"*"})]}),o.jsx(or,{id:"salePrice",inputMode:"numeric",placeholder:"Ex.: 15,00",value:`R$ ${se||"0,00"}`,onChange:tt=>{nr.current="salePrice",rt(vt(tt.target.value))},disabled:!lt,className:"sm:col-span-3 text-xs sm:text-sm"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{htmlFor:"marginPercent",className:"text-xs sm:text-right",children:"% de Lucro (Margem)"}),o.jsx(or,{id:"marginPercent",type:"text",placeholder:"Ex.: 40",value:mt?`% ${mt}`:"",onChange:tt=>{nr.current="marginPercent";const Lr=tt.target.value.replace(/[^\d,]/g,"");tr(Lr)},onBlur:()=>{if(nr.current==="marginPercent"){const tt=ze(yt),Lr=Zt(mt);if(tt>0&&Lr>0)if(Lr>=100){const cn=tt*(1+Lr/100);rt(cn.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}))}else{const cn=tt/(1-Lr/100);rt(cn.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}))}}},disabled:!lt,className:"sm:col-span-3 text-xs sm:text-sm"})]})]}),o.jsxs(Wi,{value:"impostos",className:"space-y-4 mt-2",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Bo,{id:"useCsosn",checked:nt,onCheckedChange:tt=>$t(!!tt),disabled:!lt}),o.jsx(Wt,{htmlFor:"useCsosn",className:"cursor-pointer text-xs sm:text-sm",children:"Usar CSOSN (Simples Nacional)"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold",children:"ICMS - Operao Interna"}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{className:"text-xs sm:text-right",children:"CFOP"}),o.jsx(or,{value:Qr,onChange:tt=>Xr(Ar(tt.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"5102",disabled:!lt})]}),!nt&&o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{className:"text-xs sm:text-right",children:"CST"}),o.jsx(or,{value:In,onChange:tt=>sn(tt.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"00, 20, 40...",disabled:!lt})]}),nt&&o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{className:"text-xs sm:text-right",children:"CSOSN"}),o.jsx(or,{value:Qt,onChange:tt=>qr(tt.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"101, 102...",disabled:!lt})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{className:"text-xs sm:text-right",children:"Alquota ICMS (%)"}),o.jsx(or,{value:`${Tr||""}`,onChange:tt=>sr(at(tt.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"0,00",disabled:!lt})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold",children:"ICMS - Operao Externa"}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{className:"text-xs sm:text-right",children:"CFOP"}),o.jsx(or,{value:$r,onChange:tt=>Gr(Ar(tt.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"6102",disabled:!lt})]}),!nt&&o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{className:"text-xs sm:text-right",children:"CST"}),o.jsx(or,{value:ke,onChange:tt=>Mt(tt.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"00, 20, 40...",disabled:!lt})]}),nt&&o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{className:"text-xs sm:text-right",children:"CSOSN"}),o.jsx(or,{value:wr,onChange:tt=>Fr(tt.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"101, 102...",disabled:!lt})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{className:"text-xs sm:text-right",children:"Alquota ICMS (%)"}),o.jsx(or,{value:`${Ur||""}`,onChange:tt=>Kr(at(tt.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"0,00",disabled:!lt})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold",children:"PIS/COFINS"}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{className:"text-xs sm:text-right",children:"CST PIS Entrada"}),o.jsx(or,{value:dn,onChange:tt=>wn(tt.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"50, 70...",disabled:!lt})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{className:"text-xs sm:text-right",children:"CST PIS Sada"}),o.jsx(or,{value:va,onChange:tt=>xa(tt.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"01, 04...",disabled:!lt})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{className:"text-xs sm:text-right",children:"Alquota PIS (%)"}),o.jsx(or,{value:`${Aa||""}`,onChange:tt=>ut(at(tt.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"0,65",disabled:!lt})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{className:"text-xs sm:text-right",children:"Alquota COFINS (%)"}),o.jsx(or,{value:`${Ht||""}`,onChange:tt=>dr(at(tt.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"3,00",disabled:!lt})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold",children:"IPI"}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{className:"text-xs sm:text-right",children:"CST IPI"}),o.jsx(or,{value:Ft,onChange:tt=>Ot(tt.target.value.toUpperCase()),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"50, 99...",disabled:!lt})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{className:"text-xs sm:text-right",children:"Alquota IPI (%)"}),o.jsx(or,{value:`${Br||""}`,onChange:tt=>Vt(at(tt.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"0,00",disabled:!lt})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-6",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{className:"text-xs sm:text-right",children:"FCP (%)"}),o.jsx(or,{value:`${Cr||""}`,onChange:tt=>ct(at(tt.target.value)),placeholder:"2,00",disabled:!lt,className:"text-xs sm:text-sm"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{className:"text-xs sm:text-right",children:"MVA (%)"}),o.jsx(or,{value:`${Gt||""}`,onChange:tt=>gr(at(tt.target.value)),placeholder:"40,00",disabled:!lt,className:"text-xs sm:text-sm"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{className:"text-xs sm:text-right",children:"Base Reduzida (%)"}),o.jsx(or,{value:`${J||""}`,onChange:tt=>Ye(at(tt.target.value)),placeholder:"0,00",disabled:!lt,className:"text-xs sm:text-sm"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-6",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{className:"text-xs sm:text-right",children:"NCM"}),o.jsx(or,{value:Xe,onChange:tt=>it(br(tt.target.value)),placeholder:"00000000",disabled:!lt,className:"text-xs sm:text-sm"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{className:"text-xs sm:text-right",children:"CEST"}),o.jsx(or,{value:Pt,onChange:tt=>zt(yr(tt.target.value)),placeholder:"0000000",disabled:!lt,className:"text-xs sm:text-sm"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 items-start sm:items-center gap-2 sm:gap-4 sm:col-span-1",children:[o.jsx(Wt,{className:"text-xs sm:text-right",children:"Descrio NCM"}),o.jsx(or,{value:Ze,onChange:tt=>dt(tt.target.value),placeholder:"Descrio do NCM",disabled:!lt,className:"text-xs sm:text-sm"})]})]})]}),o.jsxs(Wi,{value:"outras",className:"space-y-3 mt-2",children:[r&&o.jsxs("div",{className:"pb-4 mb-4 border-b border-border",children:[o.jsx(oe,{type:"button",onClick:()=>H(!0),disabled:!lt,className:"w-full bg-primary hover:bg-primary/90 text-primary-foreground",children:"Desmembrar e Unir Produto"}),o.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Divida o preo por quantidade e opcionalmente una com outro produto"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{htmlFor:"barcode2",className:"text-xs sm:text-right",children:"Cdigo de Barras"}),o.jsx(or,{id:"barcode2",value:k,onChange:tt=>M(zr(tt.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"EAN-13",disabled:!lt})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{htmlFor:"barcodeBox",className:"text-xs sm:text-right",children:"Cdigo Barras (Caixa)"}),o.jsx(or,{id:"barcodeBox",value:S,onChange:tt=>I(zr(tt.target.value)),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"EAN-13 da caixa",disabled:!lt})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{htmlFor:"reference",className:"text-xs sm:text-right",children:"Referncia"}),o.jsx(or,{id:"reference",value:T,onChange:tt=>D(tt.target.value),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"Ex.: REF-123",disabled:!lt})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{htmlFor:"brand",className:"text-xs sm:text-right",children:"Marca"}),o.jsx(or,{id:"brand",value:B,onChange:tt=>U(tt.target.value),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"Ex.: Nike",disabled:!lt})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[o.jsx(Wt,{htmlFor:"group",className:"text-xs sm:text-right",children:"Grupo"}),o.jsx(or,{id:"group",value:z,onChange:tt=>$(tt.target.value),className:"sm:col-span-3 text-xs sm:text-sm",placeholder:"Ex.: Calados",disabled:!lt})]})]}),!1]})}),o.jsxs(Un,{children:[o.jsx(Hm,{asChild:!0,children:o.jsx(oe,{type:"button",variant:"secondary",children:"Cancelar"})}),o.jsx(oe,{type:"button",onClick:Zr,disabled:Ue||!lt,title:"F5 para salvar",children:Ue?"Salvando...":"Salvar Produto"})]})]}),o.jsx(Eat,{open:Er,onOpenChange:H,product:r,currentPrice:se,allProducts:c,userProfile:u,onApply:async(tt,Lr,cn,pn)=>{if(!cn)rt(tt),je(Lr),H(!1),d({title:"Preo desmembrado!",description:`Preo unitrio: R$ ${ze(tt).toFixed(2)} | Estoque: ${Lr}`,variant:"success"});else try{const jn=Number(Lr),Gn=await Gv({productId:cn.id,delta:jn,codigoEmpresa:u?.codigo_empresa}),Ln=Number(Gn?.stock??Number(cn.stock||0)+jn);if(pn){const aa={...cn,stock:Ln,salePrice:ze(tt),price:ze(tt)};await C5(cn.id,aa)}await tR(r.id),d({title:"Produto desmembrado e unido!",description:`${cn.name}: novo estoque = ${Ln} | preo unitrio = R$ ${ze(tt).toFixed(2)}`,variant:"success"}),H(!1),t(!1);try{typeof l=="function"&&l()}catch{}}catch(jn){console.error("[Desmembrar e Unir] Erro:",jn),d({title:"Erro ao processar",description:jn?.message||"Tente novamente",variant:"destructive"})}}})]})}function Eat({open:e,onOpenChange:t,product:r,currentPrice:n,allProducts:a,userProfile:i,onApply:s}){const[l,c]=p.useState(""),[d,u]=p.useState(""),[f,m]=p.useState(!1),[h,v]=p.useState(""),[g,y]=p.useState(null),[x,b]=p.useState(!1),w=P=>{const k=String(P||"").replace(/\D/g,"");return(k?Number(k)/100:0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})},j=P=>{if(!P)return 0;const k=String(P).replace(/\./g,"").replace(",","."),M=Number(k);return Number.isFinite(M)?M:0};p.useEffect(()=>{e&&n&&(c(n),u(""),m(!1),v(""),y(null),b(!1))},[e,n]);const _=l&&d&&Number(d)>0?j(l)/Number(d):0,C=(a||[]).filter(P=>{if(!r||P.id===r.id)return!1;if(!h.trim())return!0;const k=h.toLowerCase();return(P.name||"").toLowerCase().includes(k)||(P.code||"").toLowerCase().includes(k)}).slice(0,10),E=g?Number(d||0)+Number(g.stock||0):0;return o.jsx(ln,{open:e,onOpenChange:t,children:o.jsxs(on,{className:"w-[95vw] sm:max-w-[650px] max-h-[85vh] flex flex-col overflow-y-auto",children:[o.jsxs(nn,{children:[o.jsx(rn,{children:"Desmembrar e Unir Produto"}),o.jsx(_n,{children:"Divida o preo por quantidade e opcionalmente una com outro produto"})]}),o.jsxs("div",{className:"space-y-4 py-4",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsx("h3",{className:"text-sm font-semibold",children:"1. Desmembrar Preo"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Wt,{children:"Valor Total (R$)"}),o.jsx(or,{inputMode:"numeric",placeholder:"0,00",value:`R$ ${l||"0,00"}`,onChange:P=>c(w(P.target.value))})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Wt,{children:"Quantidade de Unidades"}),o.jsx(or,{type:"text",inputMode:"numeric",placeholder:"0",value:d,onChange:P=>u(P.target.value.replace(/[^0-9]/g,""))})]}),_>0&&o.jsx("div",{className:"bg-muted/50 border border-border p-3 rounded-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Preo Unitrio:"}),o.jsxs("span",{className:"text-lg font-bold",children:["R$ ",_.toFixed(2)]})]})})]}),_>0&&o.jsxs("div",{className:"space-y-3 border-t pt-4",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Bo,{id:"wantToMerge",checked:f,onCheckedChange:P=>{m(!!P),P||(y(null),v(""),b(!1))}}),o.jsx(Wt,{htmlFor:"wantToMerge",className:"cursor-pointer text-sm font-semibold",children:"2. Unir com outro produto (opcional)"})]}),f&&o.jsxs("div",{className:"space-y-3 ml-6",children:[o.jsx("div",{className:"bg-muted/30 border border-border p-3 rounded-lg",children:o.jsxs("p",{className:"text-xs text-muted-foreground",children:[o.jsx("strong",{children:"Produto atual:"})," ",r?.name," (ser inativado aps unio)"]})}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Wt,{children:"Buscar Produto Destino"}),o.jsx(or,{placeholder:"Digite o nome ou cdigo...",value:h,onChange:P=>v(P.target.value)})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs(Wt,{className:"text-xs",children:["Produtos Disponveis (",C.length,")"]}),o.jsx("div",{className:"max-h-48 overflow-y-auto space-y-1 border border-border rounded-lg p-2",children:C.length===0?o.jsx("p",{className:"text-xs text-muted-foreground p-2 text-center",children:"Nenhum produto encontrado"}):C.map(P=>o.jsx("div",{onClick:()=>y(P),className:Yt("p-2 rounded-md cursor-pointer border transition-colors",g?.id===P.id?"bg-primary/10 border-primary":"bg-background hover:bg-muted/50 border-transparent"),children:o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-sm font-medium truncate",children:P.name}),o.jsxs("p",{className:"text-xs text-muted-foreground",children:[P.code&&`Cdigo: ${P.code}  `,"Estoque: ",P.stock||0,"  R$ ",Number(P.price||P.salePrice||0).toFixed(2)]})]}),g?.id===P.id&&o.jsx(Ai,{className:"w-4 h-4 text-primary flex-shrink-0"})]})},P.id))})]}),g&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"bg-primary/5 border border-primary/20 p-3 rounded-lg",children:[o.jsx("p",{className:"text-xs font-medium mb-1",children:"Resumo da Unio:"}),o.jsxs("div",{className:"text-xs space-y-0.5 text-muted-foreground",children:[o.jsxs("p",{children:[" Destino: ",o.jsx("strong",{children:g.name})]}),o.jsxs("p",{children:[" Estoque atual: ",g.stock||0]}),o.jsxs("p",{children:[" Estoque a somar: +",d]}),o.jsxs("p",{className:"text-primary font-bold",children:[" Novo estoque: ",E]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Bo,{id:"updatePrice",checked:x,onCheckedChange:P=>b(!!P)}),o.jsxs(Wt,{htmlFor:"updatePrice",className:"cursor-pointer text-xs",children:["Atualizar preo do destino para R$ ",_.toFixed(2)]})]})]})]})]})]}),o.jsxs(Un,{children:[o.jsx(oe,{variant:"outline",onClick:()=>t(!1),children:"Cancelar"}),o.jsx(oe,{onClick:()=>{if(_>0){const P=_.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2});s(P,d,f?g:null,x)}},disabled:_<=0||f&&!g,children:f&&g?"Desmembrar e Unir":"Aplicar Desmembramento"})]})]})})}function kat({open:e,onOpenChange:t,categories:r,onAddCategory:n,onRemoveCategory:a}){const{toast:i}=oo(),[s,l]=p.useState(""),[c,d]=p.useState(!1),u=async()=>{const m=s.trim();if(m){if(r.includes(m)){i({title:"Categoria j existe",description:"Escolha outro nome.",variant:"destructive"});return}try{d(!0),await n(m),l(""),i({title:"Categoria adicionada",description:"Ela j aparece na lista.",variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(h){console.error("[Categorias] add:error",h);const v=rc(h,{action:"save"});i({title:v.title,description:v.description,variant:"destructive"})}finally{d(!1)}}},f=async m=>{try{d(!0),await a(m),i({title:"Categoria desativada",description:"A categoria foi marcada como inativa.",variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(h){console.error("[Categorias] remove:error",h);const v=rc(h,{action:"save"});i({title:v.title,description:v.description,variant:"destructive"})}finally{d(!1)}};return o.jsx(ln,{open:e,onOpenChange:t,children:o.jsxs(on,{className:"w-[90vw] sm:max-w-[480px]",children:[o.jsxs(nn,{children:[o.jsx(rn,{children:"Gerenciar Categorias"}),o.jsx(_n,{children:"Adicione ou remova categorias de produtos."})]}),o.jsxs("div",{className:"py-4 space-y-4",children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsx(or,{value:s,onChange:m=>l(m.target.value),placeholder:"Nome da nova categoria"}),o.jsx(oe,{onClick:u,disabled:c,children:c?"Processando...":"Adicionar"})]}),o.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:r.map(m=>o.jsxs("div",{className:"flex items-center justify-between bg-surface-2 p-2 rounded-md",children:[o.jsx("span",{className:"font-semibold",children:m}),o.jsx(oe,{variant:"ghost",size:"icon",className:"h-8 w-8 text-danger/80 hover:text-danger",onClick:()=>f(m),disabled:c,children:o.jsx(Um,{size:14})})]},m))})]})]})})}function Oat(){const{toast:e}=oo(),{userProfile:t,authReady:r}=Do();ls();const[n,a]=p.useState(_at),[i,s]=p.useState(Sat),[l,c]=p.useState([]);p.useState("list");const[d,u]=p.useState(!0),[f,m]=p.useState(null),[h,v]=p.useState(!1),[g,y]=p.useState(!1),[x,b]=p.useState("all"),[w,j]=p.useState(""),[_,C]=p.useState({type:"all",category:"all",status:"active",newOnly:!1}),[E,P]=p.useState(!1),[k,M]=p.useState(!1),[S,I]=p.useState(!1),[T,D]=p.useState(null),[B,U]=p.useState({by:"code",dir:"asc"}),z=p.useRef(!0),$=p.useRef(0),Y=p.useRef(0);p.useRef(!1);const[de,xe]=p.useState(!1),[q,L]=p.useState("paged"),W=q==="paged",[ne,le]=p.useState(1),[K]=p.useState(100),[Q,re]=p.useState(0);p.useEffect(()=>(z.current=!0,()=>{z.current=!1}),[]),p.useEffect(()=>{try{const ke=localStorage.getItem(nU);if(!ke)return;const Mt=JSON.parse(ke);Mt&&typeof Mt=="object"&&((Mt.listMode==="paged"||Mt.listMode==="all")&&L(Mt.listMode),typeof Mt.showStats=="boolean"&&u(Mt.showStats))}catch{}},[]),p.useEffect(()=>{(async()=>{if(!t?.codigo_empresa||!t?.id&&!t?.user_id)return;const Mt=t.id||t.user_id,wr=`produtos:${t.codigo_empresa}`,Fr=await zae({userId:Mt,scope:wr});Fr&&((Fr.listMode==="paged"||Fr.listMode==="all")&&L(Fr.listMode),typeof Fr.showStats=="boolean"&&u(Fr.showStats))})()},[t?.codigo_empresa,t?.id]),p.useEffect(()=>{try{const ke={listMode:q,showStats:d};localStorage.setItem(nU,JSON.stringify(ke))}catch{}if(t?.codigo_empresa&&(t?.id||t?.user_id)){const ke=t.id||t.user_id,Mt=`produtos:${t.codigo_empresa}`;Uae({userId:ke,scope:Mt,settings:{listMode:q,showStats:d}})}},[q,d,t?.codigo_empresa,t?.id]);const G=async()=>{const ke=t?.codigo_empresa||null;if(!r||!ke)return;const Mt=`produtos:list:${ke}`;P(!0);const wr=setTimeout(()=>{if(z.current)try{const Fr=JSON.parse(localStorage.getItem(Mt)||"[]");Array.isArray(Fr)&&Fr.length>0&&(console.warn("[Produtos] slow fallback: using cached snapshot"),a(Fr))}catch{}},2e3);try{const Fr=_.status==="all"||_.status==="inactive";let Ur=[];if(W){console.log("[Produtos] refetchProducts - modo paginado - Filtro status:",_.status,"includeInactive:",Fr,"page:",ne,"pageSize:",K);const Kr=await Jnt({includeInactive:Fr,search:w,codigoEmpresa:ke,page:ne,pageSize:K});if(!z.current)return;Ur=Kr?.data||[];const dn=Kr?.count||0;console.log("[Produtos] refetchProducts - Produtos carregados (paginado):",Ur.length,"de",dn),a(Ur),re(dn)}else{if(console.log("[Produtos] refetchProducts - modo TODOS - Filtro status:",_.status,"includeInactive:",Fr),Ur=await qu({includeInactive:Fr,search:w,codigoEmpresa:ke}),!z.current)return;console.log("[Produtos] refetchProducts - Produtos carregados (todos):",Ur.length),a(Ur),re(Ur.length)}try{localStorage.setItem(Mt,JSON.stringify(Ur))}catch{}Y.current=Ur.length,$.current=Date.now()}catch(Fr){console.error("[Produtos] refetchProducts:error",Fr);const Ur=rc(Fr,{action:"fetch"});e({title:Ur.title,description:Ur.description,variant:"destructive"})}finally{clearTimeout(wr),P(!1)}};p.useEffect(()=>{const ke=(()=>{try{const Kr=localStorage.getItem("auth:userProfile");return Kr&&JSON.parse(Kr)?.codigo_empresa||null}catch{return null}})(),Mt=t?.codigo_empresa||ke;if(!Mt)return;const wr=`produtos:list:${Mt}`,Fr=(()=>{try{return JSON.parse(localStorage.getItem(wr)||"[]")}catch{return[]}})();Array.isArray(Fr)&&Fr.length>0&&(a(Fr),Y.current=Fr.length);const Ur=async(Kr=3)=>{for(let dn=0;dn<Kr;dn++)try{if(z.current){await G();break}}catch(wn){console.warn(`[ProdutosPage] Tentativa ${dn+1} falhou:`,wn),dn===Kr-1?console.error("[ProdutosPage] Todas as tentativas falharam"):await new Promise(va=>setTimeout(va,1e3*(dn+1)))}};try{const Kr=JSON.parse(localStorage.getItem(`produtos:cats:${Mt}`)||"[]");Array.isArray(Kr)&&Kr.length>0&&s(Kr)}catch{}if(r&&t?.codigo_empresa){const Kr=setTimeout(()=>Ur(),100);return(async()=>{try{const dn=await rU({codigoEmpresa:t.codigo_empresa});if(!z.current)return;s(dn);try{localStorage.setItem(`produtos:cats:${t.codigo_empresa}`,JSON.stringify(dn))}catch{}}catch(dn){console.error("[Categorias] load on mount:error",dn)}})(),()=>clearTimeout(Kr)}},[r,t?.codigo_empresa]),p.useEffect(()=>{const ke=()=>{(Date.now()-($.current||0)>3e4||Y.current===0)&&G()},Mt=()=>{document.visibilityState==="visible"&&(Date.now()-($.current||0)>3e4||Y.current===0)&&G()};return window.addEventListener("focus",ke),document.addEventListener("visibilitychange",Mt),()=>{window.removeEventListener("focus",ke),document.removeEventListener("visibilitychange",Mt)}},[r,t?.codigo_empresa]),p.useEffect(()=>{le(1),r&&G()},[_.status,r]),p.useEffect(()=>{const ke=setTimeout(()=>{le(1),r&&G()},300);return()=>clearTimeout(ke)},[w,r]),p.useEffect(()=>{le(1),r&&G()},[q,r]);const[me,pe]=p.useState("N/A");p.useEffect(()=>{let ke=!0;return(async()=>{try{const Mt=await Xnt({limit:1,codigoEmpresa:t?.codigo_empresa});if(!ke)return;if(Array.isArray(Mt)&&Mt.length>0){const wr=Mt[0];pe(`${wr.name} (${wr.total})`)}else pe("")}catch{ke&&pe("N/A")}})(),()=>{ke=!1}},[t?.codigo_empresa]);const[Be,Z]=p.useState(!1),[ee,kt]=p.useState(()=>{const ke=new Date;return ke.setHours(0,0,0,0),ke}),[Nt,De]=p.useState(!1),[st,ft]=p.useState(()=>new Date),[yt,Nr]=p.useState(!1),[se,rt]=p.useState([]),[mt,tr]=p.useState(!1),Ce=async()=>{try{Nr(!0);const ke=await Ynt({from:ee,to:st,codigoEmpresa:t?.codigo_empresa});rt(ke||[])}catch(ke){e({title:"Falha ao carregar vendas do perodo",description:ke?.message||"Tente novamente",variant:"destructive"})}finally{Nr(!1)}},je=p.useMemo(()=>{const ke=new Date;return{mostSold:me,lowStock:n.filter(Mt=>Mt.status==="low_stock"||Mt.stock>0&&Mt.stock<=Mt.minStock).length,expired:n.filter(Mt=>Mt.validade&&Mt.validade<ke).length}},[n,me]),ae=p.useMemo(()=>{const ke=new Date;return n.filter(Mt=>{const wr=x==="all"?!0:x==="low_stock"?Mt.status==="low_stock"||Mt.stock>0&&Mt.stock<=Mt.minStock:x==="expired"?Mt.validade&&Mt.validade<ke:!1,Fr=_.status==="all"?!0:Mt.status===_.status,Ur=_.type==="all"||Mt.type===_.type,Kr=_.category==="all"||Mt.category===_.category,dn=!_.newOnly||Mt.dataImportacao&&(()=>Math.floor((new Date-Mt.dataImportacao)/864e5)<=7)();return wr&&Fr&&Ur&&Kr&&dn})},[n,x,_]),$e=ke=>ke?.dataImportacao?Math.floor((new Date-ke.dataImportacao)/(1e3*60*60*24))<=7:!1,Ae=p.useMemo(()=>{const ke=[...ae],Mt=B.dir==="asc"?1:-1,wr=(Ur,Kr)=>Number.isFinite(Ur)?Ur:Kr,Fr=Ur=>{if(!Ur)return NaN;if(Ur instanceof Date)return Ur.getTime();const Kr=new Date(Ur);return Number.isNaN(Kr.getTime())?NaN:Kr.getTime()};return ke.sort((Ur,Kr)=>{if(B.by==="code"){const dn=wr(parseInt((Ur.code||"").trim(),10),1/0),wn=wr(parseInt((Kr.code||"").trim(),10),1/0);return dn===wn?0:dn>wn?Mt:-Mt}if(B.by==="name"){const dn=(Ur.name||"").toString(),wn=(Kr.name||"").toString();return dn.localeCompare(wn,"pt-BR",{sensitivity:"base"})*Mt}if(B.by==="validade"){const dn=wr(Fr(Ur.validade),1/0),wn=wr(Fr(Kr.validade),1/0);return dn===wn?0:dn>wn?Mt:-Mt}return 0}),ke},[ae,B]),Tt=p.useMemo(()=>{if(!K)return 1;const ke=Math.ceil((Q||0)/K);return ke>0?ke:1},[Q,K]),Se=ke=>{U(Mt=>Mt.by===ke?{by:ke,dir:Mt.dir==="asc"?"desc":"asc"}:{by:ke,dir:"asc"})},Ne=ke=>{b(Mt=>Mt===ke?"all":ke)},Ue=()=>{kt(()=>{const ke=new Date;return ke.setHours(0,0,0,0),ke}),ft(new Date),Z(!0),setTimeout(Ce,0)},Qe=(ke,Mt)=>{C(wr=>({...wr,[ke]:Mt}))},et=()=>{m(null),v(!0)},pt=ke=>{m(ke),v(!0)},Ke=()=>{try{Pat(Ae),e({title:"Exportao concluda",description:`${Ae.length} produto(s) exportado(s).`,variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(ke){console.error("[Produtos] export:error",ke);const Mt=rc(ke,{action:"export"});e({title:Mt.title,description:Mt.description,variant:"destructive"})}},qt=ke=>{c(Mt=>Mt.includes(ke)?Mt.filter(wr=>wr!==ke):[...Mt,ke])},lt=()=>{const ke=Ae.map(Mt=>Mt.id);ke.length&&c(ke)},rr=()=>{c([])},nt=ke=>{ke?lt():rr()},$t=p.useMemo(()=>Ae.filter(ke=>l.includes(ke.id)),[Ae,l]),Qr=p.useMemo(()=>$t.some($e),[$t]),Xr=async ke=>{if(l.length)try{await Qnt({ids:l,status:ke}),await G(),rr(),e({title:ke==="inactive"?"Produtos inativados":"Produtos atualizados",description:`${l.length} produto(s) atualizado(s).`,variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(Mt){const wr=rc(Mt,{action:"save"});e({title:wr.title,description:wr.description,variant:"destructive"})}},In=async()=>{if(!(!l.length||!Qr))try{await Znt({ids:l}),await G(),rr(),e({title:"Novos removidos",description:"A etiqueta de novo foi removida dos produtos selecionados.",variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(ke){const Mt=rc(ke,{action:"save"});e({title:Mt.title,description:Mt.description,variant:"destructive"})}},sn=async()=>{const ke=t?.codigo_empresa||null;if(!(!r||!ke))try{const Mt=await rU({codigoEmpresa:ke});if(!z.current)return;s(Mt);try{localStorage.setItem(`produtos:cats:${ke}`,JSON.stringify(Mt))}catch{}}catch(Mt){console.error("[Categorias] load on mount:error",Mt)}},Qt=async ke=>{s(Mt=>{if(Mt.includes(ke))return Mt;const wr=[...Mt,ke];return wr.sort((Fr,Ur)=>Fr.localeCompare(Ur,"pt-BR")),wr});try{await eat(ke),await sn()}catch(Mt){s(Fr=>Fr.filter(Ur=>Ur!==ke)),console.error("[Categorias] add:error",Mt);const wr=rc(Mt,{action:"save"});e({title:wr.title,description:wr.description,variant:"destructive"})}},qr=async ke=>{if(n.some(Fr=>Fr.category===ke&&Fr.status!=="inactive"))throw new Error("Categoria possui produtos ativos vinculados");const wr=i;s(Fr=>Fr.filter(Ur=>Ur!==ke));try{await tat(ke),await sn()}catch(Fr){s(wr),console.error("[Categorias] remove:error",Fr);const Ur=rc(Fr,{action:"save"});e({title:Ur.title,description:Ur.description,variant:"destructive"})}},Tr=async ke=>{try{if(console.log("[Produtos] handleSaveProduct",ke),!ke||typeof ke!="object"){console.warn("[Produtos] handleSaveProduct chamado sem payload vlido. Ignorando.");return}if(!ke.code){const Fr=n.map(Kr=>(Kr.code||"").trim()).filter(Kr=>/^\d+$/.test(Kr)).map(Kr=>parseInt(Kr,10)),Ur=Fr.length?Math.max(...Fr)+1:1;ke.code=String(Ur).padStart(4,"0")}const Mt=t?.codigo_empresa||null,wr=async Fr=>{const Kr=new Promise((dn,wn)=>setTimeout(()=>wn(new Error("Timeout update/create (12s)")),12e3));return Promise.race([Fr,Kr])};if(ke.id){const Fr=await wr(C5(ke.id,ke,{codigoEmpresa:Mt}));console.log("[Produtos] Produto atualizado - active:",Fr.active,"status:",Fr.status),a(Ur=>Ur.map(Kr=>Kr.id===Fr.id?Fr:Kr)),await G(),console.log("[Produtos] Refetch concludo aps update")}else{const Fr=await wr(J_(ke,{codigoEmpresa:Mt}));console.log("[Produtos] Produto criado",Fr),a(Ur=>[Fr,...Ur]),setTimeout(()=>{G().catch(Ur=>console.error("[Produtos] refetch ps-create falhou",Ur))},0)}}catch(Mt){console.error("[Produtos] Erro no handleSaveProduct",Mt);const wr=rc(Mt,{action:"save"});throw e({title:wr.title,description:wr.description,variant:"destructive"}),Mt}},sr=ke=>{D(ke),M(!0)},$r=async()=>{if(T?.id)try{I(!0),await tR(T.id),a(Mt=>Mt.filter(wr=>wr.id!==T.id)),await G();const ke=rc(null,{action:"delete"});e({variant:"success",title:ke.title,description:`Produto "${T.name}" foi inativado com sucesso.`})}catch(ke){const Mt=rc(ke,{action:"delete"});e({variant:"destructive",...Mt})}finally{I(!1),M(!1),D(null)}},Gr=p.useMemo(()=>{const ke=n.map(wr=>(wr.code||"").trim()).filter(wr=>/^\d+$/.test(wr)).map(wr=>parseInt(wr,10)),Mt=ke.length?Math.max(...ke)+1:1;return String(Mt).padStart(4,"0")},[n]);return o.jsxs(o.Fragment,{children:[o.jsxs(fr.div,{variants:Cat,initial:"hidden",animate:"visible",className:"flex flex-col",children:[o.jsxs(fr.div,{variants:w4,className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between gap-3",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-black text-text-primary tracking-tighter",children:"Controle de Produtos"}),o.jsx("p",{className:"text-text-secondary hidden md:block",children:"Controle total sobre seu inventrio e estoque."})]}),o.jsx(oe,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full hidden md:flex items-center justify-center",onClick:()=>xe(!0),"aria-label":"Configuraes da aba",title:"Configuraes da aba",children:o.jsx(zm,{className:"h-4 w-4"})})]}),o.jsxs("div",{className:"hidden md:flex items-center gap-2 flex-wrap",children:[o.jsx(oe,{variant:"outline",size:"icon",onClick:()=>u(ke=>!ke),title:d?"Ocultar resumo":"Mostrar resumo","aria-label":d?"Ocultar resumo":"Mostrar resumo",children:d?o.jsx(Sp,{className:"h-4 w-4"}):o.jsx(zp,{className:"h-4 w-4"})}),o.jsxs(oe,{variant:"outline",onClick:Ke,children:[o.jsx(ri,{className:"mr-2 h-4 w-4"})," Exportar"]}),o.jsxs(oe,{variant:"secondary",onClick:()=>De(!0),children:[o.jsx(ns,{className:"mr-2 h-4 w-4"})," Importar XML"]}),o.jsxs(oe,{onClick:et,children:[o.jsx(Ka,{className:"mr-2 h-4 w-4"})," Novo Produto"]})]}),o.jsxs("div",{className:"mt-2 flex md:hidden items-center gap-2",children:[o.jsxs(oe,{variant:"outline",className:"h-9 px-3 rounded-xl flex items-center gap-1 text-xs",onClick:Ke,title:"Exportar CSV","aria-label":"Exportar CSV",children:[o.jsx(ri,{className:"h-4 w-4"}),o.jsx("span",{children:"CSV"})]}),o.jsxs(oe,{variant:"secondary",className:"h-9 px-3 rounded-xl flex items-center gap-1 text-xs",onClick:()=>De(!0),title:"Importar XML","aria-label":"Importar XML",children:[o.jsx(ns,{className:"h-4 w-4"}),o.jsx("span",{children:"XML"})]}),o.jsxs(oe,{className:"h-9 px-3 rounded-xl flex items-center gap-1 text-xs",onClick:et,title:"Novo Produto","aria-label":"Novo Produto",children:[o.jsx(Ka,{className:"h-4 w-4"}),o.jsx("span",{children:"Prod"})]}),o.jsxs(oe,{variant:"outline",className:"h-9 px-3 rounded-xl flex items-center gap-1 text-xs",onClick:()=>y(!0),title:"Gerenciar categorias","aria-label":"Gerenciar categorias",children:[o.jsx(t2,{className:"h-4 w-4"}),o.jsx("span",{children:"Cat."})]}),o.jsx(oe,{variant:"outline",size:"icon",className:"h-9 w-9 rounded-xl flex items-center justify-center ml-auto",onClick:()=>xe(!0),title:"Configuraes da aba","aria-label":"Configuraes da aba",children:o.jsx(zm,{className:"h-4 w-4"})}),o.jsx(oe,{variant:"outline",size:"icon",className:"h-10 w-10 rounded-xl flex items-center justify-center ml-auto",onClick:()=>u(ke=>!ke),title:d?"Ocultar resumo":"Mostrar resumo","aria-label":d?"Ocultar resumo":"Mostrar resumo",children:d?o.jsx(Sp,{className:"h-5 w-5"}):o.jsx(zp,{className:"h-5 w-5"})})]})]}),d&&o.jsxs("div",{className:"grid grid-cols-3 gap-3 md:gap-6 mb-6",children:[o.jsx(vE,{icon:$d,title:o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"hidden md:inline",children:"Mais Vendido (Dia)"}),o.jsx("span",{className:"md:hidden",children:"+ vendidos"})]}),value:je.mostSold,subtitle:"Produto com mais sadas hoje",color:"text-brand",onClick:Ue}),o.jsx(vE,{icon:Af,title:o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"hidden md:inline",children:"Estoque Baixo"}),o.jsx("span",{className:"md:hidden",children:"Est. baixo"})]}),value:je.lowStock,subtitle:"Produtos precisando de reposio",color:"text-warning",onClick:()=>Ne("low_stock"),isActive:x==="low_stock"}),o.jsx(vE,{icon:dj,title:o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"hidden md:inline",children:"Vendidos"}),o.jsx("span",{className:"md:hidden",children:"Vencidos"})]}),value:je.expired,subtitle:"Produtos fora da data de validade",color:"text-danger",onClick:()=>Ne("expired"),isActive:x==="expired"})]}),o.jsx(ln,{open:Be,onOpenChange:Z,children:o.jsxs(on,{className:"max-w-2xl",onKeyDown:ke=>ke.stopPropagation(),children:[o.jsxs(nn,{children:[o.jsx(rn,{className:"text-xl font-bold",children:"Vendas por Perodo"}),o.jsx(_n,{children:"Selecione o intervalo de datas e visualize os produtos vendidos."})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 items-end",children:[o.jsxs("div",{children:[o.jsx(Wt,{className:"mb-1 block",children:"Incio"}),o.jsxs(xc,{children:[o.jsx(yc,{asChild:!0,children:o.jsxs(oe,{variant:"outline",className:"w-full justify-start",children:[o.jsx(dj,{className:"mr-2 h-4 w-4"}),ee?Jt(ee,"dd/MM/yyyy"):"Incio"]})}),o.jsx(Rl,{className:"p-0 w-[300px]",children:o.jsx("div",{className:"w-[300px] min-h-[332px]",children:o.jsx(bc,{mode:"single",selected:ee,onSelect:ke=>ke&&kt(ke),initialFocus:!0,fixedWeeks:!0})})})]})]}),o.jsxs("div",{children:[o.jsx(Wt,{className:"mb-1 block",children:"Fim"}),o.jsxs(xc,{children:[o.jsx(yc,{asChild:!0,children:o.jsxs(oe,{variant:"outline",className:"w-full justify-start",children:[o.jsx(dj,{className:"mr-2 h-4 w-4"}),st?Jt(st,"dd/MM/yyyy"):"Fim"]})}),o.jsx(Rl,{className:"p-0 w-[300px]",children:o.jsx("div",{className:"w-[300px] min-h-[332px]",children:o.jsx(bc,{mode:"single",selected:st,onSelect:ke=>ke&&ft(ke),initialFocus:!0,fixedWeeks:!0})})})]})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(oe,{type:"button",onClick:Ce,disabled:yt,className:"w-full",children:yt?"Carregando...":"Aplicar"}),o.jsx(oe,{type:"button",variant:"secondary",onClick:()=>{try{const ke=se||[],Mt=";",wr=()=>{const dn=["Produto;Quantidade"];for(const wn of ke)dn.push(`${(wn.name||"").replace(/;/g,",")}${Mt}${Number(wn.total||0)}`);return dn.join(`
`)},Fr=new Blob(["\uFEFF"+wr()],{type:"text/csv;charset=utf-8;"}),Ur=URL.createObjectURL(Fr),Kr=document.createElement("a");Kr.href=Ur,Kr.download="vendas-periodo.csv",document.body.appendChild(Kr),Kr.click(),document.body.removeChild(Kr),URL.revokeObjectURL(Ur),e({title:"Exportao concluda",description:`${ke.length} linha(s)`,variant:"success"})}catch(ke){e({title:"Falha ao exportar",description:ke?.message||"Tente novamente",variant:"destructive"})}},children:"Exportar CSV"})]})]}),o.jsx("div",{className:"mt-3 border rounded-md max-h-[50vh] overflow-auto thin-scroll",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-surface-2",children:[o.jsx("th",{className:"text-left p-2",children:"Produto"}),o.jsx("th",{className:"text-right p-2",children:"Quantidade"})]})}),o.jsxs("tbody",{children:[(se||[]).length===0&&!yt&&o.jsx("tr",{children:o.jsx("td",{colSpan:2,className:"p-3 text-text-muted",children:"Nenhum item no perodo."})}),(se||[]).map(ke=>o.jsxs("tr",{className:"border-t border-border",children:[o.jsx("td",{className:"p-2",children:ke.name}),o.jsx("td",{className:"p-2 text-right font-mono",children:Number(ke.total||0)})]},ke.id))]})]})}),o.jsx(Un,{children:o.jsx(Hm,{asChild:!0,children:o.jsx(oe,{type:"button",variant:"secondary",children:"Fechar"})})})]})}),o.jsx(ln,{open:de,onOpenChange:xe,children:o.jsxs(on,{className:"max-w-2xl",children:[o.jsx(nn,{children:o.jsx(rn,{children:"Configuraes da aba"})}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-[11px] font-medium text-text-muted",children:"Modo de listagem"}),o.jsxs(En,{value:q,onValueChange:L,children:[o.jsx(Sn,{className:"w-[200px] h-8 text-xs",children:o.jsx(kn,{placeholder:"Paginado"})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"paged",children:"Paginado (100 por pgina)"}),o.jsx(wt,{value:"all",children:"Todos (sem paginao)"})]})]})]}),o.jsx("div",{className:"flex items-center justify-between pt-1",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Bo,{id:"produtos-show-stats",checked:d,onCheckedChange:u}),o.jsx("label",{htmlFor:"produtos-show-stats",className:"text-xs font-medium text-text-primary",children:"Mostrar cards de resumo no topo"})]})})]}),o.jsx(Un,{children:o.jsx(Hm,{asChild:!0,children:o.jsx(oe,{type:"button",variant:"secondary",children:"Fechar"})})})]})}),o.jsxs(fr.div,{variants:w4,className:"bg-surface rounded-lg border border-border flex flex-col",children:[o.jsxs("div",{className:"p-3 pb-4 sm:p-4 border-b border-border space-y-3 flex-shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(pi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(or,{placeholder:"Buscar por nome ou cdigo...",className:"pl-9 text-sm",value:w,onChange:ke=>j(ke.target.value)})]}),o.jsx(oe,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full flex md:hidden items-center justify-center",onClick:()=>tr(!0),"aria-label":"Abrir filtros",title:"Filtros",children:o.jsx(Ck,{className:"h-4 w-4"})})]}),o.jsxs("div",{className:"hidden md:flex w-full items-center gap-3",children:[o.jsx("div",{className:"flex-1 min-w-[120px]",children:o.jsxs(En,{value:_.type,onValueChange:ke=>Qe("type",ke),children:[o.jsx(Sn,{className:"w-full text-xs sm:text-sm bg-surface-2 border border-border rounded-full px-3",children:o.jsx(kn,{})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"all",children:"Tipos"}),o.jsx(wt,{value:"Venda",children:"Venda"}),o.jsx(wt,{value:"Uso Interno",children:"Uso Interno"})]})]})}),o.jsx("div",{className:"flex-1 min-w-[140px]",children:o.jsxs(En,{value:_.category,onValueChange:ke=>Qe("category",ke),children:[o.jsx(Sn,{className:"w-full text-xs sm:text-sm bg-surface-2 border border-border rounded-full px-3",children:o.jsx(kn,{})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"all",children:"Categorias"}),i.map(ke=>o.jsx(wt,{value:ke,children:ke},ke))]})]})}),o.jsx("div",{className:"flex-1 max-w-[180px]",children:o.jsxs(En,{value:_.status,onValueChange:ke=>Qe("status",ke),children:[o.jsx(Sn,{className:"w-full text-xs sm:text-sm bg-surface-2 border border-border rounded-full px-3",children:o.jsx(kn,{})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"all",children:"Status"}),o.jsx(wt,{value:"active",children:"Ativo"}),o.jsx(wt,{value:"low_stock",children:"Estoque Baixo"}),o.jsx(wt,{value:"inactive",children:"Inativo"})]})]})}),o.jsxs("div",{className:"flex-1 flex justify-end gap-2 min-w-[160px]",children:[o.jsxs(oe,{variant:"outline",onClick:()=>Qe("newOnly",!_.newOnly),className:Yt("text-xs sm:text-sm rounded-full px-3 border border-border bg-surface-2 hover:bg-surface flex items-center gap-1 whitespace-nowrap",_.newOnly&&"bg-amber-500 text-black border-amber-500 hover:bg-amber-400"),size:"sm",children:[o.jsx("span",{className:"mr-1",children:""}),o.jsx("span",{children:"Novos"})]}),o.jsxs(oe,{variant:"outline",onClick:()=>y(!0),className:"text-xs sm:text-sm rounded-full px-3 border border-border bg-surface-2 hover:bg-surface flex items-center gap-1 whitespace-nowrap",size:"sm",children:[o.jsx(t2,{className:"h-3 w-3 sm:h-4 sm:w-4"}),o.jsx("span",{children:"Categorias"})]}),o.jsx(oe,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full flex items-center justify-center",onClick:()=>xe(ke=>!ke),"aria-label":"Configuraes da aba",title:"Configuraes da aba",children:o.jsx(zm,{className:"h-4 w-4"})})]})]})]}),l.length>0&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"px-3 sm:px-4 py-2.5 border-b border-border flex md:hidden items-center gap-2 text-xs",children:[o.jsxs("span",{className:"font-medium mr-2",children:[l.length," sel."]}),o.jsxs("button",{type:"button",className:"flex items-center gap-1.5 px-3 py-1.5 rounded-full border border-border bg-surface-2",onClick:()=>{const ke=Ae.length>0&&Ae.every(Mt=>l.includes(Mt.id));nt(!ke)},children:[o.jsx(Bo,{checked:Ae.length>0&&Ae.every(ke=>l.includes(ke.id)),className:"h-4 w-4"}),o.jsx("span",{children:"Todos"})]}),o.jsxs("div",{className:"flex items-center gap-1.5 ml-auto",children:[o.jsx(oe,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>Xr("active"),children:o.jsx(Ai,{className:"h-4 w-4"})}),o.jsx(oe,{variant:"outline",size:"icon",className:"h-8 w-8 text-danger border-danger/60 hover:bg-danger/10",onClick:()=>Xr("inactive"),children:o.jsx(Um,{className:"h-4 w-4"})}),Qr&&o.jsx(oe,{variant:"outline",size:"icon",className:"h-8 w-8 border-amber-500/70 text-amber-700 hover:bg-amber-500/10",onClick:In,children:o.jsx(t2,{className:"h-4 w-4"})})]})]}),o.jsxs("div",{className:"hidden md:flex px-4 py-2 border-b border-border items-center gap-3 text-xs",children:[o.jsx("span",{className:"font-medium text-text-secondary whitespace-nowrap",children:l.length===0?"Nenhum item selecionado":`${l.length} produto${l.length>1?"s":""} selecionado${l.length>1?"s":""}`}),o.jsxs("div",{className:"flex flex-1 flex-wrap items-center justify-end gap-2",children:[o.jsxs(oe,{variant:"outline",size:"xs",className:"h-7 px-3 rounded-full border border-border bg-surface-2 hover:bg-surface flex items-center gap-1",onClick:lt,children:[o.jsx(Ai,{className:"h-3 w-3"}),o.jsx("span",{children:"Marcar filtrados"})]}),o.jsxs(oe,{variant:"outline",size:"xs",className:"h-7 px-3 rounded-full border border-border bg-surface-2 hover:bg-surface flex items-center gap-1",onClick:rr,children:[o.jsx(Ck,{className:"h-3 w-3"}),o.jsx("span",{children:"Limpar seleo"})]}),o.jsxs(oe,{size:"xs",variant:"outline",className:"h-7 px-3 rounded-full border-emerald-500/70 text-emerald-300 bg-emerald-500/10 hover:bg-emerald-500/20 flex items-center gap-1",onClick:()=>Xr("active"),children:[o.jsx(Ai,{className:"h-3 w-3"}),o.jsx("span",{children:"Ativar itens"})]}),o.jsxs(oe,{size:"xs",variant:"outline",className:"h-7 px-3 rounded-full text-danger border-danger/60 hover:bg-danger/10 flex items-center gap-1",onClick:()=>Xr("inactive"),children:[o.jsx(Sp,{className:"h-3 w-3"}),o.jsx("span",{children:"Desativar itens"})]}),Qr&&o.jsxs(oe,{size:"xs",variant:"outline",className:"h-7 px-3 rounded-full border-amber-500/70 text-amber-500 hover:bg-amber-500/10 flex items-center gap-1",onClick:In,children:[o.jsx(t2,{className:"h-3 w-3"}),o.jsx("span",{children:'Limpar tag "Novo"'})]})]})]})]}),o.jsx("div",{children:Ae.length===0?o.jsxs("div",{className:"p-10 text-center text-text-secondary",children:[o.jsx("p",{className:"text-lg mb-3",children:"Nenhum produto cadastrado."}),o.jsxs(oe,{onClick:et,children:[o.jsx(Ka,{className:"mr-2 h-4 w-4"}),"Cadastrar primeiro produto"]})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"md:hidden p-3 space-y-3",children:Ae.map(ke=>{const Mt=l.includes(ke.id);return o.jsxs("div",{className:Yt("rounded-lg border bg-surface p-4 space-y-3 cursor-pointer",Mt?"border-brand/70 bg-brand/5":"border-border"),onClick:()=>pt(ke),children:[o.jsxs("div",{className:"flex items-start justify-between gap-3",children:[o.jsx("button",{type:"button",className:"pt-1 pr-2 -ml-1 flex items-center justify-center w-9 h-9",onClick:wr=>{wr.stopPropagation(),qt(ke.id)},children:o.jsx(Bo,{checked:Mt,className:"h-5 w-5 border-2"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h3",{className:"font-semibold text-base text-text-primary truncate",title:ke.name,children:ke.name}),ke.dataImportacao&&(()=>Math.floor((new Date-ke.dataImportacao)/864e5)<=7?o.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-brand/20 text-brand text-xs font-medium flex-shrink-0",children:[o.jsx("span",{children:""}),o.jsx("span",{children:"Novo"})]}):null)()]}),o.jsx("p",{className:"text-xs text-text-muted mt-0.5",children:ke.category||"Sem categoria"})]}),o.jsx("span",{className:Yt("inline-flex px-2 py-0.5 rounded-full text-xs border flex-shrink-0",ke.status==="active"&&"bg-emerald-50/5 border-emerald-500/30 text-emerald-400",ke.status==="low_stock"&&"bg-amber-50/5 border-amber-500/30 text-amber-400",ke.status==="inactive"&&"bg-surface-2 border-border text-text-muted"),children:ke.status==="active"?"Ativo":ke.status==="low_stock"?"Estoque Baixo":"Inativo"})]}),o.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs text-text-muted",children:[ke.code&&o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx("span",{children:"Cd."}),o.jsx("span",{className:"font-mono text-text-primary text-xs",children:ke.code})]}),o.jsx("span",{className:"mx-1 text-text-muted",children:""}),o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx("span",{children:"R$"}),o.jsx("span",{className:"font-semibold text-text-primary",children:ke.price.toFixed(2)})]}),o.jsx("span",{className:"mx-1 text-text-muted",children:""}),o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx("span",{children:"Est."}),o.jsx("span",{className:"font-medium text-text-primary",children:ke.stock})]}),ke.validade&&o.jsx("span",{className:"mx-1 text-text-muted",children:""}),ke.validade&&o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx("span",{children:"Val."}),o.jsx("span",{className:"text-text-primary",children:(()=>{const wr=ke.validade instanceof Date?ke.validade:X$(String(ke.validade));return isNaN(wr)?"-":Jt(wr,"dd/MM/yy")})()})]}),o.jsxs("div",{className:"ml-auto flex items-center gap-1",children:[o.jsx(oe,{variant:"outline",size:"icon",onClick:wr=>{wr.stopPropagation(),pt(ke)},className:"h-7 w-7",children:o.jsx(El,{className:"h-3.5 w-3.5"})}),o.jsx(oe,{variant:"outline",size:"icon",onClick:wr=>{wr.stopPropagation(),sr(ke)},className:"h-7 w-7 text-danger hover:text-danger",children:o.jsx(Um,{className:"h-3.5 w-3.5"})})]})]})]},ke.id)})}),o.jsx("div",{className:"hidden md:block rounded-lg border border-border overflow-hidden",children:o.jsxs("table",{className:"w-full text-sm bg-surface table-fixed",children:[o.jsx("thead",{className:"bg-surface-2 text-text-secondary",children:o.jsxs("tr",{className:"border-b border-border",children:[o.jsx("th",{className:"p-3 w-10 text-center",children:o.jsx(Bo,{checked:Ae.length>0&&Ae.every(ke=>l.includes(ke.id)),onCheckedChange:ke=>nt(!!ke)})}),o.jsxs("th",{className:"p-3 text-left font-semibold select-none cursor-pointer whitespace-nowrap w-[110px]",onClick:()=>Se("code"),children:["Cdigo ",B.by==="code"?B.dir==="asc"?"":"":""]}),o.jsxs("th",{className:"p-3 text-left font-semibold select-none cursor-pointer whitespace-nowrap w-[40%]",onClick:()=>Se("name"),children:["Produto ",B.by==="name"?B.dir==="asc"?"":"":""]}),o.jsx("th",{className:"p-3 text-left font-semibold whitespace-nowrap w-[18%]",children:"Categoria"}),o.jsx("th",{className:"p-3 text-right font-semibold whitespace-nowrap w-[120px]",children:"Preo"}),o.jsx("th",{className:"p-3 text-right font-semibold whitespace-nowrap w-[110px]",children:"Estoque"}),o.jsxs("th",{className:"p-3 text-center font-semibold select-none cursor-pointer whitespace-nowrap w-[120px]",onClick:()=>Se("validade"),children:["Validade ",B.by==="validade"?B.dir==="asc"?"":"":""]}),o.jsx("th",{className:"p-3 text-center font-semibold whitespace-nowrap w-[140px]",children:"Status"}),o.jsx("th",{className:"p-3 text-right font-semibold whitespace-nowrap w-[90px]",children:"Aes"})]})}),o.jsx("tbody",{className:"text-text-primary divide-y divide-border",children:Ae.map(ke=>o.jsxs("tr",{className:"hover:bg-surface-2 transition-colors group cursor-pointer align-middle",children:[o.jsx("td",{className:"p-3 text-center align-middle",children:o.jsx(Bo,{checked:l.includes(ke.id),onCheckedChange:()=>qt(ke.id)})}),o.jsx("td",{className:"p-3 font-mono text-sm text-text-secondary align-middle whitespace-nowrap",onClick:()=>pt(ke),children:ke.code||"-"}),o.jsx("td",{className:"p-3 font-semibold align-middle text-text-primary whitespace-nowrap overflow-hidden text-ellipsis",onClick:()=>pt(ke),title:ke.name,children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"truncate",children:ke.name}),ke.dataImportacao&&(()=>Math.floor((new Date-ke.dataImportacao)/864e5)<=7?o.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-brand/20 text-brand text-xs font-medium flex-shrink-0",children:[o.jsx("span",{children:""}),o.jsx("span",{children:"Novo"})]}):null)()]})}),o.jsx("td",{className:"p-3 text-text-secondary align-middle whitespace-nowrap",onClick:()=>pt(ke),children:ke.category}),o.jsxs("td",{className:"p-3 text-right font-mono tabular-nums align-middle whitespace-nowrap",onClick:()=>pt(ke),children:["R$ ",ke.price.toFixed(2)]}),o.jsx("td",{className:"p-3 text-right font-mono tabular-nums align-middle whitespace-nowrap",onClick:()=>pt(ke),children:ke.stock}),o.jsx("td",{className:"p-3 text-center font-mono tabular-nums whitespace-nowrap",onClick:()=>pt(ke),children:(()=>{if(!ke.validade)return"-";const Mt=ke.validade instanceof Date?ke.validade:X$(String(ke.validade));return isNaN(Mt)?"-":Jt(Mt,"dd/MM/yy")})()}),o.jsx("td",{className:"p-3 text-center whitespace-nowrap",onClick:()=>pt(ke),children:o.jsx("span",{className:Yt("px-2 py-1 text-xs font-bold rounded-full",ke.status==="active"&&"bg-success/10 text-success",ke.status==="low_stock"&&"bg-warning/10 text-warning",ke.status==="inactive"&&"bg-danger/10 text-danger"),children:ke.status==="active"?"Ativo":ke.status==="low_stock"?"Estoque Baixo":"Inativo"})}),o.jsx("td",{className:"p-3 whitespace-nowrap",children:o.jsx("div",{className:"flex items-center justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:o.jsx(oe,{variant:"ghost",size:"icon",className:"h-8 w-8 text-text-muted hover:text-danger",onClick:Mt=>{Mt.stopPropagation(),sr(ke)},children:o.jsx(Um,{size:14})})})})]},ke.id))})]})})]})}),W&&o.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between mt-4 gap-2 text-xs sm:text-sm text-text-muted px-3 sm:px-4 pb-3",children:[o.jsxs("span",{children:["Pgina ",ne," de ",Tt," (",Q," produto(s))"]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(oe,{type:"button",variant:"outline",size:"sm",onClick:()=>le(ke=>Math.max(1,ke-1)),disabled:ne<=1,children:"Anterior"}),o.jsx(oe,{type:"button",variant:"outline",size:"sm",onClick:()=>le(ke=>Math.min(Tt,ke+1)),disabled:ne>=Tt,children:"Prxima"})]})]})]})]}),o.jsx(Aat,{open:h,onOpenChange:v,product:f,categories:i,onSave:Tr,onCreateCategory:Qt,suggestedCode:f?void 0:Gr,onRefreshProducts:G,products:n}),o.jsx(ln,{open:k,onOpenChange:M,children:o.jsxs(on,{className:"sm:max-w-[480px]",children:[o.jsxs(nn,{children:[o.jsx(rn,{children:"Excluir produto"}),o.jsxs(_n,{children:["Tem certeza que deseja excluir o produto",T?` "${T.name}"`:"","? Esta ao no pode ser desfeita."]})]}),o.jsxs(Un,{children:[o.jsx(Hm,{asChild:!0,children:o.jsx(oe,{type:"button",variant:"secondary",disabled:S,children:"Cancelar"})}),o.jsx(oe,{type:"button",variant:"destructive",onClick:$r,disabled:S,children:S?"Excluindo...":"Excluir"})]})]})}),o.jsx(Nat,{open:Nt,onOpenChange:De,products:n,codigoEmpresa:t?.codigo_empresa,onSuccess:()=>{G(),De(!1)}}),o.jsx(ln,{open:mt,onOpenChange:tr,children:o.jsxs(on,{className:"w-[90vw] sm:max-w-[420px]",children:[o.jsx(nn,{children:o.jsx(rn,{className:"text-base",children:"Filtros de Produtos"})}),o.jsxs("div",{className:"space-y-3 py-2 text-xs",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx(Wt,{className:"text-xs",children:"Tipo"}),o.jsxs(En,{value:_.type,onValueChange:ke=>Qe("type",ke),children:[o.jsx(Sn,{className:"text-xs",children:o.jsx(kn,{})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"all",children:"Todos"}),o.jsx(wt,{value:"Venda",children:"Venda"}),o.jsx(wt,{value:"Uso Interno",children:"Uso Interno"})]})]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx(Wt,{className:"text-xs",children:"Categoria"}),o.jsxs(En,{value:_.category,onValueChange:ke=>Qe("category",ke),children:[o.jsx(Sn,{className:"text-xs",children:o.jsx(kn,{})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"all",children:"Todas"}),i.map(ke=>o.jsx(wt,{value:ke,children:ke},ke))]})]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx(Wt,{className:"text-xs",children:"Status"}),o.jsxs(En,{value:_.status,onValueChange:ke=>Qe("status",ke),children:[o.jsx(Sn,{className:"text-xs",children:o.jsx(kn,{})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"all",children:"Todos"}),o.jsx(wt,{value:"active",children:"Ativo"}),o.jsx(wt,{value:"low_stock",children:"Estoque Baixo"}),o.jsx(wt,{value:"inactive",children:"Inativo"})]})]})]}),o.jsxs("div",{className:"flex items-center gap-2 pt-1",children:[o.jsx(Bo,{id:"mobileNewOnly",checked:!!_.newOnly,onCheckedChange:ke=>Qe("newOnly",!!ke)}),o.jsx(Wt,{htmlFor:"mobileNewOnly",className:"text-xs flex items-center gap-1",children:o.jsx("span",{children:"Somente Novos"})})]})]}),o.jsxs(Un,{className:"flex justify-between mt-2",children:[o.jsx(oe,{type:"button",variant:"outline",size:"sm",className:"text-xs",onClick:()=>{C({type:"all",category:"all",status:"active",newOnly:!1}),tr(!1)},children:"Limpar"}),o.jsx(oe,{type:"button",size:"sm",className:"text-xs",onClick:()=>tr(!1),children:"Aplicar"})]})]})}),o.jsx(kat,{open:g,onOpenChange:y,categories:i,onAddCategory:Qt,onRemoveCategory:qr})]})}function Iat({purchase:e,items:t,onClose:r,onEdit:n,onReprocess:a,onDownloadXML:i,onInactivate:s}){if(!e)return null;const l=t.reduce((d,u)=>d+Number(u.valor_total||0),0),c=d=>d?.data_importacao?oye(new Date,new Date(d.data_importacao))<=7:!1;return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-3 py-4 bg-black/60 backdrop-blur-sm",children:o.jsxs("div",{className:"relative w-[95vw] sm:w-full sm:max-w-4xl max-h-[85vh] bg-surface rounded-xl shadow-2xl border border-border overflow-hidden flex flex-col",children:[o.jsxs("div",{className:"relative bg-surface border-b border-border p-4",children:[o.jsx("button",{onClick:r,className:"absolute top-3 right-3 p-1.5 hover:bg-surface-2 rounded-lg transition-colors",children:o.jsx(Ml,{className:"h-4 w-4 text-text-muted"})}),o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 sm:gap-4 pr-0 sm:pr-10",children:[o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:"p-2 bg-brand/10 rounded-lg",children:o.jsx(ns,{className:"h-5 w-5 text-brand"})}),o.jsxs("div",{children:[o.jsxs("h2",{className:"text-xl font-bold text-text-primary mb-0.5",children:["NF-e ",e.numero_nfe,e.serie_nfe&&` / Srie ${e.serie_nfe}`]}),o.jsx("p",{className:"text-text-muted text-xs",children:e.natureza_operacao||"Nota Fiscal Eletrnica"})]})]}),o.jsxs("div",{className:"mt-3 sm:mt-0 sm:text-right",children:[o.jsx("p",{className:"text-text-muted text-xs mb-0.5",children:"Valor Total"}),o.jsxs("p",{className:"text-xl sm:text-2xl font-bold text-success whitespace-nowrap",children:["R$ ",Number(e.valor_total||0).toFixed(2)]})]})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6 space-y-6",children:o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"bg-surface-2 rounded-lg border border-border p-4",children:o.jsxs("div",{className:"flex flex-col gap-3",children:[o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:"flex-shrink-0 mt-0.5",children:o.jsx(ju,{className:"h-4 w-4 text-brand"})}),o.jsxs("div",{className:"min-w-0",children:[o.jsx("p",{className:"text-xs font-medium text-text-muted mb-0.5",children:"Fornecedor"}),o.jsx("p",{className:"font-semibold text-base text-text-primary leading-snug break-words",children:e.fornecedor?.nome||"No identificado"}),e.fornecedor?.cnpj&&o.jsxs("p",{className:"text-xs text-text-muted mt-0.5",children:["CNPJ: ",e.fornecedor.cnpj]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 lg:grid-cols-5 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx(Ei,{className:"h-3.5 w-3.5 text-info"}),o.jsx("span",{className:"text-xs font-medium text-text-muted",children:"Emisso"})]}),o.jsx("p",{className:"font-semibold text-text-primary",children:e.data_emissao?Jt(new Date(e.data_emissao),"dd/MM/yyyy",{locale:ia}):"No informada"})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx(oue,{className:"h-3.5 w-3.5 text-warning"}),o.jsx("span",{className:"text-xs font-medium text-text-muted",children:"Operao"})]}),o.jsx("p",{className:"font-semibold text-text-primary",children:e.tipo_operacao||"Entrada"})]}),e.forma_pagamento&&o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx(Cm,{className:"h-3.5 w-3.5 text-success"}),o.jsx("span",{className:"text-xs font-medium text-text-muted",children:"Pagamento"})]}),o.jsx("p",{className:"font-semibold text-text-primary",children:e.forma_pagamento})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs font-medium text-text-muted mb-1",children:"Valor dos Produtos"}),o.jsxs("p",{className:"font-semibold text-text-primary",children:["R$ ",l.toFixed(2)]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs font-medium text-text-muted mb-1",children:"Valor Total NF-e"}),o.jsxs("p",{className:"font-semibold text-brand",children:["R$ ",Number(e.valor_total||0).toFixed(2)]})]})]})]})}),o.jsxs("div",{children:[o.jsxs("h3",{className:"text-base font-semibold text-text-primary flex items-center gap-2 mb-3",children:[o.jsx(ud,{className:"h-4 w-4 text-brand"}),"Produtos da NF-e",o.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-brand/10 text-brand font-medium ml-2",children:t.length})]}),o.jsx("div",{className:"space-y-2",children:t.map((d,u)=>o.jsx("div",{className:"p-3 bg-surface-2 rounded-lg border border-border hover:border-brand/30 transition-colors",children:o.jsxs("div",{className:"flex items-start justify-between gap-3",children:[o.jsx("div",{className:"flex-1 min-w-0",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx("span",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-brand/10 text-brand text-xs font-bold flex items-center justify-center mt-0.5",children:u+1}),o.jsxs("div",{className:"flex-1",children:[d.produto?.nome?o.jsxs(o.Fragment,{children:[o.jsxs("p",{className:"font-medium text-base text-text-primary mb-0.5",children:["Produto atual: ",d.produto.nome]}),d.nome_produto_xml&&o.jsxs("p",{className:"text-xs text-text-muted mb-1",children:["XML original: ",o.jsx("span",{className:"font-medium text-text-primary",children:d.nome_produto_xml})]})]}):o.jsx("p",{className:"font-medium text-sm text-text-primary mb-1",children:d.nome_produto_xml}),o.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-0.5 text-xs text-text-muted mb-1.5",children:[(d.produto?.codigo_produto||d.codigo_produto_xml)&&o.jsxs("span",{children:[o.jsx("span",{className:"font-medium",children:"Cd:"})," ",d.produto?.codigo_produto||d.codigo_produto_xml]}),d.ean_xml&&d.ean_xml!=="SEM GTIN"&&o.jsxs("span",{children:[o.jsx("span",{className:"font-medium",children:"EAN:"})," ",d.ean_xml]}),d.ncm_xml&&o.jsxs("span",{children:[o.jsx("span",{className:"font-medium",children:"NCM:"})," ",d.ncm_xml]}),d.unidade_xml&&o.jsxs("span",{children:[o.jsx("span",{className:"font-medium",children:"Un:"})," ",d.unidade_xml]}),d.produto&&o.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-success/20 text-success font-medium",children:" Cadastrado"}),d.produto&&c(d.produto)&&o.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-brand/20 text-brand font-medium",children:[o.jsx(Pk,{className:"h-3 w-3"}),"Novo"]}),d.vinculado_manualmente&&o.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-warning/20 text-warning font-medium",children:" Vinculado"}),!d.produto&&o.jsx("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-text-muted/20 text-text-muted font-medium",children:" No importado"})]})]})]})}),o.jsxs("div",{className:"flex-shrink-0 text-right",children:[o.jsxs("div",{className:"mb-1.5",children:[o.jsx("span",{className:"text-xs text-text-muted mr-1",children:"Qtd:"}),o.jsx("span",{className:"font-bold text-base text-warning",children:d.quantidade})]}),o.jsxs("div",{className:"space-y-0.5",children:[o.jsxs("p",{className:"text-xs text-text-muted",children:["Unit: ",o.jsxs("span",{className:"font-semibold text-success",children:["R$ ",Number(d.valor_unitario||0).toFixed(2)]})]}),o.jsxs("p",{className:"text-sm font-bold text-text-primary",children:["Total: R$ ",Number(d.valor_total||0).toFixed(2)]})]})]})]})},u))})]}),e.chave_nfe&&o.jsxs("div",{className:"p-3 bg-surface-2 rounded-lg border border-border",children:[o.jsxs("p",{className:"text-xs font-medium text-text-muted mb-1.5 flex items-center gap-1.5",children:[o.jsx(ns,{className:"h-3 w-3"}),"Chave de Acesso NF-e:"]}),o.jsx("p",{className:"font-mono text-xs text-text-primary break-all leading-relaxed select-all",children:e.chave_nfe})]})]})}),o.jsxs("div",{className:"p-3 sm:p-4 bg-surface-2 border-t border-border flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[o.jsx("div",{className:"flex flex-wrap gap-2",children:e.ativo&&o.jsxs(o.Fragment,{children:[o.jsxs(oe,{onClick:()=>n?.(e),size:"sm",variant:"outline",className:"gap-2",children:[o.jsx(El,{className:"h-4 w-4"}),"Editar"]}),o.jsxs(oe,{onClick:()=>a?.(e),size:"sm",variant:"outline",className:"gap-2",disabled:!e.xml_completo,children:[o.jsx(Cp,{className:"h-4 w-4"}),"Reprocessar"]}),e.xml_completo&&o.jsx(o.Fragment,{children:o.jsxs(oe,{onClick:()=>i?.(e),size:"sm",variant:"outline",className:"gap-2",children:[o.jsx(ri,{className:"h-4 w-4"}),"XML"]})}),o.jsxs(oe,{onClick:()=>s?.(e),size:"sm",variant:"outline",className:"gap-2 text-destructive hover:text-destructive",children:[o.jsx(Um,{className:"h-4 w-4"}),"Inativar"]})]})}),o.jsx(oe,{onClick:r,variant:"outline",className:"w-full sm:w-auto",children:"Fechar"})]})]})})}function Tat({open:e,onOpenChange:t,purchase:r,products:n,codigoEmpresa:a,onSuccess:i,autoFile:s}){const{toast:l}=oo(),[c,d]=p.useState("upload"),[u,f]=p.useState(null),[m,h]=p.useState(null),[v,g]=p.useState([]),[y,x]=p.useState(!1),[b,w]=p.useState({created:0,updated:0,errors:0,details:[]}),[j,_]=p.useState({}),[C,E]=p.useState({}),[P,k]=p.useState({}),[M,S]=p.useState({isOpen:!1,productIndex:null,currentProduct:null}),[I,T]=p.useState({isOpen:!1}),D=()=>{const K=m?.nfe?.modelo||r?.modelo_nfe;return K==="55"?"NF-e":K==="65"?"NFC-e":"NF-e / NFC-e"},B=(K,Q,re)=>j[K]?.[Q]??re,U=(K,Q)=>!K||!Q?0:K*(1+Q/100),z=K=>{E(Q=>({...Q,[K]:!Q[K]}))},$=(K,Q,re)=>{console.log("[XMLReprocessModal] handleEditProduct chamado:",{index:K,field:Q,value:re}),_(G=>{const me={...G,[K]:{...G[K],[Q]:re}};return console.log("[XMLReprocessModal] Novo estado editedProducts:",me),me})},Y=K=>{g(Q=>Q.map((re,G)=>{if(G===K){const me=!re.selected;return k(pe=>({...pe,[K]:me})),{...re,selected:me}}return re}))},de=(K,Q)=>{console.log("[XMLReprocessModal] handleLinkProduct chamado:",{index:K,productId:Q}),console.log("[XMLReprocessModal] Estado editedProducts antes:",j[K]),$(K,"linkedProductId",Q),console.log("[XMLReprocessModal] Estado editedProducts depois:",{...j,[K]:{...j[K],linkedProductId:Q}})};p.useEffect(()=>{s&&e&&xe(s)},[s,e]);const xe=async K=>{f(K);try{console.log("[XMLReprocess] Processando arquivo automtico..."),console.log("[XMLReprocess] Purchase data:",r);const re=await K.text();console.log("[XMLReprocess] XML content length:",re.length);const G=Q_(re);if(!G.success){l({title:"Erro ao ler XML",description:G.error||"XML invlido",variant:"destructive"});return}console.log("[XMLReprocess] Dados parseados:",G.data),console.log("[XMLReprocess] Produtos encontrados:",G.data?.produtos?.length||0),console.log("[XMLReprocess] Comparando chaves:",{xmlChave:G.data?.nfe?.chaveAcesso,purchaseChave:r?.chave_nfe,match:G.data?.nfe?.chaveAcesso===r?.chave_nfe}),h(G.data);const me=await Wae(r.id);console.log("[XMLReprocess] Itens da compra original:",me.length);const pe=G.data?.produtos?.map((Z,ee)=>{const kt=Z_(Z,n),Nt=!kt,De=me.find(yt=>Z.codigo&&yt.codigo_produto_xml?yt.codigo_produto_xml===Z.codigo:yt.nome_produto_xml===Z.nome),st=!!De,ft=De?.selecionado_na_importacao||!1;return console.log(`[XMLReprocess] Produto ${ee+1}: ${Z.nome}`),console.log(`  - Cdigo XML: ${Z.codigo}`),console.log("  - originalItem encontrado:",De?`${De.nome_produto_xml} (cdigo: ${De.codigo_produto_xml})`:"NO ENCONTRADO"),console.log(`  - wasImported: ${st}`),console.log(`  - wasSelectedInOriginalImport: ${ft}`),{index:ee,xml:Z,existing:kt,isNew:Nt,wasImported:st,selected:P[ee]!==void 0?P[ee]:st}})||[];console.log("[XMLReprocess] Preview preparado:",pe.length,"produtos"),console.log("[XMLReprocess] Produtos marcados:",pe.filter(Z=>Z.selected).length),console.log("[XMLReprocess] Produtos importados originalmente:",pe.filter(Z=>Z.wasImported).length),console.log("[XMLReprocess] Items da compra original detalhado:"),me.forEach((Z,ee)=>{console.log(`  ${ee+1}. ${Z.nome_produto_xml} (cdigo: ${Z.codigo_produto_xml}) - selecionado_na_importacao: ${Z.selecionado_na_importacao}`)}),g(pe);const Be={};pe.forEach((Z,ee)=>{Z.xml.precoVenda&&(Be[ee]={salePrice:Number(Z.xml.precoVenda)})}),console.log("[XMLReprocess] Pr-populando editedProducts:",Be),_(Be),d("preview")}catch(re){console.error("[XMLReprocess] Erro ao processar arquivo automtico:",re),l({title:"Erro",description:"Erro ao processar o XML salvo.",variant:"destructive"})}},q=async K=>{const Q=K.target.files?.[0];if(!Q){console.log("[XMLReprocess] Nenhum arquivo selecionado");return}if(console.log("[XMLReprocess] Arquivo selecionado:",Q.name),!Q.name.endsWith(".xml")){l({title:"Arquivo invlido",description:"Selecione um arquivo XML vlido.",variant:"destructive"});return}f(Q);try{console.log("[XMLReprocess] Lendo contedo do arquivo...");const re=await Q.text();console.log("[XMLReprocess] Arquivo lido, parseando XML...");const G=Q_(re);if(console.log("[XMLReprocess] XML parseado:",G),!G.success){l({title:"Erro ao ler XML",description:G.error||"XML invlido",variant:"destructive"});return}if(!G.data?.produtos||G.data.produtos.length===0){l({title:"Nenhum produto encontrado",description:"O XML no contm produtos.",variant:"warning"});return}if(G.data?.nfe?.chaveAcesso!==r?.chave_nfe){l({title:"XML incompatvel",description:"Este XML no corresponde  NF-e selecionada. Verifique a chave de acesso.",variant:"destructive"});return}h(G.data);let me=n;try{me=await qu({search:"",codigoEmpresa:a,includeInactive:!0})||n,console.log("[XMLReprocess] Produtos carregados para validao:",me.length)}catch(Z){console.warn("[XMLReprocess] No foi possvel carregar lista completa, usando cache:",Z)}const pe=G.data.produtos.map((Z,ee)=>{const kt=Z_(Z,me);return{xml:Z,existing:kt,isNew:!kt,willCreate:!kt,willUpdate:!!kt,selected:!0,index:ee}});g(pe);const Be={};pe.forEach((Z,ee)=>{Z.xml.precoVenda&&(Be[ee]={salePrice:Number(Z.xml.precoVenda)})}),console.log("[XMLReprocess] Pr-populando editedProducts:",Be),_(Be),console.log("[XMLReprocess] Preview preparado, mudando para step preview. Total produtos:",pe.length),d("preview")}catch(re){console.error("[XMLReprocess] Erro ao processar arquivo:",re),l({title:"Erro",description:"Erro ao processar o arquivo XML.",variant:"destructive"})}},L=()=>{T({isOpen:!0})},W=async()=>{if(T({isOpen:!1}),!m||!r){l({title:"Erro",description:"Dados insuficientes para reprocessamento.",variant:"destructive"});return}x(!0),d("processing");const K={created:0,updated:0,removed:0,errors:0,details:[]},Q=v.filter(G=>G.selected),re=v.filter(G=>!G.selected);console.log("[XMLReprocess] Iniciando reprocessamento para compra:",r.id),console.log("[XMLReprocess] Produtos selecionados:",Q.length),console.log("[XMLReprocess] Produtos desmarcados:",re.length);try{for(const G of re){const pe=(j[G.index]||{}).name||G.xml.nome,Be=Number(G.xml.quantidade);try{if(G.isNew){const Z=G.existing;Z&&(await tR(Z.id),K.removed++,K.details.push({produto:pe,acao:"Produto removido (era novo e foi desmarcado)",status:"success"}))}else{const Z=G.existing;Z&&Be>0&&(await Gv({productId:Z.id,delta:-Be,codigoEmpresa:r.codigo_empresa}),K.updated++,K.details.push({produto:pe,acao:`Estoque revertido -${Be}`,status:"success"}))}}catch(Z){console.error(`[XMLReprocess] Erro ao processar produto desmarcado: ${pe}`,Z),K.errors++,K.details.push({produto:pe,acao:`Erro ao reverter: ${Z.message}`,status:"error"})}}for(const G of Q){const me=j[G.index]||{},pe=me.name||G.xml.nome,Be=me.qty!==void 0?me.qty:Number(G.xml.quantidade),Z=me.margin,ee=me.salePrice,kt=me.linkedProductId;try{if(G.isNew&&(!kt||kt==="new")){const Nt=b4(G.xml,r.codigo_empresa);if(pe&&(Nt.name=pe),ee!=null)Nt.salePrice=ee,Nt.price=ee;else if(Z!=null&&Z>0){const st=Nt.costPrice||0;if(st>0){const ft=st*(1+Z/100);Nt.salePrice=ft,Nt.price=ft}}else Nt.salePrice!=null&&Nt.price==null&&(Nt.price=Nt.salePrice);const De=await J_(Nt,{codigoEmpresa:r.codigo_empresa});Be>0&&await Gv({productId:De.id,delta:Be,codigoEmpresa:r.codigo_empresa}),K.created++,K.details.push({produto:pe,acao:Be>0?`Criado com estoque ${Be}`:"Criado",status:"success"})}else{const Nt=kt&&kt!=="force-new"&&kt!=="new"?n.find(De=>De.id===kt):G.existing;if(me.updatePrice&&Nt){const De=Number(G.xml.valorUnitario)||0,st={};if(De>0&&(st.costPrice=De),ee!=null)st.salePrice=ee,st.price=ee;else if(Z!=null&&Z>0&&De>0){const ft=De*(1+Z/100);st.salePrice=ft,st.price=ft}await C5(Nt.id,st)}K.updated++,K.details.push({produto:pe,acao:me.updatePrice?"Preo atualizado":"Mantido sem alteraes",status:"success"})}}catch(Nt){console.error(`[XMLReprocess] Erro ao processar produto: ${pe}`,Nt),K.errors++,K.details.push({produto:pe,acao:`Erro: ${Nt.message}`,status:"error"})}}}catch(G){console.error("[XMLReprocess] Erro geral no reprocessamento:",G),K.errors++,K.details.push({produto:"Sistema",acao:`Erro geral: ${G.message}`,status:"error",error:G.message})}try{const G=Q.map(me=>{const pe=j[me.index]||{},Be=pe.linkedProductId;let Z=null;return Be&&Be!=="force-new"?Z=Be:!me.isNew&&Be!=="force-new"&&(Z=me.existing?.id||null),{produtoId:Z,codigoProdutoXML:me.xml.codigo,nomeProdutoXML:me.xml.nome,eanXML:me.xml.ean,ncmXML:me.xml.ncm,cfopXML:me.xml.cfop,unidadeXML:me.xml.unidade,quantidade:pe.qty!==void 0?pe.qty:Number(me.xml.quantidade),valorUnitario:Number(me.xml.valorUnitario)||0,valorTotal:Number(me.xml.valorTotal)||0,vinculadoManualmente:!!Be&&Be!=="force-new"}});await wat(r.id,G),console.log("[XMLReprocess] Itens reprocessados:",G.length)}catch(G){console.error("[XMLReprocess] Erro ao reprocessar itens da compra:",G),K.errors++,K.details.push({produto:"Itens da NF-e",acao:"Erro ao reprocessar",status:"error",error:G.message})}w(K),x(!1),d("done"),K.errors===0?l({title:"Reprocessamento concludo!",description:`${K.created} produto(s) criado(s), ${K.updated} atualizado(s).`,variant:"success"}):l({title:"Reprocessamento com erros",description:`${K.errors} erro(s) encontrado(s). Verifique os detalhes.`,variant:"destructive"}),i&&i()};p.useEffect(()=>{e||(d("upload"),f(null),h(null),g([]),_({}),E({}),w({created:0,updated:0,errors:0,details:[]}),x(!1),k({}))},[e]);const ne=()=>{t(!1)},le=v.filter(K=>K.selected).length;return o.jsxs(ln,{open:e,onOpenChange:ne,children:[o.jsxs(on,{className:"w-[95vw] sm:max-w-4xl max-h-[85vh] overflow-hidden flex flex-col",children:[o.jsxs(nn,{children:[o.jsxs(rn,{className:"flex items-center gap-2",children:[o.jsx(Cp,{className:"h-5 w-5"}),o.jsx("span",{children:"Reprocessar XML"}),o.jsx("span",{className:"inline-flex items-center rounded-full bg-surface-2 border border-border px-2 py-0.5 text-xs font-semibold text-text-muted uppercase tracking-wide",children:D()}),o.jsx("span",{className:"text-sm text-text-muted",children:r?.numero_nfe})]}),o.jsx(_n,{children:"Reimporte o XML para atualizar os produtos e itens desta NF-e. Os itens atuais sero substitudos pelos novos."})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto",children:[c==="upload"&&o.jsx("div",{className:"space-y-6",children:o.jsxs("div",{className:"border-2 border-dashed border-border rounded-lg p-8 text-center",children:[o.jsx(LI,{className:"h-12 w-12 mx-auto text-text-muted mb-4"}),o.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Selecione o arquivo XML"}),o.jsxs("p",{className:"text-text-muted mb-4",children:["Faa upload do XML da NF-e ",r?.numero_nfe," para reprocessar os produtos"]}),o.jsx("input",{type:"file",accept:".xml",onChange:q,className:"hidden",id:"xml-reprocess-upload"}),o.jsx("label",{htmlFor:"xml-reprocess-upload",children:o.jsx(oe,{asChild:!0,children:o.jsx("span",{children:"Selecionar XML"})})})]})}),c==="preview"&&m&&o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4",children:[o.jsx("h3",{className:"font-semibold mb-2",children:"Informaes da NF-e"}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Nmero:"})," ",m.nfe.numero]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Srie:"})," ",m.nfe.serie]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Modelo:"})," ",D()]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Fornecedor:"})," ",m.fornecedor?.nome]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Total:"})," R$ ",Number(m.nfe.totalNota||0).toFixed(2)]})]})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"font-semibold text-base",children:"Produtos Encontrados"}),o.jsxs("span",{className:"text-sm text-text-muted",children:[v.filter(K=>K.selected).length," de ",v.length," selecionados"]})]}),o.jsx("div",{className:"space-y-2",children:v.map((K,Q)=>{const re=B(Q,"name",K.xml.nome),G=B(Q,"qty",Number(K.xml.quantidade)),me=B(Q,"linkedProductId",null),pe=K.xml.valorUnitario||0,Be=B(Q,"margin",null);let ee=B(Q,"salePrice",null);ee==null&&!K.isNew&&K.existing&&(ee=Number(K.existing.preco_venda||K.existing.salePrice||K.existing.price||0)),ee==null&&Be!=null&&(ee=U(pe,Be)),ee==null&&K.xml.precoVenda&&(ee=Number(K.xml.precoVenda));let kt=null;if(Be!=null)kt=Be;else if(ee!=null&&pe>0&&ee>0){const De=(ee-pe)/pe*100;kt=Math.max(-999,Math.min(9999,De))}const Nt=C[Q];return o.jsxs("div",{className:Yt("rounded-lg border transition-all",K.selected?"bg-info/10 border-info/30":"bg-surface opacity-60 border-border"),children:[o.jsxs("div",{className:"p-3 flex flex-col gap-2 sm:flex-row sm:items-center sm:gap-3",children:[o.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[o.jsx("input",{type:"checkbox",checked:K.selected,onChange:()=>Y(Q),className:"w-4 h-4 rounded border-border accent-warning cursor-pointer"}),o.jsx("button",{onClick:()=>z(Q),className:"p-0.5 hover:bg-surface-2 rounded transition-colors",children:Nt?o.jsx(L1,{className:"w-4 h-4 text-text-muted"}):o.jsx(Kx,{className:"w-4 h-4 text-text-muted"})}),o.jsx("div",{children:me?o.jsx(aH,{className:"w-5 h-5 text-warning"}):o.jsx(Cp,{className:"w-5 h-5 text-info"})})]}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-baseline justify-between gap-2",children:[o.jsxs("div",{className:"min-w-0",children:[o.jsx("p",{className:"font-semibold text-sm truncate",children:me&&me!=="force-new"&&me!=="new"?(()=>{const De=n.find(st=>st.id===me);return De?De.name:re})():re}),o.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-text-muted mt-0.5",children:[K.xml.codigo&&o.jsxs("span",{className:"flex-shrink-0",children:["#",K.xml.codigo]}),o.jsxs("span",{children:["Qtd: ",G]})]})]}),o.jsx("div",{className:"flex-shrink-0 ml-2",children:me?o.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-warning/20 text-warning font-medium",children:"Vinculado"}):o.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-info/20 text-info font-medium",children:"Cadastrado"})})]}),o.jsxs("div",{className:"mt-1 text-[11px] text-text-muted",children:[o.jsxs("span",{children:["R$ ",pe.toFixed(2),ee?`  R$ ${ee.toFixed(2)}`:""]}),kt!=null&&o.jsxs("span",{className:"ml-2 "+(kt>0?"text-success":kt<0?"text-destructive":"text-text-muted"),children:[kt.toFixed(1),"%"]})]})]})]}),Nt&&o.jsxs("div",{className:"px-3 pb-3 pt-0 space-y-3 border-t border-border/50",children:[o.jsxs("div",{className:"mt-3",children:[o.jsx("label",{className:"text-sm font-medium text-text-primary mb-1 block",children:"Nome do Produto"}),o.jsx("input",{type:"text",value:re,onChange:De=>$(Q,"name",De.target.value),disabled:!K.selected,className:"w-full px-3 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 disabled:cursor-not-allowed"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Quantidade"}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{type:"button",onClick:()=>$(Q,"qty",Math.max(0,G-1)),disabled:!K.selected||G<=0,className:"w-9 h-9 rounded-md border border-border bg-surface hover:bg-surface-2 disabled:opacity-30 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:o.jsx(gv,{className:"w-4 h-4"})}),o.jsx("input",{type:"text",value:G,onChange:De=>{const st=De.target.value.replace(/\D/g,"");$(Q,"qty",st===""?0:Number(st))},disabled:!K.selected,className:"w-14 text-center px-2 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50"}),o.jsx("button",{type:"button",onClick:()=>$(Q,"qty",G+1),disabled:!K.selected,className:"w-9 h-9 rounded-md bg-warning hover:bg-warning/90 disabled:opacity-30 disabled:cursor-not-allowed transition-colors flex items-center justify-center text-black font-bold shadow-sm",children:o.jsx(Ka,{className:"w-4 h-4"})})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Margem %"}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"text",value:(()=>{const De=B(Q,"margin",null);return De!=null?String(De):""})(),onChange:De=>{const st=De.target.value;if(st===""){$(Q,"margin",null),$(Q,"salePrice",null);return}const ft=st.replace(/[^0-9.,\-]/g,"").replace(",",".");if(ft==="."||ft==="-"||ft==="-.")return;const yt=parseFloat(ft);if(!isNaN(yt)&&($(Q,"margin",yt),pe>0)){const Nr=U(pe,yt);$(Q,"salePrice",Nr)}},disabled:!K.selected,placeholder:"0",className:"w-24 pl-3 pr-6 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 text-right"}),o.jsx("span",{className:"absolute right-1.5 top-1/2 -translate-y-1/2 text-sm text-text-muted pointer-events-none",children:"%"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Custo"}),o.jsx("div",{className:"px-3 py-2 bg-surface/50 rounded-md border border-border",children:o.jsxs("span",{className:"text-sm font-semibold",children:["R$ ",pe.toFixed(2)]})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-muted mb-1 block",children:"Preo Venda"}),o.jsxs("div",{className:"relative",children:[o.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-sm text-text-muted pointer-events-none",children:"R$"}),o.jsx("input",{type:"text",value:(()=>{const De=B(Q,"salePrice",ee);return De==null?"":Number(De).toFixed(2).replace(".",",")})(),onChange:De=>{const st=De.target.value.replace(/\D/g,"");if(st===""){$(Q,"salePrice",null);return}const ft=Number(st)/100;if($(Q,"salePrice",ft),ft>0&&pe>0){const yt=(ft-pe)/pe*100;$(Q,"margin",Math.round(yt*100)/100)}},disabled:!K.selected,placeholder:"0,00",className:"w-28 pl-7 pr-3 py-2 text-sm bg-surface border border-border rounded-md focus:border-brand focus:ring-1 focus:ring-brand outline-none disabled:opacity-50 text-right font-semibold text-success"})]})]})]}),o.jsxs("div",{className:"flex items-center space-x-2 mt-3",children:[o.jsx("input",{type:"checkbox",id:`update-price-${Q}`,checked:B(Q,"updatePrice",!1),onChange:De=>$(Q,"updatePrice",De.target.checked),disabled:!K.selected,className:"w-4 h-4 text-brand bg-surface border-border rounded focus:ring-brand focus:ring-2 disabled:opacity-50"}),o.jsx("label",{htmlFor:`update-price-${Q}`,className:"text-sm text-text-primary select-none cursor-pointer",children:"Atualizar preo do produto no sistema"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium text-text-primary mb-1 block",children:"Vincular a Produto Existente (Opcional)"}),o.jsxs(En,{value:me==="force-new"?"force-new":me||(K.isNew?"new":K.existing?.id||"new"),onValueChange:De=>{De==="new"||De===K.existing?.id?de(Q,null):De==="search"?S({isOpen:!0,productIndex:Q,currentProduct:K}):de(Q,De)},disabled:!K.selected,children:[o.jsx(Sn,{className:"w-full hover:bg-white/5 transition-colors",children:o.jsx(kn,{placeholder:K.isNew?" Criar como novo produto":" Atualizar produto existente"})}),o.jsxs(Cn,{className:"max-h-[300px] overflow-y-auto",children:[K.isNew?o.jsx(wt,{value:"new",children:" Criar como novo produto"}):o.jsxs(wt,{value:K.existing?.id||"new",children:[" Atualizar: ",K.existing?.name," (Estoque atual: ",K.existing?.stock||0,")"]}),!K.isNew&&o.jsx(wt,{value:"force-new",children:" Criar como novo produto (ignorar existente)"}),o.jsx(wt,{value:"search",children:" Buscar produto para vincular..."})]})]})]})]})]},Q)})})]})]}),c==="processing"&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[o.jsx(Pm,{className:"h-12 w-12 animate-spin text-brand mb-4"}),o.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Reprocessando XML..."}),o.jsx("p",{className:"text-text-muted",children:"Atualizando produtos e itens da NF-e"})]}),c==="done"&&o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"text-center py-6",children:[b.errors===0?o.jsx(Ai,{className:"h-12 w-12 text-success mx-auto mb-4"}):o.jsx(hc,{className:"h-12 w-12 text-warning mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-semibold mb-2",children:b.errors===0?"Reprocessamento Concludo!":"Reprocessamento com Erros"}),o.jsxs("div",{className:"text-text-muted",children:[b.created," produto(s) criado(s), ",b.updated," atualizado(s)",b.errors>0&&`, ${b.errors} erro(s)`]})]}),b.details.length>0&&o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold mb-3",children:"Detalhes do Reprocessamento"}),o.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:b.details.map((K,Q)=>o.jsxs("div",{className:Yt("flex items-center gap-3 p-2 rounded",K.status==="success"?"bg-green-50 text-green-800":K.status==="error"?"bg-red-50 text-red-800":"bg-gray-50 text-gray-800"),children:[K.status==="success"?o.jsx(Ai,{className:"h-4 w-4 flex-shrink-0"}):o.jsx(hc,{className:"h-4 w-4 flex-shrink-0"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-medium truncate",children:K.produto}),o.jsx("div",{className:"text-xs",children:K.acao}),K.error&&o.jsx("div",{className:"text-xs mt-1 opacity-75",children:K.error})]})]},Q))})]})]})]}),o.jsxs(Un,{children:[c==="upload"&&o.jsx(oe,{variant:"outline",onClick:ne,children:"Cancelar"}),c==="preview"&&o.jsxs(o.Fragment,{children:[o.jsx(oe,{variant:"outline",onClick:()=>d("upload"),children:"Voltar"}),o.jsxs(oe,{onClick:L,disabled:le===0,children:["Reprocessar (",le," produtos)"]})]}),c==="done"&&o.jsx(oe,{onClick:ne,children:"Fechar"})]})]}),o.jsx(Hae,{isOpen:M.isOpen,onClose:()=>S({isOpen:!1,productIndex:null,currentProduct:null}),onSelect:K=>{console.log("[XMLReprocessModal] onSelect chamado com produto:",K),console.log("[XMLReprocessModal] Index do produto:",M.productIndex),de(M.productIndex,K.id),S({isOpen:!1,productIndex:null,currentProduct:null})},currentProduct:M.currentProduct}),o.jsx(Gae,{isOpen:I.isOpen,onClose:()=>T({isOpen:!1}),onConfirm:W,products:v.map((K,Q)=>({...K,originalIndex:Q})),editedProducts:j,allProducts:n,isReprocess:!0})]})}const aU="comprasPage:settings";function Dat(){const{user:e,userProfile:t}=Do(),[r,n]=p.useState([]),[a,i]=p.useState(!0),[s,l]=p.useState(""),[c,d]=p.useState(null),[u,f]=p.useState([]),[m,h]=p.useState(!1),[v,g]=p.useState(()=>pl(new Date)),[y,x]=p.useState(()=>VS(new Date)),[b,w]=p.useState("all"),[j,_]=p.useState(!0),[C,E]=p.useState(!1),[P,k]=p.useState("active"),[M,S]=p.useState({show:!1,purchase:null}),[I,T]=p.useState(""),[D,B]=p.useState({show:!1,purchase:null}),[U,z]=p.useState({}),[$,Y]=p.useState({show:!1,purchase:null}),[de,xe]=p.useState([]),[q,L]=p.useState(!1),[W,ne]=p.useState(!1),[le,K]=p.useState("paged"),Q=le==="paged",[re,G]=p.useState(1),[me]=p.useState(100),[pe,Be]=p.useState(0),Z=ae=>{const $e=String(ae||"").replace(/\D/g,"");return($e?Number($e)/100:0).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})},ee=ae=>{if(!ae.xml_completo){alert("XML no disponvel para esta NF-e");return}const $e=new Blob([ae.xml_completo],{type:"text/xml;charset=utf-8"}),Ae=URL.createObjectURL($e),Tt=document.createElement("a");Tt.href=Ae,Tt.download=`${ae.chave_nfe}.xml`,document.body.appendChild(Tt),Tt.click(),document.body.removeChild(Tt),URL.revokeObjectURL(Ae)},kt=async ae=>{if(!ae.xml_completo){alert("XML no disponvel para reprocessamento automtico");return}if(confirm("Deseja reprocessar esta NF-e? Isso substituir todos os itens atuais pelos dados do XML original."))try{console.log("[ComprasPage] Iniciando reprocessamento para purchase:",ae),console.log("[ComprasPage] Chave NF-e:",ae.chave_nfe),console.log("[ComprasPage] XML disponvel:",!!ae.xml_completo);const $e=new Blob([ae.xml_completo],{type:"text/xml"}),Ae=new File([$e],`${ae.chave_nfe}.xml`,{type:"text/xml"});Y({show:!0,purchase:ae,autoFile:Ae})}catch($e){console.error("Erro no reprocessamento automtico:",$e),alert("Erro ao iniciar reprocessamento automtico")}},Nt=ae=>{if(!ae)return 0;const $e=String(ae).replace(/\./g,"").replace(",",".");return parseFloat($e)||0};p.useEffect(()=>{try{const ae=localStorage.getItem(aU);if(!ae)return;const $e=JSON.parse(ae);$e&&typeof $e=="object"&&(($e.listMode==="paged"||$e.listMode==="all")&&K($e.listMode),typeof $e.showStats=="boolean"&&_($e.showStats))}catch{}},[]),p.useEffect(()=>{(async()=>{if(!e?.id||!t?.codigo_empresa)return;const $e=`compras:${t.codigo_empresa}`,Ae=await zae({userId:e.id,scope:$e});Ae&&((Ae.listMode==="paged"||Ae.listMode==="all")&&K(Ae.listMode),typeof Ae.showStats=="boolean"&&_(Ae.showStats))})()},[e?.id,t?.codigo_empresa]),p.useEffect(()=>{try{const ae={listMode:le,showStats:j};localStorage.setItem(aU,JSON.stringify(ae))}catch{}if(e?.id&&t?.codigo_empresa){const ae=`compras:${t.codigo_empresa}`;Uae({userId:e.id,scope:ae,settings:{listMode:le,showStats:j}})}},[le,j,e?.id,t?.codigo_empresa]),p.useEffect(()=>{t?.codigo_empresa&&(st(),De())},[t,P,b,v,y,re,le]),p.useEffect(()=>{G(1)},[P,b,v,y,le]);const De=async()=>{try{const ae=await qu({codigoEmpresa:t.codigo_empresa});xe(ae||[])}catch(ae){console.error("[Compras] Erro ao carregar produtos:",ae)}},st=async()=>{try{i(!0);let ae=null,$e=null;if(v){const Ue=new Date(v);Ue.setHours(0,0,0,0),ae=Ue.toISOString()}if(y){const Ue=new Date(y);Ue.setHours(23,59,59,999),$e=Ue.toISOString()}const Se={incluirInativas:P==="all"||P==="inactive",apenasInativas:P==="inactive",fornecedorId:b!=="all"?b:void 0,dataInicio:ae,dataFim:$e,page:Q?re:1,pageSize:Q?me:1e4},Ne=await xat(t.codigo_empresa,Se);n(Ne?.data||[]),Be(Ne?.count||0)}catch(ae){console.error("[Compras] Erro ao carregar compras:",ae)}finally{i(!1)}},ft=async ae=>{d(ae),h(!0);try{const $e=await Wae(ae.id);f($e||[])}catch($e){console.error("[Compras] Erro ao carregar itens:",$e),f([])}finally{h(!1)}},yt=()=>{d(null),f([])},Nr=ae=>{B({show:!0,purchase:ae}),z({numeroNfe:ae.numero_nfe||"",serieNfe:ae.serie_nfe||"",dataEmissao:ae.data_emissao?ae.data_emissao.split("T")[0]:"",tipoOperacao:ae.tipo_operacao||"",naturezaOperacao:ae.natureza_operacao||"",valorProdutos:Z((ae.valor_produtos||0)*100),valorTotal:Z((ae.valor_total||0)*100),formaPagamento:ae.forma_pagamento||"",observacoes:ae.observacoes||""})},se=async()=>{try{await jat(D.purchase.id,{...U,valorProdutos:Nt(U.valorProdutos),valorTotal:Nt(U.valorTotal),fornecedorId:D.purchase.fornecedor_id}),await st(),B({show:!1,purchase:null}),z({}),console.log("Compra editada com sucesso!")}catch(ae){console.error("Erro ao editar compra:",ae)}},rt=p.useMemo(()=>{const ae=new Map;return r.forEach($e=>{$e.fornecedor?.id&&ae.set($e.fornecedor.id,$e.fornecedor)}),Array.from(ae.values())},[r]),mt=p.useMemo(()=>r.filter(ae=>{if(s){const $e=s.toLowerCase();if(!(ae.numero_nfe?.toLowerCase().includes($e)||ae.fornecedor?.nome?.toLowerCase().includes($e)||ae.chave_nfe?.toLowerCase().includes($e)))return!1}return!0}),[r,s]),tr=p.useMemo(()=>{const ae=mt.reduce((Ne,Ue)=>Ne+Number(Ue.valor_total||0),0),$e=mt.length,Ae=$e>0?ae/$e:0,Tt={};mt.forEach(Ne=>{const Ue=Ne.fornecedor?.id||"unknown",Qe=Ne.fornecedor?.nome||"No identificado";Tt[Ue]||(Tt[Ue]={name:Qe,total:0,count:0}),Tt[Ue].total+=Number(Ne.valor_total||0),Tt[Ue].count+=1});const Se=Object.values(Tt).sort((Ne,Ue)=>Ue.total-Ne.total).slice(0,5);return{total:ae,count:$e,avgTicket:Ae,topSuppliers:Se}},[mt]),Ce=p.useMemo(()=>{if(!me)return 1;const ae=Math.ceil((pe||0)/me);return ae>0?ae:1},[pe,me]),je=()=>{const ae=["NF-e","Serie","Data Emissao","Fornecedor","CNPJ","Tipo","Valor Total","Valor Produtos","Forma Pagamento"],$e=mt.map(Ne=>[Ne.numero_nfe||"",Ne.serie_nfe||"",Ne.data_emissao?Jt(new Date(Ne.data_emissao),"dd/MM/yyyy"):"",(Ne.fornecedor?.nome||"").replace(/,/g," "),Ne.fornecedor?.cnpj||"",Ne.tipo_operacao||"",Number(Ne.valor_total||0).toFixed(2),Number(Ne.valor_produtos||0).toFixed(2),(Ne.forma_pagamento||"").replace(/,/g," ")]),Ae=[ae,...$e].map(Ne=>Ne.join(";")).join(`
`),Tt=new Blob(["\uFEFF"+Ae],{type:"text/csv;charset=utf-8;"}),Se=document.createElement("a");Se.href=URL.createObjectURL(Tt),Se.download=`compras_${Jt(new Date,"yyyy-MM-dd")}.csv`,Se.click()};return o.jsxs("div",{className:"px-3 py-4 md:p-6 max-w-7xl mx-auto",children:[o.jsx("div",{className:"mb-4",children:o.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-3 md:gap-4 mb-2",children:[o.jsxs("div",{className:"flex items-center justify-between gap-3",children:[o.jsx("h1",{className:"text-3xl font-bold text-text-primary",children:"Compras (NF-e)"}),o.jsx(oe,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full flex items-center justify-center",onClick:()=>ne(!0),"aria-label":"Configuraes da aba",title:"Configuraes da aba",children:o.jsx(zm,{className:"h-4 w-4"})})]}),o.jsxs("div",{className:"flex flex-row flex-wrap items-end gap-2",children:[o.jsxs("div",{className:"flex-1 min-w-[140px]",children:[o.jsx("label",{className:"text-xs font-medium text-text-muted block mb-1",children:"Perodo Inicial"}),o.jsxs(xc,{modal:!0,children:[o.jsx(yc,{asChild:!0,children:o.jsxs(oe,{variant:"outline",className:"w-full justify-start text-left font-normal h-9 text-sm",children:[o.jsx(Ei,{className:"mr-2 h-4 w-4"}),v?Jt(v,"dd/MM/yyyy"):o.jsx("span",{children:"Selecionar"})]})}),o.jsx(Rl,{className:"w-auto p-0 z-50",align:"end",children:o.jsx(bc,{mode:"single",selected:v,onSelect:g,locale:ia})})]})]}),o.jsxs("div",{className:"flex-1 min-w-[140px]",children:[o.jsx("label",{className:"text-xs font-medium text-text-muted block mb-1",children:"Perodo Final"}),o.jsxs(xc,{modal:!0,children:[o.jsx(yc,{asChild:!0,children:o.jsxs(oe,{variant:"outline",className:"w-full justify-start text-left font-normal h-9 text-sm",children:[o.jsx(Ei,{className:"mr-2 h-4 w-4"}),y?Jt(y,"dd/MM/yyyy"):o.jsx("span",{children:"Selecionar"})]})}),o.jsx(Rl,{className:"w-auto p-0 z-50",align:"end",children:o.jsx(bc,{mode:"single",selected:y,onSelect:x,locale:ia})})]})]}),(v||y)&&o.jsx(oe,{variant:"ghost",size:"sm",onClick:()=>{g(null),x(null)},className:"h-8 px-3 text-xs",children:"Limpar"})]})]})}),j&&mt.length>0&&o.jsxs("div",{className:"mb-4 space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[o.jsxs("div",{className:"bg-surface rounded-lg border border-border px-2 py-3 flex flex-col items-center justify-center text-center",children:[o.jsxs("div",{className:"flex items-center gap-1 text-text-muted text-[11px] mb-1",children:[o.jsx(ns,{className:"h-3.5 w-3.5"}),o.jsx("span",{children:"NF-es"})]}),o.jsx("p",{className:"text-lg md:text-2xl font-bold text-text-primary leading-none",children:tr.count})]}),o.jsxs("div",{className:"bg-surface rounded-lg border border-border px-2 py-3 flex flex-col items-center justify-center text-center",children:[o.jsxs("div",{className:"flex items-center gap-1 text-text-muted text-[11px] mb-1",children:[o.jsx(Ui,{className:"h-3.5 w-3.5"}),o.jsx("span",{children:"Total"})]}),o.jsxs("p",{className:"text-base md:text-2xl font-bold text-success leading-none whitespace-nowrap",children:["R$ ",tr.total.toFixed(2)]})]}),o.jsxs("div",{className:"bg-surface rounded-lg border border-border px-2 py-3 flex flex-col items-center justify-center text-center",children:[o.jsxs("div",{className:"flex items-center gap-1 text-text-muted text-[11px] mb-1",children:[o.jsx(ju,{className:"h-3.5 w-3.5"}),o.jsx("span",{children:"Fornec."})]}),o.jsx("p",{className:"text-lg md:text-2xl font-bold text-info leading-none",children:rt.length})]})]}),tr.topSuppliers.length>0&&o.jsxs("div",{className:"bg-surface rounded-lg border border-border p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("h3",{className:"font-semibold text-text-primary flex items-center gap-2",children:[o.jsx(mP,{className:"h-4 w-4"}),"Top 5 Fornecedores"]}),o.jsx(oe,{variant:"ghost",size:"sm",onClick:()=>E(!0),className:"text-xs",children:"Ver Todos"})]}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:tr.topSuppliers.map((ae,$e)=>{const Ae=ae.total/tr.total*100;return o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"flex items-center justify-between text-xs",children:[o.jsx("span",{className:"text-text-primary font-medium truncate flex-1",title:ae.name,children:ae.name}),o.jsxs("span",{className:"text-text-muted text-xs ml-2 flex-shrink-0",children:["R$ ",ae.total.toFixed(2)]})]}),o.jsx("div",{className:"w-full bg-surface-2 rounded-full h-1.5",children:o.jsx("div",{className:"bg-brand rounded-full h-1.5 transition-all",style:{width:`${Ae}%`}})})]},$e)})})]})]}),o.jsx("div",{className:"mb-6 space-y-4",children:o.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3 md:gap-4 md:flex-wrap",children:[o.jsxs("div",{className:"flex items-center gap-2 w-full md:flex-1 md:min-w-[250px]",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(pi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(or,{placeholder:"Buscar por NF-e, fornecedor ou chave...",value:s,onChange:ae=>l(ae.target.value),className:"pl-10"})]}),o.jsx(oe,{type:"button",variant:"outline",size:"icon",className:"h-9 w-9 rounded-full flex md:hidden items-center justify-center",onClick:()=>L(ae=>!ae),"aria-label":"Filtros",children:o.jsx(Ck,{className:"h-4 w-4"})})]}),q&&o.jsxs("div",{className:"md:hidden mt-1 space-y-3 px-0.5",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-text-muted",children:"Fornecedor"}),o.jsxs(En,{value:b,onValueChange:w,children:[o.jsxs(Sn,{className:"w-full text-sm",children:[o.jsx(ju,{className:"h-4 w-4 mr-2 flex-shrink-0"}),o.jsx("div",{className:"truncate",children:o.jsx(kn,{placeholder:"Todos"})})]}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"all",children:"Todos"}),rt.map(ae=>o.jsx(wt,{value:ae.id,children:o.jsx("div",{className:"truncate max-w-[220px]",title:ae.nome,children:ae.nome})},ae.id))]})]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-text-muted",children:"Status"}),o.jsxs(En,{value:P,onValueChange:k,children:[o.jsx(Sn,{className:"w-full text-sm",children:o.jsx(kn,{})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"active",children:"Apenas ativas"}),o.jsx(wt,{value:"all",children:"Todas"}),o.jsx(wt,{value:"inactive",children:"Apenas inativas"})]})]})]}),o.jsxs("div",{className:"flex items-center justify-between gap-2 pt-1 border-t border-border/60",children:[o.jsxs(oe,{type:"button",variant:"ghost",size:"sm",className:"gap-2 text-xs px-2",onClick:()=>_(!j),children:[o.jsx(mP,{className:"h-4 w-4"}),j?"Ocultar estatsticas":"Mostrar estatsticas"]}),o.jsxs(oe,{type:"button",variant:"outline",size:"sm",onClick:je,disabled:mt.length===0,className:"gap-1 text-xs px-3",children:[o.jsx(ri,{className:"h-4 w-4"}),"CSV"]})]})]}),o.jsxs("div",{className:"hidden md:flex md:items-center md:gap-4 md:flex-wrap w-full",children:[o.jsxs(En,{value:b,onValueChange:w,children:[o.jsxs(Sn,{className:"w-full md:w-[220px]",children:[o.jsx(ju,{className:"h-4 w-4 mr-2 flex-shrink-0"}),o.jsx("div",{className:"truncate",children:o.jsx(kn,{placeholder:"Fornecedor"})})]}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"all",children:"Todos"}),rt.map(ae=>o.jsx(wt,{value:ae.id,children:o.jsx("div",{className:"truncate max-w-[180px]",title:ae.nome,children:ae.nome})},ae.id))]})]}),o.jsxs(oe,{variant:"outline",onClick:je,disabled:mt.length===0,className:"gap-2 w-full sm:w-auto justify-center",children:[o.jsx(ri,{className:"h-4 w-4"}),"Exportar CSV"]}),o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[o.jsxs(oe,{variant:"ghost",size:"sm",onClick:()=>_(!j),className:"gap-2",children:[o.jsx(mP,{className:"h-4 w-4"}),j?"Ocultar":"Mostrar"]}),o.jsxs(En,{value:P,onValueChange:k,children:[o.jsx(Sn,{className:"w-[140px]",children:o.jsx(kn,{})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"active",children:"Apenas ativas"}),o.jsx(wt,{value:"all",children:"Todas"}),o.jsx(wt,{value:"inactive",children:"Apenas inativas"})]})]})]})]})]})}),a?o.jsxs("div",{className:"text-center py-12 bg-surface rounded-lg border border-border",children:[o.jsx(ud,{className:"h-12 w-12 mx-auto text-text-muted mb-4"}),o.jsx("p",{className:"text-text-muted",children:s?"Nenhuma compra encontrada":"Nenhuma NF-e importada ainda"}),o.jsx("p",{className:"text-sm text-text-muted mt-2",children:"Importe XMLs de NF-e na pgina de Produtos"})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"grid gap-3",children:mt.map(ae=>o.jsx("div",{className:`rounded-lg border overflow-hidden transition-all hover:shadow-lg ${ae.ativo===!1?"bg-gray-900/60 border-red-500 shadow-red-500/20":"bg-surface border-border hover:border-brand/50"}`,onClick:()=>ft(ae),children:o.jsx("div",{className:"p-4",children:o.jsx("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 sm:gap-4",children:o.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[o.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[o.jsx(ns,{className:"h-6 w-6 text-brand mt-0.5 flex-shrink-0"}),o.jsx("div",{className:"min-w-0",children:o.jsxs("h3",{className:`font-semibold text-sm md:text-base leading-snug ${ae.ativo===!1?"text-red-600":"text-text-primary"}`,children:["NF-e ",ae.numero_nfe," / Srie ",ae.serie_nfe,ae.ativo===!1&&o.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 bg-red-100 text-red-700 text-[10px] rounded-full font-medium align-middle",children:"INATIVA"})]})})]}),o.jsx("div",{className:"sm:hidden flex items-center",children:o.jsxs("span",{className:"text-success font-semibold text-xs whitespace-nowrap pr-2",children:["R$ ",Number(ae.valor_total||0).toFixed(2)]})})]}),o.jsxs("div",{className:"space-y-2.5",children:[o.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[o.jsx(ju,{className:"h-5 w-5 flex-shrink-0 text-brand"}),o.jsx("span",{className:"font-medium text-text-primary text-sm md:text-base overflow-hidden truncate",title:ae.fornecedor?.nome||"Fornecedor no identificado",children:ae.fornecedor?.nome||"Fornecedor no identificado"})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1.5 text-xs md:text-sm text-text-muted",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Ei,{className:"h-4 w-4"}),o.jsx("span",{children:ae.data_emissao?Jt(new Date(ae.data_emissao),"dd/MM/yyyy",{locale:ia}):"Data no informada"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(ud,{className:"h-4 w-4"}),o.jsx("span",{children:ae.tipo_operacao||"Entrada"})]}),ae.chave_nfe&&o.jsxs("div",{className:"text-[10px] md:text-xs max-w-[180px] md:max-w-xs overflow-hidden whitespace-nowrap truncate",children:[o.jsx("span",{className:"font-medium",children:"Chave:"})," ",ae.chave_nfe.length>20?ae.chave_nfe.slice(0,20)+"...":ae.chave_nfe]})]}),ae.natureza_operacao&&o.jsx("p",{className:"text-[10px] md:text-xs text-text-muted overflow-hidden whitespace-nowrap truncate",title:ae.natureza_operacao,children:ae.natureza_operacao})]})]}),o.jsxs("div",{className:"hidden sm:flex sm:flex-col sm:gap-3 sm:mt-0 sm:w-auto",children:[o.jsx("div",{className:"w-full flex justify-end",children:o.jsxs("div",{className:"text-right text-text-muted",children:[o.jsxs("span",{className:"text-success font-semibold text-base md:text-lg whitespace-nowrap",children:["R$ ",Number(ae.valor_total||0).toFixed(2)]}),o.jsxs("p",{className:"text-[11px] md:text-xs mt-0.5",children:["Produtos: R$ ",Number(ae.valor_produtos||0).toFixed(2)]})]})}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 w-full justify-end",children:[o.jsxs(oe,{onClick:$e=>{$e.stopPropagation(),ft(ae)},size:"sm",className:"gap-2 w-full justify-center",children:[o.jsx(zp,{className:"h-4 w-4"}),o.jsx("span",{className:"text-xs sm:text-sm",children:"Detalhes"})]}),ae.ativo&&o.jsxs(oe,{onClick:$e=>{$e.stopPropagation(),Nr(ae)},size:"sm",variant:"outline",className:"gap-2 w-full justify-center",children:[o.jsx(El,{className:"h-4 w-4"}),o.jsx("span",{className:"text-xs sm:text-sm",children:"Editar"})]})]})]})]})})})},ae.id))}),Q&&o.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between mt-4 gap-2 text-xs sm:text-sm text-text-muted",children:[o.jsxs("span",{children:["Pgina ",re," de ",Ce," (",pe," NF-es)"]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(oe,{type:"button",variant:"outline",size:"sm",onClick:()=>G(ae=>Math.max(1,ae-1)),disabled:re<=1,children:"Anterior"}),o.jsx(oe,{type:"button",variant:"outline",size:"sm",onClick:()=>G(ae=>Math.min(Ce,ae+1)),disabled:re>=Ce,children:"Prxima"})]})]})]}),o.jsx(ln,{open:W,onOpenChange:ne,children:o.jsxs(on,{className:"w-[90vw] sm:max-w-md max-h-[80vh] flex flex-col",children:[o.jsx(nn,{children:o.jsx(rn,{children:"Configuraes de Compras"})}),o.jsxs("div",{className:"space-y-4 text-sm",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{className:"text-xs font-medium text-text-muted",children:"Modo de listagem"}),o.jsxs(En,{value:le,onValueChange:K,children:[o.jsx(Sn,{className:"w-full h-9 text-sm",children:o.jsx(kn,{placeholder:"Paginado"})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"paged",children:"Paginado (100 por pgina)"}),o.jsx(wt,{value:"all",children:"Todos (sem paginao)"})]})]})]}),o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Bo,{id:"compras-show-stats",checked:j,onCheckedChange:_}),o.jsx("label",{htmlFor:"compras-show-stats",className:"text-xs font-medium text-text-primary",children:"Mostrar cards de estatsticas"})]})})]})]})}),o.jsx(ln,{open:M.show,onOpenChange:ae=>S({show:ae,purchase:null}),children:o.jsxs(on,{className:"w-[90vw] sm:max-w-md",children:[o.jsx(nn,{children:o.jsx(rn,{children:"Inativar NF-e"})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("p",{className:"text-sm text-text-muted",children:["Tem certeza que deseja inativar a NF-e ",o.jsx("strong",{children:M.purchase?.numero_nfe}),"?"]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-2",children:"Motivo da inativao:"}),o.jsx(or,{value:I,onChange:ae=>T(ae.target.value),placeholder:"Ex: NF-e duplicada, erro na importao...",className:"w-full"})]}),o.jsxs("div",{className:"flex justify-end gap-2",children:[o.jsx(oe,{variant:"outline",onClick:()=>{S({show:!1,purchase:null}),T("")},children:"Cancelar"}),o.jsx(oe,{variant:"destructive",onClick:async()=>{if(!I.trim()){alert("Por favor, informe o motivo da inativao");return}try{await yat(M.purchase.id,I.trim(),t.id),S({show:!1,purchase:null}),T(""),st()}catch(ae){console.error("Erro ao inativar compra:",ae),alert("Erro ao inativar NF-e. Tente novamente.")}},disabled:!I.trim(),children:"Inativar"})]})]})]})}),c&&o.jsx(Iat,{purchase:c,items:m?[]:u,onClose:yt,onEdit:Nr,onReprocess:kt,onDownloadXML:ee,onInactivate:ae=>S({show:!0,purchase:ae})}),o.jsx(ln,{open:C,onOpenChange:E,children:o.jsxs(on,{className:"w-[90vw] sm:max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[o.jsx(nn,{children:o.jsx(rn,{children:"Todos os Fornecedores"})}),o.jsx("div",{className:"px-6 py-3 bg-surface-2 border-y border-border",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-muted",children:"Valor Total Geral"}),o.jsxs("span",{className:"text-2xl font-bold text-success",children:["R$ ",tr.total.toFixed(2)]})]})}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:o.jsx("div",{className:"space-y-3 pr-2",children:Object.entries(mt.reduce((ae,$e)=>{const Ae=$e.fornecedor?.id||"unknown",Tt=$e.fornecedor?.nome||"No identificado";return ae[Ae]||(ae[Ae]={name:Tt,total:0,count:0}),ae[Ae].total+=Number($e.valor_total||0),ae[Ae].count+=1,ae},{})).sort(([,ae],[,$e])=>$e.total-ae.total).map(([ae,$e],Ae)=>{const Tt=$e.total/tr.total*100;return o.jsxs("div",{className:"p-3 bg-surface-2 rounded-lg border border-border",children:[o.jsxs("div",{className:"flex items-start justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-brand/10 text-brand text-xs font-bold flex items-center justify-center",children:Ae+1}),o.jsx("span",{className:"font-medium text-text-primary",children:$e.name})]}),o.jsxs("div",{className:"text-right",children:[o.jsxs("p",{className:"font-bold text-success",children:["R$ ",$e.total.toFixed(2)]}),o.jsxs("p",{className:"text-xs text-text-muted",children:[$e.count," NF-es"]})]})]}),o.jsx("div",{className:"w-full bg-surface rounded-full h-2",children:o.jsx("div",{className:"bg-brand rounded-full h-2 transition-all",style:{width:`${Tt}%`}})})]},ae)})})})]})}),o.jsx(ln,{open:D.show,onOpenChange:ae=>B({show:ae,purchase:null}),children:o.jsxs(on,{className:"w-[90vw] sm:max-w-2xl max-h-[80vh] flex flex-col",onOpenAutoFocus:ae=>ae.preventDefault(),children:[o.jsx(nn,{children:o.jsx(rn,{children:"Editar NF-e"})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium",children:"Nmero NF-e"}),o.jsx(or,{value:U.numeroNfe||"",onChange:ae=>z($e=>({...$e,numeroNfe:ae.target.value})),placeholder:"Nmero da NF-e"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium",children:"Srie"}),o.jsx(or,{value:U.serieNfe||"",onChange:ae=>z($e=>({...$e,serieNfe:ae.target.value})),placeholder:"Srie"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium",children:"Data de Emisso"}),o.jsx(or,{type:"date",value:U.dataEmissao||"",onChange:ae=>z($e=>({...$e,dataEmissao:ae.target.value}))})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium",children:"Tipo de Operao"}),o.jsxs(En,{value:U.tipoOperacao||"",onValueChange:ae=>z($e=>({...$e,tipoOperacao:ae})),children:[o.jsx(Sn,{children:o.jsx(kn,{placeholder:"Selecione o tipo"})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"Entrada",children:"0 - Entrada"}),o.jsx(wt,{value:"Sada",children:"1 - Sada"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium",children:"Natureza da Operao"}),o.jsxs(En,{value:U.naturezaOperacao||"",onValueChange:ae=>z($e=>({...$e,naturezaOperacao:ae})),children:[o.jsx(Sn,{children:o.jsx(kn,{placeholder:"Selecione a natureza"})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"Compra para comercializao",children:"Compra para comercializao"}),o.jsx(wt,{value:"Compra para industrializao",children:"Compra para industrializao"}),o.jsx(wt,{value:"Compra para uso ou consumo",children:"Compra para uso ou consumo"}),o.jsx(wt,{value:"Compra de ativo imobilizado",children:"Compra de ativo imobilizado"}),o.jsx(wt,{value:"Compra de material para uso ou consumo",children:"Compra de material para uso ou consumo"}),o.jsx(wt,{value:"Devoluo de venda de produo do estabelecimento",children:"Devoluo de venda de produo do estabelecimento"}),o.jsx(wt,{value:"Devoluo de venda de mercadoria adquirida ou recebida de terceiros",children:"Devoluo de venda de mercadoria adquirida ou recebida de terceiros"}),o.jsx(wt,{value:"Remessa de mercadoria por conta e ordem de terceiros",children:"Remessa de mercadoria por conta e ordem de terceiros"}),o.jsx(wt,{value:"Retorno de mercadoria remetida por conta e ordem de terceiros",children:"Retorno de mercadoria remetida por conta e ordem de terceiros"}),o.jsx(wt,{value:"Remessa para industrializao por encomenda",children:"Remessa para industrializao por encomenda"}),o.jsx(wt,{value:"Retorno de mercadoria remetida para industrializao por encomenda",children:"Retorno de mercadoria remetida para industrializao por encomenda"}),o.jsx(wt,{value:"Transferncia de produo do estabelecimento",children:"Transferncia de produo do estabelecimento"}),o.jsx(wt,{value:"Transferncia de mercadoria adquirida ou recebida de terceiros",children:"Transferncia de mercadoria adquirida ou recebida de terceiros"})]})]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium",children:"Valor dos Produtos"}),o.jsx(or,{inputMode:"numeric",placeholder:"R$ 0,00",value:`R$ ${U.valorProdutos||"0,00"}`,onChange:ae=>z($e=>({...$e,valorProdutos:Z(ae.target.value)}))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium",children:"Valor Total"}),o.jsx(or,{inputMode:"numeric",placeholder:"R$ 0,00",value:`R$ ${U.valorTotal||"0,00"}`,onChange:ae=>z($e=>({...$e,valorTotal:Z(ae.target.value)}))})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium",children:"Forma de Pagamento"}),o.jsxs(En,{value:U.formaPagamento||"",onValueChange:ae=>z($e=>({...$e,formaPagamento:ae})),children:[o.jsx(Sn,{children:o.jsx(kn,{placeholder:"Selecione a forma de pagamento"})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"01 - Dinheiro",children:"01 - Dinheiro"}),o.jsx(wt,{value:"02 - Cheque",children:"02 - Cheque"}),o.jsx(wt,{value:"03 - Carto de Crdito",children:"03 - Carto de Crdito"}),o.jsx(wt,{value:"04 - Carto de Dbito",children:"04 - Carto de Dbito"}),o.jsx(wt,{value:"05 - Carto da Loja (Private Label)",children:"05 - Carto da Loja (Private Label)"}),o.jsx(wt,{value:"10 - Vale Alimentao",children:"10 - Vale Alimentao"}),o.jsx(wt,{value:"11 - Vale Refeio",children:"11 - Vale Refeio"}),o.jsx(wt,{value:"12 - Vale Presente",children:"12 - Vale Presente"}),o.jsx(wt,{value:"13 - Vale Combustvel",children:"13 - Vale Combustvel"}),o.jsx(wt,{value:"14 - Duplicata Mercantil",children:"14 - Duplicata Mercantil"}),o.jsx(wt,{value:"15 - Boleto Bancrio",children:"15 - Boleto Bancrio"}),o.jsx(wt,{value:"16 - Depsito Bancrio",children:"16 - Depsito Bancrio"}),o.jsx(wt,{value:"17 - PIX Dinmico (QR-Code)",children:"17 - PIX Dinmico (QR-Code)"}),o.jsx(wt,{value:"18 - Transferncia Bancria / Carteira Digital",children:"18 - Transferncia Bancria / Carteira Digital"}),o.jsx(wt,{value:"19 - Programa de Fidelidade / Cashback",children:"19 - Programa de Fidelidade / Cashback"}),o.jsx(wt,{value:"20 - PIX Esttico",children:"20 - PIX Esttico"}),o.jsx(wt,{value:"21 - Crdito em Loja",children:"21 - Crdito em Loja"}),o.jsx(wt,{value:"22 - Pagamento Eletrnico no Informado",children:"22 - Pagamento Eletrnico no Informado"}),o.jsx(wt,{value:"90 - Sem Pagamento",children:"90 - Sem Pagamento"}),o.jsx(wt,{value:"99 - Outros",children:"99 - Outros"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium",children:"Observaes"}),o.jsx(or,{value:U.observacoes||"",onChange:ae=>z($e=>({...$e,observacoes:ae.target.value})),placeholder:"Observaes adicionais"})]}),o.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[o.jsx(oe,{variant:"outline",onClick:()=>B({show:!1,purchase:null}),children:"Cancelar"}),o.jsx(oe,{onClick:se,children:"Salvar Alteraes"})]})]})]})}),o.jsx(Tat,{open:$.show,onOpenChange:ae=>Y({show:ae,purchase:null}),purchase:$.purchase,products:de,codigoEmpresa:t?.codigo_empresa,autoFile:$.autoFile,onSuccess:()=>{st(),Y({show:!1,purchase:null})}})]})}const rl=ye.forwardRef(({className:e,...t},r)=>o.jsx("div",{className:"relative w-full overflow-auto",children:o.jsx("table",{ref:r,className:Yt("w-full caption-bottom text-sm",e),...t})}));rl.displayName="Table";const nl=ye.forwardRef(({className:e,...t},r)=>o.jsx("thead",{ref:r,className:Yt("[&_tr]:border-b",e),...t}));nl.displayName="TableHeader";const al=ye.forwardRef(({className:e,...t},r)=>o.jsx("tbody",{ref:r,className:Yt("[&_tr:last-child]:border-0",e),...t}));al.displayName="TableBody";const Mat=ye.forwardRef(({className:e,...t},r)=>o.jsx("tfoot",{ref:r,className:Yt("bg-primary font-medium text-primary-foreground",e),...t}));Mat.displayName="TableFooter";const Ba=ye.forwardRef(({className:e,...t},r)=>o.jsx("tr",{ref:r,className:Yt("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));Ba.displayName="TableRow";const vn=ye.forwardRef(({className:e,...t},r)=>o.jsx("th",{ref:r,className:Yt("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));vn.displayName="TableHead";const en=ye.forwardRef(({className:e,...t},r)=>o.jsx("td",{ref:r,className:Yt("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));en.displayName="TableCell";const Rat=ye.forwardRef(({className:e,...t},r)=>o.jsx("caption",{ref:r,className:Yt("mt-4 text-sm text-muted-foreground",e),...t}));Rat.displayName="TableCaption";const Lat={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},Kae={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},K2=({icon:e,title:t,value:r,color:n,onClick:a,isActive:i})=>{const s=e;return o.jsxs(fr.div,{variants:Kae,className:Yt("bg-surface rounded-lg border p-4 flex items-center gap-4 cursor-pointer transition-all duration-200",i?"border-brand ring-2 ring-brand/50":"border-border hover:border-brand/50"),onClick:a,children:[o.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${n}/20`,children:o.jsx(s,{className:`w-6 h-6 ${n}`})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-text-secondary text-sm font-medium",children:t}),o.jsx("p",{className:"text-2xl font-bold text-text-primary",children:r})]})]})};function $at({open:e,onOpenChange:t,client:r,onEdit:n,onInactivate:a,codigoEmpresa:i}){const{toast:s}=oo(),l={scheduled:{bg:"bg-[#3B82F6]/10",text:"text-[#3B82F6]",border:"border-[#3B82F6]/30"},confirmed:{bg:"bg-[#22C55E]/10",text:"text-[#22C55E]",border:"border-[#22C55E]/30"},in_progress:{bg:"bg-[#FACC15]/10",text:"text-[#FACC15]",border:"border-[#FACC15]/30"},finished:{bg:"bg-[#6B7280]/10",text:"text-[#6B7280]",border:"border-[#6B7280]/30"},canceled:{bg:"bg-[#EF4444]/10",text:"text-[#EF4444]",border:"border-[#EF4444]/30"},absent:{bg:"bg-[#F97316]/10",text:"text-[#F97316]",border:"border-[#F97316]/30"}},c=({label:T,value:D})=>o.jsxs("div",{className:"grid grid-cols-12 items-start gap-3 py-2 border-b border-border/50",children:[o.jsx("div",{className:"col-span-5 sm:col-span-4",children:o.jsx("span",{className:"block text-[11px] uppercase tracking-wide text-text-muted font-semibold",children:T})}),o.jsx("div",{className:"col-span-7 sm:col-span-8",children:o.jsx("span",{className:"block text-sm font-medium text-text-primary break-words",children:D})})]}),[d,u]=p.useState(!1),[f,m]=p.useState([]),[h,v]=p.useState(!1),[g,y]=p.useState([]),x=p.useRef(!1),b=p.useRef(!1),[w,j]=p.useState(!1),[_,C]=p.useState(null),[E,P]=p.useState(!1),[k,M]=p.useState(null),S=p.useMemo(()=>{try{const T=(f||[]).map(B=>({kind:"comanda",ts:new Date(B.aberto_em||B.created_at||0).getTime(),data:B})),D=(g||[]).map(B=>({kind:"agendamento",ts:new Date(B.inicio||0).getTime(),data:B}));return[...T,...D].sort((B,U)=>U.ts-B.ts).slice(0,10)}catch{return[]}},[f,g]),I=async T=>{try{if(j(!0),C(T?.kind||null),P(!0),M(null),T?.kind==="comanda"){const D=T?.data?.comanda_id;if(!D){P(!1);return}let B=ve.from("comanda_itens").select("id, quantidade, preco_unitario, desconto, produto:produtos!comanda_itens_produto_id_fkey ( nome )").eq("comanda_id",D);i&&(B=B.eq("codigo_empresa",i));const{data:U}=await B,z=(U||[]).map(K=>({id:K.id,quantidade:K.quantidade,preco_unitario:K.preco_unitario,desconto:K.desconto,produto_nome:K.produto?.[0]?.nome||K.produto?.nome||"Item"}));let $=ve.from("pagamentos").select("id, valor, status, recebido_em, metodo").eq("comanda_id",D);i&&($=$.eq("codigo_empresa",i));const{data:Y}=await $,de=Y||[];let xe=ve.from("comanda_clientes").select("cliente:clientes!comanda_clientes_cliente_id_fkey ( id, nome, email, telefone )").eq("comanda_id",D);i&&(xe=xe.eq("codigo_empresa",i));const{data:q}=await xe,L=(q||[]).map(K=>K.cliente?.[0]||K.cliente).filter(Boolean),W=(z||[]).reduce((K,Q)=>K+(Number(Q.quantidade||0)*Number(Q.preco_unitario||0)-Number(Q.desconto||0)),0),ne=(de||[]).filter(K=>(K.status||"Pago")!=="Cancelado"&&(K.status||"Pago")!=="Estornado").reduce((K,Q)=>K+Number(Q.valor||0),0),le=Math.max(0,W-ne);M({comandaId:D,mesa_title:T?.data?.mesa_title||"Balco",status:T?.data?.status||"open",itens:z||[],pagamentos:de||[],clientes:L,totalItens:W,totalPagos:ne,saldo:le,aberto_em:T?.data?.aberto_em||T?.data?.created_at||null,fechado_em:T?.data?.fechado_em||null})}else if(T?.kind==="agendamento"){const D=T?.data?.id;if(!D){P(!1);return}let B=[];try{const{data:$}=await ve.from("agendamento_participantes").select("cliente_id, nome, valor_cota, status_pagamento").eq("agendamento_id",D).limit(200);B=$||[]}catch{B=[]}const U=Array.from(new Set((B||[]).map($=>$.cliente_id).filter(Boolean)));let z=[];if(z=(B||[]).map($=>({id:$.cliente_id,nome:$.nome||null,email:null,telefone:null,codigo:null,valor_cota:$.valor_cota??null,status_pagamento:$.status_pagamento||null})),U.length>0)try{const{data:$}=await ve.from("clientes").select("id,nome,email,telefone,codigo").in("id",U),Y=new Map(($||[]).map(de=>[String(de.id),de]));z=z.map(de=>{const xe=Y.get(String(de.id));return xe?{...de,nome:de.nome||xe.nome,email:xe.email,telefone:xe.telefone,codigo:xe.codigo}:de})}catch{}M({id:D,inicio:T?.data?.inicio||null,fim:T?.data?.fim||null,status:T?.data?.status||null,modalidade:T?.data?.modalidade||null,quadra_nome:T?.data?.quadra_nome||null,participantes:z})}}catch{}finally{P(!1)}};return p.useEffect(()=>{let T=!1;if(e&&(x.current=!1,b.current=!1),e&&r?.id&&!i)return u(!1),v(!1),()=>{T=!0};const D=async()=>{if(!e||!r?.id)return;u(!0);const U=Number(r?.codigo??-1)===0;let z=ve.from("comanda_clientes").select("comanda_id, created_at");U?z=z.is("cliente_id",null):z=z.eq("cliente_id",r.id),z=z.order("created_at",{ascending:!1}).limit(50),i&&(z=z.eq("codigo_empresa",i));const{data:$,error:Y}=await z;if(Y)throw Y;const de=Array.from(new Set(($||[]).map(ne=>ne.comanda_id).filter(Boolean)));let xe=[];if(!U){let ne=ve.from("comandas").select("id, status, aberto_em, fechado_em").eq("cliente_id",r.id).order("aberto_em",{ascending:!1}).limit(10);i&&(ne=ne.eq("codigo_empresa",i));const{data:le,error:K}=await ne;if(K)throw K;xe=le||[]}const q=Array.from(new Set((xe||[]).map(ne=>ne.id))),L=Array.from(new Set([...de,...q]));if(L.length===0){m([]),u(!1);return}let W;try{W=setTimeout(()=>u(!1),1e4)}catch{}try{let ne=ve.from("comandas").select("id,status,aberto_em,fechado_em, mesa:mesas!comandas_mesa_id_fkey ( nome, numero )").in("id",L);i&&(ne=ne.eq("codigo_empresa",i));const{data:le,error:K}=await ne;if(K)throw K;const Q=new Map((le||[]).map(yt=>[yt.id,yt]));let re=ve.from("comanda_itens").select("comanda_id, quantidade, preco_unitario, desconto").in("comanda_id",L);i&&(re=re.eq("codigo_empresa",i));const{data:G,error:me}=await re;if(me)throw me;const pe={};for(const yt of G||[]){const Nr=Number(yt.quantidade||0)*Number(yt.preco_unitario||0),se=Number(yt.desconto||0);pe[yt.comanda_id]=(pe[yt.comanda_id]||0)+Math.max(0,Nr-se)}let Be=ve.from("pagamentos").select("comanda_id, valor, status, recebido_em, metodo").in("comanda_id",L);i&&(Be=Be.eq("codigo_empresa",i));const{data:Z,error:ee}=await Be;if(ee)throw ee;const kt={};for(const yt of Z||[])(yt.status||"Pago")!=="Cancelado"&&(yt.status||"Pago")!=="Estornado"&&(kt[yt.comanda_id]=(kt[yt.comanda_id]||0)+Number(yt.valor||0));const Nt=(yt,Nr=null)=>{const se=Q.get(yt)||{},rt=Number(pe[yt]||0),mt=Number(kt[yt]||0),tr=Math.max(0,rt-mt),Ce=se.mesa?.[0]?.nome||se.mesa?.nome||null,je=se.mesa?.[0]?.numero||se.mesa?.numero||null,ae=Ce||(je!=null?`Mesa ${je}`:"Balco");return{comanda_id:yt,created_at:Nr,aberto_em:se.aberto_em||null,fechado_em:se.fechado_em||null,status:se.status||"open",total:rt,pago:mt,saldo:tr,mesa_title:ae}},De=($||[]).map(yt=>Nt(yt.comanda_id,yt.created_at)),st=(xe||[]).filter(yt=>!(de||[]).includes(yt.id)).map(yt=>Nt(yt.id,yt.aberto_em)),ft=[...De,...st].sort((yt,Nr)=>{const se=new Date(yt.aberto_em||yt.created_at||0).getTime();return new Date(Nr.aberto_em||Nr.created_at||0).getTime()-se}).slice(0,10);if(!T&&ft.length===0&&!x.current){x.current=!0,console.debug("[ClientDetailsModal] loadHistory: empty result, retrying once..."),setTimeout(()=>{e&&r?.id&&D()},700);return}T||m(ft)}catch(ne){s({title:"Falha ao carregar histrico do cliente",description:ne?.message||"Tente novamente",variant:"destructive"})}finally{try{clearTimeout(W)}catch{}T||u(!1)}},B=async()=>{if(!e||!r?.id)return;v(!0);let U;try{U=setTimeout(()=>v(!1),1e4)}catch{}try{console.debug("[ClientDetailsModal] loadBookings: start",{clientId:r.id,codigoEmpresa:i});let z=ve.from("agendamentos").select(`
            id, inicio, fim, status, modalidade,
            quadra:quadra_id ( nome )
          `).eq("cliente_id",r.id).order("inicio",{ascending:!1}).limit(10);i&&(z=z.eq("codigo_empresa",i));const{data:$,error:Y}=await z;if(Y)throw Y;const de=($||[]).map(re=>({id:re.id,inicio:re.inicio,fim:re.fim,status:re.status,modalidade:re.modalidade,quadra_nome:re.quadra?.[0]?.nome||re.quadra?.nome||null}));let xe=ve.from("v_agendamento_participantes").select("agendamento_id").eq("cliente_id",r.id).limit(30);const{data:q,error:L}=await xe;if(L)throw L;const W=Array.from(new Set((q||[]).map(re=>re.agendamento_id).filter(Boolean))),ne=new Set((de||[]).map(re=>re.id)),le=W.filter(re=>!ne.has(re));let K=[];if(le.length>0){let re=ve.from("agendamentos").select(`
              id, inicio, fim, status, modalidade,
              quadra:quadra_id ( nome )
            `).in("id",le);i&&(re=re.eq("codigo_empresa",i));const{data:G,error:me}=await re;if(me)throw me;K=(G||[]).map(pe=>({id:pe.id,inicio:pe.inicio,fim:pe.fim,status:pe.status,modalidade:pe.modalidade,quadra_nome:pe.quadra?.[0]?.nome||pe.quadra?.nome||null}))}const Q=[...de,...K].sort((re,G)=>new Date(G.inicio)-new Date(re.inicio)).slice(0,10);if(!T&&Q.length===0&&!b.current){b.current=!0,console.debug("[ClientDetailsModal] loadBookings: empty result, retrying once..."),setTimeout(()=>{e&&r?.id&&B()},700);return}T||y(Q)}catch(z){console.warn("[ClientDetailsModal] Falha ao carregar agendamentos do cliente:",z)}finally{try{clearTimeout(U)}catch{}T||v(!1)}};return D(),B(),()=>{T=!0,e||(u(!1),v(!1))}},[e,r?.id,i]),r?o.jsx(ln,{open:e,onOpenChange:t,children:o.jsxs(on,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto w-full",children:[o.jsxs(nn,{children:[o.jsx(rn,{children:"Detalhes do Cliente"}),o.jsx(_n,{children:"Informaes cadastrais e histrico recente deste cliente."})]}),o.jsxs("div",{className:"p-4 sm:p-6 space-y-6 sm:space-y-8",children:[o.jsx("div",{className:"overflow-hidden",children:o.jsx("div",{className:"flex items-start justify-between gap-4",children:o.jsxs("div",{className:"min-w-0",children:[o.jsx("h2",{className:"text-xl sm:text-2xl font-extrabold tracking-tight text-text-primary truncate",children:r.nome}),o.jsxs("div",{className:"mt-2 flex items-center flex-wrap gap-2",children:[o.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-semibold bg-surface-2 border border-border text-text-secondary",children:["Cdigo: ",o.jsx("span",{className:"text-text-primary font-mono",children:r.codigo})]}),o.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold border ${r.status==="active"?"bg-emerald-500/10 text-emerald-400 border-emerald-400/30":"bg-rose-500/10 text-rose-400 border-rose-400/30"}`,children:r.status==="active"?"Ativo":"Inativo"}),r.flag_cliente&&o.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-blue-500/10 text-blue-500 border border-blue-500/30",children:"Cliente"}),r.flag_fornecedor&&o.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-purple-500/10 text-purple-500 border border-purple-500/30",children:"Fornecedor"})]}),o.jsx("span",{className:"mt-2 block text-sm text-text-secondary truncate",children:r.email||""})]})})}),o.jsx("div",{className:"grid grid-cols-1 gap-8",children:o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-text-secondary mb-2",children:"Informaes Cadastrais"}),o.jsxs("div",{className:"bg-surface-2 p-3 sm:p-4 rounded-lg space-y-1",children:[o.jsx(c,{label:"Cdigo",value:r.codigo}),o.jsx(c,{label:"CPF/CNPJ",value:r.cpf||r.cnpj||""}),o.jsx(c,{label:"Telefone",value:r.telefone||""}),o.jsx(c,{label:"Aniversrio",value:r.aniversario?new Date(r.aniversario).toLocaleDateString("pt-BR"):""}),o.jsx(c,{label:"Email",value:r.email||""}),o.jsx(c,{label:"Status",value:r.status==="active"?"Ativo":"Inativo"})]})]})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center gap-2 text-text-primary",children:[o.jsx(Hde,{className:"w-5 h-5 text-text-secondary"}),o.jsx("h4",{className:"font-semibold",children:"Histrico Recente"})]}),o.jsx("div",{className:"bg-surface-2 p-3 sm:p-4 rounded-lg",children:d&&h?o.jsx("div",{className:"text-center py-8 text-sm text-text-muted",children:"Carregando histrico..."}):S&&S.length>0?o.jsx("div",{className:"max-h-64 overflow-y-auto thin-scroll pr-1",children:o.jsx("div",{className:"space-y-3",children:S.map((T,D)=>o.jsxs("div",{className:"group flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-3 p-3 rounded-md border border-border/60 bg-background cursor-pointer transition-colors transition-shadow hover:bg-surface-2/60 hover:shadow-md hover:border-brand/30",title:"Clique para ver detalhes",onClick:()=>I(T),children:[o.jsx("div",{className:"min-w-0",children:T.kind==="comanda"?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"text-sm font-semibold text-text-primary truncate",children:T.data.mesa_title||"Balco"}),o.jsx("div",{className:"text-xs text-text-secondary truncate",children:(()=>{const B=T.data;return B.aberto_em?new Date(B.aberto_em).toLocaleString("pt-BR"):new Date(B.created_at).toLocaleString("pt-BR")})()})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"text-sm font-semibold text-text-primary truncate",children:T.data.modalidade||"Agendamento"}),o.jsxs("div",{className:"text-xs text-text-secondary truncate",children:[new Date(T.data.inicio).toLocaleString("pt-BR"),"  ",T.data.quadra_nome||"Quadra"]})]})}),o.jsx("div",{className:"flex items-center gap-2 sm:gap-3 w-full sm:w-auto justify-between sm:justify-end",children:T.kind==="comanda"?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:Yt("px-2 py-1 text-[11px] font-semibold rounded-full border",T.data.status==="closed"||T.data.fechado_em?"bg-success/10 text-success border-success/30":T.data.status==="awaiting-payment"?"bg-info/10 text-info border-info/30":"bg-warning/10 text-warning border-warning/30"),children:T.data.status==="closed"||T.data.fechado_em?"Fechada":T.data.status==="awaiting-payment"?"Pagamento":"Em uso"}),o.jsx("span",{className:"opacity-0 group-hover:opacity-100 transition-opacity text-[11px] text-text-secondary whitespace-nowrap",children:"Clique para detalhes"})]}):o.jsxs(o.Fragment,{children:[o.jsx("span",{className:Yt("px-2 py-1 text-[11px] font-semibold rounded-full border",(()=>{const B=String(T.data.status||"").toLowerCase(),U=l[B]||l.scheduled;return`${U.bg} ${U.text} ${U.border}`})()),children:(()=>{switch(T.data.status){case"finished":return"Finalizado";case"canceled":return"Cancelado";case"in_progress":return"Em andamento";case"confirmed":return"Confirmado";case"absent":return"Ausente";case"scheduled":default:return"Agendado"}})()}),o.jsx("span",{className:"opacity-0 group-hover:opacity-100 transition-opacity text-[11px] text-text-secondary whitespace-nowrap",children:"Clique para detalhes"})]})})]},`${T.kind}-${D}`))})}):o.jsx("div",{className:"text-center py-8 text-sm text-text-muted",children:"Sem registros recentes para este cliente."})})]}),o.jsx(ln,{open:w,onOpenChange:j,children:o.jsxs(on,{className:"sm:max-w-[700px] w-full max-h-[85vh] overflow-y-auto",children:[o.jsxs(nn,{children:[o.jsx(rn,{children:_==="comanda"?k?.mesa_title||"Detalhes da Comanda":"Detalhes do Agendamento"}),o.jsx(_n,{children:_==="comanda"?"Itens e pagamentos desta comanda.":"Informaes do agendamento e participantes."}),o.jsxs("div",{className:"mt-2 flex items-center gap-2 flex-wrap",children:[o.jsx("span",{className:"text-xs text-text-secondary",children:"Cliente:"}),o.jsx("span",{className:"text-sm font-medium text-text-primary",children:r?.nome||""}),o.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-semibold bg-surface-2 border border-border text-text-secondary",children:["Cdigo: ",o.jsx("span",{className:"text-text-primary font-mono",children:r?.codigo??""})]})]})]}),o.jsx("div",{className:"space-y-4",children:E?o.jsx("div",{className:"text-sm text-text-muted",children:"Carregando detalhes..."}):_==="comanda"&&k?o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3",children:[o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Status"}),o.jsx("p",{className:"font-semibold",children:(()=>{const T=String(k.status||"").toLowerCase();return T==="closed"||k.fechado_em?"Fechada":T==="awaiting-payment"?"Aguardando pagamento":"Aberta"})()})]}),o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Abertura"}),o.jsx("p",{className:"font-semibold",children:k.aberto_em?new Date(k.aberto_em).toLocaleString("pt-BR"):""})]}),o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Fechamento"}),o.jsx("p",{className:"font-semibold",children:k.fechado_em?new Date(k.fechado_em).toLocaleString("pt-BR"):""})]})]}),o.jsxs("div",{children:[o.jsx("h5",{className:"text-sm font-semibold mb-2",children:"Itens"}),o.jsxs("div",{className:"border rounded-md divide-y divide-border",children:[(k.itens||[]).map(T=>o.jsxs("div",{className:"p-2 flex flex-col sm:grid sm:grid-cols-12 gap-1 sm:gap-2 text-sm",children:[o.jsx("div",{className:"sm:col-span-6 font-medium",children:T.produto_nome||"Item"}),o.jsxs("div",{className:"sm:col-span-2 sm:text-right text-text-muted",children:["Qtd: ",Number(T.quantidade||0)]}),o.jsxs("div",{className:"sm:col-span-2 sm:text-right",children:["R$ ",Number(T.preco_unitario||0).toFixed(2)]}),o.jsx("div",{className:"sm:col-span-2 sm:text-right text-text-secondary",children:Number(T.desconto||0)?`- R$ ${Number(T.desconto||0).toFixed(2)}`:""})]},T.id)),(!k.itens||k.itens.length===0)&&o.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum item."})]})]}),o.jsxs("div",{children:[o.jsx("h5",{className:"text-sm font-semibold mb-2",children:"Pagamentos"}),o.jsxs("div",{className:"border rounded-md divide-y divide-border",children:[(k.pagamentos||[]).map(T=>o.jsxs("div",{className:"p-2 flex items-center justify-between text-sm",children:[o.jsxs("span",{className:"truncate",children:[T.metodo||""," ",T.status?`(${T.status})`:""]}),o.jsxs("span",{className:"font-semibold",children:["R$ ",Number(T.valor||0).toFixed(2)]})]},T.id)),(!k.pagamentos||k.pagamentos.length===0)&&o.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum pagamento registrado."})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3",children:[o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Total de Itens"}),o.jsxs("p",{className:"font-bold",children:["R$ ",Number(k.totalItens||0).toFixed(2)]})]}),o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Total Pago"}),o.jsxs("p",{className:"font-bold text-success",children:["R$ ",Number(k.totalPagos||0).toFixed(2)]})]})]})]}):_==="agendamento"&&k?o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3",children:[o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Modalidade"}),o.jsx("p",{className:"font-semibold",children:k.modalidade||""})]}),o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Quadra"}),o.jsx("p",{className:"font-semibold",children:k.quadra_nome||""})]}),o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Incio"}),o.jsx("p",{className:"font-semibold",children:k.inicio?new Date(k.inicio).toLocaleString("pt-BR"):""})]}),o.jsxs("div",{className:"bg-surface-2 rounded-md p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Fim"}),o.jsx("p",{className:"font-semibold",children:k.fim?new Date(k.fim).toLocaleString("pt-BR"):""})]})]}),o.jsxs("div",{children:[o.jsx("h5",{className:"text-sm font-semibold mb-2",children:"Participantes"}),o.jsxs("div",{className:"border rounded-md divide-y divide-border",children:[(k.participantes||[]).map((T,D)=>o.jsxs("div",{className:"p-2 text-sm flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-3",children:[o.jsx("div",{className:"min-w-0",children:o.jsxs("div",{className:"flex items-center gap-2",children:[T.codigo!==null&&T.codigo!==void 0&&o.jsxs("span",{className:`text-xs font-bold rounded px-1.5 py-0.5 shrink-0 ${String(T.status_pagamento||"").toLowerCase()==="pago"?"text-emerald-400 bg-emerald-600/20 border border-emerald-700/40":"text-amber-400 bg-amber-600/20 border border-amber-700/40"}`,children:["#",T.codigo]}),o.jsx("span",{className:"font-medium truncate",children:T.nome||"Participante"})]})}),o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 w-full sm:w-auto justify-between sm:justify-end",children:[T.valor_cota!=null&&o.jsxs("span",{className:"text-xs font-semibold text-text-secondary",children:["R$ ",Number(T.valor_cota||0).toFixed(2)]}),o.jsx("span",{className:`text-[11px] font-semibold rounded-full px-2 py-0.5 border ${String(T.status_pagamento||"").toLowerCase()==="pago"?"bg-success/10 text-success border-success/30":"bg-warning/10 text-warning border-warning/30"}`,children:String(T.status_pagamento||T.status_pagamento_text||"Pendente")})]})]},`${T.id}-${D}`)),(!k.participantes||k.participantes.length===0)&&o.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum participante encontrado."})]})]})]}):o.jsx("div",{className:"text-sm text-text-muted",children:"Nenhuma informao para exibir."})}),o.jsx(Un,{children:o.jsx(oe,{variant:"outline",onClick:()=>j(!1),children:"Fechar"})})]})})]}),o.jsxs(Un,{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 sm:gap-0 sm:justify-between",children:[!r?.is_consumidor_final&&o.jsx("div",{className:"w-full sm:flex-1",children:o.jsxs(oe,{type:"button",variant:"destructive",className:"bg-red-600 hover:bg-red-500 text-white w-full sm:w-auto",onClick:()=>a?.(r),children:[o.jsx(lH,{className:"mr-2 h-4 w-4"})," Inativar Cliente"]})}),o.jsxs("div",{className:"flex gap-2 w-full sm:w-auto sm:ml-auto",children:[o.jsx(Hm,{asChild:!0,children:o.jsx(oe,{type:"button",variant:"secondary",className:"flex-1 sm:flex-none",children:"Fechar"})}),!r?.is_consumidor_final&&o.jsxs(oe,{onClick:()=>n(r),className:"flex-1 sm:flex-none",children:[o.jsx(El,{className:"mr-2 h-4 w-4"})," Editar Cliente"]})]})]})]})}):null}function Fat(){const{toast:e}=oo(),{userProfile:t,authReady:r}=Do(),n=ls(),[a,i]=p.useState(()=>{try{const L=localStorage.getItem("auth:userProfile"),W=L&&JSON.parse(L)?.codigo_empresa||null,ne=W?`clientes:list:${W}`:"clientes:list",le=JSON.parse(localStorage.getItem(ne)||"[]");return Array.isArray(le)?le:[]}catch{return[]}}),[s,l]=p.useState(!1),[c,d]=p.useState(!0),[u,f]=p.useState(!1),[m,h]=p.useState(!1),[v,g]=p.useState(null),[y,x]=p.useState(null),[b,w]=p.useState({searchTerm:"",status:"all",tipo:"todos"}),j=p.useRef(!1),_=p.useRef(0),C=p.useRef(0),E=p.useRef(!1);p.useEffect(()=>{n.state?.openModal&&!u&&!E.current&&(E.current=!0,f(!0),window.history.replaceState({},document.title))},[n.state?.openModal,u]);const P=async()=>{try{const L=a&&a.length>0;if(L||l(!0),!t?.codigo_empresa)return;const W=`clientes:list:${t.codigo_empresa}`;let ne=ve.from("clientes").select("*, is_consumidor_final").eq("codigo_empresa",t.codigo_empresa).order("codigo",{ascending:!0});if(b.searchTerm.trim()!==""){const G=b.searchTerm.trim();/^\d+$/.test(G)?ne=ne.or(`codigo.eq.${G},nome.ilike.%${G}%,email.ilike.%${G}%,telefone.ilike.%${G}%`):ne=ne.or(`nome.ilike.%${G}%,email.ilike.%${G}%,telefone.ilike.%${G}%`)}b.status!=="all"&&(ne=ne.eq("status",b.status));const le=setTimeout(()=>{try{if(!L){const G=JSON.parse(localStorage.getItem(W)||"[]");Array.isArray(G)&&G.length>0&&(console.warn("[Clientes] slow fallback: using cached snapshot"),i(G),C.current=G.length)}}catch{}},2e3),{data:K,error:Q}=await ne;if(Q){if(!j.current){j.current=!0,setTimeout(P,900);return}throw Q}const re=K||[];if(re.length===0&&L&&!j.current){j.current=!0,setTimeout(P,700);return}j.current=!1,i(re);try{localStorage.setItem(W,JSON.stringify(re))}catch{}C.current=re.length,_.current=Date.now()}catch(L){e({title:"Erro ao carregar clientes",description:L.message,variant:"destructive"})}finally{l(!1);try{clearTimeout(slowFallback)}catch{}}};p.useEffect(()=>{try{const L=localStorage.getItem("auth:userProfile"),W=t?.codigo_empresa||L&&JSON.parse(L)?.codigo_empresa||null;if(W){const ne=`clientes:list:${W}`,le=JSON.parse(localStorage.getItem(ne)||"[]");Array.isArray(le)&&le.length&&a.length===0&&(i(le),C.current=le.length)}}catch{}if(r&&t?.codigo_empresa){const L=setTimeout(P,50);return()=>clearTimeout(L)}return()=>{}},[r,t?.codigo_empresa]),p.useEffect(()=>{if(r&&t?.codigo_empresa){const L=setTimeout(P,200);return()=>clearTimeout(L)}return()=>{}},[b.searchTerm,b.status,r,t?.codigo_empresa]),p.useEffect(()=>{const L=()=>{(Date.now()-(_.current||0)>3e4||C.current===0)&&r&&t?.codigo_empresa&&P()},W=()=>{document.visibilityState==="visible"&&(Date.now()-(_.current||0)>3e4||C.current===0)&&r&&t?.codigo_empresa&&P()};return window.addEventListener("focus",L),document.addEventListener("visibilitychange",W),()=>{window.removeEventListener("focus",L),document.removeEventListener("visibilitychange",W)}},[r,t?.codigo_empresa]);const k=p.useMemo(()=>{const W=new Date().getMonth();return{total:a.length,birthdays:a.filter(ne=>ne.aniversario&&new Date(ne.aniversario).getMonth()===W).length,active:a.filter(ne=>ne.status==="active").length}},[a]);function M(L){const W=["Cdigo","Tipo Pessoa","Nome/Razo Social","Apelido/Nome Fantasia","CPF","CNPJ","RG","IE","Email","Telefone","Fone 2","Celular 1","Celular 2","WhatsApp","CEP","Endereo","Nmero","Complemento","Bairro","Cidade","UF","Cidade IBGE","Limite Crdito","Tipo Recebimento","Regime Tributrio","Tipo Contribuinte","Aniversrio","Sexo","Estado Civil","Nome da Me","Nome do Pai","Observaes"," Cliente"," Fornecedor"," Funcionrio"," Administradora"," Parceiro","CCF/SPC","Status"],ne=";",le=Z=>{if(!Z)return"";try{const ee=new Date(Z);if(!isNaN(ee)){const kt=String(ee.getDate()).padStart(2,"0"),Nt=String(ee.getMonth()+1).padStart(2,"0"),De=ee.getFullYear();return`${kt}/${Nt}/${De}`}}catch{}return String(Z)},K=Z=>{const ee=Number(Z??0);return Number.isFinite(ee)?ee.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}):""},Q=Z=>Z?"Sim":"No",re=Z=>{const ee=Z==null?"":String(Z);return/[";\n]/.test(ee)?`"${ee.replace(/"/g,'""')}"`:ee},G=[];G.push("\uFEFF"+W.join(ne));for(const Z of L){const ee=[Z.codigo??"",Z.tipo_pessoa||"",Z.nome||"",Z.apelido||"",Z.cpf||"",Z.cnpj||"",Z.rg||"",Z.ie||"",Z.email||"",Z.telefone||"",Z.fone2||"",Z.celular1||"",Z.celular2||"",Z.whatsapp||"",Z.cep||"",Z.endereco||"",Z.numero||"",Z.complemento||"",Z.bairro||"",Z.cidade||"",Z.uf||"",Z.cidade_ibge||"",K(Z.limite_credito),Z.tipo_recebimento||"",Z.regime_tributario||"",Z.tipo_contribuinte||"",le(Z.aniversario),Z.sexo||"",Z.estado_civil||"",Z.nome_mae||"",Z.nome_pai||"",Z.observacoes||"",Q(!!Z.flag_cliente),Q(!!Z.flag_fornecedor),Q(!!Z.flag_funcionario),Q(!!Z.flag_administradora),Q(!!Z.flag_parceiro),Q(!!Z.flag_ccf_spc),Z.status==="active"?"Ativo":"Inativo"].map(re).join(ne);G.push(ee)}const me=new Blob([G.join(`
`)],{type:"text/csv;charset=utf-8;"}),pe=URL.createObjectURL(me),Be=document.createElement("a");Be.href=pe,Be.download="clientes.csv",document.body.appendChild(Be),Be.click(),document.body.removeChild(Be),URL.revokeObjectURL(pe)}const S=()=>{try{M(I),e({title:"Exportao concluda",description:`${I.length} cliente(s) exportado(s).`,variant:"success",className:"bg-amber-500 text-black shadow-xl"})}catch(L){e({title:"Falha ao exportar",description:L?.message||"No foi possvel gerar o arquivo.",variant:"destructive"})}},I=p.useMemo(()=>(new Date().getMonth(),a.filter(W=>{const ne=b.searchTerm.toLowerCase()===""||(W.nome||"").toLowerCase().includes(b.searchTerm.toLowerCase())||(W.cpf||"").includes(b.searchTerm)||(W.telefone||"").includes(b.searchTerm),le=b.status==="all"||W.status===b.status;let K=!0;return b.tipo==="clientes"?K=W.flag_cliente===!0:b.tipo==="fornecedores"?K=W.flag_fornecedor===!0:b.tipo==="ambos"&&(K=W.flag_cliente===!0&&W.flag_fornecedor===!0),ne&&le&&K})),[a,b]),[T,D]=p.useState({by:"codigo",dir:"asc"}),B=L=>{D(W=>W.by===L&&W.dir==="asc"?{by:L,dir:"desc"}:{by:L,dir:"asc"})},U=p.useMemo(()=>{const L=I.find(Q=>Q?.is_consumidor_final===!0),ne=[...I.filter(Q=>Q?.is_consumidor_final!==!0)],le=T.dir==="asc"?1:-1,K=(Q,re)=>Number.isFinite(Q)?Q:re;return ne.sort((Q,re)=>{if(T.by==="codigo"){const G=K(parseInt(String(Q.codigo||"").trim(),10),1/0),me=K(parseInt(String(re.codigo||"").trim(),10),1/0);return G===me?0:G>me?le:-le}if(T.by==="nome"){const G=(Q.nome||"").toString(),me=(re.nome||"").toString();return G.localeCompare(me,"pt-BR",{sensitivity:"base"})*le}return 0}),L?[L,...ne]:ne},[I,T]),z=L=>{g(L),h(!0)},$=()=>{x(null),f(!0)},Y=L=>{h(!1),x(L),f(!0)},de=async L=>{try{const{error:W}=await ve.from("clientes").update({status:"inactive"}).eq("id",L.id);if(W)throw W;h(!1),e({title:"Cliente inativado",description:`${L.nome} foi marcado como inativo.`}),P()}catch(W){e({title:"Erro ao inativar cliente",description:W.message,variant:"destructive"})}},xe=()=>{w({searchTerm:"",status:"all",tipo:"todos"})},q=b.searchTerm!==""||b.status!=="all"||b.tipo!=="todos";return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"h-full flex flex-col",children:o.jsxs(fr.div,{variants:Lat,initial:"hidden",animate:"visible",children:[o.jsxs(fr.div,{variants:Kae,className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h1",{className:"text-2xl sm:text-3xl font-black text-text-primary tracking-tighter",children:"Clientes & Fornecedores"}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Gesto completa de clientes e fornecedores"})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-2 w-full sm:w-auto",children:[o.jsx(oe,{variant:"outline",size:"icon",onClick:()=>d(L=>!L),title:c?"Ocultar resumo":"Mostrar resumo","aria-label":c?"Ocultar resumo":"Mostrar resumo",className:"flex-shrink-0",children:c?o.jsx(Sp,{className:"h-4 w-4"}):o.jsx(zp,{className:"h-4 w-4"})}),o.jsxs(oe,{variant:"outline",onClick:S,className:"text-sm",children:[o.jsx(ri,{className:"mr-2 h-4 w-4"}),o.jsx("span",{className:"hidden sm:inline",children:"Exportar"}),o.jsx("span",{className:"sm:hidden",children:"CSV"})]}),o.jsxs(oe,{onClick:$,className:"text-sm",children:[o.jsx(Ka,{className:"mr-2 h-4 w-4"})," ",o.jsx("span",{className:"hidden xs:inline",children:"Novo"}),o.jsx("span",{className:"xs:hidden",children:"Novo"})]})]})]}),c&&o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[o.jsx(K2,{icon:cl,title:"Total de Clientes",value:a.filter(L=>L.flag_cliente).length,color:"text-brand",onClick:()=>w(L=>({...L,tipo:"clientes"})),isActive:b.tipo==="clientes"}),o.jsx(K2,{icon:cl,title:"Total de Fornecedores",value:a.filter(L=>L.flag_fornecedor).length,color:"text-purple-500",onClick:()=>w(L=>({...L,tipo:"fornecedores"})),isActive:b.tipo==="fornecedores"}),o.jsx(K2,{icon:Ude,title:"Aniversariantes do Ms",value:k.birthdays,color:"text-info",onClick:()=>w(L=>({...L,tipo:"todos"})),isActive:b.tipo==="todos"}),o.jsx(K2,{icon:Up,title:"Ativos",value:k.active,color:"text-success",onClick:()=>w(L=>({...L,status:"active"})),isActive:b.status==="active"})]}),o.jsx(fr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:o.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[o.jsxs("div",{className:"p-4 border-b border-border flex flex-col gap-4",children:[o.jsxs("div",{className:"relative w-full",children:[o.jsx(pi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(or,{placeholder:"Buscar por nome, CPF ou telefone...",className:"pl-9",value:b.searchTerm,onChange:L=>w(W=>({...W,searchTerm:L.target.value}))})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[o.jsxs(En,{value:b.tipo,onValueChange:L=>w(W=>({...W,tipo:L})),children:[o.jsx(Sn,{className:"w-full sm:w-[200px]",children:o.jsx(kn,{placeholder:"Tipo"})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"todos",children:"Todos"}),o.jsx(wt,{value:"clientes",children:"Apenas Clientes"}),o.jsx(wt,{value:"fornecedores",children:"Apenas Fornecedores"}),o.jsx(wt,{value:"ambos",children:"Clientes e Fornecedores"})]})]}),o.jsxs(En,{value:b.status,onValueChange:L=>w(W=>({...W,status:L})),children:[o.jsx(Sn,{className:"w-full sm:w-[180px]",children:o.jsx(kn,{placeholder:"Status"})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"all",children:"Todos os Status"}),o.jsx(wt,{value:"active",children:"Ativos"}),o.jsx(wt,{value:"inactive",children:"Inativos"})]})]}),q&&o.jsxs(oe,{variant:"ghost",onClick:xe,className:"w-full sm:w-auto",children:[o.jsx(Py,{className:"mr-2 h-4 w-4"}),"Limpar Filtros"]})]})]}),o.jsx("div",{className:"md:hidden space-y-3 p-4",children:s?o.jsx("div",{className:"text-center py-8 text-text-muted",children:"Carregando..."}):U.length>0?U.map(L=>{const W=L?.is_consumidor_final===!0;return o.jsxs("div",{className:Yt("rounded-lg border bg-surface p-4 space-y-3 cursor-pointer transition-all",W?"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-4 border-l-amber-500/40 border-t-border border-r-border border-b-border":"border-border hover:border-brand/50"),onClick:()=>z(L),children:[o.jsxs("div",{className:"flex items-center justify-between gap-3",children:[o.jsx("span",{className:Yt("font-mono text-sm font-semibold",W?"text-amber-300/90":"text-text-primary"),children:L.codigo}),o.jsx("span",{className:Yt("px-2 py-0.5 text-xs font-semibold rounded-full flex-shrink-0",L.status==="active"?"bg-success/10 text-success":"bg-danger/10 text-danger"),children:L.status==="active"?"Ativo":"Inativo"})]}),o.jsxs("div",{children:[o.jsx("h3",{className:Yt("font-semibold text-base mb-1",W?"text-amber-100/90":"text-text-primary"),children:L.nome||""}),W&&o.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium mb-1",children:[o.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]}),o.jsx("p",{className:"text-sm text-text-muted",children:L.cpf&&`CPF: ${L.cpf}`||L.cnpj&&`CNPJ: ${L.cnpj}`||(L.apelido?`Apelido: ${L.apelido}`:" ")})]}),o.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[L.flag_cliente&&o.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-blue-500/10 text-blue-500 border border-blue-500/30",children:"Cliente"}),L.flag_fornecedor&&o.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-purple-500/10 text-purple-500 border border-purple-500/30",children:"Fornecedor"})]}),(L.telefone||L.email)&&o.jsxs("div",{children:[o.jsx("span",{className:"text-xs text-text-muted block mb-1",children:"Contato"}),o.jsx("span",{className:"text-sm font-medium",children:L.telefone||L.email})]}),o.jsx("div",{className:"text-xs text-text-muted text-center pt-2 border-t border-border/50",children:"Toque para ver detalhes"})]},L.id)}):o.jsx("div",{className:"text-center py-8 text-text-muted",children:"Nenhum cliente encontrado com os filtros aplicados."})}),o.jsx("div",{className:"hidden md:block",children:o.jsxs(rl,{children:[o.jsx(nl,{className:"sticky top-0 bg-surface-2 z-10",children:o.jsxs(Ba,{className:"border-b border-border",children:[o.jsxs(vn,{className:"select-none cursor-pointer text-text-secondary",onClick:()=>B("codigo"),title:"Ordenar por cdigo",children:["Cdigo ",T.by==="codigo"?T.dir==="asc"?"":"":""]}),o.jsxs(vn,{className:"text-text-secondary select-none cursor-pointer",onClick:()=>B("nome"),title:"Ordenar por nome",children:["Cliente ",T.by==="nome"?T.dir==="asc"?"":"":""]}),o.jsx(vn,{className:"text-text-secondary",children:"Contato"}),o.jsx(vn,{className:"text-text-secondary",children:"Tipo"}),o.jsx(vn,{className:"text-text-secondary",children:"Status"})]})}),o.jsx(al,{children:s?o.jsx(Ba,{children:o.jsx(en,{colSpan:5,className:"h-24 text-center",children:"Carregando..."})}):U.length>0?U.map(L=>{const W=L?.is_consumidor_final===!0;return o.jsxs(Ba,{className:Yt("cursor-pointer transition-all",W?"bg-gradient-to-r from-amber-500/5 to-transparent hover:from-amber-500/10 border-l-2 border-l-amber-500/40":"hover:bg-surface-2"),onClick:()=>z(L),children:[o.jsx(en,{className:Yt("font-mono text-base font-semibold",W?"text-amber-300/90":"text-text-primary"),children:L.codigo}),o.jsx(en,{children:o.jsxs("div",{className:"flex flex-col gap-1",children:[o.jsx("span",{className:Yt("text-base font-semibold truncate",W?"text-amber-100/90":"text-text-primary"),children:L.nome||""}),W&&o.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-amber-400/70 font-medium",children:[o.jsx("svg",{className:"w-3 h-3 opacity-60",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Cliente Padro"]}),o.jsx("span",{className:"text-xs text-text-muted truncate",children:L.cpf&&`CPF: ${L.cpf}`||L.cnpj&&`CNPJ: ${L.cnpj}`||(L.apelido?`Apelido: ${L.apelido}`:" ")})]})}),o.jsx(en,{children:o.jsx("div",{className:"flex flex-col",children:o.jsx("span",{className:"text-sm truncate",children:L.telefone||L.email||""})})}),o.jsx(en,{children:o.jsxs("div",{className:"flex flex-wrap gap-1",children:[L.flag_cliente&&o.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-blue-500/10 text-blue-500 border border-blue-500/30",children:"Cliente"}),L.flag_fornecedor&&o.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-purple-500/10 text-purple-500 border border-purple-500/30",children:"Fornecedor"})]})}),o.jsx(en,{children:o.jsx("span",{className:Yt("px-2 py-1 text-xs font-semibold rounded-full",L.status==="active"?"bg-success/10 text-success":"bg-danger/10 text-danger"),children:L.status==="active"?"Ativo":"Inativo"})})]},L.id)}):o.jsx(Ba,{children:o.jsx(en,{colSpan:5,className:"h-24 text-center",children:"Nenhum cliente encontrado com os filtros aplicados."})})})]})})]})})]})}),o.jsx(nre,{open:u,onOpenChange:f,client:y,onSaved:P}),o.jsx($at,{open:m,onOpenChange:h,client:v,onEdit:Y,onInactivate:de,codigoEmpresa:t?.codigo_empresa})]})}const Bat=[],qat={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},Yae={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},xE=({icon:e,title:t,value:r,color:n})=>{const a=e;return o.jsxs(fr.div,{variants:Yae,className:"bg-surface rounded-lg border border-border p-4 flex items-center gap-4",children:[o.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${n}/20`,children:o.jsx(a,{className:`w-6 h-6 ${n}`})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-text-secondary text-sm font-medium",children:t}),o.jsx("p",{className:"text-2xl font-bold text-text-primary",children:r})]})]})};function zat({open:e,onOpenChange:t,member:r,onEdit:n}){return r?o.jsx(ln,{open:e,onOpenChange:t,children:o.jsxs(on,{className:"sm:max-w-[500px] w-full",children:[o.jsx(nn,{children:o.jsx(rn,{children:"Detalhes do Funcionrio"})}),o.jsxs("div",{className:"p-4 sm:p-6 space-y-4",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h2",{className:"text-xl font-bold",children:r.name}),o.jsx("p",{className:"text-brand font-semibold",children:r.role})]}),o.jsxs("div",{className:"bg-surface-2 p-8 rounded-lg text-center border border-border",children:[o.jsx("p",{className:"text-lg font-semibold text-text-secondary",children:" Em desenvolvimento"}),o.jsx("p",{className:"text-sm text-text-muted mt-2",children:"Detalhes completos do funcionrio estaro disponveis em breve."})]})]}),o.jsxs(Un,{className:"flex flex-col sm:flex-row gap-2 sm:gap-0",children:[o.jsx(Hm,{asChild:!0,children:o.jsx(oe,{type:"button",variant:"secondary",className:"w-full sm:w-auto",children:"Fechar"})}),o.jsxs(oe,{onClick:()=>n(r),className:"w-full sm:w-auto",children:[o.jsx(El,{className:"mr-2 h-4 w-4"})," Editar"]})]})]})}):null}function Uat({open:e,onOpenChange:t,member:r,onSave:n,loading:a}){const{toast:i}=oo(),[s,l]=p.useState(r?.name||""),[c,d]=p.useState(r?.role||"");p.useEffect(()=>{e&&(l(r?.name||""),d(r?.role||""))},[r,e]);const u=async f=>{if(f.preventDefault(),!s.trim()){i({title:"Nome  obrigatrio",variant:"destructive"});return}await n({name:s.trim(),role:c.trim()})};return o.jsx(ln,{open:e,onOpenChange:t,children:o.jsxs(on,{className:"sm:max-w-[700px] w-full",children:[o.jsxs(nn,{children:[o.jsx(rn,{children:r?"Editar Funcionrio":"Novo Funcionrio"}),o.jsx(_n,{children:"Informe apenas nome e cargo. O cargo  livre (texto)."})]}),o.jsx("form",{onSubmit:u,className:"py-2",children:o.jsx("div",{className:"bg-surface-2 border border-border rounded-lg p-4 space-y-4",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Wt,{htmlFor:"name",children:"Nome"}),o.jsxs("div",{className:"relative",children:[o.jsx(ju,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(or,{id:"name",value:s,onChange:f=>l(f.target.value),className:"pl-9",placeholder:"Ex.: Maria Silva"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Wt,{htmlFor:"role",children:"Cargo"}),o.jsxs("div",{className:"relative",children:[o.jsx(Kde,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(or,{id:"role",value:c,onChange:f=>d(f.target.value),className:"pl-9",placeholder:"Ex.: Gerente, Caixa, ..."})]})]})]})})}),o.jsxs(Un,{className:"flex flex-col sm:flex-row gap-2 sm:gap-0",children:[o.jsx(Hm,{asChild:!0,children:o.jsx(oe,{type:"button",variant:"secondary",className:"w-full sm:w-auto",children:"Cancelar"})}),o.jsx(oe,{type:"submit",onClick:u,disabled:!!a,className:"w-full sm:w-auto",children:a?"Salvando...":"Salvar"})]})]})})}function Vat(){const{company:e,authReady:t,userProfile:r}=Do(),{toast:n}=oo(),[a,i]=p.useState(Bat),[s,l]=p.useState(!1),[c,d]=p.useState(!1),[u,f]=p.useState(null),[m,h]=p.useState(null),[v,g]=p.useState(""),[y,x]=p.useState(!1),b=p.useRef(!1),w=p.useRef(!0);p.useEffect(()=>(w.current=!0,()=>{w.current=!1}),[]);const j=async()=>{try{const T=e?.codigo_empresa||null;if(!T&&!e?.id)return;const D=T?`team:list:${T}`:"team:list",B=setTimeout(()=>{if(w.current)try{const q=localStorage.getItem(D),L=q?JSON.parse(q):[];Array.isArray(L)&&L.length>0&&(console.warn("[Equipe] slow fallback: using cached snapshot"),i(L))}catch{}},5e3);let U=ve.from("colaboradores").select("*").order("nome",{ascending:!0});T&&(U=U.eq("codigo_empresa",T));const{data:z,error:$}=await U;if($){if(!b.current){b.current=!0,setTimeout(j,800);return}throw $}let de=(z||[]).map(q=>({id:q.id,name:q.nome||"",role:q.cargo||"user",status:q.ativo===!1?"inactive":"active",online:!1,permissions:{}}));const xe=r?.codigo_empresa&&e?.codigo_empresa&&r.codigo_empresa===e.codigo_empresa;if(r?.id&&xe&&(de.some(L=>L.id===r.id)||(de=[{id:r.id,name:r.nome||"Voc",role:r.cargo||"user",status:"active",online:!1,permissions:{}},...de])),!w.current)return;i(de);try{localStorage.setItem(D,JSON.stringify(de))}catch{}}catch(T){console.error("Falha ao carregar equipe:",T);const D=e?.codigo_empresa||null,B=D?`team:list:${D}`:"team:list";try{const U=localStorage.getItem(B);U&&w.current&&i(JSON.parse(U))}catch{}}finally{b.current=!1}};p.useEffect(()=>{const T=e?.codigo_empresa||null;if(!(!t||!T)){try{const D=localStorage.getItem(`team:list:${T}`),B=D?JSON.parse(D):[];Array.isArray(B)&&B.length>0&&i(B)}catch{}j()}},[t,e?.codigo_empresa]),p.useEffect(()=>{const T=()=>{document.visibilityState==="visible"&&t&&(e?.codigo_empresa||e?.id)&&j()},D=()=>{t&&(e?.codigo_empresa||e?.id)&&j()};return document.addEventListener("visibilitychange",T),window.addEventListener("focus",D),()=>{document.removeEventListener("visibilitychange",T),window.removeEventListener("focus",D)}},[t,e?.codigo_empresa,e?.id]);const _=p.useMemo(()=>({total:a.length,active:a.filter(T=>T.status==="active").length,inactive:a.filter(T=>T.status==="inactive").length}),[a]),C=p.useMemo(()=>a.filter(T=>T.name.toLowerCase().includes(v.toLowerCase())||T.role.toLowerCase().includes(v.toLowerCase())),[a,v]),E=T=>{f(T),d(!0)},P=()=>{h(null),l(!0)},k=T=>{d(!1),h(T),l(!0)},M=T=>{h(T),l(!0)},S=async({name:T,role:D})=>{try{if(x(!0),!e?.codigo_empresa&&!e?.id)throw new Error("Empresa no encontrada para o usurio atual.");let B=e?.codigo_empresa||null;if(!B&&e?.id){const{data:U}=await ve.from("empresas").select("codigo_empresa").eq("id",e.id).single();B=U?.codigo_empresa||null}if(!B)throw new Error("Empresa sem cdigo. Defina o cdigo da empresa antes de adicionar colaboradores.");if(m){const{error:U}=await ve.from("colaboradores").update({nome:T,cargo:D}).eq("id",m.id);if(U)throw U;n({title:"Funcionrio atualizado",description:m.name,variant:"default"})}else{const{error:U}=await ve.from("colaboradores").insert({codigo_empresa:B,nome:T,cargo:D,ativo:!0});if(U)throw U;n({title:"Funcionrio criado com sucesso",description:T,variant:"success"})}await j(),l(!1),h(null)}catch(B){n({title:"Erro ao salvar funcionrio",description:B.message||String(B),variant:"destructive"})}finally{x(!1)}},I=async T=>{try{if(!(e?.id||e?.codigo_empresa))return;const D=a[0]?.id;if(T.id===D){n({title:"Ao no permitida",description:"No  possvel desativar o primeiro funcionrio.",variant:"destructive"});return}if(r?.id&&T.id===r.id){n({title:"Ao no permitida",description:"Voc no pode desativar o seu prprio usurio.",variant:"destructive"});return}if(a.filter(U=>U.status==="active").length<=1){n({title:"Ao no permitida",description:"Deve haver pelo menos um funcionrio ativo.",variant:"destructive"});return}const{error:B}=await ve.from("colaboradores").update({ativo:!1}).eq("id",T.id);if(B)throw B;n({title:"Funcionrio desativado",description:T.name}),await j()}catch(D){n({title:"Erro ao desativar",description:D.message||String(D),variant:"destructive"})}};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"h-full flex flex-col",children:o.jsxs(fr.div,{variants:qat,initial:"hidden",animate:"visible",children:[o.jsxs(fr.div,{variants:Yae,className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl sm:text-3xl font-black text-text-primary tracking-tighter",children:"Gesto de Equipe"}),o.jsx("p",{className:"text-sm sm:text-base text-text-secondary",children:"Controle de funcionrios, permisses e logs."})]}),o.jsxs(oe,{onClick:P,disabled:!t||!e?.codigo_empresa,title:t?e?.codigo_empresa?"":"Empresa sem cdigo. Defina o cdigo da empresa antes.":"Aguardando autenticao...",children:[o.jsx(Ka,{className:"mr-2 h-4 w-4"})," Novo Funcionrio"]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[o.jsx(xE,{icon:cl,title:"Total",value:_.total,color:"text-brand"}),o.jsx(xE,{icon:iue,title:"Ativos",value:_.active,color:"text-success"}),o.jsx(xE,{icon:rue,title:"Desativados",value:_.inactive,color:"text-danger"})]}),o.jsx(fr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:o.jsxs("div",{className:"bg-surface rounded-lg border border-border",children:[o.jsx("div",{className:"p-4 border-b border-border",children:o.jsxs("div",{className:"relative",children:[o.jsx(pi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(or,{placeholder:"Buscar por nome ou cargo...",className:"pl-9",value:v,onChange:T=>g(T.target.value)})]})}),o.jsx("div",{className:"md:hidden p-4 space-y-3",children:C.length===0?o.jsx("div",{className:"text-center py-10 text-text-muted",children:"Nenhum funcionrio cadastrado."}):C.map((T,D)=>o.jsxs("div",{className:"rounded-lg border border-border bg-surface p-4 space-y-3",onClick:()=>E(T),children:[o.jsxs("div",{className:"flex items-start justify-between gap-3",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h3",{className:"font-semibold text-base text-text-primary truncate",children:T.name}),o.jsx("p",{className:"text-sm text-text-muted mt-0.5",children:T.role})]}),o.jsx("span",{className:Yt("inline-flex px-2 py-0.5 rounded-full text-xs font-semibold flex-shrink-0",T.status==="active"?"bg-success/10 text-success":"bg-danger/10 text-danger"),children:T.status==="active"?"Ativo":"Inativo"})]}),o.jsxs("div",{className:"flex gap-2 pt-2",children:[o.jsx(oe,{variant:"outline",size:"sm",onClick:B=>{B.stopPropagation(),E(T)},className:"flex-1",children:"Ver Detalhes"}),o.jsx(oe,{variant:"outline",size:"sm",onClick:B=>{B.stopPropagation(),M(T)},children:o.jsx(El,{className:"h-3 w-3"})}),o.jsxs(Uy,{children:[o.jsx(Vy,{asChild:!0,children:o.jsx(oe,{variant:"outline",size:"sm",onClick:B=>B.stopPropagation(),children:o.jsx(e6,{className:"h-3 w-3"})})}),o.jsx(zv,{align:"end",children:o.jsx(sl,{className:"text-danger",disabled:D===0||a.filter(B=>B.status==="active").length<=1||r?.id&&T.id===r.id,onClick:B=>{B.stopPropagation(),I(T)},children:"Desativar"})})]})]})]},T.id))}),o.jsx("div",{className:"hidden md:block",children:o.jsxs(rl,{children:[o.jsx(nl,{children:o.jsxs(Ba,{children:[o.jsx(vn,{children:"Funcionrio"}),o.jsx(vn,{children:"Cargo"}),o.jsx(vn,{children:"Status"}),o.jsx(vn,{className:"w-[80px] text-center",children:"Aes"})]})}),o.jsxs(al,{children:[C.length===0&&o.jsx(Ba,{children:o.jsx(en,{colSpan:4,className:"text-center py-10 text-text-muted",children:"Nenhum funcionrio cadastrado."})}),C.map((T,D)=>o.jsxs(Ba,{className:"cursor-pointer",onClick:()=>E(T),children:[o.jsx(en,{className:"font-medium",children:o.jsx("div",{className:"flex items-center gap-3",children:o.jsx("span",{children:T.name})})}),o.jsx(en,{children:T.role}),o.jsx(en,{children:o.jsx("span",{className:Yt("px-2 py-1 text-xs font-semibold rounded-full",T.status==="active"?"bg-success/10 text-success":"bg-danger/10 text-danger"),children:T.status==="active"?"Ativo":"Inativo"})}),o.jsx(en,{className:"text-center",children:o.jsxs(Uy,{children:[o.jsx(Vy,{asChild:!0,children:o.jsx(oe,{variant:"ghost",className:"h-8 w-8 p-0 mx-auto",onClick:B=>B.stopPropagation(),children:o.jsx(e6,{className:"h-4 w-4"})})}),o.jsxs(zv,{align:"end",children:[o.jsx(sl,{onClick:B=>{B.stopPropagation(),E(T)},children:"Ver Detalhes"}),o.jsx(sl,{onClick:B=>{B.stopPropagation(),M(T)},children:"Editar"}),o.jsx(sl,{className:"text-danger",disabled:D===0||a.filter(B=>B.status==="active").length<=1||r?.id&&T.id===r.id,onClick:B=>{B.stopPropagation(),I(T)},children:"Desativar"})]})]})})]},T.id))]})]})})]})})]})}),o.jsx(Uat,{open:s,onOpenChange:l,member:m,onSave:S,loading:y}),o.jsx(zat,{open:c,onOpenChange:d,member:u,onEdit:k})]})}const Wat="v1.0.4";function im({title:e,icon:t,children:r,className:n="",collapsible:a=!1,defaultOpen:i=!0}){return a?o.jsx("div",{className:`bg-surface rounded-lg border border-border shadow-sm ${n}`,children:o.jsxs("details",{className:"group",open:i,children:[o.jsxs("summary",{className:"list-none cursor-pointer select-none p-4 flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[t&&o.jsx(t,{className:"w-5 h-5 text-brand"}),o.jsx("h3",{className:"text-base font-semibold",children:e})]}),o.jsx("span",{className:"text-xs text-text-secondary group-open:rotate-180 transition-transform",children:""})]}),o.jsx("div",{className:"px-4 pb-4",children:r})]})}):o.jsxs("div",{className:`bg-surface rounded-lg border border-border shadow-sm p-4 ${n}`,children:[o.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t&&o.jsx(t,{className:"w-5 h-5 text-brand"}),o.jsx("h3",{className:"text-base font-semibold",children:e})]}),r]})}function sm({label:e,value:t}){return o.jsxs("div",{className:"flex items-center justify-between gap-3 py-1 text-sm",children:[o.jsx("span",{className:"text-text-secondary",children:e}),o.jsx("span",{className:"font-medium truncate",children:t||""})]})}function Hat(){const{userProfile:e,company:t,authReady:r,loading:n}=Do();ls();const[a,i]=p.useState("Agenda"),[s,l]=p.useState("Mdia"),[c,d]=p.useState(""),[u,f]=p.useState(""),[m,h]=p.useState(!0),[v,g]=p.useState(()=>window.__installPrompt||null),[y,x]=p.useState(!1),[b,w]=p.useState(!1),[j,_]=p.useState(!1),[C,E]=p.useState("unknown"),P="Fluxo7 Arena",k="fluxo7team@gmail.com",M="https://wa.me/5534998936088",S="tel:+5534998936088",I="+55 (34) 99893-6088";p.useEffect(()=>{try{const Y=window.matchMedia("(pointer:fine)"),de=()=>h(Y.matches);return de(),Y.addEventListener?.("change",de),()=>Y.removeEventListener?.("change",de)}catch{h(!0)}},[]),p.useEffect(()=>{const Y=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;w(Y);const de=navigator.userAgent;de.includes("Chrome")&&!de.includes("Edg")?E("chrome"):de.includes("Edg")?E("edge"):de.includes("Firefox")?E("firefox"):de.includes("Safari")&&!de.includes("Chrome")?E("safari"):E("other"),(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone)&&x(!0),window.__installPrompt&&!v&&g(window.__installPrompt);const xe=()=>{x(!0),g(null),_(!1)};return window.addEventListener("appinstalled",xe),()=>{window.removeEventListener("appinstalled",xe)}},[v]);const T=async()=>{if(v)try{await v.prompt();const{outcome:Y}=await v.userChoice;Y==="accepted"?(x(!0),_(!1)):_(!0),g(null),window.__installPrompt=null}catch(Y){console.error("Erro ao mostrar prompt de instalao:",Y),_(!0)}else _(!0)},D=()=>{navigator.share?navigator.share({title:"F7 Arena",text:"Adicione F7 Arena  sua tela inicial",url:window.location.href}).catch(()=>{alert(`Para adicionar  tela inicial:

1. Toque no boto de Compartilhar (cone de quadrado com seta)
2. Role para baixo
3. Toque em "Adicionar  Tela de Incio"`)}):alert(`Para adicionar  tela inicial:

1. Toque no boto de Compartilhar (cone de quadrado com seta)
2. Role para baixo
3. Toque em "Adicionar  Tela de Incio"`)},B=p.useMemo(()=>{try{return{empresa:t?.nome||t?.fantasia||t?.razao_social||t?.razaoSocial||t?.displayName||t?.codigo_empresa||"",usuario:e?.nome||e?.name||e?.email||"",dataHora:new Date().toLocaleString("pt-BR")}}catch{return{empresa:"",usuario:"",dataHora:new Date().toLocaleString("pt-BR")}}},[t?.nome,t?.fantasia,t?.razao_social,t?.razaoSocial,t?.displayName,t?.codigo_empresa,e?.nome,e?.name,e?.email]),U=p.useMemo(()=>[`[${P} - Suporte]`,`Assunto: ${c||"(sem assunto)"} `,`Categoria: ${a} `,`Severidade: ${s}`,"","Descrio:",(u||"(adicione uma descrio detalhada, passos para reproduzir, prints se possvel)")+`
`," Dados ",`Empresa: ${B.empresa}`,`Usurio: ${B.usuario}`,`Data e Hora: ${B.dataHora}`].join(`
`),[c,a,s,u,B]),z=`${M}?text=${encodeURIComponent(U)}`,$=`mailto:${k}?subject=${encodeURIComponent(`[Suporte] ${c||"Assunto"}`)}&body=${encodeURIComponent(U)}`;return o.jsxs("div",{className:"px-4 md:px-6 lg:px-8 py-4 md:py-6",children:[o.jsxs("div",{className:"bg-surface rounded-xl border border-border p-5 md:p-6 mb-6",children:[o.jsxs("div",{className:"flex items-start md:items-center justify-between gap-4 flex-col md:flex-row",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-lg bg-brand/10 border border-brand/30 flex items-center justify-center",children:o.jsx(nH,{className:"w-5 h-5 text-brand"})}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl md:text-2xl font-semibold",children:"Suporte"}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Precisa de ajuda? Fale com a gente ou consulte as respostas rpidas abaixo."})]})]}),o.jsxs("div",{className:"text-right",children:[o.jsxs("div",{className:"flex items-center justify-end gap-2",children:[o.jsx("div",{className:"w-10 h-10 bg-brand rounded-xl flex items-center justify-center",children:o.jsx($d,{className:"w-6 h-6 text-primary-foreground"})}),o.jsxs("div",{className:"flex items-baseline",children:[o.jsx("span",{className:"font-extrabold text-base md:text-xl",style:{color:"#FF6600"},children:"Fluxo"}),o.jsx("span",{className:"font-extrabold text-base md:text-xl",style:{color:"#FFAA33"},children:"7"}),o.jsx("span",{className:"font-medium text-base md:text-xl",style:{color:"#B0B0B0"},children:" Arena"})]})]}),o.jsxs("div",{className:"text-xs text-text-secondary mt-1",children:["Verso ",Wat]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-4",children:[o.jsx(im,{title:"Status",icon:e2,children:o.jsxs("div",{className:"grid grid-cols-1 gap-1",children:[o.jsx(sm,{label:"Empresa",value:B.empresa}),o.jsx(sm,{label:"Usurio",value:`${B.usuario}`})]})}),o.jsx(im,{title:"Fale com a gente",icon:hP,children:o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsxs("a",{href:M,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 rounded-md bg-brand text-black hover:opacity-90 transition",children:[o.jsx(hP,{className:"w-4 h-4"})," WhatsApp"]}),o.jsxs("a",{href:`mailto:${k}`,className:"inline-flex items-center gap-2 px-3 py-2 rounded-md border border-border hover:bg-surface-2 transition",children:[o.jsx(ax,{className:"w-4 h-4"})," E-mail"]}),o.jsxs("a",{href:S,className:"inline-flex items-center gap-2 px-3 py-2 rounded-md border border-border hover:bg-surface-2 transition",children:[o.jsx(wb,{className:"w-4 h-4"})," ",m?I:"Telefone"]})]})}),!y&&b&&o.jsx(im,{title:"Adicionar  Tela Inicial",icon:pP,children:o.jsxs("div",{className:"space-y-3",children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Crie um atalho do F7 Arena na sua tela inicial para acesso rpido."}),o.jsxs("button",{onClick:D,className:"w-full inline-flex items-center justify-center gap-2 px-4 py-3 rounded-md bg-brand text-black font-medium hover:opacity-90 transition",children:[o.jsx(r6,{className:"w-4 h-4"})," Criar Atalho"]}),o.jsxs("details",{className:"text-xs text-text-muted",children:[o.jsx("summary",{className:"cursor-pointer hover:text-text-secondary",children:"Como fazer manualmente?"}),o.jsxs("div",{className:"mt-2 space-y-1 pl-2",children:[o.jsxs("p",{children:["1. Toque no boto ",o.jsx(r6,{className:"inline w-3 h-3"})," (Compartilhar)"]}),o.jsx("p",{children:'2. Role para baixo e toque em "Adicionar  Tela de Incio"'}),o.jsx("p",{children:'3. Toque em "Adicionar"'})]})]})]})}),!y&&!b&&o.jsx(im,{title:"Instalar Aplicativo",icon:pP,children:o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Instale o F7 Arena no seu dispositivo para acesso rpido e experincia completa de aplicativo."}),o.jsxs("button",{onClick:T,className:"w-full inline-flex items-center justify-center gap-2 px-4 py-3 rounded-md bg-brand text-black font-medium hover:opacity-90 transition",children:[o.jsx(ri,{className:"w-4 h-4"})," Instalar App"]}),o.jsx("p",{className:"text-xs text-text-muted text-center",children:"Pode demorar alguns segundos. Se no aparecer nada, veja as instrues no tutorial."})]})}),y&&o.jsx(im,{title:"Aplicativo Instalado",icon:e2,children:o.jsxs("div",{className:"flex items-center gap-2 text-sm text-success",children:[o.jsx(e2,{className:"w-4 h-4"}),o.jsx("span",{children:"F7 Arena est instalado no seu dispositivo!"})]})})]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[o.jsx("div",{className:"lg:col-span-2 space-y-3",children:o.jsx(im,{title:"Perguntas Frequentes (FAQ)",children:o.jsxs("div",{className:"divide-y divide-border/60",children:[o.jsxs("details",{className:"py-3",children:[o.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Como abrir comanda de balco?"}),o.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"Abra o caixa antes. A tela de balco utiliza uma comanda sem mesa (mesa_id nulo). Se no existir, o sistema cria ao abrir o balco; caso o caixa esteja fechado, a abertura da comanda  bloqueada."})]}),o.jsxs("details",{className:"py-3",children:[o.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Por que no consigo fechar o caixa?"}),o.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"O fechamento  bloqueado se houver comandas com itens em aberto (inclui balco e mesas). Finalize ou feche as comandas pendentes antes de encerrar o caixa."})]}),o.jsxs("details",{className:"py-3",children:[o.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Como adicionar participantes no agendamento?"}),o.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"No modal de agendamento, selecione um ou mais clientes. Aps salvar, o chip de pagamentos  atualizado imediatamente. Se no visualizar, recarregue os dados da agenda."})]}),o.jsxs("details",{className:"py-3",children:[o.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Como ver o histrico completo do cliente?"}),o.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"Abra o cliente e utilize o Histrico Recente, que combina comandas e agendamentos em uma nica timeline com totais e status."})]}),o.jsxs("details",{className:"py-3",children:[o.jsx("summary",{className:"cursor-pointer select-none font-medium",children:"Como ajustar estoque mnimo e ver mais vendidos?"}),o.jsx("p",{className:"mt-2 text-sm text-text-secondary",children:"Na aba de Produtos voc pode gerenciar estoque, preos e relatrios. Utilize filtros e exportaes para anlise."})]})]})})}),o.jsx("div",{className:"lg:col-span-1",children:o.jsxs("div",{className:"space-y-3 lg:sticky lg:top-6",children:[o.jsx(im,{title:"Reportar um problema",icon:Mde,collapsible:!0,defaultOpen:!1,children:o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-secondary",children:"Categoria"}),o.jsxs("select",{value:a,onChange:Y=>i(Y.target.value),className:"w-full mt-1 px-2 py-2 rounded-md bg-background border border-border",children:[o.jsx("option",{children:"Agenda"}),o.jsx("option",{children:"Vendas"}),o.jsx("option",{children:"Clientes"}),o.jsx("option",{children:"Produtos"}),o.jsx("option",{children:"Financeiro"}),o.jsx("option",{children:"Outros"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-secondary",children:"Severidade"}),o.jsxs("select",{value:s,onChange:Y=>l(Y.target.value),className:"w-full mt-1 px-2 py-2 rounded-md bg-background border border-border",children:[o.jsx("option",{children:"Baixa"}),o.jsx("option",{children:"Mdia"}),o.jsx("option",{children:"Alta"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-secondary",children:"Assunto"}),o.jsx("input",{value:c,onChange:Y=>d(Y.target.value),placeholder:"Ex.: Erro ao salvar agendamento",className:"w-full mt-1 px-3 py-2 rounded-md bg-background border border-border"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-xs text-text-secondary",children:"Descrio"}),o.jsx("textarea",{value:u,onChange:Y=>f(Y.target.value),rows:4,placeholder:"Descreva o que aconteceu, passos para reproduzir, expectativa.",className:"w-full mt-1 px-3 py-2 rounded-md bg-background border border-border resize-y"})]}),o.jsxs("div",{className:"flex flex-wrap gap-2 pt-1",children:[o.jsxs("a",{href:z,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 rounded-md bg-brand text-black hover:opacity-90 transition",children:[o.jsx(hP,{className:"w-4 h-4"})," Enviar no WhatsApp"]}),o.jsxs("a",{href:$,className:"inline-flex items-center gap-2 px-3 py-2 rounded-md border border-border hover:bg-surface-2 transition",children:[o.jsx(ax,{className:"w-4 h-4"})," Enviar por E-mail"]}),o.jsxs("a",{href:S,className:"inline-flex items-center gap-2 px-3 py-2 rounded-md border border-border hover:bg-surface-2 transition",children:[o.jsx(wb,{className:"w-4 h-4"})," ",m?I:"Ligar agora"]})]})]})}),o.jsx(im,{title:"Diagnstico",icon:Bde,children:o.jsxs("div",{className:"space-y-1 text-sm",children:[o.jsx(sm,{label:"Empresa",value:B.empresa}),o.jsx(sm,{label:"Usurio",value:`${B.usuario}`}),o.jsx(sm,{label:"Data/Hora",value:B.dataHora}),o.jsx(sm,{label:"Canal - WhatsApp",value:"(34) 99893-6088"}),o.jsx(sm,{label:"Canal - E-mail",value:"fluxo7team@gmail.com"}),o.jsx(sm,{label:"Canal - Telefone",value:"(34) 99893-6088"})]})})]})})]}),o.jsx(ln,{open:j,onOpenChange:_,children:o.jsxs(on,{className:"max-w-2xl max-h-[85vh] overflow-y-auto",children:[o.jsx(nn,{children:o.jsxs(rn,{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-12 h-12 rounded-xl bg-brand/10 border border-brand/30 flex items-center justify-center",children:o.jsx(ri,{className:"w-6 h-6 text-brand"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-bold",children:"Como Instalar o F7 Arena"}),o.jsx("p",{className:"text-sm text-text-secondary font-normal",children:"Siga as instrues para o seu navegador"})]})]})}),o.jsxs("div",{className:"mt-6 space-y-6",children:[(C==="chrome"||C==="edge")&&o.jsxs("div",{className:"bg-gradient-to-br from-brand/10 to-brand/5 rounded-xl p-6 border-2 border-brand/30",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[o.jsx("div",{className:"w-10 h-10 rounded-lg bg-brand flex items-center justify-center",children:o.jsx($de,{className:"w-6 h-6 text-black"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold",children:"Chrome (Celular)"}),o.jsx("p",{className:"text-xs text-text-muted",children:"Siga os passos abaixo"})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:o.jsxs("div",{className:"flex gap-3 items-start",children:[o.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-brand text-black flex items-center justify-center font-bold",children:"1"}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("p",{className:"font-semibold mb-2",children:["Toque nos 3 pontinhos ",o.jsx("span",{className:"text-2xl",children:""})]}),o.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"No canto superior direito da tela"}),o.jsx("div",{className:"bg-background/50 rounded-md p-3 border border-border/50",children:o.jsx("p",{className:"text-xs text-text-muted",children:" Os 3 pontinhos ficam ao lado da barra de endereo"})})]})]})}),o.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:o.jsxs("div",{className:"flex gap-3 items-start",children:[o.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-brand text-black flex items-center justify-center font-bold",children:"2"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"font-semibold mb-3",children:"Procure uma destas opes:"}),o.jsxs("div",{className:"space-y-2 mb-3",children:[o.jsx("div",{className:"bg-brand/20 rounded-md p-3 border-2 border-brand/40",children:o.jsx("p",{className:"font-bold text-center text-base",children:' "Instalar aplicativo"'})}),o.jsxs("div",{className:"flex items-center justify-center gap-2 text-text-muted text-sm font-medium",children:[o.jsx("div",{className:"h-px bg-border flex-1"}),o.jsx("span",{children:"OU"}),o.jsx("div",{className:"h-px bg-border flex-1"})]}),o.jsx("div",{className:"bg-brand/20 rounded-md p-3 border-2 border-brand/40",children:o.jsx("p",{className:"font-bold text-center text-base",children:' "Adicionar  tela inicial"'})})]}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Toque em qualquer uma dessas opes no menu"})]})]})}),o.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:o.jsxs("div",{className:"flex gap-3 items-start",children:[o.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-brand text-black flex items-center justify-center font-bold",children:"3"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"font-semibold mb-2",children:"Confirme a instalao"}),o.jsx("p",{className:"text-sm text-text-secondary mb-3",children:"Aparecer uma janela perguntando se deseja instalar"}),o.jsx("div",{className:"bg-success/10 rounded-md p-3 border border-success/30",children:o.jsx("p",{className:"text-sm font-medium text-center",children:' Toque em "Instalar"'})})]})]})}),o.jsxs("div",{className:"bg-success/5 rounded-lg p-4 border border-success/20",children:[o.jsx("p",{className:"text-sm font-medium text-success mb-1",children:" Pronto!"}),o.jsx("p",{className:"text-xs text-text-secondary",children:"O app aparecer na sua tela inicial e voc poder abri-lo como qualquer outro aplicativo!"})]})]})]}),C==="firefox"&&o.jsxs("div",{className:"bg-gradient-to-br from-orange-500/10 to-orange-500/5 rounded-xl p-6 border-2 border-orange-500/30",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[o.jsx("div",{className:"w-10 h-10 rounded-lg bg-orange-500 flex items-center justify-center",children:o.jsx(tue,{className:"w-6 h-6 text-white"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold",children:"Firefox (Celular)"}),o.jsx("p",{className:"text-xs text-text-muted",children:"Siga os passos abaixo"})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:o.jsxs("div",{className:"flex gap-3 items-start",children:[o.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-orange-500 text-white flex items-center justify-center font-bold",children:"1"}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("p",{className:"font-semibold mb-2",children:["Toque nos 3 pontinhos ",o.jsx("span",{className:"text-2xl",children:""})]}),o.jsx("p",{className:"text-sm text-text-secondary",children:"No canto inferior direito da tela"})]})]})}),o.jsx("div",{className:"bg-surface rounded-lg p-4 border border-border",children:o.jsxs("div",{className:"flex gap-3 items-start",children:[o.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-orange-500 text-white flex items-center justify-center font-bold",children:"2"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"font-semibold mb-3",children:"Procure uma destas opes:"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("div",{className:"bg-orange-500/20 rounded-md p-3 border-2 border-orange-500/40",children:o.jsx("p",{className:"font-bold text-center text-base",children:' "Instalar"'})}),o.jsxs("div",{className:"flex items-center justify-center gap-2 text-text-muted text-sm font-medium",children:[o.jsx("div",{className:"h-px bg-border flex-1"}),o.jsx("span",{children:"OU"}),o.jsx("div",{className:"h-px bg-border flex-1"})]}),o.jsx("div",{className:"bg-orange-500/20 rounded-md p-3 border-2 border-orange-500/40",children:o.jsx("p",{className:"font-bold text-center text-base",children:' "Adicionar  tela inicial"'})})]})]})]})}),o.jsxs("div",{className:"bg-success/5 rounded-lg p-4 border border-success/20",children:[o.jsx("p",{className:"text-sm font-medium text-success mb-1",children:" Pronto!"}),o.jsx("p",{className:"text-xs text-text-secondary",children:"O app ser adicionado  sua tela inicial!"})]})]})]}),(C==="safari"||C==="other")&&o.jsxs("div",{className:"bg-gradient-to-br from-purple-500/10 to-purple-500/5 rounded-xl p-6 border-2 border-purple-500/30",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[o.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-500 flex items-center justify-center",children:o.jsx(pP,{className:"w-6 h-6 text-white"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold",children:"Outros Navegadores"}),o.jsx("p",{className:"text-xs text-text-muted",children:"Instrues gerais"})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"bg-surface rounded-lg p-4 border border-border",children:[o.jsx("p",{className:"font-semibold mb-3",children:"Procure no menu do navegador:"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("div",{className:"bg-purple-500/10 rounded-md p-3 border border-purple-500/30",children:o.jsx("p",{className:"font-medium",children:' "Instalar aplicativo"'})}),o.jsx("div",{className:"bg-purple-500/10 rounded-md p-3 border border-purple-500/30",children:o.jsx("p",{className:"font-medium",children:' "Adicionar  tela inicial"'})}),o.jsx("div",{className:"bg-purple-500/10 rounded-md p-3 border border-purple-500/30",children:o.jsx("p",{className:"font-medium",children:' "Criar atalho"'})})]})]}),o.jsx("div",{className:"bg-background/50 rounded-lg p-4 border border-border/50",children:o.jsx("p",{className:"text-sm text-text-muted",children:" Geralmente a opo est no menu de 3 pontos ou 3 linhas do navegador"})})]})]}),o.jsxs("div",{className:"bg-brand/5 rounded-lg p-4 border border-brand/20",children:[o.jsxs("h4",{className:"font-semibold mb-2 flex items-center gap-2",children:[o.jsx(e2,{className:"w-5 h-5 text-brand"}),"Benefcios do App Instalado"]}),o.jsxs("ul",{className:"space-y-1.5 text-sm text-text-secondary",children:[o.jsxs("li",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-brand"}),"Acesso rpido direto da rea de trabalho ou menu iniciar"]}),o.jsxs("li",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-brand"}),"Funciona em tela cheia, sem barras do navegador"]}),o.jsxs("li",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-brand"}),"Notificaes e atualizaes automticas"]}),o.jsxs("li",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-brand"}),"Melhor desempenho e experincia de uso"]})]})]}),o.jsx("div",{className:"flex justify-end",children:o.jsx("button",{onClick:()=>_(!1),className:"px-6 py-2.5 rounded-md bg-surface-2 hover:bg-surface text-text-primary font-medium transition",children:"Entendi"})})]})]})})]})}function Xae(e,t,r,n,a){n=n||{};var i=1.15,s=a.internal.scaleFactor,l=a.internal.getFontSize()/s,c=a.getLineHeightFactor?a.getLineHeightFactor():i,d=l*c,u=/\r\n|\r|\n/g,f="",m=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(f=typeof e=="string"?e.split(u):e,m=f.length||1),r+=l*(2-i),n.valign==="middle"?r-=m/2*d:n.valign==="bottom"&&(r-=m*d),n.halign==="center"||n.halign==="right"){var h=l;if(n.halign==="center"&&(h*=.5),f&&m>=1){for(var v=0;v<f.length;v++)a.text(f[v],t-a.getStringUnitWidth(f[v])*h,r),r+=d;return a}t-=a.getStringUnitWidth(e)*h}return n.halign==="justify"?a.text(e,t,r,{maxWidth:n.maxWidth||100,align:"justify"}):a.text(e,t,r),a}var oU={},Kv=function(){function e(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(t,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=t:oU=t},e.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},e.prototype.applyStyles=function(t,r){var n,a,i;r===void 0&&(r=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var s=this.jsPDFDocument.internal.getFont(),l=s.fontStyle,c=s.fontName;if(t.font&&(c=t.font),t.fontStyle){l=t.fontStyle;var d=this.getFontList()[c];d&&d.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(d[0]),l=d[0])}if(this.jsPDFDocument.setFont(c,l),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!r){var u=e.unifyColor(t.fillColor);u&&(n=this.jsPDFDocument).setFillColor.apply(n,u),u=e.unifyColor(t.textColor),u&&(a=this.jsPDFDocument).setTextColor.apply(a,u),u=e.unifyColor(t.lineColor),u&&(i=this.jsPDFDocument).setDrawColor.apply(i,u),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(t,r,n){return this.jsPDFDocument.splitTextToSize(t,r,n)},e.prototype.rect=function(t,r,n,a,i){return this.jsPDFDocument.rect(t,r,n,a,i)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return oU||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e}(),j4=function(e,t){return j4=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},j4(e,t)};function Jae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");j4(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Qae=function(e){Jae(t,e);function t(r){var n=e.call(this)||this;return n._element=r,n}return t}(Array);function Gat(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function Kat(e){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[e]}function eS(e,t,r){r.applyStyles(t,!0);var n=Array.isArray(e)?e:[e],a=n.map(function(i){return r.getTextWidth(i)}).reduce(function(i,s){return Math.max(i,s)},0);return a}function Zae(e,t,r,n){var a=t.settings.tableLineWidth,i=t.settings.tableLineColor;e.applyStyles({lineWidth:a,lineColor:i});var s=eoe(a,!1);s&&e.rect(r.x,r.y,t.getWidth(e.pageSize().width),n.y-r.y,s)}function eoe(e,t){var r=e>0,n=t||t===0;return r&&n?"DF":r?"S":n?"F":null}function P5(e,t){var r,n,a,i;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=t}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(r=e.left)!==null&&r!==void 0?r:t,top:(n=e.top)!==null&&n!==void 0?n:t,right:(a=e.right)!==null&&a!==void 0?a:t,bottom:(i=e.bottom)!==null&&i!==void 0?i:t}):(typeof e!="number"&&(e=t),{top:e,right:e,bottom:e,left:e})}function toe(e,t){var r=P5(t.settings.margin,0);return e.pageSize().width-(r.left+r.right)}function Yat(e,t,r,n,a){var i={},s=1.3333333333333333,l=yE(t,function(w){return a.getComputedStyle(w).backgroundColor});l!=null&&(i.fillColor=l);var c=yE(t,function(w){return a.getComputedStyle(w).color});c!=null&&(i.textColor=c);var d=Jat(n,r);d&&(i.cellPadding=d);var u="borderTopColor",f=s*r,m=n.borderTopWidth;if(n.borderBottomWidth===m&&n.borderRightWidth===m&&n.borderLeftWidth===m){var h=(parseFloat(m)||0)/f;h&&(i.lineWidth=h)}else i.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/f,right:(parseFloat(n.borderRightWidth)||0)/f,bottom:(parseFloat(n.borderBottomWidth)||0)/f,left:(parseFloat(n.borderLeftWidth)||0)/f},i.lineWidth.top||(i.lineWidth.right?u="borderRightColor":i.lineWidth.bottom?u="borderBottomColor":i.lineWidth.left&&(u="borderLeftColor"));var v=yE(t,function(w){return a.getComputedStyle(w)[u]});v!=null&&(i.lineColor=v);var g=["left","right","center","justify"];g.indexOf(n.textAlign)!==-1&&(i.halign=n.textAlign),g=["middle","bottom","top"],g.indexOf(n.verticalAlign)!==-1&&(i.valign=n.verticalAlign);var y=parseInt(n.fontSize||"");isNaN(y)||(i.fontSize=y/s);var x=Xat(n);x&&(i.fontStyle=x);var b=(n.fontFamily||"").toLowerCase();return e.indexOf(b)!==-1&&(i.font=b),i}function Xat(e){var t="";return(e.fontWeight==="bold"||e.fontWeight==="bolder"||parseInt(e.fontWeight)>=700)&&(t="bold"),(e.fontStyle==="italic"||e.fontStyle==="oblique")&&(t+="italic"),t}function yE(e,t){var r=roe(e,t);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var a=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],i=parseInt(n[4]);return i===0||isNaN(a[0])||isNaN(a[1])||isNaN(a[2])?null:a}function roe(e,t){var r=t(e);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?e.parentElement==null?null:roe(e.parentElement,t):r}function Jat(e,t){var r=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],n=96/(72/t),a=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,i=r.map(function(l){return parseInt(l||"0")/n}),s=P5(i,0);return a>s.top&&(s.top=a),a>s.bottom&&(s.bottom=a),s}function noe(e,t,r,n,a){var i,s;n===void 0&&(n=!1),a===void 0&&(a=!1);var l;typeof t=="string"?l=r.document.querySelector(t):l=t;var c=Object.keys(e.getFontList()),d=e.scaleFactor(),u=[],f=[],m=[];if(!l)return console.error("Html table could not be found with input: ",t),{head:u,body:f,foot:m};for(var h=0;h<l.rows.length;h++){var v=l.rows[h],g=(s=(i=v?.parentElement)===null||i===void 0?void 0:i.tagName)===null||s===void 0?void 0:s.toLowerCase(),y=Qat(c,d,r,v,n,a);y&&(g==="thead"?u.push(y):g==="tfoot"?m.push(y):f.push(y))}return{head:u,body:f,foot:m}}function Qat(e,t,r,n,a,i){for(var s=new Qae(n),l=0;l<n.cells.length;l++){var c=n.cells[l],d=r.getComputedStyle(c);if(a||d.display!=="none"){var u=void 0;i&&(u=Yat(e,c,t,d,r)),s.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:u,_element:c,content:Zat(c)})}}var f=r.getComputedStyle(n);if(s.length>0&&(a||f.display!=="none"))return s}function Zat(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),t.innerText||t.textContent||""}function eot(e,t,r){for(var n=0,a=[e,t,r];n<a.length;n++){var i=a[n];i&&typeof i!="object"&&console.error("The options parameter should be of type object, is: "+typeof i),i.startY&&typeof i.startY!="number"&&(console.error("Invalid value for startY option",i.startY),delete i.startY)}}function xf(e,t,r,n,a){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),s=1;s<arguments.length;s++){var l=arguments[s];if(l!=null)for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(i[c]=l[c])}return i}function rR(e,t){var r=new Kv(e),n=r.getDocumentOptions(),a=r.getGlobalOptions();eot(a,n,t);var i=xf({},a,n,t),s;typeof window<"u"&&(s=window);var l=tot(a,n,t),c=rot(a,n,t),d=not(r,i),u=oot(r,i,s);return{id:t.tableId,content:u,hooks:c,styles:l,settings:d}}function tot(e,t,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},a=function(c){if(c==="columnStyles"){var d=e[c],u=t[c],f=r[c];n.columnStyles=xf({},d,u,f)}else{var m=[e,t,r],h=m.map(function(v){return v[c]||{}});n[c]=xf({},h[0],h[1],h[2])}},i=0,s=Object.keys(n);i<s.length;i++){var l=s[i];a(l)}return n}function rot(e,t,r){for(var n=[e,t,r],a={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},i=0,s=n;i<s.length;i++){var l=s[i];l.didParseCell&&a.didParseCell.push(l.didParseCell),l.willDrawCell&&a.willDrawCell.push(l.willDrawCell),l.didDrawCell&&a.didDrawCell.push(l.didDrawCell),l.willDrawPage&&a.willDrawPage.push(l.willDrawPage),l.didDrawPage&&a.didDrawPage.push(l.didDrawPage)}return a}function not(e,t){var r,n,a,i,s,l,c,d,u,f,m,h,v=P5(t.margin,40/e.scaleFactor()),g=(r=aot(e,t.startY))!==null&&r!==void 0?r:v.top,y;t.showFoot===!0?y="everyPage":t.showFoot===!1?y="never":y=(n=t.showFoot)!==null&&n!==void 0?n:"everyPage";var x;t.showHead===!0?x="everyPage":t.showHead===!1?x="never":x=(a=t.showHead)!==null&&a!==void 0?a:"everyPage";var b=(i=t.useCss)!==null&&i!==void 0?i:!1,w=t.theme||(b?"plain":"striped"),j=!!t.horizontalPageBreak,_=(s=t.horizontalPageBreakRepeat)!==null&&s!==void 0?s:null;return{includeHiddenHtml:(l=t.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:b,theme:w,startY:g,margin:v,pageBreak:(c=t.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(d=t.rowPageBreak)!==null&&d!==void 0?d:"auto",tableWidth:(u=t.tableWidth)!==null&&u!==void 0?u:"auto",showHead:x,showFoot:y,tableLineWidth:(f=t.tableLineWidth)!==null&&f!==void 0?f:0,tableLineColor:(m=t.tableLineColor)!==null&&m!==void 0?m:200,horizontalPageBreak:j,horizontalPageBreakRepeat:_,horizontalPageBreakBehaviour:(h=t.horizontalPageBreakBehaviour)!==null&&h!==void 0?h:"afterAllRows"}}function aot(e,t){var r=e.getLastAutoTable(),n=e.scaleFactor(),a=e.pageNumber(),i=!1;if(r&&r.startPageNumber){var s=r.startPageNumber+r.pageNumber-1;i=s===a}return typeof t=="number"?t:(t==null||t===!1)&&i&&r?.finalY!=null?r.finalY+20/n:null}function oot(e,t,r){var n=t.head||[],a=t.body||[],i=t.foot||[];if(t.html){var s=t.includeHiddenHtml;if(r){var l=noe(e,t.html,r,s,t.useCss)||{};n=l.head||n,a=l.body||n,i=l.foot||n}else console.error("Cannot parse html in non browser environment")}var c=t.columns||iot(n,a,i);return{columns:c,head:n,body:a,foot:i}}function iot(e,t,r){var n=e[0]||t[0]||r[0]||[],a=[];return Object.keys(n).filter(function(i){return i!=="_element"}).forEach(function(i){var s=1,l;Array.isArray(n)?l=n[parseInt(i)]:l=n[i],typeof l=="object"&&!Array.isArray(l)&&(s=l?.colSpan||1);for(var c=0;c<s;c++){var d=void 0;Array.isArray(n)?d=a.length:d=i+(c>0?"_".concat(c):"");var u={dataKey:d};a.push(u)}}),a}var tS=function(){function e(t,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=t.getDocument()}return e}(),aoe=function(e){Jae(t,e);function t(r,n,a,i,s,l){var c=e.call(this,r,n,l)||this;return c.cell=a,c.row=i,c.column=s,c.section=i.section,c}return t}(tS),ooe=function(){function e(t,r){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return e.prototype.getHeadHeight=function(t){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.getFootHeight=function(t){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(t,r,n,a,i,s){for(var l=0,c=r;l<c.length;l++){var d=c[l],u=new aoe(t,this,n,a,i,s),f=d(u)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],f)return!1}return!0},e.prototype.callEndPageHooks=function(t,r){t.applyStyles(t.userStyles);for(var n=0,a=this.hooks.didDrawPage;n<a.length;n++){var i=a[n];i(new tS(t,this,r))}},e.prototype.callWillDrawPageHooks=function(t,r){for(var n=0,a=this.hooks.willDrawPage;n<a.length;n++){var i=a[n];i(new tS(t,this,r))}},e.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(a,i){return a+i.wrappedWidth},0);return r}else{var n=this.settings.margin;return t-n.left-n.right}},e}(),nR=function(){function e(t,r,n,a,i){i===void 0&&(i=!1),this.height=0,this.raw=t,t instanceof Qae&&(this.raw=t._element,this.element=t._element),this.index=r,this.section=n,this.cells=a,this.spansMultiplePages=i}return e.prototype.getMaxCellHeight=function(t){var r=this;return t.reduce(function(n,a){var i;return Math.max(n,((i=r.cells[a.index])===null||i===void 0?void 0:i.height)||0)},0)},e.prototype.hasRowSpan=function(t){var r=this;return t.filter(function(n){var a=r.cells[n.index];return a?a.rowSpan>1:!1}).length>0},e.prototype.canEntireRowFit=function(t,r){return this.getMaxCellHeight(r)<=t},e.prototype.getMinimumRowHeight=function(t,r){var n=this;return t.reduce(function(a,i){var s=n.cells[i.index];if(!s)return 0;var l=r.getLineHeight(s.styles.fontSize),c=s.padding("vertical"),d=c+l;return d>a?d:a},0)},e}(),aR=function(){function e(t,r,n){var a;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=t;var i=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,i=(a=t.content)!==null&&a!==void 0?a:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var s=i!=null?""+i:"",l=/\r\n|\r|\n/g;this.text=s.split(l)}return e.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");t=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var a=this.width-this.padding("horizontal");n=this.x+a/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:t}},e.prototype.getContentHeight=function(t,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,a=this.styles.fontSize/t*r,i=n*a+this.padding("vertical");return Math.max(i,this.styles.minCellHeight)},e.prototype.padding=function(t){var r=P5(this.styles.cellPadding,0);return t==="vertical"?r.top+r.bottom:t==="horizontal"?r.left+r.right:r[t]},e}(),ioe=function(){function e(t,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=r,this.index=n}return e.prototype.getMaxCustomCellWidth=function(t){for(var r=0,n=0,a=t.allRows();n<a.length;n++){var i=a[n],s=i.cells[this.index];s&&typeof s.styles.cellWidth=="number"&&(r=Math.max(r,s.styles.cellWidth))}return r},e}();function sot(e,t){lot(e,t);var r=[],n=0;t.columns.forEach(function(i){var s=i.getMaxCustomCellWidth(t);s?i.width=s:(i.width=i.wrappedWidth,r.push(i)),n+=i.width});var a=t.getWidth(e.pageSize().width)-n;a&&(a=N4(r,a,function(i){return Math.max(i.minReadableWidth,i.minWidth)})),a&&(a=N4(r,a,function(i){return i.minWidth})),a=Math.abs(a),!t.settings.horizontalPageBreak&&a>.1/e.scaleFactor()&&(a=a<1?a:Math.round(a),console.warn("Of the table content, ".concat(a," units width could not fit page"))),dot(t),uot(t,e),cot(t)}function lot(e,t){var r=e.scaleFactor(),n=t.settings.horizontalPageBreak,a=toe(e,t);t.allRows().forEach(function(i){for(var s=0,l=t.columns;s<l.length;s++){var c=l[s],d=i.cells[c.index];if(d){var u=t.hooks.didParseCell;t.callCellHooks(e,u,d,i,c,null);var f=d.padding("horizontal");d.contentWidth=eS(d.text,d.styles,e)+f;var m=eS(d.text.join(" ").split(/[^\S\u00A0]+/),d.styles,e);if(d.minReadableWidth=m+d.padding("horizontal"),typeof d.styles.cellWidth=="number")d.minWidth=d.styles.cellWidth,d.wrappedWidth=d.styles.cellWidth;else if(d.styles.cellWidth==="wrap"||n===!0)d.contentWidth>a?(d.minWidth=a,d.wrappedWidth=a):(d.minWidth=d.contentWidth,d.wrappedWidth=d.contentWidth);else{var h=10/r;d.minWidth=d.styles.minCellWidth||h,d.wrappedWidth=d.contentWidth,d.minWidth>d.wrappedWidth&&(d.wrappedWidth=d.minWidth)}}}}),t.allRows().forEach(function(i){for(var s=0,l=t.columns;s<l.length;s++){var c=l[s],d=i.cells[c.index];if(d&&d.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,d.wrappedWidth),c.minWidth=Math.max(c.minWidth,d.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,d.minReadableWidth);else{var u=t.styles.columnStyles[c.dataKey]||t.styles.columnStyles[c.index]||{},f=u.cellWidth||u.minCellWidth;f&&typeof f=="number"&&(c.minWidth=f,c.wrappedWidth=f)}d&&(d.colSpan>1&&!c.minWidth&&(c.minWidth=d.minWidth),d.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=d.minWidth))}})}function N4(e,t,r){for(var n=t,a=e.reduce(function(h,v){return h+v.wrappedWidth},0),i=0;i<e.length;i++){var s=e[i],l=s.wrappedWidth/a,c=n*l,d=s.width+c,u=r(s),f=d<u?u:d;t-=f-s.width,s.width=f}if(t=Math.round(t*1e10)/1e10,t){var m=e.filter(function(h){return t<0?h.width>r(h):!0});m.length&&(t=N4(m,t,r))}return t}function cot(e){for(var t={},r=1,n=e.allRows(),a=0;a<n.length;a++)for(var i=n[a],s=0,l=e.columns;s<l.length;s++){var c=l[s],d=t[c.index];if(r>1)r--,delete i.cells[c.index];else if(d)d.cell.height+=i.height,r=d.cell.colSpan,delete i.cells[c.index],d.left--,d.left<=1&&delete t[c.index];else{var u=i.cells[c.index];if(!u)continue;if(u.height=i.height,u.rowSpan>1){var f=n.length-a,m=u.rowSpan>f?f:u.rowSpan;t[c.index]={cell:u,left:m,row:i}}}}}function dot(e){for(var t=e.allRows(),r=0;r<t.length;r++)for(var n=t[r],a=null,i=0,s=0,l=0;l<e.columns.length;l++){var c=e.columns[l];if(s-=1,s>1&&e.columns[l+1])i+=c.width,delete n.cells[c.index];else if(a){var d=a;delete n.cells[c.index],a=null,d.width=c.width+i}else{var d=n.cells[c.index];if(!d)continue;if(s=d.colSpan,i=0,d.colSpan>1){a=d,i+=c.width;continue}d.width=c.width+i}}}function uot(e,t){for(var r={count:0,height:0},n=0,a=e.allRows();n<a.length;n++){for(var i=a[n],s=0,l=e.columns;s<l.length;s++){var c=l[s],d=i.cells[c.index];if(d){t.applyStyles(d.styles,!0);var u=d.width-d.padding("horizontal");if(d.styles.overflow==="linebreak")d.text=t.splitTextToSize(d.text,u+1/t.scaleFactor(),{fontSize:d.styles.fontSize});else if(d.styles.overflow==="ellipsize")d.text=iU(d.text,u,d.styles,t,"...");else if(d.styles.overflow==="hidden")d.text=iU(d.text,u,d.styles,t,"");else if(typeof d.styles.overflow=="function"){var f=d.styles.overflow(d.text,u);typeof f=="string"?d.text=[f]:d.text=f}d.contentHeight=d.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var m=d.contentHeight/d.rowSpan;d.rowSpan>1&&r.count*r.height<m*d.rowSpan?r={height:m,count:d.rowSpan}:r&&r.count>0&&r.height>m&&(m=r.height),m>i.height&&(i.height=m)}}r.count--}}function iU(e,t,r,n,a){return e.map(function(i){return fot(i,t,r,n,a)})}function fot(e,t,r,n,a){var i=1e4*n.scaleFactor();if(t=Math.ceil(t*i)/i,t>=eS(e,r,n))return e;for(;t<eS(e+a,r,n)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+a}function oR(e,t){var r=new Kv(e),n=mot(t,r.scaleFactor()),a=new ooe(t,n);return sot(r,a),r.applyStyles(r.userStyles),a}function mot(e,t){var r=e.content,n=pot(r.columns);if(r.head.length===0){var a=sU(n,"head");a&&r.head.push(a)}if(r.foot.length===0){var a=sU(n,"foot");a&&r.foot.push(a)}var i=e.settings.theme,s=e.styles;return{columns:n,head:bE("head",r.head,n,s,i,t),body:bE("body",r.body,n,s,i,t),foot:bE("foot",r.foot,n,s,i,t)}}function bE(e,t,r,n,a,i){var s={},l=t.map(function(c,d){for(var u=0,f={},m=0,h=0,v=0,g=r;v<g.length;v++){var y=g[v];if(s[y.index]==null||s[y.index].left===0)if(h===0){var x=void 0;Array.isArray(c)?x=c[y.index-m-u]:x=c[y.dataKey];var b={};typeof x=="object"&&!Array.isArray(x)&&(b=x?.styles||{});var w=got(e,y,d,a,n,i,b),j=new aR(x,w,e);f[y.dataKey]=j,f[y.index]=j,h=j.colSpan-1,s[y.index]={left:j.rowSpan-1,times:h}}else h--,m++;else s[y.index].left--,h=s[y.index].times,u++}return new nR(c,d,e,f)});return l}function sU(e,t){var r={};return e.forEach(function(n){if(n.raw!=null){var a=hot(t,n.raw);a!=null&&(r[n.dataKey]=a)}}),Object.keys(r).length>0?r:null}function hot(e,t){if(e==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(e==="foot"&&typeof t=="object")return t.footer;return null}function pot(e){return e.map(function(t,r){var n,a;return typeof t=="object"?a=(n=t.dataKey)!==null&&n!==void 0?n:r:a=r,new ioe(a,t,r)})}function got(e,t,r,n,a,i,s){var l=Kat(n),c;e==="head"?c=a.headStyles:e==="body"?c=a.bodyStyles:e==="foot"&&(c=a.footStyles);var d=xf({},l.table,l[e],a.styles,c),u=a.columnStyles[t.dataKey]||a.columnStyles[t.index]||{},f=e==="body"?u:{},m=e==="body"&&r%2===0?xf({},l.alternateRow,a.alternateRowStyles):{},h=Gat(i),v=xf({},h,d,m,f);return xf(v,s)}function vot(e,t,r){var n;r===void 0&&(r={});var a=toe(e,t),i=new Map,s=[],l=[],c=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?c=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(c=[t.settings.horizontalPageBreakRepeat]),c.forEach(function(m){var h=t.columns.find(function(v){return v.dataKey===m||v.index===m});h&&!i.has(h.index)&&(i.set(h.index,!0),s.push(h.index),l.push(t.columns[h.index]),a-=h.wrappedWidth)});for(var d=!0,u=(n=r?.start)!==null&&n!==void 0?n:0;u<t.columns.length;){if(i.has(u)){u++;continue}var f=t.columns[u].wrappedWidth;if(d||a>=f)d=!1,s.push(u),l.push(t.columns[u]),a-=f;else break;u++}return{colIndexes:s,columns:l,lastIndex:u-1}}function xot(e,t){for(var r=[],n=0;n<t.columns.length;n++){var a=vot(e,t,{start:n});a.columns.length&&(r.push(a),n=a.lastIndex)}return r}function iR(e,t){var r=t.settings,n=r.startY,a=r.margin,i={x:a.left,y:n},s=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),l=n+a.bottom+s;if(r.pageBreak==="avoid"){var c=t.body,d=c.reduce(function(m,h){return m+h.height},0);l+=d}var u=new Kv(e);(r.pageBreak==="always"||r.startY!=null&&l>u.pageSize().height)&&(loe(u),i.y=a.top),t.callWillDrawPageHooks(u,i);var f=xf({},i);t.startPageNumber=u.pageNumber(),r.horizontalPageBreak?yot(u,t,f,i):(u.applyStyles(u.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&t.head.forEach(function(m){return Rf(u,t,m,i,t.columns)}),u.applyStyles(u.userStyles),t.body.forEach(function(m,h){var v=h===t.body.length-1;rS(u,t,m,v,f,i,t.columns)}),u.applyStyles(u.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&t.foot.forEach(function(m){return Rf(u,t,m,i,t.columns)})),Zae(u,t,f,i),t.callEndPageHooks(u,i),t.finalY=i.y,e.lastAutoTable=t,u.applyStyles(u.userStyles)}function yot(e,t,r,n){var a=xot(e,t),i=t.settings;if(i.horizontalPageBreakBehaviour==="afterAllRows")a.forEach(function(d,u){e.applyStyles(e.userStyles),u>0?tb(e,t,r,n,d.columns,!0):lU(e,t,n,d.columns),bot(e,t,r,n,d.columns),wE(e,t,n,d.columns)});else for(var s=-1,l=a[0],c=function(){var d=s;if(l){e.applyStyles(e.userStyles);var u=l.columns;s>=0?tb(e,t,r,n,u,!0):lU(e,t,n,u),d=cU(e,t,s+1,n,u),wE(e,t,n,u)}var f=d-s;a.slice(1).forEach(function(m){e.applyStyles(e.userStyles),tb(e,t,r,n,m.columns,!0),cU(e,t,s+1,n,m.columns,f),wE(e,t,n,m.columns)}),s=d};s<t.body.length-1;)c()}function lU(e,t,r,n){var a=t.settings;e.applyStyles(e.userStyles),(a.showHead==="firstPage"||a.showHead==="everyPage")&&t.head.forEach(function(i){return Rf(e,t,i,r,n)})}function bot(e,t,r,n,a){e.applyStyles(e.userStyles),t.body.forEach(function(i,s){var l=s===t.body.length-1;rS(e,t,i,l,r,n,a)})}function cU(e,t,r,n,a,i){e.applyStyles(e.userStyles),i=i??t.body.length;var s=Math.min(r+i,t.body.length),l=-1;return t.body.slice(r,s).forEach(function(c,d){var u=r+d===t.body.length-1,f=soe(e,t,u,n);c.canEntireRowFit(f,a)&&(Rf(e,t,c,n,a),l=r+d)}),l}function wE(e,t,r,n){var a=t.settings;e.applyStyles(e.userStyles),(a.showFoot==="lastPage"||a.showFoot==="everyPage")&&t.foot.forEach(function(i){return Rf(e,t,i,r,n)})}function wot(e,t,r){var n=r.getLineHeight(e.styles.fontSize),a=e.padding("vertical"),i=Math.floor((t-a)/n);return Math.max(0,i)}function jot(e,t,r,n){var a={};e.spansMultiplePages=!0,e.height=0;for(var i=0,s=0,l=r.columns;s<l.length;s++){var c=l[s],d=e.cells[c.index];if(d){Array.isArray(d.text)||(d.text=[d.text]);var u=new aR(d.raw,d.styles,d.section);u=xf(u,d),u.text=[];var f=wot(d,t,n);d.text.length>f&&(u.text=d.text.splice(f,d.text.length));var m=n.scaleFactor(),h=n.getLineHeightFactor();d.contentHeight=d.getContentHeight(m,h),d.contentHeight>=t&&(d.contentHeight=t,u.styles.minCellHeight-=t),d.contentHeight>e.height&&(e.height=d.contentHeight),u.contentHeight=u.getContentHeight(m,h),u.contentHeight>i&&(i=u.contentHeight),a[c.index]=u}}var v=new nR(e.raw,-1,e.section,a,!0);v.height=i;for(var g=0,y=r.columns;g<y.length;g++){var c=y[g],u=v.cells[c.index];u&&(u.height=v.height);var d=e.cells[c.index];d&&(d.height=e.height)}return v}function Not(e,t,r,n){var a=e.pageSize().height,i=n.settings.margin,s=i.top+i.bottom,l=a-s;t.section==="body"&&(l-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=t.getMinimumRowHeight(n.columns,e),d=c<r;if(c>l)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!d)return!1;var u=t.hasRowSpan(n.columns),f=t.getMaxCellHeight(n.columns)>l;return f?(u&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(u||n.settings.rowPageBreak==="avoid")}function rS(e,t,r,n,a,i,s){var l=soe(e,t,n,i);if(r.canEntireRowFit(l,s))Rf(e,t,r,i,s);else if(Not(e,r,l,t)){var c=jot(r,l,t,e);Rf(e,t,r,i,s),tb(e,t,a,i,s),rS(e,t,c,n,a,i,s)}else tb(e,t,a,i,s),rS(e,t,r,n,a,i,s)}function Rf(e,t,r,n,a){n.x=t.settings.margin.left;for(var i=0,s=a;i<s.length;i++){var l=s[i],c=r.cells[l.index];if(!c){n.x+=l.width;continue}e.applyStyles(c.styles),c.x=n.x,c.y=n.y;var d=t.callCellHooks(e,t.hooks.willDrawCell,c,r,l,n);if(d===!1){n.x+=l.width;continue}_ot(e,c,n);var u=c.getTextPos();Xae(c.text,u.x,u.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,c,r,l,n),n.x+=l.width}n.y+=r.height}function _ot(e,t,r){var n=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),typeof n.lineWidth=="number"){var a=eoe(n.lineWidth,n.fillColor);a&&e.rect(t.x,r.y,t.width,t.height,a)}else typeof n.lineWidth=="object"&&(n.fillColor&&e.rect(t.x,r.y,t.width,t.height,"F"),Sot(e,t,r,n.lineWidth))}function Sot(e,t,r,n){var a,i,s,l;n.top&&(a=r.x,i=r.y,s=r.x+t.width,l=r.y,n.right&&(s+=.5*n.right),n.left&&(a-=.5*n.left),c(n.top,a,i,s,l)),n.bottom&&(a=r.x,i=r.y+t.height,s=r.x+t.width,l=r.y+t.height,n.right&&(s+=.5*n.right),n.left&&(a-=.5*n.left),c(n.bottom,a,i,s,l)),n.left&&(a=r.x,i=r.y,s=r.x,l=r.y+t.height,n.top&&(i-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.left,a,i,s,l)),n.right&&(a=r.x+t.width,i=r.y,s=r.x+t.width,l=r.y+t.height,n.top&&(i-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.right,a,i,s,l));function c(d,u,f,m,h){e.getDocument().setLineWidth(d),e.getDocument().line(u,f,m,h,"S")}}function soe(e,t,r,n){var a=t.settings.margin.bottom,i=t.settings.showFoot;return(i==="everyPage"||i==="lastPage"&&r)&&(a+=t.getFootHeight(t.columns)),e.pageSize().height-n.y-a}function tb(e,t,r,n,a,i){a===void 0&&(a=[]),i===void 0&&(i=!1),e.applyStyles(e.userStyles),t.settings.showFoot==="everyPage"&&!i&&t.foot.forEach(function(l){return Rf(e,t,l,n,a)}),t.callEndPageHooks(e,n);var s=t.settings.margin;Zae(e,t,r,n),loe(e),t.pageNumber++,n.x=s.left,n.y=s.top,r.y=s.top,t.callWillDrawPageHooks(e,n),t.settings.showHead==="everyPage"&&(t.head.forEach(function(l){return Rf(e,t,l,n,a)}),e.applyStyles(e.userStyles))}function loe(e){var t=e.pageNumber();e.setPage(t+1);var r=e.pageNumber();return r===t?(e.addPage(),!0):!1}function coe(e){e.API.autoTable=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t[0],a=rR(this,n),i=oR(this,a);return iR(this,i),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(t,r,n,a){Xae(t,r,n,a,this)},e.API.autoTableSetDefaults=function(t){return Kv.setDefaults(t,this),this},e.autoTableSetDefaults=function(t,r){Kv.setDefaults(t,r)},e.API.autoTableHtmlToJson=function(t,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var a=new Kv(this),i=noe(a,t,window,r,!1),s=i.head,l=i.body,c=((n=s[0])===null||n===void 0?void 0:n.map(function(d){return d.content}))||[];return{columns:c,rows:l,data:l}}}var jE;function dU(e,t){var r=rR(e,t),n=oR(e,r);iR(e,n)}function Cot(e,t){var r=rR(e,t);return oR(e,r)}function Pot(e,t){iR(e,t)}try{if(typeof window<"u"&&window){var uU=window,fU=uU.jsPDF||((jE=uU.jspdf)===null||jE===void 0?void 0:jE.jsPDF);fU&&coe(fU)}}catch(e){console.error("Could not apply autoTable plugin",e)}const Aot=Object.freeze(Object.defineProperty({__proto__:null,Cell:aR,CellHookData:aoe,Column:ioe,HookData:tS,Row:nR,Table:ooe,__createTable:Cot,__drawTable:Pot,applyPlugin:coe,autoTable:dU,default:dU},Symbol.toStringTag,{value:"Module"})),Eot={hidden:{opacity:0},visible:{opacity:1,transition:{when:"beforeChildren",staggerChildren:.08,delayChildren:.1}}},tl={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}};function Y2({icon:e,label:t,value:r,delta:n,positive:a=!0,color:i="brand"}){return o.jsxs(fr.div,{variants:tl,className:"fx-card border-0 ring-0 outline-none shadow-none",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider",children:[o.jsx(e,{className:`w-4 h-4 text-${i}`}),o.jsx("span",{children:t})]}),n!=null&&o.jsxs("div",{className:`text-xs font-bold ${a?"text-success":"text-danger"}`,children:[a?"+":"",n]})]}),o.jsx("div",{className:"text-3xl font-bold text-text-primary tabular-nums",children:r})]})}function kot(){const{toast:e}=oo(),{userProfile:t}=Do(),[r,n]=NS(),[a,i]=p.useState(r.get("tab")||"visao-geral"),[s,l]=p.useState(!1),[c,d]=p.useState(()=>{const H=new Date;return new Date(H.getFullYear(),H.getMonth(),1).toISOString().slice(0,10)}),[u,f]=p.useState(()=>new Date().toISOString().slice(0,10)),[m,h]=p.useState(null),[v,g]=p.useState(0),[y,x]=p.useState(0),[b,w]=p.useState([]),[j,_]=p.useState([]),[C,E]=p.useState([]),[P,k]=p.useState([]),[M,S]=p.useState([]),[I,T]=p.useState(0),[D,B]=p.useState(0),[U,z]=p.useState(!1),[$,Y]=p.useState(!1),[de,xe]=p.useState(null),[q,L]=p.useState([]),[W,ne]=p.useState(!1),[le,K]=p.useState(!1),[Q,re]=p.useState(!1),[G,me]=p.useState(null),[pe,Be]=p.useState([]),[Z,ee]=p.useState([]);p.useState({open:!1,tipo:"suprimento",valor:"",observacao:"",loading:!1});const[kt,Nt]=p.useState(!1),[De,st]=p.useState(!1),[ft,yt]=p.useState(null),[Nr,se]=p.useState([]),[rt,mt]=p.useState(""),[tr,Ce]=p.useState("all"),[je,ae]=p.useState("all"),[$e,Ae]=p.useState([]),[Tt,Se]=p.useState(""),[Ne,Ue]=p.useState("all"),[Qe,et]=p.useState("all"),[pt,Ke]=p.useState(new Set),[qt,lt]=p.useState(!1),[rr,nt]=p.useState(!1),[$t,Qr]=p.useState(null),[Xr,In]=p.useState([]),[sn,Qt]=p.useState(!1),[qr,Tr]=p.useState([]);p.useState("");const sr=H=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(H||0)),$r=H=>Number(H||0).toFixed(2),Gr=async(H,Ee,Te,vt)=>{try{const{default:ze}=await Ou(()=>Promise.resolve().then(()=>sQe),void 0);await Ou(()=>Promise.resolve().then(()=>Aot),void 0);const at=new ze("p","mm","a4"),Zt=at.internal.pageSize.getWidth();if(at.setFontSize(20),at.setTextColor(245,158,11),at.text(H,14,20),at.setDrawColor(245,158,11),at.setLineWidth(.5),at.line(14,23,Zt-14,23),at.setFontSize(10),at.setTextColor(100,100,100),at.text(`Perodo: ${c||"N/A"} at ${u||"N/A"}`,14,30),at.text(`Gerado em: ${new Date().toLocaleString("pt-BR")}`,14,35),typeof at.autoTable=="function"){at.autoTable({head:[Ee],body:Te,startY:42,theme:"striped",headStyles:{fillColor:[245,158,11],textColor:[255,255,255],fontStyle:"bold",fontSize:11},bodyStyles:{fontSize:10,textColor:[50,50,50]},alternateRowStyles:{fillColor:[249,249,249]},margin:{top:42,left:14,right:14}});const zr=at.lastAutoTable.finalY||50;at.setFontSize(8),at.setTextColor(150,150,150),at.text("Relatrio gerado por Fluxo7Arena - Sistema de Gesto de Quadras Esportivas",Zt/2,zr+15,{align:"center"})}else{let zr=45;at.setFontSize(11),at.setTextColor(0,0,0),Ee.forEach((Ar,br)=>{const yr=14+br*60;at.text(Ar,yr,zr)}),zr+=7,at.setFontSize(10),Te.forEach(Ar=>{Ar.forEach((br,yr)=>{const nr=14+yr*60;at.text(String(br),nr,zr)}),zr+=6})}at.save(`${vt}_${Jt(new Date,"yyyy-MM-dd")}.pdf`),e({title:"PDF baixado com sucesso!",description:"O arquivo foi salvo na sua pasta de downloads"})}catch(ze){console.error("Erro ao gerar PDF:",ze),e({title:"Erro ao gerar PDF",description:ze.message,variant:"destructive"})}},ke=async()=>{try{const H=["Abertura","Fechamento","Saldo Inicial","Saldo Final","Valor Final (Dinheiro)","Diferena","Status"],Ee=(Z||[]).map(Te=>[Te?.aberto_em?new Date(Te.aberto_em).toLocaleString("pt-BR"):"-",Te?.fechado_em?new Date(Te.fechado_em).toLocaleString("pt-BR"):"-",sr(Te?.saldo_inicial||0),Te?.saldo_final!=null?sr(Te.saldo_final):sr(0),Te?.valor_final_dinheiro!=null?sr(Te.valor_final_dinheiro):"",Te?.diferenca_dinheiro!=null?sr(Te.diferenca_dinheiro):"",String(Te?.status||"").toUpperCase()]);await Gr("Fechamentos de Caixa",H,Ee,"fechamentos_caixa")}catch(H){e({title:"Erro ao exportar PDF",description:H?.message||"Tente novamente",variant:"destructive"})}},Mt=()=>{try{const H=";",Te=[["Abertura","Fechamento","Saldo Inicial","Saldo Final","Valor Final (Dinheiro)","Diferena","Status"].join(H)];(Z||[]).forEach(Zt=>{const zr=Zt?.aberto_em?new Date(Zt.aberto_em).toLocaleString("pt-BR"):"-",Ar=Zt?.fechado_em?new Date(Zt.fechado_em).toLocaleString("pt-BR"):"-",br=Number(Zt?.saldo_inicial||0).toFixed(2).replace(".",","),yr=(Zt?.saldo_final!=null?Number(Zt.saldo_final):0).toFixed(2).replace(".",","),nr=Zt?.valor_final_dinheiro!=null?Number(Zt.valor_final_dinheiro):null,Zr=Zt?.diferenca_dinheiro!=null?Number(Zt.diferenca_dinheiro):null,tt=String(Zt?.status||"").toUpperCase();Te.push([zr,Ar,br,yr,nr!=null?nr.toFixed(2).replace(".",","):"",Zr!=null?Zr.toFixed(2).replace(".",","):"",tt].join(H))});const vt=new Blob(["\uFEFF"+Te.join(`
`)],{type:"text/csv;charset=utf-8;"}),ze=URL.createObjectURL(vt),at=document.createElement("a");at.href=ze,at.download=`fechamentos_caixa_${new Date().toISOString().slice(0,10)}.csv`,document.body.appendChild(at),at.click(),document.body.removeChild(at),URL.revokeObjectURL(ze),e({title:"CSV baixado com sucesso!"})}catch(H){e({title:"Erro ao exportar CSV",description:H?.message||"Tente novamente",variant:"destructive"})}},wr=({cx:H,cy:Ee,midAngle:Te,outerRadius:vt,percent:ze})=>{const at=Math.PI/180,Zt=(vt||0)+12,zr=H+Zt*Math.cos(-Te*at),Ar=Ee+Zt*Math.sin(-Te*at);return o.jsx("text",{x:zr,y:Ar,fill:"#fff",textAnchor:zr>H?"start":"end",dominantBaseline:"central",style:{pointerEvents:"none",fontSize:15,fontWeight:700},children:`${Math.round((ze||0)*100)}%`})},Fr=H=>{const Ee=dr!=null&&dr!==H;return{transition:"opacity 320ms ease-in-out, filter 320ms ease-in-out",opacity:Ee?.25:1,filter:Ee?"grayscale(15%)":"none",cursor:"pointer"}};p.useEffect(()=>{(async()=>{if(!rr||!$t||$t.origem!=="Comanda"||!$t.comanda_id){In([]),Tr([]);return}try{Qt(!0);const Ee=t?.codigo_empresa;let Te=ve.from("comanda_itens").select("descricao, quantidade, preco_unitario").eq("comanda_id",$t.comanda_id);Ee&&(Te=Te.eq("codigo_empresa",Ee));const{data:vt}=await Te;In(vt||[]);let ze=ve.from("pagamentos").select("id, valor, metodo, status, finalizadoras!pagamentos_finalizadora_id_fkey(nome)").eq("comanda_id",$t.comanda_id);Ee&&(ze=ze.eq("codigo_empresa",Ee));const{data:at}=await ze;Tr(at||[])}catch(Ee){console.warn("[Financeiro][RecebimentoModal] Falha ao carregar itens da comanda:",Ee?.message),In([]),Tr([])}finally{Qt(!1)}})()},[rr,$t,t?.codigo_empresa]);const Ur=async()=>{try{l(!0);const H=va(c)||void 0,Ee=xa(u)||void 0,Te=t?.codigo_empresa;console.debug("[Financeiro][VisaoGeral] Carregando com perodo:",{fromISO:H,toISO:Ee,codigo:Te});const vt=await nd({from:H,to:Ee}).catch(()=>null);h(vt||{totalPorFinalizadora:{},totalEntradas:0,totalVendasBrutas:0,totalDescontos:0,totalVendasLiquidas:0}),console.debug("[Financeiro][VisaoGeral] Resumo calculado:",vt);try{let ze=ve.from("pagamentos").select("valor, status").eq("codigo_empresa",Te);H&&(ze=ze.gte("recebido_em",H)),Ee&&(ze=ze.lte("recebido_em",Ee));const{data:at}=await ze,Zt=(at||[]).reduce((yr,nr)=>{const Zr=nr.status||"Pago";return Zr==="Cancelado"||Zr==="Estornado"?yr:yr+Number(nr.valor||0)},0);g(Zt);let zr=ve.from("agendamentos").select("id").eq("codigo_empresa",Te);H&&(zr=zr.gte("inicio",H)),Ee&&(zr=zr.lte("inicio",Ee));const{data:Ar}=await zr;let br=0;if(Ar&&Ar.length>0){const yr=Ar.map(Zr=>Zr.id),{data:nr}=await ve.from("agendamento_participantes").select("valor_cota, aplicar_taxa, finalizadoras!agp_finalizadora_id_fkey(taxa_percentual)").eq("codigo_empresa",Te).in("agendamento_id",yr).eq("status_pagamento","Pago");br=(nr||[]).reduce((Zr,tt)=>{let Lr=Number(tt.valor_cota||0);if(tt.aplicar_taxa===!0){const cn=Number(tt.finalizadoras?.taxa_percentual||0);cn>0&&(Lr=Lr/(1+cn/100))}return Zr+Lr},0)}x(br),console.debug("[Financeiro][VisaoGeral] Receitas por origem:",{totalComandas:Zt,totalAg:br})}catch(ze){console.warn("[Financeiro][VisaoGeral] Falha ao calcular KPIs por origem:",ze?.message),g(0),x(0)}try{let ze=ve.from("pagamentos").select("valor, status, origem").eq("codigo_empresa",Te).eq("origem","xml");H&&(ze=ze.gte("recebido_em",H)),Ee&&(ze=ze.lte("recebido_em",Ee));const{data:at}=await ze,Zt=(at||[]).reduce((Ar,br)=>["Cancelado","Estornado"].includes(br.status)?Ar:Ar+Number(br.valor||0),0);T(Zt);const{count:zr}=await ve.from("produtos").select("id",{count:"exact",head:!0}).eq("codigo_empresa",Te).or("importado_via_xml.is.true,categoria.ilike.Importados").gte("criado_em",H).lte("criado_em",Ee);B(zr||0)}catch(ze){console.warn("[Financeiro][VisaoGeral] Falha KPIs XML:",ze?.message),T(0),B(0)}if(Te){let ze=ve.from("comandas").select("id").eq("status","closed");Te&&(ze=ze.eq("codigo_empresa",Te)),H&&(ze=ze.gte("fechado_em",H)),Ee&&(ze=ze.lte("fechado_em",Ee));const{data:at,error:Zt}=await ze;if(Zt)throw Zt;const zr=(at||[]).map(nr=>nr.id);console.debug("[Financeiro][VisaoGeral] Comandas fechadas:",zr.length);let Ar=[];if(zr.length>0){let nr=ve.from("comanda_itens").select("produto_id, quantidade, preco_unitario, produtos!comanda_itens_produto_id_fkey(nome)").in("comanda_id",zr);Te&&(nr=nr.eq("codigo_empresa",Te));const{data:Zr}=await nr;Ar=Zr||[]}const br={};(Ar||[]).forEach(nr=>{const Zr=nr.produtos?.nome||"Produto sem nome",tt=Number(nr.quantidade||0),Lr=tt*Number(nr.preco_unitario||0);br[Zr]||(br[Zr]={quantidade:0,valor:0}),br[Zr].quantidade+=tt,br[Zr].valor+=Lr});const yr=Object.entries(br).map(([nr,Zr])=>({nome:nr,quantidade:Zr.quantidade,valor:Zr.valor})).sort((nr,Zr)=>Zr.valor-nr.valor);E(yr),w(yr.slice(0,5)),console.debug("[Financeiro][VisaoGeral] Produtos agregados:",{total:yr.length,top5:yr.slice(0,5)})}if(Te)try{let ze=ve.from("pagamentos").select("comanda_id, valor, status").eq("codigo_empresa",Te).neq("status","Cancelado").neq("status","Estornado");H&&(ze=ze.gte("recebido_em",H)),Ee&&(ze=ze.lte("recebido_em",Ee));const{data:at}=await ze;console.debug("[Financeiro][VisaoGeral] Pagamentos carregados:",(at||[]).length);const Zt=Array.from(new Set((at||[]).map(tt=>tt.comanda_id).filter(Boolean)));let zr=[];if(Zt.length>0){let tt=ve.from("comanda_clientes").select("comanda_id, cliente_id, nome_livre").in("comanda_id",Zt).eq("codigo_empresa",Te);const{data:Lr}=await tt;zr=Lr||[]}console.debug("[Financeiro][VisaoGeral] Vinculos comanda_clientes:",zr.length);const Ar=Array.from(new Set(zr.map(tt=>tt.cliente_id).filter(Boolean))),br={};if(Ar.length>0){const{data:tt}=await ve.from("clientes").select("id, nome").in("id",Ar).eq("codigo_empresa",Te);(tt||[]).forEach(Lr=>{br[Lr.id]=Lr.nome})}const yr={};zr.forEach(tt=>{const Lr=tt.nome_livre||br[tt.cliente_id]||`Cliente ${tt.cliente_id||""}`;yr[tt.comanda_id]||(yr[tt.comanda_id]=new Set),Lr&&yr[tt.comanda_id].add(Lr)});const nr={};(at||[]).forEach(tt=>{const Lr=Array.from(yr[tt.comanda_id]||[]),cn=Number(tt.valor||0);if(Lr.length===0){const pn="Sem cliente";nr[pn]||(nr[pn]={id:null,nome:pn,valor:0}),nr[pn].valor+=cn}else Lr.forEach(pn=>{nr[pn]||(nr[pn]={id:null,nome:pn,valor:0}),nr[pn].valor+=cn})});try{const tt=new Map(Object.values(br).map((Bn,ya)=>[Object.keys(br)[ya],Bn]));let Lr=ve.from("v_agendamento_participantes").select("agendamento_id, cliente_id, valor_cota, status_pagamento, status_pagamento_text");Te&&(Lr=Lr.eq("codigo_empresa",Te));let{data:cn}=await Lr;cn=cn||[];const pn=Array.from(new Set(cn.map(Bn=>Bn.agendamento_id).filter(Boolean)));let jn=new Set;if(pn.length>0){let Bn=ve.from("agendamentos").select("id, inicio").in("id",pn);Te&&(Bn=Bn.eq("codigo_empresa",Te));const{data:ya}=await Bn,an=H?new Date(H).getTime():null,Ea=Ee?new Date(Ee).getTime():null;(ya||[]).forEach(Sa=>{const ba=Sa?.inicio?new Date(Sa.inicio).getTime():null;ba!=null&&(an==null||ba>=an)&&(Ea==null||ba<=Ea)&&jn.add(Sa.id)})}const Gn=cn.filter(Bn=>jn.has(Bn.agendamento_id));console.debug("[Financeiro][Agendamentos] participantes no perodo (by agendamento.inicio):",Gn.length);const aa=Array.from(new Set((Gn||[]).map(Bn=>Bn.cliente_id).filter(Boolean).map(String))).filter(Bn=>!tt.has(Bn));if(aa.length>0){const{data:Bn}=await ve.from("clientes").select("id,nome").in("id",aa);(Bn||[]).forEach(ya=>tt.set(String(ya.id),ya.nome))}(Gn||[]).forEach(Bn=>{const ya=String(Bn.status_pagamento||Bn.status_pagamento_text||"pago").toLowerCase();if(["cancelado","estornado"].includes(ya))return;const an=Bn.cliente_id,Ea=an?tt.get(String(an))||`Cliente ${an}`:null;if(!Ea)return;const Sa=Number(Bn.valor_cota||0);nr[Ea]||(nr[Ea]={id:an||null,nome:Ea,valor:0}),nr[Ea].valor+=Sa})}catch{}const Zr=Object.values(nr).sort((tt,Lr)=>Lr.valor-tt.valor);k(Zr),_(Zr.slice(0,5)),console.debug("[Financeiro][VisaoGeral] Clientes agregados:",{total:Zr.length,top5:Zr.slice(0,5)})}catch(ze){console.error("Erro ao carregar top clientes:",ze),_([]),k([])}if(Te&&H&&Ee)try{let ze=ve.from("pagamentos").select("recebido_em, valor, status").eq("codigo_empresa",Te).gte("recebido_em",H).lte("recebido_em",Ee).order("recebido_em",{ascending:!0});const{data:at}=await ze;let Zt=ve.from("v_agendamentos_detalhado").select("inicio, valor_pago, status_pagamento").eq("codigo_empresa",Te).eq("status_pagamento","Pago").gte("inicio",H).lte("inicio",Ee).order("inicio",{ascending:!0});const{data:zr}=await Zt,Ar={};(at||[]).forEach(yr=>{if(["Cancelado","Estornado"].includes(yr.status))return;const nr=new Date(yr.recebido_em).toLocaleDateString("pt-BR");Ar[nr]=(Ar[nr]||0)+Number(yr.valor||0)}),(zr||[]).forEach(yr=>{const nr=new Date(yr.inicio).toLocaleDateString("pt-BR");Ar[nr]=(Ar[nr]||0)+Number(yr.valor_pago||0)});const br=Object.entries(Ar).map(([yr,nr])=>({data:yr,valor:nr})).sort((yr,nr)=>{const[Zr,tt,Lr]=yr.data.split("/").map(Number),[cn,pn,jn]=nr.data.split("/").map(Number);return new Date(Lr,tt-1,Zr).getTime()-new Date(jn,pn-1,cn).getTime()});S(br),console.debug("[Financeiro][VisaoGeral] Evoluo diria:",br.length,"dias")}catch(ze){console.warn("[Financeiro][VisaoGeral] Falha ao calcular evoluo diria:",ze?.message),S([])}else S([])}catch(H){e({title:"Falha ao carregar viso geral",description:H?.message||"Tente novamente",variant:"destructive"})}finally{l(!1)}},Kr=async()=>{try{const H=t?.codigo_empresa,Ee=await km({codigoEmpresa:H});if(re(!!Ee),Ee){const[vt,ze]=await Promise.all([g1({codigoEmpresa:H}),Op({caixaSessaoId:Ee.id,codigoEmpresa:H})]);me(vt||null),Be(ze||[])}else me(null),Be([]);const Te=await Ute({limit:50,codigoEmpresa:H});if(console.log("[FinanceiroPage][loadCaixa] Histrico recebido de listarFechamentosCaixa:",Te?.length,"sesses"),Te&&Te.length>0){console.log("[FinanceiroPage][loadCaixa] Primeira sesso do histrico:",Te[0]);const vt=Te.filter(ze=>ze.valor_final_dinheiro!=null);console.log("[FinanceiroPage][loadCaixa] Sesses com valor_final_dinheiro:",vt.length,"/",Te.length)}ee(Te||[])}catch(H){e({title:"Falha ao carregar caixa",description:H?.message,variant:"destructive"})}},dn=async()=>{try{l(!0);const H=t?.codigo_empresa,Ee=va(c)||void 0,Te=xa(u)||void 0;let vt=ve.from("pagamentos").select("id, comanda_id, valor, status, metodo, recebido_em, origem, xml_chave, finalizadoras!pagamentos_finalizadora_id_fkey(nome)").eq("codigo_empresa",H).order("recebido_em",{ascending:!1});Ee&&(vt=vt.gte("recebido_em",Ee)),Te&&(vt=vt.lte("recebido_em",Te));const{data:ze}=await vt;let at=new Map,Zt=new Map;try{const nr=Array.from(new Set((ze||[]).map(Zr=>Zr.comanda_id).filter(Boolean)));if(nr.length>0){const{data:Zr}=await ve.from("comandas").select("id, cliente_id, tipo").in("id",nr).eq("codigo_empresa",H),tt=Array.from(new Set((Zr||[]).map(pn=>pn.cliente_id).filter(Boolean)));let Lr=new Map;if(tt.length>0){const{data:pn}=await ve.from("clientes").select("id, nome").in("id",tt).eq("codigo_empresa",H);Lr=new Map((pn||[]).map(jn=>[jn.id,jn.nome]))}for(const pn of Zr||[]){if(!pn)continue;const jn=Lr.get(pn.cliente_id)||null;at.set(pn.id,jn),Zt.set(pn.id,pn.tipo||null)}const cn=(Zr||[]).filter(pn=>!pn?.cliente_id).map(pn=>pn.id);if(cn.length>0)try{const{data:pn}=await ve.from("comanda_clientes").select("comanda_id, cliente_id").in("comanda_id",cn).eq("codigo_empresa",H),jn=Array.from(new Set((pn||[]).map(Gn=>Gn.cliente_id).filter(Boolean)));if(jn.length>0){const{data:Gn}=await ve.from("clientes").select("id, nome").in("id",jn).eq("codigo_empresa",H),Ln=new Map((Gn||[]).map(aa=>[aa.id,aa.nome]));for(const aa of pn||[]){const Bn=Ln.get(aa.cliente_id)||null;Bn&&!at.get(aa.comanda_id)&&at.set(aa.comanda_id,Bn)}}}catch{console.debug("[Financeiro][Recebimentos] comanda_clientes indisponvel (ok)")}}}catch(nr){console.warn("[Financeiro][Recebimentos] Falha ao buscar clientes de comandas:",nr?.message)}let zr=ve.from("v_agendamentos_detalhado").select("agendamento_id, agendamento_codigo, inicio, quadra_nome, participante_nome, valor_cota, status_pagamento, finalizadora_nome").eq("codigo_empresa",H).eq("status_pagamento","Pago").order("inicio",{ascending:!1});Ee&&(zr=zr.gte("inicio",Ee)),Te&&(zr=zr.lte("inicio",Te));const{data:Ar}=await zr,br=(ze||[]).map(nr=>({id:nr.id,origem:Zt.get(nr.comanda_id||"")==="balcao"?"Balco":"Comanda",comanda_id:nr.comanda_id||null,recebido_em:nr.recebido_em,finalizadoras:nr.finalizadoras,metodo:nr.metodo,valor:nr.valor,status:nr.status,descricao:at.get(nr.comanda_id||"")||null,fonte:nr.origem||"manual",xml_chave:nr.xml_chave||null})),yr=(Ar||[]).map((nr,Zr)=>({id:`ag-${nr.agendamento_id}-${Zr}`,origem:"Agendamento",recebido_em:nr.inicio,finalizadoras:nr.finalizadora_nome?{nome:nr.finalizadora_nome}:null,metodo:nr.finalizadora_nome||null,valor:nr.valor_cota,status:nr.status_pagamento,descricao:`#${nr.agendamento_codigo} - ${nr.participante_nome} (${nr.quadra_nome||""})`,agendamento_codigo:nr.agendamento_codigo,quadra_nome:nr.quadra_nome,participante_nome:nr.participante_nome,fonte:null}));se([...br,...yr])}catch(H){e({title:"Falha ao carregar recebimentos",description:H?.message,variant:"destructive"})}finally{l(!1)}},wn=async()=>{try{l(!0);const H=t?.codigo_empresa,Ee=va(c)||void 0,Te=xa(u)||void 0;let vt=ve.from("v_agendamentos_detalhado").select("agendamento_id, agendamento_codigo, inicio, fim, quadra_nome, participante_nome, cliente_id, valor_cota, finalizadora_nome, status_pagamento").eq("codigo_empresa",H).order("inicio",{ascending:!1});Ee&&(vt=vt.gte("inicio",Ee)),Te&&(vt=vt.lte("inicio",Te));const{data:ze}=await vt,at=[...new Set((ze||[]).map(Ar=>Ar.cliente_id).filter(Boolean))];let Zt={};if(at.length>0){const{data:Ar}=await ve.from("clientes").select("id, is_consumidor_final, codigo").in("id",at).eq("codigo_empresa",H);Ar&&(Zt=Object.fromEntries(Ar.map(br=>[br.id,br])))}const zr=(ze||[]).map(Ar=>({...Ar,is_consumidor_final:Zt[Ar.cliente_id]?.is_consumidor_final||!1,cliente_codigo:Zt[Ar.cliente_id]?.codigo||null}));Ae(zr)}catch(H){e({title:"Falha ao carregar agendamentos",description:H?.message,variant:"destructive"})}finally{l(!1)}};p.useEffect(()=>{n({tab:a})},[a]);const va=H=>{if(!H)return null;if(typeof H=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(H)){const[Ee,Te,vt]=H.split("-").map(Number);return new Date(Ee,Te-1,vt,0,0,0,0).toISOString()}return new Date(H).toISOString()},xa=H=>{if(!H)return null;if(typeof H=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(H)){const[Ee,Te,vt]=H.split("-").map(Number);return new Date(Ee,Te-1,vt,23,59,59,999).toISOString()}return new Date(H).toISOString()};p.useEffect(()=>{t?.codigo_empresa&&(a==="visao-geral"||a==="relatorios"?Ur():a==="caixa"?Kr():a==="recebimentos"?dn():a==="agendamentos"&&wn())},[a,c,u,t?.codigo_empresa]);const Aa=p.useMemo(()=>{const H=m?.totalPorFinalizadora||{},Ee=Object.entries(H).map(([Te,vt])=>({name:Te,valor:Number(vt||0)}));return Ee.sort((Te,vt)=>vt.valor-Te.valor),Ee},[m]),[ut,Ht]=p.useState(null),[dr,Ft]=p.useState(null),Ot={start:90,end:-270},Br=(H,Ee,Te)=>H+(Ee-H)*Te,Vt=H=>H<.5?4*H*H*H:1-Math.pow(-2*H+2,3)/2,Cr=H=>{const Ee=Number(v||0),Te=Number(y||0),vt=Math.max(1e-4,Ee+Te),ze=360*(Ee/vt);return H===0?{a:Ot.start,b:Ot.start-ze}:{a:Ot.start-ze,b:Ot.end}},[ct,Gt]=p.useState({from:null,to:null,t:1}),gr=dr??ut;p.useEffect(()=>{if(gr==null)return;const H=Cr(gr);Gt(at=>({from:at.to||H,to:H,t:0}));let Ee;const Te=performance.now(),vt=380,ze=at=>{const Zt=Math.min(1,(at-Te)/vt),zr=Vt(Zt);Gt(Ar=>({...Ar,t:zr})),Zt<1&&(Ee=requestAnimationFrame(ze))};return Ee=requestAnimationFrame(ze),()=>Ee&&cancelAnimationFrame(Ee)},[gr,v,y]);const J=86,Ye=94,Xe=80,[it,Ze]=p.useState({from:[J,J],to:[J,J],t:1});p.useEffect(()=>{const H=gr===0?[Ye,Xe]:gr===1?[Xe,Ye]:[J,J];Ze(at=>({from:at.to||H,to:H,t:0}));let Ee;const Te=performance.now(),vt=380,ze=at=>{const Zt=Math.min(1,(at-Te)/vt),zr=Vt(Zt);Ze(Ar=>({...Ar,t:zr})),Zt<1&&(Ee=requestAnimationFrame(ze))};return Ee=requestAnimationFrame(ze),()=>Ee&&cancelAnimationFrame(Ee)},[gr]);const dt=({cx:H,cy:Ee,outerRadius:Te})=>{if(!ct.from||!ct.to)return null;const vt=Br(ct.from.a,ct.to.a,ct.t),ze=Br(ct.from.b,ct.to.b,ct.t),at=gr===0?"#22C55E":"#F59E0B";return o.jsx(yD,{cx:H,cy:Ee,innerRadius:0,outerRadius:(Te||0)+4,startAngle:vt,endAngle:ze,fill:at,fillOpacity:.18,stroke:"transparent"})},Pt=p.useMemo(()=>{let H=Nr;if(rt){const Ee=rt.toLowerCase();H=H.filter(Te=>(Te.descricao||"").toLowerCase().includes(Ee)||(Te.finalizadoras?.nome||"").toLowerCase().includes(Ee)||String(Te.valor||"").includes(Ee)||(Te.origem||"").toLowerCase().includes(Ee))}return tr!=="all"&&(H=H.filter(Ee=>(Ee.finalizadoras?.nome||Ee.metodo)===tr)),je!=="all"&&(H=H.filter(Ee=>(Ee.fonte||"manual")===je)),H},[Nr,rt,tr,je]),zt=p.useMemo(()=>{const H={};return($e||[]).forEach(Ee=>{const Te=Ee.agendamento_id||Ee.agendamento_codigo;H[Te]||(H[Te]={agendamento_id:Ee.agendamento_id,agendamento_codigo:Ee.agendamento_codigo,inicio:Ee.inicio,fim:Ee.fim,quadra_nome:Ee.quadra_nome,participantes:[],total:0,totalPago:0,totalPendente:0,statusGeral:"Pendente",representante:"",representanteClienteId:null,representanteCodigo:null,isRepresentanteConsumidor:!1}),H[Te].participantes.push(Ee),H[Te].total+=Number(Ee.valor_cota||0),Ee.status_pagamento==="Pago"?H[Te].totalPago+=Number(Ee.valor_cota||0):H[Te].totalPendente+=Number(Ee.valor_cota||0)}),Object.values(H).forEach(Ee=>{const Te=Ee.participantes.every(ze=>ze.status_pagamento==="Pago");if(Ee.participantes.every(ze=>ze.status_pagamento==="Cancelado")?Ee.statusGeral="Cancelado":Te?Ee.statusGeral="Pago":Ee.statusGeral="Pendente",Ee.participantes.length>0){let ze=Ee.participantes.find(Zt=>!Zt.is_consumidor_final);ze||(ze=Ee.participantes[0]);let at=ze?.participante_nome||"";ze?.is_consumidor_final&&at&&(at.toLowerCase().includes("cliente consumidor")||(at=at)),Ee.representante=at,Ee.representanteClienteId=ze?.cliente_id||null,Ee.representanteCodigo=ze?.is_consumidor_final?0:ze?.cliente_codigo??null,Ee.isRepresentanteConsumidor=ze?.is_consumidor_final||!1}}),Object.values(H).sort((Ee,Te)=>new Date(Te.inicio)-new Date(Ee.inicio))},[$e]),Er=p.useMemo(()=>{const H=Tt.toLowerCase().trim();return zt.filter(Ee=>{if(Ne!=="all"&&(Ne==="Pago"&&Ee.statusGeral!=="Pago"||Ne==="Pendente"&&Ee.statusGeral!=="Pendente"||Ne==="Cancelado"&&Ee.statusGeral!=="Cancelado")||Qe!=="all"&&!Ee.participantes.some(Zt=>Zt.finalizadora_nome===Qe))return!1;if(!H)return!0;const Te=String(Ee.agendamento_codigo||""),vt=String(Ee.quadra_nome||"").toLowerCase(),ze=Ee.participantes.map(at=>String(at.participante_nome||"").toLowerCase()).join(" ");return Te.includes(H)||vt.includes(H)||ze.includes(H)})},[zt,Tt,Ne,Qe]);return o.jsx(o.Fragment,{children:o.jsxs(fr.div,{variants:Eot,initial:"hidden",animate:"visible",className:"space-y-6",children:[o.jsx(fr.div,{variants:tl,className:"fx-card p-4",children:o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Financeiro"}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Gesto completa das finanas da empresa"})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row flex-wrap items-stretch sm:items-center gap-3 w-full sm:w-auto",children:[o.jsxs("div",{className:"flex flex-col justify-center flex-1 sm:flex-initial",children:[o.jsx("label",{className:"text-xs text-text-secondary mb-1",children:"Incio"}),o.jsxs(xc,{children:[o.jsx(yc,{asChild:!0,children:o.jsxs(oe,{variant:"outline",className:"h-9 w-full sm:w-[160px] pl-3 pr-3 flex items-center gap-2 justify-start text-left font-medium bg-black border-warning/40 text-white hover:bg-black/80 hover:border-warning",children:[o.jsx(Ei,{className:"h-5 w-5 text-warning flex-shrink-0"}),o.jsx("span",{className:"font-mono tracking-wide text-sm leading-none",children:c?Jt(new Date(c+"T00:00:00"),"dd/MM/yyyy",{locale:ia}):"Selecione"})]})}),o.jsx(Rl,{className:"w-auto p-0 bg-black border-warning/40",align:"start",children:o.jsx(bc,{mode:"single",selected:c?new Date(c+"T00:00:00"):void 0,onSelect:H=>H&&d(Jt(H,"yyyy-MM-dd")),initialFocus:!0,classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md border-warning/40"}})})]})]}),o.jsxs("div",{className:"flex flex-col justify-center flex-1 sm:flex-initial",children:[o.jsx("label",{className:"text-xs text-text-secondary mb-1",children:"Fim"}),o.jsxs(xc,{children:[o.jsx(yc,{asChild:!0,children:o.jsxs(oe,{variant:"outline",className:"h-9 w-full sm:w-[160px] pl-3 pr-3 flex items-center gap-2 justify-start text-left font-medium bg-black border-warning/40 text-white hover:bg-black/80 hover:border-warning",children:[o.jsx(Ei,{className:"h-5 w-5 text-warning flex-shrink-0"}),o.jsx("span",{className:"font-mono tracking-wide text-sm leading-none",children:u?Jt(new Date(u+"T00:00:00"),"dd/MM/yyyy",{locale:ia}):"Selecione"})]})}),o.jsx(Rl,{className:"w-auto p-0 bg-black border-warning/40",align:"start",children:o.jsx(bc,{mode:"single",selected:u?new Date(u+"T00:00:00"):void 0,onSelect:H=>H&&f(Jt(H,"yyyy-MM-dd")),initialFocus:!0,classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md border-warning/40"}})})]})]})]})]})}),o.jsxs(Fd,{value:a,onValueChange:i,children:[o.jsx("div",{className:"md:hidden mb-4",children:o.jsxs(En,{value:a,onValueChange:i,children:[o.jsx(Sn,{className:"w-full h-11 bg-black border-warning/40 text-white",children:o.jsx(kn,{placeholder:"Selecione uma aba"})}),o.jsxs(Cn,{className:"bg-black text-white border-warning/40",children:[o.jsx(wt,{value:"visao-geral",children:"Viso Geral"}),o.jsx(wt,{value:"caixa",children:"Caixa"}),o.jsx(wt,{value:"recebimentos",children:"Recebimentos"}),o.jsx(wt,{value:"agendamentos",children:"Agendamentos"}),o.jsx(wt,{value:"relatorios",children:"Relatrios"})]})]})}),o.jsxs(ad,{className:"hidden md:grid w-full grid-cols-5",children:[o.jsx(wa,{value:"visao-geral",children:"Viso Geral"}),o.jsx(wa,{value:"caixa",children:"Caixa"}),o.jsx(wa,{value:"recebimentos",children:"Recebimentos"}),o.jsx(wa,{value:"agendamentos",children:"Agendamentos"}),o.jsx(wa,{value:"relatorios",children:"Relatrios"})]}),o.jsxs(Wi,{value:"visao-geral",className:"space-y-6 mt-6",children:[o.jsxs(fr.div,{variants:tl,className:"grid grid-cols-1 sm:grid-cols-4 gap-4",children:[o.jsx(Y2,{icon:cH,label:"Total Geral",value:sr(Number(v||0)+Number(y||0)),color:"brand"}),o.jsx(Y2,{icon:$1,label:"Comandas",value:sr(v),color:"success"}),o.jsx(Y2,{icon:Ei,label:"Agendamentos",value:sr(y),color:"success"}),o.jsx(Y2,{icon:Cm,label:"XML (Recebimentos)",value:sr(I),color:"success"})]}),o.jsxs(fr.div,{variants:tl,className:"fx-card p-4 border-0 ring-0 outline-none shadow-none",children:[o.jsx("div",{className:"flex items-center justify-between mb-3",children:o.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider",children:[o.jsx(Cm,{className:"w-4 h-4 text-brand"}),o.jsx("span",{children:"Proporo de Receita"})]})}),Number(v||0)+Number(y||0)===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Sem receitas no perodo."}):o.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:[o.jsx("div",{className:"w-full md:flex-1 h-[280px]",children:o.jsx(xj,{width:"100%",height:"100%",children:o.jsxs(Tqe,{children:[o.jsxs(Fu,{data:function(){const H=Br(it.from?.[0]??J,it.to?.[0]??J,it.t),Ee=Br(it.from?.[1]??J,it.to?.[1]??J,it.t);return[{name:"Comandas",value:Number(v||0),fill:"#22C55E",outerRadius:H},{name:"Agendamentos",value:Number(y||0),fill:"#F59E0B",outerRadius:Ee}]}(),dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",innerRadius:0,stroke:"transparent",label:!1,labelLine:!1,isAnimationActive:!0,animationBegin:50,animationDuration:500,startAngle:Ot.start,endAngle:Ot.end,activeIndex:gr,activeShape:void 0,onMouseEnter:(H,Ee)=>Ht(Ee),onMouseLeave:()=>Ht(null),onClick:(H,Ee)=>{Ft(Te=>Te===Ee?null:Ee),Ht(Ee)},children:[o.jsx(Mb,{fill:"#22C55E",style:Fr(0)},"c"),o.jsx(Mb,{fill:"#F59E0B",style:Fr(1)},"a")]}),dt({cx:"50%",cy:"50%",outerRadius:92}),o.jsx(Fu,{data:function(){const H=Br(it.from?.[0]??J,it.to?.[0]??J,it.t),Ee=Br(it.from?.[1]??J,it.to?.[1]??J,it.t);return[{name:"Comandas",value:Number(v||0),fill:"transparent",outerRadius:H},{name:"Agendamentos",value:Number(y||0),fill:"transparent",outerRadius:Ee}]}(),dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",innerRadius:0,stroke:"transparent",label:wr,labelLine:!1,isAnimationActive:!1,startAngle:Ot.start,endAngle:Ot.end}),o.jsx(oc,{formatter:H=>sr(H),contentStyle:{background:"rgba(10, 10, 10, 0.95)",border:"1px solid #fbbf24",borderRadius:"8px",padding:"8px 10px",color:"#fff"},labelStyle:{color:"#fff"},itemStyle:{color:"#fff"},cursor:{fill:"rgba(251, 191, 36, 0.06)"}})]})})}),o.jsx("div",{className:"w-full md:w-64 space-y-3 md:pr-2",children:[{name:"Comandas",value:Number(v||0),color:"#22C55E"},{name:"Agendamentos",value:Number(y||0),color:"#F59E0B"}].map((H,Ee)=>o.jsxs("div",{className:`flex items-center justify-between px-3 py-2 rounded-md transition-all duration-200 ${ut===Ee?"bg-white/5":"hover:bg-white/5"} cursor-pointer ${dr!=null&&dr!==Ee?"opacity-60":""}`,onMouseEnter:()=>Ht(Ee),onMouseLeave:()=>Ht(null),onClick:()=>Ft(Te=>Te===Ee?null:Ee),role:"button",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"inline-block w-3 h-3 rounded-sm",style:{backgroundColor:H.color}}),o.jsx("span",{className:"text-sm text-text-secondary",children:H.name})]}),o.jsx("div",{className:`text-sm font-semibold ${dr!=null&&dr!==Ee?"opacity-70":""}`,children:sr(H.value)})]},H.name))})]})]}),o.jsxs(fr.div,{variants:tl,className:"fx-card p-4 border-0 ring-0 outline-none shadow-none",children:[o.jsx("div",{className:"flex items-center justify-between mb-3",children:o.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider",children:[o.jsx(Cm,{className:"w-4 h-4 text-brand"}),o.jsx("span",{children:"Entradas por Finalizadora"})]})}),Aa.length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Sem pagamentos no perodo."}):o.jsx("div",{className:"h-[280px]",children:o.jsx(xj,{width:"100%",height:"100%",children:o.jsxs(Iqe,{data:Aa,margin:{top:8,right:8,left:8,bottom:8},children:[o.jsx(w3,{strokeDasharray:"3 3",stroke:"#333"}),o.jsx(Qp,{dataKey:"name",stroke:"#aaa"}),o.jsx(Zp,{stroke:"#aaa",tickFormatter:H=>sr(H),width:80}),o.jsx(oc,{formatter:H=>sr(H),labelFormatter:H=>`Finalizadora: ${H}`,contentStyle:{background:"rgba(10, 10, 10, 0.95)",border:"1px solid #fbbf24",borderRadius:"8px",padding:"8px 12px",color:"#fff"},cursor:{fill:"rgba(251, 191, 36, 0.1)"}}),o.jsx(Pp,{}),o.jsx(xg,{dataKey:"valor",name:"Valor",fill:"#fbbf24"})]})})})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[o.jsxs(fr.div,{variants:tl,className:"fx-card p-4 border-0 ring-0 outline-none focus-visible:outline-none shadow-none cursor-pointer",onClick:()=>z(!0),children:[o.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider mb-3",children:[o.jsx(ud,{className:"w-4 h-4 text-brand"}),o.jsx("span",{children:"Produtos mais vendidos"}),C.length>5&&o.jsx(oe,{variant:"outline",size:"xs",className:"ml-auto h-7 px-2",onClick:()=>z(!0),children:"Ver todos"})]}),b.length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Sem dados no perodo."}):o.jsx("div",{className:"space-y-2",children:b.map((H,Ee)=>o.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-border last:border-0",children:[o.jsxs("span",{className:"text-sm text-text-primary",children:[Ee+1,". ",H.nome]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-xs text-text-secondary",children:sr(H.valor)}),o.jsxs("span",{className:"text-sm font-bold text-brand",children:["x",H.quantidade]})]})]},Ee))})]}),o.jsxs(fr.div,{variants:tl,className:"fx-card p-4 border-0 ring-0 outline-none focus-visible:outline-none shadow-none cursor-pointer",onClick:()=>Y(!0),children:[o.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-xs font-semibold uppercase tracking-wider mb-3",children:[o.jsx(cl,{className:"w-4 h-4 text-brand"}),o.jsx("span",{children:"Clientes (por valor pago)"}),P.length>5&&o.jsx(oe,{variant:"outline",size:"xs",className:"ml-auto h-7 px-2",onClick:()=>Y(!0),children:"Ver todos"})]}),j.length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Sem dados no perodo."}):o.jsx("div",{className:"space-y-2",children:j.map((H,Ee)=>o.jsxs("button",{className:"w-full flex items-center justify-between py-2 border-b border-border last:border-0 hover:bg-surface-2 rounded-sm px-2 text-left",onClick:()=>{xe(H),Y(!0)},children:[o.jsxs("span",{className:"text-sm text-text-primary",children:[Ee+1,". ",H.nome]}),o.jsx("span",{className:"text-sm font-bold text-success",children:sr(H.valor)})]},Ee))})]})]})]}),o.jsx(Wi,{value:"agendamentos",className:"space-y-6 mt-6",children:o.jsxs(fr.div,{variants:tl,className:"fx-card p-4 border-0 ring-0 outline-none shadow-none",children:[o.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4",children:[o.jsx("h2",{className:"text-lg font-bold",children:"Agendamentos (Pagamentos por Participante)"}),o.jsxs("div",{className:"flex flex-col md:flex-row gap-2 md:items-center",children:[o.jsxs("div",{className:"relative",children:[o.jsx(pi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(or,{placeholder:"Buscar (#cdigo, participante, quadra)",value:Tt,onChange:H=>Se(H.target.value),className:"pl-10 pr-10 w-full md:w-[260px] bg-black border-warning/40 text-white placeholder:text-white/60"}),o.jsxs(xc,{open:qt,onOpenChange:lt,children:[o.jsx(yc,{asChild:!0,children:o.jsx(oe,{variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-7 w-7 p-0 hover:bg-warning/20",title:"Selecionar cliente",children:o.jsx("svg",{className:"h-4 w-4 text-warning",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})}),o.jsx(Rl,{className:"w-[280px] p-2 bg-surface border-border",align:"end",children:o.jsxs("div",{className:"space-y-1 max-h-[300px] overflow-y-auto",children:[o.jsx("div",{className:"text-xs font-semibold text-text-secondary px-2 py-1 sticky top-0 bg-surface z-10",children:"Selecionar Cliente"}),(()=>{const H=new Map;$e.forEach(Te=>{const vt=Te.participante_nome;vt&&!H.has(vt)&&H.set(vt,{nome:vt,codigo:Te.cliente_codigo||0,is_consumidor:Te.is_consumidor_final||!1})});const Ee=Array.from(H.values()).sort((Te,vt)=>Te.is_consumidor!==vt.is_consumidor?Te.is_consumidor?1:-1:Te.nome.localeCompare(vt.nome));return Ee.length===0?o.jsx("div",{className:"text-sm text-text-muted text-center py-4",children:"Nenhum participante encontrado"}):Ee.map((Te,vt)=>o.jsxs("button",{onClick:()=>{Se(Te.nome),lt(!1)},className:"w-full flex items-center gap-2 px-2 py-2 hover:bg-surface-2 rounded text-left transition-colors",children:[o.jsxs("span",{className:`inline-flex items-center justify-center min-w-[24px] h-5 px-1 rounded text-[10px] font-bold ${Te.codigo===0?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",Te.codigo]}),o.jsx("span",{className:"text-sm text-text-primary flex-1 truncate",children:Te.nome})]},vt))})()]})})]})]}),o.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[o.jsxs(En,{value:Ne,onValueChange:Ue,children:[o.jsx(Sn,{className:"w-full md:w-[170px] h-9 bg-black border-warning/40 text-white",children:o.jsx(kn,{placeholder:"Todos os Status"})}),o.jsxs(Cn,{className:"bg-black text-white border-warning/40",children:[o.jsx(wt,{value:"all",children:"Todos os Status"}),o.jsx(wt,{value:"Pago",children:"Pago"}),o.jsx(wt,{value:"Pendente",children:"Pendente"}),o.jsx(wt,{value:"Cancelado",children:"Cancelado"})]})]}),o.jsxs(En,{value:Qe,onValueChange:et,children:[o.jsx(Sn,{className:"w-full md:w-[220px] h-9 bg-black border-warning/40 text-white",children:o.jsx(kn,{placeholder:"Todas as Finalizadoras"})}),o.jsxs(Cn,{className:"bg-black text-white border-warning/40",children:[o.jsx(wt,{value:"all",children:"Todas as Finalizadoras"}),[...new Set(($e||[]).map(H=>H.finalizadora_nome).filter(Boolean))].map(H=>o.jsx(wt,{value:H,children:H},H))]})]})]}),o.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>{try{const H=";",Te=[["Data","Horrio","Cdigo","Representante","Quadra","Participantes","Total","Pago","Pendente","Status"].join(H)];Er.forEach(br=>{const yr=br.inicio?new Date(br.inicio).toLocaleDateString("pt-BR"):"",nr=br.inicio&&br.fim?`${new Date(br.inicio).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}-${new Date(br.fim).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}`:"",Zr=br.participantes.length,tt=br.participantes.filter(jn=>jn.status_pagamento==="Pago").length,Lr=br.participantes.filter(jn=>jn.status_pagamento==="Pendente").length,cn=String($r(br.total)).replace(".",","),pn=[yr,nr,br.agendamento_codigo??"",(br.representante??"").replace(/"/g,'""'),(br.quadra_nome??"").replace(/"/g,'""'),Zr,cn,tt,Lr,br.statusGeral??""].map(jn=>`"${jn}"`).join(H);Te.push(pn)});const vt="\uFEFF"+Te.join(`
`),ze=new Blob([vt],{type:"text/csv;charset=utf-8;"}),at=URL.createObjectURL(ze),Zt=document.createElement("a");Zt.href=at;const zr=c?new Date(c+"T00:00:00").toLocaleDateString("pt-BR").replace(/\//g,"-"):"",Ar=u?new Date(u+"T00:00:00").toLocaleDateString("pt-BR").replace(/\//g,"-"):"";Zt.download=`agendamentos_${zr}_a_${Ar}.csv`,document.body.appendChild(Zt),Zt.click(),document.body.removeChild(Zt),URL.revokeObjectURL(at),e({title:"CSV exportado com sucesso!"})}catch(H){e({title:"Falha ao exportar CSV",description:H?.message,variant:"destructive"})}},children:[o.jsx(ri,{className:"h-4 w-4 mr-2"})," Exportar CSV"]})]})]}),s?o.jsxs("div",{className:"text-center py-8",children:[o.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-brand border-r-transparent"}),o.jsx("p",{className:"mt-4 text-text-muted",children:"Carregando..."})]}):Er.length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Sem registros no perodo."}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"hidden md:block overflow-x-auto",children:o.jsxs(rl,{children:[o.jsx(nl,{children:o.jsxs(Ba,{children:[o.jsx(vn,{className:"w-12"}),o.jsx(vn,{children:"Data/Hora"}),o.jsx(vn,{children:"Cdigo"}),o.jsx(vn,{children:"Representante"}),o.jsx(vn,{children:"Quadra"}),o.jsx(vn,{className:"text-right",children:"Participantes"}),o.jsx(vn,{className:"text-right",children:"Total"}),o.jsx(vn,{children:"Status"})]})}),o.jsx(al,{children:Er.map(H=>{const Ee=pt.has(H.agendamento_id||H.agendamento_codigo);return o.jsxs(ye.Fragment,{children:[o.jsxs(Ba,{className:"cursor-pointer hover:bg-surface-2",onClick:()=>{const Te=H.agendamento_id||H.agendamento_codigo;Ke(vt=>{const ze=new Set(vt);return ze.has(Te)?ze.delete(Te):ze.add(Te),ze})},children:[o.jsx(en,{children:o.jsx("div",{className:`transition-transform ${Ee?"rotate-90":""}`,children:""})}),o.jsx(en,{children:H.inicio?o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"text-xs text-text-secondary",children:new Date(H.inicio).toLocaleDateString("pt-BR")}),o.jsxs("span",{className:"font-medium",children:[new Date(H.inicio).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),H.fim&&` - ${new Date(H.fim).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}`]})]}):""}),o.jsxs(en,{className:"font-semibold",children:["#",H.agendamento_codigo||""]}),o.jsx(en,{children:o.jsxs("div",{className:"flex items-center gap-2",children:[H.representanteCodigo!==null&&H.representanteCodigo!==void 0&&o.jsxs("span",{className:`inline-flex items-center justify-center min-w-[32px] h-6 px-1.5 rounded text-xs font-bold ${H.representanteCodigo===0||H.representanteCodigo==="0"?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",H.representanteCodigo]}),o.jsx("span",{className:"text-text-primary",children:H.representante||""})]})}),o.jsx(en,{children:H.quadra_nome||""}),o.jsx(en,{className:"text-right",children:H.participantes.length}),o.jsx(en,{className:"text-right font-semibold",children:sr(H.total)}),o.jsx(en,{children:o.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${H.statusGeral==="Pago"?"bg-success/20 text-success":H.statusGeral==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:H.statusGeral==="Parcial"?"Pendente":H.statusGeral})})]}),Ee&&H.participantes.map((Te,vt)=>{const ze=Te.is_consumidor_final?0:Te.cliente_codigo??null;return o.jsxs(Ba,{className:"bg-surface-2/30 hover:bg-surface-2/50 transition-colors",children:[o.jsx(en,{}),o.jsx(en,{colSpan:2}),o.jsx(en,{className:"pl-8 text-sm text-text-secondary",children:o.jsxs("div",{className:"flex items-center gap-2",children:[ze!=null&&o.jsxs("span",{className:`inline-flex items-center justify-center min-w-[28px] h-5 px-1 rounded text-[10px] font-bold ${ze===0||ze==="0"?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",ze]}),o.jsx("span",{children:Te.participante_nome||""})]})}),o.jsx(en,{className:"text-sm text-text-secondary",children:Te.finalizadora_nome||""}),o.jsx(en,{}),o.jsx(en,{className:"text-right text-sm font-medium",children:sr(Te.valor_cota)}),o.jsx(en,{className:"text-sm",children:o.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs ${Te.status_pagamento==="Pago"?"bg-success/20 text-success":Te.status_pagamento==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:Te.status_pagamento||"Pendente"})})]},`${H.agendamento_codigo}-${vt}`)})]},H.agendamento_id||H.agendamento_codigo)})})]})}),o.jsx("div",{className:"md:hidden space-y-3",children:Er.map(H=>{const Ee=pt.has(H.agendamento_id||H.agendamento_codigo);return o.jsxs("div",{className:"bg-surface-2 rounded-lg overflow-hidden",children:[o.jsxs("div",{className:"p-4 cursor-pointer",onClick:()=>{const Te=H.agendamento_id||H.agendamento_codigo;Ke(vt=>{const ze=new Set(vt);return ze.has(Te)?ze.delete(Te):ze.add(Te),ze})},children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:`transition-transform text-text-secondary ${Ee?"rotate-90":""}`,children:""}),o.jsxs("div",{className:"text-sm font-semibold text-text-primary",children:["#",H.agendamento_codigo||""]})]}),o.jsx("div",{className:`text-xs px-2 py-1 rounded-full ${H.statusGeral==="Pago"?"bg-success/20 text-success":H.statusGeral==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:H.statusGeral==="Parcial"?"Pendente":H.statusGeral})]}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Data:"}),o.jsx("span",{className:"text-text-primary",children:H.inicio?new Date(H.inicio).toLocaleDateString("pt-BR"):""})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Horrio:"}),o.jsx("span",{className:"text-text-primary font-medium",children:H.inicio&&H.fim?`${new Date(H.inicio).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})} - ${new Date(H.fim).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}`:""})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-text-secondary",children:"Representante:"}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[H.representanteCodigo!==null&&H.representanteCodigo!==void 0&&o.jsxs("span",{className:`inline-flex items-center justify-center min-w-[28px] h-5 px-1 rounded text-[10px] font-bold ${H.representanteCodigo===0||H.representanteCodigo==="0"?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",H.representanteCodigo]}),o.jsx("span",{className:"text-text-primary font-medium",children:H.representante||""})]})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Quadra:"}),o.jsx("span",{className:"text-text-primary font-medium",children:H.quadra_nome||""})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Participantes:"}),o.jsx("span",{className:"text-text-primary",children:H.participantes.length})]}),o.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-border/50",children:[o.jsx("span",{className:"text-text-secondary",children:"Total:"}),o.jsx("span",{className:"font-bold text-lg text-success",children:sr(H.total)})]})]})]}),Ee&&o.jsx("div",{className:"border-t border-border/50 bg-surface-2/20",children:H.participantes.map((Te,vt)=>{const ze=Te.is_consumidor_final?0:Te.cliente_codigo??null;return o.jsxs("div",{className:"px-4 py-3 border-b border-border/30 last:border-b-0",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center gap-1.5",children:[ze!=null&&o.jsxs("span",{className:`inline-flex items-center justify-center min-w-[24px] h-4 px-1 rounded text-[9px] font-bold ${ze===0||ze==="0"?"bg-amber-500/20 text-amber-400 ring-1 ring-amber-500/30":"bg-emerald-600/20 text-emerald-400"}`,children:["#",ze]}),o.jsx("div",{className:"font-medium text-sm",children:Te.participante_nome||""})]}),o.jsx("div",{className:`text-xs px-2 py-0.5 rounded-full ${Te.status_pagamento==="Pago"?"bg-success/20 text-success":Te.status_pagamento==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:Te.status_pagamento||"Pendente"})]}),o.jsxs("div",{className:"flex justify-between text-xs",children:[o.jsx("span",{className:"text-text-secondary",children:Te.finalizadora_nome||""}),o.jsx("span",{className:"font-semibold text-success",children:sr(Te.valor_cota)})]})]},vt)})})]},H.agendamento_id||H.agendamento_codigo)})})]})]})}),o.jsx(Wi,{value:"caixa",className:"space-y-6 mt-6",children:o.jsxs(fr.div,{variants:tl,className:"fx-card p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3 gap-2",children:[o.jsx("h3",{className:"text-base font-bold",children:"Fechamentos Anteriores"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(oe,{variant:"outline",size:"sm",onClick:Mt,children:[o.jsx(ri,{className:"h-4 w-4 mr-2"})," CSV"]}),o.jsxs(oe,{variant:"outline",size:"sm",onClick:ke,children:[o.jsx(Cg,{className:"h-4 w-4 mr-2"})," PDF"]})]})]}),Z.length===0?o.jsx("div",{className:"text-sm text-text-secondary",children:"Nenhum fechamento encontrado."}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"hidden md:block overflow-x-auto",children:o.jsxs(rl,{children:[o.jsx(nl,{children:o.jsxs(Ba,{children:[o.jsx(vn,{children:"Aberto em"}),o.jsx(vn,{children:"Fechado em"}),o.jsx(vn,{className:"text-right",children:"Saldo Inicial"}),o.jsx(vn,{className:"text-right",children:"Saldo Final (contado)"}),o.jsx(vn,{children:"Status"})]})}),o.jsxs(al,{children:[(()=>{console.log("[FinanceiroPage][Render] Renderizando histrico, total de sesses:",Z.length);const H=Z.filter(Ee=>Ee.valor_final_dinheiro!=null);return console.log("[FinanceiroPage][Render] Sesses com valor_final_dinheiro no render:",H.length),Z.length>0&&console.log("[FinanceiroPage][Render] Primeira sesso no array history:",Z[0]),null})(),Z.map(H=>o.jsxs(Ba,{className:"cursor-pointer hover:bg-surface-2",onClick:async()=>{Nt(!0),st(!0),yt(null);try{const Ee=t?.codigo_empresa,Te=typeof performance<"u"&&performance.now?performance.now():Date.now();console.log("[Caixa][Fechamento][Open]",{sessaoId:H.id,from:H.aberto_em,to:H.fechado_em,codigo:Ee});let vt=await M_({caixaSessaoId:H.id,codigoEmpresa:Ee}),at=(Gn=>{if(!Gn)return null;if(Gn.total_bruto!=null||Gn.por_finalizadora!=null){let Ln=Gn.por_finalizadora;if(Ln&&typeof Ln=="string")try{Ln=JSON.parse(Ln)}catch{Ln={}}return{from:Gn.periodo_de||null,to:Gn.periodo_ate||null,totalPorFinalizadora:Ln||{},totalEntradas:Number(Gn.total_entradas||0),totalVendasBrutas:Number(Gn.total_bruto||0),totalDescontos:Number(Gn.total_descontos||0),totalVendasLiquidas:Number(Gn.total_liquido||0)}}return Gn})(vt);at||(console.log("[Caixa][Fechamento] Snapshot ausente, calculando resumo por perodo..."),at=await nd({from:H.aberto_em,to:H.fechado_em||new Date().toISOString(),codigoEmpresa:Ee}));const Zt={...H,saldo_inicial:vt&&typeof vt.saldo_inicial<"u"?Number(vt.saldo_inicial):H.saldo_inicial,saldo_final:vt&&typeof vt.saldo_final<"u"?Number(vt.saldo_final):H.saldo_final};if(!at||!at.totalPorFinalizadora||Object.keys(at.totalPorFinalizadora).length===0)try{const Gn=H.aberto_em,Ln=H.fechado_em||new Date().toISOString();let aa=ve.from("pagamentos").select("metodo, valor, status, recebido_em, finalizadoras:finalizadoras!pagamentos_finalizadora_id_fkey(nome)").gte("recebido_em",Gn).lte("recebido_em",Ln);Ee&&(aa=aa.eq("codigo_empresa",Ee));const{data:Bn}=await aa,ya={};let an=0;for(const Ea of Bn||[]){if(!((Ea.status||"Pago")!=="Cancelado"&&(Ea.status||"Pago")!=="Estornado"))continue;const ba=Ea.finalizadoras?.nome||Ea.metodo||"Outros",Mo=Number(Ea.valor||0);ya[ba]=(ya[ba]||0)+Mo,an+=Mo}at={...at||{},totalPorFinalizadora:ya,totalEntradas:Number(at?.totalEntradas||0)||an},console.log("[Caixa][Fechamento][FallbackPF]",{methods:Object.keys(ya).length})}catch{}const Ar=await Op({caixaSessaoId:H.id,codigoEmpresa:Ee}),br=vt&&vt.movimentos?vt.movimentos:null,yr=H.aberto_em,nr=H.fechado_em||new Date().toISOString();let Zr=ve.from("pagamentos").select("id, valor, status, metodo, recebido_em, finalizadoras:finalizadoras!pagamentos_finalizadora_id_fkey(nome)").gte("recebido_em",yr).lte("recebido_em",nr).order("recebido_em",{ascending:!1});Ee&&(Zr=Zr.eq("codigo_empresa",Ee));const{data:tt}=await Zr;console.log("[Caixa][Fechamento][Pays]",{count:(tt||[]).length});const Lr=vt&&typeof vt.valor_final_dinheiro<"u"?Number(vt.valor_final_dinheiro):null;yt({resumo:at,movimentacoes:Ar,movimentosAgg:br,pagamentos:tt||[],sessao:Zt,valorFinalContado:Lr});const cn=typeof performance<"u"&&performance.now?performance.now():Date.now(),pn=Array.isArray(Ar)?Ar.length:0,jn=at&&at.totalPorFinalizadora?Object.keys(at.totalPorFinalizadora).length:0;console.log("[Caixa][Fechamento][Loaded]",{sessaoId:H.id,finCount:jn,movCount:pn,ms:Math.round(cn-Te)})}catch(Ee){console.error("[Caixa][Fechamento][Error]",{sessaoId:H.id,message:Ee?.message,code:Ee?.code}),e({title:"Falha ao carregar fechamento",description:Ee?.message||"Tente novamente",variant:"destructive"})}finally{st(!1)}},children:[o.jsx(en,{children:H.aberto_em?new Date(H.aberto_em).toLocaleString("pt-BR"):""}),o.jsx(en,{children:H.fechado_em?new Date(H.fechado_em).toLocaleString("pt-BR"):""}),o.jsx(en,{className:"text-right",children:sr(H.saldo_inicial)}),o.jsx(en,{className:"text-right",children:H.valor_final_dinheiro!=null?sr(H.valor_final_dinheiro):""}),o.jsx(en,{children:String(H.status||"").toLowerCase()==="open"?"Aberto":"Fechado"})]},H.id))]})]})}),o.jsx("div",{className:"md:hidden space-y-3",children:Z.map(H=>o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 cursor-pointer hover:bg-surface-2/80 transition-colors",onClick:async()=>{Nt(!0),st(!0),yt(null);try{const Ee=t?.codigo_empresa;let Te=await M_({caixaSessaoId:H.id,codigoEmpresa:Ee}),ze=(br=>{if(!br)return null;if(br.total_bruto!=null||br.por_finalizadora!=null){let yr=br.por_finalizadora;if(yr&&typeof yr=="string")try{yr=JSON.parse(yr)}catch{yr={}}return{from:br.periodo_de||null,to:br.periodo_ate||null,totalPorFinalizadora:yr||{},totalEntradas:Number(br.total_entradas||0),totalVendasBrutas:Number(br.total_bruto||0),totalDescontos:Number(br.total_descontos||0),totalVendasLiquidas:Number(br.total_liquido||0)}}return br})(Te);ze||(ze=await nd({from:H.aberto_em,to:H.fechado_em||new Date().toISOString(),codigoEmpresa:Ee}));const at={...H,saldo_inicial:Te&&typeof Te.saldo_inicial<"u"?Number(Te.saldo_inicial):H.saldo_inicial,saldo_final:Te&&typeof Te.saldo_final<"u"?Number(Te.saldo_final):H.saldo_final},Zt=await Op({caixaSessaoId:H.id,codigoEmpresa:Ee}),zr=Te&&Te.movimentos?Te.movimentos:null,Ar=Te&&typeof Te.valor_final_dinheiro<"u"?Number(Te.valor_final_dinheiro):null;yt({resumo:ze,movimentacoes:Zt,movimentosAgg:zr,sessao:at,pagamentos:[],valorFinalContado:Ar})}catch(Ee){console.error("[Caixa][Fechamento][Error]",Ee),e({title:"Erro ao carregar detalhes",description:Ee?.message,variant:"destructive"})}finally{st(!1)}},children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"text-sm font-semibold text-text-primary",children:["Sesso #",H.id]}),o.jsx("div",{className:`text-xs px-2 py-1 rounded-full ${H.status==="fechado"?"bg-success/20 text-success":"bg-warning/20 text-warning"}`,children:String(H.status||"").toLowerCase()==="open"?"Aberto":"Fechado"})]}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Aberto em:"}),o.jsx("span",{className:"text-text-primary",children:H.aberto_em?new Date(H.aberto_em).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):""})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Fechado em:"}),o.jsx("span",{className:"text-text-primary",children:H.fechado_em?new Date(H.fechado_em).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):""})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Saldo Inicial:"}),o.jsx("span",{className:"font-semibold text-info",children:sr(H.saldo_inicial)})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Saldo Final (contado):"}),o.jsx("span",{className:"font-semibold text-success",children:H.valor_final_dinheiro!=null?sr(H.valor_final_dinheiro):""})]})]}),o.jsx("div",{className:"mt-3 text-xs text-text-muted text-center",children:"Toque para ver detalhes"})]},H.id))})]})]})}),o.jsx(Wi,{value:"recebimentos",className:"space-y-6 mt-6",children:o.jsxs(fr.div,{variants:tl,className:"fx-card p-4 border-0 ring-0 outline-none shadow-none",children:[o.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4",children:[o.jsx("h2",{className:"text-lg font-bold",children:"Todos os Recebimentos"}),o.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[o.jsxs("div",{className:"relative",children:[o.jsx(pi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(or,{placeholder:"Buscar...",value:rt,onChange:H=>mt(H.target.value),className:"pl-10 w-full md:w-[200px]"})]}),o.jsxs(En,{value:je,onValueChange:ae,children:[o.jsx(Sn,{className:"w-full md:w-[160px] h-9 bg-black border-warning/40 text-white",children:o.jsx(kn,{placeholder:"Todas as Fontes"})}),o.jsxs(Cn,{className:"bg-black text-white border-warning/40",children:[o.jsx(wt,{value:"all",children:"Todas as Fontes"}),o.jsx(wt,{value:"manual",children:"Manual"}),o.jsx(wt,{value:"xml",children:"XML"})]})]}),o.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>{try{const H=Pt||[],Te=[["Data/Hora","Origem","Fonte","Descrio","Finalizadora","Valor","Status"].join(";")];for(const br of H){const yr=[br.recebido_em?new Date(br.recebido_em).toLocaleString("pt-BR"):"",br.origem??"",br.fonte??"",(br.descricao??"").replaceAll('"','""'),(br.finalizadoras?.nome||br.metodo||"").replaceAll('"','""'),String($r(br.valor)).replace(".",","),br.status??""].map(nr=>`"${String(nr)}"`).join(";");Te.push(yr)}const vt="\uFEFF"+Te.join(`
`),ze=new Blob([vt],{type:"text/csv;charset=utf-8;"}),at=URL.createObjectURL(ze),Zt=c?new Date(c+"T00:00:00").toLocaleDateString("pt-BR"):"",zr=u?new Date(u+"T00:00:00").toLocaleDateString("pt-BR"):"",Ar=document.createElement("a");Ar.href=at,Ar.download=`recebimentos_${Zt}_a_${zr}.csv`,document.body.appendChild(Ar),Ar.click(),document.body.removeChild(Ar),URL.revokeObjectURL(at)}catch(H){e({title:"Falha ao exportar CSV",description:H?.message,variant:"destructive"})}},children:[o.jsx(ri,{className:"h-4 w-4 mr-2"})," Exportar CSV"]})]})]}),s?o.jsxs("div",{className:"text-center py-8",children:[o.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-brand border-r-transparent"}),o.jsx("p",{className:"mt-4 text-text-muted",children:"Carregando..."})]}):Pt.length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Sem registros no perodo."}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"hidden md:block overflow-x-auto",children:o.jsxs(rl,{children:[o.jsx(nl,{children:o.jsxs(Ba,{children:[o.jsx(vn,{children:"Data/Hora"}),o.jsx(vn,{children:"Origem"}),o.jsx(vn,{children:"Fonte"}),o.jsx(vn,{children:"Descrio"}),o.jsx(vn,{children:"Finalizadora"}),o.jsx(vn,{className:"text-right",children:"Valor"}),o.jsx(vn,{children:"Status"})]})}),o.jsx(al,{children:Pt.map(H=>o.jsxs(Ba,{className:"cursor-pointer hover:bg-surface-2",onClick:()=>{Qr(H),nt(!0)},children:[o.jsx(en,{children:H.recebido_em?new Date(H.recebido_em).toLocaleString("pt-BR"):""}),o.jsx(en,{children:H.origem||""}),o.jsx(en,{children:H.fonte?H.fonte.toUpperCase():""}),o.jsx(en,{className:"truncate max-w-[260px]",title:H.descricao||"",children:H.descricao||""}),o.jsx(en,{children:H.finalizadoras?.nome||H.metodo||""}),o.jsx(en,{className:"text-right font-semibold",children:sr(H.valor)}),o.jsx(en,{children:H.status||""})]},H.id))})]})}),o.jsx("div",{className:"md:hidden space-y-3",children:Pt.map(H=>o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 cursor-pointer hover:bg-surface-2/80 transition-colors",onClick:()=>{Qr(H),nt(!0)},children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("div",{className:"text-sm font-semibold text-text-primary",children:H.origem||"Recebimento"}),o.jsx("div",{className:`text-xs px-2 py-1 rounded-full ${H.status==="Pago"?"bg-success/20 text-success":H.status==="Cancelado"?"bg-danger/20 text-danger":"bg-warning/20 text-warning"}`,children:H.status||"Pendente"})]}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Data/Hora:"}),o.jsx("span",{className:"text-text-primary",children:H.recebido_em?new Date(H.recebido_em).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):""})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Fonte:"}),o.jsx("span",{className:"text-text-primary font-medium",children:H.fonte?H.fonte.toUpperCase():""})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Finalizadora:"}),o.jsx("span",{className:"text-text-primary",children:H.finalizadoras?.nome||H.metodo||""})]}),H.descricao&&o.jsxs("div",{className:"flex flex-col gap-1",children:[o.jsx("span",{className:"text-text-secondary",children:"Descrio:"}),o.jsx("span",{className:"text-text-primary text-xs bg-surface/50 p-2 rounded",children:H.descricao})]}),o.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-border/50",children:[o.jsx("span",{className:"text-text-secondary",children:"Valor:"}),o.jsx("span",{className:"font-bold text-lg text-success",children:sr(H.valor)})]})]}),o.jsx("div",{className:"mt-3 text-xs text-text-muted text-center",children:"Toque para ver detalhes"})]},H.id))})]})]})}),o.jsxs(Wi,{value:"relatorios",className:"space-y-6 mt-6",children:[o.jsxs(fr.div,{variants:tl,className:"fx-card p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[o.jsx(Ui,{className:"w-5 h-5 text-success"}),"Faturamento Consolidado"]}),o.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Resumo geral das receitas no perodo"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(oe,{variant:"outline",size:"sm",className:"bg-success/10 border-success/40 text-success hover:bg-success/20",onClick:()=>{const Ee=[["Mtrica","Valor"],["Receita de Comandas",sr(v)],["Receita de Agendamentos",sr(y)],["Receita Total",sr(Number(v||0)+Number(y||0))],["Perodo",`${c||"N/A"} at ${u||"N/A"}`]].map(at=>at.map(Zt=>`"${Zt}"`).join(";")).join(`
`),Te=new Blob(["\uFEFF"+Ee],{type:"text/csv;charset=utf-8;"}),vt=URL.createObjectURL(Te),ze=document.createElement("a");ze.href=vt,ze.download=`faturamento_consolidado_${Jt(new Date,"yyyy-MM-dd")}.csv`,ze.click(),URL.revokeObjectURL(vt),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[o.jsx(ri,{className:"w-4 h-4 mr-2"}),"CSV"]}),o.jsxs(oe,{variant:"outline",size:"sm",className:"bg-success/10 border-success/40 text-success hover:bg-success/20",onClick:()=>{const H=[["Receita de Comandas",sr(v)],["Receita de Agendamentos",sr(y)],["Receita Total",sr(Number(v||0)+Number(y||0))]];Gr("Faturamento Consolidado",["Mtrica","Valor"],H,"faturamento_consolidado")},children:[o.jsx(Cg,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"p-4 bg-success/5 border border-success/20 rounded-lg",children:[o.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Receita Comandas"}),o.jsx("div",{className:"text-2xl font-bold text-success",children:sr(v)}),o.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Vendas no perodo"})]}),o.jsxs("div",{className:"p-4 bg-purple-500/5 border border-purple-500/20 rounded-lg",children:[o.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Receita Agendamentos"}),o.jsx("div",{className:"text-2xl font-bold text-purple-400",children:sr(y)}),o.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Reservas pagas"})]}),o.jsxs("div",{className:"p-4 bg-brand/5 border border-brand/20 rounded-lg",children:[o.jsx("div",{className:"text-xs text-text-secondary mb-1",children:"Receita Total"}),o.jsx("div",{className:"text-2xl font-bold text-brand",children:sr(Number(v||0)+Number(y||0))}),o.jsx("div",{className:"text-xs text-text-muted mt-1",children:"Perodo selecionado"})]})]})]}),o.jsxs(fr.div,{variants:tl,className:"fx-card p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[o.jsx(Cm,{className:"w-5 h-5 text-info"}),"Pagamentos por Mtodo"]}),o.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Distribuio por finalizadora"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(oe,{variant:"outline",size:"sm",className:"bg-info/10 border-info/40 text-info hover:bg-info/20",onClick:()=>{const H=m?.totalPorFinalizadora||{},Ee=Object.entries(H).map(([Ar,br])=>[Ar,sr(br)]).sort((Ar,br)=>{const yr=Number(String(Ar[1]).replace(/[^\d,]/g,"").replace(",","."));return Number(String(br[1]).replace(/[^\d,]/g,"").replace(",","."))-yr}),Te=Object.values(H).reduce((Ar,br)=>Ar+br,0),ze=[["Mtodo de Pagamento","Valor","% do Total"],...Ee.map(([Ar,br])=>{const nr=((Object.entries(H).find(([Zr])=>Zr===Ar)?.[1]||0)/Te*100).toFixed(1)+"%";return[Ar,br,nr]}),["TOTAL",sr(Te),"100%"]].map(Ar=>Ar.map(br=>`"${br}"`).join(";")).join(`
`),at=new Blob(["\uFEFF"+ze],{type:"text/csv;charset=utf-8;"}),Zt=URL.createObjectURL(at),zr=document.createElement("a");zr.href=Zt,zr.download=`pagamentos_por_metodo_${Jt(new Date,"yyyy-MM-dd")}.csv`,zr.click(),URL.revokeObjectURL(Zt),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[o.jsx(ri,{className:"w-4 h-4 mr-2"}),"CSV"]}),o.jsxs(oe,{variant:"outline",size:"sm",className:"bg-info/10 border-info/40 text-info hover:bg-info/20",onClick:()=>{const H=m?.totalPorFinalizadora||{},Ee=Object.values(H).reduce((vt,ze)=>vt+ze,0),Te=Object.entries(H).sort(([,vt],[,ze])=>ze-vt).map(([vt,ze])=>[vt,sr(ze),(ze/Ee*100).toFixed(1)+"%"]);Te.push(["TOTAL",sr(Ee),"100%"]),Gr("Pagamentos por Mtodo",["Mtodo","Valor","% do Total"],Te,"pagamentos_por_metodo")},children:[o.jsx(Cg,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),Object.keys(m?.totalPorFinalizadora||{}).length===0?o.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem pagamentos no perodo."}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs(rl,{children:[o.jsx(nl,{children:o.jsxs(Ba,{children:[o.jsx(vn,{children:"Mtodo de Pagamento"}),o.jsx(vn,{className:"text-right",children:"Valor"}),o.jsx(vn,{className:"text-right",children:"% do Total"})]})}),o.jsxs(al,{children:[Object.entries(m?.totalPorFinalizadora||{}).sort(([,H],[,Ee])=>Ee-H).map(([H,Ee])=>{const Te=Object.values(m?.totalPorFinalizadora||{}).reduce((ze,at)=>ze+at,0),vt=(Ee/Te*100).toFixed(1);return o.jsxs(Ba,{children:[o.jsx(en,{className:"font-medium",children:H}),o.jsx(en,{className:"text-right font-semibold",children:sr(Ee)}),o.jsxs(en,{className:"text-right text-text-secondary",children:[vt,"%"]})]},H)}),o.jsxs(Ba,{className:"bg-surface-2 font-bold",children:[o.jsx(en,{children:"TOTAL"}),o.jsx(en,{className:"text-right",children:sr(Object.values(m?.totalPorFinalizadora||{}).reduce((H,Ee)=>H+Ee,0))}),o.jsx(en,{className:"text-right",children:"100%"})]})]})]})})]}),o.jsxs(fr.div,{variants:tl,className:"fx-card p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[o.jsx(ud,{className:"w-5 h-5 text-purple-400"}),"Produtos Mais Vendidos"]}),o.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Top produtos por faturamento"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(oe,{variant:"outline",size:"sm",className:"bg-purple-500/10 border-purple-500/40 text-purple-400 hover:bg-purple-500/20",onClick:()=>{const Ee=[["Posio","Produto","Faturamento"],...C.slice(0,50).map((at,Zt)=>[Zt+1,at.nome,sr(at.valor)])].map(at=>at.map(Zt=>`"${Zt}"`).join(";")).join(`
`),Te=new Blob(["\uFEFF"+Ee],{type:"text/csv;charset=utf-8;"}),vt=URL.createObjectURL(Te),ze=document.createElement("a");ze.href=vt,ze.download=`produtos_vendidos_${Jt(new Date,"yyyy-MM-dd")}.csv`,ze.click(),URL.revokeObjectURL(vt),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[o.jsx(ri,{className:"w-4 h-4 mr-2"}),"CSV"]}),o.jsxs(oe,{variant:"outline",size:"sm",className:"bg-purple-500/10 border-purple-500/40 text-purple-400 hover:bg-purple-500/20",onClick:()=>{const H=C.slice(0,50).map((Ee,Te)=>[Te+1,Ee.nome,sr(Ee.valor)]);Gr("Produtos Mais Vendidos",["#","Produto","Faturamento"],H,"produtos_vendidos")},children:[o.jsx(Cg,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),C.length===0?o.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem produtos vendidos no perodo."}):o.jsxs("div",{className:"overflow-x-auto",children:[o.jsxs(rl,{children:[o.jsx(nl,{children:o.jsxs(Ba,{children:[o.jsx(vn,{className:"w-16",children:"#"}),o.jsx(vn,{children:"Produto"}),o.jsx(vn,{className:"text-right",children:"Faturamento"})]})}),o.jsx(al,{children:C.slice(0,20).map((H,Ee)=>o.jsxs(Ba,{children:[o.jsx(en,{className:"text-text-secondary font-mono",children:Ee+1}),o.jsx(en,{className:"font-medium",children:H.nome}),o.jsx(en,{className:"text-right font-semibold",children:sr(H.valor)})]},`${H.nome}-${Ee}`))})]}),C.length>20&&o.jsx("div",{className:"text-center mt-4",children:o.jsxs(oe,{variant:"ghost",size:"sm",className:"text-brand hover:text-brand/80",onClick:()=>z(!0),children:["Ver todos os ",C.length," produtos"]})})]})]}),o.jsxs(fr.div,{variants:tl,className:"fx-card p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[o.jsx(cl,{className:"w-5 h-5 text-warning"}),"Clientes que Mais Consomem"]}),o.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Ranking por faturamento total"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(oe,{variant:"outline",size:"sm",className:"bg-warning/10 border-warning/40 text-warning hover:bg-warning/20",onClick:()=>{const Ee=[["Posio","Cliente","Faturamento"],...P.slice(0,50).map((at,Zt)=>[Zt+1,at.nome,sr(at.valor)])].map(at=>at.map(Zt=>`"${Zt}"`).join(";")).join(`
`),Te=new Blob(["\uFEFF"+Ee],{type:"text/csv;charset=utf-8;"}),vt=URL.createObjectURL(Te),ze=document.createElement("a");ze.href=vt,ze.download=`clientes_top_${Jt(new Date,"yyyy-MM-dd")}.csv`,ze.click(),URL.revokeObjectURL(vt),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[o.jsx(ri,{className:"w-4 h-4 mr-2"}),"CSV"]}),o.jsxs(oe,{variant:"outline",size:"sm",className:"bg-warning/10 border-warning/40 text-warning hover:bg-warning/20",onClick:()=>{const H=P.slice(0,50).map((Ee,Te)=>[Te+1,Ee.nome,sr(Ee.valor)]);Gr("Clientes que Mais Consomem",["#","Cliente","Total Gasto"],H,"clientes_top")},children:[o.jsx(Cg,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),P.length===0?o.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem dados de clientes no perodo."}):o.jsxs("div",{className:"overflow-x-auto",children:[o.jsxs(rl,{children:[o.jsx(nl,{children:o.jsxs(Ba,{children:[o.jsx(vn,{className:"w-16",children:"#"}),o.jsx(vn,{children:"Cliente"}),o.jsx(vn,{className:"text-right",children:"Total Gasto"})]})}),o.jsx(al,{children:P.slice(0,20).map((H,Ee)=>o.jsxs(Ba,{children:[o.jsx(en,{className:"text-text-secondary font-mono",children:Ee+1}),o.jsx(en,{className:"font-medium",children:H.nome}),o.jsx(en,{className:"text-right font-semibold",children:sr(H.valor)})]},`${H.nome}-${Ee}`))})]}),P.length>20&&o.jsx("div",{className:"text-center mt-4",children:o.jsxs(oe,{variant:"ghost",size:"sm",className:"text-brand hover:text-brand/80",onClick:()=>Y(!0),children:["Ver todos os ",P.length," clientes"]})})]})]}),o.jsxs(fr.div,{variants:tl,className:"fx-card p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[o.jsx(Up,{className:"w-5 h-5 text-success"}),"Evoluo Diria de Receitas"]}),o.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Faturamento dia a dia no perodo"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(oe,{variant:"outline",size:"sm",className:"bg-success/10 border-success/40 text-success hover:bg-success/20",onClick:()=>{const Ee=[["Data","Receita"],...M.map(at=>[at.data,sr(at.valor)])].map(at=>at.map(Zt=>`"${Zt}"`).join(";")).join(`
`),Te=new Blob(["\uFEFF"+Ee],{type:"text/csv;charset=utf-8;"}),vt=URL.createObjectURL(Te),ze=document.createElement("a");ze.href=vt,ze.download=`evolucao_diaria_${Jt(new Date,"yyyy-MM-dd")}.csv`,ze.click(),URL.revokeObjectURL(vt),e({title:"Relatrio exportado",description:"CSV salvo com sucesso"})},children:[o.jsx(ri,{className:"w-4 h-4 mr-2"}),"CSV"]}),o.jsxs(oe,{variant:"outline",size:"sm",className:"bg-success/10 border-success/40 text-success hover:bg-success/20",onClick:()=>{const H=M.map(Ee=>[Ee.data,sr(Ee.valor)]);Gr("Evoluo Diria de Receitas",["Data","Receita"],H,"evolucao_diaria")},children:[o.jsx(Cg,{className:"w-4 h-4 mr-2"}),"PDF"]})]})]}),M.length===0?o.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem dados de evoluo no perodo."}):o.jsx("div",{className:"h-80",children:o.jsx(xj,{width:"100%",height:"100%",children:o.jsxs(Oqe,{data:M,margin:{top:5,right:20,bottom:5,left:0},children:[o.jsx(w3,{strokeDasharray:"3 3",stroke:"#2a2a2a"}),o.jsx(Qp,{dataKey:"data",stroke:"#888",tick:{fill:"#888",fontSize:11},tickFormatter:H=>{const Ee=H.split("/");return`${Ee[0]}/${Ee[1]}`}}),o.jsx(Zp,{stroke:"#888",tick:{fill:"#888",fontSize:11},tickFormatter:H=>`R$ ${(H/1e3).toFixed(0)}k`}),o.jsx(oc,{contentStyle:{backgroundColor:"#1a1a1a",border:"1px solid #333",borderRadius:"8px"},labelStyle:{color:"#fff"},itemStyle:{color:"#22C55E"},formatter:H=>[sr(H),"Receita"]}),o.jsx(ew,{type:"monotone",dataKey:"valor",stroke:"#22C55E",strokeWidth:2,dot:{fill:"#22C55E",r:4},activeDot:{r:6}})]})})})]})]})]}),o.jsx(ln,{open:rr,onOpenChange:nt,children:o.jsxs(on,{className:"max-w-lg",children:[o.jsxs(nn,{children:[o.jsx(rn,{className:"text-xl font-bold",children:"Detalhes do Recebimento"}),o.jsx(_n,{children:$t?.origem==="Comanda"?"Operao de comanda":$t?.origem==="Agendamento"?"Operao de agendamento":"Operao"})]}),$t&&o.jsxs("div",{className:"space-y-3 text-sm",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-text-muted",children:"Data/Hora"}),o.jsx("div",{className:"font-medium",children:$t.recebido_em?new Date($t.recebido_em).toLocaleString("pt-BR"):""})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-text-muted",children:"Valor"}),o.jsx("div",{className:"font-semibold",children:sr($t.valor)})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-text-muted",children:"Origem"}),o.jsx("div",{children:$t.origem||""})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-text-muted",children:"Fonte"}),o.jsx("div",{children:$t.fonte?$t.fonte.toUpperCase():""})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-text-muted",children:"Finalizadora"}),o.jsx("div",{children:$t.finalizadoras?.nome||$t.metodo||""})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-text-muted",children:"Status"}),o.jsx("div",{children:$t.status||""})]})]}),$t.origem==="Comanda"&&o.jsxs("div",{className:"mt-2 p-3 rounded border border-border",children:[o.jsx("div",{className:"font-semibold mb-2",children:"Comanda"}),o.jsx("div",{className:"grid grid-cols-2 gap-3",children:o.jsxs("div",{children:[o.jsx("div",{className:"text-text-muted",children:"Cliente"}),o.jsx("div",{children:$t.descricao||""})]})}),o.jsxs("div",{className:"mt-3",children:[o.jsx("div",{className:"text-text-muted mb-1",children:"Produtos"}),sn?o.jsx("div",{className:"text-xs text-text-muted",children:"Carregando itens..."}):Xr.length===0?o.jsx("div",{className:"text-xs text-text-muted",children:"Sem itens encontrados."}):o.jsx("div",{className:"max-h-48 overflow-y-auto space-y-1",children:Xr.map((H,Ee)=>o.jsxs("div",{className:"text-xs flex justify-between gap-3",children:[o.jsxs("div",{className:"truncate",children:[o.jsx("span",{className:"font-mono",children:$r(H.quantidade)}),o.jsx("span",{children:" x "}),o.jsx("span",{className:"font-medium",children:H.descricao})]}),o.jsx("div",{className:"whitespace-nowrap",children:sr(Number(H.preco_unitario||0)*Number(H.quantidade||0))})]},Ee))})]}),o.jsxs("div",{className:"mt-4",children:[o.jsx("div",{className:"text-text-muted mb-1",children:"Pagamentos"}),qr.length===0?o.jsx("div",{className:"text-xs text-text-muted",children:"Sem pagamentos adicionais."}):o.jsxs("div",{className:"space-y-1",children:[qr.map((H,Ee)=>o.jsxs("div",{className:"text-xs flex justify-between gap-3",children:[o.jsx("div",{className:"truncate",children:o.jsx("span",{className:"font-medium",children:H.finalizadoras?.nome||H.metodo||""})}),o.jsx("div",{className:"whitespace-nowrap",children:sr(H.valor)})]},H.id||Ee)),o.jsxs("div",{className:"text-xs flex justify-between gap-3 pt-2 border-t border-border",children:[o.jsx("div",{className:"font-semibold",children:"Total"}),o.jsx("div",{className:"font-semibold",children:sr(qr.reduce((H,Ee)=>H+Number(Ee.valor||0),0))})]})]})]})]}),$t.origem==="Agendamento"&&o.jsxs("div",{className:"mt-2 p-3 rounded border border-border",children:[o.jsx("div",{className:"font-semibold mb-2",children:"Agendamento"}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-text-muted",children:"Cdigo"}),o.jsxs("div",{className:"font-mono",children:["#",$t.agendamento_codigo]})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-text-muted",children:"Participante"}),o.jsx("div",{children:$t.participante_nome})]}),o.jsxs("div",{className:"col-span-2",children:[o.jsx("div",{className:"text-text-muted",children:"Quadra"}),o.jsx("div",{children:$t.quadra_nome||""})]})]})]})]})]})}),o.jsx(ln,{open:U,onOpenChange:z,children:o.jsxs(on,{className:"max-w-2xl bg-surface text-text-primary border-0",children:[o.jsxs(nn,{children:[o.jsx(rn,{children:"Todos os Produtos"}),o.jsx(_n,{children:"Ordenados por valor de vendas"})]}),o.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:o.jsxs(rl,{children:[o.jsx(nl,{children:o.jsxs(Ba,{children:[o.jsx(vn,{children:"Produto"}),o.jsx(vn,{className:"text-center",children:"Quantidade"}),o.jsx(vn,{className:"text-right",children:"Valor Total"})]})}),o.jsx(al,{children:C.map((H,Ee)=>o.jsxs(Ba,{children:[o.jsxs(en,{children:[Ee+1,". ",H.nome]}),o.jsxs(en,{className:"text-center",children:["x",H.quantidade]}),o.jsx(en,{className:"text-right font-semibold",children:sr(H.valor)})]},`${H.nome}-${Ee}`))})]})})]})}),o.jsx(ln,{open:kt,onOpenChange:Nt,children:o.jsxs(on,{className:"sm:max-w-[900px] w-full max-h-[85vh] overflow-y-auto bg-surface text-text-primary border-0",children:[o.jsxs(nn,{children:[o.jsx(rn,{children:"Fechamento do Caixa"}),o.jsxs(_n,{children:[ft?.sessao?.aberto_em?`${new Date(ft.sessao.aberto_em).toLocaleString("pt-BR")}`:"",ft?.sessao?.fechado_em?`  ${new Date(ft.sessao.fechado_em).toLocaleString("pt-BR")}`:""]})]}),De?o.jsx("div",{className:"text-sm text-text-muted",children:"Carregando..."}):ft?o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Saldo Inicial"}),o.jsx("p",{className:"text-2xl font-bold tabular-nums",children:sr(ft.sessao?.saldo_inicial)})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Total do Dia"}),o.jsx("p",{className:"text-2xl font-bold text-success tabular-nums",children:(()=>{const H=Number(ft.resumo?.totalEntradas||0),Ee=Array.isArray(ft.movimentacoes)?ft.movimentacoes:[];let Te=0,vt=0,ze=0,at=0;for(const zr of Ee){const Ar=String(zr?.tipo||"").toLowerCase(),br=Number(zr?.valor||0);Ar==="suprimento"?Te+=br:Ar==="sangria"?vt+=br:Ar==="troco"?ze+=br:Ar==="ajuste"&&(at+=br)}const Zt=H+Te+at-vt-ze;return sr(Zt)})()})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Saldo Final (contado)"}),o.jsx("p",{className:"text-2xl font-bold tabular-nums",children:(()=>{const H=ft&&typeof ft.valorFinalContado=="number"?ft.valorFinalContado:null;return H!=null?sr(H):""})()})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Descontos"}),o.jsx("p",{className:"text-2xl font-bold text-warning tabular-nums",children:sr(ft.resumo?.totalDescontos)})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Lquido"}),o.jsx("p",{className:"text-2xl font-bold tabular-nums",children:sr(ft.resumo?.totalVendasLiquidas)})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Entradas por Finalizadora"}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2",children:ft.resumo?.totalPorFinalizadora&&Object.keys(ft.resumo.totalPorFinalizadora).length>0?Object.entries(ft.resumo.totalPorFinalizadora).map(([H,Ee])=>o.jsxs("div",{className:"bg-surface-2 rounded-md p-2 border border-border flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary truncate",children:String(H)}),o.jsx("span",{className:"text-sm font-semibold",children:sr(Ee)})]},H)):o.jsx("div",{className:"text-sm text-text-muted",children:"Sem pagamentos."})})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Movimentaes"}),!ft.movimentacoes||ft.movimentacoes.length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Sem movimentaes nesta sesso."}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs(rl,{children:[o.jsx(nl,{children:o.jsxs(Ba,{children:[o.jsx(vn,{children:"Data"}),o.jsx(vn,{children:"Tipo"}),o.jsx(vn,{children:"Obs"}),o.jsx(vn,{className:"text-right",children:"Valor"})]})}),o.jsx(al,{children:ft.movimentacoes.map(H=>o.jsxs(Ba,{children:[o.jsx(en,{children:H.created_at?new Date(H.created_at).toLocaleString("pt-BR"):""}),o.jsx(en,{className:"capitalize",children:H.tipo||""}),o.jsx(en,{className:"truncate max-w-[280px]",title:H.observacao||"",children:H.observacao||""}),o.jsx(en,{className:"text-right font-semibold",children:sr(H.valor)})]},H.id))})]})})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Recebimentos"}),!ft.pagamentos||ft.pagamentos.length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Sem recebimentos no perodo deste caixa."}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs(rl,{children:[o.jsx(nl,{children:o.jsxs(Ba,{children:[o.jsx(vn,{children:"Data/Hora"}),o.jsx(vn,{children:"Finalizadora"}),o.jsx(vn,{className:"text-right",children:"Valor"}),o.jsx(vn,{children:"Status"})]})}),o.jsx(al,{children:ft.pagamentos.map(H=>o.jsxs(Ba,{children:[o.jsx(en,{children:H.recebido_em?new Date(H.recebido_em).toLocaleString("pt-BR"):""}),o.jsx(en,{children:H.finalizadoras?.nome||H.metodo||""}),o.jsx(en,{className:"text-right font-semibold",children:sr(H.valor)}),o.jsx(en,{children:H.status||""})]},H.id))})]})})]})]}):o.jsx("div",{className:"text-sm text-text-muted",children:"Sem dados."})]})}),o.jsx(ln,{open:$,onOpenChange:H=>{Y(H),H||(xe(null),L([]))},children:o.jsxs(on,{className:"max-w-2xl bg-surface text-text-primary border-0",children:[o.jsxs(nn,{children:[o.jsx(rn,{children:"Clientes"}),o.jsx(_n,{children:"Ordenados por valor pago no perodo selecionado"})]}),o.jsx("div",{className:"max-h-[60vh] overflow-y-auto border border-border rounded-md",children:o.jsxs(rl,{children:[o.jsx(nl,{children:o.jsxs(Ba,{children:[o.jsx(vn,{children:"Cliente"}),o.jsx(vn,{className:"text-right",children:"Pago"})]})}),o.jsx(al,{children:P.map((H,Ee)=>o.jsxs(Ba,{className:"cursor-pointer hover:bg-brand/10",onClick:async()=>{K(!0),xe(H),ne(!0);try{const Te=va(c),vt=xa(u),ze=(H.nome||"").trim(),at=t?.codigo_empresa;let Zt=ve.from("clientes").select("id, nome").eq("codigo_empresa",at).ilike("nome",`%${ze}%`);const{data:zr}=await Zt,Ar=new Set((zr||[]).map(Ln=>Ln.id));let br=ve.from("comanda_clientes").select("comanda_id").eq("codigo_empresa",at).ilike("nome_livre",`%${ze}%`);const{data:yr}=await br;let nr=new Set((yr||[]).map(Ln=>Ln.comanda_id));if(Ar.size>0){let Ln=ve.from("comanda_clientes").select("comanda_id, cliente_id").eq("codigo_empresa",at).in("cliente_id",Array.from(Ar));const{data:aa}=await Ln;(aa||[]).forEach(Bn=>nr.add(Bn.comanda_id))}const Zr=Array.from(nr);let tt=ve.from("pagamentos").select("id, valor, recebido_em, metodo, finalizadoras!pagamentos_finalizadora_id_fkey(nome), comanda_id, status").in("comanda_id",Zr).neq("status","Cancelado").neq("status","Estornado").order("recebido_em",{ascending:!1}).limit(50);Te&&(tt=tt.gte("recebido_em",Te)),vt&&(tt=tt.lte("recebido_em",vt));const{data:Lr}=await tt,cn=Lr||[],pn=Array.from(new Set(cn.map(Ln=>Ln.comanda_id).filter(Boolean))),jn={};if(pn.length>0){let Ln=ve.from("comandas").select("id, tipo, mesa_id").in("id",pn);const{data:aa}=await Ln,Bn=Array.from(new Set((aa||[]).map(an=>an.mesa_id).filter(Boolean))),ya={};if(Bn.length>0){let an=ve.from("mesas").select("id, numero, nome").in("id",Bn);const{data:Ea}=await an;(Ea||[]).forEach(Sa=>{ya[Sa.id]=(Sa.nome||`Mesa ${Sa.numero||""}`).trim()})}(aa||[]).forEach(an=>{let Ea="";const Sa=String(an?.tipo||"").toLowerCase();Sa==="balcao"||Sa==="balco"?Ea="Balco":Sa==="mesa"||an.mesa_id?Ea=ya[an.mesa_id]||"Mesa":Sa==="agendamento"&&(Ea="Agendamento"),jn[an.id]=Ea})}let Gn=cn.map(Ln=>({...Ln,origem:Ln.comanda_id&&jn[Ln.comanda_id]||""}));try{const Ln=t?.codigo_empresa;let aa=[];if(Ar&&Ar.size>0){let ba=ve.from("v_agendamento_participantes").select("id, agendamento_id, cliente_id, valor_cota, status_pagamento, status_pagamento_text").in("cliente_id",Array.from(Ar));Ln&&(ba=ba.eq("codigo_empresa",Ln));const{data:Mo}=await ba;if(aa=Mo||[],aa.length===0&&Ln){let vi=ve.from("v_agendamento_participantes").select("id, agendamento_id, cliente_id, valor_cota, status_pagamento, status_pagamento_text").in("cliente_id",Array.from(Ar));const{data:lo}=await vi;aa=lo||[]}}let Bn=[...aa];const ya=Array.from(new Set(Bn.map(ba=>ba.agendamento_id).filter(Boolean)));let an=new Set;const Ea={};if(ya.length>0){let ba=ve.from("agendamentos").select("id, inicio").in("id",ya);Ln&&(ba=ba.eq("codigo_empresa",Ln));const{data:Mo}=await ba,vi=Te?new Date(Te).getTime():null,lo=vt?new Date(vt).getTime():null;(Mo||[]).forEach(zl=>{const yl=zl?.inicio?new Date(zl.inicio).getTime():null;yl!=null&&(vi==null||yl>=vi)&&(lo==null||yl<=lo)&&an.add(zl.id),zl?.id&&(Ea[zl.id]=zl.inicio||null)})}Bn=Bn.filter(ba=>an.has(ba.agendamento_id));const Sa=new Set;console.debug("[Financeiro][Agendamentos][Detalhe] encontrados:",Bn.length),Bn.forEach(ba=>{const Mo=`${ba.id}`;if(Sa.has(Mo))return;Sa.add(Mo);const vi=String(ba.status_pagamento||ba.status_pagamento_text||"pago").toLowerCase();if(["cancelado","estornado"].includes(vi))return;const lo=ba.finalizadora_nome||ba.metodo||ba.metodo_pagamento||ba.forma_pagamento||"Agendamento";Gn.push({id:`ag-${ba.id}`,recebido_em:Ea[ba.agendamento_id]||null,finalizadoras:lo?{nome:lo}:null,metodo:lo,origem:"Agendamento",valor:ba.valor_cota})})}catch{}L(Gn)}finally{ne(!1)}},children:[o.jsx(en,{children:H.nome}),o.jsx(en,{className:"text-right font-semibold",children:sr(H.valor)})]},`${H.nome}-${Ee}`))})]})})]})}),o.jsx(ln,{open:le,onOpenChange:K,children:o.jsxs(on,{className:"max-w-5xl w-[95vw] md:w-[90vw] max-h-[85vh] bg-surface text-text-primary border-0 overflow-hidden flex flex-col",children:[o.jsxs(nn,{className:"flex-shrink-0",children:[o.jsx(rn,{className:"text-lg md:text-xl",children:"Detalhes do Cliente"}),o.jsx(_n,{className:"text-sm md:text-base",children:de?.nome})]}),de?o.jsxs("div",{className:"space-y-4 flex-1 overflow-hidden flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between p-3 md:p-4 bg-surface-2 rounded-lg flex-shrink-0",children:[o.jsx("span",{className:"text-sm md:text-base text-text-secondary",children:"Total Pago no Perodo"}),o.jsx("span",{className:"text-lg md:text-2xl font-bold text-success",children:sr(de.valor)})]}),W?o.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Carregando detalhes..."}):q.length===0?o.jsx("div",{className:"text-sm text-text-muted text-center py-8",children:"Sem pagamentos no perodo selecionado."}):o.jsx("div",{className:"flex-1 overflow-auto border border-border rounded-md",children:o.jsxs(rl,{children:[o.jsx(nl,{className:"sticky top-0 bg-surface z-10",children:o.jsxs(Ba,{children:[o.jsx(vn,{className:"text-xs md:text-sm w-[70px] md:w-auto",children:"Data"}),o.jsx(vn,{className:"text-xs md:text-sm w-[80px] md:w-auto",children:"Finaliz."}),o.jsx(vn,{className:"text-xs md:text-sm w-[60px] md:w-auto",children:"Origem"}),o.jsx(vn,{className:"text-right text-xs md:text-sm w-[70px] md:w-auto",children:"Valor"})]})}),o.jsx(al,{children:q.map(H=>o.jsxs(Ba,{children:[o.jsx(en,{className:"text-xs md:text-sm w-[70px] md:w-auto",children:o.jsx("div",{className:"text-[10px] md:text-xs leading-tight",children:H.recebido_em?new Date(H.recebido_em).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}):""})}),o.jsx(en,{className:"text-xs md:text-sm w-[80px] md:w-auto",children:o.jsx("div",{className:"truncate max-w-[80px] md:max-w-[200px] text-[10px] md:text-xs",title:H.finalizadoras?.nome||H.metodo||"",children:H.finalizadoras?.nome||H.metodo||""})}),o.jsx(en,{className:"text-xs md:text-sm w-[60px] md:w-auto",children:o.jsx("div",{className:"truncate max-w-[60px] md:max-w-[150px] text-[10px] md:text-xs",title:H.origem||"",children:H.origem||""})}),o.jsx(en,{className:"text-right font-semibold text-xs md:text-sm w-[70px] md:w-auto",children:o.jsx("div",{className:"text-[10px] md:text-xs whitespace-nowrap",children:sr(H.valor)})})]},H.id))})]})})]}):o.jsx("div",{className:"text-sm text-text-muted py-8 text-center",children:"Nenhum cliente selecionado"})]})})]})})}const Oot={hidden:{opacity:0},visible:{opacity:1,transition:{when:"beforeChildren",staggerChildren:.06,delayChildren:.05}}},sR={hidden:{opacity:0,y:12},visible:{opacity:1,y:0,transition:{duration:.35}}};function Iot({children:e,className:t=""}){return o.jsx(fr.div,{variants:sR,className:`fx-card ${t}`,children:e})}const NE=({icon:e,title:t,value:r,subtitle:n,color:a})=>{const i=e;return o.jsxs(fr.div,{variants:sR,className:"bg-surface rounded-lg border-2 border-border hover:border-border-hover p-4 flex flex-col justify-between gap-2 transition-all duration-300",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("p",{className:"text-text-secondary text-sm font-semibold",children:t}),o.jsx(i,{className:`w-5 h-5 ${a}`})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-text-primary",children:r}),o.jsx("p",{className:"text-xs text-text-muted",children:n})]})]})};function mU({label:e,...t}){return o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:e}),o.jsx("input",{...t,className:`bg-surface-2 border border-border rounded-md px-3 py-2 text-sm ${t.className||""}`})]})}function Tot(){const{toast:e}=oo(),{userProfile:t,authReady:r}=Do(),n=p.useRef(!1),[a,i]=p.useState(()=>{try{const se=JSON.parse(localStorage.getItem("quadras:list")||"[]");return Array.isArray(se)?se:[]}catch{return[]}}),[s,l]=p.useState(()=>{try{const se=JSON.parse(localStorage.getItem("quadras:list")||"[]");return!(Array.isArray(se)&&se.length>0)}catch{return!0}}),[c,d]=p.useState(!1),[u,f]=p.useState(!1),[m,h]=p.useState({nome:"",descricao:"",modalidades:[],tipo:"Descoberta",status:"Ativa",hora_inicio:"06:00",hora_fim:"23:59",valor_hora:""}),[v,g]=p.useState(""),[y,x]=p.useState(!1),[b,w]=p.useState(null),[j,_]=p.useState({nome:"",descricao:"",modalidades:[],tipo:"Descoberta",status:"Ativa",hora_inicio:"06:00",hora_fim:"23:59",valor_hora:""}),[C,E]=p.useState(""),[P,k]=p.useState(!0),[M,S]=p.useState({mostUsed:"-",topClient:"-",totalBookings:"-"}),[I,T]=p.useState(!1),[D,B]=p.useState(null),[U,z]=p.useState({0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0}),[$,Y]=p.useState([]),[de,xe]=p.useState(""),[q,L]=p.useState(""),[W,ne]=p.useState(!1),le=se=>{if(!se)return null;const[rt,mt]=String(se).split(":");return`${rt.padStart(2,"0")}:${mt.padStart(2,"0")}:00`},K=se=>{const rt=String(se??"").replace(/\D/g,"");if(!rt)return"";const mt=(Number(rt)/100).toFixed(2),[tr,Ce]=mt.split(".");return`${tr.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${Ce}`},Q=se=>{if(se==null||se==="")return NaN;const rt=String(se).replace(/\./g,"").replace(",","."),mt=parseFloat(rt);return Number.isFinite(mt)?mt:NaN},re=(se,rt=!1)=>{if(se==null||!Number.isFinite(Number(se)))return"-";const tr=Number(se).toFixed(2).split("."),Ce=tr[0],je=tr[1],$e=`${Ce.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${je}`;return rt?`R$ ${$e}`:$e},G=se=>{if(!se)return"";const[rt,mt]=String(se).split(":");return`${String(rt).padStart(2,"0")}:${String(mt).padStart(2,"0")}`},me=se=>{if(!se)return 0;const[rt,mt]=String(se).split(":").map(Number);return(rt===0&&mt===0?24:rt||0)*60+(mt||0)},pe=se=>{if(!se)return!1;const rt=String(se).split(":");if(rt.length<2)return!1;const mt=Number(rt[1]);return mt===0||mt===30},Be=se=>{if(!se)return"";const[rt,mt]=String(se).split(":");let tr=Math.max(0,Math.min(23,parseInt(rt||"0",10))),Ce=Math.max(0,Math.min(59,parseInt(mt||"0",10)));const je=Math.round(Ce/30);if(je>=2?(tr+=1,Ce=0):Ce=je*30,tr>=24)return"23:59";const ae=String(tr).padStart(2,"0"),$e=String(Ce).padStart(2,"0");return`${ae}:${$e}`};p.useEffect(()=>{if(!c)return;const se=setTimeout(()=>{console.error("[Quadras] add/update stuck >15s",{route:"/quadras",codigo_empresa:t?.codigo_empresa,editingId:b,formQuadra:m,editForm:j})},15e3);return()=>clearTimeout(se)},[c,t?.codigo_empresa,b,m,j]);const Z=async()=>{if(!t?.codigo_empresa)return;const se=a&&a.length>0;se||l(!0);const{data:rt,error:mt}=await ve.from("quadras").select("*").eq("codigo_empresa",t.codigo_empresa).order("nome",{ascending:!0});if(mt){if(!n.current){n.current=!0,setTimeout(Z,800),se||l(!1);return}e({title:"Erro ao carregar quadras",description:mt.message}),se||l(!1);return}const tr=rt||[];if(tr.length===0&&se&&!n.current){n.current=!0,setTimeout(Z,600),se||l(!1);return}n.current=!1,i(tr);try{localStorage.setItem("quadras:list",JSON.stringify(tr))}catch{}se||l(!1)},ee=se=>{w(se.id),_({nome:se.nome||"",descricao:se.descricao||"",modalidades:Array.isArray(se.modalidades)?se.modalidades:se.modalidades?[se.modalidades]:[],tipo:se.tipo||"Descoberta",status:se.status||"Ativa",hora_inicio:G(se.hora_inicio||"06:00:00"),hora_fim:G(se.hora_fim||"24:00:00")||"23:59",valor_hora:se.valor!=null&&se.valor!==""?K(String((Number(se.valor)*2).toFixed(2))):""}),E(""),x(!0)},kt=async()=>{if(!j.nome?.trim()){e({title:"Nome obrigatrio",description:"Informe um nome para a quadra."});return}if(!j.hora_inicio||!j.hora_fim){e({title:"Horrio obrigatrio",description:"Informe horrio de abertura e fechamento."});return}if(!pe(j.hora_inicio)||!pe(j.hora_fim)){e({title:"Intervalo invlido",description:"Use apenas horrios em horas cheias ou :30."});return}if(me(j.hora_fim)<=me(j.hora_inicio)){e({title:"Horrio invlido",description:"Fechamento deve ser depois da abertura."});return}if(!j.modalidades?.length){e({title:"Adicione ao menos uma modalidade",description:"Informe e adicione uma modalidade usando o boto +."});return}if(!t?.codigo_empresa||!b){e({title:"Atualizao indisponvel",description:"Dados insuficientes para atualizar."});return}d(!0);const se={nome:j.nome.trim(),descricao:j.descricao?.trim()||null,modalidades:j.modalidades,tipo:j.tipo,status:j.status,hora_inicio:le(j.hora_inicio),hora_fim:le(j.hora_fim==="24:00"?"23:59":j.hora_fim)};if(j.valor_hora!=null&&String(j.valor_hora).trim()!==""){const Ce=Q(j.valor_hora);!Number.isNaN(Ce)&&Number.isFinite(Ce)&&(se.valor=Math.round(Ce/2*100)/100)}else se.valor=null;const rt=(Ce,je)=>Promise.race([Ce,new Promise((ae,$e)=>setTimeout(()=>$e(new Error("Timeout ao atualizar quadra (>12s)")),je))]);let mt,tr;try{({data:mt,error:tr}=await rt(ve.from("quadras").update(se).eq("codigo_empresa",t.codigo_empresa).eq("id",b).select("id,nome,descricao,modalidades,tipo,status,hora_inicio,hora_fim,valor").single(),12e3))}catch(Ce){console.error("update timeout/error",Ce),e({title:"Tempo excedido",description:"Sem resposta do servidor ao atualizar. Verifique conexo e tente novamente."}),d(!1);return}if(d(!1),tr){e({title:"Erro ao atualizar quadra",description:tr.message});return}if(!mt){await Z(),e({title:"Quadra atualizada",description:`${se.nome} foi atualizada.`}),x(!1),w(null),E("");return}e({title:"Quadra atualizada",description:`${mt.nome} foi atualizada.`}),x(!1),w(null),E(""),i(Ce=>Ce.map(je=>je.id===mt.id?mt:je).sort((je,ae)=>je.nome.localeCompare(ae.nome)))};p.useEffect(()=>{try{const se=JSON.parse(localStorage.getItem("quadras:list")||"[]");Array.isArray(se)&&se.length&&a.length===0&&(i(se),l(!1))}catch{}},[]),p.useEffect(()=>{r&&t?.codigo_empresa&&(Z(),Nt())},[r,t?.codigo_empresa]);const Nt=async()=>{if(t?.codigo_empresa)try{const se=new Date;se.setDate(se.getDate()-30);const{data:rt}=await ve.from("agendamentos").select("quadra_id, cliente_id, quadras!inner(nome), clientes(nome, codigo)").eq("codigo_empresa",t.codigo_empresa).gte("inicio",se.toISOString()).neq("status","canceled");if(!rt||rt.length===0){S({mostUsed:"Sem dados",topClient:"Sem dados",totalBookings:"0"});return}const mt={};rt.forEach(ae=>{const $e=ae.quadras?.nome||"Sem nome";mt[$e]=(mt[$e]||0)+1});const tr=Object.entries(mt).sort((ae,$e)=>$e[1]-ae[1])[0],Ce={};rt.forEach(ae=>{if(ae.cliente_id&&ae.clientes?.nome){const $e=ae.clientes?.codigo;if($e===0||$e==="0")return;const Ae=ae.clientes.nome;Ce[Ae]=(Ce[Ae]||0)+1}});const je=Object.entries(Ce).sort((ae,$e)=>$e[1]-ae[1])[0];S({mostUsed:tr?`${tr[0]} (${tr[1]})`:"Sem dados",topClient:je?`${je[0]} (${je[1]})`:"Sem dados",totalBookings:rt.length.toString()})}catch(se){console.error("Erro ao carregar stats:",se),S({mostUsed:"Erro",topClient:"Erro",totalBookings:"0"})}},De=async()=>{if(console.groupCollapsed("[Quadras] addQuadra: CLICK"),console.time("[Quadras] addQuadra duration"),console.log("pre-validate",{codigo_empresa:t?.codigo_empresa,formQuadra:m}),!m.nome?.trim()){e({title:"Nome obrigatrio",description:"Informe um nome para a quadra."}),console.warn("validation: missing nome"),console.groupEnd();return}if(!m.modalidades?.length){e({title:"Adicione ao menos uma modalidade",description:"Informe e adicione uma modalidade usando o boto +."});return}if(!m.hora_inicio||!m.hora_fim){e({title:"Horrio obrigatrio",description:"Informe horrio de abertura e fechamento."});return}if(!pe(m.hora_inicio)||!pe(m.hora_fim)){e({title:"Intervalo invlido",description:"Use apenas horrios em horas cheias ou :30."});return}if(me(m.hora_fim)<=me(m.hora_inicio)){e({title:"Horrio invlido",description:"Fechamento deve ser depois da abertura."});return}if(!t?.codigo_empresa){e({title:"Empresa no localizada",description:"Associe o usurio a uma empresa para cadastrar quadras."});return}d(!0),console.log("validated, building payload");const se={codigo_empresa:t.codigo_empresa,nome:m.nome.trim(),descricao:m.descricao?.trim()||null,modalidades:m.modalidades,tipo:m.tipo,status:m.status,hora_inicio:le(m.hora_inicio),hora_fim:le(m.hora_fim==="24:00"?"23:59":m.hora_fim)};if(m.valor_hora!=null&&String(m.valor_hora).trim()!==""){const Ce=Q(m.valor_hora);!Number.isNaN(Ce)&&Number.isFinite(Ce)&&(se.valor=Math.round(Ce/2*100)/100)}console.log("payload",se);const rt=(Ce,je)=>Promise.race([Ce,new Promise((ae,$e)=>setTimeout(()=>$e(new Error("Timeout ao inserir quadra (>12s)")),je))]);let mt,tr;try{({data:mt,error:tr}=await rt(ve.from("quadras").insert(se).select("id,nome,descricao,modalidades,tipo,status,hora_inicio,hora_fim,valor").single(),12e3))}catch(Ce){d(!1),console.error("insert timeout/error",Ce),e({title:"Tempo excedido",description:"Sem resposta do servidor ao cadastrar. Verifique conexo e tente novamente."}),console.timeEnd("[Quadras] addQuadra duration"),console.groupEnd();return}if(d(!1),tr){e({title:"Erro ao cadastrar quadra",description:tr.message}),console.error("insert error",{code:tr.code,message:tr.message,details:tr.details}),console.timeEnd("[Quadras] addQuadra duration"),console.groupEnd();return}if(!mt){console.warn("insert success sem representao; recarregando lista"),await Z(),e({title:"Quadra adicionada",description:`${se.nome} foi cadastrada.`}),h({nome:"",descricao:"",modalidades:[],tipo:"Descoberta",status:"Ativa",hora_inicio:"06:00",hora_fim:"23:59",valor_hora:""}),f(!1),g(""),console.timeEnd("[Quadras] addQuadra duration"),console.groupEnd();return}console.log("insert success",{id:mt?.id,nome:mt?.nome}),e({title:"Quadra adicionada",description:`${mt.nome} foi cadastrada.`}),h({nome:"",descricao:"",modalidades:[],tipo:"Descoberta",status:"Ativa",hora_inicio:"06:00",hora_fim:"23:59",valor_hora:""}),f(!1),g(""),i(Ce=>[mt,...Ce].sort((je,ae)=>je.nome.localeCompare(ae.nome))),console.timeEnd("[Quadras] addQuadra duration"),console.groupEnd()},st=async se=>{B(se),ne(!0);try{const{data:rt,error:mt}=await ve.from("quadras_dias_funcionamento").select("*").eq("quadra_id",se.id).eq("codigo_empresa",t.codigo_empresa);if(mt)throw mt;const tr={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0},Ce=[];rt?.forEach(je=>{je.tipo==="dia_semana"?tr[je.dia_semana]=je.funciona:je.tipo==="data_fechamento"&&Ce.push(je)}),z(tr),Y(Ce),T(!0)}catch(rt){console.error("Erro ao carregar dias de funcionamento:",rt),e({title:"Erro",description:"No foi possvel carregar as configuraes."})}finally{ne(!1)}},ft=async()=>{if(D){ne(!0);try{await ve.from("quadras_dias_funcionamento").delete().eq("quadra_id",D.id).eq("tipo","dia_semana");const se=Object.entries(U).map(([mt,tr])=>({quadra_id:D.id,codigo_empresa:t.codigo_empresa,tipo:"dia_semana",dia_semana:parseInt(mt),funciona:tr,observacao:"Configurao de dias da semana"})),{error:rt}=await ve.from("quadras_dias_funcionamento").insert(se);if(rt)throw rt;e({title:"Sucesso",description:"Dias da semana salvos com sucesso!"})}catch(se){console.error("Erro ao salvar dias da semana:",se),e({title:"Erro",description:"No foi possvel salvar as configuraes."})}finally{ne(!1)}}},yt=async()=>{if(!(!D||!de)){ne(!0);try{const{data:se,error:rt}=await ve.from("quadras_dias_funcionamento").insert({quadra_id:D.id,codigo_empresa:t.codigo_empresa,tipo:"data_fechamento",data_fechamento:de,funciona:!1,observacao:q||"Fechamento especial"}).select().single();if(rt)throw rt;Y(mt=>[...mt,se]),xe(""),L(""),e({title:"Sucesso",description:"Data de fechamento adicionada!"})}catch(se){console.error("Erro ao adicionar data de fechamento:",se),e({title:"Erro",description:"No foi possvel adicionar a data de fechamento."})}finally{ne(!1)}}},Nr=async se=>{ne(!0);try{const{error:rt}=await ve.from("quadras_dias_funcionamento").delete().eq("id",se);if(rt)throw rt;Y(mt=>mt.filter(tr=>tr.id!==se)),e({title:"Sucesso",description:"Data de fechamento removida!"})}catch(rt){console.error("Erro ao remover data de fechamento:",rt),e({title:"Erro",description:"No foi possvel remover a data de fechamento."})}finally{ne(!1)}};return o.jsx(o.Fragment,{children:o.jsxs(fr.div,{variants:Oot,initial:"hidden",animate:"visible",className:"space-y-6",children:[o.jsxs(fr.div,{variants:sR,className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-black text-text-primary tracking-tighter",children:"Controle de Quadras"}),o.jsx("p",{className:"text-text-secondary",children:"Gerencie as quadras e horrios disponveis."})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(oe,{variant:"outline",size:"icon",onClick:()=>k(se=>!se),title:P?"Ocultar resumo":"Mostrar resumo","aria-label":P?"Ocultar resumo":"Mostrar resumo",children:P?o.jsx(Sp,{className:"h-4 w-4"}):o.jsx(zp,{className:"h-4 w-4"})}),o.jsx(oe,{onClick:()=>f(!0),className:"shadow-sm",children:"Adicionar Quadra"})]})]}),P&&o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[o.jsx(NE,{icon:$d,title:"Quadra Mais Usada",value:M.mostUsed,subtitle:"ltimos 30 dias",color:"text-brand"}),o.jsx(NE,{icon:cl,title:"Cliente Top",value:M.topClient,subtitle:"Mais agendamentos no ms",color:"text-purple"}),o.jsx(NE,{icon:Up,title:"Total de Agendamentos",value:M.totalBookings,subtitle:"ltimos 30 dias",color:"text-success"})]}),o.jsxs(Iot,{children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h2",{className:"text-lg font-bold text-text-primary",children:"Quadras"}),o.jsx("div",{className:"text-xs text-text-muted",children:s?"Carregando...":`${a.length} registro(s)`})]}),!s&&a.length===0?o.jsxs("div",{className:"text-sm text-text-muted py-8 text-center",children:[o.jsx("div",{className:"font-medium mb-1",children:"Nenhuma quadra cadastrada"}),o.jsx("div",{className:"mb-4",children:'Clique em "Adicionar Quadra" para cadastrar a primeira.'}),o.jsx(oe,{onClick:()=>f(!0),children:"Adicionar Quadra"})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"md:hidden space-y-3",children:a.map(se=>o.jsxs("div",{className:"rounded-lg border border-border bg-surface p-4 space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between gap-3",children:[o.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[o.jsx("span",{className:"inline-block w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:hm(se.nome),boxShadow:"0 0 0 2px rgba(255,255,255,0.06)"},"aria-hidden":"true"}),o.jsx("span",{className:"font-semibold text-base text-text-primary truncate",children:se.nome})]}),o.jsx("span",{className:`inline-flex px-2 py-0.5 rounded-full text-xs border flex-shrink-0 ${se.status==="Ativa"?"bg-emerald-50/5 border-emerald-500/30 text-emerald-400":se.status==="Manuteno"?"bg-amber-50/5 border-amber-500/30 text-amber-400":"bg-surface-2 border-border text-text-muted"}`,children:se.status})]}),Array.isArray(se.modalidades)&&se.modalidades.length>0&&o.jsxs("div",{children:[o.jsx("span",{className:"text-xs text-text-muted mb-1 block",children:"Modalidades"}),o.jsx("div",{className:"flex flex-wrap gap-1",children:se.modalidades.map(rt=>o.jsx("span",{className:"inline-flex px-2 py-0.5 rounded-full bg-surface-2 border border-border text-xs",children:rt},rt))})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-xs text-text-muted block mb-1",children:"Valor/hora"}),o.jsx("span",{className:"text-sm font-medium",children:se.valor==null||se.valor===""?"-":re(Number(se.valor)*2,!0)})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-xs text-text-muted block mb-1",children:"Funcionamento"}),o.jsxs("span",{className:"text-sm font-medium",children:[G(se.hora_inicio)," - ",G(se.hora_fim==="24:00:00"?"23:59:00":se.hora_fim)]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>st(se),className:"flex items-center gap-1",children:[o.jsx(Ei,{className:"h-3 w-3"}),"Dias"]}),o.jsx(oe,{variant:"outline",size:"sm",onClick:()=>ee(se),children:"Editar"})]})]},se.id))}),o.jsx("div",{className:"hidden md:block overflow-x-auto rounded-lg border border-border bg-surface-0",children:o.jsxs(rl,{children:[o.jsx(nl,{className:"bg-surface-2/60 backdrop-blur supports-[backdrop-filter]:bg-surface-2/70",children:o.jsxs(Ba,{children:[o.jsx(vn,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Nome"}),o.jsx(vn,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Modalidades"}),o.jsx(vn,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Valor por hora"}),o.jsx(vn,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Funcionamento"}),o.jsx(vn,{className:"text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Status"}),o.jsx(vn,{className:"text-right text-[11px] md:text-xs uppercase tracking-wide text-text-muted",children:"Aes"})]})}),o.jsx(al,{children:a.map(se=>o.jsxs(Ba,{className:"hover:bg-surface-2/40 transition-colors",children:[o.jsx(en,{className:"font-medium text-sm md:text-base text-text-primary",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"inline-block w-2.5 h-2.5 rounded-full",style:{backgroundColor:hm(se.nome),boxShadow:"0 0 0 2px rgba(255,255,255,0.06)"},"aria-hidden":"true"}),o.jsx("span",{children:se.nome})]})}),o.jsx(en,{className:"text-sm md:text-base",children:Array.isArray(se.modalidades)&&se.modalidades.length>0?o.jsx("div",{className:"flex flex-wrap gap-1",children:se.modalidades.map(rt=>o.jsx("span",{className:"inline-flex px-2 py-0.5 rounded-full bg-surface-2 border border-border text-[11px] md:text-xs",children:rt},rt))}):se.modalidades||""}),o.jsx(en,{className:"text-sm md:text-base",children:se.valor==null||se.valor===""?"-":o.jsx("span",{className:"inline-flex px-2 py-0.5 rounded-full bg-surface-2 border border-border text-[11px] md:text-xs",children:re(Number(se.valor)*2,!0)})}),o.jsxs(en,{className:"text-sm md:text-base",children:[G(se.hora_inicio)," - ",G(se.hora_fim==="24:00:00"?"23:59:00":se.hora_fim)]}),o.jsx(en,{className:"text-sm md:text-base",children:o.jsx("span",{className:`inline-flex px-2 py-0.5 rounded-full text-[11px] md:text-xs border ${se.status==="Ativa"?"bg-emerald-50/5 border-emerald-500/30 text-emerald-400":se.status==="Manuteno"?"bg-amber-50/5 border-amber-500/30 text-amber-400":"bg-surface-2 border-border text-text-muted"}`,children:se.status})}),o.jsx(en,{className:"text-right",children:o.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[o.jsxs(oe,{variant:"outline",size:"sm",onClick:()=>st(se),className:"text-sm",children:[o.jsx(Ei,{className:"h-3 w-3 mr-1"}),"Dias"]}),o.jsx(oe,{variant:"outline",size:"sm",onClick:()=>ee(se),className:"text-sm",children:"Editar"})]})})]},se.id))})]})})]})]}),o.jsx(ln,{open:u,onOpenChange:f,children:o.jsxs(on,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[o.jsxs(nn,{children:[o.jsx(rn,{children:"Adicionar Quadra"}),o.jsx(_n,{children:"Cadastre uma nova quadra da sua empresa."})]}),o.jsxs("div",{className:"grid gap-4 py-2",children:[o.jsx(mU,{label:"Nome",value:m.nome,onChange:se=>h({...m,nome:se.target.value}),placeholder:"Ex.: Quadra Society 2"}),o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Descrio (opcional)"}),o.jsx("textarea",{value:m.descricao,onChange:se=>h({...m,descricao:se.target.value}),placeholder:"Ex.: Quadra oficial com grama sinttica, iluminao LED, vestirios completos",rows:3,className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm resize-none"})]}),o.jsxs("div",{className:"flex flex-col gap-2 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Modalidades"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{type:"text",value:v,onChange:se=>g(se.target.value),onKeyDown:se=>{if(se.key==="Enter"){se.preventDefault();const rt=v.trim();if(!rt)return;h(mt=>mt.modalidades.some(Ce=>Ce.toLowerCase()===rt.toLowerCase())?mt:{...mt,modalidades:[...mt.modalidades,rt]}),g("")}},placeholder:"Ex.: Society",className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm w-60 sm:w-72 focus:outline-none focus:ring-2 focus:ring-primary/30"}),o.jsx(oe,{type:"button",variant:"secondary",className:"bg-amber-500 hover:bg-amber-400 text-black disabled:opacity-50 disabled:cursor-not-allowed",disabled:!v.trim(),onClick:()=>{const se=v.trim();se&&(h(rt=>rt.modalidades.some(tr=>tr.toLowerCase()===se.toLowerCase())?rt:{...rt,modalidades:[...rt.modalidades,se]}),g(""))},"aria-label":"Adicionar modalidade",title:"Adicionar modalidade",children:"+"})]}),m.modalidades.length>0&&o.jsx("div",{className:"flex flex-wrap gap-2",children:m.modalidades.map(se=>o.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full border border-border bg-surface-2 text-xs",children:[o.jsx("span",{className:"px-0.5",children:se}),o.jsx("button",{type:"button",className:"text-text-muted hover:text-destructive/80",onClick:()=>h(rt=>({...rt,modalidades:rt.modalidades.filter(mt=>mt!==se)})),"aria-label":`Remover ${se}`,title:`Remover ${se}`,children:""})]},se))})]}),o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Tipo"}),o.jsxs("select",{value:m.tipo,onChange:se=>h({...m,tipo:se.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[o.jsx("option",{children:"Descoberta"}),o.jsx("option",{children:"Coberta"})]})]}),o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Valor por hora (R$)"}),o.jsx("input",{type:"text",inputMode:"decimal",step:"0.01",placeholder:"0,00",value:m.valor_hora,onChange:se=>h({...m,valor_hora:K(se.target.value)}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm w-40"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Abertura"}),o.jsx("input",{type:"time",step:"1800",value:m.hora_inicio,onChange:se=>h({...m,hora_inicio:se.target.value}),onBlur:se=>h(rt=>({...rt,hora_inicio:Be(se.target.value)})),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]}),o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Fechamento"}),o.jsx("input",{type:"time",step:"1800",value:m.hora_fim,onChange:se=>h({...m,hora_fim:se.target.value}),onBlur:se=>h(rt=>({...rt,hora_fim:Be(se.target.value)})),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]})]}),o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Status"}),o.jsxs("select",{value:m.status,onChange:se=>h({...m,status:se.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[o.jsx("option",{children:"Ativa"}),o.jsx("option",{children:"Inativa"}),o.jsx("option",{children:"Manuteno"})]})]})]}),o.jsx(Un,{children:o.jsx(oe,{onClick:De,disabled:c||m.modalidades.length===0,children:c?"Adicionando...":"Salvar"})})]})}),o.jsx(ln,{open:y,onOpenChange:x,children:o.jsxs(on,{className:"sm:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[o.jsxs(nn,{children:[o.jsx(rn,{children:"Editar Quadra"}),o.jsx(_n,{children:"Atualize os dados da quadra selecionada."})]}),o.jsxs("div",{className:"grid gap-4 py-2",children:[o.jsx(mU,{label:"Nome",value:j.nome,onChange:se=>_({...j,nome:se.target.value}),placeholder:"Ex.: Quadra Society 2"}),o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Descrio (opcional)"}),o.jsx("textarea",{value:j.descricao,onChange:se=>_({...j,descricao:se.target.value}),placeholder:"Ex.: Quadra oficial com grama sinttica, iluminao LED, vestirios completos",rows:3,className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm resize-none"})]}),o.jsxs("div",{className:"flex flex-col gap-2 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Modalidades"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{type:"text",value:C,onChange:se=>E(se.target.value),onKeyDown:se=>{if(se.key==="Enter"){se.preventDefault();const rt=C.trim();if(!rt)return;_(mt=>mt.modalidades.some(Ce=>Ce.toLowerCase()===rt.toLowerCase())?mt:{...mt,modalidades:[...mt.modalidades,rt]}),E("")}},placeholder:"Ex.: Society",className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm w-60 sm:w-72 focus:outline-none focus:ring-2 focus:ring-primary/30"}),o.jsx(oe,{type:"button",variant:"secondary",onClick:()=>{const se=C.trim();se&&(_(rt=>rt.modalidades.some(tr=>tr.toLowerCase()===se.toLowerCase())?rt:{...rt,modalidades:[...rt.modalidades,se]}),E(""))},children:"+"})]}),j.modalidades.length>0&&o.jsx("div",{className:"flex flex-wrap gap-2",children:j.modalidades.map(se=>o.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full border border-border bg-surface-2 text-xs",children:[o.jsx("span",{className:"px-0.5",children:se}),o.jsx("button",{type:"button",className:"text-text-muted hover:text-destructive/80",onClick:()=>_(rt=>({...rt,modalidades:rt.modalidades.filter(mt=>mt!==se)})),"aria-label":`Remover ${se}`,title:`Remover ${se}`,children:""})]},se))})]}),o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Tipo"}),o.jsxs("select",{value:j.tipo,onChange:se=>_({...j,tipo:se.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[o.jsx("option",{children:"Descoberta"}),o.jsx("option",{children:"Coberta"})]})]}),o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Valor por hora (R$)"}),o.jsx("input",{type:"text",inputMode:"decimal",step:"0.01",placeholder:"0,00",value:j.valor_hora,onChange:se=>_({...j,valor_hora:K(se.target.value)}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm w-40"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Abertura"}),o.jsx("input",{type:"time",step:"1800",value:j.hora_inicio,onChange:se=>_({...j,hora_inicio:se.target.value}),onBlur:se=>_(rt=>({...rt,hora_inicio:Be(se.target.value)})),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]}),o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Fechamento"}),o.jsx("input",{type:"time",step:"1800",value:j.hora_fim,onChange:se=>_({...j,hora_fim:se.target.value}),onBlur:se=>_(rt=>({...rt,hora_fim:Be(se.target.value)})),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]})]}),o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Status"}),o.jsxs("select",{value:j.status,onChange:se=>_({...j,status:se.target.value}),className:"bg-surface-2 border border-border rounded-md px-3 py-2 text-sm",children:[o.jsx("option",{children:"Ativa"}),o.jsx("option",{children:"Inativa"}),o.jsx("option",{children:"Manuteno"})]})]})]}),o.jsx(Un,{children:o.jsx(oe,{onClick:kt,disabled:c||j.modalidades.length===0,children:c?"Salvando...":"Salvar alteraes"})})]})}),o.jsx(ln,{open:I,onOpenChange:T,children:o.jsxs(on,{className:"sm:max-w-[600px] max-h-[90vh] overflow-hidden pointer-events-none",children:[o.jsx("div",{className:"fixed inset-0 z-50 backdrop-blur-lg bg-black/60 flex items-center justify-center pointer-events-auto",children:o.jsx("div",{className:"rounded-2xl border border-white/30 bg-slate-900 shadow-2xl max-w-sm w-full text-center mx-4",children:o.jsxs("div",{className:"px-8 py-10",children:[o.jsxs("div",{className:"flex items-center justify-center gap-4 mb-8",children:[o.jsx("div",{className:"w-14 h-14 bg-brand rounded-xl flex items-center justify-center flex-shrink-0",children:o.jsx($d,{className:"w-8 h-8 text-primary-foreground"})}),o.jsxs("div",{className:"flex items-baseline select-none",children:[o.jsx("span",{className:"font-extrabold text-3xl",style:{color:"#FF6600"},children:"Fluxo"}),o.jsx("span",{className:"font-extrabold text-3xl",style:{color:"#FFAA33"},children:"7"}),o.jsx("span",{className:"font-medium text-3xl",style:{color:"#FFFFFF"},children:" Arena"})]})]}),o.jsx("div",{className:"text-2xl font-bold text-white mb-3",children:"Em Desenvolvimento"}),o.jsx("p",{className:"text-base text-gray-200",children:"Esta funcionalidade est sendo desenvolvida e em breve estar disponvel."}),o.jsx("div",{className:"mt-8 flex items-center justify-center",children:o.jsx(oe,{variant:"outline",onClick:()=>T(!1),children:"Fechar"})})]})})}),o.jsxs(nn,{children:[o.jsxs(rn,{className:"flex items-center gap-2",children:[o.jsx(Ei,{className:"h-5 w-5"}),"Dias de Funcionamento - ",D?.nome]}),o.jsx(_n,{children:"Configure os dias da semana que a quadra funciona e adicione datas especficas de fechamento."})]}),W?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx("div",{className:"text-sm text-text-muted",children:"Carregando configuraes..."})}):o.jsxs("div",{className:"space-y-6 py-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-semibold text-text-primary mb-3",children:"Dias da Semana"}),o.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[{key:0,label:"Domingo",short:"Dom"},{key:1,label:"Segunda",short:"Seg"},{key:2,label:"Tera",short:"Ter"},{key:3,label:"Quarta",short:"Qua"},{key:4,label:"Quinta",short:"Qui"},{key:5,label:"Sexta",short:"Sex"},{key:6,label:"Sbado",short:"Sb"}].map(se=>o.jsxs("label",{className:"flex items-center gap-2 p-3 rounded-lg border border-border hover:bg-surface-2/50 cursor-pointer transition-colors",children:[o.jsx("input",{type:"checkbox",checked:U[se.key],onChange:rt=>z(mt=>({...mt,[se.key]:rt.target.checked})),className:"w-4 h-4 text-primary bg-surface-2 border-border rounded focus:ring-primary focus:ring-2"}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"text-sm font-medium text-text-primary",children:se.short}),o.jsx("span",{className:"text-xs text-text-muted hidden sm:block",children:se.label})]})]},se.key))}),o.jsx("div",{className:"mt-4",children:o.jsx(oe,{onClick:ft,disabled:W,size:"sm",children:W?"Salvando...":"Salvar Dias da Semana"})})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-semibold text-text-primary mb-3",children:"Datas de Fechamento"}),o.jsx("div",{className:"bg-surface-2/30 rounded-lg p-4 mb-4",children:o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"Data"}),o.jsx("input",{type:"date",value:de,onChange:se=>xe(se.target.value),className:"w-full bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs text-text-muted mb-1",children:"Observao"}),o.jsx("input",{type:"text",placeholder:"Ex: Feriado, Manuteno",value:q,onChange:se=>L(se.target.value),className:"w-full bg-surface-2 border border-border rounded-md px-3 py-2 text-sm"})]}),o.jsx("div",{className:"flex items-end",children:o.jsx(oe,{onClick:yt,disabled:!de||W,size:"sm",className:"w-full sm:w-auto",children:"Adicionar"})})]})}),$.length>0?o.jsx("div",{className:"space-y-2",children:$.map(se=>o.jsxs("div",{className:"flex items-center justify-between p-3 bg-surface-2/50 rounded-lg border border-border",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Vd,{className:"h-4 w-4 text-text-muted"}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-medium text-text-primary",children:new Date(se.data_fechamento+"T00:00:00").toLocaleDateString("pt-BR")}),se.observacao&&o.jsx("div",{className:"text-xs text-text-muted",children:se.observacao})]})]}),o.jsx(oe,{variant:"outline",size:"sm",onClick:()=>Nr(se.id),disabled:W,className:"text-destructive hover:text-destructive hover:bg-destructive/10",children:o.jsx(Ml,{className:"h-3 w-3"})})]},se.id))}):o.jsx("div",{className:"text-center py-6 text-sm text-text-muted",children:"Nenhuma data de fechamento configurada"})]})]}),o.jsx(Un,{children:o.jsx(oe,{variant:"outline",onClick:()=>T(!1),children:"Fechar"})})]})})]})})}const Dot={hidden:{opacity:0},visible:{opacity:1,transition:{when:"beforeChildren",staggerChildren:.06,delayChildren:.05}}},Mot={hidden:{opacity:0,y:12},visible:{opacity:1,y:0,transition:{duration:.35}}};function hU({children:e,className:t=""}){return o.jsx(fr.div,{variants:Mot,className:`fx-card ${t}`,children:e})}function Xg({label:e,...t}){return o.jsxs("label",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:e}),o.jsx("input",{...t,className:`bg-surface-2 border border-border rounded-md px-3 py-2 text-sm ${t.className||""}`})]})}function Rot(e){return e.replace(/\D/g,"").replace(/(\d{2})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1/$2").replace(/(\d{4})(\d)/,"$1-$2").substring(0,18)}function Lot(e){return e.replace(/\D/g,"").replace(/(\d{2})(\d)/,"($1) $2").replace(/(\d{4})(\d)/,"$1-$2").substring(0,15)}function $ot(){const{toast:e}=oo(),{company:t,userProfile:r,reloadCompany:n}=Do(),[a,i]=p.useState(!1),[s,l]=p.useState({razao_social:"",nome_fantasia:"",cnpj:"",email:"",telefone:"",endereco:"",logo_url:""}),c=p.useRef(null),[d,u]=p.useState(""),f=p.useRef(!0);p.useEffect(()=>(f.current=!0,()=>{f.current=!1}),[]),p.useEffect(()=>{(async()=>{try{const g=r?.codigo_empresa||null;if(!g)return;const y=`empresa:form:${g}`;try{const _=localStorage.getItem(y);if(_){const C=JSON.parse(_);C&&typeof C=="object"&&(l(E=>({...E,...C})),C.logo_url&&u(`${C.logo_url.split("?")[0]}?v=${Date.now()}`))}}catch{}const x=setTimeout(()=>{if(f.current)try{const _=localStorage.getItem(y);if(_){const C=JSON.parse(_);C&&typeof C=="object"&&(console.warn("[Empresas] slow fallback: using cached form"),l(E=>({...E,...C})),C.logo_url&&u(`${C.logo_url.split("?")[0]}?v=${Date.now()}`))}}catch{}},5e3),{data:b,error:w}=await ve.from("empresas").select("*").eq("codigo_empresa",g).single();if(clearTimeout(x),w)throw w;if(!f.current)return;const j={razao_social:b?.razao_social||"",nome_fantasia:b?.nome_fantasia||b?.nome||"",cnpj:b?.cnpj||"",email:b?.email||"",telefone:b?.telefone||"",endereco:b?.endereco||"",logo_url:b?.logo_url||""};l(j),u(j.logo_url?`${j.logo_url.split("?")[0]}?v=${Date.now()}`:"");try{localStorage.setItem(y,JSON.stringify(j))}catch{}}catch(g){console.warn("Falha ao carregar empresa:",g)}})()},[r?.codigo_empresa]),p.useEffect(()=>{if(!s.logo_url){u("");return}const v=s.logo_url.split("?")[0];u(`${v}?v=${Date.now()}`)},[s.logo_url]);const m=async v=>{if(v.preventDefault(),!a){if(!s.razao_social?.trim()||!s.cnpj?.trim()){e({title:"Campos obrigatrios",description:"Preencha Razo Social e CNPJ."});return}if(!r?.codigo_empresa){e({title:"Empresa no vinculada",description:"No foi possvel identificar a empresa do usurio para salvar."});return}try{i(!0);const g={nome:s.nome_fantasia||s.razao_social||"Empresa",razao_social:s.razao_social||null,nome_fantasia:s.nome_fantasia||null,cnpj:s.cnpj?.replace(/\D/g,"")||null,email:s.email||null,telefone:s.telefone||null,endereco:s.endereco||null,logo_url:s.logo_url||null},{error:y}=await ve.from("empresas").upsert({codigo_empresa:r.codigo_empresa,...g},{onConflict:"codigo_empresa"}).select("id").single();if(y)throw y;await n?.(),e({title:"Dados salvos",description:"As informaes da empresa foram atualizadas."})}catch(g){console.error(g);const y=(g?.message||g?.hint||"").toString()||"No foi possvel salvar os dados. Verifique as permisses e tente novamente.";e({title:"Erro ao salvar",description:y})}finally{i(!1)}}},h=async v=>{try{const g=v.target.files?.[0];if(!g)return;if(!r?.codigo_empresa){e({title:"Empresa no vinculada",description:"Seu usurio no est associado a uma empresa."});return}const y=g.name.split(".").pop()?.toLowerCase()||"png",x=`${r.codigo_empresa}/logo.${y}`,{error:b}=await ve.storage.from("logos").upload(x,g,{upsert:!0,contentType:g.type||void 0});if(b)throw b;const{data:w}=ve.storage.from("logos").getPublicUrl(x),j=w?.publicUrl||"";l(_=>({..._,logo_url:j})),u(j?`${j}?v=${Date.now()}`:""),e({title:"Logo enviada",description:"A imagem foi carregada com sucesso. Lembre-se de salvar."})}catch(g){console.error("Falha no upload da logo:",g),e({title:"Erro no upload",description:"No foi possvel enviar a logo. Tente outro arquivo."})}finally{c.current&&(c.current.value="")}};return o.jsx(o.Fragment,{children:o.jsxs(fr.div,{variants:Dot,initial:"hidden",animate:"visible",className:"space-y-6",children:[o.jsx(hU,{children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsx("h1",{className:"text-xl font-bold text-text-primary",children:"Cadastros  Empresa"})})}),o.jsxs(hU,{children:[o.jsx("h2",{className:"text-lg font-bold text-text-primary mb-4",children:"Dados da Empresa"}),o.jsxs("form",{onSubmit:m,className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[o.jsx(Xg,{label:"Razo Social",value:s.razao_social,onChange:v=>l({...s,razao_social:v.target.value}),placeholder:"Ex.: Fluxo7 Arena LTDA"}),o.jsx(Xg,{label:"Nome Fantasia",value:s.nome_fantasia,onChange:v=>l({...s,nome_fantasia:v.target.value}),placeholder:"Ex.: Fluxo7 Arena"}),o.jsx(Xg,{label:"CNPJ",type:"text",inputMode:"numeric",value:s.cnpj,onChange:v=>l({...s,cnpj:Rot(v.target.value)}),placeholder:"00.000.000/0000-00"}),o.jsx(Xg,{label:"Email",type:"email",value:s.email,onChange:v=>l({...s,email:v.target.value}),placeholder:"contato@empresa.com"}),o.jsx(Xg,{label:"Telefone",type:"tel",inputMode:"tel",value:s.telefone,onChange:v=>l({...s,telefone:Lot(v.target.value)}),placeholder:"(11) 99999-9999"}),o.jsx(Xg,{label:"Endereo",value:s.endereco,onChange:v=>l({...s,endereco:v.target.value}),placeholder:"Rua, nmero, bairro, cidade",className:"md:col-span-2 lg:col-span-2"}),o.jsx("div",{className:"md:col-span-2 lg:col-span-2 grid grid-cols-1 gap-3",children:o.jsxs("div",{className:"flex items-center gap-4",children:[d||s.logo_url?o.jsx("img",{src:d||s.logo_url,alt:"Logo da empresa",className:"w-16 h-16 rounded-md object-cover border border-border"}):o.jsx("div",{className:"w-16 h-16 rounded-md border border-dashed border-border/60 bg-surface-2/40 flex items-center justify-center text-xs text-text-muted",children:"Sem logo"}),o.jsxs("div",{className:"flex flex-col gap-1 text-sm",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Upload da Logo"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(oe,{type:"button",variant:"outline",onClick:()=>c.current?.click(),className:"px-3",children:"Escolher imagem"}),o.jsx("input",{ref:c,type:"file",accept:"image/*",onChange:h,className:"hidden"}),(d||s.logo_url)&&o.jsx("span",{className:"text-xs text-text-muted truncate max-w-[260px]",title:s.logo_url||d,children:"Logo selecionada"})]}),o.jsx("span",{className:"text-[11px] text-text-muted",children:"Formatos: PNG/JPG. Tamanho recomendado: 256x256."})]})]})}),o.jsx("div",{className:"flex items-end",children:o.jsx(oe,{type:"submit",className:"w-full md:w-auto",disabled:a,children:a?"Salvando...":"Salvar"})})]})]})]})})}const Fot={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},Ej={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}},pU=[{codigo:"01",nome:"Dinheiro"},{codigo:"02",nome:"Cheque"},{codigo:"03",nome:"Carto de Crdito"},{codigo:"04",nome:"Carto de Dbito"},{codigo:"05",nome:"Carto da Loja (Private Label)"},{codigo:"10",nome:"Vale Alimentao"},{codigo:"11",nome:"Vale Refeio"},{codigo:"12",nome:"Vale Presente"},{codigo:"13",nome:"Vale Combustvel"},{codigo:"14",nome:"Duplicata Mercantil"},{codigo:"15",nome:"Boleto Bancrio"},{codigo:"16",nome:"Depsito Bancrio"},{codigo:"17",nome:"PIX Dinmico (QR-Code)"},{codigo:"18",nome:"Transferncia Bancria / Carteira Digital"},{codigo:"19",nome:"Programa de Fidelidade / Cashback"},{codigo:"20",nome:"PIX Esttico"},{codigo:"21",nome:"Crdito em Loja"},{codigo:"22",nome:"Pagamento Eletrnico no Informado"},{codigo:"90",nome:"Sem Pagamento"},{codigo:"99",nome:"Outros"}],_E=({icon:e,title:t,value:r,subtitle:n,color:a,onClick:i,isActive:s})=>o.jsx(fr.div,{variants:Ej,onClick:i,className:Yt("bg-surface rounded-lg border md:border-2 p-3 md:p-4 transition-all text-center h-[90px] md:h-auto",i?"cursor-pointer hover:shadow-md":"",s?`border-${a} bg-${a}/5`:"border-border",i&&!s?"hover:border-border-hover":""),children:o.jsxs("div",{className:"flex flex-col items-center justify-center gap-1 md:flex-row md:items-center md:gap-3 h-full",children:[o.jsx("div",{className:Yt("p-1.5 md:p-2 rounded-lg",`bg-${a}/10`),children:o.jsx(e,{className:Yt("w-4 h-4 md:w-5 md:h-5",`text-${a}`)})}),o.jsxs("div",{className:"flex-1 md:text-left",children:[o.jsx("p",{className:"text-base md:text-2xl font-bold text-text-primary leading-none",children:r}),o.jsx("p",{className:"text-[10px] md:text-xs font-semibold text-text-secondary md:mt-0.5",children:t}),o.jsx("p",{className:"hidden md:block text-xs text-text-muted",children:n})]})]})});function Bot(){const{toast:e}=oo(),{userProfile:t,authReady:r}=Do(),[n,a]=p.useState([]),[i,s]=p.useState(!1),[l,c]=p.useState(!1),[d,u]=p.useState(""),[f,m]=p.useState("all"),[h,v]=p.useState("all"),[g,y]=p.useState(!0),[x,b]=p.useState(null),[w,j]=p.useState(!1),[_,C]=p.useState(null),[E,P]=p.useState({codigo_interno:"",codigo_sefaz:"",nome:"",taxa_percentual:"",ativo:!0}),[k,M]=p.useState(!1),[S,I]=p.useState(""),[T,D]=p.useState(!1),[B,U]=p.useState(null),[z,$]=p.useState(null),[Y,de]=p.useState(!1),[xe,q]=p.useState("mes"),[L,W]=p.useState(!1),[ne,le]=p.useState([]),[K,Q]=p.useState("customizado"),[re,G]=p.useState(""),[me,pe]=p.useState(""),[Be,Z]=p.useState(!1),[ee,kt]=p.useState(!1);p.useEffect(()=>{const je=()=>{try{kt(typeof window<"u"&&window.innerWidth<=640)}catch{}};return je(),window.addEventListener("resize",je),()=>window.removeEventListener("resize",je)},[]);const Nt=async()=>{try{s(!0);const je=t?.codigo_empresa;if(!je)return;const ae=await Uv({somenteAtivas:!1,codigoEmpresa:je});console.log(" Finalizadoras carregadas:",ae),console.log(" Primeira finalizadora:",ae?.[0]),a(Array.isArray(ae)?ae:[])}catch(je){e({title:"Erro ao carregar",description:je?.message,variant:"destructive"})}finally{s(!1)}},De=p.useMemo(()=>{const je=n.length,ae=n.filter(Se=>Se.ativo).length,$e=n.length>0?n.reduce((Se,Ne)=>{const Ue=Ne.nome||"Sem nome";return Se[Ue]=(Se[Ue]||0)+1,Se},{}):{},Ae=Object.entries($e).sort((Se,Ne)=>Ne[1]-Se[1])[0],Tt=Ae?Ae[0]:"-";return{total:je,ativas:ae,maisUsada:Tt}},[n]),st=p.useMemo(()=>{let je=[...n];if(d){const ae=d.toLowerCase();je=je.filter($e=>{const Ae=String($e.tipo||"").toLowerCase(),Tt=String($e.nome||"").toLowerCase(),Se=String($e.codigo_interno||"").toLowerCase(),Ne=ae.replace(/\D/g,""),Ue=String($e.codigo_interno||"").replace(/\D/g,"");return Ae.includes(ae)||Tt.includes(ae)||Se.includes(ae)||!!Ne&&Ue===Ne})}return f!=="all"&&(je=je.filter(ae=>ae.tipo===f)),h!=="all"&&(je=je.filter(ae=>h==="active"?ae.ativo:!ae.ativo)),x==="ativas"&&(je=je.filter(ae=>ae.ativo)),je.sort((ae,$e)=>{const Ae=parseInt(ae.codigo_interno)||0,Tt=parseInt($e.codigo_interno)||0;return Ae-Tt}),je},[n,d,f,h,x]),ft=()=>{C(null);const je=n.reduce(($e,Ae)=>{const Tt=parseInt(Ae.codigo_interno)||0;return Tt>$e?Tt:$e},0),ae=String(je+1).padStart(2,"0");P({codigo_interno:ae,codigo_sefaz:"",nome:"",taxa_percentual:"",ativo:!0}),j(!0)},yt=je=>{C(je),P({codigo_interno:je.codigo_interno||"",codigo_sefaz:je.codigo_sefaz||"",nome:je.nome||"",taxa_percentual:je.taxa_percentual!=null?String(je.taxa_percentual):"",ativo:je.ativo!==!1}),j(!0)},Nr=async(je,ae="mes")=>{try{de(!0);const $e=t?.codigo_empresa;if(!$e)return;const Ae=new Date;let Tt,Se=Ae.toISOString();switch(ae){case"hoje":Tt=new Date(Ae.setHours(0,0,0,0)).toISOString();break;case"semana":Tt=new Date(Ae.setDate(Ae.getDate()-7)).toISOString();break;case"mes":Tt=new Date(Ae.setMonth(Ae.getMonth()-1)).toISOString();break;default:Tt=new Date(Ae.setMonth(Ae.getMonth()-1)).toISOString()}const{data:Ne,error:Ue}=await ve.from("pagamentos").select("valor, recebido_em, status").eq("finalizadora_id",je).eq("codigo_empresa",$e).gte("recebido_em",Tt).lte("recebido_em",Se).neq("status","Cancelado").neq("status","Estornado");if(Ue)throw Ue;const Qe=Ne?.length||0,et=Ne?.reduce((qt,lt)=>qt+(Number(lt.valor)||0),0)||0,pt=Qe>0?et/Qe:0,Ke=Ne?.[Ne.length-1]?.recebido_em||null;$({transacoes:Qe,faturamento:et,ticketMedio:pt,ultimaUtilizacao:Ke})}catch($e){console.error("Erro ao carregar estatsticas:",$e),e({title:"Erro ao carregar estatsticas",description:$e?.message,variant:"destructive"})}finally{de(!1)}},se=async(je="customizado",ae=null,$e=null)=>{try{Z(!0);const Ae=t?.codigo_empresa;if(!Ae)return;let Tt,Se;if(je==="customizado"&&ae&&$e)Tt=new Date(ae).toISOString(),Se=new Date($e+"T23:59:59").toISOString();else{const pt=new Date;switch(Se=pt.toISOString(),je){case"hoje":Tt=new Date(pt.setHours(0,0,0,0)).toISOString();break;case"semana":Tt=new Date(pt.setDate(pt.getDate()-7)).toISOString();break;case"mes":Tt=new Date(pt.setMonth(pt.getMonth()-1)).toISOString();break;default:Tt=new Date(pt.setMonth(pt.getMonth()-1)).toISOString()}}const{data:Ne,error:Ue}=await ve.from("pagamentos").select("finalizadora_id, valor, finalizadoras!pagamentos_finalizadora_id_fkey(id, codigo_interno, nome)").eq("codigo_empresa",Ae).gte("recebido_em",Tt).lte("recebido_em",Se).neq("status","Cancelado").neq("status","Estornado");if(Ue)throw Ue;const Qe={};Ne?.forEach(pt=>{const Ke=pt.finalizadora_id;Ke&&(Qe[Ke]||(Qe[Ke]={id:Ke,codigo:pt.finalizadoras?.codigo_interno||"-",nome:pt.finalizadoras?.nome||"Sem nome",total:0,transacoes:0}),Qe[Ke].total+=Number(pt.valor)||0,Qe[Ke].transacoes+=1)});const et=Object.values(Qe).sort((pt,Ke)=>Ke.total-pt.total);le(et)}catch(Ae){console.error("Erro ao carregar ranking:",Ae),e({title:"Erro ao carregar ranking",description:Ae?.message,variant:"destructive"})}finally{Z(!1)}},rt=()=>{W(!0),Q("customizado");const je=new Date,ae=new Date;ae.setMonth(ae.getMonth()-1),G(ae.toISOString().split("T")[0]),pe(je.toISOString().split("T")[0]),se("customizado",ae.toISOString().split("T")[0],je.toISOString().split("T")[0])},mt=je=>{U(je),D(!0),q("mes"),Nr(je.id,"mes")},tr=async()=>{try{if(!E.nome?.trim()){e({title:"Nome  obrigatrio",variant:"warning"});return}if(!E.codigo_sefaz){e({title:"Cdigo SEFAZ  obrigatrio",variant:"warning"});return}if(E.codigo_interno?.trim()&&n.some(Ae=>Ae.codigo_interno===E.codigo_interno.trim()&&(!_||Ae.id!==_.id))){e({title:"Cdigo j existe",description:"Este cdigo interno j est em uso por outra finalizadora",variant:"warning"});return}c(!0);const je=t?.codigo_empresa,ae={codigo_interno:E.codigo_interno?.trim()||null,codigo_sefaz:E.codigo_sefaz,nome:E.nome.trim(),tipo:"outros",taxa_percentual:E.taxa_percentual===""?null:Number(E.taxa_percentual),ativo:E.ativo};_?(await XHe(_.id,ae,je),e({title:"Finalizadora atualizada!",variant:"success"})):(await YHe(ae,je),e({title:"Finalizadora criada!",variant:"success"})),j(!1),await Nt()}catch(je){e({title:"Erro ao salvar",description:je?.message,variant:"destructive"})}finally{c(!1)}},Ce=async je=>{try{await JHe(je.id,!je.ativo,t?.codigo_empresa),e({title:je.ativo?"Desativada":"Ativada",variant:"success"}),await Nt()}catch(ae){e({title:"Erro ao alterar status",description:ae?.message,variant:"destructive"})}};return p.useEffect(()=>{r&&t?.codigo_empresa&&Nt()},[r,t?.codigo_empresa]),o.jsxs(o.Fragment,{children:[o.jsxs(fr.div,{variants:Fot,initial:"hidden",animate:"visible",className:"flex-1 space-y-6 p-4 md:p-6",children:[o.jsxs(fr.div,{variants:Ej,className:"flex items-center justify-between gap-2",children:[o.jsx("div",{className:"min-w-0",children:o.jsx("h1",{className:"text-2xl md:text-3xl font-black text-text-primary tracking-tight leading-tight",children:"Finalizadoras"})}),o.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[o.jsx(oe,{variant:"ghost",size:"icon",onClick:()=>y(!g),className:"h-9 w-9",children:g?o.jsx(Sp,{className:"h-5 w-5"}):o.jsx(zp,{className:"h-5 w-5"})}),o.jsxs(oe,{onClick:ft,className:"gap-2 h-9 px-3 whitespace-nowrap",children:[o.jsx(Ka,{className:"h-4 w-4"}),o.jsx("span",{className:"md:hidden",children:"Nova"}),o.jsx("span",{className:"hidden md:inline",children:"Nova Finalizadora"})]})]})]}),g&&o.jsxs("div",{className:"grid grid-cols-3 gap-3 md:grid-cols-3 md:gap-6",children:[o.jsx(_E,{icon:Cm,title:"Total",value:De.total,subtitle:"Finalizadoras cadastradas",color:"brand"}),o.jsx(_E,{icon:Ui,title:"Ativas",value:De.ativas,subtitle:"Disponveis para uso",color:"success",onClick:()=>b(x==="ativas"?null:"ativas"),isActive:x==="ativas"}),o.jsx(_E,{icon:Up,title:"Mais Usada",value:De.maisUsada,subtitle:"Mtodo mais popular",color:"warning",onClick:rt})]}),o.jsx(fr.div,{variants:Ej,className:"bg-surface rounded-lg border border-border p-4",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("div",{className:"relative min-w-0 basis-0 flex-grow",children:[o.jsx(pi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(or,{placeholder:"Buscar finalizadora...",value:d,onChange:je=>u(je.target.value),className:"pl-10 h-11"})]}),o.jsxs(En,{value:h,onValueChange:v,children:[o.jsx(Sn,{className:"w-[110px] md:w-[180px]",children:o.jsx(kn,{placeholder:"Filtrar por status"})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"all",children:"Todos"}),o.jsx(wt,{value:"active",children:"Ativas"}),o.jsx(wt,{value:"inactive",children:"Inativas"})]})]})]})}),o.jsx(fr.div,{variants:Ej,className:"bg-surface rounded-lg border border-border overflow-hidden",children:i?o.jsxs("div",{className:"p-12 text-center",children:[o.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-brand border-r-transparent"}),o.jsx("p",{className:"mt-4 text-text-muted",children:"Carregando..."})]}):st.length===0?o.jsxs("div",{className:"p-12 text-center text-text-muted",children:[o.jsx(Cm,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),o.jsx("p",{children:"Nenhuma finalizadora encontrada"})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"md:hidden divide-y divide-border",children:st.map(je=>o.jsxs("div",{className:"p-3 flex flex-col gap-2 hover:bg-surface-2/50 cursor-pointer",onClick:()=>mt(je),children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[o.jsx("span",{className:"px-2 py-0.5 rounded-md bg-surface-2 border border-border font-mono text-xs text-text-secondary",children:je.codigo_interno||"-"}),o.jsx("span",{className:"font-semibold text-sm text-text-primary truncate",title:je.nome,children:je.nome})]}),o.jsxs("span",{className:Yt("inline-flex items-center gap-1.5 px-2 py-0.5 rounded-full text-[11px] font-medium",je.ativo?"bg-success/10 text-success":"bg-muted/10 text-muted"),children:[o.jsx("span",{className:Yt("w-1.5 h-1.5 rounded-full",je.ativo?"bg-success":"bg-muted")}),je.ativo?"Ativa":"Inativa"]})]}),o.jsxs("div",{className:"flex items-center justify-between text-xs text-text-secondary",children:[o.jsx("div",{className:"flex items-center gap-3",children:o.jsxs("span",{children:["Taxa: ",je.taxa_percentual?`${je.taxa_percentual}%`:"-"]})}),o.jsxs("div",{className:"flex items-center gap-2",onClick:ae=>ae.stopPropagation(),children:[o.jsx(oe,{variant:"ghost",size:"sm",className:"h-7 px-2",onClick:()=>yt(je),children:o.jsx(El,{className:"h-4 w-4"})}),o.jsx(oe,{variant:je.ativo?"ghost":"default",size:"sm",className:"h-7 px-2",onClick:()=>Ce(je),children:je.ativo?"Desativar":"Ativar"})]})]})]},je.id))}),o.jsx("div",{className:"hidden md:block overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{className:"bg-surface-2 border-b border-border",children:o.jsxs("tr",{children:[o.jsx("th",{className:"text-left px-6 py-4 text-sm font-semibold text-text-secondary",children:"Cdigo"}),o.jsx("th",{className:"text-left px-6 py-4 text-sm font-semibold text-text-secondary",children:"Descrio"}),o.jsx("th",{className:"text-left px-6 py-4 text-sm font-semibold text-text-secondary",children:"Taxa (%)"}),o.jsx("th",{className:"text-center px-6 py-4 text-sm font-semibold text-text-secondary",children:"Status"}),o.jsx("th",{className:"text-right px-6 py-4 text-sm font-semibold text-text-secondary",children:"Aes"})]})}),o.jsx("tbody",{className:"divide-y divide-border",children:st.map(je=>o.jsxs("tr",{className:"hover:bg-surface-2/50 transition-colors cursor-pointer",onClick:()=>mt(je),children:[o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:"font-mono text-sm text-text-primary",children:je.codigo_interno||"-"})}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:"font-semibold text-text-primary",children:je.nome})}),o.jsx("td",{className:"px-6 py-4",children:o.jsx("span",{className:"text-text-secondary",children:je.taxa_percentual?`${je.taxa_percentual}%`:"-"})}),o.jsx("td",{className:"px-6 py-4 text-center",children:o.jsxs("span",{className:Yt("inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs font-medium",je.ativo?"bg-success/10 text-success":"bg-muted/10 text-muted"),children:[o.jsx("span",{className:Yt("w-2 h-2 rounded-full",je.ativo?"bg-success":"bg-muted")}),je.ativo?"Ativa":"Inativa"]})}),o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"flex justify-end gap-2",onClick:ae=>ae.stopPropagation(),children:[o.jsx(oe,{variant:"ghost",size:"sm",onClick:()=>yt(je),children:o.jsx(El,{className:"h-4 w-4"})}),o.jsx(oe,{variant:je.ativo?"ghost":"default",size:"sm",onClick:()=>Ce(je),children:je.ativo?"Desativar":"Ativar"})]})})]},je.id))})]})})]})})]}),o.jsx(ln,{open:w,onOpenChange:j,children:o.jsxs(on,{className:"sm:max-w-[500px] w-[92vw] max-h-[90vh] overflow-y-auto",children:[o.jsxs(nn,{children:[o.jsx(rn,{children:_?"Editar Finalizadora":"Nova Finalizadora"}),o.jsx(_n,{children:_?"Atualize as informaes da finalizadora":"Adicione um novo mtodo de pagamento"})]}),o.jsxs("div",{className:"space-y-4 py-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Wt,{htmlFor:"codigo_interno",children:"Cdigo Finalizadora"}),o.jsx(or,{id:"codigo_interno",type:"text",placeholder:"Ex: 01, 02, 03...",value:E.codigo_interno,onChange:je=>P({...E,codigo_interno:je.target.value})}),o.jsx("p",{className:"text-xs text-text-muted",children:"Gerado automaticamente, mas pode ser editado"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Wt,{htmlFor:"nome",children:"Descrio *"}),o.jsx(or,{id:"nome",placeholder:"Ex: PIX, Dinheiro, Carto de Crdito...",value:E.nome,onChange:je=>P({...E,nome:je.target.value})})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Wt,{htmlFor:"codigo_sefaz",children:"Forma de Pagamento NF-e/NFC-e *"}),o.jsx(oe,{type:"button",variant:"outline",className:"justify-between w-full",onClick:()=>M(!0),children:E.codigo_sefaz?`${E.codigo_sefaz} - ${pU.find(je=>je.codigo===E.codigo_sefaz)?.nome||""}`:"Selecione a forma de pagamento"}),o.jsx("p",{className:"text-xs text-text-muted",children:"A lista abrir em um modal com rolagem."})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Wt,{htmlFor:"taxa",children:"Taxa"}),o.jsxs("div",{className:"relative",children:[o.jsx(or,{id:"taxa",inputMode:"decimal",placeholder:"0,00",className:"pr-10",value:E.taxa_percentual,onChange:je=>{const ae=String(je.target.value).replace(/[^0-9.,]/g,"").replace(/,/g,".");if(ae===""){P({...E,taxa_percentual:""});return}const $e=Number(ae);if(Number.isFinite($e)){const Ae=Math.max(0,Math.min(100,$e));P({...E,taxa_percentual:String(Ae)})}},onBlur:()=>{const je=String(E.taxa_percentual||"").replace(/,/g,".");if(je==="")return;const ae=Number(je);if(Number.isFinite(ae)){const $e=Math.max(0,Math.min(100,ae));P(Ae=>({...Ae,taxa_percentual:$e.toFixed(2)}))}}}),o.jsx("span",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-text-muted text-sm",children:"%"})]}),o.jsx("p",{className:"text-xs text-text-muted",children:"Deixe vazio se no houver taxa"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"checkbox",id:"ativo",checked:E.ativo,onChange:je=>P({...E,ativo:je.target.checked}),className:"h-4 w-4 rounded border-border"}),o.jsx(Wt,{htmlFor:"ativo",className:"text-sm font-normal cursor-pointer",children:"Finalizadora ativa"})]})]}),o.jsxs(Un,{children:[o.jsx(oe,{variant:"outline",onClick:()=>j(!1),disabled:l,children:"Cancelar"}),o.jsx(oe,{onClick:tr,disabled:l,children:l?"Salvando...":"Salvar"})]})]})}),o.jsx(ln,{open:k,onOpenChange:M,children:o.jsxs(on,{className:"sm:max-w-[520px] w-[92vw]",children:[o.jsxs(nn,{children:[o.jsx(rn,{children:"Selecionar Forma de Pagamento (SEFAZ)"}),o.jsx(_n,{children:"Busque por cdigo ou nome"})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsx(or,{placeholder:"Ex.: 03, crdito, pix...",value:S,onChange:je=>I(je.target.value)}),o.jsx("div",{className:"max-h-[420px] overflow-auto fx-scroll rounded-md border border-border",children:o.jsx("ul",{className:"divide-y divide-border",children:pU.filter(je=>{const ae=(S||"").toLowerCase();return ae?je.codigo.includes(ae)||String(je.nome).toLowerCase().includes(ae):!0}).map(je=>o.jsx("li",{children:o.jsxs("button",{type:"button",className:`w-full text-left px-3 py-2 hover:bg-surface-2 ${E.codigo_sefaz===je.codigo?"bg-surface-2":""}`,onClick:()=>{P(ae=>({...ae,codigo_sefaz:je.codigo})),M(!1)},children:[o.jsx("span",{className:"font-mono mr-2 text-text-secondary",children:je.codigo}),o.jsx("span",{children:je.nome})]})},je.codigo))})})]})]})}),o.jsx(ln,{open:T,onOpenChange:D,children:o.jsxs(on,{className:"sm:max-w-[700px] w-[92vw] max-h-[90vh] overflow-y-auto",children:[o.jsxs(nn,{children:[o.jsx(rn,{children:"Detalhes da Finalizadora"}),o.jsx(_n,{children:"Estatsticas e informaes completas"})]}),B&&o.jsxs("div",{className:"space-y-6 py-4",children:[o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[o.jsx("h3",{className:"font-semibold text-text-primary mb-3",children:"Informaes"}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Cdigo Finalizadora"}),o.jsx("p",{className:"font-mono text-sm text-text-primary",children:B.codigo_interno||"-"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Forma de Pagamento NF-e/NFC-e"}),o.jsx("p",{className:"font-mono text-sm text-text-primary",children:B.codigo_sefaz||"-"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Descrio"}),o.jsx("p",{className:"font-medium text-text-primary",children:B.nome})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Taxa"}),o.jsx("p",{className:"font-medium text-text-primary",children:B.taxa_percentual?`${B.taxa_percentual}%`:"Sem taxa"})]}),o.jsxs("div",{className:"col-span-2",children:[o.jsx("p",{className:"text-xs text-text-muted mb-1",children:"Status"}),o.jsxs("span",{className:Yt("inline-flex items-center gap-2 px-2 py-1 rounded-full text-xs font-medium",B.ativo?"bg-success/10 text-success":"bg-muted/10 text-muted"),children:[o.jsx("span",{className:Yt("w-2 h-2 rounded-full",B.ativo?"bg-success":"bg-muted")}),B.ativo?"Ativa":"Inativa"]})]})]})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[o.jsx("h3",{className:"font-semibold text-text-primary mb-3",children:"Perodo de Anlise"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(oe,{variant:xe==="hoje"?"default":"outline",size:"sm",onClick:()=>{q("hoje"),Nr(B.id,"hoje")},children:"Hoje"}),o.jsx(oe,{variant:xe==="semana"?"default":"outline",size:"sm",onClick:()=>{q("semana"),Nr(B.id,"semana")},children:"7 Dias"}),o.jsx(oe,{variant:xe==="mes"?"default":"outline",size:"sm",onClick:()=>{q("mes"),Nr(B.id,"mes")},children:"30 Dias"})]})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[o.jsx("h3",{className:"font-semibold text-text-primary mb-3",children:"Estatsticas de Uso"}),Y?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx("div",{className:"h-6 w-6 animate-spin rounded-full border-2 border-brand border-t-transparent"})}):z?o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Total de Transaes"}),o.jsx("span",{className:"font-semibold text-text-primary",children:z.transacoes})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Faturamento Total"}),o.jsxs("span",{className:"font-semibold text-success",children:["R$ ",z.faturamento.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Ticket Mdio"}),o.jsxs("span",{className:"font-semibold text-text-primary",children:["R$ ",z.ticketMedio.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"ltima Utilizao"}),o.jsx("span",{className:"font-medium text-text-muted",children:z.ultimaUtilizacao?new Date(z.ultimaUtilizacao).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Nunca utilizada"})]})]}):o.jsx("div",{className:"text-center py-8 text-text-muted",children:o.jsx("p",{className:"text-sm",children:"Nenhum dado disponvel"})})]})]}),o.jsxs(Un,{children:[o.jsx(oe,{variant:"outline",onClick:()=>D(!1),children:"Fechar"}),o.jsxs(oe,{onClick:()=>{D(!1),yt(B)},children:[o.jsx(El,{className:"h-4 w-4 mr-2"}),"Editar"]})]})]})}),o.jsx(ln,{open:L,onOpenChange:W,children:o.jsxs(on,{className:"sm:max-w-[700px] w-[92vw] max-h-[90vh] overflow-y-auto",children:[o.jsxs(nn,{children:[o.jsx(rn,{children:"Ranking de Finalizadoras"}),o.jsx(_n,{children:"Faturamento por forma de pagamento"})]}),o.jsxs("div",{className:"space-y-4 py-4",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsx(oe,{variant:K==="hoje"?"default":"outline",size:"sm",className:"flex-1 min-w-[70px]",onClick:()=>{Q("hoje"),se("hoje")},children:"Hoje"}),o.jsx(oe,{variant:K==="semana"?"default":"outline",size:"sm",className:"flex-1 min-w-[70px]",onClick:()=>{Q("semana"),se("semana")},children:"7 Dias"}),o.jsx(oe,{variant:K==="mes"?"default":"outline",size:"sm",className:"flex-1 min-w-[70px]",onClick:()=>{Q("mes"),se("mes")},children:"30 Dias"}),o.jsx(oe,{variant:K==="customizado"?"default":"outline",size:"sm",className:"flex-1 min-w-[70px]",onClick:()=>Q("customizado"),children:"Perodo"})]}),K==="customizado"&&(ee?o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{children:[o.jsx(Wt,{className:"text-xs",children:"Data Inicial"}),o.jsx("input",{type:"date",className:"mt-1 h-9 w-full rounded-md border border-border bg-surface px-2 text-sm text-text-primary",value:re,onChange:je=>G(je.target.value)})]}),o.jsxs("div",{children:[o.jsx(Wt,{className:"text-xs",children:"Data Final"}),o.jsx("input",{type:"date",className:"mt-1 h-9 w-full rounded-md border border-border bg-surface px-2 text-sm text-text-primary",value:me,onChange:je=>pe(je.target.value)})]})]}),o.jsx(oe,{className:"w-full",onClick:()=>se("customizado",re,me),disabled:!re||!me||Be,children:Be?"Buscando...":"Buscar"})]}):o.jsxs("div",{className:"flex gap-3 items-end",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx(Wt,{children:"Data Inicial"}),o.jsxs(xc,{children:[o.jsx(yc,{asChild:!0,children:o.jsxs(oe,{variant:"outline",className:Yt("w-full justify-start text-left font-normal",!re&&"text-text-muted"),children:[o.jsx(Ei,{className:"mr-2 h-4 w-4"}),re?new Date(re+"T12:00:00").toLocaleDateString("pt-BR"):"Selecione"]})}),o.jsx(Rl,{className:"w-auto p-0 bg-surface border border-border",align:"start",children:o.jsx(L3,{mode:"single",selected:re?new Date(re+"T12:00:00"):void 0,onSelect:je=>{if(je){const ae=je.getFullYear(),$e=String(je.getMonth()+1).padStart(2,"0"),Ae=String(je.getDate()).padStart(2,"0");G(`${ae}-${$e}-${Ae}`)}},className:"p-3"})})]})]}),o.jsxs("div",{className:"flex-1",children:[o.jsx(Wt,{children:"Data Final"}),o.jsxs(xc,{children:[o.jsx(yc,{asChild:!0,children:o.jsxs(oe,{variant:"outline",className:Yt("w-full justify-start text-left font-normal",!me&&"text-text-muted"),children:[o.jsx(Ei,{className:"mr-2 h-4 w-4"}),me?new Date(me+"T12:00:00").toLocaleDateString("pt-BR"):"Selecione"]})}),o.jsx(Rl,{className:"w-auto p-0 bg-surface border border-border",align:"start",children:o.jsx(L3,{mode:"single",selected:me?new Date(me+"T12:00:00"):void 0,onSelect:je=>{if(je){const ae=je.getFullYear(),$e=String(je.getMonth()+1).padStart(2,"0"),Ae=String(je.getDate()).padStart(2,"0");pe(`${ae}-${$e}-${Ae}`)}},className:"p-3"})})]})]}),o.jsx(oe,{onClick:()=>se("customizado",re,me),disabled:!re||!me||Be,children:"Buscar"})]}))]}),Be?o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-brand border-t-transparent"})}):ne.length===0?o.jsx("div",{className:"text-center py-12 text-text-muted",children:o.jsx("p",{children:"Nenhuma transao no perodo selecionado"})}):o.jsx("div",{className:"space-y-3",children:ne.map((je,ae)=>o.jsx("div",{className:"bg-surface-2 rounded-lg p-3 md:p-4 border border-border",children:o.jsxs("div",{className:"flex items-start md:items-center justify-between gap-3",children:[o.jsxs("div",{className:"flex items-start md:items-center gap-2 md:gap-3 flex-1 min-w-0",children:[o.jsxs("div",{className:Yt("flex items-center justify-center w-7 h-7 md:w-8 md:h-8 rounded-full font-bold text-xs md:text-sm flex-shrink-0",ae===0?"bg-warning/20 text-warning":ae===1?"bg-info/20 text-info":ae===2?"bg-success/20 text-success":"bg-muted/20 text-muted"),children:[ae+1,""]}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2",children:[o.jsx("span",{className:"font-mono text-[10px] md:text-xs text-text-muted",children:je.codigo}),o.jsx("span",{className:"font-semibold text-sm md:text-base text-text-primary truncate",children:je.nome})]}),o.jsxs("p",{className:"text-[10px] md:text-xs text-text-muted",children:[je.transacoes," transaes"]})]})]}),o.jsxs("div",{className:"text-right flex-shrink-0",children:[o.jsxs("p",{className:"text-base md:text-lg font-bold text-success whitespace-nowrap",children:["R$ ",je.total.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),o.jsxs("p",{className:"text-[10px] md:text-xs text-text-muted whitespace-nowrap",children:["Mdia: R$ ",(je.total/je.transacoes).toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})]})},je.id))})]}),o.jsx(Un,{children:o.jsx(oe,{variant:"outline",onClick:()=>W(!1),children:"Fechar"})})]})})]})}function qot(){return o.jsxs("div",{className:"p-8",children:[o.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Pgina de Teste"}),o.jsx("p",{children:"Esta  uma pgina de teste para verificar se o roteamento est funcionando corretamente."})]})}function zot(e){const t=new URLSearchParams(e.startsWith("#")?e.slice(1):e),r=t.get("access_token"),n=t.get("refresh_token");return{access_token:r,refresh_token:n}}const Uot=()=>{const{toast:e}=oo(),t=Pc(),[r,n]=p.useState(""),[a,i]=p.useState(""),[s,l]=p.useState(!1),[c,d]=p.useState(!1),u=p.useMemo(()=>zot(window.location.hash),[]);p.useEffect(()=>{(async()=>{const{data:{session:h}}=await ve.auth.getSession();if(h){d(!0);return}if(u.access_token&&u.refresh_token){const{data:v,error:g}=await ve.auth.setSession({access_token:u.access_token,refresh_token:u.refresh_token});g&&e({title:"Link invlido ou expirado",description:"Abra o link do email novamente.",variant:"destructive"}),d(!!v?.session)}else e({title:"Link invlido",description:"Abra o link de redefinio enviado por email.",variant:"destructive"})})()},[]);const f=async m=>{if(m.preventDefault(),r.length<6){e({title:"Senha muito curta",description:"A senha deve ter pelo menos 6 caracteres.",variant:"destructive"});return}if(r!==a){e({title:"Senhas no conferem",description:"As senhas digitadas so diferentes.",variant:"destructive"});return}l(!0);const{data:h,error:v}=await ve.auth.updateUser({password:r});if(l(!1),v){e({title:"Erro ao redefinir senha",description:v.message||"Tente novamente.",variant:"destructive"});return}e({title:"Senha redefinida",description:"Voc j pode acessar o sistema.",variant:"default"}),t("/")};return o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-6",children:o.jsxs("div",{className:"w-full max-w-md bg-surface rounded-xl border border-border p-6 shadow",children:[o.jsx("h1",{className:"text-2xl font-semibold mb-2 text-text-primary",children:"Redefinir senha"}),o.jsx("p",{className:"text-sm text-text-secondary mb-6",children:"Defina uma nova senha para sua conta."}),o.jsxs("form",{onSubmit:f,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm mb-1 text-text-secondary",children:"Nova senha"}),o.jsx(or,{type:"password",value:r,onChange:m=>n(m.target.value),placeholder:"",disabled:!c||s})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm mb-1 text-text-secondary",children:"Confirmar nova senha"}),o.jsx(or,{type:"password",value:a,onChange:m=>i(m.target.value),placeholder:"",disabled:!c||s})]}),o.jsx(oe,{type:"submit",className:"w-full",disabled:!c||s,children:s?"Salvando...":"Salvar nova senha"})]})]})})},Vot=(e,t,r)=>e.split(/(\*\*.*?\*\*)/g).map((a,i)=>{if(a.startsWith("**")&&a.endsWith("**")){const s=a.slice(2,-2);return o.jsx("strong",{className:`font-black ${t?r?"text-white":"text-[#000000]":"text-white"}`,style:{fontWeight:900,textShadow:t?r?"0 0 1px rgba(0,0,0,0.25)":"0 0 1px rgba(0,0,0,0.3)":"0 0 1px rgba(255,255,255,0.5)"},children:s},i)}return a}),doe=({message:e})=>{const t=e.from==="isis",r=t&&e?.color==="green";return o.jsx(fr.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.4,ease:[.22,1,.36,1]},className:`flex ${t?"justify-start":"justify-end"} mb-4 md:mb-6`,children:o.jsxs("div",{className:`flex items-end gap-2 md:gap-3 max-w-[90%] md:max-w-[85%] lg:max-w-[75%] ${!t&&"flex-row-reverse"}`,children:[t?o.jsx(Wd,{size:"sm",variant:"message",className:"md:w-14 md:h-14"}):o.jsx("div",{className:"w-10 h-10 md:w-14 md:h-14 rounded-full flex items-center justify-center flex-shrink-0 border bg-surface border-border-color",children:o.jsx(ju,{className:"w-5 h-5 md:w-6 md:h-6 text-text-secondary"})}),o.jsxs("div",{className:"flex flex-col gap-1",children:[o.jsx("div",{className:`px-3 py-2.5 md:px-5 md:py-3.5 backdrop-blur-sm transition-all duration-300 ${t?r?"bg-emerald-600/90 border border-emerald-400 text-white rounded-2xl rounded-bl-sm shadow-lg shadow-emerald-600/30":"bg-brand border border-brand text-[#0A0A0A] rounded-2xl rounded-bl-sm shadow-lg shadow-brand/20":"bg-surface/70 border border-white/10 text-text-primary rounded-2xl rounded-br-sm"}`,children:o.jsx("p",{className:"text-[15px] md:text-[15px] font-bold leading-relaxed whitespace-pre-wrap tracking-wide",children:Vot(e.text,t,r)})}),o.jsx("p",{className:`text-[10px] md:text-[10px] text-text-muted px-2 ${t?"text-left":"text-right"}`,children:Jt(e.timestamp,"HH:mm")})]})]})})};function Wot(){const[e,t]=p.useState([]),[r,n]=p.useState(""),[a,i]=p.useState(!1),[s,l]=p.useState(""),[c,d]=p.useState(!0),u=p.useRef(null),{company:f,userProfile:m,user:h}=Do();p.useEffect(()=>{const b={id:Date.now()+Math.random(),from:"isis",text:"Ol! Eu sou a verso Premium da sis, integrada  OpenAI. Em que posso ajudar? ",timestamp:new Date};t([b])},[]),p.useEffect(()=>{const b=setTimeout(()=>{u.current?.scrollIntoView({behavior:"smooth",block:"end"})},100);return()=>clearTimeout(b)},[e,a]);const v=b=>{t(w=>[...w,{id:Date.now()+Math.random(),timestamp:new Date,...b}])},g=b=>{const w=String(b||"").toLowerCase();return w?w.includes("agend")||w.includes("agenda")?w.includes("hoje")?"Consultando os agendamentos de hoje...":w.includes("amanh")?"Consultando os agendamentos de amanh...":"Consultando seus agendamentos...":w.includes("cliente")?"Buscando informaes de clientes...":w.includes("caixa")||w.includes("faturamento")||w.includes("financeiro")||w.includes("venda")||w.includes("pagamento")?"Analisando movimentaes da sua arena...":w.includes("quadra")||w.includes("reserva")?"Verificando horrios e quadras disponveis...":"...":"..."},y=async(b,w)=>{try{const j=f?.codigoEmpresa||f?.codigo_empresa||null,_=m?.id||h?.id||null,C=m?.nome||h?.email||null,E=m?.cargo||null,P=new Date,k=new Date(P.getFullYear(),P.getMonth(),P.getDate(),0,0,0,0),M=new Date(k);M.setDate(M.getDate()+1);const S=k.toISOString(),I=M.toISOString(),T=Array.isArray(w)?w.map($=>({role:$.from==="isis"?"assistant":"user",content:$.text})):[],{data:D,error:B}=await ve.functions.invoke("chat-proxy",{body:{message:b,empresaCodigo:j,usuarioId:_,usuarioNome:C,usuarioCargo:E,data_inicio:S,data_fim:I,history:T}});if(B)throw B;const U=typeof D?.reply=="string"&&D.reply.trim().length>0?D.reply:"Certo! (resposta provisria)";let z=Array.isArray(D?.replies)?D.replies.filter($=>typeof $=="string"&&$.trim().length>0):[];if(z.length===0&&(z=[U]),console.log("[sis][response]",{replies:z,raw:D}),D)try{console.log("[sis][response raw JSON]",JSON.stringify(D,null,2))}catch{}for(let $=0;$<z.length;$++){const Y=z[$];v({from:"isis",text:Y}),$<z.length-1&&await new Promise(de=>setTimeout(de,600))}i(!1),l("")}catch{v({from:"isis",text:"No momento, estou operando em modo de demonstrao. Em breve estarei 100% conectada  OpenAI aqui na aba Premium! "}),i(!1),l("")}},x=async b=>{b.preventDefault();const w=r.trim();if(!w)return;const j=[...e];console.log("[sis][question]",{message:w}),v({from:"user",text:w}),n(""),i(!0),l(g(w)),await y(w,j)};return o.jsxs("div",{className:"flex h-full w-full relative",children:[o.jsxs("div",{className:"flex-1 flex flex-col pointer-events-none",children:[o.jsxs("div",{className:"flex-1 overflow-y-auto px-3 md:px-6 py-4 md:py-6",children:[e.map(b=>o.jsx(doe,{message:b},b.id)),a&&o.jsx(fr.div,{initial:{opacity:0},animate:{opacity:1},className:"flex justify-start mb-4",children:o.jsx("div",{className:"px-4 py-2 rounded-2xl bg-brand border border-brand text-[#0A0A0A] flex items-center gap-2 animate-pulse",children:s&&s!=="..."?o.jsxs(o.Fragment,{children:[o.jsx("span",{role:"img","aria-label":"pensando",children:""}),o.jsx("span",{children:s})]}):o.jsx("span",{className:"font-semibold tracking-widest",children:"..."})})}),o.jsx("div",{ref:u})]}),o.jsx("div",{className:"sticky bottom-0 px-3 md:px-6 pb-3 md:pb-6 pt-3 md:pt-4 bg-gradient-to-t from-background via-background to-transparent",children:o.jsxs("form",{onSubmit:x,className:"flex items-center gap-2 bg-surface/70 border border-white/10 rounded-xl px-3 py-2.5",children:[o.jsx(eH,{className:"w-5 h-5 text-text-muted"}),o.jsx("input",{value:r,onChange:b=>n(b.target.value),placeholder:"Escreva aqui",className:"flex-1 bg-transparent outline-none text-sm"}),o.jsxs("button",{type:"submit",disabled:!r.trim(),className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm font-semibold transition ${r.trim()?"bg-brand text-bg":"bg-surface/40 text-text-muted cursor-not-allowed"}`,children:[o.jsx(MI,{className:"w-4 h-4"}),"Enviar"]})]})})]}),c&&o.jsx("div",{className:"absolute inset-0 z-10 backdrop-blur-lg bg-black/60 flex items-center justify-center pointer-events-auto rounded-lg overflow-hidden",children:o.jsx(fr.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},transition:{duration:.5,ease:[.22,1,.36,1]},className:"rounded-2xl border border-white/30 bg-gradient-to-br from-slate-900 via-slate-900 to-slate-800 shadow-2xl max-w-sm w-full text-center mx-4 overflow-hidden",children:o.jsxs("div",{className:"px-8 py-10",children:[o.jsx(fr.div,{initial:{scale:.8},animate:{scale:1},transition:{delay:.2,duration:.4},className:"flex items-center justify-center mb-8",children:o.jsx("div",{className:"w-24 h-24 rounded-full p-[3px] bg-gradient-to-r from-fuchsia-500 via-violet-500 to-emerald-400 shadow-[0_0_20px_rgba(168,85,247,0.5)] overflow-hidden",children:o.jsx("div",{className:"w-full h-full rounded-full overflow-hidden bg-background flex items-center justify-center",children:o.jsx(Wd,{size:"lg"})})})}),o.jsxs(fr.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3,duration:.4},children:[o.jsx("div",{className:"text-3xl font-black bg-clip-text text-transparent bg-gradient-to-r from-fuchsia-400 via-violet-300 to-emerald-300 mb-4",children:"sis"}),o.jsx("p",{className:"text-sm text-gray-300 mb-6 leading-relaxed",children:"Em breve sua assistente IA vai estar pronta para revolucionar a gesto da sua arena. "}),o.jsxs("div",{className:"space-y-3 text-left",children:[o.jsxs("div",{className:"flex items-start gap-3 text-sm text-gray-200",children:[o.jsx("span",{className:"text-emerald-400 font-bold mt-0.5",children:""}),o.jsx("span",{children:"Gerencie agendamentos com inteligncia artificial"})]}),o.jsxs("div",{className:"flex items-start gap-3 text-sm text-gray-200",children:[o.jsx("span",{className:"text-violet-400 font-bold mt-0.5",children:""}),o.jsx("span",{children:"Otimize sua agenda e maximize ocupao"})]}),o.jsxs("div",{className:"flex items-start gap-3 text-sm text-gray-200",children:[o.jsx("span",{className:"text-fuchsia-400 font-bold mt-0.5",children:""}),o.jsx("span",{children:"Insights inteligentes sobre sua arena"})]})]})]})]})})})]})}function Hot({open:e,onOpenChange:t,codigoEmpresa:r,onSuccess:n}){const{toast:a}=oo(),[i,s]=p.useState("upload"),[l,c]=p.useState(null),[d,u]=p.useState(null),[f,m]=p.useState(!1),[h,v]=p.useState({success:!1,comandaId:null,error:null}),g=async j=>{const _=j.target.files?.[0];if(_){if(!_.name.endsWith(".xml")){a({title:"Arquivo invlido",description:"Selecione um arquivo XML vlido.",variant:"destructive"});return}c(_);try{const C=await _.text(),E=Q_(C);if(!E.success){a({title:"Erro ao ler XML",description:E.error||"XML invlido",variant:"destructive"});return}if(!E.produtos||E.produtos.length===0){a({title:"Nenhum produto encontrado",description:"O XML no contm produtos.",variant:"warning"});return}if(E.nfe?.tipo!=="Sada"){a({title:"Tipo de nota incorreto",description:"Este XML  de entrada. Use a importao em Produtos para notas de entrada.",variant:"warning"});return}u(E),s("preview")}catch(C){console.error("[XMLSalesImport] Erro ao processar arquivo:",C),a({title:"Erro ao processar XML",description:C.message,variant:"destructive"})}}},y=async()=>{s("processing"),m(!0);try{const j=await qu({searchTerm:"",limit:1e4,codigoEmpresa:r}),_=d.nfe?.dataEmissao?new Date(d.nfe.dataEmissao):new Date,C=d.nfe?.chaveAcesso||"",{data:E,error:P}=await ve.from("comandas").insert({codigo_empresa:r,mesa_id:null,status:"closed",aberto_em:_.toISOString(),fechado_em:_.toISOString(),observacao:`Importado de XML - NF-e ${d.nfe?.numero||""}${C?`
Chave: ${C}`:""}`,origem:"xml",xml_chave:C||null}).select().single();if(P)throw P;const k=[],M=[];for(const I of d.produtos){const T=Z_(I,j);if(T){k.push({comanda_id:E.id,produto_id:T.id,descricao:I.nome,quantidade:I.quantidade,preco_unitario:I.valorUnitario,desconto:I.desconto||0,codigo_empresa:r});const D=Math.max(0,(T.stock||T.estoque||0)-I.quantidade);await ve.from("produtos").update({estoque:D}).eq("id",T.id).eq("codigo_empresa",r)}else M.push(I.nome)}if(k.length>0){const{error:I}=await ve.from("comanda_itens").insert(k);if(I)throw I}const S=d.pagamentos||[];if(S.length>0){const{data:I}=await ve.from("finalizadoras").select("id, codigo_sefaz, nome").eq("codigo_empresa",r).eq("ativo",!0),T=new Map((I||[]).map(U=>[U.codigo_sefaz,U])),D=S.map(U=>{const z=T.get(U.codigoSefaz);return{comanda_id:E.id,finalizadora_id:z?.id||null,metodo:U.descricao.toLowerCase(),valor:U.valor,status:"Pago",recebido_em:_.toISOString(),codigo_empresa:r,origem:"xml",xml_chave:C||null}}),{error:B}=await ve.from("pagamentos").insert(D);if(B)throw B}else{const I=d.produtos.reduce((D,B)=>D+(B.valorTotal||0),0),{error:T}=await ve.from("pagamentos").insert({comanda_id:E.id,finalizadora_id:null,metodo:"outros",valor:I,status:"Pago",recebido_em:_.toISOString(),codigo_empresa:r,origem:"xml",xml_chave:C||null});if(T)throw T}console.log("[XMLSalesImport] Venda importada com sucesso. Comanda ID:",E.id),M.length>0?a({title:"Venda importada com avisos",description:`${k.length} produto(s) registrado(s), ${M.length} no encontrado(s).`,variant:"warning",duration:5e3}):a({title:"Venda importada com sucesso!",description:`${k.length} produto(s) registrado(s). Total: R$ ${w.toFixed(2)}`,variant:"success"}),v({success:!0,comandaId:E.id,error:null,produtosNaoEncontrados:M,totalItens:k.length,totalVenda:w,dataEmissao:_.toISOString().slice(0,10)}),s("done"),n&&n(_.toISOString().slice(0,10))}catch(j){console.error("[XMLSalesImport] Erro ao importar:",j),v({success:!1,comandaId:null,error:j.message}),s("done"),a({title:"Erro ao importar XML",description:j.message,variant:"destructive"})}finally{m(!1)}},x=()=>{s("upload"),c(null),u(null),v({success:!1,comandaId:null,error:null}),t(!1)},b=()=>{s("upload"),c(null),u(null)},w=d?.produtos?.reduce((j,_)=>j+(_.valorTotal||0),0)||0;return o.jsx(ln,{open:e,onOpenChange:t,children:o.jsxs(on,{className:"max-w-3xl max-h-[90vh] flex flex-col overflow-hidden",children:[o.jsxs(nn,{children:[o.jsx(rn,{className:"text-2xl font-bold",children:"Importar XML de Venda (NF-e)"}),o.jsxs(_n,{children:[i==="upload"&&"Selecione o arquivo XML da nota fiscal de sada",i==="preview"&&"Revise os dados da venda que ser importada",i==="processing"&&"Processando venda...",i==="done"&&"Importao finalizada"]})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto px-1",children:[i==="upload"&&o.jsx("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:o.jsxs("div",{className:"w-full max-w-md",children:[o.jsxs("label",{htmlFor:"xml-sales-upload",className:"flex flex-col items-center justify-center w-full h-64 border-2 border-dashed border-border rounded-lg cursor-pointer bg-surface hover:bg-surface-2 transition-colors",children:[o.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[o.jsx(LI,{className:"w-12 h-12 mb-4 text-text-muted"}),o.jsx("p",{className:"mb-2 text-sm text-text-primary font-semibold",children:"Clique para selecionar ou arraste o arquivo"}),o.jsx("p",{className:"text-xs text-text-muted",children:"XML de NF-e de Sada (Venda)"})]}),o.jsx("input",{id:"xml-sales-upload",type:"file",accept:".xml",className:"hidden",onChange:g})]}),l&&o.jsxs("div",{className:"mt-4 p-3 bg-surface-2 rounded-lg flex items-center gap-2",children:[o.jsx(ns,{className:"w-5 h-5 text-success"}),o.jsx("span",{className:"text-sm text-text-primary",children:l.name})]})]})}),i==="preview"&&o.jsxs("div",{className:"space-y-4",children:[d?.nfe&&o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[o.jsx("h3",{className:"font-semibold mb-3",children:"Informaes da NF-e"}),d.fornecedor&&o.jsxs("div",{className:"mb-3 pb-3 border-b border-border",children:[o.jsx("div",{className:"text-sm font-semibold text-text-primary mb-1",children:d.fornecedor.razaoSocial||d.fornecedor.nomeFantasia||"Fornecedor"}),o.jsxs("div",{className:"text-xs text-text-muted",children:[d.fornecedor.cnpj&&`CNPJ: ${d.fornecedor.cnpj}`,d.fornecedor.endereco?.cidade&&d.fornecedor.endereco?.uf&&`  ${d.fornecedor.endereco.cidade}/${d.fornecedor.endereco.uf}`]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-3",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Nmero:"})," ",o.jsx("span",{className:"font-mono",children:d.nfe.numero})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Srie:"})," ",o.jsx("span",{className:"font-mono",children:d.nfe.serie})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Tipo:"})," ",o.jsx("span",{className:"text-warning font-semibold",children:d.nfe.tipo})]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-text-muted",children:"Data:"})," ",o.jsx("span",{children:new Date(d.nfe.dataEmissao).toLocaleDateString("pt-BR")})]})]}),d.nfe.naturezaOperacao&&o.jsxs("div",{className:"mb-2 text-sm",children:[o.jsx("span",{className:"text-text-muted",children:"Natureza:"})," ",o.jsx("span",{className:"font-medium",children:d.nfe.naturezaOperacao})]}),d.nfe.totalNota!==void 0&&o.jsxs("div",{className:"mb-3 text-sm",children:[o.jsx("span",{className:"text-text-muted",children:"Total da Nota:"})," ",o.jsxs("span",{className:"font-mono font-semibold text-lg text-success",children:["R$ ",d.nfe.totalNota.toFixed(2)]})]}),d.nfe.chaveAcesso&&o.jsxs("div",{className:"mt-3 pt-3 border-t border-border",children:[o.jsx("span",{className:"text-text-muted text-xs",children:"Chave de Acesso:"}),o.jsx("p",{className:"font-mono text-xs break-all",children:d.nfe.chaveAcesso})]})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[o.jsxs("h3",{className:"font-semibold mb-3",children:["Produtos da Venda (",d.produtos.length,")"]}),o.jsx("div",{className:"space-y-2",children:d.produtos.map((j,_)=>o.jsxs("div",{className:"p-3 rounded-lg border border-border bg-surface flex items-start gap-3",children:[o.jsx($1,{className:"w-5 h-5 text-warning flex-shrink-0 mt-0.5"}),o.jsx("div",{className:"flex-1 min-w-0",children:o.jsxs("div",{className:"flex items-start justify-between gap-2",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"font-semibold text-sm truncate",children:j.nome}),o.jsxs("p",{className:"text-xs text-text-muted",children:[j.codigo&&`Cdigo: ${j.codigo}  `,"Qtd: ",j.quantidade," ",j.unidade]})]}),o.jsxs("div",{className:"text-right flex-shrink-0",children:[o.jsxs("p",{className:"text-sm font-semibold",children:["R$ ",j.valorTotal.toFixed(2)]}),o.jsxs("p",{className:"text-xs text-text-muted",children:["Unit: R$ ",j.valorUnitario.toFixed(2)]})]})]})})]},_))})]}),d.pagamentos&&d.pagamentos.length>0&&o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[o.jsxs("h3",{className:"font-semibold mb-3",children:["Formas de Pagamento (",d.pagamentos.length,")"]}),o.jsx("div",{className:"space-y-2",children:d.pagamentos.map((j,_)=>o.jsxs("div",{className:"p-3 rounded-lg border border-border bg-surface flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-semibold text-sm",children:j.descricao}),o.jsxs("p",{className:"text-xs text-text-muted",children:["Cdigo SEFAZ: ",j.codigoSefaz]})]}),o.jsxs("p",{className:"text-sm font-semibold",children:["R$ ",j.valor.toFixed(2)]})]},_))})]}),o.jsx("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(hc,{className:"w-5 h-5 text-warning flex-shrink-0 mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"font-semibold text-sm mb-1",children:"Ateno: Venda Externa"}),o.jsx("p",{className:"text-xs text-text-muted",children:"Esta venda ser registrada no histrico como uma venda externa (importada de XML). O estoque dos produtos ser subtrado automaticamente."})]})]})}),o.jsxs("div",{className:"flex items-center justify-between text-lg font-bold",children:[o.jsx("span",{children:"Total da Venda:"}),o.jsxs("span",{className:"text-success",children:["R$ ",w.toFixed(2)]})]})]}),i==="processing"&&o.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[o.jsx(Pm,{className:"w-12 h-12 animate-spin text-warning mb-4"}),o.jsx("p",{className:"text-lg font-semibold",children:"Processando venda..."}),o.jsx("p",{className:"text-sm text-text-muted",children:"Criando comanda e atualizando estoque"})]}),i==="done"&&o.jsx("div",{className:"space-y-4",children:o.jsx("div",{className:"bg-surface-2 rounded-lg p-6 border border-border text-center",children:h.success?o.jsxs(o.Fragment,{children:[o.jsx(Ai,{className:"w-16 h-16 text-success mx-auto mb-4"}),o.jsx("h3",{className:"text-xl font-bold mb-2",children:"Venda Importada com Sucesso!"}),o.jsx("p",{className:"text-sm text-text-muted mb-4",children:"A venda foi registrada no histrico"}),h.produtosNaoEncontrados&&h.produtosNaoEncontrados.length>0&&o.jsxs("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-3 text-left",children:[o.jsx("p",{className:"text-sm font-semibold mb-2",children:" Produtos no encontrados:"}),o.jsx("ul",{className:"text-xs text-text-muted space-y-1",children:h.produtosNaoEncontrados.map((j,_)=>o.jsxs("li",{children:[" ",j]},_))})]})]}):o.jsxs(o.Fragment,{children:[o.jsx(hc,{className:"w-16 h-16 text-danger mx-auto mb-4"}),o.jsx("h3",{className:"text-xl font-bold mb-2",children:"Erro na Importao"}),o.jsx("p",{className:"text-sm text-text-muted",children:h.error||"Ocorreu um erro ao importar a venda"})]})})})]}),o.jsxs(Un,{children:[i==="upload"&&o.jsx(oe,{variant:"outline",onClick:x,children:"Cancelar"}),i==="preview"&&o.jsxs(o.Fragment,{children:[o.jsx(oe,{variant:"outline",onClick:b,children:"Voltar"}),o.jsx(oe,{onClick:y,children:"Confirmar Importao"})]}),i==="done"&&o.jsx(oe,{onClick:x,children:"Fechar"})]})]})})}const Got={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},ny={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}};function Kot(e,t=300){const[r,n]=p.useState(e);return p.useEffect(()=>{const a=setTimeout(()=>n(e),t);return()=>clearTimeout(a)},[e,t]),r}function X2({value:e,onChange:t}){const[r,n]=p.useState(!1),a=p.useRef(null),i=p.useRef(null),s=p.useRef(null),[l,c]=p.useState({top:0,left:0,width:0,center:!1,mode:"fixed"});p.useEffect(()=>{function g(b){const w=b.target,j=a.current&&a.current.contains(w),_=s.current&&s.current.contains(w);!j&&!_&&n(!1)}function y(b){b.key==="Escape"&&n(!1)}function x(){r&&d()}return window.addEventListener("mousedown",g),window.addEventListener("keydown",y),window.addEventListener("scroll",x,!0),window.addEventListener("resize",x),()=>{window.removeEventListener("mousedown",g),window.removeEventListener("keydown",y),window.removeEventListener("scroll",x,!0),window.removeEventListener("resize",x)}},[r]),p.useEffect(()=>{if(r){const g=requestAnimationFrame(()=>{d();const y=requestAnimationFrame(()=>d());return()=>cancelAnimationFrame(y)});return()=>cancelAnimationFrame(g)}},[r]),p.useEffect(()=>{if(r&&l.mode==="overlay"){const g=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=g}}},[r,l.mode]);const d=()=>{try{const g=i.current;if(!g)return;const y=g.getBoundingClientRect(),x=window.innerWidth,b=window.innerHeight,w=8,j=Math.max(y.width,280),_=Math.min(x-w*2,360),C=Math.min(j,_);let E=320;if(s.current)try{E=s.current.getBoundingClientRect().height||E}catch{}if(x<=640){c({top:0,left:0,width:Math.min(x-w*2,360),center:!0,mode:"overlay"});return}const P=a.current,k=P?P.getBoundingClientRect():y,M=y.bottom-k.top+6,S=Math.max(y.width,280);c({top:M,left:0,width:S,center:!1,mode:"anchor"})}catch{}},u=g=>{try{const[y,x,b]=String(g||"").split("-").map(Number);return!y||!x||!b?null:new Date(y,x-1,b)}catch{return null}},f=g=>{const y=x=>String(x).padStart(2,"0");return`${g.getFullYear()}-${y(g.getMonth()+1)}-${y(g.getDate())}`},m=g=>{const y=x=>String(x).padStart(2,"0");return`${y(g.getDate())}/${y(g.getMonth()+1)}/${g.getFullYear()}`},h=u(e),v=h?m(h):"";return o.jsxs("div",{className:"relative",ref:a,children:[o.jsx("button",{type:"button",className:"absolute left-2 top-1/2 -translate-y-1/2 p-1 rounded hover:bg-warning/10 focus:outline-none",onMouseDown:g=>{g.preventDefault()},onClick:()=>{n(g=>!g),setTimeout(d,0)},"aria-label":"Abrir calendrio",children:o.jsx(Lde,{className:"h-4 w-4 text-warning"})}),typeof window<"u"&&window.innerWidth<=640?o.jsx("button",{type:"button",ref:i,onMouseDown:g=>{g.preventDefault()},onClick:()=>{n(!0),setTimeout(d,0)},className:"pl-9 pr-3 h-10 w-full text-left bg-surface text-text-primary border border-warning/40 rounded-md",children:v||"Selecionar data"}):o.jsx(or,{type:"text",readOnly:!0,ref:i,inputMode:"none",onMouseDown:g=>{g.preventDefault()},onClick:()=>{n(g=>!g),setTimeout(d,0)},className:"pl-9 pr-3 w-full bg-surface text-text-primary border border-warning/40 focus-visible:ring-warning focus-visible:border-warning",value:v}),r&&(l.mode==="overlay"?o.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/50",onClick:g=>{g.target===g.currentTarget&&n(!1)},children:o.jsx("div",{ref:s,className:"bg-black text-white border border-warning/40 rounded-md shadow-xl p-2 w-[92vw] max-w-[360px]",children:o.jsx(bc,{mode:"single",selected:h||void 0,onSelect:g=>{g&&(t(f(g)),n(!1))},showOutsideDays:!0,className:"",classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md",table:"w-full"}})})}):l.mode==="anchor"?o.jsx("div",{ref:s,className:"absolute z-[999] bg-black text-white border border-warning/40 rounded-md shadow-xl p-2 left-0",style:{top:`${l.top}px`,minWidth:`${l.width}px`,maxWidth:"92vw"},children:o.jsx(bc,{mode:"single",selected:h||void 0,onSelect:g=>{g&&(t(f(g)),n(!1))},showOutsideDays:!0,className:"",classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md",table:"w-full"}})}):o.jsx("div",{ref:s,className:"fixed z-[999] bg-black text-white border border-warning/40 rounded-md shadow-xl p-2",style:{top:`${l.top}px`,left:`${l.left}px`,width:`${l.width}px`,maxWidth:"92vw"},children:o.jsx(bc,{mode:"single",selected:h||void 0,onSelect:g=>{g&&(t(f(g)),n(!1))},showOutsideDays:!0,className:"",classNames:{caption_label:"text-sm font-medium text-white",head_cell:"text-xs text-warning/80 w-9",day:"h-9 w-9 p-0 font-normal text-white hover:bg-warning/10 rounded-md",day_selected:"bg-warning text-black hover:bg-warning focus:bg-warning",day_today:"border border-warning text-white",day_outside:"text-white/30",nav_button:"h-7 w-7 p-0 text-white hover:bg-warning/10 rounded-md",table:"w-full"}})}))]})}function Yot(){const{toast:e}=oo(),t=Pc(),{userProfile:r}=Do(),[n]=NS(),a=n.get("mesa"),[i,s]=p.useState(!1),[l,c]=p.useState([]),[d,u]=p.useState(()=>a?"":new Date().toISOString().slice(0,10)),[f,m]=p.useState(()=>a?"":new Date().toISOString().slice(0,10)),[h,v]=p.useState(()=>a?"all":"closed"),[g,y]=p.useState(""),x=Kot(g,350),[b,w]=p.useState("all"),[j,_]=p.useState("comandas"),[C,E]=p.useState(!1),[P,k]=p.useState(""),[M,S]=p.useState(null),[I,T]=p.useState({loading:!1,itens:[],pagamentos:[]}),[D,B]=p.useState(null),[U,z]=p.useState({open:!1,loading:!1,resumo:null,periodo:{from:null,to:null},movs:[]}),[$,Y]=p.useState(!1),[de,xe]=p.useState(!1),[q,L]=p.useState(!1),W=async()=>{try{e({title:"Gerando CSV...",description:"Aguarde enquanto preparamos o arquivo",variant:"default"});const Ce=await Iq({status:h,from:d||void 0,to:f||void 0,search:x||"",limit:1e4,offset:0});if(!Ce||Ce.length===0){e({title:"Nenhum dado para exportar",variant:"warning"});return}const je=Ce.map(qt=>qt.id),ae=await H3(je,r?.codigo_empresa),$e=await xp(r?.codigo_empresa),Ae=new Map($e.map(qt=>[qt.id,qt.numero])),Tt=await kq(je),Se=await Oq(je),Ne=Ce.map(qt=>{const lt=qt.mesa_id?`Mesa ${Ae.get(qt.mesa_id)||"?"}`:"Balco",rr=Tt[qt.id]||"Sem cliente",nt=Se[qt.id],$t=Array.isArray(nt)?nt.join(", "):nt||"No informado",Qr=qt.fechado_em?"Fechada":"Aberta";return{Tipo:qt.tipo==="balcao"?"Balco":"Mesa","Mesa/Local":lt,"Cliente(s)":rr,Status:Qr,Abertura:new Date(qt.aberto_em).toLocaleString("pt-BR"),Fechamento:qt.fechado_em?new Date(qt.fechado_em).toLocaleString("pt-BR"):"-","Total (R$)":Number(ae[qt.id]||0).toFixed(2),"Forma(s) Pagamento":$t,Observaes:qt.observacao||"-"}}),Ue=Object.keys(Ne[0]),Qe=[Ue.join(";"),...Ne.map(qt=>Ue.map(lt=>{const rr=qt[lt]||"";return`"${String(rr).replace(/"/g,'""')}"`}).join(";"))].join(`
`),et=new Blob(["\uFEFF"+Qe],{type:"text/csv;charset=utf-8;"}),pt=document.createElement("a"),Ke=URL.createObjectURL(et);pt.setAttribute("href",Ke),pt.setAttribute("download",`historico_comandas_${new Date().toISOString().slice(0,10)}.csv`),pt.style.visibility="hidden",document.body.appendChild(pt),pt.click(),document.body.removeChild(pt),e({title:"CSV exportado!",description:`${Ne.length} comandas exportadas`,variant:"success"})}catch(Ce){console.error("Erro ao exportar CSV:",Ce),e({title:"Erro ao exportar",description:Ce.message,variant:"destructive"})}},ne=async()=>{try{if(e({title:"Gerando CSV...",description:"Aguarde enquanto preparamos o arquivo",variant:"default"}),!l||l.length===0){e({title:"Nenhum dado para exportar",variant:"warning"});return}const Ce=l.map(Se=>{const Ne=Se.status==="open"?"Aberto":Se.status==="closed"?"Fechado":Se.status;return{"Data Abertura":Se.aberto_em?new Date(Se.aberto_em).toLocaleString("pt-BR"):"-","Data Fechamento":Se.fechado_em?new Date(Se.fechado_em).toLocaleString("pt-BR"):"-",Status:Ne,"Saldo Inicial (R$)":Number(Se.saldo_inicial||0).toFixed(2),"Saldo Final (R$)":Number(Se.saldo_final||0).toFixed(2),"Valor Contado (R$)":Se.valor_final_dinheiro?Number(Se.valor_final_dinheiro).toFixed(2):"-","Diferena (R$)":Se.diferenca_dinheiro?Number(Se.diferenca_dinheiro).toFixed(2):"-"}}),je=Object.keys(Ce[0]),ae=[je.join(";"),...Ce.map(Se=>je.map(Ne=>{const Ue=Se[Ne]||"";return`"${String(Ue).replace(/"/g,'""')}"`}).join(";"))].join(`
`),$e=new Blob(["\uFEFF"+ae],{type:"text/csv;charset=utf-8;"}),Ae=document.createElement("a"),Tt=URL.createObjectURL($e);Ae.setAttribute("href",Tt),Ae.setAttribute("download",`fechamentos_caixa_${new Date().toISOString().slice(0,10)}.csv`),Ae.style.visibility="hidden",document.body.appendChild(Ae),Ae.click(),document.body.removeChild(Ae),e({title:"CSV exportado!",description:`${Ce.length} fechamentos exportados`,variant:"success"})}catch(Ce){console.error("Erro ao exportar CSV:",Ce),e({title:"Erro ao exportar",description:Ce.message,variant:"destructive"})}},le=100,[K,Q]=p.useState(0),[re,G]=p.useState(!1),me=p.useRef(!1),pe=p.useRef(0),Be=p.useRef(0),Z=p.useRef(!1),ee=()=>{try{const Ce=localStorage.getItem("auth:userProfile");return Ce&&JSON.parse(Ce)?.codigo_empresa||null}catch{return null}},kt=p.useMemo(()=>`hist:comandas:${ee()||"na"}:${d}:${f}:${h}:${b}:${(x||"").trim()}`,[d,f,h,b,x]),Nt=async({append:Ce=!1,skipCacheWrite:je=!1}={})=>{try{s(!0);const ae=ee();if(!ae){s(!1);return}const $e=setTimeout(()=>s(!1),1e4);if(j==="comandas"){const Ae=!!(x&&x.trim()),Tt=Ae?1e3:le,Se=Ae?0:K;console.log("[HistoricoComandasPage] Carregando com:",{status:h,from:d,to:f,search:x,mesaId:a,searching:Ae,effLimit:Tt});const Ne=await Iq({status:h,from:d,to:f,search:a||x,limit:Tt,offset:Se});console.log("[HistoricoComandasPage] Resultado:",Ne?.length||0,"comandas");const Ue=(Ne||[]).map(rr=>rr.id);let Qe={};if(Ue.length>0)try{Qe=await H3(Ue,ae)}catch{Qe={}}let et=[];try{et=await xp(ae)}catch{et=[]}const pt=new Map((et||[]).map(rr=>[rr.id,rr.numero]));let Ke={},qt={};try{Ke=await kq(Ue)}catch{Ke={}}try{qt=await Oq(Ue)}catch{qt={}}const lt=(Ne||[]).map(rr=>{const nt=Ke[rr.id],$t=qt[rr.id];return{...rr,statusDerived:rr.status==="cancelled"?"cancelled":rr.fechado_em?"closed":rr.status||"open",total:Number(Qe[rr.id]||0),mesaNumero:pt.get(rr.mesa_id),clientesStr:Array.isArray(nt)?nt.join(", "):nt||"",finalizadorasStr:Array.isArray($t)?$t.join(", "):$t||""}});if(G(Ae?!1:(Ne||[]).length===le),c(Ce?rr=>[...rr,...lt]:lt),!je)try{localStorage.setItem(kt,JSON.stringify({ts:Date.now(),rows:lt}))}catch{}}else{const Ae=await Ute({from:d,to:f,limit:100,offset:0,codigoEmpresa:ae});c(Ae||[])}clearTimeout($e)}catch(ae){e({title:"Falha ao carregar histrico",description:ae?.message||"Tente novamente",variant:"destructive"})}finally{s(!1),pe.current=Date.now()}};p.useEffect(()=>{a&&(async()=>{try{const ae=(await xp(r?.codigo_empresa)||[]).find($e=>$e.id===a);ae&&k(`Mesa ${ae.numero}`)}catch{}})()},[a,r?.codigo_empresa]),p.useEffect(()=>{if(me.current=!0,j==="comandas")try{const Ce=localStorage.getItem(kt);if(Ce){const je=JSON.parse(Ce);je&&Array.isArray(je.rows)&&Date.now()-Number(je.ts||0)<12e4&&c(je.rows)}}catch{}return()=>{me.current=!1}},[kt,j]),p.useEffect(()=>{j==="comandas"&&(Q(0),G(!1)),Nt({append:!1})},[h,x,d,f,j]),p.useEffect(()=>{if(!i&&j==="comandas"&&l.length===0){const Ce=setTimeout(()=>{me.current&&Nt({append:!1,skipCacheWrite:!1})},1500);return()=>clearTimeout(Ce)}},[l.length,i,j]),p.useEffect(()=>{const Ce=()=>{document.visibilityState==="visible"&&Date.now()-(pe.current||0)>3e4&&Nt({append:!1})},je=()=>{Date.now()-(pe.current||0)>3e4&&Nt({append:!1})};return window.addEventListener("visibilitychange",Ce),window.addEventListener("focus",je),()=>{window.removeEventListener("visibilitychange",Ce),window.removeEventListener("focus",je)}},[kt,j]);const De=async Ce=>{S(Ce),T({loading:!0,itens:[],pagamentos:[]});const je=ee();Z.current=!0;const ae=++Be.current,$e=setTimeout(()=>{Be.current===ae&&Z.current&&T(Ae=>({...Ae,loading:!1}))},1e4);if(!je){clearTimeout($e),Be.current===ae&&Z.current&&T({loading:!1,itens:[],pagamentos:[]});return}try{const Ae=(l||[]).find(Tt=>Tt.id===Ce)||null;if(Ae){const Tt=Ae.mesa_id==null?"Balco":Ae.mesaNumero!=null?`Mesa ${Ae.mesaNumero}`:"Comanda";B({mesaLabel:Tt,clientesStr:Ae.clientesStr||"",aberto_em:Ae.aberto_em||null,fechado_em:Ae.fechado_em||null,tipo:Ae.mesa_id==null?"balcao":"comanda",status:Ae.statusDerived||Ae.status||"open",diferenca_pagamento:typeof Ae.diferenca_pagamento=="number"?Ae.diferenca_pagamento:0})}else B(null)}catch{B(null)}try{const Ae=async()=>{const[Se,Ne]=await Promise.all([Ci({comandaId:Ce,codigoEmpresa:je}),qte({comandaId:Ce,codigoEmpresa:je})]);let Ue=[];try{Ue=await Zi({comandaId:Ce,codigoEmpresa:je})}catch{}console.log("[openDetail] clientesVinc:",Ue);const Qe=new Map((Ue||[]).map(Ke=>{const qt=Ke?.cliente_id??Ke?.clientes?.id??null,lt=Ke?.clientes?.nome??Ke?.nome??Ke?.nome_livre??"";return console.log(`[openDetail] Mapeando cliente: cid=${qt}, nome=${lt}`),qt?[String(qt),lt]:null}).filter(Boolean));console.log("[openDetail] nomeById map:",Array.from(Qe.entries()));const et=[...Array.from(Qe.values()),...(Ue||[]).filter(Ke=>!Ke?.cliente_id&&(Ke?.nome_livre||Ke?.nome)).map(Ke=>Ke?.nome_livre||Ke?.nome||"Consumidor")];console.log("[openDetail] clientesDisponiveis:",et),console.log("[openDetail] pagamentos:",Ne);const pt=(Ne||[]).map((Ke,qt)=>{let lt="";return Ke?.cliente_id?(lt=Qe.get(String(Ke.cliente_id))||"",!lt&&et.length>0&&(lt=et[qt%et.length])):et.length>0&&(lt=et[qt%et.length]),console.log(`[openDetail] Pagamento ${qt}: cliente_id=${Ke?.cliente_id}, clienteNome=${lt}`),{...Ke,cliente_nome:lt,finalizadora_nome:Ke?.finalizadoras?.nome||Ke?.metodo||""}});return{itens:Se||[],pagamentos:pt}};let Tt=await Ae();Tt.itens.length===0&&Tt.pagamentos.length===0&&(await new Promise(Se=>setTimeout(Se,700)),Tt=await Ae()),Be.current===ae&&Z.current&&T({loading:!1,itens:Tt.itens,pagamentos:Tt.pagamentos})}catch(Ae){Be.current===ae&&Z.current&&T({loading:!1,itens:[],pagamentos:[]}),e({title:"Falha ao carregar detalhes",description:Ae?.message||"Tente novamente",variant:"destructive"})}finally{clearTimeout($e),Be.current===ae&&Z.current&&T(Ae=>({...Ae,loading:!1}))}},st=p.useMemo(()=>({sum:l.reduce((je,ae)=>je+Number(ae.total||0),0)}),[l]),ft=Ce=>(Ce||"").toString().toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,""),yt=p.useMemo(()=>{const Ce=(x||"").trim(),je=ft(Ce),$e=l.filter(Ae=>{const Tt=Ae.mesa_id==null;return!(b==="balcao"&&!Tt||b==="comanda"&&Tt)}).filter(Ae=>{const Tt=Ae.statusDerived||(Ae.status==="cancelled"?"cancelled":Ae.fechado_em?"closed":Ae.status||"open");return h==="closed"?Tt==="closed":h==="open"?Tt==="open":h==="awaiting-payment"?Tt==="awaiting-payment":h==="cancelled"?Tt==="cancelled":!0});return je?$e.filter(Ae=>{const Tt=Ae.mesaNumero!=null?String(Ae.mesaNumero):"",Se=Ae.mesa_id==null?"balcao":`mesa ${Tt}`;return[Tt,Se,Ae.clientesStr||"",Ae.finalizadorasStr||"",Ae.mesa_id==null?"balcao":"comanda",Ae.statusDerived||Ae.status||""].map(ft).join(" | ").includes(je)}):$e},[l,x,b,h]),Nr=Ce=>Ce==="open"?"Aberta":Ce==="awaiting-payment"?"Pagamento":Ce==="closed"?"Fechada":Ce==="cancelled"?"Cancelada":Ce||"",se=Ce=>{if(!Ce)return"";try{return new Date(Ce).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return""}},rt=Ce=>{const je=String(Ce||"").toLowerCase();return je==="open"?"Aberto":je==="closed"?"Fechado":""},mt=Ce=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(Ce||0)),tr=Ce=>Ce==="open"?"text-info bg-info/10 border-info/30":Ce==="awaiting-payment"?"text-warning bg-warning/10 border-warning/30":Ce==="closed"?"text-success bg-success/10 border-success/30":Ce==="cancelled"?"text-red-400 bg-red-500/10 border-red-500/30":"text-text-secondary bg-transparent border-border/50";return o.jsxs(fr.div,{variants:Got,initial:"hidden",animate:"visible",className:"min-h-screen flex flex-col",children:[o.jsxs(fr.div,{variants:ny,className:"mb-6 gap-3 flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[o.jsx(Fd,{value:"historico",onValueChange:Ce=>{Ce==="mesas"&&t("/vendas"),Ce==="balcao"&&t("/balcao"),Ce==="historico"&&t("/historico")},children:o.jsxs(ad,{className:"grid w-full sm:w-auto grid-cols-3 sm:inline-flex",children:[o.jsx(wa,{value:"mesas",children:"Mesas"}),o.jsx(wa,{value:"balcao",children:"Balco"}),o.jsx(wa,{value:"historico",children:"Histrico"})]})}),o.jsxs("div",{className:"w-full flex items-center gap-2 sm:gap-3",children:[o.jsxs("div",{className:"flex sm:hidden items-center gap-2 w-full",children:[o.jsxs(En,{value:j,onValueChange:_,children:[o.jsx(Sn,{className:"w-[160px] text-sm",children:o.jsx(kn,{placeholder:"Selecionar"})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"comandas",children:"Comandas"}),o.jsx(wt,{value:"fechamentos",children:"Fechamentos"})]})]}),o.jsxs("div",{className:"ml-auto text-xs text-text-secondary whitespace-nowrap",children:["Total: ",o.jsxs("span",{className:"font-semibold text-text-primary",children:["R$ ",st.sum.toFixed(2)]})]}),j==="comandas"&&o.jsx(oe,{type:"button",size:"icon",variant:"outline",className:"h-9 w-9 sm:hidden",onClick:()=>xe(!0),title:"Aes",children:o.jsx(ri,{className:"h-4 w-4"})}),j==="fechamentos"&&o.jsx(oe,{type:"button",size:"icon",variant:"outline",className:"h-9 w-9 sm:hidden",onClick:ne,title:"Exportar",children:o.jsx(ri,{className:"h-4 w-4"})})]}),o.jsx("div",{className:"hidden sm:flex items-center gap-2 sm:gap-3 ml-auto",children:o.jsx(Fd,{value:j,onValueChange:_,className:"w-full sm:w-auto",children:o.jsxs(ad,{className:"w-full grid grid-cols-2 sm:w-auto sm:inline-flex text-sm",children:[o.jsx(wa,{value:"comandas",className:"text-sm",children:"Comandas"}),o.jsx(wa,{value:"fechamentos",className:"text-sm",children:"Fechamentos"})]})})})]}),o.jsxs("div",{className:"hidden sm:flex w-full sm:w-auto items-center gap-2 sm:gap-3",children:[j==="comandas"&&o.jsxs(o.Fragment,{children:[o.jsxs(oe,{variant:"secondary",size:"sm",className:"hidden sm:inline-flex",onClick:()=>Y(!0),children:[o.jsx(ns,{className:"mr-2 h-4 w-4"}),"Importar XML"]}),o.jsxs(oe,{variant:"outline",size:"sm",className:"hidden sm:inline-flex",onClick:W,children:[o.jsx(ri,{className:"mr-1 h-3 w-3"}),"Exportar"]}),o.jsx("button",{className:"hidden sm:inline-block text-xs text-text-muted hover:text-text-primary transition-colors",onClick:()=>{if(q){const Ce=new Date().toISOString().slice(0,10);u(Ce),m(Ce),L(!1)}else u(""),m(""),L(!0);Q(0)},title:q?"Voltar ao filtro de hoje":"Mostrar todas as comandas",children:q?"":""}),o.jsxs("div",{className:"text-sm text-text-secondary whitespace-nowrap ml-auto",children:["Total: ",o.jsxs("span",{className:"font-semibold text-text-primary",children:["R$ ",st.sum.toFixed(2)]})]})]}),j==="fechamentos"&&o.jsxs(oe,{variant:"outline",size:"sm",className:"hidden sm:inline-flex",onClick:ne,children:[o.jsx(ri,{className:"mr-1 h-3 w-3"}),"Exportar"]})]})]}),o.jsx(ln,{open:de,onOpenChange:xe,children:o.jsxs(on,{className:"sm:hidden w-[92vw] max-w-[360px] p-2",onOpenAutoFocus:Ce=>Ce.preventDefault(),onKeyDown:Ce=>Ce.stopPropagation(),children:[o.jsxs(nn,{children:[o.jsx(rn,{className:"text-base",children:"Aes"}),o.jsx(_n,{children:"Escolha uma ao para Comandas"})]}),o.jsxs("div",{className:"flex flex-col gap-2",children:[o.jsxs(oe,{variant:"secondary",onClick:()=>{xe(!1),Y(!0)},children:[o.jsx(ns,{className:"mr-2 h-4 w-4"})," Importar XML"]}),o.jsxs(oe,{variant:"outline",onClick:()=>{xe(!1),W()},children:[o.jsx(ri,{className:"mr-2 h-4 w-4"})," Exportar CSV"]})]})]})}),j==="comandas"&&o.jsxs("div",{className:"flex items-center justify-between mt-2",children:[o.jsxs("div",{className:"text-xs text-text-secondary",children:["Carregadas ",l.length," ",l.length===1?"comanda":"comandas"]}),re&&o.jsx(oe,{size:"sm",variant:"outline",disabled:i,onClick:async()=>{const Ce=K+le;Q(Ce),await Nt({append:!0})},children:"Carregar mais"})]}),j==="comandas"&&o.jsxs("div",{className:"sm:hidden bg-surface rounded-lg border border-border p-3 mb-3",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(pi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(or,{placeholder:"Buscar...",className:"pl-9 h-9 text-sm",value:g,onChange:Ce=>y(Ce.target.value)})]}),o.jsx(oe,{size:"sm",variant:"outline",className:"h-9",onClick:()=>E(Ce=>!Ce),children:C?"Ocultar":"Filtros"})]}),o.jsxs("div",{className:"mt-1 text-[11px] text-text-secondary truncate",children:[d||"","  ",f||""]})]}),j==="comandas"&&o.jsx(fr.div,{variants:ny,className:`bg-surface rounded-lg border border-border p-4 mb-4 ${C?"":"hidden"} sm:block`,children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[o.jsxs("div",{children:[o.jsx(Wt,{className:"mb-1 block",children:"Perodo Inicial"}),o.jsx(X2,{value:d,onChange:u})]}),o.jsxs("div",{children:[o.jsx(Wt,{className:"mb-1 block",children:"Perodo Final"}),o.jsx(X2,{value:f,onChange:m})]}),o.jsxs("div",{className:"md:col-span-2 hidden sm:block",children:[o.jsxs(Wt,{className:"mb-1 block",children:["Busca ",P&&o.jsxs("span",{className:"text-xs text-warning ml-1",children:["(",P,")"]})]}),o.jsxs("div",{className:"relative",children:[o.jsx(pi,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted"}),o.jsx(or,{placeholder:"Mesa, status (fechada/aberta) ou cliente",className:"pl-9 pr-12",value:g,onChange:Ce=>y(Ce.target.value)}),a&&o.jsx(oe,{size:"sm",variant:"ghost",className:"absolute right-1 top-1/2 -translate-y-1/2 h-7 text-xs",onClick:()=>{t("/historico")},children:" Limpar"})]})]}),o.jsxs("div",{children:[o.jsx(Wt,{className:"mb-1 block",children:"Status"}),o.jsxs(En,{value:h,onValueChange:v,children:[o.jsx(Sn,{className:"w-full text-xs",children:o.jsx(kn,{placeholder:"Selecionar status"})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"closed",children:"Fechadas"}),o.jsx(wt,{value:"open",children:"Abertas"}),o.jsx(wt,{value:"awaiting-payment",children:"Pagamento"}),o.jsx(wt,{value:"cancelled",children:"Canceladas"})]})]})]}),o.jsxs("div",{children:[o.jsx(Wt,{className:"mb-1 block",children:"Tipo"}),o.jsxs(En,{value:b,onValueChange:w,children:[o.jsx(Sn,{className:"w-full text-xs",children:o.jsx(kn,{placeholder:"Selecionar tipo"})}),o.jsxs(Cn,{children:[o.jsx(wt,{value:"all",children:"Todos"}),o.jsx(wt,{value:"comanda",children:"Comandas"}),o.jsx(wt,{value:"balcao",children:"Balco"})]})]})]})]})}),j==="comandas"&&o.jsxs(fr.div,{variants:ny,className:"bg-surface rounded-lg border border-border p-0 overflow-hidden",children:[o.jsx("div",{className:"hidden sm:block overflow-x-auto pr-2 sm:pr-3",children:o.jsxs("table",{className:"min-w-full text-sm",children:[o.jsx("thead",{className:"bg-surface-2 text-text-secondary",children:o.jsxs("tr",{children:[o.jsx("th",{className:"text-left px-4 py-3 whitespace-nowrap",children:"Mesa"}),o.jsx("th",{className:"text-left px-4 py-3 whitespace-nowrap",children:"Tipo"}),o.jsx("th",{className:"text-left px-4 py-3",children:"Clientes"}),o.jsx("th",{className:"text-left px-4 py-3",children:"Status"}),o.jsx("th",{className:"text-left px-4 py-3",children:"Finalizadora"}),o.jsx("th",{className:"text-left px-4 py-3 whitespace-nowrap",children:"Abertura"}),o.jsx("th",{className:"text-left px-4 py-3 whitespace-nowrap",children:"Fechamento"}),o.jsx("th",{className:"text-right px-4 py-3 whitespace-nowrap",children:"Diferena"}),o.jsx("th",{className:"text-right px-4 py-3",children:"Total"})]})}),o.jsxs("tbody",{children:[yt.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:8,className:"px-4 py-6 text-center text-text-muted",children:"Nenhuma comanda encontrada no perodo."})}),yt.map(Ce=>o.jsxs("tr",{className:"border-t border-border/70 hover:bg-warning/10 cursor-pointer transition-all duration-150 hover:translate-x-[1px]",onClick:()=>De(Ce.id),children:[o.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:Ce.mesa_id==null?"Balco":Ce.mesaNumero!=null?`Mesa ${Ce.mesaNumero}`:""}),o.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:Ce.mesa_id==null?"Balco":"Comanda"}),o.jsx("td",{className:"px-4 py-2 break-words",title:Ce.clientesStr||"",children:Ce.clientesStr||""}),o.jsx("td",{className:"px-4 py-2",children:o.jsx("span",{className:Yt("inline-flex items-center text-[11px] font-medium px-2 py-0.5 rounded-full border",tr(Ce.statusDerived||Ce.status)),children:Nr(Ce.statusDerived||Ce.status)})}),o.jsx("td",{className:"px-4 py-2 break-words",title:Ce.finalizadorasStr||"",children:Ce.finalizadorasStr||""}),o.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:se(Ce.aberto_em)}),o.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:se(Ce.fechado_em)}),o.jsx("td",{className:"px-4 py-2 text-right whitespace-nowrap",children:(()=>{const je=typeof Ce.diferenca_pagamento=="number"?Ce.diferenca_pagamento:0;if(Math.abs(je)<.005)return o.jsx("span",{className:"text-xs text-text-muted",children:"R$ 0,00"});const ae=je>0?"text-emerald-500":"text-amber-500",$e=je>0?"+":"-";return o.jsx("span",{className:`text-xs font-semibold ${ae}`,children:`${$e} R$ ${Math.abs(je).toFixed(2)}`})})()}),o.jsx("td",{className:"px-4 py-2 text-right font-semibold whitespace-nowrap",children:mt(Ce.total)})]},Ce.id))]})]})}),o.jsxs("div",{className:"sm:hidden divide-y divide-border",children:[yt.length===0&&o.jsx("div",{className:"p-4 text-center text-text-muted",children:"Nenhuma comanda encontrada no perodo."}),yt.map(Ce=>o.jsxs("button",{className:"w-full text-left p-3 active:bg-warning/10",onClick:()=>De(Ce.id),children:[o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"min-w-0",children:[o.jsx("div",{className:"text-xs text-text-secondary",children:Ce.mesa_id==null?"Balco":Ce.mesaNumero!=null?`Mesa ${Ce.mesaNumero}`:"Comanda"}),o.jsx("div",{className:"font-semibold truncate max-w-[220px]",children:Ce.clientesStr||"Sem cliente"})]}),o.jsx("div",{children:o.jsx("div",{className:Yt("inline-flex items-center text-[10px] font-medium px-2 py-0.5 rounded-full border",tr(Ce.statusDerived||Ce.status)),children:Nr(Ce.statusDerived||Ce.status)})})]}),o.jsx("div",{className:"mt-1 text-xs text-text-secondary truncate",children:Ce.finalizadorasStr||""}),o.jsxs("div",{className:"mt-2 flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"flex-1 min-w-0 text-[11px] text-text-muted truncate pr-2",children:[se(Ce.aberto_em),Ce.fechado_em?`  ${se(Ce.fechado_em)}`:""]}),o.jsxs("div",{className:"flex-shrink-0 text-right min-w-[84px]",children:[o.jsx("div",{className:"text-[11px]",children:(()=>{const je=typeof Ce.diferenca_pagamento=="number"?Ce.diferenca_pagamento:0;if(Math.abs(je)<.005)return o.jsx("span",{className:"text-text-muted",children:"Dif.: R$ 0,00"});const ae=je>0?"text-emerald-500":"text-amber-500",$e=je>0?"+":"-";return o.jsx("span",{className:ae,children:`Dif.: ${$e} R$ ${Math.abs(je).toFixed(2)}`})})()}),o.jsx("div",{className:"font-mono font-semibold whitespace-nowrap",children:mt(Ce.total)})]})]})]},Ce.id))]})]}),j==="fechamentos"&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"sm:hidden bg-surface rounded-lg border border-border p-3 mb-3",children:o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsx("div",{className:"text-sm font-medium",children:"Filtros"}),o.jsx(oe,{size:"sm",variant:"outline",onClick:()=>E(Ce=>!Ce),children:C?"Ocultar filtros":"Mostrar filtros"})]})}),o.jsx(fr.div,{variants:ny,className:`bg-surface rounded-lg border border-border p-4 mb-4 ${C?"":"hidden"} sm:block`,children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[o.jsxs("div",{children:[o.jsx(Wt,{className:"mb-1 block",children:"Perodo Inicial"}),o.jsx(X2,{value:d,onChange:u})]}),o.jsxs("div",{children:[o.jsx(Wt,{className:"mb-1 block",children:"Perodo Final"}),o.jsx(X2,{value:f,onChange:m})]})]})}),o.jsxs(fr.div,{variants:ny,className:"bg-surface rounded-lg border border-border p-4 overflow-hidden",children:[o.jsxs("div",{className:"sm:hidden space-y-2",children:[i&&(!l||l.length===0)&&o.jsxs("div",{className:"px-2 py-3 text-center text-text-muted",children:[o.jsx(Pm,{className:"inline mr-2 h-4 w-4 animate-spin"}),"Carregando fechamentos"]}),(!l||l.length===0)&&!i&&o.jsx("div",{className:"px-2 py-3 text-center text-text-muted",children:"Nenhum fechamento encontrado no perodo."}),(l||[]).map(Ce=>o.jsxs("button",{onClick:async()=>{try{z({open:!0,loading:!0,resumo:null,periodo:{from:Ce.aberto_em,to:Ce.fechado_em},movs:[],movimentosAgg:null,saldos:{inicial:Ce?.saldo_inicial??null,final:Ce?.saldo_final??null}});const je=ee(),[ae,$e]=await Promise.all([M_({caixaSessaoId:Ce.id,codigoEmpresa:je}).catch(()=>null),Op({caixaSessaoId:Ce.id,codigoEmpresa:je}).catch(()=>[])]);let Ae=ae?.movimentos||null;if(!Ae&&Array.isArray($e)){const Se={suprimentos:0,sangrias:0,ajustes:0,troco:0};for(const Ne of $e){const Ue=String(Ne?.tipo||"").toLowerCase(),Qe=Number(Ne?.valor||0);Ue==="suprimento"?Se.suprimentos+=Qe:Ue==="sangria"?Se.sangrias+=Qe:Ue==="ajuste"?Se.ajustes+=Qe:Ue==="troco"&&(Se.troco+=Qe)}Ae=Se}const Tt=ae?{totalDescontos:Number(ae.total_descontos||0),totalVendasLiquidas:Number(ae.total_liquido||0),totalEntradas:Number(ae.total_entradas||0),totalPorFinalizadora:ae.por_finalizadora||{}}:null;z({open:!0,loading:!1,resumo:Tt,periodo:{from:ae?.periodo_de||Ce.aberto_em,to:ae?.periodo_ate||Ce.fechado_em},movs:$e||[],movimentosAgg:Ae,saldos:{inicial:Ce?.saldo_inicial??null,final:Ce?.saldo_final??null}})}catch{z({open:!0,loading:!1,resumo:null,periodo:{from:Ce.aberto_em,to:Ce.fechado_em},movs:[],movimentosAgg:null,saldos:{inicial:Ce?.saldo_inicial??null,final:Ce?.saldo_final??null}})}},className:"w-full text-left p-3 rounded-lg border border-border hover:bg-surface-2 transition",children:[o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsxs("div",{className:"text-xs text-text-secondary",children:[se(Ce.aberto_em),o.jsx("span",{className:"mx-1",children:""}),se(Ce.fechado_em)]}),o.jsx("div",{className:"text-[11px] px-2 py-0.5 rounded-full border bg-success/10 text-success border-success/30",children:rt(Ce.status)})]}),o.jsxs("div",{className:"mt-1 grid grid-cols-2 gap-2 text-xs",children:[o.jsxs("div",{className:"bg-surface-2 rounded p-2 border border-border",children:[o.jsx("div",{className:"text-[10px] text-text-secondary",children:"Saldo Inicial"}),o.jsx("div",{className:"font-semibold",children:Ce?.saldo_inicial!=null?mt(Ce.saldo_inicial):""})]}),o.jsxs("div",{className:"bg-surface-2 rounded p-2 border border-border",children:[o.jsx("div",{className:"text-[10px] text-text-secondary",children:"Saldo Final (contado)"}),o.jsx("div",{className:"font-semibold",children:Ce?.valor_final_dinheiro!=null?mt(Ce.valor_final_dinheiro):""})]})]})]},Ce.id))]}),o.jsx("div",{className:"hidden sm:block overflow-x-auto max-h-[60vh] overflow-y-auto pr-2 sm:pr-3",children:o.jsxs("table",{className:"min-w-full text-sm",children:[o.jsx("thead",{className:"bg-surface-2 text-text-secondary",children:o.jsxs("tr",{children:[o.jsx("th",{className:"text-left px-4 py-3",children:"Abertura"}),o.jsx("th",{className:"text-left px-4 py-3",children:"Fechamento"}),o.jsx("th",{className:"text-left px-4 py-3",children:"Status"}),o.jsx("th",{className:"text-right px-4 py-3",children:"Saldo Inicial"}),o.jsx("th",{className:"text-right px-4 py-3",children:"Saldo Final (contado)"})]})}),o.jsxs("tbody",{children:[i&&(!l||l.length===0)&&o.jsx("tr",{children:o.jsxs("td",{colSpan:5,className:"px-4 py-6 text-center text-text-muted",children:[o.jsx(Pm,{className:"inline mr-2 h-4 w-4 animate-spin"}),"Carregando fechamentos"]})}),(!l||l.length===0)&&o.jsx("tr",{children:o.jsx("td",{colSpan:5,className:"px-4 py-6 text-center text-text-muted",children:"Nenhum fechamento encontrado no perodo."})}),(l||[]).map(Ce=>o.jsxs("tr",{className:"border-t border-border/70 hover:bg-success/10 cursor-pointer transition-all duration-150 hover:translate-x-[1px]",onClick:async()=>{try{z({open:!0,loading:!0,resumo:null,periodo:{from:Ce.aberto_em,to:Ce.fechado_em},movs:[],movimentosAgg:null,saldos:{inicial:Ce?.saldo_inicial??null,final:Ce?.saldo_final??null}});const je=async()=>{const Ae=ee(),[Tt,Se]=await Promise.all([M_({caixaSessaoId:Ce.id,codigoEmpresa:Ae}).catch(()=>null),Op({caixaSessaoId:Ce.id,codigoEmpresa:Ae}).catch(()=>[])]);return{snap:Tt,movs:Se}};let{snap:ae,movs:$e}=await je();if(ae||(await new Promise(Ae=>setTimeout(Ae,700)),{snap:ae,movs:$e}=await je()),ae){const Ae={totalDescontos:Number(ae.total_descontos||0),totalVendasLiquidas:Number(ae.total_liquido||0),totalEntradas:Number(ae.total_entradas||0),totalPorFinalizadora:ae.por_finalizadora||{}};let Tt=ae.movimentos||null;if(!Tt&&Array.isArray($e)){const Se={suprimentos:0,sangrias:0,ajustes:0,troco:0};for(const Ne of $e){const Ue=String(Ne?.tipo||"").toLowerCase(),Qe=Number(Ne?.valor||0);Ue==="suprimento"?Se.suprimentos+=Qe:Ue==="sangria"?Se.sangrias+=Qe:Ue==="ajuste"?Se.ajustes+=Qe:Ue==="troco"&&(Se.troco+=Qe)}Tt=Se}z({open:!0,loading:!1,resumo:Ae,periodo:{from:ae.periodo_de||Ce.aberto_em,to:ae.periodo_ate||Ce.fechado_em},movs:$e||[],movimentosAgg:Tt,saldos:{inicial:typeof ae.saldo_inicial<"u"?Number(ae.saldo_inicial):Ce?.saldo_inicial??null,final:typeof ae.valor_final_dinheiro<"u"?Number(ae.valor_final_dinheiro):Ce?.valor_final_dinheiro??null}})}else{const Ae=ee(),Tt=await nd({from:Ce.aberto_em,to:Ce.fechado_em||new Date().toISOString(),codigoEmpresa:Ae});let Se=null;if(Array.isArray($e)){const Ne={suprimentos:0,sangrias:0,ajustes:0,troco:0};for(const Ue of $e){const Qe=String(Ue?.tipo||"").toLowerCase(),et=Number(Ue?.valor||0);Qe==="suprimento"?Ne.suprimentos+=et:Qe==="sangria"?Ne.sangrias+=et:Qe==="ajuste"?Ne.ajustes+=et:Qe==="troco"&&(Ne.troco+=et)}Se=Ne}z({open:!0,loading:!1,resumo:Tt||null,periodo:{from:Ce.aberto_em,to:Ce.fechado_em},movs:$e||[],movimentosAgg:Se,saldos:{inicial:Ce?.saldo_inicial??null,final:Ce?.valor_final_dinheiro??null}})}}catch{z({open:!0,loading:!1,resumo:null,periodo:{from:Ce.aberto_em,to:Ce.fechado_em},movs:[],movimentosAgg:null,saldos:{inicial:Ce?.saldo_inicial??null,final:Ce?.valor_final_dinheiro??null}})}},children:[o.jsx("td",{className:"px-4 py-2",children:se(Ce.aberto_em)}),o.jsx("td",{className:"px-4 py-2",children:se(Ce.fechado_em)}),o.jsx("td",{className:"px-4 py-2",children:rt(Ce.status)}),o.jsx("td",{className:"px-4 py-2 text-right",children:Ce?.saldo_inicial!=null?mt(Ce.saldo_inicial):""}),o.jsx("td",{className:"px-4 py-2 text-right",children:Ce?.valor_final_dinheiro!=null?mt(Ce.valor_final_dinheiro):""})]},Ce.id))]})]})})]})]}),j==="comandas"&&o.jsx(ln,{open:!!M,onOpenChange:Ce=>{Ce?Z.current=!0:(Z.current=!1,S(null),T({loading:!1,itens:[],pagamentos:[]}),B(null))},children:o.jsxs(on,{className:"sm:max-w-4xl w-[92vw] max-h-[90vh] overflow-hidden flex flex-col animate-none",onKeyDown:Ce=>Ce.stopPropagation(),children:[o.jsxs(nn,{children:[o.jsxs(rn,{className:"flex items-center gap-2 flex-wrap",children:[o.jsx("span",{children:D?o.jsxs("span",{children:[D.mesaLabel,D.clientesStr?o.jsxs("span",{className:"text-text-secondary",children:["  ",D.clientesStr]}):null]}):o.jsxs(o.Fragment,{children:["Comanda #",M||""]})}),D&&o.jsxs("div",{className:"flex gap-2",children:[o.jsx("span",{className:Yt("text-xs px-2 py-0.5 rounded-full border",tr(D.status)),children:D.status==="closed"?"Fechada":D.status==="open"?"Aberta":"Cancelada"}),o.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full border bg-info/10 text-info border-info/30",children:D.tipo==="balcao"?"Balco":D.tipo==="comanda"?"Mesa":"Importada"})]})]}),o.jsx(_n,{className:"space-y-1",children:D?o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[D.aberto_em?o.jsxs(o.Fragment,{children:["Abertura: ",se(D.aberto_em)]}):"",D.fechado_em&&o.jsxs(o.Fragment,{children:[" ",""," ","Fechamento: ",se(D.fechado_em),(()=>{const Ce=new Date(D.aberto_em),ae=new Date(D.fechado_em)-Ce,$e=Math.floor(ae/6e4),Ae=Math.floor($e/60),Tt=$e%60;return $e>0?o.jsxs("span",{className:"text-text-muted",children:[" (",Ae>0?`${Ae}h `:"",Tt,"min)"]}):null})()]})]}),D.observacao&&o.jsx("div",{className:"text-xs text-text-muted",children:D.observacao.includes("Importado de XML")?o.jsxs("span",{className:"text-warning",children:[" ",D.observacao.split(`
`)[0]]}):o.jsxs("span",{children:["Obs: ",D.observacao]})})]}):o.jsx(o.Fragment,{children:"Itens e pagamentos registrados."})})]}),I.loading?o.jsxs("div",{className:"p-6 text-center text-text-muted",children:[o.jsx(Pm,{className:"mr-2 inline h-4 w-4 animate-spin"})," Carregando..."]}):o.jsxs("div",{className:"space-y-4 overflow-y-auto flex-1 px-1",children:[(()=>{const Ce=I.itens.reduce((Se,Ne)=>Se+Number(Ne.quantidade||0)*Number(Ne.preco_unitario||0),0),je=I.itens.reduce((Se,Ne)=>Se+Number(Ne.desconto||0),0),ae=Ce-je,$e=I.pagamentos.reduce((Se,Ne)=>Se+Number(Ne.valor||0),0),Ae=typeof D?.diferenca_pagamento=="number"?D.diferenca_pagamento:null,Tt=Ae??$e-ae;return o.jsxs("div",{className:"bg-surface-2 rounded-lg p-4 border border-border",children:[o.jsx("h3",{className:"font-semibold mb-3",children:"Resumo Financeiro"}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-text-muted",children:"Subtotal"}),o.jsxs("span",{className:"font-mono font-semibold",children:["R$ ",Ce.toFixed(2)]})]}),je>0&&o.jsxs("div",{className:"flex items-center gap-2 text-warning",children:[o.jsx("span",{children:"Desconto"}),o.jsxs("span",{className:"font-mono font-semibold",children:["-R$ ",je.toFixed(2)]})]})]}),o.jsxs("div",{className:"flex justify-between font-semibold pt-2 border-t border-border",children:[o.jsx("span",{children:"Total:"}),o.jsxs("span",{className:"font-mono text-lg",children:["R$ ",ae.toFixed(2)]})]}),o.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[o.jsxs("div",{className:"flex items-center gap-2 text-success",children:[o.jsx("span",{children:"Pagamentos"}),o.jsxs("span",{className:"font-mono",children:["R$ ",$e.toFixed(2)]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-text-secondary",children:"Diferena"}),o.jsx("span",{className:Yt("font-semibold",Math.abs(Tt)<.005?"text-text-muted":Tt>0?"text-emerald-500":"text-amber-500"),children:Math.abs(Tt)<.005?"R$ 0,00":`${Tt>0?"+":"-"} R$ ${Math.abs(Tt).toFixed(2)}`})]})]})]})]})})(),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"border rounded-md p-3",children:[o.jsxs("div",{className:"font-semibold mb-2",children:["Itens (",I.itens.length,")"]}),I.itens.length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Sem itens."}):o.jsx("ul",{className:"text-sm space-y-2 max-h-64 overflow-auto thin-scroll",children:I.itens.map(Ce=>{const je=Number(Ce.quantidade||0)*Number(Ce.preco_unitario||0),ae=Number(Ce.desconto||0),$e=je-ae;return o.jsx("li",{className:"border-b border-border/50 pb-2 last:border-0",children:o.jsxs("div",{className:"flex justify-between items-start gap-2",children:[o.jsxs("span",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"font-medium truncate",children:Ce.descricao}),o.jsxs("div",{className:"text-xs text-text-muted",children:[Ce.quantidade," x R$ ",Number(Ce.preco_unitario||0).toFixed(2),ae>0&&o.jsxs("span",{className:"text-warning",children:[" (desc: R$ ",ae.toFixed(2),")"]})]})]}),o.jsxs("span",{className:"font-mono font-semibold whitespace-nowrap",children:["R$ ",$e.toFixed(2)]})]})},Ce.id)})})]}),o.jsxs("div",{className:"border rounded-md p-3",children:[o.jsxs("div",{className:"font-semibold mb-2",children:["Pagamentos (",I.pagamentos.length,")"]}),I.pagamentos.length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Sem registros."}):o.jsx("ul",{className:"text-sm space-y-2 max-h-64 overflow-auto thin-scroll",children:I.pagamentos.map(Ce=>o.jsxs("li",{className:"flex justify-between gap-2 border-b border-border/50 pb-2 last:border-0",children:[o.jsxs("span",{className:"pr-2 break-words flex-1",children:[Ce.cliente_nome?o.jsx("div",{className:"font-medium",children:Ce.cliente_nome}):o.jsx("div",{className:"text-text-muted",children:"Sem cliente"}),o.jsx("div",{className:"text-xs text-text-secondary",children:Ce.finalizadora_nome||"Outros"})]}),o.jsxs("span",{className:"font-mono font-semibold whitespace-nowrap",children:["R$ ",Number(Ce.valor||0).toFixed(2)]})]},Ce.id))})]})]})]}),o.jsx(Un,{children:o.jsx(oe,{size:"sm",variant:"secondary",onClick:()=>{S(null)},children:"Fechar"})})]})}),j==="fechamentos"&&o.jsx(ln,{open:U.open,onOpenChange:Ce=>{Ce||z({open:!1,loading:!1,resumo:null,periodo:{from:null,to:null}})},children:o.jsxs(on,{className:"sm:max-w-2xl w-[92vw] max-h-[85vh] animate-none flex flex-col overflow-hidden overflow-x-hidden",onKeyDown:Ce=>Ce.stopPropagation(),children:[o.jsxs(nn,{children:[o.jsx(rn,{children:"Fechamento do Perodo"}),o.jsxs(_n,{children:[U.periodo.from?se(U.periodo.from):""," ","at"," ",U.periodo.to?se(U.periodo.to):""]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto pr-1",children:U.loading?o.jsxs("div",{className:"p-3 sm:p-4 text-text-muted",children:[o.jsx(Pm,{className:"inline mr-2 h-4 w-4 animate-spin"}),"Carregando resumo"]}):o.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-3",children:[o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Saldo Inicial"}),o.jsx("p",{className:"text-xl font-bold",children:mt(U?.saldos?.inicial??0)})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Entradas (pagamentos)"}),o.jsx("p",{className:"text-xl font-bold text-success",children:mt(U.resumo?.totalEntradas||0)})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border col-span-2 sm:col-span-1",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Saldo Final (contado)"}),o.jsx("p",{className:"text-xl font-bold",children:U?.saldos?.final!=null?mt(U.saldos.final):""})]})]}),o.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 gap-2 sm:gap-3",children:[o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Descontos"}),o.jsx("p",{className:"text-xl font-bold text-warning",children:mt(U.resumo?.totalDescontos||0)})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Lquido"}),o.jsx("p",{className:"text-xl font-bold",children:mt(U.resumo?.totalVendasLiquidas||0)})]})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-semibold mb-1",children:"Por Finalizadora"}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:U.resumo?.totalPorFinalizadora&&Object.keys(U.resumo.totalPorFinalizadora).length>0?Object.entries(U.resumo.totalPorFinalizadora).map(([Ce,je])=>o.jsxs("div",{className:"flex items-center justify-between bg-surface-2 rounded-md p-2 border border-border",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:String(Ce)}),o.jsx("span",{className:"text-sm font-semibold",children:mt(je)})]},Ce)):o.jsx("div",{className:"text-sm text-text-muted",children:"Sem dados de finalizadoras"})})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-semibold mb-1",children:"Resumo de Movimentaes"}),U.movimentosAgg?o.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3",children:[o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Suprimentos"}),o.jsx("p",{className:"text-lg font-bold text-success",children:mt(U.movimentosAgg?.suprimentos||0)})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Sangrias"}),o.jsx("p",{className:"text-lg font-bold text-danger",children:mt(U.movimentosAgg?.sangrias||0)})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Ajustes"}),o.jsx("p",{className:"text-lg font-bold",children:mt(U.movimentosAgg?.ajustes||0)})]}),o.jsxs("div",{className:"bg-surface-2 rounded-lg p-3 border border-border",children:[o.jsx("p",{className:"text-xs text-text-secondary",children:"Troco"}),o.jsx("p",{className:"text-lg font-bold",children:mt(U.movimentosAgg?.troco||0)})]})]}):o.jsx("div",{className:"text-sm text-text-muted",children:"Sem movimentaes agregadas nesta sesso."})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm font-semibold mb-1",children:"Movimentaes"}),!U.movs||U.movs.length===0?o.jsx("div",{className:"text-sm text-text-muted",children:"Nenhuma movimentao registrada"}):o.jsxs(o.Fragment,{children:[o.jsx("ul",{className:"sm:hidden divide-y divide-border rounded-md border border-border overflow-hidden",children:U.movs.map((Ce,je)=>o.jsxs("li",{className:"px-3 py-2",children:[o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsx("span",{className:"text-xs text-text-secondary whitespace-nowrap",children:se(Ce.criado_em)}),o.jsx("span",{className:"text-sm font-semibold whitespace-nowrap",children:mt(Ce.valor||0)})]}),o.jsxs("div",{className:"mt-0.5 flex items-center gap-2 text-xs",children:[o.jsx("span",{className:"px-1.5 py-0.5 rounded bg-surface-2 border border-border text-text-secondary whitespace-nowrap",children:String(Ce.tipo||"").toUpperCase()}),o.jsx("span",{className:"text-xs text-text-primary whitespace-normal break-words flex-1",children:Ce.observacao||""})]})]},je))}),o.jsx("div",{className:"hidden sm:block rounded-md border border-border overflow-x-auto",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{className:"bg-surface-2",children:o.jsxs("tr",{children:[o.jsx("th",{className:"text-left px-3 py-2",children:"Data"}),o.jsx("th",{className:"text-left px-3 py-2",children:"Tipo"}),o.jsx("th",{className:"text-left px-3 py-2",children:"Obs"}),o.jsx("th",{className:"text-right px-3 py-2",children:"Valor"})]})}),o.jsx("tbody",{children:U.movs.map((Ce,je)=>o.jsxs("tr",{className:"border-t border-border/60",children:[o.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:se(Ce.criado_em)}),o.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:String(Ce.tipo||"").toUpperCase()}),o.jsx("td",{className:"px-3 py-2 whitespace-normal break-words",children:Ce.observacao||""}),o.jsx("td",{className:"px-3 py-2 text-right font-semibold whitespace-nowrap",children:mt(Ce.valor||0)})]},je))})]})})]})]})]})})]})}),o.jsx(Hot,{open:$,onOpenChange:Y,codigoEmpresa:r?.codigo_empresa,onSuccess:async Ce=>{Y(!1),Ce&&(u(Ce),m(Ce)),await new Promise(je=>setTimeout(je,500)),Q(0),await Nt({append:!1})}})]})}function Xot(){const{userProfile:e}=Do(),[t]=NS(),r=t.get("comanda"),[n,a]=p.useState(!0),[i,s]=p.useState(null),[l,c]=p.useState([]),[d,u]=p.useState([]),[f,m]=p.useState([]),[h,v]=p.useState(null),[g,y]=p.useState(""),[x,b]=p.useState("");p.useEffect(()=>{(async()=>{try{if(!r||!e?.codigo_empresa)return;try{const{data:T,error:D}=await ve.from("empresas").select("nome_fantasia, nome").eq("codigo_empresa",e.codigo_empresa).single();if(D&&console.warn("[PrintComandaPage] Erro ao buscar empresa:",D.message),T){const B=T.nome_fantasia||T.nome||"";console.log("[PrintComandaPage] Empresa carregada:",T,"-> nome exibido:",B),b(B)}else console.warn("[PrintComandaPage] Empresa no encontrada para codigo_empresa:",e.codigo_empresa)}catch(T){console.warn("[PrintComandaPage] Exceo ao carregar empresa:",T)}const{data:E}=await ve.from("comandas").select("mesa_id, observacoes").eq("id",r).eq("codigo_empresa",e.codigo_empresa).single();if(E?.mesa_id){const{data:T}=await ve.from("mesas").select("numero").eq("id",E.mesa_id).eq("codigo_empresa",e.codigo_empresa).single();v(T)}y(E?.observacoes||"");const[P,k,M]=await Promise.all([Ci({comandaId:r,codigoEmpresa:e.codigo_empresa}),Zi({comandaId:r,codigoEmpresa:e.codigo_empresa}),qte({comandaId:r,codigoEmpresa:e.codigo_empresa})]);c(P||[]),u(k||[]),m(M||[]);const S=(P||[]).reduce((T,D)=>T+Number(D.quantidade||0)*Number(D.preco_unitario||0),0),I=(M||[]).reduce((T,D)=>T+Number(D.valor||0),0);s({id:r,totalItens:S,totalPagamentos:I,diferenca:I-S})}catch(E){console.error("Erro ao carregar comanda:",E)}finally{a(!1)}})()},[r,e?.codigo_empresa]);const w=()=>{window.print()},j=()=>{window.history.back()};if(n)return o.jsx("div",{className:"flex items-center justify-center min-h-screen",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand mx-auto mb-4"}),o.jsx("p",{className:"text-text-muted",children:"Carregando comanda..."})]})});if(!i)return o.jsx("div",{className:"flex items-center justify-center min-h-screen",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-text-muted mb-4",children:"Comanda no encontrada"}),o.jsxs(oe,{onClick:j,variant:"outline",children:[o.jsx(Cy,{className:"mr-2 h-4 w-4"}),"Voltar"]})]})});const _=(d||[]).map(C=>C?.nome||C?.nome_livre||"").filter(Boolean).join(", ")||"Sem cliente";return i.totalItens,i.totalPagamentos,o.jsxs("div",{className:"w-screen h-screen bg-gray-100 flex flex-col print:bg-white print:p-0",children:[o.jsxs("div",{className:"flex gap-2 p-4 bg-white border-b border-gray-200 print:hidden",children:[o.jsxs(oe,{onClick:j,size:"sm",className:"bg-black text-white hover:bg-black/80 border border-black shadow-sm",children:[o.jsx(Cy,{className:"mr-2 h-4 w-4"}),"Voltar"]}),o.jsxs(oe,{onClick:w,size:"sm",className:"ml-auto",children:[o.jsx(iH,{className:"mr-2 h-4 w-4"}),"Imprimir"]})]}),o.jsx("div",{className:"flex-1 overflow-auto flex items-start justify-center p-4 print:p-0 print:overflow-visible print:flex-none",children:o.jsxs("div",{className:"w-80 border border-black p-6 bg-white print:border-0 print:p-0 print:w-full",children:[o.jsxs("div",{className:"text-center mb-4 border-b border-black pb-3",children:[o.jsx("p",{className:"text-xs font-semibold text-black mb-2",children:x||" "}),o.jsx("h1",{className:"text-xl font-bold text-black",children:"COMANDA"}),h&&o.jsxs("p",{className:"text-xs text-black mt-1",children:["Mesa ",h.numero]}),o.jsx("p",{className:"text-xs text-black mt-1",children:new Date().toLocaleString("pt-BR")})]}),o.jsxs("div",{className:"mb-6 pb-4 border-b border-black",children:[o.jsx("p",{className:"text-sm font-semibold text-black",children:"CLIENTE:"}),o.jsx("p",{className:"text-sm text-black",children:_})]}),o.jsx("div",{className:"mb-6 pb-4 border-b border-black",children:o.jsx("div",{className:"space-y-2",children:l.map((C,E)=>{const P=Number(C.quantidade||0)*Number(C.preco_unitario||0);return o.jsxs("div",{className:"flex justify-between text-sm text-black",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("span",{children:C.descricao||"Item"}),o.jsxs("span",{className:"ml-2 text-xs",children:["x",C.quantidade]})]}),o.jsxs("span",{className:"font-semibold",children:["R$ ",P.toFixed(2)]})]},E)})})}),g&&o.jsxs("div",{className:"mb-4 pb-3",children:[o.jsx("p",{className:"text-xs font-semibold text-black mb-1",children:"OBS:"}),o.jsx("p",{className:"text-xs text-black border-b border-black pb-3",children:g})]}),o.jsx("div",{className:"text-center pt-4",children:o.jsxs("p",{className:"text-lg font-bold text-black mt-2",children:["TOTAL: R$ ",i.totalItens.toFixed(2)]})}),o.jsxs("div",{className:"text-center mt-8 pt-4 border-t border-black text-xs text-black",children:[o.jsx("p",{children:"Obrigado pela preferncia!"}),o.jsx("p",{className:"mt-2",children:"Fluxo7Arena"})]})]})}),o.jsx("style",{children:`
        @media print {
          body {
            margin: 0;
            padding: 0;
            background: white;
          }
          .print\\:hidden {
            display: none !important;
          }
          .print\\:border-0 {
            border: none !important;
          }
          .print\\:p-0 {
            padding: 0 !important;
          }
        }
      `})]})}const Jot="18810778",Jg={hidden:{opacity:0,x:20},visible:{opacity:1,x:0,transition:{duration:.3}},exit:{opacity:0,x:-20,transition:{duration:.2}}};function Qot(e){return e.replace(/\D/g,"").replace(/(\d{2})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1/$2").replace(/(\d{4})(\d)/,"$1-$2").substring(0,18)}function Zot(e){return e.replace(/\D/g,"").replace(/(\d{2})(\d)/,"($1) $2").replace(/(\d{5})(\d)/,"$1-$2").substring(0,15)}async function eit(){try{const{data:e,error:t}=await ve.from("empresas").select("codigo_empresa").order("codigo_empresa",{ascending:!1}).limit(100);if(t)return console.warn("Erro ao buscar cdigos:",t),"1";let r=0;return e&&e.length>0&&e.forEach(n=>{const a=parseInt(n.codigo_empresa);!isNaN(a)&&a>r&&(r=a)}),(r+1).toString()}catch(e){return console.warn("Erro ao gerar cdigo:",e),"1"}}function tit(){const{toast:e}=oo(),t=Pc(),[r,n]=p.useState(1),[a,i]=p.useState(!1),[s,l]=p.useState(!1),[c,d]=p.useState(""),[u,f]=p.useState({email:"",nomeUsuario:"",cargo:"",razaoSocial:"",nomeFantasia:"",cnpj:"",emailEmpresa:"",telefone:"",endereco:"",quadras:[],mesas:[],categorias:[]}),[m,h]=p.useState(null),v=z=>{z.preventDefault(),c===Jot?(l(!0),n(2),e({title:"Acesso liberado",description:"Bem-vindo ao formulrio de criao de empresa."})):(e({title:"Senha incorreta",description:"Tente novamente.",variant:"destructive"}),d(""))},g=()=>!0,y=()=>u.razaoSocial.trim()?u.nomeFantasia.trim()?!0:(e({title:"Nome Fantasia obrigatrio",variant:"destructive"}),!1):(e({title:"Razo Social obrigatria",variant:"destructive"}),!1),x=()=>{r===2&&!g()||r===3&&!y()||n(r+1)},b=()=>{n(r-1)},w=()=>{const z=u.quadras.length+1;f({...u,quadras:[...u.quadras,{nome:`Quadra ${z}`}]})},j=z=>{f({...u,quadras:u.quadras.filter(($,Y)=>Y!==z)})},_=()=>{const z=u.mesas.length+1;f({...u,mesas:[...u.mesas,{numero:z,nome:`Mesa ${z}`}]})},C=z=>{f({...u,mesas:u.mesas.filter(($,Y)=>Y!==z)})},E=()=>{const z=prompt("Digite o nome da categoria:");z&&z.trim()&&f({...u,categorias:[...u.categorias,{nome:z.trim(),descricao:""}]})},P=z=>{f({...u,categorias:u.categorias.filter(($,Y)=>Y!==z)})},k=async()=>{try{i(!0);try{const q={user:{email:u.email?.trim()||null,nome:u.nomeUsuario?.trim()||null,cargo:u.cargo?.trim()||"admin"},empresa:{razao_social:u.razaoSocial?.trim()||null,nome_fantasia:u.nomeFantasia?.trim()||null,cnpj:u.cnpj?u.cnpj.replace(/\D/g,""):null,email:u.emailEmpresa?.trim()||null,telefone:u.telefone?.trim()||null,endereco:u.endereco?.trim()||null},quadras:u.quadras||[],mesas:u.mesas||[],categorias:u.categorias||[]},{data:L,error:W}=await ve.rpc("create_company_full",{payload:q});if(!W&&L&&L.codigo_empresa){h({success:!0,codigoEmpresa:L.codigo_empresa,email:u.email,nomeEmpresa:u.nomeFantasia,numQuadras:(u.quadras||[]).length,numMesas:(u.mesas||[]).length,numCategorias:(u.categorias||[]).length}),n(6),e({title:" Empresa criada com sucesso!",description:`Cdigo: ${L.codigo_empresa}`});return}else W&&console.warn("RPC create_company_full indisponvel/erro. Usando fluxo local.",W?.message||W)}catch(q){console.warn("Falha ao tentar RPC create_company_full. Usando fluxo local.",q?.message||q)}let z=null;u.email.trim()&&(console.log("Email fornecido:",u.email),console.log("Nota: O vnculo com o usurio ser criado no primeiro login"),z=null);const $=await eit();console.log("Cdigo da empresa gerado:",$);const{data:Y,error:de}=await ve.from("empresas").insert({codigo_empresa:$,nome:u.nomeFantasia,razao_social:u.razaoSocial,nome_fantasia:u.nomeFantasia,cnpj:u.cnpj?u.cnpj.replace(/\D/g,""):null,email:u.emailEmpresa||null,telefone:u.telefone||null,endereco:u.endereco||null}).select().single();if(de)throw new Error("Erro ao criar empresa: "+de.message);const{error:xe}=await ve.from("empresa_counters").insert({empresa_id:Y.id,next_cliente_codigo:1,next_agendamento_codigo:1});if(xe&&console.warn("Erro ao criar contador:",xe),u.email.trim()||u.nomeUsuario.trim())try{const q="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(ne){const le=Math.random()*16|0;return(ne==="x"?le:le&3|8).toString(16)}),{error:L}=await ve.from("usuarios").insert({id:q,email:u.email||null,nome:u.nomeUsuario||null,papel:u.cargo||"admin",codigo_empresa:$});L&&console.warn("Aviso ao criar usurio:",L.message);const{error:W}=await ve.from("colaboradores").insert({id:q,nome:u.nomeUsuario||"Administrador",cargo:u.cargo||"admin",ativo:!0,codigo_empresa:$});W&&console.warn("Aviso ao criar colaborador:",W.message),u.email&&(console.log(" APS O PRIMEIRO LOGIN, execute este SQL no Supabase:"),console.log(`
-- Atualizar ID do colaborador com o ID real do auth.users
UPDATE public.colaboradores 
SET id = (SELECT id FROM auth.users WHERE email = '${u.email}')
WHERE codigo_empresa = '${$}' AND id = '${q}';

-- Atualizar ID do usurio
UPDATE public.usuarios 
SET id = (SELECT id FROM auth.users WHERE email = '${u.email}')
WHERE codigo_empresa = '${$}' AND id = '${q}';
            `))}catch(q){console.warn("Erro ao criar registros de usurio:",q)}try{await ve.from("agenda_settings").insert({empresa_id:Y.id,auto_confirm_enabled:!1,auto_start_enabled:!0,auto_finish_enabled:!0})}catch(q){console.warn("Aviso: no foi possvel criar agenda_settings agora (provvel RLS). Ser configurado aps o primeiro login.",q?.message||q)}if(u.quadras.length>0){const q=u.quadras.map(L=>({nome:L.nome,codigo_empresa:$}));await ve.from("quadras").insert(q)}if(u.mesas.length>0){const q=u.mesas.map(L=>({numero:L.numero,nome:L.nome,codigo_empresa:$,status:"available"}));await ve.from("mesas").insert(q)}if(u.categorias.length>0){const q=u.categorias.map(L=>({nome:L.nome,descricao:L.descricao||null,codigo_empresa:$,ativa:!0}));await ve.from("produto_categorias").insert(q)}h({success:!0,codigoEmpresa:$,email:u.email,nomeEmpresa:u.nomeFantasia,numQuadras:u.quadras.length,numMesas:u.mesas.length,numCategorias:u.categorias.length}),n(6),e({title:" Empresa criada com sucesso!",description:`Cdigo: ${$}`})}catch(z){console.error("Erro ao criar empresa:",z),e({title:"Erro ao criar empresa",description:z.message,variant:"destructive"})}finally{i(!1)}},M=()=>{if(r===1||r===6)return null;const z=(r-1)/4*100;return o.jsxs("div",{className:"mb-8",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsxs("span",{className:"text-sm text-text-muted",children:["Etapa ",r-1," de 4"]}),o.jsxs("span",{className:"text-sm text-text-muted",children:[Math.round(z),"%"]})]}),o.jsx("div",{className:"h-2 bg-surface-2 rounded-full overflow-hidden",children:o.jsx(fr.div,{className:"h-full bg-brand",initial:{width:0},animate:{width:`${z}%`},transition:{duration:.3}})})]})},S=()=>o.jsxs(fr.div,{variants:Jg,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-md mx-auto",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:o.jsx(sh,{className:"w-8 h-8 text-brand"})}),o.jsx("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:"rea Restrita"}),o.jsx("p",{className:"text-text-muted",children:"Digite a senha para acessar"})]}),o.jsxs("form",{onSubmit:v,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(Wt,{htmlFor:"senha",children:"Senha de Acesso"}),o.jsx(or,{id:"senha",type:"password",value:c,onChange:z=>d(z.target.value),placeholder:"Digite a senha",className:"text-center text-lg tracking-widest",autoFocus:!0})]}),o.jsxs(oe,{type:"submit",className:"w-full",children:["Acessar",o.jsx(Zw,{className:"ml-2 h-4 w-4"})]})]})]},"step1"),I=()=>o.jsxs(fr.div,{variants:Jg,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:o.jsx(ju,{className:"w-8 h-8 text-brand"})}),o.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Primeiro Usurio"}),o.jsx("p",{className:"text-text-muted",children:"Informaes do administrador da empresa"})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx(Wt,{htmlFor:"email",children:"Email cadastrado no Supabase Auth"}),o.jsx(or,{id:"email",type:"email",value:u.email,onChange:z=>f({...u,email:z.target.value}),placeholder:"usuario@email.com"}),o.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Este email j deve estar cadastrado no Supabase Auth"})]}),o.jsxs("div",{children:[o.jsx(Wt,{htmlFor:"nomeUsuario",children:"Nome Completo"}),o.jsx(or,{id:"nomeUsuario",type:"text",value:u.nomeUsuario,onChange:z=>f({...u,nomeUsuario:z.target.value}),placeholder:"Joo Silva"})]}),o.jsxs("div",{children:[o.jsx(Wt,{htmlFor:"cargo",children:"Cargo na Empresa"}),o.jsx(or,{id:"cargo",type:"text",value:u.cargo,onChange:z=>f({...u,cargo:z.target.value}),placeholder:"Ex: Proprietrio, Gerente, Administrador, Scio, etc."}),o.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Digite o cargo que voc ocupa na empresa"})]}),o.jsxs("div",{className:"flex gap-3 pt-4",children:[o.jsx(oe,{type:"button",variant:"outline",onClick:()=>t("/"),className:"flex-1",children:"Cancelar"}),o.jsxs(oe,{type:"button",onClick:x,className:"flex-1",children:["Prximo",o.jsx(Zw,{className:"ml-2 h-4 w-4"})]})]})]})]},"step2"),T=()=>o.jsxs(fr.div,{variants:Jg,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:o.jsx(iN,{className:"w-8 h-8 text-brand"})}),o.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Dados da Empresa"}),o.jsx("p",{className:"text-text-muted",children:"Informaes cadastrais da empresa"})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"md:col-span-2",children:[o.jsx(Wt,{htmlFor:"razaoSocial",children:"Razo Social *"}),o.jsx(or,{id:"razaoSocial",type:"text",value:u.razaoSocial,onChange:z=>f({...u,razaoSocial:z.target.value}),placeholder:"Empresa LTDA"})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx(Wt,{htmlFor:"nomeFantasia",children:"Nome Fantasia *"}),o.jsx(or,{id:"nomeFantasia",type:"text",value:u.nomeFantasia,onChange:z=>f({...u,nomeFantasia:z.target.value}),placeholder:"Minha Empresa"}),o.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Como a empresa aparecer no sistema"})]}),o.jsxs("div",{children:[o.jsx(Wt,{htmlFor:"cnpj",children:"CNPJ"}),o.jsx(or,{id:"cnpj",type:"text",value:u.cnpj,onChange:z=>f({...u,cnpj:Qot(z.target.value)}),placeholder:"00.000.000/0000-00"})]}),o.jsxs("div",{children:[o.jsx(Wt,{htmlFor:"telefone",children:"Telefone"}),o.jsx(or,{id:"telefone",type:"tel",value:u.telefone,onChange:z=>f({...u,telefone:Zot(z.target.value)}),placeholder:"(11) 99999-9999"})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx(Wt,{htmlFor:"emailEmpresa",children:"Email da Empresa"}),o.jsx(or,{id:"emailEmpresa",type:"email",value:u.emailEmpresa,onChange:z=>f({...u,emailEmpresa:z.target.value}),placeholder:"contato@empresa.com"})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx(Wt,{htmlFor:"endereco",children:"Endereo Completo (opcional)"}),o.jsx(or,{id:"endereco",type:"text",value:u.endereco,onChange:z=>f({...u,endereco:z.target.value}),placeholder:"Rua X, 123, Bairro, Cidade - UF"})]})]}),o.jsxs("div",{className:"flex gap-3 pt-4",children:[o.jsxs(oe,{type:"button",variant:"outline",onClick:b,className:"flex-1",children:[o.jsx(Cy,{className:"mr-2 h-4 w-4"}),"Voltar"]}),o.jsxs(oe,{type:"button",onClick:x,className:"flex-1",children:["Prximo",o.jsx(Zw,{className:"ml-2 h-4 w-4"})]})]})]})]},"step3"),D=()=>o.jsxs(fr.div,{variants:Jg,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:o.jsx(zm,{className:"w-8 h-8 text-brand"})}),o.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Configurao Inicial"}),o.jsx("p",{className:"text-text-muted",children:"Adicione dados iniciais ou pule esta etapa"})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Gde,{className:"w-5 h-5 text-brand"}),o.jsx("h3",{className:"font-semibold text-text-primary",children:"Quadras Esportivas"})]}),o.jsxs(oe,{type:"button",onClick:w,size:"sm",className:"gap-2",children:[o.jsx(Ka,{className:"w-4 h-4"}),"Adicionar Quadra"]})]}),u.quadras.length>0?o.jsx("div",{className:"space-y-2",children:u.quadras.map((z,$)=>o.jsxs("div",{className:"flex items-center justify-between bg-background rounded-md p-3 border border-border",children:[o.jsx("span",{className:"text-sm text-text-primary",children:z.nome}),o.jsx(oe,{type:"button",variant:"ghost",size:"sm",onClick:()=>j($),className:"h-8 w-8 p-0 text-danger hover:text-danger hover:bg-danger/10",children:o.jsx(Ml,{className:"w-4 h-4"})})]},$))}):o.jsx("p",{className:"text-sm text-text-muted text-center py-4",children:"Nenhuma quadra adicionada"})]}),o.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(cl,{className:"w-5 h-5 text-brand"}),o.jsx("h3",{className:"font-semibold text-text-primary",children:"Mesas da Loja"})]}),o.jsxs(oe,{type:"button",onClick:_,size:"sm",className:"gap-2",children:[o.jsx(Ka,{className:"w-4 h-4"}),"Adicionar Mesa"]})]}),u.mesas.length>0?o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:u.mesas.map((z,$)=>o.jsxs("div",{className:"flex items-center justify-between bg-background rounded-md p-3 border border-border",children:[o.jsx("span",{className:"text-sm text-text-primary",children:z.nome}),o.jsx(oe,{type:"button",variant:"ghost",size:"sm",onClick:()=>C($),className:"h-8 w-8 p-0 text-danger hover:text-danger hover:bg-danger/10",children:o.jsx(Ml,{className:"w-4 h-4"})})]},$))}):o.jsx("p",{className:"text-sm text-text-muted text-center py-4",children:"Nenhuma mesa adicionada"})]}),o.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(ud,{className:"w-5 h-5 text-brand"}),o.jsx("h3",{className:"font-semibold text-text-primary",children:"Categorias de Produtos"})]}),o.jsxs(oe,{type:"button",onClick:E,size:"sm",className:"gap-2",children:[o.jsx(Ka,{className:"w-4 h-4"}),"Adicionar Categoria"]})]}),u.categorias.length>0?o.jsx("div",{className:"space-y-2",children:u.categorias.map((z,$)=>o.jsxs("div",{className:"flex items-center justify-between bg-background rounded-md p-3 border border-border",children:[o.jsx("span",{className:"text-sm text-text-primary",children:z.nome}),o.jsx(oe,{type:"button",variant:"ghost",size:"sm",onClick:()=>P($),className:"h-8 w-8 p-0 text-danger hover:text-danger hover:bg-danger/10",children:o.jsx(Ml,{className:"w-4 h-4"})})]},$))}):o.jsx("p",{className:"text-sm text-text-muted text-center py-4",children:"Nenhuma categoria adicionada"})]}),o.jsx("div",{className:"bg-info/10 border border-info/30 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(hc,{className:"w-5 h-5 text-info mt-0.5"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-text-primary mb-1",children:"Configuraes Opcionais"}),o.jsx("p",{className:"text-xs text-text-muted",children:"Voc pode adicionar quadras, mesas e categorias agora ou configurar depois no sistema."})]})]})}),o.jsxs("div",{className:"flex gap-3 pt-4",children:[o.jsxs(oe,{type:"button",variant:"outline",onClick:b,className:"flex-1",children:[o.jsx(Cy,{className:"mr-2 h-4 w-4"}),"Voltar"]}),o.jsxs(oe,{type:"button",onClick:x,className:"flex-1",children:["Prximo",o.jsx(Zw,{className:"ml-2 h-4 w-4"})]})]})]})]},"step4"),B=()=>o.jsxs(fr.div,{variants:Jg,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-brand/10 rounded-full mb-4",children:o.jsx(Ai,{className:"w-8 h-8 text-brand"})}),o.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Reviso Final"}),o.jsx("p",{className:"text-text-muted",children:"Confira os dados antes de criar a empresa"})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[o.jsxs("h3",{className:"font-semibold text-text-primary mb-4 flex items-center gap-2",children:[o.jsx(ju,{className:"w-5 h-5"}),"Primeiro Usurio"]}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Email:"}),o.jsx("span",{className:"text-text-primary font-medium",children:u.email})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Nome:"}),o.jsx("span",{className:"text-text-primary font-medium",children:u.nomeUsuario})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Cargo:"}),o.jsx("span",{className:"text-text-primary font-medium",children:u.cargo})]})]})]}),o.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[o.jsxs("h3",{className:"font-semibold text-text-primary mb-4 flex items-center gap-2",children:[o.jsx(iN,{className:"w-5 h-5"}),"Empresa"]}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Razo Social:"}),o.jsx("span",{className:"text-text-primary font-medium",children:u.razaoSocial})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Nome Fantasia:"}),o.jsx("span",{className:"text-text-primary font-medium",children:u.nomeFantasia})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"CNPJ:"}),o.jsx("span",{className:"text-text-primary font-medium",children:u.cnpj})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Email:"}),o.jsx("span",{className:"text-text-primary font-medium",children:u.emailEmpresa})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Telefone:"}),o.jsx("span",{className:"text-text-primary font-medium",children:u.telefone})]}),u.endereco&&o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Endereo:"}),o.jsx("span",{className:"text-text-primary font-medium text-right",children:u.endereco})]})]})]}),o.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[o.jsxs("h3",{className:"font-semibold text-text-primary mb-4 flex items-center gap-2",children:[o.jsx(zm,{className:"w-5 h-5"}),"Configuraes Iniciais"]}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Quadras:"}),o.jsx("span",{className:"text-text-primary font-medium",children:u.quadras.length})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Mesas:"}),o.jsx("span",{className:"text-text-primary font-medium",children:u.mesas.length})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Categorias de Produtos:"}),o.jsx("span",{className:"text-text-primary font-medium",children:u.categorias.length})]})]})]}),o.jsx("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(hc,{className:"w-5 h-5 text-warning mt-0.5"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-text-primary mb-1",children:"Ateno"}),o.jsx("p",{className:"text-xs text-text-muted",children:"Esta ao criar a empresa no banco de dados. Certifique-se de que todos os dados esto corretos."})]})]})}),o.jsxs("div",{className:"flex gap-3 pt-4",children:[o.jsxs(oe,{type:"button",variant:"outline",onClick:b,className:"flex-1",disabled:a,children:[o.jsx(Cy,{className:"mr-2 h-4 w-4"}),"Voltar"]}),o.jsx(oe,{type:"button",onClick:k,className:"flex-1 bg-emerald-600 hover:bg-emerald-500",disabled:a,children:a?o.jsxs(o.Fragment,{children:[o.jsx(Pm,{className:"mr-2 h-4 w-4 animate-spin"}),"Criando..."]}):o.jsx(o.Fragment,{children:" Criar Empresa"})})]})]})]},"step5"),U=()=>o.jsxs(fr.div,{variants:Jg,initial:"hidden",animate:"visible",exit:"exit",className:"max-w-2xl mx-auto",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-success/10 rounded-full mb-6",children:o.jsx(Ai,{className:"w-12 h-12 text-success"})}),o.jsx("h2",{className:"text-3xl font-bold text-text-primary mb-2",children:" Empresa Criada!"}),o.jsx("p",{className:"text-text-muted",children:"Tudo pronto para comear a usar o sistema"})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"bg-brand/10 border border-brand/30 rounded-lg p-6",children:o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-sm text-text-muted mb-2",children:"Cdigo da Empresa"}),o.jsx("p",{className:"text-3xl font-bold text-brand font-mono",children:m?.codigoEmpresa})]})}),o.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[o.jsx("h3",{className:"font-semibold text-text-primary mb-4",children:"Dados de Acesso"}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Email:"}),o.jsx("span",{className:"text-text-primary font-medium",children:m?.email})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Senha:"}),o.jsx("span",{className:"text-text-primary font-medium",children:"(a que voc definiu no Supabase)"})]})]})]}),o.jsxs("div",{className:"bg-surface-2 border border-border rounded-lg p-6",children:[o.jsx("h3",{className:"font-semibold text-text-primary mb-4",children:"Dados Criados"}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:""}),o.jsx("div",{className:"text-xs text-text-muted",children:"Empresa"})]}),o.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:""}),o.jsx("div",{className:"text-xs text-text-muted",children:"Configuraes"})]}),o.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:m?.numQuadras}),o.jsx("div",{className:"text-xs text-text-muted",children:"Quadras"})]}),o.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:m?.numMesas}),o.jsx("div",{className:"text-xs text-text-muted",children:"Mesas"})]}),o.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:m?.numCategorias}),o.jsx("div",{className:"text-xs text-text-muted",children:"Categorias"})]}),o.jsxs("div",{className:"text-center p-4 bg-background rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-brand mb-1",children:""}),o.jsx("div",{className:"text-xs text-text-muted",children:"Pronto para Uso"})]})]})]}),o.jsx("div",{className:"bg-warning/10 border border-warning/30 rounded-lg p-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(hc,{className:"w-5 h-5 text-warning mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-sm font-medium text-text-primary mb-2",children:" IMPORTANTE: Execute o SQL Antes de Fazer Login"}),o.jsxs("div",{className:"space-y-2 text-xs text-text-muted",children:[o.jsx("p",{className:"font-semibold text-text-primary",children:"Para vincular seu usurio  empresa, siga estes passos:"}),o.jsxs("ol",{className:"list-decimal list-inside space-y-1 ml-2",children:[o.jsxs("li",{children:["Abra o ",o.jsx("strong",{children:"Console do Navegador"})," (pressione F12)"]}),o.jsxs("li",{children:["Procure pela mensagem ",o.jsx("strong",{children:'" APS O PRIMEIRO LOGIN, execute este SQL"'})]}),o.jsx("li",{children:"Copie o comando SQL que aparece no console"}),o.jsxs("li",{children:["Acesse o ",o.jsx("strong",{children:"Supabase  SQL Editor"})]}),o.jsx("li",{children:"Cole e execute o SQL"}),o.jsx("li",{children:"Agora sim, faa login normalmente"})]}),o.jsx("p",{className:"mt-2 text-warning font-medium",children:' Se no executar o SQL, voc ver o erro "Empresa no vinculada"'})]})]})]})}),o.jsx("div",{className:"pt-4",children:o.jsx(oe,{type:"button",onClick:()=>t("/"),className:"w-full bg-brand hover:bg-brand/90",children:"Ir para Login"})})]})]},"step6");return o.jsx(o.Fragment,{children:o.jsx("div",{className:"min-h-screen bg-background text-text-primary p-8",children:o.jsxs("div",{className:"max-w-4xl mx-auto",children:[M(),o.jsxs(Spe,{mode:"wait",children:[r===1&&S(),r===2&&I(),r===3&&T(),r===4&&D(),r===5&&B(),r===6&&U()]})]})})})}const uoe=p.createContext(),foe=()=>{const e=p.useContext(uoe);if(!e)throw new Error("useIsis deve ser usado dentro de IsisProvider");return e},rit=({children:e})=>{const[t,r]=p.useState("greeting"),[n,a]=p.useState([]),[i,s]=p.useState({empresa:null,quadra:null,data:null,horario:null,modalidade:null,quantidade:null,nomes:[],contato:{nome:"",telefone:""}}),[l,c]=p.useState(!1),[d,u]=p.useState(!1),f=p.useRef(null),m=p.useCallback(E=>{a(P=>[...P,{id:Date.now()+Math.random(),timestamp:new Date,...E}]),setTimeout(()=>{f.current?.scrollIntoView({behavior:"smooth"})},100)},[]),h=p.useCallback((E,P=2e3,k=null)=>{u(!0),setTimeout(()=>{u(!1),m({from:"isis",text:E,type:"text",color:k})},P)},[m]),v=p.useCallback((E,P,k=2e3)=>{u(!0),setTimeout(()=>{u(!1),a(M=>M.map(S=>S.type==="buttons"&&S.buttons&&S.buttons.length>0?{...S,disabled:!0}:S)),m({from:"isis",text:E,type:"buttons",buttons:P,disabled:!1})},k)},[m]),g=p.useCallback(()=>{a(E=>E.map(P=>P.type==="buttons"&&P.buttons&&P.buttons.length>0&&!P.disabled?{...P,disabled:!0}:P))},[]),y=p.useCallback(E=>{m({from:"user",text:E,type:"text"})},[m]),x=p.useCallback((E,P)=>{s(k=>({...k,[E]:P}))},[]),b=p.useCallback((E,P)=>{s(k=>({...k,contato:{...k.contato,[E]:P}}))},[]),w=p.useCallback(E=>{r(E)},[]),j=p.useCallback(()=>{const E=["greeting","quadra","data","horario","modalidade","quantidade","nomes","contato","review","confirmation","avaliacao"],P=E.indexOf(t);P>0&&r(E[P-1])},[t]),_=p.useCallback(()=>{r("greeting"),a([]),s({empresa:null,quadra:null,data:null,horario:null,modalidade:null,quantidade:null,nomes:[],contato:{nome:"",telefone:""}}),c(!1),u(!1)},[]),C={currentStep:t,messages:n,selections:i,isLoading:l,isTyping:d,chatEndRef:f,addMessage:m,addIsisMessage:h,addIsisMessageWithButtons:v,addUserMessage:y,disableAllButtons:g,updateSelection:x,updateContact:b,nextStep:w,previousStep:j,resetConversation:_,setIsLoading:c,setIsTyping:u};return o.jsx(uoe.Provider,{value:C,children:e})},nit=()=>o.jsx(fr.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:"flex justify-start mb-6",children:o.jsxs("div",{className:"flex items-end gap-3 max-w-[85%] md:max-w-[75%]",children:[o.jsx(Wd,{size:"md",variant:"message"}),o.jsx("div",{className:"px-4 py-3 bg-brand border border-brand backdrop-blur-sm rounded-2xl rounded-bl-sm shadow-lg shadow-brand/20",children:o.jsx("div",{className:"flex gap-1.5",children:[0,1,2].map(e=>o.jsx(fr.div,{className:"w-2.5 h-2.5 md:w-2 md:h-2 bg-[#0A0A0A] rounded-full",animate:{y:[0,-6,0],opacity:[.4,1,.4]},transition:{duration:.8,repeat:1/0,delay:e*.2,ease:"easeInOut"}},e))})})]})}),ait=({buttons:e,onSelect:t,disabled:r=!1,hideText:n=!1})=>o.jsx(fr.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.4,delay:.3,ease:[.22,1,.36,1]},className:"flex flex-wrap gap-2 md:gap-2.5 mb-4 md:mb-6 ml-12 md:ml-[68px]",children:e.map((a,i)=>o.jsx(fr.button,{initial:{opacity:0,scale:.9},animate:{opacity:n?0:1,scale:1},transition:{duration:.3,delay:.4+i*.05},whileHover:{scale:r?1:1.02,y:r?0:-2},whileTap:{scale:r?1:.98},onClick:()=>!r&&t(a),disabled:r,className:`
            group relative px-5 py-3.5 md:px-6 md:py-4 rounded-xl font-semibold text-[15px] md:text-[15px]
            transition-all duration-300 ease-out
            ${r?"bg-surface/30 text-text-muted cursor-not-allowed border border-white/5":"bg-surface/70 backdrop-blur-sm text-text-primary border border-white/10 hover:border-brand/70 hover:bg-brand/10 hover:text-brand hover:shadow-lg hover:shadow-brand/20 shadow-md"}
            ${n?"opacity-0 pointer-events-none":""}
          `,children:o.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1 relative z-10",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[a.icon&&!n&&o.jsx("span",{className:`text-base md:text-lg transition-transform duration-300 ${!r&&"group-hover:scale-110"}`,children:a.icon}),!n&&o.jsx("span",{className:"font-semibold",children:a.label})]}),a.subtitle&&!n&&o.jsx("span",{className:"text-[12px] md:text-xs opacity-70 pl-6 md:pl-7 font-normal",children:a.subtitle})]})},a.value||i))}),oit=({children:e,onButtonClick:t,hideButtonTexts:r=!1})=>{const{messages:n,isTyping:a,chatEndRef:i}=foe();return o.jsxs("div",{className:"flex flex-col min-h-full",children:[o.jsxs("div",{className:"flex-1 px-3 md:px-6 py-4 md:py-8",children:[n.map(s=>o.jsxs("div",{children:[o.jsx(doe,{message:s}),s.type==="buttons"&&s.buttons&&o.jsx(ait,{buttons:s.buttons,onSelect:t||s.onButtonClick,disabled:s.disabled,hideText:r})]},s.id)),a&&o.jsx(nit,{}),o.jsx("div",{ref:i})]}),o.jsx("div",{className:"sticky bottom-0 px-3 md:px-6 pb-3 md:pb-6 pt-3 md:pt-4 bg-gradient-to-t from-background via-background to-transparent",children:e})]})},iit=({onSubmit:e,onMudarData:t,disabled:r=!1,horariosDisponiveis:n=[],esportes:a=[]})=>{const[i,s]=p.useState(""),[l,c]=p.useState(""),[d,u]=p.useState(""),f=n.map(h=>({value:h.inicio,label:h.inicio,available:!0})),m=(()=>{if(!i)return[];const h=n.findIndex(g=>g.inicio===i);if(h===-1)return[];const v=[];for(let g=h+1;g<n.length;g++){const y=n[g],x=n[g+1];if(v.push({value:y.fim,label:y.fim,available:!0}),!x||y.fim!==x.inicio)break}return v})();return p.useEffect(()=>{i&&l&&d&&!r&&e({inicio:i,fim:l,esporte:d})},[i,l,d]),p.useEffect(()=>{i&&c("")},[i]),o.jsxs(fr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},className:"flex flex-col gap-3",children:[o.jsxs("div",{className:"flex items-center gap-2 text-text-secondary text-sm md:text-xs",children:[o.jsx(Vd,{className:"w-4 h-4"}),o.jsx("span",{className:"font-medium",children:"Horrio desejado"})]}),o.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("label",{htmlFor:"horario-inicio",className:"text-xs text-text-muted mb-1 block",children:"Incio"}),o.jsxs(En,{value:i,onValueChange:s,disabled:r,children:[o.jsx(Sn,{className:"w-full bg-surface/70 backdrop-blur-sm border-white/10 text-[15px] md:text-sm",children:o.jsx(kn,{placeholder:"Selecione"})}),o.jsx(Cn,{className:"max-h-[300px] z-[60]",children:f.map(h=>o.jsx(wt,{value:h.value,disabled:!h.available,className:Yt(!h.available&&"opacity-60"),children:o.jsxs("span",{className:"inline-flex items-center gap-2",children:[h.available?o.jsx(Vd,{className:"w-4 h-4 opacity-80"}):o.jsx(sh,{className:"w-4 h-4 opacity-80"}),h.label]})},h.value))})]})]}),o.jsx("div",{className:"text-text-muted font-bold text-lg pt-5",children:""}),o.jsxs("div",{className:"flex-1",children:[o.jsx("label",{htmlFor:"horario-fim",className:"text-xs text-text-muted mb-1 block",children:"Trmino"}),o.jsxs(En,{value:l,onValueChange:c,disabled:!i||r,children:[o.jsx(Sn,{className:"w-full bg-surface/70 backdrop-blur-sm border-white/10 text-[15px] md:text-sm",children:o.jsx(kn,{placeholder:"Selecione"})}),o.jsx(Cn,{className:"max-h-[300px] z-[60]",children:m.map(h=>o.jsx(wt,{value:h.value,disabled:!h.available,className:Yt(!h.available&&"opacity-60"),children:o.jsxs("span",{className:"inline-flex items-center gap-2",children:[h.available?o.jsx(Vd,{className:"w-4 h-4 opacity-80"}):o.jsx(sh,{className:"w-4 h-4 opacity-80"}),h.label]})},h.value))})]})]})]}),o.jsxs("div",{className:"flex items-end gap-2 md:gap-3",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("label",{htmlFor:"esporte",className:"text-xs text-text-muted mb-1 block",children:"Esporte"}),o.jsxs(En,{value:d,onValueChange:u,disabled:r,children:[o.jsx(Sn,{className:"w-full bg-surface/70 backdrop-blur-sm border-white/10 text-[15px] md:text-sm",children:o.jsx(kn,{placeholder:"Selecione o esporte"})}),o.jsx(Cn,{className:"max-h-[300px] z-[60]",children:a.map(h=>o.jsx(wt,{value:h,children:h},h))})]})]}),t&&o.jsxs(fr.button,{type:"button",onClick:t,disabled:r,whileHover:{scale:r?1:1.05},whileTap:{scale:r?1:.95},className:`
              px-4 py-2.5 rounded-xl font-medium text-sm
              transition-all duration-300 shrink-0
              flex items-center gap-2
              ${r?"bg-surface/30 text-text-muted cursor-not-allowed":"bg-surface/70 backdrop-blur-sm border border-white/10 text-text-primary hover:bg-surface/90 hover:border-white/20"}
            `,children:[o.jsx(Ei,{className:"w-4 h-4"}),o.jsx("span",{className:"hidden md:inline",children:"Mudar Data"}),o.jsx("span",{className:"md:hidden",children:"Mudar Data"})]})]})]})},sit=({onSubmit:e,tipo:t,onTrocarTipo:r,disabled:n=!1,mostrarBotaoTrocar:a=!0})=>{const[i,s]=p.useState(""),[l,c]=p.useState(!1),[d,u]=p.useState(!1);p.useEffect(()=>{s("")},[t]);const f=w=>{if(w){const j=Jt(w,"dd/MM/yyyy",{locale:ia});s(j),u(!1)}},m=w=>{const j=w.replace(/\D/g,"");return j.length<=2?`(${j}`:j.length<=7?`(${j.slice(0,2)}) ${j.slice(2)}`:j.length===10?`(${j.slice(0,2)}) ${j.slice(2,6)}-${j.slice(6)}`:j.length===11?`(${j.slice(0,2)}) ${j.slice(2,7)}-${j.slice(7)}`:`(${j.slice(0,2)}) ${j.slice(2,7)}-${j.slice(7,11)}`},h=w=>{const j=w.replace(/\D/g,"");return j.length<=2?j:j.length<=4?`${j.slice(0,2)}/${j.slice(2)}`:j.length<=8?`${j.slice(0,2)}/${j.slice(2,4)}/${j.slice(4)}`:`${j.slice(0,2)}/${j.slice(2,4)}/${j.slice(4,8)}`},v=w=>{const j=w.target.value;if(t==="telefone"){const _=m(j);s(_)}else if(t==="data_custom"){const _=h(j);s(_)}else s(j)},g=w=>{if(w.preventDefault(),!(!i.trim()||n))if(t==="telefone"){const j=i.replace(/\D/g,"");j.length===11&&(e(j),s(""))}else t==="data_custom"?i.trim()&&(e(i.trim()),s("")):i.includes("@")&&i.includes(".")&&(e(i.trim()),s(""))},y=w=>{w.key==="Enter"&&(w.preventDefault(),g(w))},x=w=>{if(w.length!==10)return{valida:!1,erro:"Data incompleta"};const j=/^(\d{2})\/(\d{2})\/(\d{4})$/,_=w.match(j);if(!_)return{valida:!1,erro:"Formato invlido"};const[,C,E,P]=_,k=new Date(parseInt(P),parseInt(E)-1,parseInt(C));if(isNaN(k.getTime())||k.getDate()!==parseInt(C)||k.getMonth()!==parseInt(E)-1||k.getFullYear()!==parseInt(P))return{valida:!1,erro:"Data invlida"};const M=new Date;return M.setHours(0,0,0,0),k.setHours(0,0,0,0),k<M?{valida:!1,erro:"Data no passado"}:{valida:!0,erro:null}},b=()=>t==="telefone"?i.replace(/\D/g,"").length===11:t==="data_custom"?x(i).valida:i.includes("@")&&i.includes(".");return o.jsxs(fr.form,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},onSubmit:g,className:"flex flex-col gap-3 max-w-md mx-auto",children:[o.jsx("div",{className:"relative",children:o.jsxs("div",{className:`
          flex items-center gap-2 px-3 py-2.5 rounded-xl
          bg-surface/70 backdrop-blur-sm
          border-2 transition-all duration-300
          ${l?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
        `,children:[t!=="data_custom"&&o.jsx("div",{className:`
              shrink-0 transition-colors duration-300
              ${l?"text-brand":"text-text-muted"}
            `,children:t==="telefone"?o.jsx(wb,{className:"w-4 h-4"}):o.jsx(ax,{className:"w-4 h-4"})}),o.jsxs("div",{className:"flex-1 relative flex items-center",children:[o.jsx("input",{type:t==="data_custom"?"text":t==="telefone"?"tel":"email",value:i,onChange:v,onKeyDown:y,onFocus:()=>c(!0),onBlur:()=>c(!1),placeholder:t==="telefone"?"(00) 00000-0000":t==="data_custom"?"DD/MM/AAAA":"email@exemplo.com",disabled:n,className:`
                w-full bg-transparent text-text-primary placeholder:text-text-muted
                outline-none text-[17px] md:text-base font-medium
                ${t==="data_custom"?"pr-12":""}
                ${n?"opacity-50 cursor-not-allowed":""}
              `}),t==="data_custom"&&o.jsxs(xc,{open:d,onOpenChange:u,children:[o.jsx(yc,{asChild:!0,children:o.jsx(fr.button,{type:"button",whileHover:{scale:1.1},whileTap:{scale:.9},disabled:n,className:`
                      absolute right-1 w-10 h-10 rounded-xl flex items-center justify-center transition-all duration-300
                      bg-brand/10 text-brand hover:bg-brand hover:text-white
                      border border-brand/20 hover:border-brand/40
                      shadow-md hover:shadow-lg hover:shadow-brand/30
                      ${n?"opacity-50 cursor-not-allowed":"cursor-pointer"}
                    `,children:o.jsx(Ei,{className:"w-5 h-5"})})}),o.jsx(Rl,{className:"w-auto p-0",align:"end",children:o.jsx(bc,{mode:"single",selected:i?(()=>{try{const[w,j,_]=i.split("/");return new Date(parseInt(_),parseInt(j)-1,parseInt(w))}catch{return}})():void 0,onSelect:f,disabled:w=>{const j=new Date;return j.setHours(0,0,0,0),w<j},initialFocus:!0})})]})]}),o.jsx(fr.button,{type:"submit",whileHover:{scale:b()?1.1:1},whileTap:{scale:b()?.9:1},disabled:!b()||n,className:`
              shrink-0 w-9 h-9 rounded-full flex items-center justify-center transition-all duration-300
              ${b()?"bg-brand text-bg shadow-md hover:shadow-lg hover:shadow-brand/30":"bg-surface-light text-text-muted cursor-not-allowed opacity-50"}
            `,children:o.jsx(MI,{className:"w-4 h-4"})})]})}),t==="telefone"&&i&&o.jsx("div",{className:"text-xs text-center",children:(()=>{const w=i.replace(/\D/g,""),j=w.length===11,_=w.length>0&&!j;return j?o.jsx("span",{className:"text-green-400 flex items-center justify-center gap-1",children:" Telefone vlido"}):_?o.jsxs("span",{className:"text-yellow-400 flex items-center justify-center gap-1",children:[" Digite todos os dgitos (",w.length,"/11)"]}):null})()}),t==="data_custom"&&i&&o.jsx("div",{className:"text-xs text-center",children:(()=>{const w=x(i);return w.valida?o.jsx("span",{className:"text-green-400 flex items-center justify-center gap-1",children:" Data vlida"}):i.length>0?o.jsxs("span",{className:"text-red-400 flex items-center justify-center gap-1",children:[" ",w.erro]}):null})()}),a&&t!=="data_custom"&&o.jsx("button",{type:"button",onClick:r,className:"text-sm text-brand/80 hover:text-brand hover:underline self-center py-1 px-3 rounded-lg hover:bg-brand/5 transition-all",children:t==="telefone"?o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(ax,{className:"w-4 h-4"}),"Prefiro usar e-mail"]}):o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(wb,{className:"w-4 h-4"}),"Prefiro usar telefone"]})})]})},lit=({onSubmit:e,disabled:t=!1,valorInicial:r=null,tipoInicial:n="telefone"})=>{const[a,i]=p.useState(""),[s,l]=p.useState(n==="telefone"&&r||""),[c,d]=p.useState(n==="email"&&r||""),[u,f]=p.useState(null),m=y=>{const x=y.replace(/\D/g,"");return x.length<=2?`(${x}`:x.length<=7?`(${x.slice(0,2)}) ${x.slice(2)}`:x.length<=11?`(${x.slice(0,2)}) ${x.slice(2,7)}-${x.slice(7,11)}`:`(${x.slice(0,2)}) ${x.slice(2,7)}-${x.slice(7,11)}`},h=y=>{const x=m(y.target.value);l(x)},v=y=>{if(y.preventDefault(),!a.trim())return;const x=s.replace(/\D/g,"").length>=10,b=c.trim().includes("@")&&c.trim().includes(".");if(!x&&!b)return;const w={nome:a.trim(),telefone:x?s.replace(/\D/g,""):null,email:b?c.trim():null};e(w)},g=()=>{if(!a.trim())return!1;const y=s.replace(/\D/g,"").length>=10,x=c.trim().includes("@")&&c.trim().includes(".");return y||x};return o.jsxs(fr.form,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},onSubmit:v,className:"flex flex-col gap-3",children:[o.jsxs("div",{className:`
        flex items-center gap-3 px-4 py-3 rounded-2xl
        bg-surface/70 backdrop-blur-sm
        border-2 transition-all duration-300
        ${u==="nome"?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
      `,children:[o.jsx(ju,{className:`w-5 h-5 transition-colors ${u==="nome"?"text-brand":"text-text-muted"}`}),o.jsx("input",{type:"text",value:a,onChange:y=>i(y.target.value),onFocus:()=>f("nome"),onBlur:()=>f(null),placeholder:"Seu nome completo",disabled:t,className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-[17px] md:text-base font-medium"})]}),o.jsxs("div",{className:`
        flex items-center gap-3 px-4 py-3 rounded-2xl
        bg-surface/70 backdrop-blur-sm
        border-2 transition-all duration-300
        ${u==="telefone"?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
      `,children:[o.jsx(wb,{className:`w-5 h-5 transition-colors ${u==="telefone"?"text-brand":"text-text-muted"}`}),o.jsx("input",{type:"tel",value:s,onChange:h,onFocus:()=>f("telefone"),onBlur:()=>f(null),placeholder:"(00) 00000-0000",disabled:t,className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-[17px] md:text-base font-medium"})]}),o.jsxs("div",{className:`
        flex items-center gap-3 px-4 py-3 rounded-2xl
        bg-surface/70 backdrop-blur-sm
        border-2 transition-all duration-300
        ${u==="email"?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
      `,children:[o.jsx(ax,{className:`w-5 h-5 transition-colors ${u==="email"?"text-brand":"text-text-muted"}`}),o.jsx("input",{type:"email",value:c,onChange:y=>d(y.target.value),onFocus:()=>f("email"),onBlur:()=>f(null),placeholder:"email@exemplo.com (opcional)",disabled:t,className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-[17px] md:text-base font-medium"})]}),o.jsxs(fr.button,{type:"submit",whileHover:{scale:g()?1.02:1},whileTap:{scale:g()?.98:1},disabled:!g()||t,className:`
          flex items-center justify-center gap-2 py-3 px-6 rounded-2xl
          font-semibold text-base transition-all duration-300
          ${g()?"bg-brand text-bg shadow-lg shadow-brand/20 hover:shadow-xl hover:shadow-brand/30":"bg-surface-light text-text-muted cursor-not-allowed opacity-50"}
        `,children:[o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M5 13l4 4L19 7"})}),"Continuar"]}),o.jsx("p",{className:"text-xs text-text-muted text-center",children:"Preencha pelo menos telefone ou e-mail"})]})},cit=({participantesAtuais:e=[],onAdicionar:t,onRemover:r,onFinalizar:n,disabled:a=!1,onAdicionarLote:i,selfName:s})=>{const[l,c]=p.useState(""),[d,u]=p.useState(!1),[f,m]=p.useState(!1),h=p.useRef(null),[v,g]=p.useState(!1),[y,x]=p.useState(""),[b,w]=p.useState(!1),[j,_]=p.useState([]),[C,E]=p.useState([]),[P,k]=p.useState({}),[M,S]=p.useState(!1),[I,T]=p.useState(!1),[D,B]=p.useState(null);p.useEffect(()=>{const G=()=>{m(window.innerWidth<768)};return G(),window.addEventListener("resize",G),()=>window.removeEventListener("resize",G)},[]),p.useEffect(()=>{if(v){const G=document.body.style.overflow;return document.body.style.overflow="hidden",S(!1),T(!1),B(null),()=>{document.body.style.overflow=G}}},[v]);const U=G=>G.normalize("NFD").replace(/[\u0300-\u036f]/g,""),z=G=>U(String(G||"").trim().toLowerCase()).replace(/\s+/g," ");new Set((e||[]).map(G=>z(G.nome)));const $=s?String(s).trim():e&&e[0]&&e[0].nome?String(e[0].nome).trim():null,Y=$?z($):null,de=G=>U(String(G||"").toLowerCase()).split(/\s+/).map(me=>me.trim()).filter(me=>me.length>=3),xe=G=>{if(!$)return!1;const me=String(G||"").trim();if(!me)return!1;if(z(me)===Y)return!0;const pe=de($),Be=de(me);return pe.length===0||Be.length===0?!1:Be.some(Z=>pe.includes(Z))},q=G=>{G.preventDefault(),!(!l.trim()||a)&&(t(l.trim()),c(""),setTimeout(()=>{h.current?.focus()},100))},L=G=>{G.key==="Enter"&&!f&&(G.preventDefault(),G.shiftKey?n():q(G))},W=async()=>{if(y.trim()){w(!0),_([]),E([]),k({});try{const{data:G,error:me}=await ve.functions.invoke("parse-participants",{body:{text:y,locale:"pt-BR"}});if(me)throw me;G&&typeof G.source=="string"&&console.log("[Isis Import] source=",G.source);const pe=Array.isArray(G?.extracted)?G.extracted:[],Be=pe.some(ft=>xe(ft)),Z=Array.isArray(G?.invalid)?G.invalid:[],ee=[],kt=new Set;for(const ft of pe){const yt=z(ft);!yt||kt.has(yt)||(kt.add(yt),ee.push(ft))}let Nt=ee.slice(0,50);const De=Nt.findIndex(ft=>xe(ft));if(De>=0){const ft=Nt[De];B(z(ft)),Nt=[ft,...Nt.filter((yt,Nr)=>Nr!==De)]}else B(null);_(Nt),E(Z);const st={};ee.slice(0,50).forEach(ft=>{st[z(ft)]=!0}),k(st),S(!0),T(Be)}catch{const me=y.split(/[\n,;]+/).map(kt=>kt.trim()).filter(Boolean),pe=me.some(kt=>{const Nt=kt.replace(/^[\W_]+|[\W_]+$/g,"");return xe(Nt)}),Be=[],Z=new Set;for(const kt of me){const Nt=kt.replace(/^[\W_]+|[\W_]+$/g,""),De=z(Nt),st=/[A-Za-z---]/.test(Nt);if(!(Nt.length>=2&&Nt.length<=60&&st&&!/[0-9@]/.test(Nt))||!De||Z.has(De))continue;Z.add(De);const yt=Nt.toLowerCase().split(/\s+/).map(Nr=>Nr&&Nr[0].toUpperCase()+Nr.slice(1)).join(" ");Be.push(yt)}_(Be.slice(0,50));const ee={};Be.slice(0,50).forEach(kt=>{ee[z(kt)]=!0}),k(ee),S(!0),T(pe)}finally{w(!1)}}},ne=G=>{const me=z(G);k(pe=>({...pe,[me]:!pe[me]}))},le=()=>{const G={...P};j.forEach(me=>{G[z(me)]=!0}),k(G)},K=()=>{const G={...P};j.forEach(me=>{G[z(me)]=!1}),k(G)},Q=()=>{const G=j.filter(me=>{const pe=z(me);return D&&pe===D?!1:P[pe]});G.length!==0&&(typeof i=="function"?i(G):G.forEach(me=>t(me)),g(!1),x(""),_([]),E([]),k({}))},re=()=>{x(""),_([]),E([]),k({}),S(!1),T(!1),B(null)};return o.jsxs(fr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},className:"flex flex-col gap-3 w-full",children:[o.jsx("div",{className:"flex items-center justify-end",children:o.jsx("button",{type:"button",disabled:a,onClick:()=>g(!0),className:`px-3 py-1.5 rounded-lg text-sm font-semibold transition-all ${a?"bg-surface/30 text-text-muted cursor-not-allowed":"bg-surface/80 hover:bg-surface/60 border border-white/10 text-text-primary"}`,children:"Importar lista"})}),e.length>0&&o.jsx("div",{className:"flex flex-col gap-1.5 max-h-[140px] overflow-y-auto px-1",children:e.map((G,me)=>o.jsxs(fr.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.2},className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm ${G.principal?"bg-brand/10 border border-brand/30":"bg-surface/50 border border-white/10"}`,children:[o.jsx("span",{className:"text-base shrink-0",children:G.principal?"":""}),o.jsxs("span",{className:`flex-1 font-medium truncate ${G.principal?"text-brand":"text-text-primary"}`,children:[G.nome,G.principal&&o.jsx("span",{className:"ml-1.5 text-xs opacity-70",children:"(voc)"})]}),!G.principal&&r&&o.jsx(fr.button,{type:"button",onClick:()=>r(me),whileHover:{scale:1.1},whileTap:{scale:.9},className:"shrink-0 p-1 rounded-full hover:bg-red-500/20 text-red-400 hover:text-red-300 transition-colors",title:"Remover participante",children:o.jsx(Ml,{className:"w-4 h-4"})})]},me))}),o.jsxs("form",{onSubmit:q,className:"flex flex-col gap-2",children:[o.jsxs("div",{className:`
          flex items-center gap-2 px-3 py-2.5 rounded-xl
          bg-surface/70 backdrop-blur-sm
          border-2 transition-all duration-300
          ${d?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
        `,children:[o.jsx(lue,{className:`w-4 h-4 shrink-0 transition-colors ${d?"text-brand":"text-text-muted"}`}),o.jsx("input",{ref:h,type:"text",value:l,onChange:G=>c(G.target.value),onKeyDown:L,onFocus:()=>u(!0),onBlur:()=>u(!1),placeholder:f?"Nome":"Nome do participante",disabled:a,autoComplete:"off",className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-base font-medium min-w-0"}),o.jsx(fr.button,{type:"submit",whileHover:{scale:l.trim()?1.05:1},whileTap:{scale:l.trim()?.95:1},disabled:!l.trim()||a,className:`
              px-3 py-1.5 rounded-lg transition-all duration-300 text-sm font-semibold shrink-0
              ${l.trim()?"bg-brand text-bg shadow-md":"bg-surface-light text-text-muted cursor-not-allowed opacity-50"}
            `,children:"Adicionar"})]}),o.jsx(fr.button,{type:"button",onClick:n,disabled:a,whileHover:{scale:a?1:1.05},whileTap:{scale:a?1:.95},className:`
            w-full px-6 py-3.5 rounded-xl font-bold text-base
            transition-all duration-300
            ${a?"bg-surface/30 text-text-muted cursor-not-allowed":"bg-brand text-bg shadow-lg hover:shadow-xl hover:shadow-brand/30"}
          `,children:o.jsxs("span",{className:"flex items-center justify-center gap-2",children:[o.jsx(ih,{className:"w-5 h-5"}),"Confirmar Participantes (",e.length,")"]})}),!f&&o.jsxs("p",{className:"text-xs text-text-muted text-center mt-1",children:[" ",o.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface rounded text-[10px]",children:"Enter"})," adiciona  ",o.jsx("kbd",{className:"px-1.5 py-0.5 bg-surface rounded text-[10px]",children:"Shift+Enter"})," confirma"]})]}),v&&typeof document<"u"&&$f.createPortal(o.jsxs("div",{className:"fixed inset-0 z-[9999] overflow-y-auto",children:[o.jsx("div",{className:"fixed inset-0 bg-black/75 backdrop-blur-sm",onClick:()=>!b&&g(!1)}),o.jsx("div",{className:"min-h-screen flex items-start justify-center pt-24 md:pt-16 pb-8 px-3",children:o.jsxs("div",{className:"relative w-[96vw] max-w-5xl bg-gradient-to-br from-surface via-background to-surface border border-white/10 rounded-3xl shadow-2xl flex flex-col overflow-hidden",children:[o.jsxs("div",{className:"sticky top-0 z-10 px-5 py-4 border-b border-white/10 bg-surface/70 backdrop-blur flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Wd,{size:"sm",variant:"header"}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-base md:text-lg font-extrabold text-text-primary leading-tight",children:j.length>0?"Sugestes encontradas":"Importar participantes"}),o.jsx("p",{className:"text-[11px] md:text-xs text-text-muted",children:j.length>0?`Selecione os nomes para adicionar (${j.length})`:"Cole sua lista e processe com IA"})]})]}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsx("button",{type:"button",disabled:b,onClick:()=>g(!1),className:"p-2 rounded-lg hover:bg-white/10",children:o.jsx(Ml,{className:"w-5 h-5"})})})]}),o.jsx("div",{className:"flex-1 max-h-[70vh] overflow-y-auto p-4 md:p-5",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 h-full",children:[o.jsxs("div",{className:"flex flex-col h-full",children:[o.jsx("label",{className:"text-xs text-text-muted mb-2",children:"Sua lista"}),o.jsx("textarea",{value:y,onChange:G=>x(G.target.value),disabled:b,placeholder:`Exemplo:
1) Joo Silva
2) Maria Clara
3) Pedro Henrique

Cole sua lista (um por linha ou separados por vrgula) e clique em Processar com sis`,className:"w-full min-h-[320px] max-h-[320px] resize-none overflow-y-auto bg-surface border border-white/10 rounded-xl p-3 outline-none text-sm focus:ring-2 focus:ring-brand/40"}),o.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[o.jsx("button",{type:"button",onClick:re,disabled:b&&!y.trim(),className:"px-4 py-2 rounded-xl font-semibold bg-surface border border-white/10 text-text-primary hover:bg-white/10 disabled:opacity-60",children:"Apagar"}),o.jsx("button",{type:"button",onClick:W,disabled:b||!y.trim(),className:"px-5 py-2.5 rounded-xl font-semibold shadow-lg transition bg-gradient-to-r from-brand to-emerald-500 text-white hover:shadow-emerald-500/30 disabled:opacity-60 disabled:cursor-not-allowed",children:b?"Processando":"Processar com sis"})]})]}),o.jsxs("div",{className:"flex flex-col h-full",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center gap-2 text-xs text-text-muted",children:[o.jsx("span",{children:"Sugeridos"}),o.jsx("span",{className:"inline-flex items-center justify-center px-2 py-0.5 rounded-full bg-white/10",children:j.length})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{type:"button",onClick:le,disabled:b,className:"px-2 py-1 text-xs rounded-lg bg-surface hover:bg-white/10 disabled:opacity-50",children:"Selecionar todos"}),o.jsx("button",{type:"button",onClick:K,disabled:b,className:"px-2 py-1 text-xs rounded-lg bg-surface hover:bg-white/10 disabled:opacity-50",children:"Limpar"})]})]}),o.jsx("div",{className:"min-h-[320px] max-h-[320px] overflow-y-auto border border-white/10 rounded-xl bg-surface",children:b?o.jsxs("div",{className:"p-3 animate-pulse",children:[o.jsx("div",{className:"h-4 w-28 bg-white/10 rounded mb-3"}),o.jsx("div",{className:"space-y-2",children:Array.from({length:8}).map((G,me)=>o.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[o.jsx("div",{className:"h-3 w-40 bg-white/10 rounded"}),o.jsx("div",{className:"h-4 w-4 bg-white/10 rounded"})]},me))})]}):o.jsx("ul",{className:"divide-y divide-white/5",children:j.map(G=>{const me=z(G),pe=M&&I&&D&&me===D;return o.jsxs("li",{className:`flex items-center justify-between px-3 py-2 ${pe?"bg-white/5":""}`,children:[o.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[o.jsx("span",{className:"text-sm truncate pr-1",children:G}),pe&&o.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-emerald-600/20 text-emerald-400 border border-emerald-500/30 shrink-0",children:"Voc"})]}),o.jsx("input",{type:"checkbox",className:"w-4 h-4",checked:pe?!0:!!P[me],onChange:()=>!pe&&ne(G),disabled:pe})]},me)})})}),M&&j.length===0&&y.trim()&&!b&&o.jsx("div",{className:"p-3 text-sm text-text-muted",children:"Nenhum nome novo encontrado."}),C.length>0&&o.jsxs("div",{className:"mt-2 text-xs text-text-muted flex items-center gap-2",children:[o.jsx("span",{children:"Ignorados"}),o.jsx("span",{className:"inline-flex items-center justify-center px-2 py-0.5 rounded-full bg-white/10",children:C.length})]}),o.jsx("div",{className:"mt-3 flex items-center justify-end",children:o.jsx("button",{type:"button",onClick:Q,disabled:b||j.filter(G=>P[z(G)]).length===0,className:`px-5 py-2.5 rounded-xl font-semibold ${b||j.filter(G=>P[z(G)]).length===0?"bg-surface/30 text-text-muted cursor-not-allowed":"bg-emerald-600 text-white shadow-lg hover:shadow-emerald-600/30 transition"}`,children:(()=>`Adicionar selecionados (${j.reduce((me,pe)=>{const Be=z(pe);return M&&I&&D&&Be===D?me+1:me+(P[Be]?1:0)},0)})`)()})})]})]})})]})})]}),document.body)]})},dit=({onSubmit:e,disabled:t=!1})=>{const[r,n]=p.useState(0),[a,i]=p.useState(0),[s,l]=p.useState(""),[c,d]=p.useState(!1),u=g=>{g.preventDefault(),!(r===0||t)&&e({rating:r,comentario:s.trim()||null,timestamp:new Date().toISOString()})},f=g=>{t||n(g)},m=g=>{t||i(g)},h=()=>{t||i(0)},v=a||r;return o.jsx(fr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:[.22,1,.36,1]},className:"w-full mb-8 md:mb-4",children:o.jsx("div",{className:"bg-background/98 backdrop-blur-3xl border-2 border-white/50 rounded-3xl p-6 md:p-8 shadow-2xl relative z-50",children:o.jsxs("form",{onSubmit:u,className:"flex flex-col gap-6",children:[o.jsxs("div",{className:"flex flex-col items-center gap-4",children:[o.jsx("div",{className:"flex items-center gap-2",children:[1,2,3,4,5].map(g=>o.jsx(fr.button,{type:"button",onClick:()=>f(g),onMouseEnter:()=>m(g),onMouseLeave:h,disabled:t,whileHover:{scale:t?1:1.2},whileTap:{scale:t?1:.9},className:`
                    p-2 transition-all duration-200 rounded-full
                    ${t?"cursor-not-allowed":"cursor-pointer hover:bg-brand/10"}
                  `,children:o.jsx(nue,{className:`w-8 h-8 md:w-10 md:h-10 transition-all duration-200 ${g<=v?"fill-yellow-400 text-yellow-400 drop-shadow-lg":"text-text-muted hover:text-yellow-300"}`})},g))}),r>0&&o.jsx(fr.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-center",children:o.jsxs("p",{className:"text-base font-semibold text-text-primary",children:[r===1&&" Muito ruim",r===2&&" Ruim",r===3&&" Regular",r===4&&" Bom",r===5&&" Excelente"]})})]}),r>0&&o.jsx("div",{className:"w-full h-px bg-white/10 my-2"}),r>0&&o.jsxs(fr.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{duration:.3,delay:.2},className:"flex flex-col gap-4",children:[o.jsxs("label",{className:"text-base font-semibold text-text-primary flex items-center gap-2",children:[o.jsx(eue,{className:"w-5 h-5 text-brand"}),"Comentrio (opcional)"]}),o.jsx("div",{className:`
                flex items-start gap-2 px-4 py-3 rounded-xl
                bg-background/60 backdrop-blur-sm
                border-2 transition-all duration-300
                ${c?"border-brand/50 shadow-lg shadow-brand/10":"border-white/10 shadow-md"}
              `,children:o.jsx("textarea",{value:s,onChange:g=>l(g.target.value),onFocus:()=>d(!0),onBlur:()=>d(!1),placeholder:"Conte-nos mais sobre sua experincia...",disabled:t,rows:3,maxLength:500,className:"flex-1 bg-transparent text-text-primary placeholder:text-text-muted outline-none text-base resize-none min-w-0"})}),o.jsxs("div",{className:"text-sm text-text-muted text-right",children:[s.length,"/500"]})]}),r>0&&o.jsx(fr.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.4},className:"mt-2 mb-4",children:o.jsxs(fr.button,{type:"submit",disabled:t,whileHover:{scale:t?1:1.02},whileTap:{scale:t?1:.98},className:`
                w-full px-6 py-4 rounded-2xl font-bold text-lg
                transition-all duration-300 flex items-center justify-center gap-3
                shadow-xl border-2
                ${t?"bg-surface text-text-muted cursor-not-allowed border-white/10":"bg-gradient-to-r from-brand to-brand/90 text-white shadow-brand/30 hover:shadow-2xl hover:shadow-brand/40 border-brand/20 hover:from-brand/90 hover:to-brand"}
              `,children:[o.jsx(MI,{className:"w-6 h-6"}),"Enviar Avaliao"]})})]})})})},uit=({message:e="Carregando..."})=>{const t=[" sis IA iniciando..."," Processando dados em tempo real..."," IA analisando disponibilidade..."," sis aprendendo suas preferncias..."," Assistente virtual ativando..."," IA otimizando seu agendamento..."," sis calculando melhores opes..."," Sincronizando com IA..."," Inteligncia artificial carregando..."," sis processando informaes..."],r=t[Math.floor(Math.random()*t.length)];return o.jsxs("div",{className:"min-h-screen bg-background flex items-center justify-center relative overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-background via-surface/30 to-background",children:o.jsx(fr.div,{className:"absolute inset-0 opacity-20",animate:{background:["radial-gradient(circle at 20% 50%, #FF6600 0%, transparent 50%)","radial-gradient(circle at 80% 50%, #FFAA33 0%, transparent 50%)","radial-gradient(circle at 50% 20%, #FF6600 0%, transparent 50%)","radial-gradient(circle at 20% 50%, #FF6600 0%, transparent 50%)"]},transition:{duration:4,repeat:1/0,ease:"easeInOut"}})}),o.jsx("div",{className:"absolute inset-0 pointer-events-none",children:[...Array(6)].map((n,a)=>o.jsx(fr.div,{className:"absolute w-2 h-2 rounded-full",style:{background:a%2===0?"#FF6600":"#FFAA33",left:`${Math.random()*100}%`,top:`${Math.random()*100}%`},animate:{y:[-20,-100,-20],opacity:[0,1,0],scale:[.5,1,.5]},transition:{duration:3+Math.random()*2,repeat:1/0,delay:Math.random()*2,ease:"easeInOut"}},a))}),o.jsxs(fr.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.8,ease:[.22,1,.36,1]},className:"relative z-10 text-center",children:[o.jsxs("div",{className:"mb-8 flex flex-col items-center gap-6",children:[o.jsxs(fr.div,{className:"relative",animate:{rotateY:[0,360]},transition:{duration:4,repeat:1/0,ease:"easeInOut"},children:[o.jsx(fr.div,{className:"absolute inset-0 rounded-2xl blur-xl opacity-60",style:{background:"#FFAA33"},animate:{scale:[1,1.2,1],opacity:[.4,.8,.4]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}}),o.jsx(fr.div,{className:"relative w-20 h-20 md:w-24 md:h-24 rounded-2xl flex items-center justify-center",style:{background:"#FFAA33"},whileHover:{scale:1.05},children:o.jsx($d,{className:"w-12 h-12 md:w-14 md:h-14 text-white",strokeWidth:2})})]}),o.jsxs(fr.div,{className:"flex items-baseline gap-1",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.3},children:[o.jsx(fr.span,{className:"font-extrabold text-4xl md:text-5xl",style:{color:"#FF6600"},animate:{textShadow:["0 0 10px rgba(255, 102, 0, 0.5)","0 0 20px rgba(255, 102, 0, 0.8)","0 0 10px rgba(255, 102, 0, 0.5)"]},transition:{duration:2,repeat:1/0},children:"Fluxo"}),o.jsx(fr.span,{className:"font-extrabold text-4xl md:text-5xl",style:{color:"#FFAA33"},animate:{textShadow:["0 0 10px rgba(255, 170, 51, 0.5)","0 0 20px rgba(255, 170, 51, 0.8)","0 0 10px rgba(255, 170, 51, 0.5)"]},transition:{duration:2,repeat:1/0,delay:.1},children:"7"}),o.jsx(fr.span,{className:"font-medium text-4xl md:text-5xl ml-2",style:{color:"#B0B0B0"},initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:.6},children:"Arena"})]})]}),o.jsx("div",{className:"w-64 md:w-80 mx-auto mb-6",children:o.jsx("div",{className:"h-1 bg-surface/30 rounded-full overflow-hidden",children:o.jsx(fr.div,{className:"h-full rounded-full",style:{background:"linear-gradient(90deg, #FFAA33, #FFD700, #FFAA33)"},animate:{x:[-100,300]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},initial:{x:-100}})})}),o.jsxs(fr.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:.8},className:"space-y-3",children:[o.jsx(fr.p,{className:"text-base md:text-lg font-medium text-text-primary px-4",animate:{opacity:[.7,1,.7]},transition:{duration:1.5,repeat:1/0},children:r}),o.jsx("div",{className:"flex justify-center gap-1",children:[0,1,2].map(n=>o.jsx(fr.div,{className:"w-2 h-2 rounded-full",style:{background:"#FFAA33"},animate:{scale:[.8,1.2,.8],opacity:[.5,1,.5]},transition:{duration:1,repeat:1/0,delay:n*.2}},n))})]})]})]})},fit={greeting:["Ol! Eu sou a Isis  Vou te ajudar a agendar sua quadra! Qual voc prefere?","Oi! Sou a Isis!  Vamos agendar? Me diz, qual quadra voc quer?","E a! Isis aqui! Bora marcar sua partida? Qual quadra te interessa?","Ol!  Prazer, sou a Isis! Qual quadra voc quer reservar?","Opa! Isis na rea! Vamos agendar sua quadra? Qual delas?","Seja bem-vindo! Sou a Isis e vou facilitar sua reserva! Qual quadra?"],afterQuadra:["Boa escolha! {quadra}  tima!  Para qual dia?","Perfeito! {quadra}  top! Qual dia voc quer?","{quadra} confirmada!  Me diz, que dia?","Show! {quadra}  sucesso aqui! Qual o dia?","Anotado! {quadra}  Agora me fala o dia:","Excelente! {quadra}  uma das melhores! Para quando?"],afterData:["Beleza! {data} anotado!  Qual horrio voc prefere?","timo! {data} t disponvel! Que horas?","{data}  logo ali!  Me diz o horrio:","Confirmado {data}! Qual horrio te atende melhor?","Perfeito! {data}  Agora escolhe o horrio:","Show! {data} t livre! Qual o melhor horrio pra voc?"],afterHorario:["{horario}  seu!  Qual modalidade?","Reservado {horario}!  Vai ser qual modalidade?","Fechou {horario}! Qual esporte?","{horario} confirmado! Me diz a modalidade:","Show! {horario}  E a modalidade ...?","Perfeito! {horario} garantido! Qual modalidade?"],afterModalidade:["{modalidade}! Massa!  Quantas pessoas vo jogar?","Vai ser {modalidade}! Legal! Quantos jogadores?","{modalidade}  bom demais!  Quantas pessoas?","Top! {modalidade}  Me diz quantas pessoas:","{modalidade} confirmado! Quantos vo jogar?","timo! {modalidade}  show! Quantos participantes?"],askNames:["Agora preciso dos nomes! Digite cada um (um por linha):","Beleza! Me manda os nomes dos participantes:","Show! Lista os nomes pra mim:","timo! Quais so os nomes?","Perfeito! Me passa os nomes de todo mundo:","Legal! Agora os nomes dos jogadores:"],askContact:["ltimos dados! Qual seu nome completo?","Agora preciso do seu nome e telefone:","Quase l! Me passa seu nome e WhatsApp:","Beleza! Seus dados para contato:","Falta pouco! Nome completo e telefone:","ltima etapa! Qual seu nome e telefone?"],reviewData:["timo! Vamos conferir tudo antes de confirmar:","Perfeito! Revisa comigo os dados:","Show! Confirma se t tudo certo:","Beleza! D uma olhada se est correto:","Legal! Vamos revisar juntos:","Massa! Confere os detalhes aqui:"],confirmation:[" Tudo certo! Agendamento #{codigo} confirmado!"," Pronto! Seu agendamento #{codigo} est garantido!"," Feito! Cdigo #{codigo} confirmado!"," Sucesso! Agendamento #{codigo} t na agenda!"," Confirmado! #{codigo}  seu!"," Show! Agendamento #{codigo} marcado!"],thankYou:["Obrigada por agendar conosco! At logo! ","Valeu! Te vejo no jogo! ","Brigada! Bom jogo! ","Obrigada! At a partida! ","Valeu pela preferncia! At breve! ","Obrigada! Qualquer coisa,  s voltar aqui! "],loading:["Deixa eu verificar...","S um momento...","J te respondo...","Aguarda um pouquinho...","Consultando aqui...","Verificando pra voc..."],error:["Ops! Algo deu errado. Vamos tentar de novo?","Eita! Tive um problema aqui. Podemos recomear?","Putz! Deu erro. Tenta novamente?","Opa! Algo no funcionou. Vamos de novo?","Caramba! Erro aqui. Pode tentar novamente?"],noAvailability:["Puts... esse horrio j foi reservado.  Escolhe outro?","Eita! Esse j est ocupado. Que tal outro horrio?","Opa! Esse horrio acabou de ser reservado. Tem outro?","Poxa! Algum reservou esse agora mesmo. Outro horrio?","Xiii! Esse j foi. Bora escolher outro?"]},Qg=(e,t={})=>{const r=fit[e];if(!r||r.length===0)return console.warn(`[Isis] Nenhuma variao encontrada para step: ${e}`),"Ol! Como posso ajudar?";const n=Math.floor(Math.random()*r.length);let a=r[n];return Object.keys(t).forEach(i=>{const s=new RegExp(`\\{${i}\\}`,"g");a=a.replace(s,t[i])}),a},_4="690605e5ae596e708f3c7bc5",S4="$2a$10$/XmOGvx8./SZzV3qMzQ5i.6FjBjS4toNbeaEFzX2D8QPUddyM6VR2",moe="https://api.jsonbin.io/v3",mit=async()=>{try{const e=await fetch(`${moe}/b/${_4}/latest`,{method:"GET",headers:{"X-Master-Key":S4,"Content-Type":"application/json"}});if(!e.ok){const r=await e.text();throw console.error("[JSONBin] Resposta do servidor:",r),e.status===401?new Error("Chave de API JSONBin invlida ou bin no pertence  conta"):e.status===404?new Error("Bin JSONBin no encontrado"):new Error(`Erro ao buscar dados: ${e.status} - ${r}`)}return(await e.json()).record}catch(e){throw console.error("[JSONBin] Erro ao buscar dados:",e),e}},hit=async e=>{try{const t=await fetch(`${moe}/b/${_4}`,{method:"PUT",headers:{"X-Master-Key":S4,"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`Erro ao atualizar dados: ${t.status}`);return(await t.json()).record}catch(t){throw console.error("[JSONBin] Erro ao atualizar dados:",t),t}},pit=e=>{try{const t=JSON.parse(localStorage.getItem("isis-feedbacks")||"[]");return t.push(e),localStorage.setItem("isis-feedbacks",JSON.stringify(t)),console.log("[JSONBin] Feedback salvo localmente como fallback:",e.id),e}catch(t){return console.error("[JSONBin] Erro ao salvar feedback localmente:",t),e}},git=async e=>{const t={id:Date.now()+Math.random().toString(36).substr(2,9),timestamp:new Date().toISOString(),estrelas:e.rating,nome_cliente:e.cliente_nome,empresa:e.empresa_nome,projeto:"fluxo7arena",comentario:e.comentario||null};try{console.log("[JSONBin] Adicionando feedback ISIS:",e);const r=await mit();return r["feedback-isis"]||(r["feedback-isis"]=[]),r["feedback-isis"].push(t),await hit(r),console.log("[JSONBin] Feedback adicionado com sucesso:",t.id),t}catch(r){return console.error("[JSONBin] Erro ao adicionar feedback, salvando localmente:",r),pit(t)}},vit=()=>{const{nomeFantasia:e}=Cce();Pc();const[t,r]=p.useState(null),{currentStep:n,selections:a,addIsisMessage:i,addIsisMessageWithButtons:s,addUserMessage:l,disableAllButtons:c,updateSelection:d,updateContact:u,nextStep:f,setIsLoading:m,setIsTyping:h,chatEndRef:v}=foe(),[g,y]=p.useState(null),[x,b]=p.useState([]),[w,j]=p.useState([]),[_,C]=p.useState(!0),[E,P]=p.useState("telefone"),[k,M]=p.useState(!1),[S,I]=p.useState(null),[T,D]=p.useState(null),[B,U]=p.useState(!1),z=ye.useMemo(()=>(console.log("[Isis] Logo da empresa:",{logo_url:g?.logo_url,empresa:g}),g?.logo_url?`${g.logo_url}?v=${Date.now()}`:g?.logo_url||""),[g?.logo_url]);p.useEffect(()=>{(async()=>{if(!e){C(!1);return}try{console.log("[Isis] Buscando empresa por nome fantasia:",e);const Ue=decodeURIComponent(e).toLowerCase().replace(/[\s\-_]+/g,"").trim();console.log("[Isis] Nome normalizado para busca:",Ue);const{data:Qe,error:et}=await ve.from("empresas").select("codigo_empresa, nome_fantasia, razao_social, logo_url");let pt=null;if(!et&&Qe){const qt=Qe.find(lt=>{const rr=(lt.nome_fantasia||"").toLowerCase().replace(/[\s\-_]+/g,""),nt=(lt.razao_social||"").toLowerCase().replace(/[\s\-_]+/g,"");return rr===Ue||nt===Ue});qt&&(pt=[qt])}if(et||!pt||pt.length===0){console.error("[Isis] Empresa no encontrada:",et),r(null),C(!1);return}const Ke=pt[0];console.log("[Isis] Empresa encontrada:",Ke),r(Ke.codigo_empresa)}catch(Ne){console.error("[Isis] Erro ao buscar empresa:",Ne),r(null),C(!1)}})()},[e]),p.useEffect(()=>{if(console.log("[DEBUG] useEffect iniciarConversa:",{codigoEmpresa:t,loadingEmpresa:_,hasCliente:!!a.cliente,identificacaoIniciada:B,timestamp:new Date().toISOString()}),!t||_){console.log("[DEBUG] Saindo - sem cdigo ou ainda carregando");return}!a.cliente&&!B?(console.log("[DEBUG] Cliente no identificado e identificao no iniciada, agendando iniciarIdentificacao em 1s"),U(!0),setTimeout(()=>{console.log("[DEBUG] Executando iniciarIdentificacao aps delay (loading fora da tela)"),Y()},2500)):console.log("[DEBUG] Cliente j identificado ou identificao j iniciada, no fazendo nada")},[t,_,a.cliente,B]),p.useEffect(()=>{(async()=>{if(!t){C(!1);return}try{console.log("[useEffect] Definindo empresa atual para RLS:",t),await ve.rpc("set_current_empresa",{empresa_codigo:String(t)}),await G()}catch(Ne){console.error("[useEffect] Erro ao definir empresa para RLS:",Ne),await G()}})()},[t]);const $=()=>{const Ne=new Date().getHours();return Ne>=5&&Ne<12?"Bom dia":Ne>=12&&Ne<18?"Boa tarde":"Boa noite"},Y=()=>{console.log("[DEBUG] iniciarIdentificacao INICIOU:",{loadingEmpresa:_,empresa:g?.nome_fantasia,timestamp:new Date().toISOString()}),P("telefone"),M(!1);const Se=g?.nome_fantasia||g?.razao_social||"Arena Palace",Ne=$(),Ue=[`**${Ne}!** Tudo bem? 

Sou a **sis**, assistente virtual da **${Se}** e estou aqui para tornar seu **agendamento** super fcil!

Para comear, qual seu **telefone** ou **e-mail**?`,`Hey! **${Ne}!**  **sis** na rea!

Sou a assistente virtual da **${Se}** e vim facilitar sua vida.

Bora **agendar**? Me passa seu **telefone** ou **e-mail**:`,`**${Ne}!** Prazer em te atender! 

Sou a **sis** da **${Se}**, sua assistente virtual para **agendamentos**.

Para comear, preciso do seu **telefone** ou **e-mail**:`,`Opa! **${Ne}!**  **sis** aqui, sua assistente virtual da **${Se}**!

Vamos **marcar seu horrio**?  rapidinho!

Me informa seu **telefone** ou **e-mail**:`,`**${Ne}!** Seja bem-vindo! 

Eu sou a **sis**, sua assistente virtual aqui na **${Se}**.

Vou te ajudar a **agendar seu horrio** rapidinho!

Informe seu **telefone** ou **e-mail**:`],Qe=Math.floor(Math.random()*Ue.length);console.log("[DEBUG] Mostrando indicador de digitao primeiro:",{loadingEmpresa:_,timestamp:new Date().toISOString()}),h(!0),setTimeout(()=>{console.log("[DEBUG] Fazendo scroll inicial para mostrar indicador de digitao"),v.current?.scrollIntoView({behavior:"smooth",block:"end"})},300),setTimeout(()=>{console.log("[DEBUG] Enviando mensagem da Isis aps indicador de digitao"),h(!1),i(Ue[Qe],0),setTimeout(()=>{console.log("[DEBUG] Fazendo scroll aps mensagem aparecer"),v.current?.scrollIntoView({behavior:"smooth",block:"end"})},100)},3500),setTimeout(()=>{console.log("[DEBUG] Mostrando input"),M(!0),setTimeout(()=>{v.current?.scrollIntoView({behavior:"smooth",block:"end"})},200)},3500+600),f("identificacao")},de=async Se=>{try{console.log("[DEBUG] Buscando cliente com valor:",Se),console.log("[DEBUG] Cdigo empresa:",t);const Ne=Se.replace(/\D/g,"");if(Ne.length>=10){console.log("[DEBUG] Buscando telefone:",Ne);const{data:et,error:pt}=await ve.from("clientes").select("id, nome, email, telefone, whatsapp, celular1, codigo").eq("codigo_empresa",t).eq("status","active");if(pt)throw pt;console.log("[DEBUG] Total de clientes ativos:",et?.length);const Ke=et?.find(qt=>{const lt=(qt.telefone||"").replace(/\D/g,""),rr=(qt.whatsapp||"").replace(/\D/g,""),nt=(qt.celular1||"").replace(/\D/g,"");return lt.includes(Ne)||rr.includes(Ne)||nt.includes(Ne)});return console.log("[DEBUG] Cliente encontrado:",Ke),Ke||null}const{data:Ue,error:Qe}=await ve.from("clientes").select("id, nome, email, telefone, whatsapp, codigo").eq("codigo_empresa",t).eq("status","active").ilike("email",`%${Se}%`);if(console.log("[DEBUG] Busca por email - Clientes encontrados:",Ue),Qe)throw Qe;return Ue?.[0]||null}catch(Ne){return console.error("Erro ao buscar cliente:",Ne),null}},xe=Se=>{const Ne=Se.trim().split(" ").filter(Ue=>Ue);return Ne.length===1?Ne[0]:Ne.length>=2?`${Ne[0]} ${Ne[1]}`:Ne[0]},q=async Se=>{if(!Se){i("Por favor, informe a data desejada.",400);return}const Ne=/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/,Ue=Se.match(Ne);if(!Ue){i("**Formato invlido!** Por favor, use o formato DD/MM/AAAA (exemplo: 15/12/2024)",400);return}const[,Qe,et,pt]=Ue,Ke=new Date(parseInt(pt),parseInt(et)-1,parseInt(Qe));if(isNaN(Ke.getTime())||Ke.getDate()!==parseInt(Qe)||Ke.getMonth()!==parseInt(et)-1||Ke.getFullYear()!==parseInt(pt)){i("**Data invlida!** Verifique se o dia, ms e ano esto corretos.",400);return}const qt=new Date;if(qt.setHours(0,0,0,0),Ke.setHours(0,0,0,0),Ke<qt){i("**Data no passado!** Por favor, escolha uma data de hoje em diante.",400);return}l(Se);const lt=Jt(Ke,"dd/MM/yyyy",{locale:ia}),rr=Jt(Ke,"EEEE",{locale:ia});m(!0);const nt=await Z(a.quadra.id,Ke);if(m(!1),nt.fechada){if(nt.motivo==="data_especifica")i(`**Ops!** A quadra estar **fechada** no dia **${lt}** (${rr}). 

**Motivo:** ${nt.observacao}`,800);else if(nt.motivo==="dia_semana"){const In=Jt(Ke,"EEEE",{locale:ia});i(`**Ops!** A quadra no funciona ${In==="domingo"||In==="sbado"?"aos":"s"} **${In}s**. 

Escolha outro dia da semana!`,800)}setTimeout(()=>{i("Digite **outra data** no formato DD/MM/AAAA:",1200),setTimeout(()=>{M(!0),setTimeout(()=>{v.current?.scrollIntoView({behavior:"smooth",block:"start"})},200)},400)},1200);return}d("data",Ke),M(!1),P("telefone"),i(`**Perfeito!** Data escolhida: **${lt}** (${rr}) `,600);const $t=nt.slots;if($t.length===0){i("Ops! No encontrei **horrios disponveis** para esse dia.  Que tal tentar outra data?",800),setTimeout(()=>{perguntarData()},1200);return}const Qr=ee($t);let Xr="";Qr.length===1?Xr=`Tenho **horrios livres** das **${Qr[0].inicio}** s **${Qr[0].fim}**! `:Xr=`Tenho **horrios livres** ${Qr.map((sn,Qt)=>Qt===Qr.length-1?`e das **${sn.inicio}** s **${sn.fim}**`:Qt===0?`das **${sn.inicio}** s **${sn.fim}**`:`das **${sn.inicio}** s **${sn.fim}**`).join(", ")}! `,i(Xr,1e3),setTimeout(()=>{i("Escolha o horrio de incio e trmino: ",1200),f("horario"),setTimeout(()=>{M(!0),setTimeout(()=>{v.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1e3)},1600)},L=async Se=>{if(E==="data_custom")return await q(Se);if(!Se){i("Por favor, informe seu telefone ou e-mail.",400);return}const Ne=E==="telefone"?`(${Se.slice(0,2)}) ${Se.slice(2,7)}-${Se.slice(7)}`:Se;l(Ne);const Ue=await de(Se);if(Ue){d("cliente",Ue),M(!1);const Qe=xe(Ue.nome),et=[`**${Qe}!** `,`Opa, **${Qe}!** `,`E a, **${Qe}!** `,`**${Qe}!** Que bom te ver! `,`Fala, **${Qe}!** `,`**${Qe}!** Tudo bem? `,`Hey, **${Qe}!** `],pt=Math.floor(Math.random()*et.length);i(et[pt],600),setTimeout(()=>{Q()},1e3)}else d("identificacao_valor",Ne),d("identificacao_tipo",E),M(!1),i("No encontrei seu cadastro. Sem problemas! Vamos fazer rapidinho. ",800),i("Preciso de algumas informaes:",1400),setTimeout(()=>{M(!0),setTimeout(()=>{v.current?.scrollIntoView({behavior:"smooth",block:"start"})},200),setTimeout(()=>{v.current?.scrollIntoView({behavior:"smooth",block:"start"})},600)},1400+800),f("cadastro")},W=async Se=>{let Ne=`Nome: ${Se.nome}`;if(Se.telefone){const Ue=`(${Se.telefone.slice(0,2)}) ${Se.telefone.slice(2,7)}-${Se.telefone.slice(7)}`;Ne+=`
Telefone: ${Ue}`}Se.email&&(Ne+=`
E-mail: ${Se.email}`),l(Ne),await ne(Se.nome,Se.email,Se.telefone)},ne=async(Se,Ne,Ue)=>{try{m(!0),i(Qg("loading"));const{data:Qe}=await ve.from("empresa_counters").select("next_cliente_codigo").eq("empresa_id",g?.id).single(),et=Qe?.next_cliente_codigo||1,{data:pt,error:Ke}=await ve.from("clientes").insert({codigo_empresa:t,codigo:et,nome:Se,email:Ne||null,telefone:Ue,whatsapp:Ue,status:"active"}).select("id, nome, email, telefone, whatsapp, codigo").single();if(Ke){if(Ke.code==="23505"&&Ke.message.includes("uq_clientes_empresa_codigo")){console.log("[Isis] Cdigo duplicado, tentando prximo cdigo...");const{data:qt,error:lt}=await ve.from("clientes").insert({codigo_empresa:t,codigo:et+1,nome:Se,email:Ne||null,telefone:Ue,whatsapp:Ue,status:"active"}).select("id, nome, email, telefone, whatsapp, codigo").single();if(lt)throw lt;await ve.from("empresa_counters").update({next_cliente_codigo:et+2}).eq("empresa_id",g?.id),m(!1),d("cliente",qt),i(`Pronto, ${Se}! Cadastro realizado com sucesso! `,800),setTimeout(()=>{re()},1400);return}throw Ke}await ve.from("empresa_counters").update({next_cliente_codigo:et+1}).eq("empresa_id",g?.id),m(!1),d("cliente",pt),i(`Pronto, ${Se}! Cadastro realizado com sucesso! `,800),setTimeout(()=>{re()},1400)}catch(Qe){console.error("Erro ao criar cliente:",Qe),m(!1),i("Ops! Erro ao criar cadastro. Tente novamente.",400)}},le=()=>{const Se=new Date,Ne=Ia(Se,1),Ue=[{label:`Hoje (${Jt(Se,"dd/MM")})`,value:Jt(Se,"yyyy-MM-dd"),icon:"",date:Se},{label:`Amanh (${Jt(Ne,"dd/MM")})`,value:Jt(Ne,"yyyy-MM-dd"),icon:"",date:Ne},{label:"Outro dia...",value:"custom",icon:""}];s("Para qual dia voc gostaria de agendar?",Ue,600),f("data")},K=()=>{l(" Mudar Data"),M(!1),setTimeout(()=>{le()},400)},Q=()=>{const Se=["O que voc gostaria de fazer hoje?","Como posso te ajudar?","Qual  o plano para hoje?","O que vamos fazer?","Em que posso te auxiliar?","Qual sua necessidade hoje?","Como posso ser til?"],Ne=Se[Math.floor(Math.random()*Se.length)];s(Ne,[{label:"Fazer Agendamento",value:"novo_agendamento",icon:""},{label:"Editar Agendamento",value:"buscar_agendamento",icon:""},{label:"Finalizar Atendimento",value:"finalizar_atendimento",icon:""}],600)},re=async()=>{console.log("[iniciarAgendamento] Dados disponveis:",{quadras:x?.length||0,empresa:!!g,empresaNome:g?.nome_fantasia||g?.razao_social});let Se=x,Ne=g;if(!Se||Se.length===0){console.log("[iniciarAgendamento] Quadras no disponveis, carregando...");const Ue=await G(!1);if(Se=Ue.quadras,Ne=Ue.empresa,!Se||Se.length===0){console.error("[iniciarAgendamento] Quadras ainda no disponveis aps carregar!"),i("Ops! No consegui carregar as quadras. Tente novamente.",600);return}}if(!Ne){console.error("[iniciarAgendamento] Empresa no disponvel!"),i("Ops! No consegui carregar os dados da empresa. Tente novamente.",600);return}setTimeout(()=>{me(Se,Ne,!0)},800)},G=async(Se=!0)=>{try{Se&&C(!0);const Ne=Date.now(),Ue=3500;console.log("[DEBUG] Loading premium INICIOU:",{startTime:Ne,minLoadingTime:Ue,timestamp:new Date().toISOString()});const{data:Qe,error:et}=await ve.from("empresas").select("*").eq("codigo_empresa",t).single();if(et)throw et;if(!Qe)return gj({title:"Empresa no encontrada",description:"Verifique o cdigo e tente novamente",variant:"destructive"}),{empresa:null,quadras:[]};y(Qe),d("empresa",Qe);const{data:pt,error:Ke}=await ve.from("quadras").select("id, nome, modalidades, hora_inicio, hora_fim, valor, codigo_empresa, status, descricao").eq("codigo_empresa",String(t)).eq("status","Ativa").order("nome",{ascending:!0});if(Ke)throw console.error("[loadEmpresa] Erro ao buscar quadras:",Ke),Ke;if(!pt||pt.length===0){console.warn("[loadEmpresa] Nenhuma quadra encontrada devido a RLS. Criando quadra temporria.");const rr=[{id:"temp-quadra-1004",nome:"Quadra Principal",modalidades:["Futebol","Futsal"],hora_inicio:"07:00:00",hora_fim:"22:00:00",valor:30,codigo_empresa:String(t),status:"Ativa",descricao:"Quadra temporria (problema de permisso)"}];return b(rr),{empresa:Qe,quadras:rr}}b(pt||[]);const qt=Date.now()-Ne,lt=Math.max(0,Ue-qt);return console.log("[DEBUG] Verificando delay mnimo:",{elapsedTime:qt,remainingTime:lt,willWait:lt>0,timestamp:new Date().toISOString()}),lt>0&&(console.log("[DEBUG] Aguardando delay mnimo de",lt,"ms"),await new Promise(rr=>setTimeout(rr,lt)),console.log("[DEBUG] Delay mnimo CONCLUDO")),{empresa:Qe,quadras:pt||[]}}catch(Ne){console.error("[Isis] Erro ao carregar empresa:",Ne);const Ue=Date.now()-startTime,Qe=Math.max(0,minLoadingTime-Ue);return Qe>0&&await new Promise(et=>setTimeout(et,Qe)),gj({title:"Erro ao carregar",description:"No foi possvel carregar os dados da empresa",variant:"destructive"}),{empresa:null,quadras:[]}}finally{Se&&(console.log("[DEBUG] loadEmpresa FINALIZOU - setLoadingEmpresa(false):",{timestamp:new Date().toISOString()}),C(!1))}},me=(Se,Ne,Ue=!1)=>{if(console.log("[iniciarConversa] Iniciando com:",{quadras:Se?.length||0,empresa:Ne?.nome_fantasia||Ne?.razao_social,jaIdentificado:Ue}),Ne.nome_fantasia||Ne.razao_social,$(),Se.length===1){console.log("[iniciarConversa] Uma quadra detectada, auto-selecionando:",Se[0].nome);const pt=Se[0];if(Ue){const Ke=[`Perfeito! Agora vamos **agendar** seu horrio na **${pt.nome}!** `,`timo! Vou te ajudar a **marcar sua partida** na **${pt.nome}!** `,`Show! Bora **agendar** a **${pt.nome}?** `,`Perfeito! Vamos **marcar sua reserva** na **${pt.nome}!** `],qt=Math.floor(Math.random()*Ke.length),lt=Ke[qt];i(lt)}d("quadra",pt),setTimeout(()=>{const Ke=new Date,qt=Ia(Ke,1),lt=[{label:`Hoje (${Jt(Ke,"dd/MM")})`,value:Jt(Ke,"yyyy-MM-dd"),icon:"",date:Ke},{label:`Amanh (${Jt(qt,"dd/MM")})`,value:Jt(qt,"yyyy-MM-dd"),icon:"",date:qt},{label:"Outro dia...",value:"custom",icon:""}];i("Para qual dia voc gostaria de agendar?",800),s("",lt,1e3),f("data")},1200);return}let Qe;if(Ue){const pt=["Qual quadra voc quer reservar? ","Qual quadra te interessa? ","Me diz, qual quadra? ","Qual quadra voc prefere? ","Bora escolher a quadra? Qual delas? "],Ke=Math.floor(Math.random()*pt.length);Qe=pt[Ke]}else return;const et=Se.map(pt=>({label:pt.nome,subtitle:pt.descricao||null,value:pt.id,icon:"",quadra:pt}));s(Qe,et),f("quadra")},pe=async Se=>{console.log("[handleQuadraSelection] Iniciando...",{button:Se,currentStep:n});const Ne=Se.quadra;if(l(Ne.nome),d("quadra",Ne),n==="review"){console.log("[handleQuadraSelection] Modo edio detectado - recarregando horrios"),console.log("[handleQuadraSelection] Quadra ID:",Ne.id),console.log("[handleQuadraSelection] Data:",a.data),M(!1),I("horario"),m(!0);const Ke=await Z(Ne.id,a.data,T?.id);if(console.log("[handleQuadraSelection] Resultado:",Ke),m(!1),Ke.fechada){const lt=Jt(a.data,"dd/MM/yyyy",{locale:ia}),rr=Jt(a.data,"EEEE",{locale:ia});if(Ke.motivo==="data_especifica")i(`**Ops!** A **${Ne.nome}** estar **fechada** no dia **${lt}** (${rr}). 

**Motivo:** ${Ke.observacao}`,800);else if(Ke.motivo==="dia_semana"){const nt=Jt(a.data,"EEEE",{locale:ia}),$t=nt==="domingo"||nt==="sbado"?"aos":"s";i(`**Ops!** A **${Ne.nome}** no funciona ${$t} **${nt}s**. `,800)}setTimeout(()=>{i("Escolha **outra quadra** ou **mude a data**:",1200),setTimeout(()=>{le()},400)},1600);return}const qt=Ke.slots;if(qt&&qt.length>0){const lt=ee(qt);let rr="";lt.length===1?rr=`Tenho **horrios livres** das **${lt[0].inicio}** s **${lt[0].fim}**! `:rr=`Tenho **horrios livres** ${lt.map(($t,Qr)=>Qr===lt.length-1?`e das **${$t.inicio}** s **${$t.fim}**`:Qr===0?`das **${$t.inicio}** s **${$t.fim}**`:`das **${$t.inicio}** s **${$t.fim}**`).join(", ")}! `,console.log("[handleQuadraSelection] Mostrando horrios disponveis e input de horrio"),i(rr,600),setTimeout(()=>{i("Escolha o horrio de incio e trmino: ",800),setTimeout(()=>{console.log("[handleQuadraSelection] Ativando showInput=true"),M(!0),setTimeout(()=>{v.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1e3)},800)}else console.log("[handleQuadraSelection] Nenhum horrio disponvel"),i("Ops! No encontrei **horrios disponveis** para essa quadra nesse dia. ");return}console.log("[handleQuadraSelection] Fluxo normal (no edio)");const Ue=Qg("afterQuadra",{quadra:Ne.nome});i(Ue,600);const Qe=new Date,et=Ia(Qe,1),pt=[{label:`Hoje (${Jt(Qe,"dd/MM")})`,value:Jt(Qe,"yyyy-MM-dd"),icon:"",date:Qe},{label:`Amanh (${Jt(et,"dd/MM")})`,value:Jt(et,"yyyy-MM-dd"),icon:"",date:et},{label:"Outro dia...",value:"custom",icon:""}];s("Para qual dia voc gostaria de agendar?",pt,1e3),f("data")},Be=async Se=>{if(console.log("[handleDataSelection] Iniciando...",{button:Se,currentStep:n}),Se.value==="custom"){l(" Outro dia..."),i("**Perfeito!** Me informe a **data desejada** no formato DD/MM/AAAA:",600),P("data_custom"),setTimeout(()=>{M(!0),setTimeout(()=>{v.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},800);return}const Ne=Se.date;if(l(Se.label),d("data",Ne),n==="review"){console.log("[handleDataSelection] Modo edio detectado - recarregando horrios"),console.log("[handleDataSelection] Quadra ID:",a.quadra?.id),console.log("[handleDataSelection] Nova Data:",Ne),M(!1),I("horario"),m(!0);const Ke=await Z(a.quadra.id,Ne,T?.id);if(console.log("[handleDataSelection] Resultado:",Ke),m(!1),Ke.fechada){const lt=Jt(Ne,"dd/MM/yyyy",{locale:ia}),rr=Jt(Ne,"EEEE",{locale:ia});if(Ke.motivo==="data_especifica")i(`**Ops!** A quadra estar **fechada** no dia **${lt}** (${rr}). 

**Motivo:** ${Ke.observacao}`,800);else if(Ke.motivo==="dia_semana"){const nt=Jt(Ne,"EEEE",{locale:ia});i(`**Ops!** A quadra no funciona ${nt==="domingo"||nt==="sbado"?"aos":"s"} **${nt}s**. `,800)}setTimeout(()=>{i("Escolha **outra data**:",1200),setTimeout(()=>{le()},400)},1600);return}const qt=Ke.slots;if(qt&&qt.length>0){const lt=ee(qt);let rr="";lt.length===1?rr=`Tenho **horrios livres** das **${lt[0].inicio}** s **${lt[0].fim}**! `:rr=`Tenho **horrios livres** ${lt.map(($t,Qr)=>Qr===lt.length-1?`e das **${$t.inicio}** s **${$t.fim}**`:Qr===0?`das **${$t.inicio}** s **${$t.fim}**`:`das **${$t.inicio}** s **${$t.fim}**`).join(", ")}! `,console.log("[handleDataSelection] Mostrando horrios disponveis e input"),i(rr,600),setTimeout(()=>{i("Escolha o horrio de incio e trmino: ",800),setTimeout(()=>{console.log("[handleDataSelection] Ativando showInput=true"),M(!0),setTimeout(()=>{v.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1e3)},800)}else console.log("[handleDataSelection] Nenhum horrio disponvel"),i("Ops! No encontrei **horrios disponveis** para essa quadra nesse dia.  Tente outra data.");return}console.log("[handleDataSelection] Fluxo normal (no edio)"),m(!0);const Ue=await Z(a.quadra.id,Ne);if(console.log("[handleDataSelection] Resultado (fluxo normal):",Ue),m(!1),Ue.fechada){const Ke=Jt(Ne,"dd/MM/yyyy",{locale:ia}),qt=Jt(Ne,"EEEE",{locale:ia});if(Ue.motivo==="data_especifica")i(`**Ops!** A quadra estar **fechada** no dia **${Ke}** (${qt}). 

**Motivo:** ${Ue.observacao}`,800);else if(Ue.motivo==="dia_semana"){const lt=Jt(Ne,"EEEE",{locale:ia});i(`**Ops!** A quadra no funciona ${lt==="domingo"||lt==="sbado"?"aos":"s"} **${lt}s**. 

Escolha outro dia da semana!`,800)}setTimeout(()=>{i("Que tal tentar **outra data**? ",1200),setTimeout(()=>{le()},400)},1600);return}const Qe=Ue.slots;if(Qe.length===0){console.log("[handleDataSelection] Nenhum horrio disponvel"),i("Ops! No encontrei **horrios disponveis** para esse dia.  Que tal tentar outro dia?");return}const et=ee(Qe);let pt="";et.length===1?pt=`Tenho **horrios livres** das **${et[0].inicio}** s **${et[0].fim}**! `:pt=`Tenho **horrios livres** ${et.map((qt,lt)=>lt===et.length-1?`e das **${qt.inicio}** s **${qt.fim}**`:lt===0?`das **${qt.inicio}** s **${qt.fim}**`:`das **${qt.inicio}** s **${qt.fim}**`).join(", ")}! `,i(pt,800),setTimeout(()=>{i("Escolha o horrio de incio e trmino: ",1e3),f("horario"),setTimeout(()=>{M(!0),setTimeout(()=>{v.current?.scrollIntoView({behavior:"smooth",block:"start"})},200),setTimeout(()=>{v.current?.scrollIntoView({behavior:"smooth",block:"start"})},600),setTimeout(()=>{v.current?.scrollIntoView({behavior:"smooth",block:"start"})},1e3)},1e3+600)},1400)},Z=async(Se,Ne,Ue=null)=>{try{console.log("[loadHorariosDisponiveis] quadraId:",Se),console.log("[loadHorariosDisponiveis] data:",Ne);const Qe=x.find(Tr=>Tr.id===Se);if(!Qe)return console.error("[loadHorariosDisponiveis] Quadra no encontrada:",Se),[];console.log("[loadHorariosDisponiveis] Quadra encontrada:",Qe.nome),console.log("[loadHorariosDisponiveis] Horrio funcionamento:",Qe.hora_inicio,"-",Qe.hora_fim);const et=Jt(Ne,"yyyy-MM-dd"),pt=Ne.getDay();console.log("[loadHorariosDisponiveis] Verificando funcionamento para:",et,"dia da semana:",pt);const{data:Ke,error:qt}=await ve.from("quadras_dias_funcionamento").select("*").eq("codigo_empresa",t).eq("quadra_id",Se).or(`and(tipo.eq.data_fechamento,data_fechamento.eq.${et}),and(tipo.eq.dia_semana,dia_semana.eq.${pt})`);if(qt)console.error("[loadHorariosDisponiveis] Erro ao buscar configuraes de funcionamento:",qt);else{console.log("[loadHorariosDisponiveis] Configuraes encontradas:",Ke?.length||0);const Tr=Ke?.find($r=>$r.tipo==="data_fechamento"&&$r.data_fechamento===et);if(Tr&&!Tr.funciona)return console.log("[loadHorariosDisponiveis] Quadra fechada em data especfica:",Tr.observacao),{slots:[],fechada:!0,motivo:"data_especifica",observacao:Tr.observacao||"Fechamento especial"};const sr=Ke?.find($r=>$r.tipo==="dia_semana"&&$r.dia_semana===pt);if(sr&&!sr.funciona)return console.log("[loadHorariosDisponiveis] Quadra no funciona neste dia da semana"),{slots:[],fechada:!0,motivo:"dia_semana",observacao:`Quadra fechada s ${["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"][pt]}s`};console.log("[loadHorariosDisponiveis] Quadra funciona normalmente na data selecionada")}const lt=ni(Ne),rr=Ia(lt,1);let nt=ve.from("agendamentos").select("inicio, fim, status").eq("codigo_empresa",t).eq("quadra_id",Se).gte("inicio",lt.toISOString()).lt("inicio",rr.toISOString()).neq("status","canceled");Ue&&(nt=nt.neq("id",Ue),console.log("[loadHorariosDisponiveis] Excluindo agendamento sendo editado:",Ue));const{data:$t,error:Qr}=await nt;if(Qr)throw Qr;console.log("[loadHorariosDisponiveis] Agendamentos encontrados:",$t?.length||0);const Xr=parseInt(Qe.hora_inicio?.split(":")[0]||"6");let In=parseInt(Qe.hora_fim?.split(":")[0]||"24");In===0&&(In=24);const sn=new Date,Qt=ni(Ne).getTime()===ni(sn).getTime(),qr=[];for(let Tr=Xr;Tr<In;Tr++)for(let sr of[0,30]){const $r=v2(g2(Ne,Tr),sr),Gr=Q0e($r,30);if(Qt&&$r<sn)continue;$t?.some(Mt=>{const wr=new Date(Mt.inicio),Fr=new Date(Mt.fim),Ur=Math.floor($r.getTime()/6e4),Kr=Math.floor(Gr.getTime()/6e4),dn=Math.floor(wr.getTime()/6e4),wn=Math.floor(Fr.getTime()/6e4);return Kr===dn||Ur===wn?!1:Ur<wn&&Kr>dn})||qr.push({inicio:Jt($r,"HH:mm"),fim:Jt(Gr,"HH:mm"),inicioDate:$r,fimDate:Gr})}return console.log("[loadHorariosDisponiveis] Total de slots disponveis:",qr.length),j(qr),{slots:qr,fechada:!1,motivo:null,observacao:null}}catch(Qe){return console.error("[loadHorariosDisponiveis] Erro ao carregar horrios:",Qe),j([]),{slots:[],fechada:!1,motivo:"erro",observacao:"Erro ao carregar horrios"}}},ee=Se=>{if(Se.length===0)return[];const Ne=[];let Ue={inicio:Se[0].inicio,fim:Se[0].fim};for(let Qe=1;Qe<Se.length;Qe++)Se[Qe].inicio===Ue.fim?Ue.fim=Se[Qe].fim:(Ne.push(Ue),Ue={inicio:Se[Qe].inicio,fim:Se[Qe].fim});return Ne.push(Ue),Ne},kt=({inicio:Se,fim:Ne,esporte:Ue})=>{const[Qe,et]=Se.split(":").map(Number),[pt,Ke]=Ne.split(":").map(Number),qt=a.data,lt=v2(g2(qt,Qe),et),rr=pt===0&&Ke===0?v2(g2(Ia(qt,1),0),0):v2(g2(qt,pt),Ke),nt={inicio:Se,fim:Ne,inicioDate:lt,fimDate:rr};if(l(`${nt.inicio} - ${nt.fim}  ${Ue}`),console.log("[handleHorarioSubmit] Atualizando horrio:",nt),console.log("[handleHorarioSubmit] Atualizando esporte:",Ue),d("horario",nt),d("esporte",Ue),M(!1),n==="review"||S==="horario"){setTimeout(()=>{I(null),f("review"),yt(nt,Ue)},600);return}const $t=[{nome:a.cliente.nome,cliente_id:a.cliente.id,principal:!0}];d("participantes",$t);const Qr=xe(a.cliente.nome);i(`Perfeito! ${Qr}, voc j est na lista! `,800),i('Quer adicionar mais pessoas? Digite o nome e clique em "Adicionar" para cada um, ou finalize quando quiser.',1400),setTimeout(()=>{M(!0),setTimeout(()=>{v.current?.scrollIntoView({behavior:"smooth",block:"start"})},200),setTimeout(()=>{v.current?.scrollIntoView({behavior:"smooth",block:"start"})},600)},1400+600),f("participantes")},Nt=Se=>{if(!Se||!Se.trim())return;const Ne=a.participantes||[],Ue={nome:Se.trim(),cliente_id:null,principal:!1},Qe=[...Ne,Ue];d("participantes",Qe)},De=Se=>{if(!Array.isArray(Se)||Se.length===0)return;const Ne=rr=>String(rr||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim().replace(/\s+/g," "),Ue=a.cliente,Qe=Ue?.nome?String(Ue.nome).trim():null,et=Qe?Ne(Qe):null,pt=a.participantes||[],Ke=pt.length>0?pt:Qe&&Ue?[{nome:Qe,cliente_id:Ue.id,principal:!0}]:[],qt=new Set,lt=[];Ke.forEach(rr=>{const nt=Ne(rr.nome);if(!nt||qt.has(nt))return;qt.add(nt);const $t=et&&nt===et;lt.push({...rr,principal:$t})}),Se.forEach(rr=>{const nt=String(rr||"").trim();if(!nt)return;const $t=Ne(nt);!$t||qt.has($t)||et&&$t===et||(qt.add($t),lt.push({nome:nt,cliente_id:null,principal:!1}))}),lt.length===0&&Qe&&Ue&&lt.push({nome:Qe,cliente_id:Ue.id,principal:!0}),d("participantes",lt)},st=Se=>{const Ne=a.participantes||[];if(Se===0)return;const Ue=Ne.filter((Qe,et)=>et!==Se);d("participantes",Ue)},ft=()=>{const Se=a.participantes||[];if(Se.length===0){i("Voc precisa ter pelo menos 1 participante!",400);return}M(!1);const Ne=Se.length;if(Ne===1)l(" Apenas eu por enquanto");else{const Ue=Se.filter(Qe=>!Qe.principal).map(Qe=>Qe.nome).join(", ");l(` Eu + ${Ue} (${Ne} pessoas)`)}setTimeout(()=>{I(null),yt()},600)},yt=(Se=null,Ne=null,Ue=!1,Qe=null,et=null,pt=null,Ke=null)=>{const qt=Se||a.horario,lt=Ne||a.esporte,rr=Qe||a.quadra,nt=et||a.data,$t=pt||a.participantes||[],Qr=Ke||T;if(console.log("[mostrarResumo] Selections atuais:",a),console.log("[mostrarResumo] Horrio usado:",qt),console.log("[mostrarResumo] Esporte usado:",lt),console.log("[mostrarResumo] Quadra atual:",rr),console.log("[mostrarResumo] Data atual:",nt),console.log("[mostrarResumo] Modo edio inicial:",Ue),!nt||!qt||!rr){console.error("[mostrarResumo] Dados obrigatrios faltando:",{dataFinal:nt,horarioFinal:qt,quadraFinal:rr});return}if(!Ue){const Ht=Qg("reviewData");i(Ht,400)}const Xr=$t.map((Ht,dr)=>{const Ft=dr===0?"":"",Ot=dr===0?" (voc)":"";return`${Ft} ${Ht.nome}${Ot}`}).join(`
`),In=Jt(nt,"dd/MM/yyyy",{locale:ia}),sn=Jt(nt,"EEEE",{locale:ia}),[Qt,qr]=qt.inicio.split(":").map(Number),[Tr,sr]=qt.fim.split(":").map(Number);let $r=Tr*60+sr-(Qt*60+qr);Tr===0&&sr===0&&($r=24*60-(Qt*60+qr));const Gr=Math.floor($r/60),ke=$r%60,Mt=ke>0?`${Gr}h ${ke}min`:`${Gr}h`,wr=rr.valor||0,Fr=$r/30,Ur=Math.round(wr*Fr*100)/100,Kr=Ur/$t.length;console.log("[mostrarResumo] Clculo do valor:"),console.log("- Valor por meia hora:",wr),console.log("- Slots de 30min:",Fr),console.log("- Durao em minutos:",$r),console.log("- Valor total:",Ur),console.log("- Participantes:",$t.length),console.log("- Valor dividido:",Kr);const dn=` **RESUMO DO AGENDAMENTO**

 **Quadra**
${rr.nome}

 **Data**
${In} (${sn})

 **Horrio**
${qt.inicio} s ${qt.fim}
 Durao: **${Mt}**

 **Modalidade**
${lt}

 **Participantes** (${$t.length})
${Xr}

 **Valor Total**
R$ **${Ur.toFixed(2).replace(".",",")}**
 **Valor Dividido**
R$ **${Kr.toFixed(2).replace(".",",")}** por pessoa

 **Responsvel**
${a.cliente.nome}
 ${a.cliente.telefone||a.cliente.whatsapp||"N/A"}`;i(dn,Ue?200:1e3);const va=[{label:Qr?"Salvar Alteraes":"Confirmar Agendamento",value:"confirm",icon:""}],xa=[];x.length>1&&xa.push({label:"Editar Quadra",value:"edit_quadra",icon:""}),xa.push({label:"Editar Data",value:"edit_data",icon:""}),xa.push({label:"Editar Horrio e Esporte",value:"edit_horario",icon:""}),xa.push({label:"Editar Participantes",value:"edit_participantes",icon:""}),Qr&&xa.push({label:"Cancelar Agendamento",value:"cancelar_agendamento",icon:""});const Aa=[...va,...xa];s("Est tudo correto?",Aa,Ue?400:1600),f("review")},Nr=(Se,Ne=!1)=>{i(Ne?" **Perfeito!** Suas **alteraes** foram **salvas com sucesso!**":" **Pronto!** Seu **agendamento** foi **confirmado com sucesso!**",600,"green");const Qe=a.participantes||[],et=Qe.map($r=>` ${$r.nome}`).join(`
`),pt=Jt(a.data,"dd/MM/yyyy",{locale:ia}),Ke=Jt(a.data,"EEEE",{locale:ia}),[qt,lt]=a.horario.inicio.split(":").map(Number),[rr,nt]=a.horario.fim.split(":").map(Number);let $t=rr*60+nt-(qt*60+lt);rr===0&&nt===0&&($t=24*60-(qt*60+lt));const Qr=Math.floor($t/60),Xr=$t%60,In=Xr>0?`${Qr}h ${Xr}min`:`${Qr}h`,sn=a.quadra.valor||0,Qt=$t/30,qr=Math.round(sn*Qt*100)/100,Tr=` **AGENDAMENTO CONFIRMADO**

 **Cdigo:** #${Se.codigo}

 **Local**
${a.quadra.nome}

 **Quando**
${pt} (${Ke})
 ${a.horario.inicio} s ${a.horario.fim} **(${In})**

 **Modalidade**
${a.esporte}

 **Participantes** (${Qe.length})
${et}

 **Valor Total:** R$ **${qr.toFixed(2).replace(".",",")}**

 **Responsvel:** ${a.cliente.nome}`;i(Tr,1200),s("O que voc gostaria de fazer?",[{label:"Finalizar Atendimento",value:"finalizar",icon:""},{label:"Editar Agendamento",value:"editar_agendamento",icon:""},{label:"Cancelar Agendamento",value:"cancelar_agendamento",icon:""}],1800)},se=async Se=>{if(Se.quadra){await pe(Se);return}if(Se.date){await Be(Se);return}if(Se.agendamento){const Ne=Jt(new Date(Se.agendamento.inicio),"dd/MM/yyyy",{locale:ia}),Ue=Jt(new Date(Se.agendamento.inicio),"HH:mm"),Qe=Jt(new Date(Se.agendamento.fim),"HH:mm");l(`${Ne}  ${Ue}-${Qe}`),await mt(Se.agendamento);return}switch(Se.value){case"confirm":l(T?" Salvar Alteraes":" Confirmar Agendamento"),T?await ae():await $e();break;case"edit_quadra":l(" Editar Quadra");const Ue=x.map(Xr=>({label:Xr.nome,value:Xr.id,icon:"",subtitle:Xr.descricao||Xr.tipo||null,quadra:Xr}));s("Qual quadra voc quer?",Ue,600);break;case"edit_data":l(" Editar Data");const Qe=new Date,et=Ia(Qe,1),pt=[{label:`Hoje (${Jt(Qe,"dd/MM")})`,value:Jt(Qe,"yyyy-MM-dd"),icon:"",date:Qe},{label:`Amanh (${Jt(et,"dd/MM")})`,value:Jt(et,"yyyy-MM-dd"),icon:"",date:et},{label:"Outro dia...",value:"custom",icon:""}];s("Para qual dia?",pt,600);break;case"edit_horario":l(" Editar Horrio e Esporte"),M(!1),I("horario"),m(!0);const Ke=await Z(a.quadra.id,a.data,T?.id);if(m(!1),Ke.fechada){const Xr=Jt(a.data,"dd/MM/yyyy",{locale:ia}),In=Jt(a.data,"EEEE",{locale:ia});if(Ke.motivo==="data_especifica")i(`**Ops!** A quadra estar **fechada** no dia **${Xr}** (${In}). 

**Motivo:** ${Ke.observacao}`,800);else if(Ke.motivo==="dia_semana"){const sn=Jt(a.data,"EEEE",{locale:ia});i(`**Ops!** A quadra no funciona ${sn==="domingo"||sn==="sbado"?"aos":"s"} **${sn}s**. `,800)}setTimeout(()=>{i("No  possvel editar o horrio. Escolha **outra data** ou **quadra**:",1200),setTimeout(()=>{le()},400)},1600);return}const qt=Ke.slots;if(qt&&qt.length>0){const Xr=ee(qt);let In="";Xr.length===1?In=`Tenho **horrios livres** das **${Xr[0].inicio}** s **${Xr[0].fim}**! `:In=`Tenho **horrios livres** ${Xr.map((Qt,qr)=>qr===Xr.length-1?`e das **${Qt.inicio}** s **${Qt.fim}**`:qr===0?`das **${Qt.inicio}** s **${Qt.fim}**`:`das **${Qt.inicio}** s **${Qt.fim}**`).join(", ")}! `,i(In,600),setTimeout(()=>{i("Escolha o horrio de incio e trmino: ",800),setTimeout(()=>{M(!0),setTimeout(()=>{v.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1e3)},800)}else i("Ops! No encontrei **horrios disponveis**. ");break;case"edit_participantes":l(" Editar Participantes"),M(!1),I("participantes"),i("Edite a lista de participantes:",600),setTimeout(()=>{M(!0),setTimeout(()=>{v.current?.scrollIntoView({behavior:"smooth",block:"start"})},200)},800);break;case"finalizar":l(" Finalizar Atendimento");const lt=["Pronto! Seu agendamento est confirmado! ","Perfeito! Agendamento realizado com sucesso! ","Tudo certo! Seu horrio est garantido! ","Sucesso! Agendamento confirmado! "],rr=lt[Math.floor(Math.random()*lt.length)];i(rr,800),setTimeout(()=>{Ce()},1400);break;case"cancelar_agendamento":l(" Cancelar Agendamento");const nt=[{label:"Sim, cancelar",value:"confirmar_cancelamento",icon:""},{label:"No, voltar",value:"voltar_cancelamento",icon:""}],$t=["Tem certeza que deseja cancelar este agendamento?","Confirma o cancelamento do agendamento?","Realmente quer cancelar? Esta ao no pode ser desfeita.","Deseja mesmo cancelar este agendamento?"],Qr=$t[Math.floor(Math.random()*$t.length)];s(Qr,nt,600);break;case"confirmar_cancelamento":await tr();break;case"voltar_cancelamento":l(" Voltar"),i("Ok! Voltando ao resumo do agendamento.",400),setTimeout(()=>{yt(null,null,!0,null,null,null,T)},800);break;case"editar_agendamento":l(" Editar Agendamento"),i("Claro! O que voc gostaria de alterar?",600),setTimeout(()=>{yt(null,null,!0)},800);break;case"novo_agendamento":l(" Fazer Agendamento"),re();break;case"buscar_agendamento":l(" Editar Agendamento"),i("Vou buscar seus agendamentos...",600),rt();break;case"finalizar_atendimento":l(" Finalizar Atendimento"),Ce();break;default:console.warn("[Isis] Ao no reconhecida:",Se.value)}},rt=async()=>{try{console.log("[buscarAgendamentosCliente] Iniciando busca de agendamentos...");const{data:Se,error:Ne}=await ve.from("agendamentos").select(`
          id,
          codigo,
          inicio,
          fim,
          modalidade,
          status,
          valor_total,
          quadras!inner(nome, descricao, valor)
        `).eq("codigo_empresa",t).eq("cliente_id",a.cliente.id).in("status",["scheduled","confirmed"]).gte("inicio",new Date().toISOString()).order("inicio",{ascending:!0});if(Ne)throw Ne;if(!Se||Se.length===0){i("No encontrei agendamentos futuros para voc. ",800),i("Que tal fazer um novo agendamento? ",1400),setTimeout(()=>{re()},2e3);return}if(Se.length===1){const Ue=Se[0],Qe=Jt(new Date(Ue.inicio),"dd/MM/yyyy",{locale:ia}),et=Jt(new Date(Ue.inicio),"HH:mm"),pt=Jt(new Date(Ue.fim),"HH:mm");i(`Encontrei seu agendamento para ${Qe} das ${et} s ${pt} - ${Ue.modalidade}! `,800),setTimeout(()=>{mt(Ue)},1200)}else{i(`Encontrei ${Se.length} agendamentos futuros! Qual voc quer editar?`,800);const Ue=Se.map(Qe=>{const et=new Date(Qe.inicio),pt=Jt(et,"dd/MM/yyyy",{locale:ia}),Ke=Jt(et,"EEEE",{locale:ia}),qt=Jt(et,"HH:mm"),lt=Jt(new Date(Qe.fim),"HH:mm"),rr=(new Date(Qe.fim)-et)/(1e3*60),nt=Math.floor(rr/60),$t=rr%60;let Qr="";nt>0?Qr=$t>0?`${nt}h${$t}m`:`${nt}h`:Qr=`${$t}m`;const Xr=Qe.quadras.valor||0,In=rr/30,Qt=(Math.round(Xr*In*100)/100).toFixed(2).replace(".",","),qr=new Date,Tr=new Date(qr);Tr.setDate(qr.getDate()+1);let sr="";return et.toDateString()===qr.toDateString()?sr="Hoje":et.toDateString()===Tr.toDateString()?sr="Amanh":sr=`${Ke.charAt(0).toUpperCase()+Ke.slice(1)}, ${pt}`,{label:`${sr}  ${qt}-${lt}`,value:`editar_agendamento_${Qe.id}`,icon:"",subtitle:`${Qe.quadras.nome}  ${Qe.modalidade}  ${Qr}  R$ ${Qt}`,agendamento:Qe}});setTimeout(()=>{s("Escolha o agendamento:",Ue,600)},1200)}}catch(Se){console.error("[Isis] Erro ao buscar agendamentos:",Se),i("Ops! Tive um problema ao buscar seus agendamentos. ",800),i("Que tal tentar fazer um novo agendamento?",1400),setTimeout(()=>{re()},2e3)}},mt=async Se=>{try{console.log("[carregarAgendamentoParaEdicao] Iniciando carregamento do agendamento:",Se.id);const{data:Ne,error:Ue}=await ve.from("agendamentos").select(`
          *,
          quadras(id, nome, descricao, modalidades, valor),
          agendamento_participantes(nome, cliente_id)
        `).eq("id",Se.id).single();if(Ue)throw console.error("[Isis] Erro ao buscar agendamento:",Ue),new Error(`Agendamento no encontrado ou inacessvel: ${Ue.message}`);if(!Ne)throw new Error("Agendamento no encontrado");const Qe=new Date(Ne.inicio),et=Jt(Qe,"HH:mm"),pt=Jt(new Date(Ne.fim),"HH:mm");d("quadra",Ne.quadras),d("data",Qe),d("horario",{inicio:et,fim:pt,inicioDate:new Date(Ne.inicio),fimDate:new Date(Ne.fim)}),d("esporte",Ne.modalidade);const Ke=Ne.cliente_id||a.cliente?.id||null,qt=Ne.agendamento_participantes||[];let lt=null;const rr=[];qt.forEach($t=>{const Qr=Ke&&$t.cliente_id===Ke,Xr={nome:$t.nome,cliente_id:$t.cliente_id,principal:Qr};Qr&&!lt?lt=Xr:rr.push(Xr)});const nt=lt?[lt,...rr.map($t=>({...$t,principal:!1}))]:qt.map(($t,Qr)=>({nome:$t.nome,cliente_id:$t.cliente_id,principal:Qr===0}));d("participantes",nt),D(Ne),i("Perfeito! Aqui esto os detalhes do seu agendamento:",600),setTimeout(()=>{const $t={inicio:et,fim:pt,inicioDate:new Date(Ne.inicio),fimDate:new Date(Ne.fim)};yt($t,Ne.modalidade,!0,Ne.quadras,Qe,nt,Ne),f("review")},1400)}catch(Ne){console.error("[Isis] Erro ao carregar agendamento:",Ne),Ne.message.includes("no encontrado")?(i("Ops! Este agendamento no foi encontrado ou pode ter sido cancelado. ",800),i("Vou buscar seus agendamentos atualizados...",1400),setTimeout(()=>{rt()},2e3)):(i("Ops! Tive um problema ao carregar o agendamento. ",800),i("Que tal tentar fazer um novo agendamento?",1400),setTimeout(()=>{re()},2e3))}},tr=async()=>{if(!T){console.error("[Isis] Nenhum agendamento para cancelar");return}try{m(!0);const{error:Se}=await ve.from("agendamentos").update({status:"canceled"}).eq("id",T.id);if(Se)throw Se;m(!1);const Ne=[" Agendamento cancelado com sucesso!"," Pronto! Seu agendamento foi cancelado."," Cancelamento realizado! Agendamento removido."," Feito! O agendamento foi cancelado com sucesso."],Ue=Ne[Math.floor(Math.random()*Ne.length)];i(Ue,600),D(null),setTimeout(()=>{i("O que voc gostaria de fazer agora?",800),setTimeout(()=>{Q()},1200)},1200)}catch(Se){console.error("[Isis] Erro ao cancelar agendamento:",Se),m(!1);const Ne=Qg("error");i(Ne)}},Ce=()=>{c();const Se=["Antes de finalizar, que tal me dar uma avaliao? ","Para finalizar, gostaria que avaliasse nosso atendimento! ","Quase pronto! Me ajuda com uma avaliao rpida? ","ltima etapa! Como foi nosso atendimento hoje? ","Para encerrar, que nota voc daria para nosso atendimento? ","Ei, que tal me contar como foi a experincia? ","Curiosa para saber: como voc avalia nosso atendimento? ","Rapidinho aqui: o que achou do nosso servio? ","Me conta a, como foi para voc hoje? ","Sua opinio  super importante! Como foi tudo? ","Sua avaliao nos ajuda a melhorar! Como foi? ","Para continuarmos evoluindo, como voc nos avalia? ","Queremos sempre melhorar! Que nota voc daria? ","Seu feedback  ouro para ns! Como foi o atendimento? ","Ajude-nos a ser ainda melhores! Qual sua avaliao? ","Espero ter te ajudado bem! Como voc me avalia? ","Fiz um bom trabalho hoje? Me conta sua opinio! ","Consegui resolver tudo certinho? Que tal uma avaliao? ","Antes de voc ir, me diz como foi nossa conversa? ","Sua experincia foi boa? Adoraria saber! ","Obrigada pela confiana! Como foi para voc? ","Foi um prazer te atender! Que nota voc daria? ","Agradeo pela pacincia! Como avalia nosso servio? ","Muito obrigada! Me conta como foi tudo? ","Pode ser sincero(a)! Como foi o atendimento? ","Sem papas na lngua: que nota voc daria? ","Honestamente, como voc nos avalia? ","Sua opinio real  importante! Como foi? ","Para finalizar o atendimento, preciso da sua avaliao! ","Processo quase concludo! Falta s sua avaliao! ","ltima etapa do nosso protocolo: sua opinio! ","Para encerrar com chave de ouro: como nos avalia? "],Ne=Se[Math.floor(Math.random()*Se.length)];i(Ne,800),setTimeout(()=>{M(!0),f("avaliacao"),setTimeout(()=>{v.current?.scrollIntoView({behavior:"smooth",block:"start"})},300)},1200)},je=async Se=>{try{const Ne=`${Se.rating} estrela${Se.rating>1?"s":""}`,Ue=Se.comentario?` ${Ne}
 "${Se.comentario}"`:` ${Ne}`;l(Ue),M(!1),m(!0);const Qe={rating:Se.rating,comentario:Se.comentario,cliente_nome:a.cliente?.nome,empresa_nome:g?.nome_fantasia||g?.razao_social||"Arena"};await git(Qe),m(!1);const et=g?.nome_fantasia||g?.razao_social||"a empresa",pt=new Date().getHours();let Ke;pt>=5&&pt<12?Ke="Tenha um timo dia! ":pt>=12&&pt<18?Ke="Tenha uma tima tarde! ":pt>=18&&pt<22?Ke="Tenha uma tima noite! ":Ke="Tenha uma boa noite! ";let qt;if(Se.rating>=4){const lt=[` **Muito obrigada pela avaliao!** A **${et}** agradece imensamente! Foi um prazer te atender! ${Ke}`,` **Que bom que gostou!** A **${et}** fica muito feliz! Volte sempre! ${Ke}`,` **Perfeito!** A **${et}** agradece de corao! Espero ter ajudado! ${Ke}`,` **Adorei seu feedback!** A **${et}** est muito grata! Nos vemos em breve! ${Ke}`,` **Excelente!** A **${et}** agradece pela confiana! At a prxima! ${Ke}`,` **Uau, que nota incrvel!** A **${et}** est nas nuvens! Obrigada! ${Ke}`,` **Voc  demais!** A **${et}** adora clientes como voc! ${Ke}`,` **Top demais!** A **${et}** se sente campe com seu feedback! ${Ke}`,` **Que alegria!** A **${et}** fica radiante com sua avaliao! ${Ke}`,` **Sensacional!** A **${et}** est celebrando sua nota! ${Ke}`,` **Amei sua avaliao!** Fico feliz em saber que te atendi bem! A **${et}** agradece! ${Ke}`,` **Que feedback maravilhoso!** Me deixou super feliz! A **${et}**  grata! ${Ke}`,` **Seu carinho me emociona!** A **${et}** tem sorte de ter voc! ${Ke}`,` **Voc iluminou meu dia!** A **${et}** agradece de todo corao! ${Ke}`,` **Nota mxima!** A **${et}** te espera sempre de braos abertos! ${Ke}`,` **Cliente 5 estrelas!** A **${et}** adora te ter aqui! Volte logo! ${Ke}`,` **Voc  especial!** A **${et}** sempre ter um lugar especial para voc! ${Ke}`,` **Show de avaliao!** A **${et}** te aguarda para a prxima apresentao! ${Ke}`];qt=lt[Math.floor(Math.random()*lt.length)]}else if(Se.rating===3){const lt=[` **Obrigada pelo feedback!** A **${et}** vai melhorar ainda mais! ${Ke}`,` **Agradecemos sua avaliao!** A **${et}** est trabalhando para evoluir! ${Ke}`,` **Obrigada!** A **${et}** valoriza seu retorno! Foi um prazer te atender! ${Ke}`,` **Toda avaliao nos faz crescer!** A **${et}** agradece sua sinceridade! ${Ke}`,` **Feedback valioso!** A **${et}** usa cada retorno para evoluir! ${Ke}`,` **Obrigada pela nota!** A **${et}** est sempre buscando melhorar! ${Ke}`,` **Seu retorno  importante!** A **${et}** vai usar para aprimorar nosso servio! ${Ke}`,` **Agradecemos a oportunidade!** A **${et}** espera te surpreender na prxima! ${Ke}`,` **Obrigada pela dica!** A **${et}** vai trabalhar para te conquistar! ${Ke}`,` **Toda crtica construtiva  bem-vinda!** A **${et}** agradece! ${Ke}`];qt=lt[Math.floor(Math.random()*lt.length)]}else{const lt=[` **Obrigada pela sinceridade.** A **${et}** vai trabalhar para melhorar! ${Ke}`,` **Agradecemos seu feedback.** A **${et}** est comprometida em evoluir! ${Ke}`,` **Obrigada por compartilhar.** A **${et}** vai usar seu retorno para melhorar! ${Ke}`,` **Lamentamos no ter atendido suas expectativas.** A **${et}** vai se esforar mais! ${Ke}`,` **Sentimos muito pela experincia.** A **${et}** levar isso muito a srio! ${Ke}`,` **Assumimos a responsabilidade.** A **${et}** vai fazer melhor da prxima vez! ${Ke}`,` **Sua insatisfao nos preocupa.** A **${et}** vai revisar todos os processos! ${Ke}`,` **Obrigada pelo alerta!** A **${et}** espera uma nova chance de te impressionar! ${Ke}`,` **Vamos melhorar!** A **${et}** promete que da prxima vez ser diferente! ${Ke}`,` **Seu feedback  nosso combustvel!** A **${et}** vai usar para crescer! ${Ke}`,` **J estamos trabalhando nas melhorias!** A **${et}** agradece sua pacincia! ${Ke}`,` **Sua honestidade  valiosa!** A **${et}** prefere a verdade para evoluir! ${Ke}`,` **Crticas nos fazem crescer!** A **${et}** agradece sua coragem de falar! ${Ke}`];qt=lt[Math.floor(Math.random()*lt.length)]}i(qt,600)}catch(Ne){console.error("[Isis] Erro ao enviar avaliao:",Ne),m(!1);const Ue=g?.nome_fantasia||g?.razao_social||"a empresa",Qe=new Date().getHours();let et;Qe>=5&&Qe<12?et="Tenha um timo dia! ":Qe>=12&&Qe<18?et="Tenha uma tima tarde! ":Qe>=18&&Qe<22?et="Tenha uma tima noite! ":et="Tenha uma boa noite! ";const pt=[`Ops! Tive um problema ao salvar sua avaliao, mas a **${Ue}** agradece muito seu feedback! ${et}`,` No consegui salvar sua avaliao, mas a **${Ue}** agradece imensamente! ${et}`,` Deu uma travadinha aqui, mas sua opinio j ficou guardada no meu corao! A **${Ue}** agradece! ${et}`,` Ops, falhei na tecnologia, mas no falhei em te ouvir! A **${Ue}** valoriza seu feedback! ${et}`,` Parece que o sistema deu soluo, mas sua avaliao foi ouvida! A **${Ue}** agradece! ${et}`,` A internet no colaborou, mas sua opinio chegou at mim! A **${Ue}**  grata! ${et}`,` Problema tcnico aqui, mas o importante  que voc compartilhou! A **${Ue}** agradece! ${et}`,` O sistema travou, mas sua avaliao no passou despercebida! A **${Ue}** valoriza! ${et}`],Ke=pt[Math.floor(Math.random()*pt.length)];i(Ke,600)}},ae=async()=>{if(!T){console.error("[Isis] Nenhum agendamento para atualizar");return}try{m(!0);const Se=a.cliente,Ne=a.participantes||[],{data:Ue}=await ve.from("clientes").select("id").eq("codigo_empresa",t).eq("is_consumidor_final",!0).single(),Qe=Ne.find($r=>$r.principal),et=Ne.filter($r=>!$r.principal),pt=Qe?[Qe,...et]:Ne,Ke=pt.map($r=>$r.nome),[qt,lt]=a.horario.inicio.split(":").map(Number),[rr,nt]=a.horario.fim.split(":").map(Number);let $t=rr*60+nt-(qt*60+lt);rr===0&&nt===0&&($t=24*60-(qt*60+lt));const Qr=a.quadra.valor||0,Xr=$t/30,In=Math.round(Qr*Xr*100)/100,{data:sn,error:Qt}=await ve.from("agendamentos").update({quadra_id:a.quadra.id,clientes:Ke,inicio:a.horario.inicioDate.toISOString(),fim:a.horario.fimDate.toISOString(),modalidade:a.esporte,valor_total:In}).eq("id",T.id).select().single();if(Qt)throw Qt;const{error:qr}=await ve.from("agendamento_participantes").delete().eq("agendamento_id",T.id);if(qr)throw qr;const Tr=pt.map(($r,Gr)=>({agendamento_id:sn.id,codigo_empresa:t,cliente_id:$r.cliente_id||Ue?.id,nome:$r.nome,valor_cota:0,status_pagamento:"Pendente",ordem:Gr+1})),{error:sr}=await ve.from("agendamento_participantes").insert(Tr);if(sr)throw sr;m(!1),D(sn),Nr(sn,!0),f("confirmation")}catch(Se){console.error("[Isis] Erro ao atualizar agendamento:",Se),m(!1);const Ne=Qg("error");i(Ne)}},$e=async()=>{try{m(!0);const Se=a.cliente,Ne=a.participantes||[],{data:Ue}=await ve.from("clientes").select("id").eq("codigo_empresa",t).eq("is_consumidor_final",!0).single(),Qe=Ne.find(ke=>ke.principal),et=Ne.filter(ke=>!ke.principal),pt=Qe?[Qe,...et]:Ne,Ke=pt.map(ke=>ke.nome),[qt,lt]=a.horario.inicio.split(":").map(Number),[rr,nt]=a.horario.fim.split(":").map(Number);let $t=rr*60+nt-(qt*60+lt);rr===0&&nt===0&&($t=24*60-(qt*60+lt));const Qr=a.quadra.valor||0,Xr=$t/30,In=Math.round(Qr*Xr*100)/100,{data:sn}=await ve.from("agendamentos").select("codigo").eq("codigo_empresa",t).order("codigo",{ascending:!1}).limit(1).single();let Qt=sn?sn.codigo+1:1;console.log("[criarAgendamento] ltimo cdigo usado:",sn?.codigo),console.log("[criarAgendamento] Prximo cdigo inicial:",Qt);let qr,Tr=0;const sr=10;for(;!qr&&Tr<sr;){Tr++,console.log("[criarAgendamento] Tentativa",Tr,"com cdigo:",Qt);const{data:ke,error:Mt}=await ve.from("agendamentos").insert({codigo:Qt,codigo_empresa:t,quadra_id:a.quadra.id,cliente_id:Se.id,clientes:Ke,inicio:a.horario.inicioDate.toISOString(),fim:a.horario.fimDate.toISOString(),modalidade:a.esporte,status:"scheduled",valor_total:In}).select("id, codigo").single();if(Mt)if(Mt.code==="23505")console.log("[criarAgendamento] Cdigo",Qt,"j existe, tentando prximo..."),Qt++;else throw Mt;else qr=ke,console.log("[criarAgendamento] Agendamento criado com cdigo:",qr.codigo)}if(!qr)throw new Error("No foi possvel gerar um cdigo nico aps "+sr+" tentativas");try{const{data:ke}=await ve.from("empresas").select("id").eq("codigo_empresa",t).single();ke&&(await ve.from("empresa_counters").update({next_agendamento_codigo:qr.codigo+1}).eq("empresa_id",ke.id),console.log("[criarAgendamento] Counter atualizado para:",qr.codigo+1))}catch(ke){console.warn("[criarAgendamento] Erro ao atualizar counter:",ke)}const $r=pt.map((ke,Mt)=>({codigo_empresa:t,agendamento_id:qr.id,cliente_id:ke.principal?Se.id:Ue?.id||null,nome:ke.nome,valor_cota:0,status_pagamento:"Pendente",ordem:Mt+1})),{error:Gr}=await ve.from("agendamento_participantes").insert($r);if(Gr)throw Gr;m(!1),D(qr),Nr(qr),f("confirmation")}catch(Se){console.error("[Isis] Erro ao criar agendamento:",Se),m(!1);const Ne=Qg("error");i(Ne),gj({title:"Erro ao criar agendamento",description:Se.message||"Tente novamente",variant:"destructive"})}},Ae=Se=>{switch(c(),n){case"quadra":pe(Se);break;case"data":Be(Se);break;case"identificacao":se(Se);break;case"review":se(Se);break;case"confirmation":se(Se);break;default:console.warn("[Isis] Nenhum handler para step:",n)}},Tt=()=>(console.log("[renderInput] currentStep:",n,"showInput:",k),k?n==="participantes"||n==="review"&&k&&S==="participantes"?(console.log("[renderInput] Renderizando IsisParticipantesInput"),o.jsx(cit,{participantesAtuais:a.participantes||[],onAdicionar:Nt,onRemover:st,onFinalizar:ft,onAdicionarLote:De,selfName:a.cliente?.nome})):n==="identificacao"||E==="data_custom"?o.jsx(sit,{tipo:E,onSubmit:L,onTrocarTipo:()=>{P(E==="telefone"?"email":"telefone")}}):n==="cadastro"?o.jsx(lit,{onSubmit:W,valorInicial:a.identificacao_valor,tipoInicial:a.identificacao_tipo||"telefone"}):n==="horario"||n==="review"&&k&&S==="horario"?(console.log("[renderInput] Renderizando IsisHorarioInput"),console.log("[renderInput] horariosDisponiveis:",w?.length||0),console.log("[renderInput] esportes:",a.quadra?.modalidades),o.jsx(iit,{onSubmit:kt,onMudarData:K,horariosDisponiveis:w,esportes:a.quadra?.modalidades||[]})):n==="avaliacao"?(console.log("[renderInput] Renderizando IsisAvaliacaoInput"),o.jsx(dit,{onSubmit:je})):null:(console.log("[renderInput] showInput=false, retornando null"),null));return e?_?o.jsx(uit,{message:"Preparando sua experincia..."}):g?o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(fr.header,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5},className:"bg-surface/70 backdrop-blur-xl border-b border-white/10 sticky top-0 z-20 shadow-lg",children:o.jsxs("div",{className:"container mx-auto px-4 md:px-6 py-3 md:py-4 flex items-center justify-between gap-3 md:gap-4",children:[o.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[o.jsxs("div",{className:"relative group",children:[o.jsx("div",{className:"transition-all duration-300 group-hover:scale-105",children:o.jsx(Wd,{size:"md",variant:"header",className:"md:w-20 md:h-20"})}),o.jsx("div",{className:"absolute bottom-0 right-0 w-3 h-3 md:w-4 md:h-4 bg-success rounded-full border-2 border-surface"})]}),o.jsxs("div",{className:"flex flex-col gap-0.5 md:gap-1",children:[o.jsx("h1",{className:"font-bold text-text-primary text-lg md:text-2xl tracking-tight leading-none",children:"sis"}),o.jsxs("div",{className:"relative group w-fit",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-500 via-purple-500 to-pink-500 blur-md opacity-60 group-hover:opacity-100 animate-pulse rounded-md"}),o.jsxs("div",{className:"relative px-2 py-0.5 md:px-2.5 md:py-1 bg-gradient-to-r from-cyan-500/20 via-purple-500/20 to-pink-500/20 backdrop-blur-sm border border-cyan-500/50 rounded-md flex items-center gap-1 md:gap-1.5 shadow-lg",children:[o.jsxs("svg",{className:"w-2.5 h-2.5 md:w-3 md:h-3 text-cyan-400",fill:"currentColor",viewBox:"0 0 20 20",children:[o.jsx("path",{d:"M13 7H7v6h6V7z"}),o.jsx("path",{fillRule:"evenodd",d:"M7 2a1 1 0 012 0v1h2V2a1 1 0 112 0v1h2a2 2 0 012 2v2h1a1 1 0 110 2h-1v2h1a1 1 0 110 2h-1v2a2 2 0 01-2 2h-2v1a1 1 0 11-2 0v-1H9v1a1 1 0 11-2 0v-1H5a2 2 0 01-2-2v-2H2a1 1 0 110-2h1V9H2a1 1 0 010-2h1V5a2 2 0 012-2h2V2zM5 5h10v10H5V5z",clipRule:"evenodd"})]}),o.jsx("span",{className:"text-[9px] md:text-[10px] font-bold bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:"AI"}),o.jsxs("div",{className:"hidden md:flex gap-0.5",children:[o.jsx("span",{className:"w-1 h-1 bg-cyan-400 rounded-full animate-pulse",style:{animationDelay:"0ms"}}),o.jsx("span",{className:"w-1 h-1 bg-purple-400 rounded-full animate-pulse",style:{animationDelay:"150ms"}}),o.jsx("span",{className:"w-1 h-1 bg-pink-400 rounded-full animate-pulse",style:{animationDelay:"300ms"}})]})]})]})]})]}),o.jsx("div",{className:"flex flex-1 justify-end md:justify-center",children:o.jsxs("div",{className:"group relative",children:[o.jsx("div",{className:"hidden md:block absolute inset-0 bg-gradient-to-r from-brand/20 via-brand/10 to-brand/20 blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),o.jsxs("div",{className:"relative flex items-center gap-2.5 md:gap-3 px-4 py-2 md:px-5 md:py-2.5 bg-gradient-to-r from-surface via-surface-2 to-surface backdrop-blur-sm rounded-lg md:rounded-xl border border-brand/20 shadow-md md:shadow-lg",children:[o.jsxs("div",{className:"relative w-9 h-9 md:w-10 md:h-10 shrink-0 overflow-hidden rounded-lg border border-white/10 bg-surface-2/60 grid place-items-center shadow-[0_0_0_3px_RGBA(0,0,0,0.2)] group-hover:border-white/20 transition-colors duration-300",children:[z?o.jsx("img",{src:z,alt:"Logo da empresa",className:"w-full h-full object-cover",onError:Se=>{Se.target.style.display="none",Se.target.nextSibling.style.display="block"}}):null,o.jsx(iN,{className:`w-5 h-5 md:w-6 md:h-6 opacity-80 ${z?"hidden":"block"}`,strokeWidth:2})]}),o.jsx("h2",{className:"text-sm md:text-base font-bold text-text-primary tracking-wide truncate max-w-[140px] md:max-w-none",children:g.nome_fantasia||g.razao_social})]})]})}),o.jsxs("div",{className:"hidden md:flex items-center gap-3",children:[o.jsx("div",{className:"w-12 h-12 bg-brand rounded-xl flex items-center justify-center flex-shrink-0",children:o.jsx($d,{className:"w-7 h-7 text-primary-foreground"})}),o.jsxs("div",{className:"hidden lg:flex items-baseline",children:[o.jsx("span",{className:"font-extrabold text-xl",style:{color:"#FF6600"},children:"Fluxo"}),o.jsx("span",{className:"font-extrabold text-xl",style:{color:"#FFAA33"},children:"7"}),o.jsx("span",{className:"font-medium text-xl",style:{color:"#B0B0B0"},children:" Arena"})]})]})]})}),o.jsx("div",{className:"container mx-auto max-w-5xl pb-6 md:pb-6 mb-12 md:mb-0",children:o.jsx(oit,{onButtonClick:Ae,hideButtonTexts:n==="avaliacao",children:Tt()})}),o.jsx(fr.footer,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.5,delay:.3},className:"md:hidden fixed bottom-0 left-0 right-0 bg-surface/90 backdrop-blur-xl border-t border-white/10 z-20 shadow-lg",children:o.jsx("div",{className:"flex items-center justify-center py-2",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-6 h-6 bg-brand rounded-lg flex items-center justify-center",children:o.jsx($d,{className:"w-4 h-4 text-primary-foreground"})}),o.jsxs("div",{className:"flex items-baseline",children:[o.jsx("span",{className:"font-extrabold text-sm",style:{color:"#FF6600"},children:"Fluxo"}),o.jsx("span",{className:"font-extrabold text-sm",style:{color:"#FFAA33"},children:"7"}),o.jsx("span",{className:"font-medium text-sm",style:{color:"#B0B0B0"},children:" Arena"})]})]})})})]}):o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:o.jsxs(fr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center max-w-2xl",children:[o.jsx(fr.div,{className:"mb-8 flex justify-center",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5,delay:.2},children:o.jsxs("div",{className:"relative",children:[o.jsx(Wd,{size:"xl",variant:"header"}),o.jsx(fr.div,{className:"absolute inset-0 rounded-full border-4 border-brand/30",animate:{scale:[1,1.2,1],opacity:[.5,0,.5]},transition:{duration:2,repeat:1/0}})]})}),o.jsxs(fr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"space-y-6",children:[o.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-text-primary mb-4",children:[$(),"! Tentando Agendar? "]}),o.jsxs("div",{className:"bg-surface/70 backdrop-blur-sm border border-white/10 rounded-2xl p-8 shadow-xl",children:[o.jsx("p",{className:"text-xl text-text-primary mb-6 leading-relaxed",children:"Entre em contato com o dono da quadra e solicite o **link de agendamento**."}),o.jsxs("div",{className:"bg-surface-2/50 border border-white/5 rounded-xl p-6 mb-6",children:[o.jsxs("h3",{className:"text-lg font-semibold text-text-primary mb-3 flex items-center gap-2",children:[o.jsx(eH,{className:"w-5 h-5 text-brand"}),"Formato do Link"]}),o.jsxs("div",{className:"bg-background/60 border border-white/10 rounded-lg p-4 font-mono text-sm",children:[o.jsx("span",{className:"text-text-muted",children:"fluxo7arena.com/agendar/"}),o.jsx("span",{className:"text-brand font-bold",children:"nome-da-empresa"})]})]})]})]}),o.jsx(fr.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.6},className:"mt-12 flex items-center justify-center",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-brand rounded-xl flex items-center justify-center shadow-lg",children:o.jsx($d,{className:"w-6 h-6 text-primary-foreground"})}),o.jsxs("div",{className:"flex items-baseline",children:[o.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FF6600"},children:"Fluxo"}),o.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FFAA33"},children:"7"}),o.jsx("span",{className:"font-medium text-2xl",style:{color:"#B0B0B0"},children:" Arena"})]})]})})]})}):o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:o.jsxs(fr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center max-w-2xl",children:[o.jsx(fr.div,{className:"mb-8 flex justify-center",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5,delay:.2},children:o.jsxs("div",{className:"relative",children:[o.jsx(Wd,{size:"xl",variant:"header"}),o.jsx(fr.div,{className:"absolute inset-0 rounded-full border-4 border-brand/30",animate:{scale:[1,1.2,1],opacity:[.5,0,.5]},transition:{duration:2,repeat:1/0}})]})}),o.jsxs(fr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"space-y-6",children:[o.jsxs("h1",{className:"text-3xl md:text-4xl font-bold text-text-primary mb-4",children:[$(),"! Tentando Agendar?"]}),o.jsx("div",{className:"bg-surface/70 backdrop-blur-sm border border-white/10 rounded-2xl p-8 shadow-xl",children:o.jsx("p",{className:"text-xl text-text-primary mb-4 leading-relaxed",children:"Entre em contato com o dono da quadra e solicite o link de agendamento."})})]}),o.jsx(fr.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.6},className:"mt-12 flex items-center justify-center",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 bg-brand rounded-xl flex items-center justify-center shadow-lg",children:o.jsx($d,{className:"w-6 h-6 text-primary-foreground"})}),o.jsxs("div",{className:"flex items-baseline",children:[o.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FF6600"},children:"Fluxo"}),o.jsx("span",{className:"font-extrabold text-2xl",style:{color:"#FFAA33"},children:"7"}),o.jsx("span",{className:"font-medium text-2xl",style:{color:"#B0B0B0"},children:" Arena"})]})]})})]})})};function xit(){return o.jsx(rit,{children:o.jsx(vit,{})})}function yit(e){return e&&typeof e=="object"&&"default"in e?e.default:e}var hoe=p,bit=yit(hoe);function gU(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wit(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var jit=!!(typeof window<"u"&&window.document&&window.document.createElement);function Nit(e,t,r){if(typeof e!="function")throw new Error("Expected reducePropsToState to be a function.");if(typeof t!="function")throw new Error("Expected handleStateChangeOnClient to be a function.");if(typeof r<"u"&&typeof r!="function")throw new Error("Expected mapStateOnServer to either be undefined or a function.");function n(a){return a.displayName||a.name||"Component"}return function(i){if(typeof i!="function")throw new Error("Expected WrappedComponent to be a React component.");var s=[],l;function c(){l=e(s.map(function(u){return u.props})),d.canUseDOM?t(l):r&&(l=r(l))}var d=function(u){wit(f,u);function f(){return u.apply(this,arguments)||this}f.peek=function(){return l},f.rewind=function(){if(f.canUseDOM)throw new Error("You may only call rewind() on the server. Call peek() to read the current state.");var v=l;return l=void 0,s=[],v};var m=f.prototype;return m.UNSAFE_componentWillMount=function(){s.push(this),c()},m.componentDidUpdate=function(){c()},m.componentWillUnmount=function(){var v=s.indexOf(this);s.splice(v,1),c()},m.render=function(){return bit.createElement(i,this.props)},f}(hoe.PureComponent);return gU(d,"displayName","SideEffect("+n(i)+")"),gU(d,"canUseDOM",jit),d}}var _it=Nit;const Sit=qa(_it);var Cit=typeof Element<"u",Pit=typeof Map=="function",Ait=typeof Set=="function",Eit=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function kj(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r,n,a;if(Array.isArray(e)){if(r=e.length,r!=t.length)return!1;for(n=r;n--!==0;)if(!kj(e[n],t[n]))return!1;return!0}var i;if(Pit&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(i=e.entries();!(n=i.next()).done;)if(!t.has(n.value[0]))return!1;for(i=e.entries();!(n=i.next()).done;)if(!kj(n.value[1],t.get(n.value[0])))return!1;return!0}if(Ait&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(i=e.entries();!(n=i.next()).done;)if(!t.has(n.value[0]))return!1;return!0}if(Eit&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(r=e.length,r!=t.length)return!1;for(n=r;n--!==0;)if(e[n]!==t[n])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&typeof e.valueOf=="function"&&typeof t.valueOf=="function")return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&typeof e.toString=="function"&&typeof t.toString=="function")return e.toString()===t.toString();if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!Object.prototype.hasOwnProperty.call(t,a[n]))return!1;if(Cit&&e instanceof Element)return!1;for(n=r;n--!==0;)if(!((a[n]==="_owner"||a[n]==="__v"||a[n]==="__o")&&e.$$typeof)&&!kj(e[a[n]],t[a[n]]))return!1;return!0}return e!==e&&t!==t}var kit=function(t,r){try{return kj(t,r)}catch(n){if((n.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw n}};const Oit=qa(kit);/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var vU=Object.getOwnPropertySymbols,Iit=Object.prototype.hasOwnProperty,Tit=Object.prototype.propertyIsEnumerable;function Dit(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function Mit(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;var n=Object.getOwnPropertyNames(t).map(function(i){return t[i]});if(n.join("")!=="0123456789")return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach(function(i){a[i]=i}),Object.keys(Object.assign({},a)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var Rit=Mit()?Object.assign:function(e,t){for(var r,n=Dit(e),a,i=1;i<arguments.length;i++){r=Object(arguments[i]);for(var s in r)Iit.call(r,s)&&(n[s]=r[s]);if(vU){a=vU(r);for(var l=0;l<a.length;l++)Tit.call(r,a[l])&&(n[a[l]]=r[a[l]])}}return n};const Lit=qa(Rit);var Rp={BODY:"bodyAttributes",HTML:"htmlAttributes",TITLE:"titleAttributes"},la={BASE:"base",BODY:"body",HEAD:"head",HTML:"html",LINK:"link",META:"meta",NOSCRIPT:"noscript",SCRIPT:"script",STYLE:"style",TITLE:"title"};Object.keys(la).map(function(e){return la[e]});var Fo={CHARSET:"charset",CSS_TEXT:"cssText",HREF:"href",HTTPEQUIV:"http-equiv",INNER_HTML:"innerHTML",ITEM_PROP:"itemprop",NAME:"name",PROPERTY:"property",REL:"rel",SRC:"src",TARGET:"target"},nS={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},O1={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate"},$it=Object.keys(nS).reduce(function(e,t){return e[nS[t]]=t,e},{}),Fit=[la.NOSCRIPT,la.SCRIPT,la.STYLE],qd="data-react-helmet",Bit=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qit=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},zit=function(){function e(t,r){for(var n=0;n<r.length;n++){var a=r[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Uit=function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},xU=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r},Vit=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e},C4=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return r===!1?String(t):String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")},Wit=function(t){var r=Yv(t,la.TITLE),n=Yv(t,O1.TITLE_TEMPLATE);if(n&&r)return n.replace(/%s/g,function(){return Array.isArray(r)?r.join(""):r});var a=Yv(t,O1.DEFAULT_TITLE);return r||a||void 0},Hit=function(t){return Yv(t,O1.ON_CHANGE_CLIENT_STATE)||function(){}},SE=function(t,r){return r.filter(function(n){return typeof n[t]<"u"}).map(function(n){return n[t]}).reduce(function(n,a){return _l({},n,a)},{})},Git=function(t,r){return r.filter(function(n){return typeof n[la.BASE]<"u"}).map(function(n){return n[la.BASE]}).reverse().reduce(function(n,a){if(!n.length)for(var i=Object.keys(a),s=0;s<i.length;s++){var l=i[s],c=l.toLowerCase();if(t.indexOf(c)!==-1&&a[c])return n.concat(a)}return n},[])},ay=function(t,r,n){var a={};return n.filter(function(i){return Array.isArray(i[t])?!0:(typeof i[t]<"u"&&Jit("Helmet: "+t+' should be of type "Array". Instead found type "'+Bit(i[t])+'"'),!1)}).map(function(i){return i[t]}).reverse().reduce(function(i,s){var l={};s.filter(function(m){for(var h=void 0,v=Object.keys(m),g=0;g<v.length;g++){var y=v[g],x=y.toLowerCase();r.indexOf(x)!==-1&&!(h===Fo.REL&&m[h].toLowerCase()==="canonical")&&!(x===Fo.REL&&m[x].toLowerCase()==="stylesheet")&&(h=x),r.indexOf(y)!==-1&&(y===Fo.INNER_HTML||y===Fo.CSS_TEXT||y===Fo.ITEM_PROP)&&(h=y)}if(!h||!m[h])return!1;var b=m[h].toLowerCase();return a[h]||(a[h]={}),l[h]||(l[h]={}),a[h][b]?!1:(l[h][b]=!0,!0)}).reverse().forEach(function(m){return i.push(m)});for(var c=Object.keys(l),d=0;d<c.length;d++){var u=c[d],f=Lit({},a[u],l[u]);a[u]=f}return i},[]).reverse()},Yv=function(t,r){for(var n=t.length-1;n>=0;n--){var a=t[n];if(a.hasOwnProperty(r))return a[r]}return null},Kit=function(t){return{baseTag:Git([Fo.HREF,Fo.TARGET],t),bodyAttributes:SE(Rp.BODY,t),defer:Yv(t,O1.DEFER),encode:Yv(t,O1.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:SE(Rp.HTML,t),linkTags:ay(la.LINK,[Fo.REL,Fo.HREF],t),metaTags:ay(la.META,[Fo.NAME,Fo.CHARSET,Fo.HTTPEQUIV,Fo.PROPERTY,Fo.ITEM_PROP],t),noscriptTags:ay(la.NOSCRIPT,[Fo.INNER_HTML],t),onChangeClientState:Hit(t),scriptTags:ay(la.SCRIPT,[Fo.SRC,Fo.INNER_HTML],t),styleTags:ay(la.STYLE,[Fo.CSS_TEXT],t),title:Wit(t),titleAttributes:SE(Rp.TITLE,t)}},P4=function(){var e=Date.now();return function(t){var r=Date.now();r-e>16?(e=r,t(r)):setTimeout(function(){P4(t)},0)}}(),yU=function(t){return clearTimeout(t)},Yit=typeof window<"u"?window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||P4:global.requestAnimationFrame||P4,Xit=typeof window<"u"?window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||yU:global.cancelAnimationFrame||yU,Jit=function(t){return console&&typeof console.warn=="function"&&console.warn(t)},oy=null,Qit=function(t){oy&&Xit(oy),t.defer?oy=Yit(function(){bU(t,function(){oy=null})}):(bU(t),oy=null)},bU=function(t,r){var n=t.baseTag,a=t.bodyAttributes,i=t.htmlAttributes,s=t.linkTags,l=t.metaTags,c=t.noscriptTags,d=t.onChangeClientState,u=t.scriptTags,f=t.styleTags,m=t.title,h=t.titleAttributes;A4(la.BODY,a),A4(la.HTML,i),Zit(m,h);var v={baseTag:Zg(la.BASE,n),linkTags:Zg(la.LINK,s),metaTags:Zg(la.META,l),noscriptTags:Zg(la.NOSCRIPT,c),scriptTags:Zg(la.SCRIPT,u),styleTags:Zg(la.STYLE,f)},g={},y={};Object.keys(v).forEach(function(x){var b=v[x],w=b.newTags,j=b.oldTags;w.length&&(g[x]=w),j.length&&(y[x]=v[x].oldTags)}),r&&r(),d(t,g,y)},poe=function(t){return Array.isArray(t)?t.join(""):t},Zit=function(t,r){typeof t<"u"&&document.title!==t&&(document.title=poe(t)),A4(la.TITLE,r)},A4=function(t,r){var n=document.getElementsByTagName(t)[0];if(n){for(var a=n.getAttribute(qd),i=a?a.split(","):[],s=[].concat(i),l=Object.keys(r),c=0;c<l.length;c++){var d=l[c],u=r[d]||"";n.getAttribute(d)!==u&&n.setAttribute(d,u),i.indexOf(d)===-1&&i.push(d);var f=s.indexOf(d);f!==-1&&s.splice(f,1)}for(var m=s.length-1;m>=0;m--)n.removeAttribute(s[m]);i.length===s.length?n.removeAttribute(qd):n.getAttribute(qd)!==l.join(",")&&n.setAttribute(qd,l.join(","))}},Zg=function(t,r){var n=document.head||document.querySelector(la.HEAD),a=n.querySelectorAll(t+"["+qd+"]"),i=Array.prototype.slice.call(a),s=[],l=void 0;return r&&r.length&&r.forEach(function(c){var d=document.createElement(t);for(var u in c)if(c.hasOwnProperty(u))if(u===Fo.INNER_HTML)d.innerHTML=c.innerHTML;else if(u===Fo.CSS_TEXT)d.styleSheet?d.styleSheet.cssText=c.cssText:d.appendChild(document.createTextNode(c.cssText));else{var f=typeof c[u]>"u"?"":c[u];d.setAttribute(u,f)}d.setAttribute(qd,"true"),i.some(function(m,h){return l=h,d.isEqualNode(m)})?i.splice(l,1):s.push(d)}),i.forEach(function(c){return c.parentNode.removeChild(c)}),s.forEach(function(c){return n.appendChild(c)}),{oldTags:i,newTags:s}},goe=function(t){return Object.keys(t).reduce(function(r,n){var a=typeof t[n]<"u"?n+'="'+t[n]+'"':""+n;return r?r+" "+a:a},"")},est=function(t,r,n,a){var i=goe(n),s=poe(r);return i?"<"+t+" "+qd+'="true" '+i+">"+C4(s,a)+"</"+t+">":"<"+t+" "+qd+'="true">'+C4(s,a)+"</"+t+">"},tst=function(t,r,n){return r.reduce(function(a,i){var s=Object.keys(i).filter(function(d){return!(d===Fo.INNER_HTML||d===Fo.CSS_TEXT)}).reduce(function(d,u){var f=typeof i[u]>"u"?u:u+'="'+C4(i[u],n)+'"';return d?d+" "+f:f},""),l=i.innerHTML||i.cssText||"",c=Fit.indexOf(t)===-1;return a+"<"+t+" "+qd+'="true" '+s+(c?"/>":">"+l+"</"+t+">")},"")},voe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.keys(t).reduce(function(n,a){return n[nS[a]||a]=t[a],n},r)},rst=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.keys(t).reduce(function(n,a){return n[$it[a]||a]=t[a],n},r)},nst=function(t,r,n){var a,i=(a={key:r},a[qd]=!0,a),s=voe(n,i);return[ye.createElement(la.TITLE,s,r)]},ast=function(t,r){return r.map(function(n,a){var i,s=(i={key:a},i[qd]=!0,i);return Object.keys(n).forEach(function(l){var c=nS[l]||l;if(c===Fo.INNER_HTML||c===Fo.CSS_TEXT){var d=n.innerHTML||n.cssText;s.dangerouslySetInnerHTML={__html:d}}else s[c]=n[l]}),ye.createElement(t,s)})},nf=function(t,r,n){switch(t){case la.TITLE:return{toComponent:function(){return nst(t,r.title,r.titleAttributes)},toString:function(){return est(t,r.title,r.titleAttributes,n)}};case Rp.BODY:case Rp.HTML:return{toComponent:function(){return voe(r)},toString:function(){return goe(r)}};default:return{toComponent:function(){return ast(t,r)},toString:function(){return tst(t,r,n)}}}},xoe=function(t){var r=t.baseTag,n=t.bodyAttributes,a=t.encode,i=t.htmlAttributes,s=t.linkTags,l=t.metaTags,c=t.noscriptTags,d=t.scriptTags,u=t.styleTags,f=t.title,m=f===void 0?"":f,h=t.titleAttributes;return{base:nf(la.BASE,r,a),bodyAttributes:nf(Rp.BODY,n,a),htmlAttributes:nf(Rp.HTML,i,a),link:nf(la.LINK,s,a),meta:nf(la.META,l,a),noscript:nf(la.NOSCRIPT,c,a),script:nf(la.SCRIPT,d,a),style:nf(la.STYLE,u,a),title:nf(la.TITLE,{title:m,titleAttributes:h},a)}},ost=function(t){var r,n;return n=r=function(a){Uit(i,a);function i(){return qit(this,i),Vit(this,a.apply(this,arguments))}return i.prototype.shouldComponentUpdate=function(l){return!Oit(this.props,l)},i.prototype.mapNestedChildrenToProps=function(l,c){if(!c)return null;switch(l.type){case la.SCRIPT:case la.NOSCRIPT:return{innerHTML:c};case la.STYLE:return{cssText:c}}throw new Error("<"+l.type+" /> elements are self-closing and can not contain children. Refer to our API for more information.")},i.prototype.flattenArrayTypeChildren=function(l){var c,d=l.child,u=l.arrayTypeChildren,f=l.newChildProps,m=l.nestedChildren;return _l({},u,(c={},c[d.type]=[].concat(u[d.type]||[],[_l({},f,this.mapNestedChildrenToProps(d,m))]),c))},i.prototype.mapObjectTypeChildren=function(l){var c,d,u=l.child,f=l.newProps,m=l.newChildProps,h=l.nestedChildren;switch(u.type){case la.TITLE:return _l({},f,(c={},c[u.type]=h,c.titleAttributes=_l({},m),c));case la.BODY:return _l({},f,{bodyAttributes:_l({},m)});case la.HTML:return _l({},f,{htmlAttributes:_l({},m)})}return _l({},f,(d={},d[u.type]=_l({},m),d))},i.prototype.mapArrayTypeChildrenToProps=function(l,c){var d=_l({},c);return Object.keys(l).forEach(function(u){var f;d=_l({},d,(f={},f[u]=l[u],f))}),d},i.prototype.warnOnInvalidChildren=function(l,c){return!0},i.prototype.mapChildrenToProps=function(l,c){var d=this,u={};return ye.Children.forEach(l,function(f){if(!(!f||!f.props)){var m=f.props,h=m.children,v=xU(m,["children"]),g=rst(v);switch(d.warnOnInvalidChildren(f,h),f.type){case la.LINK:case la.META:case la.NOSCRIPT:case la.SCRIPT:case la.STYLE:u=d.flattenArrayTypeChildren({child:f,arrayTypeChildren:u,newChildProps:g,nestedChildren:h});break;default:c=d.mapObjectTypeChildren({child:f,newProps:c,newChildProps:g,nestedChildren:h});break}}}),c=this.mapArrayTypeChildrenToProps(u,c),c},i.prototype.render=function(){var l=this.props,c=l.children,d=xU(l,["children"]),u=_l({},d);return c&&(u=this.mapChildrenToProps(c,u)),ye.createElement(t,u)},zit(i,null,[{key:"canUseDOM",set:function(l){t.canUseDOM=l}}]),i}(ye.Component),r.propTypes={base:Mn.object,bodyAttributes:Mn.object,children:Mn.oneOfType([Mn.arrayOf(Mn.node),Mn.node]),defaultTitle:Mn.string,defer:Mn.bool,encodeSpecialCharacters:Mn.bool,htmlAttributes:Mn.object,link:Mn.arrayOf(Mn.object),meta:Mn.arrayOf(Mn.object),noscript:Mn.arrayOf(Mn.object),onChangeClientState:Mn.func,script:Mn.arrayOf(Mn.object),style:Mn.arrayOf(Mn.object),title:Mn.string,titleAttributes:Mn.object,titleTemplate:Mn.string},r.defaultProps={defer:!0,encodeSpecialCharacters:!0},r.peek=t.peek,r.rewind=function(){var a=t.rewind();return a||(a=xoe({baseTag:[],bodyAttributes:{},encodeSpecialCharacters:!0,htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}})),a},n},ist=function(){return null},sst=Sit(Kit,Qit,xoe)(ist),E4=ost(sst);E4.renderStatic=E4.rewind;function lst(){const[e,t]=p.useState(!0),[r,n]=p.useState(!1),a=()=>{t(c=>!c)},i=ls(),s=Pc(),l=i.pathname==="/agenda";return p.useEffect(()=>{const c=d=>{const u=String(d.target?.tagName||"").toLowerCase();if(!(["input","textarea","select"].includes(u)||d.target?.isContentEditable)&&!d.repeat){if(String(d.key).toLowerCase()==="b"){d.preventDefault();const f=String(i?.pathname||"").toLowerCase();console.log("[Global Hotkey B] Current path:",f),f.includes("balcao")?(console.log("[Global Hotkey B] Navigating to /vendas"),s("/vendas")):(console.log("[Global Hotkey B] Navigating to /balcao"),s("/balcao"));return}if(String(d.key).toLowerCase()==="h"){d.preventDefault(),s("/historico");return}}};return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[i,s]),o.jsx(Zbe,{children:o.jsx(Hbe,{children:o.jsx(e1e,{children:o.jsxs("div",{className:"relative flex h-screen bg-background text-text-primary",children:[o.jsxs(E4,{children:[o.jsx("title",{children:"F7 Arena"}),o.jsx("meta",{name:"description",content:"Software para gesto de quadras esportivas."})]}),o.jsx(Tpe,{isVisible:e,setIsVisible:t,sidebarPinned:r}),e&&o.jsx("button",{type:"button",onClick:()=>t(!1),className:"md:hidden fixed inset-0 z-30 bg-black/40","aria-label":"Fechar menu lateral"}),o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[o.jsx(Gbe,{onToggleSidebar:a,sidebarVisible:e,sidebarPinned:r}),o.jsx("main",{className:Yt("flex-1 overflow-x-hidden overflow-y-auto bg-background",l?"p-0 md:p-8":"p-8"),children:o.jsxs(VW,{children:[o.jsx(Vo,{path:"/",element:o.jsx(Fqe,{})}),o.jsx(Vo,{path:"/agenda",element:o.jsx(vQe,{sidebarVisible:e})}),o.jsx(Vo,{path:"/isis",element:o.jsx(Wot,{})}),o.jsx(Vo,{path:"/vendas",element:o.jsx(oat,{})}),o.jsx(Vo,{path:"/balcao",element:o.jsx(iat,{})}),o.jsx(Vo,{path:"/produtos",element:o.jsx(Oat,{})}),o.jsx(Vo,{path:"/compras",element:o.jsx(Dat,{})}),o.jsx(Vo,{path:"/clientes",element:o.jsx(Fat,{})}),o.jsx(Vo,{path:"/equipe",element:o.jsx(Vat,{})}),o.jsx(Vo,{path:"/financeiro",element:o.jsx(kot,{})}),o.jsx(Vo,{path:"/caixa",element:o.jsx(qce,{to:"/financeiro?tab=caixa",replace:!0})}),o.jsx(Vo,{path:"/quadras",element:o.jsx(Tot,{})}),o.jsx(Vo,{path:"/empresas",element:o.jsx($ot,{})}),o.jsx(Vo,{path:"/finalizadoras",element:o.jsx(Bot,{})}),o.jsx(Vo,{path:"/test-page",element:o.jsx(qot,{})}),o.jsx(Vo,{path:"/historico",element:o.jsx(Yot,{})}),o.jsx(Vo,{path:"/suporte",element:o.jsx(Hat,{})})]})})]})]})})})})}function cst(){return o.jsxs(VW,{children:[o.jsx(Vo,{path:"/reset-password",element:o.jsx(Uot,{})}),o.jsx(Vo,{path:"/40028922",element:o.jsx(tit,{})}),o.jsx(Vo,{path:"/agendar/:nomeFantasia",element:o.jsx(xit,{})}),o.jsx(Vo,{path:"/print-comanda",element:o.jsx(Q$,{children:o.jsx(Xot,{})})}),o.jsx(Vo,{path:"/*",element:o.jsx(Q$,{children:o.jsx(lst,{})})})]})}var lR="ToastProvider",[cR,dst,ust]=VC("Toast"),[yoe,elt]=pd("Toast",[ust]),[fst,A5]=yoe(lR),boe=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:a="right",swipeThreshold:i=50,children:s}=e,[l,c]=p.useState(null),[d,u]=p.useState(0),f=p.useRef(!1),m=p.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${lR}\`. Expected non-empty \`string\`.`),o.jsx(cR.Provider,{scope:t,children:o.jsx(fst,{scope:t,label:r,duration:n,swipeDirection:a,swipeThreshold:i,toastCount:d,viewport:l,onViewportChange:c,onToastAdd:p.useCallback(()=>u(h=>h+1),[]),onToastRemove:p.useCallback(()=>u(h=>h-1),[]),isFocusedToastEscapeKeyDownRef:f,isClosePausedRef:m,children:s})})};boe.displayName=lR;var woe="ToastViewport",mst=["F8"],k4="toast.viewportPause",O4="toast.viewportResume",joe=p.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=mst,label:a="Notifications ({hotkey})",...i}=e,s=A5(woe,r),l=dst(r),c=p.useRef(null),d=p.useRef(null),u=p.useRef(null),f=p.useRef(null),m=Da(t,f,s.onViewportChange),h=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),v=s.toastCount>0;p.useEffect(()=>{const y=x=>{n.length!==0&&n.every(w=>x[w]||x.code===w)&&f.current?.focus()};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[n]),p.useEffect(()=>{const y=c.current,x=f.current;if(v&&y&&x){const b=()=>{if(!s.isClosePausedRef.current){const C=new CustomEvent(k4);x.dispatchEvent(C),s.isClosePausedRef.current=!0}},w=()=>{if(s.isClosePausedRef.current){const C=new CustomEvent(O4);x.dispatchEvent(C),s.isClosePausedRef.current=!1}},j=C=>{!y.contains(C.relatedTarget)&&w()},_=()=>{y.contains(document.activeElement)||w()};return y.addEventListener("focusin",b),y.addEventListener("focusout",j),y.addEventListener("pointermove",b),y.addEventListener("pointerleave",_),window.addEventListener("blur",b),window.addEventListener("focus",w),()=>{y.removeEventListener("focusin",b),y.removeEventListener("focusout",j),y.removeEventListener("pointermove",b),y.removeEventListener("pointerleave",_),window.removeEventListener("blur",b),window.removeEventListener("focus",w)}}},[v,s.isClosePausedRef]);const g=p.useCallback(({tabbingDirection:y})=>{const b=l().map(w=>{const j=w.ref.current,_=[j,...Cst(j)];return y==="forwards"?_:_.reverse()});return(y==="forwards"?b.reverse():b).flat()},[l]);return p.useEffect(()=>{const y=f.current;if(y){const x=b=>{const w=b.altKey||b.ctrlKey||b.metaKey;if(b.key==="Tab"&&!w){const _=document.activeElement,C=b.shiftKey;if(b.target===y&&C){d.current?.focus();return}const k=g({tabbingDirection:C?"backwards":"forwards"}),M=k.findIndex(S=>S===_);CE(k.slice(M+1))?b.preventDefault():C?d.current?.focus():u.current?.focus()}};return y.addEventListener("keydown",x),()=>y.removeEventListener("keydown",x)}},[l,g]),o.jsxs(Xpe,{ref:c,role:"region","aria-label":a.replace("{hotkey}",h),tabIndex:-1,style:{pointerEvents:v?void 0:"none"},children:[v&&o.jsx(I4,{ref:d,onFocusFromOutsideViewport:()=>{const y=g({tabbingDirection:"forwards"});CE(y)}}),o.jsx(cR.Slot,{scope:r,children:o.jsx(Hn.ol,{tabIndex:-1,...i,ref:m})}),v&&o.jsx(I4,{ref:u,onFocusFromOutsideViewport:()=>{const y=g({tabbingDirection:"backwards"});CE(y)}})]})});joe.displayName=woe;var Noe="ToastFocusProxy",I4=p.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...a}=e,i=A5(Noe,r);return o.jsx(JD,{tabIndex:0,...a,ref:t,style:{position:"fixed"},onFocus:s=>{const l=s.relatedTarget;!i.viewport?.contains(l)&&n()}})});I4.displayName=Noe;var _w="Toast",hst="toast.swipeStart",pst="toast.swipeMove",gst="toast.swipeCancel",vst="toast.swipeEnd",_oe=p.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:a,onOpenChange:i,...s}=e,[l,c]=kf({prop:n,defaultProp:a??!0,onChange:i,caller:_w});return o.jsx(Ac,{present:r||l,children:o.jsx(bst,{open:l,...s,ref:t,onClose:()=>c(!1),onPause:Fl(e.onPause),onResume:Fl(e.onResume),onSwipeStart:Jr(e.onSwipeStart,d=>{d.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Jr(e.onSwipeMove,d=>{const{x:u,y:f}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","move"),d.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${f}px`)}),onSwipeCancel:Jr(e.onSwipeCancel,d=>{d.currentTarget.setAttribute("data-swipe","cancel"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Jr(e.onSwipeEnd,d=>{const{x:u,y:f}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","end"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${f}px`),c(!1)})})})});_oe.displayName=_w;var[xst,yst]=yoe(_w,{onClose(){}}),bst=p.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:a,open:i,onClose:s,onEscapeKeyDown:l,onPause:c,onResume:d,onSwipeStart:u,onSwipeMove:f,onSwipeCancel:m,onSwipeEnd:h,...v}=e,g=A5(_w,r),[y,x]=p.useState(null),b=Da(t,D=>x(D)),w=p.useRef(null),j=p.useRef(null),_=a||g.duration,C=p.useRef(0),E=p.useRef(_),P=p.useRef(0),{onToastAdd:k,onToastRemove:M}=g,S=Fl(()=>{y?.contains(document.activeElement)&&g.viewport?.focus(),s()}),I=p.useCallback(D=>{!D||D===1/0||(window.clearTimeout(P.current),C.current=new Date().getTime(),P.current=window.setTimeout(S,D))},[S]);p.useEffect(()=>{const D=g.viewport;if(D){const B=()=>{I(E.current),d?.()},U=()=>{const z=new Date().getTime()-C.current;E.current=E.current-z,window.clearTimeout(P.current),c?.()};return D.addEventListener(k4,U),D.addEventListener(O4,B),()=>{D.removeEventListener(k4,U),D.removeEventListener(O4,B)}}},[g.viewport,_,c,d,I]),p.useEffect(()=>{i&&!g.isClosePausedRef.current&&I(_)},[i,_,g.isClosePausedRef,I]),p.useEffect(()=>(k(),()=>M()),[k,M]);const T=p.useMemo(()=>y?Ooe(y):null,[y]);return g.viewport?o.jsxs(o.Fragment,{children:[T&&o.jsx(wst,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite",children:T}),o.jsx(xst,{scope:r,onClose:S,children:$f.createPortal(o.jsx(cR.ItemSlot,{scope:r,children:o.jsx(Ype,{asChild:!0,onEscapeKeyDown:Jr(l,()=>{g.isFocusedToastEscapeKeyDownRef.current||S(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:o.jsx(Hn.li,{tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":g.swipeDirection,...v,ref:b,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:Jr(e.onKeyDown,D=>{D.key==="Escape"&&(l?.(D.nativeEvent),D.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,S()))}),onPointerDown:Jr(e.onPointerDown,D=>{D.button===0&&(w.current={x:D.clientX,y:D.clientY})}),onPointerMove:Jr(e.onPointerMove,D=>{if(!w.current)return;const B=D.clientX-w.current.x,U=D.clientY-w.current.y,z=!!j.current,$=["left","right"].includes(g.swipeDirection),Y=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,de=$?Y(0,B):0,xe=$?0:Y(0,U),q=D.pointerType==="touch"?10:2,L={x:de,y:xe},W={originalEvent:D,delta:L};z?(j.current=L,J2(pst,f,W,{discrete:!1})):wU(L,g.swipeDirection,q)?(j.current=L,J2(hst,u,W,{discrete:!1}),D.target.setPointerCapture(D.pointerId)):(Math.abs(B)>q||Math.abs(U)>q)&&(w.current=null)}),onPointerUp:Jr(e.onPointerUp,D=>{const B=j.current,U=D.target;if(U.hasPointerCapture(D.pointerId)&&U.releasePointerCapture(D.pointerId),j.current=null,w.current=null,B){const z=D.currentTarget,$={originalEvent:D,delta:B};wU(B,g.swipeDirection,g.swipeThreshold)?J2(vst,h,$,{discrete:!0}):J2(gst,m,$,{discrete:!0}),z.addEventListener("click",Y=>Y.preventDefault(),{once:!0})}})})})}),g.viewport)})]}):null}),wst=e=>{const{__scopeToast:t,children:r,...n}=e,a=A5(_w,t),[i,s]=p.useState(!1),[l,c]=p.useState(!1);return _st(()=>s(!0)),p.useEffect(()=>{const d=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(d)},[]),l?null:o.jsx(Xx,{asChild:!0,children:o.jsx(JD,{...n,children:i&&o.jsxs(o.Fragment,{children:[a.label," ",r]})})})},jst="ToastTitle",Soe=p.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return o.jsx(Hn.div,{...n,ref:t})});Soe.displayName=jst;var Nst="ToastDescription",Coe=p.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return o.jsx(Hn.div,{...n,ref:t})});Coe.displayName=Nst;var Poe="ToastAction",Aoe=p.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?o.jsx(koe,{altText:r,asChild:!0,children:o.jsx(dR,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${Poe}\`. Expected non-empty \`string\`.`),null)});Aoe.displayName=Poe;var Eoe="ToastClose",dR=p.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,a=yst(Eoe,r);return o.jsx(koe,{asChild:!0,children:o.jsx(Hn.button,{type:"button",...n,ref:t,onClick:Jr(e.onClick,a.onClose)})})});dR.displayName=Eoe;var koe=p.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...a}=e;return o.jsx(Hn.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...a,ref:t})});function Ooe(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),Sst(n)){const a=n.ariaHidden||n.hidden||n.style.display==="none",i=n.dataset.radixToastAnnounceExclude==="";if(!a)if(i){const s=n.dataset.radixToastAnnounceAlt;s&&t.push(s)}else t.push(...Ooe(n))}}),t}function J2(e,t,r,{discrete:n}){const a=r.originalEvent.currentTarget,i=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?sT(a,i):a.dispatchEvent(i)}var wU=(e,t,r=0)=>{const n=Math.abs(e.x),a=Math.abs(e.y),i=n>a;return t==="left"||t==="right"?i&&n>r:!i&&a>r};function _st(e=()=>{}){const t=Fl(e);Cs(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function Sst(e){return e.nodeType===e.ELEMENT_NODE}function Cst(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function CE(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var Pst=boe,Ioe=joe,Toe=_oe,Doe=Soe,Moe=Coe,Roe=Aoe,Loe=dR;const Ast=Pst,$oe=ye.forwardRef(({className:e,...t},r)=>o.jsx(Ioe,{ref:r,className:Yt("fixed z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));$oe.displayName=Ioe.displayName;const Est=iT("group relative pointer-events-auto flex w-full items-start justify-between gap-4 overflow-hidden rounded-lg border p-4 pr-8 shadow-xl transition-all data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=open]:sm:slide-in-from-bottom-full data-[state=closed]:slide-out-to-right-full",{variants:{variant:{default:"bg-warning text-black border-warning",destructive:"bg-danger text-white border-danger",success:"bg-success text-white border-success",info:"bg-info text-black border-info",warning:"bg-warning text-black border-warning"}},defaultVariants:{variant:"default"}}),Foe=ye.forwardRef(({className:e,variant:t,...r},n)=>o.jsx(Toe,{ref:n,className:Yt(Est({variant:t}),e),...r}));Foe.displayName=Toe.displayName;const kst=ye.forwardRef(({className:e,...t},r)=>o.jsx(Roe,{ref:r,className:Yt("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-destructive/30 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));kst.displayName=Roe.displayName;const Boe=ye.forwardRef(({className:e,...t},r)=>o.jsx(Loe,{ref:r,className:Yt("absolute right-2 top-2 rounded-md p-1 text-white/80 transition-opacity hover:text-white focus:outline-none focus:ring-2 focus:ring-white/50 group-[.default]:text-black/70 group-[.default]:hover:text-black",e),...t,children:o.jsx(Ml,{className:"h-4 w-4"})}));Boe.displayName=Loe.displayName;const qoe=ye.forwardRef(({className:e,...t},r)=>o.jsx(Doe,{ref:r,className:Yt("text-sm font-semibold",e),...t}));qoe.displayName=Doe.displayName;const zoe=ye.forwardRef(({className:e,...t},r)=>o.jsx(Moe,{ref:r,className:Yt("text-sm",e),...t}));zoe.displayName=Moe.displayName;function Ost(){const{toasts:e}=oo();return o.jsxs(Ast,{children:[e.map(({id:t,title:r,description:n,action:a,dismiss:i,...s})=>o.jsxs(Foe,{...s,children:[o.jsxs("div",{className:"grid gap-1",children:[r&&o.jsx(qoe,{children:r}),n&&o.jsx(zoe,{children:n})]}),a,o.jsx(Boe,{onClick:i})]},t)),o.jsx($oe,{})]})}function Ist(){"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js",{scope:"/"}).then(e=>{setInterval(()=>{e.update()},6e4),e.addEventListener("updatefound",()=>{const t=e.installing;t.addEventListener("statechange",()=>{t.state==="installed"&&navigator.serviceWorker.controller&&window.confirm("Nova verso disponvel! Deseja atualizar agora?")&&(t.postMessage({type:"SKIP_WAITING"}),window.location.reload())})})}).catch(e=>{console.error("[SW] Erro ao registrar Service Worker:",e)}),navigator.serviceWorker.addEventListener("controllerchange",()=>{window.location.reload()})})}Ist();window.screen?.orientation?.lock&&window.screen.orientation.lock("portrait").catch(e=>{console.log("[Orientation] Lock no suportado ou j bloqueado:",e.message)});window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),window.__installPrompt=e},{passive:!1});window.addEventListener("appinstalled",()=>{window.__installPrompt=null});PE.createRoot(document.getElementById("root")).render(o.jsx(Jce,{children:o.jsxs(H0e,{children:[o.jsx(cst,{}),o.jsx(Ost,{})]})}));export{Ebe as _,Us as c,qa as g};
